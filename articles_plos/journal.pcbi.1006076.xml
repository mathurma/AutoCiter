<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006076</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-02056</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Artificial intelligence</subject><subj-group><subject>Artificial neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Artificial neural networks</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Artificial neural networks</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Diagnostic medicine</subject><subj-group><subject>Prognosis</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Nephrology</subject><subj-group><subject>Renal cancer</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Endocrinology</subject><subj-group><subject>Endocrine physiology</subject><subj-group><subject>Insulin signaling</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Endocrine physiology</subject><subj-group><subject>Insulin signaling</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Endocrine physiology</subject><subj-group><subject>Insulin signaling</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Oncology</subject><subj-group><subject>Cancers and neoplasms</subject><subj-group><subject>Lung and intrathoracic tumors</subject><subj-group><subject>Squamous cell lung carcinoma</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Oncology</subject><subj-group><subject>Cancers and neoplasms</subject><subj-group><subject>Carcinomas</subject><subj-group><subject>Squamous cell carcinomas</subject><subj-group><subject>Squamous cell lung carcinoma</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Research design</subject><subj-group><subject>Clinical research design</subject><subj-group><subject>Survival analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Survival analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Survival analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Cox-nnet: An artificial neural network method for prognosis prediction of high-throughput omics data</article-title>
<alt-title alt-title-type="running-head">Artificial neural network for prognosis</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Ching</surname>
<given-names>Travers</given-names>
</name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Zhu</surname>
<given-names>Xun</given-names>
</name>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4654-2126</contrib-id>
<name name-style="western">
<surname>Garmire</surname>
<given-names>Lana X.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Molecular Biosciences and Bioengineering Graduate Program, University of Hawaii at Manoa, Honolulu, HI, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Epidemiology Program, University of Hawaii Cancer Center, Honolulu, HI, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Markowetz</surname>
<given-names>Florian</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Cambridge, UNITED KINGDOM</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">lgarmire@cc.hawaii.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>10</day>
<month>4</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="collection">
<month>4</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>4</issue>
<elocation-id>e1006076</elocation-id>
<history>
<date date-type="received">
<day>16</day>
<month>12</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>7</day>
<month>3</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Ching et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006076"/>
<abstract>
<p>Artificial neural networks (ANN) are computing architectures with many interconnections of simple neural-inspired computing elements, and have been applied to biomedical fields such as imaging analysis and diagnosis. We have developed a new ANN framework called Cox-nnet to predict patient prognosis from high throughput transcriptomics data. In 10 TCGA RNA-Seq data sets, Cox-nnet achieves the same or better predictive accuracy compared to other methods, including Cox-proportional hazards regression (with LASSO, ridge, and mimimax concave penalty), Random Forests Survival and CoxBoost. Cox-nnet also reveals richer biological information, at both the pathway and gene levels. The outputs from the hidden layer node provide an alternative approach for survival-sensitive dimension reduction. In summary, we have developed a new method for accurate and efficient prognosis prediction on high throughput data, with functional biological insights. The source code is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/lanagarmire/cox-nnet" xlink:type="simple">https://github.com/lanagarmire/cox-nnet</ext-link>.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>The increasing application of high-througput transcriptomics data to predict patient prognosis demands modern computational methods. With the re-gaining popularity of artificial neural networks, we asked if a refined neural network model could be used to predict patient survival, as an alternative to the conventional methods, such as Cox proportional hazards (Cox-PH) methods with LASSO or ridge penalization. To this end, we have developed a neural network extension of the Cox regression model, called Cox-nnet. It is optimized for survival prediction from high throughput gene expression data, with comparable or better performance than other conventional methods. More importantly, Cox-nnet reveals much richer biological information, at both the pathway and gene levels, by analyzing features represented in the hidden layer nodes in Cox-nnet. Additionally, we propose to use hidden node features as a new approach for dimension reduction during survival data analysis.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000066</institution-id>
<institution>National Institute of Environmental Health Sciences</institution>
</institution-wrap>
</funding-source>
<award-id>K01ES025434</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4654-2126</contrib-id>
<name name-style="western">
<surname>Garmire</surname>
<given-names>Lana X.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000057</institution-id>
<institution>National Institute of General Medical Sciences</institution>
</institution-wrap>
</funding-source>
<award-id>GM103457</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4654-2126</contrib-id>
<name name-style="western">
<surname>Garmire</surname>
<given-names>Lana X.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000092</institution-id>
<institution>U.S. National Library of Medicine</institution>
</institution-wrap>
</funding-source>
<award-id>LM012373</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4654-2126</contrib-id>
<name name-style="western">
<surname>Garmire</surname>
<given-names>Lana X.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000071</institution-id>
<institution>National Institute of Child Health and Human Development</institution>
</institution-wrap>
</funding-source>
<award-id>HD084633</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4654-2126</contrib-id>
<name name-style="western">
<surname>Garmire</surname>
<given-names>Lana X.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100001159</institution-id>
<institution>Hawaii Community Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>14ADVC-64566</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4654-2126</contrib-id>
<name name-style="western">
<surname>Garmire</surname>
<given-names>Lana X.</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This research was supported by grants K01ES025434 awarded by NIEHS through funds provided by the trans-NIH Big Data to Knowledge (BD2K) initiative (<ext-link ext-link-type="uri" xlink:href="http://www.bd2k.nih.gov" xlink:type="simple">www.bd2k.nih.gov</ext-link>), P20 COBRE GM103457 awarded by NIH/NIGMS, R01 LM012373 awarded by NLM, R01 HD084633 awarded by NICHD, and Hawaii Community Foundation Medical Research Grant 14ADVC-64566 to LXG. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="1"/>
<page-count count="18"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-04-20</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Data used in this publication come from The Cancer Genome Atlas, managed by NIH (<ext-link ext-link-type="uri" xlink:href="https://cancergenome.nih.gov/" xlink:type="simple">https://cancergenome.nih.gov/</ext-link>). Readers can access the TCGA RNA-Seq data by visiting <ext-link ext-link-type="uri" xlink:href="https://portal.gdc.cancer.gov/legacy-archive/search/f" xlink:type="simple">https://portal.gdc.cancer.gov/legacy-archive/search/f</ext-link>, selecting “gene expression data” and downloading using the downloading application. The data from TCGA is detailed in the methods section of the manuscript. Code used in this publication is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/lanagarmire/cox-nnet" xlink:type="simple">https://github.com/lanagarmire/cox-nnet</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>With the wide application of genomics technologies, gene expression data of patients are often used as inputs to predict patients’ survival. Computationally, survival prediction is usually framed as a regression problem to model patients’ survival time (or other event time). The most common method is the Cox-PH model, a semi-parametric proportional hazards model, where the covariates of the models explain the relative risks of the patients, termed hazard ratios [<xref ref-type="bibr" rid="pcbi.1006076.ref001">1</xref>]. Given the large amount of input features in gene expression data, penalization methods such as LASSO (L1 norm), ridge (L2 norm) and MCP [<xref ref-type="bibr" rid="pcbi.1006076.ref002">2</xref>] regularizations are often used to help select representative feature in Cox-PH models. A modification of Cox-PH model is CoxBoost [<xref ref-type="bibr" rid="pcbi.1006076.ref003">3</xref>]. It is an iterative “gradient boosting” method, where the parameters are separated into individual partitions. The partition that leads to the largest improvement in the penalized partial log likelihood is selected and in subsequent iterations, the model selects another block and refits those parameters by maximizing the penalized partial log likelihood [<xref ref-type="bibr" rid="pcbi.1006076.ref003">3</xref>]. Random Forests Survival (RF-S) is a tree-based, non-linear, ensemble method [<xref ref-type="bibr" rid="pcbi.1006076.ref004">4</xref>], rather than a proportional hazards model. For each tree in the forest, data is bootstrapped, and nodes are split by maximizing the log-rank statistic. The cumulative hazard function (CHF) is estimated in each tree and a patient’s CHF is calculated as an average over all the trees in the ensemble.</p>
<p>Besides these methods above, Artificial Neural networks (ANNs), a type of model that is based on the idea of neurons in processing information, could be trained to predict survival as well. Developed in 1943, ANNs were used to model non-linear behavior [<xref ref-type="bibr" rid="pcbi.1006076.ref005">5</xref>]. In an ANN, hidden units, termed as neurons or nodes, may be activated or deactivated, depending on the input signals, based their own linear weight and bias parameters. The data are fed forward through the network, and for each hidden unit these weight and bias parameters are learned through back propagation along the gradient of the loss function. In recent years, ANNs have caught renewed attention to solve problems in genomics field [<xref ref-type="bibr" rid="pcbi.1006076.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1006076.ref007">7</xref>], thanks to increased parallel computing power and the promise of deep learning [<xref ref-type="bibr" rid="pcbi.1006076.ref008">8</xref>]. For example, Alipanhi et al. used deep learning in order to better predict the bind of RNA and DNA to proteins [<xref ref-type="bibr" rid="pcbi.1006076.ref009">9</xref>]. Ciresan et al. used convolutional neural networks to detect cell mitosis in histological breast cancer images [<xref ref-type="bibr" rid="pcbi.1006076.ref010">10</xref>]. However, relative to these new areas, survival prediction using ANN has been lagging behind.</p>
<p>The first ANN model to predict survival was done by Faraggi and Simon, who used four clinical input parameters to model prostate cancer survival[<xref ref-type="bibr" rid="pcbi.1006076.ref011">11</xref>]. However, their simple model was not suitable for high throughput input data, where tens of thousands of features are present per patient. Subsequently, other authors attempted to implement ANN methods to predict patient survival. One study applied ANNs to high dimensional survival data by simplifying the regression as a binary classification problem [<xref ref-type="bibr" rid="pcbi.1006076.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1006076.ref013">13</xref>], and another study fit continuous variables of survival time to discrete variables through binning [<xref ref-type="bibr" rid="pcbi.1006076.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1006076.ref013">13</xref>]. These approaches potentially led to loss of accuracy in prediction. Another study used time as an additional input in order to predict patient survival or censoring status [<xref ref-type="bibr" rid="pcbi.1006076.ref014">14</xref>], which will overfit when the survival and censoring are correlated. Thus far, an ANN model based on proportional hazards to analyze high throughput data in the genomics era is lacking.</p>
<p>To address all the issues of ANN based predictions as mentioned earlier, we have developed a new software package, named Cox-nnet. We use a two layer neural network: one hidden layer and the output layer. Rather than approximating survival as a classification problem, we used the output layer to perform Cox regression based on the activation levels of the hidden layer. Cox-nnet also computes feature importance scores, so that the relative importance of specific genes to prognosis outcome can be assessed. More importantly, the hidden layer node structure in the ANN can be analyzed to reveal more useful information regarding relevant genes and pathways, compared to other methods in the study. A similar idea for classification (rather than survival analysis) was recently explored in dimension reduction of single cell RNA-Seq data, in which a set of input genes with high weights to the hidden nodes of the neural network, in single cell RNA-Seq was analyzed using GO analysis [<xref ref-type="bibr" rid="pcbi.1006076.ref015">15</xref>]. Overall, Cox-nnet is a desirable survival analysis method with both excellent predictive power and ability to elucidate biological functions related to prognosis.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Cox-nnet structure and optimization</title>
<p>The neural network model used in this paper is shown in <xref ref-type="fig" rid="pcbi.1006076.g001">Fig 1</xref> and an overview of modules in the Cox-nnet package is shown in <xref ref-type="supplementary-material" rid="pcbi.1006076.s001">S1 Fig</xref>. The current ANN architecture is composed of the input, one fully connected hidden layer (143 nodes) and an output “proportional hazards” layer. Cox-nnet performs cross-validation (CV) to find the optimal regularization parameter. Due to the large number of parameters, overfitting is a potential problem in ANNs, particularly for small datasets. Thus for regularization, we experimented with a range of regularization methods, including ridge, dropout [<xref ref-type="bibr" rid="pcbi.1006076.ref016">16</xref>], and the combination of ridge and dropout (see details in <xref ref-type="sec" rid="sec009">Methods</xref>). We found that dropout regularization offered overall the best model (<xref ref-type="supplementary-material" rid="pcbi.1006076.s002">S2A and S2B Fig</xref>). Furthermore, we compared Cox-nnet structures within no hidden layer (a standard Cox-PH model), one hidden layer (143 nodes) and two hidden layers (143 nodes in both layers) under dropout regularization (<xref ref-type="supplementary-material" rid="pcbi.1006076.s003">S3 Fig</xref>). We found that a single hidden layer Cox-nnet performed slightly better than those with no hidden layer (standard Cox-PH) or two hidden layers (<xref ref-type="supplementary-material" rid="pcbi.1006076.s003">S3A and S3B Fig</xref>). Thus, we used the single hidden-layer Cox-nnet with dropout regularization (average dropout rate = 7.75 +/- 0.042), for comparison with other survival methods in all following analyses.</p>
<fig id="pcbi.1006076.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006076.g001</object-id>
<label>Fig 1</label>
<caption>
<title>An overview of the optimized Cox-nnet neural network architecture used in this study.</title>
<p>Cox-nnet is composed of one hidden layer and an output “Cox-regression” layer. It is optimized to work on high dimensional gene expression data. The model is trained to minimize the partial log likelihood using back-propagation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.g001" xlink:type="simple"/>
</fig>
<p>Many other functions are implemented to improve the usability of the package (<xref ref-type="supplementary-material" rid="pcbi.1006076.s001">S1 Fig</xref>). Among them, the optimizers for adapting the learning rate include momentum gradient descent [<xref ref-type="bibr" rid="pcbi.1006076.ref017">17</xref>] and Nesterov accelerated gradient [<xref ref-type="bibr" rid="pcbi.1006076.ref018">18</xref>]. A comparison of these descent methods is shown in <xref ref-type="supplementary-material" rid="pcbi.1006076.s004">S4A Fig</xref>. We chose Nesterov accelerated gradient search method for this report. Other parameterization details of Cox-nnet are described in the Methods section.</p>
</sec>
<sec id="sec004">
<title>Performance comparison of survival prediction methods</title>
<p>We compared four methods, including Cox-nnet, Cox-PH (including Ridge, LASSO and MCP penalizations), CoxBoost and RF-S on 10 datasets from The Cancer Genome Atlas (TCGA). These datasets were selected for having at least 50 death events (<xref ref-type="supplementary-material" rid="pcbi.1006076.s011">S1 Table</xref>). For each dataset, we trained the model on 80% of the randomly selected samples and determined the regularization parameter using 5-fold CV on the training set. We evaluated the performance on the remaining 20% holdout test set. We replicated this evaluation 10 times in order to assess the average distribution of each method.</p>
<p>We used four accuracy metrics to evaluate the performance of the model. The first one is C-IPCW (inverse probability of censoring weighted) [<xref ref-type="bibr" rid="pcbi.1006076.ref019">19</xref>]. This metric aims to overcome the inaccuracy of the unweighted concordance index when censoring time is correlated with the patient’s hazard score. The second metric is Harrell’s concordance index (C-harrel) [<xref ref-type="bibr" rid="pcbi.1006076.ref020">20</xref>], which is an unweighted concordance index that evaluates the relative ordering of the samples, comparing the prognostic index (i.e., log hazard ratio) of each patient with the survival times. The third metric is the log-ranked p-value from Kaplan-Meier survival curves of two different survival risk groups. This is done by using the median Prognosis Index (PI), the output of Cox-nnet, to dichotomize the patients into high risk and low risk groups, similar to our earlier reports [<xref ref-type="bibr" rid="pcbi.1006076.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1006076.ref022">22</xref>]. A log-ranked p-value is then computed to differentiate the Kaplan-Meier survival curves from these two groups. It is worth noticing that the dichotomization of patients ignores the differences within each dichotomized group, thus may lead to less accuracy compared to C-index and IPCW metrics. Finally, the Integrated Brier Score (Brier) was also calculated. This score calculates the squared error between the predicted survival probability and the actual survival of patients at each time point [<xref ref-type="bibr" rid="pcbi.1006076.ref022">22</xref>–<xref ref-type="bibr" rid="pcbi.1006076.ref024">24</xref>].</p>
<p>The comparison of C-IPCW among the four methods over the 10 TCGA datasets is shown in <xref ref-type="fig" rid="pcbi.1006076.g002">Fig 2</xref>. Based on the C-IPCW score, Cox-nnet has better overall rankings than other methods (<xref ref-type="fig" rid="pcbi.1006076.g002">Fig 2B</xref>), but the improvement over Cox-PH is lacking statistically significance in most cases (<xref ref-type="fig" rid="pcbi.1006076.g002">Fig 2A</xref>). Note among the three penalization methods applied to Cox-PH, ridge penalization has the best overall accuracy (<xref ref-type="supplementary-material" rid="pcbi.1006076.s005">S5 Fig</xref>), and thus Cox-PH with ridge penalization is chosen to compare with the other methods. However, when using C-harrel (<xref ref-type="supplementary-material" rid="pcbi.1006076.s006">S6 Fig</xref>) and the log-rank p-value metrics (<xref ref-type="supplementary-material" rid="pcbi.1006076.s007">S7 Fig</xref>), Cox-nnet had significantly improved performance compared to all other methods. Based on the Brier score metric, Cox-nnet had significantly higher predictive accuracy compared to RF-S (<xref ref-type="supplementary-material" rid="pcbi.1006076.s008">S8 Fig</xref>). Overall, the other non-linear method (RF-S), an ensemble-based method consistently ranks worse than Cox-nnet and Cox-PH (<xref ref-type="fig" rid="pcbi.1006076.g002">Fig 2</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006076.s006">S6</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006076.s007">S7</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006076.s008">S8</xref> Figs).</p>
<fig id="pcbi.1006076.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006076.g002</object-id>
<label>Fig 2</label>
<caption>
<title/>
<p>A. Boxplot of the C-IPCW of the 10 TCGA datasets using four prognosis-predicting methods: Cox-nnet (dropout), CoxBoost, Cox-PH (ridge) and RF-S. The data were randomly split into 80% training and 20% testing sets, and repeated 10 times. Average C-IPCWs are presented as the metric. For “overall” condition, all 10 TCGA cancer datasets are combined as one “cancer” dataset. Sign * indicates statistical significance (p &lt; 0.05). B. Heatmap of the performance rank of each dataset, based on the order of the average C-IPCW scores. Ranks 1, 2, 3, and 4 indicate the descending performance of each computational method.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>Hidden layer nodes of Cox-nnet are surrogate prognostic features</title>
<p>To explore the biological relevance of the hidden nodes of Cox-nnet, we used the TCGA Kidney Renal Cell Carcinoma (KIRC) dataset as an example. We first extracted the contribution of each hidden node to the PI score for each patient (<xref ref-type="fig" rid="pcbi.1006076.g003">Fig 3A</xref>). The contribution was calculated as the output value of each hidden node weighted by the corresponding coefficient at the Cox regression output layer. As expected, the value of the hidden nodes strongly correlated to the PI score. However, there is still significant heterogeneity among the nodes, suggesting that individual nodes may reflect different biological processes.</p>
<fig id="pcbi.1006076.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006076.g003</object-id>
<label>Fig 3</label>
<caption>
<title/>
<p>A. Hidden node activation weighted by the corresponding Cox layer coefficients of the TCGA KIRC dataset. The columns represent individual patient scores, ordered by their Prognostic Index. The rows represent the node activations. B. t-SNE plot of the top 20 nodes (left) and t-SNE of differentially expressed genes between the two groups with low and high prognostic index, respecitively (right). C. Gene Set Enrichment Analysis: significantly enriched KEGG pathways of the top 20 hidden nodes (adjusted p-value &lt; 0.05).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.g003" xlink:type="simple"/>
</fig>
<p>We hypothesize that the top (most variable) nodes may serve as surrogate features to discriminate patient survival. To explore this idea, we selected the top 20 nodes with the highest variances and presented the patients PI scores using t-SNE (<xref ref-type="fig" rid="pcbi.1006076.g003">Fig 3B</xref>). t-SNE is a non-linear dimensionality reduction method that embeds high-dimensional datasets into a low dimensional space (usually two or three dimensions). This method has been widely used to visualize data with large number of features, by enhancing the separation among samples[<xref ref-type="bibr" rid="pcbi.1006076.ref025">25</xref>]. The hidden nodes represent a dimension reduction of the original data and they clearly discriminate samples by their PI scores, as shown by the t-SNE plot (<xref ref-type="fig" rid="pcbi.1006076.g003">Fig 3B</xref>, left). As comparison, we performed t-SNE using all differentially expressed genes of patients with low prognostic index and high prognostic index (<xref ref-type="fig" rid="pcbi.1006076.g003">Fig 3B</xref>, right). The t-SNE plots demonstrates that the nodes in Cox-nnet effectively capture the survival information. Therefore, the top node PI scores can be used as features for dimension reduction in survival analysis.</p>
</sec>
<sec id="sec006">
<title>Hidden layer nodes of Cox-nnet are associated with biological functions</title>
<p>To further explore the biological relevance of the top 20 hidden nodes, we conducted Gene Set Enrichment Analysis (GSEA) [<xref ref-type="bibr" rid="pcbi.1006076.ref026">26</xref>] using KEGG pathways [<xref ref-type="bibr" rid="pcbi.1006076.ref027">27</xref>], as described in the Methods section. Briefly, we calculated significantly enriched pathways using Pearson’s correlation between the log transformed gene expression input and the output score of each node across all patients in the KIRC dataset (<xref ref-type="fig" rid="pcbi.1006076.g003">Fig 3C</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006076.s012">S2 Table</xref>). We compared these enriched pathways to those from GSEA of the Cox-PH (ridge) model (<xref ref-type="supplementary-material" rid="pcbi.1006076.s013">S3 Table</xref>), the competing model with the second best prognosis prediction. A total of 110 (out of 187) significantly enriched pathways (<xref ref-type="supplementary-material" rid="pcbi.1006076.s012">S2 Table</xref>) were identified in at least one node, including seven pathways enriched in all 20 nodes that were not found by the Cox-PH method (<xref ref-type="table" rid="pcbi.1006076.t001">Table 1</xref>). In contrast, Cox-PH only identified 30 significantly enriched pathways using the same significance threshold. We also used the genes values from CoxBoost and RF-S, however they did not produce any significantly enriched pathways. Among the seven pathways enriched in all 20 nodes from Cox-nnet, the p53 signaling pathway stands out as an important biologically relevant pathway (<xref ref-type="supplementary-material" rid="pcbi.1006076.s009">S9 Fig</xref>), since it was shown to be highly prognostic of patient survival in kidney cancer [<xref ref-type="bibr" rid="pcbi.1006076.ref028">28</xref>].</p>
<table-wrap id="pcbi.1006076.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006076.t001</object-id>
<label>Table 1</label> <caption><title>Cox-nnet node-associated pathways.</title> <p>Significantly enriched pathways from common to all 20 hidden nodes that are not found in the Cox-PH Gene Set Enrichment Analysis (Adjusted P &lt; 0.05).</p></caption>
<alternatives>
<graphic id="pcbi.1006076.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Pathway</th>
<th align="left">P.value</th>
<th align="left">P.adjusted</th>
<th align="left">Nodes</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">KEGG adherens junction</td>
<td align="left">0.000</td>
<td align="left">0.001</td>
<td align="left">1-20</td>
</tr>
<tr>
<td align="left">KEGG endocytosis</td>
<td align="left">0.000</td>
<td align="left">0.001</td>
<td align="left">1-20</td>
</tr>
<tr>
<td align="left">KEGG insulin signaling pathway</td>
<td align="left">0.000</td>
<td align="left">0.001</td>
<td align="left">1-20</td>
</tr>
<tr>
<td align="left">KEGG lysine degradation</td>
<td align="left">0.000</td>
<td align="left">0.003</td>
<td align="left">1-20</td>
</tr>
<tr>
<td align="left">KEGG p53 signaling pathway</td>
<td align="left">0.000</td>
<td align="left">0.003</td>
<td align="left">1-20</td>
</tr>
<tr>
<td align="left">KEGG pyruvate metabolism</td>
<td align="left">0.000</td>
<td align="left">0.001</td>
<td align="left">1-20</td>
</tr>
<tr>
<td align="left">KEGG sphingolipid metabolism</td>
<td align="left">0.001</td>
<td align="left">0.005</td>
<td align="left">1-20</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Next, we estimated the predictive accuracies of the leading edge genes [<xref ref-type="bibr" rid="pcbi.1006076.ref027">27</xref>] enriched in the GSEA from Cox-nnet vs. those enriched in Cox-PH model. Leading edge genes are those genes in the pathway of interest that contribute positively to the enrichment score in GSEA. We used the C-IPCW of each leading edge gene, obtained from single-variable analysis (<xref ref-type="fig" rid="pcbi.1006076.g004">Fig 4</xref>). Collectively, leading edge genes from Cox-nnet have significantly higher C-IPCW scores (p = 1.253e-05) than those from Cox-PH, suggesting that Cox-nnet has selected more informative features. In order to visualize these gene level and pathway level differences between Cox-nnet and Cox-PH, we reconstructed a bipartite graph between leading edge genes for Cox-nnet or feature genes (for Cox-PH) and their corresponding enriched pathways (<xref ref-type="fig" rid="pcbi.1006076.g005">Fig 5</xref>). Besides the p53 pathway mentioned earlier that is specific to Cox-nnet, several other pathways, such as insulin signaling pathway, endocytosis and adherens junction, also have many more genes enriched in Cox-nnet. Among these genes specific to Cox-nnet, many have been previously reported to relevant to renal carcinoma development and prognosis, such as CASP9[<xref ref-type="bibr" rid="pcbi.1006076.ref027">27</xref>], TGFBR2[<xref ref-type="bibr" rid="pcbi.1006076.ref030">30</xref>], KDR (VEGFR)[<xref ref-type="bibr" rid="pcbi.1006076.ref031">31</xref>]. These results suggest that Cox-nnet model reveals richer biological information than Cox-PH.</p>
<fig id="pcbi.1006076.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006076.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Single variable C-IPCW scores of the leading edge genes from Cox-nnet and Cox-PH.</title>
<p>The leading edge genes are obtained using Gene-Set Enrichment Analysis, and they are genes contributing positively to the maximum value of the pathway enrichment score[<xref ref-type="bibr" rid="pcbi.1006076.ref029">29</xref>]. Cox-nnet has significantly higher C-IPCW scores (p = 1.253e-05).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.g004" xlink:type="simple"/>
</fig>
<fig id="pcbi.1006076.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006076.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Enriched pathway-gene bipartite network from the leading edge genes and significantly enriched pathways.</title>
<p>Significantly enriched pathways common to all 20 hidden nodes are labeled in green. Leading edge genes found uniquely in Cox-nnet are labeled in orange, and genes found in both Cox-nnet and Cox-PH are labeled in blue.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.g005" xlink:type="simple"/>
</fig>
<p>Additionally, we compared the partial derivative of the hidden nodes (rather than the Cox-nnet output), with respect to the input genes. We first calculated the gradient for each patient and calculated the average partial derivatives and replicated the GSEA analysis as for the previous analysis. However, we found that fewer pathways are significant, and are less relevant to cancer using this approach.</p>
</sec>
<sec id="sec007">
<title>Evaluation of gene input relative to survival in Cox-nnet</title>
<p>To further examine the importance of each gene relative to the survival outcome, we calculated the average partial derivative of the output of the model (i.e., the log hazard ratio) with respect to each input gene value across all patients. As demonstrated by the leading edge genes in seven common pathways of all nodes in Cox-nnet, the feature importance scores from Cox-nnet appear to be more biologically insightful compared to the feature importance values from the Cox-PH model (<xref ref-type="supplementary-material" rid="pcbi.1006076.s009">S9 Fig</xref>). For example, the feature importance for the BAI1 gene in the p53 pathway is much higher in the Cox-nnet model compared to the Cox-PH model. Corresponding to our finding, the BAI gene family was found to be involved in several types of cancers including renal cancer [<xref ref-type="bibr" rid="pcbi.1006076.ref032">32</xref>]. BAI1 acts as an inhibitor to angiogenesis and is transcriptionally regulated by p53 [<xref ref-type="bibr" rid="pcbi.1006076.ref033">33</xref>–<xref ref-type="bibr" rid="pcbi.1006076.ref036">36</xref>]. Its expression level was significantly decreased in tumor vs. normal kidney tissue, and was even lower in advanced stage renal carcinoma[<xref ref-type="bibr" rid="pcbi.1006076.ref037">37</xref>]. Mice kidney cancer models treated with BAI1 showed slower tumor growth and proliferation [<xref ref-type="bibr" rid="pcbi.1006076.ref036">36</xref>]. Additionally, the MAPK1 gene (also known as ERK2), annotated in two pathways identified by Cox-nnet (the Adherens Junction and Insulin Signaling pathway), has a much higher feature importance score in Cox-nnet compared to Cox-PH. MAPK1 is one of the key kinases in intra-cellular transduction, and was found constitutively activated in renal cell carcinoma [<xref ref-type="bibr" rid="pcbi.1006076.ref038">38</xref>]. Drugs inhibiting the MAPK cascade have been targeted for development[<xref ref-type="bibr" rid="pcbi.1006076.ref039">39</xref>]. We list the top 20 genes from each method in <xref ref-type="supplementary-material" rid="pcbi.1006076.s014">S4 Table</xref>.</p>
</sec>
</sec>
<sec id="sec008" sec-type="conclusions">
<title>Discussion</title>
<p>We have implemented Cox-nnet, a new ANN method, to predict patient survival from high throughput omics data. Cox-nnet is an alternative to the standard Cox-PH regression, enabling automatic discovery of biological features at both the pathway and gene levels. The hidden nodes in the Cox-nnet model have distinct activation patterns, and can serve as surrogate features for survival-sensitive dimension reduction. More significantly enriched KEGG pathways that correlate with top nodes in Cox-nnet are identified, as compared to those from the Cox-PH model, suggesting that Cox-nnet reveals more relevant biological information. We show how a critical pathway for renal cancer development, p53 pathway is identified only by cox-nnet but not Cox-PH model in TCGA KIRC dataset. Other pathways, including insulin signaling pathway, endocytosis and adherens junction, have many more genes enriched by Cox-nnet. Moreover, leading edge genes obtained from these KEGG pathways identified as enriched by Cox-nnet (which are a fraction of the gene features considered by the model) have collectively higher associations with survival. Enrichment analysis on the top genes from Random Forest and CoxBoost did not produce any significant pathways. As a promising new predictive method for prognosis, the current Cox-nnet implementation has some limitations. Its architecture is relatively simple, including one or two hidden layers and an output Cox regression layer. It is possible to incorporate other more sophisticated architecture into the model, such as including more layers of neurons or more sophisticated hidden layers. However, deeper ANN is not necessarily more beneficial (<xref ref-type="supplementary-material" rid="pcbi.1006076.s003">S3 Fig</xref>), when compared to the regularization methods. This suggests that ANN may overfit the small size of the genomics data tested. New variations of neural networks, such as convolutional neural network approach or a recurrent network approach as those reported showed good performance in processing imaging or other types of positional data [<xref ref-type="bibr" rid="pcbi.1006076.ref040">40</xref>], and they could be used as input to a proportional hazards output layer. Additionally, it is possible to embed <italic>a priori</italic> biological pathway information into the network architecture, e.g., by connecting genes in a pathway to a common node in the next hidden layer of neurons [<xref ref-type="bibr" rid="pcbi.1006076.ref015">15</xref>]. In the future, we plan to further analyze how different neural network architectures affect the performance of Cox-nnet and compare the biological insights from the various models.</p>
</sec>
<sec id="sec009" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec010">
<title>Datasets</title>
<p>We analyzed 10 TCGA datasets which were combined into a pan-cancer dataset. The TCGA datasets included the following cancer types: Bladder Urothelial Carcinoma (BLCA), Breast invasive carcinoma (BRCA), Head and Neck squamous cell carcinoma (HNSC), Kidney renal clear cell carcinoma (KIRC), Brain Lower Grade Glioma (LGG), Liver hepatocellular carcinoma (LIHC), Lung adenocarcinoma (LUAD), Lung squamous cell carcinoma (LUSC), Ovarian serous cystadenocarcinoma (OV) and Stomach adenocarcinoma (STAD). RNA-Seq expression and clinical data were downloaded from the Broad Institute GDAC [<xref ref-type="bibr" rid="pcbi.1006076.ref041">41</xref>]. Overall survival time and censoring information were extracted from the clinical follow-up data. Raw count data were normalized using the DESeq2 R package [<xref ref-type="bibr" rid="pcbi.1006076.ref017">17</xref>] and then log-transformed. Datasets were selected from TCGA based on the following criteria: &gt; 300 samples with both RNASeq and survival data and &gt; 50 survival events. In total, 5031 patient samples were used (see <xref ref-type="supplementary-material" rid="pcbi.1006076.s011">S1 Table</xref> for a patient tabulation by individual dataset).</p>
</sec>
<sec id="sec011">
<title>Cox-PH, CoxBoost and Random Forest Survival (RF-S) models</title>
<p>Cox-nnet is an extension to the Cox-PH model. Individual hazard, an instantaneous measure of the likelihood of an event, is estimated based on a set of features [<xref ref-type="bibr" rid="pcbi.1006076.ref017">17</xref>]. The hazard function is:
<disp-formula id="pcbi.1006076.e001">
<alternatives>
<graphic id="pcbi.1006076.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006076.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mspace width="0.25em"/><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
<disp-formula id="pcbi.1006076.e002">
<alternatives>
<graphic id="pcbi.1006076.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006076.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="bold-italic">β</mml:mi>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula></p>
<p>Where <bold><italic>θ</italic></bold><sub><bold><italic>i</italic></bold></sub> is the log hazard ratio for patient <bold><italic>i</italic></bold>. This model uses partial log-likelihood as the cost function
<disp-formula id="pcbi.1006076.e003">
<alternatives>
<graphic id="pcbi.1006076.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006076.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mi mathvariant="bold-italic">o</mml:mi><mml:mi mathvariant="bold-italic">g</mml:mi><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mstyle><mml:mrow><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula></p>
<p>Since gene expression data have tens of thousands in initial features, penalization methods are usually implemented along with Cox-PH. We experimented with 3 penalization methods, namely LASSO (L1 norm), ridge (L2 norm), and mimimax concave penalty (MCP). MCP attempts to moderate the biased large penalty for large coefficients in LASSO [<xref ref-type="bibr" rid="pcbi.1006076.ref017">17</xref>] (<xref ref-type="supplementary-material" rid="pcbi.1006076.s005">S5 Fig</xref>). MCP reduces the regularization for large coefficients and plateaus at a value selected through cross-validation. LASSO and ridge regularization were performed using the Glmnet R package [<xref ref-type="bibr" rid="pcbi.1006076.ref042">42</xref>] and the MCP regularization was performed with the Ncvreg R package [<xref ref-type="bibr" rid="pcbi.1006076.ref043">43</xref>].</p>
<p>CoxBoost, is an iterative “gradient boosting” method modified from the Cox-PH model [<xref ref-type="bibr" rid="pcbi.1006076.ref044">44</xref>]. In CoxBoost, parameters are separated into individual partitions, and the partition that leads to the largest improvement in the penalized partial log likelihood is selected for that iteration. In subsequent boosting iteration, the model selects another block and refits those parameters by maximizing the penalized likelihood function. In this method, the number of boosting iterations is used as the complexity parameter in CoxBoost and optimized via cross-validation (CV).</p>
<p>Random Forests Survival (RF-S) is a tree-based, non-linear, ensemble method [<xref ref-type="bibr" rid="pcbi.1006076.ref001">1</xref>], rather than a proportional hazards model. For each tree in the forest, samples are boostrapped, and at each node in a tree, features are boostrapped, and the node is split by selecting the feature that maximizes the log-rank statistic. At the leaf nodes, the cumulative hazard function (CHF) is estimated and a patient’s CHF is calculated as an average over all the trees in the ensemble.</p>
</sec>
<sec id="sec012">
<title>Cox-nnet</title>
<p>Cox-nnet is a neural network whose output layer is a cox regression. In a Cox-nnet model, <bold><italic>x</italic></bold><sub><bold><italic>i</italic></bold></sub> in Eq (<xref ref-type="disp-formula" rid="pcbi.1006076.e002">2</xref>) is replaced by the output of the hidden layer, and the linear predictor is:
<disp-formula id="pcbi.1006076.e004">
<alternatives>
<graphic id="pcbi.1006076.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006076.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">β</mml:mi>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula></p>
<p>Where <bold><italic>W</italic></bold> is the coefficient weight matrix between the input and hidden layer with the size H x J, <bold><italic>b</italic></bold> is the bias term for each hidden node and <bold><italic>G</italic></bold> is the activation function (applied element-wise on a vector).</p>
<p>In this manuscript, the tanh activation function is used:
<disp-formula id="pcbi.1006076.e005">
<alternatives>
<graphic id="pcbi.1006076.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006076.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula></p>
<p>Subsequently, the partial log likelihood in Eq (<xref ref-type="disp-formula" rid="pcbi.1006076.e003">3</xref>) is extended by a ridge regularization term:
<disp-formula id="pcbi.1006076.e006">
<alternatives>
<graphic id="pcbi.1006076.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006076.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="normal">λ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula></p>
<p>In addition to ridge regularization, we also employ dropout regularization (2). This approach has been shown to reduce overfitting and improve performance over other regularization schemes[<xref ref-type="bibr" rid="pcbi.1006076.ref045">45</xref>]. In dropout, a hyperparameter <italic>p</italic> is the probability of retaining nodes during each iteration of training. I.e., the activation of each node is set to zero with probability <italic>1-p</italic>. The optimal parameter is determined through CV on the training set, using C-index as the performance metric [<xref ref-type="bibr" rid="pcbi.1006076.ref002">2</xref>]. A complete description of the hyperparameters and optimization approaches for each method is shown in <xref ref-type="supplementary-material" rid="pcbi.1006076.s015">S5 Table</xref>. Briefly, we used 5-fold cross-validation and grid search to optimize parameters in Cox-nnet.</p>
<p>In neural networks, because of the large amount of parameters and hyperparameters, overfitting is a potential problem. In Cox-nnet, we experimented with three regularization approaches given previous guidelines: ridge, dropout and combination of ridge and dropout. Ridge regularization is one of the most common methods to reduce overfitting, recommended by Demuth et al. [<xref ref-type="bibr" rid="pcbi.1006076.ref003">3</xref>]. In this scheme, the L2 norm of all the weights are added to the cost function of the model, leading to a “weight decay” term in the gradient. Dropout is a recent regularization method for networks, inspired by Bayesian analysis on weighted averages of different network architectures to improve the model performance [<xref ref-type="bibr" rid="pcbi.1006076.ref004">4</xref>]. In dropout networks, each training iteration uses different network architecture; nodes are randomly deactivated from the network during training based on a probability hyperparameter between 0 and 1. Instead of entire models being reweighted, the output of each node is reweighted during evaluation. This method was previously shown to perform better than other regularization methods, such as ridge regularization [<xref ref-type="bibr" rid="pcbi.1006076.ref017">17</xref>]. Our results on Cox-nnet confirmed this earlier conclusion. Also similar to a previous study, we found that additional complexity of combining dropout and ridge regularization does not yield better performance [<xref ref-type="bibr" rid="pcbi.1006076.ref017">17</xref>].</p>
</sec>
<sec id="sec013">
<title>Implementation of Cox-nnet</title>
<p>We implement Cox-nnet in Python with Theano package, a package for automatic differentiation that is widely used for designing neural networks. Cox-nnet is trained through back propagation. The partial log likelihood is usually written as two summations (one nested within the other) conditioned on survival time and censoring status (<xref ref-type="disp-formula" rid="pcbi.1006076.e003">Eq 3</xref>). Because the partial log likelihood is usually written as a nested summation, one may write a program to calculate the partial log likelihood using nested loops. However, these types of operations are very slow in Theano, whereas matrix operations are very fast. Therefore, it is imperative to convert the usual form of the partial log likelihood into a mathematically equivalent form using matrix multiplication. First, we define an indicator matrix <bold><italic>R</italic></bold> with elements:
<disp-formula id="pcbi.1006076.e007">
<alternatives>
<graphic id="pcbi.1006076.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006076.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula></p>
<p>We also define an indicator vector <bold><italic>C</italic></bold> with elements given by the censoring of each patient. An operation using <bold><italic>R</italic></bold> replaces the conditional sum over <italic>t</italic><sub><italic>i</italic></sub> ≥ <italic>t</italic><sub><italic>j</italic></sub>, and an operation using <bold><italic>C</italic></bold> replaces the conditional sum over <bold><italic>C</italic></bold>(<bold><italic>i</italic></bold>) = <bold>1</bold> in <xref ref-type="disp-formula" rid="pcbi.1006076.e004">Eq 4</xref>. For the models trained in this manuscript, the number of iterations was fixed at 1e4. The learning rate was initialized at 0.1, and decayed exponentially by a factor of 0.9 if the loss did not decrease. The number of hidden nodes in the hidden layer is chosen to be the square root of the number of input nodes, following the “pyramid” rule of thumb [<xref ref-type="bibr" rid="pcbi.1006076.ref021">21</xref>]. The optimization strategy used was Nesterov accelerated gradient [<xref ref-type="bibr" rid="pcbi.1006076.ref041">41</xref>]. For the two hidden layer neural network, we used the same number of hidden nodes as the single hidden layer model in both the first and second hidden layers.</p>
<p>Many functions are implemented to make it easier to train and evaluate models for survival analysis, including CVSearch, CVProfile, CrossValidation, and TrainCoxMlp (<xref ref-type="supplementary-material" rid="pcbi.1006076.s001">S1 Fig</xref>). CVSearch, CVProfile, CrossValidation are methods that perform CV to find the optimal regularization parameter. TrainCoxMlp performs optimization of coefficients on the regularized partial log likelihood function.</p>
<p>The source code of cox-nnet can be found at: <ext-link ext-link-type="uri" xlink:href="https://github.com/lanagarmire/cox-nnet" xlink:type="simple">https://github.com/lanagarmire/cox-nnet</ext-link>, and can be installed through the Python Package Index (PyPI). Documentation of package can be found at <ext-link ext-link-type="uri" xlink:href="http://garmiregroup.org/cox-nnet/docs/" xlink:type="simple">http://garmiregroup.org/cox-nnet/docs/</ext-link>. An example of analyzing Cox-nnet through R can be found at: <ext-link ext-link-type="uri" xlink:href="http://garmiregroup.org/cox-nnet/docs/examples/#interfacing-and-analysis-with-r" xlink:type="simple">http://garmiregroup.org/cox-nnet/docs/examples/#interfacing-and-analysis-with-r</ext-link></p>
<p>Cox-nnet can be run on multiple threads or a Graphics Processing Unit (GPU), an advantage of the Theano framework. We measured the running time on the KIRC dataset and re-measured it 5 times. The computational time for Cox-nnet included model compilation time and cross validation time to optimize dropout.</p>
</sec>
<sec id="sec014">
<title>Model evaluation</title>
<p>To evaluate the performance of all methods, we resampled the data 10 times. In each resampling iteration, we trained each model on 80% of the samples for each dataset (chosen randomly) and evaluated the performance on the 20% holdout test set. The output of Cox-PH, Cox-nnet and CoxBoost are the log hazard ratios (i.e., Prognosis Index, or PI) for each patient. The hazard ratio describes the relative risk of a patient compared to a non-parametric baseline. In contrast, the output of RF-S is an estimation of the survival time for each patient. We use C-index, IPCW [<xref ref-type="bibr" rid="pcbi.1006076.ref017">17</xref>], log-ranked p-value and Brier score to measure the accuracy performance of each model. We also compare running time of each model (<xref ref-type="supplementary-material" rid="pcbi.1006076.s004">S4B Fig</xref>).</p>
<p>C-index: is a measure of how well the model prediction corresponds to the ranking of the survival data [<xref ref-type="bibr" rid="pcbi.1006076.ref017">17</xref>]. It is calculated for censored survival data, which evaluates a value between 0 and 1, with 0.5 equivalent to a random process. The C-index can be computed as a summation over all events in the dataset, where patients with a higher survival time and lower log hazard ratios (and conversely patients with a lower survival time but higher log hazard ratios) are considered concordant.</p>
<p>C-IPCW (Inverse Probability of Censoring Weighting): it is a method that takes into account the censoring probability in the concordance index, by weighting pairs of patients in the calculation based on the inverse of their individual probabilities to be censored [<xref ref-type="bibr" rid="pcbi.1006076.ref017">17</xref>]. In this manuscript, we use the Kaplan-Meier estimate of censorship.</p>
<p>log-ranked p-value: a PI cutoff threshold is used to dichotomize the patients in the data set into higher and lower risk groups, similar to our earlier report [<xref ref-type="bibr" rid="pcbi.1006076.ref046">46</xref>]. A log-ranked p-value is then computed to differentiate the Kaplan-Meier survival curves between the higher vs. lower risk groups. In this report, we used the median log hazard ratio as the cutoff threshold.</p>
<p>Brier-score: the Brier-score is the mean square error of the difference between the probability of an event and the event value (1 or 0). The integrated Brier score was used as the performance metric, which is the Brier score averaged over the time interval of the dataset.</p>
<p>Running-time: Cox-nnet can be run on multiple threads or a Graphics Processing Unit (GPU), an advantage of the Theano framework. We measured the running time on the KIRC dataset, and re-measured it 5 times. The computational time for Cox-nnet included model compilation time and cross validation time to optimize dropout.</p>
</sec>
<sec id="sec015">
<title>Feature evaluation</title>
<p>For computing the importance of a feature in Cox-nnet, we use a method of partial derivatives [<xref ref-type="bibr" rid="pcbi.1006076.ref019">19</xref>]. For each patient, we compute the partial derivatives of each linear output of the model (e.g., the log hazard ratio) with respect to the input. The average of the partial derivatives over each input across all patient samples is calculated as the feature score. As comparison, we also compute the partial derivatives of each hidden layer node with respect to the inputs.</p>
</sec>
<sec id="sec016">
<title>t-SNE clustering</title>
<p>T-distributed stochastic neighbor embedding (t-SNE) is a non-linear dimensionality reduction method that is commonly used for visualizing high-dimensional data [<xref ref-type="bibr" rid="pcbi.1006076.ref020">20</xref>]. We selected the top 20 nodes of the Cox-nnet model with the highest variances, and clustered the patient samples using t-SNE. To do this, we used the tsne package in R [<xref ref-type="bibr" rid="pcbi.1006076.ref047">47</xref>]. As comparison, we also plot t-SNE based on the top 33% and bottom 33% of patients as determined by the prognostic index. A total of 8467 and 5805 genes were deemed significantly up and down regulated respectively in the KIRC dataset, using DESeq2 for differential expression analysis.</p>
</sec>
<sec id="sec017">
<title>Gene Set Enrichment Analysis (GSEA)</title>
<p>We performed GSEA on the correlation of normalized log gene expression to the node output (for Cox-nnet) or the model output (for Cox-PH, Random Forest and CoxBoost), across all patients in the KIRC dataset. Using the fgsea package in R [<xref ref-type="bibr" rid="pcbi.1006076.ref048">48</xref>], we calculated statistical significance of the KEGG pathways by performing 10,000 permutations, followed by multiple hypothesis testing with Benjamini Hochberg adjustment.</p>
</sec>
<sec id="sec018">
<title>Statistical testing between model performances</title>
<p>To test for statistical significance between the performance of Cox-nnet and other methods, we use the “multcomp” package in R to perform multiple linear hypothesis testing, with the method as the factor of interest, and the iteration number (used to control the random sampling seed in each 80%/20% split) as a covariate. We then perform multiple comparisons that compare Cox-nnet with the other methods, and adjust for multiple hypothesis testing with the Benjamini Hochberg procedure [<xref ref-type="bibr" rid="pcbi.1006076.ref020">20</xref>]. We apply this statistical approach to all performance metrics (C-harrell, C-IPCW, log-rank, and brier score).</p>
</sec>
<sec id="sec019">
<title>Simulation</title>
<p>overfitting in Cox-nnet may come from patient censoring. To investigate this, we ran a simulation RNA-Seq dataset. We used the ssizeRNA package in R to generate simulated RNA-Seq data counts in R [<xref ref-type="bibr" rid="pcbi.1006076.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1006076.ref024">24</xref>]. We generated four sub-groups of 200 patients each (a total of 800 patient samples) with 1000 genes, among which 20% of the genes are differentially expressed for each group. The prognosis index for patients in each group was randomly generated based on expression of 100 randomly selected genes, and the survival times were sampled based on the Weibull survival distribution. Censoring times were chosen from the exponential distribution with rate = 0.05. We randomly generated this dataset 100 times and estimated the performance metrics on 20% holdout test-sets. We compared C-index and IPCW metrics with censoring to uncensored C-index (<xref ref-type="supplementary-material" rid="pcbi.1006076.s010">S10 Fig</xref>). Neural network-based Cox-nnet and tree-based Random Forest survival do not differ significantly from Cox-PH models. This may be due to the simplification in the simulated data. For example, the simulated gene-expression does not have common biological functions and embedded co-linearability as shown in TCGA data.</p>
</sec>
</sec>
<sec id="sec020">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006076.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Overview of the structure, methods and classes in the Cox-nnet package.</title>
<p>The arrows in the workflow point from each module to the output of that module. “Model Predictions” and “Var. Importance Score” are the output of Cox-nnet package.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006076.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title/>
<p>A. Boxplot of C-IPCW of the 10 TCGA datasets among various penalization approaches in Cox-nnet one hidden layer (ridge, drop-out and ridge combined with dropout). Cox-nnet with Ridge and Dropout is optimized based on 5-fold cross-validation. Cox-nnet parameterizations with Ridge and Dropout are optimized based on a single validation set. Each dataset is randomly split into 80% training and 20% testing sets and resampled 10 times to calculate the average performance of each approach. B. Performance rank of each regularization approach, ordered by their average performance in each dataset.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006076.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title/>
<p>A. Boxplot of C-IPCW of the 10 TCGA datasets comparing zero, one and two hidden layers. Each model was optimized with 5-fold cross-validation. Each dataset is randomly split into 80% training and 20% testing sets and resampled 10 times to calculate the average performance of each approach. B. Performance rank of each regularization approach, ordered by the average C-IPCW scores in each dataset. *: P &lt; 0.05.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006076.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title/>
<p>A: comparison of descent methods on the TCGA KIRC dataset. The change in cost function is evaluated over 100,000 iterations for three methods: gradient descent, momentum gradient descent and the Nesterov accelerated gradient. B: Boxplots comparing Cox-nnet (CPU and GPU), Cox-PH, Cox-boost and Random Forest (RS-F) running time on the same dataset.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006076.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title/>
<p>A. Boxplot of C-IPCW of the 10 TCGA datasets comparing Cox-PH regularization methods (LASSO, Ridge and MCP). Each model is optimized with 5-fold cross-validation. Each dataset is randomly split into 80% training and 20% testing sets and resampled 10 times to calculate the average performance of each approach. B. Performance rank of each regularization approach, ordered by the average C-IPCW scores in each dataset. *: P &lt; 0.05.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006076.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Boxplot of the C-harrel of the 10 TCGA datasets using four prognosis-predicting methods: Cox-nnet (dropout), CoxBoost, Cox-PH (ridge) and RF-S.</title>
<p>The data are randomly split into 80% training and 20% testing sets, and repeated 10 times to calculate the average C-harrel values in each approach. *: P &lt; 0.05.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006076.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title/>
<p>A. Bar plots of Log-rank p-values of the 10 TCGA datasets. The log rank p-values are calculated first splitting the patients by median prognostic index in the testing data set, in order to compare the survival distributions between the high and low risk groups. The data are randomly split into 80% training and 20% testing sets, and repeated 10 times to calculate the average log-rank p-values in each approach. *: P &lt; 0.05. B. Kaplan-Meier plots from one exemplary repeat showing survival differences between the high and low risk groups. Note that due to dichotomization, log-rank p-values vary much widely compared to other performance metrics.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006076.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Boxplot of the Brier score of the 10 TCGA datasets using four prognosis-predicting methods: Cox-nnet (dropout), CoxBoost, Cox-PH (ridge) and RF-S.</title>
<p>The data are randomly split into 80% training and 20% testing sets and repeated 10 times to calculate the average Brier scores in each approach. *: P &lt; 0.05.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006076.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Variable importance of the common leading edge genes of enriched KEGG pathways.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006076.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.s010" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>RNA-Seq survival simulation results showing the performance over 100 simulated datasets comparing the C-index, IPCW metric and the uncensored concordance.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006076.s011" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.s011" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Tabulation of TCGA patients by individual dataset.</title>
<p>Event = 1 indicates death.</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006076.s012" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.s012" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Significantly enriched pathways from the Cox-nnet method (P &lt; 0.05).</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006076.s013" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.s013" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Significantly enriched pathways from the Cox-PH method (P &lt; 0.05).</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006076.s014" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.s014" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>Top 20 genes from the four survival methods compared.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006076.s015" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006076.s015" xlink:type="simple">
<label>S5 Table</label>
<caption>
<title>Description of hyperparameters in each method and their method of optimization.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors would like to thank Dr. Garmire’s group members for helpful discussion on this project.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006076.ref001"><label>1</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Therneau</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Grambsch</surname> <given-names>PM</given-names></name>. <source>Modeling survival data: extending the Cox model</source>: <publisher-name>Springer Science &amp; Business Media</publisher-name>; <year>2000</year>.</mixed-citation></ref>
<ref id="pcbi.1006076.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Breheny</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>J</given-names></name>. <article-title>Coordinate descent algorithms for nonconvex penalized regression, with applications to biological feature selection</article-title>. <source>The annals of applied statistics</source>. <year>2011</year>;<volume>5</volume>(<issue>1</issue>):<fpage>232</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/10-AOAS388" xlink:type="simple">10.1214/10-AOAS388</ext-link></comment> <object-id pub-id-type="pmid">22081779</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref003"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Binder H. CoxBoost: Cox models by likelihood based boosting for a single survival endpoint or competing risks. R package version. 2013;1.</mixed-citation></ref>
<ref id="pcbi.1006076.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ishwaran</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kogalur</surname> <given-names>UB</given-names></name>, <name name-style="western"><surname>Blackstone</surname> <given-names>EH</given-names></name>, <name name-style="western"><surname>Lauer</surname> <given-names>MS</given-names></name>. <article-title>Random survival forests</article-title>. <source>The Annals of Applied Statistics</source>. <year>2008</year>:<fpage>841</fpage>–<lpage>60</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006076.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McCulloch</surname> <given-names>WS</given-names></name>, <name name-style="western"><surname>Pitts</surname> <given-names>W</given-names></name>. <article-title>A logical calculus of the ideas immanent in nervous activity</article-title>. <source>The bulletin of mathematical biophysics</source>. <year>1943</year>;<volume>5</volume>(<issue>4</issue>):<fpage>115</fpage>–<lpage>33</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006076.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>LeCun</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bengio</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>G</given-names></name>. <article-title>Deep learning</article-title>. <source>Nature</source>. <year>2015</year>;<volume>521</volume>(<issue>7553</issue>):<fpage>436</fpage>–<lpage>44</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature14539" xlink:type="simple">10.1038/nature14539</ext-link></comment> <object-id pub-id-type="pmid">26017442</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ching</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Himmelstein</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Beaulieu-Jones</surname> <given-names>BK</given-names></name>, <name name-style="western"><surname>Kalinin</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Do</surname> <given-names>BT</given-names></name>, <name name-style="western"><surname>Way</surname> <given-names>GP</given-names></name>, <etal>et al</etal>. <article-title>Opportunities And Obstacles For Deep Learning In Biology And Medicine</article-title>. <source>bioRxiv</source>. <year>2017</year>:<fpage>142760</fpage>.</mixed-citation></ref>
<ref id="pcbi.1006076.ref008"><label>8</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Jones</surname> <given-names>N</given-names></name>. <chapter-title>The learning machines</chapter-title>. <publisher-name>Nature Publishing Group</publisher-name> <publisher-loc>MACMILLAN BUILDING, 4 CRINAN ST, LONDON N1 9XW, ENGLAND</publisher-loc>; <year>2014</year>.</mixed-citation></ref>
<ref id="pcbi.1006076.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alipanahi</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Delong</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Weirauch</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Frey</surname> <given-names>BJ</given-names></name>. <article-title>Predicting the sequence specificities of DNA-and RNA-binding proteins by deep learning</article-title>. <source>Nature biotechnology</source>. <year>2015</year>;<volume>33</volume>(<issue>8</issue>):<fpage>831</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.3300" xlink:type="simple">10.1038/nbt.3300</ext-link></comment> <object-id pub-id-type="pmid">26213851</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref010"><label>10</label><mixed-citation publication-type="other" xlink:type="simple">Cireşan DC, Giusti A, Gambardella LM, Schmidhuber J, editors. Mitosis detection in breast cancer histology images with deep neural networks. International Conference on Medical Image Computing and Computer-assisted Intervention; 2013: Springer.</mixed-citation></ref>
<ref id="pcbi.1006076.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Faraggi</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Simon</surname> <given-names>R</given-names></name>. <article-title>A neural network model for survival data</article-title>. <source>Statistics in medicine</source>. <year>1995</year>;<volume>14</volume>(<issue>1</issue>):<fpage>73</fpage>–<lpage>82</lpage>. <object-id pub-id-type="pmid">7701159</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Petalidis</surname> <given-names>LP</given-names></name>, <name name-style="western"><surname>Oulas</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Backlund</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wayland</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Plant</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Improved grading and survival prediction of human astrocytic brain tumors by artificial neural network analysis of gene expression microarray data</article-title>. <source>Molecular cancer therapeutics</source>. <year>2008</year>;<volume>7</volume>(<issue>5</issue>):<fpage>1013</fpage>–<lpage>24</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1158/1535-7163.MCT-07-0177" xlink:type="simple">10.1158/1535-7163.MCT-07-0177</ext-link></comment> <object-id pub-id-type="pmid">18445660</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chi</surname> <given-names>C-L</given-names></name>, <name name-style="western"><surname>Street</surname> <given-names>WN</given-names></name>, <name name-style="western"><surname>Wolberg</surname> <given-names>WH</given-names></name>, <article-title>editors. Application of artificial neural network-based survival analysis on two breast cancer datasets</article-title>. <source>AMIA Annual Symposium Proceedings</source>; <year>2007</year>: American Medical Informatics Association.</mixed-citation></ref>
<ref id="pcbi.1006076.ref014"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Joshi R, Reeves C, editors. Beyond the Cox model: artificial neural networks for survival analysis part II. Proceedings of the eighteenth international conference on systems engineering; 2006.</mixed-citation></ref>
<ref id="pcbi.1006076.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lin</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Jain</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bar-Joseph</surname> <given-names>Z</given-names></name>. <article-title>Using neural networks for reducing the dimensions of single-cell RNA-Seq data</article-title>. <source>Nucleic Acids Res</source>. <year>2017</year>;<volume>45</volume>(<issue>17</issue>):<fpage>e156</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkx681" xlink:type="simple">10.1093/nar/gkx681</ext-link></comment> <object-id pub-id-type="pmid">28973464</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Al-Rfou</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Alain</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Almahairi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Angermueller</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bahdanau</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ballas</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Theano: A Python framework for fast computation of mathematical expressions</article-title>. arXiv preprint arXiv:160502688. <year>2016</year>.</mixed-citation></ref>
<ref id="pcbi.1006076.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Srivastava</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Krizhevsky</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sutskever</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Salakhutdinov</surname> <given-names>R</given-names></name>. <article-title>Dropout: a simple way to prevent neural networks from overfitting</article-title>. <source>Journal of Machine Learning Research</source>. <year>2014</year>;<volume>15</volume>(<issue>1</issue>):<fpage>1929</fpage>–<lpage>58</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006076.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Qian</surname> <given-names>N</given-names></name>. <article-title>On the momentum term in gradient descent learning algorithms</article-title>. <source>Neural networks</source>. <year>1999</year>;<volume>12</volume>(<issue>1</issue>):<fpage>145</fpage>–<lpage>51</lpage>. <object-id pub-id-type="pmid">12662723</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref019"><label>19</label><mixed-citation publication-type="other" xlink:type="simple">Bengio Y, Boulanger-Lewandowski N, Pascanu R, editors. Advances in optimizing recurrent networks. Acoustics, Speech and Signal Processing (ICASSP), 2013 IEEE International Conference on; 2013: IEEE.</mixed-citation></ref>
<ref id="pcbi.1006076.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gerds</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Kattan</surname> <given-names>MW</given-names></name>, <name name-style="western"><surname>Schumacher</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>C</given-names></name>. <article-title>Estimating a time‐dependent concordance index for survival prediction models with covariate dependent censoring</article-title>. <source>Statistics in Medicine</source>. <year>2013</year>;<volume>32</volume>(<issue>13</issue>):<fpage>2173</fpage>–<lpage>84</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/sim.5681" xlink:type="simple">10.1002/sim.5681</ext-link></comment> <object-id pub-id-type="pmid">23172755</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koziol</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Jia</surname> <given-names>Z</given-names></name>. <article-title>The concordance index C and the Mann–Whitney parameter Pr (X&gt; Y) with randomly censored data</article-title>. <source>Biometrical Journal</source>. <year>2009</year>;<volume>51</volume>(<issue>3</issue>):<fpage>467</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/bimj.200800228" xlink:type="simple">10.1002/bimj.200800228</ext-link></comment> <object-id pub-id-type="pmid">19588452</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wei</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>De Vivo</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Risch</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Moore</surname> <given-names>JH</given-names></name>, <etal>et al</etal>. <article-title>Meta-dimensional data integration identifies critical pathways for susceptibility, tumorigenesis and progression of endometrial cancer</article-title>. <source>Oncotarget</source>. <year>2016</year>.</mixed-citation></ref>
<ref id="pcbi.1006076.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Yee</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ching</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Garmire</surname> <given-names>LX</given-names></name>. <article-title>A Novel Model to Combine Clinical and Pathway-Based Transcriptomic Information for the Prognosis Prediction of Breast Cancer</article-title>. <source>PLoS computational biology</source>. <year>2014</year>;<volume>10</volume>(<issue>9</issue>):<fpage>e1003851</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003851" xlink:type="simple">10.1371/journal.pcbi.1003851</ext-link></comment> <object-id pub-id-type="pmid">25233347</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Chong</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Lewis</surname> <given-names>NE</given-names></name>, <name name-style="western"><surname>Jia</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Garmire</surname> <given-names>LX</given-names></name>. <article-title>Novel personalized pathway-based metabolomics models reveal key metabolic pathways for breast cancer diagnosis</article-title>. <source>Genome medicine</source>. <year>2016</year>;<volume>8</volume>(<issue>1</issue>):<fpage>1</fpage>.</mixed-citation></ref>
<ref id="pcbi.1006076.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Graf</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Schmoor</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sauerbrei</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Schumacher</surname> <given-names>M</given-names></name>. <article-title>Assessment and comparison of prognostic classification schemes for survival data</article-title>. <source>Statistics in medicine</source>. <year>1999</year>;<volume>18</volume>(<issue>17‐18</issue>):<fpage>2529</fpage>–<lpage>45</lpage>. <object-id pub-id-type="pmid">10474158</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lvd</surname> <given-names>Maaten</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>G</given-names></name>. <article-title>Visualizing data using t-SNE</article-title>. <source>Journal of Machine Learning Research</source>. <year>2008</year>;<volume>9</volume>(Nov):<fpage>2579</fpage>–<lpage>605</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006076.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Subramanian</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tamayo</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Mootha</surname> <given-names>VK</given-names></name>, <name name-style="western"><surname>Mukherjee</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ebert</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Gillette</surname> <given-names>MA</given-names></name>, <etal>et al</etal>. <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2005</year>;<volume>102</volume>(<issue>43</issue>):<fpage>15545</fpage>–<lpage>50</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006076.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sergushichev</surname> <given-names>A</given-names></name>. <article-title>An algorithm for fast preranked gene set enrichment analysis using cumulative statistic calculation</article-title>. <source>bioRxiv</source>. <year>2016</year>:<fpage>060012</fpage>.</mixed-citation></ref>
<ref id="pcbi.1006076.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Girgin</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Tarhan</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>seyin</surname> <given-names>u</given-names></name>, <name name-style="western"><surname>Hekimgil</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sezer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gürel</surname> <given-names>G</given-names></name>. <article-title>P53 mutations and other prognostic factors of renal cell carcinoma</article-title>. <source>Urologia internationalis</source>. <year>2001</year>;<volume>66</volume>(<issue>2</issue>):<fpage>78</fpage>–<lpage>83</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1159/000056575" xlink:type="simple">10.1159/000056575</ext-link></comment> <object-id pub-id-type="pmid">11223748</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marques</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Teixeira</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Ferreira</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Assis</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lobo</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Maurício</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Influence of survivin (BIRC5) and caspase-9 (CASP9) functional polymorphisms in renal cell carcinoma development: a study in a southern European population</article-title>. <source>Molecular biology reports</source>. <year>2013</year>;<volume>40</volume>(<issue>8</issue>):<fpage>4819</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11033-013-2578-3" xlink:type="simple">10.1007/s11033-013-2578-3</ext-link></comment> <object-id pub-id-type="pmid">23645041</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Akhurst</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Derynck</surname> <given-names>R</given-names></name>. <article-title>TGF-β signaling in cancer–a double-edged sword</article-title>. <source>Trends in cell biology</source>. <year>2001</year>;<volume>11</volume>(<issue>11</issue>):<fpage>S44</fpage>–<lpage>S51</lpage>. <object-id pub-id-type="pmid">11684442</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Choueiri</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Vaishampayan</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Rosenberg</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Logan</surname> <given-names>TF</given-names></name>, <name name-style="western"><surname>Harzstark</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Bukowski</surname> <given-names>RM</given-names></name>, <etal>et al</etal>. <article-title>Phase II and biomarker study of the dual MET/VEGFR2 inhibitor foretinib in patients with papillary renal cell carcinoma</article-title>. <source>Journal of Clinical Oncology</source>. <year>2013</year>;<volume>31</volume>(<issue>2</issue>):<fpage>181</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1200/JCO.2012.43.3383" xlink:type="simple">10.1200/JCO.2012.43.3383</ext-link></comment> <object-id pub-id-type="pmid">23213094</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cork</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Van Meir</surname> <given-names>EG</given-names></name>. <article-title>Emerging roles for the BAI1 protein family in the regulation of phagocytosis, synaptogenesis, neurovasculature, and tumor development</article-title>. <source>Journal of molecular medicine</source>. <year>2011</year>;<volume>89</volume>(<issue>8</issue>):<fpage>743</fpage>–<lpage>52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00109-011-0759-x" xlink:type="simple">10.1007/s00109-011-0759-x</ext-link></comment> <object-id pub-id-type="pmid">21509575</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fukushima</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Oshika</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Tsuchida</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tokunaga</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hatanaka</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kijima</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Brain-specific angiogenesis inhibitor 1 expression is inversely correlated with vascularity and distant metastasis of colorectal cancer</article-title>. <source>International journal of oncology</source>. <year>1998</year>;<volume>13</volume>(<issue>5</issue>):<fpage>967</fpage>–<lpage>70</lpage>. <object-id pub-id-type="pmid">9772287</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Koh</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Shin</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Ahn</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Roh</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Comparative study of angiostatic and anti-invasive gene expressions as prognostic factors in gastric cancer</article-title>. <source>International journal of oncology</source>. <year>2001</year>;<volume>18</volume>(<issue>2</issue>):<fpage>355</fpage>–<lpage>62</lpage>. <object-id pub-id-type="pmid">11172604</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Izutsu</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Konda</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Sugimura</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Iwasaki</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Fujioka</surname> <given-names>T</given-names></name>. <article-title>Brain-specific angiogenesis inhibitor 1 is a putative factor for inhibition of neovascular formation in renal cell carcinoma</article-title>. <source>The Journal of urology</source>. <year>2011</year>;<volume>185</volume>(<issue>6</issue>):<fpage>2353</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.juro.2011.02.019" xlink:type="simple">10.1016/j.juro.2011.02.019</ext-link></comment> <object-id pub-id-type="pmid">21511296</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nishimori</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Shiratsuchi</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Urano</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kimura</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kiyono</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Tatsumi</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>A novel brain-specific p53-target gene, BAI1, containing thrombospondin type 1 repeats inhibits experimental angiogenesis</article-title>. <source>Oncogene</source>. <year>1997</year>;<volume>15</volume>(<issue>18</issue>):<fpage>2145</fpage>–<lpage>50</lpage>. <object-id pub-id-type="pmid">9393972</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kudo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Konda</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Obara</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Kudo</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tani</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Nakamura</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Inhibition of tumor growth through suppression of angiogenesis by brain-specific angiogenesis inhibitor 1 gene transfer in murine renal cell carcinoma</article-title>. <source>Oncology reports</source>. <year>2007</year>;<volume>18</volume>(<issue>4</issue>):<fpage>785</fpage>–<lpage>92</lpage>. <object-id pub-id-type="pmid">17786337</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oka</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Chatani</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hoshino</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ogawa</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Kakehi</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Terachi</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Constitutive activation of mitogen-activated protein (MAP) kinases in human renal cell carcinoma</article-title>. <source>Cancer research</source>. <year>1995</year>;<volume>55</volume>(<issue>18</issue>):<fpage>4182</fpage>–<lpage>7</lpage>. <object-id pub-id-type="pmid">7664295</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friday</surname> <given-names>BB</given-names></name>, <name name-style="western"><surname>Adjei</surname> <given-names>AA</given-names></name>. <article-title>Advances in targeting the Ras/Raf/MEK/Erk mitogen-activated protein kinase cascade with MEK inhibitors for cancer therapy</article-title>. <source>Clinical Cancer Research</source>. <year>2008</year>;<volume>14</volume>(<issue>2</issue>):<fpage>342</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1158/1078-0432.CCR-07-4790" xlink:type="simple">10.1158/1078-0432.CCR-07-4790</ext-link></comment> <object-id pub-id-type="pmid">18223206</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref041"><label>41</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Demuth</surname> <given-names>HB</given-names></name>, <name name-style="western"><surname>Beale</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>De Jess</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Hagan</surname> <given-names>MT</given-names></name>. <chapter-title>Neural network design</chapter-title>: <publisher-name>Martin Hagan</publisher-name>; <year>2014</year>.</mixed-citation></ref>
<ref id="pcbi.1006076.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>LeCun</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bengio</surname> <given-names>Y</given-names></name>. <article-title>Convolutional networks for images, speech, and time series</article-title>. <source>The handbook of brain theory and neural networks</source>. <year>1995</year>;<volume>3361</volume>(<issue>10</issue>):<fpage>1995</fpage>.</mixed-citation></ref>
<ref id="pcbi.1006076.ref043"><label>43</label><mixed-citation publication-type="other" xlink:type="simple">Broad. Broad Institute TCGA Genome Data Analysis Center (2014): Analysis Overview for 15 July 2014. Broad Institute of MIT and Harvard. 2014.</mixed-citation></ref>
<ref id="pcbi.1006076.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Love</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Anders</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Huber</surname> <given-names>W</given-names></name>. <article-title>Differential analysis of RNA-Seq data at the gene level using the DESeq2 package</article-title>. <year>2013</year>.</mixed-citation></ref>
<ref id="pcbi.1006076.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friedman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hastie</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>R</given-names></name>. <article-title>Regularization paths for generalized linear models via coordinate descent</article-title>. <source>Journal of statistical software</source>. <year>2010</year>;<volume>33</volume>(<issue>1</issue>):<fpage>1</fpage>. <object-id pub-id-type="pmid">20808728</object-id></mixed-citation></ref>
<ref id="pcbi.1006076.ref046"><label>46</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Masters</surname> <given-names>T</given-names></name>. <chapter-title>Practical neural network recipes in C++</chapter-title>: <publisher-name>Morgan Kaufmann</publisher-name>; <year>1993</year>.</mixed-citation></ref>
<ref id="pcbi.1006076.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Harrell</surname> <given-names>FE</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Mark</surname> <given-names>DB</given-names></name>. <article-title>Tutorial in biostatistics multivariable prognostic models: issues in developing models, evaluating assumptions and adequacy, and measuring and reducing errors</article-title>. <source>Statistics in medicine</source>. <year>1996</year>;<volume>15</volume>:<fpage>361</fpage>–<lpage>87</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006076.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kanehisa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Goto</surname> <given-names>S</given-names></name>. <article-title>KEGG: kyoto encyclopedia of genes and genomes</article-title>. <source>Nucleic acids research</source>. <year>2000</year>;<volume>28</volume>(<issue>1</issue>):<fpage>27</fpage>–<lpage>30</lpage>. <object-id pub-id-type="pmid">10592173</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>