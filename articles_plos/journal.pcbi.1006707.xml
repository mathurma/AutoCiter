<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-00537</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006707</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Behavior</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Behavior</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognition</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov models</subject><subj-group><subject>Hidden Markov models</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Thermodynamics</subject><subj-group><subject>Free energy</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject><subj-group><subject>Human learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject><subj-group><subject>Human learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject><subj-group><subject>Human learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Learning</subject><subj-group><subject>Human learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Research design</subject><subj-group><subject>Experimental design</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Predicting change: Approximate inference under explicit representation of temporal structure in changing environments</article-title>
<alt-title alt-title-type="running-head">Inference under explicit representation of temporal structure in changing environments</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4185-696X</contrib-id>
<name name-style="western">
<surname>Marković</surname> <given-names>Dimitrije</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Reiter</surname> <given-names>Andrea M. F.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kiebel</surname> <given-names>Stefan J.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001">
<addr-line>Department of Psychology, Technische Universität Dresden, Dresden, Germany</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>O'Reilly</surname> <given-names>Jill</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Oxford University, UNITED KINGDOM</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">dimitrije.markovic@tu-dresden.de</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>1</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>31</day>
<month>1</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>1</issue>
<elocation-id>e1006707</elocation-id>
<history>
<date date-type="received">
<day>8</day>
<month>4</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>11</day>
<month>12</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Marković et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006707"/>
<abstract>
<p>In our daily lives timing of our actions plays an essential role when we navigate the complex everyday environment. It is an open question though how the representations of the temporal structure of the world influence our behavior. Here we propose a probabilistic model with an explicit representation of state durations which may provide novel insights in how the brain predicts upcoming changes. We illustrate several properties of the behavioral model using a standard reversal learning design and compare its task performance to standard reinforcement learning models. Furthermore, using experimental data, we demonstrate how the model can be applied to identify participants’ beliefs about the latent temporal task structure. We found that roughly one quarter of participants seem to have learned the latent temporal structure and used it to anticipate changes, whereas the remaining participants’ behavior did not show signs of anticipatory responses, suggesting a lack of precise temporal expectations. We expect that the introduced behavioral model will allow, in future studies, for a systematic investigation of how participants learn the underlying temporal structure of task environments and how these representations shape behavior.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Although time perception and timed behavior are essential for our everyday experience, it is still unclear how the human brain represents the underlying temporal regularities of our dynamic environment. These regularities and their representations in the brain are important to generate well-timed behavior. When deciding on the sequence of actions to complete most of our everyday tasks like cooking, driving, or even brushing our teeth, it is essential to represent and keep track of the durations of different parts of the tasks. Here we introduce a behavioral model of decision making in environments in which a change is at least partially predictable by the time it took since the last change. We show that human participants are using such predictions in the so-called reversal learning task, which simulates abrupt but not immediately obvious changes of the environment. We find that some but not all participants harness previously experienced regularities in these changes to anticipate when the next change is going to happen. We expect that a wide range of similar questions of how humans and other animals use temporal expectations to make their decisions in a dynamic environment can be addressed using the new modelling approach.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
<institution>Deutsche Forschungsgemeinschaft</institution>
</institution-wrap>
</funding-source>
<award-id>SFB 940/2; Projects A9 and B7</award-id>
</award-group>
<award-group id="award002">
<funding-source>
<institution>Open Access Publication Funds of the TU Dresden</institution>
</funding-source>
</award-group>
<funding-statement>This work was supported by the Deutsche Forschungsgemeinschaft <ext-link ext-link-type="uri" xlink:href="http://www.dfg.de/" xlink:type="simple">http://www.dfg.de/</ext-link> (grant number SFB 940/2, Project A9 (DM and SJK); and Project B7 (AMFR)), and the Open Access Publication Funds of the TU Dresden <ext-link ext-link-type="uri" xlink:href="https://www.slub-dresden.de/service/open-science-service/" xlink:type="simple">https://www.slub-dresden.de/service/open-science-service/</ext-link>. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="12"/>
<table-count count="1"/>
<page-count count="31"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-02-12</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data and python codes are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/dimarkov/predchange" xlink:type="simple">https://github.com/dimarkov/predchange</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Our ability to represent time and to generate complex actions and plans based on this representation are central to all aspects of our behavior. Knowing when to act, precisely, is clearly crucial for our survival [<xref ref-type="bibr" rid="pcbi.1006707.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref002">2</xref>]. Thus, it is not surprising that the question of how we perceive and represent time gains an increasing interest in neurosciences [<xref ref-type="bibr" rid="pcbi.1006707.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1006707.ref005">5</xref>]. However, in comparison to our understanding of spatial cognition, the neural basis of time perception is still poorly understood [<xref ref-type="bibr" rid="pcbi.1006707.ref006">6</xref>]. Here, we address the question of how the brain, in principle, can use knowledge about a hidden temporal structure of a task when making decisions.</p>
<p>Traditionally, the question how we learn the structure of the world and use these representations for decision making, has been investigated from the perspective of reinforcement learning [<xref ref-type="bibr" rid="pcbi.1006707.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref008">8</xref>]. The focus of these investigations has been on how learning is driven by prediction errors [<xref ref-type="bibr" rid="pcbi.1006707.ref009">9</xref>], defined as a mismatch between expected and observed outcomes of one’s actions. More recent studies on human behavior in dynamic environments [<xref ref-type="bibr" rid="pcbi.1006707.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1006707.ref013">13</xref>] have demonstrated that the relative precision of one’s prior beliefs and current sensory information weights prediction error signals [<xref ref-type="bibr" rid="pcbi.1006707.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1006707.ref021">21</xref>]. These findings indicate that humans update their beliefs about the structure of the world akin to a rational (Bayesian) agent [<xref ref-type="bibr" rid="pcbi.1006707.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref023">23</xref>]. This suggests that one can approximately describe human behavior using the methodology of probabilistic inference. The key advantage of the probabilistic inference framework over the standard reinforcement learning modelling approach is that one can embed the knowledge about the structure of the world and the uncertainty about that knowledge within a generative model that describes the known rules that shape the dynamics of the world.</p>
<p>A potential limitation of previous approaches—both probabilistic and reinforcement learning based—is that they do not take into account the underlying temporal structure of the task. Recently a series of studies have demonstrated the relevance of learned temporal associations on attention, perception, and sensory integration [<xref ref-type="bibr" rid="pcbi.1006707.ref024">24</xref>–<xref ref-type="bibr" rid="pcbi.1006707.ref027">27</xref>]. Experimental paradigms employed in this studies utilized observable temporal structure within trial. Similarly, in [<xref ref-type="bibr" rid="pcbi.1006707.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref029">29</xref>] authors demonstrate that learning of the underlying temporal structure of the task is used by human participants (or animal subjects) to anticipate the moment in time at which rules are most likely to change. In contrast to the experimental design which use within trial temporal structure, here participants were exposed to a hidden temporal structure across trials.</p>
<p>Motivated by these findings, we propose a way to extend current probabilistic models of behavior, aimed at describing decision making in dynamic environments, to incorporate an explicit representation of the underlying temporal structure in the form of prior beliefs about state durations. In particular we will focus on the case when the state durations are not directly observable, but inferred across multiple trials using observable changes in action outcomes. The two essential components of the proposed behavioral model are (i) the update of beliefs about states and duration derived using approximate inference under hidden semi-Markov models [<xref ref-type="bibr" rid="pcbi.1006707.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref031">31</xref>] and (ii) the update of beliefs about actions, that is the planning process, cast as an inference problem [<xref ref-type="bibr" rid="pcbi.1006707.ref032">32</xref>–<xref ref-type="bibr" rid="pcbi.1006707.ref034">34</xref>].</p>
<p>As a test bed for illustrating the key properties of the model and for demonstrating its applicability to experimental studies we adopted a probabilistic reversal learning task [<xref ref-type="bibr" rid="pcbi.1006707.ref035">35</xref>]. This task and its variants have been frequently used in human and animal studies to investigate key properties of flexible behavioral adaptation in dynamic environments [<xref ref-type="bibr" rid="pcbi.1006707.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref036">36</xref>–<xref ref-type="bibr" rid="pcbi.1006707.ref038">38</xref>]. In a typical setup participants first learn to associate a particular choice with a reward, followed by a sequence of reversals of reward contingencies. The interesting question is typically how fast participants adapt their choices to these new contingencies. In the work here, we address the question, whether participants actually use the underlying temporal task structure to predict the moment of the reversal so that behavior is adapted faster as compared to the case when the reversal is unexpected.</p>
<p>Using the reversal learning task, we first demonstrate using simulations that we can link sub-optimal behavior in changing environments to a misrepresentation of the underlying temporal structure of the changes. Subsequently, when fitting the behavioral model to experimental data, we relate the measured behavior of each participant to model parameters that define the beliefs about the temporal structure of reversals. Strikingly, our results suggest a heterogeneous distribution of the task representation across participants where some participants correctly inferred the latent temporal structure of the task, whereas others did not. We discuss potential reasons for this finding and how the presented approach enables systematic investigations of how participants learn the underlying temporal structure of task environments and how these representations shape behavior.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and methods</title>
<p>In what follows we will first introduce the reversal learning task which we used here as a test bed for illustrating behavioral properties of the proposed model and its applicability to experimental data. Afterwards, we will briefly describe a classical reinforcement learning approach for modeling behavior in a reversal learning task, and later introduce the procedure for deriving the probabilistic behavioral model based on a special type of hidden semi-Markov models. Finally, we will describe in detail the analysis steps used for fitting behavioral models to data, and performing model comparison.</p>
<sec id="sec003">
<title>Ethics statement</title>
<p>All participants provided written informed consent and were paid on an hourly basis. The Medical Faculty of Leipzig University approved the study.</p>
</sec>
<sec id="sec004">
<title>Reversal learning</title>
<p>A probabilistic reversal learning task is typically structured as follows. An agent is presented with two choices A and B where each choice is associated with a probability of receiving a reward or punishment. For example, initially choice A has high probability <italic>p</italic><sub><italic>H</italic></sub> and choice B low probability <italic>p</italic><sub><italic>L</italic></sub> of getting a reward. Importantly, after several trials the reward contingencies switch, such that choice B now corresponds to the high reward probability choice. Participants are not informed about the switch and they have to infer that a change occurred and adapt their behavior. Here we used a multiple reversals design in which reversals occur several times during the experiment. Furthermore, the reversals occur at predefined trial numbers and are independent of participant’s performance. This reversal schedule was successfully used in past studies in healthy as well as patient samples and is well suited to detect inter-individual differences in behavioral adaptation [<xref ref-type="bibr" rid="pcbi.1006707.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref040">40</xref>].</p>
<p>For the model-based analysis, we used a subset of behavioral data—consisting of 22 healthy participants—from a previously published fMRI study [<xref ref-type="bibr" rid="pcbi.1006707.ref039">39</xref>]. In the experimental task participants were deciding between two cards shown on a screen, each showing a different stimulus (a geometric shape, e.g. rectangle, triangle, etc.) as shown in <xref ref-type="fig" rid="pcbi.1006707.g001">Fig 1A</xref>. The reward probabilities associated with the two choice options were anti-correlated on all trials: whenever reward probability of choice A was high (<italic>p</italic><sub><italic>H</italic></sub> = 0.8) the reward probability of choice B was low (<italic>p</italic><sub><italic>L</italic></sub> = 0.2), and vice versa. Note that <italic>p</italic><sub><italic>H</italic></sub> = 1 − <italic>p</italic><sub><italic>L</italic></sub> on all trials. Reward contingencies change as follows: they were stable for the first 55 trials, afterwards they changed four times after 15 or 20 trials, and remained stable for the last 35 trials, see <xref ref-type="fig" rid="pcbi.1006707.g001">Fig 1B</xref>. In total, the experimental block consisted of 160 trials.</p>
<fig id="pcbi.1006707.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006707.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Reversal learning task.</title>
<p>A: Exemplary trial sequence of experimental reversal learning task. Participants were instructed to choose the card that they thought would lead to a monetary reward. After they chose one of the two cards, the corresponding card was highlighted and feedback was displayed. The feedback consisted of either a 10 Eurocents coin for a win outcome, or a crossed 10 Eurocents for a loss outcome. B: The time series of the underlying reward probability of one of the two stimuli. The reward probability of the more rewarding stimuli at any time step was set to 0.8 and a punishment probability to 0.2 (and vice versa for the other stimulus). Reward contingencies remained stable for the first 55 trials (pre-reversal phase) and for the last 35 trials (post-reversal phase). In between, reward contingencies changed four times (reversal phase).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006707.g001" xlink:type="simple"/>
</fig>
<p>The location of each stimulus on the screen (right or left side) was randomized over trials. After each choice the stimulus was highlighted and depicted for 1.5 s minus the reaction time. The feedback in form of reward (won 10 Eurocents) or punishment (lost 10 Eurocents) was shown for 0.5 s. If no response occurred during the decision window, the message “too slow” was presented, and no outcome was delivered. During the inter-trial interval, a fixation cross was presented for a variable duration (jittered and exponentially distributed; range 1–12.5 s).</p>
<p>All 22 participants underwent a training session during which they had the opportunity to learn the statistics of the rewards associated with high and low reward probability choices. The set of stimuli used in the training phase differed from the one used during the testing phase. The participants were instructed that they could either win or lose 10 cents on each trial, and that they will be paid the total amount of money they gained during the testing phase at the end of the experiment. Each participant performed 20 training trials without any reversal of reward contingencies. Before the start of the testing phase participants were told that reward probabilities might change over the course of the experiment. No other information about reversals or the correlation of choices and outcomes was provided. Thus, the participants had no explicitly instructed knowledge about the anti-correlated task structure before the experiment.</p>
</sec>
<sec id="sec005">
<title>Reinforcement learning models</title>
<sec id="sec006">
<title>Classical Rescorla-Wagner model</title>
<p>A classical approach to modeling the probabilistic multiple-reversals learning task is using the Rescorla-Wagner (RW) model [<xref ref-type="bibr" rid="pcbi.1006707.ref041">41</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref042">42</xref>]. The reasoning of this approach is that agents tend to value those choices which on average lead to more rewarding outcomes in the past. This reasoning can be formalized as follows
<disp-formula id="pcbi.1006707.e001"><alternatives><graphic id="pcbi.1006707.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi>t</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup> <mml:mo>+</mml:mo> <mml:mi>α</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi>t</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>c</italic><sub><italic>t</italic></sub> ∈ [<italic>A</italic>, <italic>B</italic>] denotes a choice at trial <italic>t</italic>, <italic>o</italic><sub><italic>t</italic></sub> ∈ {−1, 1} denotes the outcome of that choice (loss or gain), and <inline-formula id="pcbi.1006707.e002"><alternatives><graphic id="pcbi.1006707.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msubsup><mml:mi>V</mml:mi> <mml:mi>t</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup></mml:math></alternatives></inline-formula> is the current value associated with each choice. Importantly, the choice values <inline-formula id="pcbi.1006707.e003"><alternatives><graphic id="pcbi.1006707.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msubsup><mml:mi>V</mml:mi> <mml:mi>t</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup></mml:math></alternatives></inline-formula> are updated after each trial proportionally to the prediction error <inline-formula id="pcbi.1006707.e004"><alternatives><graphic id="pcbi.1006707.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msub><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi>t</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> weighted by a constant learning rate <italic>α</italic>.</p>
</sec>
<sec id="sec007">
<title>Dual update Rescorla-Wagner model</title>
<p>As the experimental design imposes anti-correlation between high and low reward probability (<italic>p</italic><sub><italic>H</italic></sub> = 1 − <italic>p</italic><sub><italic>L</italic></sub>), an extended version of <xref ref-type="disp-formula" rid="pcbi.1006707.e001">Eq (1)</xref> was proposed in [<xref ref-type="bibr" rid="pcbi.1006707.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref040">40</xref>] which incorporates fictive learning signals [<xref ref-type="bibr" rid="pcbi.1006707.ref043">43</xref>]. The extension is based on the assumption that agents update, in parallel, values of both choices. The value of the executed choice is updated as before, whereas the value of the alternative (non-executed) choice is updated as if the outcome for that choice was the opposite to the observed one. We can formalize this with the following update rules
<disp-formula id="pcbi.1006707.e005"><alternatives><graphic id="pcbi.1006707.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi>t</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup> <mml:mo>+</mml:mo> <mml:mi>α</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi>t</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi>t</mml:mi> <mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:mi>κ</mml:mi> <mml:mi>α</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:mo>-</mml:mo> <mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi>t</mml:mi> <mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where <inline-formula id="pcbi.1006707.e006"><alternatives><graphic id="pcbi.1006707.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> denotes the permutation operator such that if <italic>c</italic><sub><italic>t</italic></sub> = <italic>A</italic>, then <inline-formula id="pcbi.1006707.e007"><alternatives><graphic id="pcbi.1006707.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>B</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> (and vice versa). In addition, <italic>κ</italic> denotes the coupling strength of the fictive prediction error.</p>
</sec>
</sec>
<sec id="sec008">
<title>Probabilistic model</title>
<p>To derive the probabilistic model of behavior we start by defining a generative model of the task that formalizes an agent’s beliefs about the structure and the dynamics of the task environment. The update rules are then obtained using (approximate) Bayesian inference.</p>
<p>The assumption here is that participants learn to represent the latent task structure. This structure consists of hidden states which define two possible configurations of the environment: in one configuration stimulus A corresponds to a high reward choice, in the second, stimulus B corresponds to a high reward choice. Note that the notion of state used here differs from what is typically used in reinforcement learning models, in which states are cues that are associated with values over time. Here, the states are hidden and not directly observable. Furthermore, they capture a context, which defines how two stimuli (option cues) are related to actions and outcomes of those actions.</p>
<p>Importantly, the task environment transits from one state to another in a probabilistic manner. Here we will consider two assumptions about the dynamics of state transition probabilities: (i) the state transition probability is constant and independent of the moment of the previous change, as is the case under hidden Markov models (HMM) [<xref ref-type="bibr" rid="pcbi.1006707.ref044">44</xref>]; (ii) the state transition probability is time dependent and linked to the moment of the last change, which we will represent using hidden semi-Markov models (HSMM) [<xref ref-type="bibr" rid="pcbi.1006707.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref045">45</xref>]. As the HMM corresponds to a special case of HSMM, in which state transition probabilities are constant, it is sufficient to define the behavioral model based on the HSMM assumption.</p>
<p>In what follows we will define the components of the generative model (observation likelihood and state dynamics) and derive the corresponding update rules.</p>
<sec id="sec009">
<title>Observation likelihood</title>
<p>The observation likelihood defines the probability of observing reward or punishment in any of the two possible states <italic>s</italic><sub><italic>t</italic></sub> ∈ {¬<italic>R</italic>, <italic>R</italic>} depending of the choice <italic>c</italic><sub><italic>t</italic></sub> ∈ {<italic>A</italic>, <italic>B</italic>} that an agent makes at a given trial <italic>t</italic>. Note that we have used ¬<italic>R</italic> to denote an initial non-reversal state (e.g., stimulus A is linked to a high reward probability), and <italic>R</italic> for a reversal state with switched reward contingencies. We define the observation likelihood as
<disp-formula id="pcbi.1006707.e008"><alternatives><graphic id="pcbi.1006707.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msubsup> <mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>ρ</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>¬</mml:mo> <mml:mi>R</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msubsup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>ρ</mml:mi> <mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover><mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>R</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where the <inline-formula id="pcbi.1006707.e009"><alternatives><graphic id="pcbi.1006707.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> again corresponds to the permutation operator (e.g. <inline-formula id="pcbi.1006707.e010"><alternatives><graphic id="pcbi.1006707.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>A</mml:mi> <mml:mo>=</mml:mo> <mml:mi>B</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>). Note that the choice dependent reward probabilities (<italic>ρ</italic><sub><italic>A</italic></sub> and <italic>ρ</italic><sub><italic>B</italic></sub>) are treated as random variables. Hence they are initially unknown to the agent and learned during the course of the experiment.</p>
</sec>
</sec>
<sec id="sec010">
<title>State dynamics</title>
<p>To formalize the presence of sequential reversals, that is, transitions from one task configuration to another, we define the state transition probability as
<disp-formula id="pcbi.1006707.e011"><alternatives><graphic id="pcbi.1006707.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>δ</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>≠</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
where <italic>δ</italic> denotes probability of transiting between distinct hidden states (e.g. from <italic>s</italic><sub><italic>t</italic>−1</sub> = ¬<italic>R</italic> to <italic>s</italic><sub><italic>t</italic></sub> = <italic>R</italic>. This representation of the state transition process corresponds to a standard HMM previously used in reversal learning tasks [<xref ref-type="bibr" rid="pcbi.1006707.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref038">38</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref046">46</xref>–<xref ref-type="bibr" rid="pcbi.1006707.ref048">48</xref>].</p>
<p>Note that under this formulation of the state transition matrix the agent implicitly assumes that the interval (the elapsed number of trials) between two reversals follows a geometric distribution. Hence, the probability that any between reversal interval is of length <italic>d</italic> is given as
<disp-formula id="pcbi.1006707.e012"><alternatives><graphic id="pcbi.1006707.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi>δ</mml:mi> <mml:mo>,</mml:mo><mml:mspace width="8pt"/><mml:mtext>where</mml:mtext><mml:mspace width="4pt"/><mml:mi>d</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mn>3</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
with an expected dwelling time in each task configuration (mean interval length) set to <inline-formula id="pcbi.1006707.e013"><alternatives><graphic id="pcbi.1006707.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:mi>μ</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>δ</mml:mi></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>To derive agents with arbitrary beliefs about between reversal intervals we will use a special type of hidden semi-Markov models, the so-called explicit duration hidden Markov models (ED-HMM) [<xref ref-type="bibr" rid="pcbi.1006707.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref050">50</xref>]. This will allow us to identify individual differences in the beliefs about the temporal task structure and to investigate what impact these beliefs might have on an agent’s performance.</p>
</sec>
<sec id="sec011">
<title>State durations</title>
<p>The ED-HMM embeds the generative model with the representation of state durations, that is, the state dwelling time <italic>d</italic><sub><italic>t</italic></sub> (the time spent in each state, ¬<italic>R</italic> or <italic>R</italic>). In other words, an agent will be able to form expectations about the number of trials between consecutive reversals.</p>
<p>Under the ED-HMM we define the state transition matrix as follows
<disp-formula id="pcbi.1006707.e014"><alternatives><graphic id="pcbi.1006707.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>I</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>&gt;</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>J</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
where <italic>I</italic><sub>2</sub> denotes the 2 × 2 identity matrix and <italic>J</italic><sub>2</sub> denotes the 2 × 2 all-ones matrix. The above relations describe a simple deterministic process for which the current state <italic>s</italic><sub><italic>t</italic></sub> remains unchanged as long as <italic>d</italic><sub><italic>t</italic>−1</sub> &gt; 1 and switches to alternative state (e.g. if <italic>s</italic><sub><italic>t</italic>−1</sub> = <italic>A</italic> then <italic>s</italic><sub><italic>t</italic></sub> = <italic>B</italic>) with probability one when <italic>d</italic><sub><italic>t</italic>−1</sub> = 1.</p>
<p>The transitions between state durations follow a deterministic countdown (<italic>d</italic><sub><italic>t</italic></sub> = <italic>d</italic><sub><italic>t</italic>−1</sub> − 1) as long as <italic>d</italic><sub><italic>t</italic>−1</sub> &gt; 1; once <italic>d</italic><sub><italic>t</italic>−1</sub> = 1 the subsequent value <italic>d</italic><sub><italic>t</italic></sub> is sampled from the prior over state durations <italic>p</italic><sub>0</sub>(<italic>d</italic><sub><italic>t</italic></sub>), that is, from the beliefs over between reversal interval. We can write this formally in the form of the transition probability as
<disp-formula id="pcbi.1006707.e015"><alternatives><graphic id="pcbi.1006707.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>&gt;</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>(</mml:mo><mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
In <xref ref-type="fig" rid="pcbi.1006707.g002">Fig 2</xref> we illustrate conditional dependencies between states, durations, reward probabilities, and outcomes in the form of a a graphical model.</p>
<fig id="pcbi.1006707.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006707.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Graphical representation of the generative model and model summary.</title>
<p>Left: We illustrate here the conditional dependence of state durations, states, reward probabilities, and outcomes. Note that the choices <italic>c</italic><sub><italic>t</italic></sub> are treated as observables within the generative model. Right: summary of the hidden state variables, observations, and the notation used for defining prior expectations and posterior beliefs over hidden states.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006707.g002" xlink:type="simple"/>
</fig>
<p>Although, the semi-Markov formalisms allows for defining state dependent prior beliefs <italic>p</italic><sub>0</sub>(<italic>d</italic><sub><italic>t</italic></sub>|<italic>s</italic><sub><italic>t</italic></sub>), here, to reduce model complexity, we have assumed that the priors are independent of the current state, thus we set <italic>p</italic><sub>0</sub>(<italic>d</italic><sub><italic>t</italic></sub>|<italic>s</italic><sub><italic>t</italic></sub>) = <italic>p</italic><sub>0</sub>(<italic>d</italic><sub><italic>t</italic></sub>) for any <italic>s</italic><sub><italic>t</italic></sub> ∈ {¬<italic>R</italic>, <italic>R</italic>}.</p>
<p>In practice, prior beliefs about state durations <italic>p</italic><sub>0</sub>(<italic>d</italic><sub><italic>t</italic></sub>) can have an arbitrary form, however for the purpose of inferring the participants’ representation of between reversal intervals we will use a parametric distribution, specifically the negative binomial <italic>NB</italic> distribution defined as
<disp-formula id="pcbi.1006707.e016"><alternatives><graphic id="pcbi.1006707.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>(</mml:mo><mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>r</mml:mi><mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>r</mml:mi> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>δ</mml:mi><mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mi>δ</mml:mi> <mml:mi>r</mml:mi></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
where <italic>δ</italic> ∈ [0, 1] and <italic>r</italic> &gt; 0.</p>
<p>The <italic>NB</italic> distribution has several convenient properties. First, in the case <italic>r</italic> = 1 we obtain the geometric distribution (see <xref ref-type="disp-formula" rid="pcbi.1006707.e012">Eq (5)</xref>), hence we recover the HMM model described above. Second, for <italic>r</italic> &gt; 1 the NB distribution exhibits a nonzero mode which shifts towards the expected value <inline-formula id="pcbi.1006707.e017"><alternatives><graphic id="pcbi.1006707.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:mi>μ</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>r</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> as a function of a decreasing variance <inline-formula id="pcbi.1006707.e018"><alternatives><graphic id="pcbi.1006707.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:mi>σ</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>r</mml:mi></mml:mrow> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, which is illustrated in <xref ref-type="fig" rid="pcbi.1006707.g003">Fig 3</xref>. Hence, the parameters of the negative binomial distribution will allow us to quantify an agent’s specific belief in the regularity of reversals. The lower the variance <italic>σ</italic>, the more an agent believes that reversals occur at regular intervals.</p>
<fig id="pcbi.1006707.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006707.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Specific cases of the negative binomial distribution.</title>
<p>We illustrate here the dependence of the shape (and the mode) of the negative binomial distribution for different values of the variance <italic>σ</italic>. Note that when the variance <italic>σ</italic> equals its mean <italic>μ</italic> (blue), the distribution peaks around its expected value. As the variance increases (green) the mode shifts toward zero. The limiting case of the geometric distribution (red) corresponds to <italic>r</italic> = 1, that is, <italic>σ</italic> = <italic>μ</italic>(<italic>μ</italic> − 1). For all three cases we fixed the mean interval length at <italic>μ</italic> = 20.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006707.g003" xlink:type="simple"/>
</fig>
<p>Importantly, the variance of prior beliefs <italic>p</italic><sub>0</sub>(<italic>d</italic>) has direct effects on the temporal expectation profile (that a reversal will occur at some future trial <italic>τ</italic>). In <xref ref-type="fig" rid="pcbi.1006707.g004">Fig 4</xref> we show the dependence of the expected reversal probability <italic>δ</italic><sub><italic>τ</italic></sub> on the variance <italic>σ</italic>, and under fixed mean <italic>μ</italic> = 20 of prior beliefs about the between-reversals interval. The expected reversal probability <italic>δ</italic><sub><italic>τ</italic></sub> is defined as
<disp-formula id="pcbi.1006707.e019"><alternatives><graphic id="pcbi.1006707.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>δ</mml:mi> <mml:mi>τ</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>τ</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>R</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>τ</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>¬</mml:mo> <mml:mi>R</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:munder> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi> <mml:mi>τ</mml:mi></mml:msub> <mml:mrow><mml:mo>=</mml:mo> <mml:mi>R</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>τ</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>¬</mml:mo> <mml:mi>R</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo> <mml:mi>p</mml:mi> <mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
where <italic>τ</italic> &gt; 1, and <italic>p</italic>(<italic>s</italic> = ¬<italic>R</italic>) = 1. Hence, <italic>δ</italic><sub><italic>τ</italic></sub> corresponds to the transition probability (from non-reversal state ¬<italic>R</italic> into reversal state <italic>R</italic>) at some future trial <italic>τ</italic> starting from the non-reversal state <italic>s</italic><sub>1</sub> = ¬<italic>R</italic>. Note that for prior beliefs <italic>p</italic><sub>0</sub>(<italic>d</italic>) with large variance (<italic>σ</italic> = <italic>μ</italic>(<italic>μ</italic> − 1)), we get a constant transition probability, which corresponds to the HMM formulation of the state transition probability. In contrast, for prior beliefs with low variance (<italic>σ</italic> = <italic>μ</italic>) one obtains a trial dependent transition probability with values alternating between the low and high probabilities in a periodic manner. This temporal dependence of the transition probability will affect the inference process. The agent will become insensitive to subsequent reversals occurring few trials after the initial reversal, and highly sensitive to reversals occurring twenty to thirty trials after the initial reversal.</p>
<fig id="pcbi.1006707.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006707.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Expected transition probability at future trial <italic>τ</italic>.</title>
<p>Estimate of the transition probability <italic>δ</italic><sub><italic>τ</italic></sub> (see <xref ref-type="disp-formula" rid="pcbi.1006707.e019">Eq (9)</xref>) at a future trial <italic>τ</italic> conditioned upon a reversal at <italic>τ</italic> = 1 and known initial state set at <italic>s</italic><sub>1</sub> = ¬<italic>R</italic>. Each curve corresponds to estimates of the transition probability obtained from prior beliefs <italic>p</italic><sub>0</sub>(<italic>d</italic>) shown in <xref ref-type="fig" rid="pcbi.1006707.g003">Fig 3</xref>. Note that for the low variance case (blue, <italic>σ</italic> = <italic>μ</italic>), the temporal profile of transition probability has clearly defined periods of low and high transition probability. As the variance increases (green) the variability of the temporal profile decreases, until it finally becomes constant in the case of the geometrically distributed prior beliefs (red, <italic>σ</italic> = <italic>μ</italic>(<italic>μ</italic> − 1)). For all three cases we fixed the mean interval length at <italic>μ</italic> = 20.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006707.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec012">
<title>Inference</title>
<p>For model inversion we use a variational inference scheme [<xref ref-type="bibr" rid="pcbi.1006707.ref051">51</xref>–<xref ref-type="bibr" rid="pcbi.1006707.ref053">53</xref>] which allows us to derive the update rules for the inference process akin to the ones presented in <xref ref-type="disp-formula" rid="pcbi.1006707.e005">Eq (2)</xref>.</p>
<p>After making a choice <italic>c</italic><sub><italic>t</italic></sub> and observing outcome <italic>o</italic><sub><italic>t</italic></sub> at trial <italic>t</italic>, the agent updates its beliefs over reward probabilities <inline-formula id="pcbi.1006707.e020"><alternatives><graphic id="pcbi.1006707.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, states <italic>s</italic><sub><italic>t</italic></sub>, and durations <italic>d</italic><sub><italic>t</italic></sub> following Bayes’ rule
<disp-formula id="pcbi.1006707.e021"><alternatives><graphic id="pcbi.1006707.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow> <mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo><mml:mi>p</mml:mi> <mml:mrow> <mml:mo>(</mml:mo><mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>)</mml:mo> <mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow> <mml:mo>(</mml:mo><mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where we used the following notation <inline-formula id="pcbi.1006707.e022"><alternatives><graphic id="pcbi.1006707.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>o</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006707.e023"><alternatives><graphic id="pcbi.1006707.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>o</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>—for <inline-formula id="pcbi.1006707.e024"><alternatives><graphic id="pcbi.1006707.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:mi>x</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>—to denote prior and posterior beliefs, respectively, at time step <italic>t</italic>.</p>
<p>If we express prior beliefs as
<disp-formula id="pcbi.1006707.e025"><alternatives><graphic id="pcbi.1006707.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>¬</mml:mo> <mml:mi>R</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>=</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>d</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>∈</mml:mo> <mml:mo>{</mml:mo><mml:mrow><mml:mi>A</mml:mi> <mml:mo>,</mml:mo> <mml:mi>B</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:mi>B</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>ρ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:msubsup><mml:mi>a</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
where <italic>B</italic>(<italic>x</italic>; <italic>a</italic>, <italic>b</italic>) denotes a beta distribution, we can define the approximate posterior in similar form
<disp-formula id="pcbi.1006707.e026"><alternatives><graphic id="pcbi.1006707.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:mi>q</mml:mi> <mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:mi>q</mml:mi> <mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
where we use the following parametrization of the factors of the approximate posterior
<disp-formula id="pcbi.1006707.e027"><alternatives><graphic id="pcbi.1006707.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>¬</mml:mo> <mml:mi>R</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>=</mml:mo> <mml:mi>d</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>d</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>q</mml:mi> <mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo><mml:mi>A</mml:mi> <mml:mo>,</mml:mo> <mml:mi>B</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder> <mml:mi>B</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>ρ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:msubsup><mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>b</mml:mi> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula></p>
<p>The prior expectation at the next trial <italic>t</italic> + 1 depends on the current posterior <italic>q</italic>(<italic>s</italic><sub><italic>t</italic></sub>, <italic>d</italic><sub><italic>t</italic></sub>) via the sum product rule
<disp-formula id="pcbi.1006707.e028"><alternatives><graphic id="pcbi.1006707.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula></p>
<p>The update of the agent’s beliefs about reward contingencies for each choice <italic>ρ</italic>, current state <italic>s</italic><sub><italic>t</italic></sub>, and the number of trials until the next reversal <italic>d</italic><sub><italic>t</italic></sub> is completely defined by the update rules of the sufficient statistics of the posterior, namely parameters <italic>θ</italic><sub><italic>t</italic></sub>, <inline-formula id="pcbi.1006707.e029"><alternatives><graphic id="pcbi.1006707.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msubsup><mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006707.e030"><alternatives><graphic id="pcbi.1006707.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msubsup><mml:mi>b</mml:mi> <mml:mi>t</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup></mml:math></alternatives></inline-formula>. We will obtain the update rules for these parameters using variational inference. The parameters of the approximate posterior can be found as minimizers of the variational free energy defined as
<disp-formula id="pcbi.1006707.e031"><alternatives><graphic id="pcbi.1006707.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi> <mml:mo>[</mml:mo> <mml:mi>q</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mi>L</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>q</mml:mi> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo><mml:mtext>ln</mml:mtext><mml:mspace width="2pt"/><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>(</mml:mo><mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mo>∫</mml:mo> <mml:mtext>d</mml:mtext><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>q</mml:mi> <mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mtext>ln</mml:mtext><mml:mspace width="2pt"/><mml:mfrac><mml:mrow><mml:mi>q</mml:mi> <mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula></p>
<p>The posterior beliefs <italic>q</italic> that minimize the free energy <italic>F</italic> can be obtained using the following relations
<disp-formula id="pcbi.1006707.e032"><alternatives><graphic id="pcbi.1006707.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mover><mml:mi>p</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>ρ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo> <mml:mrow><mml:mtext>ln</mml:mtext><mml:mspace width="2pt"/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mover><mml:mi>p</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo> <mml:mrow><mml:mtext>ln</mml:mtext><mml:mspace width="2pt"/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
To obtain update rules similar to the delta learning rules of the RW model we simplified the above iterative procedure needed to estimate the posterior parameters. To break the cyclic update we will assume that one can first update beliefs about <italic>q</italic>(<italic>s</italic><sub><italic>t</italic></sub>, <italic>d</italic><sub><italic>t</italic></sub>) by setting
<disp-formula id="pcbi.1006707.e033"><alternatives><graphic id="pcbi.1006707.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo> <mml:mrow><mml:mtext>ln</mml:mtext><mml:mspace width="2pt"/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>ρ</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mtext>ln</mml:mtext><mml:mspace width="2pt"/><mml:mover><mml:mi>p</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
and then use the obtained posterior beliefs about states and durations to estimate the reward probabilities <inline-formula id="pcbi.1006707.e034"><alternatives><graphic id="pcbi.1006707.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:mi>q</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Using this simplification we obtain the following update rules
<disp-formula id="pcbi.1006707.e035"><alternatives><graphic id="pcbi.1006707.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>d</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mtext>ln</mml:mtext><mml:mspace width="2pt"/><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>¬</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
where <inline-formula id="pcbi.1006707.e036"><alternatives><graphic id="pcbi.1006707.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mo>¬</mml:mo> <mml:mi>R</mml:mi></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Note that the conditional posterior <italic>q</italic>(<italic>d</italic><sub><italic>t</italic></sub>|<italic>s</italic><sub><italic>t</italic></sub>) corresponds to the conditional prior <inline-formula id="pcbi.1006707.e037"><alternatives><graphic id="pcbi.1006707.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, as <inline-formula id="pcbi.1006707.e038"><alternatives><graphic id="pcbi.1006707.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>d</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>p</mml:mi> <mml:mi>d</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, hence it remains constant during the update of beliefs. However, the prior expectations (at the next time step) about state duration will be linked to the inference process via the state-duration transition matrix (see Eqs <xref ref-type="disp-formula" rid="pcbi.1006707.e014">(6)</xref> and <xref ref-type="disp-formula" rid="pcbi.1006707.e015">(7)</xref>).</p>
<p>Subsequently, we update the beliefs about the choice reward contingencies as
<disp-formula id="pcbi.1006707.e039"><alternatives><graphic id="pcbi.1006707.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e039" xlink:type="simple"/><mml:math display="block" id="M39"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mi>a</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msub><mml:mover><mml:mi>o</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>b</mml:mi> <mml:mi>t</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mover><mml:mi>o</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>·</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mi>a</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mo>·</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover><mml:mi>o</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>b</mml:mi> <mml:mi>t</mml:mi> <mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>·</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mo>·</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mover><mml:mi>o</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
where <inline-formula id="pcbi.1006707.e040"><alternatives><graphic id="pcbi.1006707.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>o</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> (<inline-formula id="pcbi.1006707.e041"><alternatives><graphic id="pcbi.1006707.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>o</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>).</p>
<p>To demonstrate the relation of the above update rules to the ones of the DU-RW model, we transform the shape parameters (<inline-formula id="pcbi.1006707.e042"><alternatives><graphic id="pcbi.1006707.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:msubsup><mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006707.e043"><alternatives><graphic id="pcbi.1006707.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:msubsup><mml:mi>b</mml:mi> <mml:mi>t</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup></mml:math></alternatives></inline-formula>) of the posterior beta distribution into the mean <inline-formula id="pcbi.1006707.e044"><alternatives><graphic id="pcbi.1006707.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>t</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup></mml:math></alternatives></inline-formula> and the samples size <inline-formula id="pcbi.1006707.e045"><alternatives><graphic id="pcbi.1006707.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:msubsup><mml:mi>ν</mml:mi> <mml:mi>t</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup></mml:math></alternatives></inline-formula> as
<disp-formula id="pcbi.1006707.e046"><alternatives><graphic id="pcbi.1006707.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e046" xlink:type="simple"/><mml:math display="block" id="M46"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>x</mml:mi></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mi>a</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>x</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>x</mml:mi></mml:msubsup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>μ</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>x</mml:mi></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>x</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>ν</mml:mi> <mml:mi>t</mml:mi> <mml:mi>x</mml:mi></mml:msubsup></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula>
where <inline-formula id="pcbi.1006707.e047"><alternatives><graphic id="pcbi.1006707.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mrow><mml:mi>x</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>·</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Expressing the expected reward probability <italic>μ</italic><sub><italic>t</italic></sub> as a function of the expected value <italic>V</italic><sub><italic>t</italic></sub>, that is, as <inline-formula id="pcbi.1006707.e048"><alternatives><graphic id="pcbi.1006707.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>t</mml:mi> <mml:mi>x</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mi>V</mml:mi> <mml:mi>t</mml:mi> <mml:mi>x</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, we get the following set of update equations
<disp-formula id="pcbi.1006707.e049"><alternatives><graphic id="pcbi.1006707.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e049" xlink:type="simple"/><mml:math display="block" id="M49"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>α</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup> <mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>·</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>·</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>κ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msubsup><mml:mi>α</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>·</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>·</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula>
where <inline-formula id="pcbi.1006707.e050"><alternatives><graphic id="pcbi.1006707.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:msubsup><mml:mi>α</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>x</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>θ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msubsup><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>x</mml:mi></mml:msubsup></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006707.e051"><alternatives><graphic id="pcbi.1006707.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mrow><mml:msub><mml:mi>κ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Although in form similar to the DU-RW learning rules, a notable difference is that the fictive prediction error is of the same sign as the actual prediction error. The reason for this is that under the generative model the fictive learning signals are a product of the agent’s uncertainty about the current state of the world, that is, the current configuration of reward contingencies and not the uncertainty about the anti-correlation of reward contingencies on different choices. This alternative representation could be introduced into the generative model by introducing beliefs about a dependence between high and low reward probabilities. However, we will leave this extension for future work as it increases model complexity and does not contribute to our analysis of how temporal representations influence behavior.</p>
</sec>
<sec id="sec013">
<title>Responses</title>
<p>Here we will describe the response model, which defines the mapping from the agent’s beliefs to responses, based on the active inference framework [<xref ref-type="bibr" rid="pcbi.1006707.ref054">54</xref>]. We will demonstrate how a response likelihood that is often used in reinforcement learning models (in the form of a softmax transform) can be derived within this framework. We do this for didactic purposes to show how one can formally relate active inference to a well-known reinforcement learning account.</p>
<p>The core concept of active inference is that agents generate behavior that is most likely to minimize the expected free energy, that is, that tends to maximise, at the same time, the extrinsic and the epistemic value of agents’ choices [<xref ref-type="bibr" rid="pcbi.1006707.ref055">55</xref>]. The expected free energy can be defined as
<disp-formula id="pcbi.1006707.e052"><alternatives><graphic id="pcbi.1006707.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e052" xlink:type="simple"/><mml:math display="block" id="M52"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>G</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mrow><mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub> <mml:mo>[</mml:mo><mml:mrow><mml:mo>-</mml:mo> <mml:mi>U</mml:mi> <mml:mo>(</mml:mo><mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mi>L</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula>
where <inline-formula id="pcbi.1006707.e053"><alternatives><graphic id="pcbi.1006707.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <italic>U</italic>(<italic>o</italic><sub><italic>t</italic></sub>) denotes the utility of future outcomes (reward or punishment), and <italic>D</italic><sub><italic>KL</italic></sub> denotes the Kullback-Leibler divergence between the posterior (conditioned on possible future outcome and action) and prior expectations at the time step <italic>t</italic>. Note that we have assumed that the behavior is characterized by planning only a single time step into the future. Importantly, the response model maintains the causal structure of the task, where at trial <italic>t</italic> an agent first makes a choice <italic>c</italic><sub><italic>t</italic></sub> and only afterward observes an outcome <italic>o</italic><sub><italic>t</italic></sub>.</p>
<p>The first term on the right hand side of <xref ref-type="disp-formula" rid="pcbi.1006707.e052">Eq (21)</xref> is typically denoted as the extrinsic value of an action (policy) whereas the second term is denoted as epistemic value or information gain. If we express the utility <italic>U</italic> as
<disp-formula id="pcbi.1006707.e054"><alternatives><graphic id="pcbi.1006707.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e054" xlink:type="simple"/><mml:math display="block" id="M54"><mml:mrow><mml:mi>U</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:msub><mml:mi>o</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <italic>o</italic><sub><italic>t</italic></sub> ∈ {−1, 1}, and λ &gt; 0, the extrinsic value becomes
<disp-formula id="pcbi.1006707.e055"><alternatives><graphic id="pcbi.1006707.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e055" xlink:type="simple"/><mml:math display="block" id="M55"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo> <mml:mi>U</mml:mi> <mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>λ</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="right"><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
In practice, for sufficiently large λ the behavior will be fully driven by the extrinsic value, as each independent observation <italic>o</italic><sub><italic>t</italic></sub> carries little information about the underlying hidden states (a sequence of observations is required to identify the precise past moment of a reversal). In other words, each individual choice leads to a small information gain. Thus, we will assume that the expected free energy can be approximated as
<disp-formula id="pcbi.1006707.e056"><alternatives><graphic id="pcbi.1006707.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e056" xlink:type="simple"/><mml:math display="block" id="M56"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>G</mml:mi> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>≈</mml:mo> <mml:mo>-</mml:mo> <mml:mo>λ</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>The optimal action (choice) corresponds to the one that minimizes the expected free energy, thus
<disp-formula id="pcbi.1006707.e057"><alternatives><graphic id="pcbi.1006707.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e057" xlink:type="simple"/><mml:math display="block" id="M57"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix">argmin</mml:mo> <mml:mi>c</mml:mi></mml:munder> <mml:msubsup><mml:mi>G</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix">argmax</mml:mo> <mml:mi>c</mml:mi></mml:munder> <mml:msubsup><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
<p>Still, for describing participants’ behavior we have to assume that the action selection process is corrupted by external sources of noise; e.g. mental processes irrelevant for the task at hand. Therefore, we will soften the requirement of minimizing the expected free energy using the softmax transform, which is typically used to define the response likelihood [<xref ref-type="bibr" rid="pcbi.1006707.ref056">56</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref057">57</xref>]. The choice probability then becomes
<disp-formula id="pcbi.1006707.e058"><alternatives><graphic id="pcbi.1006707.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e058" xlink:type="simple"/><mml:math display="block" id="M58"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>c</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>o</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>β</mml:mi> <mml:msubsup><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:mtext>ln</mml:mtext><mml:mspace width="2pt"/> <mml:msub><mml:mi>p</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>u</mml:mi></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>β</mml:mi> <mml:msubsup><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>u</mml:mi></mml:msubsup> <mml:mo>+</mml:mo><mml:mtext>ln</mml:mtext><mml:mspace width="2pt"/><mml:msub><mml:mi>p</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
where <italic>β</italic> denotes the response precision and <italic>p</italic><sub>0</sub>(<italic>c</italic>) the response bias. These two parameters are the free parameters of the response model and allow us to capture participants’ deviation from optimal behavior when fitting models to the data.</p>
<p>Finally, in the case of the DU-RW model, we will use the same form of the response likelihood as above, with the difference that the choice value <inline-formula id="pcbi.1006707.e059"><alternatives><graphic id="pcbi.1006707.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec014">
<title>Model fitting and model comparison</title>
<p>When fitting models to behavior we have focused our analysis on either the DU-RW or the ED-HMM model, where we have used in both cases a hierarchical prior over free model parameters (see below for details). We will not consider the SU-RW and HMM models in model comparison as they represent special cases of the DU-RW and the ED-HMM model, respectively, which are obtained in the limit of <italic>κ</italic> → 0, in the case of the DU-RW model, and <italic>r</italic> → 1 in the case of the ED-HMM model. Hence, we can easily recover these special cases from the estimates of the posterior distributions of the free model parameters, which are summarized in <xref ref-type="table" rid="pcbi.1006707.t001">Table 1</xref>.</p>
<table-wrap id="pcbi.1006707.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006707.t001</object-id>
<label>Table 1</label>
<caption>
<title>Free parameters, their transform, and interpretation for the two behavioral models.</title>
<p>The model parameters are grouped based on whether they shape the inference (learning) or the behavioral responses. Note that the DU-RW and ED-HMM share the same mapping from beliefs into responses (see <xref ref-type="disp-formula" rid="pcbi.1006707.e058">Eq (22)</xref>).</p>
</caption>
<alternatives>
<graphic id="pcbi.1006707.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006707.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" style="border-bottom:thick">Model</th>
<th align="left" style="border-bottom:thick">Parameter</th>
<th align="left" style="border-bottom:thick">Transform</th>
<th align="left" style="border-bottom:thick">Interpretation</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="3">DU-RW</td>
<td align="left"><italic>α</italic></td>
<td align="left">
<inline-formula id="pcbi.1006707.e060">
<alternatives>
<graphic id="pcbi.1006707.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e060" xlink:type="simple"/>
<mml:math display="inline" id="M60">
<mml:mfrac>
<mml:msub>
<mml:mo>λ</mml:mo>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mo>λ</mml:mo>
<mml:mn>1</mml:mn>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left">learning rate</td>
</tr>
<tr>
<td align="left"><italic>κ</italic></td>
<td align="left">
<inline-formula id="pcbi.1006707.e061">
<alternatives>
<graphic id="pcbi.1006707.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e061" xlink:type="simple"/>
<mml:math display="inline" id="M61">
<mml:mfrac>
<mml:msub>
<mml:mo>λ</mml:mo>
<mml:mn>2</mml:mn>
</mml:msub>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mo>λ</mml:mo>
<mml:mn>2</mml:mn>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left">coupling strength</td>
</tr>
<tr>
<td align="left">
<inline-formula id="pcbi.1006707.e062">
<alternatives>
<graphic id="pcbi.1006707.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e062" xlink:type="simple"/>
<mml:math display="inline" id="M62">
<mml:msubsup>
<mml:mi>V</mml:mi>
<mml:mn>0</mml:mn>
<mml:mi>A</mml:mi>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>, <inline-formula id="pcbi.1006707.e063"><alternatives><graphic id="pcbi.1006707.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:msubsup><mml:mi>V</mml:mi> <mml:mn>0</mml:mn> <mml:mi>B</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula></td>
<td align="left">
<inline-formula id="pcbi.1006707.e064">
<alternatives>
<graphic id="pcbi.1006707.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e064" xlink:type="simple"/>
<mml:math display="inline" id="M64">
<mml:mfrac>
<mml:mrow>
<mml:msub>
<mml:mo>λ</mml:mo>
<mml:mn>3</mml:mn>
</mml:msub>
<mml:mo>-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mo>λ</mml:mo>
<mml:mn>3</mml:mn>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:mfrac>
</mml:math>
</alternatives>
</inline-formula>, <inline-formula id="pcbi.1006707.e065"><alternatives><graphic id="pcbi.1006707.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mn>4</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula></td>
<td align="left">initial choice values</td>
</tr>
<tr>
<td align="left" rowspan="3">ED-HMM</td>
<td align="left"><italic>δ</italic></td>
<td align="left">
<inline-formula id="pcbi.1006707.e066">
<alternatives>
<graphic id="pcbi.1006707.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e066" xlink:type="simple"/>
<mml:math display="inline" id="M66">
<mml:mfrac>
<mml:msub>
<mml:mo>λ</mml:mo>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mo>λ</mml:mo>
<mml:mn>1</mml:mn>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left">rate of prior beliefs</td>
</tr>
<tr>
<td align="left"><italic>r</italic></td>
<td align="left">1 + λ<sub>2</sub></td>
<td align="left">shape of prior beliefs</td>
</tr>
<tr>
<td align="left">
<inline-formula id="pcbi.1006707.e067">
<alternatives>
<graphic id="pcbi.1006707.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e067" xlink:type="simple"/>
<mml:math display="inline" id="M67">
<mml:msubsup>
<mml:mi>μ</mml:mi>
<mml:mn>0</mml:mn>
<mml:mi>A</mml:mi>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>, <inline-formula id="pcbi.1006707.e068"><alternatives><graphic id="pcbi.1006707.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:msubsup><mml:mi>μ</mml:mi> <mml:mn>0</mml:mn> <mml:mi>B</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula></td>
<td align="left">
<inline-formula id="pcbi.1006707.e069">
<alternatives>
<graphic id="pcbi.1006707.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e069" xlink:type="simple"/>
<mml:math display="inline" id="M69">
<mml:mfrac>
<mml:msub>
<mml:mo>λ</mml:mo>
<mml:mn>3</mml:mn>
</mml:msub>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mo>λ</mml:mo>
<mml:mn>3</mml:mn>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:math>
</alternatives>
</inline-formula>,<inline-formula id="pcbi.1006707.e070"><alternatives><graphic id="pcbi.1006707.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula></td>
<td align="left">initial expectations</td>
</tr>
<tr>
<td align="left" rowspan="2">response</td>
<td align="left"><italic>β</italic></td>
<td align="left">
<inline-formula id="pcbi.1006707.e071">
<alternatives>
<graphic id="pcbi.1006707.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e071" xlink:type="simple"/>
<mml:math display="inline" id="M71">
<mml:mfrac>
<mml:msub>
<mml:mo>λ</mml:mo>
<mml:mn>5</mml:mn>
</mml:msub>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mo>λ</mml:mo>
<mml:mn>5</mml:mn>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left">response precision</td>
</tr>
<tr>
<td align="left"><italic>p</italic><sub>0</sub>(<italic>c</italic> = <italic>A</italic>)</td>
<td align="left">
<inline-formula id="pcbi.1006707.e072">
<alternatives>
<graphic id="pcbi.1006707.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e072" xlink:type="simple"/>
<mml:math display="inline" id="M72">
<mml:mfrac>
<mml:msub>
<mml:mo>λ</mml:mo>
<mml:mn>6</mml:mn>
</mml:msub>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mo>λ</mml:mo>
<mml:mn>6</mml:mn>
</mml:msub>
</mml:mrow>
</mml:mfrac>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left">response bias</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Note that the parameters <inline-formula id="pcbi.1006707.e073"><alternatives><graphic id="pcbi.1006707.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:msubsup><mml:mi>ν</mml:mi> <mml:mn>0</mml:mn> <mml:mi>A</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006707.e074"><alternatives><graphic id="pcbi.1006707.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:msubsup><mml:mi>ν</mml:mi> <mml:mn>0</mml:mn> <mml:mi>B</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> of the ED-HMM model (see <xref ref-type="disp-formula" rid="pcbi.1006707.e046">Eq (19)</xref>), which define the initial number of observations, have been fixed to values which reflect that participants underwent a 20 trials long training session. Hence, setting <inline-formula id="pcbi.1006707.e075"><alternatives><graphic id="pcbi.1006707.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:mrow><mml:msubsup><mml:mi>ν</mml:mi> <mml:mn>0</mml:mn> <mml:mi>A</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>ν</mml:mi> <mml:mn>0</mml:mn> <mml:mi>B</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>10</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> reflects our assumption that participants selected both options in equal amounts during the training session.</p>
<p>To estimate the posterior distribution over free model parameters we have used the above defined response model as observation likelihood of the behavioral model. Hence, the likelihood of behavior (the sequence of a participant’s responses) is defined as
<disp-formula id="pcbi.1006707.e076"><alternatives><graphic id="pcbi.1006707.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e076" xlink:type="simple"/><mml:math display="block" id="M76"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>o</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>Λ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:munderover> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>c</mml:mi> <mml:mi>t</mml:mi> <mml:mi>n</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>o</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>Λ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
where <inline-formula id="pcbi.1006707.e077"><alternatives><graphic id="pcbi.1006707.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> denotes the sequence of responses of the <italic>n</italic>th participant (<italic>n</italic> ∈ {1, …, 22}), <inline-formula id="pcbi.1006707.e078"><alternatives><graphic id="pcbi.1006707.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:msubsup><mml:mi>o</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> denotes the sequence of observations (wins or losses) that the <italic>n</italic>th participant made, Λ denotes the set of free model parameters, and <italic>m</italic> ∈ {1, 2} denotes the corresponding behavioral model.</p>
<p>To define the prior distribution over model parameters we have used the so-called horseshoe prior as a weakly informative hierarchical prior. If we denote the <italic>i</italic>th model parameter (where <italic>i</italic> ∈ {1, …, 6}) of the <italic>n</italic>th participant as <inline-formula id="pcbi.1006707.e079"><alternatives><graphic id="pcbi.1006707.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, the horseshoe prior is defined as
<disp-formula id="pcbi.1006707.e080"><alternatives><graphic id="pcbi.1006707.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e080" xlink:type="simple"/><mml:math display="block" id="M80"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>C</mml:mi> <mml:mo>+</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>C</mml:mi> <mml:mo>+</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula>
where <italic>C</italic><sup>+</sup>(<italic>x</italic>; 0, <italic>γ</italic>) denotes a half-Cauchy distribution with scale parameter <italic>γ</italic>. Hence, the full hierarchical prior for the model <italic>m</italic> can be expressed as
<disp-formula id="pcbi.1006707.e081"><alternatives><graphic id="pcbi.1006707.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e081" xlink:type="simple"/><mml:math display="block" id="M81"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:mo>λ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>|</mml:mo> <mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>22</mml:mn></mml:munderover> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>6</mml:mn></mml:munderover> <mml:msup><mml:mi>C</mml:mi> <mml:mo>+</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>C</mml:mi> <mml:mo>+</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>τ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula>
Note that <italic>τ</italic><sub><italic>i</italic></sub> acts as a hyper-prior, which plays the role of regulating the prior scale, for the corresponding free parameter, over the whole group. As <inline-formula id="pcbi.1006707.e082"><alternatives><graphic id="pcbi.1006707.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is a positive definite variable, we have used specific transforms to relate each <inline-formula id="pcbi.1006707.e083"><alternatives><graphic id="pcbi.1006707.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> parameter to the corresponding model parameter (see <xref ref-type="table" rid="pcbi.1006707.t001">Table 1</xref>).</p>
<p>The posterior probability over model parameters can be obtain from the Bayes rule as follows
<disp-formula id="pcbi.1006707.e084"><alternatives><graphic id="pcbi.1006707.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e084" xlink:type="simple"/><mml:math display="block" id="M84"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:mo>λ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>|</mml:mo> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo> <mml:mi>O</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>22</mml:mn></mml:munderover> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>o</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:mo>λ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>|</mml:mo> <mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula>
where <inline-formula id="pcbi.1006707.e085"><alternatives><graphic id="pcbi.1006707.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:mrow><mml:mi>C</mml:mi> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>22</mml:mn></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006707.e086"><alternatives><graphic id="pcbi.1006707.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:mrow><mml:mi>O</mml:mi> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>o</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>o</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>22</mml:mn></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. However, the exact posterior distribution of the model parameters and their hyper-priors is analytically intractable, hence we have applied the variational mean-field approximation, in which one assumes that the posterior is fully factorized
<disp-formula id="pcbi.1006707.e087"><alternatives><graphic id="pcbi.1006707.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e087" xlink:type="simple"/><mml:math display="block" id="M87"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:mo>λ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>|</mml:mo> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo> <mml:mi>O</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>τ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(27)</label></disp-formula>
The full hierarchical model was implemented in the probabilistic programing library PyMC3 [<xref ref-type="bibr" rid="pcbi.1006707.ref058">58</xref>]. The PyMC3 library provides an interface to multiple state-of-the-art inference schemes. In our specific case, for estimating the approximate posterior distribution over model parameters, we have used the PyMC3 implementation of the automatic differentiation variational inference (ADVI) [<xref ref-type="bibr" rid="pcbi.1006707.ref059">59</xref>]. ADVI is a stochastic black-box variational inference scheme which returns an approximate estimate of the posterior distribution in a fully factorized form.</p>
<p>To attribute participants’ behavior to a specific behavioral model we have assumed that models can be treated as random effects (variables), that is, the attribution of a model to participants’ behavior can differ across participants [<xref ref-type="bibr" rid="pcbi.1006707.ref060">60</xref>]. Furthremore, we have based Bayesian model comparison on the posterior predictive model evidence [<xref ref-type="bibr" rid="pcbi.1006707.ref061">61</xref>] instead of the full model evidence, that is marginal likelihood. The motivation for basing model comparison on the posterior predictive model evidence comes from the fact that the posterior predictive model evidence is less sensitive to a prior specification of free model parameters: the approximate estimate of the predictive evidence is based on the samples from the posterior distribution which is already constrained by the subset of the behavioral data. This procedure provides for a more robust model comparison and testing results as it resolves some issues arising when using weakly-informative or misspecified prior probabilities [<xref ref-type="bibr" rid="pcbi.1006707.ref061">61</xref>]. The posterior predictive model evidence is defined as a marginal expectation of the subset of behavioral responses <italic>C</italic><sub><italic>T</italic>:<italic>k</italic></sub> condition on the behavioral responses up to the <italic>k</italic>th trial (<italic>C</italic><sub><italic>k</italic>:1</sub>) and the full set of outcomes presented to participants (<italic>O</italic>). Formally, we can define the posterior predictive model evidence as
<disp-formula id="pcbi.1006707.e088"><alternatives><graphic id="pcbi.1006707.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e088" xlink:type="simple"/><mml:math display="block" id="M88"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi>O</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi>O</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi>O</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mtext>d</mml:mtext><mml:mo>λ</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:munderover> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>c</mml:mi> <mml:mi>t</mml:mi> <mml:mi>n</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>o</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mi>n</mml:mi></mml:msup> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mi>n</mml:mi></mml:msup> <mml:mo>|</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>≈</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:munderover> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>c</mml:mi> <mml:mi>t</mml:mi> <mml:mi>n</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>o</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>l</mml:mi> <mml:mi>n</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(28)</label></disp-formula>
where <inline-formula id="pcbi.1006707.e089"><alternatives><graphic id="pcbi.1006707.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:mrow><mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mi>n</mml:mi></mml:msup> <mml:mo>|</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and <italic>N</italic> = 10<sup>4</sup>. Note that to estimate the posterior predictive model evidence we have first estimated the approximate posterior over free model parameters on a reduced data set consisting of the pre-reversal and reversal phases (<italic>k</italic> = 125). Then, we generated <italic>N</italic> samples from the posterior distribution to estimate the posterior predictive model evidence on the remaining part of behavioral data <italic>C</italic><sub><italic>T</italic>:<italic>k</italic></sub> which covers only the post-reversal phase (see <xref ref-type="fig" rid="pcbi.1006707.g001">Fig 1</xref>).</p>
<p>We then used the posterior predictive model evidence as the likelihood of the random effect model proposed in [<xref ref-type="bibr" rid="pcbi.1006707.ref060">60</xref>]. The goal here is to identify the posterior probability that each of the two behavioral models can generate the same sequence of behavioral response as participants. Here we have defined the random effect model as the following mixture model
<disp-formula id="pcbi.1006707.e090"><alternatives><graphic id="pcbi.1006707.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e090" xlink:type="simple"/><mml:math display="block" id="M90"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>,</mml:mo> <mml:mi>π</mml:mi> <mml:mo>,</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>O</mml:mi> <mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>O</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:mi>π</mml:mi> <mml:mo>|</mml:mo> <mml:mi>γ</mml:mi><mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:mi>γ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(29)</label></disp-formula>
where
<disp-formula id="pcbi.1006707.e091"><alternatives><graphic id="pcbi.1006707.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e091" xlink:type="simple"/><mml:math display="block" id="M91"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>O</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>22</mml:mn></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:munderover> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>:</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi>O</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>π</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>π</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:munderover> <mml:msubsup><mml:mi>π</mml:mi> <mml:mrow><mml:mi>l</mml:mi></mml:mrow> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:msubsup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:mi>π</mml:mi> <mml:mo>|</mml:mo> <mml:mi>γ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>γ</mml:mi></mml:mfrac> <mml:mo>,</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>γ</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:munderover> <mml:msubsup><mml:mi>π</mml:mi> <mml:mrow><mml:mi>l</mml:mi></mml:mrow> <mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>γ</mml:mi></mml:mfrac> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo><mml:mi>γ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mi>C</mml:mi> <mml:mo>+</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo><mml:mi>γ</mml:mi> <mml:mo>;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(30)</label></disp-formula>
Similar to the role of the hyperpriors on the parameters of the behavioral model, <italic>γ</italic> plays here the role of a regularization parameter that allows for data driven constraints of the random effects assumption. If the marginal posterior probability over <italic>γ</italic> shrinks towards zero, this implies that data supports a null hypothesis which states that all models are present in the population with the same frequency and any differences we observe are purely chance driven [<xref ref-type="bibr" rid="pcbi.1006707.ref060">60</xref>].</p>
<p>As above, the random effects model selection was implemented in PyMC3, where the estimation of the posterior was performed using the PyMC3 implementation of the ADVI procedure. A fully factorized approximate posterior
<disp-formula id="pcbi.1006707.e092"><alternatives><graphic id="pcbi.1006707.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e092" xlink:type="simple"/><mml:math display="block" id="M92"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:mi>π</mml:mi> <mml:mo>,</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>|</mml:mo> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo> <mml:mi>O</mml:mi><mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo><mml:mi>γ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(31)</label></disp-formula>
provides us with an estimate of the posterior model probability <italic>q</italic>(<italic>π</italic>). The posterior model probability can then be used to identify group level posterior estimate over possible model frequencies in the group of participants and the participant specific posterior model probability.</p>
</sec>
</sec>
<sec id="sec015" sec-type="results">
<title>Results</title>
<sec id="sec016">
<title>Simulating behavior</title>
<p>To illustrate how the agent’s performance depends on the agent’s prior beliefs over the between reversal interval <italic>p</italic><sub>0</sub>(<italic>d</italic>) we will start by comparing two special cases of the ED-HMM based behavioral model using synthetic data. In the first case, we will fix the variance <italic>σ</italic> of the prior beliefs <italic>p</italic><sub>0</sub>(<italic>d</italic>) to <italic>σ</italic> = <italic>μ</italic>(1 − <italic>μ</italic>), which we named irregular reversal interval (IRI) agent. In the second case, we will fix the variance to <italic>σ</italic> = <italic>μ</italic>, which we named regular reversal interval (RRI) agent. In addition, we will compare the performance of the two probabilistic behavioral models to the single (SU) and dual update (DU) Rescorla-Wagner (RW) models introduced in Eqs <xref ref-type="disp-formula" rid="pcbi.1006707.e001">(1)</xref> and <xref ref-type="disp-formula" rid="pcbi.1006707.e005">(2)</xref>, respectively.</p>
<p>To illustrate the behavioral difference of different computational models we have modified the experimental setup and introduced two conditions in which reversals occur either at regular or irregular intervals, as shown in <xref ref-type="fig" rid="pcbi.1006707.g005">Fig 5</xref>. These two conditions allow us to make clear distinction between different behavioral models with respect to their behavior in the presence or absence of regularities.</p>
<fig id="pcbi.1006707.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006707.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Example of a reversal schedule for simulated data.</title>
<p>In the condition with irregular reversals, the between reversal intervals were sampled from a geometric distribution (top right plot), whereas in the condition with (semi)regular reversals, the intervals were sampled from the negative binomial distribution with variance <italic>σ</italic> = 20 (bottom right plot). In both cases the mean interval duration is set to <italic>μ</italic> = 20.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006707.g005" xlink:type="simple"/>
</fig>
<p>In all simulated experiments we fixed the number of trials to <italic>T</italic> = 160 and the number of experimental blocks to <italic>n</italic> = 1000. Hence, each simulated agent repeated the experiment <italic>n</italic> times, where at the beginning of each experiment the free model parameters (besides mean and variance) of the ED-HMM based agents (IRI and RRI) were set to the following values
<disp-formula id="pcbi.1006707.e093"><alternatives><graphic id="pcbi.1006707.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006707.e093" xlink:type="simple"/><mml:math display="block" id="M93"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mi>A</mml:mi></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mn>8</mml:mn> <mml:mo>;</mml:mo> <mml:mspace width="0.222222em"/><mml:mspace width="0.222222em"/><mml:msubsup><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mi>A</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mi>B</mml:mi></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mo>;</mml:mo> <mml:mspace width="0.222222em"/><mml:mspace width="0.222222em"/><mml:msubsup><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mi>B</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>8</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>V</mml:mi> <mml:mn>0</mml:mn> <mml:mi>A</mml:mi></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>;</mml:mo> <mml:mspace width="0.222222em"/><mml:mspace width="0.222222em"/><mml:msubsup><mml:mi>V</mml:mi> <mml:mn>0</mml:mn> <mml:mi>B</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>d</mml:mi> <mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>d</mml:mi> <mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(32)</label></disp-formula>
In other words, simulated agents have a loose initial knowledge of the underlying reward probabilities, but do not know the initial configuration of the task (whether the environment is initially in the reversal or the no-reversal state).</p>
<p>
<xref ref-type="fig" rid="pcbi.1006707.g006">Fig 6</xref> shows the dependence of the agent’s performance on its prior beliefs about the between reversal interval in two different environments. We have defined the performance as the fraction of correct choices (the choice associated with the higher reward probability). The irregular environment corresponds to the interval duration drawn from the geometric distribution with mean <italic>μ</italic> = 20 and variance <italic>σ</italic> = <italic>μ</italic>(<italic>μ</italic> − 1), and the semi-regular environment corresponds to interval durations drawn from the negative binomial distribution with mean <italic>μ</italic> = 20 and variance <italic>σ</italic> = <italic>μ</italic>, as illustrated previously in <xref ref-type="fig" rid="pcbi.1006707.g005">Fig 5</xref>.</p>
<fig id="pcbi.1006707.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006707.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Performance as a function of the expected interval duration for ED-HMM based agents.</title>
<p>The shaded regions show the performance quartiles estimated over <italic>n</italic> = 1000 simulated experiments, in two different task environments. Left: In the first environment, reversals occur at irregular intervals. The irregular reversal interval (IRI) agent (red) corresponds to the case where prior beliefs over interval duration follow a geometric distribution (see <xref ref-type="disp-formula" rid="pcbi.1006707.e012">Eq (5)</xref>), with mean <italic>μ</italic> and variance <italic>σ</italic> = <italic>μ</italic>(<italic>μ</italic> − 1). This agent expects reversals at irregular intervals. The regular reversal agent (RRI) (blue) corresponds to the prior beliefs in the form of the negative binomial distribution, with mean <italic>μ</italic> and variance <italic>σ</italic> = <italic>μ</italic>. This agent expects reversals at (semi)regular intervals. The true distribution of between reversal intervals in both conditions is depicted in <xref ref-type="fig" rid="pcbi.1006707.g005">Fig 5</xref>. Right: Same as left plot but the environment has semi-regular intervals encoded by <italic>μ</italic> = 20 and <italic>σ</italic> = 20. As expected, we find that the RRI agent is highly sensitive to the misspecification of the expected interval duration <italic>μ</italic> and variability of interval durations in different conditions, while the IRI agent shows a much better performance in the irregular environment. The lower row shows the average probability of making a correct choice relative to the point of reversal, denoted by the vertical black dashed line.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006707.g006" xlink:type="simple"/>
</fig>
<p>The IRI agent exhibits stable performance levels independent on the environment or a belief misspecification (incorrect mean interval duration, or incorrect variability around the mean). In contrast, the performance of the RRI model strongly depends on the correctness of the prior beliefs. These results make the rather intuitive point that if one is unfamiliar with the temporal structure of the environment, assigning high uncertainty to the expected state duration (as is the case for the IRI agent) ensures reasonably high levels of performance. However, if the environment changes at regular intervals, it is worthwhile to build an accurate representation of the temporal structure, as the performance levels can drastically increase (in this example from 81% to 87% of median performance levels).</p>
<p>
<xref ref-type="fig" rid="pcbi.1006707.g007">Fig 7</xref> shows the comparison of the performance distribution between four models; the probabilistic agents IRI and RRI, and the two reinforcement learning based agents with single update (SU-RW) and dual update (DU-RW) learning rules. The free model parameters (<italic>α</italic> and <italic>κ</italic>, see <xref ref-type="table" rid="pcbi.1006707.t001">Table 1</xref>) of the SU-RW and DU-RW agents were fixed to those values that maximize the average performance levels in each environment. Importantly, when comparing the performance distribution of the DU-RW agent to the performance distribution of the IRI agent we find similar average performance per trial which is stable across environments. This finding suggests that in spite of subtle differences in learning rules (see Eqs <xref ref-type="disp-formula" rid="pcbi.1006707.e005">(2)</xref> and <xref ref-type="disp-formula" rid="pcbi.1006707.e049">(20)</xref>) the two agents generate very similar behavior.</p>
<fig id="pcbi.1006707.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006707.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Performance distributions of all four behavioral models in two different environments.</title>
<p>Here we compare the performance distributions of four different agents: irregular reversal interval (IRI) agent, regular reversal interval (RRI) agent, single-update Rescorla-Wagner(SU-RW) agent (<xref ref-type="disp-formula" rid="pcbi.1006707.e001">Eq (1)</xref>) and dual-update Rescorla-Wagner (DU-RW) agent (<xref ref-type="disp-formula" rid="pcbi.1006707.e005">Eq (2)</xref>). The free model parameters were fixed as follows (see main text for more details): (IRI) <italic>μ</italic> = 20, and <italic>σ</italic> = <italic>μ</italic>(<italic>μ</italic> − 1); (RRI) <italic>μ</italic> = 20, and <italic>σ</italic> = <italic>μ</italic>; (SU-RW) <italic>α</italic> = .25 and <italic>κ</italic> = 0; (DU-RW) <italic>α</italic> = .25 and <italic>κ</italic> = 1. Interestingly, the results show that the DU-RW agent achieves similar performance levels in both environments, with average responses closely following that of the IRI agent (see lower row). In contrast, the SU-RW agent shows only medium level performance in both environments with a significant increase of performance with irregular reversals. As in <xref ref-type="fig" rid="pcbi.1006707.g006">Fig 6</xref>, the RRI agent performs best, among all agents, when exposed to semi-regular reversals, but has the worst performance, among all agents, when exposed to irregular reversals.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006707.g007" xlink:type="simple"/>
</fig>
<p>To investigate the accuracy of the procedure for model comparison which we described in Model fitting and model comparison, we have simulated behavior of the ED-HMM based and the reinforcement learning based agents on the experimental task, and applied the same model inversion procedure which we used for the analysis of behavioral data below. In <xref ref-type="fig" rid="pcbi.1006707.g008">Fig 8A</xref> we show the average performance per trial for each agent type estimated over <italic>n</italic> = 1000 repetitions of the experimental task. <xref ref-type="fig" rid="pcbi.1006707.g008">Fig 8B</xref> shows the probability of assigning behavior of each type of agents to the correct model type. The confusion matrix was estimated over <italic>n</italic> = 100 simulated experimental blocks, where in half of the experimental blocks ED-HMM based agents (IRI and RRI) were used to generate behavioral responses and in the other half of the experimental blocks the reinforcement learning agents (SU-RW and DU-RW) were used to generate behavioral responses. The rather high mixing probability of the confusion matrix suggests that the model comparison will have difficulties distinguishing properly between the models. Nevertheless, adjusting the experimental design to contain larger number of trials, that is, more data points for estimating posterior and model evidence, is likely to make model comparison more accurate.</p>
<fig id="pcbi.1006707.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006707.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Agents performance on the experimental task and model comparison.</title>
<p><bold>A:</bold> Per trial performance (probability of making a correct choice) of four different agent types: irregular reversal interval (IRI) agent, regular reversal interval (RRI) agent, single-update Rescorla-Wagner(SU-RW) agent (<xref ref-type="disp-formula" rid="pcbi.1006707.e001">Eq (1)</xref>) and dual-update Rescorla-Wagner (DU-RW) agent (<xref ref-type="disp-formula" rid="pcbi.1006707.e005">Eq (2)</xref>). The free model parameters were fixed as follows: (IRI) <italic>μ</italic> = 20, and <italic>σ</italic> = <italic>μ</italic>(<italic>μ</italic> − 1); (RRI) <italic>μ</italic> = 20, and <italic>σ</italic> = 120; (SU-RW) <italic>α</italic> = .25 and <italic>κ</italic> = 0; (DU-RW) <italic>α</italic> = .25 and <italic>κ</italic> = 1. The parameters were fixed in a way that all models have comparable median performance levels (around 0.83). <bold>B:</bold> Confusion matrix showing the probability of assigning simulated behavior of different agents to the two different types of behavioral models. Note that as in <xref ref-type="fig" rid="pcbi.1006707.g007">Fig 7</xref> the IRI and DU-RW agents generate very similar average responses across the experiment. This suggest a difficulty in distinguishing between these two type of models, which is also reflected in the confusion matrix that shows rather high mixing probability.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006707.g008" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec017">
<title>Data analysis</title>
<p>Here we will present model comparisons and model fitting based on the behavioral data of 22 participants. As the SU-RW model was shown in previous studies to provide a worse account for behavior than the DU-RW model [<xref ref-type="bibr" rid="pcbi.1006707.ref040">40</xref>], we do not expect the SU-RW model to explain the behavioral data better than the other models. Moreover, as our simulations indicate that the HMM and DU-RW models provide for comparable response patterns (see <xref ref-type="fig" rid="pcbi.1006707.g007">Fig 7</xref>), we will use only the DU-RW model as a reference model, as this model was used in a previous study based on the same data [<xref ref-type="bibr" rid="pcbi.1006707.ref039">39</xref>].</p>
<p>To circumvent a potential sensitivity of the model evidence to the specification of the prior distribution for the free model parameters, we have based our analysis on the posterior predictive model evidence (see Model fitting and model comparison for details). As the posterior predictive model evidence is estimated from the posterior distribution, rather than the prior (see <xref ref-type="disp-formula" rid="pcbi.1006707.e088">Eq (28)</xref>), it is more robust to mis-specification of the prior, given a sufficient amount of data in the predictive sample. Hence, to estimate the posterior predictive evidence we have split the behavioral data for each participant into two sets. The first set, containing the initial 125 trials, that is the pre-reversal phase and the reversal phase of the experiment (see <xref ref-type="fig" rid="pcbi.1006707.g001">Fig 1</xref>), we used for estimating posterior distributions of free model parameters (see <xref ref-type="table" rid="pcbi.1006707.t001">Table 1</xref>). Note that as this set contains all but the last reversal, it should provide sufficient information to constrain the posterior model parameters. The reversal phase of the experiment is the only period which participants can use to shape their beliefs about the time structure of reversals.</p>
<p>The second set, containing the last 35 trials, that is, the post-reversal phase (see <xref ref-type="fig" rid="pcbi.1006707.g001">Fig 1</xref>), we used for Bayesian model comparison and model validation. Critically, as no reversals are present in the post-reversal phase, this phase is especially suited for model selection: If participants believe that a reversal will occur at specific moments during the post-reversal phase this belief should be reflected in their behavior; e.g., they might change their choices in anticipation of a reversal.</p>
<p>In <xref ref-type="fig" rid="pcbi.1006707.g009">Fig 9</xref> we show the results at both the group level and the individual level, using Bayesian model comparison based on the posterior predictive model evidence. Although the group level results suggest substantial evidence in favor of the DU-RW model (see <xref ref-type="fig" rid="pcbi.1006707.g009">Fig 9A</xref>), we can still identify six participants for which we find higher model attribution (a participant specific posterior model probability) of the ED-HMM based model (see <xref ref-type="fig" rid="pcbi.1006707.g009">Fig 9B</xref>). The exact values of the predictive log model evidence (used for model comparison) and per subject model attribution are shown in <xref ref-type="supplementary-material" rid="pcbi.1006707.s001">S1 Table</xref>.</p>
<fig id="pcbi.1006707.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006707.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Bayesian model comparison.</title>
<p><bold>A:</bold> Posterior distribution of the frequency of the ED-HMM based model within the studied group of participants. The dashed line denotes the border at which both DU-RW and ED-HMM based models are equally likely. Hence, the probability mass on the right side of the dashed line (where ED-HMM has higher frequency within the population) corresponds to the exceedance probability (ep) of the ED-HMM based model (<italic>ep</italic> = 0.215). <bold>B:</bold> the color codes denote posterior model probability for each participant. The lighter the color the better the given model predicts behavior of the given participant during the post-reversal phase.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006707.g009" xlink:type="simple"/>
</fig>
<p>We next asked the question whether there is some systematic behavioral difference between these six and the remaining eighteen participants. Thus, we compared the averaged responses of participants belonging to the ED-HMM group and the participants belonging to the DU-RW group. In <xref ref-type="fig" rid="pcbi.1006707.g010">Fig 10</xref> we show the choice probability averaged for each of the two groups. Tellingly, the ED-HMM group (blue line) exhibits a sudden switch toward the alternative choice approximately 20 trials after the start of post-reversal phase. Note that no reversals were induced in this phase. This result suggests that participants belonging to the group for which the ED-HMM model has higher posterior evidence behaved as if they were expecting another reversal 20 trials after the last one. This indicates that they have used the reversal phase to infer the reversal frequency and regularity.</p>
<fig id="pcbi.1006707.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006707.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Mean participant responses during the post-reversal phase.</title>
<p><bold>A</bold>: Average response across the two groups of participants, where one group (red line) is best described by the DU-RW model, and the other group (blue line) by the ED-HMM. The shaded area marks the 90% Jeffreys interval. <bold>B</bold>: Difference between mean group responses (black line), where the shaded area marks the 5th-95th percentile (light cyan) and the 25th-75th percentile (dark cyan) of the group response differences obtained from 10<sup>4</sup> random allocations of participants into groups of size 6 and 16. The peak of the response difference (at the 21st trial after the start of the post-reversal phase) lies well above the 95th percentile.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006707.g010" xlink:type="simple"/>
</fig>
<p>If the ED-HMM model indeed captures this aspect of behavior better than the DU-RW model, we would expect to see a similar trend in the response probabilities estimated from the two behavioral models. For this we estimated the response probability for each participant under each of the two models and averaged responses according to group. In <xref ref-type="fig" rid="pcbi.1006707.g011">Fig 11</xref> we show the between model comparison of the estimated response probabilities for the two groups of participants. Although the mean response of the DU-RW model also shows a trough towards the alternative choice (when conditioned on the participants in the ED-HMM group), we see a much wider excursion in the mean response probability obtained using the ED-HMM, explaining its higher predictive model evidence for this group of participants. Still, it is important to note that the presence of the trough in the mean response probability of both models suggest that the change of response probability towards the alternative choice was driven by the specific sequence of outcomes that participants observed during this time window of the post-reversal phase. In other words, it seems that the participants that were assigned to the ED-HMM group were sensitive to a short sequence of negative outcomes, as if they were expecting another reversal during the post-reversal phase.</p>
<fig id="pcbi.1006707.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006707.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Model based mean response probabilities during the post-reversal phase.</title>
<p>Response probabilities estimated from the DU-RW model (left) and ED-HMM model (right) and averaged over the two groups of participants: (blue line) The participants for which ED-HMM has higher model attribution, and (red line) participants for which DU-RW has higher model attribution. The shaded area corresponds to the 90% confidence interval of the group mean response probability.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006707.g011" xlink:type="simple"/>
</fig>
<p>In <xref ref-type="fig" rid="pcbi.1006707.g012">Fig 12</xref> we show the posterior estimates of the expected reversal probability <italic>δ</italic><sub><italic>τ</italic></sub> for all participants of the ED-HMM group. The expected reversal probability was estimated from State durations and corresponds to the measure illustrated in <xref ref-type="fig" rid="pcbi.1006707.g004">Fig 4</xref>. Note that for four out of the six participants we find the peak of the reversal probability to fall before <italic>τ</italic> = 20, that is, before the 20th trial within the post-reversal phase. For the other two we see a rather flat trajectory which suggests that these subjects behave close to the IRI agents. Although these results seem to be in contrast to our previous findings (that these six participants anticipated the change on the 20th trial of the post reversal phase), the expected reversal probability does not correspond to the expected response probability for a specific participant. The relation between these two quantities is non-linear and is also shaped by the sequence of outcomes.</p>
<fig id="pcbi.1006707.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006707.g012</object-id>
<label>Fig 12</label>
<caption>
<title>Posterior estimate of the expected reversal probability.</title>
<p>The participants’ specific beliefs about the probability of reversal within the post-reversal phase, for all participants for which the ED-HMM model had higher posterior model evidence. The reversal probability is fully characterized by two parameters <italic>δ</italic>, and <italic>r</italic> (see Eqs <xref ref-type="disp-formula" rid="pcbi.1006707.e016">(8)</xref> and <xref ref-type="disp-formula" rid="pcbi.1006707.e019">(9)</xref>). Each light blue line corresponds to the trajectory obtained as a single sample from the posterior estimates over <italic>δ</italic> and <italic>r</italic>, whereas black lines correspond to the trajectory obtained from the mean posterior parameter estimates <italic>μ</italic><sub><italic>r</italic></sub> and <italic>μ</italic><sub><italic>δ</italic></sub>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006707.g012" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec018" sec-type="conclusions">
<title>Discussion</title>
<p>The ability to represent complex temporal structures and to use these representations in everyday decision-making is one of the key features of human adaptive behavior [<xref ref-type="bibr" rid="pcbi.1006707.ref062">62</xref>]. However, the computational mechanisms that underlie these aspect of behavior are still poorly understood. Here we proposed a novel behavioral model which utilizes an explicit representation of state durations for making decisions. This model allowed us to investigate how beliefs about the temporal structure of latent states in the environment influence the decision-making process.</p>
<p>As a demonstration of the applicability of the proposed model to behavioral data we have used a reversal learning task, in which reversals followed a pre-specified temporal pattern. We have illustrated several properties of the novel model, using both synthetic data for model validation and experimental data for a proof-of-concept demonstration.</p>
<p>Fitting the model to behavioral data allowed us to infer individual beliefs in temporal regularities and identify participants who rely on the latent reversal schedule used in the experimental task. Interestingly, we found that slightly more than one fourth of the participants showed evidence of using temporal expectations when making choices during the post-reversal phase of the experiment. Although the majority of participants behaved as if they did not use any temporal regularity in the sequence of the reversals, this result is not too surprising because participants were only exposed to five reversals during the whole experiment. We expect that prolonged exposure to reversals would allow a larger number of participants to correctly learn the latent task structure, as it was recently demonstrated in [<xref ref-type="bibr" rid="pcbi.1006707.ref028">28</xref>].</p>
<p>We anticipate that the proposed model can bring novel insights into our understanding of the interplay between the subjective representation of temporal task structure and decision making. The relevance of accurately predicting the moments of change in our everyday lives is reflected by the fact that humans exhibit a strong bias towards expecting timed changes in various tasks. This behavior can even persist when exposed to a series of unpredictable events, e.g., during gambling [<xref ref-type="bibr" rid="pcbi.1006707.ref063">63</xref>] or trading on financial markets [<xref ref-type="bibr" rid="pcbi.1006707.ref064">64</xref>]. Hence, it may not be too surprising that a firm prior belief in structured and predictable changes influences performance and may lead to a reduced performance in cases when these beliefs are incorrect (see Figs <xref ref-type="fig" rid="pcbi.1006707.g006">6</xref> and <xref ref-type="fig" rid="pcbi.1006707.g007">7</xref>). Such over-confidence in temporally structured dynamics might also explain why human behavior is found to deviate from the fully-rational Bayesian model on similar reversal learning tasks [<xref ref-type="bibr" rid="pcbi.1006707.ref048">48</xref>].</p>
<sec id="sec019">
<title>Related work</title>
<p>The key component of the proposed behavioral model is its conceptualization as an explicit duration hidden Markov models ED-HMM [<xref ref-type="bibr" rid="pcbi.1006707.ref030">30</xref>], which involves an explicit representation of the between reversal intervals as the hidden structural variable. This representation results in an anticipation of specific moments of reversals. Such anticipation would be clearly advantageous for an agent, as it enables faster behavioral adaptation in cases when reversals actually do occur in a (semi)regular manner.</p>
<p>The ED-HMM belong to more general group of hidden semi-Markov models which are often applied to the analysis of non-stationary time series [<xref ref-type="bibr" rid="pcbi.1006707.ref065">65</xref>–<xref ref-type="bibr" rid="pcbi.1006707.ref068">68</xref>]. In the context of decision making the semi-Markov formalism allows for temporal structuring of behavioral policies [<xref ref-type="bibr" rid="pcbi.1006707.ref069">69</xref>]. Importantly, semi-Markov dynamics was also applied to temporal difference learning to account for dopamine activity in cases when the timing between action and reward is varied between trials [<xref ref-type="bibr" rid="pcbi.1006707.ref070">70</xref>].</p>
<p>The proposed model builds upon recent approaches to model behavior in changing environments [<xref ref-type="bibr" rid="pcbi.1006707.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref071">71</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref072">72</xref>] and can be seen as a direct extension of hidden Markov models (HMM) which were applied to reversal learning tasks before [<xref ref-type="bibr" rid="pcbi.1006707.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref038">38</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref046">46</xref>–<xref ref-type="bibr" rid="pcbi.1006707.ref048">48</xref>]. In previous works, the HMM were used to identify the moment of reversal, changes in the beliefs about reversal probability, and the most likely moment in which agents reversed their behavior. This was crucial for understanding the effects of dopamine modulation on the underlying inference and consequently behavior. Although it is out of the scope of the present paper, it is possible to perform backward inference with hidden semi-Markov models (HSMM), hence identifying the most likely moments of reversal in the past. Furthermore, we will explore in the future possible learning rules for parameters of the prior beliefs <italic>p</italic><sub>0</sub>(<italic>d</italic>), similar to the work of [<xref ref-type="bibr" rid="pcbi.1006707.ref073">73</xref>]. Such extension would make the models also suitable for addressing questions related to changes in prior beliefs of state durations.</p>
<p>In recent years, reinforcement learning models have found multiple applications in studies relying on a reversal learning task. For example, the classical Rescorla-Wagner model [<xref ref-type="bibr" rid="pcbi.1006707.ref074">74</xref>], the dual update extension of the Rescorla-Wagner model (as described in the present paper) [<xref ref-type="bibr" rid="pcbi.1006707.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref040">40</xref>], or models separating the prediction error signals on positive and negative prediction errors [<xref ref-type="bibr" rid="pcbi.1006707.ref075">75</xref>]. As we have shown here a reinforcement learning model generates behavior very similar to a probabilistic counterpart in relatively simple settings of the reversal learning task. Hence, we would expect that additional extensions of the considered dual update RW model could make the behavior of the reinforcement learning even more similar to the probabilistic model introduced here.</p>
<p>Still, we can point out several advantages of probabilistic models of behavior over reinforcement learning models, in the context of decision making under uncertainty and in dynamic environments. The probabilistic modeling approach allows for a principle way of mapping complex knowledge about spatio-temporal task structure into a relatively simple set of learning rules (as demonstrated here). In turn this provides clear functional interpretation of various prediction error signals, and corresponding adaptive learning rates, which are typically difficult to derive or motivate within the context of classical reinforcement learning. Specifically, we would say that prescribing to a probabilistic modeling approach is crucial for understanding interaction between representation of temporal structure and decision making.</p>
</sec>
<sec id="sec020">
<title>Interval timing</title>
<p>The sense of time and time representation at a neuronal level has been the focus of numerous studies in the past [<xref ref-type="bibr" rid="pcbi.1006707.ref076">76</xref>–<xref ref-type="bibr" rid="pcbi.1006707.ref082">82</xref>]. Studies investigated how neuronal circuitry might implement a robust internal clock [<xref ref-type="bibr" rid="pcbi.1006707.ref083">83</xref>], and how such an internal clock can be utilized to estimate time elapsed between consequent events (e.g., between two tones). Although not described here, behavior in such and similar tasks can be modelled using the formalism of the hidden semi-Markov models. Estimating elapsed time between events (here, reversals) can be obtained using a backward inference process which provides an estimate on the most likely moment of the previous reversal. Nevertheless, it is an open question if the neural circuitry that explains behavior related to interval timing, which involves sub-second time scales, can also be useful to understand behavior which requires a temporal reasoning over much longer time scale. This is of specific interest for understanding how the brain makes accurate predictions about the expected moment of reward, and how this information is used to construct timed prediction error signals [<xref ref-type="bibr" rid="pcbi.1006707.ref084">84</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref085">85</xref>].</p>
</sec>
<sec id="sec021">
<title>Variants of the reversal learning task</title>
<p>The reversal learning task has been shown to be especially useful for behavioral phenotyping, e.g. in areas of executive control [<xref ref-type="bibr" rid="pcbi.1006707.ref086">86</xref>–<xref ref-type="bibr" rid="pcbi.1006707.ref090">90</xref>]; for quantifying individual proneness towards impulsive and compulsiveness [<xref ref-type="bibr" rid="pcbi.1006707.ref091">91</xref>]; and defining individual vulnerability towards addiction [<xref ref-type="bibr" rid="pcbi.1006707.ref092">92</xref>] and other psychiatric disorders [<xref ref-type="bibr" rid="pcbi.1006707.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref093">93</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref094">94</xref>]. The experimental paradigms associated with a reversal learning task can differ substantially from the design presented here (see <xref ref-type="fig" rid="pcbi.1006707.g001">Fig 1</xref>). For example, the probability of reward and punishment for different choices could be correlated to some degree [<xref ref-type="bibr" rid="pcbi.1006707.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref095">95</xref>], or the reversal schedule can be made dependent on the number of correct choices [<xref ref-type="bibr" rid="pcbi.1006707.ref096">96</xref>–<xref ref-type="bibr" rid="pcbi.1006707.ref098">98</xref>]. It is relatively straightforward to adapt the proposed model to any of these variants. For example, when the reversal schedule depends on the number of previously correct choices, one can make the duration transitions dependent on the belief that the previous choice was correct. This would relate state durations to the beliefs about the number of correct choices since the last reversal. Thus, we believe that in a combination with the proposed model, the reversal learning task opens a wide range of opportunities for linking anomalous beliefs in the time domain to different cognitive disorders.</p>
</sec>
<sec id="sec022">
<title>Relevance for understanding psychiatric disorders</title>
<p>Distortions in the temporal organization of cognition and behavior have been implicated, for a long time, in a wide range of psychiatric conditions, perhaps most prominently in attention-deficit hyperactivity disorder, autism and schizophrenia [<xref ref-type="bibr" rid="pcbi.1006707.ref099">99</xref>]. Hence, the proposed model might help to integrate findings of patients’ aberrant behavior in simple time estimation tasks (e.g., a deficit to reproduce durations [<xref ref-type="bibr" rid="pcbi.1006707.ref100">100</xref>–<xref ref-type="bibr" rid="pcbi.1006707.ref102">102</xref>] with their known deficits in the decision-making domain [<xref ref-type="bibr" rid="pcbi.1006707.ref103">103</xref>], such as, in variants of the reversal learning task.</p>
<p>Over the recent years, the question of how people apply their knowledge about the underlying structure of the environment in their decision-making has been widely investigated and discussed. Studies have come to the rather unspecific notion that a reduction in model-based control based on using environmental structure is ubiquitous across different psychiatric symptoms and diagnoses [<xref ref-type="bibr" rid="pcbi.1006707.ref104">104</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref105">105</xref>]. We believe that the model at hand could be a starting point for developing a set of tasks particularly appropriate for refining this notion.</p>
<p>For example, Bayesian theoretical accounts have conceptualized addictive behavior as decision-making based on an aberrant model of the world [<xref ref-type="bibr" rid="pcbi.1006707.ref106">106</xref>]. Both animal and human studies suggest that addicted patients might have a specific deficit to infer or simulate statistical regularities in the environment [<xref ref-type="bibr" rid="pcbi.1006707.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref107">107</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref108">108</xref>]. Such deficits suggest limitations in their ability to infer regularities, which consequently is observed as suboptimal decision-making.</p>
<p>Reversal learning deficits and impairments in model-based control have also been shown in patients suffering from obsessive compulsive disorder (OCD) [<xref ref-type="bibr" rid="pcbi.1006707.ref109">109</xref>, <xref ref-type="bibr" rid="pcbi.1006707.ref110">110</xref>]. A subgroup of OCD patients suffers from an obsession for symmetry and organization. Similarly, obsessive compulsive personality disorder (OCPD) patients show an exaggerated focus on order and symmetry as well as rule-bound traits. Given this clinical picture, it is interesting to speculate that beliefs about regularities in the environment might differ between OCD/OCPD patients and controls. A reduced ability to infer and represent irregular changes in the environment might lead to suboptimal decision-making and distress in OCD/OCPD patients in the presence of irregular changes.</p>
<p>Finally, recent studies have demonstrated that schizophrenia patients may be characterized by an “over-dominance” of an internal model [<xref ref-type="bibr" rid="pcbi.1006707.ref111">111</xref>] (e.g., in the framework presented here, overrating regularities in an irregular environment). When such an internal model is detached from the external input from the world (i.e., the true regularity structure), this mismatch might be involved in the development of psychotic states (in paranoia, delusions, hallucinations).</p>
</sec>
<sec id="sec023">
<title>Conclusion</title>
<p>In summary, we have presented a novel probabilistic model for understanding human decision making behavior in changing environments. The proposed model is based on the explicit duration hidden Markov model, which forms a special case of more general hidden semi-Markov models. The presented results, obtained from both simulated behavior and the model-based analysis of behavioral data, suggest concrete applications of the proposed model in understanding human behavior in changing environments. Most notably, it might be possible to link the quality of the underlying representation of temporal task structure to behavior, thereby opening new directions for cognitive phenotyping.</p>
</sec>
</sec>
<sec id="sec024">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006707.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006707.s001" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Model evidence and model attribution.</title>
<p>Subject specific values of the estimated log posterior predictive model evidence (PPLME) and the corresponding model attribution (see Model fitting and model comparison for details).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors would like to thank Karl Friston, Sebastian Bitzer, and Philipp Schwartenbeck for helpful comments and fruitful discussions. We also thank Florian Schlagenhauf for providing the empirical data.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006707.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Grondin</surname> <given-names>S</given-names></name>. <article-title>Timing and time perception: A review of recent behavioral and neuroscience findings and theoretical directions</article-title>. <source>Attention Perception, &amp; Psychophysics</source>. <year>2010</year>;<volume>72</volume>(<issue>3</issue>):<fpage>561</fpage>–<lpage>582</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3758/APP.72.3.561" xlink:type="simple">10.3758/APP.72.3.561</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buhusi</surname> <given-names>CV</given-names></name>, <name name-style="western"><surname>Meck</surname> <given-names>WH</given-names></name>. <article-title>What makes us tick? Functional and neural mechanisms of interval timing</article-title>. <source>Nature Reviews Neuroscience</source>. <year>2005</year>;<volume>6</volume>(<issue>10</issue>):<fpage>755</fpage>–<lpage>765</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrn1764" xlink:type="simple">10.1038/nrn1764</ext-link></comment> <object-id pub-id-type="pmid">16163383</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Howard</surname> <given-names>MW</given-names></name>, <name name-style="western"><surname>Eichenbaum</surname> <given-names>H</given-names></name>. <article-title>Time and space in the hippocampus</article-title>. <source>Brain research</source>. <year>2015</year>;<volume>1621</volume>:<fpage>345</fpage>–<lpage>354</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.brainres.2014.10.069" xlink:type="simple">10.1016/j.brainres.2014.10.069</ext-link></comment> <object-id pub-id-type="pmid">25449892</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Meck</surname> <given-names>WH</given-names></name>, <name name-style="western"><surname>Penney</surname> <given-names>TB</given-names></name>, <name name-style="western"><surname>Pouthas</surname> <given-names>V</given-names></name>. <article-title>Cortico-striatal representation of time in animals and humans</article-title>. <source>Current opinion in neurobiology</source>. <year>2008</year>;<volume>18</volume>(<issue>2</issue>):<fpage>145</fpage>–<lpage>152</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.conb.2008.08.002" xlink:type="simple">10.1016/j.conb.2008.08.002</ext-link></comment> <object-id pub-id-type="pmid">18708142</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Harrington</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Boyd</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Mayer</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Sheltraw</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Neural representation of interval encoding and decision making</article-title>. <source>Cognitive Brain Research</source>. <year>2004</year>;<volume>21</volume>(<issue>2</issue>):<fpage>193</fpage>–<lpage>205</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cogbrainres.2004.01.010" xlink:type="simple">10.1016/j.cogbrainres.2004.01.010</ext-link></comment> <object-id pub-id-type="pmid">15464351</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Finnerty</surname> <given-names>GT</given-names></name>, <name name-style="western"><surname>Shadlen</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Jazayeri</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nobre</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Buonomano</surname> <given-names>DV</given-names></name>. <article-title>Time in cortical circuits</article-title>. <source>Journal of Neuroscience</source>. <year>2015</year>;<volume>35</volume>(<issue>41</issue>):<fpage>13912</fpage>–<lpage>13916</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.2654-15.2015" xlink:type="simple">10.1523/JNEUROSCI.2654-15.2015</ext-link></comment> <object-id pub-id-type="pmid">26468192</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilson</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Takahashi</surname> <given-names>YK</given-names></name>, <name name-style="western"><surname>Schoenbaum</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Niv</surname> <given-names>Y</given-names></name>. <article-title>Orbitofrontal cortex as a cognitive map of task space</article-title>. <source>Neuron</source>. <year>2014</year>;<volume>81</volume>(<issue>2</issue>):<fpage>267</fpage>–<lpage>279</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2013.11.005" xlink:type="simple">10.1016/j.neuron.2013.11.005</ext-link></comment> <object-id pub-id-type="pmid">24462094</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Niv</surname> <given-names>Y</given-names></name>. <article-title>Learning latent structure: carving nature at its joints</article-title>. <source>Current opinion in neurobiology</source>. <year>2010</year>;<volume>20</volume>(<issue>2</issue>):<fpage>251</fpage>–<lpage>256</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.conb.2010.02.008" xlink:type="simple">10.1016/j.conb.2010.02.008</ext-link></comment> <object-id pub-id-type="pmid">20227271</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Doherty</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Critchley</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <article-title>Temporal difference models and reward-related learning in the human brain</article-title>. <source>Neuron</source>. <year>2003</year>;<volume>38</volume>(<issue>2</issue>):<fpage>329</fpage>–<lpage>337</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0896-6273(03)00169-7" xlink:type="simple">10.1016/S0896-6273(03)00169-7</ext-link></comment> <object-id pub-id-type="pmid">12718865</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Reilly</surname> <given-names>JX</given-names></name>. <article-title>Making predictions in a changing world—inference uncertainty, and learning</article-title>. <source>Frontiers in Neuroscience</source>. <year>2013</year>;<volume>7</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fnins.2013.00105" xlink:type="simple">10.3389/fnins.2013.00105</ext-link></comment> <object-id pub-id-type="pmid">23785310</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Payzan-LeNestour</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Bossaerts</surname> <given-names>P</given-names></name>. <article-title>Risk, unexpected uncertainty, and estimation uncertainty: Bayesian learning in unstable settings</article-title>. <source>PLoS computational biology</source>. <year>2011</year>;<volume>7</volume>(<issue>1</issue>):<fpage>e1001048</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1001048" xlink:type="simple">10.1371/journal.pcbi.1001048</ext-link></comment> <object-id pub-id-type="pmid">21283774</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pearson</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Heilbronner</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Barack</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Hayden</surname> <given-names>BY</given-names></name>, <name name-style="western"><surname>Platt</surname> <given-names>ML</given-names></name>. <article-title>Posterior cingulate cortex: adapting behavior to a changing world</article-title>. <source>Trends in Cognitive Sciences</source>. <year>2011</year>;<volume>15</volume>(<issue>4</issue>):<fpage>143</fpage>–<lpage>151</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tics.2011.02.002" xlink:type="simple">10.1016/j.tics.2011.02.002</ext-link></comment> <object-id pub-id-type="pmid">21420893</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ghahremani</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Monterosso</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Jentsch</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Bilder</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Poldrack</surname> <given-names>RA</given-names></name>. <article-title>Neural Components Underlying Behavioral Flexibility in Human Reversal Learning</article-title>. <source>Cerebral Cortex</source>. <year>2009</year>;<volume>20</volume>(<issue>8</issue>):<fpage>1843</fpage>–<lpage>1852</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/cercor/bhp247" xlink:type="simple">10.1093/cercor/bhp247</ext-link></comment> <object-id pub-id-type="pmid">19915091</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ballard</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Piantadosi</surname> <given-names>ST</given-names></name>, <name name-style="western"><surname>Goodman</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>McClure</surname> <given-names>SM</given-names></name>. <article-title>Beyond Reward Prediction Errors: Human Striatum Updates Rule Values During Learning</article-title>. <source>Cerebral Cortex</source>. <year>2017</year>; p. <fpage>1</fpage>–<lpage>11</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006707.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kolossa</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kopp</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Fingscheidt</surname> <given-names>T</given-names></name>. <article-title>A computational analysis of the neural bases of Bayesian inference</article-title>. <source>NeuroImage</source>. <year>2015</year>;<volume>106</volume>:<fpage>222</fpage>–<lpage>237</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2014.11.007" xlink:type="simple">https://doi.org/10.1016/j.neuroimage.2014.11.007</ext-link>. <object-id pub-id-type="pmid">25462794</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Meyniel</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Schlunegger</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Dehaene</surname> <given-names>S</given-names></name>. <article-title>The sense of confidence during probabilistic learning: A normative account</article-title>. <source>PLoS computational biology</source>. <year>2015</year>;<volume>11</volume>(<issue>6</issue>):<fpage>e1004305</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004305" xlink:type="simple">10.1371/journal.pcbi.1004305</ext-link></comment> <object-id pub-id-type="pmid">26076466</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Diaconescu</surname> <given-names>AO</given-names></name>, <name name-style="western"><surname>Mathys</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Weber</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kasper</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Lomakina</surname> <given-names>EI</given-names></name>, <etal>et al</etal>. <article-title>Inferring on the intentions of others by hierarchical Bayesian learning</article-title>. <source>PLoS computational biology</source>. <year>2014</year>;<volume>10</volume>(<issue>9</issue>):<fpage>e1003810</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003810" xlink:type="simple">10.1371/journal.pcbi.1003810</ext-link></comment> <object-id pub-id-type="pmid">25187943</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Iglesias</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mathys</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Brodersen</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Kasper</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Piccirelli</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>den Ouden</surname> <given-names>HE</given-names></name>, <etal>et al</etal>. <article-title>Hierarchical prediction errors in midbrain and basal forebrain during sensory learning</article-title>. <source>Neuron</source>. <year>2013</year>;<volume>80</volume>(<issue>2</issue>):<fpage>519</fpage>–<lpage>530</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2013.09.009" xlink:type="simple">10.1016/j.neuron.2013.09.009</ext-link></comment> <object-id pub-id-type="pmid">24139048</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Payzan-LeNestour</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Dunne</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bossaerts</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>O’Doherty</surname> <given-names>JP</given-names></name>. <article-title>The Neural Representation of Unexpected Uncertainty during Value-Based Decision Making</article-title>. <source>Neuron</source>. <year>2013</year>;<volume>79</volume>(<issue>1</issue>):<fpage>191</fpage>–<lpage>201</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2013.04.037" xlink:type="simple">https://doi.org/10.1016/j.neuron.2013.04.037</ext-link>. <object-id pub-id-type="pmid">23849203</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ide</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Shenoy</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Angela</surname> <given-names>JY</given-names></name>, <name name-style="western"><surname>Chiang-Shan</surname> <given-names>RL</given-names></name>. <article-title>Bayesian prediction and evaluation in the anterior cingulate cortex</article-title>. <source>Journal of Neuroscience</source>. <year>2013</year>;<volume>33</volume>(<issue>5</issue>):<fpage>2039</fpage>–<lpage>2047</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.2201-12.2013" xlink:type="simple">10.1523/JNEUROSCI.2201-12.2013</ext-link></comment> <object-id pub-id-type="pmid">23365241</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nassar</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Rumsey</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Parikh</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Heasly</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gold</surname> <given-names>JI</given-names></name>. <article-title>Rational regulation of learning dynamics by pupil-linked arousal systems</article-title>. <source>Nature neuroscience</source>. <year>2012</year>;<volume>15</volume>(<issue>7</issue>):<fpage>1040</fpage>–<lpage>1046</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3130" xlink:type="simple">10.1038/nn.3130</ext-link></comment> <object-id pub-id-type="pmid">22660479</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>. <article-title>The free-energy principle: a unified brain theory?</article-title> <source>Nature Reviews Neuroscience</source>. <year>2010</year>;<volume>11</volume>(<issue>2</issue>):<fpage>127</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrn2787" xlink:type="simple">10.1038/nrn2787</ext-link></comment> <object-id pub-id-type="pmid">20068583</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Knill</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Pouget</surname> <given-names>A</given-names></name>. <article-title>The Bayesian brain: the role of uncertainty in neural coding and computation</article-title>. <source>TRENDS in Neurosciences</source>. <year>2004</year>;<volume>27</volume>(<issue>12</issue>):<fpage>712</fpage>–<lpage>719</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tins.2004.10.007" xlink:type="simple">10.1016/j.tins.2004.10.007</ext-link></comment> <object-id pub-id-type="pmid">15541511</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cravo</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Rohenkohl</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Santos</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Nobre</surname> <given-names>AC</given-names></name>. <article-title>Temporal anticipation based on memory</article-title>. <source>Journal of cognitive neuroscience</source>. <year>2017</year>;<volume>29</volume>(<issue>12</issue>):<fpage>2081</fpage>–<lpage>2089</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/jocn_a_01172" xlink:type="simple">10.1162/jocn_a_01172</ext-link></comment> <object-id pub-id-type="pmid">28777060</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Ede</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Niklaus</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nobre</surname> <given-names>AC</given-names></name>. <article-title>Temporal expectations guide dynamic prioritization in visual working memory through attenuated <italic>α</italic> oscillations</article-title>. <source>Journal of Neuroscience</source>. <year>2017</year>;<volume>37</volume>(<issue>2</issue>):<fpage>437</fpage>–<lpage>445</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.2272-16.2016" xlink:type="simple">10.1523/JNEUROSCI.2272-16.2016</ext-link></comment> <object-id pub-id-type="pmid">28077721</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Auksztulewicz</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Nobre</surname> <given-names>AC</given-names></name>. <article-title>Task relevance modulates the behavioural and neural effects of sensory predictions</article-title>. <source>PLoS biology</source>. <year>2017</year>;<volume>15</volume>(<issue>12</issue>):<fpage>e2003143</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pbio.2003143" xlink:type="simple">10.1371/journal.pbio.2003143</ext-link></comment> <object-id pub-id-type="pmid">29206225</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rohenkohl</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gould</surname> <given-names>IC</given-names></name>, <name name-style="western"><surname>Pessoa</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Nobre</surname> <given-names>AC</given-names></name>. <article-title>Combining spatial and temporal expectations to improve visual perception</article-title>. <source>Journal of vision</source>. <year>2014</year>;<volume>14</volume>(<issue>4</issue>):<fpage>8</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1167/14.4.8" xlink:type="simple">10.1167/14.4.8</ext-link></comment> <object-id pub-id-type="pmid">24722562</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vilà-Balló</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mas-Herrero</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Ripollés</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Simó</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Miró</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cucurell</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Unraveling the role of the hippocampus in reversal learning</article-title>. <source>Journal of Neuroscience</source>. <year>2017</year>;<volume>37</volume>(<issue>28</issue>):<fpage>6686</fpage>–<lpage>6697</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.3212-16.2017" xlink:type="simple">10.1523/JNEUROSCI.3212-16.2017</ext-link></comment> <object-id pub-id-type="pmid">28592695</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Costa</surname> <given-names>VD</given-names></name>, <name name-style="western"><surname>Tran</surname> <given-names>VL</given-names></name>, <name name-style="western"><surname>Turchi</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Averbeck</surname> <given-names>BB</given-names></name>. <article-title>Reversal learning and dopamine: a bayesian perspective</article-title>. <source>Journal of Neuroscience</source>. <year>2015</year>;<volume>35</volume>(<issue>6</issue>):<fpage>2407</fpage>–<lpage>2416</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.1989-14.2015" xlink:type="simple">10.1523/JNEUROSCI.1989-14.2015</ext-link></comment> <object-id pub-id-type="pmid">25673835</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dewar</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wiggins</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wood</surname> <given-names>F</given-names></name>. <article-title>Inference in Hidden Markov Models with Explicit State Duration Distributions</article-title>. <source>IEEE Signal Processing Letters</source>. <year>2012</year>;<volume>19</volume>(<issue>4</issue>):<fpage>235</fpage>–<lpage>238</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/LSP.2012.2184795" xlink:type="simple">10.1109/LSP.2012.2184795</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yu</surname> <given-names>SZ</given-names></name>. <article-title>Hidden semi-Markov models</article-title>. <source>Artificial intelligence</source>. <year>2010</year>;<volume>174</volume>(<issue>2</issue>):<fpage>215</fpage>–<lpage>243</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.artint.2009.11.011" xlink:type="simple">10.1016/j.artint.2009.11.011</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref032">
<label>32</label>
<mixed-citation publication-type="other" xlink:type="simple">Attias H. Planning by Probabilistic Inference. In: Proceedings of the Ninth International Workshop on Artificial Intelligence and Statistics, AISTATS 2003, Key West, Florida, USA, January 3-6, 2003; 2003. Available from: <ext-link ext-link-type="uri" xlink:href="http://research.microsoft.com/en-us/um/cambridge/events/aistats2003/proceedings/206.pdf" xlink:type="simple">http://research.microsoft.com/en-us/um/cambridge/events/aistats2003/proceedings/206.pdf</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006707.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Botvinick</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Toussaint</surname> <given-names>M</given-names></name>. <article-title>Planning as inference</article-title>. <source>Trends in Cognitive Sciences</source>. <year>2012</year>;<volume>16</volume>(<issue>10</issue>):<fpage>485</fpage>–<lpage>488</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tics.2012.08.006" xlink:type="simple">10.1016/j.tics.2012.08.006</ext-link></comment> <object-id pub-id-type="pmid">22940577</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Rigoli</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Ognibene</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Mathys</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Fitzgerald</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Pezzulo</surname> <given-names>G</given-names></name>. <article-title>Active inference and epistemic value</article-title>. <source>Cognitive Neuroscience</source>. <year>2015</year>;<volume>6</volume>(<issue>4</issue>):<fpage>187</fpage>–<lpage>214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/17588928.2015.1020053" xlink:type="simple">10.1080/17588928.2015.1020053</ext-link></comment> <object-id pub-id-type="pmid">25689102</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Clarke</surname> <given-names>HF</given-names></name>. <article-title>Prefrontal Serotonin Depletion Affects Reversal Learning But Not Attentional Set Shifting</article-title>. <source>Journal of Neuroscience</source>. <year>2005</year>;<volume>25</volume>(<issue>2</issue>):<fpage>532</fpage>–<lpage>538</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.3690-04.2005" xlink:type="simple">10.1523/JNEUROSCI.3690-04.2005</ext-link></comment> <object-id pub-id-type="pmid">15647499</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>den Ouden</surname> <given-names>HE</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Fernandez</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Elshout</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Rijpkema</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hoogman</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Dissociable effects of dopamine and serotonin on reversal learning</article-title>. <source>Neuron</source>. <year>2013</year>;<volume>80</volume>(<issue>4</issue>):<fpage>1090</fpage>–<lpage>1100</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2013.08.030" xlink:type="simple">10.1016/j.neuron.2013.08.030</ext-link></comment> <object-id pub-id-type="pmid">24267657</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Behrens</surname> <given-names>TEJ</given-names></name>, <name name-style="western"><surname>Woolrich</surname> <given-names>MW</given-names></name>, <name name-style="western"><surname>Walton</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Rushworth</surname> <given-names>MFS</given-names></name>. <article-title>Learning the value of information in an uncertain world</article-title>. <source>Nature Neuroscience</source>. <year>2007</year>;<volume>10</volume>(<issue>9</issue>):<fpage>1214</fpage>–<lpage>1221</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1954" xlink:type="simple">10.1038/nn1954</ext-link></comment> <object-id pub-id-type="pmid">17676057</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hampton</surname> <given-names>AN</given-names></name>, <name name-style="western"><surname>Bossaerts</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>O’doherty</surname> <given-names>JP</given-names></name>. <article-title>The role of the ventromedial prefrontal cortex in abstract state-based inference during decision making in humans</article-title>. <source>Journal of Neuroscience</source>. <year>2006</year>;<volume>26</volume>(<issue>32</issue>):<fpage>8360</fpage>–<lpage>8367</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.1010-06.2006" xlink:type="simple">10.1523/JNEUROSCI.1010-06.2006</ext-link></comment> <object-id pub-id-type="pmid">16899731</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Reiter</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Heinze</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Schlagenhauf</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Deserno</surname> <given-names>L</given-names></name>. <article-title>Impaired flexible reward-based decision-making in binge eating disorder: evidence from computational modeling and functional neuroimaging</article-title>. <source>Neuropsychopharmacology</source>. <year>2017</year>;<volume>42</volume>(<issue>3</issue>):<fpage>628</fpage>–<lpage>637</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/npp.2016.95" xlink:type="simple">10.1038/npp.2016.95</ext-link></comment> <object-id pub-id-type="pmid">27301429</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Reiter</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Deserno</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Kallert</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Heinze</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Heinz</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schlagenhauf</surname> <given-names>F</given-names></name>. <article-title>Behavioral and neural signatures of reduced updating of alternative options in alcohol-dependent patients during flexible decision-making</article-title>. <source>Journal of Neuroscience</source>. <year>2016</year>;<volume>36</volume>(<issue>43</issue>):<fpage>10935</fpage>–<lpage>10948</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.4322-15.2016" xlink:type="simple">10.1523/JNEUROSCI.4322-15.2016</ext-link></comment> <object-id pub-id-type="pmid">27798176</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schiller</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Schoenbaum</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Phelps</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>. <article-title>Differential roles of human striatum and amygdala in associative learning</article-title>. <source>Nature neuroscience</source>. <year>2011</year>;<volume>14</volume>(<issue>10</issue>):<fpage>1250</fpage>–<lpage>1252</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.2904" xlink:type="simple">10.1038/nn.2904</ext-link></comment> <object-id pub-id-type="pmid">21909088</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Doherty</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Hampton</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>H</given-names></name>. <article-title>Model-Based fMRI and Its Application to Reward Learning and Decision Making</article-title>. <source>Annals of the New York Academy of Sciences</source>. <year>2007</year>;<volume>1104</volume>(<issue>1</issue>):<fpage>35</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1196/annals.1390.022" xlink:type="simple">10.1196/annals.1390.022</ext-link></comment> <object-id pub-id-type="pmid">17416921</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lohrenz</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>McCabe</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Camerer</surname> <given-names>CF</given-names></name>, <name name-style="western"><surname>Montague</surname> <given-names>PR</given-names></name>. <article-title>Neural signature of fictive learning signals in a sequential investment task</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2007</year>;<volume>104</volume>(<issue>22</issue>):<fpage>9493</fpage>–<lpage>9498</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0608842104" xlink:type="simple">10.1073/pnas.0608842104</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref044">
<label>44</label>
<mixed-citation publication-type="other" xlink:type="simple">Dymarski P. Hidden Markov models, theory and applications. InTechOpen; 2011.</mixed-citation>
</ref>
<ref id="pcbi.1006707.ref045">
<label>45</label>
<mixed-citation publication-type="other" xlink:type="simple">Murphy KP. Hidden semi-markov models (hsmms). unpublished notes. 2002;2.</mixed-citation>
</ref>
<ref id="pcbi.1006707.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jang</surname> <given-names>AI</given-names></name>, <name name-style="western"><surname>Costa</surname> <given-names>VD</given-names></name>, <name name-style="western"><surname>Rudebeck</surname> <given-names>PH</given-names></name>, <name name-style="western"><surname>Chudasama</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Averbeck</surname> <given-names>BB</given-names></name>. <article-title>The role of frontal cortical and medial-temporal lobe brain areas in learning a bayesian prior belief on reversals</article-title>. <source>Journal of Neuroscience</source>. <year>2015</year>;<volume>35</volume>(<issue>33</issue>):<fpage>11751</fpage>–<lpage>11760</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.1594-15.2015" xlink:type="simple">10.1523/JNEUROSCI.1594-15.2015</ext-link></comment> <object-id pub-id-type="pmid">26290251</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schlagenhauf</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Huys</surname> <given-names>QJ</given-names></name>, <name name-style="western"><surname>Deserno</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Rapp</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Beck</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Heinze</surname> <given-names>HJ</given-names></name>, <etal>et al</etal>. <article-title>Striatal dysfunction during reversal learning in unmedicated schizophrenia patients</article-title>. <source>Neuroimage</source>. <year>2014</year>;<volume>89</volume>:<fpage>171</fpage>–<lpage>180</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2013.11.034" xlink:type="simple">10.1016/j.neuroimage.2013.11.034</ext-link></comment> <object-id pub-id-type="pmid">24291614</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kayaba</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Shum</surname> <given-names>M</given-names></name>. <article-title>Nonparametric learning rules from bandit experiments: The eyes have it!</article-title> <source>Games and Economic Behavior</source>. <year>2013</year>;<volume>81</volume>:<fpage>215</fpage>–<lpage>231</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.geb.2013.05.003" xlink:type="simple">10.1016/j.geb.2013.05.003</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yu</surname> <given-names>SZ</given-names></name>, <name name-style="western"><surname>Kobayashi</surname> <given-names>H</given-names></name>. <article-title>An efficient forward-backward algorithm for an explicit-duration hidden Markov model</article-title>. <source>IEEE signal processing letters</source>. <year>2003</year>;<volume>10</volume>(<issue>1</issue>):<fpage>11</fpage>–<lpage>14</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/LSP.2002.806705" xlink:type="simple">10.1109/LSP.2002.806705</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vaseghi</surname> <given-names>S</given-names></name>. <article-title>State duration modelling in hidden Markov models</article-title>. <source>Signal processing</source>. <year>1995</year>;<volume>41</volume>(<issue>1</issue>):<fpage>31</fpage>–<lpage>41</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0165-1684(94)00088-H" xlink:type="simple">10.1016/0165-1684(94)00088-H</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Blei</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Kucukelbir</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>McAuliffe</surname> <given-names>JD</given-names></name>. <article-title>Variational Inference: A Review for Statisticians</article-title>. <source>Journal of the American Statistical Association</source>. <year>2017</year>;<volume>112</volume>(<issue>518</issue>):<fpage>859</fpage>–<lpage>877</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/01621459.2017.1285773" xlink:type="simple">10.1080/01621459.2017.1285773</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wainwright</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Jordan</surname> <given-names>MI</given-names></name>, <etal>et al</etal>. <article-title>Graphical models, exponential families, and variational inference</article-title>. <source>Foundations and Trends<sup>®</sup> in Machine Learning</source>. <year>2008</year>;<volume>1</volume>(<issue>1–2</issue>):<fpage>1</fpage>–<lpage>305</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006707.ref053">
<label>53</label>
<mixed-citation publication-type="other" xlink:type="simple">Beal MJ, et al. Variational algorithms for approximate Bayesian inference. university of London London; 2003.</mixed-citation>
</ref>
<ref id="pcbi.1006707.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Herreros</surname> <given-names>I</given-names></name>. <article-title>Active inference and learning in the cerebellum</article-title>. <source>Neural computation</source>. <year>2016</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/NECO_a_00863" xlink:type="simple">10.1162/NECO_a_00863</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Rigoli</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Ognibene</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Mathys</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Fitzgerald</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Pezzulo</surname> <given-names>G</given-names></name>. <article-title>Active inference and epistemic value</article-title>. <source>Cognitive neuroscience</source>. <year>2015</year>;<volume>6</volume>(<issue>4</issue>):<fpage>187</fpage>–<lpage>214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/17588928.2015.1020053" xlink:type="simple">10.1080/17588928.2015.1020053</ext-link></comment> <object-id pub-id-type="pmid">25689102</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schönberg</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Joel</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>O’Doherty</surname> <given-names>JP</given-names></name>. <article-title>Reinforcement learning signals in the human striatum distinguish learners from nonlearners during reward-based decision making</article-title>. <source>Journal of Neuroscience</source>. <year>2007</year>;<volume>27</volume>(<issue>47</issue>):<fpage>12860</fpage>–<lpage>12867</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.2496-07.2007" xlink:type="simple">10.1523/JNEUROSCI.2496-07.2007</ext-link></comment> <object-id pub-id-type="pmid">18032658</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Doya</surname> <given-names>K</given-names></name>. <article-title>The computational neurobiology of learning and reward</article-title>. <source>Current opinion in neurobiology</source>. <year>2006</year>;<volume>16</volume>(<issue>2</issue>):<fpage>199</fpage>–<lpage>204</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.conb.2006.03.006" xlink:type="simple">10.1016/j.conb.2006.03.006</ext-link></comment> <object-id pub-id-type="pmid">16563737</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Salvatier</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wiecki</surname> <given-names>TV</given-names></name>, <name name-style="western"><surname>Fonnesbeck</surname> <given-names>C</given-names></name>. <article-title>Probabilistic programming in Python using PyMC3</article-title>. <source>PeerJ Computer Science</source>. <year>2016</year>;<volume>2</volume>:<fpage>e55</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7717/peerj-cs.55" xlink:type="simple">10.7717/peerj-cs.55</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kucukelbir</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tran</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ranganath</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Blei</surname> <given-names>DM</given-names></name>. <article-title>Automatic Differentiation Variational Inference</article-title>. <source>Journal of Machine Learning Research</source>. <year>2017</year>;<volume>18</volume>(<issue>14</issue>):<fpage>1</fpage>–<lpage>45</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006707.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rigoux</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Stephan</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>. <article-title>Bayesian model selection for group studies—revisited</article-title>. <source>Neuroimage</source>. <year>2014</year>;<volume>84</volume>:<fpage>971</fpage>–<lpage>985</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2013.08.065" xlink:type="simple">10.1016/j.neuroimage.2013.08.065</ext-link></comment> <object-id pub-id-type="pmid">24018303</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hwang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Vehtari</surname> <given-names>A</given-names></name>. <article-title>Understanding predictive information criteria for Bayesian models</article-title>. <source>Statistics and Computing</source>. <year>2014</year>;<volume>24</volume>(<issue>6</issue>):<fpage>997</fpage>–<lpage>1016</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11222-013-9416-2" xlink:type="simple">10.1007/s11222-013-9416-2</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Muller</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Nobre</surname> <given-names>AC</given-names></name>. <article-title>Perceiving the passage of time: neural possibilities</article-title>. <source>Annals of the New York Academy of Sciences</source>. <year>2014</year>;<volume>1326</volume>(<issue>1</issue>):<fpage>60</fpage>–<lpage>71</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/nyas.12545" xlink:type="simple">10.1111/nyas.12545</ext-link></comment> <object-id pub-id-type="pmid">25257798</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Croson</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Sundali</surname> <given-names>J</given-names></name>. <article-title>The Gambler’s Fallacy and the Hot Hand: Empirical Data from Casinos</article-title>. <source>Journal of Risk and Uncertainty</source>. <year>2005</year>;<volume>30</volume>(<issue>3</issue>):<fpage>195</fpage>–<lpage>209</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11166-005-1153-2" xlink:type="simple">10.1007/s11166-005-1153-2</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rabin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Vayanos</surname> <given-names>D</given-names></name>. <article-title>The Gambler’s and Hot-Hand Fallacies: Theory and Applications</article-title>. <source>Review of Economic Studies</source>. <year>2010</year>;<volume>77</volume>(<issue>2</issue>):<fpage>730</fpage>–<lpage>778</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1467-937X.2009.00582.x" xlink:type="simple">10.1111/j.1467-937X.2009.00582.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tokdar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Xi</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kelly</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>. <article-title>Detection of bursts in extracellular spike trains using hidden semi-Markov point process models</article-title>. <source>Journal of computational neuroscience</source>. <year>2010</year>;<volume>29</volume>(<issue>1-2</issue>):<fpage>203</fpage>–<lpage>212</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10827-009-0182-2" xlink:type="simple">10.1007/s10827-009-0182-2</ext-link></comment> <object-id pub-id-type="pmid">19697116</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref066">
<label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gales</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Young</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>The application of hidden Markov models in speech recognition</article-title>. <source>Foundations and Trends<sup>®</sup> in Signal Processing</source>. <year>2008</year>;<volume>1</volume>(<issue>3</issue>):<fpage>195</fpage>–<lpage>304</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1561/2000000004" xlink:type="simple">10.1561/2000000004</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref067">
<label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Faisan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Thoraval</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Armspach</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Metz-Lutz</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Heitz</surname> <given-names>F</given-names></name>. <article-title>Unsupervised learning and mapping of active brain functional MRI signals based on hidden semi-Markov event sequence models</article-title>. <source>IEEE transactions on medical imaging</source>. <year>2005</year>;<volume>24</volume>(<issue>2</issue>):<fpage>263</fpage>–<lpage>276</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TMI.2004.841225" xlink:type="simple">10.1109/TMI.2004.841225</ext-link></comment> <object-id pub-id-type="pmid">15707252</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref068">
<label>68</label>
<mixed-citation publication-type="other" xlink:type="simple">Duong TV, Bui HH, Phung DQ, Venkatesh S. Activity recognition and abnormality detection with the switching hidden semi-markov model. In: Computer Vision and Pattern Recognition, 2005. CVPR 2005. IEEE Computer Society Conference on. vol. 1. IEEE; 2005. p. 838–845.</mixed-citation>
</ref>
<ref id="pcbi.1006707.ref069">
<label>69</label>
<mixed-citation publication-type="other" xlink:type="simple">Bradtke SJ, Duff MO. Reinforcement learning methods for continuous-time Markov decision problems. In: Advances in neural information processing systems; 1995. p. 393–400.</mixed-citation>
</ref>
<ref id="pcbi.1006707.ref070">
<label>70</label>
<mixed-citation publication-type="other" xlink:type="simple">Daw ND, Courville AC, Touretzky DS. Timing and partial observability in the dopamine system. In: Advances in neural information processing systems; 2003. p. 99–106.</mixed-citation>
</ref>
<ref id="pcbi.1006707.ref071">
<label>71</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mathys</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Stephan</surname> <given-names>KE</given-names></name>. <article-title>A Bayesian foundation for individual learning under uncertainty</article-title>. <source>Frontiers in human neuroscience</source>. <year>2011</year>;<volume>5</volume>:<fpage>39</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fnhum.2011.00039" xlink:type="simple">10.3389/fnhum.2011.00039</ext-link></comment> <object-id pub-id-type="pmid">21629826</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref072">
<label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nassar</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Heasly</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gold</surname> <given-names>JI</given-names></name>. <article-title>An approximately Bayesian delta-rule model explains the dynamics of belief updating in a changing environment</article-title>. <source>Journal of Neuroscience</source>. <year>2010</year>;<volume>30</volume>(<issue>37</issue>):<fpage>12366</fpage>–<lpage>12378</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.0822-10.2010" xlink:type="simple">10.1523/JNEUROSCI.0822-10.2010</ext-link></comment> <object-id pub-id-type="pmid">20844132</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref073">
<label>73</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilson</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Nassar</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Gold</surname> <given-names>JI</given-names></name>. <article-title>Bayesian online learning of the hazard rate in change-point problems</article-title>. <source>Neural computation</source>. <year>2010</year>;<volume>22</volume>(<issue>9</issue>):<fpage>2452</fpage>–<lpage>2476</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/NECO_a_00007" xlink:type="simple">10.1162/NECO_a_00007</ext-link></comment> <object-id pub-id-type="pmid">20569174</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref074">
<label>74</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roesch</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Esber</surname> <given-names>GR</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Schoenbaum</surname> <given-names>G</given-names></name>. <article-title>Surprise! Neural correlates of Pearce–Hall and Rescorla–Wagner coexist within the brain</article-title>. <source>European Journal of Neuroscience</source>. <year>2012</year>;<volume>35</volume>(<issue>7</issue>):<fpage>1190</fpage>–<lpage>1200</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1460-9568.2011.07986.x" xlink:type="simple">10.1111/j.1460-9568.2011.07986.x</ext-link></comment> <object-id pub-id-type="pmid">22487047</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref075">
<label>75</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Matsumoto</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hikosaka</surname> <given-names>O</given-names></name>. <article-title>Two types of dopamine neuron distinctly convey positive and negative motivational signals</article-title>. <source>Nature</source>. <year>2009</year>;<volume>459</volume>(<issue>7248</issue>):<fpage>837</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature08028" xlink:type="simple">10.1038/nature08028</ext-link></comment> <object-id pub-id-type="pmid">19448610</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref076">
<label>76</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hardy</surname> <given-names>NF</given-names></name>, <name name-style="western"><surname>Buonomano</surname> <given-names>DV</given-names></name>. <article-title>Neurocomputational models of interval and pattern timing</article-title>. <source>Current Opinion in Behavioral Sciences</source>. <year>2016</year>;<volume>8</volume>:<fpage>250</fpage>–<lpage>257</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cobeha.2016.01.012" xlink:type="simple">https://doi.org/10.1016/j.cobeha.2016.01.012</ext-link>. <object-id pub-id-type="pmid">27790629</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref077">
<label>77</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Merchant</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Yarrow</surname> <given-names>K</given-names></name>. <article-title>How the motor system both encodes and influences our sense of time</article-title>. <source>Current Opinion in Behavioral Sciences</source>. <year>2016</year>;<volume>8</volume>:<fpage>22</fpage>–<lpage>27</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cobeha.2016.01.006" xlink:type="simple">https://doi.org/10.1016/j.cobeha.2016.01.006</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006707.ref078">
<label>78</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Addyman</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>French</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>E</given-names></name>. <article-title>Computational models of interval timing</article-title>. <source>Current Opinion in Behavioral Sciences</source>. <year>2016</year>;<volume>8</volume>:<fpage>140</fpage>–<lpage>146</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cobeha.2016.01.004" xlink:type="simple">https://doi.org/10.1016/j.cobeha.2016.01.004</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006707.ref079">
<label>79</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Eagleman</surname> <given-names>DM</given-names></name>. <article-title>Time and the Brain: How Subjective Time Relates to Neural Time</article-title>. <source>Journal of Neuroscience</source>. <year>2005</year>;<volume>25</volume>(<issue>45</issue>):<fpage>10369</fpage>–<lpage>10371</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.3487-05.2005" xlink:type="simple">10.1523/JNEUROSCI.3487-05.2005</ext-link></comment> <object-id pub-id-type="pmid">16280574</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref080">
<label>80</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Matell</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Meck</surname> <given-names>WH</given-names></name>, <name name-style="western"><surname>Nicolelis</surname> <given-names>MAL</given-names></name>. <article-title>Interval timing and the encoding of signal duration by ensembles of cortical and striatal neurons</article-title>. <source>Behavioral Neuroscience</source>. <year>2003</year>;<volume>117</volume>(<issue>4</issue>):<fpage>760</fpage>–<lpage>773</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1037/0735-7044.117.4.760" xlink:type="simple">10.1037/0735-7044.117.4.760</ext-link></comment> <object-id pub-id-type="pmid">12931961</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref081">
<label>81</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Miall</surname> <given-names>C</given-names></name>. <article-title>The Storage of Time Intervals Using Oscillating Neurons</article-title>. <source>Neural Computation</source>. <year>1989</year>;<volume>1</volume>(<issue>3</issue>):<fpage>359</fpage>–<lpage>371</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/neco.1989.1.3.359" xlink:type="simple">10.1162/neco.1989.1.3.359</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref082">
<label>82</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Grossberg</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schmajuk</surname> <given-names>NA</given-names></name>. <article-title>Neural dynamics of adaptive timing and temporal discrimination during associative learning</article-title>. <source>Neural Networks</source>. <year>1989</year>;<volume>2</volume>(<issue>2</issue>):<fpage>79</fpage>–<lpage>102</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0893-6080(89)90026-9" xlink:type="simple">10.1016/0893-6080(89)90026-9</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref083">
<label>83</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buhusi</surname> <given-names>CV</given-names></name>, <name name-style="western"><surname>Meck</surname> <given-names>WH</given-names></name>. <article-title>What makes us tick? Functional and neural mechanisms of interval timing</article-title>. <source>Nature Reviews Neuroscience</source>. <year>2005</year>;<volume>6</volume>(<issue>10</issue>):<fpage>755</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrn1764" xlink:type="simple">10.1038/nrn1764</ext-link></comment> <object-id pub-id-type="pmid">16163383</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref084">
<label>84</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Takahashi</surname> <given-names>YK</given-names></name>, <name name-style="western"><surname>Langdon</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Niv</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Schoenbaum</surname> <given-names>G</given-names></name>. <article-title>Temporal Specificity of Reward Prediction Errors Signaled by Putative Dopamine Neurons in Rat VTA Depends on Ventral Striatum</article-title>. <source>Neuron</source>. <year>2016</year>;<volume>91</volume>(<issue>1</issue>):<fpage>182</fpage>–<lpage>193</lpage>. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2016.05.015" xlink:type="simple">https://doi.org/10.1016/j.neuron.2016.05.015</ext-link>. <object-id pub-id-type="pmid">27292535</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref085">
<label>85</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Courville</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Touretzky</surname> <given-names>DS</given-names></name>. <article-title>Representation and timing in theories of the dopamine system</article-title>. <source>Neural computation</source>. <year>2006</year>;<volume>18</volume>(<issue>7</issue>):<fpage>1637</fpage>–<lpage>1677</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/neco.2006.18.7.1637" xlink:type="simple">10.1162/neco.2006.18.7.1637</ext-link></comment> <object-id pub-id-type="pmid">16764517</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref086">
<label>86</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cools</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Gibbs</surname> <given-names>SE</given-names></name>, <name name-style="western"><surname>Miyakawa</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jagust</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>D’Esposito</surname> <given-names>M</given-names></name>. <article-title>Striatal Dopamine Predicts Outcome-Specific Reversal Learning and Its Sensitivity to Dopaminergic Drug Administration</article-title>. <source>Journal of Neuroscience</source>. <year>2009</year>;<volume>29</volume>(<issue>5</issue>):<fpage>1538</fpage>–<lpage>1543</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.4467-08.2009" xlink:type="simple">10.1523/JNEUROSCI.4467-08.2009</ext-link></comment> <object-id pub-id-type="pmid">19193900</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref087">
<label>87</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Evers</surname> <given-names>EAT</given-names></name>, <name name-style="western"><surname>Cools</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>van der Veen</surname> <given-names>FM</given-names></name>, <name name-style="western"><surname>Jolles</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sahakian</surname> <given-names>BJ</given-names></name>, <etal>et al</etal>. <article-title>Serotonergic Modulation of Prefrontal Cortex during Negative Feedback in Probabilistic Reversal Learning</article-title>. <source>Neuropsychopharmacology</source>. <year>2005</year>;<volume>30</volume>(<issue>6</issue>):<fpage>1138</fpage>–<lpage>1147</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/sj.npp.1300663" xlink:type="simple">10.1038/sj.npp.1300663</ext-link></comment> <object-id pub-id-type="pmid">15689962</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref088">
<label>88</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tsuchida</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Doll</surname> <given-names>BB</given-names></name>, <name name-style="western"><surname>Fellows</surname> <given-names>LK</given-names></name>. <article-title>Beyond Reversal: A Critical Role for Human Orbitofrontal Cortex in Flexible Learning from Probabilistic Feedback</article-title>. <source>Journal of Neuroscience</source>. <year>2010</year>;<volume>30</volume>(<issue>50</issue>):<fpage>16868</fpage>–<lpage>16875</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.1958-10.2010" xlink:type="simple">10.1523/JNEUROSCI.1958-10.2010</ext-link></comment> <object-id pub-id-type="pmid">21159958</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref089">
<label>89</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bari</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Theobald</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Caprioli</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Mar</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Aidoo-Micah</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dalley</surname> <given-names>JW</given-names></name>, <etal>et al</etal>. <article-title>Serotonin Modulates Sensitivity to Reward and Negative Feedback in a Probabilistic Reversal Learning Task in Rats</article-title>. <source>Neuropsychopharmacology</source>. <year>2010</year>;<volume>35</volume>(<issue>6</issue>):<fpage>1290</fpage>–<lpage>1301</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/npp.2009.233" xlink:type="simple">10.1038/npp.2009.233</ext-link></comment> <object-id pub-id-type="pmid">20107431</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref090">
<label>90</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rudebeck</surname> <given-names>PH</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>EA</given-names></name>. <article-title>Amygdala and Orbitofrontal Cortex Lesions Differentially Influence Choices during Object Reversal Learning</article-title>. <source>Journal of Neuroscience</source>. <year>2008</year>;<volume>28</volume>(<issue>33</issue>):<fpage>8338</fpage>–<lpage>8343</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.2272-08.2008" xlink:type="simple">10.1523/JNEUROSCI.2272-08.2008</ext-link></comment> <object-id pub-id-type="pmid">18701696</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref091">
<label>91</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Remijnse</surname> <given-names>PL</given-names></name>, <name name-style="western"><surname>Nielen</surname> <given-names>MMA</given-names></name>, <name name-style="western"><surname>van Balkom</surname> <given-names>AJLM</given-names></name>, <name name-style="western"><surname>Cath</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>van Oppen</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Uylings</surname> <given-names>HBM</given-names></name>, <etal>et al</etal>. <article-title>Reduced Orbitofrontal-Striatal Activity on a Reversal Learning Task in Obsessive-Compulsive Disorder</article-title>. <source>Archives of General Psychiatry</source>. <year>2006</year>;<volume>63</volume>(<issue>11</issue>):<fpage>1225</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1001/archpsyc.63.11.1225" xlink:type="simple">10.1001/archpsyc.63.11.1225</ext-link></comment> <object-id pub-id-type="pmid">17088503</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref092">
<label>92</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Izquierdo</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jentsch</surname> <given-names>JD</given-names></name>. <article-title>Reversal learning as a measure of impulsive and compulsive behavior in addictions</article-title>. <source>Psychopharmacology</source>. <year>2011</year>;<volume>219</volume>(<issue>2</issue>):<fpage>607</fpage>–<lpage>620</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00213-011-2579-7" xlink:type="simple">10.1007/s00213-011-2579-7</ext-link></comment> <object-id pub-id-type="pmid">22134477</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref093">
<label>93</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bernardoni</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Geisler</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>King</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Javadi</surname> <given-names>AH</given-names></name>, <name name-style="western"><surname>Ritschel</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Murr</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Altered medial frontal feedback learning signals in anorexia nervosa</article-title>. <source>Biological psychiatry</source>. <year>2017</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.biopsych.2017.07.024" xlink:type="simple">10.1016/j.biopsych.2017.07.024</ext-link></comment> <object-id pub-id-type="pmid">29025688</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref094">
<label>94</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Waltz</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Gold</surname> <given-names>JM</given-names></name>. <article-title>Probabilistic reversal learning impairments in schizophrenia: Further evidence of orbitofrontal dysfunction</article-title>. <source>Schizophrenia Research</source>. <year>2007</year>;<volume>93</volume>(<issue>1-3</issue>):<fpage>296</fpage>–<lpage>303</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.schres.2007.03.010" xlink:type="simple">10.1016/j.schres.2007.03.010</ext-link></comment> <object-id pub-id-type="pmid">17482797</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref095">
<label>95</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’doherty</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Schultz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Deichmann</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <article-title>Dissociable roles of ventral and dorsal striatum in instrumental conditioning</article-title>. <source>science</source>. <year>2004</year>;<volume>304</volume>(<issue>5669</issue>):<fpage>452</fpage>–<lpage>454</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1094285" xlink:type="simple">10.1126/science.1094285</ext-link></comment> <object-id pub-id-type="pmid">15087550</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref096">
<label>96</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Prevost</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>McCabe</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Jessup</surname> <given-names>RK</given-names></name>, <name name-style="western"><surname>Bossaerts</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>O’Doherty</surname> <given-names>JP</given-names></name>. <article-title>Differentiable contributions of human amygdalar subregions in the computations underlying reward and avoidance learning</article-title>. <source>European Journal of Neuroscience</source>. <year>2011</year>;<volume>34</volume>(<issue>1</issue>):<fpage>134</fpage>–<lpage>145</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1460-9568.2011.07686.x" xlink:type="simple">10.1111/j.1460-9568.2011.07686.x</ext-link></comment> <object-id pub-id-type="pmid">21535456</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref097">
<label>97</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wunderlich</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Beierholm</surname> <given-names>UR</given-names></name>, <name name-style="western"><surname>Bossaerts</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>O’Doherty</surname> <given-names>JP</given-names></name>. <article-title>The human prefrontal cortex mediates integration of potential causes behind observed outcomes</article-title>. <source>Journal of neurophysiology</source>. <year>2011</year>;<volume>106</volume>(<issue>3</issue>):<fpage>1558</fpage>–<lpage>1569</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.01051.2010" xlink:type="simple">10.1152/jn.01051.2010</ext-link></comment> <object-id pub-id-type="pmid">21697443</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref098">
<label>98</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Evers</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Cools</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Van Der Veen</surname> <given-names>FM</given-names></name>, <name name-style="western"><surname>Jolles</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sahakian</surname> <given-names>BJ</given-names></name>, <etal>et al</etal>. <article-title>Serotonergic modulation of prefrontal cortex during negative feedback in probabilistic reversal learning</article-title>. <source>Neuropsychopharmacology</source>. <year>2005</year>;<volume>30</volume>(<issue>6</issue>):<fpage>1138</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/sj.npp.1300663" xlink:type="simple">10.1038/sj.npp.1300663</ext-link></comment> <object-id pub-id-type="pmid">15689962</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref099">
<label>99</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Allman</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Meck</surname> <given-names>WH</given-names></name>. <article-title>Pathophysiological distortions in time perception and timed performance</article-title>. <source>Brain</source>. <year>2011</year>;<volume>135</volume>(<issue>3</issue>):<fpage>656</fpage>–<lpage>677</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/brain/awr210" xlink:type="simple">10.1093/brain/awr210</ext-link></comment> <object-id pub-id-type="pmid">21921020</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref100">
<label>100</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Radonovich</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Mostofsky</surname> <given-names>SH</given-names></name>. <article-title>Duration judgments in children with ADHD suggest deficient utilization of temporal information rather than general impairment in timing</article-title>. <source>Child Neuropsychology</source>. <year>2004</year>;<volume>10</volume>(<issue>3</issue>):<fpage>162</fpage>–<lpage>172</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/09297040409609807" xlink:type="simple">10.1080/09297040409609807</ext-link></comment> <object-id pub-id-type="pmid">15590495</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref101">
<label>101</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McInerney</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Kerns</surname> <given-names>KA</given-names></name>. <article-title>Time reproduction in children with ADHD: motivation matters</article-title>. <source>Child Neuropsychology</source>. <year>2003</year>;<volume>9</volume>(<issue>2</issue>):<fpage>91</fpage>–<lpage>108</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1076/chin.9.2.91.14506" xlink:type="simple">10.1076/chin.9.2.91.14506</ext-link></comment> <object-id pub-id-type="pmid">12815512</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref102">
<label>102</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Smith</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Taylor</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Warner Rogers</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Newman</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rubia</surname> <given-names>K</given-names></name>. <article-title>Evidence for a pure time perception deficit in children with ADHD</article-title>. <source>Journal of Child Psychology and Psychiatry</source>. <year>2002</year>;<volume>43</volume>(<issue>4</issue>):<fpage>529</fpage>–<lpage>542</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/1469-7610.00043" xlink:type="simple">10.1111/1469-7610.00043</ext-link></comment> <object-id pub-id-type="pmid">12030598</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref103">
<label>103</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hauser</surname> <given-names>TU</given-names></name>, <name name-style="western"><surname>Iannaccone</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ball</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mathys</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Brandeis</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Walitza</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Role of the medial prefrontal cortex in impaired decision making in juvenile attention-deficit/hyperactivity disorder</article-title>. <source>JAMA psychiatry</source>. <year>2014</year>;<volume>71</volume>(<issue>10</issue>):<fpage>1165</fpage>–<lpage>1173</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1001/jamapsychiatry.2014.1093" xlink:type="simple">10.1001/jamapsychiatry.2014.1093</ext-link></comment> <object-id pub-id-type="pmid">25142296</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref104">
<label>104</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Patzelt</surname> <given-names>EH</given-names></name>, <name name-style="western"><surname>Kool</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Millner</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>. <article-title>Incentives Boost Model-based Control Across a Range of Severity on Several Psychiatric Constructs</article-title>. <source>Biological Psychiatry</source>. <year>2018</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.biopsych.2018.06.018" xlink:type="simple">10.1016/j.biopsych.2018.06.018</ext-link></comment> <object-id pub-id-type="pmid">30077331</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref105">
<label>105</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Voon</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Reiter</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sebold</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Groman</surname> <given-names>S</given-names></name>. <article-title>Model-based control in dimensional psychiatry</article-title>. <source>Biological psychiatry</source>. <year>2017</year>;<volume>82</volume>(<issue>6</issue>):<fpage>391</fpage>–<lpage>400</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.biopsych.2017.04.006" xlink:type="simple">10.1016/j.biopsych.2017.04.006</ext-link></comment> <object-id pub-id-type="pmid">28599832</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref106">
<label>106</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schwartenbeck</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>FitzGerald</surname> <given-names>TH</given-names></name>, <name name-style="western"><surname>Mathys</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wurst</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Kronbichler</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Optimal inference with suboptimal models: addiction and active Bayesian inference</article-title>. <source>Medical hypotheses</source>. <year>2015</year>;<volume>84</volume>(<issue>2</issue>):<fpage>109</fpage>–<lpage>117</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.mehy.2014.12.007" xlink:type="simple">10.1016/j.mehy.2014.12.007</ext-link></comment> <object-id pub-id-type="pmid">25561321</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref107">
<label>107</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lucantonio</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Caprioli</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Schoenbaum</surname> <given-names>G</given-names></name>. <article-title>Transition from ‘model-based’to ‘model-free’behavioral control in addiction: involvement of the orbitofrontal cortex and dorsolateral striatum</article-title>. <source>Neuropharmacology</source>. <year>2014</year>;<volume>76</volume>:<fpage>407</fpage>–<lpage>415</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuropharm.2013.05.033" xlink:type="simple">10.1016/j.neuropharm.2013.05.033</ext-link></comment> <object-id pub-id-type="pmid">23752095</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref108">
<label>108</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chiu</surname> <given-names>PH</given-names></name>, <name name-style="western"><surname>Lohrenz</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Montague</surname> <given-names>PR</given-names></name>. <article-title>Smokers’ brains compute, but ignore, a fictive error signal in a sequential investment task</article-title>. <source>Nature neuroscience</source>. <year>2008</year>;<volume>11</volume>(<issue>4</issue>):<fpage>514</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn2067" xlink:type="simple">10.1038/nn2067</ext-link></comment> <object-id pub-id-type="pmid">18311134</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref109">
<label>109</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Voon</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Derbyshire</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Rück</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Irvine</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Worbe</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Enander</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Disorders of compulsivity: a common bias towards learning habits</article-title>. <source>Molecular psychiatry</source>. <year>2015</year>;<volume>20</volume>(<issue>3</issue>):<fpage>345</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/mp.2014.44" xlink:type="simple">10.1038/mp.2014.44</ext-link></comment> <object-id pub-id-type="pmid">24840709</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref110">
<label>110</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Endrass</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Koehne</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Riesel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kathmann</surname> <given-names>N</given-names></name>. <article-title>Neural correlates of feedback processing in obsessive–compulsive disorder</article-title>. <source>Journal of abnormal psychology</source>. <year>2013</year>;<volume>122</volume>(<issue>2</issue>):<fpage>387</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1037/a0031496" xlink:type="simple">10.1037/a0031496</ext-link></comment> <object-id pub-id-type="pmid">23421527</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006707.ref111">
<label>111</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Powers</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Mathys</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Corlett</surname> <given-names>P</given-names></name>. <article-title>Pavlovian conditioning–induced hallucinations result from overweighting of perceptual priors</article-title>. <source>Science</source>. <year>2017</year>;<volume>357</volume>(<issue>6351</issue>):<fpage>596</fpage>–<lpage>600</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.aan3458" xlink:type="simple">10.1126/science.aan3458</ext-link></comment> <object-id pub-id-type="pmid">28798131</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>