<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00779</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005596</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject><subj-group><subject>Motor neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject><subj-group><subject>Motor neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Random variables</subject><subj-group><subject>Covariance</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Signal processing</subject><subj-group><subject>Modulation</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Kalman filter</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Kalman filter</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Waves</subject><subj-group><subject>Square waves</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Single neuron function</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Single neuron function</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Inferring oscillatory modulation in neural spike trains</article-title>
<alt-title alt-title-type="running-head">Inferring oscillatory modulation in neural spike trains</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Arai</surname> <given-names>Kensuke</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kass</surname> <given-names>Robert E.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Statistics, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Center for the Neural Basis of Cognition, Pittsburgh, Pennsylvania, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Machine Learning Department, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Bethge</surname> <given-names>Matthias</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Tübingen and Max Planck Institute for Biologial Cybernetics, GERMANY</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item>
<p><bold>Conceived and designed the experiments:</bold> REK KA.</p>
</list-item>
<list-item>
<p><bold>Analyzed the data:</bold> KA.</p>
</list-item>
<list-item>
<p><bold>Wrote the paper:</bold> KA REK.</p>
</list-item>
</list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">kensuke.y.arai@gmail.com</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>10</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>6</day>
<month>10</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>10</issue>
<elocation-id>e1005596</elocation-id>
<history>
<date date-type="received">
<day>14</day>
<month>5</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>24</day>
<month>5</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Arai, Kass</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005596"/>
<abstract>
<p>Oscillations are observed at various frequency bands in continuous-valued neural recordings like the electroencephalogram (EEG) and local field potential (LFP) in bulk brain matter, and analysis of spike-field coherence reveals that spiking of single neurons often occurs at certain phases of the global oscillation. Oscillatory modulation has been examined in relation to continuous-valued oscillatory signals, and independently from the spike train alone, but behavior or stimulus triggered firing-rate modulation, spiking sparseness, presence of slow modulation not locked to stimuli and irregular oscillations with large variability in oscillatory periods, present challenges to searching for temporal structures present in the spike train. In order to study oscillatory modulation in real data collected under a variety of experimental conditions, we describe a flexible point-process framework we call the Latent Oscillatory Spike Train (LOST) model to decompose the instantaneous firing rate in biologically and behaviorally relevant factors: spiking refractoriness, event-locked firing rate non-stationarity, and trial-to-trial variability accounted for by baseline offset and a stochastic oscillatory modulation. We also extend the LOST model to accommodate changes in the modulatory structure over the duration of the experiment, and thereby discover trial-to-trial variability in the spike-field coherence of a rat primary motor cortical neuron to the LFP theta rhythm. Because LOST incorporates a latent stochastic auto-regressive term, LOST is able to detect oscillations when the firing rate is low, the modulation is weak, and when the modulating oscillation has a broad spectral peak.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Oscillatory modulation of neural activity in the brain is widely observed under conditions associated with a variety of cognitive tasks and mental states. Within individual neurons, oscillations may be uncovered in the moment-to-moment variation in neural firing rate. This, however, is often challenging because many factors may affect fluctuations in neural firing rate and, in addition, neurons fire irregular sets of action potentials, or spike trains, due to an unknown combination of meaningful signals and extraneous noise. We have devised a statistical Latent Oscillatory Spike Train (LOST) model with accompanying model-fitting technology, that is able to detect subtle oscillations in spike trains by taking into account both spiking noise and temporal variation in the oscillation itself. The method couples two techniques developed for other purposes in the literature on Bayesian analysis. Using data simulated from theoretical neurons and real data recorded from cortical motor neurons, we demonstrate the method’s ability to track changes in the modulatory structure of the oscillation across experimental trials.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000025</institution-id>
<institution>National Institute of Mental Health</institution>
</institution-wrap>
</funding-source>
<award-id>MH064537</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Kass</surname> <given-names>Robert E.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by the National Institute of Mental Health R01 MH064537 <ext-link ext-link-type="uri" xlink:href="http://www.nimh.nih.gov/index.shtml" xlink:type="simple">http://www.nimh.nih.gov/index.shtml</ext-link>. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="12"/>
<table-count count="0"/>
<page-count count="31"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-10-18</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All spike train data files are available from <ext-link ext-link-type="uri" xlink:href="https://www.github.com/AraiKensuke/PP-AR" xlink:type="simple">https://www.github.com/AraiKensuke/PP-AR</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Neural oscillations have generated considerable interest for their roles in cognition and as indicators for disease [<xref ref-type="bibr" rid="pcbi.1005596.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1005596.ref014">14</xref>]. Electroencephalograms (EEGs) and local field potential (LFPs) recordings have revealed transient oscillations in many cortical and subcortical structures, to which neurons both near and far from the LFP recording site show phase preferences in spiking. Groups of neurons that are locked to a common oscillation, and are therefore active in tightly confined temporal windows, may define a cell assembly whose synchronous spiking could select and activate afferent structures [<xref ref-type="bibr" rid="pcbi.1005596.ref015">15</xref>–<xref ref-type="bibr" rid="pcbi.1005596.ref017">17</xref>]. Such transient cell assemblies may form and disband as objects are attended to in the visual scene [<xref ref-type="bibr" rid="pcbi.1005596.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1005596.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref011">11</xref>], as preparation for movements are made [<xref ref-type="bibr" rid="pcbi.1005596.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref013">13</xref>], or during choice points for reward [<xref ref-type="bibr" rid="pcbi.1005596.ref009">9</xref>]. Prominent slow oscillations are observed as patients undergo anesthesia [<xref ref-type="bibr" rid="pcbi.1005596.ref010">10</xref>], and exhibit changes in dynamics during transitions in unconscious brain state [<xref ref-type="bibr" rid="pcbi.1005596.ref014">14</xref>]. Furthermore, strong oscillatory signals are prominent in neurological disorders such as Parkinson’s disease, and can be used to characterize pathophysiology and its relation to behavior [<xref ref-type="bibr" rid="pcbi.1005596.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref019">19</xref>]. The oscillatory structure of individual neurons can thus provide insight into the dynamics of cognitive processing and motor planning, and their implementation in health and disease. However, identifying oscillations in neural spike trains, particularly within individual experimental trials, can be challenging because they occur in conjunction with both non-oscillatory fluctuations in neural firing rate and extraneous noise. To tease apart multiple factors that affect spiking activity, statisticians have suggested the use of point process models together with modern regression methods associated with generalized linear model (GLM) technology [<xref ref-type="bibr" rid="pcbi.1005596.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref021">21</xref>]. In this paper we develop a method that can find oscillations in spike trains even when the signal is comparatively weak, and can track changes in oscillatory behavior across trials.</p>
<p>The starting point for our approach is the observation by Smith and Brown [<xref ref-type="bibr" rid="pcbi.1005596.ref022">22</xref>] that, for many purposes, evolving neural firing rates can be described using state-space models imbedded in point processes. We modify the models used by Smith and Brown, replacing their first-order autoregressive processes with higher-order processes [<xref ref-type="bibr" rid="pcbi.1005596.ref023">23</xref>] that can fit oscillations found in spiking neurons. This requires careful attention to the form of the higher-order autoregressive process. We take advantage of a Bayesian time-series decomposition introduced by Huerta and West [<xref ref-type="bibr" rid="pcbi.1005596.ref024">24</xref>], using prior probability distributions to constrain the fit so that it has appropriate power spectral content. We also use a Gibbs sampling method developed recently in a different context [<xref ref-type="bibr" rid="pcbi.1005596.ref025">25</xref>] to compute posterior distributions efficiently.</p>
<p>Our approach is superficially related to that of Allcroft <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005596.ref026">26</xref>], who used autoregressive moving average models to estimate spectral content from censored data, but their method does not accommodate easily the special situation we face with spiking neurons, including history effects that can account for hard and soft refractory periods. Point process models employing the GLM framework [<xref ref-type="bibr" rid="pcbi.1005596.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref027">27</xref>] have been employed to explain the spiking behavior by taking into account spiking refractoriness, behavioral and stimulus-induced non-stationarities, and spiking of neighboring neurons [<xref ref-type="bibr" rid="pcbi.1005596.ref020">20</xref>]. A series of investigations [<xref ref-type="bibr" rid="pcbi.1005596.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref019">19</xref>] have added long-term history effects to capture oscillation in the history dependence and have also used a state-space smoothing algorithm to track changes in the oscillatory dynamics over time. Eden et al used a long history to capture both, but as we shall see, LOST can better capture the irregularities present in realistic biological oscillations. Our approach is based on what we call the Latent Oscillatory Spike Train (LOST) model, which not only includes terms to describe the spiking refractoriness, event (behavior or stimulus)-locked effects, and trial-to-trial variability in firing rate, but also explicitly models the dynamics of the modulating oscillation itself. However, the latent state cannot capture the discontinuous change in the spiking probability that occurs after every spike, which the aforementioned GLM models do well in characterizing, so we utilize a short-term spiking history to capture the refractory period, while also introducing the latent state to model the oscillatory dynamics.</p>
<p>Oscillatory structure is often considerably degraded when it is observed as a spike train. On the one hand, if the firing rate is low, or the oscillatory modulation is weak, noise associated with erratic spiking will dominate. On the other hand, even if the modulation is strong and the firing rate is high, the oscillatory signal may itself be unsteady, with substantial variation in period from cycle to cycle. LOST accommodates both spiking noise and oscillatory variation by imbedding into the point process intensity function a latent auto-regressive process, and then imposing a suitable soft constraint (in the form of a prior probability distribution) on the oscillatory dynamics. We provide details of the model, along with the posterior sampling scheme and a discussion on how to interpret the posterior samples, and study its effectiveness with leaky integrate-and-fire neural simulations. We then demonstrate the ability of the LOST framework to find interesting trial-to-trial variation in motor cortical neuron during a lever-pulling task.</p>
</sec>
<sec id="sec002">
<title>Model</title>
<p>We seek to extract the underlying oscillation from the binary (<italic>M</italic> × <italic>N</italic>) matrix <bold>y</bold> representing the binned spiking data from a single neuron during <italic>M</italic> repetitions of identical behavior or stimulus presentations of time duration <italic>N</italic>. Because the spiking times are different for each trial, even though the behavior or stimulus are identical, we construct a probabilistic model of the spiking.</p>
<p>A point process models the probability of observing a spike at time <italic>t</italic>. The conditional intensity function (CIF) completely specifies the point process, and is defined as
<disp-formula id="pcbi.1005596.e001"><alternatives><graphic id="pcbi.1005596.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>λ</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>H</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">lim</mml:mo> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>→</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:munder> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mo>[</mml:mo> <mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>-</mml:mo> <mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>H</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>P</italic>[⋅|⋅] is a conditional probability conditioned on the past spiking history <italic>H</italic>(<italic>t</italic>) and model parameters Θ [<xref ref-type="bibr" rid="pcbi.1005596.ref021">21</xref>], making the point process CIF a spike history-dependent generalization of a general inhomogeneous Poisson process. We discretize the problem, and note that λ[<italic>t</italic>|<italic>H</italic>(<italic>t</italic>)]Δ<italic>t</italic> is the approximate binary probability of observing a single spike in a small time interval Δ<italic>t</italic>. In the discrete time representation, the likelihood of the spike train is then expressed as a product of conditionally independent Bernoulli events
<disp-formula id="pcbi.1005596.e002"><alternatives><graphic id="pcbi.1005596.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mrow><mml:mi>P</mml:mi> <mml:mo stretchy="false">[</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>H</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">]</mml:mo> <mml:mo>=</mml:mo> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mrow><mml:mi>M</mml:mi> <mml:mi>N</mml:mi></mml:mrow></mml:munderover> <mml:mi>p</mml:mi></mml:mstyle> <mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>H</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">]</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup> <mml:mi>p</mml:mi> <mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>H</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">]</mml:mo></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
The binary spiking probability is expressed as a sigmoidal function of a sum of several predictors, including a history term <bold>λ</bold><sup><italic>R</italic></sup>, modeling the refractoriness following a spike. In the simplest case, the predictors will be the shared trial-average effect (TAE) <bold>f</bold> = <bold><italic>β</italic></bold><sup><italic>T</italic></sup><bold><italic>α</italic></bold>, with <bold><italic>β</italic></bold> being the (<italic>K</italic><sub><italic>β</italic></sub> × <italic>N</italic>) matrix of the <italic>K</italic><sub><italic>β</italic></sub> B-spline basis vectors and <bold><italic>α</italic></bold> the <italic>K</italic><sub><italic>α</italic></sub> weights, the history term <bold>λ</bold><sup><italic>R</italic></sup> = <bold>H</bold><sup><italic>T</italic></sup> <bold>v</bold>, with <bold>H</bold> being the (<italic>K</italic><sub><italic>H</italic></sub> × <italic>N</italic>) matrix of the <italic>K</italic><sub><italic>H</italic></sub> B-spline basis vectors and <bold>v</bold> the <italic>K</italic><sub><italic>H</italic></sub> weights, the <italic>M</italic>-dimensional trial-specific baseline offset vector <bold><italic>μ</italic></bold>, and a time-dependent latent oscillational modulation <bold>x</bold>. The TAE is closely related to the peristimulus time histogram (PSTH) often employed in neuroscience. Together, the binary spiking probability for trial <italic>m</italic> at time <italic>n</italic> is
<disp-formula id="pcbi.1005596.e003"><alternatives><graphic id="pcbi.1005596.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup></mml:mrow></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup></mml:mrow></mml:msup></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(3a)</label></disp-formula> <disp-formula id="pcbi.1005596.e004"><alternatives><graphic id="pcbi.1005596.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>p</mml:mi></mml:munderover> <mml:msub><mml:mi>F</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3b)</label></disp-formula>
where <inline-formula id="pcbi.1005596.e005"><alternatives><graphic id="pcbi.1005596.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi> <mml:mrow><mml:mo>≥</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>L</italic>(<italic>m</italic>, <italic>n</italic>) is the last spike time before time <italic>n</italic> of the <italic>m</italic>th trial. From the data, we infer the parameters and the latent oscillation <bold>x</bold>, which is an AR(<italic>p</italic>) process, the <italic>F</italic><sub>1:<italic>p</italic></sub> the <italic>p</italic> AR coefficients and <italic>ϵ</italic><sub><italic>mn</italic></sub> a Gaussian random variable ∼ <italic>N</italic>(0, <italic>σ</italic><sup>2</sup>), where <italic>σ</italic><sup>2</sup> is the innovation variance. In what follows, we will often refer to the latent oscillation as simply oscillation. We also note that the inferred <bold>x</bold> may be spectrally broad, or have a very small amplitude, and may not be represent a signal that would commonly be called an oscillation.</p>
<p>The simplest oscillating AR model is of order 2 with complex eigenvalues, and may be a good model for a low dimensional oscillatory dynamical system. However fitting a model to noisy observed data utilizes noisy lagged values. The implied model for such a time series is an ARMA process, and an AR(2) would fail to capture all the structure in the observed data [<xref ref-type="bibr" rid="pcbi.1005596.ref024">24</xref>], so we approximate the ARMA process with a higher-order AR(p) process.</p>
<p>The spectra of AR(<italic>p</italic>) models is closely related to its <italic>p</italic> = 2<italic>C</italic> + <italic>R</italic> roots of the characteristic polynomial of <italic>F</italic><sub>1:<italic>p</italic></sub>, or equivalently to the eigenvalues of the matrix <bold>F</bold> in <xref ref-type="disp-formula" rid="pcbi.1005596.e008">Eq 6</xref>. The time-series decomposition [<xref ref-type="bibr" rid="pcbi.1005596.ref024">24</xref>] approach restricts the AR(<italic>p</italic>) to those with <italic>C</italic> imaginary AR(2) components and <italic>R</italic> real AR(1) components, ie only models that can accommodate the spectral features we believe are present in the data. We work through the rest of the paper using a generic structure that has proven to be a generally reasonable component structure (<italic>C</italic> = 4 and <italic>R</italic> = 1) for a wide range of simulation parameters and for real data, though model order and component structure can also be inferred from the data.</p>
<sec id="sec003">
<title>Model fitting</title>
<p>Gibbs sampling [<xref ref-type="bibr" rid="pcbi.1005596.ref028">28</xref>] and data augmentation [<xref ref-type="bibr" rid="pcbi.1005596.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref030">30</xref>] are used to infer the model parameters Θ = [<italic>F</italic><sub>1:<italic>p</italic></sub>, <italic>σ</italic><sup>2</sup>, <bold><italic>α</italic></bold>, <bold><italic>μ</italic></bold>, <bold>v</bold>] and the oscillation <bold>x</bold>. The spike history and TAE are functions of time relative to the last spike of an event or behavior, respectively, and they are estimated by parameterizing a subset of continuous functions with splines. The estimation requires us to choose a set of basis splines, which we choose heuristically, using some prior belief about their general shape to choose the knot locations. In the current work, the number and locations of the knots are not found with the Gibbs sampling procedure, so we briefly describe how they are determined before we describe the Gibbs sampling procedure.</p>
<sec id="sec004">
<title>Short-term spike history λ<sup><italic>R</italic></sup></title>
<p>Neurons typically have a refractory period following an action potential, when sodium channels in the membrane become inactive and spiking is strongly suppressed. As the channels reactivate, the neuron may experience a period of rebound excitation, where spiking probability becomes enhanced, before returning to some baseline level. This effect can be modeled by a modulation of probability since the last spike. We employ cubic splines to express the refractory modulation function, with knots placed where we would like to constrain function values, where we believe the function reaches extremum values, and places in between. The interspike interval (ISI) histogram reflects combined effects of both the spiking history and oscillation, but at the smaller intervals, the refractory inhibition and rebound excitation are rapidly changing, possibly from 0 to well over 1, while a biologically plausible oscillation varies over a more limited range of values centered around 1. The shape of the ISI histogram for smaller intervals should reflect the refractory modulation function more than the oscillation, so we place history spline knots based on features of the ISI near 0. In the case the ISI histogram has a minimum at 0 followed by a maxima, we place knots at <italic>t</italic> = Δ, one knot at the first maxima, one knot at the mean of the ISIs, and knots at the 70th and 80th percentiles of the ISI distribution. We further have knots at the 97th and at 100ms set to 0, constraining the asymptotic value of the history function. Further, if the bins of the ISI at time Δ are empty, we set <italic>v</italic><sub>0</sub> = −6 to prevent it from taking unconstrained negative values. If the histogram at 0 is the maximum value, we leave <italic>v</italic><sub>0</sub> unconstrained.</p>
</sec>
<sec id="sec005">
<title>TAE spline basis <italic>β</italic></title>
<p>To represent a smooth, arbitrary-shaped curve, we use the piecewise cubic B-spline as basis functions. Choosing the appropriate number and locations of basis functions is vital to represent the curve well, and too many points will result in overfitting. We determine the number and locations prior to the Gibbs procedure, by assuming that the shape of the TAE <bold>f</bold> in <xref ref-type="disp-formula" rid="pcbi.1005596.e003">Eq (3a)</xref> is similar to the empirical PSTH. We randomly vary the number and locations of the spline knots <italic>β</italic> and find a set which minimizes the squared error with the PSTH under the constraint that no more than 9 knots are to be used for the data presented in this paper. The shape of the PSTH can be used as a guide to guess the rough number of knots necessary, and the constraint can be changed accordingly for the spike train under investigation.</p>
</sec>
<sec id="sec006">
<title>Posterior simulation</title>
<p>We now introduce the posterior distribution, from which the conditional posteriors necessary for Gibbs sampling, and the generating distributions necessary for data augmentation, are derived. Our model is a state-space model with a point-process observable, and a latent oscillation evolving as an AR(<italic>p</italic>)-process. The posterior distribution of the parameters Θ is
<disp-formula id="pcbi.1005596.e006"><alternatives><graphic id="pcbi.1005596.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>|</mml:mo> <mml:mtext mathvariant="bold">y</mml:mtext> <mml:mo stretchy="false">)</mml:mo> <mml:mo>∝</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">y</mml:mtext> <mml:mo>,</mml:mo> <mml:mtext mathvariant="bold">x</mml:mtext> <mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mi>d</mml:mi> <mml:mtext mathvariant="bold">x</mml:mtext> <mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∫</mml:mo> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">y</mml:mtext> <mml:mo>|</mml:mo> <mml:mtext mathvariant="bold">x</mml:mtext> <mml:mo>,</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mtext mathvariant="bold">x</mml:mtext> <mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:mstyle> <mml:mtext mathvariant="bold">x</mml:mtext></mml:math></alternatives> <label>(4)</label></disp-formula>
For the AR(<italic>p</italic>) model, <italic>p</italic>(<bold>x</bold>|Θ) does not have a simple expression. However, if <bold>x</bold> were a Markov process, then <italic>p</italic>(<bold>x</bold>|Θ) could be expressed recursively in terms of the initial probability at time 0. AR(<italic>p</italic>) can be made a Markov process if we define a new (<italic>N</italic> × <italic>M</italic> × <italic>p</italic>) matrix <bold>X</bold>, where <bold>X</bold> <italic><sub>mn</sub></italic> = (<italic>x</italic><sub><italic>m</italic>,<italic>n</italic>−1</sub>, …, <italic>x</italic> <italic><sub>m,n−p</sub></italic>)<sup><italic>T</italic></sup>. <xref ref-type="disp-formula" rid="pcbi.1005596.e004">Eq (3b)</xref> is then
<disp-formula id="pcbi.1005596.e007"><alternatives><graphic id="pcbi.1005596.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:msub><mml:mtext mathvariant="bold">X</mml:mtext> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">F</mml:mi> <mml:msub><mml:mtext mathvariant="bold">X</mml:mtext> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">ϵ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:math></alternatives> <label>(5)</label></disp-formula>
where
<disp-formula id="pcbi.1005596.e008"><alternatives><graphic id="pcbi.1005596.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mtext mathvariant="bold">F</mml:mtext></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mtd> <mml:mtd><mml:msub><mml:mi>F</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:msub><mml:mi>F</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:msub><mml:mi>F</mml:mi> <mml:mi>p</mml:mi></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mspace width="14.22636pt"/><mml:mtext>and</mml:mtext> <mml:mspace width="4.pt"/><mml:mspace width="4.26773pt"/><mml:msub><mml:mi mathvariant="bold-italic">ϵ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
(<italic>N</italic> × <italic>M</italic>) matrix <bold>x</bold> is the oscillation we would like to infer, and likely corresponds to oscillations of the membrane potential due to oscillating synaptic inputs [<xref ref-type="bibr" rid="pcbi.1005596.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref032">32</xref>]. <xref ref-type="disp-formula" rid="pcbi.1005596.e006">Eq (4)</xref> then becomes
<disp-formula id="pcbi.1005596.e009"><alternatives><graphic id="pcbi.1005596.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>∝</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mstyle displaystyle="true"><mml:mrow><mml:msub><mml:mo>∫</mml:mo> <mml:mtext mathvariant="bold">X</mml:mtext></mml:msub> <mml:mrow><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover></mml:mrow></mml:mrow></mml:mstyle> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle> <mml:mrow><mml:msup><mml:mi>n</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mtext mathvariant="bold">X</mml:mtext> <mml:mrow><mml:mi>m</mml:mi> <mml:msup><mml:mi>n</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mtext mathvariant="bold">X</mml:mtext> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>n</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mtext mathvariant="bold">X</mml:mtext> <mml:mrow><mml:mi>m</mml:mi> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mi>d</mml:mi> <mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow> <mml:mo>]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula></p>
</sec>
</sec>
<sec id="sec007">
<title>Conditional posteriors and data augmentation for Gibbs sampling</title>
<p>We jointly sample model parameters and latent states from the joint posterior distribution, <xref ref-type="disp-formula" rid="pcbi.1005596.e006">Eq (4)</xref>, using Gibbs sampling with data augmentation. The conditional posterior distribution can be read off from the full joint posterior distribution by considering all parameters fixed, except the parameter whose conditional posterior we are interested in. Our problem deviates from the standard Gibbs sampling by the missing data <bold>x</bold> in <xref ref-type="disp-formula" rid="pcbi.1005596.e006">Eq (4)</xref>, and we utilize the data augmentation strategy [<xref ref-type="bibr" rid="pcbi.1005596.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref030">30</xref>], a scheme of simplifying analysis by augmenting the observed data with missing values, to generate samples of <bold>X</bold> from the predictive distribution <italic>p</italic>(<bold>X</bold>|<bold>y</bold>, Θ) in between sampling parameters from the standard conditional posteriors. Even with samples of <bold>X</bold> in hand, the posterior distribution does not yield conditional posteriors that can be sampled easily. The recently developed Pólya-Gamma data augmentation scheme [<xref ref-type="bibr" rid="pcbi.1005596.ref025">25</xref>] allows sampling from simple Gaussian conditional posteriors at the cost of introducing the <italic>M</italic> × <italic>N</italic> matrix of Pólya-Gamma variables <bold><italic>ω</italic></bold> through the following identity for the spike probability:
<disp-formula id="pcbi.1005596.e010"><alternatives><graphic id="pcbi.1005596.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:msup> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mo>×</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>∞</mml:mi></mml:msubsup> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup> <mml:mi>P</mml:mi> <mml:mi>G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>z</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>∝</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup> <mml:mo>|</mml:mo> <mml:mfrac><mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:mo>,</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:mo/> <mml:mo>)</mml:mo> <mml:mi>P</mml:mi> <mml:mi>G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>z</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
where <italic>PG</italic>(<italic>ω</italic><sub><italic>mn</italic></sub>|<italic>b</italic> = 1, <italic>z</italic> = 0) is the Pólya-Gamma distribution with parameters <italic>b</italic> = 1 and <italic>z</italic> = 0, and <inline-formula id="pcbi.1005596.e011"><alternatives><graphic id="pcbi.1005596.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:mi mathvariant="bold-italic">κ</mml:mi> <mml:mo>≡</mml:mo> <mml:mtext mathvariant="bold">y</mml:mtext> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>With the introduction of the Pólya-Gamma variables, the joint posterior <xref ref-type="disp-formula" rid="pcbi.1005596.e006">Eq (4)</xref> becomes
<disp-formula id="pcbi.1005596.e012"><alternatives><graphic id="pcbi.1005596.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>∝</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mstyle displaystyle="true"><mml:mrow><mml:msub><mml:mo>∫</mml:mo> <mml:mtext mathvariant="bold">X</mml:mtext></mml:msub> <mml:mrow><mml:mrow> <mml:mo>[</mml:mo> <mml:mrow><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle> <mml:mrow><mml:msup><mml:mi>n</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mtext mathvariant="bold">X</mml:mtext> <mml:mrow><mml:mi>m</mml:mi> <mml:msup><mml:mi>n</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mtext mathvariant="bold">X</mml:mtext> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>n</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mtext mathvariant="bold">X</mml:mtext> <mml:mrow><mml:mi>m</mml:mi> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mo>×</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover></mml:mstyle> <mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mrow><mml:mi>N</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup> <mml:mo>|</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo stretchy="false">)</mml:mo> <mml:mi>P</mml:mi> <mml:mi>G</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>z</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo stretchy="false">)</mml:mo> <mml:mi>d</mml:mi> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo stretchy="false">]</mml:mo> <mml:mi>d</mml:mi> <mml:mtext mathvariant="bold">X</mml:mtext> <mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
from which we derive the conditional posteriors for the parameters and the predictive distributions for the augmented variables. We refer to the set of augmented variables as <bold>V</bold><sup>+</sup> = {<bold>X</bold>, <bold>ω</bold>}, and denote by Θ<sub>\<italic>x</italic></sub> to be the set of all parameters except parameter <italic>x</italic>.</p>
<sec id="sec008">
<title>Sampling <italic>μ</italic></title>
<p>The conditional posterior of <bold><italic>μ</italic></bold> ∼ <italic>N</italic> (<bold>M<sub><italic>μ</italic></sub></bold>, <bold>Σ<sub><italic>μ</italic></sub></bold>) is a multivariate Gaussian, and if we constrain <bold><italic>μ</italic></bold> such that <inline-formula id="pcbi.1005596.e013"><alternatives><graphic id="pcbi.1005596.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mi>m</mml:mi> <mml:mi>M</mml:mi></mml:msubsup> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, and set <inline-formula id="pcbi.1005596.e014"><alternatives><graphic id="pcbi.1005596.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msub><mml:mi>μ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, it becomes
<disp-formula id="pcbi.1005596.e015"><alternatives><graphic id="pcbi.1005596.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mo>Θ</mml:mo> <mml:mrow><mml:mo>\</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>+</mml:mo></mml:msup> <mml:mo stretchy="false">)</mml:mo> <mml:mo>∝</mml:mo> <mml:mtext>exp</mml:mtext> <mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:munderover></mml:mstyle> <mml:mo>−</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi> <mml:mi>N</mml:mi></mml:munderover></mml:mstyle> <mml:mfrac><mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac> <mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>m</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>&gt;</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover></mml:mstyle> <mml:msub><mml:mi>μ</mml:mi> <mml:msup><mml:mi>m</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>O</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>−</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi mathvariant="bold-italic">μ</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msubsup><mml:mi mathvariant="bold">D</mml:mi> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>−</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi mathvariant="bold-italic">μ</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mtext>exp</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msub><mml:mi>Q</mml:mi> <mml:mi mathvariant="bold-italic">μ</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula>
where <inline-formula id="pcbi.1005596.e016"><alternatives><graphic id="pcbi.1005596.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:msub><mml:mi>O</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>≡</mml:mo> <mml:mfrac><mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:mo>-</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. The covariance can be read off from the quadratic term,
<disp-formula id="pcbi.1005596.e017"><alternatives><graphic id="pcbi.1005596.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo>∑</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>3</mml:mn> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>M</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
The mean <bold>M</bold><bold><sub><italic>μ</italic></sub></bold> is at the minimum of <italic>Q</italic><bold><sub><italic>μ</italic></sub></bold>, which can be found by setting <inline-formula id="pcbi.1005596.e018"><alternatives><graphic id="pcbi.1005596.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>Q</mml:mi> <mml:mi mathvariant="bold-italic">μ</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, or <inline-formula id="pcbi.1005596.e019"><alternatives><graphic id="pcbi.1005596.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">Σ</mml:mi> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msub><mml:mi mathvariant="bold">M</mml:mi> <mml:mi mathvariant="bold-italic">μ</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">g</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>g</italic><sub><italic>i</italic></sub> = ∑<sub><italic>n</italic></sub> <italic>ω</italic><sub>1<italic>n</italic></sub><italic>O</italic><sub>1<italic>n</italic></sub> − <italic>ω</italic><sub><italic>in</italic></sub><italic>O</italic><sub><italic>in</italic></sub>.</p>
</sec>
<sec id="sec009">
<title>Sampling v</title>
<p><bold>v</bold> are the vector spline weights for the spike history, and {<italic>I</italic><sub><italic>H</italic></sub>} = {1, …, <italic>K</italic><sub><italic>H</italic></sub>} its component indices. We impose our prior belief about the timescale and shape of the spike history term by keeping some of the knots fixed, while re-weighting the remaining ones. The indices of the fixed ones we denote {<italic>I</italic><sub><italic>f</italic></sub>} and the adjustable one {<italic>I</italic><sub><italic>a</italic></sub>}, with {<italic>I</italic><sub><italic>f</italic></sub>} ∪ {<italic>I</italic><sub><italic>a</italic></sub>} = {<italic>I</italic><sub><italic>H</italic></sub>} and {<italic>I</italic><sub><italic>f</italic></sub>} ∩ {<italic>I</italic><sub><italic>a</italic></sub>} = ∅. We use the shorthand notations <bold>a</bold> to be the vector comprised of components {<italic>I</italic><sub><italic>a</italic></sub>} of <bold>v</bold>, and {<italic>I</italic><sub><italic>a</italic></sub>} = {<italic>a</italic>(1), <italic>a</italic>(2), …<italic>a</italic>(|{<italic>I</italic><sub><italic>a</italic></sub>}|)}, its numerical values. Then the conditional posterior of <bold>a</bold> ∼ <italic>N</italic> (<bold>M</bold><sub><bold>a</bold></sub>, <bold>Σ</bold><sub><bold>a</bold></sub>) is a multivariate Gaussian. Defining <inline-formula id="pcbi.1005596.e020"><alternatives><graphic id="pcbi.1005596.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:msub><mml:mi>O</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>≡</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac><mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:mo>-</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, it is
<disp-formula id="pcbi.1005596.e021"><alternatives><graphic id="pcbi.1005596.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi mathvariant="bold">a</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mo>Θ</mml:mo> <mml:mrow><mml:mo>\</mml:mo> <mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>+</mml:mo></mml:msup> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∝</mml:mo> <mml:mtext>exp</mml:mtext> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mi>m</mml:mi> <mml:mi>M</mml:mi></mml:munderover></mml:mstyle> <mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi> <mml:mi>N</mml:mi></mml:munderover></mml:mstyle> <mml:mfrac><mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup> <mml:mo>−</mml:mo> <mml:msub><mml:mi>O</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mo>…</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi mathvariant="bold">v</mml:mi> <mml:mo>−</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi mathvariant="bold">v</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mi mathvariant="bold">D</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi mathvariant="bold">v</mml:mi> <mml:mo>−</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi mathvariant="bold">v</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mi>m</mml:mi> <mml:mi>M</mml:mi></mml:munderover></mml:mstyle> <mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi> <mml:mi>N</mml:mi></mml:munderover></mml:mstyle> <mml:mo>−</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi> <mml:mrow><mml:msub><mml:mi>K</mml:mi> <mml:mi>H</mml:mi></mml:msub></mml:mrow></mml:munderover></mml:mstyle> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>v</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi>O</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder></mml:mstyle> <mml:mfrac><mml:mrow><mml:msubsup><mml:mi>v</mml:mi> <mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>−</mml:mo> <mml:mn>2</mml:mn> <mml:msub><mml:mi>v</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>μ</mml:mi> <mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mtext>exp</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msub><mml:mi>Q</mml:mi> <mml:mi mathvariant="bold">a</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(12)</label></disp-formula>
The mean <bold>M<sub>a</sub></bold> of the adjustable knots is the solution of the set of linear equations whose <italic>i</italic>th equation, <italic>i</italic> ∈ {<italic>I</italic><sub><italic>a</italic></sub>} is
<disp-formula id="pcbi.1005596.e022"><alternatives><graphic id="pcbi.1005596.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:mn>2</mml:mn> <mml:mo>(</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mi>m</mml:mi> <mml:mi>M</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi> <mml:mi>N</mml:mi></mml:munderover> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mo>)</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mo>(</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mi>m</mml:mi> <mml:mi>M</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi> <mml:mi>N</mml:mi></mml:munderover> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:msub><mml:mi>μ</mml:mi> <mml:msub><mml:mi>v</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mi>f</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:mo>(</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mi>m</mml:mi> <mml:mi>M</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi> <mml:mi>N</mml:mi></mml:munderover> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mo>)</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>The covariance can be read off from the quadratic term, and is
<disp-formula id="pcbi.1005596.e023"><alternatives><graphic id="pcbi.1005596.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">Σ</mml:mi> <mml:mi mathvariant="bold">a</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>…</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>…</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋱</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(13)</label></disp-formula></p>
</sec>
<sec id="sec010">
<title>Sampling <italic>α</italic></title>
<p>The conditional posterior of <bold><italic>α</italic></bold> ∼ <italic>N</italic> (<bold>M</bold><sub><bold><italic>α</italic></bold></sub>, <bold>Σ</bold><sub><bold><italic>α</italic></bold></sub>) is multivariate Gaussian,
<disp-formula id="pcbi.1005596.e024"><alternatives><graphic id="pcbi.1005596.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mo>Θ</mml:mo> <mml:mrow><mml:mo>\</mml:mo> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>+</mml:mo></mml:msup> <mml:mo stretchy="false">)</mml:mo> <mml:mo>∝</mml:mo> <mml:mtext>exp</mml:mtext> <mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>≠</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:munderover> <mml:mo>−</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula>
By rearranging, we can easily calculate the mean and variance of the conditionals for <bold><italic>α</italic></bold>. If <italic>n</italic> or <italic>m</italic> is kept fixed in the sum, this is a quadratic form of <italic>M</italic> or <italic>N</italic>-dim vectors with a diagonal covariance matrix, and <bold><italic>α</italic></bold> ∼ <italic>N</italic> (<bold>M</bold>, <bold>Σ</bold>), For <bold><italic>α</italic></bold>,
<disp-formula id="pcbi.1005596.e025"><alternatives><graphic id="pcbi.1005596.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">M</mml:mi> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">D</mml:mi> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:msub> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:msub><mml:mi mathvariant="bold">D</mml:mi> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:msub> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">W</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi mathvariant="bold">O</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi mathvariant="bold-italic">α</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo> <mml:mrow><mml:msubsup><mml:mrow/> <mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mi mathvariant="bold-italic">β</mml:mi> <mml:msup><mml:mi mathvariant="bold">W</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">D</mml:mi> <mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi mathvariant="bold">W</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mi>m</mml:mi></mml:munder> <mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle> <mml:mo>,</mml:mo> <mml:mspace width="1pt"/> <mml:mtext>where</mml:mtext> <mml:mspace width="1pt"/> <mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">W</mml:mi> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mi mathvariant="bold">O</mml:mi></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mi mathvariant="bold">W</mml:mi> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mi>m</mml:mi></mml:munder> <mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle> <mml:msub><mml:mi mathvariant="bold">O</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="1pt"/> <mml:mtext>where</mml:mtext> <mml:mspace width="1pt"/> <mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi mathvariant="bold">O</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mi>n</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>−</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup> <mml:mo>−</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula> <bold><italic>μ</italic><sub><italic>α</italic></sub></bold> and <bold>D</bold><bold><italic><sub>α</sub></italic></bold> are prior mean and covariances for <bold><italic>α</italic></bold>. Aside from the smoothness imposed by the restriction to the number of knots, we have no prior knowledge about the offsets and knot weights, so we set the means to 0 and the covariances to be broad.</p>
</sec>
<sec id="sec011">
<title>Sampling <italic>σ</italic><sup>2</sup></title>
<p>The conditional posterior distribution of the innovation variance is
<disp-formula id="pcbi.1005596.e026"><alternatives><graphic id="pcbi.1005596.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msub><mml:mo>Θ</mml:mo> <mml:mrow><mml:mo>\</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">ω</mml:mi></mml:mrow></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>∝</mml:mo> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>M</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mtext>exp</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:munder></mml:mstyle> <mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi mathvariant="bold">F</mml:mi> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(16)</label></disp-formula>
and is in the form of an inverse Gamma distribution. We choose a conjugate inverse Gaussian prior with parameters <italic>α</italic><sub><italic>σ</italic><sup>2</sup></sub> and <italic>β</italic><sub><italic>σ</italic><sup>2</sup></sub>, and sample as
<disp-formula id="pcbi.1005596.e027"><alternatives><graphic id="pcbi.1005596.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>∼</mml:mo> <mml:mi>I</mml:mi> <mml:mi>G</mml:mi> <mml:mo stretchy="false">[</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>|</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mi>M</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>,</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mrow><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:munder></mml:mstyle> <mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi mathvariant="bold">F</mml:mi> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(17)</label></disp-formula>
As with the offset and spline weights, we have no <italic>apriori</italic> knowledge about an appropriate range of values for <italic>σ</italic><sup>2</sup>. In order to minimize the effect of the prior, we choose a small values for <italic>α</italic><sub><italic>σ</italic><sup>2</sup></sub> (relative to the amount of data), and <italic>β</italic><sub><italic>σ</italic><sup>2</sup></sub>, so that small values of <italic>σ</italic><sup>2</sup> can also be sampled.</p>
</sec>
<sec id="sec012">
<title>Sampling <italic>F</italic><sub>1:<italic>p</italic></sub></title>
<p>Without further assumptions on the latent dynamics [<xref ref-type="bibr" rid="pcbi.1005596.ref033">33</xref>], the conditional posterior is a simple multivariate normal distribution. However, for application to spiking data, this naive approach often does not produce desired results for two main reasons. First, the constrained sampling of the coefficients to the stationary regime is inefficient, due to the nontrivial shape of the surface of the stationary manifold [<xref ref-type="bibr" rid="pcbi.1005596.ref024">24</xref>]. Second, our observations are noisy and sparse, and maximum likelihood using a flat prior may not find a state with an oscillatory character. The component decomposition [<xref ref-type="bibr" rid="pcbi.1005596.ref024">24</xref>] approach addresses both of these concerns, and allows us to specifically search for models with an oscillatory character through the imposition of an informative prior.</p>
<p>We seek to sample
<disp-formula id="pcbi.1005596.e028"><alternatives><graphic id="pcbi.1005596.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mo>Θ</mml:mo><mml:mrow><mml:mo>\</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>V</mml:mi></mml:mstyle><mml:mo>+</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:munder></mml:mstyle><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>F</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(18)</label></disp-formula>
with the prior <italic>p</italic>(<italic>F</italic><sub>1:<italic>p</italic></sub>) a structural prior which restricts sampling of <italic>F</italic><sub>1:<italic>p</italic></sub> to the subspace of coefficients for which the process is stationary and its characteristic polynomial has <italic>R</italic> real roots and <italic>C</italic> pairs of imaginary roots. For what follows, we drop the pairs qualifier when referring to one of the pairs of imaginary roots. Instead of sampling the entire <italic>F</italic><sub>1:<italic>p</italic></sub> at once, we sample one of the <italic>C</italic> imaginary or <italic>R</italic> real roots at a time while keeping the rest of the roots fixed, via Markov Chain Monte Carlo (MCMC) as follows.</p>
<p>The residuals of the AR(<italic>p</italic>) process are uncorrelated Gaussians, but leaving out one of the roots results in residuals that are correlated. We now outline the case when sampling an imaginary root. Here, we consider the correlated residual to be an AR(2) process. Ignoring the trial index, <italic>x</italic><sub><italic>n</italic></sub> is related to the <italic>p</italic> lagged values <italic>x</italic><sub><italic>n</italic>−1</sub>, …<italic>x</italic><sub><italic>n</italic>−<italic>p</italic></sub> through the AR coefficients and an innovation variance. Utilizing the backshift operator, <inline-formula id="pcbi.1005596.e029"><alternatives><graphic id="pcbi.1005596.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:msub><mml:mi>x</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, <xref ref-type="disp-formula" rid="pcbi.1005596.e004">eq (3b)</xref> can be written as a polynomial in <inline-formula id="pcbi.1005596.e030"><alternatives><graphic id="pcbi.1005596.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, and the polynomial as a product of its <italic>R</italic> real roots <italic>α</italic><sub><italic>j</italic></sub>, <italic>j</italic> ∈ {1, …, <italic>R</italic>} and <italic>C</italic> pairs of complex roots <inline-formula id="pcbi.1005596.e031"><alternatives><graphic id="pcbi.1005596.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:msub><mml:mi>γ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>γ</mml:mi> <mml:mi>j</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <italic>j</italic> ∈ {1, …, <italic>C</italic>}.</p>
<p>With the roots calculated, the AR process, <xref ref-type="disp-formula" rid="pcbi.1005596.e004">Eq (3b)</xref>, can be represented as
<disp-formula id="pcbi.1005596.e032"><alternatives><graphic id="pcbi.1005596.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>r</mml:mi></mml:mrow> <mml:mi>R</mml:mi></mml:munderover> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>r</mml:mi></mml:msub> <mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>c</mml:mi></mml:mrow> <mml:mi>C</mml:mi></mml:munderover> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>γ</mml:mi> <mml:mi>c</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula>
The coefficient for <inline-formula id="pcbi.1005596.e033"><alternatives><graphic id="pcbi.1005596.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:msup><mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msup></mml:math></alternatives></inline-formula>, <italic>i</italic> ∈ {1, …, <italic>p</italic>}, is <italic>F</italic><sub><italic>i</italic></sub>. Regrouping the terms, we rewrite the residuals when the contribution of the <italic>j</italic>th complex root is removed, to obtain a new time series <italic>ω</italic><sub><italic>jn</italic></sub>:
<disp-formula id="pcbi.1005596.e034"><alternatives><graphic id="pcbi.1005596.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>γ</mml:mi> <mml:mi>j</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mi>r</mml:mi> <mml:mi>R</mml:mi></mml:munderover> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>r</mml:mi></mml:msub> <mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>C</mml:mi></mml:munderover> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>γ</mml:mi> <mml:mi>c</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>x</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(20)</label></disp-formula>
This equation tells us how to obtain the <italic>ω</italic><sub><italic>jn</italic></sub>, and that we are treating that time series as an AR(2). We note that given a timeseries <bold>x</bold> <italic><sub>m</sub></italic> and some <italic>F</italic><sub>1:<italic>p</italic></sub>, we could calculate the residual <bold><italic>ϵ</italic></bold>, and this would be the same series of <italic>N</italic> numbers had we first obtained the <bold>w</bold> <italic><sub>j</sub></italic>, and then calculated the <italic>N</italic> <inline-formula id="pcbi.1005596.e035"><alternatives><graphic id="pcbi.1005596.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>γ</mml:mi> <mml:mi>j</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Given that its eigenvalues <inline-formula id="pcbi.1005596.e036"><alternatives><graphic id="pcbi.1005596.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:msub><mml:mi>γ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>γ</mml:mi> <mml:mi>j</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> have corresponding angle 2<italic>π</italic>/λ<sub><italic>j</italic></sub> and modulus <italic>r</italic><sub><italic>j</italic></sub>, which control the frequency and the steadiness of the oscillation when these parameters are used to generate a time series. Using Vieta’s formula [<xref ref-type="bibr" rid="pcbi.1005596.ref034">34</xref>], the AR(2) coefficients <inline-formula id="pcbi.1005596.e037"><alternatives><graphic id="pcbi.1005596.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>γ</mml:mi> <mml:mi>j</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005596.e038"><alternatives><graphic id="pcbi.1005596.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msubsup><mml:mi>γ</mml:mi> <mml:mi>j</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are related to the frequency and modulus as 2<italic>r</italic><sub><italic>j</italic></sub> cos(2<italic>π</italic>/λ<sub><italic>j</italic></sub>) and <inline-formula id="pcbi.1005596.e039"><alternatives><graphic id="pcbi.1005596.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:mo>-</mml:mo> <mml:msubsup><mml:mi>r</mml:mi> <mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, and
<disp-formula id="pcbi.1005596.e040"><alternatives><graphic id="pcbi.1005596.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:mrow></mml:msub> <mml:mo>∼</mml:mo> <mml:mi>N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>h</mml:mi></mml:mstyle> <mml:mo>,</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="bold">H</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow> <mml:mrow><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(21)</label></disp-formula>
where
<disp-formula id="pcbi.1005596.e041"><alternatives><graphic id="pcbi.1005596.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtable columnalign="right"><mml:mtr columnalign="right"><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">H</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">D</mml:mi> <mml:mi>j</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:msub><mml:mi mathvariant="bold">D</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="right"><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">h</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">H</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msubsup><mml:mi mathvariant="bold">D</mml:mi> <mml:mi>j</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:msubsup><mml:mi mathvariant="bold">w</mml:mi> <mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">D</mml:mi> <mml:mi>j</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>…</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>…</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi> <mml:mo>−</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">w</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>…</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
The stationary regime is defined by <italic>r</italic><sub><italic>j</italic></sub> ≤ 1, so in sampling from the conditional posterior, we must restrict the sampling to regions bounded by the curves
<disp-formula id="pcbi.1005596.e042"><alternatives><graphic id="pcbi.1005596.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e042" xlink:type="simple"/><mml:math display="block" id="M42"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mn>4</mml:mn></mml:mfrac> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="22.76228pt"/><mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
This boundary describes a truncated 2-variate normal distribution.</p>
<p>When the root in question is real, we remove its contribution to obtain the correlated residuals
<disp-formula id="pcbi.1005596.e043"><alternatives><graphic id="pcbi.1005596.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:msub><mml:mi>u</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>R</mml:mi></mml:munderover> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>r</mml:mi></mml:msub> <mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>c</mml:mi></mml:mrow> <mml:mi>C</mml:mi></mml:munderover> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>γ</mml:mi> <mml:mi>c</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>x</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(24)</label></disp-formula>
The real roots are can be sampled from a truncated univariate normal with mean <italic>m</italic><sub><italic>j</italic></sub> and variance <italic>M</italic><sub><italic>j</italic></sub> <disp-formula id="pcbi.1005596.e044"><alternatives><graphic id="pcbi.1005596.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e044" xlink:type="simple"/><mml:math display="block" id="M44"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msub><mml:mi>u</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>u</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>u</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="28.45274pt"/><mml:msub><mml:mi>M</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>u</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula></p>
<p>We further assume a simple informative, uniformly distributed prior of [0.97, 1] for the modulus of the slowest root. Large modulus roots are spectrally peaked, and correspond to oscillations with a relatively well-defined frequency. Our choice of a prior on the modulus is similar to adding regularization terms to the likelihood to address concerns about overfitting when data is limited, an alternative avenue recently investigated by Buesing et al [<xref ref-type="bibr" rid="pcbi.1005596.ref035">35</xref>], although this requires the structured decomposition of the AR model, which would be difficult to express in terms of regularization functions.</p>
</sec>
<sec id="sec013">
<title>The latent oscillation: X data augmentation</title>
<p>The predictive distribution for <bold>X</bold> can be read off from <xref ref-type="disp-formula" rid="pcbi.1005596.e006">Eq (4)</xref>, and is
<disp-formula id="pcbi.1005596.e045"><alternatives><graphic id="pcbi.1005596.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e045" xlink:type="simple"/><mml:math display="block" id="M45"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle> <mml:mo>∼</mml:mo> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo> <mml:mi>m</mml:mi> <mml:mi>M</mml:mi></mml:munderover></mml:mstyle> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover></mml:mstyle> <mml:mi>N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup> <mml:mo>|</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:msup><mml:mi>n</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover></mml:mstyle> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:msup><mml:mi>n</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>n</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(26)</label></disp-formula>
The <italic>mn</italic>th observation, which through augmentation by the Pólya-Gamma variables, is no longer the spikes, but a continuous variable <inline-formula id="pcbi.1005596.e046"><alternatives><graphic id="pcbi.1005596.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> with observation noise <italic>r</italic><sub><italic>mn</italic></sub> = 1/<italic>ω</italic><sub><italic>mn</italic></sub>. We generate a sample of <bold>X</bold> given observation <bold>t</bold> and fixed Θ by employing the FFBS (Forward-filter backward-sample) algorithm [<xref ref-type="bibr" rid="pcbi.1005596.ref030">30</xref>]. Briefly, FFBS is a recursive algorithm with the same forward filtering step as the Kalman Filter, but on the backward step, instead of obtaining the mean from the smoothing density, we obtain realizable sample paths of the latent state from the smoothing density. The <italic>M</italic> trials are independent, so for the sake of simple notation, we drop the trial index <italic>m</italic> in what follows. Forward filtering is done by recursive application of a prediction and filtering step.
<disp-formula id="pcbi.1005596.e047"><alternatives><graphic id="pcbi.1005596.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>prediction</mml:mtext></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mtext>filter</mml:mtext></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">F</mml:mi> <mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">K</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:mi mathvariant="bold">H</mml:mi> <mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">F</mml:mi> <mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:msup><mml:mi mathvariant="bold">F</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">Q</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi mathvariant="bold">I</mml:mi> <mml:mo>−</mml:mo> <mml:msub><mml:mi mathvariant="bold">K</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mi mathvariant="bold">H</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(27)</label></disp-formula>
with
<disp-formula id="pcbi.1005596.e048"><alternatives><graphic id="pcbi.1005596.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e048" xlink:type="simple"/><mml:math display="block" id="M48"><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn> <mml:mo>…</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="2em"/><mml:mi mathvariant="bold">H</mml:mi> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mspace width="1em"/><mml:mn>0</mml:mn> <mml:mspace width="1em"/><mml:mo>…</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(28)</label></disp-formula>
and the Kalman gain, <inline-formula id="pcbi.1005596.e049"><alternatives><graphic id="pcbi.1005596.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mrow><mml:msub><mml:mi mathvariant="bold">K</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:msup><mml:mi mathvariant="bold">H</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi mathvariant="bold">H</mml:mi> <mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:msup><mml:mi mathvariant="bold">H</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. The prediction mean is straightforward given the structure of <bold>F</bold>, while the prediction covariance is
<disp-formula id="pcbi.1005596.e050"><alternatives><graphic id="pcbi.1005596.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e050" xlink:type="simple"/><mml:math display="block" id="M50"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:msub><mml:mi>F</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle> <mml:msub><mml:mi>F</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:msub><mml:mi>F</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>…</mml:mo> <mml:mi>p</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:msub><mml:mi>F</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>…</mml:mo> <mml:mi>p</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>…</mml:mo> <mml:mi>p</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>…</mml:mo> <mml:mi>p</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(29)</label></disp-formula>
The Kalman gain becomes
<disp-formula id="pcbi.1005596.e051"><alternatives><graphic id="pcbi.1005596.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e051" xlink:type="simple"/><mml:math display="block" id="M51"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold">K</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(30)</label></disp-formula>
while filter mean is <inline-formula id="pcbi.1005596.e052"><alternatives><graphic id="pcbi.1005596.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mstyle> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mstyle> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">K</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mstyle> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and covariance is
<disp-formula id="pcbi.1005596.e053"><alternatives><graphic id="pcbi.1005596.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e053" xlink:type="simple"/><mml:math display="block" id="M53"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>11</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(31)</label></disp-formula></p>
<p>FFBS requires starting values <inline-formula id="pcbi.1005596.e054"><alternatives><graphic id="pcbi.1005596.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>|</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005596.e055"><alternatives><graphic id="pcbi.1005596.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>|</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> for the recursion, for which we choose <bold>0</bold> and a reasonably broad, diagonal covariance, respectively. The inferred oscillation in the begin of the trials will be of poorer quality, but improves quickly after enough spikes are observed. After the last time point is reached, the latent state is sampled backwards in time. The smoothing distribution can be written
<disp-formula id="pcbi.1005596.e056"><alternatives><graphic id="pcbi.1005596.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e056" xlink:type="simple"/><mml:math display="block" id="M56"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn><mml:mo>…</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn><mml:mo>…</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mo>∝</mml:mo> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn><mml:mo>…</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover></mml:mstyle> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn><mml:mo>…</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(32)</label></disp-formula>
the first term a normal distribution about <inline-formula id="pcbi.1005596.e057"><alternatives><graphic id="pcbi.1005596.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi> <mml:mo>|</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> with covariance <inline-formula id="pcbi.1005596.e058"><alternatives><graphic id="pcbi.1005596.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi> <mml:mo>|</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, and the term under the product written in terms of known distributions
<disp-formula id="pcbi.1005596.e059"><alternatives><graphic id="pcbi.1005596.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e059" xlink:type="simple"/><mml:math display="block" id="M59"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn><mml:mo>…</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mo>∝</mml:mo> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn><mml:mo>…</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(33)</label></disp-formula>
which is a product of the transition density, which is a normal distribution with mean <bold>Fx</bold> <italic><sub>mn</sub></italic> and variance <bold>Q</bold>, and a filter density with mean <inline-formula id="pcbi.1005596.e060"><alternatives><graphic id="pcbi.1005596.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and variance <inline-formula id="pcbi.1005596.e061"><alternatives><graphic id="pcbi.1005596.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. Defining <inline-formula id="pcbi.1005596.e062"><alternatives><graphic id="pcbi.1005596.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>A</mml:mi></mml:mstyle> <mml:mo>≡</mml:mo> <mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mstyle> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mi mathvariant="bold">F</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi mathvariant="bold">F</mml:mi> <mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mstyle> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mi mathvariant="bold">F</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">Q</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, the sampling distribution of <bold>X</bold> <italic><sub>m,n</sub></italic> is a multivariate normal with mean and covariance given by
<disp-formula id="pcbi.1005596.e063"><alternatives><graphic id="pcbi.1005596.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e063" xlink:type="simple"/><mml:math display="block" id="M63"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi mathvariant="bold">I</mml:mi> <mml:mo>−</mml:mo> <mml:mi mathvariant="bold">A</mml:mi> <mml:mi mathvariant="bold">F</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">A</mml:mi> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi mathvariant="bold">I</mml:mi> <mml:mo>−</mml:mo> <mml:mi mathvariant="bold">A</mml:mi> <mml:mi mathvariant="bold">F</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(34)</label></disp-formula></p>
<p><bold>X</bold><sub><italic>m</italic>,<italic>n</italic>+1</sub> is the previously-sampled laten state <bold>Q</bold> can be expressed as an outer product of a column vector <bold>u</bold> = (σ, 0, 0, …) with itself, <bold>uu</bold><sup><italic>T</italic></sup>. Using the Sherman-Morrison formula [<xref ref-type="bibr" rid="pcbi.1005596.ref036">36</xref>] for the rank-1 update of an inverse matrix, the moments of the backward-sampling densities may be written as
<disp-formula id="pcbi.1005596.e064"><alternatives><graphic id="pcbi.1005596.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e064" xlink:type="simple"/><mml:math display="block" id="M64"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>|</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>F</mml:mi></mml:mstyle><mml:mrow><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>|</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>|</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msubsup><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>|</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>|</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>|</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>F</mml:mi></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(35)</label></disp-formula> <disp-formula id="pcbi.1005596.e065"><alternatives><graphic id="pcbi.1005596.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e065" xlink:type="simple"/><mml:math display="block" id="M65"><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>|</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>|</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>F</mml:mi></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mo>…</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">F</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(36)</label></disp-formula>
where <inline-formula id="pcbi.1005596.e066"><alternatives><graphic id="pcbi.1005596.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:mrow><mml:msub><mml:mi>F</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>≡</mml:mo> <mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>p</mml:mi></mml:msubsup> <mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:msup><mml:mi mathvariant="bold">F</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula>. The AR(<italic>p</italic>) model with the extended state-space is only partly dynamic [<xref ref-type="bibr" rid="pcbi.1005596.ref030">30</xref>], with rank (<bold>Q</bold>) = 1 &lt; <italic>p</italic>, and the computations necessary for the FFBS equations are much less than would be necessary for a full-rank model, as can be seen from the calculations of various moments presented in this section.</p>
</sec>
<sec id="sec014">
<title>Pólya-Gamma data augmentation</title>
<p>The predictive distribution for <italic>ω</italic><sub><italic>mn</italic></sub>, the term under the integral marginalizing out <italic>ω</italic><sub><italic>mn</italic></sub> in <xref ref-type="disp-formula" rid="pcbi.1005596.e010">Eq (8)</xref>, is the general <italic>PG</italic>(<italic>ω</italic><sub><italic>mn</italic></sub>|<italic>b</italic> = 1, <italic>z</italic> ≠ 0) distribution, obtained by an exponential tilting of the PG(<italic>ω</italic><sub><italic>mn</italic></sub>|<italic>b</italic> = 1, <italic>z</italic> = 0) distribution [<xref ref-type="bibr" rid="pcbi.1005596.ref025">25</xref>]:
<disp-formula id="pcbi.1005596.e067"><alternatives><graphic id="pcbi.1005596.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e067" xlink:type="simple"/><mml:math display="block" id="M67"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>∼</mml:mo> <mml:mi>P</mml:mi> <mml:mi>G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>κ</mml:mi> <mml:msub><mml:mi>ψ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>ψ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup> <mml:mi>P</mml:mi> <mml:mi>G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(37)</label></disp-formula>
with <inline-formula id="pcbi.1005596.e068"><alternatives><graphic id="pcbi.1005596.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. This is sampled using the rejection sampler described in Polson <italic>et al</italic> [<xref ref-type="bibr" rid="pcbi.1005596.ref025">25</xref>].</p>
</sec>
<sec id="sec015">
<title>Inferring additional latent structures</title>
<p>Oscillations temporally structure the spike train, but it is possible that these oscillations do not occur uniformly throughout all trials. The LOST model allows inferring additional structure present in the neural data, such as modulation of oscillatory strength within a trial, or trends in modulation strength across trials. In the simulation studies, we consider an example where the spike train is significantly modulated in only a fraction of the trials, and demonstrate that the LOST model is able to identify these trials. We also apply this to real data to show the LOST model can predict, using only spike train data, which trials are strongly modulated to a theta rhythm in the LFP, and which are not. For these applications, we assume the modulation strength takes on 2 distinct values. We fix the modulation strength of unmodulated trials to <italic>s</italic><sub>0</sub> = 0.1, and parameterize the modulation strength of the modulated trials, <italic>s</italic><sub>1</sub>. We introduce the latent indicator variable <bold>Z</bold>, which is an (<italic>M</italic> × 2) matrix where, for example, <bold>Z</bold><sub><italic>m</italic></sub> = (1, 0) if the <italic>m</italic>th trial is an unmodulated trial, and also the parameter mixture weights <bold><italic>π</italic></bold>, a 2 component column vector whose components sum to 1. The likelihood is then
<disp-formula id="pcbi.1005596.e069"><alternatives><graphic id="pcbi.1005596.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e069" xlink:type="simple"/><mml:math display="block" id="M69"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msub><mml:mo>∫</mml:mo> <mml:mi mathvariant="bold">X</mml:mi></mml:msub> <mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo> <mml:mi>m</mml:mi></mml:munder> <mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mi>p</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi mathvariant="bold">y</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold">Z</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mi>d</mml:mi> <mml:mi mathvariant="bold">X</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msub><mml:mo>∫</mml:mo> <mml:mi mathvariant="bold">X</mml:mi></mml:msub> <mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo> <mml:mi>m</mml:mi></mml:munder> <mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi mathvariant="bold">Z</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi mathvariant="bold">y</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mrow><mml:mo>|</mml:mo> <mml:mi mathvariant="bold">X</mml:mi></mml:mrow> <mml:mi>m</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mi>d</mml:mi> <mml:mi mathvariant="bold">X</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msub><mml:mo>∫</mml:mo> <mml:mtext mathvariant="bold">X</mml:mtext></mml:msub> <mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo> <mml:mi>m</mml:mi></mml:munder> <mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mtext mathvariant="bold">Z</mml:mtext> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:mi>B</mml:mi></mml:mstyle> <mml:mi>e</mml:mi> <mml:mi>r</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mtext mathvariant="bold">X</mml:mtext> <mml:mi>m</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mi>d</mml:mi> <mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msub><mml:mo>∫</mml:mo> <mml:mtext mathvariant="bold">X</mml:mtext></mml:msub> <mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo> <mml:mi>m</mml:mi></mml:munder> <mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mtext mathvariant="bold">Z</mml:mtext> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:mrow><mml:mrow> <mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>×</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo> <mml:mi>n</mml:mi></mml:munder></mml:mstyle> <mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:mstyle> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mi>d</mml:mi> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup> <mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mtext mathvariant="bold">X</mml:mtext> <mml:mi>m</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mi>d</mml:mi> <mml:mtext mathvariant="bold">X</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math></alternatives> <label>(38)</label></disp-formula>


Define <italic>M</italic><sub><italic>L</italic></sub> to be all <italic>m</italic> such that <bold>Z</bold><sub><italic>m</italic></sub> = (1, 0) and <italic>M</italic><sub><italic>H</italic></sub> to be all <italic>m</italic> such that <bold>Z</bold><sub><italic>m</italic></sub> = (0, 1). The likelihood contribution to the conditional posterior for <italic>s</italic><sub>1</sub> is Gaussian, <inline-formula id="pcbi.1005596.e070"><alternatives><graphic id="pcbi.1005596.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>∼</mml:mo> <mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:mfrac><mml:mi>B</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>A</mml:mi></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>A</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where
<disp-formula id="pcbi.1005596.e071"><alternatives><graphic id="pcbi.1005596.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e071" xlink:type="simple"/><mml:math display="block" id="M71"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi> <mml:mo>≡</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mi>L</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:munder> <mml:mfrac><mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac> <mml:mspace width="19.91684pt"/><mml:mi>B</mml:mi> <mml:mo>≡</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mi>L</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>(</mml:mo> <mml:mfrac><mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:mo>-</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(39)</label></disp-formula>
For the prior distribution for <italic>s</italic><sub>1</sub>, we use <inline-formula id="pcbi.1005596.e072"><alternatives><graphic id="pcbi.1005596.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msub> <mml:msubsup><mml:mi>σ</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1005596.e073"><alternatives><graphic id="pcbi.1005596.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mrow><mml:msub><mml:mi>μ</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and a large variance <inline-formula id="pcbi.1005596.e074"><alternatives><graphic id="pcbi.1005596.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:msubsup><mml:mi>σ</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>, because we have no prior belief about what <italic>s</italic><sub>1</sub> should be. The data augmentation of <bold>X</bold> analogous to <xref ref-type="disp-formula" rid="pcbi.1005596.e045">Eq (26)</xref> is carried out by replacing the <italic>mn</italic>th observation and noise by
<disp-formula id="pcbi.1005596.e075"><alternatives><graphic id="pcbi.1005596.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e075" xlink:type="simple"/><mml:math display="block" id="M75"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>→</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>κ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup></mml:mrow> <mml:mrow><mml:msub><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle> <mml:mi>j</mml:mi></mml:msub> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac> <mml:mspace width="3em"/><mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>→</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mstyle displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle> <mml:mi>j</mml:mi></mml:msub> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(40)</label></disp-formula>
The Pólya-Gamma data augmentation analogous to <xref ref-type="disp-formula" rid="pcbi.1005596.e067">Eq (37)</xref> is carried out by replacing the <italic>mn</italic>th <italic>ψ</italic><sub><italic>mn</italic></sub> by
<disp-formula id="pcbi.1005596.e076"><alternatives><graphic id="pcbi.1005596.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e076" xlink:type="simple"/><mml:math display="block" id="M76"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>→</mml:mo> <mml:munder><mml:mo mathvariant="bold">∏</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>j</mml:mi> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(41)</label></disp-formula>
The data augmentation for <italic>Z</italic><sub><italic>mj</italic></sub> is done by generating from a 2-category multinomial distribution. The probability of the <italic>m</italic>th trial being in the <italic>j</italic>th category is proportional
<disp-formula id="pcbi.1005596.e077"><alternatives><graphic id="pcbi.1005596.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e077" xlink:type="simple"/><mml:math display="block" id="M77"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>,</mml:mo> <mml:mspace width="1pt"/> <mml:msup><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>+</mml:mo></mml:msup> <mml:mo stretchy="false">)</mml:mo> <mml:mo>∝</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:munder><mml:mstyle displaystyle="true" mathvariant="bold"><mml:mo>∏</mml:mo></mml:mstyle> <mml:mi>n</mml:mi></mml:munder> <mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup></mml:mrow></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(42)</label></disp-formula>
The <bold><italic>π</italic></bold> are sampled from a Dirichlet distribution
<disp-formula id="pcbi.1005596.e078"><alternatives><graphic id="pcbi.1005596.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e078" xlink:type="simple"/><mml:math display="block" id="M78"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi> <mml:mo>∼</mml:mo> <mml:mi>D</mml:mi> <mml:mi>i</mml:mi> <mml:mi>r</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mi>H</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mn>2</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(43)</label></disp-formula>
We set the vector <bold><italic>α</italic><sub><italic>π</italic></sub></bold> = (1, 1).</p>
</sec>
</sec>
<sec id="sec016">
<title>Numerical computation</title>
<p>Gibbs samplding was implemented in the Python programming language using the Numpy, SciPy, Matplotlib, StatsModels, and Patsy toolboxes. Numerical routines were written in C/C++ and Cython. Software for the Gibbs sampler and a Python wrapper for the Pólya-Gamma routine based on the original code by Jesse Windle, available at <ext-link ext-link-type="uri" xlink:href="https://github.com/jwindle" xlink:type="simple">https://github.com/jwindle</ext-link>, is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/AraiKensuke/PP-AR" xlink:type="simple">https://github.com/AraiKensuke/PP-AR</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/AraiKensuke/pyPG" xlink:type="simple">https://github.com/AraiKensuke/pyPG</ext-link>, respectively.</p>
</sec>
</sec>
<sec id="sec017" sec-type="results">
<title>Results</title>
<p>To illustrate how the LOST model can infer latent oscillations under a variety of realistic conditions, we simulated biologically plausible oscillations, and spike trains modulated with these oscillations using either a simple inhomogeneous renewal process, or the leaky integrate-and-fire (LIF) neuron model. Further, we describe another point process method to infer the CIF, the GLM method, for comparison with the LOST model.</p>
<sec id="sec018">
<title>Simulated oscillations and spike trains</title>
<p>The stochastic oscillation for the <italic>m</italic>th trial <bold>w</bold><sub><italic>m</italic></sub> is generated by first generating a stochastic phase <bold>t</bold><sub><italic>m</italic></sub> and stochastic amplitude <bold>A</bold><sub><italic>m</italic></sub> as
<disp-formula id="pcbi.1005596.e079"><alternatives><graphic id="pcbi.1005596.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e079" xlink:type="simple"/><mml:math display="block" id="M79"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mfrac><mml:msub><mml:mi>ξ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>C</mml:mi> <mml:mi>ξ</mml:mi></mml:msub></mml:mfrac> <mml:mo>)</mml:mo> <mml:mspace width="28.45274pt"/><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mfrac><mml:msub><mml:mi>A</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>C</mml:mi> <mml:mi>A</mml:mi></mml:msub></mml:mfrac> <mml:mo form="prefix">sin</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>ν</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(44)</label></disp-formula>
where <bold><italic>ξ</italic></bold><sub><italic>m</italic></sub> and <bold>A</bold><sub><italic>m</italic></sub> are generated by AR(1) processes, and <italic>t</italic><sub><italic>m</italic>0</sub> ∈ [0, 1] a uniform random number. These are then used to generate the irregular oscillation <italic>C</italic><sub><italic>ξ</italic></sub> and <italic>C</italic><sub><italic>A</italic></sub> control the size of deviation from uniformity, while the timescale of the AR(1) processes controls the timescale of variation of amplitude and phase in the oscillation. AR(1)s with timescales on the order of the oscillation period <italic>T</italic> = 1/<italic>ν</italic> produce fluctuations that causes considerable variability of period and amplitude in <bold>w</bold>, which we quantify with the oscillator irregularity, the oscillatory coefficient of variation (OCV) of the instantaneous periods <italic>T</italic> of oscillation, defined as the ratio of the standard deviation to the mean of time intervals between phase 0 crossings of an oscillatory signal. <xref ref-type="fig" rid="pcbi.1005596.g001">Fig 1</xref> shows 2 example oscillations generated by this procedure, their OCVs and their power spectral densities. Irregular oscillations have a higher OCV and a less peaked spectral density.</p>
<fig id="pcbi.1005596.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005596.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Regular and irregular oscillations.</title>
<p>A) LOST infers (red) the oscillatory modulation (black), if any, underlying the spikes (vertical ticks) in a spike train, using only the spiking data. The oscillation amplitude stabilizes after the first few spikes are observed. B) We refer to spectrally narrow (wide) oscillations as regular (irregular), shown by the blue (pink) oscillation with OCV = 0.02 (0.22). The correlation between the current and past phase decays slowly (quickly) as a function of lag in regular (irregular) oscillations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005596.g001" xlink:type="simple"/>
</fig>
<p>To generate spikes, we employ an inhomogeneous renewal process or the LIF model, driven by a stochastic model of oscillation to modulate the firing of spikes. For the inhomogeneous renewal process, for each trial <italic>m</italic> and time <italic>n</italic>, if for a uniform random number <italic>r</italic><sub><italic>mn</italic></sub> ∈ [0, 1], <inline-formula id="pcbi.1005596.e080"><alternatives><graphic id="pcbi.1005596.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>G</mml:mi></mml:msubsup></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, we generated a spike, with <inline-formula id="pcbi.1005596.e081"><alternatives><graphic id="pcbi.1005596.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>G</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> the user-defined ground truth refractory history function. For the LIF model, spikes were generated using
<disp-formula id="pcbi.1005596.e082"><alternatives><graphic id="pcbi.1005596.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e082" xlink:type="simple"/><mml:math display="block" id="M82"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mi>τ</mml:mi></mml:mfrac> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>χ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(45)</label></disp-formula>
where the Gaussian random variable <inline-formula id="pcbi.1005596.e083"><alternatives><graphic id="pcbi.1005596.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:mrow><mml:msub><mml:mi>χ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>∼</mml:mo> <mml:mi>N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mtext>b</mml:mtext> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> represents irregular arrival times of afferent spikes, <italic>τ</italic> = 0.2 the membrane time constant, <italic>μ</italic><sub><italic>m</italic></sub> a baseline DC current and <inline-formula id="pcbi.1005596.e084"><alternatives><graphic id="pcbi.1005596.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mtext>b</mml:mtext> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>210</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> the amplitude of background fluctuation. Spikes are elicited when <italic>V</italic><sub><italic>mn</italic></sub> ≥ 1 passes the threshold value of 1, which then causes a reset to <italic>V</italic><sub><italic>m</italic>,<italic>n</italic>+1</sub> = 0. LIF have a refractory period that depends on the model parameters, and therefore the CIF naturally is dependent on the last spike time.</p>
<sec id="sec019">
<title>LIF neuron with stimulus-triggered change in firing rate</title>
<p>We demonstrate the basic operation of LOST and the inference of the TAE, spike history and oscillation. In the following, we monitor a small subset of the full joint posterior parameters: the modulus <italic>r</italic>, frequency 2<italic>π</italic>/λ of the lowest AR(2) component, and the latent state amplitude defined by its standard deviation. Samples of trial offsets or the TAE knots approach their stationary distribution values much more quickly than these parameters representative of the latent state, so monitoring this smaller subset suffices for determining when the posterior LOST draws from has reached its stationary distribution. <xref ref-type="fig" rid="pcbi.1005596.g002">Fig 2A</xref> shows a clear oscillation being inferred, as the parameters show little uncertainty. We took the mean of the last 2000 iterations to calculate the means in <xref ref-type="fig" rid="pcbi.1005596.g002">Fig 2B</xref>, and the oscillation in <xref ref-type="fig" rid="pcbi.1005596.g002">Fig 2C</xref>. In most of the following figures, we use the convention that cyan represents sampled values themselves, their distribution or 5-95% intervals of the sampled values. Red lines represent means of sampled values, and black lines represent ground truth values.</p>
<fig id="pcbi.1005596.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005596.g002</object-id>
<label>Fig 2</label>
<caption>
<title>LIF neuron with stimulus-triggered change in firing rate.</title>
<p>Phase inference for simulated LIF neuron driven by irregular oscillation with an average firing rate of 40Hz and a 15Hz modulating oscillation with OCV of 0.13. 60 trials of 1 second duration were used for LOST. A) Samples of the representative AR parameters. B) Top, samples of the TAE (cyan), the mean (red), and the empirical PSTH used to initialize TAE knot locations (green), and bottom, samples (cyan) of the spike history and mean (red). C) Example of inferred latent oscillation. The RL of the inferred oscillation is 0.65 ± 0.02, while the spike train has an <italic>R</italic> of 0.22 ± 0.01 with the ground truth oscillation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005596.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec020">
<title>Model identifiability and interpreting the results of LOST</title>
<p>Oscillations and post-spike refractory periods both add temporal structure to spike trains. Because they are presumably separate biological mechanisms and modify the spike train in distinct ways, we model them separately using the latent state and the spike history term. Without imposing constraints on these two terms, the latent state and spike history cannot, in principle be separated. LOST imposes constraints on the latent state and spike history according to our prior beliefs about their properties. The knot locations impose a strong prior on the shapes the spike history can take, so misplacing the knots may strongly affect the inferred latent state, presenting a significant difficulty in interpreting the results. We therefore investigate how mis-specifying the history affects LOST in <xref ref-type="fig" rid="pcbi.1005596.g003">Fig 3</xref>, which shows typical results from mis-specifying the spike history with two simulated datasets. The datasets are spike trains generated by a renewal process, <xref ref-type="fig" rid="pcbi.1005596.g003">Fig 3A</xref> with and <xref ref-type="fig" rid="pcbi.1005596.g003">Fig 3F</xref> without oscillatory modulation.</p>
<fig id="pcbi.1005596.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005596.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Interaction of spike history and latent state.</title>
<p>Two inhomogeneous, history dependent spike trains, with first spike train A) generated with stochastic oscillational modulation at 10Hz and OCV at 0.18, and spiking at 40Hz, and the second spike train F) without modulation, spiking at 60Hz. Gibbs samples from 4 (3) separate LOST for first (second) spike train in B-E (G-I). In B-E and G-I, we show the 3 representative sampled quantities, frequency and modulus of the slowest root and the amplitude of the inferred latent state on the left, and the ISI distribution and spike history term on the right. The ground truth, sampled mean and 5-95% intervals of the sampled spike history term plotted in black, red and cyan, respectively. The differences between the different LOST runs is in how spike history knots were chosen, or if a fixed spike history function was used. For the first spike train A, B uses the standard knot choices, C uses a constant history set to 0 and D, a fixed spike history set to a time-compressed ground-truth history. For the second spike train, G uses the standard knot choice, H the ground truth and I the standard knots moved farther out in time. For the first spike train, misspecification of the history may lead to a false inference of a flat latent state, a latent state with high uncertainty in its parameters or the correct latent state. For the second spike train, a misspecified history can lead to a latent state with significant amplitude but with uncertain parameters, making the inference inconclusive.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005596.g003" xlink:type="simple"/>
</fig>
<p>For the first spike train, the standard spline knot locations allows the successful inference of an oscillation and the history, <xref ref-type="fig" rid="pcbi.1005596.g003">Fig 3B</xref>, as the frequency, modulus and amplitude conditional posteriors are all very certain. The use of a fixed, flat history results in a flat latent state, <xref ref-type="fig" rid="pcbi.1005596.g003">Fig 3C</xref>, as the pronounced silences immediately following spikes are increasingly unlikely under spike train models with the latent state alone, which tends to increase the firing rate immediately following a spike. The latent states take large amplitudes near the spiking frequency of 40Hz when a temporally-compressed version of the ground truth spike history is used, <xref ref-type="fig" rid="pcbi.1005596.g003">Fig 3D</xref>. While the frequency has certainty, the modulus and amplitudes in contrast have large uncertainty, lowering our confidence that this latent state represents an oscillatory modulation. It is likely that a wide range of latent model parameters are nearly interchangeable, leading to a widening of the posterior in the direction of the AR parameters. Stretching the spike history, <xref ref-type="fig" rid="pcbi.1005596.g003">Fig 3E</xref>, results in a similar inferred latent state as <xref ref-type="fig" rid="pcbi.1005596.g003">Fig 3B</xref>, so a mis-specified history does not always lead to spurious results. We analyzed the second spike train 3 times with LOST, twice with an adjustable spike history term but with different history knot locations, and once with a fixed spike history term set to the ground truth, and <xref ref-type="fig" rid="pcbi.1005596.g003">Fig 3G–3I</xref> show samples from their respective posteriors. <xref ref-type="fig" rid="pcbi.1005596.g003">Fig 3G</xref> uses knots chosen by changing the default knot finder parameters, and the amplitudes do not go to 0 while the uncertainty in AR parameters remain high. <xref ref-type="fig" rid="pcbi.1005596.g003">Fig 3H</xref> uses the fixed ground truth history, and the amplitude approaches 0, as it does in <xref ref-type="fig" rid="pcbi.1005596.g003">Fig 3I</xref> where knots were placed farther out than in <xref ref-type="fig" rid="pcbi.1005596.g003">Fig 3G</xref>, and the amplitude also approaches 0. We conclude that if the post-spike inhibition is not well characterized, the inference of an oscillation will most likely fail. If the inhibition is well characterized but the rest of the history is not, we find either that an oscillation will still be inferred successfully, or that the posterior will be broad in some of the directions of the AR parameters, making it difficult to conclusively determine that the latent state represents an oscillation.</p>
<p>We now look at spike trains without oscillational modulation, but generated with various post-spike refractory profiles to check that certain refractory profiles are not confounded as oscillations. <xref ref-type="fig" rid="pcbi.1005596.g004">Fig 4A–4D and 4E–4H</xref> are spike trains with average firing rate around 34Hz and 60Hz, respectively. In all cases except <xref ref-type="fig" rid="pcbi.1005596.g004">Fig 4C and 4F</xref>, the latent state amplitude approaches 0 as expected. For <xref ref-type="fig" rid="pcbi.1005596.g004">Fig 4C and 4F</xref>, the amplitude does not approach 0 but fluctuates widely along with the other parameters. In these cases, the large uncertainty in the AR parameters suggests the results of LOST are ambiguous, and we refrain from drawing a conclusion. We find that a reasonable rule of thumb in assessing how much uncertainty is “too much” is that frequency 2<italic>π</italic>/λ has a standard deviation of around 10% of its mean or less, and that modulus <italic>r</italic> have a standard deviation of under 0.005. Typically, we also find slow trends over a few thousand Gibbs iterations in the sampled values is commonly observed, consistent with the view that the parameters are nearly interchangeable over a fairly broad region of parameter space and the Gibbs sampler then performs a near random walk over the parameters. A latent state with a large amplitude does not necessarily signify the successful inference of an oscillation, and the uncertainty in the model parameters of the oscillation must also be taken in account in deciding whether to reject the hypothesis that there is an oscillation modulating the spiking. The amplitude of the latent state can inform us of how large the modulation is surrounding the mean firing rate. A latent state amplitude of 0.15 equates to a peak-to-peak fluctuation of about 30% of the average firing rate (for low firing rates &lt; 100Hz), which is quite small a fluctuation considering only a few spikes may be observable for an oscillational cycle, so we use a latent state amplitude of 0.15 as a rule of thumb for when to consider the latent state as practically flat.</p>
<fig id="pcbi.1005596.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005596.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Spike trains without oscillatory modulation.</title>
<p>Simulated spike trains at 34Hz (A-D) and 60Hz (E-H), with 4 types of post-spike refractory profiles. Each panel shows Gibbs samples on left and on the right, an example spike train at the top, and the ISI histogram and spike history function as in <xref ref-type="fig" rid="pcbi.1005596.g001">Fig 1</xref>. The expected output of LOST is a nearly flat latent state, which is the case in A, B, D, E, G, H, accompanied by large variability in the other sampled parameters. In C and F, the amplitude of the latent state does not approach 0, but rather continues to fluctuate while taking larger values.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005596.g004" xlink:type="simple"/>
</fig>
<p>Through our examples, we found that the latent state can partially compensate an incorrectly specified spike history, as long as the short-term inhibition is reasonably well characterized by the spike history, or the post-spike inhibition is not too pronounced or long. In the absence of oscillational modulation in the data, this causes the latent state to take on significant amplitude, but the AR parameters themselves also have large uncertainty, making it difficult to conclude that the latent state represents an oscillation. However, in one limiting case, even with a mischaracterized spike history, LOST infers a clear oscillation. A nearly periodic spike train in <xref ref-type="fig" rid="pcbi.1005596.g005">Fig 5A</xref> is shown analyzed with LOST using the adjustable spike history term, <xref ref-type="fig" rid="pcbi.1005596.g005">Fig 5B</xref> and a fixed but modified ground truth spike history term, <xref ref-type="fig" rid="pcbi.1005596.g005">Fig 5C</xref>. When the misspecified history is used, the latent state takes large amplitudes with the posterior distribution of AR parameters having little uncertainty. The frequency of oscillation is nearly the same as the spiking frequency, 62Hz. In the limit of nearly periodic spikes, it may be difficult to conclude what particular combination of latent state and spike history underlies the highly regular spiking.</p>
<fig id="pcbi.1005596.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005596.g005</object-id>
<label>Fig 5</label>
<caption>
<title/>
<p>A) limiting case where models are not identifiable. The spike train in A is nearly periodic, but generated without an oscillatory modulation. When using the standard knots, the latent state amplitude approaches 0, B, but when we use a fixed history that is very different than the ground truth, C, the sampled parameters appear to be very certain, and an oscillation at 62Hz, nearly the spiking frequency, 64hz, is inferred. For cases where the spike train itself is nearly periodic, the spike train may be described equally well with various combinations of spike histories and an oscillation at the spiking frequency.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005596.g005" xlink:type="simple"/>
</fig>
<p>A flat latent state may signify a lack of oscillatory modulation or a spike history term that poorly captures the post-spike inhibition, or it may also signify that there is not enough data to infer an oscillation. Two spike trains with oscillatory modulation and different refractory profiles are shown in <xref ref-type="fig" rid="pcbi.1005596.g006">Fig 6A and 6E</xref>, with differing amount of trials used in LOST analysis, <xref ref-type="fig" rid="pcbi.1005596.g006">Fig 6B–6D and 6F–6H</xref>. When there is insufficient data to detect an oscillation, the latent state amplitude approaches 0, <xref ref-type="fig" rid="pcbi.1005596.g006">Fig 6B and 6F</xref>. In general, the uncertainty in the parameters of the oscillation will decrease as more trials and data are used, <xref ref-type="fig" rid="pcbi.1005596.g006">Fig 6C, 6D, 6G and 6H</xref>, as expected.</p>
<fig id="pcbi.1005596.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005596.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Effect of data size on posterior samples.</title>
<p>2 simulations of spike train with spiking around 60Hz, modulated with a 20Hz oscillation with OCV around 0.14 and 1 second long trials, but with different refractory period profiles, A and E. Layout of the figures is the same as in <xref ref-type="fig" rid="pcbi.1005596.g003">Fig 3</xref>, but with B-D and F-G showing different number of trials used, B) 8, C) 15 trials, and D) 40 for spike train in A and F) 5, G) 60 and H) 80 trials for spike train in E. For the smallest number of trials, the posterior is noticeably more variable, but the amplitude of the latent state approaches 0, meaning the latent state is almost decoupled from the spiking. We can see that the posterior narrows as more trials are used.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005596.g006" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec021">
<title>Model comparison</title>
<p>We compare the LOST model to another point process model whose CIF is a general linear model (GLM) of past spiking history [<xref ref-type="bibr" rid="pcbi.1005596.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref018">18</xref>]. Briefly, the CIF for trial <italic>m</italic> time <italic>n</italic> is written
<disp-formula id="pcbi.1005596.e085"><alternatives><graphic id="pcbi.1005596.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e085" xlink:type="simple"/><mml:math display="block" id="M85"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>S</mml:mi></mml:munderover> <mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>O</mml:mi></mml:munderover> <mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mspace width="14.22636pt"/><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(46)</label></disp-formula>
and this is easily fit to obtain the <inline-formula id="pcbi.1005596.e086"><alternatives><graphic id="pcbi.1005596.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">a</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005596.e087"><alternatives><graphic id="pcbi.1005596.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e087" xlink:type="simple"/><mml:math display="inline" id="M87"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">b</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> coefficients. The <inline-formula id="pcbi.1005596.e088"><alternatives><graphic id="pcbi.1005596.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:mrow><mml:mover accent="true"><mml:mtext>a</mml:mtext> <mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> models the short-term refractory self-history and <inline-formula id="pcbi.1005596.e089"><alternatives><graphic id="pcbi.1005596.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">b</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> encapsulates longer-term oscillatory self-history. This model does not take into account the dynamics of oscillation. Rather the spiking activity up to <italic>S</italic>(<italic>O</italic> + 1) steps in the past uniquely determine the firing probability at the present, in contrast to our model. We fit the model several times with different initial conditions and values of <italic>S</italic> and <italic>L</italic>, using the python function <monospace>statsmodels.api.GLM</monospace>, and compare their goodness of fit via the time-rescaling theorem [<xref ref-type="bibr" rid="pcbi.1005596.ref037">37</xref>], and find the best combination of <italic>S</italic> and <italic>O</italic>. We then calculate the CIF from that model. Interpreting the fluctuating CIF as an oscillation, we extract the instantaneous phases, and compare to the phases inferred by the LOST model. The GLM model does not separate out the contribution of the short-term refractory self-history and the longer-term oscillatory self-history to the CIF, so we attempted to extract the oscillatory contribution by low-pass filtering the obtained CIF. We refer to this method of inference as GLM hereafter.</p>
<p>We compare the quality of inference of different models by comparing the resultant length of their inference with the ground truth. The resultant length (RL) <italic>L</italic> is calculated as <inline-formula id="pcbi.1005596.e090"><alternatives><graphic id="pcbi.1005596.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:mrow><mml:mi>L</mml:mi> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:msub><mml:mo>Φ</mml:mo> <mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi> <mml:mi>N</mml:mi></mml:msubsup> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, where the <bold><italic>ψ</italic></bold> (<bold><italic>ϕ</italic></bold>) are the ground truth (inferred) phases, and is the circular equivalent to the mean squared error (MSE) of the ground truth and inferred phase. We also use another simple measure of characterizing the strength of oscillatory modulation, the spike phase (SP) histogram and its circular statistic <italic>R</italic>, calculated as <inline-formula id="pcbi.1005596.e091"><alternatives><graphic id="pcbi.1005596.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e091" xlink:type="simple"/><mml:math display="inline" id="M91"><mml:mrow><mml:mi>R</mml:mi> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>Φ</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msub><mml:mi>ϕ</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>t</italic><sub><italic>n</italic></sub> is the time of the <italic>n</italic>th spike. Here <italic>R</italic> characterizes non-uniformity in the distribution of <inline-formula id="pcbi.1005596.e092"><alternatives><graphic id="pcbi.1005596.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e092" xlink:type="simple"/><mml:math display="inline" id="M92"><mml:msub><mml:mi>ϕ</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula>. While they are calculated in a similar fashion, the RL directly compares the inferred phase with the ground truth or LFP, while the SP <italic>R</italic> measures the uniformity of the probability of spiking with respect to ground truth or LFP phase. We caution that a result <italic>L</italic> &lt; <italic>R</italic> does not mean that the LOST model performed inference poorly. SP histogram detects modulation, but knowledge that spiking occurs at preferred phases does not also mean we know how to assign instantaneous phases given the spikes in a spike train. The error on <italic>R</italic>s and <italic>L</italic>s is calculated by bootstrap sampling with replacement of trials.</p>
</sec>
<sec id="sec022">
<title>Comparison to other models of oscillation</title>
<p>Comparison of the LOST model with the GLM model illustrates how point process noise and oscillatory irregularity pose challenges to inferring an oscillation from a spike train, and how explicitly modeling the dynamics of the oscillation using a latent state with a point process observation model, improves inference when posed with these challenges. <xref ref-type="fig" rid="pcbi.1005596.g007">Fig 7A and 7B</xref> show the dependence of RL on how much spike history is used in the GLM (bottom right), and the history weights <bold>b</bold> when 180, 480 or 720ms of history is used. The oscillation OCVs were 0.02 and 0.2 for <xref ref-type="fig" rid="pcbi.1005596.g007">Fig 7A and 7B</xref>, respectively. Temporal phase relationship is preserved for large time lags, as can be seen in the clear periodicity of the history weights <bold>b</bold> in <xref ref-type="fig" rid="pcbi.1005596.g007">Fig 7A</xref>, and the GLM model performs as well as the LOST model when long history dependence is used. Shorter history degrades the performance of the GLM model, because we are not averaging out the spiking noise as much when shorter history is used. However, <xref ref-type="fig" rid="pcbi.1005596.g007">Fig 7B</xref> shows that when the oscillation is irregular, the phase information quickly dissipates, as seen by the lack of periodicity in <bold>b</bold> at longer lags. Consequently, the spiking noise cannot be averaged out using long history, but rather spikes with large lag contribute only noise as the oscillational irregularity washes out the phase relationship for longer lags. The LOST model suffers less because it models the statistics of the irregularity in oscillation, the observable of the latent oscillation has a point-process observation model that takes into account spiking noise, and also because the inferred oscillation is conditioned on all the spikes in the trial, <xref ref-type="fig" rid="pcbi.1005596.g007">Fig 7C</xref>.</p>
<fig id="pcbi.1005596.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005596.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Comparison with other models of spiking and the AR order.</title>
<p>Spiking noise and oscillation irregularity affect the quality of phase inference. A, B) Clockwise from top, spike train (ticks) produced by the regular oscillation plotted above, the resultant lengths when oscillation inferred using 3 different history lengths using GLM along with the RL from LOST inference of same data, and the history weights <bold>b</bold> (dashed red) and their confidence intervals (purple) for GLM using history length 720ms. Modulating oscillations have OCV = 0.02 and 0.2 in A) and B), respectively. C) Sample CIF inference of data shown in A) using LOST (top trace), and GLM (bottom trace), with black line the duplicated ground truth CIFs. For GLM, the dashed (solid) line is the inference obtained from using 720ms (180ms) of spiking history. D) Comparison of how different AR orders for the LOST model affect inference performance for irregular oscillations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005596.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec023">
<title>AR order</title>
<p>Huerta [<xref ref-type="bibr" rid="pcbi.1005596.ref024">24</xref>] describes a reversible jump MCMC procedure to choose an appropriate AR model strucure. We did not implement this due to the complexity of implementation and the relatively high computational cost of the current algorithm. Nonetheless, we investigate the effect of varying the AR order for phase inference with the LOST model. In <xref ref-type="fig" rid="pcbi.1005596.g007">Fig 7D</xref>, we used 4 sets of data with increasing firing rates, and compared the RLs of inference with different AR orders, and the accompanying RL from inference using GLM. The data sets themselves are generated with an oscillation of 10Hz using the LIF model, with OCVs of around 0.2, and have mean firing rates of 11Hz, 15Hz, 21Hz and 33Hz. 140, 130, 100, and 90 trials of 1.2 seconds duration were used in the fitting of the data. The model order comparison in <xref ref-type="fig" rid="pcbi.1005596.g007">Fig 7D</xref> shows that including more components usually resulted in a better inference of instantaneous phase, but qualitatively, even few components can pick out the oscillatory structure present in the spike train. This suggests that a model with the correct order, while important for optimal inference, can still infer valuable information if a sub-optimal order is chosen. For the rest of the paper, we keep the model structure to 4<italic>C</italic> + 1<italic>R</italic>, unless otherwise stated, as it seems to provide a good compromise between good inference and reasonable computation times.</p>
</sec>
<sec id="sec024">
<title>Presence of additional, slower fluctuation</title>
<p>Periods of prolonged silence, followed by prolonged periods of elevated firing rates are often visibly apparent in spike trains [<xref ref-type="bibr" rid="pcbi.1005596.ref038">38</xref>]. The timescales of these readily visible features are much slower than those characterizing faster neuronal oscillations thought to be relevant to cortical processing. In this example, we seek to demonstrate that the LOST model will give us useful inference of the faster oscillation in the presence of these slow modulations. We generated data with the offset, instead of being constant throughout a trial, to be a randomly generated square wave with a given duty cycle, and state duration generated from an exponential distribution with a minimum duration of 100 ms. Because the square wave is different in each trial, the overall PSTHs are flat. The spike train in <xref ref-type="fig" rid="pcbi.1005596.g008">Fig 8</xref> have mean firing rates of 22Hz, a 20Hz oscillatory modulation with OCV = 0.27, with 200 trials used, and a duty cycle of 50% for the slow square wave. The resultant length was <italic>L</italic> = 0.25 ± 0.01. To analyze the data, we begin by inferring the slow time modulation using an AR(1) model as our latent model. We choose an AR(1) model, as we don’t expect very much structure in the slow latent state, and also because the time scale of the square waves relative to the duration of each trial ensures that any potential slow oscillatory structure would only be partially sampled, that considering additional structure in the AR is unnecessary. Although an AR(1) model is not the correct model describing these square waves, we are able to roughly infer the shape of the square waves, <xref ref-type="fig" rid="pcbi.1005596.g008">Fig 8</xref> top.</p>
<fig id="pcbi.1005596.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005596.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Spike train modulated with fast oscillation and a slower square-wave fluctuation.</title>
<p>For a sample trial, top shows inferred, square-wave modulation of spiking (black) and the inferred latent state (red). Bottom shows inference of faster rhythm by taking the slow signal shown above to be a known signal, and re-running LOST.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005596.g008" xlink:type="simple"/>
</fig>
<p>We account for the slower fluctuation by modifying the CIF, <xref ref-type="disp-formula" rid="pcbi.1005596.e003">Eq 3a</xref> to include the inferred slow fluctuation as a known signal <italic>I</italic><sub><italic>mn</italic></sub>,
<disp-formula id="pcbi.1005596.e093"><alternatives><graphic id="pcbi.1005596.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e093" xlink:type="simple"/><mml:math display="block" id="M93"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>|</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(47)</label></disp-formula>
After incorporating this known signal, we are able to infer the phases of the faster oscillation. Without including this step, the oscillatory AR(p) model would infer the slower fluctuation as in <xref ref-type="fig" rid="pcbi.1005596.g008">Fig 8</xref> top, but inclusion of this known signal allows the faster oscillation to be inferred, <xref ref-type="fig" rid="pcbi.1005596.g008">Fig 8</xref> bottom.</p>
<p>Neural data often contains more structure than the data analyst is aware of or suspects, and if on initial analysis with the standard LOST the analyst finds a much slower timescale latent state than expected, chances are the user has discovered a real but unknown feature of the data, and that the user may want to infer this slow latent state using an AR(1) as described in this section, and include this signal as a known signal in a second run of LOST to discover the higher-frequency modulation expected.</p>
</sec>
<sec id="sec025">
<title>Mixture of modulated and non-modulated trials</title>
<p>Here we show an example where additional, discrete latent structures beside the oscillation, are present in the data. We motivate this extension to LOST as recent work has shown that brain states during sensory processing and behavior undergo discrete state transitions [<xref ref-type="bibr" rid="pcbi.1005596.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref040">40</xref>], and because the authors have suspected (unpublished) that the motor cortical neurons analyzed in the Data Analysis section, also exhibit discrete transitions from trial to trial. <xref ref-type="fig" rid="pcbi.1005596.g009">Fig 9</xref> shows results from 3 simulated spike trains, where 0% (<xref ref-type="fig" rid="pcbi.1005596.g009">Fig 9A</xref>), 25% (<xref ref-type="fig" rid="pcbi.1005596.g009">Fig 9B</xref>) or 40% (<xref ref-type="fig" rid="pcbi.1005596.g009">Fig 9C</xref>) of the of the trials are weakly modulated, and the rest strongly modulated. The mean firing rate for all 3 of the spiketrains are 36Hz, modulated with a 20Hz modulation with OCVs of 0.32. 80 trials were analyzed, each of duration 1.2 seconds.</p>
<fig id="pcbi.1005596.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005596.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Mixture of modulated and non-modulated trials.</title>
<p>A), B), C) 0%, 25% and 40% of the trials are weakly modulated. Left shows posterior distribution of <italic>π</italic><sub>1</sub> and the black line is the ground truth value, red line is the mode of the marginal posterior. Right shows inferred modulation state, weak or strong, for each of the 80 trials. Black dots are ground truth, red dots are inferred state. Below them are indicators (+−) of whether inferred matches ground truth.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005596.g009" xlink:type="simple"/>
</fig>
<p>The LOST model successfully infers the existence of 2 subsets of trials whose modulation strengths are very different in <xref ref-type="fig" rid="pcbi.1005596.g009">Fig 9B and 9C</xref>, and correctly infers that all trials are modulated by similar strengths in <xref ref-type="fig" rid="pcbi.1005596.g009">Fig 9A</xref>. To infer the modulation state, weak or strong, we compiled the posterior mean of the indicators 〈<italic>Z</italic><sub><italic>m</italic>1</sub>〉 for all trials <italic>m</italic>. Trials that are strongly modulated tend to have small values of 〈<italic>Z</italic><sub><italic>m</italic>1</sub>〉. The mixture coefficient <bold><italic>π</italic></bold> provides a straightforward threshold for 〈<italic>Z</italic><sub><italic>m</italic>1</sub>〉 for categorization into weak or strong trials. We choose the threshold to be <inline-formula id="pcbi.1005596.e094"><alternatives><graphic id="pcbi.1005596.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e094" xlink:type="simple"/><mml:math display="inline" id="M94"><mml:mrow><mml:mi>M</mml:mi> <mml:msubsup><mml:mi>π</mml:mi> <mml:mn>1</mml:mn> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1005596.e095"><alternatives><graphic id="pcbi.1005596.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005596.e095" xlink:type="simple"/><mml:math display="inline" id="M95"><mml:msubsup><mml:mi>π</mml:mi> <mml:mn>1</mml:mn> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> is the posterior mode of <italic>π</italic><sub>1</sub>. The trials whose 〈<italic>Z</italic><sub><italic>m</italic>1</sub>〉 are larger than the threshold are deemed weakly modulated trials. As can be seen in <xref ref-type="fig" rid="pcbi.1005596.g009">Fig 9B and 9C</xref>, the LOST model categorizes a significant fraction, &gt; 80%, of trials correctly, and also infers the mixture weights close to the true values. We note that in inferring the value of <italic>π</italic><sub>1</sub>, we did not take the mean as we do for most other parameters due to its bounded nature and the bias this confers when <italic>π</italic><sub>1</sub> is at or near 0, but rather take the mode of the posterior.</p>
</sec>
</sec>
<sec id="sec026">
<title>Data analysis</title>
<p>We analyze neurons from M1 of rat performing a self-paced lever push-hold-pull task [<xref ref-type="bibr" rid="pcbi.1005596.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref041">41</xref>] that have been found to be significantly modulated to the theta rhythm in the LFP. These 2 neurons were recorded on separate electrodes, with “neuron 1” in Figs <xref ref-type="fig" rid="pcbi.1005596.g010">10</xref> and <xref ref-type="fig" rid="pcbi.1005596.g011">11</xref> recorded and spike sorted from a tetrode on a siliconprobe, and “neuron 2” recorded using juxtacellular (cell-attached) recording, where the spike trains did not need to be sorted. Both neurons were located in layer 1/2, and “neuron 2” identified morphologically as an interneuron, while “neuron 1” is likely to be an interneuron based on spike shape. We identified trials by selecting lever hold periods lasting more than 1 second followed by a large-amplitude pull, and analyzed the 1.2 second period encompassing the hold-pull period.</p>
<fig id="pcbi.1005596.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005596.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Two simultaneously-recorded motor cortical neurons: Slow fluctuations in firing rate for neuron 1 and 2.</title>
<p>A) rasters from sample trials for the two neurons. There are noticeable holes in the rasters of the neuron 1, and neuron 2 also appears to have a similar slower fluctuation that is less noticeable. B, C) the PSTHs for the two neurons (top) show they both increase their activity around the time of PULL onset (0ms), and power spectral density of latent state show slow fluctuations on the order of 1-2 Hz. Correlation coefficient at 0 lag for the slow fluctuations inferred from neuron 1 and 2 are weakly correlated, with a correlation coefficient 0.15, <italic>p</italic> &lt; 1 × 10<sup>−3</sup>, boot strap test.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005596.g010" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005596.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005596.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Two simultaneously-recorded motor cortical neurons: Simultaneous inference of theta oscillations using inferred slow fluctuation from <xref ref-type="fig" rid="pcbi.1005596.g010">Fig 10</xref> as a known signal.</title>
<p>A) SP histograms for neurons 1 and 2 with circular statistics R = 0.13 ± 0.01 and 0.08 ± 0.01. B) power spectral densities of inferred oscillation for the 2 neurons showing power in the theta range. C) The cross-correlation function of the inferred latent oscillations of the two neurons, grey traces from when trials shuffled. D) The spike-spike cross correlation function shows very little oscillatory structure.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005596.g011" xlink:type="simple"/>
</fig>
<sec id="sec027">
<title>Slow fluctuations</title>
<p>
<xref ref-type="fig" rid="pcbi.1005596.g010">Fig 10A</xref> shows that the spike trains appear to have long periods of low firing rate, interspersed with periods of higher firing within a trial, creating noticeable holes in the spike train. Applying the LOST model using an AR(1) latent state first picks up a latent state that follows these slow fluctuations to the firing rate, but with the faster oscillatory modulation absent. <xref ref-type="fig" rid="pcbi.1005596.g010">Fig 10B and 10C</xref> bottom show the power spectrum for the fluctuation <bold>I</bold> we infer for each neuron, and find that both are slow, in the 1-2Hz range. Interestingly, this slow fluctuation is weakly correlated between the neurons, <italic>p</italic> &lt; 6 × 10<sup>−3</sup>, bootstrap test.</p>
</sec>
<sec id="sec028">
<title>Shared theta oscillations</title>
<p>Next, we account for the faster fluctuation by including the slow fluctuation <bold>I</bold> into the CIF as described in <xref ref-type="disp-formula" rid="pcbi.1005596.e093">Eq 47</xref>. After incorporating this known signal, we are able to infer the phases, <xref ref-type="fig" rid="pcbi.1005596.g011">Fig 11</xref> for both neurons. The power spectral density of the inferred latent oscillation are similar, with a peak around 7-8Hz, <xref ref-type="fig" rid="pcbi.1005596.g011">Fig 11A and 11B</xref> bottom. Igarashi <italic>et al</italic> [<xref ref-type="bibr" rid="pcbi.1005596.ref013">13</xref>] found significant modulation to the LFP theta of these neurons using SP histograms, but did not find direct evidence of simultaneous modulation of the neurons from the spike-spike cross-correlation function, <xref ref-type="fig" rid="pcbi.1005596.g011">Fig 11D</xref>. In contrast, the oscillatory cross-correlation function of the independently inferred oscillations shown in <xref ref-type="fig" rid="pcbi.1005596.g011">Fig 11C</xref>, clearly shows evidence of simultaneous modulation of the neurons to a shared oscillation.</p>
</sec>
<sec id="sec029">
<title>Weakly and strongly modulated trials to LFP theta in a single neuron</title>
<p>In the previous section, we treated all trials of neuron 1 as equally modulated and inferred a theta modulation in its spike train. Using a simple model to fit often results in finding an oscillation, as we did for neuron 1, but it may be that there is further structure that can be discovered by using a more complicated parametric model. Here, we analyze neuron 1 using the mixture model, and find a significant difference in the strength of oscillatory modulation between trials. Following the procedure described for the mixture model, we find that about 85% of the trials (H, pink) have a much stronger modulation, <xref ref-type="fig" rid="pcbi.1005596.g012">Fig 12A</xref> right, than the remaining trials (L, blue), <xref ref-type="fig" rid="pcbi.1005596.g012">Fig 12C</xref> top.</p>
<fig id="pcbi.1005596.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005596.g012</object-id>
<label>Fig 12</label>
<caption>
<title>Motor cortical neuron (neuron 1, Figs <xref ref-type="fig" rid="pcbi.1005596.g010">10</xref> and <xref ref-type="fig" rid="pcbi.1005596.g011">11</xref>) shows changing relationship to LFP theta oscillation in different trials.</title>
<p>A) The posterior distributions of the mixture weight of the weakly modulated L trials, and relative modulation strength of the strongly modulated H trials. B) PSTH<sub>L</sub> (blue) and PSTH<sub>H</sub> (pink) overlap one another, showing no difference in average firing rate. C) LFP theta amplitudes calculated for all L and H trials on a per trial basis. Difference between cumulative distributions of per trial LFP theta amplitude not significant, <italic>p</italic> &lt; 0.78, 2 sample KS-test. D) Top, the 33 (187) trials classified as weakly (strongly) modulated trials, blue (pink) dots, top. Bottom, the SP histogram calculated from L (H) trials, left (right). Inference of modulation strength using the spike train alone corresponds to the modulation strength to LFP theta. Circular statistics <italic>R</italic><sub>L</sub> = 0.06 ± 0.01 and <italic>R</italic><sub>H</sub> = 0.16 ± 0.01 are significantly different, bootstrap test <italic>p</italic> &lt; 7 × 10<sup>−4</sup>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005596.g012" xlink:type="simple"/>
</fig>
<p>We emphasize this classification was made using only the spike trains. The PSTHs constructed separately from L trials and H trials show no significant difference <xref ref-type="fig" rid="pcbi.1005596.g012">Fig 12B</xref> left, so the L and H trials being detected do not reflect a difference in temporal trial-locked firing rate, or in the baseline firing rate. Since the classification into L and H reflects a dichotomous change in the structure of oscillatory modulation, we expect to find a similar change in the relationship between the spike train and the LFP theta. It is possible that the L and H trials are indicative of absence or presence of the global LFP theta, that L trials show weak modulation because there is no modulating drive in those trials. The autocorrelation function of the high-pass filtered (above 1Hz) LFP constructed separately for the L trials and H trials, showed similar oscillatory structure, <xref ref-type="fig" rid="pcbi.1005596.g012">Fig 12B</xref> center. Further, the amplitude of the theta-band LFP in L trials and H trials also show no significant difference, <xref ref-type="fig" rid="pcbi.1005596.g012">Fig 12C</xref>, so global theta seems to be a reliable and perpetual presence. However, in <xref ref-type="fig" rid="pcbi.1005596.g012">Fig 12D</xref>, when we construct 2 separate LFP theta SP histograms, SP<sub>L</sub> and SP<sub>H</sub>, we find that SP<sub>L</sub> is significantly more uniform than SP<sub>H</sub>, with R<sub>L</sub> = 0.06 ± 0.01 and R<sub>H</sub> = 0.16 ± 0.01, bootstrap test <italic>p</italic> &lt; 7 × 10<sup>−4</sup>. Thus it appears that this neuron intermittently participates in the perpetual theta rhythmicity, resulting in distinct subsets of trials, some being weakly modulated and others being strongly modulated.</p>
</sec>
</sec>
</sec>
<sec id="sec030" sec-type="conclusions">
<title>Discussion</title>
<p>We have defined the LOST model, together with accompanying posterior simulation technology, in order to detect the presence of oscillatory firing-rate modulation in a spike train, and infer its phase of oscillation in the presence of a variety of non-stationarities in firing rate that are present in experimental data. Previous methods have assessed the oscillatory content in spike trains by comparing the spiking to a known oscillatory signal like a band-passed LFP [<xref ref-type="bibr" rid="pcbi.1005596.ref042">42</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref043">43</xref>], by detecting oscillation directly from the spike train [<xref ref-type="bibr" rid="pcbi.1005596.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref044">44</xref>–<xref ref-type="bibr" rid="pcbi.1005596.ref046">46</xref>], or by point process regression using the oscillatory signal as a covariate [<xref ref-type="bibr" rid="pcbi.1005596.ref047">47</xref>]. The LOST model not only detects oscillatory modulation from the spike train itself, but does so in the presence of both spiking noise and oscillatory irregularity, and also allows extensions to inferring additional latent structure, such as non-stationarities in the modulational strength across trials. In addition, LOST is able to separately account for modulational signals of different frequency band, which has proven to be vital in the analysis of real spike trains. Structural priors on the latent state dynamics together with explicit consideration of spiking noise and oscillatory irregularity allows LOST to uncover oscillatory structure even when the firing rate is low, the modulation weak or when the oscillation is irregular, compared to methods that directly regressed the spiking probability on the raw spiking history itself without an intermediary latent state [<xref ref-type="bibr" rid="pcbi.1005596.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref019">19</xref>]. LOST uses the intermediary latent state to addresses the irregularity characteristic of neural oscillations. Another approach to modeling the spectral features of time series using Gaussian processes has recently been developed by Wilson <italic>et al</italic> [<xref ref-type="bibr" rid="pcbi.1005596.ref048">48</xref>], where different classes of covariance kernels, the SE and SM, respectively, model non-oscillatory and oscillatory structures, analogous to the real and imaginary roots of the characteristic polynomials. It would be interesting to compare the two approaches in future work.</p>
<p>The increased sensitivity and flexibility in specifying latent structures, should allow LOST to be used in investigating the role of oscillations in cognitive functions in the cortex. Investigators are increasingly interested in characterizing the change in neural responses to time-varying stimulus or behavior [<xref ref-type="bibr" rid="pcbi.1005596.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref050">50</xref>]. Theta and gamma oscillations in hippocampus change their coupling structure and prevalence during learning and memory acquisition [<xref ref-type="bibr" rid="pcbi.1005596.ref051">51</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref052">52</xref>]. The inclusion of trial-specific structure independently of the LFP in the LOST model may also allow detection of increased recruitment of a given neuron into cell assemblies during periods when oscillations in the LFP are changing. Further, the variability of the timing and presence of oscillations in the LFP seen in many areas of the cortex and hippocampus [<xref ref-type="bibr" rid="pcbi.1005596.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005596.ref053">53</xref>], suggests oscillatory modulation in single neurons may likewise exhibit finer structure on a per-trial basis. Use of the LOST model in the analysis of such systems may reveal richer dynamics of recruitment into cell assemblies, and a better understanding of the role of single neurons in cognition.</p>
</sec>
</body>
<back>
<ack>
<p>We thank Yoshikazu Isomura at Tamagawa University Brain Science Institute for the rat data collected at Riken Brain Science Institute. We also thank James Scott at the University of Texas, Austin and Jesse Windle at Duke University, for helpful advice concerning the implementation of the Pólya-Gamma data augmentation method and programming assistance. And finally, we thank Uri Eden at Boston University, Pengcheng Zhou and Spencer Koerner at the Carnegie Mellon University for constructive discussion.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005596.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Murthy</surname> <given-names>VN</given-names></name>, <name name-style="western"><surname>Fetz</surname> <given-names>EE</given-names></name>. <article-title>Synchronization of neurons during local field potential oscillations in sensorimotor cortex of awake monkeys</article-title>. <source>Journal of neurophysiology</source>. <year>1996</year> <month>dec</month>;<volume>76</volume>(<issue>6</issue>):<fpage>3968</fpage>–<lpage>82</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/8985893" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/8985893</ext-link>. <object-id pub-id-type="pmid">8985893</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Donoghue</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Sanes</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Hatsopoulos</surname> <given-names>NG</given-names></name>, <name name-style="western"><surname>Gaál</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Omlor</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Patino</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Neural Discharge and Local Field Potential Oscillations in Primate Motor Cortex During Voluntary Movements Neural Discharge and Local Field Potential Oscillations in Primate Motor Cortex During Voluntary Movements</article-title>. <source>Journal of neurophysiology</source>. <year>1998</year>;<volume>79</volume>:<fpage>159</fpage>–<lpage>173</lpage>. <object-id pub-id-type="pmid">9425187</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Engel</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Fries</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name>. <article-title>Dynamic predictions: oscillations and synchrony in top-down processing</article-title>. <source>Nature reviews Neuroscience</source>. <year>2001</year>;<volume>2</volume>(<issue>10</issue>):<fpage>704</fpage>–<lpage>716</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/35094565" xlink:type="simple">10.1038/35094565</ext-link></comment> <object-id pub-id-type="pmid">11584308</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Siapas</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Lubenov</surname> <given-names>EV</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>Ma</given-names></name>. <article-title>Prefrontal phase locking to hippocampal theta oscillations</article-title>. <source>Neuron</source>. <year>2005</year> <month>apr</month>;<volume>46</volume>(<issue>1</issue>):<fpage>141</fpage>–<lpage>51</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/15820700" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/15820700</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2005.02.028" xlink:type="simple">10.1016/j.neuron.2005.02.028</ext-link></comment> <object-id pub-id-type="pmid">15820700</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Denker</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Roux</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Timme</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Riehle</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Grün</surname> <given-names>S</given-names></name>. <article-title>Phase synchronization between LFP and spiking activity in motor cortex during movement preparation</article-title>. <source>Neurocomputing</source>. <year>2007</year>;<volume>70</volume>(<issue>10-12</issue>):<fpage>2096</fpage>–<lpage>2101</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neucom.2006.10.088" xlink:type="simple">10.1016/j.neucom.2006.10.088</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gregoriou</surname> <given-names>GG</given-names></name>, <name name-style="western"><surname>Gotts</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Desimone</surname> <given-names>R</given-names></name>. <article-title>High-frequency, long-range coupling between prefrontal and visual cortex during attention</article-title>. <source>Science</source>. <year>2009</year>;<volume>324</volume>(<issue>5931</issue>):<fpage>1207</fpage>–<lpage>1210</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1171402" xlink:type="simple">10.1126/science.1171402</ext-link></comment> <object-id pub-id-type="pmid">19478185</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fries</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Womelsdorf</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Oostenveld</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Desimone</surname> <given-names>R</given-names></name>. <article-title>The effects of visual stimulation and selective visual attention on rhythmic neuronal synchronization in macaque area V4</article-title>. <source>The Journal of neuroscience: the official journal of the Society for Neuroscience</source>. <year>2008</year>;<volume>28</volume>(<issue>18</issue>):<fpage>4823</fpage>–<lpage>4835</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4499-07.2008" xlink:type="simple">10.1523/JNEUROSCI.4499-07.2008</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Siegel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Warden</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>EK</given-names></name>. <article-title>Phase-dependent neuronal coding of objects in short-term memory</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2009</year> <month>dec</month>;<volume>106</volume>(<issue>50</issue>):<fpage>21341</fpage>–<lpage>6</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2779828{&amp;}tool=pmcentrez{&amp;}rendertype=abstract" xlink:type="simple">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2779828{&amp;}tool=pmcentrez{&amp;}rendertype=abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0908193106" xlink:type="simple">10.1073/pnas.0908193106</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Benchenane</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Peyrache</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Khamassi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tierney</surname> <given-names>PL</given-names></name>, <name name-style="western"><surname>Gioanni</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Battaglia</surname> <given-names>FP</given-names></name>, <etal>et al</etal>. <article-title>Coherent theta oscillations and reorganization of spike timing in the hippocampal- prefrontal network upon learning</article-title>. <source>Neuron</source>. <year>2010</year> <month>jun</month>;<volume>66</volume>(<issue>6</issue>):<fpage>921</fpage>–<lpage>36</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/20620877" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/20620877</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2010.05.013" xlink:type="simple">10.1016/j.neuron.2010.05.013</ext-link></comment> <object-id pub-id-type="pmid">20620877</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ching</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Cimenser</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Purdon</surname> <given-names>PL</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>, <name name-style="western"><surname>Kopell</surname> <given-names>NJ</given-names></name>. <article-title>Thalamocortical model for a propofol-induced <italic>α</italic>-rhythm associated with loss of consciousness</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2010</year>;<volume>107</volume>(<issue>52</issue>):<fpage>22665</fpage>–<lpage>22670</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/cgi/doi/10.1073/pnas.1017069108" xlink:type="simple">http://www.pnas.org/cgi/doi/10.1073/pnas.1017069108</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005596.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chalk</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Herrero</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Gieselmann</surname> <given-names>Ma</given-names></name>, <name name-style="western"><surname>Delicato</surname> <given-names>LS</given-names></name>, <name name-style="western"><surname>Gotthardt</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Thiele</surname> <given-names>A</given-names></name>. <article-title>Attention reduces stimulus-driven gamma frequency oscillations and spike field coherence in V1</article-title>. <source>Neuron</source>. <year>2010</year> <month>apr</month>;<volume>66</volume>(<issue>1</issue>):<fpage>114</fpage>–<lpage>25</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2923752{&amp;}tool=pmcentrez{&amp;}rendertype=abstract" xlink:type="simple">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2923752{&amp;}tool=pmcentrez{&amp;}rendertype=abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2010.03.013" xlink:type="simple">10.1016/j.neuron.2010.03.013</ext-link></comment> <object-id pub-id-type="pmid">20399733</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sarma</surname> <given-names>SV</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>ZM</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Eskandar</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Using point process models to compare neural spiking activity in the subthalamic nucleus of Parkinson’s patients and a healthy primate</article-title>. <source>IEEE transactions on bio-medical engineering</source>. <year>2010</year> <month>jun</month>;<volume>57</volume>(<issue>6</issue>):<fpage>1297</fpage>–<lpage>305</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/20172804" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/20172804</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TBME.2009.2039213" xlink:type="simple">10.1109/TBME.2009.2039213</ext-link></comment> <object-id pub-id-type="pmid">20172804</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Igarashi</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Isomura</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Arai</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Harukuni</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Fukai</surname> <given-names>T</given-names></name>. <article-title>Oscillation Code for Neuronal Coordination during Motor Behavior</article-title>. <source>Journal of Neuroscience</source>. <year>2013</year> <month>nov</month>;<volume>33</volume>(<issue>47</issue>):<fpage>18515</fpage>–<lpage>18530</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.jneurosci.org/cgi/doi/10.1523/JNEUROSCI.2126-13.2013" xlink:type="simple">http://www.jneurosci.org/cgi/doi/10.1523/JNEUROSCI.2126-13.2013</ext-link>. <object-id pub-id-type="pmid">24259574</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mukamel</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Pirondini</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Babadi</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Wong</surname> <given-names>KFK</given-names></name>, <name name-style="western"><surname>Pierce</surname> <given-names>ET</given-names></name>, <name name-style="western"><surname>Harrell</surname> <given-names>PG</given-names></name>, <etal>et al</etal>. <article-title>A transition in brain state during propofol-induced unconsciousness</article-title>. <source>Journal of Neuroscience</source>. <year>2014</year>;<volume>34</volume>(<issue>3</issue>):<fpage>839</fpage>–<lpage>845</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.jneurosci.org/cgi/doi/10.1523/JNEUROSCI.5813-12.2014" xlink:type="simple">http://www.jneurosci.org/cgi/doi/10.1523/JNEUROSCI.5813-12.2014</ext-link>. <object-id pub-id-type="pmid">24431442</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fries</surname> <given-names>P</given-names></name>. <article-title>A mechanism for cognitive dynamics: neuronal communication through neuronal coherence</article-title>. <source>Trends in cognitive sciences</source>. <year>2005</year> <month>oct</month>;<volume>9</volume>(<issue>10</issue>):<fpage>474</fpage>–<lpage>80</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/16150631" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/16150631</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tics.2005.08.011" xlink:type="simple">10.1016/j.tics.2005.08.011</ext-link></comment> <object-id pub-id-type="pmid">16150631</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fell</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Axmacher</surname> <given-names>N</given-names></name>. <article-title>The role of phase synchronization in memory processes</article-title>. <source>Nature reviews Neuroscience</source>. <year>2011</year> <month>feb</month>;<volume>12</volume>(<issue>2</issue>):<fpage>105</fpage>–<lpage>18</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/21248789" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/21248789</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn2979" xlink:type="simple">10.1038/nrn2979</ext-link></comment> <object-id pub-id-type="pmid">21248789</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Denker</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Roux</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lindén</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Diesmann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Riehle</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Grün</surname> <given-names>S</given-names></name>. <article-title>The local field potential reflects surplus spike synchrony</article-title>. <source>Cerebral Cortex</source>. <year>2011</year>;<volume>21</volume>(<issue>12</issue>):<fpage>2681</fpage>–<lpage>2695</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/cercor/bhr040" xlink:type="simple">10.1093/cercor/bhr040</ext-link></comment> <object-id pub-id-type="pmid">21508303</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>, <name name-style="western"><surname>Gale</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Amirnovin</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Eskandar</surname> <given-names>EN</given-names></name>. <article-title>Characterizing the spiking dynamics of subthalamic nucleus neurons in Parkinson’s disease using generalized linear models</article-title>. <source>Frontiers in integrative neuroscience</source>. <year>2012</year> <month>jan</month>;<volume>6</volume>(<issue>June</issue>):<fpage>28</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3379030{&amp;}tool=pmcentrez{&amp;}rendertype=abstract" xlink:type="simple">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3379030{&amp;}tool=pmcentrez{&amp;}rendertype=abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fnint.2012.00028" xlink:type="simple">10.3389/fnint.2012.00028</ext-link></comment> <object-id pub-id-type="pmid">22723771</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deng</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Eskandar</surname> <given-names>EN</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>. <article-title>A point process approach to identifying and tracking transitions in neural spiking dynamics in the subthalamic nucleus of Parkinson’s patients</article-title>. <source>Chaos</source>. <year>2013</year> <month>dec</month>;<volume>23</volume>(<issue>4</issue>):<fpage>046102</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3808419{&amp;}tool=pmcentrez{&amp;}rendertype=abstract" xlink:type="simple">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3808419{&amp;}tool=pmcentrez{&amp;}rendertype=abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.4818546" xlink:type="simple">10.1063/1.4818546</ext-link></comment> <object-id pub-id-type="pmid">24387581</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Truccolo</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>, <name name-style="western"><surname>Fellows</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Donoghue</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <article-title>A point process framework for relating neural spiking activity to spiking history, neural ensemble, and extrinsic covariate effects</article-title>. <source>Journal of neurophysiology</source>. <year>2005</year>;<volume>93</volume>(<issue>September 2004</issue>):<fpage>1074</fpage>–<lpage>1089</lpage>. <object-id pub-id-type="pmid">15356183</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref021">
<label>21</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <source>Analysis of Neural Data</source>. <publisher-name>Springer</publisher-name>; <year>2014</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005596.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Smith</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <article-title>Estimating a state-space model from point process observations</article-title>. <source>Neural computation</source>. <year>2003</year> <month>may</month>;<volume>15</volume>(<issue>5</issue>):<fpage>965</fpage>–<lpage>91</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/12803953" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/12803953</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/089976603765202622" xlink:type="simple">10.1162/089976603765202622</ext-link></comment> <object-id pub-id-type="pmid">12803953</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref023">
<label>23</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Kitagawa</surname> <given-names>G</given-names></name>. <source>Introduction to Time Series Modeling</source>. <publisher-name>Chapman &amp; Hall / CRC Monographs on Statistics &amp; Applied Probability</publisher-name>; <year>2010</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005596.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huerta</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>West</surname> <given-names>M</given-names></name>. <article-title>Priors and component structures in autoregressive time series models</article-title>. <source>Journal of the Royal Statistics Society Series B</source>. <year>1999</year>;<volume>61</volume>(<issue>4</issue>):<fpage>881</fpage>–<lpage>899</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/1467-9868.00208" xlink:type="simple">10.1111/1467-9868.00208</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Polson</surname> <given-names>NG</given-names></name>, <name name-style="western"><surname>Scott</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Windle</surname> <given-names>J</given-names></name>. <article-title>Bayesian Inference for Logistic Models Using Pólya-Gamma Latent Variables</article-title>. <source>Journal of the American Statistical Association</source>. <year>2013</year>;<volume>108</volume>(<issue>504</issue>):<fpage>1339</fpage>–<lpage>1349</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.tandfonline.com/doi/abs/10.1080/01621459.2013.829001" xlink:type="simple">http://www.tandfonline.com/doi/abs/10.1080/01621459.2013.829001</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005596.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Allcroft</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Glasbey</surname> <given-names>CA</given-names></name>. <article-title>A spectral estimator of ARMA parameters from thresholded data</article-title>. <source>Statistics and Computing</source>. <year>2002</year>;<volume>12</volume>:<fpage>369</fpage>–<lpage>376</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1023/A:1020796314300" xlink:type="simple">10.1023/A:1020796314300</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Ventura</surname> <given-names>V</given-names></name>. <article-title>A Spike-Train Probability Model</article-title>. <source>Neural Computation</source>. <year>2001</year>;<volume>1720</volume>:<fpage>1713</fpage>–<lpage>1720</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/08997660152469314" xlink:type="simple">10.1162/08997660152469314</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref028">
<label>28</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Carlin</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Stern</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>. <source>Bayesian Data Analysis</source>. <publisher-name>Chapman &amp; Hall</publisher-name>; <year>1995</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005596.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tanner</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Wong</surname> <given-names>WH</given-names></name>. <article-title>The Calculation of Posterior Distributions by Data Augmentation</article-title>. <source>Journal of the American Statistical Association</source>. <year>1987</year> <month>jun</month>;<volume>82</volume>(<issue>398</issue>):<fpage>528</fpage>–<lpage>540</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.tandfonline.com/doi/abs/10.1080/01621459.1987.10478458" xlink:type="simple">http://www.tandfonline.com/doi/abs/10.1080/01621459.1987.10478458</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/2289463" xlink:type="simple">10.2307/2289463</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Frühwirth-Schnatter</surname> <given-names>S</given-names></name>. <article-title>Data Augmentation and Dynamic Linear Models</article-title>. <source>Journal of Time Series Analysis</source>. <year>1994</year>;<volume>15</volume>(<issue>2</issue>):<fpage>183</fpage>–<lpage>202</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1467-9892.1994.tb00184.x" xlink:type="simple">10.1111/j.1467-9892.1994.tb00184.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Penttonen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kamondi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Acsady</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Buzsaki</surname> <given-names>G</given-names></name>. <article-title>Gamma frequency oscillation in the hippocampus of the rat: intracellular analysis in vivo</article-title>. <source>European Journal of Neuroscience</source>. <year>1998</year> <month>feb</month>;<volume>10</volume>(<issue>2</issue>):<fpage>718</fpage>–<lpage>728</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://doi.wiley.com/10.1046/j.1460-9568.1998.00096.x" xlink:type="simple">http://doi.wiley.com/10.1046/j.1460-9568.1998.00096.x</ext-link>. <object-id pub-id-type="pmid">9749733</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Burgess</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>O’Keefe</surname> <given-names>J</given-names></name>. <article-title>Models of place and grid cell firing and theta rhythmicity</article-title>. <source>Current opinion in neurobiology</source>. <year>2011</year> <month>oct</month>;<volume>21</volume>(<issue>5</issue>):<fpage>734</fpage>–<lpage>44</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3223517{&amp;}tool=pmcentrez{&amp;}rendertype=abstract" xlink:type="simple">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3223517{&amp;}tool=pmcentrez{&amp;}rendertype=abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.conb.2011.07.002" xlink:type="simple">10.1016/j.conb.2011.07.002</ext-link></comment> <object-id pub-id-type="pmid">21820895</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref033">
<label>33</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Polasek</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Jin</surname> <given-names>S</given-names></name>. <chapter-title>Gibbs Sampling in AR Models with Random Walk Priors</chapter-title>. In: <source>From Data to Knowledge: Theoretical and practical aspects of classification, data analysis, and knowledge organization</source>. <publisher-name>Springer</publisher-name>; <year>1996</year>. p. <fpage>86</fpage>–<lpage>93</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005596.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Funkhouser</surname> <given-names>HG</given-names></name>. <article-title>A Short Account of the History of Symmetric Functions of Roots of Equations</article-title>. <source>The American Mathematical Monthly</source>. <year>1930</year>;<volume>37</volume>(<issue>7</issue>):<fpage>357</fpage>–<lpage>365</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/2299273" xlink:type="simple">10.2307/2299273</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buesing</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Macke</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Sahani</surname> <given-names>M</given-names></name>. <article-title>Learning stable, regularised latent models of neural population dynamics</article-title>. <source>Network: Computation in Neural Systems</source>. <year>2012</year>;<volume>23</volume>(<issue>1-2</issue>):<fpage>24</fpage>–<lpage>47</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005596.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sherman</surname> <given-names>BYJ</given-names></name>, <name name-style="western"><surname>Morrison</surname> <given-names>WJ</given-names></name>. <article-title>Adjustment of an Inverse Matrix Corresponding to a Change in One Element of a Given Matrix</article-title>. <source>The Annals of Mathematical Statistics</source>. <year>1950</year>;<volume>21</volume>(<issue>1</issue>):<fpage>124</fpage>–<lpage>127</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/aoms/1177729893" xlink:type="simple">10.1214/aoms/1177729893</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>, <name name-style="western"><surname>Nguyen</surname> <given-names>DP</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>Ma</given-names></name>, <name name-style="western"><surname>Solo</surname> <given-names>V</given-names></name>. <article-title>An analysis of neural receptive field plasticity by point process adaptive filtering</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2001</year>;<volume>98</volume>(<issue>21</issue>):<fpage>12261</fpage>–<lpage>12266</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.201409398" xlink:type="simple">10.1073/pnas.201409398</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Okamoto</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Isomura</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Takada</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fukai</surname> <given-names>T</given-names></name>. <article-title>Temporal integration by stochastic recurrent network dynamics with bimodal neurons</article-title>. <source>Journal of neurophysiology</source>. <year>2007</year>;<volume>97</volume>(<issue>6</issue>):<fpage>3859</fpage>–<lpage>3867</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.01100.2006" xlink:type="simple">10.1152/jn.01100.2006</ext-link></comment> <object-id pub-id-type="pmid">17392417</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jones</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Fontanini</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sadacca</surname> <given-names>BF</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Katz</surname> <given-names>DB</given-names></name>. <article-title>Natural stimuli evoke dynamic sequences of states in sensory cortical ensembles</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2007</year>;<volume>104</volume>(<issue>47</issue>):<fpage>18772</fpage>–<lpage>18777</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2141852{&amp;}tool=pmcentrez{&amp;}rendertype=abstract" xlink:type="simple">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2141852{&amp;}tool=pmcentrez{&amp;}rendertype=abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0705546104" xlink:type="simple">10.1073/pnas.0705546104</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref040">
<label>40</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Ulrich</surname> <given-names>KR</given-names></name>, <name name-style="western"><surname>Carlson</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Lian</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Borg</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Dzirasa</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Carin</surname> <given-names>L</given-names></name>. <chapter-title>Analysis of Brain States from Multi-Region LFP Time-Series</chapter-title>. In: <name name-style="western"><surname>Ghahramani</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Welling</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Cortes</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lawrence</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Weinberger</surname> <given-names>KQ</given-names></name>, editors. <source>Advances in Neural Information Processing Systems 27</source>. <publisher-name>Curran Associates, Inc.</publisher-name>; <year>2014</year>. p. <fpage>2483</fpage>–<lpage>2491</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://papers.nips.cc/paper/5624-analysis-of-brain-states-from-multi-region-lfp-time-series.pdf" xlink:type="simple">http://papers.nips.cc/paper/5624-analysis-of-brain-states-from-multi-region-lfp-time-series.pdf</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005596.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Isomura</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Harukuni</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Takekawa</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Aizawa</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Fukai</surname> <given-names>T</given-names></name>. <article-title>Microcircuitry coordination of cortical motor information in self-initiation of voluntary movements</article-title>. <source>Nature neuroscience</source>. <year>2009</year> <month>dec</month>;<volume>12</volume>(<issue>12</issue>):<fpage>1586</fpage>–<lpage>93</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/19898469" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/19898469</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2431" xlink:type="simple">10.1038/nn.2431</ext-link></comment> <object-id pub-id-type="pmid">19898469</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fries</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Roelfsema</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Engel</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>König</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name>. <article-title>Synchronization of oscillatory responses in visual cortex correlates with perception in interocular rivalry</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1997</year>;<volume>94</volume>(<issue>November</issue>):<fpage>12699</fpage>–<lpage>12704</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.94.23.12699" xlink:type="simple">10.1073/pnas.94.23.12699</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lepage</surname> <given-names>KQ</given-names></name>, <name name-style="western"><surname>Gregoriou</surname> <given-names>GG</given-names></name>, <name name-style="western"><surname>Kramer</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Aoi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gotts</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>, <etal>et al</etal>. <article-title>A procedure for testing across-condition rhythmic spike-field association change</article-title>. <source>Journal of neuroscience methods</source>. <year>2013</year> <month>feb</month>;<volume>213</volume>(<issue>1</issue>):<fpage>43</fpage>–<lpage>62</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/23164959" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/23164959</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jneumeth.2012.10.010" xlink:type="simple">10.1016/j.jneumeth.2012.10.010</ext-link></comment> <object-id pub-id-type="pmid">23164959</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mureşan</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Jurjuţ</surname> <given-names>OF</given-names></name>, <name name-style="western"><surname>Moca</surname> <given-names>VV</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Nikolić</surname> <given-names>D</given-names></name>. <article-title>The Oscillation Score: An Efficient Method for Estimating Oscillation Strength in Neuronal Activity</article-title>. <source>Journal of neurophysiology</source>. <year>2008</year>;p. <fpage>1333</fpage>–<lpage>1353</lpage>. <object-id pub-id-type="pmid">18160427</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Climer</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Newman</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Hasselmo</surname> <given-names>ME</given-names></name>. <article-title>Phase coding by grid cells in unconstrained environments: two-dimensional phase precession</article-title>. <source>The European journal of neuroscience</source>. <year>2013</year> <month>aug</month>;<volume>38</volume>(<issue>4</issue>):<fpage>2526</fpage>–<lpage>41</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3912569{&amp;}tool=pmcentrez{&amp;}rendertype=abstract" xlink:type="simple">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3912569{&amp;}tool=pmcentrez{&amp;}rendertype=abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/ejn.12256" xlink:type="simple">10.1111/ejn.12256</ext-link></comment> <object-id pub-id-type="pmid">23718553</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Matzner</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bar-Gad</surname> <given-names>I</given-names></name>. <article-title>Quantifying Spike Train Oscillations: Biases, Distortions and Solutions</article-title>. <source>PLOS Computational Biology</source>. <year>2015</year>;<volume>11</volume>(<issue>4</issue>):<fpage>e1004252</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.plos.org/10.1371/journal.pcbi.1004252" xlink:type="simple">http://dx.plos.org/10.1371/journal.pcbi.1004252</ext-link>. <object-id pub-id-type="pmid">25909328</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhou</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Burton</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Snyder</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Urban</surname> <given-names>NN</given-names></name>, <name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>. <article-title>Establishing a Statistical Link between Network Oscillations and Neural Synchrony</article-title>. <source>PLoS Computational Biology</source>. <year>2015</year>;<volume>11</volume>(<issue>10</issue>):<fpage>1</fpage>–<lpage>25</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004549" xlink:type="simple">10.1371/journal.pcbi.1004549</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref048">
<label>48</label>
<mixed-citation publication-type="other" xlink:type="simple">Wilson AG, Adams RP. Gaussian Process Covariance Kernels for Pattern Discovery and Extrapolation. In: Proceedings of the 30th International Conference on Machine Learning. vol. 28; 2013. p. 15. Available from: <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1302.4245" xlink:type="simple">http://arxiv.org/abs/1302.4245</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005596.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Czanner</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>, <name name-style="western"><surname>Wirth</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Yanike</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Suzuki</surname> <given-names>Wa</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <article-title>Analysis of between-trial and within-trial neural spiking dynamics</article-title>. <source>Journal of neurophysiology</source>. <year>2008</year>;<volume>99</volume>(<issue>5</issue>):<fpage>2672</fpage>–<lpage>2693</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00343.2007" xlink:type="simple">10.1152/jn.00343.2007</ext-link></comment> <object-id pub-id-type="pmid">18216233</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mandelblat-Cerf</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Paz</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Vaadia</surname> <given-names>E</given-names></name>. <article-title>Trial-to-trial variability of single cells in motor cortices is dynamically modified during visuomotor adaptation</article-title>. <source>The Journal of neuroscience</source>. <year>2009</year> <month>dec</month>;<volume>29</volume>(<issue>48</issue>):<fpage>15053</fpage>–<lpage>62</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/19955356" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/19955356</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3011-09.2009" xlink:type="simple">10.1523/JNEUROSCI.3011-09.2009</ext-link></comment> <object-id pub-id-type="pmid">19955356</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tort</surname> <given-names>ABL</given-names></name>, <name name-style="western"><surname>Komorowski</surname> <given-names>RW</given-names></name>, <name name-style="western"><surname>Manns</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Kopell</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Eichenbaum</surname> <given-names>H</given-names></name>. <article-title>Theta-gamma coupling increases during the learning of item-context associations</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2009</year>;<volume>106</volume>(<issue>49</issue>):<fpage>20942</fpage>–<lpage>20947</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0911331106" xlink:type="simple">10.1073/pnas.0911331106</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Vugt</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Schulze-Bonhage</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Litt</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Brandt</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kahana</surname> <given-names>MJ</given-names></name>. <article-title>Hippocampal gamma oscillations increase with memory load</article-title>. <source>The Journal of Neuroscience</source>. <year>2010</year>;<volume>30</volume>(<issue>7</issue>):<fpage>2694</fpage>–<lpage>2699</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.0567-09.2010" xlink:type="simple">10.1523/JNEUROSCI.0567-09.2010</ext-link></comment> <object-id pub-id-type="pmid">20164353</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005596.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yartsev</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Witter</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Ulanovsky</surname> <given-names>N</given-names></name>. <article-title>Grid cells without theta oscillations in the entorhinal cortex of bats</article-title>. <source>Nature</source>. <year>2011</year> <month>nov</month>;<volume>479</volume>(<issue>7371</issue>):<fpage>103</fpage>–<lpage>7</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/22051680" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/22051680</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature10583" xlink:type="simple">10.1038/nature10583</ext-link></comment> <object-id pub-id-type="pmid">22051680</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>