<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005876</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-01068</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Immune physiology</subject><subj-group><subject>Cytokines</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Immune physiology</subject><subj-group><subject>Cytokines</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune system</subject><subj-group><subject>Innate immune system</subject><subj-group><subject>Cytokines</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune system</subject><subj-group><subject>Innate immune system</subject><subj-group><subject>Cytokines</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Developmental biology</subject><subj-group><subject>Molecular development</subject><subj-group><subject>Cytokines</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population metrics</subject><subj-group><subject>Death rates</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Diagnostic medicine</subject><subj-group><subject>Signs and symptoms</subject><subj-group><subject>Sepsis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pathology and laboratory medicine</subject><subj-group><subject>Signs and symptoms</subject><subj-group><subject>Sepsis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune response</subject><subj-group><subject>Inflammation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune response</subject><subj-group><subject>Inflammation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Diagnostic medicine</subject><subj-group><subject>Signs and symptoms</subject><subj-group><subject>Inflammation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pathology and laboratory medicine</subject><subj-group><subject>Signs and symptoms</subject><subj-group><subject>Inflammation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Genetic algorithms</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Genetic algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Systems science</subject><subj-group><subject>Dynamical systems</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Systems science</subject><subj-group><subject>Dynamical systems</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Epithelial cells</subject><subj-group><subject>Endothelial cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Biological tissue</subject><subj-group><subject>Epithelium</subject><subj-group><subject>Epithelial cells</subject><subj-group><subject>Endothelial cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Biological tissue</subject><subj-group><subject>Epithelium</subject><subj-group><subject>Epithelial cells</subject><subj-group><subject>Endothelial cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Examining the controllability of sepsis using genetic algorithms on an agent-based model of systemic inflammation</article-title>
<alt-title alt-title-type="running-head">Examining the controllability of sepsis using genetic algorithms</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3224-7617</contrib-id>
<name name-style="western">
<surname>Cockrell</surname>
<given-names>Robert Chase</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="corresp" rid="cor001">*</xref>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4549-9004</contrib-id>
<name name-style="western">
<surname>An</surname>
<given-names>Gary</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001"><addr-line>Department of Surgery, University of Chicago, Chicago, Illinois, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Hunt</surname>
<given-names>C. Anthony</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of California San Francisco, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">cockrell@uchicago.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>15</day>
<month>2</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="collection">
<month>2</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>2</issue>
<elocation-id>e1005876</elocation-id>
<history>
<date date-type="received">
<day>29</day>
<month>6</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>8</day>
<month>11</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Cockrell, An</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005876"/>
<abstract>
<title>Abstract</title>
<p>Sepsis, a manifestation of the body’s inflammatory response to injury and infection, has a mortality rate of between 28%-50% and affects approximately 1 million patients annually in the United States. Currently, there are no therapies targeting the cellular/molecular processes driving sepsis that have demonstrated the ability to control this disease process in the clinical setting. We propose that this is in great part due to the considerable heterogeneity of the clinical trajectories that constitute clinical “sepsis,” and that determining how this system can be controlled back into a state of health requires the application of concepts drawn from the field of dynamical systems. In this work, we consider the human immune system to be a random dynamical system, and investigate its potential controllability using an agent-based model of the innate immune response (the Innate Immune Response ABM or IIRABM) as a surrogate, proxy system. Simulation experiments with the IIRABM provide an explanation as to why single/limited cytokine perturbations at a single, or small number of, time points is unlikely to significantly improve the mortality rate of sepsis. We then use genetic algorithms (GA) to explore and characterize multi-targeted control strategies for the random dynamical immune system that guide it from a persistent, non-recovering inflammatory state (functionally equivalent to the clinical states of systemic inflammatory response syndrome (SIRS) or sepsis) to a state of health. We train the GA on a single parameter set with multiple stochastic replicates, and show that while the calculated results show good generalizability, more advanced strategies are needed to achieve the goal of adaptive personalized medicine. This work evaluating the extent of interventions needed to control a simplified surrogate model of sepsis provides insight into the scope of the clinical challenge, and can serve as a guide on the path towards true “precision control” of sepsis.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Sepsis, characterized by the body’s inflammatory response to injury and infection, has a mortality rate of between 28%-50% and affects approximately 1 million patients annually in the United States. Currently, there are no therapies targeting the cellular/molecular processes driving sepsis that have demonstrated the ability to control this disease process. In this work, we utilize a computational model of the human immune response to infectious injury to offer an explanation as to why previously attempted treatment strategies are inadequate and why the current approach to drug/therapy-development is inadequate. We then use evolutionary computation algorithms to explore drug-intervention space using this same computational model as a surrogate system for human sepsis to identify the scale and scope of interventions to successfully control sepsis, as well as the types of data needed to derive these interventions. We demonstrate that multi-point and time-dependent varying controls are necessary and able to control the cytokine network dynamics of the immune system.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100006227</institution-id>
<institution>Lawrence Livermore National Laboratory</institution>
</institution-wrap>
</funding-source>
<award-id>B616283</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4549-9004</contrib-id>
<name name-style="western">
<surname>An</surname>
<given-names>Gary</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>1RO1GM115839-01</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4549-9004</contrib-id>
<name name-style="western">
<surname>An</surname>
<given-names>Gary</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This research used high performance computing resources of the National Energy Research Scientific Computing Center, a DOE Office of Science User Facility supported by the Office of Science of the U.S. Department of Energy under Contract No. DE-AC02-05CH11231. Additionally, this research was supported in part by NIH through resources provided by the University of Chicago Computation Institute (Beagle2) and the Biological Sciences Division of the University of Chicago and Argonne National Laboratory, under grant 1S10OD018495-01. This work was also supported by funds from Lawrence Livermore National Laboratory under Award #B616283. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="1"/>
<page-count count="17"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its supporting information file.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Approximately 1 million people will be diagnosed with sepsis, a condition with a mortality rate ranging from 28%-50%, each year [<xref ref-type="bibr" rid="pcbi.1005876.ref001">1</xref>]. Attempts to discover biologically-targeted therapies for sepsis have thus far been focused on manipulating a single mediator/cytokine, generally administered with either a single dose or over a very short course (&lt;72 hours) [<xref ref-type="bibr" rid="pcbi.1005876.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005876.ref003">3</xref>]. Unfortunately, all these attempts have been unsuccessful [<xref ref-type="bibr" rid="pcbi.1005876.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005876.ref003">3</xref>], likely due to both the nonlinear nature of the human inflammatory signaling network and the paucity of clinical time-course data to place network relationships in context,. In fact, we would propose that the universal failure to find effective cellular/molecular control strategies effective at the clinical level raises the question as to whether the system can be effectively controlled at all. The rationale for the current investigation is an attempt to address this fundamental question: can the trajectory of clinical sepsis be controlled, and if so, what is the scale and scope of the therapeutic interventions required to do so?</p>
<p>It is well known in biology that the systemic response to identical perturbations in genetically identical individuals (i.e., mice) is governed according to some probability distribution. This small stochastic variability in response can propagate over time such that it ultimately leads to divergent phenotypes. It logically follows then that a single time point/single cytokine intervention is unlikely to be successful on a broad range of patients with a broad range of conditions that have led to the state of sepsis. The challenge, however, is that the range of possible interventions, which is a function of the number of potential molecular targets, the extent to which they are modified, the time at which such modification can occur and the combinations thereof, is staggering, and cannot be tractably investigated given the logistical and practical limitations of both experimental and clinical research. We propose to address this challenge by the use of evolutionary computing (in the form of genetic algorithms) applied to a sufficiently complex, albeit abstracted, computational model of sepsis.</p>
<p>We have previously proposed that dynamic computational modeling, and specifically agent based modeling, can be used to represent mechanistic biological knowledge in a way that reproduces the non-linear dynamics of the real world system [<xref ref-type="bibr" rid="pcbi.1005876.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005876.ref005">5</xref>]. Agent-based models (ABM) have been used to study and model a wide variety of biological systems [<xref ref-type="bibr" rid="pcbi.1005876.ref006">6</xref>], from general purpose anatomic/cell-for-cell representations of organ systems capable of reproducing multiple independent phenomena [<xref ref-type="bibr" rid="pcbi.1005876.ref005">5</xref>] to platforms for drug development [<xref ref-type="bibr" rid="pcbi.1005876.ref007">7</xref>], and are frequently used to model non-linear dynamical systems such as the human immune system [<xref ref-type="bibr" rid="pcbi.1005876.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005876.ref009">9</xref>]. Specifically, was have previously developed an ABM of systemic inflammation, the Innate Immune Response agent-based model (IIRABM). We propose to use the existing IIRABM as a surrogate proxy system [<xref ref-type="bibr" rid="pcbi.1005876.ref010">10</xref>] for the investigation of potential control strategies for sepsis. We note that while the model does not contain a comprehensive list of all signaling mediators present in the human body, all relevant cellular behaviors are represented. The named cytokines in this model are those that are most often associated with the available behavior rules in the current literature[<xref ref-type="bibr" rid="pcbi.1005876.ref011">11</xref>].</p>
<p>The IIRABM is a two-dimensional abstract representation of the human endothelial-blood interface. This abstraction is designed to model the endothelial-blood interface for a traumatic (in the medical sense) injury, and does so by representing this interface as the unwrapped internal vascular surface of a 2D projection of the terminus for a branch of the arterial vascular network. The closed circulatory surface can be represented as a torus, and this two-dimensional area makes up the space that is simulated by the model. The spatial scale is not directly mapped using this scheme. This abstraction serves two primary purposes: to allow circumferential access to the traumatic injury by the innate immune system, and to incorporate multiple levels of interaction between leukocytes and tissue. The IIRABM utilizes this abstraction to simulate the human inflammatory signaling network response to injury; the model has been calibrated such that it reproduces the general clinical trajectories of sepsis (see [<xref ref-type="bibr" rid="pcbi.1005876.ref013">13</xref>] for details). The IIRABM operates by simulating multiple cell types and their interactions, including endothelial cells, macrophages, neutrophils, TH0, TH1, and TH2 cells as well as their associated precursor cells. The simulated system dies when total damage (defined as aggregate endothelial cell damage) exceeds 80%; this threshold represents the ability of current medical technologies to keep patients alive (i.e., through organ support machines) in conditions that previously would have been lethal. The IIRABM is initiated using 5 parameters representing the size and nature of the injury/infection as well as a metric of the host’s resilience–initial injury size, microbial invasiveness, microbial toxigenesis, environmental toxicity, and host resilience. In previous work [<xref ref-type="bibr" rid="pcbi.1005876.ref012">12</xref>], we have performed a sweep over these parameters to determine the plausible boundaries for conditions that could be considered clinically relevant. These are parameter sets that lead to all possible final outcomes when stochastically replicated–complete healing, death by infection, or death from immune dysregulation/sepsis.</p>
<p>Additionally, the IIRABM has been used to perform <italic>in silico</italic> clinical trials of mediator-directed therapies via the inhibition or augmentation of single and specific cytokine synthesis pathways [<xref ref-type="bibr" rid="pcbi.1005876.ref011">11</xref>]. Those studies accurately reproduced unsuccessful clinical trials, as well as the non-efficacy of hypothetical interventions; however, to date no effective putative interventions have been discovered.</p>
<p>The human innate immune response, and specifically in terms of sepsis, can be characterized through measurement of various biomarkers, including the pro-inflammatory and anti-inflammatory cytokines included in the IIRABM [<xref ref-type="bibr" rid="pcbi.1005876.ref013">13</xref>]. This implies that the system can be characterized by its state at some specific time, and therefore we apply that same perspective to our investigations with the IIRABM. At each time step, the IIRABM measures the total amount of cytokine present for all mediators in the model across the entire simulation. The ordered set of these cytokine measurement creates a high-dimensional trajectory through cytokine space that lasts throughout the duration of the simulation (until the <italic>in silico</italic> patient heals completely or dies. Prior analysis of these trajectories has shown that the aggregate output of the IIRABM behaves as a Random Dynamical System (RDS) with chaotic features [<xref ref-type="bibr" rid="pcbi.1005876.ref012">12</xref>] (in the sense that future simulation state can be sensitive to initial conditions). A Random Dynamical System [<xref ref-type="bibr" rid="pcbi.1005876.ref014">14</xref>] can be described by the triplet (<italic>S</italic>, Γ, <italic>Q</italic>) where <italic>S</italic> is the state space, Γ is a family of maps which maps <italic>S</italic> back onto itself (often referred to as the “equations of motion”), and <italic>Q</italic> is some probability distribution on Γ. Simply put, an RDS is a system in which the equations of motion (in this case, the equations which give the aggregate cytokine value for the system at a specific instance in time) contain elements of randomness. A detailed discussion of this, and more formal definition, can be found in [<xref ref-type="bibr" rid="pcbi.1005876.ref015">15</xref>].</p>
<p>System state in the IIRABM can be defined by a vector of cytokines, <inline-formula id="pcbi.1005876.e001"><alternatives><graphic id="pcbi.1005876.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005876.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>, in which each element of <inline-formula id="pcbi.1005876.e002"><alternatives><graphic id="pcbi.1005876.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005876.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math></alternatives></inline-formula> is the total amount of an individual cytokine present in the simulation at that instance in time. At each time step, <inline-formula id="pcbi.1005876.e003"><alternatives><graphic id="pcbi.1005876.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005876.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> is given by:
<disp-formula id="pcbi.1005876.e004">
<alternatives>
<graphic id="pcbi.1005876.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005876.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
where <italic>c</italic><sub><italic>i</italic>,<italic>n</italic></sub>(<italic>t</italic>) is the individual cytokine concentration seen by the endothelial cell at a specific grid point and <italic>N</italic> is the total number of endothelial cells which make up the endothelial surface. The random element comes from the calculation:
<disp-formula id="pcbi.1005876.e005">
<alternatives>
<graphic id="pcbi.1005876.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005876.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
</disp-formula></p>
<p>We note that this is a descriptive equation and is not explicitly solved in the IIRABM. It should also be mentioned that the exact output generated by an individual cell at a given time-step is dependent on the cellular action-execution ordering. We utilize a shuffled ordering system to achieve emulated concurrency and avoid artifacts associated with fixed agent ordering. This equation contains four primary terms: <inline-formula id="pcbi.1005876.e006"><alternatives><graphic id="pcbi.1005876.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005876.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> is the amount of cytokine <italic>i</italic> produced by endothelial cell <italic>n</italic> in response to current cytokine concentrations; <inline-formula id="pcbi.1005876.e007"><alternatives><graphic id="pcbi.1005876.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005876.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> is the sum of the responses of all other cell types, indexed with <italic>A</italic>, at the location of endothelial cell <italic>n</italic>, where <italic>p</italic><sub><italic>n</italic>,<italic>A</italic></sub> is the population of a specific cell type at that location;<italic>D</italic><sub><italic>i</italic></sub>(∑<sub><italic>n</italic>′</sub><italic>c</italic><sub><italic>i</italic>,<italic>n</italic>′</sub>(<italic>t</italic>)<italic>D</italic><sub><italic>i</italic></sub>−<italic>c</italic><sub><italic>i</italic>,<italic>n</italic></sub>(<italic>t</italic>)) represents the amount of cytokine <italic>i</italic> which diffuses into location <italic>n</italic> (according to the associated diffusion constant, <italic>D</italic><sub><italic>i</italic></sub>) from the neighboring cell locations, denoted by <italic>n</italic>′, and out of the current cell location into the space occupied by neighboring cells; and <italic>λ</italic><sub><italic>i</italic></sub><italic>c</italic><sub><italic>i</italic>,<italic>n</italic></sub>(<italic>t</italic>) is the amount of cytokine at cell location <italic>n</italic> that degrades at each time step according to degradation constant <italic>λ</italic><sub><italic>i</italic></sub>. The randomness in this model comes from the term <italic>p</italic><sub><italic>n</italic>,<italic>A</italic></sub>. This population is random in two ways: 1) in the absence of cytokine markers, inflammatory cell movement follows a random walk, and 2) cellular differentiation of inflammatory cells proceeds according to a probability distribution parameterized by current cytokine concentrations. We note that this explicit randomness does not comprise the entire uncertainty present in the model. The aggregation of individual cytokine concentrations into a single measure conceals any spatial information present in the simulation. Due to this, future behaviors can appear to be random when, in reality, an epistemic uncertainty (as opposed to intrinsic or “real” stochasticity) prevents an accurate prognosis. A high-level overview of this system and visual depiction of the functional rules governing cytokine production can be seen in <xref ref-type="fig" rid="pcbi.1005876.g001">Fig 1</xref>.</p>
<fig id="pcbi.1005876.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005876.g001</object-id>
<label>Fig 1</label>
<caption>
<title>IIRABM schematic diagram.</title>
<p>This is a high-level overview of the signaling rules incorporated into the IIRABM. Rules represented include cytokine up-regulation/down-regulation, cell activation, and cellular differentiation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005876.g001" xlink:type="simple"/>
</fig>
<p>Discovery of an effective or optimal intervention can then be viewed as a nonlinear optimization of a control problem [<xref ref-type="bibr" rid="pcbi.1005876.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1005876.ref018">18</xref>]. Genetic Algorithms (GA) [<xref ref-type="bibr" rid="pcbi.1005876.ref019">19</xref>] and Evolutionary Computing have been used to optimize a wide variety [<xref ref-type="bibr" rid="pcbi.1005876.ref020">20</xref>] of nonlinear systems. Medical applications of GA include vaccine dosing strategies and protein binding site prediction [<xref ref-type="bibr" rid="pcbi.1005876.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1005876.ref022">22</xref>]. Given a sufficiently validated model, and interpretation of the development of an intervention/control strategy to be a nonlinear optimization problem, GA’s can also be utilized to develop complex treatment and control strategies.</p>
<p>We acknowledge that the intrinsic limitation to this approach is that the use of machine-learning approaches to develop therapeutic strategies requires the use of a computational model to generate a sufficient amount of data to inform the algorithm. Hence, the strategy computed by a GA is only as valid as the model upon which it was trained. While the behaviors and rules in the IIRABM have been validated [<xref ref-type="bibr" rid="pcbi.1005876.ref012">12</xref>,<xref ref-type="bibr" rid="pcbi.1005876.ref013">13</xref>], we recognize that it is incomplete and less complex than its referent, the actual human immune cell/gene regulatory network; thus, we assert that if one is unable to reliably control this model, one would also be unable to reliably control its referent. While control of the IIRABM does not necessarily guarantee one could control the human immune system clinically, it does set a baseline for the types of control strategies one could expect to be successful as well as the data required to inform those control strategies.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>The parameter set (invasiveness = 2, toxigenesis = 5, host resilience = 0.1, environmental toxicity = 2, injury radius = 33 cells) upon which the GA was trained on a specific patient drawn from a parameter set that led to a final outcome of death by sepsis with a probability of 82%. We chose this parameterization because it represented a challenging case to digitally “cure.” <xref ref-type="table" rid="pcbi.1005876.t001">Table 1</xref> displays results from a variety of interventions that minimized their associated fitness function functions.</p>
<table-wrap id="pcbi.1005876.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005876.t001</object-id>
<label>Table 1</label>
<alternatives>
<graphic id="pcbi.1005876.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005876.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Number of Interventions</th>
<th align="left">Length</th>
<th align="left">General Case P(Death):</th>
<th align="left">Specific Patient P(Death):</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="right">N/A</td>
<td align="right">82</td>
<td align="right">68</td>
</tr>
<tr>
<td align="right">1</td>
<td align="right">25</td>
<td align="right">80</td>
<td align="right">65</td>
</tr>
<tr>
<td align="right">1</td>
<td align="right">50</td>
<td align="right">80</td>
<td align="right">64</td>
</tr>
<tr>
<td align="right">1</td>
<td align="right">99</td>
<td align="right">95</td>
<td align="right">87</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">25</td>
<td align="right">77</td>
<td align="right">67</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">50</td>
<td align="right">73</td>
<td align="right">66</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">99</td>
<td align="right">75</td>
<td align="right">71</td>
</tr>
<tr>
<td align="right">5</td>
<td align="right">50</td>
<td align="right">56</td>
<td align="right">41</td>
</tr>
<tr>
<td align="right">5</td>
<td align="right">99</td>
<td align="right">44</td>
<td align="right">30</td>
</tr>
<tr>
<td align="right">6</td>
<td align="right">99</td>
<td align="right">25</td>
<td align="right">12</td>
</tr>
<tr>
<td align="right">7</td>
<td align="right">99</td>
<td align="right">30</td>
<td align="right">12</td>
</tr>
<tr>
<td align="right">8</td>
<td align="right">99</td>
<td align="right">16</td>
<td align="right">12</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The first column displays the number of sequential interventions (spaced 100 time steps apart); the second column displays the length of the intervention in simulation time steps (where 100 time steps represents 12 hours); the third column displays the general probability of death for this specific condition (parameter set) after intervention; the fourth column displays the probability of death for the specific <italic>in silico</italic> patient upon which the GA was trained. The general probability of death was calculated by starting the simulation with 100 distinct RNG seeds, applying the selected intervention, and running the simulation to completion. The probability of death for the specific patient (meaning specific parameter set and specific RNG seed) was calculated by starting the simulation with a specific RNG seed, reseeding the RNG 100 times at the start of the intervention sequence, applying the intervention, and running the simulation to completion (either complete healing or death). We should note that the probability of death for a specific patient utilizes two distinct pieces of information: the random number seed and the time at which the probability is calculated. A specific patient’s probability of death evolves over time as their total level of health evolves due to simulation rules. The initial patient-specific mortality rate of 68% then is only valid for that particular random number seed at the particular instance in time 12 hours post-injury.”</p>
<p>We have previously characterized the stochastic properties of the trajectory space of the IIRABM in [<xref ref-type="bibr" rid="pcbi.1005876.ref012">12</xref>], and note the existence of 3 distinct regions of state space: 1) the region of space under the influence of the Life Attractor–trajectories in this region will always lead to a state of complete healing; 2) the region of space under the influence of the Death attractor–trajectories in this region will always lead to complete system failure and death; and 3) the “stochastic zone”–trajectories in this region are influenced more strongly by random effects (stochastic randomness and epistemic uncertainty) than by the effects of either of the aforementioned attractors.</p>
<p>At the time point when the intervention is started, the system is still in the “stochastic zone,” and thus a given intervention will not have a guaranteed effect; rather, it changes the probabilistic future outcome distribution to favor a state corresponding to greater health. Thus, a subtle effect sustained over time causes a significant improvement in mortality rates. Throughout the course of this work, we initiate our interventions 12 hours post-simulated injury. The GA has found an effective intervention which begins at this point, however, if stochasticity leads an <italic>in silico</italic> patient to a sufficiently different location in cytokine state-space, the stochastic failure of the first stage of the intervention will lead to further failure at subsequent stages. The nature of these dynamics explains the phenomenon of “non-responders” to the putative interventions as defined at various time points during an individual trajectory; ultimately “non-responders” represent trajectories that are either not driven out of the stochastic zone by our proscribed duration of therapy or those whose stochastic response lead them to a region of parameter space in which the intervention no longer alters the future outcome probability distribution to favor a state of increased health.</p>
<p>The best solution (that which minimized the probability of death for both the specific patient case and the general case) was found by using 8 sequential interventions. For the specific patient upon which the GA was trained, the probability of death was reduced from 68% to 12% through application in the intervention shown in <xref ref-type="fig" rid="pcbi.1005876.g002">Fig 2</xref>; for the general case, the probability of death with this intervention was reduced from 82% to 16%. This intervention is represented as a series of bar graphs in <xref ref-type="fig" rid="pcbi.1005876.g002">Fig 2</xref>. The height of the bars along the y-axis represents the log<sub>2</sub> of the intervention multiplier; the x-axis shows which cytokine has its protein synthesis augmented or inhibited according to its associated bar.</p>
<fig id="pcbi.1005876.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005876.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Representation of computed intervention.</title>
<p>This figure contains 8 bar graphs, each of which represents a single stage of the 8-stage intervention. The cytokines operated on are shown on the x-axes and the base-2 logarithm of the augmentation or inhibition strength is shown on the y-axes. This sequence of interventions lowered the probability of death from 68% to 12% for the patient upon which the GA was trained; the probability of death was lowered from 82% to 16% for the general population using an identical parameter set.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005876.g002" xlink:type="simple"/>
</fig>
<p>In order to explore the generalizability of this intervention, we tested it against all clinically relevant parameter sets (8291 parameter sets) that generated a mortality rate between 1 and 99%—this is the population of parameter sets that have been defined as “clinically relevant” [<xref ref-type="bibr" rid="pcbi.1005876.ref012">12</xref>]. The results of this test are shown in <xref ref-type="fig" rid="pcbi.1005876.g003">Fig 3</xref>. In Panel A, we show the untreated mortality rate distribution for all parameter sets that generate at least two outcomes (life and death, either from infection or from sepsis). This distribution is skewed towards the edge cases as the hyper-surface-area of the clinically relevant region is maximized at the boundaries of the space; this represents the total number of simulations that are at the “edge” of clinical relevance. This is discussed more extensively in previous work [<xref ref-type="bibr" rid="pcbi.1005876.ref012">12</xref>]. Panel 3B shows the overall shift in the mortality rate distribution for this population of parameter sets. <xref ref-type="fig" rid="pcbi.1005876.g003">Fig 3</xref>, Panels C-F show the shifts in mortality rate distribution for more narrow ranges of mortality. We note that <xref ref-type="fig" rid="pcbi.1005876.g003">Fig 3</xref>, panels E and F appear to have a bimodal distribution (also hinted at in Panel D); this bimodal distribution occurs because as the severity of the simulated condition increases, the likelihood of a given stochastic replicate being a “non-responder” to a standardized treatment also increases.</p>
<fig id="pcbi.1005876.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005876.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Examination of generalizability of computed intervention.</title>
<p>In panel A, the mortality rate distribution for the parameter sets that generate between 1 and 99% mortality rate (MR) is presented with the mortality rate on the x-axis and the number of parameter sets that generate that mortality rate (with 100 stochastic replicates) is on the y-axis. Panel B shows the MR distribution for a set of simulations with parameterizations identical to those in panel A, however they have been treated with the calculated intervention. Panel C shows the post intervention MR for those simulations in panel A which have a base MR between 20% and 30%; Panel D: 40% and 50%; Panel E: 60% and 70%; Panel F: 70% and 80%; Panel G: 80% and 90%. In Panel H, we plot the base MR against the post treatment MR for all clinically relevant parameter sets. Those points which lie below the black diagonal line represent parameter sets for which this treatment was beneficial.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005876.g003" xlink:type="simple"/>
</fig>
<p>The phenomenon of “non-responders” provides an excellent argument for adaptive personalized medicine, that is, the need to adapt a therapeutic strategy based on <italic>an individual’s</italic> response to therapy (“in silico clinical trials of 1”), with the goal of returning a system to a state of health. To further explore this, we investigated the cases that were unable to be cured using the derived intervention. <xref ref-type="fig" rid="pcbi.1005876.g004">Fig 4A</xref> shows the total oxygen deficit trajectories for the average of all the simulations that healed when using the optimal intervention and for a single instance of the simulation that does not heal; <xref ref-type="fig" rid="pcbi.1005876.g004">Fig 4B</xref> shows the neutrophil population and <xref ref-type="fig" rid="pcbi.1005876.g004">Fig 4C</xref> shows the total systemic GCSF. After three sequential interventions, it is apparent that this patient has a stronger response to GCSF stimulation, and thus a higher neutrophil population. As this difference continues to compound over time, interventions later in the sequence lose their efficacy (as they are optimized for a system in a different state). We pause the simulation at this point and use the GA to find a sequence of 5 more interventions that could heal the system. The newly derived final 5 interventions are compared with the old intervention in <xref ref-type="fig" rid="pcbi.1005876.g005">Fig 5</xref>. This shifted the probability of death for that patient (at the time in which the intervention is changed) from 75% to 8%. This success suggests that an algorithm that adapts interventions based on system response could be more successful than a GA without the ability to adapt based on system response.</p>
<fig id="pcbi.1005876.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005876.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Non-responder system dynamics.</title>
<p>Panel A displays the oxygen deficit (an inverse measure of the system’s health) for an intervention non-responder (red) compared to the average oxygen deficit for intervention responders (blue) over time. Panel B displays the total GCSF for the non-responder and the responder average; panel C displays the total neutrophil population for an individual non-responder and the responder average. In this case, the non-responder does not end up healing due to a hyper-productive response to GCSF pathway stimulation, which leads to a surplus neutrophil population; this patient ultimately dies due to inflammation, which is exacerbated by the applied intervention.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005876.g004" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005876.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005876.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Intervention comparison for responders and non-responder.</title>
<p>The set of bar graphs on the left shows the final 5 interventions in a sequence of 8 that showed the greatest success in healing the most <italic>in silico</italic> patients. The set of bar graphs on the right shows an alternate intervention sequence that was generated by training the genetic algorithm on a patient who was non-responsive to the original intervention. The cytokines operated on are shown on the x-axes and the base-2 logarithm of the augmentation or inhibition strength is shown on the y-axes. The <italic>in silico</italic> patients received identical interventions for the first three time points. At time point 3, a significant deviation from expected behavior is noted in the non-responder. At this time point, the simulation is halted and used to populate the sample set for a new run of the genetic algorithm. When given the original intervention, this patient has a 75% chance of death at 60 hrs post-injury; the alternate intervention lowers this chance to 8%.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005876.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec003" sec-type="conclusions">
<title>Discussion</title>
<p>The human inflammatory signaling network as represented by the IIRABM is a nonlinear and stochastic system that lacks a unique set of analytical equations that can adequately describe it. Designing an effective policy to control such a system requires the exploration of an astronomically large search space–in the case of 8 sequential interventions with 9 defined augmentation/inhibition strengths, there are approximately 10<sup>91</sup> combinations that can be applied to the system. Given the size of this space, we make no claim that we have found the globally optimal intervention for our model, given a fixed set of parameters; rather, we have shown that GA can be used to find a “good-enough” solution that shows success (though not perfection) at treating a range of conditions leading to death by sepsis.</p>
<p>Longer duration therapies were more successful than shorter therapies due to the stochastic nature of the IIRABM and its response to perturbations (<xref ref-type="supplementary-material" rid="pcbi.1005876.s001">S1 Fig</xref>). All interventions are performed on <italic>in silico</italic> patients whose system state is either in the stochastic zone or under the influence of the death attractor (in which case their trajectories would have to pass through the stochastic zone on the way to health). When the system state is in the stochastic zone, the effects of randomness can be stronger the effects of either of the attractors which influence the system; subsequent states fall will within some probability distribution (which is discoverable via pausing the simulation and reseeding the random number generator several times) based on the current state. Just as the system evolves in a stochastic nature when left unattended, its responses to perturbations will also be stochastic, however the possible future distribution of states is now based on the components of the perturbation as well as the current system state. Successful interventions will then shift the future state probability distribution towards health; more successful interventions will generate a larger move towards health more often, though there can still exist a non-zero probability that the system state evolves negatively rather than beneficially.</p>
<p>While GA is quite successful at healing the IIRABM under a wide range of conditions, it has a few drawbacks which preclude it from being the ideal solution: 1) more extreme conditions (either very large injuries or extremely virulent bacteria) require either a finer degree of control than is computationally tractable using GA, as each sequential intervention multiplies the size of the search space by a factor of 9<sup>12</sup> (approximately 5 billion), or more aggressive interventions; intervention multipliers were limited to a small set of values we considered clinically tractable–removing this constraint would lead to an unconstrained search, increasing computational cost and potentially generating implausible interventions; 2) adjusting the temporal density of interventions requires a new run of the GA, which can be computationally expensive; 3) the GA does not have the ability to react to non-responders and adjust the intervention accordingly–rather, it finds the single sequence of interventions which (locally) maximizes the survival probability for a given patient population. As such we note that we do not claim to find the absolute optimum sequence of interventions for a given parameter set due to the lack of general formal analytical convergence proofs for genetic algorithms [<xref ref-type="bibr" rid="pcbi.1005876.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005876.ref024">24</xref>] and the fact that it is computationally intractable to explore the entire intervention space, especially for multiple sequential interventions. Additionally, many interventions can have opposing effects with the possibility of cancelling each other out (i.e., GCSF augmentation leading to an increasing neutrophil population.</p>
<p>Future work will incorporate alternative machine learning algorithms, including deep reinforcement learning [<xref ref-type="bibr" rid="pcbi.1005876.ref025">25</xref>] and Long Short Term Memory neural networks [<xref ref-type="bibr" rid="pcbi.1005876.ref026">26</xref>] for time-series prediction of aggregate cytokine values. Both of these techniques would base putative interventions on the sequence of events that led up to the intervention. In this sense, the learning algorithm would adapt the putative intervention to an individual system state rather than attempting to develop a single broad policy that would cover a certain class of injury. As these approaches will incorporate more “adaption” to where the system happens to be in trajectory space (overcoming a recognized limitation of GAs) they will have more direct clinical relevance as they will explore several different sampling strategies, including those that are currently clinically infeasible, to determine the types and frequencies of sampling necessary to characterize the trajectory of a random dynamical system.</p>
<p>These results strengthen the case for adaptive personalized medicine (as defined above). Rather than searching an astronomically large space for a utilitarian intervention, personalized medicine techniques would respond to cytokine dynamics with an individualized intervention for each patient at varying temporal scales. These things are theoretically possible using GA, but at the present time, the computational expense limits the practicality of using this technique to personalize treatments.</p>
</sec>
<sec id="sec004" sec-type="materials|methods">
<title>Methods</title>
<p>The current investigation involves providing a proof-of-concept example of identifying whether effective controls can be found for the IIRABM, and, by extension, for the treatment of sepsis. This initial proof-of-concept constrains the problem by focusing a particular parameter configuration of the IIRABM with a mortality rate of 68%. We first employed a genetic algorithm (GA) to search for possible therapeutic interventions, and then examined the generalizability of the optimal solutions across a wider range of stochastic replicates and additional parameter sets with similar overall baseline mortality rates. The IIRABM was implemented in C++ and simulations were performed on the Edison Cray XC30 Supercomputer at the National Energy Research Scientific Computing Center and on the Beagle Cray XE6 Supercomputer at the University of Chicago.</p>
<p>We chose to train the GA on a single parameter set for 2 primary reasons:</p>
<p>1) A large number of parameter sets can generate a realistic sepsis condition. Parameter sets that are relatively similar tend to have similar mortality rates and similar simulated length-of-stays in the ICU. In this work, we explored the generalizability of intervention solutions derived using the GA to help assess the future potential of utilizing GA as an <italic>in silico</italic> drug-development technique. 2) The computational cost of running a genetic algorithm is substantial. A single instance of this model simulating 90 days in the ICU will take approximately 4 minutes (depending on the speed of the processor running the simulation). Each iteration of the GA gathers data from up to 2000 independent simulation runs (where each run repeats the simulation 10 times using 10 stochastic replicates), and the GA can run for 1000 or more generations before convergence when considering multi-stage interventions; each GA experiment can utilize up to 1,000,000 cpu-hrs (equivalent to $100,000) [<xref ref-type="bibr" rid="pcbi.1005876.ref027">27</xref>].</p>
<p>We have selected a parameter set (invasiveness = 2, toxigenesis = 5, host resilience = 0.1, environmental toxicity = 2) which leads to simulated death approximately 80% of the time in the general case. This is illustrated in <xref ref-type="fig" rid="pcbi.1005876.g006">Fig 6A</xref>; here we show total health trajectories for 100 stochastic replicates of the above parameter set. The systemic oxygen deficit (a proxy for total system damage) is plotted against the time for which the simulation ran. Trajectories shown in red are simulations that die and trajectories shown in blue are simulations that heal completely. From this set of outcome trajectories, we have chosen a specific trajectory/<italic>in silico</italic> patient with which to train the GA. Given this specific patient’s location in state space 12 hours post injury, we estimate that they have a 68% chance of death. Note that this mortality rate is calculated in a different manner than the rate referenced above. In the general case, this parameter set generates a mortality rate of 80%, meaning that when the simulation’s random number generator (RNG) is given 100 unique starting seeds, 80 of those simulations will die (a population level outcome distribution). For the individual patient mortality rate, the simulation is paused at the time step before the intervention would be applied (in this case, 12 hrs post injury); the simulation’s RNG is then reseeded a number of times to discover the mortality rate for a specific <italic>in silico</italic> patient at a specific moment in time. Thus, the general case mortality rate represents the mortality rate for a specific parameter set, while the individual patient mortality rate represents the mortality rate for a specific parameter set at a specific instance in time. As discussed above, an individual patient does not have a fixed fate at any given point in time (as long as their trajectory remains in the stochastic zone) and their probabilistic future outcome distribution is time dependent and will evolve with the system. This is shown in <xref ref-type="fig" rid="pcbi.1005876.g006">Fig 6B</xref>; this image displays 100 random number generator (RNG) re-seedings, reseeded 12 hours post injury, of the specific trajectory we have chosen. The utilization of stochastic replicates on a single patient allows the GA to sample the full range of responses possible for a given intervention.</p>
<fig id="pcbi.1005876.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005876.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Stochastic trajectory example.</title>
<p>Panel A displays 100 stochastic trajectories generated by the IIRABM for a specific parameter set (Invasiveness = 2; Host Resilience = 0.1; Toxigenesis = 5; Environmental Toxicity = 2) with an injury with a radius of 33 cells. The total systemic oxygen deficit, an inverse measure of the <italic>in silico</italic> patient’s health (y-axis) is presented as a function of time (x-axis). 82% of the simulated patients (red) end in death, while 18% heal completely (blue). The trajectories shown in panel B use the same parameter set as in panel A, however the run is started with a specific random number generator seed; the random number generator is re-seeded at 12 hrs post injury. At 1-day post injury, this specific patient has a 68% chance of death.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005876.g006" xlink:type="simple"/>
</fig>
<p>We have selected a set of cytokines and associated targets (Platelet-activating factor (PAF), Tumor necrosis factor alpha (TNFα), Soluble tumor necrosis factor receptors (sTNFr), Interleukin-1 (IL1), soluble interleukin-1 receptors (sIL1r), Interleukin-1 receptor antagonist (IL1ra), Interferon-gamma IFNγ, Interleukin-4 (IL4), Interleukin-8 (IL8), Interleukin-10 (IL10), Interleukin-12 (IL12), and Granulocyte colony-stimulating factor (GCSF)), which are the principal drivers of the inflammatory/immune dynamics expressed by the model. In order to search for an optimal intervention strategy, we allow production of each of these targets to be augmented or inhibited alone or as a group. For the purposes of this study, we consider an <bold>intervention</bold> to be a set of signaling augmentations/inhibitions. An individual’s chromosome is then a 1x12<italic>n</italic> vector, where <italic>n</italic> is the number of independent sequential interventions, containing this information. The augmentation and inhibition values are selected from the set: {0.05, 0.25, 0.5, 0.75, 1, 2, 5, 10, 20}; inhibitory values are multiplicative (i.e., <italic>S</italic><sub><italic>i</italic>,<italic>new</italic></sub> = <italic>S</italic><sub><italic>i</italic>,<italic>old</italic></sub> * <italic>I</italic><sub><italic>i</italic></sub>) where <italic>S</italic><sub><italic>i</italic>,<italic>new</italic></sub> represents the modified signal value, <italic>S</italic><sub><italic>i</italic>,<italic>old</italic></sub> represents the signal value being modified, and <italic>I</italic><sub><italic>i</italic></sub> represents the vector element of the intervention vector which applies to the signal. Augmentations are additive rather than multiplicative (i.e., <italic>S</italic><sub><italic>i</italic>,<italic>new</italic></sub> = <italic>S</italic><sub><italic>i</italic>,<italic>old</italic></sub> + (<italic>I</italic><sub><italic>i</italic></sub> – 1)). This allows for a sustained application of the intervention; were the augmentations to be multiplicative, then the simulation would quickly produce results outside the realm of plausibility due to an exponential explosion in concentrations of cytokines whose values have been multiplied. The descriptive local cytokine update function then becomes:
<disp-formula id="pcbi.1005876.e008">
<alternatives>
<graphic id="pcbi.1005876.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005876.e008" xlink:type="simple"/>
<mml:math display="block" id="M8">
<mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mspace width="0.25em"/><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where
<disp-formula id="pcbi.1005876.e009">
<alternatives>
<graphic id="pcbi.1005876.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005876.e009" xlink:type="simple"/>
<mml:math display="block" id="M9">
<mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:munder></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
and <italic>T</italic><sub><italic>i</italic></sub> represents the cytokine augmentation/inhibition value for that state of the treatment. All of these cytokine augmentations/inhibitions represent theoretical drug targets rather than actual drugs. While there are drugs that target some of these specific pathways, i.e. Filgrastim for GCSF, incorporating specific drugs, their dosage-dependent effects, and their change in efficacy over time, presumably based on the drug’s half-life, is beyond the scope of this work.</p>
<p>We define the fitness function as <inline-formula id="pcbi.1005876.e010"><alternatives><graphic id="pcbi.1005876.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005876.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where OD represents the Oxygen Deficit, and is an inverse measure of the patient’s total health at the time when the fitness is evaluated and X is a measure of the total infectious load in the system at the time when the fitness is evaluated, and <italic>n</italic> is the number of stochastic replicates used. An optimal solution will minimize this fitness function (and thus maximize the patient’s total health). We train the GA on 10 stochastic replicates of an individual trajectory. These replicates are generated by re-seeding the RNG at the time point when the intervention begins. This allows the GA to learn from a possible range of responses an individual can have to a given intervention. The fitness is evaluated 12 hours after the application of the final intervention (which has a maximum duration of 12 hours).</p>
<p>After the fitness is evaluated, we use the tournament selection method [<xref ref-type="bibr" rid="pcbi.1005876.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005876.ref029">29</xref>], with a tournament size of 2, to generate the breeding population. When breeding, each pair of progenitors produces two progeny using a uniform crossover operator [<xref ref-type="bibr" rid="pcbi.1005876.ref030">30</xref>]. We continue this process until the algorithm has converged to a small set of possible solutions, and select the solution that leads to the minimal fitness value as the intervention to be tested. We evaluate the intervention according to three criteria: 1) outcome distribution in specific patient upon which the GA was trained; 2) outcome distribution in a population of patients exposed to the same injury and microbial infection; and 3) outcome distribution in a population of patients exposed to a range of injuries and microbial infections.</p>
<p>Due to the enormous size of the intervention-possibility space, we cannot definitely state that our intervention strategy is the globally optimal intervention strategy, and in fact is likely not; rather, it is a near-optimal strategy stuck in some local minima of the fitness function. We recognize that the utilization of alternate crossover or mutation strategies would lead to alternative intervention strategies, possibly even strategies would be rated as more “fit” than the strategy that we found; however, alternative strategies would still suffer from the same primary weakness identified with this approach–the inability to adapt therapeutic strategy based on system response. Rather than attempt to make small improvements in the fitness of the strategy, future work will focus on the development of a GA-derived intervention strategy with this adaptive ability.</p>
<p>Source code for the IIRABM with GA capability is available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/cockrell/iirabm_public" xlink:type="simple">https://bitbucket.org/cockrell/iirabm_public</ext-link>. Certain GA experiments used the EMEWS [<xref ref-type="bibr" rid="pcbi.1005876.ref031">31</xref>] framework with DEAP [<xref ref-type="bibr" rid="pcbi.1005876.ref032">32</xref>] to automate the GA process.</p>
</sec>
<sec id="sec005">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005876.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005876.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Representation of GA-identified intervention strategy by mediator.</title>
<p>This figure contains 12 bar graphs, each of which represents the sequence of augmentations/inhibitions applied to a particular cytokine pathway. The intervention sequence is shown on the x-axes and the base-2 logarithm of the augmentation or inhibition strength is shown on the y-axes. This sequence of interventions lowered the probability of death from 68% to 12% for the patient upon which the GA was trained; the probability of death was lowered from 82% to 16% for the general population using an identical parameter set.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005876.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wood</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Angus</surname> <given-names>DC</given-names></name>. <article-title>Pharmacoeconomic implications of new therapies in sepsis</article-title>. <source>Pharmacoeconomics</source>. <year>2004</year>;<volume>22</volume>(<issue>14</issue>):<fpage>895</fpage>–<lpage>906</lpage>. <object-id pub-id-type="pmid">15362927</object-id></mixed-citation></ref>
<ref id="pcbi.1005876.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marshall</surname> <given-names>J</given-names></name>. <article-title>Clinical trials of mediator-directed therapy in sepsis: what have we learned?</article-title> <source>Intensive care medicine</source>. <year>2000</year>;<volume>26</volume>(<issue>1</issue>):<fpage>S075</fpage>–<lpage>S83</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005876.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Opal</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Dellinger</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Vincent</surname> <given-names>J-L</given-names></name>, <name name-style="western"><surname>Masur</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Angus</surname> <given-names>DC</given-names></name>. <article-title>The next generation of sepsis trials: What’s next after the demise of recombinant human activated Protein C?</article-title> <source>Critical care medicine</source>. <year>2014</year>;<volume>42</volume>(<issue>7</issue>):<fpage>1714</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1097/CCM.0000000000000325" xlink:type="simple">10.1097/CCM.0000000000000325</ext-link></comment> <object-id pub-id-type="pmid">24717456</object-id></mixed-citation></ref>
<ref id="pcbi.1005876.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cockrell</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Christley</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>An</surname> <given-names>G</given-names></name>. <article-title>Investigation of Inflammation and Tissue Patterning in the Gut Using a Spatially Explicit General-Purpose Model of Enteric Tissue (SEGMEnT)</article-title>. <source>PLoS computational biology</source>. <year>2014</year>;<volume>10</volume>(<issue>3</issue>):<fpage>e1003507</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003507" xlink:type="simple">10.1371/journal.pcbi.1003507</ext-link></comment> <object-id pub-id-type="pmid">24675765</object-id></mixed-citation></ref>
<ref id="pcbi.1005876.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cockrell</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Christley</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>An</surname> <given-names>G</given-names></name>. <article-title>Towards anatomic scale agent-based modeling with a massively parallel spatially explicit general-purpose model of enteric tissue (SEGMEnT_HPC)</article-title>. <source>PloS one</source>. <year>2015</year>;<volume>10</volume>(<issue>3</issue>):<fpage>e0122192</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0122192" xlink:type="simple">10.1371/journal.pone.0122192</ext-link></comment> <object-id pub-id-type="pmid">25806784</object-id></mixed-citation></ref>
<ref id="pcbi.1005876.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bonabeau</surname> <given-names>E</given-names></name>. <article-title>Agent-based modeling: methods and techniques for simulating human systems</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2002</year>;<volume>99</volume> <issue>Suppl 3</issue>:<fpage>7280</fpage>–<lpage>7</lpage>. Epub 2002/05/16. doi: <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.082080899" xlink:type="simple">10.1073/pnas.082080899</ext-link>.</comment> <object-id pub-id-type="pmid">12011407</object-id>; PubMed Central PMCID: PMC128598.</mixed-citation></ref>
<ref id="pcbi.1005876.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>An</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Bartels</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Vodovotz</surname> <given-names>Y</given-names></name>. <article-title>In Silico Augmentation of the Drug Development Pipeline: Examples from the study of Acute Inflammation</article-title>. <source>Drug Dev Res</source>. <year>2011</year>;<volume>72</volume>(<issue>2</issue>):<fpage>187</fpage>–<lpage>200</lpage>. Epub 2011/05/10. doi: <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/ddr.20415" xlink:type="simple">10.1002/ddr.20415</ext-link>.</comment> <object-id pub-id-type="pmid">21552346</object-id>; PubMed Central PMCID: PMC3086282.</mixed-citation></ref>
<ref id="pcbi.1005876.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Baldazzi</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Castiglione</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Bernaschi</surname> <given-names>M</given-names></name>. <article-title>An enhanced agent based model of the immune system response</article-title>. <source>Cellular immunology</source>. <year>2006</year>;<volume>244</volume>(<issue>2</issue>):<fpage>77</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cellimm.2006.12.006" xlink:type="simple">10.1016/j.cellimm.2006.12.006</ext-link></comment> <object-id pub-id-type="pmid">17416357</object-id></mixed-citation></ref>
<ref id="pcbi.1005876.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bailey</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Thorne</surname> <given-names>BC</given-names></name>, <name name-style="western"><surname>Peirce</surname> <given-names>SM</given-names></name>. <article-title>Multi-cell agent-based simulation of the microvasculature to study the dynamics of circulating inflammatory cell trafficking</article-title>. <source>Annals of biomedical engineering</source>. <year>2007</year>;<volume>35</volume>(<issue>6</issue>):<fpage>916</fpage>–<lpage>36</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10439-007-9266-1" xlink:type="simple">10.1007/s10439-007-9266-1</ext-link></comment> <object-id pub-id-type="pmid">17436112</object-id></mixed-citation></ref>
<ref id="pcbi.1005876.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>An</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Fitzpatrick</surname> <given-names>BG</given-names></name>, <name name-style="western"><surname>Christley</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Federico</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kanarek</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Neilan</surname> <given-names>RM</given-names></name>, <etal>et al</etal>. <article-title>Optimization and Control of Agent-Based Models in Biology: A Perspective</article-title>. <source>Bull Math Biol</source>. <year>2016</year>. doi: <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11538-016-0225-6" xlink:type="simple">10.1007/s11538-016-0225-6</ext-link>.</comment> <object-id pub-id-type="pmid">27826879</object-id>.</mixed-citation></ref>
<ref id="pcbi.1005876.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>An</surname> <given-names>G</given-names></name>. <article-title>In silico experiments of existing and hypothetical cytokine-directed clinical trials using agent-based modeling</article-title>. <source>Critical care medicine</source>. <year>2004</year>;<volume>32</volume>(<issue>10</issue>):<fpage>2050</fpage>–<lpage>60</lpage>. <object-id pub-id-type="pmid">15483414</object-id></mixed-citation></ref>
<ref id="pcbi.1005876.ref012"><label>12</label><mixed-citation publication-type="other" xlink:type="simple">Cockrell C, An G. Sepsis Reconsidered: Identifying Novel Metrics For Behavioral Landscape Characterization With A High-Performance Computing Implementation Of An Agent-Based Model. bioRxiv. 2017:141804.</mixed-citation></ref>
<ref id="pcbi.1005876.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Faix</surname> <given-names>JD</given-names></name>. <article-title>Biomarkers of sepsis</article-title>. <source>Critical reviews in clinical laboratory sciences</source>. <year>2013</year>;<volume>50</volume>(<issue>1</issue>):<fpage>23</fpage>–<lpage>36</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3109/10408363.2013.764490" xlink:type="simple">10.3109/10408363.2013.764490</ext-link></comment> <object-id pub-id-type="pmid">23480440</object-id></mixed-citation></ref>
<ref id="pcbi.1005876.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bhattacharya</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Majumdar</surname> <given-names>M</given-names></name>. <article-title>Random dynamical systems: a review</article-title>. <source>Economic Theory</source>. <year>2003</year>;<volume>23</volume>(<issue>1</issue>):<fpage>13</fpage>–<lpage>38</lpage> (2004).</mixed-citation></ref>
<ref id="pcbi.1005876.ref015"><label>15</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Arnold</surname> <given-names>L</given-names></name>. <source>Random dynamical systems</source>: <publisher-name>Springer Science &amp; Business Media</publisher-name>; <year>2013</year>.</mixed-citation></ref>
<ref id="pcbi.1005876.ref016"><label>16</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Nazareth</surname> <given-names>L</given-names></name>. <chapter-title>An optimization primer: on models, algorithms, and duality</chapter-title>: <publisher-name>Springer Science &amp; Business Media</publisher-name>; <year>2004</year>.</mixed-citation></ref>
<ref id="pcbi.1005876.ref017"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">Canon MD, Cullum Jr CD, Polak E. Theory of optimal control and mathematical programming. 1970.</mixed-citation></ref>
<ref id="pcbi.1005876.ref018"><label>18</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Friesz</surname> <given-names>TL</given-names></name>. <chapter-title>Nonlinear Programming and Discrete-Time Optimal Control</chapter-title>. <source>Dynamic Optimization and Differential Games</source>: <publisher-name>Springer</publisher-name>; <year>2010</year>. p. <fpage>33</fpage>–<lpage>78</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005876.ref019"><label>19</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Haupt</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Haupt</surname> <given-names>SE</given-names></name>. <source>Practical genetic algorithms</source>: <publisher-name>John Wiley &amp; Sons</publisher-name>; <year>2004</year>.</mixed-citation></ref>
<ref id="pcbi.1005876.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Patel</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Longini</surname> <given-names>IM</given-names></name>, <name name-style="western"><surname>Halloran</surname> <given-names>ME</given-names></name>. <article-title>Finding optimal vaccination strategies for pandemic influenza using genetic algorithms</article-title>. <source>Journal of theoretical biology</source>. <year>2005</year>;<volume>234</volume>(<issue>2</issue>):<fpage>201</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2004.11.032" xlink:type="simple">10.1016/j.jtbi.2004.11.032</ext-link></comment> <object-id pub-id-type="pmid">15757679</object-id></mixed-citation></ref>
<ref id="pcbi.1005876.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dweep</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Sticht</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pandey</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Gretz</surname> <given-names>N</given-names></name>. <article-title>miRWalk–database: prediction of possible miRNA binding sites by “walking” the genes of three genomes</article-title>. <source>Journal of biomedical informatics</source>. <year>2011</year>;<volume>44</volume>(<issue>5</issue>):<fpage>839</fpage>–<lpage>47</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jbi.2011.05.002" xlink:type="simple">10.1016/j.jbi.2011.05.002</ext-link></comment> <object-id pub-id-type="pmid">21605702</object-id></mixed-citation></ref>
<ref id="pcbi.1005876.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morris</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Goodsell</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Halliday</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Huey</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Hart</surname> <given-names>WE</given-names></name>, <name name-style="western"><surname>Belew</surname> <given-names>RK</given-names></name>, <etal>et al</etal>. <article-title>Automated docking using a Lamarckian genetic algorithm and an empirical binding free energy function</article-title>. <source>Journal of computational chemistry</source>. <year>1998</year>;<volume>19</volume>(<issue>14</issue>):<fpage>1639</fpage>–<lpage>62</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005876.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sharapov</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Lapshin</surname> <given-names>AV</given-names></name>. <article-title>Convergence of genetic algorithms</article-title>. <source>Pattern Recognition and Image Analysis</source>. <year>2006</year>;<volume>16</volume>(<issue>3</issue>):<fpage>392</fpage>–<lpage>7</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005876.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Levine</surname> <given-names>D</given-names></name>. <article-title>Commentary—Genetic Algorithms: A Practitioner's View</article-title>. <source>INFORMS Journal on computing</source>. <year>1997</year>;<volume>9</volume>(<issue>3</issue>):<fpage>256</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005876.ref025"><label>25</label><mixed-citation publication-type="other" xlink:type="simple">Mnih V, Kavukcuoglu K, Silver D, Graves A, Antonoglou I, Wierstra D, et al. Playing atari with deep reinforcement learning. arXiv preprint arXiv:13125602. 2013.</mixed-citation></ref>
<ref id="pcbi.1005876.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gers</surname> <given-names>FA</given-names></name>, <name name-style="western"><surname>Schmidhuber</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cummins</surname> <given-names>F</given-names></name>. <article-title>Learning to forget: Continual prediction with LSTM</article-title>. <source>Neural computation</source>. <year>2000</year>;<volume>12</volume>(<issue>10</issue>):<fpage>2451</fpage>–<lpage>71</lpage>. <object-id pub-id-type="pmid">11032042</object-id></mixed-citation></ref>
<ref id="pcbi.1005876.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Walker</surname> <given-names>E</given-names></name>. <article-title>The real cost of a CPU hour</article-title>. <source>Computer</source>. <year>2009</year>:<fpage>35</fpage>–<lpage>41</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005876.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goldberg</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Deb</surname> <given-names>K</given-names></name>. <article-title>A comparative analysis of selection schemes used in genetic algorithms</article-title>. <source>Foundations of genetic algorithms</source>. <year>1991</year>;<volume>1</volume>:<fpage>69</fpage>–<lpage>93</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005876.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blickle</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Thiele</surname> <given-names>L</given-names></name>. <article-title>A comparison of selection schemes used in evolutionary algorithms</article-title>. <source>Evolutionary Computation</source>. <year>1996</year>;<volume>4</volume>(<issue>4</issue>):<fpage>361</fpage>–<lpage>94</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005876.ref030"><label>30</label><mixed-citation publication-type="other" xlink:type="simple">Gwiazda TD. Crossover for single-objective numerical optimization problems: Tomasz Gwiazda; 2006.</mixed-citation></ref>
<ref id="pcbi.1005876.ref031"><label>31</label><mixed-citation publication-type="other" xlink:type="simple">Ozik J, Collier NT, Wozniak JM, Spagnuolo C, editors. From desktop to large-scale model exploration with Swift/T. Proceedings of the 2016 Winter Simulation Conference; 2016: IEEE Press.</mixed-citation></ref>
<ref id="pcbi.1005876.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fortin</surname> <given-names>F-A</given-names></name>, <name name-style="western"><surname>Rainville</surname> <given-names>F-MD</given-names></name>, <name name-style="western"><surname>Gardner</surname> <given-names>M-A</given-names></name>, <name name-style="western"><surname>Parizeau</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gagné</surname> <given-names>C</given-names></name>. <article-title>DEAP: Evolutionary algorithms made easy</article-title>. <source>Journal of Machine Learning Research</source>. <year>2012</year>;<volume>13</volume>(<issue>Jul</issue>):<fpage>2171</fpage>–<lpage>5</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>