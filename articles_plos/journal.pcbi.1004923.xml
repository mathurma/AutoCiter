<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00662</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004923</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Network analysis</subject><subj-group><subject>Signaling networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biophysics</subject><subj-group><subject>Biophysical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Biophysics</subject><subj-group><subject>Biophysical simulations</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Biophysical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Circadian oscillators</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Chronobiology</subject><subj-group><subject>Circadian oscillators</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Numerical analysis</subject><subj-group><subject>Numerical integration</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Developmental biology</subject><subj-group><subject>Cell differentiation</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Stochastic Simulation of Biomolecular Networks in Dynamic Environments</article-title>
<alt-title alt-title-type="running-head">Stochastic Simulation of Biomolecular Networks in Dynamic Environments</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Voliotis</surname> <given-names>Margaritis</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Thomas</surname> <given-names>Philipp</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Grima</surname> <given-names>Ramon</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Bowsher</surname> <given-names>Clive G.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>School of Mathematics, University of Bristol, Bristol, United Kingdom</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Mathematics, Imperial College London, London, United Kingdom</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>School of Biological Sciences, University of Edinburgh, Edinburgh, United Kingdom</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ouzounis</surname> <given-names>Christos A.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Institute of Agrobiotechnology, GREECE</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: PT MV RG CGB. Performed the experiments: PT MV. Analyzed the data: PT MV RG CGB. Contributed reagents/materials/analysis tools: PT MV RG CGB. Wrote the paper: RG CGB.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">Ramon.Grima@ed.ac.uk</email> (RG); <email xlink:type="simple">C.Bowsher@bristol.ac.uk</email> (CGB)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>6</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>1</day>
<month>6</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>6</issue>
<elocation-id>e1004923</elocation-id>
<history>
<date date-type="received">
<day>23</day>
<month>4</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>17</day>
<month>4</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Voliotis et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004923"/>
<abstract>
<p>Simulation of biomolecular networks is now indispensable for studying biological systems, from small reaction networks to large ensembles of cells. Here we present a novel approach for stochastic simulation of networks embedded in the dynamic environment of the cell and its surroundings. We thus sample trajectories of the stochastic process described by the chemical master equation with time-varying propensities. A comparative analysis shows that existing approaches can either fail dramatically, or else can impose impractical computational burdens due to numerical integration of reaction propensities, especially when cell ensembles are studied. Here we introduce the Extrande method which, given a simulated time course of dynamic network inputs, provides a conditionally exact and several orders-of-magnitude faster simulation solution. The new approach makes it feasible to demonstrate—using decision-making by a large population of quorum sensing bacteria—that robustness to fluctuations from upstream signaling places strong constraints on the design of networks determining cell fate. Our approach has the potential to significantly advance both understanding of molecular systems biology and design of synthetic circuits.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Simulation algorithms have become indispensable tools in modern quantitative biology, providing deep insight into many biochemical systems, including gene regulatory networks. However, current stochastic simulation approaches handle the effects of fluctuating extracellular signals and upstream processes poorly, either failing to give qualitatively reliable predictions or being very inefficient computationally. Here we introduce the Extrande method, a novel approach for simulation of biomolecular networks embedded in the dynamic environment of the cell and its surroundings. The method is accurate and computationally efficient, and hence fills an important gap in the field of stochastic simulation. In particular, we employ it to study a bacterial decision-making network and demonstrate that robustness to fluctuations from upstream signaling places strong constraints on the design of networks determining cell fate.</p>
</abstract>
<funding-group>
<funding-statement>MV acknowledges support under an MRC Biomedical Informatics Fellowship. PT acknowledges support by the Royal Commission for the Exhibition of 1851. RG acknowledges support from the Leverhulme Trust (RPG-2013-171). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="3"/>
<table-count count="0"/>
<page-count count="18"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote><p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p></disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Dynamic simulation is an essential and widespread approach for studying biomolecular networks in cell biology [<xref ref-type="bibr" rid="pcbi.1004923.ref001">1</xref>]. However, the computational resources required can quickly become limiting for several reasons. Cellular networks are complex, containing many biomolecular species and reactions. The effects of biochemical stochasticity can be pervasive at the single-cell level [<xref ref-type="bibr" rid="pcbi.1004923.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1004923.ref003">3</xref>], implying that stochastic simulation approaches are often needed. And cells do not live in isolation, which requires simulation on multiple scales, ranging from the single cell to large ensembles of communicating cells [<xref ref-type="bibr" rid="pcbi.1004923.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1004923.ref005">5</xref>]. In these circumstances, parsimonious models of intracellular networks offer dimension reduction [<xref ref-type="bibr" rid="pcbi.1004923.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1004923.ref008">8</xref>] and significant advantages [<xref ref-type="bibr" rid="pcbi.1004923.ref009">9</xref>]. However, such models often only provide accurate descriptions when they include the effects of interactions with other fluctuating processes in the cell and of signals arising extracellularly [<xref ref-type="bibr" rid="pcbi.1004923.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1004923.ref012">12</xref>]. While it is straightforward to write a Chemical Master Equation describing the stochastic dynamics of these models, it is usually impenetrable to analysis and one needs to make use of simulation methods. The stochastic simulation algorithm (SSA) [<xref ref-type="bibr" rid="pcbi.1004923.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1004923.ref014">14</xref>] allows only the random timing of reactions in the network model to be taken into account (often known as intrinsic noise), but cannot be used when other processes interacting with the network cause its propensities to fluctuate between reaction occurrences. The SSA assumes constant propensities between reactions (and hence exponentially distributed waiting times). Here we present a new approach relaxing this assumption, called Extrande, for stochastic simulation of a biomolecular network of interest embedded in the dynamic, fluctuating environment of the cell and its surroundings. An extensible implementation of Extrande for general reaction networks with multiple inputs is given in the <xref ref-type="supplementary-material" rid="pcbi.1004923.s001">S1 File</xref>.</p>
<p>Biological processes that interact with the network or model of interest are sometimes called extrinsic processes [<xref ref-type="bibr" rid="pcbi.1004923.ref015">15</xref>]. They often significantly change the stochastic behaviour and dynamics of the network [<xref ref-type="bibr" rid="pcbi.1004923.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1004923.ref017">17</xref>]. We briefly give two illustrations of the biological importance of extrinsic processes as motivation for the development of our approach, the first well-established, and the second considered here. First, although intrinsic noise is an important contributor, extrinsic processes are known to be a substantial and sometimes dominant source of variation in gene expression levels across cells and over time [<xref ref-type="bibr" rid="pcbi.1004923.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1004923.ref021">21</xref>]. We are now beginning to understand the underlying biological sources [<xref ref-type="bibr" rid="pcbi.1004923.ref022">22</xref>], which include effects related to circadian oscillations, temperature, chromatin remodelling, the cell-cycle and pulsatile transcription factors [<xref ref-type="bibr" rid="pcbi.1004923.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1004923.ref024">24</xref>]. To understand gene expression, it is therefore essential to move beyond the SSA, which can only account for intrinsic noise, and to include other sources of variation. Second, fluctuations in the expression, degradation and recycling of proteins inevitably affect the way networks containing those proteins function and the extent of stochasticity in the input they provide to other networks. Fluctuations in the component proteins of signal transduction networks limit information transfer [<xref ref-type="bibr" rid="pcbi.1004923.ref025">25</xref>], affect transduction network ‘design’ [<xref ref-type="bibr" rid="pcbi.1004923.ref026">26</xref>] and, although often overlooked, are inevitably conveyed (as extrinsic inputs) to the networks regulated by signaling. Here, the computational advantages of Extrande will allow us to demonstrate how fluctuations in the protein componentry of signal transduction networks are conveyed to signaling outputs and place strong constraints on the design of networks determining cell fate, thus influencing the distribution of phenotypes at the population level. Without the ability to simulate biomolecular networks that are exposed to fluctuating inputs, the ability to address such questions is severely restricted.</p>
<p>There are two existing approaches to stochastic simulation of reaction networks subject to dynamic, fluctuating inputs. The first class of algorithms [<xref ref-type="bibr" rid="pcbi.1004923.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1004923.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1004923.ref027">27</xref>] implements the SSA, under the <italic>approximation</italic> that the input remains constant between the occurrences of any two reactions. However, this approximation can give spurious results even when dynamic inputs to the network are changing relatively slowly. We term these collectively the <italic>Slow Input Approximation method</italic> (SIA). The second class of algorithms [<xref ref-type="bibr" rid="pcbi.1004923.ref028">28</xref>–<xref ref-type="bibr" rid="pcbi.1004923.ref030">30</xref>] involves step-wise numerical integration of reaction propensities until a target value for the integral is reached. Algorithms in this class would be (conditionally) exact, if it were not for the presence of numerical error in integration, but can impose large and impractical computational burdens, especially when cell ensembles are studied. We term these collectively the <italic>integral method</italic> (distinguishing next and direct integral approaches below). We perform a comparative analysis of both methods with Extrande and demonstrate that our method offers an accurate and computationally efficient alternative approach. Extrande involves no analytical or numerical integration but instead relies on ‘thinning’ techniques [<xref ref-type="bibr" rid="pcbi.1004923.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1004923.ref032">32</xref>]. Other approaches using rejection methods have also recently been proposed as a means to tackle systems with time-dependent propensities [<xref ref-type="bibr" rid="pcbi.1004923.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1004923.ref033">33</xref>].</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Stochastic simulation using the Extrande approach</title>
<p>The stochastic simulation algorithm (SSA) [<xref ref-type="bibr" rid="pcbi.1004923.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1004923.ref014">14</xref>] allows simulation of biomolecular reaction networks taking into account the discreteness of these systems as well as the intrinsic randomness in the timing of reaction events. The SSA assumes that the propensity of each reaction channel to fire, hence the probability of the reaction to occur over a small time interval, remains constant between reaction events. This naturally restrains the use of SSA to simulate networks embedded in dynamic, fluctuating environments because the reaction propensities then become time-varying quantities under the influence of extrinsic processes.</p>
<boxed-text id="pcbi.1004923.box001" position="float">
<sec id="sec004">
<title>Box 1: Extrande algorithm</title>
<p>We present below the Extrande algorithm—<italic><bold>Extra</bold></italic> <bold>Reaction Algorithm for Networks in Dynamic Environments</bold>—for stochastic simulation over the interval [0, <italic>T</italic>] of a reaction network with <italic>M</italic> reaction channels {<italic>R</italic><sub>1</sub>, …, <italic>R</italic><sub><italic>M</italic></sub>} and associated stoichiometries {<italic>v</italic><sub>1</sub>, …, <italic>v</italic><sub><italic>M</italic></sub>}. The network state, <italic>X</italic>, gives the number of molecules of each species. We denote the extra (‘virtual’) reaction channel by <italic>R</italic><sub><italic>M</italic>+1</sub>. The algorithm takes as input a function that simulates the dynamic, exogenous inputs, <italic>I</italic>, over time (see below). The variable <italic>t</italic> below tracks the progress of the algorithm in continuous time.</p>
<p specific-use="line">1: Initialise time <italic>t</italic> ← 0 and network state <italic>X</italic> ← <italic>X</italic><sub>0</sub>.</p>
<p specific-use="line">2: <bold>repeat</bold></p>
<p specific-use="line">3:  (<italic>Determine propensity bound</italic>) Choose <italic>L</italic> ≤ <italic>T</italic> − <italic>t</italic> and <italic>B</italic> such that <italic>a</italic><sub>0</sub>(<italic>t</italic>+<italic>u</italic>) ≤ <italic>B</italic> for 0 ≤ <italic>u</italic> &lt; <italic>L</italic>, where <inline-formula id="pcbi.1004923.e001"><alternatives><graphic id="pcbi.1004923.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:msub><mml:mi>a</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the sum of the reaction propensities <italic>a</italic><sub><italic>j</italic></sub> at time <italic>t</italic> + <italic>u</italic> provided that no reaction channel fires during (<italic>t</italic>, <italic>t</italic>+<italic>L</italic>).</p>
<p specific-use="line">4:  (<italic>Generate putative reaction time</italic>) Draw exponentially distributed random number <italic>τ</italic> ∼ <italic>Exp</italic>(1/<italic>B</italic>).</p>
<p specific-use="line">5:  <bold>if</bold> <italic>τ</italic> &gt; <italic>L</italic> <bold>then</bold></p>
<p specific-use="line">    (<italic>‘Reject’; State of the network remains unchanged</italic>)</p>
<p specific-use="line">6:   Update time <italic>t</italic> ← <italic>t</italic> + <italic>L</italic>.</p>
<p specific-use="line">7:  <bold>else</bold></p>
<p specific-use="line">8:   Update time <italic>t</italic> ← <italic>t</italic> + <italic>τ</italic>.</p>
<p specific-use="line">9:   From the simulation of <italic>I</italic> at time <italic>t</italic>, obtain <italic>I</italic>(<italic>t</italic>), update all propensities <italic>a</italic><sub><italic>j</italic></sub>[<italic>X</italic>, <italic>I</italic>(<italic>t</italic>)] that depend on <italic>I</italic>(<italic>t</italic>), and evaluate the sum <inline-formula id="pcbi.1004923.e002"><alternatives><graphic id="pcbi.1004923.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:msub><mml:mi>a</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p specific-use="line">10:   Generate uniformly distributed random number <italic>u</italic> ∼ <italic>U</italic><sub>(0,1)</sub>.</p>
<p specific-use="line">11:   <bold>if</bold> <italic>a</italic><sub>0</sub>(<italic>t</italic>) ≥ <italic>Bu</italic> <bold>then</bold></p>
<p>    (<italic>‘Accept’; Choose reaction channel to fire and update state</italic>)</p>
<p specific-use="line">12:    choose reaction associated with the smallest positive integer <italic>j</italic> less than or equal to <italic>M</italic> satisfying:
<disp-formula id="pcbi.1004923.e003"><alternatives><graphic id="pcbi.1004923.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>j</mml:mi></mml:munderover> <mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>≥</mml:mo> <mml:mi>B</mml:mi> <mml:mi>u</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p specific-use="line">13:    Update state <italic>X</italic> ← <italic>X</italic>+<italic>ν</italic><sub><italic>j</italic></sub>.</p>
<p specific-use="line">14:   <bold>else</bold></p>
<p specific-use="line">     (<italic>‘Thin’; The extra reaction channel fires and the state of the network remains unchanged</italic>)</p>
<p specific-use="line">15:   <bold>end if</bold></p>
<p specific-use="line">16:  <bold>end if</bold></p>
<p specific-use="line">17: <bold>until</bold> <italic>t</italic> ≥ <italic>T</italic> (<italic>terminate when final time is exceeded</italic>)</p>
<p>The function used to simulate the inputs, <italic>I</italic>, will depend on the input processes. For example, when <italic>I</italic> is given by a stochastic or ordinary differential equation (SDE or ODE) requiring numerical solution, the function returns values of <italic>I</italic> on a discrete grid (using, e.g., the Euler-Maruyama method [<xref ref-type="bibr" rid="pcbi.1004923.ref034">34</xref>] in the case of an SDE), with values for intermediate times obtained by a deterministic interpolation rule. Notice that, in general, the bound, <italic>B</italic>, and look-ahead horizon, <italic>L</italic>, change on each repeat of the algorithm: both may depend on the history of <italic>X</italic> at time <italic>t</italic> and on the trajectory of <italic>I</italic> on [0, <italic>T</italic>]. The bound, <italic>B</italic>, may be set to the supremum of <italic>a</italic><sub>0</sub>(<italic>t</italic>+<italic>u</italic>) for 0 ≤ <italic>u</italic> &lt; <italic>L</italic>: e.g., in the case of single input and with all <italic>a</italic><sub><italic>j</italic></sub> monotonically increasing functions of <italic>I</italic> this would be <inline-formula id="pcbi.1004923.e004"><alternatives><graphic id="pcbi.1004923.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mi>B</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:msub><mml:mi>a</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msup><mml:mi>I</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> where <italic>I</italic>* is the supremum of <italic>I</italic>(<italic>t</italic>+<italic>u</italic>) for 0 ≤ <italic>u</italic> &lt; <italic>L</italic>. Different methods for computing the bound <italic>B</italic> and various implementations of Extrande are given in <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>. A simple choice for the look-ahead horizon is <italic>L</italic> = <italic>T</italic>−<italic>t</italic>. In practice, we find that the efficiency of the method is relatively robust to the choice of <italic>L</italic> and a few exploratory simulation runs can guide its choice. Alternatively <italic>L</italic> could be adaptively updated at the beginning of each repeat based on information collected by the algorithm (e.g., statistics of ‘thin’, ‘reject’ and ‘accept’ events).</p>
</sec>
</boxed-text>
<p>Extrande (<xref ref-type="boxed-text" rid="pcbi.1004923.box001">Box 1</xref>)—or <italic>Ext</italic>ra Reaction Algorithm for Networks in Dynamic Environments—allows exact stochastic simulation of any downstream reaction network, conditional upon a time course of the dynamic inputs that is simulated up-front. The method involves no analytical or numerical integration, though we give a connection to the direct integral method below, and instead makes use of point process ‘thinning’ techniques [<xref ref-type="bibr" rid="pcbi.1004923.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1004923.ref032">32</xref>], where some simulated events are discarded. The only error incurred is any error associated with the input pre-simulation, typically an approximate simulation of a stochastic differential equation (<xref ref-type="boxed-text" rid="pcbi.1004923.box001">Box 1</xref>).</p>
<p>The Extrande approach can be understood as introducing an extra, ‘virtual’ reaction channel into the system (whose occurrence does not change molecule numbers). The propensity of the extra channel is designed to fluctuate over time so that (when added to the sum of all other reaction propensities) the total propensity in the <italic>augmented</italic> system becomes constant between events and equal to an upper bound on the sum of the propensities in the <italic>original</italic> system. To accomplish this, the method exploits the exogeneity of the dynamic inputs—the assumption of negligible retroactivity [<xref ref-type="bibr" rid="pcbi.1004923.ref035">35</xref>] from network to inputs. In particular, their exogeneity means that Extrande is able to make use of the ‘future’ trajectory of the inputs to find an upper bound, <italic>B</italic>, on the total propensity, which is valid over a certain time interval <italic>L</italic> (see Step 3, <xref ref-type="boxed-text" rid="pcbi.1004923.box001">Box 1</xref>).</p>
<p>Simulation of the <italic>augmented</italic> system is feasible by means of an SSA-like algorithm. The method uses the bound on the total propensity to generate a putative reaction reaction time <italic>τ</italic> (Step 4). If the reaction time exceeds the time horizon <italic>L</italic>, it is rejected; the system time advances by <italic>L</italic> (Step 6), and the procedure restarts by determining a new bound. Otherwise, time advances by <italic>τ</italic> and a reaction is chosen based on the updated reaction propensities (at time <italic>t</italic>+<italic>τ</italic>) (Steps 8–15). The reaction events of the virtual channel are discarded, leaving those of the other channels—because the simulated timing and types of the biochemical reaction channels are unaffected by the behaviour of the extra channel, the result is a trajectory of the original system (see <xref ref-type="sec" rid="sec009">Methods</xref>).</p>
<sec id="sec005"><title>The Extrande method is accurate but the SIA method can fail, even when inputs vary relatively slowly</title> <p>Under the SIA method (see <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>), the input is approximated by a piecewise constant function whose value can only change when the firing of a biomolecular reaction is simulated. The method does not track the instantaneous value of the input process but values of its past; the process simulated therefore becomes non-Markovian. Nevertheless, one might expect that the SIA method would be adequate when the input changes on a slow timescale, compared to the typical waiting times between firings of the physical reaction network when exposed to the input [<xref ref-type="bibr" rid="pcbi.1004923.ref013">13</xref>]. We demonstrate (<xref ref-type="fig" rid="pcbi.1004923.g001">Fig 1</xref>) this is far from being the case using gene expression models with dynamic transcription propensities, and biologically realistic protein abundances and rates for various cell types: unicellular algae, bacteria, yeast, and mammalian cells. Specifically, we consider the two-stage model
<disp-formula id="pcbi.1004923.e005"><alternatives><graphic id="pcbi.1004923.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>⌀</mml:mi> <mml:mover><mml:mo>→</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mover> <mml:mi>M</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mi>M</mml:mi> <mml:mover><mml:mo>→</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>s</mml:mi></mml:msub></mml:mover> <mml:mi>M</mml:mi> <mml:mo>+</mml:mo> <mml:mi>P</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:mi>M</mml:mi> <mml:mover><mml:mo>→</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mtext>dm</mml:mtext></mml:msub></mml:mover> <mml:mi>⌀</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mi>P</mml:mi> <mml:mover><mml:mo>→</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mtext>dp</mml:mtext></mml:msub></mml:mover> <mml:mi>⌀</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
with time-varying transcription propensity, <italic>k</italic>(<italic>t</italic>). The translation rate, <italic>k</italic><sub><italic>s</italic></sub>, and the mRNA and protein degradation rates, <italic>k</italic><sub>dm</sub> and <italic>k</italic><sub>dp</sub> respectively, are constant parameters.</p>
<fig id="pcbi.1004923.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004923.g001</object-id>
<label>Fig 1</label>
<caption><title>Comparison of the accuracy of the Extrande and SIA simulation methods.</title>
<p><bold>(A)</bold> <bold>Gene expression with circadian transcription rate</bold>, <italic>k</italic>(<italic>t</italic>)/<italic>k</italic><sub><italic>dp</italic></sub> = 4(1 + sin(2<italic>πft</italic>)), and period <italic>f</italic><sup>−1</sup> = 24h. The proportional root mean square error between the average protein number from the SIA method, 〈<italic>n</italic>(<italic>t</italic>)〉, and the exact, time-dependent solution, <italic>n</italic><sub>ex</sub>(<italic>t</italic>), is shown as a function of the relative frequency of oscillation. The error is given by <inline-formula id="pcbi.1004923.e006"><alternatives><graphic id="pcbi.1004923.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>T</mml:mi> <mml:msubsup><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>ex</mml:mtext> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>T</mml:mi></mml:msubsup> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi> <mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>〈</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mtext>ex</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1004923.e007"><alternatives><graphic id="pcbi.1004923.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:msub><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>ex</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> is the time-average of the exact solution. Physiological parameters for circadian rhythms (CR) in 4 different cell types are indicated. Actual mean protein numbers are varied via the translation rate (<italic>k</italic><sub><italic>s</italic></sub>), holding degradation rates constant. The error is particularly conspicuous (&gt;60%) for <italic>O. tauri</italic> over the whole range of average protein numbers (10–10,000) whereas the exact Extrande method (Inset) accurately predicts the mean protein numbers for this case within sampling error (given by the standard error of the mean, SEM). <bold>(B)</bold> <bold>Gene expression with noisy transcription rate</bold>, <italic>k</italic>(<italic>t</italic>) = 〈exp(<italic>ξ</italic>(<italic>t</italic>)〉<sup>−1</sup>exp(<italic>ξ</italic>(<italic>t</italic>)) where <italic>ξ</italic>(<italic>t</italic>) is zero-mean Gaussian (OU) noise with autocovariance 〈<italic>ξ</italic>(<italic>t</italic>)<italic>ξ</italic>(<italic>t</italic>′)〉 = 5<italic>e</italic><sup>−<italic>γ</italic>|<italic>t</italic>−<italic>t</italic>′|</sup>. We show the proportional error of the stationary average protein number from the SIA method as <italic>γ</italic> varies, with average protein numbers set via <italic>k</italic><sub><italic>s</italic></sub> as in (A). Autocorrelation times of the transcription rate of the order of the cell cycle (CC) are indicated for 4 different cell types. The error is particularly conspicuous (60–90%) for stable proteins removed mainly by dilution, as is common in bacteria (<italic>γ</italic>/<italic>k</italic><sub>dp</sub> = 1), where we show (Inset) simulated average protein numbers for a population of 100 cells. The error bars denote one standard deviation of the bootstrap distribution. <bold>(C)</bold> <bold>Noisy circadian oscillations in an <italic>O</italic>. <italic>tauri</italic> cell population</bold>. Average protein numbers for 2500 cells and 10 days simulated using a circadian transcription rate with cell cycle-induced amplitude fluctuations on a similar timescale: <italic>k</italic>(<italic>t</italic>) = 20exp(<italic>ξ</italic>(<italic>t</italic>))(1 + sin(2<italic>πft</italic>)), where <italic>ξ</italic>(<italic>t</italic>) is zero-mean Gaussian (OU) noise with autocovariance <inline-formula id="pcbi.1004923.e008"><alternatives><graphic id="pcbi.1004923.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo> <mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>8</mml:mn></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mrow><mml:mo>-</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo></mml:mrow> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and <italic>γ</italic>/<italic>k</italic><sub>dp</sub> = <italic>f</italic> ln 2. While Extrande correctly predicts sustained oscillations (blue), the SIA method predicts only damped oscillations (red). Extrande is in excellent agreement with the corresponding moment equations of the master equation (dots, equivalent to ODE solution). Single cell realizations (Inset) reveal the SIA method shows unphysical loss and revival of oscillations. <bold>(D)</bold> <bold>Average behaviour of <italic>O</italic>. <italic>tauri</italic> cells conditional on transcription dynamics</bold>: We pregenerated a single realization (Inset) of the transcription rate, <italic>k</italic>(<italic>t</italic>), used in (C), and averaged over 1,000 resultant protein trajectories (all parameters as in C). The solution of the corresponding SDE for average protein conditional on the trajectory of <italic>k</italic>(<italic>t</italic>) agrees very well with the average from Extrande, in contrast to the SIA method. See <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref> for simulation details and other rate parameters.</p></caption> <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004923.g001" xlink:type="simple"/></fig>
<p>We focus on two important timescales for changes in transcription rates, the circadian 24 hour period [<xref ref-type="bibr" rid="pcbi.1004923.ref036">36</xref>] and the length of the cell cycle [<xref ref-type="bibr" rid="pcbi.1004923.ref023">23</xref>]. For the unicellular alga <italic>O. tauri</italic>, a model organism for circadian rhythms [<xref ref-type="bibr" rid="pcbi.1004923.ref037">37</xref>], the error made by the SIA method (in predicting average expression by a cell population) when the transcription rate follows the circadian sinusoid is conspicuous (&gt;60%) across the entire physiological range of protein abundances—despite there being just 0.008 circadian cycles per protein lifetime (and 0.002 cycles per mRNA lifetime) for this organism (<xref ref-type="fig" rid="pcbi.1004923.g001">Fig 1A</xref>). For processes with stationary, fluctuating transcription rate, the error depends on the correlation time, <italic>γ</italic>, (<xref ref-type="fig" rid="pcbi.1004923.g001">Fig 1B</xref>) which is of the order of cell cycle. Typical parameters in bacteria yield particularly large (60–90%) errors in the mean expression, again across the entire physiological abundance range. We have verified, throughout <xref ref-type="fig" rid="pcbi.1004923.g001">Fig 1A, 1C &amp; 1D</xref>, close agreement of the results generated using Extrande with the corresponding analytical results (derived as in [<xref ref-type="bibr" rid="pcbi.1004923.ref010">10</xref>]; see Fig. C in <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>,). All simulations were performed (for the Extrande, integral and SIA methods) using a modified version of the iNA software [<xref ref-type="bibr" rid="pcbi.1004923.ref038">38</xref>]. We provide an implementation of Extrande and the SIA method reproducing the results of <xref ref-type="fig" rid="pcbi.1004923.g001">Fig 1C</xref> (<xref ref-type="supplementary-material" rid="pcbi.1004923.s001">S1 File</xref>).</p>
<p>The error of the SIA method in <xref ref-type="fig" rid="pcbi.1004923.g001">Fig 1A &amp; 1B</xref> depends non-monotonically on the input frequency. While small errors are expected for extremely slow inputs, the method performs well also for comparably fast inputs and large molecule numbers because the system effectively averages the signal. In the intermediate regime, the error is considerable and the SIA method yields qualitatively misleading results (<xref ref-type="fig" rid="pcbi.1004923.g001">Fig 1C</xref>), predicting damped rather than sustained oscillations of the average protein expression. The damping arises from loss of protein expression in individual cells (inset <xref ref-type="fig" rid="pcbi.1004923.g001">Fig 1C</xref>), which is not always reinstated. We find that SIA error plots in <xref ref-type="fig" rid="pcbi.1004923.g001">Fig 1A</xref> are well explained by the difference between the fractions of time during which protein and mRNA numbers are both zero in the SIA and Extrande simulated trajectories respectively (see Fig. B in <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>). When protein and mRNA numbers are zero or near-zero, the transcription rate fails to update or sluggishly updates under the SIA method, since the value of its input only updates when some reaction channel fires. In the extreme case of zero copy numbers occurring while the true transcription rate is zero, the SIA method gets trapped and simulates no further reactions. We presume this reasoning also explains the misleading damping predicted by SIA for the average protein concentration conditional on a particular trajectory of the transcription rate (<xref ref-type="fig" rid="pcbi.1004923.g001">Fig 1D</xref>), whereas in reality the conditional mean closely follows the input dynamics due to the linearity of the system and its fast dynamics (compared to the circadian timescale).</p>
<p>A SIA algorithm could be considered in which the input is updated on either a predetermined or random grid, with the grid resolution chosen in advance on the basis of the time-scales in the network. Such an algorithm is expected to be computationally demanding for systems in which stiffness arises due to rapidly varying inputs—the grid must be fine to account for this timescale, while the simulation time will have to be long to account for the largest timescale, resulting in a very slow algorithm. By contrast, the performance of the Extrande algorithm is limited only by the firing times of the extra reactions and hence by the quality of the upper bound. It thereby avoids <italic>ad hoc</italic> discretization schemes and the need to experiment with multiple choices of resolution.</p></sec>
<sec id="sec006"><title>The Extrande method can speed up simulation by several orders of magnitude compared to the integral method</title> <p>The Modified Next (MN) integral method has been proposed [<xref ref-type="bibr" rid="pcbi.1004923.ref028">28</xref>] as well-suited to simulation when there are time-varying propensities. We obtained a breakdown (<xref ref-type="fig" rid="pcbi.1004923.g002">Fig 2A</xref>) of the CPU time of Extrande and compared this to the CPU time of the MN integral method (with the same time-step used for integration and for up-front simulation of the input). We use the noisy circadian transcriptional input and network in <xref ref-type="fig" rid="pcbi.1004923.g001">Fig 1D</xref> as an example.</p> <fig id="pcbi.1004923.g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1004923.g002</object-id> <label>Fig 2</label> <caption><title>Comparison of the Extrande and integral methods.</title> <p><bold>(A)</bold> Comparison of CPU times for Extrande and the modified next (MN) integral method [<xref ref-type="bibr" rid="pcbi.1004923.ref028">28</xref>]. CPU times broken down into their constituents (color coded), and shown as a function of the look-ahead horizon, <italic>L</italic>, for Extrande (see also <xref ref-type="boxed-text" rid="pcbi.1004923.box001">Box 1</xref>). Time-step of input presimulation and of integration for the MN method both equal to 10<sup>−6</sup>h. CPU times were collected while simulating the two state model of gene expression with noisy circadian transcription (see <xref ref-type="fig" rid="pcbi.1004923.g001">Fig 1D</xref>) up to <italic>t</italic> = 10 days. <bold>(B)</bold> Percentage of exponential random variables generated in Step 4 of Extrande (<xref ref-type="boxed-text" rid="pcbi.1004923.box001">Box 1</xref>) that are rejected, thinned, and accepted, as a function of <italic>L</italic>. Extrande simulation, network and input as in (A). <bold>(C)</bold> As in (A) but for the SynDM network (<xref ref-type="fig" rid="pcbi.1004923.g003">Fig 3A</xref>) with single OU input presimulated using a time-step of 10<sup>−2</sup>s (and with lifetime 1h, CV 0.5), and integration time-step for the MN method also equal to 10<sup>−2</sup>s. <bold>(D)</bold> Comparison of CPU times (for 10 simulated days) and of percentage errors for Extrande and the MN integral method. Network and input as in <xref ref-type="fig" rid="pcbi.1004923.g001">Fig 1D</xref> (and panels A &amp; B), time-step of input presimulation again equal to 10<sup>−6</sup>h. The absolute value of the percentage error in the integral method’s estimate of the conditional mean is shown in red, both at 6h (crosses) and averaged over the first 24h (compared to Extrande, circles). CPU time for Extrande corresponds to an intermediate value of <italic>L</italic> (in practice, a few of the 1000 cells would be run initially to choose <italic>L</italic>). Throughout Fig 2, we use trapezoidal numerical integration for the MN integral method; the implementation of Extrande uses input presimulation over the look-ahead horizon <italic>L</italic> from which its ceiling value is obtained; and the CPU time for input presimulation is excluded since it is identical for the MN and Extrande methods.</p></caption> <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004923.g002" xlink:type="simple"/></fig> <p>The MN integral method has a CPU time 140 times that of Extrande (with intermediate look-ahead horizon, <italic>L</italic>)—4.6 months, for example, is reduced by Extrande to 1 day (<xref ref-type="fig" rid="pcbi.1004923.g002">Fig 2A</xref>). The source of the improvement is the substantial reduction by Extrande in the CPU time spent on propensity evaluation, which accounts for the vast majority of the total CPU time of the MN integral method. Breakdown of the total CPU time of Extrande reveals that it is dominated by the time spent finding a local ceiling on the input trajectory. This computational cost, however, is more than outweighed by the reduced CPU time spent on propensity evaluation. The total CPU time of Extrande is mostly insensitive to <italic>L</italic>, the fixed look-ahead horizon used (except at smaller values of <italic>L</italic>). Recall that Step 4 of the Extrande algorithm (<xref ref-type="boxed-text" rid="pcbi.1004923.box001">Box 1</xref>) generates exponential random variables (waiting times). Smaller values of <italic>L</italic> are associated (<xref ref-type="fig" rid="pcbi.1004923.g002">Fig 2A &amp; 2B</xref>) with a higher proportion of rejected exponentials, a lower proportion of ‘thinned’ exponentials (those resulting in firing of the extra channel), and higher CPU times incurred in evaluating propensities and drawing exponential random variables (in Steps 3 and 4 of the algorithm). We observe similar behaviour of the CPU times and CPU components of Extrande (see <xref ref-type="fig" rid="pcbi.1004923.g002">Fig 2C</xref> and Fig. D in <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>) for simulation of the synthetic decision-making network studied below—using equal integration and input presimulation time-steps, the MN integral method has a CPU time 25,000 times that of Extrande (with intermediate look-ahead horizon, <italic>L</italic>), with the vast majority of the CPU time for the integral method again spent on propensity evaluation.</p>
<p>We also compared the CPU times and accuracies of the MN integral method to those of Extrande for a range of time-steps of numerical integration (<xref ref-type="fig" rid="pcbi.1004923.g002">Fig 2D</xref>), again using the input and network of <xref ref-type="fig" rid="pcbi.1004923.g001">Fig 1D</xref>. In practice, of course, multiple integration time-steps would require investigation to assess convergence (and there would usually be no analytical result available with which to make comparison). For time-steps giving an absolute relative error &lt;5%, the CPU time for the MN integral method is at least 15 times the CPU time for Extrande, which has the lower relative error. For integration time-steps resulting in equal CPU time for Extrande and the MN integral method, the relative error of the latter is 30% (at the 6h point). We note that the time-step used to presimulate the noisy transcriptional input (10<sup>−6</sup>h) is sufficiently small to ensure an error near 0% for Extrande. We also show (see <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>), again in the context of <xref ref-type="fig" rid="pcbi.1004923.g002">Fig 2A</xref>, that the CPU time of the direct integral method is also expected to exceed the CPU time of Extrande. For the MN integral method, an integration time-step equal to that for input presimulation can in theory be used to again leave only the error associated with input simulation but such integration time-steps can make simulation of the model computationally infeasible (see Fig. D in <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>).</p>
<p>It is clear that the Extrande method offers important advantages compared to integral methods in terms of simulation speed. Furthermore, Extrande avoids the need to assess convergence of estimates as the time-step of integration in decreased. The total reduction in CPU time can be enough to make a previously infeasible simulation project computationally practical. We present results for such a project below (<xref ref-type="fig" rid="pcbi.1004923.g003">Fig 3</xref>) that consumed 2.3 months of computing time using Extrande but we calculate would have taken in excess of 14 years computing time using the integral method. The goal was to simulate the distribution between 2 phenotypes in a population of 1000 bacterial cells responding to stress conditions (at the end of a 20 hour experiment in calendar time). The ‘competence’ networks of interest decide cell fate in a stochastic fashion and have attracted considerable attention, not least as a model of differentiation. However, these networks are regulated by upstream quorum signaling and this regulation has not been studied quantitatively—it turns out to be essential for understanding the wild-type design, not only to model the networks stochastically, but also to allow for fluctuations from the upstream signaling.</p>
<fig id="pcbi.1004923.g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1004923.g003</object-id> <label>Fig 3</label> <caption><title>The effect of extrinsic fluctuations from upstream quorum signaling on the competence decision of <italic>B. subtilis</italic>.</title> <p><bold>(A)</bold> The wild-type signaling (green) and competence (blue) modules. The Synthetic Decision-Making network (SynDM) has the additional positive regulation of ComK by pComA (dashed red arrow). Reaction networks and rate parameters described in detail in the <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>. <bold>(B–D)</bold> Time courses of progress to competence shown for 100 cells containing the wild-type and SynDM networks, simulated using Extrande. In B &amp; D, independent Gaussian, OU input processes for the pComA level in each cell are used, derived from an LNA model of the signaling module (see panel G). In C, pComA is held constant at the LNA mean of 1000 molecules. Progress to competence assumes differentiation proceeds with time-varying rate proportional to the level of ComK (see <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>), with progress equal to 1 corresponding to entry to competence. At time zero, the level of ComS and ComK mRNAs and proteins set to zero. <bold>(E)</bold> For the wild-type and SynDM networks, the percentage change in the fraction of a population of 1000 quorum sensing cells entering competence (within 20 hours) compared to the fraction when pComA is constant at 1000 molecules, as a function of the lifetime and CV of the OU input modeling pComA fluctuations. The limit with pComA constant in each cell is also shown, drawn from a Gaussian distribution with mean 1000 and the indicated CV. <bold>(F)</bold> For the wild-type and SynDM networks, the estimated Prob[Competence|〈pComA〉] as a function of 〈pComA〉, the time-averaged level of pComA over the 20h experiment, for different OU inputs modeling pComA fluctuations. Estimation performed using logistic regression. <bold>(G)</bold> For the wild-type and SynDM networks, the fraction of a population of 1000 quorum sensing cells entering competence as a function of the proportionality constant of ComK-driven differentiation, for different OU inputs modeling pComA fluctuations (lifetime of 28s corresponds to model of upstream signaling lacking gene expression of the component proteins). <bold>(H)</bold> The autocorrelation function of pComA given by the LNA model of upstream signaling, compared to that of a single OU input process and 2 summed, independent OU processes, both having the mean and variance of pComA given by the LNA.</p></caption> <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004923.g003" xlink:type="simple"/></fig>
</sec>
</sec>
<sec id="sec007">
<title>Robustness to extrinsic fluctuations from upstream signaling constrains the design of cell fate networks</title>
<p>We study the decision to enter competence (for uptake of extracellular DNA) by the model organism <italic>Bacillus subtilis.</italic> It is well established [<xref ref-type="bibr" rid="pcbi.1004923.ref039">39</xref>–<xref ref-type="bibr" rid="pcbi.1004923.ref041">41</xref>] that the source of differentiation of 10–20% of the cell population under stress conditions is fluctuations in transcription of the master competence regulator, ComK. The ComS-MecA-ComK competence module is regulated by the activated transcription factor pComA, the output of the transduction mechanism relaying extracellular, quorum sensing signals (CSF and ComX), see <xref ref-type="fig" rid="pcbi.1004923.g003">Fig 3A</xref>. We study the effect of this upstream signaling on differentiation into the competent phenotype.</p>
<p>A useful approach to understanding the structure-function relationship in systems biology is to rewire networks found in nature and compare function with the wild-type, which can then shed light on why apparently similar network structures were not adopted naturally [<xref ref-type="bibr" rid="pcbi.1004923.ref042">42</xref>]. In the wild-type, upstream signaling acts via activation of the <italic>ComS promoter</italic> by pComA binding (<xref ref-type="fig" rid="pcbi.1004923.g003">Fig 3A</xref>, thick black arrow). We compare the behaviour of wild-type cells to those with a Synthetic Decision-Making network (SynDM) which is regulated, in addition, via activation of the <italic>ComK</italic> <italic>promoter</italic> by pComA binding (red dashed arrow). We model ComK-driven progress and entry into functional competence, and write <inline-formula id="pcbi.1004923.e009"><alternatives><graphic id="pcbi.1004923.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:mtext>Progress</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>k</mml:mi> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup> <mml:mtext>ComK</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>k</italic> is an effective rate of ComK-driven differentiation. A cell is taken to enter (functional) competence at the time when Progress(<italic>t</italic>) = 1. The value of the parameter <italic>k</italic> is set so that the wild-type and SynDM networks give equal fractions of competent cells with a constant level of pComA (1000 molecules). We tune rate parameters associated with the ComK promoter of the SynDM network so that the fraction of SynDM cells entering competence (0.18) is the same as for wild-type cells, in the absence of fluctuations in pComA levels (see <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>). A table listing all reactions and parameter values used in our models of the competence module of wild-type <italic>B. subtilis</italic> and the SynDM networks is given in the <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>.</p>
<p>We use the linear noise approximation (LNA) [<xref ref-type="bibr" rid="pcbi.1004923.ref043">43</xref>] to model the the upstream signaling (with CSF and ComX fixed at steady-state levels), giving a mean for pComA of 1000 molecules throughout. Importantly, we include in the model gene expression and degradation of the proteins comprising the signal transduction mechanism because it is now understood that the resultant variation has important effects on signaling and information transfer [<xref ref-type="bibr" rid="pcbi.1004923.ref026">26</xref>]. A single Ornstein-Uhlenbeck (OU) process is sufficient to closely match the mean, variance and autocorrelation function of pComA given by the LNA (see <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>). We therefore use a single OU process for the pComA input in what follows. A range of protein lifetimes is considered, consistent with the broad range of cell-cycle periods observed for bacteria under different growth conditions [<xref ref-type="bibr" rid="pcbi.1004923.ref044">44</xref>], where nutrient limitation can result in periods in excess of 10h. Our baseline LNA model of the upstream signaling module gives a lifetime and CV of pComA fluctuations equal to 5h and 0.35. We take the pComA input to be exogenous to the ComS-MecA-ComK competence module since it is in high abundance relative to the 2 promoters it binds (the only interaction between the two modules).</p>
<p>The importance in determining cell fate of the time taken for the cell to complete different differentiation programs (to the point of irreversible commitment) has recently been emphasised [<xref ref-type="bibr" rid="pcbi.1004923.ref045">45</xref>]. The SynDM network creates a differentiated sub-population by activating the differentiation program in most or all of the cell population (<xref ref-type="fig" rid="pcbi.1004923.g003">Fig 3C &amp; 3D</xref>), with entry to competence the outcome of a ‘race’ to differentiate over the relevant time window. In the SynDM network, binding of pComA to the ComK promoter results more often in periods of non-zero ComK expression than in the wild-type population, but when such periods occur, they are less sustained (see <xref ref-type="fig" rid="pcbi.1004923.g003">Fig 3B–3D</xref>, and Fig. E in <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>). The typical rate of progress of a SynDM cell to competence is increased by a higher level of pComA (see Fig. E in <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>), and extrinsic fluctuations in the pComA level therefore affect the fraction of cells entering competence (<xref ref-type="fig" rid="pcbi.1004923.g003">Fig 3C &amp; 3D</xref>). In contrast, the wild-type activates the differentiation program in a smaller sub-population, the size of which is under modest regulation by pComA (<xref ref-type="fig" rid="pcbi.1004923.g003">Fig 3F</xref>)—a high proportion of the active wild-type cells then enter competence because, once activated, ComK expression rarely deactivates in the wild-type (see <xref ref-type="fig" rid="pcbi.1004923.g003">Fig 3B</xref>, and Fig. E in <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>).</p>
<p>We find two important advantages of the wild-type design (in addition to the implied reduction in the metabolic cost of gene expression). First, the fraction of cells entering competence is considerably more robust to the fluctuations from upstream signaling in pComA (<xref ref-type="fig" rid="pcbi.1004923.g003">Fig 3E</xref>). For example, with the baseline model of upstream signaling, the SynDM network has a competent fraction (40%) which is more than 2.25 times the competent fraction when pComA is held constant at its mean level, whereas the competent fraction of wild-type cells (17% cf 18%) has changed very little. The difference in robustness is explained by the sensitivity of the probability of competence for a SynDM cell as a function of the time average of the signal, 〈pComA〉, which switches quite rapidly from zero to one (<xref ref-type="fig" rid="pcbi.1004923.g003">Fig 3F</xref>). Since the fraction of competent cells is equal to the average of Prob[Competence|〈pComA〉] over the distribution of 〈pComA〉 (which is approximately the distribution of pComA for longer lifetimes), the competent fraction <italic>increases</italic> in the presence of extrinsic fluctuations for SynDM (recall the mean of pComA is 1000 molecules). In contrast, Prob[Competence|〈pComA〉] is approximately linear for the wild-type network, which implies that the competent fraction depends largely on the mean of pComA alone. Such plots (<xref ref-type="fig" rid="pcbi.1004923.g003">Fig 3F</xref>) should prove a useful diagnostic tool for the design of synthetic decision-making networks.</p>
<p>The second advantage of the wild-type design is that the fraction of cells entering competence is also considerably more robust than SynDM to heterogeneity across the cell population in the rate at which ComK-driven differentation proceeds (<xref ref-type="fig" rid="pcbi.1004923.g003">Fig 3G</xref>). The reason is evident from the progress to competence trajectories in <xref ref-type="fig" rid="pcbi.1004923.g003">Fig 3B–3D</xref>. We note that fluctuations from upstream signaling in pComA can also cause decreases in the fraction of competent SynDM cells, as seen for higher rates of differentiation (<xref ref-type="fig" rid="pcbi.1004923.g003">Fig 3G</xref>). Heterogeneity in the rate at which differentiation programs proceed is inevitable where cellular decisions are executed by large gene expression networks and involve substantial physiological changes [<xref ref-type="bibr" rid="pcbi.1004923.ref046">46</xref>].</p>
<p>These <italic>in silico</italic> experiments (<xref ref-type="fig" rid="pcbi.1004923.g003">Fig 3</xref>), made computationally feasible by Extrande, cast light on the wild-type network design in which quorum signaling input to the competence decision-making network (ComS-MecA-ComK) by the transcription factor pComA exerts its effect only at the promoter of ComS and not at the promoter of ComK. The experiments reveal exquisite robustness of the wild-type design to fluctuations from upstream signaling and to heterogeneity in downstream processes, and demonstrate the computational potential of Extrande for <italic>in silico</italic> network design.</p>
</sec>
</sec>
<sec id="sec008" sec-type="conclusions">
<title>Discussion</title>
<p>Stochastic simulation of biomolecular networks is now indispensable for studying biological systems, from small reaction networks to large ensembles of cells. The effects of stochasticity can be pervasive at the single-cell level, determining the distribution of phenotypes in a population and thus potentially affecting evolutionary outcomes. However, studying such phenomena requires stochastic simulation of a large ensemble of cells that can take into account both intrinsic and extrinsic sources of cellular variation. This can be hugely costly in terms of CPU time, placing important <italic>in silico</italic> experiments out of reach. Here we provide the new Extrande approach—for stochastic simulation of a biomolecular network embedded in the dynamic environment of the cell and its surroundings—which substantially increases the computational feasibility of such experiments without compromising accuracy.</p>
<p>We show that previous approaches to this problem either can fail dramatically, even when inputs vary relatively slowly, or impose impractical computational burdens due to costly numerical integration of reaction propensities. Given a simulated trajectory of fluctuating network inputs, the Extrande approach provides a conditionally exact solution that can speed up simulation by several orders of magnitude compared to integral methods. In practice, we find that integral methods suffer from the high cost of propensity evaluations during numerical integration. Extrande bypasses numerical integration by introducing an extra reaction channel—one designed to keep the total propensity of the ‘augmented’ system constant between events—hence making the problem of finding the time to the next event analytically tractable. Importantly, our numerical results demonstrate that the overhead costs induced by the Extrande method—for example, due to thinning and rejection events, and due to obtaining the ceiling of the input process when a global ceiling is not available–are significantly lower than the cost of accurate numerical integration. In practice, we observe speed-ups by a factor as great as 2.5×10<sup>4</sup> (<xref ref-type="fig" rid="pcbi.1004923.g002">Fig 2C</xref>).</p>
<p>Recent work [<xref ref-type="bibr" rid="pcbi.1004923.ref012">12</xref>] proposes to handle fluctuating environments in a different manner, by deriving a network model for the biochemistry that takes account of the dynamic input and follows the correct (marginal) probability law. Explicit simulation of the input is bypassed. The resultant ‘uncoupled’ network model has time-varying reaction propensities and can then be simulated using integral or thinning methods. However, analytical derivation of the uncoupled network model is not always possible, particularly when there are multiple inputs. The accuracy of the method then depends on finding suitable approximation schemes.</p>
<p>There are two main limitations of modelling using the Extrande method. The first is that Extrande, being a method of obtaining trajectories of the chemical master equation (with time-dependent propensities), has the same applicability limitations as the master equation; namely there is an implicit assumption that the system is dilute (point particles) and well-mixed, conditions which are not met when molecular crowding is significant [<xref ref-type="bibr" rid="pcbi.1004923.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1004923.ref048">48</xref>]. The second limitation is that Extrande assumes that the inputs influence the system of interest but the latter does not influence the inputs (which implies the inputs can be pre-simulated). Hence the method is useful, for example, to understand how certain external stimuli such as light and temperature can affect the stochastic dynamics of a system. For the case of a chemical stimulus, the method can provide an accurate description of the stochastic dynamics if the system and its output do not significantly feedback to adjust the original chemical stimulus, for example by a regulatory mechanism.</p>
<p>We exploit the benefits of the proposed Extrande simulation method here to study the decision-making behaviour of a quorum sensing population of bacterial cells. The <italic>in silico</italic> experiments presented (<xref ref-type="fig" rid="pcbi.1004923.g003">Fig 3</xref>) took approximately two computing months using Extrande (and an Intel Xeon, 3.3GHz quad-core processor with 32GB of RAM), but would have been prohibitive using the integral method due to the approximate 70-fold slow down needed to ensure even modest accuracy (see Fig. D in <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>). The results elucidate the costs and benefits of alternative network designs for the probabilistic differentiation of a sub-population of cells in response to upstream signaling. Our findings argue for the biological significance of fluctuations in signaling inputs that arise from synthesis and degradation of the protein componentry of signal transduction networks, and show that these fluctuations have important consequences for downstream networks such as those deciding cell fate. We expect the accuracy and reductions in CPU time made possible by Extrande to help open up the landscape of computationally feasible simulation of biomolecular networks and cell ensembles. Extrande thus has the potential to accelerate both understanding of molecular systems biology and the design of synthetic networks.</p>
</sec>
<sec id="sec009" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec010">
<title>Validity of the Extrande approach</title>
<p>The Extrande approach relies on augmenting the reaction network with an extra, ‘virtual’ channel (giving the augmented system, <italic>Z</italic>), so as to make simulation of the augmented system feasible, while ensuring that the simulated timings and types of biochemical reactions are unaffected by the firings of the extra channel. In the Extrande method, the conditional propensity of the extra channel depends on the history of the extra channel (as well as on the history of the original system, <inline-formula id="pcbi.1004923.e010"><alternatives><graphic id="pcbi.1004923.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msubsup><mml:mi mathvariant="script">H</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>X</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>), and so does the upper bound. A related Proposition in [<xref ref-type="bibr" rid="pcbi.1004923.ref032">32</xref>] does not allow for this dependence (see <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>). We therefore provide the new proof below. To see the dependence on the extra channel, note that the bound is in general updated in Step 3 of the Extrande algorithm (<xref ref-type="boxed-text" rid="pcbi.1004923.box001">Box 1</xref>) after each firing of the extra channel.</p>
<p>The reaction network to be simulated (<xref ref-type="boxed-text" rid="pcbi.1004923.box001">Box 1</xref>) has the number of molecules of each species at time <italic>t</italic> given by
<disp-formula id="pcbi.1004923.e011"><alternatives><graphic id="pcbi.1004923.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>X</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>X</mml:mi> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mi>S</mml:mi> <mml:mi>R</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>R</italic>(<italic>t</italic>) = {<italic>R</italic><sub>1</sub>(<italic>t</italic>), …, <italic>R</italic><sub><italic>M</italic></sub>(<italic>t</italic>)} is the vector of processes counting the number of times each biochemical reaction channel fires during the time interval [0, <italic>t</italic>], and <italic>S</italic> = {<italic>v</italic><sub>1</sub>, …, <italic>v</italic><sub><italic>M</italic></sub>} is the stoichiometric matrix. The ‘Poisson’ or random time-change representation [<xref ref-type="bibr" rid="pcbi.1004923.ref049">49</xref>] expresses <italic>R</italic>(<italic>t</italic>) in terms of <italic>M</italic> independent, unit rate Poisson processes, <italic>Y</italic>(<italic>t</italic>) = {<italic>Y</italic><sub>1</sub>(<italic>t</italic>), …, <italic>Y</italic><sub><italic>M</italic></sub>(<italic>t</italic>)}, and so can be written here as
<disp-formula id="pcbi.1004923.e012"><alternatives><graphic id="pcbi.1004923.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>X</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>X</mml:mi> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>S</mml:mi> <mml:msup><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:msub><mml:mi>Y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mi>a</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>s</mml:mi></mml:mfenced> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>M</mml:mi></mml:msub> <mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mi>a</mml:mi> <mml:mi>M</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>s</mml:mi></mml:mfenced></mml:mfenced></mml:mrow> <mml:mi mathvariant="normal">T</mml:mi></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>I</italic> is the possibly multivariate input, superscript T denotes transpose of a vector, and <italic>a</italic><sub><italic>j</italic></sub>[<italic>X</italic>(<italic>s</italic>), <italic>I</italic>(<italic>s</italic>)] is the propensity of the <italic>j</italic>th reaction, for <italic>j</italic> = 1, …, <italic>M</italic>, conditional on <inline-formula id="pcbi.1004923.e013"><alternatives><graphic id="pcbi.1004923.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi mathvariant="script">H</mml:mi> <mml:mrow><mml:mi>s</mml:mi></mml:mrow> <mml:mi>X</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">I</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. We denote by <inline-formula id="pcbi.1004923.e014"><alternatives><graphic id="pcbi.1004923.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mi mathvariant="script">I</mml:mi></mml:math></alternatives></inline-formula> (the <italic>σ</italic>-field generated by) the entire trajectory of the input.</p>
<p>We introduce as a simulation device the extra, virtual reaction <italic>R</italic><sub><italic>M</italic>+1</sub>: ∅ → ∅, to form the <italic>augmented system</italic> <disp-formula id="pcbi.1004923.e015"><alternatives><graphic id="pcbi.1004923.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Z</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>X</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:mo>=</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>X</mml:mi> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:mo>+</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mi>S</mml:mi></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:mfenced close=")" open="(" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>R</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
The random time-change representation of the augmented system is in terms of (<italic>M</italic>+1) independent, unit rate Poisson processes, <italic>Y</italic>(<italic>t</italic>) = {<italic>Y</italic><sub>1</sub>(<italic>t</italic>), …, <italic>Y</italic><sub><italic>M</italic>+1</sub>(<italic>t</italic>)}
<disp-formula id="pcbi.1004923.e016"><alternatives><graphic id="pcbi.1004923.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>Z</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>Z</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo stretchy="false">)</mml:mo> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>S</mml:mi></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mn>…</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup> <mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mstyle> <mml:mo stretchy="false">[</mml:mo> <mml:mi>X</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>s</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>s</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">]</mml:mo> <mml:mi>d</mml:mi> <mml:mi>s</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mn>…</mml:mn></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup> <mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle> <mml:mo stretchy="false">(</mml:mo> <mml:mi>s</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mi>d</mml:mi> <mml:mi>s</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where <italic>a</italic><sub><italic>M</italic>+1</sub>(<italic>s</italic>) is the propensity of the extra reaction channel (conditional on <inline-formula id="pcbi.1004923.e017"><alternatives><graphic id="pcbi.1004923.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>H</mml:mi> <mml:mi>s</mml:mi> <mml:mi>Z</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">I</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>), and where we set <italic>a<sub>j</sub></italic>[<italic>X</italic>(<italic>s</italic>), <italic>I</italic>(<italic>s</italic>)], for <italic>j</italic> = 1, …, <italic>M</italic>, as the propensity of the <italic>j</italic>th reaction conditional on <inline-formula id="pcbi.1004923.e018"><alternatives><graphic id="pcbi.1004923.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>H</mml:mi> <mml:mi>s</mml:mi> <mml:mi>Z</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">I</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, which now includes the history of the extra channel, <italic>R</italic><sub><italic>M</italic>+1</sub>.</p>
<p>Notice that <xref ref-type="disp-formula" rid="pcbi.1004923.e016">Eq 2</xref> is identical to <xref ref-type="disp-formula" rid="pcbi.1004923.e012">Eq 1</xref> in its expression of the original system, <italic>X</italic>(<italic>t</italic>), or equivalently of <italic>R</italic>(<italic>t</italic>). Therefore, if the propensity <italic>a</italic><sub><italic>M</italic>+1</sub> is chosen to somehow make simulation of [<italic>R</italic>(<italic>t</italic>), <italic>R</italic><sub><italic>M</italic>+1</sub>(<italic>t</italic>)] straightforward, we are able to simulate our target, <italic>R</italic>(<italic>t</italic>), by simulating the augmented system in <xref ref-type="disp-formula" rid="pcbi.1004923.e016">Eq 2</xref> and then ignoring <italic>R</italic><sub><italic>M</italic>+1</sub>(<italic>t</italic>). To do this, let <italic>B</italic>(<italic>t</italic>) be an <inline-formula id="pcbi.1004923.e019"><alternatives><graphic id="pcbi.1004923.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi mathvariant="script">H</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>Z</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">I</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>-measurable random variable satisfying (with probability 1) that
<disp-formula id="pcbi.1004923.e020"><alternatives><graphic id="pcbi.1004923.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msub><mml:mi>a</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>≤</mml:mo> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="4.pt"/><mml:mi>t</mml:mi> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
so that <italic>B</italic>(<italic>t</italic>) is a stochastic upper bound for the total biochemical reaction propensity. Now define the propensity of the extra channel (conditional on <inline-formula id="pcbi.1004923.e021"><alternatives><graphic id="pcbi.1004923.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>Z</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">I</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>) as:
<disp-formula id="pcbi.1004923.e022"><alternatives><graphic id="pcbi.1004923.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>The ground process (see <xref ref-type="supplementary-material" rid="pcbi.1004923.s002">S1 Text</xref>) of [<italic>R</italic>(<italic>t</italic>), <italic>R</italic><sub><italic>M</italic>+1</sub>(<italic>t</italic>)] has propensity (conditional on <inline-formula id="pcbi.1004923.e023"><alternatives><graphic id="pcbi.1004923.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi mathvariant="script">H</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>Z</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">I</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>) given by <inline-formula id="pcbi.1004923.e024"><alternatives><graphic id="pcbi.1004923.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msub><mml:mi>a</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> by construction. The Extrande method chooses the stochastic bound, <italic>B</italic>(<italic>t</italic>), so that it is constant between firings of the augmented system (see <xref ref-type="boxed-text" rid="pcbi.1004923.box001">Box 1</xref>), which makes straightforward the simulation of the ground process of [<italic>R</italic>(<italic>t</italic>), <italic>R</italic><sub><italic>M</italic>+1</sub>(<italic>t</italic>)]. We write the <italic>i</italic>th occurrence time of the ground process of [<italic>R</italic>(<italic>t</italic>), <italic>R</italic><sub><italic>M</italic>+1</sub>(<italic>t</italic>)] as <italic>T</italic><sub><italic>i</italic></sub>, <italic>i</italic> = 1, 2, … It is now the case that
<disp-formula id="pcbi.1004923.e025"><alternatives><graphic id="pcbi.1004923.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Prob</mml:mtext> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>≤</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">I</mml:mi> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>Z</italic><sub><italic>i</italic></sub> is the channel corresponding to the <italic>i</italic>th firing. The waiting time has an exponential distribution and the occurrence times {<italic>T</italic><sub>1</sub>, <italic>T</italic><sub>2</sub>, …} are therefore just those of a <inline-formula id="pcbi.1004923.e026"><alternatives><graphic id="pcbi.1004923.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi mathvariant="script">H</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>Z</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">I</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>-Poisson process with propensity <italic>B</italic>(<italic>t</italic>), and can be simulated analogously to the SSA as in Step 4 of <xref ref-type="boxed-text" rid="pcbi.1004923.box001">Box 1</xref>.</p>
<p>What remains is to assign each firing time <italic>T</italic><sub><italic>i</italic></sub> to one of the (<italic>M</italic>+1) channels of the augmented system. We do the allocation sequentially, using the result from counting process theory [<xref ref-type="bibr" rid="pcbi.1004923.ref050">50</xref>] that, for <italic>j</italic> = 1, …, (<italic>M</italic>+1):
<disp-formula id="pcbi.1004923.e027"><alternatives><graphic id="pcbi.1004923.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Prob</mml:mtext> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>j</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">I</mml:mi> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>B</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where we have used the left-continuous versions <inline-formula id="pcbi.1004923.e028"><alternatives><graphic id="pcbi.1004923.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of (<italic>X</italic>(<italic>t</italic>), <italic>I</italic>(<italic>t</italic>)), and <inline-formula id="pcbi.1004923.e029"><alternatives><graphic id="pcbi.1004923.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:mover accent="true"><mml:mi>B</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>B</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. <xref ref-type="disp-formula" rid="pcbi.1004923.e027">Eq 3</xref> is implemented by Steps 9–15 in <xref ref-type="boxed-text" rid="pcbi.1004923.box001">Box 1</xref>. The intuition for <xref ref-type="disp-formula" rid="pcbi.1004923.e027">Eq 3</xref> uses Bayes’ theorem. Consider a small interval of time <italic>dt</italic>. The probability that the channel is the <italic>j</italic>th one given that some reaction fires at time <italic>T</italic><sub><italic>i</italic>+1</sub>, since the probability of more than one reaction can be neglected, is given by <inline-formula id="pcbi.1004923.e030"><alternatives><graphic id="pcbi.1004923.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>·</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>·</mml:mo> <mml:msubsup><mml:mrow/><mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>∑</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> The target of the Extrande simulation, <italic>R</italic>(<italic>t</italic>), is now obtained by ignoring all the firing times of the extra channel after simulation of the augmented system is complete. This completes the proof. <inline-formula id="pcbi.1004923.e031"><alternatives><graphic id="pcbi.1004923.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mo>■</mml:mo></mml:math></alternatives></inline-formula></p>
<p>We note that the condition lim<sub><italic>t</italic> → ∞</sub> <italic>R</italic><sub><italic>j</italic></sub>(<italic>t</italic>) = ∞ (<italic>j</italic> = 1, …, <italic>M</italic>) is needed for the representation in <xref ref-type="disp-formula" rid="pcbi.1004923.e012">Eq 1</xref>, but is not needed for the validity of the Extrande method. The random time-change representation is used here to make the proof more accessible. The Extrande algorithm results in a probability law, <italic>P</italic>, under which the functions <italic>a</italic><sub><italic>j</italic></sub>[<italic>X</italic>(<italic>t</italic>), <italic>I</italic>(<italic>t</italic>)] give the propensities of the biochemical reactions conditional upon <inline-formula id="pcbi.1004923.e032"><alternatives><graphic id="pcbi.1004923.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi mathvariant="script">H</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>Z</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">I</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Because the <italic>a</italic><sub><italic>j</italic></sub>[<italic>X</italic>(<italic>t</italic>), <italic>I</italic>(<italic>t</italic>)] are <inline-formula id="pcbi.1004923.e033"><alternatives><graphic id="pcbi.1004923.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi mathvariant="script">H</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>X</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">I</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>-measurable, they also give the <inline-formula id="pcbi.1004923.e034"><alternatives><graphic id="pcbi.1004923.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi mathvariant="script">H</mml:mi> <mml:mrow><mml:mi>t</mml:mi></mml:mrow> <mml:mi>X</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">I</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>-conditional propensities of the biochemical reactions under <italic>P</italic>, as required of the probability measure <italic>P</italic> resulting from the Extrande algorithm.</p>
<p>Finally, we remark that a description equivalent to the random time-change representation, <xref ref-type="disp-formula" rid="pcbi.1004923.e012">Eq 1</xref>, is the Chemical Master Equation [<xref ref-type="bibr" rid="pcbi.1004923.ref049">49</xref>]. Specifically, for the conditional probability <inline-formula id="pcbi.1004923.e035"><alternatives><graphic id="pcbi.1004923.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mtext>Prob</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>n</mml:mi> <mml:mo>|</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>;</mml:mo> <mml:mi mathvariant="script">I</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> one can write
<disp-formula id="pcbi.1004923.e036"><alternatives><graphic id="pcbi.1004923.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004923.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:mfenced close="]" open="[" separators=""><mml:msub><mml:mi>a</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
whose propensities are time-varying, stochastic functions due to the dependence on the input process.</p>
</sec>
</sec>
<sec id="sec011">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004923.s001" mimetype="application/mathematica" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004923.s001" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>An extensible, Mathematica implementation of the Extrande algorithm.</title>
<p>(NB)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004923.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004923.s002" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supporting Information.</title>
<p>Stochastic Simulation of Biomolecular Networks in Dynamic Environments.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1004923.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Karr</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Sanghvi</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Macklin</surname> <given-names>DN</given-names></name>, <name name-style="western"><surname>Gutschow</surname> <given-names>MV</given-names></name>, <name name-style="western"><surname>Jacobs</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Bolival</surname> <given-names>B</given-names> <suffix>Jr</suffix></name>, <etal>et al</etal>. <article-title>A Whole-Cell Computational Model Predicts Phenotype from Genotype</article-title>. <source>Cell</source>. <year>2012</year>;<volume>150</volume>:<fpage>389</fpage>–<lpage>401</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2012.05.044" xlink:type="simple">10.1016/j.cell.2012.05.044</ext-link></comment> <object-id pub-id-type="pmid">22817898</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Eldar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Elowitz</surname> <given-names>MB</given-names></name>. <article-title>Functional roles for noise in genetic circuits</article-title>. <source>Nature</source>. <year>2010</year>;<volume>467</volume>:<fpage>167</fpage>–<lpage>173</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature09326" xlink:type="simple">10.1038/nature09326</ext-link></comment> <object-id pub-id-type="pmid">20829787</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thomas</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Popović</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Grima</surname> <given-names>R</given-names></name>. <article-title>Phenotypic switching in gene regulatory networks</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2014</year>;<volume>111</volume>(<issue>19</issue>):<fpage>6994</fpage>–<lpage>6999</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1400049111" xlink:type="simple">10.1073/pnas.1400049111</ext-link></comment> <object-id pub-id-type="pmid">24782538</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Crampin</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>Halstead</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hunter</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Nielsen</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Noble</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Computational physiology and the physiome project</article-title>. <source>Exp Physiol</source>. <year>2004</year>;<volume>89</volume>:<fpage>1</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1113/expphysiol.2003.026740" xlink:type="simple">10.1113/expphysiol.2003.026740</ext-link></comment> <object-id pub-id-type="pmid">15109205</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rand</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Rinas</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Schwerk</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Nohren</surname> <given-names>GN</given-names></name>, <name name-style="western"><surname>Linnes</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kroger</surname> <given-names>AK</given-names></name>, <etal>et al</etal>. <article-title>Multi-layered stochasticity and paracrine signal propagation shape the type-I interferon response</article-title>. <source>Mol Syst Biol</source>. <year>2012</year>;<volume>8</volume>:<fpage>1</fpage>–<lpage>13</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb.2012.17" xlink:type="simple">10.1038/msb.2012.17</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hartwell</surname> <given-names>LH</given-names></name>, <name name-style="western"><surname>Hopfield</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Leibler</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>AW</given-names></name>. <article-title>From molecular to modular cell biology</article-title>. <source>Nature</source>. <year>1999</year>;<volume>402</volume>:<fpage>C47</fpage>–<lpage>52</lpage>.<object-id pub-id-type="pmid">10591225</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sontag</surname> <given-names>ED</given-names></name>. <article-title>Monotone and near-monotone biochemical networks</article-title>. <source>Syst Synth Biol</source>. <year>2007</year>;<volume>1</volume>:<fpage>59</fpage>–<lpage>87</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s11693-007-9005-9" xlink:type="simple">10.1007/s11693-007-9005-9</ext-link></comment> <object-id pub-id-type="pmid">19003437</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thomas</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Straube</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>Grima</surname> <given-names>R</given-names></name>. <article-title>The slow-scale linear noise approximation: an accurate, reduced stochastic description of biochemical networks under timescale separation conditions</article-title>. <source>BMC Syst Biol</source>. <year>2012</year>;<volume>6</volume>(<issue>1</issue>):<fpage>39</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1752-0509-6-39" xlink:type="simple">10.1186/1752-0509-6-39</ext-link></comment> <object-id pub-id-type="pmid">22583770</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref009">
<label>9</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name>. <source>Biophysics: searching for principles</source>. <publisher-loc>Princeton, New Jersey</publisher-loc>: <publisher-name>Princeton University Press</publisher-name>; <year>2013</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004923.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bowsher</surname> <given-names>CG</given-names></name>, <name name-style="western"><surname>Voliotis</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Swain</surname> <given-names>PS</given-names></name>. <article-title>The fidelity of dynamic signaling by noisy biomolecular networks</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year>;<volume>9</volume>:<fpage>e1002965</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002965" xlink:type="simple">10.1371/journal.pcbi.1002965</ext-link></comment> <object-id pub-id-type="pmid">23555208</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bowsher</surname> <given-names>CG</given-names></name>, <name name-style="western"><surname>Swain</surname> <given-names>PS</given-names></name>. <article-title>Environmental sensing, information transfer, and cellular decision-making</article-title>. <source>Curr Opin Biotechnol</source>. <year>2014</year>;<volume>28</volume>:<fpage>149</fpage>–<lpage>155</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.copbio.2014.04.010" xlink:type="simple">10.1016/j.copbio.2014.04.010</ext-link></comment> <object-id pub-id-type="pmid">24846821</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zechner</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Koeppl</surname> <given-names>H</given-names></name>. <article-title>Uncoupled Analysis of Stochastic Reaction Networks in Fluctuating Environments</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>(<issue>12</issue>):<fpage>e1003942</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003942" xlink:type="simple">10.1371/journal.pcbi.1003942</ext-link></comment> <object-id pub-id-type="pmid">25473849</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gillespie</surname> <given-names>DT</given-names></name>. <article-title>A general method for numerically simulating the stochastic time evolution of coupled chemical reactions</article-title>. <source>J Comp Phys</source>. <year>1976</year>;<volume>22</volume>:<fpage>403</fpage>–<lpage>434</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0021-9991(76)90041-3" xlink:type="simple">10.1016/0021-9991(76)90041-3</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gillespie</surname> <given-names>DT</given-names></name>. <article-title>Exact stochastic simulation of coupled chemical reactions</article-title>. <source>J Phys Chem</source>. <year>1977</year>;<volume>81</volume>:<fpage>2340</fpage>–<lpage>2361</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/j100540a008" xlink:type="simple">10.1021/j100540a008</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Swain</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Elowitz</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Siggia</surname> <given-names>ED</given-names></name>. <article-title>Intrinsic and extrinsic contributions to stochasticity in gene expression</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2002</year>;<volume>99</volume>:<fpage>12795</fpage>–<lpage>12800</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.162041399" xlink:type="simple">10.1073/pnas.162041399</ext-link></comment> <object-id pub-id-type="pmid">12237400</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hilfinger</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Paulsson</surname> <given-names>J</given-names></name>. <article-title>Separating intrinsic from extrinsic fluctuations in dynamic biological systems</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2011</year>;<volume>108</volume>:<fpage>12167</fpage>–<lpage>12172</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1018832108" xlink:type="simple">10.1073/pnas.1018832108</ext-link></comment> <object-id pub-id-type="pmid">21730172</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bowsher</surname> <given-names>CG</given-names></name>, <name name-style="western"><surname>Swain</surname> <given-names>PS</given-names></name>. <article-title>Identifying sources of variation and the flow of information in biochemical networks</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2012</year>;<volume>109</volume>:<fpage>E1320</fpage>–<lpage>E1328</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1119407109" xlink:type="simple">10.1073/pnas.1119407109</ext-link></comment> <object-id pub-id-type="pmid">22529351</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Elowitz</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Levine</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Siggia</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Swain</surname> <given-names>PS</given-names></name>. <article-title>Stochastic gene expression in a single cell</article-title>. <source>Science</source>. <year>2002</year>;<volume>297</volume>:<fpage>1183</fpage>–<lpage>1186</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1070919" xlink:type="simple">10.1126/science.1070919</ext-link></comment> <object-id pub-id-type="pmid">12183631</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Raser</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>O’Shea</surname> <given-names>EK</given-names></name>. <article-title>Control of stochasticity in eukaryotic gene expression</article-title>. <source>Science</source>. <year>2004</year>;<volume>304</volume>:<fpage>1811</fpage>–<lpage>1814</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1098641" xlink:type="simple">10.1126/science.1098641</ext-link></comment> <object-id pub-id-type="pmid">15166317</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rosenfeld</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Young</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Alon</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Swain</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Elowitz</surname> <given-names>MB</given-names></name>. <article-title>Gene regulation at the single-cell level</article-title>. <source>Science</source>. <year>2005</year>;<volume>307</volume>:<fpage>1962</fpage>–<lpage>1965</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1106914" xlink:type="simple">10.1126/science.1106914</ext-link></comment> <object-id pub-id-type="pmid">15790856</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zechner</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Unger</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pelet</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Peter</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Koeppl</surname> <given-names>H</given-names></name>. <article-title>Scalable inference of heterogeneous reaction kinetics from pooled single-cell recordings</article-title>. <source>Nat Methods</source>. <year>2014</year>;<volume>11</volume>:<fpage>197</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2794" xlink:type="simple">10.1038/nmeth.2794</ext-link></comment> <object-id pub-id-type="pmid">24412977</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Das Neves</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>NS</given-names></name>, <name name-style="western"><surname>Andreu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Gupta</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Enver</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Iborra</surname> <given-names>FJ</given-names></name>. <article-title>Connecting variability in global transcription rate to mitochondrial variability</article-title>. <source>PLoS Biol</source>. <year>2010</year>;<volume>8</volume>:<fpage>e1000560</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.1000560" xlink:type="simple">10.1371/journal.pbio.1000560</ext-link></comment> <object-id pub-id-type="pmid">21179497</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Eser</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Demel</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Maier</surname> <given-names>KC</given-names></name>, <name name-style="western"><surname>Schwalb</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Pirkl</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>DE</given-names></name>, <etal>et al</etal>. <article-title>Periodic mRNA synthesis and degradation co-operate during cell cycle gene expression</article-title>. <source>Mol Syst Biol</source>. <year>2014</year>;<volume>10</volume>:<fpage>717</fpage>–<lpage>717</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/msb.134886" xlink:type="simple">10.1002/msb.134886</ext-link></comment> <object-id pub-id-type="pmid">24489117</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Levine</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Elowitz</surname> <given-names>MB</given-names></name>. <article-title>Functional roles of pulsing in genetic circuits</article-title>. <source>Science</source>. <year>2013</year>;<volume>342</volume>:<fpage>1193</fpage>–<lpage>1200</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1239999" xlink:type="simple">10.1126/science.1239999</ext-link></comment> <object-id pub-id-type="pmid">24311681</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cheong</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rhee</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Nemenman</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Levchenko</surname> <given-names>A</given-names></name>. <article-title>Information transduction capacity of noisy biochemical signaling networks</article-title>. <source>Science</source>. <year>2011</year>;<volume>334</volume>:<fpage>354</fpage>–<lpage>358</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1204553" xlink:type="simple">10.1126/science.1204553</ext-link></comment> <object-id pub-id-type="pmid">21921160</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Voliotis</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Perrett</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>McWilliams</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>McArdle</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Bowsher</surname> <given-names>CG</given-names></name>. <article-title>Information transfer by leaky, heterogeneous, protein kinase signaling systems</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2014</year>;<volume>111</volume>:<fpage>E326</fpage>–<lpage>E333</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1314446111" xlink:type="simple">10.1073/pnas.1314446111</ext-link></comment> <object-id pub-id-type="pmid">24395805</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Guerriero</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Pokhilko</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Fernandez</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Halliday</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Millar</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Hillston</surname> <given-names>J</given-names></name>. <article-title>Stochastic properties of the plant circadian clock</article-title>. <source>J R Soc Interface</source>. <year>2012</year>;<volume>9</volume>:<fpage>744</fpage>–<lpage>756</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2011.0378" xlink:type="simple">10.1098/rsif.2011.0378</ext-link></comment> <object-id pub-id-type="pmid">21880617</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Anderson</surname> <given-names>DF</given-names></name>. <article-title>A modified next reaction method for simulating chemical systems with time dependent propensities and delays</article-title>. <source>J Chem Phys</source>. <year>2007</year>;<volume>127</volume>:<fpage>214107</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.2799998" xlink:type="simple">10.1063/1.2799998</ext-link></comment> <object-id pub-id-type="pmid">18067349</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shahrezaei</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Ollivier</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Swain</surname> <given-names>PS</given-names></name>. <article-title>Colored extrinsic fluctuations and stochastic gene expression</article-title>. <source>Mol Syst Biol</source>. <year>2008</year>;<volume>4</volume>:<fpage>196</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb.2008.31" xlink:type="simple">10.1038/msb.2008.31</ext-link></comment> <object-id pub-id-type="pmid">18463620</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Johnston</surname> <given-names>IG</given-names></name>, <name name-style="western"><surname>Gaal</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Neves</surname> <given-names>RPd</given-names></name>, <name name-style="western"><surname>Enver</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Iborra</surname> <given-names>FJ</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>NS</given-names></name>. <article-title>Mitochondrial variability as a source of extrinsic cellular noise</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>:<fpage>e1002416</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002416" xlink:type="simple">10.1371/journal.pcbi.1002416</ext-link></comment> <object-id pub-id-type="pmid">22412363</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lewis</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Shedler</surname> <given-names>GS</given-names></name>. <article-title>Simulation of nonhomogeneous Poisson processes by thinning</article-title>. <source>Naval Research Logistics Quarterly</source>. <year>1979</year>;<volume>26</volume>:<fpage>403</fpage>–<lpage>413</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/nav.3800260304" xlink:type="simple">10.1002/nav.3800260304</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ogata</surname> <given-names>Y</given-names></name>. <article-title>On Lewis Simulation Method for point-processes</article-title>. <source>IEEE Trans Inf Theory</source>. <year>1981</year>;<volume>27</volume>:<fpage>23</fpage>–<lpage>31</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TIT.1981.1056305" xlink:type="simple">10.1109/TIT.1981.1056305</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thanh</surname> <given-names>VH</given-names></name>, <name name-style="western"><surname>Priami</surname> <given-names>C</given-names></name>. <article-title>Simulation of biochemical reactions with time-dependent rates by the rejection-based algorithm</article-title>. <source>J Chem Phys</source>. <year>2015</year>;<volume>143</volume>(<issue>5</issue>):<fpage>054104</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.4927916" xlink:type="simple">10.1063/1.4927916</ext-link></comment> <object-id pub-id-type="pmid">26254639</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Higham</surname> <given-names>DJ</given-names></name>. <article-title>An algorithmic introduction to numerical simulation of stochastic differential equations</article-title>. <source>SIAM review</source>. <year>2001</year>;<volume>43</volume>:<fpage>525</fpage>–<lpage>546</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/S0036144500378302" xlink:type="simple">10.1137/S0036144500378302</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Del Vecchio</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ninfa</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Sontag</surname> <given-names>ED</given-names></name>. <article-title>Modular cell biology: retroactivity and insulation</article-title>. <source>Mol Syst Biol</source>. <year>2008</year>;<volume>4</volume>:<fpage>161</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb4100204" xlink:type="simple">10.1038/msb4100204</ext-link></comment> <object-id pub-id-type="pmid">18277378</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Panda</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Antoch</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>BH</given-names></name>, <name name-style="western"><surname>Su</surname> <given-names>AI</given-names></name>, <name name-style="western"><surname>Schook</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Straume</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Coordinated transcription of key pathways in the mouse by the circadian clock</article-title>. <source>Cell</source>. <year>2002</year>;<volume>109</volume>:<fpage>307</fpage>–<lpage>320</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0092-8674(02)00722-5" xlink:type="simple">10.1016/S0092-8674(02)00722-5</ext-link></comment> <object-id pub-id-type="pmid">12015981</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Neill</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>van Ooijen</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Dixon</surname> <given-names>LE</given-names></name>, <name name-style="western"><surname>Troein</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Corellou</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Bouget</surname> <given-names>FY</given-names></name>, <etal>et al</etal>. <article-title>Circadian rhythms persist without transcription in a eukaryote</article-title>. <source>Nature</source>. <year>2011</year>;<volume>469</volume>:<fpage>554</fpage>–<lpage>558</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature09654" xlink:type="simple">10.1038/nature09654</ext-link></comment> <object-id pub-id-type="pmid">21270895</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thomas</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Matuschek</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Grima</surname> <given-names>R</given-names></name>. <article-title>Intrinsic noise analyzer: a software package for the exploration of stochastic biochemical kinetics using the system size expansion</article-title>. <source>PLoS one</source>. <year>2012</year>;<volume>7</volume>:<fpage>e38518</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0038518" xlink:type="simple">10.1371/journal.pone.0038518</ext-link></comment> <object-id pub-id-type="pmid">22723865</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Maamar</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Raj</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dubnau</surname> <given-names>D</given-names></name>. <article-title>Noise in gene expression determines cell fate in Bacillus subtilis</article-title>. <source>Science</source>. <year>2007</year>;<volume>317</volume>:<fpage>526</fpage>–<lpage>529</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1140818" xlink:type="simple">10.1126/science.1140818</ext-link></comment> <object-id pub-id-type="pmid">17569828</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Süel</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Garcia-Ojalvo</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Liberman</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Elowitz</surname> <given-names>MB</given-names></name>. <article-title>An excitable gene regulatory circuit induces transient cellular differentiation</article-title>. <source>Nature</source>. <year>2006</year>;<volume>440</volume>:<fpage>545</fpage>–<lpage>550</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004923.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Süel</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Kulkarni</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Dworkin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Garcia-Ojalvo</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Elowitz</surname> <given-names>MB</given-names></name>. <article-title>Tunability and noise dependence in differentiation dynamics</article-title>. <source>Science</source>. <year>2007</year>;<volume>315</volume>:<fpage>1716</fpage>–<lpage>1719</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1137455" xlink:type="simple">10.1126/science.1137455</ext-link></comment> <object-id pub-id-type="pmid">17379809</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cağatay</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Turcotte</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Elowitz</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Garcia-Ojalvo</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Süel</surname> <given-names>GM</given-names></name>. <article-title>Architecture-dependent noise discriminates functionally analogous differentiation circuits</article-title>. <source>Cell</source>. <year>2009</year>;<volume>139</volume>:<fpage>512</fpage>–<lpage>522</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2009.07.046" xlink:type="simple">10.1016/j.cell.2009.07.046</ext-link></comment> <object-id pub-id-type="pmid">19853288</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kampen</surname> <given-names>NG</given-names></name>. <article-title>A power series expansion of the master equation</article-title>. <source>Can J Phys</source>. <year>1961</year>;<volume>39</volume>:<fpage>551</fpage>–<lpage>567</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1139/p61-056" xlink:type="simple">10.1139/p61-056</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Michelsen</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>de Mattos</surname> <given-names>MJT</given-names></name>, <name name-style="western"><surname>Jensen</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Hansen</surname> <given-names>FG</given-names></name>. <article-title>Precise determinations of C and D periods by flow cytometry in Escherichia coli K-12 and B/r</article-title>. <source>Microbiology</source>. <year>2003</year>;<volume>149</volume>:<fpage>1001</fpage>–<lpage>1010</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1099/mic.0.26058-0" xlink:type="simple">10.1099/mic.0.26058-0</ext-link></comment> <object-id pub-id-type="pmid">12686642</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kuchina</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Espinar</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Cagatay</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Balbin</surname> <given-names>AO</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Alvarado</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Temporal competition between differentiation programs determines cell fate choice</article-title>. <source>Mol Syst Biol</source>. <year>2011</year>;<volume>7</volume>(<issue>1–11</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb.2011.88" xlink:type="simple">10.1038/msb.2011.88</ext-link></comment> <object-id pub-id-type="pmid">22146301</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hahn</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Maier</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Haijema</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Sheetz</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dubnau</surname> <given-names>D</given-names></name>. <article-title>Transformation proteins and DNA uptake localize to the cell poles in Bacillus subtilis</article-title>. <source>Cell</source>. <year>2005</year>;<volume>122</volume>:<fpage>59</fpage>–<lpage>71</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2005.04.035" xlink:type="simple">10.1016/j.cell.2005.04.035</ext-link></comment> <object-id pub-id-type="pmid">16009133</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tan</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Saurabh</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bruchez</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Schwartz</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>LeDuc</surname> <given-names>P</given-names></name>. <article-title>Molecular crowding shapes gene expression in synthetic cellular nanosystems</article-title>. <source>Nature nanotechnology</source>. <year>2013</year>;<volume>8</volume>(<issue>8</issue>):<fpage>602</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nnano.2013.132" xlink:type="simple">10.1038/nnano.2013.132</ext-link></comment> <object-id pub-id-type="pmid">23851358</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cianci</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Grima</surname> <given-names>R</given-names></name>. <article-title>Molecular finite-size effects in stochastic models of equilibrium chemical systems</article-title>. <source>Journal of Chemical Physics</source>. <year>2016</year>;<volume>144</volume>:<fpage>084101</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.4941583" xlink:type="simple">10.1063/1.4941583</ext-link></comment> <object-id pub-id-type="pmid">26931675</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004923.ref049">
<label>49</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Anderson</surname> <given-names>DF</given-names></name>, <name name-style="western"><surname>Kurtz</surname> <given-names>TG</given-names></name>. <chapter-title>Continuous time Markov chain models for chemical reaction networks</chapter-title>. In: <source>Design and analysis of biomolecular circuits</source>. <publisher-name>Springer</publisher-name>; <year>2011</year>. p. <fpage>3</fpage>–<lpage>42</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004923.ref050">
<label>50</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Brémaud</surname> <given-names>P</given-names></name>. <source>Point processes and queues</source>. <publisher-loc>Berlin, Germany</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>1981</year>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>