<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00409</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005922</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Coding mechanisms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Coding mechanisms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognition</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Information theory</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Cerebral cortex</subject><subj-group><subject>Entorhinal cortex</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Cerebral cortex</subject><subj-group><subject>Entorhinal cortex</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuronal tuning</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Number theory</subject><subj-group><subject>Real numbers</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Robust and efficient coding with grid cells</article-title>
<alt-title alt-title-type="running-head">Robust and efficient coding with grid cells</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5005-8193</contrib-id>
<name name-style="western">
<surname>Vágó</surname> <given-names>Lajos</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2295-3828</contrib-id>
<name name-style="western">
<surname>Ujfalussy</surname> <given-names>Balázs B.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
<xref ref-type="fn" rid="currentaff001"><sup>¤</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<addr-line>NAP-B PATTERN Group, MTA Wigner Research Center for Physics, Budapest, Hungary</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Macke</surname> <given-names>Jakob H</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Stiftung caesar, GERMANY</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="current-aff" id="currentaff001">
<label>¤</label> <p>Current address: Laboratory of Neuronal Signalling, MTA Research Institute of Experimental Medicine, Budapest, Hungary</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">vagolala@gmail.com</email> (LV); <email xlink:type="simple">balazs.ujfalussy@gmail.com</email> (BBU)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>1</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>8</day>
<month>1</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>1</issue>
<elocation-id>e1005922</elocation-id>
<history>
<date date-type="received">
<day>13</day>
<month>3</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>8</day>
<month>12</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Vágó, Ujfalussy</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005922"/>
<abstract>
<p>The neuronal code arising from the coordinated activity of grid cells in the rodent entorhinal cortex can uniquely represent space across a large range of distances, but the precise conditions for optimal coding capacity are known only for environments with finite size. Here we consider a coding scheme that is suitable for unbounded environments, and present a novel, number theoretic approach to derive the grid parameters that maximise the coding range in the presence of noise. We derive an analytic upper bound on the coding range and provide examples for grid scales that achieve this bound and hence are optimal for encoding in unbounded environments. We show that in the absence of neuronal noise, the capacity of the system is extremely sensitive to the choice of the grid periods. However, when the accuracy of the representation is limited by neuronal noise, the capacity quickly becomes more robust against the choice of grid scales as the number of modules increases. Importantly, we found that the capacity of the system is near optimal even for random scale choices already for a realistic number of grid modules. Our study demonstrates that robust and efficient coding can be achieved without parameter tuning in the case of grid cell representation and provides a solid theoretical explanation for the large diversity of the grid scales observed in experimental studies. Moreover, we suggest that having multiple grid modules in the entorhinal cortex is not only required for the exponentially large coding capacity, but is also a prerequisite for the robustness of the system.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Navigation in natural, open environments poses serious challenges to animals as the distances to be represented may span several orders of magnitudes and are potentially unbounded. The recently discovered grid cells in the rodent brain are though to play a crucial role in generating unique representations for a large number of spatial locations. However, it is unknown how to choose the parameters of the grid cells to achieve maximal capacity, i.e., to uniquely encode the utmost locations in an open environment. In our manuscript, we demonstrate the surprising robustness of the grid cell coding system: The population code realised by grid cells is close to optimal for unique space representation irrespective of the choices of grid parameters. Thus, our study reveals a remarkable robustness of the grid cell coding scheme and provides a solid theoretical explanation for the large diversity of the grid scales observed in experimental studies.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Hungarian Brain Research Program (KTIA-NAP-12-2-201)</institution>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Vágó</surname> <given-names>Lajos</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>Hungarian Brain Research Program (KTIA-NAP-12-2-201)</institution>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2295-3828</contrib-id>
<name name-style="western">
<surname>Ujfalussy</surname> <given-names>Balázs B.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>B.B.U. and L.V. were supported by the National Brain Research Program of Hungary (KTIA-NAP-12-2-201). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="0"/>
<page-count count="28"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-01-19</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Optimising neuronal systems for efficient processing and representation of information is a key principle for both understanding and designing neuronal circuits [<xref ref-type="bibr" rid="pcbi.1005922.ref001">1</xref>], but deciding whether a particular neuronal phenomenon reflects an optimisation process is often difficult. Grid cells in the medial entorhinal cortex have been suggested to efficiently represent spatial location of the animal by their spatially periodic firing fields near optimally [<xref ref-type="bibr" rid="pcbi.1005922.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref005">5</xref>]. However, it remained controversial whether the efficiency of the grid cell code is the result of the precise tuning of the grid parameters [<xref ref-type="bibr" rid="pcbi.1005922.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref008">8</xref>] or the performance of the system is relatively insensitive to the actual parameter settings [<xref ref-type="bibr" rid="pcbi.1005922.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref009">9</xref>].</p>
<p>Grid cells are spatially tuned neurons with multiple firing fields organised along the vertices of a triangular grid (<xref ref-type="fig" rid="pcbi.1005922.g001">Fig 1a</xref>; [<xref ref-type="bibr" rid="pcbi.1005922.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref011">11</xref>]). Grid cells of any particular animal are organised into functional modules [<xref ref-type="bibr" rid="pcbi.1005922.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref013">13</xref>] cells within a module share the same grid scale and orientation, but differ in the location of their firing fields, i.e., their preferred firing phase within the grid period (<xref ref-type="fig" rid="pcbi.1005922.g001">Fig 1a</xref>). Modules form the functional units of the grid representation: The joint activity of all (possibly hundreds of) cells within each module is captured by the (two dimensional) phase of the given module (<xref ref-type="fig" rid="pcbi.1005922.g001">Fig 1b</xref>; [<xref ref-type="bibr" rid="pcbi.1005922.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref015">15</xref>]) and the relationship between different cells from the same module remains stable across different environments [<xref ref-type="bibr" rid="pcbi.1005922.ref016">16</xref>], during sleep [<xref ref-type="bibr" rid="pcbi.1005922.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref018">18</xref>] or after environmental distortions [<xref ref-type="bibr" rid="pcbi.1005922.ref013">13</xref>]. A given spatial location is represented by the phases of the different modules (‘phase vector’). The representations are unique up to a critical distance above which the coding becomes ambiguous: the phase vectors, and hence the firing rates of all grid cells, become (nearly) identical at two separate physical locations (<xref ref-type="fig" rid="pcbi.1005922.g001">Fig 1c</xref>).</p>
<fig id="pcbi.1005922.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005922.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Coding with grid cells.</title>
<p><bold>(a)</bold> Schematic firing fields (circles) of two-dimensional grid cells as function of spatial position. Grid cells are organised into modules: Cells from the same module share the orientation and scale parameter but differ in their spatial phase (top, shades of purple). Different modules have different scale and orientation (top to bottom). <bold>(b)</bold> Grid cell spikes encodes the phase of a module. Spiking of grid cells (black ticks, each spike is shown three times, at the maxima of the cells’ firing rate) from a single module represents the movement of the animal (light-blue line) in a 1 dimensional environment. Since the firing rate of the cells (right, olive) is periodic, the position (left: colormap, right: black) which is represented by the phase of the module is also periodic. The uncertainty of the representation fluctuates over time around a typical value, <italic>δ</italic> (right). <bold>(c)</bold> Grid cell coding schemes. The location of the animal (origin, filled arrow) is jointly encoded by the phases of the different modules in both nested (top) and modulo arithmetic (bottom) codes. Grey and empty arrowheads indicate locations with large or catastrophic interference between the modules, respectively.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005922.g001" xlink:type="simple"/>
</fig>
<p>Depending on the magnitude of the critical distance compared to the largest grid scale, two complementary coding schemes have been proposed for grid cells (<xref ref-type="fig" rid="pcbi.1005922.g001">Fig 1c</xref>): In nested coding [<xref ref-type="bibr" rid="pcbi.1005922.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref008">8</xref>] smaller grid modules iteratively refine the position coding of larger modules and the modules span a wide range of scales. The capacity of nested codes, defined as the ratio of the coding range and the resolution, is exponential in the number of modules. Maximal capacity can be achieved by setting the coding range equal to the maximal grid period and then optimising the resolution by a geometric progression of the grid scales [<xref ref-type="bibr" rid="pcbi.1005922.ref006">6</xref>]. When the total capacity is utilised to encode locations within the maximal grid scale, catastrophic interference will cause ambiguity in the grid code beyond this distance (<xref ref-type="fig" rid="pcbi.1005922.g001">Fig 1c</xref>).</p>
<p>When the coding is not optimised for a fixed range, the unique combination of the activity of grid modules can encode a potentially unbounded range that can be substantially larger than the scale of the largest module using a modulo arithmetic (MA) code [<xref ref-type="bibr" rid="pcbi.1005922.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref014">14</xref>] (<xref ref-type="fig" rid="pcbi.1005922.g001">Fig 1c</xref>). In this case the grid periods can be similar in magnitude (e.g., co-prime integers or a geometric progression with a relatively small ratio). However, it is not known under what conditions the MA coding system can achieve exponential capacity [<xref ref-type="bibr" rid="pcbi.1005922.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref014">14</xref>], and how robust is the capacity against the choice of the grid periods or neuronal noise.</p>
<p>Here we develop a novel approach to study the capacity of the grid coding system that is based on Diophantine approximations, i.e., approximation of real numbers by rational numbers. First, we apply the technique to study coding with two grid modules. We show that the capacity of the system is extremely sensitive to the number theoretic properties of the scale ratio between the modules. Next, we generalise our approach to the case of multiple modules, and show both analytically and numerically that the exponential capacity of the grid cell coding system can be achieved using the MA coding scheme. Finally, we demonstrate that when the coding range is constrained by neuronal noise, the capacity of the system is extremely robust against the choices of the scaling of the modules.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>In the first section of the Results we briefly introduce the terminology and define the concepts used throughout the paper. We include this section for completeness, although several ideas presented in this section have been described before, e.g., in [<xref ref-type="bibr" rid="pcbi.1005922.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref004">4</xref>].</p>
<p>We investigate grid cell population codes along a linear trajectory as the one dimensional results extend to two (or higher) dimensions without difficulty, at least for axis aligned grid modules (<xref ref-type="sec" rid="sec013">Methods</xref>) [<xref ref-type="bibr" rid="pcbi.1005922.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref004">4</xref>]. The periodic population activity of module <italic>i</italic> can be summarised by its spatial phase
<disp-formula id="pcbi.1005922.e001"><alternatives><graphic id="pcbi.1005922.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≔</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mspace width="4pt"/><mml:mtext>mod</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mspace width="4pt"/><mml:mo>∈</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
which depends on the position (<italic>x</italic>) and the scale of the module (<italic>α</italic><sub><italic>i</italic></sub>, <xref ref-type="sec" rid="sec013">Methods</xref>) with <italic>α</italic><sub>0</sub> = 1, which means that distances are expressed in the unit of the smallest grid period. We assume, that, without loss of generality, at the spatial origin all modules are in their 0 phase. Spikes of the neurons in module <italic>i</italic>, represent the spatial location of the animal with a maximum error <italic>δ</italic> <italic>α</italic><sub><italic>i</italic></sub> (i.e., with the same 0.01 ≤ <italic>δ</italic> ≤ 0.2 phase error for all modules; <xref ref-type="sec" rid="sec013">Methods</xref>; [<xref ref-type="bibr" rid="pcbi.1005922.ref008">8</xref>]). Ambiguity occurs if the phase difference <italic>ϵ</italic> between the modules is smaller than <italic>δ</italic> at integer distance <italic>ℓ</italic> from the origin (Figs <xref ref-type="fig" rid="pcbi.1005922.g001">1c</xref> and <xref ref-type="fig" rid="pcbi.1005922.g002">2b</xref>, inset, <xref ref-type="sec" rid="sec013">Methods</xref>):
<disp-formula id="pcbi.1005922.e002"><alternatives><graphic id="pcbi.1005922.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>ψ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>ψ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where ||<italic>ψ</italic>|| means distance from the nearest integer.</p>
<fig id="pcbi.1005922.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005922.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Interference depends on the choice of the scales.</title>
<p><bold>(a)</bold> Interference with rational scale ratio. Left: Representative posteriors (<italic>P</italic>(<italic>x</italic>|<bold>s</bold>)) for two modules with scale 1 and <italic>α</italic> = 3/2. Encoding becomes ambiguous at distance 3 from the origin where perfect interference occurs (3 = 2<italic>α</italic>). Right: Phase plot of the two modules, with the colour (red to blue) encoding the distance from the origin (see the coloured line below the left panel). Perfect interference occurs when the phase-curve overlaps with itself. <bold>(b)</bold> Interference with <italic>α</italic> = 1.76 …, which is close to 7/4 and therefore leads to strong interference at distance 7. Right: Interference occurs when the distance between two neighbouring segments of the phase curve becomes smaller than the limit set by the neuronal noise (grey squares of side <italic>δ</italic> around the origin, see inset). Note, that both grids are around phase 0.3 at the distance 2.3 without interference. <bold>(c)</bold> Interference with <italic>α</italic> = <italic>σ</italic> ≈ 1.618, which is the golden ratio. Interference still becomes stronger at larger distances, (e.g. at distance 5, since <inline-formula id="pcbi.1005922.e003"><alternatives><graphic id="pcbi.1005922.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mi>σ</mml:mi> <mml:mo>≈</mml:mo> <mml:mfrac><mml:mn>5</mml:mn> <mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>). Interference in grid codes is related to the approximation of irrationals with rational numbers having small denominators (see text for further details). Right: Interference is inevitable since the phase space has a limited volume.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005922.g002" xlink:type="simple"/>
</fig>
<p>To analyse the coding properties of the grid cell system, we follow the same three logical steps both in the two module and in the multi-module case (<xref ref-type="fig" rid="pcbi.1005922.g003">Fig 3</xref>). First, we show the existence of an upper bound on how the maximal phase difference <italic>ϵ</italic>(<italic>ℓ</italic>) between the modules decreases with the distance. Intuitively, this upper bound expresses the fact that interference between the modules necessarily becomes stronger at larger distances. Second, we demonstrate that for appropriately chosen scale ratios a lower bound on the phase difference also exists and is parallel with the upper bound (<xref ref-type="fig" rid="pcbi.1005922.g003">Fig 3</xref>). For these scale choices catastrophic interference is avoided until a critical distance, that depends on the noise level in the system. Importantly, the slope of the bounds depends only on the number of modules, but not on the choice of the scale parameters. Therefore the efficiency of the scale choices (the magnitude of the critical distance) can be characterised by the offset parameter, <italic>c</italic><sub><italic>α</italic></sub> (defined below), associated with the lower bound. Thus, our third step is to estimate <italic>c</italic><sub><italic>α</italic></sub> for various choices of the scale parameter <italic>α</italic>.</p>
<fig id="pcbi.1005922.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005922.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Logical steps of the argument.</title>
<p>First, we provide an absolute upper bound on the phase difference in the function of the distance, that is linear in log-log scale (left). Second, we show, that for certain scales a lower bound also exists (middle). Third, we characterise the efficiency of the scales (<italic>α</italic>) by their offset, <italic>c</italic><sub><italic>α</italic></sub> (right).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005922.g003" xlink:type="simple"/>
</fig>
<p>Our analytic derivations provide an estimate for the asymptotic performance of the system that is valid in the low-noise limit. The main advantage of our approach is that it provides strict bounds on the achievable coding efficiency that can be used as a metric to evaluate the efficiency of different scale choices at realistic noise levels, two or more modules alike. As we found using numerical simulations, these bounds can be approached with random scale choices at realistic levels of noise and number of modules.</p>
<sec id="sec003">
<title>Coding is extremely sensitive to the scale ratio with two modules</title>
<p>We can formalise the problem of interference between two modules as having a pair of integers <italic>k</italic> and <italic>ℓ</italic> with <italic>ℓ</italic> ≈ <italic>kα</italic>, meaning that module 2 (with scale <italic>α</italic>) is close to being in phase 0 at distance <italic>ℓ</italic>, which would cause ambiguity between the coding of the spatial point <italic>ℓ</italic> and the origin. This is formally identical to the number theoretic question of the approximability of the scale <italic>α</italic> ≈ <italic>ℓ</italic>/<italic>k</italic> with rationals having numerator <italic>ℓ</italic>, also known as Diophantine approximations (<xref ref-type="fig" rid="pcbi.1005922.g002">Fig 2b and 2c</xref>).</p>
<p>Hurwitz’s theorem [<xref ref-type="bibr" rid="pcbi.1005922.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref020">20</xref>] states that for all irrational numbers <italic>α</italic> &gt; 1 there are infinitely many relative primes <italic>k</italic>, <italic>ℓ</italic> such that the error of the approximation, defined as
<disp-formula id="pcbi.1005922.e004"><alternatives><graphic id="pcbi.1005922.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mo>|</mml:mo> <mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>/</mml:mo> <mml:mi>α</mml:mi> <mml:mo>|</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
is smaller than the upper bound:
<disp-formula id="pcbi.1005922.e005"><alternatives><graphic id="pcbi.1005922.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msqrt><mml:mn>5</mml:mn></mml:msqrt></mml:mfrac> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>ℓ</mml:mi></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
Note that the approximation error <italic>ϵ</italic>(<italic>ℓ</italic>) (<xref ref-type="disp-formula" rid="pcbi.1005922.e004">Eq 2</xref>) is the same as the phase difference between the modules, defined in <xref ref-type="disp-formula" rid="pcbi.1005922.e002">Eq 1</xref>, since <italic>ψ</italic><sub>2</sub>(<italic>ℓ</italic>) = [<italic>ℓ</italic>/<italic>α</italic>] mod 1 = |<italic>k</italic> − <italic>ℓ</italic>/<italic>α</italic>| for an appropriately chosen integer <italic>k</italic> (<xref ref-type="fig" rid="pcbi.1005922.g002">Fig 2b and 2c</xref>). We call <italic>ϵ</italic>(<italic>ℓ</italic>) ‘approximation error’ only when we are talking about approximating irrationals with integer ratios while in the context of grid cells we will call <italic>ϵ</italic>(<italic>ℓ</italic>) the ‘phase difference’.</p>
<p>Applied to the grid cells, Hurwitz’s theorem provides an upper bound on how the phase difference between the modules shrinks with the distance. Specifically, the theorem states that there are infinitely many integer distances <italic>ℓ</italic>, where the phase difference is smaller than <italic>ϵ</italic>(<italic>ℓ</italic>) ∝ 1/<italic>ℓ</italic> (<xref ref-type="fig" rid="pcbi.1005922.g004">Fig 4a–4c</xref>, dashed lines), implying that on the long run interference can not be avoided no matter how carefully we choose <italic>α</italic>. This is a fundamental upper bound on the efficiency of coding with grid cells.</p>
<fig id="pcbi.1005922.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005922.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Coding efficiency in two modules.</title>
<p><bold>(a-c)</bold> The phase difference in the function of distance for different values of <italic>α</italic>. The zigzag line indicates the phase difference (PD) at all integer distances, circles indicate record low PD. Dashed line shows the theoretical upper bound of the PD, solid line shows the numerical fit on the lower bound (allowing finitely few exceptions at low <italic>ℓ</italic>). Note, that the lower and the upper bound coincides in b. Also note the 1/<italic>ℓ</italic> scaling of PD for algebraic scale ratios (b-c). Grey shading indicates the range of PD smaller than the neuronal noise, (1 + <italic>α</italic>)<italic>δ</italic>. <bold>(d)-(f)</bold> The scaled phase difference (<inline-formula id="pcbi.1005922.e006"><alternatives><graphic id="pcbi.1005922.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <xref ref-type="disp-formula" rid="pcbi.1005922.e017">Eq 7</xref>) for different distances and scale ratios. The highest constant under which there are only finitely few values of <inline-formula id="pcbi.1005922.e007"><alternatives><graphic id="pcbi.1005922.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> at small distances estimates <inline-formula id="pcbi.1005922.e008"><alternatives><graphic id="pcbi.1005922.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. The value of <inline-formula id="pcbi.1005922.e009"><alternatives><graphic id="pcbi.1005922.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is slightly higher for the golden ratio (e) than for <inline-formula id="pcbi.1005922.e010"><alternatives><graphic id="pcbi.1005922.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:math></alternatives></inline-formula> (f), and much larger than for non-algebraic numbers (d, <inline-formula id="pcbi.1005922.e011"><alternatives><graphic id="pcbi.1005922.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:mi>α</mml:mi> <mml:mo>=</mml:mo> <mml:msqrt><mml:mi>e</mml:mi></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005922.e012"><alternatives><graphic id="pcbi.1005922.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>04</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005922.g004" xlink:type="simple"/>
</fig>
<p>The critical distance where the phase difference <italic>ϵ</italic>(<italic>ℓ</italic>) leads to interference, and the representation of the position becomes ambiguous, depends on the noisiness of the two modules, <italic>δ</italic> and <italic>αδ</italic>. Interference occurs if there is a spatial point <italic>x</italic> for which both |<italic>x</italic> − <italic>kα</italic>| &lt; <italic>αδ</italic> and |<italic>x</italic> − <italic>ℓ</italic>| &lt; <italic>δ</italic> for integers <italic>k</italic>, <italic>ℓ</italic>, or equivalently, if |<italic>kα</italic> − <italic>ℓ</italic>| &lt; (1 + <italic>α</italic>)<italic>δ</italic>. Hence, by the definition of <italic>ϵ</italic>(<italic>ℓ</italic>) (<xref ref-type="disp-formula" rid="pcbi.1005922.e004">Eq 2</xref>) the coding is ambiguous near <italic>ℓ</italic> if and only if
<disp-formula id="pcbi.1005922.e013"><alternatives><graphic id="pcbi.1005922.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>α</mml:mi></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>α</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
Therefore, no matter how we chose <italic>α</italic>, we can expect ambiguity at distances <italic>ℓ</italic> from the origin if the noise in the system is larger than the upper bound on efficiency provided by <xref ref-type="disp-formula" rid="pcbi.1005922.e005">Eq 3</xref>, i.e.
<disp-formula id="pcbi.1005922.e014"><alternatives><graphic id="pcbi.1005922.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ℓ</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mfrac><mml:mi>α</mml:mi> <mml:mrow><mml:msqrt><mml:mn>5</mml:mn></mml:msqrt> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>α</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>δ</mml:mi></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
that is, at distance of order 1/<italic>δ</italic>. Consequently, it is impossible to code position with two modules better than this bound.</p>
<p>The question arises then whether the above theoretical bound is achievable, at least for some appropriately chosen <italic>α</italic>. The answer is yes, namely the upper bound in <xref ref-type="disp-formula" rid="pcbi.1005922.e005">Eq 3</xref> is sharp for the golden ratio <inline-formula id="pcbi.1005922.e015"><alternatives><graphic id="pcbi.1005922.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:mi>α</mml:mi> <mml:mo>=</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>≔</mml:mo> <mml:mfrac><mml:mrow><mml:msqrt><mml:mn>5</mml:mn></mml:msqrt> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>≈</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>618</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Practically, this also introduces a limit on <italic>ϵ</italic>(<italic>ℓ</italic>), saying that the phase difference between the modules remains always larger than a specific lower bound:
<disp-formula id="pcbi.1005922.e016"><alternatives><graphic id="pcbi.1005922.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&gt;</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msqrt><mml:mn>5</mml:mn></mml:msqrt></mml:mfrac> <mml:mo>-</mml:mo> <mml:mi>ε</mml:mi> <mml:mo>)</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>ℓ</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
except for a couple of small distances, even for arbitrary small <italic>ε</italic> &gt; 0 [<xref ref-type="bibr" rid="pcbi.1005922.ref019">19</xref>] (<xref ref-type="fig" rid="pcbi.1005922.g004">Fig 4b</xref>).</p>
<p>It may sound strange that there are finitely many exceptions, but in our simulations we found only a few instances with <italic>ℓ</italic> being small (<xref ref-type="fig" rid="pcbi.1005922.g004">Fig 4e</xref>). Therefore, if the ratio of the two grid modules equals the golden ratio then the phase difference between the two modules is guaranteed to be larger than the lower bound defined by <xref ref-type="disp-formula" rid="pcbi.1005922.e016">Eq 6</xref>. Since <italic>ε</italic> can be arbitrarily small, the lower bound for the golden ratio approaches the theoretical upper bound (<xref ref-type="disp-formula" rid="pcbi.1005922.e005">Eq 3</xref>) and <italic>σ</italic> is an optimal choice for the scale ratio to avoid interference in case of two modules. To give a geometric picture, the golden ratio guarantees approximately uniform coverage of the phase space for both short and arbitrarily long distances (<xref ref-type="fig" rid="pcbi.1005922.g002">Fig 2c</xref>, right).</p>
<p>However, it turns out that there are many good choices [<xref ref-type="bibr" rid="pcbi.1005922.ref020">20</xref>]: for any algebraic integer <italic>α</italic> of order 2 (i.e. irrational which is a root of a polynomial of degree 2 with integer coefficients, see <xref ref-type="sec" rid="sec013">Methods</xref>) there exists a maximal positive constant <italic>c</italic><sub><italic>α</italic></sub> &gt; 0 such that
<disp-formula id="pcbi.1005922.e017"><alternatives><graphic id="pcbi.1005922.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>≥</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>α</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:mfrac> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>ℓ</mml:mi></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula>
holds except for a couple of small distances (<xref ref-type="fig" rid="pcbi.1005922.g004">Fig 4c–4f</xref>, [<xref ref-type="bibr" rid="pcbi.1005922.ref021">21</xref>]). Hence, from Eqs <xref ref-type="disp-formula" rid="pcbi.1005922.e013">4</xref> and <xref ref-type="disp-formula" rid="pcbi.1005922.e017">7</xref> we see that the representation is unambiguous whenever <italic>c</italic><sub><italic>α</italic></sub>(1 + <italic>α</italic>)/(<italic>α</italic> <italic>ℓ</italic>) &gt; <italic>δ</italic>(1 + <italic>α</italic>)/<italic>α</italic>, that is up to
<disp-formula id="pcbi.1005922.e018"><alternatives><graphic id="pcbi.1005922.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ℓ</mml:mi> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mtext>max</mml:mtext></mml:msub> <mml:mo>≔</mml:mo> <mml:mfrac><mml:msub><mml:mi>c</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:mi>δ</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
for all <italic>δ</italic> which is small enough. This last condition on the magnitude of the noise is only needed to exclude the possible exceptionally small <italic>ℓ</italic> distances in <xref ref-type="disp-formula" rid="pcbi.1005922.e016">Eq 6</xref>, which in practice is not a crucial condition (<xref ref-type="fig" rid="pcbi.1005922.g004">Fig 4d and 4e</xref>).</p>
<p>The constant <italic>c</italic><sub><italic>α</italic></sub> is the single parameter that determines the critical distance up to which encoding is unique (coding range) as well as the information rate of the system (<xref ref-type="sec" rid="sec013">Methods</xref>). Therefore, we use <italic>c</italic><sub><italic>α</italic></sub> to compare the efficiency of different choices of <italic>α</italic> (<xref ref-type="fig" rid="pcbi.1005922.g004">Fig 4d–4f</xref>). We have already noted that for the golden ratio the lower and the upper bounds (Eqs <xref ref-type="disp-formula" rid="pcbi.1005922.e005">3</xref> and <xref ref-type="disp-formula" rid="pcbi.1005922.e017">7</xref>) coincide (<xref ref-type="fig" rid="pcbi.1005922.g004">Fig 4b</xref>), but the critical distance may be larger for some <italic>α</italic> even if the corresponding lower bound on the phase difference is weaker, since the upper bound also depends on <italic>α</italic> (<xref ref-type="disp-formula" rid="pcbi.1005922.e014">Eq 5</xref>).</p>
<p>We estimated the value of <italic>c</italic><sub><italic>α</italic></sub> for various scale ratios at different noise levels (<xref ref-type="sec" rid="sec013">Methods</xref>). Unlike for algebraic numbers, <inline-formula id="pcbi.1005922.e019"><alternatives><graphic id="pcbi.1005922.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msub></mml:math></alternatives></inline-formula> of real numbers depends on the distance range used for the estimation, which we controlled by setting different intervals for <italic>δ</italic> in the simulations.</p>
<p>Our simulations confirmed that <italic>σ</italic> is the best scale ratio choice in case of two modules with <inline-formula id="pcbi.1005922.e020"><alternatives><graphic id="pcbi.1005922.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>28</mml:mn> <mml:mo>≈</mml:mo> <mml:mfrac><mml:mi>σ</mml:mi> <mml:mrow><mml:msqrt><mml:mn>5</mml:mn></mml:msqrt> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, but also showed that, on both short and long run, <inline-formula id="pcbi.1005922.e021"><alternatives><graphic id="pcbi.1005922.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is extremely sensitive to the choice of <italic>α</italic> (<xref ref-type="fig" rid="pcbi.1005922.g005">Fig 5</xref>): in case of a small error in the tuning of <italic>α</italic>, the efficiency can drop substantially and <inline-formula id="pcbi.1005922.e022"><alternatives><graphic id="pcbi.1005922.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msub></mml:math></alternatives></inline-formula> becomes practically 0, implying that in the immediate neighbourhood of the optimal <italic>α</italic>, there are close to pessimal grid cell configurations. This is because the lower bound on the phase difference (<xref ref-type="disp-formula" rid="pcbi.1005922.e017">Eq 7</xref>) requires <italic>α</italic> to be an algebraic number, and in an arbitrary small neighbourhood of any algebraic number there are (infinitely) many non-algebraic numbers, i.e., transcendental numbers (<inline-formula id="pcbi.1005922.e023"><alternatives><graphic id="pcbi.1005922.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:mi>α</mml:mi> <mml:mo>=</mml:mo> <mml:msqrt><mml:mi>e</mml:mi></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>, <xref ref-type="fig" rid="pcbi.1005922.g004">Fig 4a</xref>) or rational numbers (<italic>α</italic> = 3/2, <italic>c</italic><sub><italic>α</italic></sub> → 0, <xref ref-type="fig" rid="pcbi.1005922.g002">Fig 2a</xref>). As non-algebraic irrational numbers can be much better approximated with rationals than algebraic numbers, non-algebraic grid scale ratios will lead to much stronger interference between the two modules, but only at distances moderately large compared to the scale of the modules (<xref ref-type="fig" rid="pcbi.1005922.g005">Fig 5</xref>).</p>
<fig id="pcbi.1005922.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005922.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Approximate <italic>c</italic><sub><italic>α</italic></sub> values as a function of <italic>α</italic>.</title>
<p>The values are shown for 1000 <italic>α</italic> randomly selected from the interval (1, 2). The <italic>c</italic><sub><italic>α</italic></sub> of algebraic (<inline-formula id="pcbi.1005922.e024"><alternatives><graphic id="pcbi.1005922.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:msqrt><mml:mi>2</mml:mi></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005922.e025"><alternatives><graphic id="pcbi.1005922.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:msqrt><mml:mi>3</mml:mi></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>, <italic>σ</italic>, <italic>σ</italic> − 1/2) and non-algebraic (<inline-formula id="pcbi.1005922.e026"><alternatives><graphic id="pcbi.1005922.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:msqrt><mml:mi>e</mml:mi></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>) irrationals are also shown in red and black, respectively. We estimated <italic>c</italic><sub><italic>α</italic></sub>, based on <xref ref-type="disp-formula" rid="pcbi.1005922.e018">Eq 8</xref>, as <italic>c</italic><sub><italic>α</italic></sub> ≈ inf{<italic>L</italic><sub>max</sub> <italic>δ</italic> ∣ <italic>δ</italic><sub>min</sub> &lt; <italic>δ</italic> &lt; <italic>δ</italic><sub>max</sub>}, for different noise ranges [<italic>δ</italic><sub>min</sub>, <italic>δ</italic><sub>max</sub>] in the three panels: (a) 0.05 &lt; <italic>δ</italic> &lt; 0.2, (b) 0.005 &lt; <italic>δ</italic> &lt; 0.05, (c) 0.001 &lt; <italic>δ</italic> &lt; 0.01. Approximate <italic>L</italic><sub>max</sub> values are indicated on the top of the panels for <italic>α</italic> = <italic>σ</italic>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005922.g005" xlink:type="simple"/>
</fig>
<p>The extremely rough landscape of <italic>c</italic><sub><italic>α</italic></sub> renders optimisation for <italic>α</italic> an especially difficult problem: it is very unlikely that a biological system would be able to find the global optimum for the scale ratio of two grid modules and a relatively small mistuning from a local optimum could significantly deteriorate the efficiency of the system. Therefore, at least in the case of two modules, it seems to be impossible to achieve asymptotically optimal scale ratio for the grid cells.</p>
</sec>
<sec id="sec004">
<title>Generalisation to multiple modules</title>
<p>To derive the general solution for <italic>M</italic> grid modules, we focus on a set of 1-dimensional grids with scales <italic>α</italic><sub>0</sub> = 1 &lt; <italic>α</italic><sub>1</sub> &lt; ⋯ &lt; <italic>α</italic><sub><italic>M</italic>−1</sub>. Spatial representation is unambiguous up to a distance <italic>L</italic> from the origin if there is at least one module for which the phase is significantly different from 0 (<xref ref-type="fig" rid="pcbi.1005922.g006">Fig 6</xref>). Interestingly, avoiding interference between adjacent modules (giving <italic>α</italic> = <italic>σ</italic>) is not a good solution, since it leads to interference between the distant modules wherever the adjacent modules are in close apposition (<xref ref-type="sec" rid="sec013">Methods</xref>). The logic of the general solution for multiple modules is the same as in the case of two modules. Here we only state the main results and the technical details of the analysis can be found in the Methods.</p>
<fig id="pcbi.1005922.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005922.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Interference of <italic>M</italic> = 3 modules with different choice of scales.</title>
<p><bold>(a)</bold> Top: Posterior densities for three modules with rational scale ratios. The overlap between the modules is shown in black, its height indicates the interference of the three modules as a function of distance from the origin. The representation becomes ambiguous only if all 3 modules interfere, as at distance 6. Bottom: Ambiguity in position coding quantified by the multi-modality of the combined posterior. <bold>(b)</bold> Posterior densities for three modules with pairwise optimal scale ratios. The scales are 1 (blue), <italic>σ</italic> (red), and <italic>σ</italic><sup>2</sup> (olive), where <italic>σ</italic> is the golden ratio. As we have more modules (3) than the order of <italic>σ</italic> (2), wherever any two modules interfere with each other, then they interfere with the third as well: at distance 8 the three peaks almost coincide. <bold>(c)</bold> The same as in (b) for scales 1, 2<sup>1/3</sup>, 2<sup>2/3</sup>, powers of a third order algebraic number. Although pairwise interference can be very strong between any pairs (e.g. at distances 5, 6.2 and 8), the total interference is substantially lower than in panel b (bottom).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005922.g006" xlink:type="simple"/>
</fig>
<p>First, we show that a similar upper bound exists for the maximal phase difference between the modules. Compared to the two-module case, the bound is weaker when <italic>M</italic> &gt; 2 as the phase difference scales only with 1/<italic>ℓ</italic><sup>1/(<italic>M</italic>−1)</sup> ≫ 1/<italic>ℓ</italic> meaning that it ensures simultaneous interference between all modules only at much larger distances.</p>
<p>Second, we found that the upper bound can be satisfied, up to a constant multiplier, <inline-formula id="pcbi.1005922.e027"><alternatives><graphic id="pcbi.1005922.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, for algebraic scale ratios (<xref ref-type="sec" rid="sec013">Methods</xref>). Specifically, if the scales of <italic>M</italic> modules form a geometric series with common ratio <italic>α</italic> being an algebraic number of degree <italic>M</italic>, the upper bound is tight, meaning that the phase difference does not shrink faster than 1/<italic>ℓ</italic><sup>1/(<italic>M</italic>−1)</sup>. Intuitively, this scaling indicates that there is always at least one pair of modules for which the phase difference at the integer distance <italic>ℓ</italic> from the origin is larger than the lower bound.</p>
<p>The critical distance <italic>L</italic><sub>max</sub> up to which coding is unambiguous can be expressed as (cf. <xref ref-type="disp-formula" rid="pcbi.1005922.e018">Eq 8</xref>):
<disp-formula id="pcbi.1005922.e028"><alternatives><graphic id="pcbi.1005922.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub> <mml:mo>≔</mml:mo> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:mrow> <mml:mi>δ</mml:mi></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
for all <italic>δ</italic> which is small enough, where <inline-formula id="pcbi.1005922.e029"><alternatives><graphic id="pcbi.1005922.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and its estimate <inline-formula id="pcbi.1005922.e030"><alternatives><graphic id="pcbi.1005922.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> are defined analogously as in the two modules case (see <xref ref-type="sec" rid="sec013">Methods</xref> for the definition). Intuitively, <xref ref-type="disp-formula" rid="pcbi.1005922.e028">Eq 9</xref> expresses an exponential scaling of the maximal distance uniquely represented by a population of grid cells with the number of grid modules, <italic>M</italic>. The coding range of a particular set of the grid scales, <inline-formula id="pcbi.1005922.e031"><alternatives><graphic id="pcbi.1005922.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:mi mathvariant="script">A</mml:mi> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, depends on both the noise in the system and on the basis of the exponential <inline-formula id="pcbi.1005922.e032"><alternatives><graphic id="pcbi.1005922.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.</p>
<p>Interestingly, the above described geometric sequence of algebraic numbers are the only known explicit examples of badly approximable vectors (to the best of our knowledge). However, it is known that there are much more such vectors which do not form geometric sequences [<xref ref-type="bibr" rid="pcbi.1005922.ref022">22</xref>], therefore the scale ratio of a well-tuned MA grid cell system does not have to be constant.</p>
<p>The expression about the exponential scaling (<xref ref-type="disp-formula" rid="pcbi.1005922.e028">Eq 9</xref>) is similar to the capacity estimates of Fiete et al. [<xref ref-type="bibr" rid="pcbi.1005922.ref003">3</xref>] (see their <xref ref-type="disp-formula" rid="pcbi.1005922.e016">Eq 6</xref>) obtained using a combinatorial upper bound and numerical simulations. Importantly, our analytic derivation also provides insight about why certain grid systems are more efficient than others and give examples for efficient grid scales. Moreover, when <inline-formula id="pcbi.1005922.e033"><alternatives><graphic id="pcbi.1005922.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> our formula for the capacity of the grid code becomes identical to the theoretically maximum capacity found in the case of nested coding [<xref ref-type="bibr" rid="pcbi.1005922.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref006">6</xref>].</p>
<p>In the next sections we first numerically estimate the value of <inline-formula id="pcbi.1005922.e034"><alternatives><graphic id="pcbi.1005922.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> for various choices of the grid scales <inline-formula id="pcbi.1005922.e035"><alternatives><graphic id="pcbi.1005922.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mi mathvariant="script">A</mml:mi></mml:math></alternatives></inline-formula> and then we show that with sufficiently large number of modules <inline-formula id="pcbi.1005922.e036"><alternatives><graphic id="pcbi.1005922.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is guaranteed to approach its theoretical maximum <inline-formula id="pcbi.1005922.e037"><alternatives><graphic id="pcbi.1005922.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> for randomly chosen grid periods.</p>
</sec>
<sec id="sec005">
<title>Numerical estimation of the <inline-formula id="pcbi.1005922.e038"><alternatives><graphic id="pcbi.1005922.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula></title>
<p>We developed an efficient method to numerically estimate the value of <inline-formula id="pcbi.1005922.e039"><alternatives><graphic id="pcbi.1005922.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> for various parameter settings that is based on the simultaneous Diophantine approximations of a set of irrational numbers (<xref ref-type="sec" rid="sec013">Methods</xref>). Using realistic noise levels we found that, in contrast to the case of two modules, the sensitivity of the coding efficiency to the choice of <italic>α</italic> gradually vanishes when the number of grid modules is increased (<xref ref-type="fig" rid="pcbi.1005922.g007">Fig 7a and 7b</xref>). In particular, with <italic>M</italic> = 10 modules <inline-formula id="pcbi.1005922.e040"><alternatives><graphic id="pcbi.1005922.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>4</mml:mn> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for almost all choices of the grid scales (<xref ref-type="fig" rid="pcbi.1005922.g007">Fig 7b</xref>), both when the scales follow a geometric series with a common scale ratio <italic>α</italic> (<xref ref-type="fig" rid="pcbi.1005922.g007">Fig 7b</xref>) and when all the <italic>M</italic> scales are chosen from the bounded interval (1, 2). We also found that <inline-formula id="pcbi.1005922.e041"><alternatives><graphic id="pcbi.1005922.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> vanishes only for pathological examples such as rational numbers or powers of the second order algebraic number <italic>α</italic> = <italic>σ</italic> − 1/2 ≈ 1.118 (<xref ref-type="fig" rid="pcbi.1005922.g007">Fig 7a and 7b</xref>, red). The only random scale choice that significantly degrades the performance is when <italic>α</italic> ≈ 1 (<xref ref-type="fig" rid="pcbi.1005922.g007">Fig 7a and 7b</xref>) in which case all grid modules have nearly identical spatial scale.</p>
<fig id="pcbi.1005922.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005922.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Robustness of the grid code with multiple modules.</title>
<p><bold>(a)-(b)</bold>: Values of <inline-formula id="pcbi.1005922.e042"><alternatives><graphic id="pcbi.1005922.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> estimated for 100 <italic>α</italic> randomly selected from the interval (1, 2) with <italic>M</italic> = 5 (a) and <italic>M</italic> = 10 (b) (see also <xref ref-type="fig" rid="pcbi.1005922.g005">Fig 5a</xref> for <italic>M</italic> = 2). The scales form a geometric series, i.e., <inline-formula id="pcbi.1005922.e043"><alternatives><graphic id="pcbi.1005922.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mrow><mml:mi mathvariant="script">A</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mo>{</mml:mo> <mml:msup><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. Red circle indicates <inline-formula id="pcbi.1005922.e044"><alternatives><graphic id="pcbi.1005922.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> for a second order algebraic number <italic>α</italic> = <italic>σ</italic> − 1/2 ≈ 1.118. Green (cyan) shows <inline-formula id="pcbi.1005922.e045"><alternatives><graphic id="pcbi.1005922.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> for 5th (10th) order algebraic numbers, respectively. Noise level is the same as in <xref ref-type="fig" rid="pcbi.1005922.g005">Fig 5a</xref> (0.05 &lt; <italic>δ</italic> &lt; 0.2). <bold>(c)-(d)</bold>: Mean (c) and coefficient of variation (d) of <inline-formula id="pcbi.1005922.e046"><alternatives><graphic id="pcbi.1005922.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> evaluated on the range <italic>α</italic> = {1.1, 1.9}. For <italic>M</italic> = 10 the <inline-formula id="pcbi.1005922.e047"><alternatives><graphic id="pcbi.1005922.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is also shown for two alternative selection of the scales: if all 10 scales are selected randomly from the interval [<xref ref-type="bibr" rid="pcbi.1005922.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref002">2</xref>] (olive) and when <italic>α</italic>s form a geometric series perturbed as <inline-formula id="pcbi.1005922.e048"><alternatives><graphic id="pcbi.1005922.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:mi mathvariant="script">A</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ε</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>10</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>ε</italic><sub><italic>i</italic></sub> are i.i.d. uniform random variables on the range [−0.01, 0.01] (purple). <bold>(e)-(f)</bold> Phase difference (<inline-formula id="pcbi.1005922.e049"><alternatives><graphic id="pcbi.1005922.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <xref ref-type="disp-formula" rid="pcbi.1005922.e101">Eq 25</xref>) in the function of the distance, <italic>ℓ</italic>. (e) Effect of number theoretic properties with <italic>M</italic> = 10. When <italic>α</italic> is the root of the 10th order polynomial <italic>x</italic><sup>10</sup> − <italic>x</italic><sup>7</sup> − 1, <italic>α</italic> ≈ 1.12725, <italic>ϵ</italic>(<italic>ℓ</italic>) decays as 1/<italic>ℓ</italic><sup>1/9</sup> (black). When <italic>α</italic> is second order, <italic>α</italic> = <italic>σ</italic> − 1/2 ≈ 1.11803, the initial decay is similar, but after a critical distance at <italic>ℓ</italic> ≈ 10<sup>6</sup> the decay becomes 1/<italic>ℓ</italic> (yellow). <bold>(f)</bold> The critical distance grows with the number of modules (<italic>α</italic><sub><italic>i</italic></sub> = (<italic>σ</italic> − 1/2)<sup><italic>i</italic></sup>). Grey shading in (e-f) indicates the range of phase difference smaller than noise (<xref ref-type="disp-formula" rid="pcbi.1005922.e106">Eq 26</xref>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005922.g007" xlink:type="simple"/>
</fig>
<p>To quantify the sensitivity of the grid system against the choice of the scale parameters we calculated the mean and the coefficient of variation of <inline-formula id="pcbi.1005922.e050"><alternatives><graphic id="pcbi.1005922.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> with random choices of <italic>α</italic> (<xref ref-type="fig" rid="pcbi.1005922.g007">Fig 7c and 7d</xref>). We found, that the average <inline-formula id="pcbi.1005922.e051"><alternatives><graphic id="pcbi.1005922.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> increased monotonically with the number of grid modules indicating that the system’s performance becomes closer to the ideal <inline-formula id="pcbi.1005922.e052"><alternatives><graphic id="pcbi.1005922.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> value as the number of modules increased (<xref ref-type="fig" rid="pcbi.1005922.g007">Fig 7c</xref>). Moreover, the variability of <inline-formula id="pcbi.1005922.e053"><alternatives><graphic id="pcbi.1005922.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> consistently decreased with the number of modules reflecting the improved robustness of the system to the choice of grid periods (<xref ref-type="fig" rid="pcbi.1005922.g007">Fig 7d</xref>). Therefore not only the maximal coding distance increases exponentially with the number of modules, but the basis of the exponential, <inline-formula id="pcbi.1005922.e054"><alternatives><graphic id="pcbi.1005922.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, also increases.</p>
<p>To further investigate the mechanisms responsible for the robustness of the system, we numerically evaluated the minimal phase difference between the modules, <italic>ϵ</italic>(<italic>ℓ</italic>), in the function of the distance (<xref ref-type="fig" rid="pcbi.1005922.g007">Fig 7e and 7f</xref>). In line with the predictions of the theory (<xref ref-type="disp-formula" rid="pcbi.1005922.e101">Eq 25</xref>), we found that the phase difference decreased with <italic>ℓ</italic><sup>−1/(<italic>M</italic>−1)</sup>, i.e., with a small negative power of the distance for <italic>α</italic> being an order <italic>M</italic> algebraic number (<xref ref-type="fig" rid="pcbi.1005922.g007">Fig 7e</xref>, black). For suboptimal <italic>α</italic>-s, the scaling of the phase difference was nearly optimal up to a critical point beyond which the scaling followed the algebraic rank of <italic>α</italic> (i.e., second order <italic>α</italic> scales with 1/ <italic>ℓ</italic>, <xref ref-type="fig" rid="pcbi.1005922.g007">Fig 7e</xref>, yellow). Importantly, this critical point, where the transition occurs between ideal and number theoretical scaling is located at increasingly larger distances when the number of modules is increased (<xref ref-type="fig" rid="pcbi.1005922.g007">Fig 7f</xref>). Therefore, the asymptotic, number theoretical properties of the grid periods have a gradually lower impact on the performance of the system in the distance range limited by the intrinsic variability on neuronal spiking (<xref ref-type="fig" rid="pcbi.1005922.g007">Fig 7e and 7f</xref>, background shading).</p>
<p>These observations suggest that even random scale choices might achieve optimal performance as the number of modules grow. In the next section we make this statement mathematically precise and demonstrate that indeed, <inline-formula id="pcbi.1005922.e055"><alternatives><graphic id="pcbi.1005922.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> approaches its theoretical maximum, 0.5, when the number of modules grow and the scales are chosen uniformly at random from a bounded interval.</p>
</sec>
<sec id="sec006">
<title>Capacity of non-geometric grid scales</title>
<p>Our number theoretic argument (<xref ref-type="disp-formula" rid="pcbi.1005922.e028">Eq 9</xref>) alone does not imply exponential capacity, since it does not exclude the possibility that the base of the exponential, <inline-formula id="pcbi.1005922.e056"><alternatives><graphic id="pcbi.1005922.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, converges to 0 as <italic>M</italic> increases (although we observed the opposite trend, see <xref ref-type="fig" rid="pcbi.1005922.g007">Fig 7c</xref>). In this section we investigate the asymptotic properties of the grid code when the number of modules increases and the relative uncertainty <italic>δ</italic> of the modules remains fixed. Here we only state these results informally, and leave the precise statements and the slightly technical mathematical proof to the Methods.</p>
<p>The main idea behind the proof is that the phase of a given module at particular distance <italic>x</italic> from the origin depends only on the scale of that module, <italic>α</italic>. If the scale is randomly chosen from a bounded interval [1, <italic>α</italic><sub>max</sub>], then the phase is also a random variable with probability distribution approaching the uniform distribution as the distance increases. Then, the probability of simultaneous interference between <italic>M</italic> modules, that is, the probability of all modules being near phase 0 at some distance <italic>x</italic>, is proportional to the volume of an M-dimensional hypercube, which is <italic>V</italic> = (2<italic>δ</italic>)<sup><italic>M</italic></sup>, where the side of the cube is 2<italic>δ</italic>. The ratio of the volume of the hypercube and the unit cube (the number of distinguishable phases) diminishes exponentially with <italic>M</italic>, and the total distance (expressed in units of <italic>α</italic><sup>0</sup> = 1) covered without ambiguity is <inline-formula id="pcbi.1005922.e057"><alternatives><graphic id="pcbi.1005922.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn> <mml:mi>δ</mml:mi></mml:mrow> <mml:mi>V</mml:mi></mml:mfrac> <mml:mo>∝</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>δ</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Specifically, our statement is, roughly speaking, that if 0 &lt; <italic>δ</italic> &lt; 1/2 is fixed, <italic>M</italic> is large enough, and the module scales are drawn uniformly at random from a not too narrow bounded interval, e.g. from (1, 2), then the representation is unambiguous up to the exponential distance
<disp-formula id="pcbi.1005922.e058"><alternatives><graphic id="pcbi.1005922.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e058" xlink:type="simple"/><mml:math display="block" id="M58"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="script">l</mml:mi> <mml:mo>&lt;</mml:mo> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:mrow> <mml:mi>δ</mml:mi></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula>
with probability approaching 1, and <inline-formula id="pcbi.1005922.e059"><alternatives><graphic id="pcbi.1005922.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> approaching 1/2. Although the above statement applies only for <italic>M</italic> → ∞, and it does not provide examples for efficient scale choices for finite <italic>M</italic>, we emphasise that this result is stronger than our previous derivation (<xref ref-type="disp-formula" rid="pcbi.1005922.e028">Eq 9</xref>) in four aspects: First, our previous derivation (<xref ref-type="disp-formula" rid="pcbi.1005922.e028">Eq 9</xref>) allowed <inline-formula id="pcbi.1005922.e060"><alternatives><graphic id="pcbi.1005922.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> to tend to 0 as <italic>M</italic> increased. Now we showed that this does not happen for random scale choices, rather the value of the constant tends to its theoretical maximum, <inline-formula id="pcbi.1005922.e061"><alternatives><graphic id="pcbi.1005922.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1005922.ref006">6</xref>] for large <italic>M</italic> with high probability, confirming our previous numerical results (<xref ref-type="fig" rid="pcbi.1005922.g007">Fig 7c</xref>). Second, one can achieve this nearly optimal performance without increasing the scales exponentially, with the scales chosen from a bounded interval. Third, this almost optimal efficiency is not only reached for some appropriately chosen scales, but for almost all choices. Fourth, near-optimal performance is guaranteed for 2 or higher dimensional grid codes even if the modules are randomly rotated relative to each other or in the absence of long-range coherence within the modules.</p>
<p>Thus, our results demonstrate that no meticulous tuning of the grid scales is required for close to optimal grid system performance.</p>
</sec>
</sec>
<sec id="sec007" sec-type="conclusions">
<title>Discussion</title>
<p>In this paper we developed a novel analytic technique to investigate the coding properties of grid cells. Using this technique, which is based on Diophantine approximation of real numbers by fractions of integers, we were able to derive several novel and non-trivial properties of the grid cell code. First, we demonstrated that on the long run, the capacity of the system depends heavily and chaotically on the number theoretic properties of the scale ratio between the successive modules. To achieve optimal performance in a system with <italic>M</italic> modules the scale ratio has to be an algebraic number of order <italic>M</italic>. Second, we showed that in the presence of neuronal noise the capacity of the grid code becomes increasingly more robust to the choice of the scale parameters when the number of modules is increased: when <italic>M</italic> &gt; 2, randomly chosen scales perform nearly as well as the optimal scales. Finally, we demonstrated that the capacity of MA and nested grid codes are asymptotically identical (in the large <italic>M</italic> limit), even for randomly chosen scale parameters for the MA codes.</p>
<sec id="sec008">
<title>Exponential coding range</title>
<p>Previous works used specific assumptions to derive exponential coding range for the grid cell coding system: they assumed either a nested coding scheme [<xref ref-type="bibr" rid="pcbi.1005922.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref006">6</xref>] or presumed that the phase space is covered evenly and that the readout noise in a given module decreases when the number of modules increases [<xref ref-type="bibr" rid="pcbi.1005922.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref014">14</xref>]. Here we generalised these findings and demonstrated that nested and MA codes have asymptotically equal capacity.</p>
<p>When we studied the capacity of MA codes we realised that achieving uniform coverage of the phase space is not trivial in the case of two modules, but can only be attained with appropriately chosen scales. Specifically, we recognised that approximately uniform coverage of the phase space by the phase curve at arbitrary distances is guaranteed if the scale ratio between the two modules is an algebraic number of order 2. Using our formalism allowed us to generalise this intuition for arbitrary number of grid modules and to demonstrate that even a random choice of grid scales guarantees uniform coverage of the phase space when the number of modules is high.</p>
<p>We also relaxed the assumption of an earlier study [<xref ref-type="bibr" rid="pcbi.1005922.ref014">14</xref>] that the total amount of the noise remains constant in the grid system even when the number of modules is increased, i.e., the readout error of each module decreases with <italic>M</italic>. Here we derived these results using the more general assumption that the coding precision of each module is independent of <italic>M</italic> and proportional to the scale of the module.</p>
<p>We confirmed our analytical results by extensive numerical simulations regarding the simultaneous interference between grid systems with various choices of the scale parameters. In line with previous results [<xref ref-type="bibr" rid="pcbi.1005922.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref009">9</xref>], our simulations supported that the grid system is robust to the choice of the scale parameter and that the coding range is exponential in the number of modules.</p>
</sec>
<sec id="sec009">
<title>Nested coding versus MA code</title>
<p>Although the efficiency of the coding investigated in this paper is slightly worse than that of the optimal nested coding [<xref ref-type="bibr" rid="pcbi.1005922.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref006">6</xref>], MA codes also have several advantages. First it uses orders of magnitude smaller scale lengths than the maximal distance up to which the coding works properly. The largest grid scales measured experimentally are ∼3 m [<xref ref-type="bibr" rid="pcbi.1005922.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref024">24</xref>] and extrapolations based on the dorso-ventral location of the recording electrodes within the entorhinal cortex extend to ∼10 m [<xref ref-type="bibr" rid="pcbi.1005922.ref013">13</xref>], a period still substantially smaller than the typical distances travelled daily by rodents (several hundreds of meters [<xref ref-type="bibr" rid="pcbi.1005922.ref025">25</xref>]) or bats (several kilometres, [<xref ref-type="bibr" rid="pcbi.1005922.ref026">26</xref>]; see also [<xref ref-type="bibr" rid="pcbi.1005922.ref027">27</xref>]).</p>
<p>Second, while the consequence of a module failure simple decreases the capacity of the system in the case of MA coding, it can have more dramatic effect in nested codes: Although malfunction of the largest or smallest module reduces either the capacity or the resolution of nested codes, respectively, the lack of intermediate modules functionally breaks the interaction between the remaining modules decreasing both the resolution and the capacity of the system in a disproportionate manner.</p>
<p>Third, once the scales are optimised for a given noise level, the coding range of nested grid codes does not depend on <italic>δ</italic>. Therefore, contrary to MA codes, it is not possible to increase the capacity by inserting more neurons into the same modules or by observing more grid cells from the same set of modules. Conversely, the functioning of the nested codes critically depends on accurate decoding of each module: If the readout neuron does not have access to enough presynaptic neurons from a given module, then the corresponding posterior becomes too wide leading to interference between the modules. This has similar consequences as the absence of the given module in nested codes. In contrast, in MA codes the coding properties remain similar for postsynaptic neurons receiving different number of synapses from different modules, although the coding range is the function of the precision available for the observer (<xref ref-type="disp-formula" rid="pcbi.1005922.e028">Eq 9</xref>).</p>
<p>When encoding dynamic trajectories instead of static locations, the number of neurons required to participate in a given module decreases quadratically with the scale of the module, i.e., <inline-formula id="pcbi.1005922.e062"><alternatives><graphic id="pcbi.1005922.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∼</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>α</mml:mi> <mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1005922.ref008">8</xref>]. For example, if representing the position in the 2D space with some fixed accuracy with <italic>α</italic><sub><italic>i</italic></sub> = 0.2 m requires ∼ 4000 neurons then <italic>α</italic><sub><italic>j</italic></sub> = 2 m needs only ∼ 40 neurons. This scaling implies that the coding range of the nested grid system can be easily and parsimoniously extended by adding a new module with larger scale but containing only relatively few neurons. Although the relationship between the number of neurons in a module and its scale holds also for MA codes, the total number of neurons required to achieve similar coding range can be substantially smaller in nested codes.</p>
<p>Another consequence of dynamical coding is that the time constant of the readout has to be matched to the scale of the grid modules [<xref ref-type="bibr" rid="pcbi.1005922.ref008">8</xref>]. As the grid scale varies over a large range in the case of nested codes, the postsynaptic neuron has to integrate inputs from different grid cells with time constants ranging from 1 ms to 1 second [<xref ref-type="bibr" rid="pcbi.1005922.ref008">8</xref>]. In MA codes, the modules have similar scales and their outputs can be integrated with similar time constants.</p>
<p>Finally we note that nested coding and MA coding are not mutually exclusive: although they imply fundamentally different way of decoding the same positional information [<xref ref-type="bibr" rid="pcbi.1005922.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref014">14</xref>], but both can be present in the same system. The MA code has a larger coding range if <inline-formula id="pcbi.1005922.e063"><alternatives><graphic id="pcbi.1005922.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mo>&gt;</mml:mo> <mml:mi>α</mml:mi> <mml:mi>δ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> so it is favoured by small <italic>α</italic> (small differences between scales) and small <italic>δ</italic> (high accuracy). Even in this case locations within the largest grid scale can be decoded as in nested coding, while MA decoder is required beyond this distance.</p>
</sec>
<sec id="sec010">
<title>Planar grid cells</title>
<p>In the Methods we show that the coding capacity of two or higher dimensional grid cells depend on the same number theoretic properties, and therefore the results obtained in dimension one extend to planar or cubic grid cells as well [<xref ref-type="bibr" rid="pcbi.1005922.ref028">28</xref>], provided that the main axes of the different modules remain aligned with each other.</p>
<p>If the two dimensional grid modules are rotated compared to each other, then the scale choices which perform well will be different from the scales that are optimal for axis aligned modules. Consider for example that <inline-formula id="pcbi.1005922.e064"><alternatives><graphic id="pcbi.1005922.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mrow><mml:mi>α</mml:mi> <mml:mo>=</mml:mo> <mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>, which is a relatively good choice for <italic>M</italic> = 2 (rightmost red circle in <xref ref-type="fig" rid="pcbi.1005922.g005">Fig 5a–5c</xref>), leads to cathastrophic interference at <italic>ℓ</italic> = <italic>α</italic> when the grids are rotated by 30°. Consequently, the incoherent reorientation of the grid modules during global remapping [<xref ref-type="bibr" rid="pcbi.1005922.ref013">13</xref>] renders the optimisation of the grid scales unfeasible. However, the main point of this paper is that we have shown analytically that almost all scale choices perform near optimally if the number of modules is high enough, which also applies for grid cells rotated uniformly at random relative to each other (<xref ref-type="sec" rid="sec013">Methods</xref>).</p>
<p>Moreover, the 2D grids does not need to show perfect triangular symmetry to achieve high capacity: environmental boundaries [<xref ref-type="bibr" rid="pcbi.1005922.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref024">24</xref>] or non-euclidean geometry [<xref ref-type="bibr" rid="pcbi.1005922.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref031">31</xref>] can distort the grid pattern, but as long as the distortion is coherent among modules, our theory applies unchanged. If the scales slightly vary on the long range, then our derivation based on the Diophantine approximations does not apply. However, our derivation stating exponential capacity for grid systems with many random scales (<xref ref-type="sec" rid="sec013">Methods</xref>) remains still valid.</p>
</sec>
<sec id="sec011">
<title>Optimization and robustness</title>
<p>The highly organised, regular patterns formed by the firing fields of grid cells suggest that the characteristics of the grids must be closely related to the computational function of these neurons: optimally representing and processing information about the spatial location of the animal [<xref ref-type="bibr" rid="pcbi.1005922.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref011">11</xref>]. Besides the general optimality of triangular grid-like firing fields for representing unbounded 2D space [<xref ref-type="bibr" rid="pcbi.1005922.ref028">28</xref>], recent theoretical work derived optimal scale ratio of successive grid modules in the case of nested coding [<xref ref-type="bibr" rid="pcbi.1005922.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref008">8</xref>].</p>
<p>These studies, using different assumptions, arrived at slightly different conclusions regarding the optimal value of <italic>α</italic>. Stemmler et al., [<xref ref-type="bibr" rid="pcbi.1005922.ref007">7</xref>] fixed both the coding range to <italic>L</italic><sub>max</sub> = 3 for a pair of grid modules with scales {1, <italic>α</italic>} and found that <italic>α</italic> = 3/2 minimises the ambiguity errors within that range. Mathis et al., [<xref ref-type="bibr" rid="pcbi.1005922.ref004">4</xref>] and Wei et al., [<xref ref-type="bibr" rid="pcbi.1005922.ref006">6</xref>] also fixed the coding range and minimised the number of neurons required to achieve a given resolution and provided both estimates for the maximal capacity of the grid cell coding system and a specific architecture (i.e., optimised nested codes) that achieves maximal efficiency. The optimal scale ratio for nested codes was found to depend both on the magnitude of the noise in the system and on the type of decoder [<xref ref-type="bibr" rid="pcbi.1005922.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref006">6</xref>]. Rather than fixing the coding range, we were interested in grid codes that work for potentially unbounded environments and found a similar asymptotic capacity for MA codes using random grid scales. Although predictions derived from nested coding roughly agree with the average scale ratio observed in the entorhinal cortex [<xref ref-type="bibr" rid="pcbi.1005922.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref029">29</xref>], they do not explain the substantial amount of variability which characterises the data.</p>
<p>In our derivations we assumed that the decoding error of a given grid module is larger than <italic>δ</italic> with some small probability. Inaccurate decoding of a single grid module can lead to disproportionally high error in the position representation if the subsequent time frames are decoded independently [<xref ref-type="bibr" rid="pcbi.1005922.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref009">9</xref>]. However, the chance of catastrophic ambiguity errors can be substantially reduced if a dynamical decoder combines prior information representing the predicted spatial position with the location encoded by the incoming grid cell spikes [<xref ref-type="bibr" rid="pcbi.1005922.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref008">8</xref>].</p>
<p>Our results based on the Diophantine approximations requires that the scale of the modules are set precisely, so that the phase of the different modules does not drift relative to each other (i.e., <inline-formula id="pcbi.1005922.e065"><alternatives><graphic id="pcbi.1005922.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mtext>d</mml:mtext> <mml:mi>x</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mtext>d</mml:mtext> <mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>). Although theoretical considerations suggest that drift can not be completely suppressed in a noisy neuronal system [<xref ref-type="bibr" rid="pcbi.1005922.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref036">36</xref>], whether different grid modules respond coherently to distortions caused by environmental manipulations is not known [<xref ref-type="bibr" rid="pcbi.1005922.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref024">24</xref>]. The remarkable robustness of the grid system’s efficiency against the choice of the scale ratio suggests that grids with loosely set scale parameters could also obtain a similar performance. Indeed, our derivation using randomly selected grid scales does not require precisely set scale parameters yet it provides the asymptotically exponential capacity for the grid system.</p>
<p>The optimization principle assumes that substantial improvement in the performance of the system can be achieved with precise tuning of its parameters. In the present study we demonstrated that this is indeed the case in the absence of noise. However, even in this case, optimization would be almost unfeasible for three reasons. First, the coding range is an extremely irregular, discontinuous function of the scale parameter, making optimisation essentially a trial and error game. Second, a scale parameter that is optimal for a given number of modules is guaranteed to be inefficient when the number of modules is increased precluding the possibility of pairwise or modular optimization. Finally, the optimal grid scales depend on the rotation of the modules relative to each other, which can change independently during changes in the environment [<xref ref-type="bibr" rid="pcbi.1005922.ref013">13</xref>].</p>
<p>However, taking the variability of neuronal firing into account changes the picture dramatically. We demonstrated that when the coding accuracy of grid modules is limited by neuronal noise, the capacity of the system becomes surprisingly robust to the choice of the scale parameters making its optimization unnecessary. Note, that even if the grid periods are not optimized across modules, generating the regular, periodic firing fields of grid cells demands accurate integration of velocity inputs [<xref ref-type="bibr" rid="pcbi.1005922.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref036">36</xref>] and repeated error correction [<xref ref-type="bibr" rid="pcbi.1005922.ref038">38</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref035">35</xref>], both requiring the precise tuning of single neuron and network parameters within a given module. In conclusion, our study demonstrates that the capacity of the grid cell system is nearly optimal with randomly chosen grid scales, and, instead of accurate parameter tuning, the experimentally observed scales could reflect the combined effect of random fluctuations and a gradient in the cellular properties along the dorso-ventral axis of the entorhinal cortex [<xref ref-type="bibr" rid="pcbi.1005922.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref040">40</xref>].</p>
</sec>
<sec id="sec012">
<title>Predictions</title>
<p>Our finding, that grid cells have an exponentially large coding range even with randomly chosen grid scales of similar magnitudes makes several important predictions. First, MA coding predicts that the coding range is substantially larger than the largest grid period. Since grid cells are likely to be involved in path integration [<xref ref-type="bibr" rid="pcbi.1005922.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref041">41</xref>] this prediction could be tested by probing path integration abilities of rodents beyond distances of the largest grid period [<xref ref-type="bibr" rid="pcbi.1005922.ref042">42</xref>].</p>
<p>Second, in the case of MA coding, different modules have similar contributions to the coding range of the system. Therefore, the effect of targeted dMEC lesion (inactivating a single module, as in [<xref ref-type="bibr" rid="pcbi.1005922.ref043">43</xref>]) on the rat’s navigation behaviour would be largely independent of the actual location of the lesion (i.e., which module is inactivated).</p>
<p>Third, since the performance of the system is independent of the precise choice of the grid scales, we expect a large variability in the scale ratio of successive grid modules both within and across animals. This prediction is consistent with the experimental data available [<xref ref-type="bibr" rid="pcbi.1005922.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref029">29</xref>], although further statistical analysis would be required to specifically determine the distribution of scale ratios.</p>
<p>Finally, we predict that the performance of the system is not particularly sensitive to incoherent changes in the scale parameter of a subset of modules during e.g., global remapping induced by environmental changes [<xref ref-type="bibr" rid="pcbi.1005922.ref016">16</xref>]. It has been shown that under certain conditions simultaneously recorded grid cells respond coherently within a module and independently across modules to environmental distortions [<xref ref-type="bibr" rid="pcbi.1005922.ref013">13</xref>]. To test the prediction of our theory, the behavioural consequences of incoherent realignment across modules should be assessed and compared with the effects of environmental manipulations inducing coherent realignment [<xref ref-type="bibr" rid="pcbi.1005922.ref029">29</xref>] or coherent distortion in the shape of the grid pattern [<xref ref-type="bibr" rid="pcbi.1005922.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref031">31</xref>].</p>
</sec>
</sec>
<sec id="sec013" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec014">
<title>Grid cells in the 2D plane</title>
<p>Consider a system <italic>G</italic><sup>2</sup> of planar grid cells with a set of scales <inline-formula id="pcbi.1005922.e066"><alternatives><graphic id="pcbi.1005922.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:mi mathvariant="script">A</mml:mi></mml:math></alternatives></inline-formula>. Suppose that the axis of all modules are aligned and use the coordinate system
<disp-formula id="pcbi.1005922.e067"><alternatives><graphic id="pcbi.1005922.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e067" xlink:type="simple"/><mml:math display="block" id="M67"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">B</mml:mi> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:mn>0</mml:mn> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:mrow><mml:mo>[</mml:mo> <mml:mo form="prefix">cos</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mn>60</mml:mn> <mml:mo>°</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:mo form="prefix">sin</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mn>60</mml:mn> <mml:mo>°</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>}</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
which is naturally generated by the triangular lattice. To compare with consider the one dimensional grid cell system <italic>G</italic><sup>1</sup> which has the same number of modules with the same set of scales, and for which each module represents the position of the animal with the same relative precision. To achieve this, the two dimensional modules need squared as many cells, nevertheless they also able to distinguish between squared as many spatial positions within one period of the scale.</p>
<p>If <italic>G</italic><sup>2</sup> represents a planar position <inline-formula id="pcbi.1005922.e068"><alternatives><graphic id="pcbi.1005922.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">B</mml:mi></mml:msub></mml:math></alternatives></inline-formula> ambiguously, i.e., <inline-formula id="pcbi.1005922.e069"><alternatives><graphic id="pcbi.1005922.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:mrow><mml:mi mathvariant="bold-italic">ψ</mml:mi> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">B</mml:mi></mml:msub> <mml:mo>≈</mml:mo> <mml:mi mathvariant="bold-italic">ψ</mml:mi> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">B</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, then clearly planar positions <inline-formula id="pcbi.1005922.e070"><alternatives><graphic id="pcbi.1005922.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">B</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005922.e071"><alternatives><graphic id="pcbi.1005922.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">B</mml:mi></mml:msub></mml:math></alternatives></inline-formula> are also represented ambiguously. Therefore, the corresponding one dimensional positions <italic>x</italic> and <italic>y</italic> are represented ambiguously by <italic>G</italic><sup>1</sup> as well. Conversely, if <italic>z</italic> is represented ambiguously by <italic>G</italic><sup>1</sup>, then <inline-formula id="pcbi.1005922.e072"><alternatives><graphic id="pcbi.1005922.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>z</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">B</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005922.e073"><alternatives><graphic id="pcbi.1005922.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">B</mml:mi></mml:msub></mml:math></alternatives></inline-formula> will be ambiguous in <italic>G</italic><sup>2</sup>. Therefore, an ambiguity of position at a given distance from the origin in case of planar cells can be matched to an ambiguity at the same order of magnitude of distance in the one dimensional grid system, and vica versa. The above argument also shows that the same scale choices perform best for both one dimensional grid cells and two or higher dimensional ones when the axes are aligned with each other.</p>
</sec>
<sec id="sec015">
<title>Estimating the precision of a single module</title>
<p>We chose <italic>α</italic><sub>0</sub> = 1 and fix the resolution of the system to <italic>δ</italic> &lt; <italic>α</italic><sub>0</sub> (defined below) and investigate its coding range. A formally identical system with a fixed coding range and optimised resolution can be achieved by appropriately rescaling the grid scales.</p>
<p>We numerically estimated the precision of position coding by a single module by first simulating the motion of the animal as a one dimensional Gaussian random walk:
<disp-formula id="pcbi.1005922.e074"><alternatives><graphic id="pcbi.1005922.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e074" xlink:type="simple"/><mml:math display="block" id="M74"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mspace width="0.166667em"/><mml:mi>D</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
with Δ<italic>t</italic> = 1 ms temporal resolution and <italic>D</italic> = 0.005 m<sup>2</sup>/s, which gives ≈ 5 cm displacement in 0.5 s [<xref ref-type="bibr" rid="pcbi.1005922.ref008">8</xref>]. We simulated the activity of <italic>N</italic> = [10, 300] grid cells from a single module. Grid cells had a circular tuning curve:
<disp-formula id="pcbi.1005922.e075"><alternatives><graphic id="pcbi.1005922.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e075" xlink:type="simple"/><mml:math display="block" id="M75"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>r</mml:mi> <mml:mi>k</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtext>sin</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>λ</mml:mo></mml:mrow></mml:mfrac> <mml:mo>−</mml:mo> <mml:msup><mml:mi>ϕ</mml:mi> <mml:mi>k</mml:mi></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>n</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(13)</label></disp-formula>
with the following parameters: <italic>r</italic><sub>max</sub> = 15 Hz, <italic>r</italic><sub>0</sub> = 0.1 Hz, λ = 0.25 m and <italic>ϕ</italic><sup><italic>k</italic></sup> chosen to uniformly cover the interval [0, 2<italic>π</italic>]. The power <italic>n</italic> = 22 was set to match the mean firing rate of the grid cells, 〈<italic>r</italic>(<italic>x</italic>)〉 = 2.5 Hz, to experimental data [<xref ref-type="bibr" rid="pcbi.1005922.ref016">16</xref>]. Larger (λ = 2.5 m) grid spacing was modelled by decreasing the speed of the animal by a factor of 10 (<italic>D</italic> = 0.00005 m<sup>2</sup>/s). The firing rate is shown in <xref ref-type="fig" rid="pcbi.1005922.g001">Fig 1b</xref>, right (olive).</p>
<p>Spike trains were generated as an inhomogeneous Poisson process with neurons conditionally independent given the simulated location:
<disp-formula id="pcbi.1005922.e076"><alternatives><graphic id="pcbi.1005922.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e076" xlink:type="simple"/><mml:math display="block" id="M76"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msubsup> <mml:mo>|</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mtext>Poisson</mml:mtext> <mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>r</mml:mi> <mml:mi>k</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula></p>
<p>Spikes of the neurons in module <italic>i</italic>, <bold>s</bold><sub>0:<italic>t</italic>,<italic>i</italic></sub>, represent the spatial location of the animal with error <italic>δ α</italic><sub><italic>i</italic></sub> (i.e., with the same <italic>δ</italic> phase error for all modules) which can be interpreted as the width of the (periodic) posterior probability distribution <italic>P</italic>(<italic>x</italic>|<bold>s</bold><sub>0:<italic>t</italic>,<italic>i</italic></sub>). For an ideal observer this posterior distribution quantifies how much a given spatial location is consistent with the observed spike pattern. The posterior distribution of the position was numerically calculated by recursive Bayesian filtering:
<disp-formula id="pcbi.1005922.e077"><alternatives><graphic id="pcbi.1005922.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e077" xlink:type="simple"/><mml:math display="block" id="M77"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">s</mml:mi> <mml:mrow><mml:mn mathvariant="bold">0</mml:mn> <mml:mo>:</mml:mo> <mml:mi mathvariant="bold">t</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>∝</mml:mo> <mml:mspace width="0.166667em"/><mml:munder><mml:mo>∏</mml:mo> <mml:mi>k</mml:mi></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msubsup> <mml:mo>|</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>∫</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">s</mml:mi> <mml:mrow><mml:mn mathvariant="bold">0</mml:mn> <mml:mo>:</mml:mo> <mml:mi mathvariant="bold">t</mml:mi> <mml:mo>-</mml:mo> <mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
The colormap in <xref ref-type="fig" rid="pcbi.1005922.g001">Fig 1b</xref> shows this posterior distribution with <italic>N</italic> = 50 cells and λ = 0.25 m.</p>
<p>Naturally, the width of the posterior depends on several factors, most importantly on the number of neurons observed in a given module and on the scale of the modules relative to the typical speed of the animal [<xref ref-type="bibr" rid="pcbi.1005922.ref008">8</xref>]. At each timestep the posterior distribution was fitted with a von Mises distribution with a location <italic>μ</italic><sub><italic>t</italic></sub> and a concentration parameter <italic>κ</italic><sub><italic>t</italic></sub>. The width of the posterior relative to the grid scale was estimated as:
<disp-formula id="pcbi.1005922.e078"><alternatives><graphic id="pcbi.1005922.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e078" xlink:type="simple"/><mml:math display="block" id="M78"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>δ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mo>λ</mml:mo> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msqrt><mml:msub><mml:mi>κ</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
For analytic tractability, we use a bounded noise model in the derivations assuming that the location decoded from the spikes of a module is within <italic>δ</italic> <italic>α</italic><sub><italic>i</italic></sub> distance from the true location. To be conservative, we chose <italic>δ</italic> to be the 99% of the empirical CDF of <italic>δ</italic><sub><italic>t</italic></sub>. The largest <italic>δ</italic> = 0.12 was found with λ = 0.25 m and <italic>N</italic> = 10 cells. The smallest <italic>δ</italic> = 0.01 corresponds to the parameters λ = 2.5 m and <italic>N</italic> = 300 cells.</p>
<p>We assume that the modules are conditionally independent given the location of the animal, and hence position decoding, or representation, can be implemented by an ideal observer independently reading out the spikes, <bold>s</bold><sub><italic>i</italic></sub>, emitted by the different modules: <italic>P</italic>(<italic>x</italic>|<bold>s</bold>) = ∏<sub><italic>i</italic></sub> <italic>P</italic>(<italic>x</italic>|<bold>s</bold><sub><italic>i</italic></sub>). When loosely talking about interference between the grid modules at a spatial point we refer to the interference between these periodic posterior distributions <italic>P</italic>(<italic>x</italic>|<bold>s</bold><sub><italic>i</italic></sub>), i.e., all module posteriors being larger than 0 at a location different from the origin (<xref ref-type="fig" rid="pcbi.1005922.g001">Fig 1c</xref>).</p>
</sec>
<sec id="sec016">
<title>Interference at integer distances</title>
<p>Since we measure the distance in units of the smallest grid scale (<italic>α</italic><sub>0</sub> = 1), avoiding interference at integer distances from the origin also guarantees the absence of interference elsewhere, i.e., all positions in the interval [0, <italic>L</italic>] will be distinguishable by the grid code. Hence we loosely call <italic>ϵ</italic>(<italic>ℓ</italic>) defined in <xref ref-type="disp-formula" rid="pcbi.1005922.e002">Eq 1</xref> the phase difference, but note that it is the phase difference at integer distance <italic>ℓ</italic>. Indeed, if the grid code was ambiguous confusing spatial locations <italic>x</italic><sub>1</sub> and <italic>x</italic><sub>2</sub>, then it would also confuse the origin with |<italic>x</italic><sub>1</sub> − <italic>x</italic><sub>2</sub>| as well, since the phase differences of each module are the same between 0 and |<italic>x</italic><sub>1</sub> − <italic>x</italic><sub>2</sub>| and between <italic>x</italic><sub>1</sub> and <italic>x</italic><sub>2</sub> (<xref ref-type="fig" rid="pcbi.1005922.g002">Fig 2b and 2c</xref>, right). But |<italic>x</italic><sub>1</sub> − <italic>x</italic><sub>2</sub>| can be confused with the origin only if |<italic>x</italic><sub>1</sub> − <italic>x</italic><sub>2</sub>| is an integer, that is a multiple of the smallest scale, 1. Note that this argument is correct only if the phase representation ambiguity of each module is independent of the actual position, which holds if we suppose that firing fields of cells from the same module are spaced evenly, which we do assume.</p>
<p>Graphically, interference between locations occurs when two segments of the phase curve come close to each other. Since the segments of the phase curve are parallel (<xref ref-type="fig" rid="pcbi.1005922.g002">Fig 2</xref>), and we started the phase curve in the origin, interference first occurs in the origin. Avoiding interference at the origin as much as possible at arbitrary distances thus also guarantees that the segments of the phase curve are separated from each other as much as possible, leading to a uniform coverage of the phase space [<xref ref-type="bibr" rid="pcbi.1005922.ref014">14</xref>].</p>
</sec>
<sec id="sec017">
<title>Definition of algebraic numbers</title>
<p>We call a real number <italic>α</italic> algebraic of order <italic>n</italic> (positive integer), if <italic>n</italic> is the least integer such that <italic>α</italic> is the root of a polynomial of degree <italic>n</italic> with integer coefficients. Algebraic numbers of order one are exactly the rational numbers. Another example is the golden ratio, <italic>σ</italic>, which is irrational, and is the root of <italic>x</italic><sup>2</sup> − <italic>x</italic> − 1, a integer polinomial of degree two. Therefore, <italic>σ</italic> is an algebraic number of order two.</p>
</sec>
<sec id="sec018">
<title>Information rate</title>
<p>Since we fixed the resolution, the capacity of the code is proportional to the coding range. Moreover, as the coding precision of the modules was the same, we assume that the population size of each module is approximately <italic>N</italic> for grid scales chosen randomly from a bounded interval. The information rate of the grid system, defined as the ratio of the logarithm of the capacity and the total number of conveyed bits [<xref ref-type="bibr" rid="pcbi.1005922.ref014">14</xref>] is
<disp-formula id="pcbi.1005922.e079"><alternatives><graphic id="pcbi.1005922.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e079" xlink:type="simple"/><mml:math display="block" id="M79"><mml:mrow><mml:mi>ρ</mml:mi> <mml:mrow><mml:mo>∝</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>N</mml:mi> <mml:mi>M</mml:mi></mml:mrow></mml:mfrac> <mml:mtext>log</mml:mtext> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi>α</mml:mi></mml:msub></mml:mrow> <mml:mi>δ</mml:mi></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></alternatives> <label>(17)</label></disp-formula>
<disp-formula id="pcbi.1005922.e080"><alternatives><graphic id="pcbi.1005922.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e080" xlink:type="simple"/><mml:math display="block" id="M80"><mml:mrow><mml:mo>∝</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>N</mml:mi></mml:mrow></mml:mfrac> <mml:mo form="prefix">log</mml:mo> <mml:mfrac><mml:msub><mml:mi>c</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:mi>δ</mml:mi></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(18)</label></disp-formula>
<disp-formula id="pcbi.1005922.e081"><alternatives><graphic id="pcbi.1005922.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e081" xlink:type="simple"/><mml:math display="block" id="M81"><mml:mrow><mml:mo>∝</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>N</mml:mi></mml:mrow></mml:mfrac> <mml:mo form="prefix">log</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:mo form="prefix">log</mml:mo> <mml:mi>N</mml:mi></mml:mrow> <mml:mi>k</mml:mi></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(19)</label></disp-formula>
where <inline-formula id="pcbi.1005922.e082"><alternatives><graphic id="pcbi.1005922.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the average firing rate of a grid cell and in the third line we used that <italic>δ</italic> = <italic>k</italic>/log(<italic>N</italic>) [<xref ref-type="bibr" rid="pcbi.1005922.ref014">14</xref>]. Thus, the information rate is independent of the number of modules and increases with log <italic>c</italic><sub><italic>α</italic></sub>.</p>
<p>For a geometric code with scale ratio <italic>α</italic> the optimal population size for dynamical decoding and constant <italic>δ</italic> decreases as <inline-formula id="pcbi.1005922.e083"><alternatives><graphic id="pcbi.1005922.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>/</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>/</mml:mo> <mml:msup><mml:mi>α</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> where λ<sub><italic>i</italic></sub> = <italic>α</italic><sup><italic>i</italic></sup> is the scale of module <italic>i</italic> and <italic>n</italic><sub>0</sub> is the number of neurons in the first module [<xref ref-type="bibr" rid="pcbi.1005922.ref008">8</xref>]. In this case the total number of neurons in the population is
<disp-formula id="pcbi.1005922.e084"><alternatives><graphic id="pcbi.1005922.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e084" xlink:type="simple"/><mml:math display="block" id="M84"><mml:mi mathvariant="bold">N</mml:mi> <mml:mrow><mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msub><mml:mi>n</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>/</mml:mo> <mml:msup><mml:mi>α</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>i</mml:mi></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:msup><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(20)</label></disp-formula>
Since the total number of neurons does not grow linearly with the number of modules, the information rate becomes proportional to <italic>M</italic>:
<disp-formula id="pcbi.1005922.e085"><alternatives><graphic id="pcbi.1005922.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e085" xlink:type="simple"/><mml:math display="block" id="M85"><mml:mi>ρ</mml:mi> <mml:mrow><mml:mo>∝</mml:mo> <mml:mi>M</mml:mi> <mml:mfrac><mml:mrow><mml:msup><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfrac> <mml:mo form="prefix">log</mml:mo> <mml:mfrac><mml:msub><mml:mi>c</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:mi>δ</mml:mi></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(21)</label></disp-formula>
Although a constraint on the minimal number of cells per module will limit the finite information rate to remain finite, <xref ref-type="disp-formula" rid="pcbi.1005922.e085">Eq 21</xref> emphasises that adding further modules with larger periods increases the efficiency of the grid system if the number of cells per module is set optimally for dynamical decoding [<xref ref-type="bibr" rid="pcbi.1005922.ref008">8</xref>]. Although a geometric progression of scales is consistent with both nested and MA codes, the information rate is higher for optimal nested codes since they maximise <italic>α</italic>.</p>
</sec>
<sec id="sec019">
<title>Interference with <italic>M</italic> modules I: Golden ratio is suboptimal</title>
<p>In this section we demonstrate that a set of grid cells with scale ratio (<italic>α</italic>) optimally chosen between pairs of successive grid modules is close to being pessimal for efficient space representation for <italic>M</italic> &gt; 2. Such pairwise optimisation leads to a set of scales showing geometric progression with the scale ratio being <italic>α</italic>, i.e., [1, <italic>α</italic>, <italic>α</italic><sup>2</sup>, …], which is consistent with the experimental data [<xref ref-type="bibr" rid="pcbi.1005922.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref013">13</xref>]. The representation of the position becomes ambiguous if all modules show interference at the same location, i.e., the phase of all modules are very close to 0 at distance <italic>ℓ</italic> from the origin.</p>
<p>Consider for example the golden ratio <italic>α</italic> = <italic>σ</italic>, which is a second order algebraic number, i.e., it is the root of the integer coefficient polynomial <italic>x</italic><sup>2</sup> − <italic>x</italic> − 1. Therefore, the phase <italic>ψ</italic><sub>2</sub>(<italic>x</italic>) = (<italic>x</italic> mod <italic>σ</italic><sup>2</sup>)/<italic>σ</italic><sup>2</sup> of any spatial point <italic>x</italic> according to the third module can be simply expressed with the phase of the first two modules as
<disp-formula id="pcbi.1005922.e086"><alternatives><graphic id="pcbi.1005922.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e086" xlink:type="simple"/><mml:math display="block" id="M86"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mspace width="4.pt"/><mml:mtext>mod</mml:mtext> <mml:mspace width="4.pt"/><mml:mn>1</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(22)</label></disp-formula>
To see this, consider that by the definition of the phases <italic>ψ</italic><sub><italic>i</italic></sub>(<italic>x</italic>) when the animal is at distance <italic>x</italic> from the origin there are some integers <italic>ℓ</italic>, <italic>k</italic><sub>1</sub>, <italic>k</italic><sub>2</sub> so that
<disp-formula id="pcbi.1005922.e087"><alternatives><graphic id="pcbi.1005922.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e087" xlink:type="simple"/><mml:math display="block" id="M87"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>x</mml:mi> <mml:mo>=</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>σ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Using that <italic>σ</italic><sup>2</sup> − <italic>σ</italic> − 1 = 0 we get that
<disp-formula id="pcbi.1005922.e088"><alternatives><graphic id="pcbi.1005922.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e088" xlink:type="simple"/><mml:math display="block" id="M88"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Rearranging terms yields
<disp-formula id="pcbi.1005922.e089"><alternatives><graphic id="pcbi.1005922.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e089" xlink:type="simple"/><mml:math display="block" id="M89"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mspace width="4.pt"/><mml:mtext>mod</mml:mtext> <mml:mspace width="4.pt"/><mml:mn>1</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>In other words, the phase of the third module provides no additional information given the phase of the other two modules. In particular, if both <italic>ψ</italic><sub>0</sub>(<italic>x</italic>) and <italic>ψ</italic><sub>1</sub>(<italic>x</italic>) are close to 0 (<xref ref-type="fig" rid="pcbi.1005922.g006">Fig 6b</xref>), then so is <italic>ψ</italic><sub>2</sub>(<italic>x</italic>) and hence the third module fails to resolve the ambiguity when the two first modules interfere. Similarly, if we have <italic>n</italic> grid cell modules with scales 1, <italic>α</italic>, …, <italic>α</italic><sup><italic>n</italic>−1</sup> with <italic>α</italic> being an algebraic number of order <italic>k</italic> &lt; <italic>n</italic>, then all of the <italic>n</italic> phases can be expressed by any <italic>k</italic> of them, leading to redundant and inefficient representation.</p>
<p>Clearly the same argument works not only for the powers of the golden ratio, but for powers of any algebraic number of order lower than the number of modules.</p>
</sec>
<sec id="sec020">
<title>Interference with <italic>M</italic> modules II</title>
<p>To derive the general solution for <italic>M</italic> grid modules, we consider a set of 1-dimensional grids with scales <italic>α</italic><sub>0</sub> = 1 &lt; <italic>α</italic><sub>1</sub> &lt; ⋯ &lt; <italic>α</italic><sub><italic>M</italic> −1</sub>. Again, the interference between the modules can be expressed by the simultaneous Diophantine approximation of the vector <inline-formula id="pcbi.1005922.e090"><alternatives><graphic id="pcbi.1005922.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:mrow><mml:mi mathvariant="script">A</mml:mi> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> using fractions of integers with the common numerator <italic>ℓ</italic>, i.e., <italic>α</italic><sub><italic>i</italic></sub> ≈ <italic>ℓ</italic>/<italic>k</italic><sub><italic>i</italic></sub>. Importantly, a theorem by Dirichlet provides an upper bound on the efficiency of the approximation. Namely, for all (<italic>M</italic> − 1)-tuple of irrational numbers <italic>α</italic><sub>1</sub>, …, <italic>α</italic><sub><italic>M</italic> −1</sub> we have infinitely many collections of integers <italic>k</italic><sub>0</sub>, <italic>k</italic><sub>1</sub>, …, <italic>k</italic><sub><italic>M</italic> −1</sub> (with <italic>k</italic><sub>0</sub> = <italic>ℓ</italic>), such that the approximation error defined as
<disp-formula id="pcbi.1005922.e091"><alternatives><graphic id="pcbi.1005922.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e091" xlink:type="simple"/><mml:math display="block" id="M91"><mml:mrow><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:msub><mml:mrow/> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">l</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msub><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives> <label>(23)</label></disp-formula>
is simultaneously smaller than the upper bound for all items in the tuple:
<disp-formula id="pcbi.1005922.e092"><alternatives><graphic id="pcbi.1005922.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e092" xlink:type="simple"/><mml:math display="block" id="M92"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mfrac> <mml:mspace width="2.em"/><mml:mrow><mml:mo>(</mml:mo> <mml:mo>∀</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mi>i</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula>
Note, that <inline-formula id="pcbi.1005922.e093"><alternatives><graphic id="pcbi.1005922.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e093" xlink:type="simple"/><mml:math display="inline" id="M93"><mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> differs from <italic>ϵ</italic> defined for two modules (<xref ref-type="disp-formula" rid="pcbi.1005922.e004">Eq 2</xref>) as it is not normalised with <italic>α</italic>.</p>
<p><italic>Proof of</italic> <xref ref-type="disp-formula" rid="pcbi.1005922.e092">Eq 24</xref>. First we prove that any vector of irrationals can be approximated to the claimed order with rationals having the same denominator. Let <inline-formula id="pcbi.1005922.e094"><alternatives><graphic id="pcbi.1005922.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e094" xlink:type="simple"/><mml:math display="inline" id="M94"><mml:mrow><mml:mi mathvariant="script">A</mml:mi> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. To approximate <inline-formula id="pcbi.1005922.e095"><alternatives><graphic id="pcbi.1005922.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e095" xlink:type="simple"/><mml:math display="inline" id="M95"><mml:mi mathvariant="script">A</mml:mi></mml:math></alternatives></inline-formula> with rationals of denominator at most <italic>Q</italic> let us define the vectors <inline-formula id="pcbi.1005922.e096"><alternatives><graphic id="pcbi.1005922.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e096" xlink:type="simple"/><mml:math display="inline" id="M96"><mml:mrow><mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>j</mml:mi> <mml:mi mathvariant="script">A</mml:mi> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>⌊</mml:mo> <mml:mi>j</mml:mi> <mml:mi mathvariant="script">A</mml:mi> <mml:mo>⌋</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <italic>j</italic> = 0, …, <italic>Q</italic>, where floor is understood coordinate-wise. Let us partition the unit cube [0, 1]<sup><italic>n</italic>−1</sup> into small cubes of side length <italic>Q</italic><sup>−1/(<italic>n</italic>−1)</sup>, so that altogether we have <italic>Q</italic> of them. Since we have <italic>Q</italic> + 1 many <bold>a</bold><sub><italic>j</italic></sub>-s each falling into [0, 1]<sup><italic>n</italic>−1</sup>, hence there will be (at least) 2 of them falling into the same small cube, <bold>a</bold><sub><italic>k</italic></sub> and <bold>a</bold><sub><italic>l</italic></sub>, say. Then
<disp-formula id="pcbi.1005922.e097"><alternatives><graphic id="pcbi.1005922.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e097" xlink:type="simple"/><mml:math display="block" id="M97"><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mi>l</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="script">A</mml:mi> <mml:mo>-</mml:mo> <mml:mo>|</mml:mo> <mml:mrow><mml:mo>⌊</mml:mo> <mml:mi>k</mml:mi> <mml:mi mathvariant="script">A</mml:mi> <mml:mo>⌋</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>⌊</mml:mo> <mml:mi>l</mml:mi> <mml:mi mathvariant="script">A</mml:mi> <mml:mo>⌋</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mo>≤</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>≤</mml:mo></mml:mrow> <mml:msup><mml:mi>Q</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
with the inequalities holding coordinate-wise. Therefore, because of |<italic>k</italic> − <italic>l</italic>| ≤ <italic>Q</italic>, <inline-formula id="pcbi.1005922.e098"><alternatives><graphic id="pcbi.1005922.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e098" xlink:type="simple"/><mml:math display="inline" id="M98"><mml:mi mathvariant="script">A</mml:mi></mml:math></alternatives></inline-formula> is approximable with denominator |<italic>k</italic> − <italic>l</italic>| and numerator (vector) <inline-formula id="pcbi.1005922.e099"><alternatives><graphic id="pcbi.1005922.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e099" xlink:type="simple"/><mml:math display="inline" id="M99"><mml:mrow><mml:mo>|</mml:mo> <mml:mo>⌊</mml:mo> <mml:mi>k</mml:mi> <mml:mi mathvariant="script">A</mml:mi> <mml:mo>⌋</mml:mo> <mml:mo>-</mml:mo> <mml:mo>⌊</mml:mo> <mml:mi>l</mml:mi> <mml:mi mathvariant="script">A</mml:mi> <mml:mo>⌋</mml:mo> <mml:mo>|</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> with error not exceeding |<italic>k</italic> − <italic>l</italic>|<sup>−(1+1/(<italic>n</italic>−1))</sup>. The desired statement follows then by simultaneously approximating the numbers 1/<italic>α</italic><sub><italic>i</italic></sub> with common denominator, which is also a simultaneous approximation of <italic>α</italic><sub><italic>i</italic></sub> with common numerator, which completes the proof.</p>
<p>For a set of grid scales <italic>α</italic><sub><italic>i</italic></sub> = <italic>α</italic><sup><italic>i</italic></sup> (<italic>i</italic> = 0, …, <italic>M</italic> − 1) where <italic>α</italic> is an algebraic number of degree <italic>M</italic>, there exists a maximal positive constant <inline-formula id="pcbi.1005922.e100"><alternatives><graphic id="pcbi.1005922.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e100" xlink:type="simple"/><mml:math display="inline" id="M100"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, such that
<disp-formula id="pcbi.1005922.e101"><alternatives><graphic id="pcbi.1005922.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e101" xlink:type="simple"/><mml:math display="block" id="M101"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:munder> <mml:mo>{</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo> <mml:mo>&gt;</mml:mo> <mml:mfrac><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula>
holds, except for at most finitely many integers <italic>ℓ</italic>.</p>
<p>To see that <xref ref-type="disp-formula" rid="pcbi.1005922.e101">Eq 25</xref> holds, we start from the work of [<xref ref-type="bibr" rid="pcbi.1005922.ref044">44</xref>] (see also [<xref ref-type="bibr" rid="pcbi.1005922.ref045">45</xref>]) stating that powers of an algebraic number are badly simultaneously approximable with common denominator in the following sense. Let <italic>β</italic> be an algebraic number of order <italic>M</italic>. There exists <italic>c</italic><sub><italic>β</italic></sub> &gt; 0 such that for all integer <italic>ℓ</italic>, <italic>k</italic><sub><italic>i</italic></sub> there is <italic>i</italic> ∈ {1, …, <italic>M</italic> − 1} for which
<disp-formula id="pcbi.1005922.e102"><alternatives><graphic id="pcbi.1005922.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e102" xlink:type="simple"/><mml:math display="block" id="M102"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mi>β</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mi>ℓ</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>&gt;</mml:mo></mml:mrow> <mml:mfrac><mml:msub><mml:mi>c</mml:mi> <mml:mi>β</mml:mi></mml:msub> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p><italic>Derivation of</italic> <xref ref-type="disp-formula" rid="pcbi.1005922.e101">Eq 25</xref>. Our goal is to give a lower bound on |<italic>α</italic><sup><italic>i</italic></sup> <italic>k</italic><sub><italic>i</italic></sub> − <italic>α</italic><sup><italic>j</italic></sup> <italic>k</italic><sub><italic>j</italic></sub>|, where <italic>α</italic> is algebraic of order <italic>M</italic>, 0 ≤ <italic>i</italic>, <italic>j</italic> ≤ <italic>M</italic> − 1. Without loss of generality suppose that <italic>i</italic> &lt; <italic>j</italic>.
<disp-formula id="pcbi.1005922.e103"><alternatives><graphic id="pcbi.1005922.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e103" xlink:type="simple"/><mml:math display="block" id="M103"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:msub><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msup><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msup> <mml:msub><mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>=</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mi>α</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msup> <mml:msub><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msup><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msup> <mml:mo>&gt;</mml:mo> <mml:msup><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msup> <mml:mfrac><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:msubsup><mml:mi>k</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Now the fact that <italic>k</italic><sub><italic>i</italic></sub> ∼ <italic>ℓ</italic>/<italic>α</italic><sup><italic>i</italic></sup> implies <xref ref-type="disp-formula" rid="pcbi.1005922.e101">Eq 25</xref> if <inline-formula id="pcbi.1005922.e104"><alternatives><graphic id="pcbi.1005922.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e104" xlink:type="simple"/><mml:math display="inline" id="M104"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> is chosen appropriately.</p>
<p>The position representation is unambiguous if there is at least one pair of modules for which the phase difference is larger than the threshold set by the noise, i.e., <inline-formula id="pcbi.1005922.e105"><alternatives><graphic id="pcbi.1005922.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e105" xlink:type="simple"/><mml:math display="inline" id="M105"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&gt;</mml:mo> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> which holds if
<disp-formula id="pcbi.1005922.e106"><alternatives><graphic id="pcbi.1005922.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e106" xlink:type="simple"/><mml:math display="block" id="M106"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>δ</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mfrac><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula>
From here, the critical distance <italic>L</italic><sub>max</sub> up to which coding is unambiguous can be expressed as (cf. <xref ref-type="disp-formula" rid="pcbi.1005922.e028">Eq 9</xref>):
<disp-formula id="pcbi.1005922.e107"><alternatives><graphic id="pcbi.1005922.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e107" xlink:type="simple"/><mml:math display="block" id="M107"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub> <mml:mo>≔</mml:mo> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:mrow> <mml:mi>δ</mml:mi></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(27)</label></disp-formula>
for all <italic>δ</italic> which is small enough.</p>
<p>To directly compare the capacity of the MA grid cell system derived in <xref ref-type="disp-formula" rid="pcbi.1005922.e028">Eq 9</xref> with previous estimates for nested coding [<xref ref-type="bibr" rid="pcbi.1005922.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005922.ref006">6</xref>], we also calculate <italic>N</italic><sub>max</sub>, the number of distinguishable spatial phases:
<disp-formula id="pcbi.1005922.e108"><alternatives><graphic id="pcbi.1005922.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e108" xlink:type="simple"/><mml:math display="block" id="M108"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow> <mml:mo>≔</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>δ</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:mrow> <mml:mi>δ</mml:mi></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></alternatives> <label>(28)</label></disp-formula>
Efficient coding with nested modules requires that <italic>α</italic><sub><italic>i</italic></sub> = <italic>r</italic><sup><italic>i</italic></sup> with 0 ≤ <italic>i</italic> ≤ <italic>M</italic> − 1 and <italic>r</italic> being the scale ratio with fixed relative uncertainty of modules 2<italic>δ</italic> = 1/<italic>r</italic> [<xref ref-type="bibr" rid="pcbi.1005922.ref006">6</xref>]. The position of the animal can be determined at precision 1/<italic>r</italic> without ambiguity if the animal is restricted to move in an environment with the size identical to the scale of the largest module, <italic>r</italic><sup><italic>M</italic>−1</sup>. In this case the number of distinguishable spatial phases is <inline-formula id="pcbi.1005922.e109"><alternatives><graphic id="pcbi.1005922.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e109" xlink:type="simple"/><mml:math display="inline" id="M109"><mml:mrow><mml:msup><mml:mi>r</mml:mi> <mml:mi>M</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mi>δ</mml:mi></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, which is identical to the capacity we found for non-nested coding when <inline-formula id="pcbi.1005922.e110"><alternatives><graphic id="pcbi.1005922.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e110" xlink:type="simple"/><mml:math display="inline" id="M110"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1005922.e108">Eq 28</xref>).</p>
</sec>
<sec id="sec021">
<title>Coding is unambiguous up to exponential distance in the number of modules</title>
<p>To derive <xref ref-type="disp-formula" rid="pcbi.1005922.e107">Eq 27</xref> we first show that interference of the grid representation is equivalent to pairwise interference between all pairs of modules. To test unambiguity of coding note that the place at distance <italic>x</italic> from the origin is confusable with 0 if for all <italic>i</italic> = 0, …, <italic>M</italic> − 1 there exists an integer <italic>k</italic><sub><italic>i</italic></sub> such that
<disp-formula id="pcbi.1005922.e111"><alternatives><graphic id="pcbi.1005922.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e111" xlink:type="simple"/><mml:math display="block" id="M111"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow> <mml:mspace width="2pt"/><mml:mo>−</mml:mo> <mml:mspace width="2pt"/><mml:mi>x</mml:mi> <mml:mo>|</mml:mo> <mml:mo>&lt;</mml:mo></mml:mrow> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mi>δ</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(29)</label></disp-formula>
where <italic>δ</italic> is the relative uncertainty of modules. It turns out that, as for <italic>M</italic> = 2, there is no need to consider all <italic>x</italic> ∈ [0, <italic>L</italic><sub>max</sub>], it is enough to care with integers:</p>
<p><bold>Claim</bold>. <italic>There exists x</italic> ∈ [0, <italic>L</italic><sub>max</sub>] <italic>for which</italic> <xref ref-type="disp-formula" rid="pcbi.1005922.e111">Eq 29</xref> <italic>holds for all i exactly when the following pairwise interference occurs between all modules</italic>:
<disp-formula id="pcbi.1005922.e112"><alternatives><graphic id="pcbi.1005922.e112g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e112" xlink:type="simple"/><mml:math display="block" id="M112"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>&lt;</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(30)</label></disp-formula> <italic>for all i, j with some integers k<sub>i</sub> (i</italic> = 0, …, <italic>M</italic> − 1<italic>) such that</italic> 0 &lt; <italic>k</italic><sub><italic>i</italic></sub> <italic>α</italic><sub><italic>i</italic></sub> ≤ <italic>L</italic><sub>max</sub>.</p>
<p><italic>Proof</italic>. Let us fix <italic>k</italic><sub><italic>i</italic></sub>, <italic>i</italic> = 0, …, <italic>M</italic> − 1. Pairwise interference means that there is a point <italic>x</italic><sub><italic>i</italic>,<italic>j</italic></sub> in the intersection of (<italic>k</italic><sub><italic>i</italic></sub> <italic>α</italic><sub><italic>i</italic></sub> − <italic>α</italic><sub><italic>i</italic></sub> <italic>δ</italic>, <italic>k</italic><sub><italic>i</italic></sub> <italic>α</italic><sub><italic>i</italic></sub> + <italic>α</italic><sub><italic>i</italic></sub> <italic>δ</italic>) = (<italic>a</italic><sub><italic>i</italic></sub>, <italic>b</italic><sub><italic>i</italic></sub>) and (<italic>k</italic><sub><italic>j</italic></sub> <italic>α</italic><sub><italic>j</italic></sub> − <italic>α</italic><sub><italic>j</italic></sub> <italic>δ</italic>, <italic>k</italic><sub><italic>j</italic></sub> <italic>α</italic><sub><italic>j</italic></sub> + <italic>α</italic><sub><italic>j</italic></sub> <italic>δ</italic>) = (<italic>a</italic><sub><italic>j</italic></sub>, <italic>b</italic><sub><italic>j</italic></sub>). Due to the topology of the line, it is easy to see by induction that the intersection of all such intervals is nonempty and hence one can chose <italic>x</italic><sub><italic>i</italic>,<italic>j</italic></sub> = <italic>x</italic>. The statement is obvious for <italic>M</italic> = 2. Now suppose that the intersection <inline-formula id="pcbi.1005922.e113"><alternatives><graphic id="pcbi.1005922.e113g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e113" xlink:type="simple"/><mml:math display="inline" id="M113"><mml:mrow><mml:msubsup><mml:mo>∩</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≠</mml:mo> <mml:mi>∅</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Then it is the interval (<italic>a</italic>, <italic>b</italic>) with
<disp-formula id="pcbi.1005922.e114"><alternatives><graphic id="pcbi.1005922.e114g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e114" xlink:type="simple"/><mml:math display="block" id="M114"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>a</mml:mi> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mspace width="1.em"/><mml:mtext>and</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
If (<italic>a</italic><sub><italic>n</italic>+1</sub>, <italic>b</italic><sub><italic>n</italic>+1</sub>) intersects (<italic>a</italic><sub><italic>i</italic></sub>, <italic>b</italic><sub><italic>i</italic></sub>), then both <italic>a</italic><sub><italic>n</italic>+1</sub> &lt; <italic>b</italic><sub><italic>i</italic></sub> and <italic>b</italic><sub><italic>n</italic>+1</sub> &gt; <italic>a</italic><sub><italic>i</italic></sub>, and therefore <italic>a</italic><sub><italic>n</italic>+1</sub> &lt; <italic>b</italic> and <italic>b</italic><sub><italic>n</italic>+1</sub> &gt; <italic>a</italic>, which completes the induction. Therefore <xref ref-type="disp-formula" rid="pcbi.1005922.e111">Eq 29</xref> implies <xref ref-type="disp-formula" rid="pcbi.1005922.e112">Eq 30</xref>. The other direction is immediate.</p>
<p>Now using the above Claim Equation <xref ref-type="disp-formula" rid="pcbi.1005922.e107">Eq 27</xref> easily follows by rearranging <xref ref-type="disp-formula" rid="pcbi.1005922.e101">Eq 25</xref>.</p>
</sec>
<sec id="sec022">
<title>Asymptotic capacity of the random grid cell system</title>
<p>Let us fix the relative uncertainty of modules <italic>δ</italic> &lt; 1/2 and a number <italic>α</italic><sub>max</sub> &gt; (1 + <italic>δ</italic>)/(1 − <italic>δ</italic>). We show that if scales <italic>α</italic><sub>1</sub>, <italic>α</italic><sub>2</sub>, … are drawn uniformly at random from [1, <italic>α</italic><sub>max</sub>], independently of each other, then for any <italic>δ</italic> &lt; <italic>ζ</italic> &lt; 1/2 the representation with <italic>M</italic> modules having scales <italic>α</italic><sub>1</sub>, <italic>α</italic><sub>2</sub>, …, <italic>α</italic><sub><italic>M</italic></sub> is unambiguous in every spatial position <italic>x</italic> &gt; 0 up to
<disp-formula id="pcbi.1005922.e115"><alternatives><graphic id="pcbi.1005922.e115g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e115" xlink:type="simple"/><mml:math display="block" id="M115"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub> <mml:mo>≔</mml:mo> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mi>ζ</mml:mi> <mml:mi>δ</mml:mi></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math></alternatives> <label>(31)</label></disp-formula>
with probability of order 1 − (2<italic>ζ</italic>)<sup><italic>M</italic></sup> as <italic>M</italic> → ∞.</p>
<p>Here <italic>ζ</italic> is the analog of <inline-formula id="pcbi.1005922.e116"><alternatives><graphic id="pcbi.1005922.e116g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e116" xlink:type="simple"/><mml:math display="inline" id="M116"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> which characterises the capacity of a particular grid cell system. As we will see, the convergence holds for any <italic>ζ</italic> &lt; 1/2, but the speed of the convergence depends on <italic>ζ</italic>: higher efficiency is guaranteed to be achieved only for larger number of modules.</p>
<p><italic>Proof:</italic> Let <italic>α</italic><sub>1</sub>, <italic>α</italic><sub>2</sub>, … be independent random variables distributed uniformly on [1, <italic>α</italic><sub>max</sub>]. Let <italic>x</italic> be a spatial point and let <inline-formula id="pcbi.1005922.e117"><alternatives><graphic id="pcbi.1005922.e117g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e117" xlink:type="simple"/><mml:math display="inline" id="M117"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> denote the phase of module <italic>i</italic> (with scale <italic>α</italic><sub><italic>i</italic></sub>) at <italic>x</italic>, that is
<disp-formula id="pcbi.1005922.e118"><alternatives><graphic id="pcbi.1005922.e118g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e118" xlink:type="simple"/><mml:math display="block" id="M118"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>≔</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mspace width="4.pt"/><mml:mtext>mod</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mspace width="4.pt"/><mml:mtext>mod</mml:mtext> <mml:mspace width="4.pt"/><mml:mn>1</mml:mn> <mml:mo>=</mml:mo> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mo>⌊</mml:mo> <mml:mfrac><mml:mi>x</mml:mi> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mfrac> <mml:mo>⌋</mml:mo> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Note that for fixed <italic>x</italic> the distribution of phases <inline-formula id="pcbi.1005922.e119"><alternatives><graphic id="pcbi.1005922.e119g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e119" xlink:type="simple"/><mml:math display="inline" id="M119"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> are independent of each other since the <italic>α</italic>-s are independent. We also use the notation <italic>p</italic><sub>1</sub>(<italic>x</italic>) for the probability that the phase <inline-formula id="pcbi.1005922.e120"><alternatives><graphic id="pcbi.1005922.e120g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e120" xlink:type="simple"/><mml:math display="inline" id="M120"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is (almost) indistinguishable from 0, defined in the following way:
<disp-formula id="pcbi.1005922.e121"><alternatives><graphic id="pcbi.1005922.e121g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e121" xlink:type="simple"/><mml:math display="block" id="M121"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="double-struck">P</mml:mi> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:mo>[</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>ε</mml:mi> <mml:mo>)</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>]</mml:mo> <mml:mo>∪</mml:mo> <mml:mo>[</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>ε</mml:mi> <mml:mo>)</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo> <mml:mspace width="4pt"/><mml:mo>|</mml:mo> <mml:mspace width="4pt"/><mml:mi>x</mml:mi> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>ε</italic> &gt; 0 is determined later. It is easy to see that <italic>p</italic><sub>1</sub>(<italic>x</italic>) does not depend on <italic>i</italic>, i.e., it is the same for all modules. Moreover, the distribution of <inline-formula id="pcbi.1005922.e122"><alternatives><graphic id="pcbi.1005922.e122g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e122" xlink:type="simple"/><mml:math display="inline" id="M122"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> converges to uniform as the distance increases, in particular lim<sub><italic>x</italic> → ∞</sub> <italic>p</italic><sub>1</sub>(<italic>x</italic>) = 2(1 + <italic>ε</italic>)<italic>δ</italic>. The convergence of this distribution to the uniform is a key observation that remains true even in higher dimensions with uniform random rotations or in case of slight variation of the grid scales on the long range. Hence there exists a critical distance, <italic>x</italic><sub>0</sub> = <italic>x</italic><sub>0</sub>(<italic>δ</italic>, <italic>ε</italic>) for which all <italic>x</italic> &gt; <italic>x</italic><sub>0</sub> we have |<italic>p</italic><sub>1</sub>(<italic>x</italic>) − 2(1 + <italic>ε</italic>)<italic>δ</italic>| ≤ <italic>δε</italic>. Therefore, for <italic>x</italic> &gt; <italic>x</italic><sub>0</sub> we have
<disp-formula id="pcbi.1005922.e123"><alternatives><graphic id="pcbi.1005922.e123g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e123" xlink:type="simple"/><mml:math display="block" id="M123"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≤</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>+</mml:mo> <mml:mn>3</mml:mn> <mml:mi>ε</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(32)</label></disp-formula></p>
<p>It also implies a bound on the probability of interference of many modules at a given point <italic>x</italic>. If we consider <italic>M</italic> modules with scales drawn uniformly at random from [1, <italic>α</italic><sub>max</sub>] and independently of each other, then by <xref ref-type="disp-formula" rid="pcbi.1005922.e123">Eq 32</xref> for <italic>x</italic> &gt; <italic>x</italic><sub>0</sub> the probability of all phases being close to 0 is
<disp-formula id="pcbi.1005922.e124"><alternatives><graphic id="pcbi.1005922.e124g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e124" xlink:type="simple"/><mml:math display="block" id="M124"><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>M</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mi>ℙ</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>∀</mml:mo> <mml:mi>i</mml:mi> <mml:mo>≤</mml:mo> <mml:mi>M</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="2pt"/> <mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>ε</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∪</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>ε</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="2pt"/> <mml:mo>|</mml:mo> <mml:mspace width="2pt"/> <mml:mi>x</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>M</mml:mi></mml:msup> <mml:mo>≤</mml:mo> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>+</mml:mo> <mml:mn>3</mml:mn> <mml:mi>ε</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>M</mml:mi></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math></alternatives> <label>(33)</label></disp-formula>
that is, <italic>p</italic><sub><italic>M</italic></sub>(<italic>x</italic>) is exponentially small in <italic>M</italic>.</p>
<p>There remains to estimate the probability of interference of many modules anywhere up to a maximally allowed spatial distance. Our goal is to show that
<disp-formula id="pcbi.1005922.e125"><alternatives><graphic id="pcbi.1005922.e125g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e125" xlink:type="simple"/><mml:math display="block" id="M125"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi> <mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>∃</mml:mo> <mml:mi>x</mml:mi> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mtext>max</mml:mtext></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>∀</mml:mo> <mml:mi>i</mml:mi> <mml:mo>≤</mml:mo> <mml:mi>M</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4pt"/><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>∪</mml:mo> <mml:mo>(</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>→</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(34)</label></disp-formula>
as <italic>M</italic> → ∞, where <inline-formula id="pcbi.1005922.e126"><alternatives><graphic id="pcbi.1005922.e126g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e126" xlink:type="simple"/><mml:math display="inline" id="M126"><mml:mrow><mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mi>ζ</mml:mi> <mml:mi>δ</mml:mi></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, as in <xref ref-type="disp-formula" rid="pcbi.1005922.e115">Eq 31</xref>. Note, that satisfying <xref ref-type="disp-formula" rid="pcbi.1005922.e125">Eq 34</xref> is not trivial, since <italic>X</italic><sub>max</sub> increases exponentially with <italic>M</italic>.</p>
<p>There is no need to investigate all <italic>x</italic> &lt; <italic>X</italic><sub>max</sub>, it is enough to show, that there is no interference on a set which is dense enough in [0, <italic>X</italic><sub>max</sub>] in the stronger sense of <xref ref-type="disp-formula" rid="pcbi.1005922.e124">Eq 33</xref>. Indeed, let <italic>Y</italic> be an <italic>ε</italic> dense set in [0, <italic>X</italic><sub>max</sub>] with at most 2<italic>X</italic><sub>max</sub>/<italic>ε</italic> elements. Then
<disp-formula id="pcbi.1005922.e127"><alternatives><graphic id="pcbi.1005922.e127g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e127" xlink:type="simple"/><mml:math display="block" id="M127"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mo>∃</mml:mo> <mml:mi>x</mml:mi> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mo>∀</mml:mo> <mml:mi>i</mml:mi> <mml:mo>≤</mml:mo> <mml:mi>M</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>x</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>∈</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>δ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>∪</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:mi>δ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>⇒</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mo>∃</mml:mo> <mml:mi>x</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>Y</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mo>∀</mml:mo> <mml:mi>i</mml:mi> <mml:mo>≤</mml:mo> <mml:mi>M</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>x</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>∈</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>ε</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mi>δ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>∪</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>ε</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mi>δ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula>
where we used the fact that the <inline-formula id="pcbi.1005922.e128"><alternatives><graphic id="pcbi.1005922.e128g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e128" xlink:type="simple"/><mml:math display="inline" id="M128"><mml:mrow><mml:mfrac><mml:mi mathvariant="normal">d</mml:mi> <mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:mfrac> <mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mfrac> <mml:mo>&lt;</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> since <italic>α</italic><sub><italic>i</italic></sub> was chosen from the interval [1, <italic>α</italic><sub>max</sub>]. The corresponding inequality for the probabilities of these events is
<disp-formula id="pcbi.1005922.e129"><alternatives><graphic id="pcbi.1005922.e129g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e129" xlink:type="simple"/><mml:math display="block" id="M129"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>ℙ</mml:mi> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mo>∃</mml:mo> <mml:mi>x</mml:mi> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>∀</mml:mo> <mml:mi>i</mml:mi> <mml:mo>≤</mml:mo> <mml:mi>M</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/> <mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>δ</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∪</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:mi>δ</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>≤</mml:mo> <mml:mi>ℙ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>∃</mml:mo> <mml:mi>x</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>Y</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>∀</mml:mo> <mml:mi>i</mml:mi> <mml:mo>≤</mml:mo> <mml:mi>M</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/> <mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>ε</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∪</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>ε</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula>
Now for these finitely many points <italic>x</italic> ∈ <italic>Y</italic> we can use <xref ref-type="disp-formula" rid="pcbi.1005922.e124">Eq 33</xref> one by one, if <italic>x</italic> &gt; <italic>x</italic><sub>0</sub>:
<disp-formula id="pcbi.1005922.e130"><alternatives><graphic id="pcbi.1005922.e130g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e130" xlink:type="simple"/><mml:math display="block" id="M130"><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ℙ</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mo>∃</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mi>x</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>Y</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>∀</mml:mo> <mml:mi>i</mml:mi> <mml:mo>≤</mml:mo> <mml:mi>M</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="2pt"/> <mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∈</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>ε</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∪</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>ε</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>≤</mml:mo> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>+</mml:mo> <mml:mn>3</mml:mn> <mml:mi>ε</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>M</mml:mi></mml:msup> <mml:mn>2</mml:mn> <mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:mi>ε</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mn>2</mml:mn> <mml:mi>ε</mml:mi></mml:mfrac> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>+</mml:mo> <mml:mn>3</mml:mn> <mml:mi>ε</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>M</mml:mi></mml:msup> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mi>ζ</mml:mi> <mml:mi>δ</mml:mi></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>&lt;</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>ε</mml:mi> <mml:mi>ζ</mml:mi></mml:mrow></mml:mfrac> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>ζ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>+</mml:mo> <mml:mn>3</mml:mn> <mml:mi>ε</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>M</mml:mi></mml:msup> <mml:mo>→</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
if <inline-formula id="pcbi.1005922.e131"><alternatives><graphic id="pcbi.1005922.e131g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e131" xlink:type="simple"/><mml:math display="inline" id="M131"><mml:mrow><mml:mi>ε</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mi>ζ</mml:mi></mml:mrow> <mml:mrow><mml:mn>3</mml:mn> <mml:mi>ζ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, which we assume, where in the first inequality we used <xref ref-type="disp-formula" rid="pcbi.1005922.e124">Eq 33</xref> and union bound, and then in the second one that <inline-formula id="pcbi.1005922.e132"><alternatives><graphic id="pcbi.1005922.e132g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e132" xlink:type="simple"/><mml:math display="inline" id="M132"><mml:mrow><mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mi>ζ</mml:mi> <mml:mi>δ</mml:mi></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. We have to remark that interference in different spatial points is not independent of each other, but union bound works even in that case.</p>
<p>There remains to show that the grid cell representation works up to <italic>x</italic><sub>0</sub>. Clearly there is no ambiguity up to <italic>x</italic> = 1 + <italic>δ</italic>. To estimate the probability
<disp-formula id="pcbi.1005922.e133"><alternatives><graphic id="pcbi.1005922.e133g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e133" xlink:type="simple"/><mml:math display="block" id="M133"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi> <mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>∃</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>≥</mml:mo> <mml:mi>x</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>Y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>∀</mml:mo> <mml:mi>i</mml:mi> <mml:mo>≤</mml:mo> <mml:mi>M</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4pt"/><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>ε</mml:mi> <mml:mo>)</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>∪</mml:mo> <mml:mo>(</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>ε</mml:mi> <mml:mo>)</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(35)</label></disp-formula>
we first have to observe that the cardinality of <italic>Y</italic> ∩ [1 + <italic>δ</italic>, <italic>x</italic><sub>0</sub>] is independent of <italic>M</italic>. Therefore to guarantee that the probability in <xref ref-type="disp-formula" rid="pcbi.1005922.e133">Eq 35</xref> goes to 0 we need to show that for all 1 + <italic>δ</italic> ≤ <italic>x</italic> ≤ <italic>x</italic><sub>0</sub> there is a scale <italic>α</italic> ∈ [1, <italic>A</italic>] which is able to distinguish <italic>x</italic> from the origin, that is <italic>α</italic> such that
<disp-formula id="pcbi.1005922.e134"><alternatives><graphic id="pcbi.1005922.e134g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e134" xlink:type="simple"/><mml:math display="block" id="M134"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>α</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:mi>α</mml:mi> <mml:mspace width="3.33333pt"/><mml:mo form="prefix">mod</mml:mo> <mml:mspace width="0.277778em"/><mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
This is so because <italic>x</italic>/<italic>α</italic> is monotonically decreasing in <italic>α</italic> and because
<disp-formula id="pcbi.1005922.e135"><alternatives><graphic id="pcbi.1005922.e135g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e135" xlink:type="simple"/><mml:math display="block" id="M135"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:mi>A</mml:mi> <mml:mo>≥</mml:mo> <mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mi>δ</mml:mi> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>≥</mml:mo> <mml:mn>2</mml:mn> <mml:mi>δ</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where we used that <italic>α</italic><sub>max</sub> &gt; (1 + <italic>δ</italic>)/(1 − <italic>δ</italic>) and <italic>x</italic> &gt; 1 + <italic>δ</italic>. Therefore <inline-formula id="pcbi.1005922.e136"><alternatives><graphic id="pcbi.1005922.e136g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e136" xlink:type="simple"/><mml:math display="inline" id="M136"><mml:mrow><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>α</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> can not lay in [0, <italic>δ</italic>] ∪ [1 − <italic>δ</italic>, 1] for all <italic>α</italic> ∈ [1, <italic>α</italic><sub>max</sub>].</p>
</sec>
<sec id="sec023">
<title>Numerical estimation of the <inline-formula id="pcbi.1005922.e137"><alternatives><graphic id="pcbi.1005922.e137g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e137" xlink:type="simple"/><mml:math display="inline" id="M137"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> with <italic>M</italic> modules</title>
<p>The constant <inline-formula id="pcbi.1005922.e138"><alternatives><graphic id="pcbi.1005922.e138g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e138" xlink:type="simple"/><mml:math display="inline" id="M138"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (and <italic>c</italic><sub><italic>α</italic></sub>) is well defined only for algebraic numbers, but can also be estimated for real numbers from the scaling of the phase difference with distance using numerical simulations. As <inline-formula id="pcbi.1005922.e139"><alternatives><graphic id="pcbi.1005922.e139g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e139" xlink:type="simple"/><mml:math display="inline" id="M139"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is defined asymptotically (<xref ref-type="disp-formula" rid="pcbi.1005922.e101">Eq 25</xref>), in order to estimate it numerically we need an approximation of it for finite distances. An alternative definition of <inline-formula id="pcbi.1005922.e140"><alternatives><graphic id="pcbi.1005922.e140g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e140" xlink:type="simple"/><mml:math display="inline" id="M140"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (equivalent with <xref ref-type="disp-formula" rid="pcbi.1005922.e101">Eq 25</xref>) is
<disp-formula id="pcbi.1005922.e141"><alternatives><graphic id="pcbi.1005922.e141g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e141" xlink:type="simple"/><mml:math display="block" id="M141"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">lim inf</mml:mo> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mo>→</mml:mo> <mml:mi>∞</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(36)</label></disp-formula>
where <inline-formula id="pcbi.1005922.e142"><alternatives><graphic id="pcbi.1005922.e142g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e142" xlink:type="simple"/><mml:math display="inline" id="M142"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is defined by
<disp-formula id="pcbi.1005922.e143"><alternatives><graphic id="pcbi.1005922.e143g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e143" xlink:type="simple"/><mml:math display="block" id="M143"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mrow><mml:mi mathvariant="script">K</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ℓ</mml:mi></mml:mrow></mml:munder> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:munder> <mml:mo>{</mml:mo> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>/</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(37)</label></disp-formula>
where <inline-formula id="pcbi.1005922.e144"><alternatives><graphic id="pcbi.1005922.e144g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e144" xlink:type="simple"/><mml:math display="inline" id="M144"><mml:mrow><mml:mi mathvariant="script">K</mml:mi> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Intuitively, to find the magnitude of interference at location <italic>ℓ</italic>, for all possible values of <inline-formula id="pcbi.1005922.e145"><alternatives><graphic id="pcbi.1005922.e145g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e145" xlink:type="simple"/><mml:math display="inline" id="M145"><mml:mi mathvariant="script">K</mml:mi></mml:math></alternatives></inline-formula> we first select the maximum phase difference in the set and then choose the set with the smallest maximum. From the plots Figs <xref ref-type="fig" rid="pcbi.1005922.g004">4</xref> and <xref ref-type="fig" rid="pcbi.1005922.g007">7</xref> it is clear that the naive way of approximating <inline-formula id="pcbi.1005922.e146"><alternatives><graphic id="pcbi.1005922.e146g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e146" xlink:type="simple"/><mml:math display="inline" id="M146"><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> with <inline-formula id="pcbi.1005922.e147"><alternatives><graphic id="pcbi.1005922.e147g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e147" xlink:type="simple"/><mml:math display="inline" id="M147"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for some large <italic>ℓ</italic> is not a good idea, as <inline-formula id="pcbi.1005922.e148"><alternatives><graphic id="pcbi.1005922.e148g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e148" xlink:type="simple"/><mml:math display="inline" id="M148"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> may vary heavily with <italic>ℓ</italic>, especially for non-algebraic scale ratios. Note, that the calculation of <inline-formula id="pcbi.1005922.e149"><alternatives><graphic id="pcbi.1005922.e149g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e149" xlink:type="simple"/><mml:math display="inline" id="M149"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is a special case of <inline-formula id="pcbi.1005922.e150"><alternatives><graphic id="pcbi.1005922.e150g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e150" xlink:type="simple"/><mml:math display="inline" id="M150"><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub></mml:math></alternatives></inline-formula> with <italic>M</italic> = 2.</p>
<p>To estimate coding efficiency in the presence of noise we are mostly interested in the above infemum when <italic>ℓ</italic> is such that the phase difference <inline-formula id="pcbi.1005922.e151"><alternatives><graphic id="pcbi.1005922.e151g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e151" xlink:type="simple"/><mml:math display="inline" id="M151"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is close to the precision <italic>δ</italic> of the modules. It motivates to investigate the (numerically computable) minimum
<disp-formula id="pcbi.1005922.e152"><alternatives><graphic id="pcbi.1005922.e152g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e152" xlink:type="simple"/><mml:math display="block" id="M152"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4pt"/><mml:mo>|</mml:mo> <mml:mspace width="4pt"/><mml:msub><mml:mi>ℓ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≤</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>ℓ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
for some pair <italic>δ</italic><sub>1</sub> &lt; <italic>δ</italic><sub>2</sub>, where <italic>ℓ</italic><sub>2</sub> is so that for all <italic>ℓ</italic> ≥ <italic>ℓ</italic><sub>2</sub> we have <inline-formula id="pcbi.1005922.e153"><alternatives><graphic id="pcbi.1005922.e153g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e153" xlink:type="simple"/><mml:math display="inline" id="M153"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <italic>ℓ</italic><sub>1</sub> is the smallest <italic>ℓ</italic> so that <inline-formula id="pcbi.1005922.e154"><alternatives><graphic id="pcbi.1005922.e154g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e154" xlink:type="simple"/><mml:math display="inline" id="M154"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi mathvariant="script">A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec024">
<title>Tools for the numerical investigation of Diophantine approximation</title>
<p>A common and natural way to numerically investigate Diophantine approximation is using lattice reduction [<xref ref-type="bibr" rid="pcbi.1005922.ref046">46</xref>]. By lattice we mean a subset <inline-formula id="pcbi.1005922.e155"><alternatives><graphic id="pcbi.1005922.e155g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e155" xlink:type="simple"/><mml:math display="inline" id="M155"><mml:mi mathvariant="double-struck">L</mml:mi></mml:math></alternatives></inline-formula> of <inline-formula id="pcbi.1005922.e156"><alternatives><graphic id="pcbi.1005922.e156g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e156" xlink:type="simple"/><mml:math display="inline" id="M156"><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mi>d</mml:mi></mml:msup></mml:math></alternatives></inline-formula> defined by some vectors <inline-formula id="pcbi.1005922.e157"><alternatives><graphic id="pcbi.1005922.e157g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e157" xlink:type="simple"/><mml:math display="inline" id="M157"><mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <italic>m</italic> ≤ <italic>d</italic> so that
<disp-formula id="pcbi.1005922.e158"><alternatives><graphic id="pcbi.1005922.e158g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e158" xlink:type="simple"/><mml:math display="block" id="M158"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">L</mml:mi> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mi>w</mml:mi> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>v</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">Z</mml:mi> <mml:mo>}</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>Given a lattice <inline-formula id="pcbi.1005922.e159"><alternatives><graphic id="pcbi.1005922.e159g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e159" xlink:type="simple"/><mml:math display="inline" id="M159"><mml:mi mathvariant="double-struck">L</mml:mi></mml:math></alternatives></inline-formula>, a classical computational problem is to find the shortest non-zero vector of it (<xref ref-type="fig" rid="pcbi.1005922.g008">Fig 8</xref>). In the followings we show how Diophantine approximation of a vector (<italic>α</italic><sub>1</sub>, …, <italic>α</italic><sub><italic>n</italic></sub>) can be investigated with the help of finding shortest vectors of appropriately chosen lattices.</p>
<fig id="pcbi.1005922.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005922.g008</object-id>
<label>Fig 8</label>
<caption>
<title/>
<p>Which element of the lattice generated by the above two blue headed vectors is closest to the origin? Or in other words, what is the shortest nonzero vector which can be obtained as an integer coefficient linear combination of the above vectors?</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005922.g008" xlink:type="simple"/>
</fig>
<p>Let us first consider a simple example. Let the lattice <inline-formula id="pcbi.1005922.e160"><alternatives><graphic id="pcbi.1005922.e160g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e160" xlink:type="simple"/><mml:math display="inline" id="M160"><mml:mi mathvariant="double-struck">L</mml:mi></mml:math></alternatives></inline-formula> be defined by the rows of the matrix
<disp-formula id="pcbi.1005922.e161"><alternatives><graphic id="pcbi.1005922.e161g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e161" xlink:type="simple"/><mml:math display="block" id="M161"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>V</mml:mi> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>v</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>≔</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>α</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:msub><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋱</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:msub><mml:mi>α</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mo>…</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mi>ε</mml:mi></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>ε</italic> &gt; 0. For all <italic>ε</italic> which is small enough the shortest vector <inline-formula id="pcbi.1005922.e162"><alternatives><graphic id="pcbi.1005922.e162g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e162" xlink:type="simple"/><mml:math display="inline" id="M162"><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>v</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> of <inline-formula id="pcbi.1005922.e163"><alternatives><graphic id="pcbi.1005922.e163g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e163" xlink:type="simple"/><mml:math display="inline" id="M163"><mml:mi mathvariant="double-struck">L</mml:mi></mml:math></alternatives></inline-formula> corresponds to a simultaneous Diophantine approximation of (<italic>α</italic><sub>1</sub>, …, <italic>α</italic><sub><italic>n</italic></sub>) with the common numerator <italic>b</italic><sub><italic>n</italic>+1</sub> and denominators <italic>b</italic><sub><italic>i</italic></sub>, <italic>i</italic> = 1, …, <italic>n</italic>. The parameter <italic>ε</italic> can be considered as a penalty term: the smaller this term the bigger the numerator can be.</p>
<p>When speaking about shortest vectors we need to specify the norm with respect to which vectors are compared. Here we are looking for the largest phase difference between the modules so we use supremum norm (<xref ref-type="disp-formula" rid="pcbi.1005922.e101">Eq 25</xref>). The shortest vector in supremum norm of the lattice defined by <italic>V</italic> is an approximation so that
<disp-formula id="pcbi.1005922.e164"><alternatives><graphic id="pcbi.1005922.e164g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e164" xlink:type="simple"/><mml:math display="block" id="M164"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mi>ε</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mo>{</mml:mo> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
is as small as possible. By this we can compute what is the maximal phase difference between the module with scale 1 and all other modules up to distance <italic>b</italic><sub><italic>n</italic>+1</sub>.</p>
<p>Remember that according to <xref ref-type="disp-formula" rid="pcbi.1005922.e101">Eq 25</xref> we are searching for an approximation minimizing
<disp-formula id="pcbi.1005922.e165"><alternatives><graphic id="pcbi.1005922.e165g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e165" xlink:type="simple"/><mml:math display="block" id="M165"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mi>ε</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:munder> <mml:mo>{</mml:mo> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>/</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo> <mml:msup><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mo>(</mml:mo> <mml:mi>M</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>}</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(38)</label></disp-formula>
Similarly to the previous example, it can be done simply by dividing columns <italic>i</italic>, <italic>i</italic> = 1, …, <italic>n</italic> of <italic>V</italic> by (1 + <italic>α</italic><sub><italic>i</italic></sub>), and by adding some more columns of similar form which refer to interference between modules <italic>i</italic> and <italic>j</italic>. For example, for <italic>n</italic> = 3 the shortest (in sup norm) element of the lattice generated by the rows of the following matrix gives an approximation minimizing <xref ref-type="disp-formula" rid="pcbi.1005922.e165">Eq 38</xref>:
<disp-formula id="pcbi.1005922.e166"><alternatives><graphic id="pcbi.1005922.e166g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005922.e166" xlink:type="simple"/><mml:math display="block" id="M166"><mml:mrow><mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mfrac><mml:msub><mml:mi>α</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mfrac><mml:msub><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mfrac><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mfrac><mml:msub><mml:mi>α</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mfrac><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mfrac><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mfrac><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mfrac><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mi>ε</mml:mi></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
<p>In this way maximal interference in the grid cell system can be computed numerically as shortest vectors of some lattices in supremum norm. Finding this shortest vector is an integer linear programming (ILP) problem, which in general is an NP-hard computational problem, and can be solved by e.g. a branch and bound algorithm [<xref ref-type="bibr" rid="pcbi.1005922.ref047">47</xref>]. There are also efficient methods which find approximation solutions in polynomial time, such as the LLL algorithm due to Lenstra, Lenstra and Lovász [<xref ref-type="bibr" rid="pcbi.1005922.ref046">46</xref>].</p>
<p>The LLL algorithm finds not only a short vector of a lattice, but also another basis of it which consists of short and nearly orthogonal vectors in the <italic>L</italic><sup>2</sup> norm, a so called LLL reduced basis. The error made by the LLL algorithm is too high to precisely compute the constant terms in <xref ref-type="disp-formula" rid="pcbi.1005922.e107">Eq 27</xref>, and therefore we could not rely only on this algorithm. Nevertheless, compared to the ILP solution, we could significantly speed up our computations by first applying the LLL algorithm to find an approximate solution (and a reduced lattice), and then an ILP solver on this LLL reduced basis, which could find nontrivial optimal solutions very efficiently if started from this input.</p>
</sec>
</sec>
</body>
<back>
<ack>
<p>We thank Gergő Orbán and András Telcs for useful discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005922.ref001">
<label>1</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Sterling</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Laughlin</surname> <given-names>S</given-names></name>. <source>Principles of Neural Design</source>. <publisher-name>MIT Press</publisher-name>; <year>2015</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005922.ref002">
<label>2</label>
<mixed-citation publication-type="other" xlink:type="simple">Burak Y, Brookings T, Fiete I. Triangular lattice neurons may implement an advanced numeral system to precisely encode rat position over large ranges; 2006.</mixed-citation>
</ref>
<ref id="pcbi.1005922.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fiete</surname> <given-names>IR</given-names></name>, <name name-style="western"><surname>Burak</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Brookings</surname> <given-names>T</given-names></name>. <article-title>What Grid Cells Convey about Rat Location</article-title>. <source>The Journal of Neuroscience</source>. <year>2008</year>;<volume>28</volume>(<issue>27</issue>):<fpage>6858</fpage>–<lpage>6871</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.5684-07.2008" xlink:type="simple">10.1523/JNEUROSCI.5684-07.2008</ext-link></comment> <object-id pub-id-type="pmid">18596161</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mathis</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Herz</surname> <given-names>AVM</given-names></name>, <name name-style="western"><surname>Stemmler</surname> <given-names>M</given-names></name>. <article-title>Optimal population codes for space: grid cells outperform place cells</article-title>. <source>Neural Comput</source>. <year>2012</year>;<volume>24</volume>(<issue>9</issue>):<fpage>2280</fpage>–<lpage>317</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/NECO_a_00319" xlink:type="simple">10.1162/NECO_a_00319</ext-link></comment> <object-id pub-id-type="pmid">22594833</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mathis</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Herz</surname> <given-names>AVM</given-names></name>, <name name-style="western"><surname>Stemmler</surname> <given-names>MB</given-names></name>. <article-title>Resolution of nested neuronal representations can be exponential in the number of neurons</article-title>. <source>Phys Rev Lett</source>. <year>2012</year>;<volume>109</volume>(<issue>1</issue>):<fpage>018103</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevLett.109.018103" xlink:type="simple">10.1103/PhysRevLett.109.018103</ext-link></comment> <object-id pub-id-type="pmid">23031134</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wei</surname> <given-names>XX</given-names></name>, <name name-style="western"><surname>Prentice</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Balasubramanian</surname> <given-names>V</given-names></name>. <article-title>A principle of economy predicts the functional architecture of grid cells</article-title>. <source>Elife</source>. <year>2015</year>;<volume>4</volume>:<fpage>e08362</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.08362" xlink:type="simple">10.7554/eLife.08362</ext-link></comment> <object-id pub-id-type="pmid">26335200</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stemmler</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mathis</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Herz</surname> <given-names>AVM</given-names></name>. <article-title>Connecting multiple spatial scales to decode the population activity of grid cells</article-title>. <source>Sci Adv</source>. <year>2015</year>;<volume>1</volume>(<issue>11</issue>):<fpage>e1500816</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1500816" xlink:type="simple">10.1126/science.1500816</ext-link></comment> <object-id pub-id-type="pmid">26824061</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mosheiff</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Agmon</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Moriel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Burak</surname> <given-names>Y</given-names></name>. <article-title>An efficient coding theory for a dynamic trajectory predicts non-uniform allocation of entorhinal grid cells to modules</article-title>. <source>PLoS Comput Biol</source>. <year>2017</year>;<volume>13</volume>(<issue>6</issue>):<fpage>e1005597</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005597" xlink:type="simple">10.1371/journal.pcbi.1005597</ext-link></comment> <object-id pub-id-type="pmid">28628647</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Towse</surname> <given-names>BW</given-names></name>, <name name-style="western"><surname>Barry</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bush</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Burgess</surname> <given-names>N</given-names></name>. <article-title>Optimal configurations of spatial scale for grid cell firing under noise and uncertainty</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source>. <year>2014</year>;<volume>369</volume>(<issue>1635</issue>):<fpage>20130290</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.2013.0290" xlink:type="simple">10.1098/rstb.2013.0290</ext-link></comment> <object-id pub-id-type="pmid">24366144</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hafting</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Fyhn</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Molden</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>. <article-title>Microstructure of a spatial map in the entorhinal cortex</article-title>. <source>Nature</source>. <year>2005</year>;<volume>436</volume>:<fpage>801</fpage>–<lpage>806</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature03721" xlink:type="simple">10.1038/nature03721</ext-link></comment> <object-id pub-id-type="pmid">15965463</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>, <name name-style="western"><surname>Roudi</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Witter</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Kentros</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bonhoeffer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>. <article-title>Grid cells and cortical representation</article-title>. <source>Nat Rev Neurosci</source>. <year>2014</year>;<volume>15</volume>(<issue>7</issue>):<fpage>466</fpage>–<lpage>81</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrn3766" xlink:type="simple">10.1038/nrn3766</ext-link></comment> <object-id pub-id-type="pmid">24917300</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barry</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hayman</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Burgess</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Jeffery</surname> <given-names>KJ</given-names></name>. <article-title>Experience-dependent rescaling of entorhinal grids</article-title>. <source>Nature Neuroscience</source>. <year>2007</year>;<volume>10</volume>:<fpage>682</fpage>–<lpage>684</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1905" xlink:type="simple">10.1038/nn1905</ext-link></comment> <object-id pub-id-type="pmid">17486102</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stensola</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Stensola</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Solstad</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Frøland</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>. <article-title>The entorhinal grid map is discretized</article-title>. <source>Nature</source>. <year>2012</year>;<volume>492</volume>(<issue>7427</issue>):<fpage>72</fpage>–<lpage>78</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature11649" xlink:type="simple">10.1038/nature11649</ext-link></comment> <object-id pub-id-type="pmid">23222610</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sreenivasan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fiete</surname> <given-names>I</given-names></name>. <article-title>Grid cells generate an analog error-correcting code for singularly precise neural computation</article-title>. <source>Nat Neurosci</source>. <year>2011</year>;<volume>14</volume>(<issue>10</issue>):<fpage>1330</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.2901" xlink:type="simple">10.1038/nn.2901</ext-link></comment> <object-id pub-id-type="pmid">21909090</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yoon</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Buice</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Barry</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hayman</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Burgess</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Fiete</surname> <given-names>IR</given-names></name>. <article-title>Specific evidence of low-dimensional continuous attractor dynamics in grid cells</article-title>. <source>Nat Neurosci</source>. <year>2013</year>;<volume>16</volume>(<issue>8</issue>):<fpage>1077</fpage>–<lpage>84</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3450" xlink:type="simple">10.1038/nn.3450</ext-link></comment> <object-id pub-id-type="pmid">23852111</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fyhn</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hafting</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Treves</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>. <article-title>Hippocampal remapping and grid realignment in entorhinal cortex</article-title>. <source>Nature</source>. <year>2007</year>;<volume>446</volume>:<fpage>190</fpage>–<lpage>194</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature05601" xlink:type="simple">10.1038/nature05601</ext-link></comment> <object-id pub-id-type="pmid">17322902</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gardner</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Wernle</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>. <article-title>Correlation structure of grid cells is preserved during sleep</article-title>. <source>bioRxiv</source>. <year>2017</year>; p. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/198499" xlink:type="simple">http://dx.doi.org/10.1101/198499</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005922.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Trettel</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Trimper</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Hwaun</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Fiete</surname> <given-names>IR</given-names></name>, <name name-style="western"><surname>Colgin</surname> <given-names>LL</given-names></name>. <article-title>Grid cell co-activity patterns during sleep reflect spatial overlap of grid fields during active behaviors</article-title>. <source>bioRxiv</source>. <year>2017</year>; p. <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/198671" xlink:type="simple">https://doi.org/10.1101/198671</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005922.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hurwitz</surname> <given-names>A</given-names></name>. <article-title>Ueber die angenaherte Darstellung der Irrationalzahlen durch rationale Bruche (On the approximate representation of irrational numbers by rational fractions)</article-title>. <source>Mathematische Annalen</source>. <year>1891</year>;<volume>39</volume> (<issue>2</issue>):<fpage>279</fpage>–<lpage>284</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF01206656" xlink:type="simple">10.1007/BF01206656</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref020">
<label>20</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Perron</surname> <given-names>O</given-names></name>. <source>Die Lehre von den Kettenbrüchen [The Theory of Continued Fractions] (in German), Chapter 2</source>. <publisher-loc>Leipzig</publisher-loc>: <publisher-name>B. G. Teubner</publisher-name>; <year>1913</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005922.ref021">
<label>21</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Oxtoby</surname> <given-names>JC</given-names></name>. <source>Measure and Category</source>. <publisher-loc>New York-Berlin</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>; <year>1980</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005922.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Broderick</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Fishman</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Kleinbock</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Reich</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Weiss</surname> <given-names>B</given-names></name>. <article-title>The set of badly approximable vectors is strongly C1 incompressible</article-title>. <source>Mathematical Proceedings of the Cambridge Philosophical Society</source>. <year>2012</year>;<volume>153</volume>(<issue>2</issue>):<fpage>319</fpage>–<lpage>339</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1017/S0305004112000242" xlink:type="simple">10.1017/S0305004112000242</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brun</surname> <given-names>VH</given-names></name>, <name name-style="western"><surname>Solstad</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kjelstrup</surname> <given-names>KB</given-names></name>, <name name-style="western"><surname>Fyhn</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Witter</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>, <etal>et al</etal>. <article-title>Progressive increase in grid scale from dorsal to ventral medial entorhinal cortex</article-title>. <source>Hippocampus</source>. <year>2008</year>;<volume>18</volume>(<issue>12</issue>):<fpage>1200</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/hipo.20504" xlink:type="simple">10.1002/hipo.20504</ext-link></comment> <object-id pub-id-type="pmid">19021257</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stensola</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Stensola</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>. <article-title>Shearing-induced asymmetry in entorhinal grid cells</article-title>. <source>Nature</source>. <year>2015</year>;<volume>518</volume>(<issue>7538</issue>):<fpage>207</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature14151" xlink:type="simple">10.1038/nature14151</ext-link></comment> <object-id pub-id-type="pmid">25673414</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Taylor</surname> <given-names>KD</given-names></name>. <article-title>Range of Movement and Activity of Common Rats (Rattus norvegicus) on Agricultural Land</article-title>. <source>Journal of Applied Ecology</source>. <year>1978</year>;<volume>15</volume>(<issue>3</issue>):<fpage>663</fpage>–<lpage>677</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2307/2402767" xlink:type="simple">10.2307/2402767</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tsoar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Nathan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bartan</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Vyssotski</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dell’Omo</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Ulanovsky</surname> <given-names>N</given-names></name>. <article-title>Large-scale navigational map in a mammal</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2011</year>;<volume>108</volume>(<issue>37</issue>):<fpage>E718</fpage>–<lpage>24</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1107365108" xlink:type="simple">10.1073/pnas.1107365108</ext-link></comment> <object-id pub-id-type="pmid">21844350</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Geva-Sagiv</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Las</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Yovel</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ulanovsky</surname> <given-names>N</given-names></name>. <article-title>Spatial cognition in bats and rats: from sensory acquisition to multiscale maps and navigation</article-title>. <source>Nat Rev Neurosci</source>. <year>2015</year>;<volume>16</volume>(<issue>2</issue>):<fpage>94</fpage>–<lpage>108</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrn3888" xlink:type="simple">10.1038/nrn3888</ext-link></comment> <object-id pub-id-type="pmid">25601780</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mathis</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Stemmler</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Herz</surname> <given-names>AV</given-names></name>. <article-title>Probable nature of higher-dimensional symmetries underlying mammalian grid-cell activity patterns</article-title>. <source>Elife</source>. <year>2015</year>;<volume>4</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.05979" xlink:type="simple">10.7554/eLife.05979</ext-link></comment> <object-id pub-id-type="pmid">25910055</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Krupic</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bauza</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Burton</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Barry</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>O’Keefe</surname> <given-names>J</given-names></name>. <article-title>Grid cell symmetry is shaped by environmental geometry</article-title>. <source>Nature</source>. <year>2015</year>;<volume>518</volume>(<issue>7538</issue>):<fpage>232</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature14153" xlink:type="simple">10.1038/nature14153</ext-link></comment> <object-id pub-id-type="pmid">25673417</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stella</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Si</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Kropff</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Treves</surname> <given-names>A</given-names></name>. <article-title>Grid cells on the ball</article-title>. <source>Journal of Statistical Mechanics: Theory and Experiment</source>. <year>2013</year>;<volume>2013</volume>(<issue>03</issue>):<fpage>P03013</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1088/1742-5468/2013/03/P03013" xlink:type="simple">10.1088/1742-5468/2013/03/P03013</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Urdapilleta</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Troiani</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Stella</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Treves</surname> <given-names>A</given-names></name>. <article-title>Can rodents conceive hyperbolic spaces?</article-title> <source>J R Soc Interface</source>. <year>2015</year>;<volume>12</volume>(<issue>107</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2014.1214" xlink:type="simple">10.1098/rsif.2014.1214</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Battaglia</surname> <given-names>FP</given-names></name>, <name name-style="western"><surname>Jensen</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>. <article-title>Path integration and the neural basis of the”cognitive map”</article-title>. <source>Nature Reviews Neurosci</source>. <year>2006</year>;<volume>7</volume>(<issue>8</issue>):<fpage>663</fpage>–<lpage>678</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrn1932" xlink:type="simple">10.1038/nrn1932</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kropff</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Treves</surname> <given-names>A</given-names></name>. <article-title>The emergence of grid cells: Intelligent design or just adaptation?</article-title> <source>Hippocampus</source>. <year>2008</year>;<volume>18</volume>(<issue>12</issue>):<fpage>1256</fpage>–<lpage>69</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/hipo.20520" xlink:type="simple">10.1002/hipo.20520</ext-link></comment> <object-id pub-id-type="pmid">19021261</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Quirk</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>MA</given-names></name>. <article-title>A statistical paradigm for neural spike train decoding applied to position prediction from ensemble firing patterns of rat hippocampal place cells</article-title>. <source>J Neurosci</source>. <year>1998</year>;<volume>18</volume>(<issue>18</issue>):<fpage>7411</fpage>–<lpage>25</lpage>. <object-id pub-id-type="pmid">9736661</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Samu</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Eros</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ujfalussy</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Kiss</surname> <given-names>T</given-names></name>. <article-title>Robust path integration in the entorhinal grid cell system with hippocampal feed-back</article-title>. <source>Biol Cybern</source>. <year>2009</year>;<volume>101</volume>(<issue>1</issue>):<fpage>19</fpage>–<lpage>34</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00422-009-0311-z" xlink:type="simple">10.1007/s00422-009-0311-z</ext-link></comment> <object-id pub-id-type="pmid">19381679</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Burak</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Fiete</surname> <given-names>IR</given-names></name>. <article-title>Fundamental limits on persistent activity in networks of noisy neurons</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2012</year>;<volume>109</volume>(<issue>43</issue>):<fpage>17645</fpage>–<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1117386109" xlink:type="simple">10.1073/pnas.1117386109</ext-link></comment> <object-id pub-id-type="pmid">23047704</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Issa</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>K</given-names></name>. <article-title>Universal conditions for exact path integration in neural systems</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2012</year>;<volume>109</volume>(<issue>17</issue>):<fpage>6716</fpage>–<lpage>20</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1119880109" xlink:type="simple">10.1073/pnas.1119880109</ext-link></comment> <object-id pub-id-type="pmid">22493275</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Burak</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Fiete</surname> <given-names>IR</given-names></name>. <article-title>Accurate path integration in continuous attractor network models of grid cells</article-title>. <source>PLoS Comput Biol</source>. <year>2009</year>;<volume>5</volume>(<issue>2</issue>):<fpage>e1000291</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1000291" xlink:type="simple">10.1371/journal.pcbi.1000291</ext-link></comment> <object-id pub-id-type="pmid">19229307</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Giocomo</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Hussaini</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Zheng</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Kandel</surname> <given-names>ER</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>. <article-title>Grid cells use HCN1 channels for spatial scaling</article-title>. <source>Cell</source>. <year>2011</year>;<volume>147</volume>(<issue>5</issue>):<fpage>1159</fpage>–<lpage>70</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2011.08.051" xlink:type="simple">10.1016/j.cell.2011.08.051</ext-link></comment> <object-id pub-id-type="pmid">22100643</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Urdapilleta</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Si</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Treves</surname> <given-names>A</given-names></name>. <article-title>Selforganization of modular activity of grid cells</article-title>. <source>Hippocampus</source>. <year>2017</year>;<volume>27</volume>(<issue>11</issue>):<fpage>1204</fpage>–<lpage>1213</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/hipo.22765" xlink:type="simple">10.1002/hipo.22765</ext-link></comment> <object-id pub-id-type="pmid">28768062</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>, <name name-style="western"><surname>Kropff</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>. <article-title>Place cells, grid cells, and the brain’s spatial representation system</article-title>. <source>Annu Rev Neurosci</source>. <year>2008</year>;<volume>31</volume>:<fpage>69</fpage>–<lpage>89</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev.neuro.31.061307.090723" xlink:type="simple">10.1146/annurev.neuro.31.061307.090723</ext-link></comment> <object-id pub-id-type="pmid">18284371</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Etienne</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Jeffery</surname> <given-names>KJ</given-names></name>. <article-title>Path integration in mammals</article-title>. <source>Hippocampus</source>. <year>2004</year>;<volume>14</volume>:<fpage>180</fpage>–<lpage>192</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/hipo.10173" xlink:type="simple">10.1002/hipo.10173</ext-link></comment> <object-id pub-id-type="pmid">15098724</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ormond</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>. <article-title>Place field expansion after focal MEC inactivations is consistent with loss of Fourier components and path integrator gain reduction</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2015</year>;<volume>112</volume>(<issue>13</issue>):<fpage>4116</fpage>–<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1421963112" xlink:type="simple">10.1073/pnas.1421963112</ext-link></comment> <object-id pub-id-type="pmid">25733884</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref044">
<label>44</label>
<mixed-citation publication-type="other" xlink:type="simple">Drmota M, Tichy RF. Sequences, Discrepancies and Applications. Lecture Notes in Math, Springer Verlag, Berlin. 1997; no. 1651.</mixed-citation>
</ref>
<ref id="pcbi.1005922.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cassels</surname> <given-names>J</given-names></name>. <article-title>Simultaneous Diophantine Approximation II</article-title>. <source>Proc London Math Soc</source>. <year>1955</year>;(<issue>3</issue>), <volume>5</volume>:<fpage>435</fpage>–<lpage>448</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1112/plms/s3-5.4.435" xlink:type="simple">10.1112/plms/s3-5.4.435</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lenstra</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Lenstra</surname> <given-names>HW</given-names></name>, <name name-style="western"><surname>Lovász</surname> <given-names>L</given-names></name>. <article-title>Factoring polynomials with rational coefficients</article-title>. <source>Mathematische Annalen</source>. <year>1982</year>;<volume>261</volume>(<issue>4</issue>):<fpage>515</fpage>–<lpage>534</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF01457454" xlink:type="simple">10.1007/BF01457454</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005922.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Land</surname> <given-names>AH</given-names></name>, <name name-style="western"><surname>Doig</surname> <given-names>AG</given-names></name>. <article-title>An Automatic Method of Solving Discrete Programming Problems</article-title>. <source>Econometrica</source>. <year>1960</year>;<volume>28</volume>(<issue>3</issue>):<fpage>497</fpage>–<lpage>520</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2307/1910129" xlink:type="simple">10.2307/1910129</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>