<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article article-type="research-article" dtd-version="3.0" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004868</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00659</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Industrial engineering</subject><subj-group><subject>Quality control</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Bioassays and physiological analysis</subject><subj-group><subject>Microarrays</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Research design</subject><subj-group><subject>Experimental design</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein complexes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Specimen preparation and treatment</subject><subj-group><subject>Mechanical treatment of specimens</subject><subj-group><subject>Specimen disruption</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Molecular biology assays and analysis techniques</subject><subj-group><subject>Nucleic acid analysis</subject><subj-group><subject>RNA analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Molecular biology assays and analysis techniques</subject><subj-group><subject>Nucleic acid analysis</subject><subj-group><subject>RNA analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein interactions</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>AuPairWise: A Method to Estimate RNA-Seq Replicability through Co-expression</article-title>
<alt-title alt-title-type="running-head">RNA-Seq Replicability via Co-expression</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Ballouz</surname>
<given-names>Sara</given-names>
</name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Gillis</surname>
<given-names>Jesse</given-names>
</name>
<xref ref-type="corresp" rid="cor001">*</xref>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001"><addr-line>Stanley Institute for Cognitive Genomics, Cold Spring Harbor Laboratory, Cold Spring Harbor, New York, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Rattray</surname>
<given-names>Magnus</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Manchester, UNITED KINGDOM</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: JG. Performed the experiments: SB. Analyzed the data: SB JG. Wrote the paper: SB JG.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">jgillis@cshl.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>15</day>
<month>4</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="collection">
<month>4</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>4</issue>
<elocation-id>e1004868</elocation-id>
<history>
<date date-type="received">
<day>22</day>
<month>4</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>14</day>
<month>3</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Ballouz, Gillis</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004868"/>
<abstract>
<p>In addition to detecting novel transcripts and higher dynamic range, a principal claim for RNA-sequencing has been greater replicability, typically measured in sample-sample correlations of gene expression levels. Through a re-analysis of ENCODE data, we show that replicability of transcript abundances will provide misleading estimates of the replicability of conditional variation in transcript abundances (i.e., most expression experiments). Heuristics which implicitly address this problem have emerged in quality control measures to obtain ‘good’ differential expression results. However, these methods involve strict filters such as discarding low expressing genes or using technical replicates to remove discordant transcripts, and are costly or simply ad hoc. As an alternative, we model gene-level replicability of differential activity using co-expressing genes. We find that sets of housekeeping interactions provide a sensitive means of estimating the replicability of expression changes, where the co-expressing pair can be regarded as pseudo-replicates of one another. We model the effects of noise that perturbs a gene’s expression within its usual distribution of values and show that perturbing expression by only 5% within that range is readily detectable (AUROC~0.73). We have made our method available as a set of easily implemented R scripts.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>RNA-sequencing has become a popular means to detect the expression levels of genes. However, quality control is still challenging, requiring both extreme measures and rules which are set in stone from extensive previous analysis. Instead of relying on these rules, we show that co-expression can be used to measure biological replicability with extremely high precision. Co-expression is a well-studied phenomenon in which two genes that are known to form a functional unit are also expressed at similar levels, and change in similar ways across conditions. Using this concept, we can detect how well an experiment replicates by measuring how well it has retained the co-expression pattern across defined gene-pairs. We do this by measuring how easy it is to detect a sample to which some noise has been added. We show this method is a useful tool for quality control.</p>
</abstract>
<funding-group>
<funding-statement>JG and SB were supported by a grant from T. and V. Stanley. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="0"/>
<page-count count="28"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files. All scripts are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/sarbal/AuPairWise" xlink:type="simple">https://github.com/sarbal/AuPairWise</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Recent analyses of RNA-seq have emphasized the value added by experimental designs with more samples, permitting better estimation of biological and technical variability [<xref ref-type="bibr" rid="pcbi.1004868.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1004868.ref004">4</xref>]. Unfortunately, this does not automatically translate into an experimental design decision for more replicates (biological or technical), largely due to the relatively high cost of RNA-seq, which can range anywhere from 10c to $10 per Mbp [<xref ref-type="bibr" rid="pcbi.1004868.ref005">5</xref>]. Study design is further complicated by complex dependencies on the platform chosen, library preparation and normalization methods; all these factors affect the concordance of downstream differential expression analysis, as a recent set of large scale studies have systematically demonstrated [<xref ref-type="bibr" rid="pcbi.1004868.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1004868.ref009">9</xref>]. While researchers have to be aware of the pitfalls that can arise when designing their experiment, they receive only modest feedback in the experimental data itself as to whether their choices were successful. While many optimized protocols or best practices exist, there are few means for assessing the quality of a given transcriptomic study, particularly outside of purely technical concerns and where focusing on novel biology.</p>
<p>Systematic and large scale studies assess new technologies for appropriate guidelines and best practices at great cost, time and effort. When microarrays began to be used for drug development, the Food and Drug Agency (FDA) set up the MicroArray Quality Control (MAQC) for general standards of practice in order to assure high quality and replicability [<xref ref-type="bibr" rid="pcbi.1004868.ref010">10</xref>]. In a similar fashion for RNA-seq, Sequencing Quality Control (SEQC or MAQC-III) and the Association of Biomolecular Resource Facilities (ABRF) were tasked to determine a set of gold-standard pipelines, protocols and metrics for assessment [<xref ref-type="bibr" rid="pcbi.1004868.ref005">5</xref>,<xref ref-type="bibr" rid="pcbi.1004868.ref009">9</xref>].</p>
<p>Extensive work and funding were put into these efforts: evaluating terabytes of data, across numerous preparation conditions, platforms, sample types, experiment sizes, read depths, computational quantification methods, statistical measurements and other diagnostics. The projects successfully identified the strengths and weaknesses of various aspects of RNA-seq but, alarmingly, could not generalize these findings to a consensus gold-standard method or technique. Different platforms gave different biases, depending on the chemistry of the reactions, length of the reads, the amplification of the sample and method of degradation of ribosomal RNA, to name a few. These are reflected in underlying sequence-based biases from GC content, genome size and gene size.</p>
<p>Many of these properties are addressed directly in quality control practices which have a strong history in microarray analyses and can be applied to RNA-seq without too much loss of generality. A notable example is batch detection and correction, long identified as critical in microarrays (e.g., [<xref ref-type="bibr" rid="pcbi.1004868.ref011">11</xref>]), and for which methods have been adapted for use in RNA-seq [<xref ref-type="bibr" rid="pcbi.1004868.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1004868.ref012">12</xref>]. Technical quality control metrics attached to the samples, such as RNA integrity [<xref ref-type="bibr" rid="pcbi.1004868.ref013">13</xref>], read coverage, GC content, etc. (e.g, RSeQC [<xref ref-type="bibr" rid="pcbi.1004868.ref014">14</xref>], RNA-SeQC [<xref ref-type="bibr" rid="pcbi.1004868.ref015">15</xref>]), may also be applied without alteration to RNA-seq analyses, even if the effect of such biases may be technologically dependent. Novel quality control assessments for RNA-seq have also been developed or adapted such as the irreproducible discovery rate (IDR), initially developed for CHIP-seq data [<xref ref-type="bibr" rid="pcbi.1004868.ref016">16</xref>], and then applied by ENCODE to RNA-seq data [<xref ref-type="bibr" rid="pcbi.1004868.ref017">17</xref>]. Competing statistical approaches to detect replicable signals (e.g., SERE [<xref ref-type="bibr" rid="pcbi.1004868.ref018">18</xref>]) are also in use. In all these cases, the quality control is more focused on identifying or correcting purely statistical properties without exploiting biology in any way. The latter task is challenging precisely because the biology depends on the exact experiment being performed.</p>
<p>Similarly, spike-ins of known concentrations of RNA, such as those of the External RNA Control Consortium (ERCC) [<xref ref-type="bibr" rid="pcbi.1004868.ref019">19</xref>], can be used for quality control in specific cases and to identify technical artifacts but they are useful precisely because they are independent of the biology of the experiment. Even so, their results suggest variation in expression from experiment to experiment that is large enough that there is no way to universally ‘normalize away’ our biases in a one-size-fits-all manner [<xref ref-type="bibr" rid="pcbi.1004868.ref007">7</xref>]. Instead of standardizing reads, filters are recommended to remove unwanted variation, which in the case of the recommendations from SEQC/MAQC-III, includes discarding a third of the genes with low expression levels and those outside a fold change (FC) threshold between samples (which was algorithm dependent, log<sub>2</sub> FC ~1–2). But these are general rules whose relevance must vary from case to case. How well do these heuristics generalize to carefully designed experiments conducted in an entirely different biological system?</p>
<p>In most individual labs, there will be little to no data to assess this question directly. Few labs can afford experimental designs which use samples purely as replicates for quality control. This is unfortunate, since often the experimental design is specifically intended to address noise in the biological system. There is no easy and systematic way of seeing whether this worked, outside of the experiment giving expected results, but it is unexpected results that are particularly valuable. Ideally, the results that are used for validation can provide a finely calibrated sense of performance without impinging on the capacity for novel discovery, but this will be challenging since the same data will likely be used in both cases. As a consequence of this, assessment of RNA-seq efficacy in any targeted experiment is typically difficult, relying on experts in the particular experimental system finding the results plausible (but not too obvious). The few truly generally applicable quality controls are extremely coarse, and focus more on technical properties, such as read depth, coverage, and related measures.</p>
<p>Ideally, each lab could conduct their own RNA-seq quality control, relying either on costly replicates, or some sub-class of ‘expected’ result which does not diminish the freedom to obtain other unexpected results. Our approach to this problem is to focus on modelling the behavior of tightly co-expressed genes. Gene-pairs which are very tightly co-expressed can be thought of as a form of a pseudo-replicate and have the advantage of reflecting a broadly applicable biological property orthogonal to the tested variation in most studies, which are usually based on differential expression. Of course, to the extent we rely on ‘knowing’ pairs of genes are co-expressed to determine experimental success, we diminish our ability to find we were mistaken about this property. To deal with this issue, our analysis relies on weak relationships across many genes but no strong knowledge of any single gene and only a tiny fraction of gene-gene-pairs or ‘housekeeping interactions’[<xref ref-type="bibr" rid="pcbi.1004868.ref020">20</xref>].</p>
<p>In this paper, we demonstrate a straightforward but surprisingly powerful method, which we have named AuPairWise, to measure replicability by modelling the effects of noise within observed co-expression. Because of the breadth and extent of co-expression, it provides a sensitive, yet general means of performing a quality control. We argue this in roughly three steps. We begin our analysis by performing some sample and replicate-based analyses of RNA-seq quality to establish general properties. Second, we show how common heuristics for quality control appear in a co-expression based framework. Finally we provide a means of directly quantifying this by disruption of known co-expression pairs using a model based on empirical distributions of expression data.</p>
<p>By providing a direct quality control measure, we hope to make it straightforward to customize experiments to do better than a general heuristic—such as discarding all low-expressing genes–would normally permit. We make our software available in a convenient form for bioinformatic use (<ext-link ext-link-type="uri" xlink:href="https://github.com/sarbal/AuPairWise" xlink:type="simple">https://github.com/sarbal/AuPairWise</ext-link>).</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Part I: Reviewing replicability</title>
<sec id="sec004">
<title>Two measures of expression replicability in RNA-seq</title>
<p>Before assessing replicability, it’s necessary to provide a sense of the meaning which we attach to the term. Broadly, replicability in RNA-seq is used in two quite different ways, one focusing on the replicability of estimates of mean gene expression (sample-level replicability) and the other on variation in gene expression (gene-level replicability). The earliest method is to assess whether a given pair of samples is well correlated across its transcripts or genes. This measures whether genes have similar expression in the two samples and by this standard, all RNA-seq has high enough replicability that we never need worry. Unfortunately, this doesn’t map to a very experimentally useful measure since most experiments are concerned with a gene’s variation in expression under changing conditions (i.e., for differential expression). To see why these two forms of replicability do not align, consider an early reference experiment [<xref ref-type="bibr" rid="pcbi.1004868.ref021">21</xref>] which reported high replicability in a given pair of samples from the liver, as measured by a correlation across transcripts of Spearman’s <italic>r</italic><sub><italic>s</italic></sub> = 0.976 (p&lt;1e-15, Fisher’s transformation) (<xref ref-type="fig" rid="pcbi.1004868.g001">Fig 1A</xref>). But this correlation is partially a property of transcript abundances having an approximate transcript-specific range defined regardless of tissue. As we can see, the correlation comparing the liver and the kidney is also very high (<xref ref-type="fig" rid="pcbi.1004868.g001">Fig 1B</xref>), and indeed, variation from one experiment [<xref ref-type="bibr" rid="pcbi.1004868.ref022">22</xref>] to another is sufficient to make correlations across tissues within an experiment appear much greater than those within tissues but across experiments (<xref ref-type="fig" rid="pcbi.1004868.g001">Fig 1C</xref>).</p>
<fig id="pcbi.1004868.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004868.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Individual genes have similar expression levels in many tissues.</title>
<p>Samples replicate one another to some degree, regardless of the conditions under which they are measured, i.e., whether it is actually a biological replicate or not. (A) Liver expression levels within the same experiment are very highly correlated (Spearman’s <italic>r</italic><sub><italic>s</italic></sub> = 0.976, Pearson’s <italic>r</italic> = 0.999). (B) Liver expression is moderately correlated to kidney expression within the same experiment (Spearman’s <italic>r</italic><sub><italic>s</italic></sub> = 0.837, Pearson’s <italic>r</italic> = 0.894). (C) Liver expression levels in two different experiments are less well correlated than that between tissues (Spearman’s <italic>r</italic><sub><italic>s</italic></sub> = 0.846, Pearson’s <italic>r</italic> = 0.537).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.g001" xlink:type="simple"/>
</fig>
<p>Rather than this sense of replicability, we are primarily concerned with the degree to which changes in expression for a given gene are replicable (i.e., gene-level replicability or self-correlation). While the importance of replicability in terms of differential expression has been appreciated from the first MAQC forward [<xref ref-type="bibr" rid="pcbi.1004868.ref023">23</xref>], it is difficult to generalize from differences due to specific conditions (e.g., tissues vs disease) to make cross-experiment comparisons characterizing quality control. It is this differential expression sense of replicability that is useful in most biological experiments, but the problem in even assessing it within a given experiment is that it requires enough samples to at least partially replicate the entire experiment. Additionally, the degree to which genes show replicable differences will depend in part on the degree to which they show condition-dependent variability at all.</p>
</sec>
<sec id="sec005">
<title>A contradiction between the replicability measures</title>
<p>As a brief experiment to further motivate a different metric of replicability, consider data for which we have a replicate for each expression measurement across multiple conditions for each gene; essentially, extending <xref ref-type="fig" rid="pcbi.1004868.g001">Fig 1A</xref> to even more conditions and plotting all the points at once. We show this using reference data from ENCODE in <xref ref-type="fig" rid="pcbi.1004868.g002">Fig 2</xref>, where each point represents a gene under a given condition with x-values being the initial expression measure and y-values being the replicate measurement (for that gene under that condition, see <xref ref-type="sec" rid="sec016">Materials and Methods</xref> section <bold>“Measuring replicability: correlations and sample estimates”</bold>). First, we show the gene-gene correlations for each sample (<xref ref-type="fig" rid="pcbi.1004868.g002">Fig 2A</xref>, each sample is a color, we show 9 of the 18 samples for clarity) and then the overlay of these as a replicate-replicate plot (<xref ref-type="fig" rid="pcbi.1004868.g002">Fig 2B</xref>). Clearly, there is a high level of correlation between the measurements of expression. We can display specific genes in that same plot by highlighting them; each with quite distinct dynamic ranges (colored in <xref ref-type="fig" rid="pcbi.1004868.g002">Fig 2C and 2D</xref>). Because genes will only vary within their own dynamic range, collectively measuring replicability ignores the gene specific variation. A given gene’s measured expression could be well correlated with the same gene when measured in the replicate data (the subset highlighted in <xref ref-type="fig" rid="pcbi.1004868.g002">Fig 2C</xref>) or poorly correlated (subset highlighted in <xref ref-type="fig" rid="pcbi.1004868.g002">Fig 2D</xref>), but the correlation across genes for a given condition would not reveal it: the fact gene A is higher in expression than gene B is not at all condition dependent (because of the disjoint dynamic ranges). Thus, the more genes have an approximate set point in expression, the more trivially replicable the correlation of transcript abundances between two samples regardless of condition, and the less the two measures of replicability have any relation. Ironically, one of the chief claims made of RNA-seq–that it has high dynamic range–would only increase this tendency, since it provides more ‘space’ for each transcript to occupy a separate expression domain, yielding perfect but meaningless sample-sample correlations. Note that here, as in the rest of this paper, we are concerned solely with gene-level mapping and use ‘transcript abundance’ to refer simply to a given gene’s expression. Transcript variability for a given gene is, of course, a topic of great interest, but are challenging in their own right. We focus here on establishing more basic properties first.</p>
<fig id="pcbi.1004868.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004868.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Simpson’s paradox in expression data.</title>
<p>(A) Sample-sample replicability plots are possible for each of the 18 conditions tested. Shown are a representative set of 9 sample-sample plots. Each point represents a gene with X and Y values being the two expression measures, i.e., original and replicate. Different samples are shown in different colors. (B) We overlay all these individual sample-sample plots onto the same axes to give the aggregate view of expression across samples and their replicates. This allows us to determine replication of gene variation across samples. (C) Some genes replicate well; changing their expression in a consistent way across samples and their replicates. We have highlighted genes which are positively correlated with their replicate across the samples and also have no overlapping dynamic ranges. Note that sample-sample correlations across this set of genes would be high even if the labels identifying samples were permuted (inset of “Gene A” shows labelled samples). (D) There are also genes which are negatively correlated with their replicates across samples (inset of “Gene B” shows labelled samples). And because they also do not have overlapping dynamic ranges the sample-sample correlation across these genes would remain high for any given sample pair.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.g002" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec006">
<title>Part II: Refining replicability through expression co-variation</title>
<sec id="sec007">
<title>Defining ‘replicability’ when measuring expression variation</title>
<p>Rather than measuring dynamic range by the number of genes differentiable by their expression within some range, we really need to know the number of conditions differentiable by the expression of each gene. That is, a gene has a ‘good’ precision over its dynamic range when change in its expression provides information about the condition under which it was measured. In future, we will use ‘replicate’ to refer exclusively to gene-level replication (or self-correlation), in which we consider whether a gene’s variation from condition to condition is replicable when the same conditions are re-measured. This is similar to the idea of checking if genes are reproducibly being detected as differentially expressed, i.e., if genes are DE in both replicates, but we are measuring correlations and not fold changes.</p>
<p>To assess this for each gene, we would like a range of conditions which we expect that gene to vary under, i.e., different tissues, varying time points or treatments. We would also like replicates for each of those conditions. With these, we can measure the degree to which, for each gene, its variation is distinguishable. One experiment that fits this general design was ENCODE’s RNA-seq profiling experiment (GSE35584), which looked at various biological cell lines under multiple treatments. We take ENCODE’s own labelling of the data into two batches to define the grouping of the data into sets of samples. ENCODE performed a number of perturbations likely to be genome-wide in effect. In this case, if a gene’s changed expression is meaningful, it should be correlated with its replicate across the range of conditions. However, not all genes are expected to show differential activity, and particularly if they are only modestly perturbed. For each gene, we can measure whether it does, in fact, show variation that is consistent when the same condition is measured (across all conditions). In the ENCODE data (20,635 genes detected), we find after multiple test correction that over 16,000 genes were significantly correlated (q&lt;0.05, Fisher’s transformation, Holm-Bonferroni corrected) with their replicates across the samples (<xref ref-type="fig" rid="pcbi.1004868.g003">Fig 3A</xref>), giving us a coverage of approximately ~78% of the genes in this experiment (77.7%—Student’s <italic>T</italic>, or 78.2%—Fisher’s transformation).</p>
<fig id="pcbi.1004868.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004868.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Gene expression replication across the genome.</title>
<p>(A) In the reference ENCODE data, many genes are well correlated with their replicate across the range of conditions, but the distribution has a heavy negative tail. (B) For the same example experiment, almost 80% of the genes are significantly (q&lt;0.05) replicated, as characterized by the correlation between gene replicates across conditions. (C) Across experiments in GEO, only a minority (~34%) are likely to be able to produce replicable results for more than half of the typically assayed transcriptome.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.g003" xlink:type="simple"/>
</fig>
<p>If we assume this correlation distribution holds constant, we can estimate that to significantly (q&lt;0.05) cover 90% of the transcriptome we would need to increase the number of samples to over 50, and for 95% coverage, over a hundred samples (<xref ref-type="fig" rid="pcbi.1004868.g003">Fig 3B</xref>, see <xref ref-type="sec" rid="sec016">Materials and Methods</xref> section <bold>“Measuring replicability: correlations and sample estimates”</bold> for more details). Similarly, we can assess the potential coverages of prior experiments based on their sample count, and, as a proxy, assess how replicable their results are for particular genes. Evaluating 1,451 publicly available experiments, we estimate that many experiments only have enough samples to produce significantly replicable results for a small fraction of the genome, with only 34% of experiments assessed having coverage above 50% (<xref ref-type="fig" rid="pcbi.1004868.g003">Fig 3C</xref>). Even though the whole transcriptome is measured in these experiments, using correlation as quantification demonstrates that we are not powered to detect variation sensitively for most of the genes with low sample sizes. Of course, this is subject to the important caveat that the experiments are, indeed, expected to produce replicable variation between control and experimental conditions only for a small fraction of genes: those actively relevant to the experimental perturbation.</p>
<p>One potential confound in this analysis is that increasing artifacts would broadly seem likely to increase the correlation of replicates, so long as the artifacts were maintained across replicates. Of course, this would be a problem with any sort of replication (if artifacts replicate, replication doesn’t help as much). This can be controlled for since such artifacts would generically improve the correlation between a gene and all others, rather than specifically itself in the replicate data.</p>
<p>We calculated the correlation of each gene with all others in the replicate data to provide such reference information. We then calculated the rank of a gene’s correlation with itself versus all other genes within the experiment. If the variation in expression that a gene shows is meaningful, we would expect it to have a higher correlation to the replicate of itself than other genes. We do observe from the distribution of self-correlation (i.e., gene-level replicability as previously defined) versus correlations to other genes (i.e., co-expression, co-regulation) that genes are much better correlated to themselves in replicate data than to other genes (<xref ref-type="fig" rid="pcbi.1004868.g004">Fig 4</xref>) with almost 20% even being better correlated with their measurement in the replicate data than with any other gene in the replicate data (4,024 genes). This suggests that having closely replicating gene profiles is a relatively common occurrence in high quality data.</p>
<fig id="pcbi.1004868.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004868.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Self-correlation (replicability) and co-expression.</title>
<p>The degree of correlation between a gene and its replicate is plotted relative to all other genes (relative rank). As would be expected, as the correlation between a gene and its replicate (across the same conditions) rises, the rank of that correlation relative to the value between the given gene and all others also rises. However, the true replicate is only most similar to the given gene in ~20% of cases (solid black line, 4,024 genes), i.e., the solid line is at 0.2 when the rank is exactly 1 (dashed lines). The steep fall off in this trend shows that most replicates are at least very highly ranked by the correct gene.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.g004" xlink:type="simple"/>
</fig>
<p>The average correlation of the genes in the experiment is high (Pearson’s <italic>r</italic> = 0.97, SD 0.04). If we relax our definition slightly so that the gene has to rank its replicate within the top 10%, we see that 90% of the genes pass that threshold and that they have an average correlation of 0.9. We have used this mean value as a cutoff (Pearson's <italic>r</italic> = 0.9) to characterize ‘reasonable’ replicability for our further analysis of this study. This is more stringent than simple significant correlation; we are requiring it to be above the mean of genes with a non-parametric ‘preference’ to be correlated with themselves and close to the point nearest the top right corner (best performance). Of course, because actual biological co-expression exists (a fact we will exploit), pristine results in self-correlation are not to be expected and all downstream results are robust to any reasonable variation in this threshold. We discuss the potential role of normalization creating generic correlation across all genes in the “<bold>Robustness analysis of AuPairWise”</bold> section.</p>
</sec>
<sec id="sec008">
<title>Mapping general QC heuristics to the replicability of expression changes</title>
<p>We now move on to see whether this analysis of replication matches standard heuristics. The SEQC concluded that low expressing genes, equivalent to 1/3<sup>rd</sup> of the measured dynamic range of the whole experiment, and genes with lower fold changes between conditions (&lt;log<sub>2</sub> FC 1~2) should be discarded from analyses [<xref ref-type="bibr" rid="pcbi.1004868.ref009">9</xref>]. To assess these thresholds independently, we measure their downstream impact on replicability in our reference ENCODE data. For each gene, we plot in <xref ref-type="fig" rid="pcbi.1004868.g005">Fig 5C</xref> its total mean expression (x-values) against its average fold change between conditions (y-values), and then color points according to their replicability, measured as the correlation a given gene shows with its replicates across the conditions. This allows us to visualize how the SEQC criteria align with our own definition of replicability.</p>
<fig id="pcbi.1004868.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004868.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Low expression levels and high fold changes provide sensitive quality control.</title>
<p>(A) Histogram of fraction of genes poorly replicable and filtered on mean expression (B) or fold change. (C) Plotting the average expression against the fold change to compare gene-gene replicability to the SEQC criteria. The red points are genes that were not well correlated (Pearson’s <italic>r</italic>&lt; 0.9) with their replicates across conditions. The fraction of these red points across mean expression (log<sub>2</sub> FPKM) is shown in the histogram in panel A, and the fraction of these red points across fold change (log<sub>2</sub>) is shown in the panel B. The recommended filters by the SEQC are shown by the dotted blue lines, across both mean and fold change. We see that the fraction of poorly replicated genes drops significantly at the recommended filters–i.e., discarding fold changes less than log<sub>2</sub> 1~2, and discarding the lowly expressing genes (bottom 1/3<sup>rd</sup>). The grey lines show the histograms for a given measure (mean expression–A, fold change -B) contingent on the SEQC criterion for the other having already been applied.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.g005" xlink:type="simple"/>
</fig>
<p>Overall, most of the genes with low replicability (red points in <xref ref-type="fig" rid="pcbi.1004868.g005">Fig 5C</xref>) are low expressing genes and have low fold changes. Indeed, if we wish to threshold the data for particular fold changes and expression levels so that they are replicable as we have defined the term, we would end up with results similar to the SEQC guidelines (blue dashed lines in <xref ref-type="fig" rid="pcbi.1004868.g005">Fig 5</xref>). Applying the fixed guidelines and removing the bottom third of expressing genes leaves us with 97% of genes showing good replicability (Pearson’s <italic>r</italic>≥0.9 across replicates, p&lt;1e-15, Fisher’s transformation [<xref ref-type="bibr" rid="pcbi.1004868.ref024">24</xref>], <xref ref-type="fig" rid="pcbi.1004868.g005">Fig 5A</xref>), as compared to 61% of genes in the data overall. Likewise, poor replicability is concentrated at low fold changes in the data with irreproducible genes (Pearson’s <italic>r</italic>&lt;0.9, <xref ref-type="fig" rid="pcbi.1004868.g005">Fig 5B</xref>) having a mean fold change of 2^0.48 and reproducible genes (Pearson’s <italic>r</italic>≥0.9) having a significantly higher mean fold change of 2^1.08 (p~2.34e-154, Wilcoxon test), similar to the threshold suggested by the SEQC experiments. One difference from the SEQC evaluation is that the irreproducible genes are not subject to their two criteria (mean expression and fold change) independently; we can see that there is some dependency between the two constraints and past a certain fold change, filtering on expression would not make a substantial difference (i.e., there are little to no genes with very high FC and low mean expression). We also note that although our definition of a “reproducible gene” here is set by a somewhat arbitrary threshold of 0.9, the mean correlation shows the same trend across the two criteria, perhaps even more distinctly (<xref ref-type="supplementary-material" rid="pcbi.1004868.s002">S1 Fig</xref>). Thus, we suggest self-correlation across conditions is a more useful and practical way of defining replicability.</p>
</sec>
</sec>
<sec id="sec009">
<title>Part III: Using co-expression as a proxy for replicability</title>
<sec id="sec010">
<title>A co-expression heuristic to estimate gene expression replicability</title>
<p>Motivated by our view that a gene’s co-expression across conditions with itself in a replicate is a useful view of replicability, we wished to determine how this could generalize to comparisons between different genes that are very tightly co-expressed or even stoichiometrically co-regulated. In the same way that a gene should be well correlated with itself across conditions, we hypothesize that there are gene-pairs whose functional relationship is so specific, that the pair can be treated as pseudo-replicates of one another. These pairs will show similar expression profiles and where that does not occur, we can infer poor replicability within a given data set. We call these pairs of genes “housekeeping interactions”. Selection of these pairs is described in further detail in the <xref ref-type="sec" rid="sec016">Materials and Methods</xref> section “<bold>Selecting co-expressed pairs</bold>” while much of the remainder of this paper provides evidence that these pairs serve as an extraordinarily sensitive means to detect disruption within data.</p>
<p>Proteins in complexes have been found to be highly co-expressed, such as in the proteasome [<xref ref-type="bibr" rid="pcbi.1004868.ref025">25</xref>,<xref ref-type="bibr" rid="pcbi.1004868.ref026">26</xref>], and these genes respond to changes in the cell or tissue in a tightly regulated way. This stoichiometry–where parts of a protein complex are required in fixed quantities—can be used as a useful filter to obtain candidate gene-pairs. We thus derived this set of gene-pairs—our housekeeping interactions—by extracting the top co-expressing partners from a large scale meta-analysis of co-expression data [<xref ref-type="bibr" rid="pcbi.1004868.ref027">27</xref>], and those that were annotated as protein complexes. That co-expression data is separate from the remainder used in this work (and thus may be thought of as training data for the analyses conducted here). We note that while no individual pair is guaranteed to be correct, our principal interest is in enriching for tight co-expression so that aggregate signals are detectable.</p>
<p>The top co-expressed pairs in the housekeeping interaction list are between a unique set of 1,117 genes (i.e., some genes occur multiple times). We observe that these genes are enriched for cellular functions related to the cell cycle (e.g., GO:0051301 cell division p&lt;4.82e-89) or a cellular structure (e.g., GO:0000776 kinetochore p&lt;4.91e-40) amongst similar others (<xref ref-type="supplementary-material" rid="pcbi.1004868.s010">S1 Table</xref>). We expect enrichment for these functions primarily because we have selected for genes that intersect with those annotated as protein complexes. We also suggest that these basic biological functions are plausible as characteristic of the set of genes with housekeeping interactions which will remain under regulatory control, even once subject to experimental perturbation (i.e., some subset of the pairwise relationships will be held constant or necessarily co-disrupted). We also consider pairs defined by strongly conserved co-expression across species as a secondary test set and a set defined purely by protein interaction as a third set.</p>
</sec>
<sec id="sec011">
<title>Modelling the impact of perturbations on co-expression to estimate gene expression replicability</title>
<p>For any of these tightly regulated gene-pairs, we expect that variation in the expression of one gene should match the variation in expression of its co-regulated partner, and it is this matching which we evaluate in the following. Going through our methodology in steps, a gene’s expression levels in an experiment along with the same data for the gene’s co-expression partner gives two gene expression profiles (<xref ref-type="fig" rid="pcbi.1004868.g006">Fig 6A</xref>). It would be expected that if the expression data for these genes shows some differential signal across samples (i.e., biological differences), these two profiles would show a high correlation across the samples (<xref ref-type="fig" rid="pcbi.1004868.g006">Fig 6B</xref>). However, if one or more samples have low precision in its estimate of the gene expression, this will weaken their correlation. Of course, for the genes to serve as equivalent to replicates, they must be subject to primarily independent sources of error. This is clearly not wholly true–minimally, they’re drawn from the same sample–but co-expression which is conserved, defines a protein complex or is seen in many independent experiments seems unlikely to be due to shared artifacts (although we evaluate this).</p>
<fig id="pcbi.1004868.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004868.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Co-expression perturbations to pick out samples with high variation.</title>
<p>(A) Expression levels of genes X and Y. (B) Gene X and Y show good correlation (Spearman’s <italic>r</italic><sub><italic>s</italic></sub> = 0.9). (C) If we add noise to one sample, we see a shift. The noise model is described further in the Materials and Methods section. Briefly, for each gene in a sample, we select a new rank for it to take relative to its expression in other samples, thus sampling from within its empirical distribution. The new rank is limited to one close to the original value, as defined by the noise factor. (D) The noise added to the sample has caused it to be an outlier that is disrupting the co-expression indicated by the otherwise good linear fit. The residuals of the points scores the sample (regressing from the line of best fit), and the (E) scores in aggregate allows us to draw an (F) ROC and calculate an AUROC, testing how well we the outlier was detected. We also calculate a p-value (Wilcoxon test) to compare the distributions of the average AUROCs of the co-expressed pairs and an equal number of random pairs.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.g006" xlink:type="simple"/>
</fig>
<p>We quantify the strength of the co-expression relationship by introducing “noise” into the experiment through the perturbation of the expression levels of the gene in a particular sample (<xref ref-type="fig" rid="pcbi.1004868.g006">Fig 6C</xref>). In our case, the noise added is a particularly subtle form of modification since we only nudge the gene’s expression by a slight amount to another value identically sampled from its expression distribution. Thus, in our case, 10% noise (perturbed) means that the original expression value is nudged up by enough to put the gene 10% higher in the rank that its new value takes relative to all of the expression values observed for that gene, the empirical distribution of its expression. Thus, if we rank standardize the data, the new value is sampled uniformly from samples ranking within 10% (out of all samples) of the original sample’s rank. Note that this is not a 10% change in its rank but a 10% change out of the total. Linear interpolation between adjacent sample ranks allows us to sample continuously. Put simply, a gene’s expression level in one sample is replaced by its expression level in another sample. If that sample was the one with the closest expression level, the noise is low and if it is was the furthest, the noise is high.</p>
<p>Note that this is a subtle enough shift that it can never be detected from the gene’s expression alone; the distribution of expression values is essentially unchanged. If a small perturbation (i.e., low noise factor) is detectable, it indicates that the relationship between gene-pairs must be very clear (outliers are easy to identify, <xref ref-type="fig" rid="pcbi.1004868.g006">Fig 6D</xref>). Equivalently, if a large perturbation is not detectable, it indicates an experiment with noisy data in which there are other samples that are still more aberrant than one where noise has been introduced.</p>
<p>Using the distribution of samples detected as outliers for each gene-pair (<xref ref-type="fig" rid="pcbi.1004868.g006">Fig 6E</xref>, see <xref ref-type="sec" rid="sec016">Materials and Methods</xref> section <bold>“Perturbation: the noise model”</bold>), we can predict the perturbed sample, and from this determine the area under the receiver operating characteristic curve (AUROC, <xref ref-type="fig" rid="pcbi.1004868.g006">Fig 6F</xref>) to characterize how well all the gene-pairs (in aggregate) picked out the perturbed sample (see <xref ref-type="sec" rid="sec016">Materials and Methods</xref> section <bold>“Perturbation: the noise model”</bold>). Repeating this through all samples gives an average AUROC at a particular noise factor–where an AUROC of 0.5 means that the noisy sample was undetectable, while an AUROC of 1 means that the perturbed sample is always being correctly ranked as the poorest. Thus having a high ability (i.e., a high AUROC) to detect even low noise is indicative of good performance–and good replicability as we now define it- while experiments with weaker performance will exhibit little change in response to noise and have lower AUROCs. Systematically perturbing the samples by the addition of “noise”, and measuring the effect (the AUROC) each perturbation has on the gene-pairs in aggregate can be used to quantify the quality of the experiment. As an analogy, this is like yelling in a room; if the noise is undetectable, the data is noisy to begin with, whereas if even a small noise is easily detected, the data is ‘quiet’ (shows pristine co-expression). It’s important to note that this model provides a relative ranking of all samples for their degree of noise; it is not the equivalent of a model which attempts to detect ‘differential’ samples. Thus, AUROC performance ranking the perturbed sample does not map to a categorical judgment that a particular sample is detected as different; just that it is correctly ranked as the most perturbed sample.</p>
</sec>
<sec id="sec012">
<title>Application of co-expression for noise estimation in reference datasets</title>
<p>To test our concept, we selected the BrainSpan reference set as it contained a large number of samples. Using the set of co-expressed gene-pairs we derived, we varied ‘noise’ levels and sample sizes and recorded the resulting AUROCs. First, we note that randomly sampling a new expression value in a given sample for each gene (from within that gene’s expression distribution) completely disrupted the co-expression at that sample within the experiment and we could perfectly identify the disrupted sample (<xref ref-type="fig" rid="pcbi.1004868.g007">Fig 7A</xref>, 100% noise factor, i.e. random). And with no noise, the AUROC was 0.5, since no signal from the gene-pairs could be used to distinguish the ‘disrupted’ sample from any others in that case. In this reference data with 500 samples, 5% noise was enough to increase the AUROC to 0.73.</p>
<fig id="pcbi.1004868.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004868.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Replicates via co-expression pairs to extract the noisy samples.</title>
<p>As an example, we use the BrainSpan RNA-seq dataset on 500 samples. We randomly added noise to one sample at a time at a given noise factor, and repeated this 100 times. (A) For each run, we generated an ROC, and show the average ROCs of these 100 runs, with the AUROC ranging between 0.5 and 1. Noise factor of around 5% was enough to disturb the experiments replicate, giving an AUROC of 0.73. (B) Average AUROCs varying across sample sizes and noise factors, with the standard error bar. Each point is an average of 100 repeats. The lines represent a linear fit of the data points. (C) Predicted noise factors for varying AUROCs shows the dependence on sample size and level of performance for the BrainSpan dataset.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.g007" xlink:type="simple"/>
</fig>
<p>We then systematically queried the space of different sample sizes versus noise (<xref ref-type="fig" rid="pcbi.1004868.g007">Fig 7B</xref>), and observe similar trends. Low noise (&lt;1%) across all sample sizes had average AUROCs close to 0.5, indicating that variation below that is undetectable in the dataset. While specific noise levels are shown in <xref ref-type="fig" rid="pcbi.1004868.g007">Fig 7B</xref>, we could alternatively ask what level of noise is detectable to a particular accuracy (<xref ref-type="fig" rid="pcbi.1004868.g007">Fig 7C</xref>). If we set the AUROC to 0.6 (i.e., low but significant detectability, equivalent to a Mann-Whitney p~1e-15), approximately 3.2% noise added to a sample (out of 100 samples) disrupts co-expression enough to correctly identify the sample at that level. This drops to 2.5% noise when the data has 500 samples, and increases to 4.1% for 50 samples.</p>
<p>To observe the general range of values in other experiments, we ran the analyses on a further 83 RNA-seq experiments, of varying sample sizes. The noise factors that would give an AUROC of 0.8 ranged between 3% and 40% and were inversely correlated to sample size (Spearman’s <italic>r</italic><sub><italic>s</italic></sub> = -0.48, <xref ref-type="supplementary-material" rid="pcbi.1004868.s003">S2A Fig</xref>). This is not a surprising finding, however, it reaffirms that one of the most important influences of the quality and outcome of an experiment is the number of samples. Even so, for some smaller sampled experiments (&lt;10), we recorded smaller detectable noise factors, similar to some of the larger experiments.</p>
</sec>
<sec id="sec013">
<title>Robustness analysis of AuPairWise</title>
<p>Having demonstrated that the method detects subtle disruption, we wished to establish proper use and controls. First, we assess the relative efficacy of this method to what real replicates would measure (<xref ref-type="fig" rid="pcbi.1004868.g008">Fig 8A</xref>). Instead of the subset of co-expressed pairs, we looked at all genes in the samples, paired to their replicate. As expected, replicates perform better than the co-expressed pairs (shaded lines versus solid in <xref ref-type="fig" rid="pcbi.1004868.g008">Fig 8A</xref>) with true replicates allowing us to detect the addition of noise at a level ~1.25 times lower than co-expression replicates (averaged across all ROCs; e.g., if 5% noise is detectable at a particular AUROC with co-expression, a true replicate could detect 4% noise).</p>
<fig id="pcbi.1004868.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004868.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Estimating replicability using different gene-pairs.</title>
<p>(A) Comparing the use of co-expressing pairs (solid), actual replicates (shaded) and random pairs (dashed) for the ENCODE dataset. Each point gives the average AUROC for detecting a noisy sample in the data across the varying noise factors. The sample size here was held constant at 18. The black lines are the original expression values, and the purple lines are those where we randomized the expression values (shuffling within an experiment). (B) Performance of the centiles for the experiment with and without the addition of noise. We only show the 50% noise factor. The replicates and stoichiometric pairs show very similar performance at this noise level (AUROC~1).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.g008" xlink:type="simple"/>
</fig>
<p>To better characterize these properties, we measured the performance of all possible gene-pairs (ranked from highly co-expressed to not at all). Dividing all the gene-gene correlations into centile bins, we measured the performance of these “centile pairs” under different noise factors (<xref ref-type="fig" rid="pcbi.1004868.g008">Fig 8B</xref>). We expect that the stronger the correlations (higher centiles with better co-expression), the higher the average AUROC will be. We can see that it requires highly co-expressed pairs (in the 90<sup>th</sup> centiles or greater in this experiment at 50% noise) to achieve performance close to the stoichiometric pairs, suggesting that the stoichiometric co-expression pairs are a particularly effective set to detect RNA-seq sample quality. Since these centiles are with reference to the maximum possible performance in this dataset, a perfect ranking with respect to them for our fixed set is not expected.</p>
<p>While we focused on high co-expression in protein complexes, we also wished to assess other plausible housekeeping interactions (<xref ref-type="supplementary-material" rid="pcbi.1004868.s004">S3A Fig</xref>). Our second set of gene-pairs consisted of highly co-expressed genes that were conserved across yeast and mouse (see <xref ref-type="sec" rid="sec016">Materials and Methods</xref> section “<bold>Selecting co-expressed pairs</bold>”). We also wished to assess a set of gene-pairs obtained independent of all expression data. We therefore looked at protein-protein interaction pairs that are part of protein complexes without regard to co-expression. Out of all the sets of pairs tested, the human stoichiometric co-expression pairs (i.e., those using PPI data and prior expression) performed the best, the yeast-mouse co-expressing pairs also showed good performance, while the purely protein-protein pairs showed moderate performance.</p>
<p>As a negative control, we selected sets of random pairs of similar number to the number of stoichiometric pairs, and once again ran the analyses. One striking feature of these results is that random pairs exhibit modest performance in all cases. Intuitively, one might think that random pairs could have some form of co-expression that would be detectable in aggregate, perhaps due to a few real and highly co-expressed pairs having been randomly selected or a more broadly distributed weak effect across all gene-pairs, not unlike the principle underlying correction for batch effects. Any factor other than biology which contributes to co-variation across samples could introduce this as an artifact and normalization confounds seemed to us a potential concern. Importantly, our method’s performance is not at all sensitive to changing the different normalization protocols (<xref ref-type="supplementary-material" rid="pcbi.1004868.s004">S3B Fig</xref>); however, a more finely calibrated assessment distinguishing technical artifacts of this type from biologically real variation would be to use the random gene-pairs as controls relative to our stoichiometric co-expression. The difference in performance between the two (<xref ref-type="supplementary-material" rid="pcbi.1004868.s005">S4 Fig</xref>), while not extreme, is actually quite stark: testing the performance distributions against each other yields a p-value of 2.78e-5 (Wilcoxon test, <xref ref-type="supplementary-material" rid="pcbi.1004868.s005">S4B Fig</xref>). Since technical variation should drive co-variation among random pairs and biology the preferential utility of stoichiometric pairs, we also report this statistic as a default within AuPairWise. Just as in differential expression it is important to have large differences for a subset of genes (biology) but not all (batch effect), so the same is true in our co-expression based analysis.</p>
<p>We repeated our analysis of the 83 independent RNA-seq experiments looking for purely technical co-expression as indicated by the performance of random pairs. In many of these experiments, even random pairs have good performance, and while this was generally very significantly less than the stoichiometric pairs (<xref ref-type="supplementary-material" rid="pcbi.1004868.s003">S2B Fig</xref>) only a very few experiments did not exhibit this potential technical confound.</p>
<p>We next assessed the robustness of our method to variation in the number of runs and selection of pairs (<xref ref-type="supplementary-material" rid="pcbi.1004868.s006">S5 Fig</xref>). For this analysis, we first varied the number of perturbations we ran for each noise factor analysis, and then calculated the variance of the AUROC. The noise factor has a strong effect on the variance, while increasing the number of runs, of course, lowers the standard error. We then varied the number of gene-pairs used in the analysis, and it appears that a minimum of approximately 500 or so pairs is enough to detect an aggregate signal.</p>
<p>One important caveat attached to the high performances we have reported is that our perturbation model has only perturbed one sample at a time. In reality, it is quite possible for the biological character of the data to be confounded with noise and, for instance, half the data to be of lower quality than the other half. For example, a differential expression experiment in which half of the samples were from a rare condition, hard to obtain, and for which worse quality control needed to be tolerated, would be one in which a lot of co-expression might be disrupted. Just as our single sample perturbation resembles leave-one-out cross-validation, we can conduct an identical experiment in 2-folds. We randomly sampled half the data from our ENCODE-based experiment and subjected each gene in each sample to an independent perturbation. Average AUROC’s for a given perturbation were 0.86 for 25% noise (significantly different than random pairs, Wilcoxon test p~6.65e-28, <xref ref-type="supplementary-material" rid="pcbi.1004868.s011">S2 Table</xref>). This comparably high performance also suggests that our modest class imbalance in the leave-one-out analysis is not seriously distorting assessment. Interestingly, one major difference in the 2-fold AUROC is that it does not go to 1 as the perturbation goes to 100%, instead reaching a value modestly below this (i.e., ~0.98, <xref ref-type="supplementary-material" rid="pcbi.1004868.s007">S6 Fig</xref>). Normally larger perturbations make it easier and easier to detect the altered sample(s), but when half of the samples have no co-expression due to the perturbation, it begins to impede the method. This is a fairly extreme state, however.</p>
<p>Finally, we considered whether our method could be naively applied to microarray data. Our recent work suggests that pseudo-replicates in co-expression data are dominated by artifacts in microarray data [<xref ref-type="bibr" rid="pcbi.1004868.ref027">27</xref>]. In particular, very high co-expression in microarray data is much more likely to reflect such artifacts (e.g., cross-hybridization) and occurs among low-expressing genes. While we caution that this analysis is only preliminary, applying AuPairWise to the equivalent microarray data set version of BrainSpan (across a common set of 495 samples, but performed on a microarray platform) also showed good performance (<xref ref-type="supplementary-material" rid="pcbi.1004868.s008">S7 Fig</xref>), yet the random pairs had almost equal performance (see p-values, <xref ref-type="supplementary-material" rid="pcbi.1004868.s012">S3 Table</xref>), implying a potentially greater role for normalization.</p>
</sec>
<sec id="sec014">
<title>Guidelines and availability of AuPairWise</title>
<p>Our results indicate that using co-expression is a practical approach to predict the consistency of replicates across biological samples in expression experiments. To share this method, we have compiled our R scripts and make this available on github under the name AuPairWise, so named for its use of selected housekeeping interactions (<ext-link ext-link-type="uri" xlink:href="https://github.com/sarbal/AuPairWise" xlink:type="simple">https://github.com/sarbal/AuPairWise</ext-link>).</p>
<p>A summary schematic of the input and output is shown in <xref ref-type="fig" rid="pcbi.1004868.g009">Fig 9A</xref>. The scripts are dependent on a few standard R packages and require expression data as inpu, with rows labelled with the set of genes detected in Entrez gene IDs format and columns labelled with the sample names. Given the expression dataset, a single run of the method outputs the average AUROC for a range of noise factors (which can be specified), along with the number of repeats. Further to this, an estimate quality control metric (“noise level”) is returned that is detectable over the threshold of 0.5 –i.e., this is the estimated amount of noise in the samples. As we wish to qualify the experiment based on biological properties, we compare the gene-pair results to those a similar number of gene-pairs chosen at random would do and return the p-value (Wilcoxon rank sum test, two sided) for each noise factor. When interpreting results from AuPairWise, we recommend reporting both the average AUROCs of the stoichiometric pairs, the random pairs, and the corresponding p-value (<xref ref-type="fig" rid="pcbi.1004868.g009">Fig 9B</xref>). We suggest looking at a noise factor between 5%-25% (depending on sample size), with smaller sized experiments warranting higher noise factors for meaningful perturbations. For a given noise factor, a high performance on the stoichiometric pairs and low performance on the random pairs and therefore a low p-value is a “good” experiment. Low performance of stoichiometric pairs implies a poor run, and high performance on the random pairs implies there is systematic artifact in the experiment. We also recommend a minimal number of 10 samples for any of the analyses to be meaningful.</p>
<fig id="pcbi.1004868.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004868.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Schematic of the AuPairWise method and guidelines for interpreting results.</title>
<p>(A) Input into the script is an expression matrix. Noise is added to a sample at random, and an AUROC is calculated based on how well the perturbation is detected by the gene-pairs. This is repeated for multiple noise factors, which then allows us to estimate the amount of noise required to significantly disrupt the experiment, which is used as our metric for replicability. The outputs are summary files with the AUROCs and noise estimates, along with the summary plot. (B) Guidelines for interpreting results. We plot performance of the stoichiometric pair against the random pair. Two toy examples are shown as stars, with their corresponding p-values beneath them. High performance (AUROCs) on the stoichiometric pairs and low performance on the random pairs for a given noise factor implies a fair to good experiment (dark blue shading). Any results that fall closer to the identity line are less certain and probably contain systematic noise (lighter regions), and are likely poorer experiments (red regions).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.g009" xlink:type="simple"/>
</fig>
<p>The current housekeeping interaction list is not perfect, but we argue that the list should retain, on average and in aggregate, a strong fundamental biological signal. Of course, if the experiment in question perturbs these pathways and protein complexes, it will be a useful set of gene-pairs to investigate. To this end, gene-pairs selected can be customized to exclude those subject to experimental perturbation, or those not measured. We have currently only made the human (<italic>Homo sapiens</italic>) datasets and pairs available, yet, as the pairs list can be modified, other species can be used, subject to further research to establish proper protocols and interpretation.</p>
<p>The current runtime for a single analysis (i.e., for 20 samples, 20,000 genes, 2500 gene-pairs, across 10 noise factors and 100 repeats) is approximately ~5 hours on our cluster of 16 cores with processors running at 2.4GHz and this scales linearly (<xref ref-type="supplementary-material" rid="pcbi.1004868.s014">S5 Table</xref>). However, we recommend running 1000 repeats. Although not formally implemented in the method, runs can be parallelized and the performance AUROCs combined across these runs.</p>
</sec>
</sec>
</sec>
<sec id="sec015" sec-type="conclusions">
<title>Discussion</title>
<p>Recent analyses of RNA-seq have added a number of caveats to its use, as is to be expected with any new technology as it begins to become mature [<xref ref-type="bibr" rid="pcbi.1004868.ref006">6</xref>,<xref ref-type="bibr" rid="pcbi.1004868.ref009">9</xref>]. Because of this growing appreciation of limitations in RNA-seq, we think a reconsideration of some of the early enthusiasm is timely. In particular, one of the most important technical claims made about RNA-seq–that it was highly replicable–was based on reproducing approximate transcript abundances. Instead, we have argued that we mostly should care about condition-dependent <italic>changes</italic> in transcript abundance. This is much harder to measure and much likelier to depend on experimental conditions. Consequently, it’s valuable to have a method which can measure the expected replicability of a performed experiment and it is this gap our analysis tool, AuPairWise, seeks to fill.</p>
<p>Quality control in RNA-seq is still a major concern, in particular when final biological outcomes are not replicated. At the heart of any quality control scheme is a ‘check’ for some expected class of result. For example, one might expect most genes not to be differentially expressed [<xref ref-type="bibr" rid="pcbi.1004868.ref028">28</xref>] and correct data to ensure that this is true. Our method hinges on an expectation that a particular subset of genes will show correlated expression. This is among the most well-validated observations in the analysis of expression data [<xref ref-type="bibr" rid="pcbi.1004868.ref025">25</xref>] and also one which has comparatively little impact on differential expression results. We have, nonetheless, taken unusual pains to ensure our method will not lead to overfitting, including assessing a variety of co-expression signatures, allowing customization of the pairs chosen for assessment, and not implementing our method as a correction.</p>
<p>Approaches related to our own are touched on in recent literature, even though most quality control in RNA-seq is focused on batch corrections of some sort. For example, in their analysis of single-cell data, Buettner et al. [<xref ref-type="bibr" rid="pcbi.1004868.ref029">29</xref>] exploit co-expression among cell-cycle genes to perform a batch correction based on cell-cycle as a latent variable. While this is most readily understood as a variation on conventional batch correction, it resembles our own technique in exploiting function in the form of known co-expression to determine a covariate associated with noise. Indeed, had that analysis generalized across many functional classes and then modelled the predictability of noise as a means of quality control (rather than as a correction), it would resemble our own method. Another related approach is the L1000 analysis platform which measures gene expression over only a small subset of genes and then uses learned relationships based on co-expression to infer the rest [<xref ref-type="bibr" rid="pcbi.1004868.ref030">30</xref>]. While this is exploiting an effect similar to that in our analysis, we rely on such relationships to infer a single measure of quality control; we are never too reliant on any one being accurate. To literally infer unknown expression from such relationships seems to us likely to lead to overfitting. A less extreme approach similar to the L1000 system is used in imputation of expression, where the expression of genes missing from a sample in the data are estimated by using the expression of genes that are co-expressed [<xref ref-type="bibr" rid="pcbi.1004868.ref031">31</xref>]. There, the expression profiles of the co-expressed genes provide the expression of the missing sample. In our case, prior knowledge as to which gene should be co-expressed is used not to correct the data, but to determine if that sample has correct values. Finally, because co-expression is used to infer function in networks, its utility for doing so in any given data can be used as a form of quality control (e.g., [<xref ref-type="bibr" rid="pcbi.1004868.ref032">32</xref>]), but this lacks any quantitative mapping to differential expression.</p>
<p>The perturbation model we have used, while simple and fairly close to conventional ideas such as bootstrapping (plus constraint and interpolation), is not common within RNA-seq analysis. We suggest that even outside of our specific application, a strongly data driven sampling distribution for gene expression is likely more desirable than more theoretical approaches based on modeled expression values. The observation of subtly erroneous normalization has been previously discussed as a problem for co-expression analyses [<xref ref-type="bibr" rid="pcbi.1004868.ref033">33</xref>]; this result is similar to our own that random pairs show some performance. In particular, we do consider it critical to report both random and real pairs for performance since it is the relative performance of ‘real’ pairs that indicates the experiment is conforming to expectation; just as in differential expression, pervasive effects across the genome are not evidence of high biological signal, but rather high technical signal. It is worth noting that co-expression network analyses are mostly robust to these normalization effects since they usually depend only on the relative rankings of correlations between all gene pairs and not on the significance of the values directly.</p>
<p>Our method is not without limitations. As it requires there to be a measurable amount of variance within the experiment, it will be difficult to calculate co-expression in an experiment that has no conditions for expression to vary across. The number of samples that make for meaningful co-expression will also need to be followed [<xref ref-type="bibr" rid="pcbi.1004868.ref027">27</xref>], although this seems more feature than bug to us, since it is, in fact, true that more data permits for more replicable results. We also suggest that the co-expressed pairs themselves are subject to review and reanalysis. As mentioned, we have tried our best to not overfit to current data, but it does rely on the available information present in co-expression data and gene annotations. As more data does become available, and our knowledge base on stoichiometric pairs and the biological implications behind these expands, the housekeeping interaction pairs will need to be refined. Of course, even regular housekeeping genes lists are by no means without argument despite decades of study. We also have ignored the transcript specific level of replication; this admits to clear expansion using transcript specific pairs. One final caveat is that because this method is not a correction of any type, the results do not pinpoint particular genes that are misaligned, but rather indicate that the whole experiment does not conform to expectation.</p>
<p>While previous work hints at the value of co-expression for quality control, we think it has been hampered by a poor sense of what precisely quality control should be controlling. We think our analysis and particularly our recapitulation of SEQC’s observational heuristics from more basic principles help guide quality control by attaching a more precise meaning to ‘replication’. While RNA-seq’s signal-to-noise ratio may be less idealized than early analyses implied, our ability to assess where noise <italic>does</italic> occur in RNA-seq appears to be much higher. By providing a common standard for that assessment, we hope AuPairWise will permit experimentalists the opportunity to refine their experimental design and validate their success in doing so.</p>
</sec>
<sec id="sec016" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec017">
<title>Datasets</title>
<p>To illustrate our analyses, we used data from publically accessible RNA-seq experiments where we define an experiment as a set of samples. The majority of the work and analyses were performed using the following datasets: ENCODE (GSE35584) [<xref ref-type="bibr" rid="pcbi.1004868.ref034">34</xref>], Marioni et al (GSE11045) [<xref ref-type="bibr" rid="pcbi.1004868.ref021">21</xref>], Xu et al (GSE26109) [<xref ref-type="bibr" rid="pcbi.1004868.ref022">22</xref>] and BrainSpan [<xref ref-type="bibr" rid="pcbi.1004868.ref035">35</xref>]. The ENCODE dataset and the Marioni et al. dataset were downloaded from SRA and converted to fastq files using “fastq-dump” from the SRA Toolkit [<xref ref-type="bibr" rid="pcbi.1004868.ref036">36</xref>]. Following quality control using the fastX tools, we mapped the reads using bowtie2 [<xref ref-type="bibr" rid="pcbi.1004868.ref037">37</xref>] and estimated the RPKM and FPKM expression levels using RSEQtools [<xref ref-type="bibr" rid="pcbi.1004868.ref038">38</xref>] and Cufflinks [<xref ref-type="bibr" rid="pcbi.1004868.ref039">39</xref>] respectively, and the GENCODE annotations file [<xref ref-type="bibr" rid="pcbi.1004868.ref017">17</xref>] (version 18). We used the processed data provided in the Xu et al. supplement and the online Brainspan data. For our assessment of publically available data, we looked at those accessible both via Gene Expression Omnibus (GEO) and Sequence Read Archive (SRA). We used the URL from the GEO browser [<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/geo/browse/?view=samples&amp;display=500&amp;type=10&amp;tax=9606&amp;sort=type" xlink:type="simple">http://www.ncbi.nlm.nih.gov/geo/browse/?view=samples&amp;display=500&amp;type=10&amp;tax=9606&amp;sort=type</ext-link>], filtering on human samples and those in SRA as of January 2015. Of the resulting 39K samples, we then filtered on samples only in a single experiments (unique to one GSE ID, close to 1.4K experiments), and then calculated the sample size for each of these. For a final follow up, we then obtained 83 RNA-seq experiments from the Gemma database [<xref ref-type="bibr" rid="pcbi.1004868.ref040">40</xref>] that were processed using RSEM [<xref ref-type="bibr" rid="pcbi.1004868.ref041">41</xref>]. These experiments varied in experimental design, sample size, read depth, sample type and conditions.</p>
</sec>
<sec id="sec018">
<title>Measuring replicability: Correlations and sample estimates</title>
<p>We define an experiment as an ordered set of expression values for genes across multiple samples, with each sample defined as belonging to some class of biology from which RNA can be extracted. A replicate experiment is defined as an experiment across samples with identical class memberships, but varying on one of three other levels. This could be varying at a technological level (same samples, but run on a microarray), technical level (same samples, but a different run of the same machine), or a biological level (same conditions, tissue, cell, organism etc). The ENCODE dataset were purely technical replicates. To measure the replicability of an experiment in sample-sample space, we took the expression levels of an experiment, and calculated the Spearman (<italic>r</italic><sub><italic>s</italic></sub>) or Pearson (<italic>r</italic>) correlation coefficient for each sample to its replicate (see <xref ref-type="disp-formula" rid="pcbi.1004868.e001">Eq 1</xref>). Thus, we get a single correlation value for a sample, and multiple for an experiment. In our second measure of replicability, we are assessing the degree to which changes in expression for the individual genes are replicable. For this, we take each gene’s expression value across samples in one experiment, and the replicate values (i.e., the technical replicates), and calculate the Spearman or Pearson correlation coefficient of these two expression profiles for the same gene. For this measure, we get a value for each gene, and a distribution of correlation values. So, for a gene <italic>i</italic>, the gene-level replicability (<italic>corr</italic><sub><italic>i</italic></sub>) is equal to the correlation (Spearman’s <italic>rs</italic><sub><italic>si</italic></sub> or Pearson’s <italic>r</italic><sub><italic>i</italic></sub>) between the expression values of the gene in experiment <italic>X</italic> (i.e., <italic>X</italic><sub><italic>i</italic></sub>) and the replicate experiment <italic>Y</italic> (i.e., <italic>Y</italic><sub><italic>i</italic></sub>), across <italic>n</italic> samples.
<disp-formula id="pcbi.1004868.e001">
<alternatives>
<graphic id="pcbi.1004868.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004868.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:mn>6</mml:mn><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
<xref ref-type="disp-formula" rid="pcbi.1004868.e001">Eq 1</xref> <italic>Gene-gene correlations as a gene-level replication metric</italic></p>
<p>These gene-gene correlations each have an associated p-value that is calculated by either estimating a z-score (for a normal distribution, <xref ref-type="disp-formula" rid="pcbi.1004868.e002">Eq 2</xref>) or a t-statistic (for a <italic>T</italic>-distribution, <xref ref-type="disp-formula" rid="pcbi.1004868.e003">Eq 3</xref>), where <italic>r</italic> is the correlation value and <italic>n</italic> the number of samples in the experiment
<disp-formula id="pcbi.1004868.e002">
<alternatives>
<graphic id="pcbi.1004868.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004868.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>1.06</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
<xref ref-type="disp-formula" rid="pcbi.1004868.e002">Eq 2</xref> <italic>z-score estimate</italic>
<disp-formula id="pcbi.1004868.e003">
<alternatives>
<graphic id="pcbi.1004868.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004868.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mtext>r</mml:mtext><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
<xref ref-type="disp-formula" rid="pcbi.1004868.e003">Eq 3</xref> <italic>T-statistic estimate</italic></p>
<p>One interesting terminological issue which overlaps with these two senses of replicability is the use of the term “RNA-seq experiment”. It is not uncommon within the literature to regard a single data sample as an experiment under the viewpoint that the different expression levels of different genes are then different measures of expression level. This would be close to the sample view of replicability in which even two samples would permit an estimation of replicability across those measures. In this work, we reserve the term “RNA-seq experiment” for data generated across multiple samples, typically to test some conditional variation. In such data, each gene will have multiple expression values and so gene-level replicability is meaningfully assessable.</p>
<p>We used the R functions <bold>pnorm</bold> and <bold>pt</bold> to estimate the p-values (for the <italic>z</italic>-score and <italic>T</italic>-statistic respectively). After adjusting for multiple tests with <bold>p.adjust</bold> in R, we then calculated the number of genes replicated as the number of genes with a significant correlation value (q&lt;0.05). To estimate the number of samples required to get 90% of the genes replicated, we assumed that the range of correlation values would remain the same, but varied the number of samples <italic>n</italic> (within the <italic>T</italic>-statistic estimate equation), and recalculated the adjusted p-values. This gives us, for each <italic>n</italic>, the number of genes that will be significantly correlated, assuming the distribution of correlation coefficients is the same.</p>
<p>To compare our measures of replicability to the MAQC filters, we calculate the fold change (<xref ref-type="disp-formula" rid="pcbi.1004868.e004">Eq 4</xref>) and the average expression of the ENCODE experiment. We took half the samples as untreated and the other half as treated, as per the experimental design (see GSE35584), and calculated the fold change as the absolute value of the ratio of the averaged expression levels between those conditions.</p>
<disp-formula id="pcbi.1004868.e004">
<alternatives>
<graphic id="pcbi.1004868.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004868.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mrow><mml:mi>F</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext>log</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
<p><xref ref-type="disp-formula" rid="pcbi.1004868.e004">Eq 4</xref> <italic>Fold change calculation</italic></p>
</sec>
<sec id="sec019">
<title>AuPairWise: Replication through co-expression</title>
<p>The overall idea behind the AuPairWise method is to leverage the biological signal of co-expressing pairs as a measure of replicability of an experiment. Therefore, the method requires a set of co-expressed pairs (section “<bold>Selecting co-expressed pairs</bold>”) that can be used as the biological indicator, and a noise model (section “<bold>Perturbation: the noise model</bold>”) to determine the strength of these pairs. As a general overview, the nature of the test is a way to calibrate the noise within the system, as it attempts to detect outliers where we have purposely generated them. The more detectable noise is, the lower the original noise in the data (without the perturbation). As there are outliers in the real data, those samples are precisely the ones where we can add a substantial amount of noise without detection. Thus, when we perturb out system with noise, we are making a statement about the data prior to the noise being included. The degree to which perturbations can go undetected is the degree to which the experiment is noisy.</p>
</sec>
<sec id="sec020">
<title>Selecting co-expressed pairs</title>
<p>We generated a list of co-expressed pairs of genes that are required, in a similar way to housekeeping genes, to be expressed at stoichiometric ratios. First, we took the top 1% of genes that are reciprocally co-expressed in an aggregate microarray co-expression network. We similarly took the top 1% co-expressed genes from an aggregate RNA-seq co-expression network. We then took the intersect of these two gene-pair sets. To limit our set to what we believe are non-condition specific pairs, we took all the gene-pairs that were annotated as protein complexes in the Gene Ontology (GO [<xref ref-type="bibr" rid="pcbi.1004868.ref042">42</xref>], GO:0043234). With this, we were left with 2,669 gene-pairs, between a total of 1,117 genes. We also generated a similar list of co-expressed pairs conserved in yeast and mouse. We took the top 1% co-expressed pairs from an aggregate yeast co-expression network that we had created from 30 experiments across 966 samples on the Affymetrix Yeast Genome S98 Array (GPL90) platform. We also then took the top 1% co-expressed pairs from an aggregate mouse co-expression network (30 experiments across 1,575 samples on the Affymetrix Mouse Genome 430 2.0 Array, GPL1261). We then took the intersect of these two lists, whereby we had homologs for both genes in the pair and were left with 352 gene-pairs. Another gene-pair list we used was the protein-protein interaction set from BIOGRID (version BIOGRID-ALL-3.2.106, June 2014). Once again, we filtered this list down to 7,731 gene-pairs (interactions) by specifying that the interaction was a physical interaction, from Affinity capture–mass spectrometry experimental systems, and only genes associated with the GO protein complex term (GO:0043234).</p>
<p>In order to better characterize what GO terms were enriched in our human co-expressed gene-pairs set, we ran a simple gene set enrichment analysis using the hypergeometric test (<bold>phyper</bold>), correcting for multiple hypothesis testing using the Benjamini-Hochberg adjustment (<bold>p.adjust</bold>) in R [<xref ref-type="bibr" rid="pcbi.1004868.ref043">43</xref>].</p>
</sec>
<sec id="sec021">
<title>Perturbation: The noise model</title>
<p>We define an experiment as the expression levels of all genes across all samples for a range of conditions. Samples are not constrained to biological replicates, but should contain at least two conditions. Using the expression levels of each gene-pair, we calculated a score based on the residuals of the linear regression model fitting the points. Each point is a representative of a sample and its “expression replicate” (co-expression partner). Because we expect the expression levels of the genes to be “replicated”, there should be high correlation (the gene correlations across samples we defined earlier), and thus the residuals should be small, and “outliers” few and random. We rank these residuals, thus giving each sample a score. If a sample is perturbed, it should on average score the worst across all genes. We illustrate this in <xref ref-type="fig" rid="pcbi.1004868.g006">Fig 6</xref>, and in more detail in supplementary <xref ref-type="supplementary-material" rid="pcbi.1004868.s009">S8 Fig</xref>.</p>
<p>In order to measure how robust the experiment was to noise, we then perturbed the system by randomly selecting a sample and added a relative amount of noise to all the genes in that chosen sample. We used a perturbation model that was a function of the dynamic range of a gene and the sample size of the experiment, such that a noise factor of 10 meant for an experiment with 100 samples the gene would vary within 10% of that gene’s expression values (as measured by the current experiment). First, we rank the expression profile of that gene (i.e., the gene’s dynamic range) across the samples. We then select a sample to perturb at random (<xref ref-type="supplementary-material" rid="pcbi.1004868.s009">S8A Fig</xref>). As we are perturbing each gene’s expression level for that sample based on its dynamic range, we need to ensure that the expression value is within the measured range of both the experiment and the samples. To do this, we order the gene’s expression values and interpolate the values between them to generate our sampling distribution (<xref ref-type="supplementary-material" rid="pcbi.1004868.s009">S8B Fig</xref>). We then calculate the rank shift for the given noise factor (i.e., for a 100 samples at a noise factor of 10%, we select a rank shift between 0–10), sampled from a uniform distribution (<xref ref-type="supplementary-material" rid="pcbi.1004868.s009">S8C Fig</xref>). At this new rank, we estimate the new expression value for that gene based on its dynamic range (<xref ref-type="supplementary-material" rid="pcbi.1004868.s009">S8D Fig</xref>). We then remap the expression value to be within the samples expression range (standardization). We used this model to ensure that the expression values remained within the empirical distribution of the gene and the expression distribution of the sample. Our expression experiment now has a perturbed sample (<xref ref-type="supplementary-material" rid="pcbi.1004868.s009">S8E Fig</xref>) with expression values within its original measurements. To be consistent, we defined random as a noise factor of 100%, and no perturbation as 0%. Noise is added in this way to all genes in that one sample, independently. Once all the genes are perturbed in this way, we then calculate the effect of this perturbation on the co-expressing pairs. We rank the expression profiles of each gene across the samples, and calculate the studentized residuals of the linear regression between the two genes. The score for each sample is simply the ranked residuals, whereby samples which deviate the most from the line of best fit rank the worst. With the aggregate scores from the individual linear regression model for all the genes pairs, we generated an ROC curve and calculated the area under the curve (AUROC). We also note that the AUROC is similar to the U statistic of the Mann-Whitney test and can be calculated analytically (<xref ref-type="disp-formula" rid="pcbi.1004868.e005">Eq 5</xref>). <italic>P</italic> is the rank of the held-out positive, <italic>TP</italic> the number of true positives, <italic>TN</italic> the number of true negatives, and <italic>N</italic> the total number of samples. If ranked correctly, we get an AUROC of 1. If ranked randomly, the AUROC value ranges between 0 and 1 and on average will be 0.5.
<disp-formula id="pcbi.1004868.e005">
<alternatives>
<graphic id="pcbi.1004868.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004868.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mrow><mml:mi>A</mml:mi><mml:mi>U</mml:mi><mml:mi>R</mml:mi><mml:mi>O</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mi>i</mml:mi><mml:mi>N</mml:mi></mml:msubsup><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo> </mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>*</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
<xref ref-type="disp-formula" rid="pcbi.1004868.e005">Eq 5</xref> <italic>AUROC calculation</italic></p>
<p>We used the AUROC as a measure of the performance of the experiment.</p>
</sec>
<sec id="sec022">
<title>Validation of pseudo-replication</title>
<p>As a proof of principle method for experiments where there were replicates available in the experimental design, we used the replicates and looked at every gene-paired with itself. In this case, we took the residuals of the gene replicates from the linear model, aggregating across all the genes (paired with their own replicate), and generating a ROC and calculating the AUROC. As described previously, we varied the amount of noise, repeating and permuting across the samples.</p>
<p>For the two-fold validation, where we perturbed more than one sample, we performed the same experiment, selecting at random half the samples and shuffling the expression values of the genes according to the noise factor. In this case, we shuffled each sample independently, so that the shuffled samples did not affect the values of the remaining samples to be shuffled. The AUROC was calculated as above, and the experiment was repeated across the different noise factors, and across different random set of samples.</p>
</sec>
<sec id="sec023">
<title>R scripts on github</title>
<p>For further information on how to the use the AuPairWise method and obtain the metrics, see the github repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/sarbal/AuPairWise" xlink:type="simple">https://github.com/sarbal/AuPairWise</ext-link>). We have briefly summarized the code below.</p>
<p specific-use="line">For a given noise factor</p>
<p specific-use="line"> Chose a sample</p>
<p specific-use="line">  For each gene in this sample</p>
<p specific-use="line">   Add noise to gene’s expression</p>
<p specific-use="line"> Remap sample to original expression levels</p>
<p specific-use="line"> For each gene-pair</p>
<p specific-use="line">  Calculate line of best fit</p>
<p specific-use="line">  Calculate residuals for each sample pair</p>
<p specific-use="line">  Rank residuals to score each sample</p>
<p specific-use="line"> Aggregate ranks scores for each sample</p>
<p specific-use="line"> Calculate AUROC using aggregate scores</p>
<p specific-use="line"> Repeat</p>
<p specific-use="line"> Return average AUROC (6)</p>
<p><italic>Pseudocode for the AuPairWise method</italic></p>
</sec>
</sec>
<sec id="sec024">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004868.s001" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Additional text, data location, script description and references.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004868.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.s002" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Density of mean gene-gene correlations between replicates before and after filtering.</title>
<p>(A) For the fold change values, we see that for the recommended FC cutoffs (the blue dotted lines), the mean correlations are low and increase the further we move (black line). Removing low expressing genes shows even higher mean correlations (grey line). (B) For the average expression values, once again, we see that for the recommended cut-off, we have higher mean correlations (black line), that are improved even more with the inclusion of the fold change filter (grey line).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004868.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.s003" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>AuPairWise noise metrics on RNA-seq experiments.</title>
<p>Here we took 83 RNA-seq experiments and ran the AuPairWise method for 100 repeats across a range of noise factors. (A) The density plot (solid line) shows that most experiments fall within the 19% noise factor range as assessed to cause an AUROC shift to 0.8. There is a dependence on sample size of course, with larger experiments requiring smaller noise perturbations (data points in figure). (B) Significance of difference in performance AUROCs for biologically related gene-pairs compared to random pairs for all the experiments. The geometric mean of these p-values is 4.67e-06. For comparison, the ENCODE reference dataset with 18 samples sits with a p-value of 6.52-e14.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004868.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.s004" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Average AUROC using alternative gene-pairs and different expression normalization methods.</title>
<p>(A) The co-expressed pairs (shown in red) outperform the protein-protein pairs (brown), the conserved yeast-mouse co-expressed pairs (pink) and random pairs (blue). These are the results of 1000 repeats. (B) Using different normalization methods on the expression data has a small effect on the performance AUROCs of the stoichiometric pairs. Here we compared the effects of RPKM (brown), TPM (blue), TMM (orange), VST (red), and simply ranking the expression data (green). These are the results of 1000 repeats.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004868.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.s005" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Distribution of the gene-pair AUROCs for different noise factor parameters.</title>
<p>The distributions are for 1000 runs of the method on the same dataset, varying the sample being perturbed. The colored distribution is the co-expressed pair performances, while the lighter distribution is the performance of an equal number of random gene-pairs. The solid line is the average AUROC for the co-expressed pairs, the dashed for the random pairs. The p-value is the significance of the difference between these two distributions (Wilcoxon test, two-sided). Panels are for different noise factors (A) No noise added (p~0.85), (B) 10% noise (p~2.78e-5), (C) 25% (p~2.71e-112) and (D) 50% (p~2.76e-153). We see that although the average AUROCs may be similar, the distributions are significantly different.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004868.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.s006" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Variance versus parameter choices in the AuPairWise method.</title>
<p>Here we show the standard error (SE) of the performance AUROCs of the stoichiometric pairs as a function of the parameter choices on the ENCODE dataset, holding the sample size constant. (A) First we calculate the effect of the number of runs on the analysis, by varying the number of repeats from 10 to 1000. The SE decreases as the number of runs increases, as expected, with the noise factor having a small effect on the SE. (B) Varying gene-pair numbers (between 10 and 2500) shows a consistent SE only when 500 or more gene-pairs are used. To note, all variance is below 0.01 for almost all these parameter choices, indicating the results are quite robust. (C) We show the performances (average AUROCS) as a function of to the average number of genes within the sampled gene-pairs (and mapping between average number of genes and gene-pairs in inset).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004868.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.s007" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Performance AUROCs for AuPairWise on ENCODE data with the 2-fold cross validation.</title>
<p>Using the ENCODE dataset once again and running the method 1000 times, we varied the number of samples perturbed in the experiment. The n-fold cross-validation (one perturbed sample, in red) outperform 2-fold cross-validation (half the samples perturbed, purple). The 2-fold validation does not have an AUROC performance of 1 at 100% (~0.98), likely due to the fact that a great deal of co-expression is lost, hence preventing the method from detecting any structured co-variation.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004868.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.s008" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Performance AUROCs for AuPairWise on microarray and RNA-seq versions of the BrainSpan dataset.</title>
<p>The co-expressed pairs (darker lines) outperform the random pairs (lighter lines), for both the RNA-seq (green) and Microarray (blue) datasets. But the microarray dataset has more similar performances between the co-expressed pairs and the random pairs, compared to the RNA-seq version. The microarray dataset also performs worse/close to the RNA-seq random pairs.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004868.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.s009" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Expansion of <xref ref-type="fig" rid="pcbi.1004868.g006">Fig 6C</xref> explaining the noise model.</title>
<p>(A) Expression of gene X from experiment. (B) The first step is to order the expression levels, and interpolate between the samples to get a continuous distribution of expression. (C) Then with this distribution, we define the boundaries for the noise included expression levels for that gene. For instance, with 10% noise, the new rank is limited to the yellow rectangle bounds, which corresponds to an expression change, constrained between expression values of ~1 to ~2 (the orange rectangle). (D) We then pick the new expression level and standardize it. (E) This is repeated until all the genes in the selected sample have “noise” added to them.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004868.s010" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.s010" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>GO enrichment of genes in the housekeeping interaction gene-pairs.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004868.s011" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.s011" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Significance of difference in performance AUROCs for gene-pairs compared to random pairs of the ENCODE dataset.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004868.s012" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.s012" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Significance of difference in performance AUROCs for gene-pairs compared to random pairs for microarray and RNA-seq versions of the BrainSpan dataset.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004868.s013" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.s013" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>Performance and significance of difference in performance AUROCs for gene-pairs compared to random pairs for 2-fold cross validation of the ENCODE dataset.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004868.s014" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004868.s014" xlink:type="simple">
<label>S5 Table</label>
<caption>
<title>Average running time of AuPairWise across different sample sizes and repeats for a noise factor.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We would like to thank Sanja Rogic for assistance using the Gemma RNA-seq data and Paul Pavlidis for helpful comments on the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004868.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>KP</given-names></name> (<year>2014</year>) <article-title>RNA-seq differential expression studies: more sequence or more replication?</article-title> <source>Bioinformatics</source> <volume>30</volume>: <fpage>301</fpage>–<lpage>304</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btt688" xlink:type="simple">10.1093/bioinformatics/btt688</ext-link></comment> <object-id pub-id-type="pmid">24319002</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hansen</surname> <given-names>KD</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Irizarry</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Leek</surname> <given-names>JT</given-names></name> (<year>2011</year>) <article-title>Sequencing technology does not eliminate biological variability</article-title>. <source>Nature Biotechnology</source> <volume>29</volume>: <fpage>572</fpage>–<lpage>573</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.1910" xlink:type="simple">10.1038/nbt.1910</ext-link></comment> <object-id pub-id-type="pmid">21747377</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robles</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Qureshi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Stephen</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Burden</surname> <given-names>C</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Efficient experimental design and analysis strategies for the detection of differential expression using RNA-Sequencing</article-title>. <source>BMC Genomics</source> <volume>13</volume>: <fpage>484</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-13-484" xlink:type="simple">10.1186/1471-2164-13-484</ext-link></comment> <object-id pub-id-type="pmid">22985019</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>C-I</given-names></name>, <name name-style="western"><surname>Su</surname> <given-names>P-F</given-names></name>, <name name-style="western"><surname>Shyr</surname> <given-names>Y</given-names></name> (<year>2013</year>) <article-title>Sample size calculation based on exact test for assessing differential expression analysis in RNA-seq data</article-title>. <source>BMC Bioinformatics</source> <volume>14</volume>: <fpage>357</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-14-357" xlink:type="simple">10.1186/1471-2105-14-357</ext-link></comment> <object-id pub-id-type="pmid">24314022</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tighe</surname> <given-names>SW</given-names></name>, <name name-style="western"><surname>Nicolet</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Grove</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Levy</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Multi-platform assessment of transcriptome profiling using RNA-seq in the ABRF next-generation sequencing study</article-title>. <source>Nature Biotechnology</source> <volume>32</volume>: <fpage>915</fpage>–<lpage>925</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2972" xlink:type="simple">10.1038/nbt.2972</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004868.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Labaj</surname> <given-names>PP</given-names></name>, <name name-style="western"><surname>Zumbo</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Sykacek</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>W</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Detecting and correcting systematic variation in large-scale RNA sequencing data</article-title>. <source>Nature Biotechnology</source> <volume>32</volume>: <fpage>888</fpage>–<lpage>895</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.3000" xlink:type="simple">10.1038/nbt.3000</ext-link></comment> </mixed-citation></ref>
<ref id="pcbi.1004868.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Risso</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ngai</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Speed</surname> <given-names>TP</given-names></name>, <name name-style="western"><surname>Dudoit</surname> <given-names>S</given-names></name> (<year>2014</year>) <article-title>Normalization of RNA-seq data using factor analysis of control genes or samples</article-title>. <source>Nature Biotechnology</source> <volume>32</volume>: <fpage>896</fpage>–<lpage>902</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2931" xlink:type="simple">10.1038/nbt.2931</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004868.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gong</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Bushel</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Thierry-Mieg</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Thierry-Mieg</surname> <given-names>D</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>The concordance between RNA-seq and microarray data depends on chemical treatment and transcript abundance</article-title>. <source>Nature Biotechnology</source> <volume>32</volume>: <fpage>926</fpage>–<lpage>932</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.3001" xlink:type="simple">10.1038/nbt.3001</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004868.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><collab>Consortium SM-I</collab> (<year>2014</year>) <article-title>A comprehensive assessment of RNA-seq accuracy, reproducibility and information content by the Sequencing Quality Control Consortium</article-title>. <source>Nat Biotech</source> <volume>32</volume>: <fpage>903</fpage>–<lpage>914</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004868.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stark</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Breitkreutz</surname> <given-names>B-J</given-names></name>, <name name-style="western"><surname>Reguly</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Boucher</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Breitkreutz</surname> <given-names>A</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>BioGRID: a general repository for interaction datasets</article-title>. <source>Nucleic Acids Research</source> <volume>34</volume>: <fpage>D535</fpage>–<lpage>D539</lpage>. <object-id pub-id-type="pmid">16381927</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Leek</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>WE</given-names></name>, <name name-style="western"><surname>Parker</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Jaffe</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Storey</surname> <given-names>JD</given-names></name> (<year>2012</year>) <article-title>The sva package for removing batch effects and other unwanted variation in high-throughput experiments</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>882</fpage>–<lpage>883</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts034" xlink:type="simple">10.1093/bioinformatics/bts034</ext-link></comment> <object-id pub-id-type="pmid">22257669</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Leek</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Scharpf</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Bravo</surname> <given-names>HC</given-names></name>, <name name-style="western"><surname>Simcha</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Langmead</surname> <given-names>B</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Tackling the widespread and critical impact of batch effects in high-throughput data</article-title>. <source>Nature reviews Genetics</source> <volume>11</volume>: <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg2825" xlink:type="simple">10.1038/nrg2825</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004868.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schroeder</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mueller</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Stocker</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Salowsky</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Leiber</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>The RIN: an RNA integrity number for assigning integrity values to RNA measurements</article-title>. <source>BMC Molecular Biology</source> <volume>7</volume>: <fpage>3</fpage>. <object-id pub-id-type="pmid">16448564</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>W</given-names></name> (<year>2012</year>) <article-title>RSeQC: quality control of RNA-seq experiments</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>2184</fpage>–<lpage>2185</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts356" xlink:type="simple">10.1093/bioinformatics/bts356</ext-link></comment> <object-id pub-id-type="pmid">22743226</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>DeLuca</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Levin</surname> <given-names>JZ</given-names></name>, <name name-style="western"><surname>Sivachenko</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Fennell</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Nazaire</surname> <given-names>M-D</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>RNA-SeQC: RNA-seq metrics for quality control and process optimization</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>1530</fpage>–<lpage>1532</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts196" xlink:type="simple">10.1093/bioinformatics/bts196</ext-link></comment> <object-id pub-id-type="pmid">22539670</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bickel</surname> <given-names>PJ</given-names></name> (<year>2011</year>) <article-title>Measuring reproducibility of high-throughput experiments</article-title>. <source>The annals of applied statistics</source>: <fpage>1752</fpage>–<lpage>1779</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004868.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Djebali</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Merkel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dobin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lassmann</surname> <given-names>T</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Landscape of transcription in human cells</article-title>. <source>Nature</source> <volume>489</volume>: <fpage>101</fpage>–<lpage>108</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11233" xlink:type="simple">10.1038/nature11233</ext-link></comment> <object-id pub-id-type="pmid">22955620</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schulze</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Kanwar</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Golzenleuchter</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Therneau</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Beutler</surname> <given-names>AS</given-names></name> (<year>2012</year>) <article-title>SERE: single-parameter quality control and sample comparison for RNA-Seq</article-title>. <source>BMC Genomics</source> <volume>13</volume>: <fpage>524</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-13-524" xlink:type="simple">10.1186/1471-2164-13-524</ext-link></comment> <object-id pub-id-type="pmid">23033915</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lemire</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lea</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Batten</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Jian Gu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Whitley</surname> <given-names>P</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Development of ERCC RNA Spike-In Control Mixes</article-title>. <source>Journal of Biomolecular Techniques: JBT</source> <volume>22</volume>: <fpage>S46</fpage>–<lpage>S46</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004868.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ideker</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Krogan</surname> <given-names>NJ</given-names></name> (<year>2012</year>) <article-title>Differential network biology</article-title>. <source>Molecular Systems Biology</source> <volume>8</volume>.</mixed-citation></ref>
<ref id="pcbi.1004868.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marioni</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mason</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Mane</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Stephens</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gilad</surname> <given-names>Y</given-names></name> (<year>2008</year>) <article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title>. <source>Genome Research</source> <volume>18</volume>: <fpage>1509</fpage>–<lpage>1517</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.079558.108" xlink:type="simple">10.1101/gr.079558.108</ext-link></comment> <object-id pub-id-type="pmid">18550803</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xu</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Seok</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mindrinos</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Schweitzer</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Jiang</surname> <given-names>H</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Human transcriptome array for high-throughput clinical studies</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>108</volume>: <fpage>3707</fpage>–<lpage>3712</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004868.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple">(<year>2006</year>) <article-title>The MicroArray Quality Control (MAQC) project shows inter- and intraplatform reproducibility of gene expression measurements</article-title>. <source>Nature Biotechnology</source> <volume>24</volume>: <fpage>1151</fpage>–<lpage>1161</lpage>. <object-id pub-id-type="pmid">16964229</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fisher</surname> <given-names>RA</given-names></name> (<year>1915</year>) <article-title>Frequency distribution of the values of the correlation coefficient in samples from an indefinitely large population</article-title>. <source>Biometrika</source>: <fpage>507</fpage>–<lpage>521</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004868.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eisen</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Spellman</surname> <given-names>PT</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>PO</given-names></name>, <name name-style="western"><surname>Botstein</surname> <given-names>D</given-names></name> (<year>1998</year>) <article-title>Cluster analysis and display of genome-wide expression patterns</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>95</volume>: <fpage>14863</fpage>–<lpage>14868</lpage>. <object-id pub-id-type="pmid">9843981</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stuart</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Segal</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Koller</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>SK</given-names></name> (<year>2003</year>) <article-title>A gene-coexpression network for global discovery of conserved genetic modules</article-title>. <source>Science</source> <volume>302</volume>: <fpage>249</fpage>–<lpage>255</lpage>. <object-id pub-id-type="pmid">12934013</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ballouz</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Verleyen</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Gillis</surname> <given-names>J</given-names></name> (<year>2015</year>) <article-title>Guidance for RNA-seq co-expression network construction and analysis: safety in numbers</article-title>. <source>Bioinformatics</source> <volume>31</volume>: <fpage>2123</fpage>–<lpage>2130</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btv118" xlink:type="simple">10.1093/bioinformatics/btv118</ext-link></comment> <object-id pub-id-type="pmid">25717192</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Holter</surname> <given-names>NS</given-names></name>, <name name-style="western"><surname>Mitra</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Maritan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Cieplak</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Banavar</surname> <given-names>JR</given-names></name>, <etal>et al</etal>. (<year>2000</year>) <article-title>Fundamental patterns underlying gene expression profiles: Simplicity from complexity</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>97</volume>: <fpage>8409</fpage>–<lpage>8414</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004868.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buettner</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Natarajan</surname> <given-names>KN</given-names></name>, <name name-style="western"><surname>Casale</surname> <given-names>FP</given-names></name>, <name name-style="western"><surname>Proserpio</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Scialdone</surname> <given-names>A</given-names></name>, <etal>et al</etal>. (<year>2015</year>) <article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title>. <source>Nature Biotechnology</source> <volume>33</volume>: <fpage>155</fpage>–<lpage>160</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.3102" xlink:type="simple">10.1038/nbt.3102</ext-link></comment> <object-id pub-id-type="pmid">25599176</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ma’ayan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rouillard</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>NR</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Duan</surname> <given-names>Q</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Lean Big Data integration in systems biology and systems pharmacology</article-title>. <source>Trends in Pharmacological Sciences</source> <volume>35</volume>: <fpage>450</fpage>–<lpage>460</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tips.2014.07.001" xlink:type="simple">10.1016/j.tips.2014.07.001</ext-link></comment> <object-id pub-id-type="pmid">25109570</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Troyanskaya</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Cantor</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sherlock</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Hastie</surname> <given-names>T</given-names></name>, <etal>et al</etal>. (<year>2001</year>) <article-title>Missing value estimation methods for DNA microarrays</article-title>. <source>Bioinformatics</source> <volume>17</volume>: <fpage>520</fpage>–<lpage>525</lpage>. <object-id pub-id-type="pmid">11395428</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kang</surname> <given-names>DD</given-names></name>, <name name-style="western"><surname>Sibille</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Kaminski</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Tseng</surname> <given-names>GC</given-names></name> (<year>2012</year>) <article-title>MetaQC: objective quality control and inclusion/exclusion criteria for genomic meta-analysis</article-title>. <source>Nucleic Acids Research</source> <volume>40</volume>: <fpage>e15</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr1071" xlink:type="simple">10.1093/nar/gkr1071</ext-link></comment> <object-id pub-id-type="pmid">22116060</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Freytag</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gagnon-Bartsch</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Speed</surname> <given-names>TP</given-names></name>, <name name-style="western"><surname>Bahlo</surname> <given-names>M</given-names></name> (<year>2015</year>) <article-title>Systematic noise degrades gene co-expression signals but can be corrected</article-title>. <source>BMC Bioinformatics</source> <volume>16</volume>: <fpage>1</fpage>–<lpage>17</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004868.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><collab>The EPC</collab> (<year>2011</year>) <article-title>A User's Guide to the Encyclopedia of DNA Elements (ENCODE)</article-title>. <source>PLoS Biology</source> <volume>9</volume>: <fpage>e1001046</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.1001046" xlink:type="simple">10.1371/journal.pbio.1001046</ext-link></comment> <object-id pub-id-type="pmid">21526222</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref035"><label>35</label><mixed-citation publication-type="other" xlink:type="simple">(2011) BrainSpan: Atlas of the Developing Human Brain [Internet].</mixed-citation></ref>
<ref id="pcbi.1004868.ref036"><label>36</label><mixed-citation publication-type="book" xlink:type="simple">(<year>2010</year>) <source>SRA Handbook</source>[Internet]. <publisher-loc>Bethesda (MD)</publisher-loc>: <publisher-name>National Center for Biotechnology Information (US)</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1004868.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Langmead</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Salzberg</surname> <given-names>SL</given-names></name> (<year>2012</year>) <article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nature Methods</source> <volume>9</volume>: <fpage>357</fpage>–<lpage>359</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1923" xlink:type="simple">10.1038/nmeth.1923</ext-link></comment> <object-id pub-id-type="pmid">22388286</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Habegger</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Sboner</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gianoulis</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Rozowsky</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Agarwal</surname> <given-names>A</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>RSEQtools: a modular framework to analyze RNA-Seq data using compact, anonymized data summaries</article-title>. <source>Bioinformatics</source> <volume>27</volume>: <fpage>281</fpage>–<lpage>283</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq643" xlink:type="simple">10.1093/bioinformatics/btq643</ext-link></comment> <object-id pub-id-type="pmid">21134889</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Trapnell</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Roberts</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Goff</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Pertea</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>D</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Differential gene and transcript expression analysis of RNA-seq experiments with TopHat and Cufflinks</article-title>. <source>Nature Protocols</source> <volume>7</volume>: <fpage>562</fpage>–<lpage>578</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nprot.2012.016" xlink:type="simple">10.1038/nprot.2012.016</ext-link></comment> <object-id pub-id-type="pmid">22383036</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zoubarev</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hamer</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Keshav</surname> <given-names>KD</given-names></name>, <name name-style="western"><surname>McCarthy</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Santos</surname> <given-names>JRC</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Gemma: a resource for the reuse, sharing and meta-analysis of expression profiling data</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>2272</fpage>–<lpage>2273</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts430" xlink:type="simple">10.1093/bioinformatics/bts430</ext-link></comment> <object-id pub-id-type="pmid">22782548</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dewey</surname> <given-names>CN</given-names></name> (<year>2011</year>) <article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title>. <source>BMC Bioinformatics</source> <volume>12</volume>: <fpage>1</fpage>–<lpage>16</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004868.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ashburner</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ball</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Blake</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Botstein</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Butler</surname> <given-names>H</given-names></name>, <etal>et al</etal>. (<year>2000</year>) <article-title>Gene Ontology: tool for the unification of biology</article-title>. <source>Nature Genetics</source> <volume>25</volume>: <fpage>25</fpage>–<lpage>29</lpage>. <object-id pub-id-type="pmid">10802651</object-id></mixed-citation></ref>
<ref id="pcbi.1004868.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ihaka</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gentleman</surname> <given-names>R</given-names></name> (<year>1996</year>) <article-title>R: A language for data analysis and graphics</article-title>. <source>Journal of Computational and Graphical Statistics Journal of Computational and Graphical Statistics</source> <volume>5</volume>: <fpage>299</fpage>–<lpage>314</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>