<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-01695</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006048</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Network analysis</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Brain mapping</subject><subj-group><subject>Optogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Bioassays and physiological analysis</subject><subj-group><subject>Neurophysiological analysis</subject><subj-group><subject>Optogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuronal tuning</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Mathematical functions</subject><subj-group><subject>Convolution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Imbalanced amplification: A mechanism of amplification and suppression from local imbalance of excitation and inhibition in cortical circuits</article-title>
<alt-title alt-title-type="running-head">Imbalanced amplification</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Ebsch</surname> <given-names>Christopher</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2105-9282</contrib-id>
<name name-style="western">
<surname>Rosenbaum</surname> <given-names>Robert</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Applied and Computational Mathematics and Statistics, University of Notre Dame, Notre Dame, Indiana, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Interdisciplinary Center for Network Science and Applications, University of Notre Dame, Notre Dame, Indiana, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Graham</surname> <given-names>Lyle J.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Université Paris Descartes, Centre National de la Recherche Scientifique, FRANCE</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">Robert.Rosenbaum@nd.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>3</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>15</day>
<month>3</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>3</issue>
<elocation-id>e1006048</elocation-id>
<history>
<date date-type="received">
<day>10</day>
<month>10</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>22</day>
<month>2</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Ebsch, Rosenbaum</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006048"/>
<abstract>
<p>Understanding the relationship between external stimuli and the spiking activity of cortical populations is a central problem in neuroscience. Dense recurrent connectivity in local cortical circuits can lead to counterintuitive response properties, raising the question of whether there are simple arithmetical rules for relating circuits’ connectivity structure to their response properties. One such arithmetic is provided by the mean field theory of balanced networks, which is derived in a limit where excitatory and inhibitory synaptic currents precisely balance on average. However, balanced network theory is not applicable to some biologically relevant connectivity structures. We show that cortical circuits with such structure are susceptible to an amplification mechanism arising when excitatory-inhibitory balance is broken at the level of local subpopulations, but maintained at a global level. This amplification, which can be quantified by a linear correction to the classical mean field theory of balanced networks, explains several response properties observed in cortical recordings and provides fundamental insights into the relationship between connectivity structure and neural responses in cortical circuits.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Understanding how the brain represents and processes stimuli requires a quantitative understanding of how signals propagate through networks of neurons. Developing such an understanding is made difficult by the dense interconnectivity of neurons, especially in the cerebral cortex. One approach to quantifying neural processing in the cortex is derived from observations that excitatory (positive) and inhibitory (negative) interactions between neurons tend to balance each other in many brain areas. This balance is achieved under a class of computational models called “balanced networks.” However, previous approaches to the mathematical analysis of balanced network models is not possible under some biologically relevant connectivity structures. We show that, under these structures, balance between excitation and inhibition is necessarily broken and the resulting imbalance causes some stimulus features to be amplified. This “imbalanced amplification” of stimuli can explain several observations from recordings in mouse somatosensory and visual cortical circuits and provides fundamental insights into the relationship between connectivity structure and neural responses in cortical circuits.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>1517828</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2105-9282</contrib-id>
<name name-style="western">
<surname>Rosenbaum</surname> <given-names>Robert</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>1654268</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2105-9282</contrib-id>
<name name-style="western">
<surname>Rosenbaum</surname> <given-names>Robert</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>1707400</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2105-9282</contrib-id>
<name name-style="western">
<surname>Rosenbaum</surname> <given-names>Robert</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by National Science Foundation grants DMS-1517828, DMS-1654268, and DBI-1707400. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="0"/>
<page-count count="28"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-03-27</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All data files are available from the figshare database at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.5933365.v1" xlink:type="simple">https://doi.org/10.6084/m9.figshare.5933365.v1</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Information about a sensory stimulus is passed along a hierarchy of neural populations, from subcortical areas to the cerebral cortex where it propagates through multiple cortical areas and layers. Within each layer, lateral synaptic connectivity shapes the response to synaptic input from upstream layers and populations. In a similar manner, lateral connectivity shapes the response of cortical populations to artificial, optogenetic stimuli. The densely recurrent structure of local cortical circuits can lead to counter-intuitive response properties [<xref ref-type="bibr" rid="pcbi.1006048.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1006048.ref005">5</xref>], making it difficult to predict or interpret a population’s response to natural or artificial stimuli. This raises the question of whether there are underlying arithmetical principles through which one can understand the relationship between a local circuit’s connectivity structure and its response properties.</p>
<p>In principle this relationship could be deduced from detailed computer simulations of the neurons and synapses that comprise the circuit. In practice, such detailed simulations can be computationally expensive, depend on a large number of unconstrained physiological parameters, and their complexity can make it difficult to pinpoint mechanisms underlying observed phenomena. In many cases, however, one is not interested in how the response of each neuron is related to the detailed connectivity between every pair of neurons. Relevant questions are often more macroscopic in nature, <italic>e.g.</italic> “How does increased excitation to population A affect the average firing rate of neurons in population B?” For such questions, it is sufficient to establish a relationship between macroscopic connectivity structure and macroscopic response properties.</p>
<p>One such approach is provided by the mean-field theory of balanced networks [<xref ref-type="bibr" rid="pcbi.1006048.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1006048.ref010">10</xref>], which is derived in the limit of a large number of neurons and a resulting precise balance of strong excitation with strong inhibition. This notion of precise balance implies a simple relationship between the macroscopic structure of connectivity and firing rates, and balanced network models naturally produce the asynchronous, irregular spiking activity that is characteristic of cortical recordings [<xref ref-type="bibr" rid="pcbi.1006048.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref012">12</xref>]. However, classical balanced network theory has some critical limitations. While cortical circuits do appear to balance excitation with inhibition, this balance is not always as precise and spike trains are not as asynchronous as the theory predicts [<xref ref-type="bibr" rid="pcbi.1006048.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1006048.ref019">19</xref>]. Moreover, precise balance is mathematically impossible under some biologically relevant connectivity structures [<xref ref-type="bibr" rid="pcbi.1006048.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1006048.ref010">10</xref>], implying that the classical theory of balanced networks is limited in its ability to model the complexity of real cortical circuits.</p>
<p>We show that cortical circuits with structure that is incompatible with balance are susceptible to an amplification mechanism arising when excitatory-inhibitory balance is broken at the level of local subpopulations, but maintained at a global level. This mechanism of “imbalanced amplification” can be quantified by a linear, finite-size correction to the classical mean field theory of balanced networks that accounts for imperfect balance and local imbalance. Through several examples, we show that imbalanced amplification explains several experimentally observed cortical responses to natural and artificial stimuli.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>The arithmetic of imprecise balance in cortical circuits</title>
<p>We begin by reviewing and demonstrating the classical mean-field theory of balanced networks and a linear correction to the large network limit that the theory depends on. A typical cortical neuron receives synaptic projections from thousands of neurons in other cortical layers, cortical areas or thalamus. These long range projections are largely excitatory and provide enough excitation for the postsynaptic neuron to spike at a much higher rate than the sparse spiking typically observed in cortex. The notion that excitation to cortical populations can be excessively strong has been posed in numerous studies and is typically resolved by accounting for local, lateral synaptic input that is net-inhibitory and partially cancels the strong, net-excitatory external synaptic input [<xref ref-type="bibr" rid="pcbi.1006048.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref020">20</xref>–<xref ref-type="bibr" rid="pcbi.1006048.ref023">23</xref>]. Balanced network theory takes this cancellation to its extreme by considering the limit of large external, feedforward synaptic input that is canceled by similarly large local, recurrent synaptic input. In this limit, a linear mean-field analysis determines population-averaged firing rates in terms of the macroscopic connectivity structure of the network [<xref ref-type="bibr" rid="pcbi.1006048.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref007">7</xref>].</p>
<p>To demonstrate these notions, we first simulated a recurrent network of <italic>N</italic><sub><italic>E</italic></sub> = 4000 excitatory (population <italic>E</italic>) and <italic>N</italic><sub><italic>I</italic></sub> = 1000 inhibitory spiking neurons (population <italic>I</italic>) receiving synaptic connections from an “external” population (<italic>X</italic>) of <italic>N</italic><sub><italic>X</italic></sub> = 4000 excitatory neurons modeled as Poisson processes. Cortical circuits are often probed using optogenetic methods to stimulate or suppress targeted neuronal sub-populations [<xref ref-type="bibr" rid="pcbi.1006048.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref025">25</xref>]. As a simple model of optogenetic stimulation of cortical pyramidal neurons, we added an extra inward current to all neurons in population <italic>E</italic> halfway through the simulation (<xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1a</xref>). Neurons in the local population (<italic>E</italic> and <italic>I</italic>) were modeled using the adaptive exponential integrate-and-fire (AdEx) model, which accurately captures the responses of real cortical neurons [<xref ref-type="bibr" rid="pcbi.1006048.ref026">26</xref>–<xref ref-type="bibr" rid="pcbi.1006048.ref028">28</xref>]. Connectivity was random with each neuron receiving 800 synaptic inputs on average and postsynaptic potential amplitudes between 0.19 and 1.0 mV in amplitude. The recurrent network produced asynchronous, irregular spiking (<xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1b</xref>), similar to that observed in cortical recordings [<xref ref-type="bibr" rid="pcbi.1006048.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref030">30</xref>]. Firing rates in populations <italic>E</italic> and <italic>I</italic> were similar in magnitude to those in population <italic>X</italic> and were increased by optogenetic stimulation (<xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1c</xref>). As predicted by balanced network theory, local synaptic input (from <italic>E</italic> and <italic>I</italic> combined) was net-inhibitory and approximately canceled the external input from population <italic>X</italic> and artificial stimulation combined (<xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1d</xref>).</p>
<fig id="pcbi.1006048.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006048.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Imprecise balance under optogenetic stimulation.</title>
<p><bold>a)</bold> Schematic. A population of recurrently connected excitatory (red) and inhibitory (blue) spiking neuron models receive synaptic input from an external population (<italic>X</italic>; green) of Poisson-spiking neurons. Optogenetic stimulation of excitatory neurons was modeled by an extra inward current to the excitatory population at 5s. <bold>b)</bold> Spike rasters from 50 randomly selected excitatory (red) and inhibitory (blue) neurons from recurrent network. <bold>c)</bold> Average firing rate of excitatory (red) and inhibitory (blue) neurons in the recurrent network from simulations (light solid), from the balanced network approximation (<xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref>; solid dark) and from the corrected approximation (<xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref>; dashed). <bold>d)</bold> Mean synaptic currents to 200 randomly selected excitatory neurons in the recurrent network from external inputs (<italic>X</italic>; green), from the local population (<italic>E</italic> + <italic>I</italic>; purple) and the total synaptic current (black). Currents are measured in units of the neurons’ rheobase (rheobase/<italic>C</italic><sub><italic>m</italic></sub> = 10.5 V/s). <bold>e)</bold> Mean firing rates plotted against mean input currents to all neurons in populations <italic>E</italic> and <italic>I</italic> (gray dots) and a rectified linear fit to their relationship (black line). <bold>f)</bold> Mean firing rates from identical simulations without stimulation except the total number of neurons, <italic>N</italic>, in the recurrent network was modulated while scaling synaptic weights and connection probabilities so that <inline-formula id="pcbi.1006048.e001"><alternatives><graphic id="pcbi.1006048.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mo>∼</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msqrt><mml:mi>N</mml:mi></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> (see <xref ref-type="sec" rid="sec020">Methods</xref>). Solid light curves are from simulations, solid dark from <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref>, and dashed from <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006048.g001" xlink:type="simple"/>
</fig>
<sec id="sec004">
<title>A review of the mean field theory of balanced networks</title>
<p>To capture the notion that the net external synaptic input to neurons is strong, we define the small number,
<disp-formula id="pcbi.1006048.e002"><alternatives><graphic id="pcbi.1006048.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>K</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>X</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>K</italic><sub><italic>EX</italic></sub> = <italic>p</italic><sub><italic>EX</italic></sub> <italic>N</italic><sub><italic>X</italic></sub> is the average number of external synaptic projections received by each neuron in <italic>E</italic> from all neurons in <italic>X</italic>, <italic>p</italic><sub><italic>EX</italic></sub> is connection probability, and <italic>J</italic><sub><italic>EX</italic></sub> is the synaptic strength of each connection. Specifically, <italic>J</italic><sub><italic>EX</italic></sub> is the total postsynaptic current induced in a postsynaptic neuron in <italic>E</italic> by a single spike in a presynaptic neuron in <italic>X</italic>. Hence, 1/<italic>ϵ</italic> quantifies the synaptic current that would be induced in each neuron in <italic>E</italic> (on average) if <italic>every</italic> neuron in <italic>X</italic> spiked once simultaneously. For the simulations in <xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1a–1e</xref> and in <xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2</xref>, <italic>ϵ</italic> = 0.0027 mV. Using this convention, the mean synaptic input to each neuron in populations <italic>E</italic> and <italic>I</italic> from all sources can be written in vector form as
<disp-formula id="pcbi.1006048.e003"><alternatives><graphic id="pcbi.1006048.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">I</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>ϵ</mml:mi></mml:mfrac> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>W</mml:mi> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <bold>I</bold> = [<italic>I</italic><sub><italic>E</italic></sub> <italic>I</italic><sub><italic>I</italic></sub>]<sup><italic>T</italic></sup> (superscript <italic>T</italic> denotes the transpose) is the vector of mean synaptic input to neurons in each population and similarly for their mean rates, <bold>r</bold> = [<italic>r</italic><sub><italic>E</italic></sub> <italic>r</italic><sub><italic>I</italic></sub>]<sup><italic>T</italic></sup>. The rescaled external synaptic input, <bold>X</bold> = [<italic>X</italic><sub><italic>E</italic></sub> <italic>X</italic><sub><italic>I</italic></sub>]<sup><italic>T</italic></sup>, is given by
<disp-formula id="pcbi.1006048.e004"><alternatives><graphic id="pcbi.1006048.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>W</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:msub><mml:mi>r</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mi>s</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>r</italic><sub><italic>X</italic></sub> is the average rate of neurons in population <italic>X</italic> and <italic>s</italic>/<italic>ϵ</italic> is the strength of the inward current induced by optogenetic stimulation (<italic>s</italic> = 0 when stimulation is off). The recurrent and feedforward mean-field connectivity matrices are given by
<disp-formula id="pcbi.1006048.e005"><alternatives><graphic id="pcbi.1006048.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>W</mml:mi> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>I</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>I</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mspace width="1em"/><mml:mtext>and</mml:mtext> <mml:mspace width="1em"/><mml:msub><mml:mi>W</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>I</mml:mi> <mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
respectively where <italic>w</italic><sub><italic>ab</italic></sub> = <italic>K</italic><sub><italic>ab</italic></sub> <italic>J</italic><sub><italic>ab</italic></sub>/(<italic>K</italic><sub><italic>EX</italic></sub> <italic>J</italic><sub><italic>EX</italic></sub>) quantifies the relative number, <italic>K</italic><sub><italic>ab</italic></sub> = <italic>p</italic><sub><italic>ab</italic></sub> <italic>N</italic><sub><italic>b</italic></sub>, and strength, <italic>J</italic><sub><italic>ab</italic></sub>, of synaptic connections from population <italic>b</italic> to <italic>a</italic>. To achieve moderate firing rates when <italic>ϵ</italic> is small, local input, <italic>W</italic><bold>r</bold>, must be net-inhibitory and partially cancel the strong external excitation, <bold>X</bold>, in <xref ref-type="disp-formula" rid="pcbi.1006048.e003">Eq (1)</xref>.</p>
<fig id="pcbi.1006048.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006048.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Imbalanced amplification and suppression under partial optogenetic stimulation.</title>
<p>Same as Fig. 2a-d except the inward current was only provided to 20% of the excitatory neurons, modeling ChR2-expressing pyramidal cells. <bold>a)</bold> Schematic. A population of recurrently connected excitatory (red) and inhibitory (blue) spiking neuron models receive synaptic input from an external population (<italic>X</italic>; green) of Poisson-spiking neurons. Optogenetic stimulation of excitatory neurons was modeled by an extra inward current to 20% of the excitatory population at 5s. <bold>b)</bold> Spike rasters from 10 randomly selected ChR2-expressing and 40 non-expressing excitatory (red) neurons and 50 inhibitory (blue) neurons from the recurrent network. <bold>c)</bold> Average firing rate of ChR2-expressing excitatory neurons from simulations (light solid) and from the corrected approximation (<xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref>; dashed). <bold>d)</bold> Mean synaptic currents to 200 randomly selected ChR2-expressing excitatory neurons from external inputs (<italic>X</italic>; green), from the local population (<italic>E</italic> + <italic>I</italic>; purple) and the total synaptic current (black). <bold>e)</bold> Same as c, but for non-expressing excitatory neurons (red) and inhibitory neurons (blue). <bold>f)</bold> Same as d, but for non-expressing excitatory postsynaptic neurons. <bold>g)</bold> Same as c and d, but averaged over all excitatory neurons (expressing and non-expressing). Currents are measured in units of the neurons’ rheobase (rheobase/<italic>C</italic><sub><italic>m</italic></sub> = 10.5 V/s). Firing rates predicted by <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> are not shown in c and e because <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> is not applicable to those cases.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006048.g002" xlink:type="simple"/>
</fig>
<p>Balanced network theory [<xref ref-type="bibr" rid="pcbi.1006048.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref007">7</xref>] takes this cancellation to its extreme by considering the limit of large number of neurons, <italic>N</italic> = <italic>N</italic><sub><italic>E</italic></sub> + <italic>N</italic><sub><italic>I</italic></sub>, while scaling connection strengths and probabilities in such a way that <inline-formula id="pcbi.1006048.e006"><alternatives><graphic id="pcbi.1006048.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msqrt><mml:mi>N</mml:mi></mml:msqrt> <mml:mo>)</mml:mo> <mml:mo>→</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Under this scaling, <xref ref-type="disp-formula" rid="pcbi.1006048.e003">Eq (1)</xref> would seem to imply that mean synaptic currents diverge in the limit, but this divergence is avoided in balanced networks by a precise cancellation between external and recurrent synaptic input. To achieve this cancellation, firing rates must satisfy the mean-field balance equation,
<disp-formula id="pcbi.1006048.e007"><alternatives><graphic id="pcbi.1006048.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>W</mml:mi> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
in the large <italic>N</italic> limit, so that [<xref ref-type="bibr" rid="pcbi.1006048.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1006048.ref010">10</xref>]
<disp-formula id="pcbi.1006048.e008"><alternatives><graphic id="pcbi.1006048.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
Hence, balanced network theory provides a closed form, linear expression for firing rates in the large network limit. Generally speaking, the firing rate of a neuron depends nonlinearly on the mean and variance of its input current [<xref ref-type="bibr" rid="pcbi.1006048.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref032">32</xref>]. Notably, however, the derivation of the fixed point in <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> did not require us to specify the exact form of this dependence. Instead, <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> represents the unique fixed point firing rates for which synaptic currents remain bounded as <italic>N</italic> → ∞. More specifically, if <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> is not satisfied as <italic>N</italic> → ∞ then ∥<bold>I</bold>∥ → ∞ (where ‖ ⋅ ‖ is the Euclidean norm). The existence of this fixed point does not guarantee that it is stable. Precise, general conditions on the accuracy of <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> for spiking network models are not known and the investigation of such conditions is outside the scope of this study. However, the approximation tends to be accurate in the <italic>N</italic> → ∞ limit whenever all eigenvalues of <italic>W</italic> have negative real part, the solution in <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> is strictly positive, and inhibitory synaptic kinetics are sufficiently fast [<xref ref-type="bibr" rid="pcbi.1006048.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1006048.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref033">33</xref>]. Indeed, <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> provides a reasonable, but imperfect approximation to firing rates in our spiking network simulation (<xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1c</xref>, compare light and dark solid).</p>
<p>Balanced network theory has some critical limitations. Local cortical circuits are, of course, finite in size so the <italic>N</italic> → ∞ (equivalently <italic>ϵ</italic> → 0) limit may not be justified. Moreover, excitation and inhibition in cortex may not be as perfectly balanced and spike trains not as asynchronous as predicted by balanced network theory [<xref ref-type="bibr" rid="pcbi.1006048.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1006048.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref034">34</xref>]. More importantly, under many biologically relevant connectivity structures, precise cancellation cannot be realized so <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> cannot even be applied [<xref ref-type="bibr" rid="pcbi.1006048.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1006048.ref010">10</xref>]. We next review a simple, linear correction to <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref> that partially resolves these issues.</p>
</sec>
<sec id="sec005">
<title>A linear correction to precise balance</title>
<p>A correction to <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> can be obtained by considering <italic>ϵ</italic> non-zero, but this requires making assumptions on the relationship between neurons’ input statistics and firing rates. A simple approximation is obtained by assuming that population-averaged firing rates, <bold>r</bold>, depend only on population-averaged mean inputs, <bold>I</bold>, yielding the fixed points problem <bold>r</bold> = <italic>f</italic>(<bold>I</bold>) = <italic>f</italic>([<italic>W</italic><bold>r</bold> + <bold>X</bold>]/<italic>ϵ</italic>) where <italic>f</italic> is the population-level f-I curve. When <italic>f</italic> is an increasing function over relevant ranges of <bold>I</bold>, this fixed point equation can be re-written as
<disp-formula id="pcbi.1006048.e009"><alternatives><graphic id="pcbi.1006048.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>W</mml:mi> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:msup><mml:mi>f</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Hence, in strongly coupled networks (<italic>ϵ</italic> small), the shape of f-I curves has a small effect on steady-state firing rates under such an approximation. Indeed, in the <italic>ϵ</italic> → 0 limit, the f-I curve has no effect and firing rates are determined by <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref>. This conclusion easily generalizes to the case where <italic>f</italic> also depends on the average temporal variance of neurons’ inputs.</p>
<p>A simple case of this approximation is obtained by using a rectified linear approximation, <bold>r</bold> = <italic>g</italic>[<bold>I</bold>]<sub>+</sub> where [⋅]<sub>+</sub> denotes the positive part. We fit such a function to the relationship between neurons’ mean synaptic inputs and firing rates from our spiking network simulation (<xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1e</xref>). Assuming that the average firing rates of all populations are positive, this rectified linear approximation produces a linear rate model [<xref ref-type="bibr" rid="pcbi.1006048.ref035">35</xref>] with mean firing rates given by solving <italic>W</italic><bold>r</bold> + <bold>X</bold> = <italic>ϵ</italic>/<italic>g</italic> <bold>r</bold> to obtain
<disp-formula id="pcbi.1006048.e010"><alternatives><graphic id="pcbi.1006048.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>r</mml:mi></mml:mstyle> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>ϵ</mml:mi> <mml:mi>D</mml:mi> <mml:mo>−</mml:mo> <mml:mi>W</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
where
<disp-formula id="pcbi.1006048.e011"><alternatives><graphic id="pcbi.1006048.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>D</mml:mi> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>g</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>g</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
The AdEx neuron model used in our simulations has a nonlinear f-I curve (<xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1e</xref>; gray dots) and its firing rate depends on all statistics of its input, not just the mean [<xref ref-type="bibr" rid="pcbi.1006048.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref036">36</xref>]. Nevertheless, the linear approximation in <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref> was accurate in predicting firing rates in our simulations (<xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1c</xref>, dashed), outperforming the balanced network approximation from <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref>. This can be explained by the fact that the balanced approximation in <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> is already somewhat accurate and the linear approximation in <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref> corrects for some of the error introduced by imperfect balance, even though the true dependence of <bold>r</bold> on <bold>I</bold> is nonlinear.</p>
<p>To further investigate the relative accuracy of Eqs <xref ref-type="disp-formula" rid="pcbi.1006048.e008">(3)</xref> and <xref ref-type="disp-formula" rid="pcbi.1006048.e010">(4)</xref>, we repeated the spiking network simulations from <xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1a–1d</xref> while proportionally scaling the number of neurons (<italic>N</italic><sub><italic>E</italic></sub>, <italic>N</italic><sub><italic>I</italic></sub>, and <italic>N</italic><sub><italic>X</italic></sub>) in each population and scaling connection weights and probabilities in such a way that <inline-formula id="pcbi.1006048.e012"><alternatives><graphic id="pcbi.1006048.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mo>∼</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msqrt><mml:mi>N</mml:mi></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> (see <xref ref-type="sec" rid="sec020">Methods</xref>). As predicted by balanced network theory, excitatory and inhibitory firing rates increased toward the limit in <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> (<xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1f</xref>, compare light and dark solid lines). The linear correction in <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref> tracks this increase in firing rates and is more accurate than the approximation in <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref>, particularly for smaller <italic>N</italic> (<xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1f</xref>, dashed). It is worth noting that, in applying <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref> to obtain the dashed curve in <xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1f</xref>, we fixed the value of <italic>g</italic> to the one obtained from the simulation in <xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1a–1e</xref>. Hence, a single estimate of the gain yields an accurate approximation even under different parameter values.</p>
<p>The predictive power of <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref> in these examples is, of course, limited by the fact that it was only applied after estimating the gain of the neurons using firing rates obtained in simulations. Moreover, highly nonlinear f-I curves could introduce additional error. However, the purpose of <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref> in this work is to provide a first-order approximation to and general understanding of firing rates in networks under which <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> cannot be applied. For these purposes, <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref> is sufficient.</p>
</sec>
</sec>
<sec id="sec006">
<title>Imbalanced amplification under partial optogenetic stimulation</title>
<p>We next show that a more realistic model of optogenetic stimulation breaks the classical balanced state, providing a demonstrative and experimentally relevant example of imbalanced amplification and suppression that explains phenomena observed in recordings from mouse somatosensory cortex.</p>
<sec id="sec007">
<title>Firing rates are increased by stimulating fewer neurons</title>
<p>The model of optogenetic stimulation considered in <xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1</xref> is somewhat inaccurate since optogenetic stimulation of excitatory neurons is often incomplete. For example, only a fraction of cortical pyramidal neurons express the channelrhodopsin 2 (ChR2) protein targeted in many optogenetic experiments [<xref ref-type="bibr" rid="pcbi.1006048.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref038">38</xref>]. To more accurately model optogenetic stimulation, we modified the example above so the extra inward current was provided to a randomly chosen 20% of the excitatory neurons (<xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2a</xref>), modeling ChR2-expressing pyramidal cells. This change produced surprising results. The ChR2-expressing neurons increased their firing rates by a larger amount than they did when all excitatory neurons received the current (<xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2b and 2c</xref>; compare to <xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1b and 1c</xref>). Hence, counterintuitively, stimulating fewer neurons actually <italic>amplifies</italic> the effects of stimulation on the targeted cells. In contrast, non-expressing excitatory neurons were <italic>suppressed</italic> during stimulation and inhibitory neurons increased their rates, but by a smaller amount than they did under complete stimulation (<xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2e</xref>; compare to <xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1c</xref>).</p>
<p>Similar effects were observed in experiments by Adesnik and Scanziani [<xref ref-type="bibr" rid="pcbi.1006048.ref003">3</xref>]. In that study, pyramidal neurons in layers (L) 2/3 of mouse somatosensory cortex (S1) were stimulated optogenetically, but only about 23% of the pyramidal neurons expressed ChR2. During stimulation, non-expressing L2/3 pyramidal neurons were suppressed and inhibitory synaptic currents increased, implying an increase in inhibitory neuron firing rates.</p>
<p>To understand these effects, we first extended the mean-field theory above to account for multiple subpopulations by defining
<disp-formula id="pcbi.1006048.e013"><alternatives><graphic id="pcbi.1006048.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>x</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>e</mml:mi> <mml:mi>x</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:msub><mml:mi>r</mml:mi> <mml:mi>I</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
to be the vector of average firing rates for the ChR2-expressing (<italic>exp</italic>), non-expressing (<italic>nexp</italic>) excitatory neurons and inhibitory (<italic>I</italic>) neurons. The vector of average input to the network is again given by <xref ref-type="disp-formula" rid="pcbi.1006048.e003">Eq (1)</xref> where
<disp-formula id="pcbi.1006048.e014"><alternatives><graphic id="pcbi.1006048.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>W</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:msub><mml:mi>r</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mi>s</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula> <italic>W</italic><sub><italic>X</italic></sub> = [<italic>w</italic><sub><italic>EX</italic></sub> <italic>w</italic><sub><italic>EX</italic></sub> <italic>w</italic><sub><italic>IX</italic></sub>]<sup><italic>T</italic></sup>,
<disp-formula id="pcbi.1006048.e015"><alternatives><graphic id="pcbi.1006048.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>W</mml:mi> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>q</mml:mi> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mi>q</mml:mi> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mi>q</mml:mi> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>I</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>I</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>I</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
and <italic>q</italic> = 0.2 represents the proportion of neurons that express ChR2.</p>
<p>Importantly, <italic>W</italic> is singular (<italic>i.e.</italic>, not invertible), so classical balanced network theory fails for this example since <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> cannot be evaluated. More specifically, it is impossible for <bold>I</bold> in <xref ref-type="disp-formula" rid="pcbi.1006048.e003">Eq (1)</xref> to remain finite as <italic>ϵ</italic> → 0 since there is no vector, <bold>r</bold>, such that <italic>W</italic><bold>r</bold> = −<bold>X</bold>. Intuitively, this can be understood by noting that expressing and non-expressing excitatory neurons receive the same local input on average (<xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2d and 2f</xref>, purple), since local connectivity is not specific to ChR2 expression, but they receive different external input during stimulation (<xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2d and 2f</xref>, green). Therefore, local synaptic input cannot simultaneously cancel the external input to both sub-populations, so the precise cancellation required by classical balanced network theory cannot be achieved (<xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2d and 2f</xref>, black). A similar mechanism has been used to explain a lack of cancellation between positive and negative correlations in balanced networks [<xref ref-type="bibr" rid="pcbi.1006048.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref039">39</xref>].</p>
</sec>
<sec id="sec008">
<title>Amplification in the nullspace: A general analysis</title>
<p>We now give a general analysis of network responses when <italic>W</italic> is singular. The example of partial optogenetic stimulation is then considered as a special case. If <italic>W</italic> is a singular matrix then only vectors, <bold>X</bold>, that are in the column space of <italic>W</italic> admit solutions to <italic>W</italic><bold>r</bold> + <bold>X</bold> = 0. The column space of <italic>W</italic> is defined as the linear space of all vectors, <bold>u</bold>, such that <bold>u</bold> = <italic>W</italic><bold>r</bold> for some <bold>r</bold>. The column space of a matrix, <italic>W</italic>, is the orthogonal complement of the nullspace of <italic>W</italic><sup><italic>T</italic></sup>. We can therefore decompose
<disp-formula id="pcbi.1006048.e016"><alternatives><graphic id="pcbi.1006048.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1006048.e017"><alternatives><graphic id="pcbi.1006048.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mo form="prefix">proj</mml:mo> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mspace width="4pt"/><mml:mi mathvariant="bold">X</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is the projection of <bold>X</bold> onto the nullspace of <italic>W</italic><sup><italic>T</italic></sup> and <bold>X</bold><sub>1</sub> = proj<sub><italic>C</italic>(<italic>W</italic>)</sub> <bold>X</bold> is the projection onto the column space of <italic>W</italic>. Moreover, note that <inline-formula id="pcbi.1006048.e018"><alternatives><graphic id="pcbi.1006048.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:msub><mml:mo form="prefix">proj</mml:mo> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mspace width="4pt"/><mml:mi>W</mml:mi> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> since <italic>W</italic><bold>r</bold> is in the column space of <italic>W</italic>. Therefore, the projection of the total input onto the nullspace of <italic>W</italic><sup><italic>T</italic></sup> is
<disp-formula id="pcbi.1006048.e019"><alternatives><graphic id="pcbi.1006048.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo form="prefix">proj</mml:mo> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mi mathvariant="bold">I</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mo form="prefix">proj</mml:mo> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>ϵ</mml:mi></mml:mfrac> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>W</mml:mi> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>ϵ</mml:mi></mml:mfrac> <mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
Hence, the projection of the total synaptic input onto the nullspace of <italic>W</italic><sup><italic>T</italic></sup> is <inline-formula id="pcbi.1006048.e020"><alternatives><graphic id="pcbi.1006048.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> whenever <bold>X</bold> has an <inline-formula id="pcbi.1006048.e021"><alternatives><graphic id="pcbi.1006048.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> component in the nullspace of <italic>W</italic><sup><italic>T</italic></sup>. Note that, despite the 1/<italic>ϵ</italic> term in <xref ref-type="disp-formula" rid="pcbi.1006048.e003">Eq (1)</xref>, the total synaptic input, <bold>I</bold>, is <inline-formula id="pcbi.1006048.e022"><alternatives><graphic id="pcbi.1006048.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> when balance is realized due to cancellation (as in <xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1d</xref>). Hence, the singularity of <italic>W</italic> introduces large, <inline-formula id="pcbi.1006048.e023"><alternatives><graphic id="pcbi.1006048.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> synaptic currents where they would not occur if <italic>W</italic> was non-singular. In other words, external input in the nullspace of <italic>W</italic><sup><italic>T</italic></sup> produces strong synaptic currents in the network. Importantly, this conclusion does not rely on any assumptions about neurons’ f-I curves or other properties. This result is a fundamental property of balanced networks or, more generally, networks receiving strong feedforward input.</p>
<p>To understand the implications of this result on firing rates in the network, however, we must specify an f-I curve. We again consider the linear rate approximation quantified by <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref>. Importantly, unlike <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> from classical balanced network theory, the approximation in <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref> is applicable to this example because it accounts for imperfect cancellation between local and external inputs. Specifically, the regularized matrix, <italic>ϵD</italic> − <italic>W</italic>, is invertible so <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref> can be evaluated even though <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> cannot. The resulting firing rate solution from <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref> agrees well with spiking network simulations (<xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2c and 2e</xref>). Hence, <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref> provides an accurate approximation to firing rates in networks to which classical balanced network theory is not applicable at all.</p>
<p>
<xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref> also provides a concise mathematical quantification of firing rates when <italic>W</italic> is singular. Namely, if <bold>X</bold><sub>0</sub>, <inline-formula id="pcbi.1006048.e024"><alternatives><graphic id="pcbi.1006048.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">O</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> then firing rates can be expanded as
<disp-formula id="pcbi.1006048.e025"><alternatives><graphic id="pcbi.1006048.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>ϵ</mml:mi></mml:mfrac> <mml:msub><mml:mi mathvariant="bold">r</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">r</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
where <bold>r</bold><sub>0</sub> is in the nullspace of <italic>W</italic> and <bold>r</bold><sub>0</sub>, <inline-formula id="pcbi.1006048.e026"><alternatives><graphic id="pcbi.1006048.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:msub><mml:mi mathvariant="bold">r</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">O</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. To derive this result, first note that <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref> can be rewritten as
<disp-formula id="pcbi.1006048.e027"><alternatives><graphic id="pcbi.1006048.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>W</mml:mi> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mi>D</mml:mi> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
If <bold>X</bold> has components in the nullspace of <italic>W</italic><sup><italic>T</italic></sup> then we can project both sides of this equation onto this nullspace to obtain
<disp-formula id="pcbi.1006048.e028"><alternatives><graphic id="pcbi.1006048.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo form="prefix">proj</mml:mo> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mspace width="0.166667em"/><mml:msub><mml:mo form="prefix">proj</mml:mo> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mi>D</mml:mi> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where we again used the fact that <inline-formula id="pcbi.1006048.e029"><alternatives><graphic id="pcbi.1006048.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:msub><mml:mo form="prefix">proj</mml:mo> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mi>W</mml:mi> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> since <italic>W</italic><bold>r</bold> is in the column space of <italic>W</italic>. Since <inline-formula id="pcbi.1006048.e030"><alternatives><graphic id="pcbi.1006048.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mo form="prefix">proj</mml:mo> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mi mathvariant="bold">X</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and <italic>D</italic> are assumed <inline-formula id="pcbi.1006048.e031"><alternatives><graphic id="pcbi.1006048.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, this equation is only consistent when <inline-formula id="pcbi.1006048.e032"><alternatives><graphic id="pcbi.1006048.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. We can therefore decompose <bold>r</bold> = (1/<italic>ϵ</italic>)<bold>r</bold><sub>0</sub> + <bold>r</bold><sub>1</sub> where <bold>r</bold><sub>0</sub>, <inline-formula id="pcbi.1006048.e033"><alternatives><graphic id="pcbi.1006048.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:msub><mml:mi mathvariant="bold">r</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">O</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. We next show that <bold>r</bold><sub>0</sub> is in the nullspace of <italic>W</italic>. From <xref ref-type="disp-formula" rid="pcbi.1006048.e027">Eq (7)</xref>, we have
<disp-formula id="pcbi.1006048.e034"><alternatives><graphic id="pcbi.1006048.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>W</mml:mi> <mml:mo>[</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>ϵ</mml:mi></mml:mfrac> <mml:msub><mml:mi mathvariant="bold">r</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">r</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>]</mml:mo> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mi>D</mml:mi> <mml:mo>[</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>ϵ</mml:mi></mml:mfrac> <mml:msub><mml:mi mathvariant="bold">r</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">r</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Isolating the <inline-formula id="pcbi.1006048.e035"><alternatives><graphic id="pcbi.1006048.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> terms gives <italic>W</italic><bold>r</bold><sub>0</sub> = 0 and therefore <bold>r</bold><sub>0</sub> is in the nullspace of <italic>W</italic>. In summary, components of external input in the nullspace of <italic>W</italic><sup><italic>T</italic></sup> partially break balance to evoke amplified firing rates in the nullspace of <italic>W</italic>.</p>
<p>In the special case that <italic>W</italic> has a one-dimensional nullspace, a more precise characterization of <bold>r</bold><sub>0</sub> is possible. Let <bold>v</bold><sub>0</sub> be in the nullspace of <italic>W</italic> with ∥<bold>v</bold><sub>0</sub>∥ = 1. Note that <italic>W</italic><sup><italic>T</italic></sup> also has a one-dimensional nullspace (since <italic>W</italic> is a square matrix). Let <bold>v</bold><sub>2</sub> be in the nullspace of <italic>W</italic><sup><italic>T</italic></sup> with ∥<bold>v</bold><sub>2</sub>∥ = 1. Since <bold>r</bold><sub>0</sub> is in the nullspace of <italic>W</italic>, we can write <bold>r</bold><sub>0</sub> = <italic>a</italic><bold>v</bold><sub>0</sub> for some scalar, <italic>a</italic>. Now, dot product both sides of <xref ref-type="disp-formula" rid="pcbi.1006048.e027">Eq (7)</xref> by <bold>v</bold><sub>2</sub> to obtain
<disp-formula id="pcbi.1006048.e036"><alternatives><graphic id="pcbi.1006048.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>v</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msub> <mml:mo>·</mml:mo> <mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>v</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msub> <mml:mo>·</mml:mo> <mml:mi>D</mml:mi> <mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>r</mml:mi></mml:mstyle></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>v</mml:mi></mml:mstyle> <mml:mn>2</mml:mn></mml:msub> <mml:mo>·</mml:mo> <mml:mi>D</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>r</mml:mi></mml:mstyle> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>r</mml:mi></mml:mstyle> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula>
where we have used that <bold>v</bold><sub>2</sub> · <italic>W</italic><bold>r</bold> = 0 since <bold>v</bold><sub>2</sub> is in the nullspace of <italic>W</italic><sup><italic>T</italic></sup>, which is orthogonal to <italic>W</italic><bold>r</bold> in the column space of <italic>W</italic>. Keeping only <inline-formula id="pcbi.1006048.e037"><alternatives><graphic id="pcbi.1006048.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> terms and making the substitution <bold>r</bold><sub>0</sub> = <italic>a</italic><bold>v</bold><sub>0</sub>, we get
<disp-formula id="pcbi.1006048.e038"><alternatives><graphic id="pcbi.1006048.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>a</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>·</mml:mo> <mml:mi mathvariant="bold">X</mml:mi></mml:mrow> <mml:mrow><mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>·</mml:mo> <mml:mi>D</mml:mi> <mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
so that
<disp-formula id="pcbi.1006048.e039"><alternatives><graphic id="pcbi.1006048.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e039" xlink:type="simple"/><mml:math display="block" id="M39"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">r</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>·</mml:mo> <mml:mi mathvariant="bold">X</mml:mi></mml:mrow> <mml:mrow><mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>·</mml:mo> <mml:mi>D</mml:mi> <mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac> <mml:mspace width="0.166667em"/><mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
yielding a concise expression for the amplified component of firing rates when <italic>W</italic> has a one-dimensional nullspace. Note that <bold>v</bold><sub>0</sub> is in the nullspace of <italic>W</italic>, so this result is consistent with the more general conclusions above.</p>
</sec>
<sec id="sec009">
<title>Amplification in the nullspace under partial optogenetic stimulation</title>
<p>For the specific example of partial optogenetic stimulation considered in <xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2</xref>, the nullspace of <italic>W</italic><sup><italic>T</italic></sup> is spanned by <inline-formula id="pcbi.1006048.e041"><alternatives><graphic id="pcbi.1006048.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msqrt><mml:mn>2</mml:mn></mml:msqrt> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mn>0</mml:mn> <mml:mo>]</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and the projection of <bold>X</bold> onto the nullspace of <italic>W</italic><sup><italic>T</italic></sup> is <bold>X</bold><sub>0</sub> = [<italic>s</italic>/2 − <italic>s</italic>/2 0]<sup><italic>T</italic></sup>. The nullspace of <italic>W</italic> is spanned by <inline-formula id="pcbi.1006048.e042"><alternatives><graphic id="pcbi.1006048.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:msub><mml:mi mathvariant="bold">v</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msqrt><mml:mrow><mml:msup><mml:mi>q</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi> <mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>-</mml:mo> <mml:mi>q</mml:mi> <mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mn>0</mml:mn> <mml:mo>]</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. We therefore have <bold>r</bold> = (1/<italic>ϵ</italic>)<bold>r</bold><sub>0</sub> + <bold>r</bold><sub>1</sub> where <xref ref-type="disp-formula" rid="pcbi.1006048.e039">Eq (8)</xref> gives
<disp-formula id="pcbi.1006048.e043"><alternatives><graphic id="pcbi.1006048.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">r</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mi>g</mml:mi> <mml:mi>s</mml:mi> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Hence, ChR2-expressing neurons are amplified and non-expressing neurons are suppressed by optogenetic stimulation, as observed in simulations. A more precise result is given by expanding the full approximation from <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref> to obtain
<disp-formula id="pcbi.1006048.e044"><alternatives><graphic id="pcbi.1006048.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e044" xlink:type="simple"/><mml:math display="block" id="M44"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">r</mml:mi> <mml:mtext>on</mml:mtext></mml:msub> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="bold">r</mml:mi> <mml:mtext>off</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mi>g</mml:mi> <mml:mi>s</mml:mi></mml:mrow> <mml:mi>ϵ</mml:mi></mml:mfrac> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>+</mml:mo> <mml:mi mathvariant="script">O</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mi>q</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mi>q</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mi>q</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>+</mml:mo> <mml:mi mathvariant="script">O</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
Here, <inline-formula id="pcbi.1006048.e045"><alternatives><graphic id="pcbi.1006048.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is a constant proportional to <italic>s</italic>, <italic>c</italic> = |<italic>w</italic><sub><italic>IE</italic></sub>/<italic>w</italic><sub><italic>II</italic></sub>| and <bold>r</bold><sub>off</sub> is the vector of firing rates in the balanced, <italic>ϵ</italic> → 0, limit when stimulation is off (<italic>s</italic> = 0). Specifically, <bold>r</bold><sub>off</sub> is the unique vector that satisfies <italic>W</italic><bold>r</bold><sub>off</sub> + <italic>W</italic><sub><italic>XrX</italic></sub> = 0, which is solvable even though <italic>W</italic> is singular because <italic>W</italic><sub><italic>X</italic></sub> <italic>r</italic><sub><italic>X</italic></sub> is in the column space of <italic>W</italic>, so balance can be maintained when <italic>s</italic> = 0.</p>
<p>The <italic>gs</italic>/<italic>ϵ</italic> term in <xref ref-type="disp-formula" rid="pcbi.1006048.e044">Eq (9)</xref> quantifies the amplification and suppression observed in simulations: Non-expressing neurons are suppressed by stimulation since −<italic>q</italic> &lt; 0 and the response of ChR2-expressing neurons is amplified since 1 − <italic>q</italic> &gt; 0 and <italic>s</italic>/<italic>ϵ</italic> is large. Stimulating fewer excitatory neurons (<italic>q</italic> smaller), increases the rate of the stimulated neurons, as indicated by the 1 − <italic>q</italic> factor. The <inline-formula id="pcbi.1006048.e046"><alternatives><graphic id="pcbi.1006048.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> term shows why inhibitory neurons increase their rates by a smaller amount. In summary, the optogenetically induced suppression observed experimentally by Adesnik and Scanziani [<xref ref-type="bibr" rid="pcbi.1006048.ref003">3</xref>] is a generic feature of balanced or strongly coupled networks under partial stimulation.</p>
</sec>
<sec id="sec010">
<title>Local imbalance with global balance explains intralaminar suppression and interlaminar facilitation</title>
<p>Interestingly, despite the break of balance at the level of ChR2-expressing and non-expressing subpopulations, global balance is maintained in this example. This can be understood by repeating the mean-field analysis above without partitioning neurons into ChR2-expressing and non-expressing sub-populations, thereby quantifying the global average of firing rate of all excitatory neurons. In particular, the average synaptic input, <bold>I</bold> = [<italic>I</italic><sub><italic>E</italic></sub> <italic>I</italic><sub><italic>I</italic></sub>]<sup><italic>T</italic></sup>, to excitatory and inhibitory neurons is given by <xref ref-type="disp-formula" rid="pcbi.1006048.e003">Eq (1)</xref> where <italic>W</italic> and <italic>W</italic><sub><italic>X</italic></sub> are as in <xref ref-type="disp-formula" rid="pcbi.1006048.e005">Eq (2)</xref>, and
<disp-formula id="pcbi.1006048.e047"><alternatives><graphic id="pcbi.1006048.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>W</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:msub><mml:mi>r</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>s</mml:mi> <mml:mi>q</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
to account for the fact that only a proportion <italic>q</italic> of the excitatory neurons receive the inward current from optogenetic stimulation. In this case, <italic>W</italic> is non-singular so the balanced solution in <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> is applicable. Indeed, the average firing rates of all excitatory neurons in our spiking network simulation is close to the prediction from <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> and even closer to the prediction from <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref> (<xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2g</xref>; compare to <xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1c</xref>). The average feedforward input to all excitatory neurons is canceled by net-inhibitory local input (<xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2h</xref>; compare to <xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1d</xref>). Hence, balance is maintained globally even though the network is imbalanced at the level of ChR2-expressing and non-expressing populations.</p>
<p>In the same study by Adesnik and Scanziani considered above [<xref ref-type="bibr" rid="pcbi.1006048.ref003">3</xref>], recordings were made in L5, which was not directly stimulated optogenetically, but receives synaptic input from L2/3. Interestingly, despite the fact that most excitatory neurons in L2/3 were suppressed during stimulation, firing rates in L5 increased.</p>
<p>To model these experiments, we interpreted the recurrent network from <xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2</xref> as a local neural population in L2/3, which sends synaptic projections to L5 (<xref ref-type="fig" rid="pcbi.1006048.g003">Fig 3a</xref>). We modeled a neural population in L5 identically to the L2/3 population, except its feedforward input came from excitatory neurons in the L2/3 network, instead of from Poisson-spiking neurons. As in experiments [<xref ref-type="bibr" rid="pcbi.1006048.ref003">3</xref>], L5 neurons increased their firing rates during stimulation (<xref ref-type="fig" rid="pcbi.1006048.g003">Fig 3b</xref>) and approximate balance was maintained (<xref ref-type="fig" rid="pcbi.1006048.g003">Fig 3c</xref>). This can be understood by noting that, in our model, L5 receives synaptic input sampled from all excitatory neurons in L2/3. Hence, the feedforward excitatory current to L5 neurons increases proportionally to the average excitatory firing rates in L2/3 during stimulation. As we showed above, this average rate increases (<xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2e</xref>), despite the fact that most excitatory neurons in L2/3 are suppressed by stimulation. Hence, the combination of intralaminar suppression and interlaminar facilitation observed during optogenetic stimulation in experiments [<xref ref-type="bibr" rid="pcbi.1006048.ref003">3</xref>] results from the fact that the stimulated layer is locally imbalanced, but globally balanced during partial stimulation. These conclusions rely on an assumption that synaptic projections to L5 come from both ChR2-expressing and non-expressing excitatory neurons in L2/3.</p>
<fig id="pcbi.1006048.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006048.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Interlaminar facilitation despite intralaminar suppression under optogenetic stimulation.</title>
<p><bold>a)</bold> Multi-layer network schematic. L2/3 was identical to the recurrent network in <xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2</xref> and provided external excitatory input to L5, which had the same internal structure as the L2/3 model. <bold>b)</bold> Average firing rates of excitatory (red) and inhibitory (blue) neurons in L5 from simulations (light solid) and from the corrected approximation (<xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref>; dashed). <bold>c)</bold> Mean synaptic currents to 200 randomly selected excitatory neurons in L5 from external inputs (<italic>X</italic>; green), from the local population (<italic>E</italic> + <italic>I</italic>; purple) and the total synaptic current (black). Currents are measured in units of the neurons’ rheobase (rheobase/<italic>C</italic><sub><italic>m</italic></sub> = 10.5 V/s).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006048.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec011">
<title>Imbalanced amplification of weak stimuli</title>
<p>Sufficiently small <italic>ϵ</italic> or large <italic>s</italic> would introduce negative rates in <xref ref-type="disp-formula" rid="pcbi.1006048.e044">Eq (9)</xref>, representing a regime in which non-expressing neurons cease spiking and the firing rate of ChR2-expressing neurons saturate at a high value. In this sense, firing rates do not truly have a <inline-formula id="pcbi.1006048.e048"><alternatives><graphic id="pcbi.1006048.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> component for <italic>ϵ</italic> very small. However, smaller values of <italic>ϵ</italic> allow weak stimuli (small <italic>s</italic>) to be strongly amplified. Strictly speaking, if one takes <inline-formula id="pcbi.1006048.e049"><alternatives><graphic id="pcbi.1006048.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mrow><mml:mi>s</mml:mi> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, then under the linear approximation in <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref>, partial optogenetic stimulation would have an <inline-formula id="pcbi.1006048.e050"><alternatives><graphic id="pcbi.1006048.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> effect on the average firing rate of stimulated and unstimulated subpopulations, but an <inline-formula id="pcbi.1006048.e051"><alternatives><graphic id="pcbi.1006048.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> effect on globally averaged firing rates. In practical terms, this means that, in strongly coupled networks (<italic>ϵ</italic> small), partial optogenetic stimuli can have a moderate effect on the firing rates of stimulated neurons while having a negligible effect on the average firing rates of all excitatory neurons.</p>
<p>To demonstrate this idea, we repeated the simulations from <xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2</xref> in a network with four times as many neurons (<italic>N</italic> = 2 × 10<sup>4</sup>) where synaptic weights and probabilities were scaled so that <inline-formula id="pcbi.1006048.e052"><alternatives><graphic id="pcbi.1006048.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mo>∼</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msqrt><mml:mi>N</mml:mi></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> (as in <xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1f</xref>) and we reduced stimulus strength, <italic>s</italic>, as well. In this simulation, ChR2-expressing neurons’ firing rates nearly doubled (<xref ref-type="fig" rid="pcbi.1006048.g004">Fig 4a</xref>) and non-expressing neurons were noticeably suppressed (<xref ref-type="fig" rid="pcbi.1006048.g004">Fig 4b</xref>). However, the change in the average firing rate of all excitatory neurons was nearly imperceptible (<xref ref-type="fig" rid="pcbi.1006048.g004">Fig 4c</xref>) and similarly for the firing rates of inhibitory neurons (<xref ref-type="fig" rid="pcbi.1006048.g004">Fig 4b and 4c</xref>). As a result, the firing rates in a downstream layer were unnoticeably modulated during stimulation (<xref ref-type="fig" rid="pcbi.1006048.g004">Fig 4d</xref>; compare to <xref ref-type="fig" rid="pcbi.1006048.g003">Fig 3</xref>). This effect could mask the effects of optogenetic stimulation in recordings.</p>
<fig id="pcbi.1006048.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006048.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Imbalanced amplification of weak stimuli.</title>
<p>Same simulations as Figs <xref ref-type="fig" rid="pcbi.1006048.g002">2</xref> and <xref ref-type="fig" rid="pcbi.1006048.g003">3</xref> except with <italic>N</italic> increased by a factor of four, <italic>ϵ</italic> decreased by a factor of two, and a weaker stimulus. <bold>a)</bold> Schematic. A recurrent network (stimulated layer), which receives external input from Poisson-spiking neurons (green X) and from partial optogenetic stimulation, sends excitatory synaptic input to an identical network (downstream layer). <bold>b)</bold> Average firing rate of ChR2-expressing excitatory neurons in the stimulated layer from simulations (light solid) and from the corrected approximation (<xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref>; dashed). <bold>c)</bold> Same as b, but for non-expressing excitatory (red) and inhibitory (blue) neurons in the stimulated layer. <bold>d)</bold> Same as b, but averaged over all excitatory neurons in the stimulated layer. <bold>e)</bold> Same as d, but for the downstream layer. Mean firing rates from simulations of the stimulated layer changed from 5.8 Hz before stimulation to 10.0 Hz during stimulation for ChR2-expressing neurons, from 5.9 to 5.1 Hz for non-expressing excitatory neurons, from 5.9 to 6.1 Hz averaged over all excitatory neurons, and from 7.8 to 8.0 Hz for inhibitory neurons. Mean firing rates from simulations of the downstream layer changed from 7.2 Hz to 8.1 Hz for excitatory neurons and from 8.5 Hz to 9.5 Hz for inhibitory neurons.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006048.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec012">
<title>Imbalanced amplification with nearly singular connectivity matrices</title>
<p>An apparent limitation of the results above is that they rely on the singularity of the connectivity matrix, <italic>W</italic>. Singularity is a fragile property of matrices that arises from structural symmetries. In the example above, singularity arises from our implicit assumption that local synaptic connectivity is independent of whether neurons express ChR2. Even a slight difference in connectivity to or from ChR2-expressing neurons would make <italic>W</italic> non-singular so that its nullspace would be empty, rendering <xref ref-type="disp-formula" rid="pcbi.1006048.e025">Eq (6)</xref> vacuous. We now show that <xref ref-type="disp-formula" rid="pcbi.1006048.e025">Eq (6)</xref> and the surrounding analysis naturally extends to connectivity matrices that are approximately singular, with similar overall conclusions.</p>
<p>A matrix, <italic>W</italic>, is singular if it has λ = 0 as an eigenvalue. A matrix can therefore be considered approximately singular if it has an eigenvalue with small magnitude. Specifically, let λ be an eigenvalue of <italic>W</italic> with |λ| ≪ 1. Note that λ is also an eigenvalue of <italic>W</italic><sup><italic>T</italic></sup>. Now let <bold>v</bold> be the associated eigenvector so that <italic>W</italic><sup><italic>T</italic></sup> <bold>v</bold> = λ<bold>v</bold> and assume that ∥<bold>v</bold>∥ = 1 without loss of generality. Take the projection of each term in <xref ref-type="disp-formula" rid="pcbi.1006048.e027">Eq (7)</xref> onto the subspace spanned by <bold>v</bold> to get
<disp-formula id="pcbi.1006048.e053"><alternatives><graphic id="pcbi.1006048.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e053" xlink:type="simple"/><mml:math display="block" id="M53"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo form="prefix">proj</mml:mo> <mml:mi mathvariant="bold">v</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>W</mml:mi> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mo form="prefix">proj</mml:mo> <mml:mi mathvariant="bold">v</mml:mi></mml:msub> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:msub><mml:mo form="prefix">proj</mml:mo> <mml:mi mathvariant="bold">v</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>D</mml:mi> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Now note that proj<sub><bold>v</bold></sub>[<italic>W</italic><bold>r</bold>] = λ proj<sub><bold>v</bold></sub> <bold>r</bold>. Hence,
<disp-formula id="pcbi.1006048.e054"><alternatives><graphic id="pcbi.1006048.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e054" xlink:type="simple"/><mml:math display="block" id="M54"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>λ</mml:mo> <mml:msub><mml:mo form="prefix">proj</mml:mo> <mml:mi mathvariant="bold">v</mml:mi></mml:msub> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mo form="prefix">proj</mml:mo> <mml:mi mathvariant="bold">v</mml:mi></mml:msub> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:msub><mml:mo form="prefix">proj</mml:mo> <mml:mi mathvariant="bold">v</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>D</mml:mi> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
If <inline-formula id="pcbi.1006048.e055"><alternatives><graphic id="pcbi.1006048.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mrow><mml:msub><mml:mo form="prefix">proj</mml:mo><mml:mi mathvariant="bold">v</mml:mi></mml:msub><mml:mspace width="4pt"/><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">O</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and proj<sub><bold>v</bold></sub>[<italic>D</italic><bold>r</bold>] ∼ proj<sub><bold>v</bold></sub> <bold>r</bold> then this implies
<disp-formula id="pcbi.1006048.e056"><alternatives><graphic id="pcbi.1006048.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e056" xlink:type="simple"/><mml:math display="block" id="M56"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mo>|</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>|</mml:mo> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mo form="prefix">proj</mml:mo><mml:mi mathvariant="bold">v</mml:mi></mml:msub><mml:mspace width="4pt"/><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>∼</mml:mo> <mml:msub><mml:mo form="prefix">proj</mml:mo><mml:mi mathvariant="bold">v</mml:mi></mml:msub><mml:mspace width="4pt"/><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Hence,
<disp-formula id="pcbi.1006048.e057"><alternatives><graphic id="pcbi.1006048.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e057" xlink:type="simple"/><mml:math display="block" id="M57"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>δ</mml:mi></mml:mfrac> <mml:msub><mml:mi mathvariant="bold">r</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">r</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>δ</italic> = |λ| + <italic>ϵ</italic>. This generalizes <xref ref-type="disp-formula" rid="pcbi.1006048.e025">Eq (6)</xref> to the case where <italic>W</italic> is only approximately singular. In summary, the mechanism of imbalanced amplification is a general property of strongly coupled networks with singular or nearly singular connection matrices.</p>
<p>We next show that networks with connection probabilities that depend on continuous quantities like distance or tuning preference necessarily have singular or nearly singular connectivity kernels and are therefore naturally susceptible to the amplification and suppression mechanisms described above.</p>
</sec>
</sec>
<sec id="sec013">
<title>Imbalanced amplification and suppression in continuously indexed networks</title>
<p>So far we considered networks with discrete subpopulations. Connectivity in many cortical circuits depends on continuous quantities like distance in physical or tuning space. To understand how the amplification and suppression mechanisms discussed above extend to such connectivity structures, we next considered a model of a visual cortical circuit. We arranged 2 × 10<sup>5</sup> AdEx model neurons (80% excitatory and 20% inhibitory) on a square domain, modeling a patch of L2/3 in mouse primary visual cortex (V1). Neurons received external input from a similarly arranged layer of 1.6 × 10<sup>5</sup> Poisson-spiking neurons, modeling a parallel patch of L4 (<xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5a</xref>). We additionally assigned a random orientation preference to each neuron, modeling the “salt-and-pepper” distribution of orientation preferences in mouse V1. Connectivity was probabilistic and, as in cortex [<xref ref-type="bibr" rid="pcbi.1006048.ref040">40</xref>–<xref ref-type="bibr" rid="pcbi.1006048.ref042">42</xref>], inter- and intralaminar connections were more numerous between nearby and similarly tuned neurons. Specifically, connection probability decayed like a Gaussian as a function of distance in physical and orientation space (<xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5b</xref>), where distance in both spaces was measured using periodic boundaries, <italic>i.e.</italic> wrapped Gaussians were used in place of regular Gaussians.</p>
<fig id="pcbi.1006048.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006048.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Response properties of a continuously indexed network.</title>
<p><bold>a)</bold> Network diagram. Poisson spiking neurons in L4 (<italic>X</italic>) provide external synaptic input to 2 × 10<sup>5</sup> recurrently connected excitatory and inhibitory AdEx model neurons (<italic>E</italic> and <italic>I</italic>) in L2/3. The spatial width of synaptic projections from population <italic>a</italic> = <italic>X</italic>, <italic>E</italic>, <italic>I</italic> is given by <italic>β</italic><sub><italic>a</italic></sub>. <bold>b)</bold> Neurons are assigned random orientations and connection probability also depends on the difference, <italic>dθ</italic>, between neurons’ preferred orientation. <bold>c)</bold> An oriented stimulus in the animal’s visual field. <bold>d,e)</bold> The location of the stimulus is modeled by firing rates in L4 that are peaked at the location of the stimulus in physical and orientation space. <bold>f,g)</bold> Synaptic current to neurons in population <italic>E</italic> from the external network (green), the local network (purple) and total (black) as a function distance from the receptive field center and as a function of neurons’ preferred orientation. <bold>h,i)</bold> Firing rate profiles of excitatory (red) and inhibitory (blue) neurons in the local network from simulations (light curves), classical balanced network theory (solid, dark curves; from <xref ref-type="disp-formula" rid="pcbi.1006048.e073">Eq (13)</xref>) and under the linear correction (dashed; from <xref ref-type="disp-formula" rid="pcbi.1006048.e089">Eq (17)</xref>) in physical and orientation space. <bold>j-o)</bold> Same as (d-i) except for a smaller visual stimulus, modeled by a narrower spatial firing rate profile in L4. Firing rates from <xref ref-type="disp-formula" rid="pcbi.1006048.e073">Eq (13)</xref> are not shown in panels n and o because balance cannot be realized and <xref ref-type="disp-formula" rid="pcbi.1006048.e073">Eq (13)</xref> cannot be applied when external input is narrower than recurrent connectivity (see main text, <xref ref-type="supplementary-material" rid="pcbi.1006048.s001">S1 Text</xref>, and [<xref ref-type="bibr" rid="pcbi.1006048.ref008">8</xref>]).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006048.g005" xlink:type="simple"/>
</fig>
<sec id="sec014">
<title>Amplification and suppression in simulations with spatially narrow stimuli</title>
<p>An oriented stimulus localized in the animal’s visual field (<xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5c</xref>) was modeled by imposing firing rate profiles in L4 that were peaked at the associated location in physical and tuning space, again with a Gaussian profile (<xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5d and 5e</xref>). This produced external input to L2/3 that was similarly peaked, but was nearly perfectly canceled by net-inhibitory lateral input (<xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5f and 5g</xref>). Excitatory and inhibitory firing rate profiles in L2/3 were also peaked at the associated location in physical and tuning space (<xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5h and 5i</xref>), demonstrating that neurons in L2/3 were appropriately tuned to the stimulus.</p>
<p>A smaller visual stimulus was modeled by shrinking the spatial profile of firing rates in L4 while leaving the orientation-dependence of L4 rates unchanged (<xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5j and 5k</xref>). As above, synaptic inputs and firing rate profiles were appropriately peaked in physical and orientation tuning space (<xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5l–5o</xref>). However, the smaller stimulus produced a surprising change to firing rates in L2/3. Despite the fact that L2/3 neurons at all locations received less excitation from L4 (<xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5l</xref>), peak firing rates in L2/3 increased and a surround suppression dynamic emerged (<xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5n</xref>). Hence, a more localized external input produced an amplification and suppression dynamic similar to the one observed in our model of optogenetic stimulation (compare to <xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2</xref>). On the other hand, responses in orientation tuning space were mostly unchanged by the smaller stimulus size (<xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5m and 5o</xref>).</p>
</sec>
<sec id="sec015">
<title>Mean-field theory of balance in two-dimensional spatial networks with orientation-tuning-specific connectivity</title>
<p>The mean-field theory of balanced networks was previously extended to continuously indexed networks in one and two dimensions [<xref ref-type="bibr" rid="pcbi.1006048.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref043">43</xref>]. We now review a straightforward extension to two spatial dimensions and one orientation dimension. <xref ref-type="disp-formula" rid="pcbi.1006048.e003">Eq (1)</xref> generalizes naturally to
<disp-formula id="pcbi.1006048.e058"><alternatives><graphic id="pcbi.1006048.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e058" xlink:type="simple"/><mml:math display="block" id="M58"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">I</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>ϵ</mml:mi></mml:mfrac> <mml:mo>[</mml:mo> <mml:mi mathvariant="script">W</mml:mi> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where <bold>r</bold>(<bold>x</bold>, <italic>θ</italic>) = [<italic>r</italic><sub><italic>E</italic></sub>(<bold>x</bold>, <italic>θ</italic>) <italic>r</italic><sub><italic>I</italic></sub>(<bold>x</bold>, <italic>θ</italic>)]<sup><italic>T</italic></sup> is the vector of mean firing rates of excitatory and inhibitory L2/3 neurons near spatial coordinates <bold>x</bold> = (<italic>x</italic>, <italic>y</italic>) with preferred orientation near <italic>θ</italic>, and similarly for the neurons’ external input, <bold>X</bold>(<bold>x</bold>, <italic>θ</italic>), and total input, <bold>I</bold>(<bold>x</bold>, <italic>θ</italic>). The external input is given by <inline-formula id="pcbi.1006048.e059"><alternatives><graphic id="pcbi.1006048.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="script">W</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:msub><mml:mi>r</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> where <italic>r</italic><sub><italic>X</italic></sub>(<bold>x</bold>, <italic>θ</italic>) is the profile of firing rates in L4 The connectivity kernels, <inline-formula id="pcbi.1006048.e060"><alternatives><graphic id="pcbi.1006048.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mi mathvariant="script">W</mml:mi></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006048.e061"><alternatives><graphic id="pcbi.1006048.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:msub><mml:mi mathvariant="script">W</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, are convolution integral operators defined by
<disp-formula id="pcbi.1006048.e062"><alternatives><graphic id="pcbi.1006048.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e062" xlink:type="simple"/><mml:math display="block" id="M62"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">W</mml:mi> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>*</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>E</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub> <mml:mo>*</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>I</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>*</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>E</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>I</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub> <mml:mo>*</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
and
<disp-formula id="pcbi.1006048.e063"><alternatives><graphic id="pcbi.1006048.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e063" xlink:type="simple"/><mml:math display="block" id="M63"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="script">W</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:msub><mml:mi>r</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>X</mml:mi></mml:mrow></mml:msub> <mml:mo>*</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>I</mml:mi> <mml:mi>X</mml:mi></mml:mrow></mml:msub> <mml:mo>*</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Here, <italic>w</italic><sub>ab</sub>(<bold>x</bold>, <italic>θ</italic>) is the mean-field connection strength between neurons separated by <bold>x</bold> in physical space and <italic>θ</italic> in orientation space (see <xref ref-type="sec" rid="sec020">Methods</xref>), and [<italic>w</italic><sub>ab</sub> * <italic>r</italic><sub>b</sub>](<bold>x</bold>, <italic>θ</italic>) denotes circular convolution with respect to <bold>x</bold> and <italic>θ</italic>, <italic>i.e.</italic>, convolution with periodic boundaries. These convolution operators implement low-pass filters in orientation and physical space, capturing the effects of synaptic divergence and tuning-specific connection probabilities. Similar filters describe feedforward connectivity in artificial convolutional neural networks used for image recognition [<xref ref-type="bibr" rid="pcbi.1006048.ref044">44</xref>].</p>
<p>Taking <italic>ϵ</italic> → 0 in <xref ref-type="disp-formula" rid="pcbi.1006048.e058">Eq (10)</xref> shows that that firing rates must satisfy
<disp-formula id="pcbi.1006048.e064"><alternatives><graphic id="pcbi.1006048.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e064" xlink:type="simple"/><mml:math display="block" id="M64"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">W</mml:mi> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
This is an analogue to <xref ref-type="disp-formula" rid="pcbi.1006048.e027">Eq (7)</xref> for spatial networks. From here, one may be tempted to invert the integral operator <inline-formula id="pcbi.1006048.e065"><alternatives><graphic id="pcbi.1006048.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mi mathvariant="script">W</mml:mi></mml:math></alternatives></inline-formula> to obtain a spatial analogue of <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref>. However, integral operators are never invertible [<xref ref-type="bibr" rid="pcbi.1006048.ref045">45</xref>]. Specifically, since <xref ref-type="disp-formula" rid="pcbi.1006048.e064">Eq (11)</xref> is an integral equation of the first kind, there necessarily exist external input profiles, <bold>X</bold>(<bold>x</bold>, <italic>θ</italic>), for which <xref ref-type="disp-formula" rid="pcbi.1006048.e064">Eq (11)</xref> does not admit a solution so that the classical balanced state cannot be realized [<xref ref-type="bibr" rid="pcbi.1006048.ref008">8</xref>]. This implies that there always exist inputs that prevent a continuously indexed network from maintaining excitatory-inhibitory balance. To better understand why this is the case, we follow previous work [<xref ref-type="bibr" rid="pcbi.1006048.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref043">43</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref046">46</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref047">47</xref>] in transitioning to the spatial Fourier domain to rewrite <xref ref-type="disp-formula" rid="pcbi.1006048.e064">Eq (11)</xref> as
<disp-formula id="pcbi.1006048.e066"><alternatives><graphic id="pcbi.1006048.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e066" xlink:type="simple"/><mml:math display="block" id="M66"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
Here, <inline-formula id="pcbi.1006048.e067"><alternatives><graphic id="pcbi.1006048.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>E</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.277778em"/><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>I</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is a Fourier coefficient of <bold>r</bold>(<bold>x</bold>, <italic>θ</italic>) and similarly for <inline-formula id="pcbi.1006048.e068"><alternatives><graphic id="pcbi.1006048.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> where <bold>n</bold> = (<italic>n</italic><sub>1</sub>, <italic>n</italic><sub>2</sub>) is the two-dimensional spatial Fourier mode and <italic>k</italic> is the Fourier mode in tuning space. Importantly, the convolution operators above become ordinary matrices in the Fourier domain. Specifically,
<disp-formula id="pcbi.1006048.e069"><alternatives><graphic id="pcbi.1006048.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e069" xlink:type="simple"/><mml:math display="block" id="M69"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>I</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>I</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
and
<disp-formula id="pcbi.1006048.e070"><alternatives><graphic id="pcbi.1006048.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e070" xlink:type="simple"/><mml:math display="block" id="M70"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>I</mml:mi> <mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1006048.e071"><alternatives><graphic id="pcbi.1006048.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is a Fourier coefficient of <italic>w</italic><sub><italic>a</italic></sub>(<bold>x</bold>, <italic>θ</italic>). Note that going from <xref ref-type="disp-formula" rid="pcbi.1006048.e064">Eq (11)</xref> to <xref ref-type="disp-formula" rid="pcbi.1006048.e066">Eq (12)</xref> requires that <inline-formula id="pcbi.1006048.e072"><alternatives><graphic id="pcbi.1006048.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mi mathvariant="script">W</mml:mi></mml:math></alternatives></inline-formula> is a convolution operator and that the boundaries of the network are treated periodically, <italic>i.e.</italic>, the convolutions are circular.</p>
<p>Solving <xref ref-type="disp-formula" rid="pcbi.1006048.e066">Eq (12)</xref> gives an analogue to <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref> for spatial networks in the Fourier domain,
<disp-formula id="pcbi.1006048.e073"><alternatives><graphic id="pcbi.1006048.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e073" xlink:type="simple"/><mml:math display="block" id="M73"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
This equation gives all Fourier coefficients, <inline-formula id="pcbi.1006048.e074"><alternatives><graphic id="pcbi.1006048.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. However, this solution is only viable when the inverse transform exists, <italic>i.e.</italic>, when the Fourier series of <inline-formula id="pcbi.1006048.e075"><alternatives><graphic id="pcbi.1006048.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> converges, which in turn requires that <inline-formula id="pcbi.1006048.e076"><alternatives><graphic id="pcbi.1006048.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:mrow><mml:mrow><mml:mo>∥</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∥</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> converges to zero faster than <inline-formula id="pcbi.1006048.e077"><alternatives><graphic id="pcbi.1006048.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:mrow><mml:mrow><mml:mo>∥</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∥</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> as <bold>n</bold> → 0 and <italic>k</italic> → 0. More specifically, <inline-formula id="pcbi.1006048.e078"><alternatives><graphic id="pcbi.1006048.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1006048.e073">Eq (13)</xref> must be square-summable. Hence, balance can only be realized when recurrent connectivity, quantified by <inline-formula id="pcbi.1006048.e079"><alternatives><graphic id="pcbi.1006048.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:mrow><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, has more power at high spatial frequencies than external input, <inline-formula id="pcbi.1006048.e080"><alternatives><graphic id="pcbi.1006048.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. In other words, for balance to be realized, external input, <bold>X</bold>(<bold>x</bold>, <italic>θ</italic>), cannot have “sharper” spatial features than the recurrent connectivity kernels, <italic>w</italic><sub><italic>ab</italic></sub>(<bold>x</bold>, <italic>θ</italic>) for <italic>a</italic>, <italic>b</italic> = <italic>E</italic>, <italic>I</italic>.</p>
<p>The use of Fourier series to solve <xref ref-type="disp-formula" rid="pcbi.1006048.e064">Eq (11)</xref> relies on the translation invariance of the integral operator, <inline-formula id="pcbi.1006048.e081"><alternatives><graphic id="pcbi.1006048.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:mi mathvariant="script">W</mml:mi></mml:math></alternatives></inline-formula>, but the existence of external input profiles for which <xref ref-type="disp-formula" rid="pcbi.1006048.e064">Eq (11)</xref> does not admit a solution is a more general feature that is true for any integral operators with Hilbert-Schmidt kernels. Specifically, the convolutions, <italic>w</italic><sub><italic>ab</italic></sub> * <italic>r</italic><sub><italic>b</italic></sub>, that define <inline-formula id="pcbi.1006048.e082"><alternatives><graphic id="pcbi.1006048.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:mi mathvariant="script">W</mml:mi></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006048.e083"><alternatives><graphic id="pcbi.1006048.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:msub><mml:mi mathvariant="script">W</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:math></alternatives></inline-formula> can be replaced by integrals of the form ∫ <italic>w</italic><sub><italic>ab</italic></sub>(<bold>u</bold>, <bold>v</bold>)<italic>r</italic><sub><italic>b</italic></sub>(<bold>v</bold>)<italic>d</italic><bold>v</bold> and the result that there exist <bold>X</bold>(<bold>u</bold>) for which <xref ref-type="disp-formula" rid="pcbi.1006048.e064">Eq (11)</xref> does not admit a solution is still true whenever the kernels, <italic>w</italic><sub><italic>ab</italic></sub>(<bold>u</bold>, <bold>v</bold>) are finite (no delta functions) and square-integrable [<xref ref-type="bibr" rid="pcbi.1006048.ref045">45</xref>].</p>
</sec>
<sec id="sec016">
<title>Balance and imbalance in networks with Gaussian-shaped connectivity kernels</title>
<p>A more intuitive understanding of when and why balance is broken is provided by considering the Gaussian-shaped connectivity profiles used in our spiking network simulations. This explanation applies equally to the spatial profile of firing rates and connectivity in physical and orientation space, so we do not distinguish between the two in this discussion. Similar calculations were performed previously for spatial networks [<xref ref-type="bibr" rid="pcbi.1006048.ref008">8</xref>], so we only review the results here and discuss some of their implications here. Details of the calculations are provided in <xref ref-type="supplementary-material" rid="pcbi.1006048.s001">S1 Text</xref>.</p>
<p>When L4 firing rates and all connectivity kernels are Gaussian-shaped, all firing rates and synaptic input profiles are also Gaussian-shaped in the balanced state (see [<xref ref-type="bibr" rid="pcbi.1006048.ref008">8</xref>] and <xref ref-type="supplementary-material" rid="pcbi.1006048.s001">S1 Text</xref>), so the analysis can be performed solely in terms of the widths of each of these profiles.</p>
<p>Let <italic>σ</italic><sub><italic>a</italic></sub> be the width of the firing rate profile in population <italic>a</italic>, <italic>α</italic><sub><italic>a</italic></sub> the width of outgoing synaptic connections from the presynaptic neurons in population <italic>a</italic>, and <italic>β</italic><sub><italic>a</italic></sub> the width of the spatial profile of synaptic input from population <italic>a</italic> = <italic>X</italic>, <italic>E</italic>, <italic>I</italic> (<xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5a, 5d, 5f and 5h</xref>). Since L4 is the feedforward population in this context, we use <italic>X</italic> subscripts for L4 and <italic>E</italic>, <italic>I</italic> for L2/3 neurons.</p>
<p>Synaptic divergence broadens the profile of synaptic currents so that
<disp-formula id="pcbi.1006048.e084"><alternatives><graphic id="pcbi.1006048.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e084" xlink:type="simple"/><mml:math display="block" id="M84"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>β</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>α</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
for <italic>a</italic> = <italic>E</italic>, <italic>I</italic>, <italic>X</italic>. This is due to the Gaussian shape of firing rates and connectivity, as well as the convolution that describes the resulting mean-field synaptic inputs (the convolution of a Gaussian with a Gaussian is Gaussian). For balance to be maintained, feedforward synaptic input from L4 must be precisely canceled by lateral synaptic input in L2/3. This, in turn, requires that
<disp-formula id="pcbi.1006048.e085"><alternatives><graphic id="pcbi.1006048.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e085" xlink:type="simple"/><mml:math display="block" id="M85"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>β</mml:mi> <mml:mi>E</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mi>I</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Combined with <xref ref-type="disp-formula" rid="pcbi.1006048.e084">Eq (14)</xref>, this implies that balance requires the widths of firing rate profiles in L2/3 to satisfy [<xref ref-type="bibr" rid="pcbi.1006048.ref008">8</xref>]
<disp-formula id="pcbi.1006048.e086"><alternatives><graphic id="pcbi.1006048.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e086" xlink:type="simple"/><mml:math display="block" id="M86"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>E</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mi>β</mml:mi> <mml:mi>X</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>α</mml:mi> <mml:mi>E</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>I</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mi>β</mml:mi> <mml:mi>X</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>α</mml:mi> <mml:mi>I</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
This approximation accurately predicted firing rate profiles in our first spiking network simulation (<xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5h and 5i</xref>, solid, dark curves have widths given by <xref ref-type="disp-formula" rid="pcbi.1006048.e086">Eq (15)</xref>). Hence, by <xref ref-type="disp-formula" rid="pcbi.1006048.e086">Eq (15)</xref>, the requirement of cancellation in balanced networks implies that recurrent connectivity sharpens neurons’ tuning, both in physical and orientation space.</p>
<p>Interestingly, <xref ref-type="disp-formula" rid="pcbi.1006048.e086">Eq (15)</xref> implies that the amount by which excitatory and inhibitory firing rate profiles are sharpened in balanced networks is determined by the width of their <italic>outgoing</italic> synaptic projections. Pyramidal neurons in L2/3 of mouse V1 preferentially target similarly tuned neurons in L2/3, but the tuning of these lateral connection probabilities is much broader than the tuning of pyramidal neurons’ firing rates [<xref ref-type="bibr" rid="pcbi.1006048.ref041">41</xref>] (<italic>α</italic><sub><italic>E</italic></sub> &gt; <italic>σ</italic><sub><italic>E</italic></sub> in orientation space). This observation is consistent with <xref ref-type="disp-formula" rid="pcbi.1006048.e086">Eq (15)</xref>: Excitatory neuron tuning curves are sharpened precisely because their outgoing connections are broadly tuned. Hence, sharpening of excitatory neuron tuning curves in L2/3 is naturally achieved in balanced networks with lateral excitation, without requiring lateral inhibition. Following the same line of reasoning, the broader orientation tuning of inhibitory neurons [<xref ref-type="bibr" rid="pcbi.1006048.ref040">40</xref>] (<italic>σ</italic><sub><italic>I</italic></sub> larger) suggests that they project more locally in orientation tuning space than pyramidal neurons (<italic>α</italic><sub><italic>I</italic></sub> &lt; <italic>α</italic><sub><italic>E</italic></sub> in orientation space).</p>
<p>
<xref ref-type="disp-formula" rid="pcbi.1006048.e086">Eq (15)</xref> also clarify when and why balanced network theory fails for continuously indexed networks. If external inputs are sharper than lateral connectivity (<italic>β</italic><sub><italic>X</italic></sub> &lt; <italic>α</italic><sub><italic>E</italic></sub> or <italic>β</italic><sub><italic>X</italic></sub> &lt; <italic>α</italic><sub><italic>I</italic></sub>) in physical or orientation space, then <xref ref-type="disp-formula" rid="pcbi.1006048.e086">Eq (15)</xref> do not yield solutions for <italic>σ</italic><sub><italic>E</italic></sub> or <italic>σ</italic><sub><italic>I</italic></sub>. In other words, balance requires that
<disp-formula id="pcbi.1006048.e087"><alternatives><graphic id="pcbi.1006048.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e087" xlink:type="simple"/><mml:math display="block" id="M87"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mi>E</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:mspace width="0.5em"/><mml:mtext>and</mml:mtext> <mml:mspace width="0.5em"/><mml:msub><mml:mi>α</mml:mi> <mml:mi>I</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
because <xref ref-type="disp-formula" rid="pcbi.1006048.e064">Eq (11)</xref> does not admit a solution when these inequalities are broken (see [<xref ref-type="bibr" rid="pcbi.1006048.ref008">8</xref>] and <xref ref-type="supplementary-material" rid="pcbi.1006048.s001">S1 Text</xref>). Intuitively, when the inequalities above are broken, recurrent connectivity paints with too broad a brush to cancel the sharper feedforward input, so balance cannot be realized. As a result, balanced network theory cannot be applied to the example in <xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5j–5o</xref> with a smaller visual stimulus.</p>
</sec>
<sec id="sec017">
<title>A linear correction to balance quantifies amplification and suppression in continuously indexed networks</title>
<p>We next derive a linear correction to <xref ref-type="disp-formula" rid="pcbi.1006048.e073">Eq (13)</xref> that accounts for imperfect cancellation and, in doing so, gives firing rate approximations where classical balanced network theory fails. Specifically, we generalize the derivation of <xref ref-type="disp-formula" rid="pcbi.1006048.e010">Eq (4)</xref> to continuously indexed networks. Under this linear approximation, firing rate profiles are given by solving
<disp-formula id="pcbi.1006048.e088"><alternatives><graphic id="pcbi.1006048.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e088" xlink:type="simple"/><mml:math display="block" id="M88"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">W</mml:mi> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mi>g</mml:mi> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
This is an integral equation of the second kind, which generically admits firing rate solutions, <bold>r</bold>, even when <xref ref-type="disp-formula" rid="pcbi.1006048.e064">Eq (11)</xref> does not [<xref ref-type="bibr" rid="pcbi.1006048.ref045">45</xref>]. We again transition to the Fourier domain so <xref ref-type="disp-formula" rid="pcbi.1006048.e088">Eq (16)</xref> becomes
<disp-formula id="pcbi.1006048.e089"><alternatives><graphic id="pcbi.1006048.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e089" xlink:type="simple"/><mml:math display="block" id="M89"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>ϵ</mml:mi> <mml:mi>D</mml:mi> <mml:mo>−</mml:mo> <mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo stretchy="true">˜</mml:mo></mml:mover> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(17)</label></disp-formula>
From <xref ref-type="disp-formula" rid="pcbi.1006048.e089">Eq (17)</xref>, firing rates, <bold>r</bold>(<bold>x</bold>, <italic>θ</italic>), can be computed numerically through an inverse transform (the Fourier series over <bold>n</bold> and <italic>k</italic>), yielding an accurate approximation to firing rates from spiking network simulations even where classical balanced network theory fails (<xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5n and 5o</xref>). Interestingly, the linear correction is slightly less accurate at predicting firing rates than the classical theory in <xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5i</xref>. However, the main purpose of the corrected theory is not increased accuracy, but that it is applicable in situations where the classical theory is not.</p>
<p>The amplification and suppression caused by the smaller visual stimulus can be roughly explained by the balanced amplification mechanism discussed previously. Since <inline-formula id="pcbi.1006048.e090"><alternatives><graphic id="pcbi.1006048.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:mi mathvariant="script">W</mml:mi></mml:math></alternatives></inline-formula> is a low-pass filter, it approximately cancels high frequency components of firing rate profiles. Hence, high frequency components are in the approximate nullspace of the local connectivity operator, <inline-formula id="pcbi.1006048.e091"><alternatives><graphic id="pcbi.1006048.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e091" xlink:type="simple"/><mml:math display="inline" id="M91"><mml:mi mathvariant="script">W</mml:mi></mml:math></alternatives></inline-formula>, and are therefore amplified by the network through the same mechanism discussed for discrete networks previously.</p>
<p>A more precise explanation is given by first averaging firing rates over orientation preference by setting <italic>k</italic> = 0 in <xref ref-type="disp-formula" rid="pcbi.1006048.e089">Eq (17)</xref> to give <inline-formula id="pcbi.1006048.e092"><alternatives><graphic id="pcbi.1006048.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e092" xlink:type="simple"/><mml:math display="inline" id="M92"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> that depends only on spatial frequency, and similarly for <inline-formula id="pcbi.1006048.e093"><alternatives><graphic id="pcbi.1006048.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e093" xlink:type="simple"/><mml:math display="inline" id="M93"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006048.e094"><alternatives><graphic id="pcbi.1006048.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e094" xlink:type="simple"/><mml:math display="inline" id="M94"><mml:mrow><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The convolution operator, <inline-formula id="pcbi.1006048.e095"><alternatives><graphic id="pcbi.1006048.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e095" xlink:type="simple"/><mml:math display="inline" id="M95"><mml:mi mathvariant="script">W</mml:mi></mml:math></alternatives></inline-formula>, implements a low-pass filter, so <inline-formula id="pcbi.1006048.e096"><alternatives><graphic id="pcbi.1006048.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e096" xlink:type="simple"/><mml:math display="inline" id="M96"><mml:mrow><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is <inline-formula id="pcbi.1006048.e097"><alternatives><graphic id="pcbi.1006048.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e097" xlink:type="simple"/><mml:math display="inline" id="M97"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in magnitude at low spatial frequencies and converges to zero at higher frequencies (large ∥<bold>n</bold>∥). The regularized inverse, <inline-formula id="pcbi.1006048.e098"><alternatives><graphic id="pcbi.1006048.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e098" xlink:type="simple"/><mml:math display="inline" id="M98"><mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mi>D</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, is therefore <inline-formula id="pcbi.1006048.e099"><alternatives><graphic id="pcbi.1006048.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e099" xlink:type="simple"/><mml:math display="inline" id="M99"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in magnitude at low frequencies and <inline-formula id="pcbi.1006048.e100"><alternatives><graphic id="pcbi.1006048.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e100" xlink:type="simple"/><mml:math display="inline" id="M100"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> at higher frequencies (<xref ref-type="fig" rid="pcbi.1006048.g006">Fig 6a</xref>, purple). When external input, <bold>X</bold>(<bold>x</bold>), has sharp features, <inline-formula id="pcbi.1006048.e101"><alternatives><graphic id="pcbi.1006048.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e101" xlink:type="simple"/><mml:math display="inline" id="M101"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> has power at higher spatial frequencies (<xref ref-type="fig" rid="pcbi.1006048.g006">Fig 6a</xref>, green), which are amplified by the <inline-formula id="pcbi.1006048.e102"><alternatives><graphic id="pcbi.1006048.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e102" xlink:type="simple"/><mml:math display="inline" id="M102"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> component of <inline-formula id="pcbi.1006048.e103"><alternatives><graphic id="pcbi.1006048.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e103" xlink:type="simple"/><mml:math display="inline" id="M103"><mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mi>D</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> while low frequencies remain <inline-formula id="pcbi.1006048.e104"><alternatives><graphic id="pcbi.1006048.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e104" xlink:type="simple"/><mml:math display="inline" id="M104"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The result is that the magnitude of <inline-formula id="pcbi.1006048.e105"><alternatives><graphic id="pcbi.1006048.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e105" xlink:type="simple"/><mml:math display="inline" id="M105"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> has a <inline-formula id="pcbi.1006048.e106"><alternatives><graphic id="pcbi.1006048.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e106" xlink:type="simple"/><mml:math display="inline" id="M106"><mml:mrow><mml:mi mathvariant="script">O</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> peak at a non-zero spatial frequency (<xref ref-type="fig" rid="pcbi.1006048.g006">Fig 6a</xref>, black), introducing a high-amplitude, non-monotonic rate profile (as in <xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5n</xref>; see [<xref ref-type="bibr" rid="pcbi.1006048.ref047">47</xref>] for a similar analysis). When <bold>X</bold>(<bold>x</bold>) has spatially broad features, <inline-formula id="pcbi.1006048.e107"><alternatives><graphic id="pcbi.1006048.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e107" xlink:type="simple"/><mml:math display="inline" id="M107"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> has little power at high spatial frequencies so that this amplification dynamic is weak or absent (as in <xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5h</xref>). An identical argument applies in orientation space. In summary, high-frequency components of external input profiles are transmitted more strongly than low-frequency components in strongly coupled networks, and the cutoff frequency is determined by the width (<italic>α</italic><sub><italic>E</italic></sub> or <italic>α</italic><sub><italic>I</italic></sub>) of lateral synaptic projections.</p>
<fig id="pcbi.1006048.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006048.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Spatial filtering of external input and the dependence of suppression on outgoing synaptic projection width.</title>
<p><bold>a)</bold> The magnitude of the spatial filter, <inline-formula id="pcbi.1006048.e108"><alternatives><graphic id="pcbi.1006048.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e108" xlink:type="simple"/><mml:math display="inline" id="M108"><mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mi>D</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, imposed by recurrent connections (purple), the external input (<inline-formula id="pcbi.1006048.e109"><alternatives><graphic id="pcbi.1006048.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e109" xlink:type="simple"/><mml:math display="inline" id="M109"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, green) and the resulting firing rate profile (<inline-formula id="pcbi.1006048.e110"><alternatives><graphic id="pcbi.1006048.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e110" xlink:type="simple"/><mml:math display="inline" id="M110"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, black) as a function of the spatial frequency, <inline-formula id="pcbi.1006048.e111"><alternatives><graphic id="pcbi.1006048.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e111" xlink:type="simple"/><mml:math display="inline" id="M111"><mml:mrow><mml:mrow><mml:mo>∥</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>∥</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msqrt><mml:mrow><mml:msup><mml:mi>m</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>n</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>, from the simulation in <xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5j–5o</xref>. Magnitude is measured by the Frobenius norm for <inline-formula id="pcbi.1006048.e112"><alternatives><graphic id="pcbi.1006048.e112g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e112" xlink:type="simple"/><mml:math display="inline" id="M112"><mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mi>D</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>. Curves normalized by their peaks. <bold>b)</bold> Firing rates of excitatory (red) and inhibitory (blue) neurons with receptive fields at the center of a grating stimulus plotted as the width of the stimulus increases (represented by increasing <italic>σ</italic><sub><italic>X</italic></sub>) using parameters from <xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5j–5o</xref>. <bold>c)</bold> Same as b, but the excitatory rate is plotted for different widths of the excitatory synaptic projection width, <italic>α</italic><sub><italic>E</italic></sub>. <bold>d)</bold> Same as c, but firing rates in L4 are shaped like a disc with radius <italic>σ</italic><sub><italic>X</italic></sub> instead of a Guassian with width parameter <italic>σ</italic><sub><italic>X</italic></sub>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006048.g006" xlink:type="simple"/>
</fig>
<p>It is worth noting that the average firing rates (over all orientations and spatial positions) are given by the zero Fourier coefficient <inline-formula id="pcbi.1006048.e113"><alternatives><graphic id="pcbi.1006048.e113g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e113" xlink:type="simple"/><mml:math display="inline" id="M113"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mn mathvariant="bold">0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. When balance is broken by sharp external input features, the zero Fourier mode is not affected as long as mean firing rates, <bold>r</bold>(<bold>x</bold>, <italic>θ</italic>), remain non-zero at all locations and orientations. Hence, sharp input features can break balance locally without breaking global, network-averaged, balance. This is analogous to the global balance obtained in the optogenetic example when local balance was broken at the level of subpopulations (<xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2</xref>).</p>
</sec>
<sec id="sec018">
<title>Implications of imbalanced amplification on receptive field tuning</title>
<p>We next considered a study by Adesnik et al. [<xref ref-type="bibr" rid="pcbi.1006048.ref048">48</xref>] in which drifting grating stimuli of varying sizes were presented to mice while recording from neurons in L2/3 of V1. In that study, pyramidal neurons’ firing rates first increased then decreased as the stimulus size was increased. On the other hand, somatostatin-expressing (SOM) neuron’s firing rates increased monotonically with stimulus size. Intracellular recordings combined with optogenetic stimulation in that study showed that SOM neurons project locally and pyramidal neurons form longer range projections.</p>
<p>To test our model against these findings, we applied <xref ref-type="disp-formula" rid="pcbi.1006048.e089">Eq (17)</xref> to a network with local inhibition and longer-range excitation (<italic>α</italic><sub><italic>E</italic></sub> &gt; <italic>α</italic><sub><italic>I</italic></sub>) with increasing size of a visual stimulus (increasing <italic>σ</italic><sub><italic>X</italic></sub>). Our results are consistent with recordings in Adesnik <italic>et al.</italic>, 2012 [<xref ref-type="bibr" rid="pcbi.1006048.ref048">48</xref>]: Excitatory neuron firing rates changed non-monotonically with stimulus size, while inhibitory neuron firing rates monotonically increased (<xref ref-type="fig" rid="pcbi.1006048.g006">Fig 6b</xref>). The non-monotonic dependence of excitatory firing rates on stimulus size in <xref ref-type="fig" rid="pcbi.1006048.g006">Fig 6b</xref> is explained by the mechanism of imbalanced amplification. When <italic>σ</italic><sub><italic>X</italic></sub> is sufficiently small, balance is broken so imbalanced amplification introduces a large peak firing rate surrounded by suppression (as in <xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5n</xref>). However, the total amount of external excitation introduced by the stimulus is proportional to the size of the stimulus, so a very small <italic>σ</italic><sub><italic>X</italic></sub> introduces very little excitation and peak firing rates are small. As <italic>σ</italic><sub><italic>X</italic></sub> increases, more excitation is recruited and the network is still imbalanced, which leads to increasingly large peak firing rates (as in <xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5n</xref>). Once <italic>σ</italic><sub><italic>X</italic></sub> becomes large, balance begins to be restored and the peak excitatory firing rate decreases to moderate values (as in <xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5h</xref>).</p>
<p>The degree to which excitatory neurons suppress depends on the spatial width, <italic>α</italic><sub><italic>E</italic></sub>, of lateral excitatory projections (<xref ref-type="fig" rid="pcbi.1006048.g006">Fig 6c</xref>) and suppression of inhibitory neurons similarly depends on the spatial width, <italic>α</italic><sub><italic>I</italic></sub>, of lateral inhibition (not pictured). Specifically, suppression occurs when lateral connectivity is broader than feedforward input (<italic>α</italic><sub><italic>E</italic></sub> &gt; <italic>β</italic><sub><italic>X</italic></sub> or <italic>α</italic><sub><italic>I</italic></sub> &gt; <italic>β</italic><sub><italic>X</italic></sub>) because this is when the balanced solution in <xref ref-type="disp-formula" rid="pcbi.1006048.e086">Eq (15)</xref> disappears. When a sub-population’s lateral connectivity is more localized than feedforward connectivity from L4 (<italic>α</italic><sub><italic>E</italic></sub> &lt; <italic>α</italic><sub><italic>X</italic></sub> as in the lightest gray curve in <xref ref-type="fig" rid="pcbi.1006048.g006">Fig 6c</xref>; or <italic>α</italic><sub><italic>I</italic></sub> &lt; <italic>α</italic><sub><italic>X</italic></sub>), that sub-population cannot exhibit suppression since feedforward input width (<inline-formula id="pcbi.1006048.e114"><alternatives><graphic id="pcbi.1006048.e114g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e114" xlink:type="simple"/><mml:math display="inline" id="M114"><mml:mrow><mml:msubsup><mml:mi>β</mml:mi> <mml:mi>X</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>α</mml:mi> <mml:mi>X</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>X</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>) is always larger than lateral connectivity, regardless of the stimulus size (<italic>σ</italic><sub><italic>X</italic></sub>).</p>
<p>A similar line of reasoning explains why peak inhibitory neuron firing rates increase monotonically with stimulus size in <xref ref-type="fig" rid="pcbi.1006048.g006">Fig 6b</xref>. Inhibitory neurons in that example project locally (<italic>α</italic><sub><italic>I</italic></sub> = <italic>α</italic><sub><italic>X</italic></sub>), so the inequality <italic>α</italic><sub><italic>I</italic></sub> &lt; <italic>β</italic><sub><italic>X</italic></sub> is always satisfied because <inline-formula id="pcbi.1006048.e115"><alternatives><graphic id="pcbi.1006048.e115g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e115" xlink:type="simple"/><mml:math display="inline" id="M115"><mml:mrow><mml:msub><mml:mi>β</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msqrt><mml:mrow><mml:msubsup><mml:mi>α</mml:mi> <mml:mi>X</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>X</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> whenever <italic>α</italic><sub><italic>I</italic></sub> ≤ <italic>α</italic><sub><italic>X</italic></sub>. Whenever <italic>α</italic><sub><italic>I</italic></sub> &lt; <italic>β</italic><sub><italic>X</italic></sub>, inhibitory firing rates reflect their balanced state values which increase monotonically with the increase in total excitation induced by a larger stimulus.</p>
<p>Unlike SOM neurons, parvalbumin-expressing (PV) neurons were found to exhibit suppression by Adesnik <italic>et al.</italic>, 2012 [<xref ref-type="bibr" rid="pcbi.1006048.ref048">48</xref>]. Hence, our theory predicts that PV neurons project more broadly in space than SOM neurons. Indeed, PV interneurons in L2/3 are primarily basket cells whose axons project to larger lateral distances than other inhibitory neuron subtypes such as Martinotti cells that comprise most SOM neurons [<xref ref-type="bibr" rid="pcbi.1006048.ref049">49</xref>].</p>
<p>We observed a unimodal dependence of firing rate on stimulus size (<xref ref-type="fig" rid="pcbi.1006048.g006">Fig 6c</xref>, all curves have a single peak). However, Rubin, <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1006048.ref047">47</xref>] observed a multi-modal, oscillatory dependence of firing rate on stimulus size in recordings and in a computational model. In that study, the drifting grating stimuli were disc-shaped with a sharp cutoff of contrast at the edges of the disc. Above, we considered a Gaussian-shaped contrast profile with soft edges (<xref ref-type="fig" rid="pcbi.1006048.g006">Fig 6c</xref>, inset). Repeating our calculations with a sharp-edged, disc-shaped stimulus (<xref ref-type="fig" rid="pcbi.1006048.g006">Fig 6d</xref>, inset) produced an oscillatory dependence of firing rate on stimulus size (<xref ref-type="fig" rid="pcbi.1006048.g006">Fig 6d</xref>), as observed by Rubin <italic>et al.</italic>. This oscillation only arose when lateral synaptic projections were narrower than the stimulus size (<italic>α</italic><sub><italic>E</italic></sub> small). The oscillation results from a Gibbs phenomenon: The sharp edge in the stimulus produces high-frequency power in <inline-formula id="pcbi.1006048.e116"><alternatives><graphic id="pcbi.1006048.e116g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e116" xlink:type="simple"/><mml:math display="inline" id="M116"><mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, which passes through the high-pass filter <inline-formula id="pcbi.1006048.e117"><alternatives><graphic id="pcbi.1006048.e117g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e117" xlink:type="simple"/><mml:math display="inline" id="M117"><mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mi>D</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> when <italic>α</italic><sub><italic>E</italic></sub> is small.</p>
<p>We next explored the functional consequences of these results on receptive field tuning. We first considered a disc-shaped grating stimulus (<xref ref-type="fig" rid="pcbi.1006048.g007">Fig 7a</xref>), producing a disc-shaped firing rate profile in L4 (<xref ref-type="fig" rid="pcbi.1006048.g007">Fig 7b</xref>). Synaptic divergence causes the profile of synaptic input from L4 to L2/3 to be “blurred” at the edges (<xref ref-type="fig" rid="pcbi.1006048.g007">Fig 7c</xref>), as quantified by the low-pass filter, <inline-formula id="pcbi.1006048.e118"><alternatives><graphic id="pcbi.1006048.e118g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e118" xlink:type="simple"/><mml:math display="inline" id="M118"><mml:msub><mml:mi mathvariant="script">W</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. This illustrates a fundamental problem in receptive field tuning: Synaptic divergence from one layer to another implements a low-pass filter that blurs sharp features. This problem is resolved by our observation above that lateral, recurrent connectivity implements a high-pass filter. If the width of lateral, excitatory connections in L2/3 is similar to that of feedforward connections from L4, the high-pass filter implemented by the recurrent network cancels the low-pass filter implemented by feedforward connectivity, effectively implementing a deconvolution that can recover the sharpness of firing rate profiles in L4 (<xref ref-type="fig" rid="pcbi.1006048.g007">Fig 7d–7f</xref>). Hence, counterintuitively, <italic>broader</italic> lateral excitation actually <italic>sharpens</italic> receptive field tuning. Broadening lateral connections further increases the sharpness of the firing rate profiles, but introduce oscillatory, Gibbs phenomena near sharp features (<xref ref-type="fig" rid="pcbi.1006048.g007">Fig 7f</xref>). These points are illustrated more clearly in an example with an asymmetrically shaped stimulus (<xref ref-type="fig" rid="pcbi.1006048.g007">Fig 7g–7l</xref>). Hence, the high-pass filter described above corrects the blurring caused by synaptic divergence between layers in V1.</p>
<fig id="pcbi.1006048.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006048.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Imbalanced amplification and suppression reverse the blurring introduced by interlaminar synaptic divergence.</title>
<p><bold>a)</bold> A disc-shaped grating stimulus gives rise to <bold>b)</bold> a disc-shaped firing rate profile, <italic>r</italic><sub><italic>X</italic></sub>(<bold>x</bold>), in L4 with slightly blurred edges (achieved by convolving contrast from a with a Gaussian kernel). <bold>c)</bold> Input, <italic>X</italic><sub><italic>E</italic></sub>(<bold>x</bold>), from L4 to excitatory neurons in L2/3 is blurred by synaptic divergence, which effectively applies a low-pass filter, <inline-formula id="pcbi.1006048.e119"><alternatives><graphic id="pcbi.1006048.e119g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e119" xlink:type="simple"/><mml:math display="inline" id="M119"><mml:msub><mml:mi mathvariant="script">W</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, to the L4 rates. <bold>d)</bold> Excitatory firing rates in L2/3 are sharper than external input when lateral excitation is similar, but smaller, in width than interlaminar excitation (<italic>α</italic><sub><italic>E</italic></sub> = 0.85<italic>α</italic><sub><italic>X</italic></sub>). <bold>e)</bold> Same as c, but lateral excitation is exactly as broad as interlaminar excitation (<italic>α</italic><sub><italic>E</italic></sub> = <italic>α</italic><sub><italic>X</italic></sub>), which sharpens the edges further, making firing rates in L2/3 similar to those in L4. <bold>f)</bold> Same as c, but lateral excitation is broader than interlaminar excitation (<italic>α</italic><sub><italic>E</italic></sub> = 1.1<italic>α</italic><sub><italic>X</italic></sub>), which sharpens the edges even further, but also introduced suppressed regions due to Gibbs phenomena. <bold>g-l)</bold> Same as a-f, but contrast was determined by the brightness of a photograph. Horizontal and vertical axes are neurons’ receptive fields.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006048.g007" xlink:type="simple"/>
</fig>
<p>In summary, imbalanced amplification and linear rate models provide a concise and parsimonious theoretical basis for understanding how suppression, amplification and tuning depends on the profile of neuron’s incoming and outgoing synaptic projections in physical and orientation tuning space.</p>
</sec>
</sec>
</sec>
<sec id="sec019" sec-type="conclusions">
<title>Discussion</title>
<p>We described a theory of amplification in cortical circuits arising from a local imbalance that occurs when recurrent connectivity structure cannot cancel feedforward input. We showed that this imbalanced amplification is evoked by optogenetic stimuli in somatosensory cortex and sensory stimuli in visual cortex, since these stimuli cannot be canceled by the connectivity structure in those areas. Our theoretical analysis of imbalanced amplification explains several observations from cortical recordings in those areas.</p>
<p>Even though firing rates in balanced networks in the large <italic>N</italic> limit do not depend on neurons’ f-I curves (see <xref ref-type="disp-formula" rid="pcbi.1006048.e008">Eq (3)</xref>), quantifying firing rates under imbalanced amplification relies on a finite size correction that requires an assumption on how firing rates depend on neurons’ input. For simplicity, we used an approximation that assumes populations’ mean firing rates depend linearly on their average input currents, giving rise to Eqs <xref ref-type="disp-formula" rid="pcbi.1006048.e010">(4)</xref> and <xref ref-type="disp-formula" rid="pcbi.1006048.e089">(17)</xref>. In reality, neurons’ firing rates depend nonlinearly on their mean input currents, and also depend on higher moments of their input currents. However, the salient effects of imbalanced amplification are not sensitive to our assumption of linearity. For instance, <xref ref-type="disp-formula" rid="pcbi.1006048.e019">Eq (5)</xref>, which quantifies the strong synaptic currents evoked under imbalanced amplification, does not depend on any assumption about neurons’ f-I curves. However, the precise value of the firing rates elicited by this strong input does depend on neurons’ f-I curves. We found that the linear approximation to f-I curves in Eqs <xref ref-type="disp-formula" rid="pcbi.1006048.e010">(4)</xref> and <xref ref-type="disp-formula" rid="pcbi.1006048.e089">(17)</xref> performed well at approximating firing rates in our spiking network simulations and also explained several observations from cortical recordings. This may be partly explained due to the fact that our spiking network simulations used neuron models that exhibit spike frequency adaptation, which is known to linearize f-I curves [<xref ref-type="bibr" rid="pcbi.1006048.ref050">50</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref051">51</xref>] and help networks maintain balance [<xref ref-type="bibr" rid="pcbi.1006048.ref010">10</xref>]. However, the linear approximation we used cannot explain some phenomena that rely on thresholding and other nonlinear transfer properties [<xref ref-type="bibr" rid="pcbi.1006048.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref052">52</xref>]. The notion of imbalanced amplification extends naturally to models with nonlinear transfer functions and future work will consider the implications of nonlinearities.</p>
<p>Balanced networks are related to, but distinct from, inhibitory stabilized networks (ISNs) [<xref ref-type="bibr" rid="pcbi.1006048.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref053">53</xref>] and stabilized supralinear networks that can transition between ISN and non-ISN regimes [<xref ref-type="bibr" rid="pcbi.1006048.ref047">47</xref>]. The primary distinction is that ISNs are defined by moderately strong recurrent excitation (strong <italic>E</italic> → <italic>E</italic>) whereas balanced networks are defined by very strong external, feedforward excitation (strong <italic>X</italic> → <italic>E</italic>) canceled by similarly strong net-inhibitory recurrent connectivity. Classical balanced networks are necessarily inhibitory stabilized at sufficiently large <italic>N</italic> (small <italic>ϵ</italic>) unless <italic>w</italic><sub><italic>EE</italic></sub> = 0. However, strongly coupled (approximately balanced) networks can be non-ISN at moderately large <italic>N</italic> (small <italic>ϵ</italic>) if <italic>w</italic><sub><italic>EE</italic></sub> is small. Cat V1 is believed to be inhibitory stabilized, which can be used to explain its surround suppression dynamic [<xref ref-type="bibr" rid="pcbi.1006048.ref002">2</xref>]. However, evidence from optogenetic and electrophysiological studies, suggests that mouse L2/3 V1 might not be inhibitory stabilized: Lateral connection probability is small between pyramidal neurons (small <italic>w</italic><sub><italic>EE</italic></sub>) [<xref ref-type="bibr" rid="pcbi.1006048.ref049">49</xref>], stimulation of PV neurons does not produce the paradoxical effects that characterize ISNs [<xref ref-type="bibr" rid="pcbi.1006048.ref054">54</xref>], and modulating pyramidal neuron firing rates only weakly modulates excitatory synaptic currents in local pyramidal neurons [<xref ref-type="bibr" rid="pcbi.1006048.ref048">48</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref054">54</xref>]. Nonetheless, pyramidal neurons and PV neurons in mouse V1 exhibit surround suppression [<xref ref-type="bibr" rid="pcbi.1006048.ref048">48</xref>], which we showed is explained by imbalanced amplification.</p>
<p>Despite the similarity in their names, the mechanism of imbalanced amplification studied here is fundamentally different from the mechanism of balanced amplification [<xref ref-type="bibr" rid="pcbi.1006048.ref055">55</xref>]. First, imbalanced amplification is related to steady-state firing rates, while balanced amplification is a dynamical phenomenon. Moreover, balanced amplification is intrinsic to the local, recurrent circuit: It produces large firing rate transients when local, recurrent inhibition is inefficient at canceling local, recurrent excitation. Imbalanced amplification, on the other hand, produces large steady state firing rates when local, recurrent input is unable to effectively cancel feedforward, external excitation.</p>
<p>The analysis of our spatially extended network model relied on an assumption of periodic boundaries in space, which are not biologically realistic, but approximate networks with more realistic boundary conditions [<xref ref-type="bibr" rid="pcbi.1006048.ref008">8</xref>]. Without periodic boundary conditions, the integral eqs <xref ref-type="disp-formula" rid="pcbi.1006048.e058">(10)</xref>, <xref ref-type="disp-formula" rid="pcbi.1006048.e064">(11)</xref> and <xref ref-type="disp-formula" rid="pcbi.1006048.e088">(16)</xref> are equally valid, but the integrals are defined by regular convolutions in space instead of circular convolutions. As a result, the spatial Fourier modes do not de-couple, so Eqs <xref ref-type="disp-formula" rid="pcbi.1006048.e066">(12)</xref>, <xref ref-type="disp-formula" rid="pcbi.1006048.e073">(13)</xref> and <xref ref-type="disp-formula" rid="pcbi.1006048.e089">(17)</xref> are no longer valid, though they should still offer a good approximation when connectivity is much narrower than the the spatial domain [<xref ref-type="bibr" rid="pcbi.1006048.ref008">8</xref>]. In addition, anisotropic connectivity statistics, arising for example from tuning dependent connectivity in visual cortical circuits with coherent orientation maps [<xref ref-type="bibr" rid="pcbi.1006048.ref056">56</xref>], would prevent the integral operator in Eqs <xref ref-type="disp-formula" rid="pcbi.1006048.e058">(10)</xref>, <xref ref-type="disp-formula" rid="pcbi.1006048.e064">(11)</xref> and <xref ref-type="disp-formula" rid="pcbi.1006048.e088">(16)</xref> from being a convolution operator, and therefore preclude the use of Fourier series for the solution. Future work will consider the effects of non-periodic boundaries and non-convolutional connectivity kernels on spatially extended balanced networks.</p>
<p>We only considered neuron models with current-based synaptic input. In <xref ref-type="supplementary-material" rid="pcbi.1006048.s002">S2 Text</xref>, we show that our numerical results and analysis extend naturally to models with more realistic conductance-based synapses. The analysis makes use of an approximation that relates a conductance-based model to a current-based model with similar membrane potential statistics [<xref ref-type="bibr" rid="pcbi.1006048.ref057">57</xref>–<xref ref-type="bibr" rid="pcbi.1006048.ref059">59</xref>].</p>
<p>We focused on firing rates, but sensory coding also depends on variability and correlations in neurons’ spike trains. Our previous work derived the structure of correlated variability in heterogeneous and spatially extended balanced networks when connectivity structure prevents positive and negative correlations from cancelling, effectively providing an analogous theory of imbalanced amplification of correlated variability [<xref ref-type="bibr" rid="pcbi.1006048.ref012">12</xref>]. Combining those findings with the theory of steady-state firing rates presented here could yield a more complete theory of neural coding in cortical circuits and the effects of imbalanced amplification on coding.</p>
</sec>
<sec id="sec020" sec-type="materials|methods">
<title>Materials and methods</title>
<p>We modeled recurrently connected networks with <italic>N</italic> neurons, composed of <italic>N</italic><sub><italic>E</italic></sub> = 0.8<italic>N</italic> excitatory and <italic>N</italic><sub><italic>I</italic></sub> = 0.2<italic>N</italic> inhibitory neurons. The recurrent network receives external input from a network of <italic>N</italic><sub><italic>X</italic></sub> neurons that drive the recurrent network. The membrane potential of neuron <italic>j</italic> from the excitatory (<italic>a</italic> = <italic>E</italic>) or inhibitory (<italic>a</italic> = <italic>I</italic>) population has Adaptive Exponential integrate-and-fire dynamics,
<disp-formula id="pcbi.1006048.e120"><alternatives><graphic id="pcbi.1006048.e120g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e120" xlink:type="simple"/><mml:math display="block" id="M120"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi>j</mml:mi> <mml:mi>a</mml:mi></mml:msubsup></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>L</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>V</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mi>L</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>L</mml:mi></mml:msub> <mml:msub><mml:mo>Δ</mml:mo> <mml:mi>T</mml:mi></mml:msub> <mml:mtext>exp</mml:mtext> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>V</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>T</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mo>Δ</mml:mo> <mml:mi>T</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>I</mml:mi> <mml:mi>j</mml:mi> <mml:mi>a</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>w</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>τ</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>w</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>w</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Whenever <inline-formula id="pcbi.1006048.e121"><alternatives><graphic id="pcbi.1006048.e121g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e121" xlink:type="simple"/><mml:math display="inline" id="M121"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi> <mml:mi>j</mml:mi> <mml:mi>a</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mtext>th</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, a spike is recorded, the membrane potential is held for a refractory period <italic>τ</italic><sub>ref</sub> then reset to a fixed value <italic>V</italic><sub>re</sub>, and <italic>w</italic> is incremented by <italic>B</italic>. Neuron model parameters for all simulations were <italic>τ</italic><sub><italic>m</italic></sub> = <italic>C</italic><sub><italic>m</italic></sub>/<italic>g</italic><sub><italic>L</italic></sub> = 15ms, <italic>E</italic><sub><italic>L</italic></sub> = −72mV, <italic>V</italic><sub><italic>T</italic></sub> = −60mV, <italic>V</italic><sub>th</sub> = −15mV, Δ<sub><italic>T</italic></sub> = 1.5mV, <italic>V</italic><sub>re</sub> = −72mV, <italic>τ</italic><sub>ref</sub> = 1ms, <italic>τ</italic><sub><italic>w</italic></sub> = 150ms and <italic>B</italic> = <italic>C</italic><sub><italic>m</italic></sub>0.267 mV/ms. We write all currents in terms of <italic>C</italic><sub><italic>m</italic></sub>, so <italic>C</italic><sub><italic>m</italic></sub> can be any constant. Membrane potentials were also bounded below by <italic>V</italic><sub><italic>lb</italic></sub> = −100mV. Synaptic input currents were defined by
<disp-formula id="pcbi.1006048.e122"><alternatives><graphic id="pcbi.1006048.e122g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e122" xlink:type="simple"/><mml:math display="block" id="M122"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi> <mml:mi>j</mml:mi> <mml:mi>a</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>X</mml:mi> <mml:mi>j</mml:mi> <mml:mi>a</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>R</mml:mi> <mml:mi>j</mml:mi> <mml:mi>a</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:msub><mml:mi>C</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
where <inline-formula id="pcbi.1006048.e123"><alternatives><graphic id="pcbi.1006048.e123g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e123" xlink:type="simple"/><mml:math display="inline" id="M123"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi> <mml:mi>j</mml:mi> <mml:mi>a</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the feedforward input and <inline-formula id="pcbi.1006048.e124"><alternatives><graphic id="pcbi.1006048.e124g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e124" xlink:type="simple"/><mml:math display="inline" id="M124"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi> <mml:mi>j</mml:mi> <mml:mi>a</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> the recurrent input to neuron <italic>j</italic> in population <italic>a</italic> = <italic>E</italic>, <italic>I</italic>. The recurrent input was defined by
<disp-formula id="pcbi.1006048.e125"><alternatives><graphic id="pcbi.1006048.e125g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e125" xlink:type="simple"/><mml:math display="block" id="M125"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi> <mml:mi>j</mml:mi> <mml:mi>a</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi></mml:mrow></mml:munder> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mi>b</mml:mi></mml:msub></mml:munderover> <mml:msubsup><mml:mi>J</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msubsup> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:msub><mml:mi>η</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mi>n</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1006048.e126"><alternatives><graphic id="pcbi.1006048.e126g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e126" xlink:type="simple"/><mml:math display="inline" id="M126"><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>n</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is the <italic>n</italic>th spike time of neuron <italic>k</italic> in population <italic>b</italic> = <italic>E</italic>, <italic>I</italic>. The external input to the recurrent network is defined similarly by
<disp-formula id="pcbi.1006048.e127"><alternatives><graphic id="pcbi.1006048.e127g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e127" xlink:type="simple"/><mml:math display="block" id="M127"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi> <mml:mi>j</mml:mi> <mml:mi>a</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:munderover> <mml:msubsup><mml:mi>J</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>X</mml:mi></mml:mrow></mml:msubsup> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:msub><mml:mi>η</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mi>n</mml:mi> <mml:mrow><mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula>
where <inline-formula id="pcbi.1006048.e128"><alternatives><graphic id="pcbi.1006048.e128g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e128" xlink:type="simple"/><mml:math display="inline" id="M128"><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>n</mml:mi> <mml:mrow><mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is the <italic>n</italic>th spike time of neuron <italic>k</italic> = 1, …, <italic>N</italic><sub><italic>X</italic></sub> in population <italic>X</italic>. Each coefficient, <inline-formula id="pcbi.1006048.e129"><alternatives><graphic id="pcbi.1006048.e129g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e129" xlink:type="simple"/><mml:math display="inline" id="M129"><mml:msubsup><mml:mi>J</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, represents the synaptic weight from presynaptic neuron <italic>k</italic> in population <italic>b</italic> to postsynaptic neuron <italic>j</italic> in population <italic>a</italic>. For all simulations, we modeled synaptic kinetics using <italic>η</italic><sub><italic>b</italic></sub>(<italic>t</italic>) = exp(−<italic>t</italic>/<italic>τ</italic><sub><italic>b</italic></sub>)/<italic>τ</italic><sub><italic>b</italic></sub> for <italic>t</italic> &gt; 0 where <italic>τ</italic><sub><italic>E</italic></sub> = 8ms, <italic>τ</italic><sub><italic>I</italic></sub> = 4ms, and <italic>τ</italic><sub><italic>X</italic></sub> = 10ms. Note that the integral of <italic>η</italic><sub><italic>b</italic></sub>(<italic>t</italic>) over time is equal to 1 for all three kernels, so the choice of time constant, <italic>τ</italic><sub><italic>b</italic></sub>, does not effect time-averaged synaptic currents. We used <italic>τ</italic><sub><italic>I</italic></sub> &lt; <italic>τ</italic><sub><italic>E</italic></sub> &lt; <italic>τ</italic><sub><italic>X</italic></sub> to prevent excessive synchronous events that break the balanced state. While inhibition may be faster than excitation in many cortical circuits, excitatory neurons are more likely to contact distal dendrites and inhibitory neurons are more likely to contact the soma [<xref ref-type="bibr" rid="pcbi.1006048.ref060">60</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref061">61</xref>], which could make inhibition functionally faster than excitation. In any case, using fast inhibition is common practice in spiking network simulations with strong or dense connectivity [<xref ref-type="bibr" rid="pcbi.1006048.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref062">62</xref>, <xref ref-type="bibr" rid="pcbi.1006048.ref063">63</xref>] and a complete resolution of this issue is outside the scope of this study.</p>
<p>In Figs <xref ref-type="fig" rid="pcbi.1006048.g001">1</xref>, <xref ref-type="fig" rid="pcbi.1006048.g002">2</xref> and <xref ref-type="fig" rid="pcbi.1006048.g003">3</xref> an extra term, <italic>S</italic> = 2 mV/ms, was added to <inline-formula id="pcbi.1006048.e130"><alternatives><graphic id="pcbi.1006048.e130g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e130" xlink:type="simple"/><mml:math display="inline" id="M130"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi> <mml:mi>j</mml:mi> <mml:mi>E</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for stimulated neurons during the second half of the simulation to model optogenetic stimulation. We used <italic>N</italic><sub><italic>E</italic></sub> = 4000, <italic>N</italic><sub><italic>I</italic></sub> = 1000 and <italic>N</italic><sub><italic>X</italic></sub> = 4000 (so <italic>N</italic> = 5000) except for <xref ref-type="fig" rid="pcbi.1006048.g001">Fig 1f</xref> where all <italic>N</italic><sub><italic>b</italic></sub> values were scaled. Connections were drawn randomly with connection probabilities <italic>p</italic><sub><italic>EE</italic></sub> = <italic>p</italic><sub><italic>IE</italic></sub> = <italic>p</italic><sub><italic>IX</italic></sub> = 0.1, <italic>p</italic><sub><italic>EI</italic></sub> = <italic>p</italic><sub><italic>II</italic></sub> = <italic>p</italic><sub><italic>EX</italic></sub> = 0.2. Specifically, for each neuron in presynaptic population <italic>b</italic> = <italic>E</italic>, <italic>I</italic>, <italic>X</italic>, we sampled <italic>p</italic><sub><italic>ab</italic></sub> <italic>N</italic><sub><italic>a</italic></sub> postsynaptic targets from population <italic>a</italic> = <italic>E</italic>, <italic>I</italic> randomly and uniformly with replacement. Since outgoing connections were sampled with replacement, some neurons connected multiple times to other neurons. Synaptic weights were then defined by
<disp-formula id="pcbi.1006048.e131"><alternatives><graphic id="pcbi.1006048.e131g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e131" xlink:type="simple"/><mml:math display="block" id="M131"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>#</mml:mo> <mml:mspace width="4.pt"/><mml:mtext>of</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>contacts</mml:mtext> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>J</italic><sub><italic>EE</italic></sub> = 0.4mV, <italic>J</italic><sub><italic>IE</italic></sub> = 0.83 mV, <italic>J</italic><sub><italic>II</italic></sub> = <italic>J</italic><sub><italic>EI</italic></sub> = −1.67 mV, <italic>J</italic><sub><italic>EX</italic></sub> = <italic>J</italic><sub><italic>IX</italic></sub> = 0.47 mV. This gives postsynaptic potential amplitudes between 0.19 and 1.0 mV. For Figs <xref ref-type="fig" rid="pcbi.1006048.g001">1f</xref> and <xref ref-type="fig" rid="pcbi.1006048.g004">4</xref>, the values of <italic>J</italic><sub><italic>ab</italic></sub> and the values of <italic>p</italic><sub><italic>ab</italic></sub> were each multiplied by (5000/<italic>N</italic>)<sup>1/4</sup> so that they were unchanged at <italic>N</italic> = 5000 and so that <inline-formula id="pcbi.1006048.e132"><alternatives><graphic id="pcbi.1006048.e132g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e132" xlink:type="simple"/><mml:math display="inline" id="M132"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mo>∼</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msqrt><mml:mi>N</mml:mi></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>. This is slightly different from the more common practice of fixing small connection probabilities and scaling <italic>J</italic><sub><italic>ab</italic></sub> like <inline-formula id="pcbi.1006048.e133"><alternatives><graphic id="pcbi.1006048.e133g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e133" xlink:type="simple"/><mml:math display="inline" id="M133"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msqrt><mml:mi>N</mml:mi></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>. We instead fixed a relatively dense connectivity at <italic>N</italic> = 5000 and the network became increasingly sparse and weakly connected at increased <italic>N</italic>. Both approaches have the same mean-field (since the mean-field only depends on the product of <italic>p</italic><sub><italic>ab</italic></sub> and <italic>J</italic><sub><italic>ab</italic></sub>), but our approach prevents excessively small synaptic weights at large <italic>N</italic> and prevents dense connectivity at large <italic>N</italic>, which is computationally expensive and susceptible to oscillatory and synchronous spiking.</p>
<p>Spike times in the external population were modeled as independent Poisson processes with <italic>r</italic><sub><italic>X</italic></sub> = 5 Hz. In <xref ref-type="fig" rid="pcbi.1006048.g003">Fig 3</xref>, external input to the L5 population was created using the spike times of excitatory neurons from the simulations in <xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2</xref>. Simulations for <xref ref-type="fig" rid="pcbi.1006048.g004">Fig 4</xref> were identical to those in Figs <xref ref-type="fig" rid="pcbi.1006048.g002">2</xref> and <xref ref-type="fig" rid="pcbi.1006048.g003">3</xref> except there were <italic>N</italic> = 2 × 10<sup>4</sup> neurons in the L2/3 model, synaptic weights to neurons in that population were multiplied by <inline-formula id="pcbi.1006048.e134"><alternatives><graphic id="pcbi.1006048.e134g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e134" xlink:type="simple"/><mml:math display="inline" id="M134"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>, and connections probabilities were also multiplied by <inline-formula id="pcbi.1006048.e135"><alternatives><graphic id="pcbi.1006048.e135g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e135" xlink:type="simple"/><mml:math display="inline" id="M135"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>. Hence, in relation to <xref ref-type="fig" rid="pcbi.1006048.g002">Fig 2</xref>, <italic>N</italic> was increased by a factor of four and <italic>ϵ</italic> was halved.</p>
<p>Simulations for <xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5</xref> used algorithms adapted from previous work [<xref ref-type="bibr" rid="pcbi.1006048.ref012">12</xref>]. The recurrent network (L2/3) contained <italic>N</italic> = 2 × 10<sup>5</sup> AdEx model neurons, <italic>N</italic><sub><italic>E</italic></sub> = 1.6 × 10<sup>5</sup> of which were excitatory and <italic>N</italic><sub><italic>I</italic></sub> = 4 × 10<sup>4</sup> inhibitory. Excitatory and inhibitory neurons in L2/3 were arranged on a uniform grid covering the unit square [0, 1] × [0, 1] (arbitrary spatial units). The external population (L4) contained <italic>N</italic><sub><italic>X</italic></sub> = 1.6 × 10<sup>5</sup> neurons arranged on an identical, parallel square. Each neuron in each population was assigned a preferred orientation chosen randomly and uniformly from 0 to 180°. Connections were chosen randomly as above, but connection probabilities depended on the neurons’ distances in physical and orientation tuning space. Specifically, the connection probability from a neuron in population <italic>b</italic> = <italic>E</italic>, <italic>I</italic>, <italic>X</italic> at coordinates <bold>x</bold> = (<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>) to a neuron in population <italic>a</italic> = <italic>E</italic>, <italic>I</italic> at coordinates <bold>y</bold> = (<italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>) was
<disp-formula id="pcbi.1006048.e136"><alternatives><graphic id="pcbi.1006048.e136g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e136" xlink:type="simple"/><mml:math display="block" id="M136"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>,</mml:mo> <mml:mi>d</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mover><mml:mi>p</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mi>G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>;</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>d</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>/</mml:mo> <mml:mn>180</mml:mn> <mml:mo>°</mml:mo> <mml:mo>;</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>dθ</italic> is the difference between neurons’ preferred orientation,
<disp-formula id="pcbi.1006048.e137"><alternatives><graphic id="pcbi.1006048.e137g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e137" xlink:type="simple"/><mml:math display="block" id="M137"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo>;</mml:mo> <mml:mi>α</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:msqrt> <mml:mi>α</mml:mi></mml:mrow></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>∞</mml:mi></mml:munderover> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msup><mml:mi>u</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>/</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:msup><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
is a one-dimensional wrapped Gaussian and <italic>G</italic>(<bold>u</bold>; <italic>α</italic>) = <italic>g</italic>(<italic>u</italic><sub>1</sub>; <italic>α</italic>)<italic>g</italic>(<italic>u</italic><sub>2</sub>; <italic>α</italic>) is a two dimensional wrapped Gaussian. The connection probability averaged over all distances is <inline-formula id="pcbi.1006048.e138"><alternatives><graphic id="pcbi.1006048.e138g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e138" xlink:type="simple"/><mml:math display="inline" id="M138"><mml:msub><mml:mover><mml:mi>p</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, which were chosen to be the same as in previous figures, <inline-formula id="pcbi.1006048.e139"><alternatives><graphic id="pcbi.1006048.e139g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e139" xlink:type="simple"/><mml:math display="inline" id="M139"><mml:mrow><mml:msub><mml:mover><mml:mi>p</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover><mml:mi>p</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>I</mml:mi> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover><mml:mi>p</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>I</mml:mi> <mml:mi>X</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006048.e140"><alternatives><graphic id="pcbi.1006048.e140g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e140" xlink:type="simple"/><mml:math display="inline" id="M140"><mml:mrow><mml:msub><mml:mover><mml:mi>p</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover><mml:mi>p</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>I</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover><mml:mi>p</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>X</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. As above, outgoing connections were chosen with replacement, so some neurons made multiple contacts onto other neurons. Connection widths in physical space were <italic>α</italic><sub><italic>E</italic></sub> = 0.15 and <italic>α</italic><sub><italic>I</italic></sub> = <italic>α</italic><sub><italic>X</italic></sub> = 0.04 (as measured on the unit square). Connection widths in orientation space were <italic>α</italic><sub><italic>E</italic>,<italic>θ</italic></sub> = <italic>α</italic><sub><italic>E</italic>,<italic>θ</italic></sub> = 0.1 and <italic>α</italic><sub><italic>X</italic>,<italic>θ</italic></sub> = 0.125 (corresponding to widths of 18° and 22.5° when measured in degrees). Connection strengths, <italic>J</italic><sub><italic>ab</italic></sub>, were the same as in Figs <xref ref-type="fig" rid="pcbi.1006048.g001">1</xref>, <xref ref-type="fig" rid="pcbi.1006048.g002">2</xref> and <xref ref-type="fig" rid="pcbi.1006048.g003">3</xref> except multiplied by a factor of 1.2. Each neuron in L4 was modeled as a Poisson process with rate given by
<disp-formula id="pcbi.1006048.e141"><alternatives><graphic id="pcbi.1006048.e141g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e141" xlink:type="simple"/><mml:math display="block" id="M141"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mover><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <bold>x</bold> is the location of the neuron, <italic>θ</italic> is its preferred orientation,
<disp-formula id="pcbi.1006048.e142"><alternatives><graphic id="pcbi.1006048.e142g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e142" xlink:type="simple"/><mml:math display="block" id="M142"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>c</mml:mi> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>c</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>;</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
and
<disp-formula id="pcbi.1006048.e143"><alternatives><graphic id="pcbi.1006048.e143g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e143" xlink:type="simple"/><mml:math display="block" id="M143"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mn>180</mml:mn> <mml:mo>°</mml:mo> <mml:mo>;</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>X</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
This models a stimulus with orientation <italic>θ</italic><sub>0</sub> = 0.5 (representing 90°) and centered at spatial coordinates <bold>x</bold><sub>0</sub> = (0.5, 0.5). The parameters <italic>σ</italic><sub><italic>X</italic></sub> and <italic>σ</italic><sub><italic>X</italic>,<italic>θ</italic></sub> quantify the width of L4 firing rates in physical and orientation space. For all panels in <xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5</xref>, we used <italic>σ</italic><sub><italic>X</italic>,<italic>θ</italic></sub> = 0.1 (width 18°) and <italic>c</italic><sub><italic>θ</italic></sub> = 0.75. We used <italic>σ</italic><sub><italic>X</italic></sub> = 0.2 for <xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5d–5i</xref> and <italic>σ</italic><sub><italic>X</italic></sub> = 0.06 for <xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5j–5o</xref>. In both cases, we chose <inline-formula id="pcbi.1006048.e144"><alternatives><graphic id="pcbi.1006048.e144g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e144" xlink:type="simple"/><mml:math display="inline" id="M144"><mml:msub><mml:mover><mml:mi>r</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <italic>c</italic> so that the minimum and maximum of <italic>r</italic><sub><italic>X</italic>,<italic>x</italic></sub>(<bold>x</bold>) were 10 and 20 Hz respectively.</p>
<p>For the spatially extended network, the connectivity kernels, <inline-formula id="pcbi.1006048.e145"><alternatives><graphic id="pcbi.1006048.e145g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e145" xlink:type="simple"/><mml:math display="inline" id="M145"><mml:mi mathvariant="script">W</mml:mi></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006048.e146"><alternatives><graphic id="pcbi.1006048.e146g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e146" xlink:type="simple"/><mml:math display="inline" id="M146"><mml:msub><mml:mi mathvariant="script">W</mml:mi> <mml:mi>X</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, are defined in Results where <italic>w</italic><sub><italic>ab</italic></sub>(<bold>x</bold>, <italic>θ</italic>) = <italic>J</italic><sub><italic>ab</italic></sub><italic>N</italic><sub><italic>b</italic></sub><italic>p</italic><sub><italic>ab</italic></sub>(<bold>x</bold>, <italic>θ</italic>)/(<italic>J</italic><sub><italic>EXpEX</italic></sub><italic>N</italic><sub><italic>X</italic></sub>). The Fourier series in physical and orientation tuning space is defined by
<disp-formula id="pcbi.1006048.e147"><alternatives><graphic id="pcbi.1006048.e147g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e147" xlink:type="simple"/><mml:math display="block" id="M147"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">u</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mspace width="0.277778em"/><mml:mpadded width="-3pt"><mml:mo>∫</mml:mo></mml:mpadded> <mml:mpadded width="-3pt"><mml:mo>∫</mml:mo></mml:mpadded> <mml:mspace width="0.277778em"/></mml:mrow> <mml:mi mathvariant="bold">u</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>·</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>+</mml:mo> <mml:mi>k</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mi>d</mml:mi> <mml:mi mathvariant="bold">x</mml:mi> <mml:mi>d</mml:mi> <mml:mi>θ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where the triple integral is over the two dimensions of physical space and one dimensional orientation space. The Fourier series of the convolution kernels defined above turns convolution into multiplication in the Fourier domain, from which <xref ref-type="disp-formula" rid="pcbi.1006048.e058">Eq (10)</xref> gives <inline-formula id="pcbi.1006048.e148"><alternatives><graphic id="pcbi.1006048.e148g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e148" xlink:type="simple"/><mml:math display="inline" id="M148"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">I</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mover accent="true"><mml:mi mathvariant="bold">r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> where <inline-formula id="pcbi.1006048.e149"><alternatives><graphic id="pcbi.1006048.e149g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e149" xlink:type="simple"/><mml:math display="inline" id="M149"><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1006048.e150"><alternatives><graphic id="pcbi.1006048.e150g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e150" xlink:type="simple"/><mml:math display="inline" id="M150"><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006048.e151"><alternatives><graphic id="pcbi.1006048.e151g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e151" xlink:type="simple"/><mml:math display="inline" id="M151"><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>X</mml:mi></mml:msub></mml:math></alternatives></inline-formula> are defined in Results with <inline-formula id="pcbi.1006048.e152"><alternatives><graphic id="pcbi.1006048.e152g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e152" xlink:type="simple"/><mml:math display="inline" id="M152"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mover><mml:mi>w</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo form="prefix">exp</mml:mo> <mml:mo>[</mml:mo> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:msup><mml:mi>π</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mi>α</mml:mi> <mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mi>α</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mo>)</mml:mo> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1006048.e153"><alternatives><graphic id="pcbi.1006048.e153g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e153" xlink:type="simple"/><mml:math display="inline" id="M153"><mml:mrow><mml:msub><mml:mover><mml:mi>w</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn mathvariant="bold">0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>N</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>X</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mi>X</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>N</mml:mi> <mml:mi>X</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006048.e040"><alternatives><graphic id="pcbi.1006048.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006048.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:msup><mml:mrow><mml:mo>∥</mml:mo> <mml:mi mathvariant="bold">n</mml:mi> <mml:mo>∥</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>n</mml:mi> <mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>n</mml:mi> <mml:mn>2</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. Using the linear approximation, <bold>r</bold> = <italic>g</italic><bold>I</bold> then gives <xref ref-type="disp-formula" rid="pcbi.1006048.e089">Eq (17)</xref>. Firing rates for dashed curves in <xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5</xref> and all firing rates in Figs <xref ref-type="fig" rid="pcbi.1006048.g006">6</xref> and <xref ref-type="fig" rid="pcbi.1006048.g007">7</xref> were obtained by first computing <xref ref-type="disp-formula" rid="pcbi.1006048.e089">Eq (17)</xref>, then inverting the Fourier transform numerically using an inverse fast Fourier transform. Solid curves in <xref ref-type="fig" rid="pcbi.1006048.g005">Fig 5</xref> were computed similarly, except using <xref ref-type="disp-formula" rid="pcbi.1006048.e073">Eq (13)</xref> in place of <xref ref-type="disp-formula" rid="pcbi.1006048.e089">Eq (17)</xref>.</p>
<p>All simulations and numerical computations were performed on a MacBook Pro running OS X 10.9.5 with a 2.3 GHz Intel Core i7 processor. All simulations were written in a combination of C and Matlab (Matlab R 2015b, MathWorks). The differential equations defining the neuron model were solved using a forward Euler method with time step 0.1 ms.</p>
</sec>
<sec id="sec021">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006048.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006048.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Derivation of firing rates in balanced networks with Gaussian-shaped connectivity kernels.</title>
<p>This supplementary text contains details of the analysis of balanced networks with connection probabilities that decay like a Gaussian with distance in physical and orientation space.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006048.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006048.s002" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Balance and imbalanced amplification in a model with conductance-based synaptic and optogenetic inputs.</title>
<p>This supplementary text contains simulations and analysis of balance and imbalanced amplification in a network model with conductance-based synapses.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Ashok Litwin-Kumar for helpful comments on a draft of the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006048.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tsodyks</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Skaggs</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Mcnaughton</surname> <given-names>B</given-names></name>. <article-title>Paradoxical Effects of External Modulation of Inhibitory Interneurons</article-title>. <source>J Neurosci</source>. <year>1997</year>;<volume>17</volume>(<issue>11</issue>):<fpage>4382</fpage>–<lpage>4388</lpage>. <object-id pub-id-type="pmid">9151754</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ozeki</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Finn</surname> <given-names>IM</given-names></name>, <name name-style="western"><surname>Schaffer</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>KD</given-names></name>, <name name-style="western"><surname>Ferster</surname> <given-names>D</given-names></name>. <article-title>Inhibitory stabilization of the cortical network underlies visual surround suppression</article-title>. <source>Neuron</source>. <year>2009</year>;<volume>62</volume>(<issue>4</issue>):<fpage>578</fpage>–<lpage>92</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2009.03.028" xlink:type="simple">10.1016/j.neuron.2009.03.028</ext-link></comment> <object-id pub-id-type="pmid">19477158</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Adesnik</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Scanziani</surname> <given-names>M</given-names></name>. <article-title>Lateral competition for cortical space by layer-specific horizontal circuits</article-title>. <source>Nature</source>. <year>2010</year>;<volume>464</volume>(<issue>7292</issue>):<fpage>1155</fpage>–<lpage>60</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature08935" xlink:type="simple">10.1038/nature08935</ext-link></comment> <object-id pub-id-type="pmid">20414303</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Phillips</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Hasenstaub</surname> <given-names>A</given-names></name>. <article-title>Asymmetric effects of activating and inactivating cortical interneurons</article-title>. <source>eLife</source>. <year>2016</year>;<volume>5</volume>:<fpage>e18383</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.18383" xlink:type="simple">10.7554/eLife.18383</ext-link></comment> <object-id pub-id-type="pmid">27719761</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chambers</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>MacLean</surname> <given-names>JN</given-names></name>. <article-title>Higher-Order Synaptic Interactions Coordinate Dynamics in Recurrent Networks</article-title>. <source>PLoS Comput Biol</source>. <year>2016</year>;<volume>12</volume>(<issue>8</issue>):<fpage>e1005078</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005078" xlink:type="simple">10.1371/journal.pcbi.1005078</ext-link></comment> <object-id pub-id-type="pmid">27542093</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Vreeswijk</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>. <article-title>Chaos in neuronal networks with balanced excitatory and inhibitory activity</article-title>. <source>Science</source>. <year>1996</year>;<volume>274</volume>(<issue>5293</issue>):<fpage>1724</fpage>–<lpage>1726</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.274.5293.1724" xlink:type="simple">10.1126/science.274.5293.1724</ext-link></comment> <object-id pub-id-type="pmid">8939866</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Vreeswijk</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>. <article-title>Chaotic balanced state in a model of cortical circuits</article-title>. <source>Neural Comput</source>. <year>1998</year>;<volume>10</volume>(<issue>6</issue>):<fpage>1321</fpage>–<lpage>1371</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/089976698300017214" xlink:type="simple">10.1162/089976698300017214</ext-link></comment> <object-id pub-id-type="pmid">9698348</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rosenbaum</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Doiron</surname> <given-names>B</given-names></name>. <article-title>Balanced networks of spiking neurons with spatially dependent recurrent connections</article-title>. <source>Phys Rev X</source>. <year>2014</year>;<volume>4</volume>(<issue>2</issue>):<fpage>021039</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006048.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pyle</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rosenbaum</surname> <given-names>R</given-names></name>. <article-title>Highly connected neurons spike less frequently in balanced networks</article-title>. <source>Phys Rev E</source>. <year>2016</year>;<volume>93</volume>(<issue>4</issue>):<fpage>040302</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.93.040302" xlink:type="simple">10.1103/PhysRevE.93.040302</ext-link></comment> <object-id pub-id-type="pmid">27176240</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Landau</surname> <given-names>ID</given-names></name>, <name name-style="western"><surname>Egger</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Dercksen</surname> <given-names>VJ</given-names></name>, <name name-style="western"><surname>Oberlaender</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>. <article-title>The Impact of Structural Heterogeneity on Excitation-Inhibition Balance in Cortical Networks</article-title>. <source>Neuron</source>. <year>2016</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1006048.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Renart</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>de La Rocha</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bartho</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Hollender</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Parga</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Reyes</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>The Asynchronous State in Cortical Circuits</article-title>. <source>Science</source>. <year>2010</year>;<volume>327</volume>(<issue>5965</issue>):<fpage>587</fpage>–<lpage>590</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1179850" xlink:type="simple">10.1126/science.1179850</ext-link></comment> <object-id pub-id-type="pmid">20110507</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rosenbaum</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Kohn</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Doiron</surname> <given-names>B</given-names></name>. <article-title>The spatial structure of correlated neuronal variability</article-title>. <source>Nature Neurosci</source>. <year>2016</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1006048.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Haider</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Duque</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hasenstaub</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>McCormick</surname> <given-names>DA</given-names></name>. <article-title>Neocortical network activity in vivo is generated through a dynamic balance of excitation and inhibition</article-title>. <source>J Neurosci</source>. <year>2006</year>;<volume>26</volume>(<issue>17</issue>):<fpage>4535</fpage>–<lpage>4545</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.5297-05.2006" xlink:type="simple">10.1523/JNEUROSCI.5297-05.2006</ext-link></comment> <object-id pub-id-type="pmid">16641233</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Okun</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lampl</surname> <given-names>I</given-names></name>. <article-title>Instantaneous correlation of excitation and inhibition during ongoing and sensory-evoked activities</article-title>. <source>Nature Neurosci</source>. <year>2008</year>;<volume>11</volume>(<issue>5</issue>):<fpage>535</fpage>–<lpage>537</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.2105" xlink:type="simple">10.1038/nn.2105</ext-link></comment> <object-id pub-id-type="pmid">18376400</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cohen</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Kohn</surname> <given-names>A</given-names></name>. <article-title>Measuring and interpreting neuronal correlations</article-title>. <source>Nature Neurosci</source>. <year>2011</year>;<volume>14</volume>(<issue>7</issue>):<fpage>811</fpage>–<lpage>819</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.2842" xlink:type="simple">10.1038/nn.2842</ext-link></comment> <object-id pub-id-type="pmid">21709677</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cohen-Kashi Malina</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Jubran</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Katz</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Lampl</surname> <given-names>I</given-names></name>. <article-title>Imbalance between excitation and inhibition in the somatosensory cortex produces postadaptation facilitation</article-title>. <source>J Neurosci</source>. <year>2013</year>;<volume>33</volume>(<issue>19</issue>):<fpage>8463</fpage>–<lpage>8471</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.4845-12.2013" xlink:type="simple">10.1523/JNEUROSCI.4845-12.2013</ext-link></comment> <object-id pub-id-type="pmid">23658183</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marlin</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Mitre</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>D’amour</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Chao</surname> <given-names>MV</given-names></name>, <name name-style="western"><surname>Froemke</surname> <given-names>RC</given-names></name>. <article-title>Oxytocin enables maternal behaviour by balancing cortical inhibition</article-title>. <source>Nature</source>. <year>2015</year>;<volume>520</volume>(<issue>7548</issue>):<fpage>499</fpage>–<lpage>504</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature14402" xlink:type="simple">10.1038/nature14402</ext-link></comment> <object-id pub-id-type="pmid">25874674</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dehghani</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Peyrache</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Telenczuk</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Le Van Quyen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Halgren</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Cash</surname> <given-names>SS</given-names></name>, <etal>et al</etal>. <article-title>Dynamic Balance of Excitation and Inhibition in Human and Monkey Neocortex</article-title>. <source>Sci Rep</source>. <year>2016</year>;<volume>6</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/srep23176" xlink:type="simple">10.1038/srep23176</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Doiron</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Litwin-Kumar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rosenbaum</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ocker</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Josić</surname> <given-names>K</given-names></name>. <article-title>The mechanics of state-dependent neural correlations</article-title>. <source>Nature Neurosci</source>. <year>2016</year>;<volume>19</volume>(<issue>3</issue>):<fpage>383</fpage>–<lpage>393</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.4242" xlink:type="simple">10.1038/nn.4242</ext-link></comment> <object-id pub-id-type="pmid">26906505</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerstein</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Mandelbrot</surname> <given-names>B</given-names></name>. <article-title>Random Walk Models for the Spike Activity of a Single Neuron</article-title>. <source>Biophys J</source>. <year>1964</year>;<volume>4</volume>(<issue>c</issue>):<fpage>41</fpage>–<lpage>68</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006048.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Softky</surname> <given-names>WR</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name>. <article-title>The highly irregular firing of cortical cells is inconsistent with temporal integration of random EPSPs</article-title>. <source>J Neurosci</source>. <year>1993</year>;<volume>13</volume>(<issue>1</issue>):<fpage>334</fpage>–<lpage>50</lpage>. <object-id pub-id-type="pmid">8423479</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Amit</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>. <article-title>Model of global spontaneous activity and local structured activity during delay periods in the cerebral cortex</article-title>. <source>Cereb Cortex</source>. <year>1997</year>;<volume>7</volume>(<issue>3</issue>):<fpage>237</fpage>–<lpage>252</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/cercor/7.3.237" xlink:type="simple">10.1093/cercor/7.3.237</ext-link></comment> <object-id pub-id-type="pmid">9143444</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shadlen</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Newsome</surname> <given-names>WT</given-names></name>. <article-title>The variable discharge of cortical neurons: implications for connectivity, computation, and information coding</article-title>. <source>J Neurosci</source>. <year>1998</year>;<volume>18</volume>(<issue>10</issue>):<fpage>3870</fpage>–<lpage>96</lpage>. <object-id pub-id-type="pmid">9570816</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Boyden</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Bamberg</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Nagel</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Deisseroth</surname> <given-names>K</given-names></name>. <article-title>Millisecond-timescale, genetically targeted optical control of neural activity</article-title>. <source>Nature Neurosci</source>. <year>2005</year>;<volume>8</volume>(<issue>9</issue>):<fpage>1263</fpage>–<lpage>1268</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1525" xlink:type="simple">10.1038/nn1525</ext-link></comment> <object-id pub-id-type="pmid">16116447</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deisseroth</surname> <given-names>K</given-names></name>. <article-title>Optogenetics: 10 years of microbial opsins in neuroscience</article-title>. <source>Nature Neurosci</source>. <year>2015</year>;<volume>18</volume>(<issue>9</issue>):<fpage>1213</fpage>–<lpage>1225</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.4091" xlink:type="simple">10.1038/nn.4091</ext-link></comment> <object-id pub-id-type="pmid">26308982</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brette</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Adaptive exponential integrate-and-fire model as an effective description of neuronal activity</article-title>. <source>J Neurophysiol</source>. <year>2005</year>;<volume>94</volume>(<issue>5</issue>):<fpage>3637</fpage>–<lpage>3642</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.00686.2005" xlink:type="simple">10.1152/jn.00686.2005</ext-link></comment> <object-id pub-id-type="pmid">16014787</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jolivet</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rauch</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lüscher</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Integrate-and-Fire models with adaptation are good enough: predicting spike times under random current injection</article-title>. <source>Adv Neural Inf Process Syst</source>. <year>2006</year>;<volume>18</volume>:<fpage>595</fpage>–<lpage>602</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006048.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jolivet</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Schürmann</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Berger</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Roth</surname> <given-names>A</given-names></name>. <article-title>The quantitative single-neuron modeling competition</article-title>. <source>Biol Cybern</source>. <year>2008</year>;<volume>99</volume>(<issue>4-5</issue>):<fpage>417</fpage>–<lpage>426</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00422-008-0261-x" xlink:type="simple">10.1007/s00422-008-0261-x</ext-link></comment> <object-id pub-id-type="pmid">19011928</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shadlen</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Newsome</surname> <given-names>WT</given-names></name>. <article-title>The variable discharge of cortical neurons: implications for connectivity, computation, and information coding</article-title>. <source>J Neurosci</source>. <year>1998</year>;<volume>18</volume>(<issue>10</issue>):<fpage>3870</fpage>–<lpage>3896</lpage>. <object-id pub-id-type="pmid">9570816</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ecker</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Berens</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Keliris</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Bethge</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Logothetis</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Tolias</surname> <given-names>A</given-names></name>. <article-title>Decorrelated Neuronal Firing in Cortical Microcircuits</article-title>. <source>Science</source>. <year>2010</year>;<volume>327</volume>(<issue>5965</issue>):<fpage>584</fpage>–<lpage>587</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1179867" xlink:type="simple">10.1126/science.1179867</ext-link></comment> <object-id pub-id-type="pmid">20110506</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Hakim</surname> <given-names>V</given-names></name>. <article-title>Fast global oscillations in networks of integrate-and-fire neurons with low firing rates</article-title>. <source>Neural Comput</source>. <year>1999</year>;<volume>11</volume>(<issue>7</issue>):<fpage>1621</fpage>–<lpage>1671</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/089976699300016179" xlink:type="simple">10.1162/089976699300016179</ext-link></comment> <object-id pub-id-type="pmid">10490941</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref032">
<label>32</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Renart</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>XJ</given-names></name>. <chapter-title>Mean-field theory of irregularly spiking neuronal populations and working memory in recurrent cortical networks</chapter-title>. In: <source>Computational Neuroscience: A Comprehensive Approach</source>. <publisher-name>CRC Press</publisher-name>, <publisher-loc>New York</publisher-loc>; <year>2004</year>. p. <fpage>431</fpage>–<lpage>490</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006048.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ledoux</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>. <article-title>Dynamics of networks of excitatory and inhibitory neurons in response to time-dependent inputs</article-title>. <source>Front Comput Neurosci</source>. <year>2011</year>;<volume>5</volume>:<fpage>25</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fncom.2011.00025" xlink:type="simple">10.3389/fncom.2011.00025</ext-link></comment> <object-id pub-id-type="pmid">21647353</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Scholl</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Seidemann</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Priebe</surname> <given-names>NJ</given-names></name>. <article-title>Sensory stimulation shifts visual cortex from synchronous to asynchronous states</article-title>. <source>Nature</source>. <year>2014</year>;<volume>509</volume>(<issue>7499</issue>):<fpage>226</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature13159" xlink:type="simple">10.1038/nature13159</ext-link></comment> <object-id pub-id-type="pmid">24695217</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref035">
<label>35</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Abbott</surname> <given-names>LF</given-names></name>. <source>Theoretical Neuroscience</source>. <publisher-loc>Cambridge, MA</publisher-loc>: <publisher-name>MIT Press</publisher-name>; <year>2001</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006048.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hertäg</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Durstewitz</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>. <article-title>Analytical approximations of the firing rate of an adaptive exponential integrate-and-fire neuron in the presence of synaptic noise</article-title>. <source>Frontiers in Comput Neurosci</source>. <year>2014</year>;<volume>8</volume>.</mixed-citation>
</ref>
<ref id="pcbi.1006048.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Petreanu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Huber</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Sobczyk</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Svoboda</surname> <given-names>K</given-names></name>. <article-title>Channelrhodopsin-2–assisted circuit mapping of long-range callosal projections</article-title>. <source>Nature Neurosci</source>. <year>2007</year>;<volume>10</volume>(<issue>5</issue>):<fpage>663</fpage>–<lpage>668</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1891" xlink:type="simple">10.1038/nn1891</ext-link></comment> <object-id pub-id-type="pmid">17435752</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pouille</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Marin-Burgin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Adesnik</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Atallah</surname> <given-names>BV</given-names></name>, <name name-style="western"><surname>Scanziani</surname> <given-names>M</given-names></name>. <article-title>Input normalization by global feedforward inhibition expands cortical dynamic range</article-title>. <source>Nature Neurosci</source>. <year>2009</year>;<volume>12</volume>(<issue>12</issue>):<fpage>1577</fpage>–<lpage>1585</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.2441" xlink:type="simple">10.1038/nn.2441</ext-link></comment> <object-id pub-id-type="pmid">19881502</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wimmer</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Compte</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Roxin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Peixoto</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Renart</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>de la Rocha</surname> <given-names>J</given-names></name>. <article-title>The dynamics of sensory integration in a hierarchical network explains choice probabilities in MT</article-title>. <source>Nature Commun</source>. <year>2015</year>;<volume>6</volume>:<fpage>1</fpage>–<lpage>13</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006048.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hofer</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Ko</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Pichler</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Vogelstein</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ros</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Zeng</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Differential connectivity and response dynamics of excitatory and inhibitory neurons in visual cortex</article-title>. <source>Nature Neurosci</source>. <year>2011</year>;<volume>14</volume>(<issue>8</issue>):<fpage>1045</fpage>–<lpage>52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.2876" xlink:type="simple">10.1038/nn.2876</ext-link></comment> <object-id pub-id-type="pmid">21765421</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ko</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hofer</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Pichler</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Buchanan</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Sjöström</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Mrsic-Flogel</surname> <given-names>TD</given-names></name>. <article-title>Functional specificity of local synaptic connections in neocortical networks</article-title>. <source>Nature</source>. <year>2011</year>;<volume>473</volume>(<issue>7345</issue>):<fpage>87</fpage>–<lpage>91</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature09880" xlink:type="simple">10.1038/nature09880</ext-link></comment> <object-id pub-id-type="pmid">21478872</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Levy</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Reyes</surname> <given-names>AD</given-names></name>. <article-title>Spatial profile of excitatory and inhibitory synaptic connectivity in mouse primary auditory cortex</article-title>. <source>J Neurosci</source>. <year>2012</year>;<volume>32</volume>(<issue>16</issue>):<fpage>5609</fpage>–<lpage>5619</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.5158-11.2012" xlink:type="simple">10.1523/JNEUROSCI.5158-11.2012</ext-link></comment> <object-id pub-id-type="pmid">22514322</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lim</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Goldman</surname> <given-names>MS</given-names></name>. <article-title>Balanced cortical microcircuitry for spatial working memory based on corrective feedback control</article-title>. <source>J Neurosci</source>. <year>2014</year>;<volume>34</volume>(<issue>20</issue>):<fpage>6790</fpage>–<lpage>6806</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.4602-13.2014" xlink:type="simple">10.1523/JNEUROSCI.4602-13.2014</ext-link></comment> <object-id pub-id-type="pmid">24828633</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>LeCun</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bengio</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>G</given-names></name>. <article-title>Deep learning</article-title>. <source>Nature</source>. <year>2015</year>;<volume>521</volume>(<issue>7553</issue>):<fpage>436</fpage>–<lpage>444</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature14539" xlink:type="simple">10.1038/nature14539</ext-link></comment> <object-id pub-id-type="pmid">26017442</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref045">
<label>45</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Tricomi</surname> <given-names>FG</given-names></name>. <source>Integral equations</source>. <publisher-name>Interscience</publisher-name>, <publisher-loc>New York</publisher-loc>; <year>1957</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006048.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ben-Yishai</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bar-Or</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>. <article-title>Theory of orientation tuning in visual cortex</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>1995</year>;<volume>92</volume>(<issue>9</issue>):<fpage>3844</fpage>–<lpage>3848</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.92.9.3844" xlink:type="simple">10.1073/pnas.92.9.3844</ext-link></comment> <object-id pub-id-type="pmid">7731993</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Van Hooser</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>KD</given-names></name>. <article-title>The stabilized supralinear network: A unifying circuit motif underlying multi-input integration in sensory cortex</article-title>. <source>Neuron</source>. <year>2015</year>;<volume>85</volume>(<issue>2</issue>):<fpage>1</fpage>–<lpage>51</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2014.12.026" xlink:type="simple">10.1016/j.neuron.2014.12.026</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Adesnik</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bruns</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Taniguchi</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>ZJ</given-names></name>, <name name-style="western"><surname>Scanziani</surname> <given-names>M</given-names></name>. <article-title>A neural circuit for spatial summation in visual cortex</article-title>. <source>Nature</source>. <year>2012</year>;<volume>490</volume>(<issue>7419</issue>):<fpage>226</fpage>–<lpage>31</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature11526" xlink:type="simple">10.1038/nature11526</ext-link></comment> <object-id pub-id-type="pmid">23060193</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jiang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Shen</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Cadwell</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Berens</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Sinz</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Ecker</surname> <given-names>AS</given-names></name>, <etal>et al</etal>. <article-title>Principles of connectivity among morphologically defined cell types in adult neocortex</article-title>. <source>Science</source>. <year>2015</year>;<volume>350</volume>(<issue>6264</issue>):<fpage>aac9462</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.aac9462" xlink:type="simple">10.1126/science.aac9462</ext-link></comment> <object-id pub-id-type="pmid">26612957</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ermentrout</surname> <given-names>B</given-names></name>. <article-title>Linearization of F-I curves by adaptation</article-title>. <source>Neural Comput</source>. <year>1998</year>;<volume>10</volume>(<issue>7</issue>):<fpage>1721</fpage>–<lpage>1729</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/089976698300017106" xlink:type="simple">10.1162/089976698300017106</ext-link></comment> <object-id pub-id-type="pmid">9744894</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Koch Ocker</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Doiron</surname> <given-names>B</given-names></name>. <article-title>Kv7 channels regulate pairwise spiking covariability in health and disease</article-title>. <source>J Neurophysiol</source>. <year>2014</year>;<volume>112</volume>(<issue>2</issue>):<fpage>340</fpage>–<lpage>352</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.00084.2014" xlink:type="simple">10.1152/jn.00084.2014</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Miller</surname> <given-names>KD</given-names></name>. <article-title>Canonical computations of cerebral cortex</article-title>. <source>Curr Opin Neurobiol</source>. <year>2016</year>;<volume>37</volume>:<fpage>75</fpage>–<lpage>84</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.conb.2016.01.008" xlink:type="simple">10.1016/j.conb.2016.01.008</ext-link></comment> <object-id pub-id-type="pmid">26868041</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Litwin-Kumar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rosenbaum</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Doiron</surname> <given-names>B</given-names></name>. <article-title>Inhibitory stabilization and visual coding in cortical circuits with multiple interneuron subtypes</article-title>. <source>J Neurophysiol</source>. <year>2016</year>;<volume>115</volume>(<issue>3</issue>):<fpage>1399</fpage>–<lpage>1409</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.00732.2015" xlink:type="simple">10.1152/jn.00732.2015</ext-link></comment> <object-id pub-id-type="pmid">26740531</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Atallah</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Bruns</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Carandini</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Scanziani</surname> <given-names>M</given-names></name>. <article-title>Parvalbumin-Expressing Interneurons Linearly Transform Cortical Responses to Visual Stimuli</article-title>. <source>Neuron</source>. <year>2012</year>;<volume>73</volume>(<issue>1</issue>):<fpage>159</fpage>–<lpage>170</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2011.12.013" xlink:type="simple">10.1016/j.neuron.2011.12.013</ext-link></comment> <object-id pub-id-type="pmid">22243754</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Murphy</surname> <given-names>BK</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>KD</given-names></name>. <article-title>Balanced amplification: a new mechanism of selective amplification of neural activity patterns</article-title>. <source>Neuron</source>. <year>2009</year>;<volume>61</volume>(<issue>4</issue>):<fpage>635</fpage>–<lpage>48</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2009.02.005" xlink:type="simple">10.1016/j.neuron.2009.02.005</ext-link></comment> <object-id pub-id-type="pmid">19249282</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bosking</surname> <given-names>WH</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Schofield</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Fitzpatrick</surname> <given-names>D</given-names></name>. <article-title>Orientation selectivity and the arrangement of horizontal connections in tree shrew striate cortex</article-title>. <source>J Neurosci</source>. <year>1997</year>;<volume>17</volume>(<issue>6</issue>):<fpage>2112</fpage>–<lpage>27</lpage>. <object-id pub-id-type="pmid">9045738</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Destexhe</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Paré</surname> <given-names>D</given-names></name>. <article-title>Impact of network activity on the integrative properties of neocortical pyramidal neurons in vivo</article-title>. <source>J Neurophysiol</source>. <year>1999</year>;<volume>81</volume>(<issue>4</issue>):<fpage>1531</fpage>–<lpage>47</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.1999.81.4.1531" xlink:type="simple">10.1152/jn.1999.81.4.1531</ext-link></comment> <object-id pub-id-type="pmid">10200189</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Destexhe</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rudolph</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Paré</surname> <given-names>D</given-names></name>. <article-title>The high-conductance state of neocortical neurons in vivo</article-title>. <source>Nat Rev Neurosci</source>. <year>2003</year>;<volume>4</volume>(<issue>4</issue>):<fpage>739</fpage>–<lpage>51</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrn1198" xlink:type="simple">10.1038/nrn1198</ext-link></comment> <object-id pub-id-type="pmid">12951566</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kuhn</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Aertsen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>. <article-title>Neuronal integration of synaptic input in the fluctuation-driven regime</article-title>. <source>J Neurosci</source>. <year>2004</year>;<volume>24</volume>(<issue>10</issue>):<fpage>2345</fpage>–<lpage>56</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.3349-03.2004" xlink:type="simple">10.1523/JNEUROSCI.3349-03.2004</ext-link></comment> <object-id pub-id-type="pmid">15014109</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kameda</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hioki</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Tanaka</surname> <given-names>YH</given-names></name>, <name name-style="western"><surname>Tanaka</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Sohn</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sonomura</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Parvalbumin-producing cortical interneurons receive inhibitory inputs on proximal portions and cortical excitatory inputs on distal dendrites</article-title>. <source>Europ J Neurosci</source>. <year>2012</year>;<volume>35</volume>(<issue>6</issue>):<fpage>838</fpage>–<lpage>854</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1460-9568.2012.08027.x" xlink:type="simple">10.1111/j.1460-9568.2012.08027.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hioki</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Okamoto</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Konno</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kameda</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Sohn</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kuramoto</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Cell type-specific inhibitory inputs to dendritic and somatic compartments of parvalbumin-expressing neocortical interneuron</article-title>. <source>J Neurosci</source>. <year>2013</year>;<volume>33</volume>(<issue>2</issue>):<fpage>544</fpage>–<lpage>555</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.2255-12.2013" xlink:type="simple">10.1523/JNEUROSCI.2255-12.2013</ext-link></comment> <object-id pub-id-type="pmid">23303934</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Litwin-Kumar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Doiron</surname> <given-names>B</given-names></name>. <article-title>Slow dynamics and high variability in balanced cortical networks with clustered connections</article-title>. <source>Nature Neurosci</source>. <year>2012</year>;<volume>15</volume>(<issue>11</issue>):<fpage>1498</fpage>–<lpage>1505</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3220" xlink:type="simple">10.1038/nn.3220</ext-link></comment> <object-id pub-id-type="pmid">23001062</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006048.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stringer</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pachitariu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Steinmetz</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Okun</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bartho</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Harris</surname> <given-names>KD</given-names></name>, <etal>et al</etal>. <article-title>Inhibitory control of correlated intrinsic variability in cortical networks</article-title>. <source>eLife</source>. <year>2016</year>;<volume>5</volume>:<fpage>e19695</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.19695" xlink:type="simple">10.7554/eLife.19695</ext-link></comment> <object-id pub-id-type="pmid">27926356</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>