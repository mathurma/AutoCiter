<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006624</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01895</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Prefrontal cortex</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Prefrontal cortex</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Hippocampus</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Hippocampus</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Animal studies</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Rats</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Rats</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Animal studies</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Animal models</subject><subj-group><subject>Rats</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Animals</subject><subj-group><subject>Vertebrates</subject><subj-group><subject>Amniotes</subject><subj-group><subject>Mammals</subject><subj-group><subject>Rodents</subject><subj-group><subject>Rats</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Problem solving</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Problem solving</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Problem solving</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Neostriatum</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Neostriatum</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Reservoir computing model of prefrontal cortex creates novel combinations of previous navigation sequences from hippocampal place-cell replay with spatial reward propagation</article-title>
<alt-title alt-title-type="running-head">Prefrontal—Hippocampal sequence learning by reward propagation</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Cazin</surname>
<given-names>Nicolas</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Llofriu Alonso</surname>
<given-names>Martin</given-names>
</name>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Scleidorovich Chiodi</surname>
<given-names>Pablo</given-names>
</name>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Pelc</surname>
<given-names>Tatiana</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Harland</surname>
<given-names>Bruce</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Weitzenfeld</surname>
<given-names>Alfredo</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Fellous</surname>
<given-names>Jean-Marc</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9318-179X</contrib-id>
<name name-style="western">
<surname>Dominey</surname>
<given-names>Peter Ford</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>INSERM, U1093, Cognition Action Plasticité Sensorimotrice, Université de Bourgogne, Dijon, France</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Robot Cognition Laboratory, Institut Marey, INSERM, CNRS, UBFC, Dijon, France</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Department of Computer Science and Engineering, University of South Florida, Tampa, Florida, United States of America</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Department of Psychology, University of Arizona, Tucson, Arizona, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Inman</surname>
<given-names>Cory</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Emory University, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">peter.dominey@inserm.fr</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>15</day>
<month>7</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="collection">
<month>7</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>7</issue>
<elocation-id>e1006624</elocation-id>
<history>
<date date-type="received">
<day>8</day>
<month>11</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>11</day>
<month>6</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Cazin et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006624"/>
<abstract>
<p>As rats learn to search for multiple sources of food or water in a complex environment, they generate increasingly efficient trajectories between reward sites. Such spatial navigation capacity involves the replay of hippocampal place-cells during awake states, generating small sequences of spatially related place-cell activity that we call “snippets”. These snippets occur primarily during sharp-wave-ripples (SWRs). Here we focus on the role of such replay events, as the animal is learning a traveling salesperson task (TSP) across multiple trials. We hypothesize that snippet replay generates synthetic data that can substantially expand and restructure the experience available and make learning more optimal. We developed a model of snippet generation that is modulated by reward, propagated in the forward and reverse directions. This implements a form of spatial credit assignment for reinforcement learning. We use a biologically motivated computational framework known as ‘reservoir computing’ to model prefrontal cortex (PFC) in sequence learning, in which large pools of prewired neural elements process information dynamically through reverberations. This PFC model consolidates snippets into larger spatial sequences that may be later recalled by subsets of the original sequences. Our simulation experiments provide neurophysiological explanations for two pertinent observations related to navigation. Reward modulation allows the system to reject non-optimal segments of experienced trajectories, and reverse replay allows the system to “learn” trajectories that it has not physically experienced, both of which significantly contribute to the TSP behavior.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>As rats search for multiple sources of food in a complex environment, they generate increasingly efficient trajectories between reward sites, across multiple trials. This spatial navigation optimization behavior can be measured in the laboratory using a traveling salesperson task (TSP). This likely involves the coordinated replay of place-cell “snippets” between successive trials. We hypothesize that “snippets” can be used by the prefrontal cortex (PFC) to implement a form of reward-modulated reinforcement learning. Our simulation experiments provide neurophysiological explanations for two pertinent observations related to navigation. Reward modulation allows the system to reject non-optimal segments of experienced trajectories, and reverse replay allows the system to “learn” trajectories that it has not physically experienced, both of which significantly contribute to the TSP behavior.</p>
</abstract>
<funding-group>
<funding-statement>All authors received support from the CRCNS NFS-ANR grant Spaquence, N°1429929. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="10"/>
<table-count count="3"/>
<page-count count="32"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-07-31</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the manuscript and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Spatial navigation in the rat involves the replay of place-cell sub-sequences, that we refer to as snippets, during awake and sleep states in the hippocampus during sharp-wave-ripples (SWR) [<xref ref-type="bibr" rid="pcbi.1006624.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1006624.ref004">4</xref>]. In the awake state, replay has been observed to take place in forward and reverse direction [<xref ref-type="bibr" rid="pcbi.1006624.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006624.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1006624.ref008">8</xref>], with respect to the physical order of the initial displacement of the animal. Both forward and reverse replay are influenced by task contingencies and reward [<xref ref-type="bibr" rid="pcbi.1006624.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1006624.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1006624.ref010">10</xref>]. Reverse replay is observed to originate from rewarded locations [<xref ref-type="bibr" rid="pcbi.1006624.ref011">11</xref>], with a greater frequency of replay for locations with greater reward, which could allow a propagation of value backwards from the rewarded location [<xref ref-type="bibr" rid="pcbi.1006624.ref009">9</xref>]. An interesting example of the impact of reward on forward replay is seen in the experiments of Gupta &amp; van der Meer [<xref ref-type="bibr" rid="pcbi.1006624.ref006">6</xref>] where rats ran the left or right (or both) sides of a dual maze. Replay occurred with equal proportions for the same and opposite side of the rat’s current location. Same side forward replay tended to be prospective, and project forward from the current location, as observed by Pfeiffer and Foster [<xref ref-type="bibr" rid="pcbi.1006624.ref012">12</xref>]. Interestingly, opposite-side forward replay preferentially occurred retrospectively, as forward sweeps to reward locations starting from remote locations. This suggests that more diverse forward replay including forward sweeps from remote locations (as observed by Gupta &amp; van der Meer [<xref ref-type="bibr" rid="pcbi.1006624.ref006">6</xref>]) will be observed as a function of specific task characteristics and requirements. Liu and Sibille [<xref ref-type="bibr" rid="pcbi.1006624.ref008">8</xref>] have recently shown the predictive nature of such forward sweeps, using essentially statistical data analysis techniques. Our work extends this recent work in proposing an actual mechanism and neuronal model that could support it.</p>
<p>Thus, while it has been observed that in both 1D [<xref ref-type="bibr" rid="pcbi.1006624.ref005">5</xref>] and 2D [<xref ref-type="bibr" rid="pcbi.1006624.ref012">12</xref>], the bulk of awake replay events are prospective, and depict future paths to upcoming goals, in more complex tasks, forward retrospective sweeps from remote locations can be observed. In the current research with multiple goal locations to be remembered (no foraging), and optimization of the paths (rather than just their memorization), we argue (and the model predicts), that forward sweeps from remote locations will predominantly carry information and be used to accomplish the task.</p>
<p>We focus on the role of replay during the awake state, as the animal generates increasingly efficient trajectories between reward sites, across multiple trials. This trend toward near-optimal solutions is reminiscent of the classic Traveling Salesperson Problem (TSP) [<xref ref-type="bibr" rid="pcbi.1006624.ref013">13</xref>]. The TSP problem involves finding the shortest path that visits a set of “cities” on a 2D map. It is a computationally complex problem, and is one of the most intensively studied problems in optimization [<xref ref-type="bibr" rid="pcbi.1006624.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1006624.ref015">15</xref>]. While it is clear that rats do not solve the TSP in the mathematical sense, they remarkably display a robust tendency towards such optimization [<xref ref-type="bibr" rid="pcbi.1006624.ref013">13</xref>]. It appears likely that such spatial navigation optimization involves planning and hence awake replay but the underlying neurophysiological mechanisms remain to be understood.</p>
<p>One obvious advantage of replay would be to provide additional internally generated training examples to otherwise slow reinforcement learning (RL) systems. Traditional RL methods are usually inefficient, as they use each data sample once, to incrementally improve the solution, and then discard the sample. In a real-time learning situation, where the rat is optimizing in less than ten trials, this approach is unlikely to succeed. Our model proposes to add replay to reinforcement learning to overcome this problem and improve efficiency [<xref ref-type="bibr" rid="pcbi.1006624.ref016">16</xref>]. This approach has been previously exploited with good results [<xref ref-type="bibr" rid="pcbi.1006624.ref017">17</xref>]. We will go beyond this by prioritizing replay based on a spatial gradient of reward proximity that is built up during replay. Our first hypothesis is that reward-modulated replay in hippocampus implements a simple and efficient form of reinforcement learning [<xref ref-type="bibr" rid="pcbi.1006624.ref018">18</xref>], which allows recurrent dynamics in prefrontal cortex (PFC) to consolidate snippet representations into novel efficient sequences, by rejecting sequences that are less robustly coded in the input.</p>
<p>An example of the behavior in question is illustrated in <xref ref-type="fig" rid="pcbi.1006624.g001">Fig 1</xref>. Panel A illustrates the optimal path linking the five feeders (ABCDE) in red. Panels B-D illustrate navigation trajectories that contain sub-sequences of the optimal path (in red), as well as non-optimal sub-sequences (in blue). In the framework of reward modulated replay, snippets from the efficient sub-sequences in panels B-D will be replayed more frequently, and will lead the system to autonomously generate the optimal sequence as illustrated in panel A. We thus require a sequence learning system that can re-assemble the target sequences from these replayed snippets. For this, we chose a biologically inspired recurrent network model of prefrontal cortex [<xref ref-type="bibr" rid="pcbi.1006624.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1006624.ref020">20</xref>] that we predict will be able to integrate snippets from examples of non-optimal trajectories and to synthesize an optimal path.</p>
<fig id="pcbi.1006624.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006624.g001</object-id>
<label>Fig 1</label>
<caption>
<title/>
<p>An optimal trajectory between feeders <underline>ABCDE</underline> is represented in panel A. Panel B, C and D display non optimal trajectories that contain a sub trajectory of the <underline>ABCDE</underline> trajectory. The sub trajectory shared with the <underline>ABCDE</underline> trajectory is displayed in red and the non-optimal parts in blue. Panel B contains the <underline>ABC</underline>ED, panel C the E<underline>BCD</underline>A trajectory and panel D the BA<underline>CDE</underline> trajectory.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.g001" xlink:type="simple"/>
</fig>
<p>Recurrent networks have excellent inherent sensitivity to serial and temporal structure, which make them well adapted for sequence learning [<xref ref-type="bibr" rid="pcbi.1006624.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1006624.ref022">22</xref>]. Interestingly, primate cortex is characterized by a vast majority of cortico-cortical connections being local and recurrent [<xref ref-type="bibr" rid="pcbi.1006624.ref023">23</xref>], and thus cortex is a highly recurrent network [<xref ref-type="bibr" rid="pcbi.1006624.ref024">24</xref>]. We thus model frontal cortex as a recurrent network. Interestingly, the computational complexity of credit assignment to recurrent connections is high, because it involves keeping track of the role of each connection over successive time steps as the network evolves through its temporal dynamics [<xref ref-type="bibr" rid="pcbi.1006624.ref021">21</xref>]. One solution is to unwind the recurrent network into a series of feedforward layers where each layer represents the network activation at the next time step. This is efficient [<xref ref-type="bibr" rid="pcbi.1006624.ref022">22</xref>], but introduces an arbitrary cut off of the recurrent dynamics. In order to allow the recurrent network to maintain complete dynamics, Dominey et al. [<xref ref-type="bibr" rid="pcbi.1006624.ref025">25</xref>] chose to keep the recurrent connections fixed, with a random distribution of positive and negative connections that ensured a rich network dynamics that represented the influence of new inputs, and the fading effects of previous inputs. The resulting representation of the spatiotemporal structure of the input can then be associated with the desired output function by the modification of simple feedforward connections from the recurrent network to the output neurons. Dominey and colleagues initially proposed that the prefrontal cortex corresponds to the recurrent network, and the striatum, with its dopamine-modifiable corticostriatal connections as the output layer [<xref ref-type="bibr" rid="pcbi.1006624.ref025">25</xref>]. This was in fact the first characterization of reservoir computing, which was subsequently co-discovered by Jaeger [<xref ref-type="bibr" rid="pcbi.1006624.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1006624.ref027">27</xref>], and Maass &amp; Natschlager [<xref ref-type="bibr" rid="pcbi.1006624.ref028">28</xref>]. It is now well established that frontal cortex can be characterized as a recurrent reservoir model, via demonstrations that the high dimensional representations inherent to these recurrent networks is required for higher cognitive function, and is omnipresent in frontal cortex [<xref ref-type="bibr" rid="pcbi.1006624.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1006624.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1006624.ref030">30</xref>]. The use of the reservoir structure is indeed an originality of our model, and an alternative to classical plastic recurrent networks such as those used to model attractor network dynamics in hippocampus CA3 [<xref ref-type="bibr" rid="pcbi.1006624.ref031">31</xref>].</p>
<p>We test the hypothesis that the structure of snippet replay from the hippocampus will provide the PFC with constraints that can be integrated in order to contribute to solving the TSP problem. Two principal physical and neurophysiological properties of navigation and replay are exploited by the model and contribute to the system’s ability to converge onto an acceptable solution to the TSP. First, during navigation between baited food wells in the TSP task, non-optimal trajectories by definition cover more distance between rewards than near-optimal ones. Second, during the replay of recently activated places cells, the trajectories are encoded in forward and reverse directions [<xref ref-type="bibr" rid="pcbi.1006624.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006624.ref011">11</xref>]. Exploiting these observations, we test the hypotheses that:</p>
<list list-type="order">
<list-item><p>With replay biased by distance to reward, non-optimal trajectories will be less represented in replay, allowing the PFC to eliminate non-optimal sub-sequences in constructing the final efficient trajectory.</p></list-item>
<list-item><p>Reverse replay will allow the model to exploit the information provided by a given sequence in forward and backward directions, whereas the actual trajectory run by the rat has one direction only.</p></list-item>
</list>
<p>In testing these hypotheses, we will illustrate how the system can meet the following challenges:</p>
<list list-type="order">
<list-item><p>Learn a global place-cell activation sequence from an unordered set of snippets</p></list-item>
<list-item><p>Consolidate multiple non-optimal sequences into a trajectory that efficiently links rewarded locations, thus converging to a good solution to the TSP problem.</p></list-item>
<list-item><p>Experience a trajectory in the forward direction and then learn to generate it in forward and backward direction, including concatenating parts of both forward and reverse replayed snippets in order to generate novel trajectories as demonstrated in Gupta &amp; van der Meer [<xref ref-type="bibr" rid="pcbi.1006624.ref006">6</xref>]. The objective is to provide a coherent explanation of how critical aspects of replay–notably its modulation by reward, and the forward and reverse aspects, can be exploited by a cortical sequence learning system in order to display novel and efficient navigation trajectory generation.</p></list-item>
</list>
<p>The model developed in this research provides a possible explanation of mechanisms that allow PFC and hippocampus to interact to perform path optimization. This implies functional connectivity between these two structures. In a recent review of hippocampal–prefrontal interactions in memory-guided behavior Shin and Jadhav [<xref ref-type="bibr" rid="pcbi.1006624.ref032">32</xref>] outlined a diverse set of direct and indirect connections that allow bi-directional interaction between these structures. Principal direct connections to PFC originate in the ventral and intermediate CA1 regions of the hippocampus [<xref ref-type="bibr" rid="pcbi.1006624.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1006624.ref034">34</xref>]. Connections between hippocampus and PFC pass via the medial temporal lobe (subiculum, entorhinal cortex, peri- and post-rhinal cortex) [<xref ref-type="bibr" rid="pcbi.1006624.ref035">35</xref>], and the nucleus reuniens [<xref ref-type="bibr" rid="pcbi.1006624.ref036">36</xref>]. Indeed memory replay is observed to be coordinated across hippocampus and multiple cortical areas including V1 [<xref ref-type="bibr" rid="pcbi.1006624.ref037">37</xref>]. There are direct connections from ventral CA1/subiculum to the rodent medial frontal cortex[<xref ref-type="bibr" rid="pcbi.1006624.ref038">38</xref>] and from the mFC to dorsal CA1 [<xref ref-type="bibr" rid="pcbi.1006624.ref039">39</xref>], The connections through the RE nucleus though may be of primary importance for HC-mFC communication [<xref ref-type="bibr" rid="pcbi.1006624.ref040">40</xref>]. These studies allow us to consider that there are direct and indirect anatomical pathways that justify the modeling of bi-directional interaction between PFC and hippocampus [<xref ref-type="bibr" rid="pcbi.1006624.ref041">41</xref>].</p>
<p>It is important to note that the model we describe should not be considered to be fully autonomous in driving the behavior of the animal, because it relies on prior experience from which to construct new behavior. This experience is assumed to be generated by visual and olfactive processes that contribute to locally guided behavior.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Material &amp; methods</title>
<p>Experiments are performed on navigation trajectories (observed from rat behavior, or generated automatically) that represent the recent experience from the simulated rat. Snippets are extracted from this experience, and used to train the output connections of the PFC reservoir. This requires the specification of a model of place-cell activation in order to generate snippets. Based on this training, the sequence generation performance is evaluated to test the hypotheses specified. The evaluation requires a method for comparing sequences generated with expected sequences that is based on the Fréchet distance.</p>
<sec id="sec003">
<title>Navigation behavior and trajectories</title>
<p>A trajectory is a sequence of N contiguous two-dimensional coordinates sampled from time <italic>t</italic><sub>1</sub> to time <italic>t</italic><sub><italic>N</italic></sub> noted <italic>L</italic>(<italic>t</italic><sub>1</sub>→<italic>t</italic><sub><italic>N</italic></sub>) that corresponds to the rat’s traversal of the baited feeders. The spatial resolution of trajectories are depicted at 20 <italic>points</italic>/<italic>m</italic> along the trajectory. Experiments were performed using navigation trajectories, including those displayed in <xref ref-type="fig" rid="pcbi.1006624.g001">Fig 1</xref>, based on data recorded from rats as they ran the TSP task [<xref ref-type="bibr" rid="pcbi.1006624.ref013">13</xref>] in a circular arena having a radius of 151cm. Twenty-one fixed feeders are distributed according to a spiral shape. In a typical configuration, five feeders are baited with a food pellet. For a given configuration, the rat runs several trials which are initially random and inefficient, and become increasingly efficient over successive trials, characterizing the TSP behavior [<xref ref-type="bibr" rid="pcbi.1006624.ref013">13</xref>]. Rat data that characterizes the TSP behavior is detailed in <xref ref-type="supplementary-material" rid="pcbi.1006624.s001">S1 Text</xref>, section Rat navigation data. The principle concept is that TSP behavior can be characterized as illustrated in <xref ref-type="fig" rid="pcbi.1006624.g001">Fig 1</xref>, where a system that is exposed to trajectories that contain elements of the efficient path can extract and concatenate these sub-sequences in order to generate the efficient trajectory.</p>
</sec>
<sec id="sec004">
<title>Place-cells</title>
<p>The modeled rat navigates in a closed space of 2x2 meters where it can move freely in all direction within a limited range (± 110° left and right of straight ahead), and encodes locations using hippocampus place-cell activity. A given location <italic>s</italic> = (<italic>x</italic>,<italic>y</italic>) is associated with a place-cell activation pattern by a set of 2D Gaussian place-fields:
<disp-formula id="pcbi.1006624.e001">
<alternatives>
<graphic id="pcbi.1006624.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msup>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula></p>
<p>Where:</p>
<list list-type="bullet">
<list-item><p><italic>k</italic> is the index of the place-cell</p></list-item>
<list-item><p><italic>f</italic><sub><italic>k</italic></sub>(<italic>s</italic>) is the mean firing rate of the <italic>k</italic><sup><italic>th</italic></sup> place-cell</p></list-item>
<list-item><p><italic>c</italic><sub><italic>k</italic></sub> is the (<italic>x</italic>,<italic>y</italic>) coordinate of the <italic>k</italic><sup><italic>th</italic></sup> place-cell</p></list-item>
</list>
<list list-type="bullet">
<list-item><p><inline-formula id="pcbi.1006624.e002"><alternatives><graphic id="pcbi.1006624.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> is a constant that will constrain the highest activations of the place-cell to be mostly contained in a circle of radius <italic>r</italic><sub><italic>k</italic></sub>, centered in <italic>c</italic><sub><italic>k</italic></sub></p></list-item>
<list-item><p><italic>r</italic><sub><italic>k</italic></sub> is the radius of the <italic>k</italic><sup><italic>th</italic></sup> place-field</p></list-item>
<list-item><p><italic>Θ</italic> is the radius threshold which controls the spatial selectivity of the place-cell</p></list-item>
</list>
<p>Parameter <italic>w</italic><sub><italic>k</italic></sub> is a manner of defining the variance of the 2D Gaussian surface with a distance to center related parameter <italic>r</italic><sub><italic>k</italic></sub>. We model a uniform grid of 16x16 Gaussian place-fields of equal size (mimicking dorsal hippocampus). In <xref ref-type="fig" rid="pcbi.1006624.g002">Fig 2</xref> the spatial position and extent of the place fields of several place-cells is represented in panel A by red circles. The degree of red transparency represents the mean firing rate.</p>
<fig id="pcbi.1006624.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006624.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Place-cell and snippet coding.</title>
<p>Panel A represents the place-cell activations that correspond to a single point. Place-cell centers are represented by red points and the mean firing rate of each place-cell by a red circle with a fixed radius, centered on the place-cell center. The transparency level of the circle represents the magnitude of the mean firing rate. Panel B depicts the ABCED trajectory, and a snippet randomly drawn along the trajectory. The snippet length is <italic>s</italic> = 5. Panel C represents the snippet replay likelihood as learnt by the Hippocampal replay model by propagation of reward from rewarded locations at ABCE and D. Panel D represents the raster of the place-cell activation along the ABCED trajectory. The time index where feeders A,B,C,D and E are encountered during the ABCED trajectory are tagged above the raster and represented by a thin white vertical line. The snippet represented in panel B is emphasized by a blue rectangle in panel D. Panel E represents the spatial extent of the snippet replay likelihood. F illustrates part of a typical random replay episode, where multiple snippets from remote locations are replayed.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.g002" xlink:type="simple"/>
</fig>
<p>A mean firing rate close to one will result in a bright circle if the location <italic>s</italic> is close to the place-field center <italic>c</italic><sub><italic>k</italic></sub> of the place-cell <italic>k</italic>. For a more distant place-field center <italic>c</italic><sub><italic>l</italic></sub> of place-cell <italic>l</italic>, the mean firing rate will be less important and the red circle representing this mean firing rate will be dimmer.</p>
<p>Thus, at each time step the place-cell coding that corresponds to a particular point in a trajectory is defined as the projection of this <italic>L</italic>(<italic>t</italic><sub><italic>n</italic></sub>) point through <italic>K</italic> radial basis functions (i.e. Gaussian place-fields spatial response)
<disp-formula id="pcbi.1006624.e003">
<alternatives>
<graphic id="pcbi.1006624.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula></p>
<p>Each coordinate of the input vector <italic>X</italic><sub><italic>in</italic></sub>(<italic>t</italic><sub><italic>n</italic></sub>) represents the mean firing rate of hippocampus place-cells and its value lies between 0 and 1. <xref ref-type="fig" rid="pcbi.1006624.g002">Fig 2</xref> represents in panel B the ABCED trajectory <italic>L</italic>(<italic>t</italic><sub>1</sub>→<italic>t</italic><sub><italic>N</italic></sub>) and the corresponding place-cell mean firing rate raster <italic>X</italic><sub><italic>in</italic></sub>(<italic>t</italic><sub>1</sub>→<italic>t</italic><sub><italic>N</italic></sub>) is depicted in panel C.</p>
</sec>
<sec id="sec005">
<title>Hippocampus replay</title>
<p>The hippocampus replay observed during SWR complexes in the active rest phase (between two trials in a given configuration of baited food wells) is modeled by generating condensed (time compressed) sub-sequences of place-cell activation patterns (snippets) that are then replayed at random so as to constitute a training set. The sampling distribution for drawing a random place-cell activation pattern might be uniform or modulated by new or rewarding experience as described in [<xref ref-type="bibr" rid="pcbi.1006624.ref001">1</xref>]. Ambrose and Pfeiffer [<xref ref-type="bibr" rid="pcbi.1006624.ref009">9</xref>] demonstrated that during SWR sequences place-cell activation occur in reverse order at the end of a run. We define a random replay generative model that learns to preferentially generate snippets associated to a reward by using reverse replay. For a trajectory encountered in forward direction, reverse replay allows the model to anticipate the reward by propagating the reward information in the backwards direction. Once learnt the model is able to generate snippets in forward and reverse order, hence representing parts of a trajectory in reverse or forward direction. This innovative method for spatial propagation of reward during replay yields a computationally simple form of reinforcement learning.</p>
<p>We define a snippet as the concatenation of a pattern of successive place-cell activations from a previously traversed trajectory:
<disp-formula id="pcbi.1006624.e004">
<alternatives>
<graphic id="pcbi.1006624.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula></p>
<p>Where: <italic>s</italic> is the number of place-cell activations (or the snippet length), and <italic>n</italic> is the offset in the trajectory. Replay occurs during SWRs at ~150-200Hz with a duration ~50–120 ms [<xref ref-type="bibr" rid="pcbi.1006624.ref002">2</xref>], so snippet length <italic>s</italic> in our experiments is typically 10 and varies from 5–20. We define a replay episode as the period between trials in the TSP experiment (on the order of 2–5 minutes) during which replay occurs. The duration of a replay episode is constrained by a time budget <italic>T</italic>, defined in simulation update cycles. Place cell activations in the simulated replay occur on each time step, with each time step corresponding to 5ms, or a 200Hz update rate. A replay episode <italic>E</italic> is a set of snippets of length <italic>s</italic>:
<disp-formula id="pcbi.1006624.e005">
<alternatives>
<graphic id="pcbi.1006624.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
such that sum of the durations of snippets replayed in <italic>E</italic> is constrained to be ≤ <italic>T</italic>. In a typical experiment described below T = 10000 and s = 10, which corresponds to 1000 snippets of length 10. In order to respect ecological orders of magnitude, we consider that during 2–5 minutes of intertrial delay in the TSP task, SWRs occur at ~1Hz, corresponding to ~120–300 SWRs. In a given SWR it is likely that across the dorsal hippocampus, 100s - 1000s of places cells will fire, corresponding to an order of 10<sup>1</sup>–10<sup>2</sup> snippets per SWR. This parallel replay of multiple independent snippets within an SWR is hypothesized but has not yet been experimentally observed. Over 2–5 minutes, this corresponds to a lower bound of 1.2x103—and an upper bound of 3x10<sup>4</sup> snippets during the intertrial period. We conservatively model this at 1x10<sup>3</sup>. In a given episode snippet length <italic>s</italic> is fixed. Individual snippets are spatially coherent, while successive snippets are not, and can start from random locations along previously experienced trajectories.</p>
<p>In <xref ref-type="fig" rid="pcbi.1006624.g002">Fig 2</xref>, Panel B represents a particular trajectory through feeders A, B, C, E and D. The depicted snippet is a sub-sequence of 5 contiguous locations belonging to the ABCED sequence. The B and E feeders are baited and marked as rewarding (R<sub>1</sub> and R<sub>2</sub>). Panel B shows the spatial extent of a given snippet chosen in sequence ABCED and panel C shows the place-cell activation pattern of the ABCED trajectory and the corresponding snippet location in the raster.</p>
<sec id="sec006">
<title>Reward propagation</title>
<p>The snippet replay model favors snippets that are on efficient paths linking rewarded sites (e.g. paths linking feeders A, B and C in panel B <xref ref-type="fig" rid="pcbi.1006624.g002">Fig 2</xref>), and not those that are on inefficient paths (as in paths linking C, D and E in the same panel). This is achieved by propagating reward value backwards from rewarded locations, and calculating the probability of replay as a function of proximity to a reward. Panel D of <xref ref-type="fig" rid="pcbi.1006624.g002">Fig 2</xref> illustrates the resulting probability distributions for snippet selection along the complete path. Panel E represents the spatial extent of snippet replay likelihood. Note that the paths linking A, B and C have the highest probabilities for snippet replay.</p>
<p>Hippocampus place-cell replay can occur in forward or backward direction as suggested in [<xref ref-type="bibr" rid="pcbi.1006624.ref011">11</xref>]. We model the reverse replay as follows: For a given trajectory of <italic>N</italic> samples, there are <italic>N</italic>−<italic>s</italic> possible snippets that can be replayed but only a limited number of snippets will be selected to fit the time budget <italic>T</italic>. A snippet <italic>S</italic>(<italic>n</italic>;<italic>s</italic>) has a likelihood of being replayed if it is related to a reward prediction. A generative model of snippet replay likelihood P is computed by first defining the reward prediction V over time indices sequence <italic>t</italic><sub>1</sub>−&gt;<italic>t</italic><sub><italic>N</italic></sub> of a trajectory described by N samples, noted <italic>V</italic>(<italic>t</italic><sub>1</sub>−&gt;<italic>t</italic><sub><italic>N</italic></sub>). This reward prediction value corresponds to the replay likelihood illustrated in <xref ref-type="fig" rid="pcbi.1006624.g002">Fig 2C and 2E</xref>. It is initialized to a small positive random value as described in the algorithm replay-initialize:</p>
<table-wrap id="pcbi.1006624.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006624.t001</object-id>
<alternatives>
<graphic id="pcbi.1006624.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<tbody>
<tr>
<td align="left" colspan="3"><sc>Replay-initialize</sc></td>
</tr>
<tr>
<td align="left"><bold>Input</bold></td>
<td align="left"/>
<td align="left"/>
</tr>
<tr>
<td align="left"/>
<td align="left"><bold>ϵ</bold>, a small positive constant</td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>Output</bold></td>
<td align="left"/>
<td align="left"/>
</tr>
<tr>
<td align="left"/>
<td align="left">V, the time indexed reward prediction</td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>Algorithm</bold></td>
<td align="left"/>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>1</bold></td>
<td align="left"><bold>for all</bold> i∈{1,..,N} <bold>do</bold></td>
<td align="left"><italic>/* For all time indices i in V*/</italic></td>
</tr>
<tr>
<td align="left"><bold>2</bold></td>
<td align="left"><bold><italic>V</italic></bold>(<bold><italic>i</italic></bold>)<bold>←random</bold>(<bold>U</bold>[<bold>0,ϵ</bold>])</td>
<td align="left"><italic>/* Initialize V(i) by drawing a small positive random number from a uniform distribution*/</italic></td>
</tr>
<tr>
<td align="left"><bold>3</bold></td>
<td align="left"><bold>end for</bold></td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>4</bold></td>
<td align="left"><bold>return</bold> V</td>
<td align="left"/>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Replay-initialize algorithm pseudocode</p>
<p>Then the reward prediction V is learned by propagating a time delayed reward information according to the replay direction (forward/reverse) and the snippet duration. This is described in the <italic>replay-learn algorithm</italic> pseudocode.</p>
<table-wrap id="pcbi.1006624.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006624.t002</object-id>
<alternatives>
<graphic id="pcbi.1006624.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<tbody>
<tr>
<td align="left" colspan="3"><sc>Replay learn</sc></td>
</tr>
<tr>
<td align="left"><bold>Input</bold></td>
<td align="left"/>
<td align="left"/>
</tr>
<tr>
<td align="left"/>
<td align="left">R, the time indexed instantaneous reward</td>
<td align="left"/>
</tr>
<tr>
<td align="left"/>
<td align="left">V, the time indexed reward prediction</td>
<td align="left"/>
</tr>
<tr>
<td align="left"/>
<td align="left"><italic>β</italic><sub><italic>learn</italic></sub>, the reverse rate used during learning</td>
<td align="left"/>
</tr>
<tr>
<td align="left"/>
<td align="left"><italic>α</italic>, the learning rate</td>
<td align="left"/>
</tr>
<tr>
<td align="left"/>
<td align="left"><italic>γ</italic>, the discount rate</td>
<td align="left"/>
</tr>
<tr>
<td align="left"/>
<td align="left">T, the time budget allocated to the replaylearn algorithm</td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>Output</bold></td>
<td align="left"/>
<td align="left"/>
</tr>
<tr>
<td align="left"/>
<td align="left">V, the time indexed reward prediction</td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>Algorithm</bold></td>
<td align="left"/>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>1</bold></td>
<td align="left"><bold>while</bold> T &gt; 0 <bold>do</bold></td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>2</bold></td>
<td align="left">    <bold>for all</bold> i∈{1,..,<italic>N</italic>} <bold>do</bold></td>
<td align="left"><italic>/* For all N time indices i in V */</italic></td>
</tr>
<tr>
<td align="left"><bold>3</bold></td>
<td align="left">        <inline-formula id="pcbi.1006624.e006"><alternatives><graphic id="pcbi.1006624.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mi mathvariant="normal">P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>←</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula></td>
<td align="left"><italic>/* Compute the snippet replay likelihood by normalizing the reward prediction V*/</italic></td>
</tr>
<tr>
<td align="left"><bold>4</bold></td>
<td align="left">      <bold>end for</bold></td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>5</bold></td>
<td align="left">    t←random(P)</td>
<td align="left"><italic>/* Select a random time index t by sampling from P distribution */</italic></td>
</tr>
<tr>
<td align="left"><bold>6</bold></td>
<td align="left">    r←random(U[0,1])</td>
<td align="left"><italic>/* Draw a random number r from the uniform distribution U[0</italic>, <italic>1] */</italic></td>
</tr>
<tr>
<td align="left"><bold>7</bold></td>
<td align="left">    <bold>if</bold> <italic>r</italic>&lt;B<sub><italic>learn</italic></sub> <bold>then</bold></td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>8</bold></td>
<td align="left">        <italic>τ</italic>←{<italic>t</italic>,<italic>t</italic>−1,…,max(1,<italic>t</italic>−<italic>s</italic>+1)}</td>
<td align="left"><italic>/* Define a snippet τ in reverse direction */</italic></td>
</tr>
<tr>
<td align="left"><bold>9</bold></td>
<td align="left">    <bold>else</bold></td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>10</bold></td>
<td align="left">        <italic>τ</italic>←{<italic>t</italic>,<italic>t</italic>+1,…,min(<italic>N</italic>,<italic>t</italic>+<italic>s</italic>)}</td>
<td align="left"><italic>/* Define a snippet τ in forward direction */</italic></td>
</tr>
<tr>
<td align="left"><bold>11</bold></td>
<td align="left">    <bold>end if</bold></td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>12</bold></td>
<td align="left">    <bold>for</bold> i <bold>in</bold> 2…<italic>length</italic>(<italic>τ</italic>) <bold>do</bold></td>
<td align="left"><italic>/* For all time indices i in snippet τ */</italic></td>
</tr>
<tr>
<td align="left"><bold>13</bold></td>
<td align="left">        <italic>V</italic>(<italic>τ</italic><sub><italic>i</italic></sub>)←<italic>α</italic>(<italic>R</italic>(<italic>τ</italic><sub><italic>i</italic>−1</sub>)+<italic>γV</italic>(<italic>τ</italic><sub><italic>i</italic>−1</sub>))+(1−<italic>α</italic>)<italic>V</italic>(<italic>τ</italic><sub><italic>i</italic></sub>)</td>
<td align="left"><italic>/* Apply a TD</italic>−<italic>λ algorithm on V by using successive time indices contained in τ)*/</italic></td>
</tr>
<tr>
<td align="left"><bold>14</bold></td>
<td align="left">      <bold>end for</bold></td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>15</bold></td>
<td align="left">    <italic>T</italic>←<italic>T</italic>−<italic>length</italic>(<italic>τ</italic>)</td>
<td align="left"><italic>/* compute the remaining time budget*/</italic></td>
</tr>
<tr>
<td align="left"><bold>16</bold></td>
<td align="left"><bold>end while</bold></td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>17</bold></td>
<td align="left"><bold>return</bold> V</td>
<td align="left"/>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Replay-learn algorithm pseudocode</p>
<p>The timespan and the direction of a snippet acts as a propagation vector during the estimation phase of the snippet replay likelihood. Line 13 of the <bold>replay-learn</bold> algorithm shows that V is updated as a convex combination of the current estimate of the reward information <italic>V</italic>(<italic>τ</italic><sub><italic>i</italic></sub>) at the next time step and the instantaneous reward information <italic>R</italic>(<italic>τ</italic><sub><italic>i</italic>−1</sub>)+<italic>γV</italic>(<italic>τ</italic><sub><italic>i</italic>−1</sub>) based on the previously observed reward signal <italic>R</italic>(<italic>τ</italic><sub><italic>i</italic>−1</sub>) and delayed previous reward estimate <italic>γV</italic>(<italic>τ</italic><sub><italic>i</italic>−1</sub>)). It implements a form of temporal difference learning. It is sufficient to define a coarse reward signal as:
<disp-formula id="pcbi.1006624.e007">
<alternatives>
<graphic id="pcbi.1006624.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:mi mathvariant="normal">R</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.25em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.25em"/><mml:mi>a</mml:mi><mml:mspace width="0.25em"/><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.25em"/><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.25em"/><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mspace width="0.25em"/><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.25em"/><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mspace width="0.25em"/><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>The results of this reward propagation is visualized in <xref ref-type="fig" rid="pcbi.1006624.g002">Fig 2C and 2E</xref>. Once the reward prediction is learned, it is used to generate snippets to train the PFC model. Note that this implies a reward prediction estimation phase described above, and a snippet generation phase, described below. For clarity we separate these phases, but they can be combined, by using the snippets generated in the estimation phase for training the PFC.</p>
</sec>
<sec id="sec007">
<title>Snippet generation during replay</title>
<p>The <bold>replay-generate</bold> algorithm is applied to the condensed version of the place-cell activation sequence that was previously encountered. This will result in the extraction of a set of snippets biased by the reward propagation. This set of snippets is a replay episode which models the place cell-activation observed during SWR in the inter-trial interval.</p>
<table-wrap id="pcbi.1006624.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006624.t003</object-id>
<alternatives>
<graphic id="pcbi.1006624.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.t003" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<tbody>
<tr>
<td align="left" colspan="3"><sc>Replay-generate</sc></td>
</tr>
<tr>
<td align="left"><bold>Input</bold></td>
<td align="left"/>
<td align="left"/>
</tr>
<tr>
<td align="left"/>
<td align="left">V, the time indexed reward prediction</td>
<td align="left"/>
</tr>
<tr>
<td align="left"/>
<td align="left"><italic>β</italic><sub><italic>generate</italic></sub>, the reverse rate used during snippet generation</td>
<td align="left"/>
</tr>
<tr>
<td align="left"/>
<td align="left">T, the time budget allocated to the replay-generate algorithm</td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>Output</bold></td>
<td align="left"/>
<td align="left"/>
</tr>
<tr>
<td align="left"/>
<td align="left">S the collection of generated snippets</td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>Algorithm</bold></td>
<td align="left"/>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>1</bold></td>
<td align="left"><bold>for all</bold> i∈{1,..,N<sub>k</sub>} <bold>do</bold></td>
<td align="left"><italic>/* For all N time indices i in V */</italic></td>
</tr>
<tr>
<td align="left"><bold>2</bold></td>
<td align="left">    <inline-formula id="pcbi.1006624.e008"><alternatives><graphic id="pcbi.1006624.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mi mathvariant="normal">P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>←</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula></td>
<td align="left"><italic>/* Compute the snippet replay likelihood P by normalizing the reward prediction V*/</italic></td>
</tr>
<tr>
<td align="left"><bold>3</bold></td>
<td align="left"><bold>end for</bold></td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>6</bold></td>
<td align="left"><italic>S</italic>←∅</td>
<td align="left"><italic>/* Initialize S as an empty collection */</italic></td>
</tr>
<tr>
<td align="left"><bold>9</bold></td>
<td align="left"><bold>while</bold> T &gt; 0 <bold>do</bold></td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>12</bold></td>
<td align="left">    t←random(P)</td>
<td align="left"><italic>/* Select a random time index t by sampling from P distribution */</italic></td>
</tr>
<tr>
<td align="left"><bold>13</bold></td>
<td align="left">    r←random(U[0,1])</td>
<td align="left"><italic>/* Draw a random number r from the uniform distribution U[0</italic>, <italic>1] */</italic></td>
</tr>
<tr>
<td align="left"><bold>14</bold></td>
<td align="left">    <bold>if</bold> <italic>r</italic>&lt;B<sub><italic>generate</italic></sub> <bold>then</bold></td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>15</bold></td>
<td align="left">        <italic>τ</italic>←{<italic>t</italic>,<italic>t</italic>−1,…,max(1,<italic>t</italic>−<italic>s</italic>+1)}</td>
<td align="left"><italic>/* Define a snippet τ in reverse direction */</italic></td>
</tr>
<tr>
<td align="left"><bold>16</bold></td>
<td align="left">      <bold>else</bold></td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>17</bold></td>
<td align="left">        <italic>τ</italic>←{<italic>t</italic>,<italic>t</italic>+1,…,min(<italic>N</italic>,<italic>t</italic>+<italic>s</italic>)}</td>
<td align="left"><italic>/* Define a snippet τ in forward direction */</italic></td>
</tr>
<tr>
<td align="left"><bold>18</bold></td>
<td align="left">      <bold>end if</bold></td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>19</bold></td>
<td align="left">    <italic>T</italic>←<italic>T</italic>−<italic>length</italic>(<italic>τ</italic>)</td>
<td align="left"><italic>/* compute the remaining time budget*/</italic></td>
</tr>
<tr>
<td align="left"><bold>22</bold></td>
<td align="left">    <italic>S</italic>←<italic>S</italic>∪<italic>τ</italic></td>
<td align="left"><italic>/* append snippet τ in S*/</italic></td>
</tr>
<tr>
<td align="left"><bold>23</bold></td>
<td align="left"><bold>end while</bold></td>
<td align="left"/>
</tr>
<tr>
<td align="left"><bold>24</bold></td>
<td align="left"><bold>return</bold> S</td>
<td align="left"/>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Replay-generate algorithm pseudocode</p>
<p>As indicated above, during a 2 minute (120 second) intertrial interval, we can assume that ~100 SWRs will occur, with ~10 cell sequences firing per SWRs across all the place cells with fields on the maze, yielding ~1000 snippets per replay episode. Thus, learning with 1000 snippets can be considered to take place in a biologically realistic timeframe. New in vivo imaging techniques after spatial navigation in such a multi goal tasks would be useful in refining these numbers.</p>
<p>These snippets will serve as inputs to the reservoir model of PFC described below. As illustrated in <xref ref-type="fig" rid="pcbi.1006624.g002">Fig 2D and 2E</xref>, the replay is biased by proximity to reward, which has been spatially propagated. Based on this reward propagation, the behavior generated by the model favors the shortest trajectories that cover the learned baited feeders. The propagation of reward is illustrated in <xref ref-type="fig" rid="pcbi.1006624.g002">Fig 2C and 2E</xref>. Panel C displays the 2D propagation of reward value backwards from the rewarded targets. Note that for short trajectories between rewards (e.g. sub-sequence ABC) there is a continuous dense reward distribution that will favor replay of this sub-sequence. For long meandering trajectories the reward density diminishes to zero (e.g. sub-sequence CE), thus disfavoring replay of snippets on these sub-sequences. Panel 2E displays the 1D equivalent view of the reward propagation. Again note the continuous high density of reward along ABC, vs. the discontinuities with zero reward values for the sub-sequences CED. Starting from feeders C, D or E, reward prediction is discontinuous and/or absent (replay likelihood is zero in areas along these segments) thus the PFC model will fail to consolidate a path along these segments.</p>
</sec>
</sec>
<sec id="sec008">
<title>Reservoir model of PFC for snippet consolidation</title>
<p>We model the prefrontal cortex as a recurrent reservoir network. Reservoir computing refers to a class of recurrent network models with fixed recurrent connections. The reservoir units are driven by external inputs and the network dynamics provides a high dimensional representation of the inputs from which the desired outputs can then be read out by a trained linear combination of the reservoir unit activities. The principle has been co-developed in distinct contexts as the temporal recurrent network [<xref ref-type="bibr" rid="pcbi.1006624.ref020">20</xref>], the liquid state machine [<xref ref-type="bibr" rid="pcbi.1006624.ref028">28</xref>], and the echo state network [<xref ref-type="bibr" rid="pcbi.1006624.ref026">26</xref>]. The version that we use to model the frontal cortex employs leaky integrator neurons in the recurrent network. This model of PFC is particularly appropriate because the recurrent network generates dynamic state trajectories that will allow overlapping snippets to have overlapping state trajectories. This property will favor consolidation of a whole sequence from its snippet parts. At each time-step, the network is updated according to the following schema:</p>
<p>The hippocampus place-cells project into the reservoir through feed-forward synaptic connections noted <italic>W</italic><sub><italic>ffwd</italic></sub>. The projection operation is a simple matrix-vector product. Hence, the input projection through feed-forward synaptic connections is defined by:
<disp-formula id="pcbi.1006624.e009">
<alternatives>
<graphic id="pcbi.1006624.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e009" xlink:type="simple"/>
<mml:math display="block" id="M9">
<mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula></p>
<p>Where:</p>
<list list-type="bullet">
<list-item><p><italic>W</italic><sub><italic>ffwd</italic></sub> is a fixed connectivity matrix whose values do not depend on time.</p></list-item>
</list>
<p>Synaptic weights are randomly selected at the beginning of the simulation. Practically speaking [<xref ref-type="bibr" rid="pcbi.1006624.ref042">42</xref>], sampling U[−1,1] a uniform distribution is sufficient. A positive synaptic weight in a connectivity matrix models an excitatory connection and a negative weight models an inhibitory connection between two neurons (that could be implemented via an intervening inhibitory interneuron). Let N be the number of neurons in the reservoir. Reservoir's neurons are driven by both sensory position inputs <italic>X</italic><sub><italic>in</italic></sub>(<italic>t</italic><sub><italic>n</italic></sub>) and, importantly by the recurrent connections that project an image of the previous reservoir state back into the reservoir. The recurrent projection is defined as:
<disp-formula id="pcbi.1006624.e010">
<alternatives>
<graphic id="pcbi.1006624.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e010" xlink:type="simple"/>
<mml:math display="block" id="M10">
<mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula></p>
<p>Where:</p>
<list list-type="bullet">
<list-item><p><italic>W</italic><sub><italic>rec</italic></sub> is a N by N square connectivity matrix.</p></list-item>
<list-item><p><italic>X</italic><sub><italic>res</italic></sub> is the reservoir activation (mean firing rate) (Eq (<xref ref-type="disp-formula" rid="pcbi.1006624.e016">10</xref>)</p></list-item>
</list>
<p>Synaptic weights are drawn from a U[−1,1] uniform distribution, scaled by a <inline-formula id="pcbi.1006624.e011"><alternatives><graphic id="pcbi.1006624.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>;</mml:mo><mml:mi>K</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msqrt><mml:mi>N</mml:mi></mml:msqrt></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> factor. The same sign convention as in Eq (<xref ref-type="disp-formula" rid="pcbi.1006624.e009">5</xref>) applies for the recurrent connectivity matrix.</p>
<p>Self-connections (i.e. <inline-formula id="pcbi.1006624.e012"><alternatives><graphic id="pcbi.1006624.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> with <italic>i</italic>∈1…<italic>N</italic>) are forced to zero. <italic>W</italic><sub><italic>rec</italic></sub> is also fixed and its values do not depend on time. The contributions of afferent neurons to the reservoir’s neurons is summarized by
<disp-formula id="pcbi.1006624.e013">
<alternatives>
<graphic id="pcbi.1006624.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e013" xlink:type="simple"/>
<mml:math display="block" id="M13">
<mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula></p>
<p>The membrane potential of the reservoir’s neurons <italic>P</italic><sub><italic>res</italic></sub> then is computed by solving the following ordinary derivative equation (ODE):
<disp-formula id="pcbi.1006624.e014">
<alternatives>
<graphic id="pcbi.1006624.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e014" xlink:type="simple"/>
<mml:math display="block" id="M14">
<mml:mi>τ</mml:mi><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula></p>
<p>Where:</p>
<list list-type="bullet">
<list-item><p><italic>τ</italic> is the neuron’s time constant. It models the resistive and capacitive properties of the neuron’s membrane.</p></list-item>
</list>
<p>In this article, we will consider a contiguous assembly of neurons that share the same time constant. The inverse of the time constant is called the leak rate and is noted <italic>h</italic>. By choosing the Euler’s forward method for solving Eq (<xref ref-type="disp-formula" rid="pcbi.1006624.e014">8</xref>), the membrane potential is computed recursively by the equation:
<disp-formula id="pcbi.1006624.e015">
<alternatives>
<graphic id="pcbi.1006624.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e015" xlink:type="simple"/>
<mml:math display="block" id="M15">
<mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>*</mml:mo><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula></p>
<p>This is a convex combination between instantaneous contributions of afferents neurons <italic>U</italic><sub><italic>res</italic></sub>(<italic>t</italic><sub><italic>n</italic></sub>) and the previous value <italic>P</italic><sub><italic>res</italic></sub>(<italic>t</italic><sub><italic>n</italic>−1</sub>) of the membrane potential. The current membrane potential state carries information about the previous activation values of the reservoir, provided by the recurrent weights. The influence of the history is partially controlled by the leak rate. A high leak rate will result in a responsive reservoir with a very limited temporal memory. A low leak rate will result in a slowly varying network whose activation values depend more on the global temporal structure of the input sequence.</p>
<p>Finally, the mean firing rate of a reservoir’s neuron is given by:
<disp-formula id="pcbi.1006624.e016">
<alternatives>
<graphic id="pcbi.1006624.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e016" xlink:type="simple"/>
<mml:math display="block" id="M16">
<mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula></p>
<p>Where:</p>
<list list-type="bullet">
<list-item><p>σ<sub><italic>res</italic></sub> is the non-linear activation function of the reservoir neurons</p></list-item>
<list-item><p><italic>Θ</italic><sub><italic>res</italic></sub> is a bias that will act as a threshold for the neuron’s activation function.</p></list-item>
</list>
<p>We chose a σ<sub><italic>res</italic></sub>≡<italic>tanh</italic> hyperbolic tangent activation function with a zero bias for <italic>Θ</italic><sub><italic>res</italic></sub>. Negative firing rate values represent the inhibitory/excitatory connection type in conjunction with the sign of the synaptic weight. Only the product of the mean firing rate of the afferent neuron by its associated synaptic weight is viewed by the leaky integrator neuron. See <xref ref-type="supplementary-material" rid="pcbi.1006624.s001">S1 Text</xref> High dimensional processing in the reservoir for more details on interpreting activity in the reservoir.</p>
<sec id="sec009">
<title>Learning in modifiable PFC connections to readout</title>
<p>Based on the rich activity patterns in the reservoir, it is possible to decode the reservoir's state in a supervised manner in order to produce the desired output as a function of the input sequence. This decoding is provided by the readout layer and the matrix of modifiable synaptic weights linking the reservoir to the readout layer, noted <italic>W</italic><sub><italic>ro</italic></sub> and represented by dash lines in <xref ref-type="fig" rid="pcbi.1006624.g003">Fig 3</xref>.</p>
<fig id="pcbi.1006624.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006624.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Reservoir computing model.</title>
<p>The Temporal Recurrent Network (TRN) is a model of the prefrontal cortex (PFC) that takes into account cortico-cortical loops by defining a fixed recurrent adjacency matrix for the leaky integrator neurons that model PFC neurons. Inputs of the TRN are modelled hippocampus (HIPP) place-cells. During the training phase, place-cells activations are provided by the algorithmic model of SWR replay (red pathway), and the striatum model learns to predict the next place-cell activation from the PFC model states by modifying the synaptic weights that project the PFC model into the striatum model according to the delta learning rule. During the generation phase, the model is no longer learning and the place-cell activation patterns result from the new position of the agent, reconstructed with a Bayesian algorithm from the next place-cell activation prediction of the modeled striatum (blue pathway).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.g003" xlink:type="simple"/>
</fig>
<p>The readout activation pattern <italic>X</italic><sub><italic>ro</italic></sub>(<italic>t</italic><sub><italic>n</italic></sub>) is given by the equation:
<disp-formula id="pcbi.1006624.e017">
<alternatives>
<graphic id="pcbi.1006624.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e017" xlink:type="simple"/>
<mml:math display="block" id="M17">
<mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula></p>
<p>Where:</p>
<list list-type="bullet">
<list-item><p>σ<sub><italic>ro</italic></sub> is the non-linear activation function of the readout neurons</p></list-item>
<list-item><p><italic>Θ</italic><sub><italic>ro</italic></sub> is a bias that will act as a threshold for the neuron’s activation function</p></list-item>
</list>
<p>We chose a σ<sub><italic>ro</italic></sub>≡<italic>tanh</italic> hyperbolic tangent activation function with a zero bias for <italic>Θ</italic><sub><italic>ro</italic></sub>.</p>
<p>Notice that the update algorithm described above is a very particular procedure inherited from feedforward neural networks. We chose to use it because it is computationally efficient and deterministic.</p>
<p>Once the neural network states are updated, the readout synaptic weights are updated by using a stochastic gradient descent algorithm. By deriving the Widrow-Hoff Delta rule [<xref ref-type="bibr" rid="pcbi.1006624.ref043">43</xref>] for hyperbolic tangent readout neurons, we have the following update equation:
<disp-formula id="pcbi.1006624.e018">
<alternatives>
<graphic id="pcbi.1006624.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e018" xlink:type="simple"/>
<mml:math display="block" id="M18">
<mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>*</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>*</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula></p>
<p>Where:</p>
<list list-type="bullet">
<list-item><p><italic>α</italic> is a small positive constant called the learning rate</p></list-item>
<list-item><p><italic>t</italic><sub><italic>n</italic>−<italic>b</italic>+1</sub>→<italic>t</italic><sub><italic>n</italic></sub> is the concatenation of b time steps from <italic>t</italic><sub><italic>n</italic>−<italic>b</italic>+1</sub> to <italic>t</italic><sub><italic>n</italic></sub></p></list-item>
</list>
<p>When <italic>b</italic> = 1, Eq (<xref ref-type="disp-formula" rid="pcbi.1006624.e018">12</xref>) computes a stochastic gradient descent. The case when <italic>b</italic>&gt;1 is called a mini-batch gradient descent and allows one to estimate the synaptic weight gradient base on b successive observations of predicted and desired activation values. A mini batch gradient allows one to compute efficiently and robustly the synaptic weight gradient. Empirically, <italic>b</italic> = 32 gives satisfying results.</p>
<p>In this study, we will focus on the prediction of the next place-cell activation pattern (<italic>X</italic><sub><italic>des</italic></sub>):
<disp-formula id="pcbi.1006624.e019">
<alternatives>
<graphic id="pcbi.1006624.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e019" xlink:type="simple"/>
<mml:math display="block" id="M19">
<mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula></p>
<p>This readout is considered to take place in the striatum, as part of a cortico-striatal learning system. This is consistent with data indicating that while hippocampus codes future paths, the striatum codes actual location [<xref ref-type="bibr" rid="pcbi.1006624.ref044">44</xref>].</p>
</sec>
<sec id="sec010">
<title>Training</title>
<p>The model is trained using a dataset, typically 1000 snippets, that is generated by the snippet replay mechanism described above in the paragraph on Hippocampus replay. The snippet dataset is generated from trajectories that were run in previous trials. In the consolidation experiments, the previous trials correspond to the trajectories illustrated in <xref ref-type="fig" rid="pcbi.1006624.g001">Fig 1B–1D</xref>. The readout synaptic weights are learned online by using the learning rule described in the Learning in Modifiable PFC Connections to Readout section. The model does not receive any form of feedback from the environment and it learns place-cell activation sequences based only on random replay of snippets.</p>
<p>Between each sequence of the training set (snippets in our case), the states of the reservoir and readout are set to a small random uniform value centered on zero. This models a time between the replays of two snippets that is sufficiently long for inducing states in the neural network that are not correlated with the previous stimulus. This is required for having the same effect as simulating a longer time after each snippet but without having to pay the computational cost associated to this extra simulation time.</p>
</sec>
</sec>
<sec id="sec011">
<title>Embodied simulation of sensory-motor loop via the spatial filter</title>
<p>Once the model is trained, we need to evaluate its performance and the trajectories it can generate. The model is primed with the first <italic>p</italic> steps of the place-cell activation sequence the model is supposed to produce. This sequence is called the target sequence. Then the model’s ability to generate a place-cell activation sequence is evaluated by injecting the output prediction of the next place-cell activation pattern as the input at the next step. In this iterative procedure, the system should autonomously reproduce the trained sequence pattern of place-cell activations.</p>
<p>Predicted place-cell activation values might be noisy, and the reinjection of even small amounts of noise in this autonomous generation procedure can lead to divergence. We thus employ a procedure that determines the location coded by the place-cell activation vector output, and reconstructs a proper place-cell activation vector coding this location. We call this denoising procedure the spatial filter as referred to in <xref ref-type="fig" rid="pcbi.1006624.g003">Fig 3</xref>.</p>
<p>We model the rat action as ‘reaching the most probable nearby location’. Since only the prediction of the next place-cell activation pattern <italic>η</italic> is available, we need to estimate the most probable point <italic>s</italic>*(<italic>t</italic><sub><italic>n</italic>+1</sub>) = (<italic>x</italic>*(<italic>t</italic><sub><italic>n</italic>+1</sub>),<italic>y</italic>*(<italic>t</italic><sub><italic>n</italic>+1</sub>)). From a Bayesian point of view, we need to determine the most probable next location <italic>s</italic>(<italic>t</italic><sub><italic>n</italic>+1</sub>), given the current location <italic>s</italic>(<italic>t</italic><sub><italic>n</italic></sub>) and the predicted place-cell activation pattern <italic>η</italic>(<italic>t</italic><sub><italic>n</italic></sub>). We can state our problem as:
<disp-formula id="pcbi.1006624.e020">
<alternatives>
<graphic id="pcbi.1006624.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e020" xlink:type="simple"/>
<mml:math display="block" id="M20">
<mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>η</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>u</mml:mi>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula></p>
<p>Where:</p>
<list list-type="bullet">
<list-item><p><italic>u</italic> is a noise function sampling a uniform distribution <inline-formula id="pcbi.1006624.e021"><alternatives><graphic id="pcbi.1006624.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mi mathvariant="script">U</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula></p></list-item>
</list>
<p><italic>u</italic> is useful at least in degenerate cases when a zero place-cell activation prediction generates an invalid location coding. It is also used for biasing the generation procedure and to explore other branches of the possible trajectories the model can generate as described in section Evaluating Behavior with Random walk.</p>
<p>The system is then moved to this new location <italic>s</italic>* and a new noise/interference free place-cell activation pattern is generated by the place-field model. We refer to this place-cell prediction/de-noising method as the spatial filter, which emulates a sensory-motor loop for the navigating rat in this study. <xref ref-type="fig" rid="pcbi.1006624.g003">Fig 3</xref> depicts this sensory motor loop.</p>
</sec>
<sec id="sec012">
<title>Evaluating behavior with random walk</title>
<p>Once the model has been trained, it is then primed with place-cell activation inputs corresponding to the first few steps of the trajectory to be generated. The readout from the PFC reservoir generates the next place-cell activation pattern in the trajectory, which is then reinjected into the reservoir via the spatial filter, in a closed loop process. This loop evaluation procedure is called <italic>autonomous</italic> generation. In order to evaluate the model in a particular experimental condition, several instances of the same model are evaluated multiple times in a random walk procedure. The batch of generated trajectories (typically 1000) are accumulated in a stencil buffer which acts as a two dimensional histogram showing the most frequently generated trajectories. The arena is drawn with its feeders and a vector field is computed from trajectories in order to show the main direction of these trajectories. Trajectories are superimposed and summed, resulting in a two-dimensional histogram representing the space occupied by trajectories. <xref ref-type="fig" rid="pcbi.1006624.g004">Fig 4</xref> shows an example of random walk trajectories, illustrating the model’s ability to autonomously generate a long and complex sequence when learning without snippets. <xref ref-type="fig" rid="pcbi.1006624.g004">Fig 4B</xref> illustrates a 2D histogram formed by superimposing trajectories autonomously generated by 1000 reservoirs evaluated ten times each with noise, in order to validate the robustness of the behavior.</p>
<fig id="pcbi.1006624.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006624.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Sequence learning.</title>
<p>Panel A illustrates a long convoluted trajectory taken by a rat in configuration 38. Panel B illustrates the probability maps of trajectories generated by the trained model in autonomous sequence generation mode. The 2D trajectory histogram is generated by superposing the trajectories generated when 10 batches of 100 reservoirs each were trained and each model instance was evaluated 10 times with noise. Note that there are two locations where the trajectory crosses itself. At the point of crossing, there are two possible paths that preserve path continuity. The system has memory of the context of how it got to that intersection point, and thus can continue on that trajectory. This illustrates that the model is well able to learn such complex sequences.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.g004" xlink:type="simple"/>
</fig>
<p>In cases where small errors in the readout are reinjected as input, they can be amplified, causing the trajectory to diverge. It is possible to overcome this difficulty by providing as input the expected position at each time step instead of the predicted position. The error/distance measurement can still be made, and will quantify the diverging prediction, while allowing the trajectory generation to continue. This method is called <italic>non-autonomous</italic> generation and it evaluates only the ability of a model to predict the next place-cell activation pattern, given an input sequence of place-cell activations.</p>
</sec>
<sec id="sec013">
<title>Comparing produced and ideal sequences using discrete Fréchet distance</title>
<p>The joint PFC-HIPP model can be evaluated by comparing an expected place-cell firing pattern with its prediction by the readout layer. At each time step, an error metric is computed and then averaged over the duration of the expected neurons firing rate sequence. The simplest measure is the mean square error. This is the error that the learning rule described in Eq (<xref ref-type="disp-formula" rid="pcbi.1006624.e018">12</xref>) minimizes.</p>
<p>Although the model output is place-cell coding, what is of interest is the corresponding spatial trajectory. A useful measurement in the context of comparing spatial trajectories is the discrete Fréchet distance. It is a measure of similarity between two curves that takes into account the location and ordering of the points along the curve. We use the discrete Fréchet distance applied to polygonal curves as initially described in Eiter and Mannila [<xref ref-type="bibr" rid="pcbi.1006624.ref045">45</xref>]. In [<xref ref-type="bibr" rid="pcbi.1006624.ref046">46</xref>] the Discrete Fréchet distance <italic>F</italic> between two curves <italic>A</italic> and <italic>B</italic> is defined by:
<disp-formula id="pcbi.1006624.e022">
<alternatives>
<graphic id="pcbi.1006624.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e022" xlink:type="simple"/>
<mml:math display="block" id="M22">
<mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">β</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo>[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">β</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula></p>
<p>Where <italic>d</italic>(.,.) is the Euclidean distance, <italic>m</italic> is the number of steps of the curve A, <italic>n</italic> is the number of steps of the curve B, and <italic>α</italic>,<italic>β</italic> are reparametrizations of the curves A and B. Parameterization of this measure is described in more detail in <xref ref-type="supplementary-material" rid="pcbi.1006624.s001">S1 Text</xref> Frechet distance parameters.</p>
</sec>
</sec>
<sec id="sec014" sec-type="results">
<title>Results</title>
<p>For robustness purposes, results are based on a population of neural networks rather than a single instance. The population size is usually 1000 for evaluating a condition and the metrics described above are aggregated by computing their mean <italic>μ</italic>(.) and standard-deviation <italic>σ</italic>(.). For convenience, we define a custom score function associated to a batch of coherent measurements as:
<disp-formula id="pcbi.1006624.e023">
<alternatives>
<graphic id="pcbi.1006624.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006624.e023" xlink:type="simple"/>
<mml:math display="block" id="M23">
<mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>μ</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula></p>
<p>Results having a low mean and standard deviation will be reported as low score whilst other possible configurations will result in a higher score. We chose this method rather than Z-score, which penalizes low standard deviations. We first established that the model displays standard sequence learning capabilities (e.g. illustrated in <xref ref-type="fig" rid="pcbi.1006624.g004">Fig 4</xref>) and studied parameter sensitivity (see <xref ref-type="supplementary-material" rid="pcbi.1006624.s001">S1 Text</xref> Basic Sequence learning and parameter search), and then addressed consolidation from replay.</p>
<sec id="sec015">
<title>Consolidation from snippet replay</title>
<p>The model is able to learn and generate navigation sequences from place-cell activation patterns. The important questions is whether a sequence can be learned by the same model when it is trained on randomly presented snippets, instead of the continuous sequence.</p>
<p>In this experiment, no reward is used, and thus each snippet has equal chance of being replayed. The only free parameter is the snippet size. In order to analyze the reservoir response, we collect the state-trajectories of reservoir neurons when exposed to snippets. Recall that the internal state of the reservoir is driven by the external inputs, and by recurrent internal dynamics, thus the reservoir adopts a dynamical state-trajectory when presented with an input sequence. Such a trajectory is visualized in <xref ref-type="fig" rid="pcbi.1006624.g005">Fig 5D</xref>. This is a 2D (low dimensional) visualization, via PCA, of the high dimensional state transitions realized by the 1000 neurons reservoir as the input sequence corresponding to ABCDE is presented. Panels A-C illustrate the trajectories that the reservoir state traverses as it is exposed to an increasing number of randomly selected snippets generated for the same ABCDE sequence. We observe that as snippets are presented, the corresponding reservoir state-trajectories start roughly from the same point because of the random initial state of the reservoir before each snippet is replayed. Then the trajectories evolve and partially overlap with the state-trajectory produced by the complete sequence. In other words, snippets quickly drive the reservoir state from an initial random activation (corresponding to the grey area at the center of each panel) onto their corresponding locations in the reservoir activation state-trajectory of the complete sequence. Replaying snippets at random allows the reservoir to reconstruct the original intact reservoir state trajectory because the reservoir states overlap when snippet trajectories overlap.</p>
<fig id="pcbi.1006624.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006624.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Illustration of snippet integration in reservoir state space.</title>
<p>Here we visualize the high dimensional reservoir space in a low (2D) PCA space, in order to see how pieces (snippets) of the overall sequence are consolidated. In this experiment, the sequence ABCDE is broken into snippets, which are then used to train the model. The challenge is that only local structure is presented to the model, which must consolidate the global structure. Panels A-C represent the state trajectory of reservoir activation after 100, 1000 and 10000 snippets. While each snippet represents part of the actual trajectory, each is taken out of its overall spatial context in the sequence. Panel D represents the trajectory of reservoir state during the complete presentation of the intact sequence. Panel C reproduces this trajectory, but in addition we see “ghost” trajectories leading to the ABCDE trajectory. These ghost elements represent the reservoir state transitions from an initial random state as the first few elements of each snippet take the reservoir from the initial undefined state onto the component of the ABCDE trajectory coded by that snippet.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.g005" xlink:type="simple"/>
</fig>
<p>Thus, we see that the state trajectories traversed by driving the reservoir with snippets overlaps with those from the original intact sequence. As illustrated in 5A and 5B, 100 to 1000 snippets are required for allowing the consolidation to occur in the readout layer with the learning rule described in Eq (<xref ref-type="disp-formula" rid="pcbi.1006624.e018">12</xref>). A smaller learning error is achieved with 10000 snippets because the reservoir states that correspond to the whole sequence depicted in panel D are observed more often and the error gradient corrected more often by modifying the readout synaptic weights. See further details of sequence learning by snippet replay in <xref ref-type="supplementary-material" rid="pcbi.1006624.s001">S1 Text</xref> Sequence complexity effects on consolidation.</p>
</sec>
<sec id="sec016">
<title>Longer paths are rejected</title>
<p>Here we examine how using reward proximity to modulate snippet replay probability distributions (as described in the hippocampal replay description) allows the rejection of longer, inefficient paths between rewarded targets. In this experiment, 1000 copies of the model are run 10 times. Each is exposed to the reward modulated replay of two sequences ABC and ABD having a common prefix AB as illustrated in <xref ref-type="fig" rid="pcbi.1006624.g006">Fig 6</xref>. The model is trained on snippets replayed from trajectories ABC and ABD. The random replay is not uniform and takes into account the reward associated with a baited feeder when food was consumed, as describe in the Hippocampal Replay section above. Effectively, snippets close to a reward have more chance to be replayed and thus to be consolidated into a trajectory.</p>
<fig id="pcbi.1006624.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006624.g006</object-id>
<label>Fig 6</label>
<caption>
<title/>
<p>Longer paths are rejected (left), and stronger rewards are favored (right). Panels A and B illustrate snippet counts for T maze trajectories pictured in panels C and D. In Panel C, sequences begin at location A, and rewards are given at locations C and D. Based on the reward proximity and propagation, there is a higher probability of snippets being selected along path AC than path AD. This is revealed in panel A, a histogram of snippets for the sequences ABC (in Blue) and ABD (in Orange). Panels B and D illustrate how distance and reward intensity interact. By increasing the strength of the reward, a longer trajectory can be rendered virtually shorter and more favored, by increasing the probability that snippets will be selected from this trajectory, as revealed in Panel B. Panels C and D reveal the 2D trajectory histograms generated by superposing the trajectories generated when 10 batches of 100 reservoirs each were trained and each model instance was evaluated 10 times with noise. Panel E and F confirm a robust tendency to generate autonomously sequences significantly similar to the ABC and ABD sequence respectively (p-value = 0).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.g006" xlink:type="simple"/>
</fig>
<p>Panel A in <xref ref-type="fig" rid="pcbi.1006624.g006">Fig 6</xref> illustrates the distribution of snippets selected from the two sequences, ABC in pink and ABD in blue. At the crucial point of choice at location B, the distribution of snippets for sequence ABC largely outnumbers those for sequence ABD. This is due to the propagation of rewards respectively from points C and D. Per design, rewards propagated from a more proximal location will have a greater influence on snippet generation. Panel C shows the 2D histogram of autonomously generated sequences when the model is primed with the initial sequence prefix starting at point A. We observe a complete preference for the shorter sequence ABC illustrated in panel E.</p>
<p>The snippet generation model described above takes into account the location of rewards, and the magnitude of rewards. Panel B illustrates the distribution of snippets allocated to paths ABC and ABD when a 10x stronger reward is presented at location D. This strong reward dominates the snippet generation and produces a distribution that strongly favors the trajectory towards location D, despite its farther distance. Panel F illustrates the error measures for model reconstruction of the two sequences and confirms this observation. This suggests an interesting interaction between distance and reward magnitude. For both conditions, distances to the expected sequence have been measured for every trajectory generated (10 000 for ABC and 10 000 for ABD). Then a Kruskall Wallis test confirms (p-value ~ = 0) for both cases that trajectories generated autonomously are significantly more accurate for the expected trajectories (i.e. ABC when rewards are equal and ABD when reward at D is x10).</p>
</sec>
<sec id="sec017">
<title>Novel efficient sequence creation</title>
<p>Based on the previously demonstrated dynamic properties, we determined that when rewards of equal magnitudes are used, the model would favor shorter trajectories between rewards. We now test the model’s ability to exploit this capability, in order to generate a novel and efficient trajectory from trajectories that contain sub-paths of the efficient trajectory. That is, we determine whether the model can assemble the efficient sub-sequences together, and reject the longer inefficient sub-sequences in order to generate a globally efficient trajectory. <xref ref-type="fig" rid="pcbi.1006624.g001">Fig 1</xref> (Panel A) illustrates the desired trajectory that should be created without direct experience, after experience with the three trajectories in panels B-D that each contain part of the optimal trajectory (red), which will be used to train the model.</p>
<p>The reward-biased replay is based on the following trajectories: (1) <underline>ABC</underline>ED that contains the ABC part of the ABCDE target sequence, (2) E<underline>BCD</underline>A that contains the BCD part of the ABCDE target sequence, and (3) BA<underline>CDE</underline> that contains the CDE part of the ABCDE target sequence. <xref ref-type="fig" rid="pcbi.1006624.g007">Fig 7A</xref> illustrates how the hippocampal replay model generates distributions of snippets that significantly favor the representation of the efficient sub-sequences of each of the three training sequences. This is revealed as the three successive peaks of snippet distributions on the time histogram for the blue (<underline>ABC</underline>ED) sequence, favoring its initial part ABC, the yellow (E<underline>BCD</underline>A) sequence, favoring its middle part BCD, and the pink (BA<underline>CDE</underline>) sequence, favoring its final part CDE. When observing each of the three color-coded snippet distributions corresponding to each of the three sequences we see that each sequence is favored (with high replay density) precisely where it is most efficient. Thus, based on this distribution of snippets that is biased towards the efficient sub-sequences, the reservoir should be able to extract the efficient sequence.</p>
<fig id="pcbi.1006624.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006624.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Efficient sequence synthesis.</title>
<p>A. Distribution of snippets drawn from the sequences illustrated in <xref ref-type="fig" rid="pcbi.1006624.g001">Fig 1B, 1C and 1D</xref>. Globally we observe snippet selection favors snippets from the beginning of sequence ABCED (blue), the middle of EBCDA (yellow), and the end of sequence BACDE (pink), which corresponds exactly to the efficient sub-sequences (ABC, BCD, and CDE) of these three sequences. This distribution of snippets is used to train the model. The results of the training are illustrated in panel B. Here we see a 2D histogram of sequences generated by the model in the ABCDE recombination experiment. The 2D trajectory histogram is generated by superposing the trajectories generated when 10 batches of 100 reservoirs each were trained and each model instance was evaluated 10 times with noise. Panel C displays the Frechet distance between the autonomously generated sequence and the four reference sequences. Kruskal-Wallis comparison confirms that the trajectories generated autonomously are significantly more similar to the target sequence ABCDE than to the experienced non-efficient sequences (p &lt; 0.0001).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.g007" xlink:type="simple"/>
</fig>
<p>Reservoir learning is illustrated in <xref ref-type="fig" rid="pcbi.1006624.g007">Fig 7B</xref>, which displays the autonomously generated sequences for 1000 instances of the model executed 10 times each. Training is based on 1000 snippets of length 10 selected from the distribution illustrated in <xref ref-type="fig" rid="pcbi.1006624.g007">Fig 7A</xref>. The spatial histogram reveals that the model is able to extract and concatenate the efficient sub-sequences to create the optimal path, though it was never seen in its entirety in the input. Panel C illustrate the significant differences in performance between the favored efficient sequence vs. the three that contain non-efficient sub-sequences. A Kruskal-Wallis test confirms these significant differences in reconstruction error for the efficient vs non-efficient sequences (maximum p = 5.9605e-08). These robust results demonstrate that our hypothesis for efficient sequence discovery based on reward-modulated replay is validated.</p>
</sec>
<sec id="sec018">
<title>Reverse replay</title>
<p>In [<xref ref-type="bibr" rid="pcbi.1006624.ref001">1</xref>], hippocampus replay during SWR is characterized by the activation order of the place-cells which occurs in backward and forward direction. We hypothesize that reverse replay allows the rat to explore a trajectory in one direction but consolidate it in both directions. This means that an actual trajectory, and its unexplored reverse version, can equally contribute to new behavior. Thus fewer actual trajectories are required for gathering information for solving the TSP problem. A systematic treatment of this effect on learning can be seen in <xref ref-type="supplementary-material" rid="pcbi.1006624.s001">S1 Text</xref> Analysis of different degrees of reverse replay.</p>
<p>We now investigate how reverse replay can be exploited in a recombination task where some sequences are experienced in the forward direction, and others in the reverse direction, with respect to the order of the sequence to be generated. We use the same setup as described above for novel sequence generation, but we invert the direction of sequence EBCDA in the training set. Without EBCDA, the model is not exposed to sub trajectories linking feeders B to C and C to D and the recombination cannot occur. We then introduce a partial reverse replay, which allows snippets to be played in forward and reverse order. This allows the reservoir to access segments BC and CD (even though they are not present in the forward version of the experienced trajectory.</p>
<p><xref ref-type="fig" rid="pcbi.1006624.g008">Fig 8</xref> illustrates the histogram of sequence performance for 10000 runs of the model (1000 models run 10 times each) on this novel sequence generation task with and without 50% reverse replay. We observe a significant shift towards reduced errors (i.e. towards the left) in the presence of reverse replay.</p>
<fig id="pcbi.1006624.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006624.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Reverse replay facilitates efficient sequence discovery.</title>
<p>Using the same sequences illustrated in <xref ref-type="fig" rid="pcbi.1006624.g001">Fig 1</xref>, we reversed the direction of sequence EBCDA, and then tested the model’s ability to synthesize the ABCDE sequence from <underline>ABC</underline>ED A<underline>CDB</underline>E and BA<underline>CDE</underline>. A. Error reduction with reverse replay. B. Effects of reverse replay in generation and learning.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.g008" xlink:type="simple"/>
</fig>
<p>We then examine a more realistic situation based on the observation of spontaneous creation of “shortcuts” described in [<xref ref-type="bibr" rid="pcbi.1006624.ref047">47</xref>]. The model is exposed to a random replay of snippets extracted from two trajectories having different direction (clockwise CW and counter clockwise CCW). The system thus experiences different parts of the maze in different directions. We examine whether the use of reverse replay can allow the system to generate novel shortcuts.</p>
<p>The left and right trajectories used for training are illustrated in <xref ref-type="fig" rid="pcbi.1006624.g009">Fig 9A and 9B</xref>. In A, the system starts at MS, head up and to the left at T2 (counter clockwise) and terminates back at MS. In B, up and to the right (clockwise) again terminating at MS. Possible shortcuts can take place at the end of a trajectory at MS as the system continues on to complete the whole outer circuit rather than stopping at MS. We can also test for shortcuts that traverse the top part of the maze by starting at MS and heading left or right and following the outer circuit in the CW or CCW direction, thus yielding 4 possible shortcuts. The model is trained with snippets from the sequences in A and B using different random replay rates, and evaluated in non-autonomous mode with sequences representing the 4 possible types of shortcut. <xref ref-type="fig" rid="pcbi.1006624.g009">Fig 9C</xref> shows with no reverse replay, when attempting the CCW path, there is low error until the system enters the zone that has only been learned in the CW direction. There, the system displays clear deviations from the desired path. In the non-autonomous evaluation mode used in this experiment, after each response, the system is provided with the desired next location, which in this case creates a zigzag effect, corresponding to the spatial error. In panel D, with 50% reverse replay, this error is reduced and the system can perform the shortcut without having experienced the right hand part in the correct direction. Thus, in the right hand part of the maze, it is as if the system had experienced this already in the CCW direction, though in reality this has never occurred, but is simulated by the reverse replay. This illustrates the utility of mixed forward and reverse replay. Panel E illustrates the difficulty when 100% reverse replay is used. <xref ref-type="fig" rid="pcbi.1006624.g009">Fig 9F</xref> illustrates the reconstruction errors for a shortcut path as a function of degree of reverse. The trajectory is evaluated in non-autonomous mode and the position of the agent necessarily follows the target trajectory. In this case, the expected trajectory describes a CCW path. Results are not significantly different with a replay rate 25% and 75% (p = 0.02), where the best performance is observed, and all the other conditions are significantly different (p ≤ 1.1921e-07). This phenomenon was obtained for the 4 possible shortcuts.</p>
<fig id="pcbi.1006624.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006624.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Reverse replay allows novel shortcut path generation.</title>
<p>Panels A and B illustrate the trajectories for left and right trajectories, based on Gupta et al. After training on these two trajectories, we test the ability to generate a shortcut that makes the complete outer loop in one direction. Panel C–without reverse replay, significant spatial errors are revealed when the system attempts to complete the counter-clockwise loop on the right side of the maze. Panel D illustrates the beneficial effects of reverse replay during trajectory learning. Panel E illustrates the effect of a model training with 100% reverse replay. It is similar to using 0% reverse replay but the effect is observed on the left lap trajectory part. Panel F–when reverse replay is introduced, this error is attenuated.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.g009" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec019">
<title>Effects of consolidation and reverse replay</title>
<p>The model demonstrates the ability to accumulate and consolidate paths over multiple trials, and to exploit reverse replay. Here we examine these effects on the more extensive and variable dataset extracted from rat behavior [<xref ref-type="bibr" rid="pcbi.1006624.ref013">13</xref>]. We show the positive effects of replay on trajectories from rats trying to optimize spatial navigation in the TSP task. In the prototypical TSP behavior, in a given configuration of baited wells, on successive trials the rat traverses different efficient sub-sequences of the overall efficient sequence, and then finally puts it all together and generates the efficient sequence. This suggests that as partial data about the efficient sequence are successively accumulated, the system performance will successively improve. To explore this, the model is trained on navigation trajectories that were generated by rats in the TSP task. We selected data from configurations where the rats found the optimal path after first traversing sub-sequences of that path in previous trials. Interestingly, these data contain examples where the previous informative trials include traversal of part of the optimal sequence in either the forward or reverse directions, and sometimes both (see S Rat navigation data). We trained the model with random replay of combinations of informative trials where informative trials are successively added, in order to evaluate the ability of the model to successively accumulate information. For each combination of informative trials, the random replay is evaluated with 0%, 25%, 50%, 75% and 100% of reverse replay rate in order to assess the joint effect of random replay and combination of informative trials. The model is then evaluated in non-autonomous mode with the target sequences that consist in a set of trajectories linking the baited feeders in the correct order. An idealized sequence is added to the target sequence set because trajectories generated by the rat might contain edges that do not relate the shortest distance between two vertices. Agent’s moves are restricted to a circle having a 10 cm radius.</p>
<p><xref ref-type="fig" rid="pcbi.1006624.g010">Fig 10</xref> illustrates the combined effects of successive integration of experience and its contribution to reducing error, and of the presence of different mixtures of forward and reverse replay. The ANOVA revealed that there is a significant effect for combination (F(2, 585) = 32.84, p &lt; 0.01), as performance increases with exposure to more previous experience (Panel A). There is also a significant effect for reverse replay rate (F(4, 585) = 3.71, p ≤ 0.01), illustrated in Panel B. There was no significant interaction between consolidation and replay direction (F(8, 585) = 0.03, p = 1). This indicates that when trained on trajectories produced by behaving rats, the model displays the expected behavior of improving with more experience, and of benefitting from a mixture of forward and reverse replay.</p>
<fig id="pcbi.1006624.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006624.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Consolidation and reverse replay applied to behavioral data.</title>
<p>Measured variable is Frechet distance between generated and desired sequence. Data from the rat TSP configurations are used for training and testing the model. A. Effects of consolidation: as successive trials are added to the replay repertoire; the trajectory reconstruction error is significantly reduced. B. Effects of reverse replay: as reverse replay is introduced in snippet formation for training the PFC model, reconstruction error is significantly reduced.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.g010" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec020" sec-type="conclusions">
<title>Discussion</title>
<p>We tested the hypothesis that hippocampus replay observed during sharp wave ripple events in the awake animal can play a role in learning by exposing the prefrontal cortex between successive trials to short sub-sequences of place-cell activation patterns. This replay can potentially play a crucial role in learning, essentially by generating synthetic data (based on experience) for training the system. The behavior of interest is a form of spatial navigation trajectory optimization in a task, mimicking the well-known traveling salesperson problem. It is a NP-Hard (non-polynomial) problem and finding an exact solution would require significant time and computing resources. Nevertheless, it has been observed that a rat was able to quickly find good solutions of simplified versions of this problem [<xref ref-type="bibr" rid="pcbi.1006624.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1006624.ref048">48</xref>]. The idea of exploiting replay in navigation sequence learning has been demonstrated to have a positive influence on learning [<xref ref-type="bibr" rid="pcbi.1006624.ref017">17</xref>], and here we go beyond this by further exploiting reward structure in the replay.</p>
<p>In the behavior of interest, rats are observed to converge quickly to a near-optimal path linking 5 baited food wells in a 151cm radius open arena. During their successive approximation to the optimal path, the rats often traversed segments of the optimal trajectory, as well as non-optimal segments. Observing this behavior, we conjectured the existence of neural mechanisms that would allow the optimal segments to be reinforced and the non-optical segments to be rejected, thus leading to the production of the overall near-optimal trajectory. We propose that the overall mechanism can be decomposed into two distinct neural systems. The first is a replay mechanism that favors the representation of snippets that occurred on these optimal segments, and that in contrast will give reduced representation to snippets that correspond to non-optimal trajectory segments. Here we demonstrate a simple but powerful method based on spatial reward propagation that implements this mechanism. Interestingly, this characterization of replay is broadly consistent with the effects of reward on replay observed in behaving animals [<xref ref-type="bibr" rid="pcbi.1006624.ref009">9</xref>].</p>
<p>The second neural system required to achieve this integrative performance is a sequence learning system that can integrate multiple sub-sequences (i.e. snippets) into a consolidated representation, taking into consideration the probability distributions of replay so as to favor more frequently replayed snippets. Here we considered a well-characterized model of sequence learning based on recurrent connections in prefrontal cortex that is perfectly suited to meet the sequence learning requirements.</p>
<sec id="sec021">
<title>Replay mechanism</title>
<p>Replay is modeled using a procedure that randomly selects a subset of place-cells coding part of a sequence, and outputs this snippet while taking into account the proximity of this snippet to a future reward. Each time a reward is encountered, it is taken into consideration in generating the snippet, and reward value is propagated backwards along the sequence, thus implementing a form of spatio-temporal credit assignment. This can be viewed in the Figs <xref ref-type="fig" rid="pcbi.1006624.g002">2</xref>, <xref ref-type="fig" rid="pcbi.1006624.g006">6</xref> and <xref ref-type="fig" rid="pcbi.1006624.g007">7</xref> illustrating the snippet probability densities. The replay mechanism also implements a second feature observed in animal data, which is a tendency to replay snippets in reverse order. These two features of the replay model correspond to what is observed in the rat neurophysiology, and they also make fundamental contributions to the model’s ability to converge on an efficient navigation path. This extends previous demonstrations of the value of replay to include reward-modulated optimization [<xref ref-type="bibr" rid="pcbi.1006624.ref017">17</xref>].</p>
</sec>
<sec id="sec022">
<title>Reservoir network</title>
<p>Reservoir computing exploits the spatio-temporal dynamics of recurrently connected neurons that are sensitive to the spatiotemporal structure of input sequences [<xref ref-type="bibr" rid="pcbi.1006624.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1006624.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1006624.ref028">28</xref>]. The frontal cortex has been demonstrated to operate on these reservoir properties [<xref ref-type="bibr" rid="pcbi.1006624.ref019">19</xref>]. Here we demonstrated how a reservoir model of PFC meets two requirements for sequence learning: First, it can concatenate randomly replayed sub-sequences (snippets) in order to generate the complete original sequence. Second, it is sensitive to the statistics of replay, and thus can learn to ignore rare snippets (which correspond to snippets on inefficient sub-sequences, far from rewards) thus learning to optimize.</p>
</sec>
<sec id="sec023">
<title>Effects of reward and reinforcement learning</title>
<p>The instantaneous reward information acquired during a past experience is used for recursively updating the snippet replay likelihood in the hippocampus model. This creates a reward gradient and allows the optimal sequence to be assembled by the prefrontal cortex and striatum model. This is a novel combination of prioritized replay and reservoir computing in the context of reinforcement learning. The reward gradient is propagated along the spatial trajectory, and used to create a bias in the probability of replay. This biased replay is then provided as input to the reservoir PFC model. This is complementary to [<xref ref-type="bibr" rid="pcbi.1006624.ref049">49</xref>] who used replay to train a Dyna-Q reinforcement learning model. Both models benefit from replay, and can adapt to changes in reward contingencies. In our system, when the distant feeder is given a higher reward, this large reward produces a shift in replay probabilities (illustrated in <xref ref-type="fig" rid="pcbi.1006624.g006">Fig 6B</xref>), and the model learns this new distribution and favors the longer path to target D (illustrated in <xref ref-type="fig" rid="pcbi.1006624.g006">Fig 6D</xref>). The distinction is that we modulate the replay by reward probability, thus biasing the input to the sequence learning model towards the optimal solution. A secondary effect of rewards could be observed when rewards are sufficiently close for allowing a mutual contribution to the snippet replay likelihood surrounding the locations associated with reward delivery. Thus, we predict that a cluster of reward sites will have the effect of propagating the reward information farther than a single reward.</p>
<p>While we were principally motivated to study reward-prioritized replay combined with reservoir sequence learning in the TSP task, one can ask if the model generalizes to other tasks, particularly those that directly involve manipulation of reward. We thus observed that by changing the reward magnitudes, the system adapts and chooses a longer trajectory that leads to a larger reward. However, in more difficult problems that include the discovery of a long route to a single reward, the model could participate in the consolidation of partial solutions as illustrated in the current research, but would not be able to solve such problems autonomously.</p>
</sec>
<sec id="sec024">
<title>Effects of reverse replay</title>
<p>The reverse replay mechanism has a dual effect. First, it provides the mechanism for the backwards propagation of reward along a trajectory. Based on this reward propagation, place-cell activation sequences leading to a nearby reward are represented more frequently and earlier than other less efficient sub-paths, which are thus rejected. This results in a form of spatio-temporal credit assignment that allows to take advantage of the reservoir network ability to combine multiple snippets into a whole sequence. We showed that it is possible to consolidate multiple sequences featuring parts of the same underlying optimal sequence into one efficient sequence and to generate it autonomously. Second, when the snippet replay likelihood is learned, a non-zero reverse replay rate allows the prefrontal cortex to be exposed to sequences of place-cell activations in both forward and reverse direction. This results in sequence learning in both directions while having experienced a place-cell activation sequence in one direction only. These results can be tested experimentally by recording place cells activities in SWR during the task.</p>
</sec>
<sec id="sec025">
<title>Predictions</title>
<p>During the intertrial period, the model predicts a co-occurrence of reverse replay from remote rewarded sites backwards to propagate the reward, and forward replay from remote locations towards rewarded sites to generate snippets from the optimal sub-sequences so as to generate the optimal path. Importantly, it also predicts that there will be a low probability of replay for subsequences that were on non-optimal trajectories. Future research should test these predictions.</p>
<p>A model of replay should predict which experiences should be replayed at each time to enable the most rewarding future decisions. Mattar and Daw [<xref ref-type="bibr" rid="pcbi.1006624.ref050">50</xref>] developed an elegant model of replay based on utility, characterized by a gain term that prioritizes states behind the agent when an unexpected outcome is encountered and a need term that prioritizes states ahead of the agent that are imminently relevant. This model predicts predominantly forward sequences prior to a run, and reverse sequences after a run. It accounts for a wide variety of behavioral and neurophysiological data, often in protocols where replay is observed during a run. We address a problem where the system is in a neutral area between trials in the TSP task. Thus, the current position of the animal is of low relevance. In this context, our model replays snippets that lie on the shortest route through the five baited paths. It would be interesting to observe how the Mattar and Daw model would respond during intertrial intervals in resolving the TSP problem.</p>
</sec>
<sec id="sec026">
<title>Conclusions and limitations</title>
<p>The model we studied here is able to mimic the rat’s ability to find good approximations to the traveling salesperson problem by taking advantage of recent rewarding experiences for updating a trajectory generative model using hippocampus awake replay. We showed that reverse replay allows the agent to reduce the TSP task complexity by considering an undirected graph where feeders are vertices and trajectories are the edges instead of a directed graph. In this case, autonomous sequence generation is no longer possible but the information available in each prediction of the prefrontal cortex contains the expected locations. This allows the building of a navigation policy taking into account the salient actions suggested by the prefrontal cortex predictions, which are learned from hippocampus replay.</p>
</sec>
</sec>
<sec id="sec027">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006624.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>This supporting information provides details on the rat navigation data, and the functioning of the model, including high dimensional processing in the reservoir, the spatial filter implementation and parameters, the sensor and transition model components of the simulation system, the Frechet distance parameters, basic sequence learning and parameter search, the effects of sequence complexity on consolidation, analysis of different degrees of reverse replay.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006624.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.s002" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Rat trajectory and its idealized representation.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006624.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.s003" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Internal representations in the reservoir.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006624.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.s004" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Spatial filter characterization.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006624.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.s005" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Fréchet distance visualization.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006624.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.s006" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Spatial resolution vs. reservoir neuron leak rate.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006624.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.s007" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Effects of snippet size on sequence learning for sequences of varying difficulty.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006624.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.s008" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Effects of reverse replay and initial sequence direction.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006624.s009" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.s009" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Classification of rat behavioral configurations by direction in which executed trajectories relate to desired trajectory.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006624.s010" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.s010" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Summary of the 10 parameter sets optimized by the parallel simulated annealing algorithm.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006624.s011" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.s011" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Performance (revealed by Fréchet distance to desired trajectory) as a function of snippet size.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006624.s012" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006624.s012" xlink:type="simple">
<label>S1 Data</label>
<caption>
<title>Cazin-model-data–Model and data to run selected experiments.</title>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1006624.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carr</surname> <given-names>MF</given-names></name>, <name name-style="western"><surname>Jadhav</surname> <given-names>SP</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>LM</given-names></name>. <article-title>Hippocampal replay in the awake state: a potential substrate for memory consolidation and retrieval</article-title>. <source>Nature neuroscience</source>. <year>2011</year>;<volume>14</volume>(<issue>2</issue>):<fpage>147</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.2732" xlink:type="simple">10.1038/nn.2732</ext-link></comment> <object-id pub-id-type="pmid">21270783</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Davidson</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Kloosterman</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>MA</given-names></name>. <article-title>Hippocampal replay of extended experience</article-title>. <source>Neuron</source>. <year>2009</year>;<volume>63</volume>(<issue>4</issue>):<fpage>497</fpage>–<lpage>507</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2009.07.027" xlink:type="simple">10.1016/j.neuron.2009.07.027</ext-link></comment> <object-id pub-id-type="pmid">19709631</object-id>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Euston</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Tatsuno</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>. <article-title>Fast-forward playback of recent memory sequences in prefrontal cortex during sleep</article-title>. <source>Science</source>. <year>2007</year>;<volume>318</volume>(<issue>5853</issue>):<fpage>1147</fpage>–<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1148979" xlink:type="simple">10.1126/science.1148979</ext-link></comment> <object-id pub-id-type="pmid">18006749</object-id>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kudrimoti</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Barnes</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>. <article-title>Reactivation of hippocampal cell assemblies: effects of behavioral state, experience, and EEG dynamics</article-title>. <source>J Neurosci</source>. <year>1999</year>;<volume>19</volume>(<issue>10</issue>):<fpage>4090</fpage>–<lpage>101</lpage>. <object-id pub-id-type="pmid">10234037</object-id>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Diba</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Buzsaki</surname> <given-names>G</given-names></name>. <article-title>Forward and reverse hippocampal place-cell sequences during ripples</article-title>. <source>Nature neuroscience</source>. <year>2007</year>;<volume>10</volume>(<issue>10</issue>):<fpage>1241</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1961" xlink:type="simple">10.1038/nn1961</ext-link></comment> <object-id pub-id-type="pmid">17828259</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gupta</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>van der Meer</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Touretzky</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Redish</surname> <given-names>AD</given-names></name>. <article-title>Hippocampal replay is not a simple function of experience</article-title>. <source>Neuron</source>. <year>2010</year>;<volume>65</volume>(<issue>5</issue>):<fpage>695</fpage>–<lpage>705</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2010.01.034" xlink:type="simple">10.1016/j.neuron.2010.01.034</ext-link></comment> <object-id pub-id-type="pmid">20223204</object-id>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Karlsson</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>LM</given-names></name>. <article-title>Awake replay of remote experiences in the hippocampus</article-title>. <source>Nat Neurosci</source>. <year>2009</year>;<volume>12</volume>(<issue>7</issue>):<fpage>913</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.2344" xlink:type="simple">10.1038/nn.2344</ext-link></comment> <object-id pub-id-type="pmid">19525943</object-id>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sibille</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Dragoi</surname> <given-names>G</given-names></name>. <article-title>Generative Predictive Codes by Multiplexed Hippocampal Neuronal Tuplets</article-title>. <source>Neuron</source>. <year>2018</year>;<volume>99</volume>(<issue>6</issue>):<fpage>1329</fpage>–<lpage>41</lpage>. e6. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2018.07.047" xlink:type="simple">10.1016/j.neuron.2018.07.047</ext-link></comment> <object-id pub-id-type="pmid">30146305</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ambrose</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Pfeiffer</surname> <given-names>BE</given-names></name>, <name name-style="western"><surname>Foster</surname> <given-names>DJ</given-names></name>. <article-title>Reverse replay of hippocampal place cells is uniquely modulated by changing reward</article-title>. <source>Neuron</source>. <year>2016</year>;<volume>91</volume>(<issue>5</issue>):<fpage>1124</fpage>–<lpage>36</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2016.07.047" xlink:type="simple">10.1016/j.neuron.2016.07.047</ext-link></comment> <object-id pub-id-type="pmid">27568518</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Baracskay</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>O’Neill</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Csicsvari</surname> <given-names>J</given-names></name>. <article-title>Assembly responses of hippocampal CA1 place cells predict learned behavior in goal-directed spatial tasks on the radial eight-arm maze</article-title>. <source>Neuron</source>. <year>2019</year>;<volume>101</volume>(<issue>1</issue>):<fpage>119</fpage>–<lpage>32</lpage>. e4. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2018.11.015" xlink:type="simple">10.1016/j.neuron.2018.11.015</ext-link></comment> <object-id pub-id-type="pmid">30503645</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Foster</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>MA</given-names></name>. <article-title>Reverse replay of behavioural sequences in hippocampal place cells during the awake state</article-title>. <source>Nature</source>. <year>2006</year>;<volume>440</volume>(<issue>7084</issue>):<fpage>680</fpage>–<lpage>3</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature04587" xlink:type="simple">10.1038/nature04587</ext-link></comment> <object-id pub-id-type="pmid">16474382</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pfeiffer</surname> <given-names>BE</given-names></name>, <name name-style="western"><surname>Foster</surname> <given-names>DJ</given-names></name>. <article-title>Hippocampal place-cell sequences depict future paths to remembered goals</article-title>. <source>Nature</source>. <year>2013</year>;<volume>497</volume>(<issue>7447</issue>):<fpage>74</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature12112" xlink:type="simple">10.1038/nature12112</ext-link></comment> <object-id pub-id-type="pmid">23594744</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>de Jong</surname> <given-names>LW</given-names></name>, <name name-style="western"><surname>Gereke</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Fellous</surname> <given-names>J-M</given-names></name>. <article-title>The traveling salesrat: insights into the dynamics of efficient spatial navigation in the rodent</article-title>. <source>Journal of Neural Engineering</source>. <year>2011</year>;<volume>8</volume>(<issue>6</issue>):<fpage>065010</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1088/1741-2560/8/6/065010" xlink:type="simple">10.1088/1741-2560/8/6/065010</ext-link></comment> <object-id pub-id-type="pmid">22056477</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref014"><label>14</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Applegate</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Bixby</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Chvatal</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Cook</surname> <given-names>WJ</given-names></name>. <source>The traveling salesman problem: a computational study</source>: <publisher-name>Princeton university press</publisher-name>; <year>2006</year>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hopfield</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Tank</surname> <given-names>DW</given-names></name>. <article-title>“Neural” computation of decisions in optimization problems</article-title>. <source>Biological cybernetics</source>. <year>1985</year>;<volume>52</volume>(<issue>3</issue>):<fpage>141</fpage>–<lpage>52</lpage>. <object-id pub-id-type="pmid">4027280</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Adam</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Busoniu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Babuska</surname> <given-names>R</given-names></name>. <article-title>Experience replay for real-time reinforcement learning control</article-title>. <source>IEEE Transactions on Systems, Man, and Cybernetics, Part C (Applications and Reviews)</source>. <year>2012</year>;<volume>42</volume>(<issue>2</issue>):<fpage>201</fpage>–<lpage>12</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Johnson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Redish</surname> <given-names>AD</given-names></name>. <article-title>Hippocampal replay contributes to within session learning in a temporal difference reinforcement learning model</article-title>. <source>Neural Netw</source>. <year>2005</year>;<volume>18</volume>(<issue>9</issue>):<fpage>1163</fpage>–<lpage>71</lpage>. Epub 2005/10/04. S0893-6080(05)00199-1 [pii] <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neunet.2005.08.009" xlink:type="simple">10.1016/j.neunet.2005.08.009</ext-link></comment> <object-id pub-id-type="pmid">16198539</object-id>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Singer</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>LM</given-names></name>. <article-title>Rewarded Outcomes Enhance Reactivation of Experience in the Hippocampus</article-title>. <source>Neuron</source>. <year>2009</year>;<volume>64</volume>:<fpage>910</fpage>–<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2009.11.016" xlink:type="simple">10.1016/j.neuron.2009.11.016</ext-link></comment> <object-id pub-id-type="pmid">20064396</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Enel</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Procyk</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Quilodran</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Dominey</surname> <given-names>PF</given-names></name>. <article-title>Reservoir Computing Properties of Neural Dynamics in Prefrontal Cortex</article-title>. <source>PLoS computational biology</source>. <year>2016</year>;<volume>12</volume>(<issue>6</issue>):<fpage>e1004967</fpage>. Epub 2016/06/11. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004967" xlink:type="simple">10.1371/journal.pcbi.1004967</ext-link></comment> <object-id pub-id-type="pmid">27286251</object-id>; PubMed Central PMCID: PMC4902312.</mixed-citation></ref>
<ref id="pcbi.1006624.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dominey</surname> <given-names>PF</given-names></name>. <article-title>Complex sensory-motor sequence learning based on recurrent state representation and reinforcement learning</article-title>. <source>Biol Cybern</source>. <year>1995</year>;<volume>73</volume>(<issue>3</issue>):<fpage>265</fpage>–<lpage>74</lpage>. Epub 1995/08/01. <object-id pub-id-type="pmid">7548314</object-id>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pearlmutter</surname> <given-names>BA</given-names></name>. <article-title>Gradient calculations for dynamic recurrent neural networks: A survey</article-title>. <source>Neural Networks, IEEE Transactions on</source>. <year>1995</year>;<volume>6</volume>(<issue>5</issue>):<fpage>1212</fpage>–<lpage>28</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Elman</surname> <given-names>J</given-names></name>. <article-title>Finding structure in time</article-title>. <source>Cognitive Sci</source>. <year>1990</year>;<volume>14</volume>:<fpage>179</fpage>–<lpage>211</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Markov</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Misery</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Falchier</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lamy</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Vezoli</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Quilodran</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Weight consistency specifies regularities of macaque cortical networks</article-title>. <source>Cerebral Cortex</source>. <year>2011</year>;<volume>21</volume>(<issue>6</issue>):<fpage>1254</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/cercor/bhq201" xlink:type="simple">10.1093/cercor/bhq201</ext-link></comment> <object-id pub-id-type="pmid">21045004</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Douglas</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Mahowald</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Suarez</surname> <given-names>HH</given-names></name>. <article-title>Recurrent excitation in neocortical circuits</article-title>. <source>Science</source>. <year>1995</year>;<volume>269</volume>(<issue>5226</issue>):<fpage>981</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.7638624" xlink:type="simple">10.1126/science.7638624</ext-link></comment> <object-id pub-id-type="pmid">7638624</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dominey</surname> <given-names>PF</given-names></name>, <name name-style="western"><surname>Arbib</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Joseph</surname> <given-names>JP</given-names></name>. <source>A Model of Corticostriatal Plasticity for Learning Oculomotor Associations and Sequences J Cogn Neurosci</source>. <year>1995</year>;<volume>7</volume>(<issue>3</issue>):<fpage>25</fpage>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref026"><label>26</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Jaeger</surname> <given-names>H</given-names></name>. <chapter-title>The" echo state" approach to analysing and training recurrent neural networks-with an erratum note'</chapter-title>. <publisher-loc>Bonn, Germany</publisher-loc>: <publisher-name>German National Research Center for Information Technology GMD Technical Report</publisher-name>. <year>2001</year>;<fpage>148</fpage>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jaeger</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Haas</surname> <given-names>H</given-names></name>. <article-title>Harnessing nonlinearity: predicting chaotic systems and saving energy in wireless communication</article-title>. <source>Science</source>. <year>2004</year>;<volume>304</volume>(<issue>5667</issue>):<fpage>78</fpage>–<lpage>80</lpage>. Epub 2004/04/06. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1091277" xlink:type="simple">10.1126/science.1091277</ext-link></comment> <object-id pub-id-type="pmid">15064413</object-id>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maass</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Natschlager</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name>. <article-title>Real-time computing without stable states: a new framework for neural computation based on perturbations</article-title>. <source>Neural Comput</source>. <year>2002</year>;<volume>14</volume>(<issue>11</issue>):<fpage>2531</fpage>–<lpage>60</lpage>. Epub 2002/11/16. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/089976602760407955" xlink:type="simple">10.1162/089976602760407955</ext-link></comment> <object-id pub-id-type="pmid">12433288</object-id>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fusi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>EK</given-names></name>, <name name-style="western"><surname>Rigotti</surname> <given-names>M</given-names></name>. <article-title>Why neurons mix: high dimensionality for higher cognition</article-title>. <source>Current opinion in neurobiology</source>. <year>2016</year>;<volume>37</volume>:<fpage>66</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.conb.2016.01.010" xlink:type="simple">10.1016/j.conb.2016.01.010</ext-link></comment> <object-id pub-id-type="pmid">26851755</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rigotti</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Barak</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Warden</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>X-J</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>EK</given-names></name>, <etal>et al</etal>. <article-title>The importance of mixed selectivity in complex cognitive tasks</article-title>. <source>Nature</source>. <year>2013</year>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Navratilova</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Giocomo</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Fellous</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Hasselmo</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>. <article-title>Phase precession and variable spatial scaling in a periodic attractor map model of medial entorhinal grid cells with realistic after‐spike dynamics</article-title>. <source>Hippocampus</source>. <year>2012</year>;<volume>22</volume>(<issue>4</issue>):<fpage>772</fpage>–<lpage>89</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/hipo.20939" xlink:type="simple">10.1002/hipo.20939</ext-link></comment> <object-id pub-id-type="pmid">21484936</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shin</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Jadhav</surname> <given-names>SP</given-names></name>. <article-title>Multiple modes of hippocampal–prefrontal interactions in memory-guided behavior</article-title>. <source>Current opinion in neurobiology</source>. <year>2016</year>;<volume>40</volume>:<fpage>161</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.conb.2016.07.015" xlink:type="simple">10.1016/j.conb.2016.07.015</ext-link></comment> <object-id pub-id-type="pmid">27543753</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cenquizca</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Swanson</surname> <given-names>LW</given-names></name>. <article-title>Spatial organization of direct hippocampal field CA1 axonal projections to the rest of the cerebral cortex</article-title>. <source>Brain research reviews</source>. <year>2007</year>;<volume>56</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.brainresrev.2007.05.002" xlink:type="simple">10.1016/j.brainresrev.2007.05.002</ext-link></comment> <object-id pub-id-type="pmid">17559940</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Harland</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Contreras</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fellous</surname> <given-names>J-M</given-names></name>. <article-title>A Role for the Longitudinal Axis of the Hippocampus in Multiscale Representations of Large and Complex Spatial Environments and Mnemonic Hierarchies</article-title>. <source>The Hippocampus-Plasticity and Functions: IntechOpen</source>; <year>2018</year>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Delatour</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Witter</surname> <given-names>M</given-names></name>. <article-title>Projections from the parahippocampal region to the prefrontal cortex in the rat: evidence of multiple pathways</article-title>. <source>European Journal of Neuroscience</source>. <year>2002</year>;<volume>15</volume>(<issue>8</issue>):<fpage>1400</fpage>–<lpage>7</lpage>. <object-id pub-id-type="pmid">11994135</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vertes</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Hoover</surname> <given-names>WB</given-names></name>, <name name-style="western"><surname>Szigeti-Buck</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Leranth</surname> <given-names>C</given-names></name>. <article-title>Nucleus reuniens of the midline thalamus: link between the medial prefrontal cortex and the hippocampus</article-title>. <source>Brain research bulletin</source>. <year>2007</year>;<volume>71</volume>(<issue>6</issue>):<fpage>601</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.brainresbull.2006.12.002" xlink:type="simple">10.1016/j.brainresbull.2006.12.002</ext-link></comment> <object-id pub-id-type="pmid">17292803</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ji</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>MA</given-names></name>. <article-title>Coordinated memory replay in the visual cortex and hippocampus during sleep</article-title>. <source>Nat Neurosci</source>. <year>2007</year>;<volume>10</volume>(<issue>1</issue>):<fpage>100</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1825" xlink:type="simple">10.1038/nn1825</ext-link></comment> <object-id pub-id-type="pmid">17173043</object-id>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ciocchi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Passecker</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Malagon-Vina</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Mikus</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Klausberger</surname> <given-names>T</given-names></name>. <article-title>Selective information routing by ventral hippocampal CA1 projection neurons</article-title>. <source>science</source>. <year>2015</year>;<volume>348</volume>(<issue>6234</issue>):<fpage>560</fpage>–<lpage>3</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.aaa3245" xlink:type="simple">10.1126/science.aaa3245</ext-link></comment> <object-id pub-id-type="pmid">25931556</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rajasethupathy</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Sankaran</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Marshel</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>CK</given-names></name>, <name name-style="western"><surname>Ferenczi</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>SY</given-names></name>, <etal>et al</etal>. <article-title>Projections from neocortex mediate top-down control of memory retrieval</article-title>. <source>Nature</source>. <year>2015</year>;<volume>526</volume>(<issue>7575</issue>):<fpage>653</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature15389" xlink:type="simple">10.1038/nature15389</ext-link></comment> <object-id pub-id-type="pmid">26436451</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hallock</surname> <given-names>HL</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Griffin</surname> <given-names>AL</given-names></name>. <article-title>Ventral midline thalamus is critical for hippocampal–prefrontal synchrony and spatial working memory</article-title>. <source>Journal of Neuroscience</source>. <year>2016</year>;<volume>36</volume>(<issue>32</issue>):<fpage>8372</fpage>–<lpage>89</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.0991-16.2016" xlink:type="simple">10.1523/JNEUROSCI.0991-16.2016</ext-link></comment> <object-id pub-id-type="pmid">27511010</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McClelland</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>O'Reilly</surname> <given-names>RC</given-names></name>. <article-title>Why there are complementary learning systems in the hippocampus and neocortex: insights from the successes and failures of connectionist models of learning and memory</article-title>. <source>Psychol Rev</source>. <year>1995</year>;<volume>102</volume>(<issue>3</issue>):<fpage>419</fpage>–<lpage>57</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1037/0033-295X.102.3.419" xlink:type="simple">10.1037/0033-295X.102.3.419</ext-link></comment> <object-id pub-id-type="pmid">7624455</object-id>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lukosevicius</surname> <given-names>M</given-names></name>. <article-title>A practical guide to applying echo state networks</article-title>. <source>Neural networks: tricks of the trade</source>: <collab>Springer</collab>; <year>2012</year>. p. <fpage>659</fpage>–<lpage>86</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Widrow</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Hoff</surname> <given-names>ME</given-names></name>. <article-title>Adaptive switching circuits</article-title>. <source>STANFORD UNIV CA STANFORD ELECTRONICS LABS</source>, <year>1960</year>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van der Meer</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schmitzer-Torbert</surname> <given-names>NC</given-names></name>, <name name-style="western"><surname>Redish</surname> <given-names>AD</given-names></name>. <article-title>Triple dissociation of information processing in dorsal striatum, ventral striatum, and hippocampus on a learned spatial decision task</article-title>. <source>Neuron</source>. <year>2010</year>;<volume>67</volume>(<issue>1</issue>):<fpage>25</fpage>–<lpage>32</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2010.06.023" xlink:type="simple">10.1016/j.neuron.2010.06.023</ext-link></comment> <object-id pub-id-type="pmid">20624589</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eiter</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Mannila</surname> <given-names>H</given-names></name>. <article-title>Computing discrete Frechet distance</article-title>. <source>Tech Report CD-TR 94/64, Information Systems Department, Technical University of Vienna</source>. <year>1994</year>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wylie</surname> <given-names>TR</given-names></name>. <source>The discrete Fréchet distance with applications: Montana State University-Bozeman, College of Engineering</source>; <year>2013</year>.</mixed-citation></ref>
<ref id="pcbi.1006624.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gupta</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>van der Meer</surname> <given-names>MAA</given-names></name>, <name name-style="western"><surname>Touretzky</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Redish</surname> <given-names>AD</given-names></name>. <article-title>Hippocampal replay is not a simple function of experience</article-title>. <source>Neuron</source>. <year>2010</year>;<volume>65</volume>(<issue>5</issue>):<fpage>695</fpage>–<lpage>705</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2010.01.034" xlink:type="simple">10.1016/j.neuron.2010.01.034</ext-link></comment> <object-id pub-id-type="pmid">20223204</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bureš</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Burešová</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Nerad</surname> <given-names>L</given-names></name>. <article-title>Can rats solve a simple version of the traveling salesman problem?</article-title> <source>Behavioural brain research</source>. <year>1992</year>;<volume>52</volume>(<issue>2</issue>):<fpage>133</fpage>–<lpage>42</lpage>. <object-id pub-id-type="pmid">1294192</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Johnson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Redish</surname> <given-names>AD</given-names></name>. <article-title>Hippocampal replay contributes to within session learning in a temporal difference reinforcement learning model</article-title>. <source>Neural Networks</source>. <year>2005</year>;<volume>18</volume>(<issue>9</issue>):<fpage>1163</fpage>–<lpage>71</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neunet.2005.08.009" xlink:type="simple">10.1016/j.neunet.2005.08.009</ext-link></comment> <object-id pub-id-type="pmid">16198539</object-id></mixed-citation></ref>
<ref id="pcbi.1006624.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mattar</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>. <article-title>Prioritized memory access explains planning and hippocampal replay</article-title>. <source>Nature neuroscience</source>. <year>2018</year>;<volume>21</volume>(<issue>11</issue>):<fpage>1609</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41593-018-0232-z" xlink:type="simple">10.1038/s41593-018-0232-z</ext-link></comment> <object-id pub-id-type="pmid">30349103</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>