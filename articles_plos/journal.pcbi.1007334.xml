<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01853</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1007334</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognition</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Sociology</subject><subj-group><subject>Communications</subject><subj-group><subject>Mass media</subject><subj-group><subject>Magazines</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Animal studies</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Rats</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Model organisms</subject><subj-group><subject>Rats</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Animal studies</subject><subj-group><subject>Experimental organism systems</subject><subj-group><subject>Animal models</subject><subj-group><subject>Rats</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Animals</subject><subj-group><subject>Vertebrates</subject><subj-group><subject>Amniotes</subject><subj-group><subject>Mammals</subject><subj-group><subject>Rodents</subject><subj-group><subject>Rats</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Regression analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Regression analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Agriculture</subject><subj-group><subject>Animal management</subject><subj-group><subject>Animal performance</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Learning the structure of the world: The adaptive nature of state-space and action representations in multi-stage decision-making</article-title>
<alt-title alt-title-type="running-head">Two stage decision-making in rats</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Dezfouli</surname> <given-names>Amir</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8618-7950</contrib-id>
<name name-style="western">
<surname>Balleine</surname> <given-names>Bernard W.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>School of Psychology, UNSW, Sydney, Australia</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Data61, CSIRO, Sydney, Australia</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Soltani</surname> <given-names>Alireza</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Dartmouth College, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">bernard.balleine@unsw.edu.au</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>9</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>6</day>
<month>9</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>9</issue>
<elocation-id>e1007334</elocation-id>
<history>
<date date-type="received">
<day>1</day>
<month>11</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>12</day>
<month>8</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Dezfouli, Balleine</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1007334"/>
<abstract>
<p>State-space and action representations form the building blocks of decision-making processes in the brain; states map external cues to the current situation of the agent whereas actions provide the set of motor commands from which the agent can choose to achieve specific goals. Although these factors differ across environments, it is currently unknown whether or how accurately state and action representations are acquired by the agent because previous experiments have typically provided this information a priori through instruction or pre-training. Here we studied how state and action representations adapt to reflect the structure of the world when such a priori knowledge is not available. We used a sequential decision-making task in rats in which they were required to pass through multiple states before reaching the goal, and for which the number of states and how they map onto external cues were unknown a priori. We found that, early in training, animals selected actions as if the task was not sequential and outcomes were the immediate consequence of the most proximal action. During the course of training, however, rats recovered the true structure of the environment and made decisions based on the expanded state-space, reflecting the multiple stages of the task. Similarly, we found that the set of actions expanded with training, although the emergence of new action sequences was sensitive to the experimental parameters and specifics of the training procedure. We conclude that the profile of choices shows a gradual shift from simple representations to more complex structures compatible with the structure of the world.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Everyday decision-making tasks typically require taking multiple actions and passing through multiple states before reaching desired goals. Such states constitute the state-space of the task. Here we show that, contrary to current assumptions, the state-space is not static but rather expands during training as subjects discover new states that help them efficiently solve the task. Similarly, within the same task, we show that subjects initially only consider taking simple actions, but as training progresses the set of actions can expand to include useful action sequences that reach the goal directly by passing through multiple states. These results provide evidence that state-space and action representations are not static but are acquired and then adapted to reflect the structure of the world.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Australian Research Council</institution>
</funding-source>
<award-id>DP150104878</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8618-7950</contrib-id>
<name name-style="western">
<surname>Balleine</surname> <given-names>Bernard W</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>Australian Research Council</institution>
</funding-source>
<award-id>FL0992409</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8618-7950</contrib-id>
<name name-style="western">
<surname>Balleine</surname> <given-names>Bernard W</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000925</institution-id>
<institution>National Health and Medical Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>GNT1079561</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8618-7950</contrib-id>
<name name-style="western">
<surname>Balleine</surname> <given-names>Bernard W</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>AD and this research were supported by grants DP150104878, FL0992409 from the Australian Research Council to BWB. BWB was supported by a Senior Principal Research Fellowship from the National Health &amp; Medical Research Council of Australia, GNT1079561. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="4"/>
<table-count count="3"/>
<page-count count="22"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-09-18</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The data from this study can be accessed at Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/adezfouli/TST_data/tree/master/data" xlink:type="simple">https://github.com/adezfouli/TST_data/tree/master/data</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>In sequential decision-making tasks, an agent makes a series of choices and passes through several states before earning rewards. Making choices requires knowing the structure of the environment such as the available actions, the number of states of the environment and how they map on to external cues, i.e., the <italic>state-space</italic> of the task. Within the lab this information is typically given to subjects in advance of the task either through instructions or pre-training, however, such a priori information is not usually made available to a decision-maker in natural environments, and the decision-making process must, therefore, involve (i) learning the correct state-space of the environment and (ii) acquiring new actions that are useful for earning reward in the task.</p>
<p>Learning the state-space of the task is crucial in allowing the agent to navigate within the environment, and provides building blocks for various forms of reinforcement-learning algorithms in the brain [<xref ref-type="bibr" rid="pcbi.1007334.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref002">2</xref>]. This process involves considering different events and cues that occur after taking each action, and integrating them in order to recover how many states the task has and how they are related to external cues. Recent theoretical work provides a basis for this process in the context of classical conditioning and suggests that the underlying states used to represent the environment are dynamic; that animals are able to infer and learn new states of the environment based on their observations [<xref ref-type="bibr" rid="pcbi.1007334.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref004">4</xref>]. However, at present, there is no direct evidence for such adaptive state-space representations in decision-making situations.</p>
<p>Actions are the other building block for reinforcement-learning algorithms, and refer, for example, to different motor commands that an agent can use to influence the state of the environment. Efficient decision-making relies on using actions at the appropriate scale; engaging decision-making at too fine-grained a level of motor movement will overwhelm this process with choice points. Indeed, evidence suggests that humans and other animals can create new actions in the form of action chunks or action sequences by concatenating simple actions together [<xref ref-type="bibr" rid="pcbi.1007334.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref002">2</xref>]. Such action sequences, known as ‘temporally extended actions’, can be thought of as new skills that expand the set of available actions and that are treated as single response units. By acquiring new action sequences, the selection process needs to be implemented only once at the initiation point of an action sequence instead of before each individual action and, in this way, adaptive representations of actions contribute to the scalability of the decision-making process.</p>
<p>In the current study, using a sequential decision-making task in rats, we sought to investigate whether state-space and action representations adapt to the structure of the world. We used a two-stage decision-making task similar to a two-stage task previously used in human subjects and rodents [e.g., <xref ref-type="bibr" rid="pcbi.1007334.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref012">12</xref>], and show, without any explicit instructions about the structure of the task (which obviously cannot be provided to rats), that early in training, the rats made decisions based on the assumption that the state-space is simple and the environment is composed of a single stage whereas, later in training, they learned the true state-space reflecting the multi-stage structure of the environment and made decisions accordingly. We also found that concurrently with the expansion of the state-space, the set of actions also expanded and action sequences were added to the set of actions that the rats executed. This latter effect, however, was sensitive to the choice of experimental parameters and did not emerge in all of the test conditions. We conclude that decision making is adaptive and depends on acquiring, refining and updating both state-space and action representations over time. Importantly, although this may not seem an entirely unexpected result from an associative learning perspective [e.g., <xref ref-type="bibr" rid="pcbi.1007334.ref013">13</xref>], it required the development of an alternative hierarchical architecture to generate a description of the rats’ performance in RL terms.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>Rats (n = 8; see <xref ref-type="sec" rid="sec010">Material and methods</xref>) received several pre-training sessions, in which they learned to press two levers, ‘R’ and ‘L’ (right and left), to earn food pellets (<xref ref-type="fig" rid="pcbi.1007334.g001">Fig 1</xref>:phase 2). Subjects then learned to discriminate between two stimuli S1 and S2 such that in the presence of S2 action ‘R’ was rewarded whereas in the presence of S1 action ‘L’ was rewarded (<xref ref-type="fig" rid="pcbi.1007334.g001">Fig 1</xref>:phase 3; <xref ref-type="supplementary-material" rid="pcbi.1007334.s015">S4 Fig</xref>). Subsequently, the rats received training on a two-stage decision-making task, in which they first made a binary choice at stage 1 (S0), after which they transitioned to one of the stage 2 states, (either S1 or S2), in which again they made another binary choice that could lead to either reward delivery or no-reward (<xref ref-type="fig" rid="pcbi.1007334.g002">Fig 2a</xref>). In each trial, only one of the stage 2 states led to reward; the other state did not lead to reward irrespective of the choice of actions (<xref ref-type="fig" rid="pcbi.1007334.g002">Fig 2b</xref>). During the course of each session, the stage 2 state that earned a reward switched without any signal (with probability 0.14; indicated by ‘reversal’ in <xref ref-type="fig" rid="pcbi.1007334.g002">Fig 2b</xref>).</p>
<fig id="pcbi.1007334.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007334.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Different phases of the experiment.</title>
<p>The experiment started with two magazine training sessions (phase 1), followed by several lever training sessions (phase 2), in which animals learned that pressing each lever (left and right levers corresponding to ‘L’ and ‘R’ in the figure) would delivered a reward (presented by ‘O’ in the figure). The next phase was discrimination training (phase 3), in which animals learned that when stimulus S1 was presented action ‘L’ should be taken to earn a reward, and when S2 was presented action ‘R’ should be taken to earn a reward. S1 and S2 were a constant and blinking house light, respectively. The next phase of the experiment was two-stage training, in which animals were trained on a two-stage decision-making task. This training phase comprised multiple training sessions and, in the middle or at the end of these training sessions, several ‘probe sessions’ were inserted.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.g001" xlink:type="simple"/>
</fig>
<fig id="pcbi.1007334.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007334.g002</object-id>
<label>Fig 2</label>
<caption>
<title/>
<p>(a) The flow of events in the two-stage task. Trials started in state S0, which was signalled by the absence of the house light. After an action (‘L’ or ‘R’) was taken at stage 1, either constant or blinking house light started (S1 or S2). Next, subjects could take another action at stage 2 (‘L’ or ‘R’), which could lead either to the delivery of the outcome or to no outcome. Actions taken in S0 immediately lead to the presentation of either S1 or S2, and actions taken in S1 or S2 immediately lead to the outcome or no outcome. The inter-trial interval (ITI) was zero in this experiment, but in the experiments reported in the <xref ref-type="supplementary-material" rid="pcbi.1007334.s016">S5</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007334.s017">S6</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007334.s018">S7</xref> Figs it was greater than zero, as detailed in <xref ref-type="supplementary-material" rid="pcbi.1007334.s002">S2 Text</xref>. (b) The structure of the task. Stage 1 actions in S0 led to the stage 2 stimuli (S1/S2) in a deterministic manner. The rewarding stage 2 state changed with a probability of 0.14 after earning an outcome (indicated by ‘reversal’ in the graph). ‘O’ represents outcome, and ‘X’ no-outcome. (c) The structure of the probe sessions. The probe sessions were similar to the training sessions (panel (b)), except that stage 1 actions led to the stage 2 states in a probabilistic manner. Taking action ‘L’ led to state S2 commonly (80% of the time), and to state S1 rarely (dashed lines). Taking action ‘R’ led to state S1 commonly (80% of the time), and to state S2 rarely (dashed lines).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.g002" xlink:type="simple"/>
</fig>
<sec id="sec003">
<title>Adaptive state-space representation</title>
<p>The stage 2 state that earned reward changed over time and, as such, subjects needed to use feedback from the previous trial to track which specific stage 2 state was rewarded so as to take the stage 1 action leading to that state. Given this situation, it should be expected that, if a reward is earned on the previous trial, the subjects will repeat the same stage 1 action on the next trial. <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3a</xref> shows the logarithm of odds ratio of staying on the same stage 1 action after earning a reward on the previous trial over the odds after earning no reward (across training sessions). Each bar in the graph represents a training session, and odds ratios were calculated using logistic regression analysis on the effect the reward had on staying on the same stage 1 action on the next trial (see <xref ref-type="sec" rid="sec010">Material and methods</xref> for details). The zero point on the <italic>y</italic>-axis in the figure shows the indifference point, i.e., when the probability of staying on the same stage 1 action after earning reward or no reward is equal. As the figure shows, in early training sessions the rats failed to show a tendency to take the same stage 1 action after earning a reward on the previous trial and instead showed a tendency to switch to the other action (first five sessions; <italic>β</italic> = −0.929 (CI: −1.194, −0.664), SE = 0.135, <italic>p</italic> &lt; 10<sup>−11</sup>). This sub-optimal behaviour can be explained with reference to the state-space and action representation that decisions were based on early in training; i.e., subjects were initially unaware that the environment had two stages, treated it as a single stage environment, and therefore repeated the action taken immediately prior to reward delivery. For example, if they took ‘L’ at stage 1, and ‘R’ at stage 2 and earned reward, they repeated action ‘R’ at the beginning of the next trial. Although this looks like they switched to the other stage 1 action, they were clearly repeating the last rewarded stage 2 action, which should be expected if decisions are made as if the environment is composed of a single stage.</p>
<fig id="pcbi.1007334.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007334.g003</object-id>
<label>Fig 3</label>
<caption>
<title/>
<p>(a) Logarithm of odds ratio of staying on the same stage 1 action after getting rewarded on the previous trial over the odds ratio after not getting rewarded. The zero point on the <italic>y</italic>-axis represents the indifference point (equal probability of staying on the same stage 1 action after reward or no reward). Each bar represents the odds ratio for a single training session. In the sessions marked with ‘#’ in Figure 3a the contingency between stage 1 actions and stage 2 states were revered (‘L’ leads to S1 and ‘R’ to S2). ‘Strict sequence’ refers to sessions in which a trial was aborted if the animal entered the magazine between stage 1 and stage 2 actions. Sessions marked with ‘*’ are probe sessions in which the task involved both rare and common transitions. (b) Reaction times (RT) averaged over subjects. RT refers to the delay between performing the stage 1 and stage 2 actions. Each dot represents a training session. (c) An example of how the performance of action sequences can be detected in the probe session. On a certain trial a rat has earned a reward by taking ‘L’ at stage 1 and ‘R’ at stage 2. The subject then repeats the whole action sequence (‘L’ and then ‘R’), even though after executing ‘L’ it ends up in S1 (due to a rare transition) and action ‘R’ is never rewarded in that state. (d) The probability of staying on the same stage 2 action in the probe session averaged over subjects, as a function of whether the previous trial was rewarded (reward/no reward) and whether subjects stayed on the same stage 1 action (stay/switch). As shown in panel (c) only the trials in which state 2 state is different from the previous trial are included. (e) The probability of staying on the same stage 1 action in the probe session averaged over subjects as a function of whether the previous trial was rewarded (reward/no reward) and whether the transition in the previous trial was common or rare. (f) Model simulations depicting the probability of staying on the same stage 1 action when the model is using exclusively action sequences. (g) Model simulations depicting the probability of staying on the same stage 1 action when the model is using the true state-space of the task but not action sequences. (h) Simulation of stage 2 choices, and (i) stage 1 choices using the best-fitted parameters for each subject. Error bars represent ±1 SEM.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.g003" xlink:type="simple"/>
</fig>
<p>Therefore, actions were not based on a two-stage representation, which would require that the subjects treat S1 and S2 as the outcomes of actions taken in S0; indeed, to the contrary, the data shows that the subjects acted as if their next action in S0 led to reward directly. This could be for two reasons: (1) Although S0 was visually distinct from S1 and S2, early in training it may not yet have been part of the state-space and therefore the outcomes of actions taken in S0 (which are S1/S2) were not differentiated from the outcomes of the actions taken in S1/S2 (which were reward/no-reward). From this perspective, a reward earned by taking an action in S1 or S2 was attributed to taking actions in the upcoming S0 and led the rats to repeat the same action in S0. Alternatively, (2) S0 was part of the state-space and was being treated differently from S1/S2, but the rats had yet to encode that ‘L’ leads to S2 and ‘R’ to S1. The former hypothesis relates to the state-space representation, whereas the latter relates to learning the “transition matrix” of the task, i.e., state-action-state relationships. There are two points in favour of the first hypothesis. Firstly, if animals were confused about what will happen after taking stage 1 actions (i.e., whether they will lead to S1 or S2), then we would expect the subjects to act randomly in S0, whereas, as the data indicate, the subject repeated the last rewarded action in S0 as if S0 was similar to the state in which the last action was taken. Secondly, animals typically learn action-outcome contingencies very rapidly. For example, in a simple instrumental conditioning experiment in which two levers lead to different (motivationally relevant) outcomes, such a food pellets, animals are able to learn the contingencies in a single training session [<xref ref-type="bibr" rid="pcbi.1007334.ref014">14</xref>], whereas here it took animals more than ten training sessions to take the correct actions in S0. Based on this finding, we interpret the effect as a consequence of the rats forming a simple state-space representation, i.e., all the states are organised into a single stage early in training, which is shown as S0/S1/S2 in <xref ref-type="table" rid="pcbi.1007334.t001">Table 1a</xref>.</p>
<table-wrap id="pcbi.1007334.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007334.t001</object-id>
<label>Table 1</label>
<caption>
<title>Four hypotheses about state-space and action representations.</title>
<p>(a) The state-space constitutes a single stage (outcomes such as food pellets are not shown here as states), and ‘L’ and ‘R’ are the only possible actions that the subject considers taking. (b) The state-space matches the correct state-space of the task, and the actions are ‘L’ and ‘R’. (c) The state-space only consists of state S0, and actions are ‘L → R’ and ‘R → L’. Note that single actions ‘R’ and ‘L’ are not included. (d) The state-space represents the two stages of the task and actions include both single actions and action sequences.</p>
</caption>
<alternatives>
<graphic id="pcbi.1007334.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"/>
<th align="center">(a)</th>
<th align="center">(b)</th>
<th align="center">(c)</th>
<th align="center">(d)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">state-space</td>
<td align="center">S0/S1/S2</td>
<td align="center">S0, S1, S2</td>
<td align="center">S0</td>
<td align="center">S0, S1, S2</td>
</tr>
<tr>
<td align="center">actions</td>
<td align="center">L, R</td>
<td align="center">L, R</td>
<td align="center">L→R, R→L</td>
<td align="center">L, R, L→R, R→L</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>A final logically possible account can be formed based on the assumption that S0 is part of the state-space but S1 and S2 are not. This account can explain why animals do not treat S1 and S2 as the outcome of S0, but is inconsistent with the fact that the rats took different actions in these states and so were clearly able to discriminate between S1 and S2.</p>
<p>Importantly, as <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3a</xref> shows, this pattern of choices reversed as the training progressed and the rats started to take the same stage 1 action that earned reward on the previous trial rather than repeating the action most proximal to reward (see <xref ref-type="supplementary-material" rid="pcbi.1007334.s014">S3 Fig</xref> for the behaviour of individual subject). Replications of this finding using other experimental parameters are provided in Supplementary Experiments 1-3 in (<xref ref-type="supplementary-material" rid="pcbi.1007334.s016">S5</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007334.s017">S6</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007334.s018">S7</xref> Figs and <xref ref-type="supplementary-material" rid="pcbi.1007334.s002">S2 Text</xref>). One explanation for this observation is that, at this point in training, the rats realised that the task had two-stages and, at that point, acquired the “correct” state-space of the task (<xref ref-type="table" rid="pcbi.1007334.t001">Table 1b</xref>), where the correct representation refers to the Markov Decision Process underlying the task structure [note that defining the correct state-space is not trivial; see <xref ref-type="bibr" rid="pcbi.1007334.ref015">15</xref>]. If this is true, however, then, during the course of training, the state-space used by the animals expanded from a simple representation (<xref ref-type="table" rid="pcbi.1007334.t001">Table 1a</xref>) to a more complex representation consistent with the task state-space (<xref ref-type="table" rid="pcbi.1007334.t001">Table 1b</xref>).</p>
</sec>
<sec id="sec004">
<title>Adaptive action representation</title>
<p>Learning the state-space of the task is not the only way that the rats could have adapted to the two-stage structure of the environment; in this task reward can be earned either by executing ‘L’ at stage 1 and ‘R’ at stage 2, or by executing ‘R’ at stage 1 and ‘L’ at stage 2. As such, it is possible that animals chunked actions ‘L’ and ‘R’ to make action sequences; say, ‘L→R’, and ‘R→L’. Using these new actions, the rats could then repeat an action sequence on the next trial after earning a reward instead of merely repeating the action proximal to the reward, as early in training. If this is true, however, then the transition in the pattern of stage 1 actions shown in <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3a</xref> could have been driven by the rats acquiring action sequences rather then the state-space of the task. This assumption is also consistent with the fact that the delay between the first and second action (the rats’ reaction time) decreased as training progressed (<xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3b</xref>), consistent with the formation of action chunks.</p>
<p>In order to test the role of action sequences, we looked at the choices of the subjects in a <italic>probe session</italic> inserted at the end of the training sessions (last bar in <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3a</xref>), in which in a small portion of the trials transitioning between stage 1 actions and stage 2 states were switched (<xref ref-type="fig" rid="pcbi.1007334.g002">Fig 2c</xref>). For example, during training (non-probe sessions), after executing action ‘L’ subjects always ended up in state S2; however, the probe session included some rare transitions (20% of the trials), in which, after taking ‘L’, subjects ended up in state S1 instead of S2 [inspired by the two-stage task in <xref ref-type="bibr" rid="pcbi.1007334.ref009">9</xref>]. As a consequence, in the probe session, after repeating the same stage 1 action subjects might end up in a different stage 2 state than on the previous trial, meaning that they would next take a different stage 2 action if they are selecting actions one by one. If, however, subjects are repeating the previously rewarded action sequence, we should expect them to repeat not only the first action, but also the second action even if they are now in a different stage 2 state [<xref ref-type="bibr" rid="pcbi.1007334.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref010">10</xref>]. <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3c</xref> shows an example of this situation. Animals have earned reward from action sequence ‘L→R’ on the previous trial and have repeated action ‘L’ at stage 1 of the next trial, but on this trial have ended up in state S1 in which action ‘L’ should be taken. If, however, they take action ‘R’ this can be taken as a sign that they are repeating the whole action sequence rewarded on the previous trial.</p>
<p>
<xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3d</xref> shows the probability of staying on the same stage 2 action on the trials in which the stage 2 state is different from that of the previous trial. As the figure shows, if the previous trial is rewarded (‘reward’ condition) and subjects stay on the same stage 1 action (‘stay’ condition) then there is a high chance that they will also repeat the same stage 2 action, indicating that they are repeating the whole previously rewarded action sequence. This is supported by a significant interaction between staying on the same stage 1 action and reward on the previous trial (<italic>β</italic> = 0.494 (CI: 0.055, 0.933), SE = 0.224, <italic>p</italic> = 0.027; see <xref ref-type="table" rid="pcbi.1007334.t002">Table 2</xref>:stage 2 for the full analysis). Therefore, the pattern of choices at stage 2 is consistent with the suggestion that the subjects have expanded the initial set of actions, that previously only included actions ‘L’ and ‘R’ (<xref ref-type="table" rid="pcbi.1007334.t001">Table 1a</xref>), to a more complex set that includes action sequences ‘L→R’ and ‘R→L’ (<xref ref-type="table" rid="pcbi.1007334.t001">Table 1c</xref>).</p>
<table-wrap id="pcbi.1007334.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007334.t002</object-id>
<label>Table 2</label>
<caption>
<title>Results of the logistic regression analysis of stage 1 and stage 2 choices in the probe session.</title>
<p>For the stage 1 choices, the analysis focused on staying on the same stage 1 action on the next trial, based on whether the previous trial was rewarded and whether it was common or rare (trans). ‘reward:transition’ is the interaction between reward, and transition type. For stage 2 choices, the analysis focused on staying on the same stage 2 action, based on staying on the same stage 1 action (stay) and earning a reward on the previous trial. ‘reward:stay’ is the interaction between ‘reward’, and ‘stay’.</p>
</caption>
<alternatives>
<graphic id="pcbi.1007334.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<tbody>
<tr>
<td align="center" colspan="5"><bold>stage 1 actions</bold></td>
</tr>
<tr>
<td align="left"/>
<td align="center">intercept</td>
<td align="center">reward</td>
<td align="center">transition</td>
<td align="center">reward:transition</td>
</tr>
<tr>
<td align="left"><italic>p</italic>-value</td>
<td align="center">0.373</td>
<td align="center">0.003</td>
<td align="center">0.164</td>
<td align="center">&lt; 10<sup>−5</sup></td>
</tr>
<tr>
<td align="left"><italic>β</italic> (SE)</td>
<td align="center">-0.16 (0.18)</td>
<td align="center">0.61 (0.20)</td>
<td align="center">0.37 (0.26)</td>
<td align="center">0.92 (0.20)</td>
</tr>
<tr>
<td align="center" colspan="5"><bold>stage 2 actions</bold></td>
</tr>
<tr>
<td align="left"/>
<td align="center">intercept</td>
<td align="center">reward</td>
<td align="center">stay</td>
<td align="center">reward:stay</td>
</tr>
<tr>
<td align="left"><italic>p</italic>-value</td>
<td align="center">0.001</td>
<td align="center">&lt;0.001</td>
<td align="center">0.019</td>
<td align="center">0.027</td>
</tr>
<tr>
<td align="left"><italic>β</italic> (SE)</td>
<td align="center">-0.95 (0.29)</td>
<td align="center">0.84 (0.23)</td>
<td align="center">0.60 (0.25)</td>
<td align="center">0.49 (0.22)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>It is important to note that the emergence of such actions sequences depended on the experimental setting; as reported in the <xref ref-type="supplementary-material" rid="pcbi.1007334.s016">S5</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007334.s017">S6</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007334.s018">S7</xref> Figs and <xref ref-type="supplementary-material" rid="pcbi.1007334.s002">S2 Text</xref>, we did not find evidence of action sequences using particular experimental parameters; see Section ‘Choice of experimental parameters’ below.</p>
</sec>
<sec id="sec005">
<title>The integration of adaptive state-space and action representations</title>
<p>The analysis provided in the previous section showed that acquiring either the state-space representation or action sequences can explain the pattern of choices observed during the course of training (<xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3a</xref>). Furthermore, the pattern of choices at stage 2 of the probe session provided evidence that the subjects are using action sequences. It remains open to question, therefore, whether the rats are exclusively solving the task using action sequences without relying on the state-space of the task (<xref ref-type="table" rid="pcbi.1007334.t001">Table 1c</xref>), or are using both an expanded state-space and action representations for decision-making (<xref ref-type="table" rid="pcbi.1007334.t001">Table 1d</xref>). To answer this question we looked at the pattern of choices at stage 1 of the probe session.</p>
<p>As argued in the previous sections, if decisions are based on the true state-space of the task then we expect that, after earning reward on a trial, the same stage 1 action will be taken on the next trial. The same is not true for the trials with rare transitions in the probe session, however. This is because, if the reward was earned on a trial with a rare transition, the subjects should then switch to the other stage 1 action on the next trial if they are using their knowledge of the state-space of the task [<xref ref-type="bibr" rid="pcbi.1007334.ref009">9</xref>]. For example, imagine it is a trial with a rare transition and the rat, by taking ‘L’, is transferred to state S1 and earns reward. On the next trial, using the state-space of the task, the rat should switch to ‘R’ at stage 1 because ‘R’ is the stage 1 action that commonly (80% of time) leads to S1. As a consequence, staying on the same stage 1 action after earning reward depends both on the reward and the transition type on the previous trial.</p>
<p>On the other hand, if the rats are exclusively using action sequences without relying on the state-space of the task (<xref ref-type="table" rid="pcbi.1007334.t001">Table 1c</xref>), then staying on the same stage 1 action only requires that the previous trial was rewarded; the transition type of the previous trial should not have any effect. This is because earning reward by executing an action sequence will result in the same action sequence being repeated on the next trial (and so the same stage 1 action) irrespective of the transition type on the previous trial. Therefore, a main effect of reward on staying on the same stage 1 action in the next trial indicates that the subjects are using action sequences (<xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3f</xref>) whereas, an interaction between reward and transition type on the previous trial indicates that the subjects are using the true state-space of the task (<xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3g</xref>).</p>
<p>Importantly, the results of stage 1 actions, presented in <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3e</xref>, clearly revealed a significant reward-transition interaction (<xref ref-type="table" rid="pcbi.1007334.t002">Table 2</xref>:stage 1), indicating that the subjects were using the correct state-space of the task (<xref ref-type="table" rid="pcbi.1007334.t001">Table 1b</xref>). In addition, the main effect of reward was also significant, which indicates that the subjects were also using action sequences (<xref ref-type="table" rid="pcbi.1007334.t001">Table 1c</xref>). As such the pattern of choices indicates that the rats were using both action sequences and single actions guided by the true state-space of the task. Therefore, evidence from this study suggests that, as training progressed, the initially simple state-space and action representations (<xref ref-type="table" rid="pcbi.1007334.t002">Table 2a</xref>) were expanded to align with the true structure of the task (<xref ref-type="table" rid="pcbi.1007334.t002">Table 2d</xref>).</p>
<p>Note that there are other explanations for the main effect of reward, other than using action sequences. For example, it could be the case that after experiencing a rare transition, subjects presumed that the relationship between stage 1 actions and stage 2 states had switched, which predicts a main effect of reward on staying on the same stage 1 action even if subjects were not using action sequences. Another explanation for the main effect of reward is based on the notion of ‘model-free’ actions. Intuitively, this implies that earning reward after taking an action increases the chance of repeating the action; i.e., on this task, that reward increased the chance of taking the same stage 1 action on the next trial whether the experienced transition was common or rare [<xref ref-type="bibr" rid="pcbi.1007334.ref009">9</xref>]. Nevertheless, although these two accounts can predict a main effect of reward, they do not predict nor can they explain the effect observed on the stage 2 actions (as explained above in Section Adaptive action representation).</p>
<p>As mentioned earlier, we did not find evidence for the operation of action sequences in all the range of experimental parameters that we tested and the probe tests that we conducted (as described below in section ‘Choice of experimental parameters’). For the conditions that we did not find evidence for the operation of action sequences, the main effect of reward mentioned above can be attributed either to the model-free effects—as if animals did not acquire action sequences at all [<xref ref-type="bibr" rid="pcbi.1007334.ref009">9</xref>]–, or alternatively to the interruption of actions sequences, i.e., animals started action sequences, but because of the experimental parameters they managed to inhibit the execution of inappropriate sequences. Our results cannot distinguish between these two explanations, a point that we will expand on in the Discussion section.</p>
</sec>
<sec id="sec006">
<title>Potential effects of latent states and action biases</title>
<p>In the previous section, we argued that the reward-transition interaction is a sign the animals had acquired an adaptive state-space representation, which allowed them to learn the relationship between stage 1 actions and stage 2 states. However, recently, [<xref ref-type="bibr" rid="pcbi.1007334.ref017">17</xref>] argued that this form of reward-transition interaction in multistage decision-making can be explained if subjects have learned the ‘latent states’ of the task without relying on the relationship between stage 1 actions and stage 2 states. On this account, the rats simply learned a kind of rule: e.g., whenever a reward is earned in S1, perform ‘R’ on the next trial (at stage 1), and whenever a reward is earned in S2, perform ‘L’ on the next trial. [<xref ref-type="bibr" rid="pcbi.1007334.ref017">17</xref>] argue that this process requires the subjects to expand their representation of the state-space by turning S0 into latent states S0S1 and S0S2, which encode which stage 2 state was rewarded on the previous trial and, therefore, their argument depends on the rats expanding their representation of the state-space to include new states. As a consequence, even under [<xref ref-type="bibr" rid="pcbi.1007334.ref017">17</xref>]’s account, the observed reward-transition interaction is evidence for an adaptive state-space representation, as we have argued. Furthermore, this account cannot explain the adaptive action representations that we observe; i.e., the pattern of choices due to the formation of action sequences. This is because [<xref ref-type="bibr" rid="pcbi.1007334.ref017">17</xref>]’s account does not imply repeating the previously rewarded sequence of actions in S0 and S1/S2.</p>
<p>There is another potential interpretation of the reward-transition interaction based on the potential for a local response bias induced by the reward function. Assume that, in a part of the probe session, actions taken in S1 are rewarded (and actions taken in S2 are not), and by trial and error the animal develops a tendency to take action ‘R’ more frequently than ‘L’ at S0; i.e., the probability of staying on the same action when it is ‘R’ is higher than when it is ‘L’. As most of the common transitions after taking ‘R’ are rewarded (as they mostly lead to S1) and most of the rare transitions are non-rewarded (as they mostly lead to S2), there will be an effect of reward-transition interaction on the probability of staying on the same action, which looks like the animals are taking the structure of the world into account, while what they are doing is simply taking action ‘R’ more frequently. This issue was discussed in [<xref ref-type="bibr" rid="pcbi.1007334.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref018">18</xref>] and further analysed in [<xref ref-type="bibr" rid="pcbi.1007334.ref017">17</xref>] and one way to address it is to add a new predictor to the analysis of the effect of reward and transition on staying on the same stage 1 action. This new predictor encodes whether the previous stage 1 action was the best action, i.e., it leads to the stage 2 state with the highest reward, which will absorb the effect of the reward-transition interaction if the interaction is just due to repeating the best action more frequently [<xref ref-type="bibr" rid="pcbi.1007334.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref017">17</xref>]. This analysis is presented in <xref ref-type="supplementary-material" rid="pcbi.1007334.s007">S5 Table</xref>, which shows that even in the presence of this predictor the effect of reward and the reward-transition interaction are still significant. As such, the reward-transition interaction is unlikely to be due to this form of response bias.</p>
</sec>
<sec id="sec007">
<title>Choice of experimental parameters</title>
<p>Animals were given three probe sessions in total, and the results reported above were taken from the last of these tests which was the final experimental session (probe sessions are marked by an asterisk in <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3a</xref>). The full analysis of all the probe sessions is presented in see <xref ref-type="supplementary-material" rid="pcbi.1007334.s006">S4 Table</xref>. The structure of the probe sessions was identical to each other and also in terms of results; similar to the third probe session analysed above, the main effect of reward was significant in sessions one and two. However, unlike the last probe session, in the first two sessions, the rats did not show evidence that they were using action sequences (<xref ref-type="supplementary-material" rid="pcbi.1007334.s006">S4 Table</xref>: probe 1 and 2, stage 2 actions; reward-stay interaction; <italic>p</italic>-value&gt;0.1). A closer examination of these sessions revealed that, at this stage in the training, the rats were not discriminating between the stage 2 stimuli; i.e., because the analysis of stage 2 only included trials in which the stage 2 state is different from the previous trial, we expected the probability of staying on the same stage 2 action to be generally low (as different actions are rewarded in the stage 2 states), which was not the case in the first two probe sessions (see <xref ref-type="supplementary-material" rid="pcbi.1007334.s006">S4 Table</xref>; <italic>p</italic>-value &gt; 0.05 for the intercept term at stage 2 actions in probe 1, 2). As a consequence, under these conditions, staying on the wrong stage 2 action due to the performance of action sequences cannot be detected, because the rats are likely to take the incorrect action at stage 2 states even if they are not taking an action sequence (ceiling effect). One reason for this lack of discrimination is the potential for interference between the stage 1 and stage 2 actions; if the rats checked the magazine after taking the stage 1 action they may then have repeated the same stage 1 action instead of taking the correct stage 2 action. This would make it look like the animals were not discriminating between stage 2 stimuli. To address this issue we introduced the ‘strict sequences’ criterion for the next ten training sessions (<xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3e</xref>) under which a trial was aborted if a rat entered the magazine between the stage 1 and stage 2 actions. After these ten training sessions the rats were given the third probe test, in which they showed they were able significantly to discriminate between the stage 2 states (see <xref ref-type="table" rid="pcbi.1007334.t002">Table 2</xref>; <italic>p</italic>-value = 0.001 for the intercept term at stage 2 actions). Note that the analysis presented in the previous and subsequent sections relates to this last probe session.</p>
<p>In <xref ref-type="supplementary-material" rid="pcbi.1007334.s016">S5</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007334.s017">S6</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007334.s018">S7</xref> Figs, <xref ref-type="supplementary-material" rid="pcbi.1007334.s002">S2 Text</xref> we also present three supplemental experiments each of which used different parameters. Supplementary experiment 1, which is shown in <xref ref-type="supplementary-material" rid="pcbi.1007334.s016">S5 Fig</xref>, includes probe sessions throughout the training process and shows the development of choices. Supplementary experiments 2 and 3 are mostly similar to each other and provide a training protocol in which animals reliably exhibit the reward effect in their stage 1 actions. However, in none of these experiments were we able to observe the performance of action sequences, as indicated by the reward-same interaction in stage 2 actions (see <xref ref-type="supplementary-material" rid="pcbi.1007334.s008">S6 Table</xref> for the full analysis of supplementary experiment 1 and <xref ref-type="supplementary-material" rid="pcbi.1007334.s010">S8 Table</xref> for the full analysis of supplementary experiments 2,3). One main difference between these experiments and the experiment reported in the main paper is that, whereas in the main experiment the ITI was zero, in the supplementary experiments, the inter-trial interval was non-zero. In this latter condition, animals were often found to take actions during the ITI, which were not rewarded but which were very likely to interfere with the performance of action sequences once the next trial started. Using an ITI of zero addressed this issue. Lastly, as <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3a</xref> shows, there were some training sessions in which the contingency between stage 1 actions and stage 2 states was reversed. These training sessions were introduced to overcome the interference that could be produced when animals were first exposed to rare trails.</p>
</sec>
<sec id="sec008">
<title>Computational models of adaptive decision-making</title>
<p>We next sought to establish the computational model that best characterized the decision-making process used by the rats in this experiment. The modelling was focused on the probe session that we analysed in the previous sections (the final probe session). For this purpose, we compared different families of reinforcement-learning (RL) model to establish which provided a better explanation for the data (<xref ref-type="table" rid="pcbi.1007334.t003">Table 3</xref>). The families compared included: (1) a non-hierarchical model-based RL family (MB) corresponding to <xref ref-type="table" rid="pcbi.1007334.t001">Table 1b</xref>, which assumes that the subjects acquired the correct state-space of the task, but in which action sequences were <italic>not</italic> included in the set of actions; (2) a hierarchical RL family (H) corresponding to <xref ref-type="table" rid="pcbi.1007334.t001">Table 1c</xref>, which assumes that the set of actions included only action sequences, but that decisions were <italic>not</italic> guided by the true state-space of the task; (3) a hierarchical model-based RL family (H-MB) corresponding to <xref ref-type="table" rid="pcbi.1007334.t001">Table 1d</xref>, which assumes that the subjects were using single actions, action sequences and the true state-space representation for decision-making [<xref ref-type="bibr" rid="pcbi.1007334.ref010">10</xref>]; (4) a model-free RL family (MF) without action sequences but using the correct state-space (5) a model-free RL family with action sequences and single actions and correct stat-space of the task (H-MF), (6) a hybrid model-based RL and model-free RL family with only single actions and without action sequences using the correct state-space (MB-MF), and (7) a hybrid of model-based and model-free RL with both action sequences and single actions (H-MB-MF). Model-free RL has been previously used to characterise performance on a similar task [<xref ref-type="bibr" rid="pcbi.1007334.ref009">9</xref>], and here we used it as a baselines in mixture with model-based RL and hierarchical accounts.</p>
<table-wrap id="pcbi.1007334.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007334.t003</object-id>
<label>Table 3</label>
<caption>
<title>States and actions for each family of computational model along with degrees-of-freedom (df), pseudo-<italic>r</italic><sup>2</sup>, and negative log model-evidence (− log <italic>p</italic>(<italic>D</italic>|<italic>M</italic>)) for the best model in each family; lower values of negative log model-evidence are better.</title>
</caption>
<alternatives>
<graphic id="pcbi.1007334.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">family</th>
<th align="center">state-space</th>
<th align="center">actions</th>
<th align="center">df</th>
<th align="center">p-<italic>r</italic><sup>2</sup></th>
<th align="center">negative log model-evidence</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">MB</td>
<td align="center">S0, S1, S2</td>
<td align="center">L, R</td>
<td align="center">4</td>
<td align="char" char=".">0.175</td>
<td align="char" char=".">1222.576</td>
</tr>
<tr>
<td align="center">H</td>
<td align="center">S0</td>
<td align="center">L → R, R → L</td>
<td align="center">5</td>
<td align="char" char=".">0.207</td>
<td align="char" char=".">1185.274</td>
</tr>
<tr>
<td align="center">H-MB</td>
<td align="center">S0, S1, S2</td>
<td align="center">L, R, R → L, L → R</td>
<td align="center">4</td>
<td align="char" char=".">0.207</td>
<td align="char" char=".">1172.357</td>
</tr>
<tr>
<td align="center">MF</td>
<td align="center">S0, S1, S2</td>
<td align="center">L, R</td>
<td align="center">4</td>
<td align="char" char=".">0.175</td>
<td align="char" char=".">1219.870</td>
</tr>
<tr>
<td align="center">MB-MF</td>
<td align="center">S0, S1, S2</td>
<td align="center">L, R</td>
<td align="center">5</td>
<td align="char" char=".">0.180</td>
<td align="char" char=".">1223.515</td>
</tr>
<tr>
<td align="center">H-MF</td>
<td align="center">S0, S1, S2</td>
<td align="center">L, R, R → L, L → R</td>
<td align="center">4</td>
<td align="char" char=".">0.204</td>
<td align="char" char=".">1179.717</td>
</tr>
<tr>
<td align="center">H-MB-MF</td>
<td align="center">S0, S1, S2</td>
<td align="center">L, R, R → L, L → R</td>
<td align="center">5</td>
<td align="char" char=".">0.211</td>
<td align="char" char=".">1178.339</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>In total we considered 536 different models in which each family consisted of several members with different degrees of freedom (see <xref ref-type="supplementary-material" rid="pcbi.1007334.s001">S1 Text</xref> for details). We then calculated the negative log model-evidence for each model <italic>M</italic> given the choices of subjects, <italic>D</italic> (denoted by − log <italic>p</italic>(<italic>D</italic>|<italic>M</italic>)). <xref ref-type="table" rid="pcbi.1007334.t003">Table 3</xref> shows the negative log model-evidence along with other properties of the best model for each family. The differences in log model-evidence (log-Bayes factor) between the best fitting model of the H-MB family and other families was greater than 5. In the Bayesian model comparison literature, log-Bayes factors greater than 3 are considered to be strong evidence [<xref ref-type="bibr" rid="pcbi.1007334.ref019">19</xref>]. Therefore, the above results provide strong evidence that the subjects were utilising H-MB to guide action selection compared to the other models. <xref ref-type="fig" rid="pcbi.1007334.g004">Fig 4</xref> shows the negative log model-evidence for the best eight models in each family and shows that the best model in the H-MB family provides a better explanation of the data than any of the other families.</p>
<fig id="pcbi.1007334.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007334.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Negative log model-evidence (− log <italic>p</italic>(<italic>D</italic>|<italic>M</italic>); lower numbers indicate better models) for the first best eight models in each family of computational models.</title>
<p>Different models are shown on the y-axis using different colours for better visualisation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.g004" xlink:type="simple"/>
</fig>
<p>We then simulated eight instances of the H-MB model of the task using the best fitting parameters for each subject (<xref ref-type="supplementary-material" rid="pcbi.1007334.s004">S2 Table</xref>) and analysed the stage 1 and stage 2 choices of the simulated model. Analysis of stage 1 choices (<xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3i</xref>) revealed a significant main effect of reward (<italic>β</italic> = 0.293 (CI: 0.217, 0.369), SE = 0.038, <italic>p</italic> &lt; 0.001), and a significant interaction between whether the previous trial was rewarded and the transition type of the previous trial (<italic>β</italic> = 0.327 (CI: 0.233, 0.422), SE = 0.048, <italic>p</italic> &lt; 0.001). Analysis of stage 2 choices (<xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3h</xref>), revealed a significant interaction between earning a reward on the previous trial and the likelihood of staying on the same stage 1 action (<italic>β</italic> = 0.209 (CI: 0.091, 0.327), SE = 0.060, <italic>p</italic> &lt; 0.001). These results are, therefore, consistent with the behavioural results of our experiments using rats as subjects. The fact that the H-MB family provides a better fit than the H family implies that subjects were using the correct state-space of the task (the MB part), whereas the finding that the H-MB family were better than the MB family implies that subjects were using action sequences. See <xref ref-type="supplementary-material" rid="pcbi.1007334.s019">S8 Fig</xref> for the similar simulations using the best fitting model in other classes of models. See <xref ref-type="supplementary-material" rid="pcbi.1007334.s003">S1 Table</xref> for the negative log-model evidence of the best model in each family.</p>
<p>The H-MB family also provided a better fit than baseline MB/MF models, however, this does not imply that some form of model-free RL is not working concurrently with a H-MB model. Indeed, one can imagine a model which includes both MB and MF components operating hierarchically over action sequences. Whether such a model provides a better fit of the data than H-MB cannot be addressed using the current task because it will require manipulating the value of the outcomes. The conclusions made earlier about learning the state-space and action sequences are orthogonal to the role that MF RL plays in these decisions, and therefore they are not affected by this limitation.</p>
</sec>
</sec>
<sec id="sec009" sec-type="conclusions">
<title>Discussion</title>
<p>Learning the value of different actions in various states of the environment is essential for decision-making in multi-stage environments. This learning process operates above the state-space and action representation and, therefore, the ability to (i) acquire the correct state-space of the task, and (ii) create new actions that are useful for solving the task, are important for efficient decision-making. Using a sequential decision-making task in rats, we provide direct evidence that, early in training, subjects make decisions based on simple state-space and action representations, but that, during the course of training, both state-space and action representations (under certain conditions) evolve and adapt to the structure of the environment. That is, we found that the rats responded initially as if the proximal response to reward was the only relevant action to earn that reward but gradually learned the interaction between the first lever press and the second lever press response within and across the states signalled by the discriminative stimuli and so acquired the multistage discrimination. Furthermore, we found evidence that the single lever press actions initially acquired by the rats later expanded to include sequences of lever presses and that, when these sequences were used, they tended to be used in a habitual manner by repeating previously rewarded sequences even when the stage 2 state was revalued.</p>
<p>The ability to solve multi-stage decision-making tasks has been previously demonstrated in different species, however, unlike the current study, these demonstrations have either given the different stages of the task to the subjects [e.g., <xref ref-type="bibr" rid="pcbi.1007334.ref009">9</xref>], or have explicitly signalled the actions that should be taken at each stage [e.g., <xref ref-type="bibr" rid="pcbi.1007334.ref020">20</xref>], which remove the necessity for building multi-stage representations to solve the task. Similarly, the ability of animals to concatenate simple actions to execute action sequences has been established previously and here we extended these prior studies by showing that, during the course of learning, single actions turn into action sequences that are not only executed, but also are evaluated as a single response unit [<xref ref-type="bibr" rid="pcbi.1007334.ref013">13</xref>]. Similar findings have recently been reported demonstrating that lever press-magazine entry sequences are resistant to devaluation in rats [<xref ref-type="bibr" rid="pcbi.1007334.ref021">21</xref>].</p>
<p>A task similar to the two-stage task that we used here in rats has previously been employed to study different forms of decision-making processes in humans [<xref ref-type="bibr" rid="pcbi.1007334.ref009">9</xref>]. Although the experiments in those studies were composed of a single session, results indicated that the subjects were using an expanded state-space representation without needing to go through multiple training sessions. This is presumably due to the instructions and the cover story provided to the subjects, which informed them about the correct state-space representation. In terms of acquiring action sequences, using a similar task in humans we have previously shown that subjects engaged action sequences [<xref ref-type="bibr" rid="pcbi.1007334.ref010">10</xref>]. Again, however, we found they were able to do so without requiring multiple training sessions. Why such sequences should have formed so rapidly is a matter of conjecture but, as the task involved pressing keys on a keyboard, familiarity with similar response sequences could have supported sequence acquisition (especially as only two key presses were required to earn the reward). Based on these comparisons, the results of the current experiments point to the importance and complexity of learning state-space and action representations. As the profile of the rats’ choices indicates, they required a significant amount of training in order to learn the structure of the environment (10-40 sessions). This is while, in some instrumental conditioning settings, animals are able to learn the contingency between actions and states in two and sometimes in a single training session [<xref ref-type="bibr" rid="pcbi.1007334.ref014">14</xref>]. Uncovering the processes that determine the encoding of the state-space of the task and how this process interacts with that subserving instrumental conditioning will be an important step towards better understanding the learning mechanisms that mediate decision-making processes generally.</p>
<p>The results of the computational modelling indicated that hierarchical model-based RL provides the best explanation for the rats’ choices. This model assumes that the subjects build an internal map of the environment which encodes both the specific outcomes of single actions <italic>and</italic> of action sequences. The validity of this assumption for single actions can be confirmed based on the results of the current experiment and previous studies [<xref ref-type="bibr" rid="pcbi.1007334.ref022">22</xref>] showing that subjects encode the specific outcome of each individual action, e.g., taking ‘R’ leads to ‘S1’ and ‘L’ leads to ‘S2’. With regard to encoding the outcome of action sequences, although previous studies have indicated that the subjects specifically encode the outcome of each action sequence [<xref ref-type="bibr" rid="pcbi.1007334.ref013">13</xref>], we cannot assess whether subjects encoded outcome specific sequences in the current study because the value of the food outcome was not manipulated. As such, the results do not address the (model-based or model-free) nature of the controller mediating the evaluation of action sequences.</p>
<p>Although the computational modelling analysis provided evidence consistent with hierarchical model-based RL, the results do not imply that all the behavioural trends in the data were captured by the model. In particular, although a wide range of models with different parameters were considered here, there were some differences between the pattern of stage 1 choices in the data shown in <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3(e)</xref> and the simulations of the best model shown in <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3(i)</xref>. One way to address this issue is using recurrent neural networks (RNNs) instead of the RL family, which are more flexible and able to learn the details of the behavioural processes without relying on manually engineering the models [<xref ref-type="bibr" rid="pcbi.1007334.ref023">23</xref>]. Another limitation of the current work is that, although we provided evidence for the expansion of the state-space of the task, we did not provide any computational account for ‘how’ the states-space is acquired by the animals. This can potentially be addressed by approximating <italic>Q</italic>–values using a parametrised family of models able to adjust their predictions as the training progresses.</p>
<p>Along the same lines, as we discussed in the previous sections, the emergence and detection of action sequences requires certain experimental conditions, such as a short ITI. Without these conditions actions at stage 1 are consistent with the operation of action sequences, but not actions at stage 2. One explanation for this effect is the possibility that action sequences were inhibited. For example, if during long ITIs the subjects go through extinction, it is unlikely that they keep performing the whole action sequence throughout the ITI and into the next trial. As such, although the first component of the action sequence at stage 1 is performed, the second component may be inhibited when it is inappropriate, making it harder to detect the performance of action sequences. Alternatively, this pattern of choices could also indicate the operation of another RL system, such as model-free RL, instead of interrupted sequences. Within this alternative framework, choices are a mixture of goal-directed actions (model-based), and model-free actions that are guided by their ‘cached’ [as opposed to their current values]. Our results are equivocal with respect to this interpretation, but since, in other conditions, there is positive evidence for action sequences, it is more parsimonious to interpret this result in terms of the inhibition of action sequences rather than as the output of an additional model-free system.</p>
<p>The current task and the parameter set that we have assessed in these experiments (see also <xref ref-type="supplementary-material" rid="pcbi.1007334.s002">S2 Text</xref>) constitute an addition to the developing literature on multistage discrimination learning [e.g., <xref ref-type="bibr" rid="pcbi.1007334.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref025">25</xref>] and its relationship to action sequence learning in rats [<xref ref-type="bibr" rid="pcbi.1007334.ref013">13</xref>]. Importantly, this research demonstrates that one way in which rats, and potentially other animals including humans [<xref ref-type="bibr" rid="pcbi.1007334.ref010">10</xref>], learn complex multistage discriminations is not just by expanding the task space through shifts in attention across the perceptual feature dimensions of complex stimuli [<xref ref-type="bibr" rid="pcbi.1007334.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref027">27</xref>] but also by expanding the action repertoire from single actions to action sequences. The tendency to generate such sequences may have been aided by some important features of the current task; perhaps the most important of which was our attempt to minimize the impact of predictive cues in the first stage that could significantly interfere with the action-related predictions of the second stage state. However, a recent study [<xref ref-type="bibr" rid="pcbi.1007334.ref028">28</xref>] that replicated many of the effects reported by [<xref ref-type="bibr" rid="pcbi.1007334.ref010">10</xref>] with regard to the development of action sequences in a multistage discrimination task in human subjects nevertheless confounded stimulus and action predictions at the first stage as others have done [<xref ref-type="bibr" rid="pcbi.1007334.ref009">9</xref>]. However, the Adams and Cushman’s study differed from Dezfouli and Balleine’s in also reporting some evidence for a model-free component of performance over and above the model-based selection of habitual action sequences, which raises the possibility that evidence of model-free RL in first stage choices depended on using specific first stage stimuli that could provide stimulus values for the second stage states. That feature aside, however, the current task is a close analogue for the human 2 stage task generated by Daw and colleagues and particularly that of [<xref ref-type="bibr" rid="pcbi.1007334.ref010">10</xref>] and appears to produce very similar effects in both rodent and human subjects.</p>
<p>Given its utility in animals, this task could, therefore, provide the opportunity to not only investigate the behavioural and psychological determinants of performance across species but, by utilising more direct neural manipulations, to establish the way in which the brain supports state and action learning in multistage discrimination tasks and particularly how model-based control of simple actions and habitual actions sequences is implemented in multistage discriminations. Generally, the interaction of a model-free controller with action sequence learning has not been evaluated at the neural level, although considerable evidence suggests that premotor and presupplementary motor regions are likely to play an important role [e.g., <xref ref-type="bibr" rid="pcbi.1007334.ref029">29</xref>]. This is particularly true given the evidence in animals that damage to the rodent homologue of premotor cortex reduces otherwise sequential action-outcome relations simple actions [<xref ref-type="bibr" rid="pcbi.1007334.ref013">13</xref>]. This account is strikingly different from other models within which goal-directed actions and habits and their computational model-based and model-free implementation have typically been seen as antagonistic processes for which some form of arbitrator is required to adjudicate competition between them. Arbitration has been investigated in a number of paradigms in humans and several investigators have found evidence of model-based model-free arbitration-related activity particularly in the inferior lateral prefrontal cortex [<xref ref-type="bibr" rid="pcbi.1007334.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1007334.ref031">31</xref>]. In contrast, within hierarchical models, goal-directed actions and habit sequences do not compete, being two action strategies from which the goal-directed controller selects. Which of these is the more accurate statement of the way goal-directed and habitual actions interact is an empirical issue but other potential models of performance have generally suggested that collaboration rather than competition between action controllers more accurately captures their interactions [cf. <xref ref-type="bibr" rid="pcbi.1007334.ref032">32</xref>].</p>
</sec>
<sec id="sec010" sec-type="materials|methods">
<title>Methods and materials</title>
<sec id="sec011">
<title>Subjects and apparatus</title>
<p>Eight experimentally naive male Hooded Wistar rats served as subjects in this study. Data from all the subjects are included in the analyses. All animals were housed in groups of two or three and handled daily for one week before training. Training and testing took place in eight Med Associates operant chambers housed within sound- and light-resistant shells. The chambers were also equipped with a pellet dispenser that delivered one 45 mg pellet when activated (Bio-Serve). The chambers contained two retractable levers that could be inserted to the left and the right of the magazine. The chambers contained a white noise generator, a Sonalert that delivered a 3 kHz tone, and a solenoid that, when activated, delivered a 5 Hz clicker stimulus. All stimuli were adjusted to 80 dB in the presence of a background noise of 60 dB provided by a ventilation fan. A 3 W, 24 V house light mounted on the wall opposite the levers and magazine illuminated the chamber. Microcomputers equipped with MED-PC software (Med Associates) controlled the equipment and recorded responses. Animals were food deprived one week before starting behavioral procedures. They were fed sufficiently to maintain their weight at 90% of their free-feeding weight. The animals were fed after the training sessions each day and had free access to tap water whilst in their home cage. Each training session (except the magazine training sessions) started with insertion of the levers, and ended with their retraction. All procedures were approved by the University of Sydney Animal Ethics Committee.</p>
</sec>
<sec id="sec012">
<title>Behavioral procedures</title>
<p>Rats were given two sessions of magazine training in which 30 grain pellets were delivered on a random time 60-s schedule (<xref ref-type="fig" rid="pcbi.1007334.g001">Fig 1</xref>:phase 1). Rats were then trained to lever press on a continuous reinforcement schedule with one session on the left lever and one session on the right lever each day for four days with the total number of outcomes each day limited to 60 per session (<xref ref-type="fig" rid="pcbi.1007334.g001">Fig 1</xref>). The total duration of each session was limited to 60 minutes (see <xref ref-type="supplementary-material" rid="pcbi.1007334.s013">S2 Fig</xref> for the average session duration). Next, rats were trained to discriminate the two stimuli (<xref ref-type="fig" rid="pcbi.1007334.g001">Fig 1</xref>:phase 3). Each session started with the presentation of a stimulus. The stimulus was presented until the rat performed an action (either pressing the left or right lever) after which the stimulus turned off. For one stimulus, taking the left action led to the reward, whereas for the other stimulus taking the right action led to reward. Levers and stimuli were counterbalanced across subjects. After an action was chosen, there was a 60-second inter-trial interval (ITI) after which the next trial started with the presentation of the next stimulus, again chosen randomly. The duration of each session was 90 minutes, with no limit on the maximum number of earned rewards. The stimuli were a constant or a blinking house light (5 Hz). The result of this phase is depicted in <xref ref-type="supplementary-material" rid="pcbi.1007334.s015">S4 Fig</xref>.</p>
<p>The rats then received training on the two-stage task depicted in <xref ref-type="fig" rid="pcbi.1007334.g002">Fig 2b</xref> (maximum 60 outcomes in a session and maximum duration of a session was limited to 1 hour). Animals were trained on the two-stage task for 40 sessions. In the middle of, or at the end of these training sessions, they were given probe sessions, similar to the training sessions except that stage 1 actions led to stage 2 states in a probabilistic manner (<xref ref-type="fig" rid="pcbi.1007334.g002">Fig 2c</xref>). These sessions are indicated by ‘*’ in <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3a</xref>. After the first two training sessions, subjects then received ten more training sessions, and were then given a further probe test. The results reported in the Results section correspond to this last probe session. In the sessions marked with ‘#’ in <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3a</xref> the contingency between stage 1 actions and stage 2 states were reversed (‘L’ leads to S1 and ‘R’ to S2); these training sessions were followed by a session in which ‘L’ leads to S1 and ‘R’ to S2 in 20% of times, followed by normal training sessions, as <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3a</xref> shows. Finally, ‘strict sequence’ in <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3a</xref> refers to a session in which a trial was aborted if the animal entered the magazine between stage 1 and stage 2 actions. In all the training phases levers were present throughout the training session. See <xref ref-type="supplementary-material" rid="pcbi.1007334.s005">S3 Table</xref> for the total number of trials completed by each subject; see <xref ref-type="supplementary-material" rid="pcbi.1007334.s009">S7</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007334.s011">S9</xref> Tables for the total number of trials completed by subject in the supplementary experiments.</p>
</sec>
<sec id="sec013">
<title>Behavioral analysis</title>
<p>We used R [<xref ref-type="bibr" rid="pcbi.1007334.ref033">33</xref>] and lme4 packages [<xref ref-type="bibr" rid="pcbi.1007334.ref034">34</xref>] to perform a generalized linear mixed effects analysis. In all of the analyses, logistic regression was used and all the fixed effects (including intercepts) were treated as random effects varying across subjects. For analyses that included more than one session, random effects were assumed to vary across sessions and subjects in a nested manner. Confidence intervals (CI) of the estimates were calculated using the ‘confint’ method of lme4 package with the ‘Wald’ parameter.</p>
<p>In the analyses of the stage 1 of non-probe sessions, we used a logistic regression analysis in which the independent predictor was whether the previous trial was rewarded (reward or no-reward), and the dependent variable was staying on the same stage 1 action. The <italic>p</italic>-value of this analysis was used in <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3a</xref> for colour-coding each bar, and the height of each bar represented the log odds ratio. The intercept term of this analysis is shown in <xref ref-type="supplementary-material" rid="pcbi.1007334.s012">S1 Fig</xref>. In the analyses of stage 1 of the probe sessions, the independent predictors were transition type of the previous trial (rare or common) and whether the previous trial was rewarded (reward or no-reward), whereas the dependent variable was staying on the same stage 1 action. The effects of interest were reward and the reward by transition-type interaction. In the analysis of stage 2 probe sessions, the independent variables were whether the stage 1 action was repeated (same stage 1), and whether the previous trial was rewarded. The dependent variable was staying on the same stage 2 action. The effect of interest was the interaction between the two independent variables. Note that only trials in which the stage 2 state was different from the stage 2 state of the previous trial were included in this analysis.</p>
<p>In all the analyses, only trials in which subjects made a correct discrimination on the previous trial (‘R’ in S2, and ‘L’ in S1) were included (%71 of trials in the whole training period). This was for two reasons. Firstly, it was not clear how subjects learn from actions taken during incorrect discriminations, which were never rewarded. Secondly, as depicted in <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3c</xref>, for the analysis of adaptive action representation, we focused on the trials in which the stage 2 states was different from that of the previous trial. When executing action sequences, we expected the subject to take the same stage 2 action in the next trial if (i) they were rewarded in the previous trial and (ii) they take the same stage 1 action, but not otherwise (as we focused on consecutive trials with different stage 2 states). However, assume that the subject makes an incorrect discrimination in the previous trial, e.g., it takes action ‘L’ at stage 1, moves to state S2 and takes action ‘L’ in that state, which is not rewarded since action ‘L’ in S2 is never rewarded. In the next trial, if the subject takes action ‘L’ again and ends up in state S1 (<xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3c</xref>), there is a high chance that it will take ‘L’ again at stage 2, since ‘R’ is never rewarded in S1. Therefore, even if no reward was earned in the previous trial, there is a high chance that the subject will repeat the same stage 2 action in a different trial. This only happens in the condition that the subject made an incorrect discrimination in the previous trial, and in order to remove this interaction between the discrimination between actions at stage 2, and the analysis of action sequences, we only included the trials in which the subjects made correct discrimination in the previous trial. The analysis similar to the one presented in <xref ref-type="supplementary-material" rid="pcbi.1007334.s006">S4 Table</xref> without removing these trials is presented in <xref ref-type="supplementary-material" rid="pcbi.1007334.s007">S5 Table</xref>, which shows that the main statistical tests that we used to argue for adaptive state-space and action representations are statistically significant whether we include all of the trials or not.</p>
</sec>
<sec id="sec014">
<title>Computational modelling</title>
<p>Reinforcement-learning models considered for behavioural analysis were similar to the hierarchical RL models provided in [<xref ref-type="bibr" rid="pcbi.1007334.ref010">10</xref>] and the model-based/model-free family provided in [<xref ref-type="bibr" rid="pcbi.1007334.ref009">9</xref>]. In addition to these families, we also considered a family of hierarchical models (corresponding to the H family) in which only action sequences were available at stage 1 (i.e., single actions ‘L’ and ‘R’ were not available). In addition to the free-parameters mentioned in previous work, we added two new parameters here. The first free-parameter only applies to the hierarchical families (H, H-MB, H-MF, H-MB-MF), which represented the probability that the performance of action sequences is interrupted in the middle of the action sequence (i.e., subjects only perform the first component of an action sequence, and select a new action at stage 2). The other free-parameter coded the tendency of animals to take the discriminative action at stage 2, irrespective of the value of each action (tendency to take ‘R’ in S2 and ‘L’ in S1). This free-parameter allowed the model to learn that one of the actions in each of the stage 2 states was never rewarded. Details of the computational models along with their mathematical descriptions are presented in <xref ref-type="supplementary-material" rid="pcbi.1007334.s001">S1 Text</xref>. For the purpose of model comparison, we generated different instances of each family of models with different degrees of freedom (see <xref ref-type="supplementary-material" rid="pcbi.1007334.s001">S1 Text</xref> for details). Model-evidence, reported in <xref ref-type="table" rid="pcbi.1007334.t003">Table 3</xref> and <xref ref-type="fig" rid="pcbi.1007334.g004">Fig 4</xref> was calculated similar to [<xref ref-type="bibr" rid="pcbi.1007334.ref035">35</xref>].</p>
</sec>
</sec>
<sec id="sec015">
<title>Supporting information</title>
<supplementary-material id="pcbi.1007334.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Computational modelling.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s002" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Supplementary experiments.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s003" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>For the best model in each family, the table represents the negative log-model evidence (− log <italic>P</italic>(<italic>D</italic>|<italic>M</italic>)) for each model, the number of free parameters of each model (df), the free parameters of each model, and the family of each model.</title>
<p>The table also represents a pseudo-r statistic (p–<italic>r</italic><sup>2</sup>), which is a normalized measure of the variance accounted for in comparison to a model with random choices (averaged over subjects). ‘*’ indicated the model with the best model evidence.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s004" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Value of the estimated parameters for each subject.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s005" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Total number of trials in the experiment reported in the main paper.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s006" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>Results of the logistic regression analysis of stage 1 and stage 2 choices for the experiment reported in the main paper.</title>
<p>For the stage 1 choices, the analysis is focused on staying on the same stage 1 action on the next trial, based on whether the previous trial was rewarded (reward), and whether the previous trial was common or rare (transition). ‘reward:transition’ is the interaction between reward, and transition type, and ‘intercept’ refers to the intercept term. For stage 2 choices, the analysis is focused on staying on the same stage 2 action, based on staying on the same stage 1 action (stay) and earning a reward in the previous trial (reward). ‘reward:stay’ is the interaction between ‘reward’, and ‘stay’. ‘probe 3’ are the results reported in the main paper.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s007" xlink:type="simple">
<label>S5 Table</label>
<caption>
<title>Results of the logistic regression analysis of stage 1 and stage 2 choices for the experiment reported in the main paper.</title>
<p>For the stage 1 choices, the analysis is focused on staying on the same stage 1 action on the next trial, based on whether the previous trial was rewarded (reward), and whether the previous trial was common or rare (transition). ‘reward:transition’ is the interaction between reward, and transition type, and ‘intercept’ refers to the intercept term. ‘correct’ means that whether the correct stage 1 action was taken in the previous trial. ‘correct’ stage 1 action in refers to the stage 1 action which led the rewarded stage 2 state. For stage 2 choices, the analysis is focused on staying on the same stage 2 action, based on staying on the same stage 1 action (stay) and earning a reward in the previous trial (reward). ‘reward:stay’ is the interaction between ‘reward’, and ‘stay’. This table is different from <xref ref-type="supplementary-material" rid="pcbi.1007334.s006">S4 Table</xref> in two aspects: (i) the ‘correct’ predictor was added to the analysis following Akam et al’s [<xref ref-type="bibr" rid="pcbi.1007334.ref017">17</xref>] suggestion, (ii) unlike the analysis performed in <xref ref-type="supplementary-material" rid="pcbi.1007334.s006">S4 Table</xref>, the trials in which subjects did not make the correct discrimination were not excluded from the analysis. Note that the aborted trial, i.e., the trials in which animals entered the magazine between stage 1 and stage 2 actions were excluded. The reason for this second difference is, since rewards are deterministic (within each reversal), if we only include trials in which animals make correct discrimination, then ‘reward-transition’ predictor, and ‘correct’ predictor will be identical. As such, in this analysis that ‘correct’ is a predictor, we included all the trials.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s008" xlink:type="simple">
<label>S6 Table</label>
<caption>
<title>Results of the logistic regression analysis of stage 1, and stage 2 choices in supplementary experiment 1.</title>
<p>For the stage 1 choices, the analysis is focused on staying on the same stage 1 action on the next trial based on whether the previous trial was rewarded (reward) and whether the previous trial was common or rare (transition). ‘reward:transition’ is the interaction between reward, and transition type. For stage 2 choices, the analysis focuses on staying on the same stage 2 action, based on staying on the same stage 1 action (stay), and earning a reward on the previous trial (reward). ‘reward:stay’ is the interaction between ‘reward’, and ‘stay’. ‘<italic>p</italic>’ refers to <italic>p</italic>-value. For the last probe session (s94) since the pattern of choices was not stationary but changing during the session, we presented separately the analysis for the first 16 earned outcomes during the sessions (s94:1; outcomes 1:16), second 16 outcomes earned during the session (s94:2; outcomes 17:32), and third 16 outcomes earned during the session (s94:3; outcomes 33:48).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s009" xlink:type="simple">
<label>S7 Table</label>
<caption>
<title>Total number of trials completed by the subjects in the supplementary experiment 1.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s010" xlink:type="simple">
<label>S8 Table</label>
<caption>
<title>Results of the logistic regression analysis of stage 1 and stage 2 choices in supplementary experiments 2 and 3.</title>
<p>For the stage 1 choices, the analysis is focused on staying on the same stage 1 action on the next trial, based on whether the previous trial was rewarded (reward), and whether the previous trial was common or rare (transition). ‘reward:transition’ is the interaction between reward, and transition type. For stage 2 choices, the analysis is focused on staying on the same stage 2 action, based on staying on the same stage 1 action (stay) and earning a reward in the previous trial (reward). ‘reward:stay’ is the interaction between ‘reward’, and ‘stay’.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s011" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s011" xlink:type="simple">
<label>S9 Table</label>
<caption>
<title>Total number of trials completed by the subjects in the supplementary experiments 2, 3.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s012" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s012" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>The graph shows the intercept term for the analysis shown in <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3a</xref>, which is the log odds ratio of staying on the same stage 1 action.</title>
<p>The <italic>p</italic>-value of this analysis (for the intercept term) was used for colour-coding each bar. The graphs can be interpreted as the tendency of staying on the same stage 1 action, independent of whether reward was earn in the previous trial. The sessions marked with ‘strict sequence’ are similar to the sessions described in <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3a</xref>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s013" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s013" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>The graph shows the average session duration (across subjects).</title>
<p>The animals could earn maximum of 60 outcomes and the session ended as soon as animals earned 60 outcomes. The session length was limited to an hour. The results are for the experiment reported in the main paper. Error-bars represent 1SEM.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s014" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s014" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Log odds ratio of the probability of staying on the same stage 1 action after getting rewarded on the previous trial (for the main experiment).</title>
<p>Each panel shows the data for each subject. Log odds ratio = 0 implies an equal preference for both actions. The odds ratios are calculated using logistic regression and p-values are colour coded.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s015" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s015" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Results of discrimination training (for the experiment reported in the main paper) showing the percentage of correct responses averaged over subjects.</title>
<p>Each point refers to a training session and error-bars are ±1 SEM.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s016" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s016" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Supplementary experiment 1.</title>
<p>In this experiment several probe sessions were inserted in the middle of the training sessions in order illustrate the development of actions over the training period. (a) Log odds ratio of the probability of staying on the same stage 1 action after getting rewarded on the previous trial. Log odds ratio = 0 implies an equal preference for both actions. Sessions marked with ‘*’ are the probe sessions which included both rare and common transitions. (b-f) The probability of staying on the same stage 1 action in the probe sessions, averaged over subjects, as a function of whether the previous trial was rewarded (reward/no reward), and whether the transition in the previous trial was common or rare. The graphs illustrate a gradual shift from a simple state-space representation (panel b) to reward-guided actions (panels c,d), to goal-directed choices (panel e), and finally to a mixture of goal-directed and automatic actions (panel f). (g) Stage 2 actions in session s78. The graph shows the probability of staying on the same stage 2 action, averaged over subjects, as a function of whether the previous trial was rewarded (reward/no reward), and whether subjects stayed on the same stage 1 action (stay/switch). Similar to the analysis of the experiment reported in the main paper, only trials in which the stage 2 state is different from the previous trial are included in panel (g) in order to detect the performance of action sequences. Similarly, only trials in which subjects made a correct discrimination on the previous trial (‘R’ in S2, and ‘L’ in S1) were included in panels (a-g; see text). In all the probe sessions, the probability of rare transitions was 80%, except for the last session (s94) in which the probability of common and rare transitions was equal (i.e., 50%), in order to establish the effect of the transition probabilities on actions. (h) Results of initial discrimination training showing the percentage of correct responses averaged over subjects. Error-bars ±1 SEM.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s017" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s017" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Supplementary experiment 2.</title>
<p>(a) The log odds ratio of staying on the same stage 1 action after earning a reward on the previous trial over the odds after earning no reward. Sessions denoted by ‘all rare’ included only rare transitions (similar to sessions marked with ‘#’ in <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3a</xref>). (b) The probability of staying on the same stage 1 action in the probe session (session s76) as a function of whether the previous trial was rewarded (reward/no reward) and whether the transition in the previous trial was common or rare. (c) The probability of staying on the same stage 2 action in the probe session (session s76), as a function of whether the previous trial was rewarded (reward/no reward) and whether subjects stayed on the same stage 1 action (stay/switch). Similar to the analysis in the main paper, only trials in which the stage 2 state was different from the previous trial are included in panels (c) in order to detect the performance of action sequences. Similarly, only trials in which subjects made a correct discrimination on the previous trial (‘R’ in S2, and ‘L’ in S1) were included in panels (a-c). In all the probe sessions the probability of rare transitions was 50%. (d) Results of discrimination training showing the percentage of correct responses. Error-bars ±1 SEM.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s018" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s018" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Supplementary experiment 3.</title>
<p>(a) The log odds ratio of staying on the same stage 1 action after earning a reward on the previous trial over the odds after earning no reward. Sessions denoted by ‘all rare’ included only rare transitions (similar to sessions marked with ‘#’ in <xref ref-type="fig" rid="pcbi.1007334.g003">Fig 3a</xref>). ‘strict sequences’ indicates that trials with magazine responses after stage 1 actions were aborted. (b) The probability of staying on the same stage 1 action in the probe session (session s74) as a function of whether the previous trial was rewarded (reward/no reward), and whether the transition in the previous trial was common or rare. (c) The probability of staying on the same stage 2 action in the probe session (session s74), as a function of whether the previous trial was rewarded (reward/no reward), and whether subjects stayed on the same stage 1 action (stay/switch). Similar to the analysis presented in the main paper, only trials in which the stage 2 states were different from the previous trial are included in panels (c) in order to detect the performance of action sequences. Similar to the analysis in the main paper, only trials in which subjects made a correct discrimination on the previous trial (‘R’ in S2, and ‘L’ in S1) were included in panels (a-c). In the probe sessions, the probability of rare transitions was 50%. (d) Results of discrimination training showing the percentage of correct responses. Error-bars ±1 SEM.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007334.s019" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007334.s019" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Model simulations depicting the probability of staying on the same stage 2 action (left column) and the same stage 1 action (right column) using the best-fitted parameters for each subject in each model class.</title>
<p>Note that similar to the other figures, in the left column only the trials in which state 2 state is different from the previous trial are included.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1007334.ref001">
<label>1</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Sutton</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Barto</surname> <given-names>AG</given-names></name>. <source>Reinforcement learning: an introduction</source>. <publisher-loc>Cambridge, MA</publisher-loc>: <publisher-name>MIT Press</publisher-name>; <year>1998</year>.</mixed-citation>
</ref>
<ref id="pcbi.1007334.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ito</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Doya</surname> <given-names>K</given-names></name>. <article-title>Multiple representations and algorithms for reinforcement learning in the cortico-basal ganglia circuit</article-title>. <source>Current Opinion in Neurobiology</source>. <year>2011</year>;<volume>21</volume>(<issue>3</issue>):<fpage>368</fpage>–<lpage>373</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.conb.2011.04.001" xlink:type="simple">10.1016/j.conb.2011.04.001</ext-link></comment> <object-id pub-id-type="pmid">21531544</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Blei</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Niv</surname> <given-names>Y</given-names></name>. <article-title>Context, learning, and extinction</article-title>. <source>Psychological review</source>. <year>2010</year>;<volume>117</volume>(<issue>1</issue>):<fpage>197</fpage>–<lpage>209</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1037/a0017808" xlink:type="simple">10.1037/a0017808</ext-link></comment> <object-id pub-id-type="pmid">20063968</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Redish</surname> <given-names>aD</given-names></name>, <name name-style="western"><surname>Jensen</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kurth-Nelson</surname> <given-names>Z</given-names></name>. <article-title>Reconciling reinforcement learning models with behavioral extinction and renewal: implications for addiction, relapse, and problem gambling</article-title>. <source>Psychological review</source>. <year>2007</year>;<volume>114</volume>(<issue>3</issue>):<fpage>784</fpage>–<lpage>805</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1037/0033-295X.114.3.784" xlink:type="simple">10.1037/0033-295X.114.3.784</ext-link></comment> <object-id pub-id-type="pmid">17638506</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Botvinick</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Niv</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Barto</surname> <given-names>AG</given-names></name>. <article-title>Hierarchically organized behavior and its neural foundations: a reinforcement learning perspective</article-title>. <source>Cognition</source>. <year>2009</year>;<volume>113</volume>(<issue>3</issue>):<fpage>262</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cognition.2008.08.011" xlink:type="simple">10.1016/j.cognition.2008.08.011</ext-link></comment> <object-id pub-id-type="pmid">18926527</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dezfouli</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Balleine</surname> <given-names>BW</given-names></name>. <article-title>Habits, action sequences and reinforcement learning</article-title>. <source>European Journal of Neuroscience</source>. <year>2012</year>;<volume>35</volume>(<issue>7</issue>):<fpage>1036</fpage>–<lpage>1051</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1460-9568.2012.08050.x" xlink:type="simple">10.1111/j.1460-9568.2012.08050.x</ext-link></comment> <object-id pub-id-type="pmid">22487034</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Smith</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Graybiel</surname> <given-names>AM</given-names></name>. <article-title>Investigating habits: strategies, technologies and models</article-title>. <source>Frontiers in Behavioral Neuroscience</source>. <year>2014</year>;<volume>8</volume>:<fpage>1</fpage>–<lpage>17</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fnbeh.2014.00039" xlink:type="simple">10.3389/fnbeh.2014.00039</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref008">
<label>8</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Lashley</surname> <given-names>KS</given-names></name>. <chapter-title>The problem of serial order in behavior</chapter-title>. In: <name name-style="western"><surname>Jeffress</surname> <given-names>LA</given-names></name>, editor. <source>Cerebral Mechanisms in Behavior</source>. Cerebral mechanisms in behavior. <publisher-loc>New York</publisher-loc>: <publisher-name>Wiley</publisher-name>; <year>1951</year>. p. <fpage>112</fpage>–<lpage>136</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007334.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Seymour</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <article-title>Model-based influences on humans’ choices and striatal prediction errors</article-title>. <source>Neuron</source>. <year>2011</year>;<volume>69</volume>(<issue>6</issue>):<fpage>1204</fpage>–<lpage>15</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2011.02.027" xlink:type="simple">10.1016/j.neuron.2011.02.027</ext-link></comment> <object-id pub-id-type="pmid">21435563</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dezfouli</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Balleine</surname> <given-names>BW</given-names></name>. <article-title>Actions, Action Sequences and Habits: Evidence that Goal-Directed and Habitual Action Control are Hierarchically Organized</article-title>. <source>PLoS Computational Biology</source>. <year>2013</year>;<volume>9</volume>(<issue>12</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003364" xlink:type="simple">10.1371/journal.pcbi.1003364</ext-link></comment> <object-id pub-id-type="pmid">24339762</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Miller</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Botvinick</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Brody</surname> <given-names>CD</given-names></name>. <article-title>Dorsal hippocampus contributes to model-based planning</article-title>. <source>Nature neuroscience</source>. <year>2017</year>;<volume>20</volume>(<issue>9</issue>):<fpage>1269</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.4613" xlink:type="simple">10.1038/nn.4613</ext-link></comment> <object-id pub-id-type="pmid">28758995</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref012">
<label>12</label>
<mixed-citation publication-type="other" xlink:type="simple">Akam T, Rodrigues-Vaz I, Zhang X, Pereira M, Oliveira R, Dayan P, et al. Single-Trial Inhibition of Anterior Cingulate Disrupts Model-based Reinforcement Learning in a Two-step Decision Task. bioRxiv. 2017.</mixed-citation>
</ref>
<ref id="pcbi.1007334.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ostlund</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Winterbauer</surname> <given-names>NE</given-names></name>, <name name-style="western"><surname>Balleine</surname> <given-names>BW</given-names></name>. <article-title>Evidence of action sequence chunking in goal-directed instrumental conditioning and its dependence on the dorsomedial prefrontal cortex</article-title>. <source>Journal of Neuroscience</source>. <year>2009</year>;<volume>29</volume>(<issue>25</issue>):<fpage>8280</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.1176-09.2009" xlink:type="simple">10.1523/JNEUROSCI.1176-09.2009</ext-link></comment> <object-id pub-id-type="pmid">19553467</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yin</surname> <given-names>HH</given-names></name>, <name name-style="western"><surname>Ostlund</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Knowlton</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Balleine</surname> <given-names>BW</given-names></name>. <article-title>The role of the dorsomedial striatum in instrumental conditioning</article-title>. <source>The European journal of neuroscience</source>. <year>2005</year>;<volume>22</volume>(<issue>2</issue>):<fpage>513</fpage>–<lpage>23</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1460-9568.2005.04218.x" xlink:type="simple">10.1111/j.1460-9568.2005.04218.x</ext-link></comment> <object-id pub-id-type="pmid">16045504</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Botvinick</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Weinstein</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Solway</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Barto</surname> <given-names>AG</given-names></name>. <article-title>Reinforcement learning, efficient coding, and the statistics of natural tasks</article-title>. <source>Current Opinion in Behavioral Sciences</source>. <year>2015</year>;<volume>5</volume>:<fpage>71</fpage>–<lpage>77</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cobeha.2015.08.009" xlink:type="simple">10.1016/j.cobeha.2015.08.009</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Keele</surname> <given-names>SW</given-names></name>. <article-title>Movement control in skilled motor performance</article-title>. <source>Psychological Bulletin</source>. <year>1968</year>;<volume>70</volume>(<issue>6, Pt.1</issue>):<fpage>387</fpage>–<lpage>403</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1037/h0026739" xlink:type="simple">10.1037/h0026739</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Akam</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Costa</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>. <article-title>Simple Plans or Sophisticated Habits? State, Transition and Learning Interactions in the Two-Step Task</article-title>. <source>PLoS Computational Biology</source>. <year>2015</year>;<volume>11</volume>(<issue>12</issue>):<fpage>1</fpage>–<lpage>25</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004648" xlink:type="simple">10.1371/journal.pcbi.1004648</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Smittenaar</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>FitzGerald</surname> <given-names>THB</given-names></name>, <name name-style="western"><surname>Romei</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <article-title>Disruption of dorsolateral prefrontal cortex decreases model-based in favor of model-free control in humans</article-title>. <source>Neuron</source>. <year>2013</year>;<volume>80</volume>(<issue>4</issue>):<fpage>914</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2013.08.009" xlink:type="simple">10.1016/j.neuron.2013.08.009</ext-link></comment> <object-id pub-id-type="pmid">24206669</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref019">
<label>19</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Jeffreys</surname> <given-names>H</given-names></name>. <source>Theory of Probability</source>. <publisher-name>Oxford</publisher-name>; <year>1961</year>.</mixed-citation>
</ref>
<ref id="pcbi.1007334.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Christie</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Dalrymple-Alford</surname> <given-names>JC</given-names></name>. <article-title>A new rat model of the human serial reaction time task: contrasting effects of caudate and hippocampal lesions</article-title>. <source>Journal of Neuroscience</source>. <year>2004</year>;<volume>24</volume>(<issue>5</issue>):<fpage>1034</fpage>–<lpage>1039</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.3340-03.2004" xlink:type="simple">10.1523/JNEUROSCI.3340-03.2004</ext-link></comment> <object-id pub-id-type="pmid">14762121</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Halbout</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Marshall</surname> <given-names>AT</given-names></name>, <name name-style="western"><surname>Azimi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Liljeholm</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mahler</surname> <given-names>SV</given-names></name>, <name name-style="western"><surname>Wassum</surname> <given-names>KM</given-names></name>, <etal>et al</etal>. <article-title>Mesolimbic dopamine projections mediate cue-motivated reward seeking but not reward retrieval in rats</article-title>. <source>eLife</source>. <year>2019</year>;<volume>8</volume>:<fpage>e43551</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.43551" xlink:type="simple">10.7554/eLife.43551</ext-link></comment> <object-id pub-id-type="pmid">31107241</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Balleine</surname> <given-names>BW</given-names></name>. <article-title>Neural bases of food-seeking: affect, arousal and reward in corticostriatolimbic circuits</article-title>. <source>Physiology &amp; behavior</source>. <year>2005</year>;<volume>86</volume>(<issue>5</issue>):<fpage>717</fpage>–<lpage>730</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.physbeh.2005.08.061" xlink:type="simple">10.1016/j.physbeh.2005.08.061</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dezfouli</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Griffiths</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ramos</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Balleine</surname> <given-names>BW</given-names></name>. <article-title>Models that learn how humans learn: the case of decision-making and its disorders</article-title>. <source>PLoS Computational Biology</source>. <year>2019</year> <month>Jun</month> <day>11</day>;<volume>15</volume>(<issue>6</issue>):<fpage>e1006903</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007334.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Groman</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Massi</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Mathias</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Curry</surname> <given-names>DW</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Taylor</surname> <given-names>JR</given-names></name>. <article-title>Neurochemical and Behavioral Dissections of Decision-Making in a Rodent Multistage Task</article-title>. <source>Journal of Neuroscience</source>. <year>2019</year>;<volume>39</volume>(<issue>2</issue>):<fpage>295</fpage>–<lpage>306</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.2219-18.2018" xlink:type="simple">10.1523/JNEUROSCI.2219-18.2018</ext-link></comment> <object-id pub-id-type="pmid">30413646</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hasz</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Redish</surname> <given-names>AD</given-names></name>. <article-title>Deliberation and Procedural Automation on a Two-Step Task for Rats</article-title>. <source>Frontiers in Integrative Neuroscience</source>. <year>2018</year>;<volume>12</volume>:<fpage>30</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fnint.2018.00030" xlink:type="simple">10.3389/fnint.2018.00030</ext-link></comment> <object-id pub-id-type="pmid">30123115</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Birrell</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>VJ</given-names></name>. <article-title>Medial frontal cortex mediates perceptual attentional set shifting in the rat</article-title>. <source>Journal of Neuroscience</source>. <year>2000</year>;<volume>20</volume>(<issue>11</issue>):<fpage>4320</fpage>–<lpage>4324</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.20-11-04320.2000" xlink:type="simple">10.1523/JNEUROSCI.20-11-04320.2000</ext-link></comment> <object-id pub-id-type="pmid">10818167</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Farashahi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rowe</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Aslami</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Soltani</surname> <given-names>A</given-names></name>. <article-title>Feature-based learning improves adaptability without compromising precision</article-title>. <source>Nature communications</source>. <year>2017</year>;<volume>8</volume>(<issue>1</issue>):<fpage>1768</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41467-017-01874-w" xlink:type="simple">10.1038/s41467-017-01874-w</ext-link></comment> <object-id pub-id-type="pmid">29170381</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref028">
<label>28</label>
<mixed-citation publication-type="other" xlink:type="simple">Morris A, Cushman F. Model-free RL or action sequences? 2019.</mixed-citation>
</ref>
<ref id="pcbi.1007334.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bischoff-Grethe</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Goedert</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Willingham</surname> <given-names>DT</given-names></name>, <name name-style="western"><surname>Grafton</surname> <given-names>ST</given-names></name>. <article-title>Neural substrates of response-based sequence learning using fMRI</article-title>. <source>Journal of cognitive neuroscience</source>. <year>2004</year>;<volume>16</volume>(<issue>1</issue>):<fpage>127</fpage>–<lpage>138</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/089892904322755610" xlink:type="simple">10.1162/089892904322755610</ext-link></comment> <object-id pub-id-type="pmid">15006042</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lee</surname> <given-names>SW</given-names></name>, <name name-style="western"><surname>Shimojo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>O’Doherty</surname> <given-names>JP</given-names></name>. <article-title>Neural computations underlying arbitration between model-based and model-free learning</article-title>. <source>Neuron</source>. <year>2014</year>;<volume>81</volume>(<issue>3</issue>):<fpage>687</fpage>–<lpage>99</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2013.11.028" xlink:type="simple">10.1016/j.neuron.2013.11.028</ext-link></comment> <object-id pub-id-type="pmid">24507199</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Doherty</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>SW</given-names></name>, <name name-style="western"><surname>McNamee</surname> <given-names>D</given-names></name>. <article-title>The structure of reinforcement-learning mechanisms in the human brain</article-title>. <source>Current Opinion in Behavioral Sciences</source>. <year>2015</year>;<volume>1</volume>:<fpage>94</fpage>–<lpage>100</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cobeha.2014.10.004" xlink:type="simple">10.1016/j.cobeha.2014.10.004</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Balleine</surname> <given-names>BW</given-names></name>, <name name-style="western"><surname>Dezfouli</surname> <given-names>A</given-names></name>. <article-title>Hierarchical action control: Adaptive collaboration between actions and habits</article-title>. <source>Frontiers in Psychology</source>. <year>2019</year>.</mixed-citation>
</ref>
<ref id="pcbi.1007334.ref033">
<label>33</label>
<mixed-citation publication-type="other" xlink:type="simple">R Core Team. R: A Language and Environment for Statistical Computing; 2016. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/" xlink:type="simple">https://www.r-project.org/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1007334.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bates</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Mächler</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bolker</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Walker</surname> <given-names>S</given-names></name>. <article-title>Fitting Linear Mixed-Effects Models Using lme4</article-title>. <source>Journal of Statistical Software</source>. <year>2015</year>;<volume>67</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>48</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18637/jss.v067.i01" xlink:type="simple">10.18637/jss.v067.i01</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007334.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Piray</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Zeighami</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bahrami</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Eissa</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Hewedi</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Moustafa</surname> <given-names>AA</given-names></name>. <article-title>Impulse control disorders in Parkinson’s disease are associated with dysfunction in stimulus valuation but not action valuation</article-title>. <source>The Journal of neuroscience</source>. <year>2014</year>;<volume>34</volume>(<issue>23</issue>):<fpage>7814</fpage>–<lpage>24</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.4063-13.2014" xlink:type="simple">10.1523/JNEUROSCI.4063-13.2014</ext-link></comment> <object-id pub-id-type="pmid">24899705</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>