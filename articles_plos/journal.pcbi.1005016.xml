<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005016</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-01606</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Blood cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>Macrophages</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>Macrophages</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>Macrophages</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>Macrophages</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical data</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Statistical distributions</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Signal processing</subject><subj-group><subject>White noise</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune response</subject><subj-group><subject>Inflammation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune response</subject><subj-group><subject>Inflammation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Diagnostic medicine</subject><subj-group><subject>Signs and symptoms</subject><subj-group><subject>Inflammation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pathology and laboratory medicine</subject><subj-group><subject>Signs and symptoms</subject><subj-group><subject>Inflammation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Gene pool</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Gene pool</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Gene pool</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Robust Inference of Cell-to-Cell Expression Variations from Single- and K-Cell Profiling</article-title>
<alt-title alt-title-type="running-head">Quantify Biological Variation from Single-/K-Cells</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Narayanan</surname>
<given-names>Manikandan</given-names>
</name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Martins</surname>
<given-names>Andrew J.</given-names>
</name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Tsang</surname>
<given-names>John S.</given-names>
</name>
<xref ref-type="corresp" rid="cor001">*</xref>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001"><addr-line>Systems Genomics and Bioinformatics Unit, Laboratory of Systems Biology, National Institute of Allergy and Infectious Diseases, National Institutes of Health, Bethesda, Maryland, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Gottardo</surname>
<given-names>Raphael</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Fred Hutchinson Cancer Research Center, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Formulated the study and overall approach informed by single and k-cell experiments performed by AJM in a related study: MN JST. Designed and implemented computational approaches and analyses: MN. Provided input on computational approaches and analyses: JST. Designed single- and 10-cell macrophage experiments: AJM MN JST. Performed single- and 10-cell macrophage experiments: AJM. Interpreted results: MN AJM JST. Wrote the manuscript: MN AJM JST. Supervised the study: JST.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">john.tsang@nih.gov</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>20</day>
<month>7</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="collection">
<month>7</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>7</issue>
<elocation-id>e1005016</elocation-id>
<history>
<date date-type="received">
<day>23</day>
<month>9</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>7</day>
<month>6</month>
<year>2016</year>
</date>
</history>
<permissions>
<license xlink:href="https://creativecommons.org/publicdomain/zero/1.0/" xlink:type="simple">
<license-p>This is an open access article, free of all copyright, and may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose. The work is made available under the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/" xlink:type="simple">Creative Commons CC0</ext-link> public domain dedication.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005016"/>
<abstract>
<p>Quantifying heterogeneity in gene expression among single cells can reveal information inaccessible to cell-population averaged measurements. However, the expression level of many genes in single cells fall below the detection limit of even the most sensitive technologies currently available. One proposed approach to overcome this challenge is to measure random pools of k cells (e.g., 10) to increase sensitivity, followed by computational “deconvolution” of cellular heterogeneity parameters (CHPs), such as the biological variance of single-cell expression levels. Existing approaches infer CHPs using either single-cell or k-cell data alone, and typically within a single population of cells. However, integrating both single- and k-cell data may reap additional benefits, and quantifying differences in CHPs across cell populations or conditions could reveal novel biological information. Here we present a Bayesian approach that can utilize single-cell, k-cell, or both simultaneously to infer CHPs within a single condition or their differences across two conditions. Using simulated as well as experimentally generated single- and k-cell data, we found situations where each data type would offer advantages, but using both together can improve precision and better reconcile CHP information contained in single- and k-cell data. We illustrate the utility of our approach by applying it to jointly generated single- and k-cell data to reveal CHP differences in several key inflammatory genes between resting and inflammatory cytokine-activated human macrophages, delineating differences in the distribution of ‘ON’ versus ‘OFF’ cells and in continuous variation of expression level among cells. Our approach thus offers a practical and robust framework to assess and compare cellular heterogeneity within and across biological conditions using modern multiplexed technologies.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Different cells can make different amounts of biomolecules such as RNA transcripts of genes. New technologies are emerging to measure the transcript level of many genes in single cells. However, accurate quantification of the biological variation from cell to cell can be challenging due to the low transcript level of many genes and the presence of substantial measurement noise. Here we present a flexible, novel computational approach to quantify biological cell-to-cell variation that can use different types of data, namely measurements directly obtained from single cells, and/or those from random pools of k-cells (e.g., k = 10). Assessment of these different inputs using simulated and real data revealed that each data type can offer advantages under different scenarios, but combining both single- and k-cell measurements tend to offer the best of both. Application of our approach to single- and k-cell data obtained from resting and inflammatory macrophages, an important type of immune cells implicated in diverse diseases, revealed interesting changes in cell-to-cell variation in transcript levels upon inflammatory stimulation, thus suggesting that inflammation can shape not only the average expression level of a gene but also the gene’s degree of expression variation among single cells.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100006492</institution-id>
<institution>Division of Intramural Research, National Institute of Allergy and Infectious Diseases</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Tsang</surname>
<given-names>John S</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This work is supported by the Intramural Research Program of NIAID, NIH. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="0"/>
<page-count count="33"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant expression data are available in NCBI GEO under the accession number GSE83451. All relevant software and documentation are available at <ext-link ext-link-type="uri" xlink:href="https://trackhub.niaid.nih.gov/upload/qvarks" xlink:type="simple">https://trackhub.niaid.nih.gov/upload/qvarks</ext-link>, including the R package QVARKS for heterogeneity inference (comprising a tutorial vignette, detailed documentation, all relevant code and pre-processed data) and simulation-related code snippets.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Transcriptomic profiling is widely used in biomedical research, but until recently it often relies on measuring mRNAs pooled from thousands to millions of cells, thus obscuring the well-appreciated biological variation that exists among individual cells of the profiled population. Quantifying variation in gene expression across single cells could help address fundamental biological questions and empower new applications previously not possible using cell-population based measurements. Such new applications include <italic>de novo</italic> assessment of tissue composition without <italic>a priori</italic> knowledge on cell-type defining markers [<xref ref-type="bibr" rid="pcbi.1005016.ref001">1</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref002">2</xref>] and inferring biologically relevant changes in cell-to-cell variations. Despite rapid technological advances, accurate measurement of single-cell expression is a major challenge, particularly because many mRNAs are expressed at levels close to or below the detection limit of current profiling technologies [<xref ref-type="bibr" rid="pcbi.1005016.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref004">4</xref>]. For example, the estimated rate of capturing individual mRNA molecules ranges from ~10% to ~20% using state-of-the-art single-cell RNA-Seq protocols [<xref ref-type="bibr" rid="pcbi.1005016.ref004">4</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref005">5</xref>]. Indeed, typical single-cell gene-expression data obtained by quantitative PCR (qPCR) or RNA-Seq contain a substantial number of zero or non-detected measurements (“non-detects”), which cannot be entirely attributable to cells expressing zero transcripts. For example, some non-detects may arise from technical factors such as measurement noise, and missed capture or amplification of mRNA transcripts at or near the detection limit, as revealed by recent studies using measurements of spike-in standards and statistical inference methods [<xref ref-type="bibr" rid="pcbi.1005016.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1005016.ref012">12</xref>].</p>
<p>An alternative approach to direct single-cell profiling, called “stochastic profiling” [<xref ref-type="bibr" rid="pcbi.1005016.ref013">13</xref>], has been proposed to mitigate detection issues: measure the expression of random pools of a small number of cells (k) (e.g., k = 10), followed by computationally deconvolving these pooled-cell measurements to infer the underlying cell-to-cell variation parameters. This approach offers more robust detection due to the increased amount of input mRNA and has been used to, for example, assess whether expression distributions across cells are bimodal [<xref ref-type="bibr" rid="pcbi.1005016.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1005016.ref015">15</xref>]. Each approach can offer advantages, e.g., single-cell for its direct interpretability and k-cell for improved sensitivity and therefore better quantitative estimates of certain cell-to-cell variation parameters. In principle they can also be complementary, and when both data types are obtained from a cell population, utilizing them together could potentially provide richer information for assessing cellular heterogeneity than using either one alone; however, in practice, no approach has been developed to take advantage of both data types simultaneously.</p>
<p>To utilize both data types jointly and also allow the flexibility of using either one alone, here we present a Bayesian approach (called <bold>QVARKS</bold>) that <bold>q</bold>uantifies the degree and the statistical uncertainty of expression <bold>var</bold>iation across cells by using <bold>k-</bold> and/or <bold>s</bold>ingle-cell data, after accounting for technical detection limits. A key contribution of our approach includes a newly developed statistical model and associated Bayesian inference and model assessment procedures that can handle single-cell, k-cell, or both data types jointly to infer cellular heterogeneity parameters (CHPs), including the fraction of cells in the population expressing the gene (“ON” cells) or variation in expression level among “ON” cells. Both types of cellular heterogeneity can reflect meaningful biology, for example, the former, or “discrete” heterogeneity, may capture the frequency of functionally distinct cell subsets as classically defined by marker gene expression, while the latter, or “continuous” heterogeneity may capture the spread of the expression phenotype that could ultimately influence the overall population-level response to a perturbation [<xref ref-type="bibr" rid="pcbi.1005016.ref016">16</xref>].</p>
<p>Another feature of QVARKS is that it can model data jointly from two distinct cell populations to quantitatively assess differences in CHPs (or “differential heterogeneity”, DH) between the two conditions. While assessing differences in mean expression between two conditions is widely applied, the biology of differences in cell-to-cell expression variations (CEV) has been underexplored. Given that CEV can play functional roles and can be under genetic regulation [<xref ref-type="bibr" rid="pcbi.1005016.ref017">17</xref>], QVARKS can be used to help reveal gene expression heterogeneity among cell populations, such as those exposed to different environments or from distinct developmental lineages. QVARKS thus complements existing single-cell data analysis approaches that either focus on identifying differential expressed (DE) genes [<xref ref-type="bibr" rid="pcbi.1005016.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref011">11</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref018">18</xref>], or aim to find genes with high overall variability but do not deconvolve the overall variability into discrete vs. continuous components [<xref ref-type="bibr" rid="pcbi.1005016.ref006">6</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref012">12</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref019">19</xref>].</p>
<p>We systematically assessed the performance of QVARKS using both simulations and joint single- and k-cell data obtained from two biological conditions. We took advantage of QVARKS’ flexibility to handle different input data types to study the relative performance of using single-cell, k-cell or both data types to infer CHPs in a single condition or compare them between two conditions. We found scenarios where different input data types (single-cell, k-cell, or both) offer advantages. However, integrating both single- and k-cell data often offers the advantages of both. We also evaluated whether single-cell data would lead to inferred parameters consistent with k-cell data and vice versa, and found many situations where single- or k-cell analysis on its own led to significantly different results. Thus, this argues for proper integration of the two data types for robust parameter estimation and cross-checking them for consistencies when possible.</p>
<p>We illustrate the practical biological utility of our approach by applying it to compare CEV in resting versus inflammatory-activated human macrophages, an important immune cell type known to function in diverse tissues and biological processes, including chronic inflammation associated with numerous common human diseases and aging [<xref ref-type="bibr" rid="pcbi.1005016.ref020">20</xref>]. QVARKS revealed significant differences in the CEV of key genes (e.g., <italic>RELA</italic>, a component of NFκB) upon inflammatory activation, potentially reflecting condition-dependent regulation of cellular heterogeneity. QVARKS is provided as an R package with detailed documentation (see Data Availability for download URL), and thus offers a practical, robust approach to quantitatively assess and compare CEV within and among biological states or conditions.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>QVARKS method overview: Inferring cell-to-cell expression heterogeneity via integrative modeling of single- and/or k-cell measurements</title>
<p>We focus on assessing two aspects of CEV for a given gene. First, “discrete” heterogeneity, arises due to the presence of cells with zero (OFF cells) vs. non-zero expression (ON cells) of the gene. Biologically, this type of CEV can originate from differences in the transcriptional status or activity at the gene locus among single cells, e.g., some cells have actively transcribing promoters while others have inactive promoters. Second, “continuous” patterns of CEV among ON cells reflecting, for example, that some cells have higher levels of upstream transcriptional regulators than other cells; inherent stochasticity in biochemical reactions, such as transcript and protein production, can also contribute substantially to continuous variability among single cells [<xref ref-type="bibr" rid="pcbi.1005016.ref017">17</xref>]. QVARKS mathematically models these two CEV patterns for each gene and the Bayesian procedure described below infers the value of these parameters using single-cell (SC) data alone, k-cell (KC) data alone, or both (SCKC). The overall framework is depicted in <xref ref-type="fig" rid="pcbi.1005016.g001">Fig 1</xref>. The output of QVARKS includes an estimate of the CEV parameters (or their differences between conditions when run in two-condition mode) and the statistical uncertainty around each of the parameters (all computed from the posterior distribution inferred by the Bayesian procedure; see description below and in <xref ref-type="sec" rid="sec011">Methods</xref>).</p>
<fig id="pcbi.1005016.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005016.g001</object-id>
<label>Fig 1</label>
<caption>
<title>The QVARKS methodology and its three input data modes (SC, KC and SCKC methods).</title>
<p><bold>(A)</bold> Schematic of our experimental and computational strategy (right box) for quantifying cell-to-cell variation in gene expression (left box) by integrating k- and/or single-cell expression profiles is shown (see text for additional details). Our approach can utilize single-cell data alone, or k-cell data alone, or both together as input to infer cellular heterogeneity parameters (CHPs). MCMC stands for Markov Chain Monte Carlo, and our gene expression data is measured in Et = 40-Ct units for qPCR (both in this figure and rest of the paper; please note that Et approximates <italic>log</italic><sub>2</sub>(transcript counts) as explained in Methods). <bold>(B)</bold> Schematic of our AD-test based model assessment criteria (see text and <xref ref-type="sec" rid="sec011">Methods</xref> for details).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.g001" xlink:type="simple"/>
</fig>
<sec id="sec004">
<title>Model parameters and assumptions</title>
<p>For each gene we model the distribution of expression level in single cells with two modes: a fraction <italic>π</italic> of cells have at least one transcript and hence are “ON”; the rest of the cells have zero transcripts of this gene and hence are “OFF”. Within ON cells, the level of expression (after logarithmic transformation) is normally distributed with mean <italic>μ</italic> and variance <italic>σ</italic><sup>2</sup> (i.e., log-normally distributed) (<xref ref-type="fig" rid="pcbi.1005016.g001">Fig 1A</xref>). To model imperfect transcript detection, such as when the input mRNA amount falls below the detection limit of the assay, we explicitly model the probability of detection (ranging from 0 to 100%) with a mathematical function (logistic function) that assumes higher values as the number of input transcripts increase (see <xref ref-type="fig" rid="pcbi.1005016.g001">Fig 1A</xref> and <xref ref-type="sec" rid="sec011">Methods</xref>). To model two distinct cell populations or conditions, each population has its own set of CHPs (<italic>π</italic>, <italic>μ</italic> and <italic>σ</italic>) and we assume the same transcript detection assay is used to profile both conditions. Observed k-cell expression is modeled as a random sampling of k single cells followed by noisy detection as described above (see also <xref ref-type="sec" rid="sec011">Methods</xref>). Our choice of statistical distributions used to model single cells is motivated and supported by earlier single-cell modeling studies suggesting log-normal distributions of transcript counts [<xref ref-type="bibr" rid="pcbi.1005016.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref021">21</xref>] and logistic detection behavior of qPCR or RNA-Seq assays [<xref ref-type="bibr" rid="pcbi.1005016.ref008">8</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref011">11</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref022">22</xref>], as well as our own data (see bulk DE and model assessments below). However, our overall approach is general and can be extended to alternative choices of single- and k-cell distributions, such as the negative binomial [<xref ref-type="bibr" rid="pcbi.1005016.ref011">11</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref012">12</xref>] and other models of detection limits.</p>
</sec>
<sec id="sec005">
<title>Bayesian inference of model parameters</title>
<p>A Bayesian inference procedure (based on a random walk Metropolis Markov Chain Monte Carlo (MCMC) approach) was developed to infer model parameters from SC, KC, or SCKC input modes (<xref ref-type="fig" rid="pcbi.1005016.g001">Fig 1A</xref>). A Bayesian approach was taken to allow the inference of posterior distributions that naturally capture the statistical uncertainty of inferred parameters, so that CHPs within a single cell population or their differences among cell populations can be robustly assessed. For ease of presentation, we summarize each parameter’s posterior distribution by its mean along with a 90% credible interval (CrI) that quantifies the uncertainty or spread around the mean (see <xref ref-type="fig" rid="pcbi.1005016.g001">Fig 1A</xref> and <xref ref-type="sec" rid="sec011">Methods</xref>). To assess whether our inferred models capture the data well and thereby also check if the data satisfies our model assumptions and parameterizations, including statistical distribution choices, we verified the agreement between the distribution of observed, real data and of simulated data generated from inferred models, each of which was specified by parameters independently drawn from the posterior distribution [<xref ref-type="bibr" rid="pcbi.1005016.ref023">23</xref>] (<xref ref-type="fig" rid="pcbi.1005016.g001">Fig 1B</xref>). The specific criterion we used required more than 75% of the models drawn to be capable of generating data samples statistically indistinguishable from the observed single- and/or k-cell data used to infer the parameters (i.e., AD-test P ≥ 0.1 as shown in <xref ref-type="fig" rid="pcbi.1005016.g001">Fig 1B</xref> and Methods), but other model assessment approaches, including a single AD-test approach and posterior predictive checks [<xref ref-type="bibr" rid="pcbi.1005016.ref023">23</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref024">24</xref>] are supported by QVARKS as options (see <xref ref-type="sec" rid="sec010">Discussion</xref>). We hereafter refer to inferred models passing model assessment criteria in <italic>all</italic> studied conditions as “successfully modeled” genes, and those passing in a given condition as successfully modeled “gene-condition models” or “gene-condition combinations” (GCCs).</p>
<p>Thus, QVARKS provides a unique, flexible approach to handle three input data modes from the ground up (SC, KC and SCKC), as well as a novel comparative framework to assess changes in heterogeneity parameters, such as <italic>π</italic> and <italic>σ</italic>, between two conditions.</p>
<p>In addition to its ability to integrate single- and k-cell data, QVARKS was designed to provide functionalities that are distinct from and thus complementary to existing single-cell data analysis methods. Approaches such as MAST and SCDE aim to model single cell data to identify differentially expressed (DE) genes among conditions [<xref ref-type="bibr" rid="pcbi.1005016.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref011">11</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref018">18</xref>]. The inferred CHPs from QVARKS can also be used to infer DE genes (see below), but the primary goal of QVARKS is to assess CHPs within a single condition or between two conditions. QVARKS also deviates from this class of methods by explicitly modeling: 1) detection drop-offs for each gene to deconvolve the observed fraction of OFF cells (no transcript detected) into those that are truly OFF (transcriptionally silent) vs. technically induced drop-offs, and 2) variation among ON cells to assess continuous patterns of CEV. This type of decomposition is also not yet the focus of other methods such as BASICS that do focus on quantitatively assessing cell-to-cell variability [<xref ref-type="bibr" rid="pcbi.1005016.ref006">6</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref012">12</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref019">19</xref>]. BASICS, for example, identifies genes with high overall variability unlikely explainable by those originating from technical sources by using a large number of spike-in controls that span the dynamic range of expression to disentangle biological CEV from technical noise. Since QVARKS does not rely on spike-ins, it is applicable to platforms that can only profile a smaller number of genes (e.g., microfluidic based qPCR or targeted RNA-seq).</p>
</sec>
</sec>
<sec id="sec006">
<title>Using simulation to compare the performance of SC, KC and SCKC input data modes</title>
<p>We first sought to assess the relative performance of the three input data modes of QVARKS (SC, KC and SCKC) in inferring CHPs (<italic>π</italic>, <italic>μ</italic> and <italic>σ</italic>) across a range of scenarios involving either a single condition/cell population, or two conditions/cell populations aimed at comparing the inferred CHPs between the two conditions. Here, the unique capability of QVARKS for handling all three input data types served as a common inference procedure to help evaluate their relative performance.</p>
<p>We simulated single- and k-cell data (using k = 10 and 50) subjected to measurement by an assay that would suffer from increasingly missed detection as the input mRNA level is lowered and additional measurement noise under a range of scenarios, and used the resulting single-cell data (SC), k-cell data (KC), or both (SCKC) to infer the value and statistical uncertainty of the CHPs (using a posterior surface scanning procedure; see <xref ref-type="sec" rid="sec011">Methods</xref>). The number of samples was fixed at <italic>n</italic> = 1000 across all three approaches–i.e., <italic>n</italic> single-cell, <italic>n</italic> k-cell, or <italic>n</italic>/2 single-cell and <italic>n</italic>/2 k-cell samples were used. Data were simulated under scenarios reflecting low, medium and high levels of difficulty, corresponding to, respectively, high <italic>π</italic> and low <italic>σ</italic> (i.e., high ON fraction and low cell-to-cell variation among ON cells), medium <italic>π</italic> and <italic>σ</italic>, and low <italic>π</italic> and high <italic>σ</italic> (i.e., low ON fraction and high cell-to-cell variation among ON cells) (see <xref ref-type="supplementary-material" rid="pcbi.1005016.s001">S1 Fig</xref> and <xref ref-type="sec" rid="sec011">Methods</xref>), as well as assays with varying detection efficiencies (bad, medium and good sensitivity assays corresponding to, respectively, 18%, 50% and 82% average detection of single-cell samples and nearly perfect detection of all k-cell samples; see <xref ref-type="sec" rid="sec011">Methods</xref>). The simulated data was further subjected to known, realistic sources of experimental noise including sampling, amplification and efficiency noise [<xref ref-type="bibr" rid="pcbi.1005016.ref012">12</xref>] using five distinct noise configurations (see <xref ref-type="supplementary-material" rid="pcbi.1005016.s001">S1 Fig</xref> and <xref ref-type="sec" rid="sec011">Methods</xref>). Assessing such diverse scenarios is important and informative since a wide range of possibilities is expected across the tens to thousands of genes targeted by multiplexed techniques such as microfluidic qPCR and RNA-Seq. Performance across the input data types was evaluated via the error (differences between inferred and true values) and statistical uncertainty of the parameter estimates (<xref ref-type="fig" rid="pcbi.1005016.g002">Fig 2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005016.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005016.s003">S3</xref> Figs).</p>
<fig id="pcbi.1005016.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005016.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Comparison of SC, KC and SCKC methods using single-condition simulations.</title>
<p>Simulation results for single-condition parameter inferences, where each dot corresponds to an inferred parameter for a gene simulated under one condition according to the simulation scenario denoted by the legend. Diverse scenarios of varying levels of inference difficulty, measurement noise and assay sensitivity/detection (see <xref ref-type="sec" rid="sec011">Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005016.s001">S1 Fig</xref>) were used to generate simulated data. Parameter inferences (posterior mode and 90% CrI based on a grid-based posterior scan) were made for ten simulated datasets (sample size n = 1000) and the mean is shown here for each scenario and method. Each plot compares the performance of the two indicated methods as follows: The x-axis indicates the difference in the absolute error of the two methods’ estimates divided (scaled) by the true parameter value (if non-zero)—here absolute error is defined as the magnitude of the estimate minus the true parameter value; the y-axis is the difference in the CrI width of the two methods’ estimates divided (scaled) by the true parameter value (if non-zero). Alongside the legend is the guide to understand the simulation result plots indicating the quadrants where one method outperforms the other. See the legend for simulation result plots in conjunction with <xref ref-type="sec" rid="sec011">Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005016.s002">S2 Fig</xref> to obtain a complete description of the simulation scenario (including measurement noise setting) underlying each dot in the plots. Note that <xref ref-type="supplementary-material" rid="pcbi.1005016.s002">S2 Fig</xref> is an expanded version of the figure shown here containing additional results on KC vs. SC, as well as medium inference difficulty and medium assay sensitivity.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.g002" xlink:type="simple"/>
</fig>
<p>Our single-condition simulations revealed that 1) as expected, SC’s performance on inferring both discrete and continuous heterogeneity (<italic>π</italic> and <italic>σ</italic>) was worst in medium- or high-difficulty scenarios using assays suffering from sensitivity issues (<xref ref-type="fig" rid="pcbi.1005016.g002">Fig 2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005016.s002">S2 Fig</xref>); 2) SCKC was comparable to KC across a range of scenarios, and tended to be better than KC when k is larger using assays of medium to high sensitivity for inferring <italic>π</italic> and <italic>μ</italic>—these were similar to the scenarios under which SC is better than KC when high sensitivity assays are used (see <xref ref-type="fig" rid="pcbi.1005016.g002">Fig 2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005016.s002">S2 Fig</xref>). Note that SCKC’s inferred values for <italic>π</italic> and <italic>μ</italic> (and to a lesser extent, SC’s) tended to center more tightly around the true values than those inferred from KC, because a given k-cell expression distribution for a larger k could be explained by scenarios involving different combinations of <italic>π</italic> and <italic>μ</italic> (e.g., more ON cells because of higher <italic>π</italic> but lower mean expression <italic>μ</italic>, or alternatively, less ON cells but higher <italic>μ</italic>) and these possibilities could be better disentangled by having single-cell data using a sensitive assay; under this scenario in the case of SCKC, the samples allocated for single-cell measurements provide unique information not well-captured by k-cell data. Depending on the expression-level distribution of the target genes and the assay detection properties, a larger k may sometimes be warranted to improve detection and therefore SCKC could be advantageous in such situations as suggested by these simulation results (see <xref ref-type="sec" rid="sec010">Discussion</xref>). Note that these conclusions held largely across the different measurement noise configurations tested except for a few cases as shown in <xref ref-type="supplementary-material" rid="pcbi.1005016.s002">S2 Fig</xref>.</p>
<p>A key aim of QVARKS is to enable a quantitative, comparative assessment of heterogeneity parameters of each gene between two biological conditions. Thus we augmented the single-condition assessments with two-condition simulations. We simulated each gene under two conditions with different ON cell fractions (e.g., 80% ON cells in one condition vs. 50% in the other) and subjected them to the same logistic assay and measurement noise settings as in the single-condition scenarios (see <xref ref-type="sec" rid="sec011">Methods</xref>). While the relative performance trend of the three methods in inferring parameter differences between the two simulated conditions tends to be similar to that when inferring single-condition parameters (<xref ref-type="supplementary-material" rid="pcbi.1005016.s003">S3 Fig</xref>), the performance difference among methods, particularly that between SCKC and KC, was less pronounced in the comparative setting. Again, as above, the measurement noise setting tends to have little effect on the relative performance of different methods except for a few cases as shown in <xref ref-type="supplementary-material" rid="pcbi.1005016.s003">S3 Fig</xref>.</p>
<p>Examining single- and two-condition simulation results together revealed differences in how measurement noise affects inference outcomes. As expected, as more noise is added, all three methods suffered from increased error in their estimates within individual conditions because none of the methods explicitly model experimental noise. However, such noise-induced error appeared largely mitigated when comparing across two conditions (<xref ref-type="supplementary-material" rid="pcbi.1005016.s004">S4 Fig</xref>), likely because such errors tend to cancel out in comparative analyses between two conditions. However, under some comparative scenarios, such as when both the mean expression and cell-to-cell variation are different between the two conditions, estimates of differences could still be error-prone due to the dependence of technical noise on average/mean expression. This error/bias can potentially be handled by explicitly checking the mean-variance relationship to assess whether the observed difference in heterogeneity of a given gene can be accounted for by changes in the average expression alone between two conditions (as illustrated in the biological application below; see also <xref ref-type="supplementary-material" rid="pcbi.1005016.s011">S11 Fig</xref>).</p>
<p>In summary, our simulation results revealed scenarios where different input data types can each offer advantages. We confirm that when assay sensitivity is high, SC can be desirable particularly for providing directly observable estimates of discrete heterogeneity (<italic>π</italic>). As the assay sensitivity lowers and the inference difficulty increases, the advantages of KC become apparent, at the cost of masking biological heterogeneity at larger values of k. Our simulations revealed that SCKC tends to offer the best of both SC and KC under many scenarios, thus suggesting that simultaneous generation and integration of the two data types can be a robust, valuable approach, particularly under multiplexed settings where different genes would fall under different inference difficulty and detection scenarios as simulated above.</p>
</sec>
<sec id="sec007">
<title>Using simultaneously generated single- and k-cell data to compare the precision of SC, KC and SCKC</title>
<p>Since certain features of real data cannot be fully captured by simulated data, we next sought to assess the relative performance of the three input data modes using single- and 10-cell data (i.e., k = 10) we had jointly generated for studying cell-to-cell expression variation of human macrophages in resting conditions (control, CNT) vs. those exposed to inflammatory cytokines for 24 hours (IFNγ together with TNFα, hereafter referred to as IFNT) (see full description of this data below and in <xref ref-type="sec" rid="sec011">Methods</xref>). We performed several analyses to assess relative precision, or conversely statistical uncertainty, using appropriately downsampled data so that the sample sizes were the same across SC, KC and SCKC (see <xref ref-type="sec" rid="sec011">Methods</xref>). Here we can only assess precision rather than error (the difference between the true and the estimated values), due to the lack of ground truth about parameter values in real data.</p>
<p>We first assessed the precision of estimated parameters as quantified by the credible interval (CrI) width reflecting the amount of statistical uncertainty about the true value of the parameter. In particular, we focused on genes with similar inferred values across the three input modes to avoid confounding from potential correlation between precision and error/bias. This analysis revealed that SCKC tends to provide more precise estimates for <italic>π</italic> and <italic>σ</italic> than either SC or KC alone across a larger fraction of genes (<xref ref-type="fig" rid="pcbi.1005016.g003">Fig 3A</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005016.s005">S5 Fig</xref>). By using a t-like fold-change statistic to assess statistical power for detecting changes in heterogeneity (DH) between two conditions, this improved precision of SCKC in comparison to SC or KC also translated to mild increases in sensitivity for detecting DH, especially for the <italic>π</italic> and <italic>μ</italic> parameters (<xref ref-type="fig" rid="pcbi.1005016.g003">Fig 3B</xref>).</p>
<fig id="pcbi.1005016.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005016.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Comparison of SC, KC and SCKC methods using real data.</title>
<p>Experimentally generated single- and ten-cell data obtained from resting (CNT) and inflammatory-activated (IFNT) human macrophages are used for assessing the three methods. Note that for these evaluations, ten random downsamplings of the data were performed as described in Methods to make SCKC sample size the same as that of SC or KC. Results from one of these downsamplings chosen at random is shown in (A) given that other downsamplings show similar trends, and results from all 10 downsamplings are shown in (B) as lightly shaded lines along with a darkly shaded blue line connecting the median values across runs. <bold>(A)</bold> Comparing the precision (or uncertainty) of the parameter estimate of the indicated methods. For gene-condition combinations (GCCs) whose parameter estimates are similar between the compared methods (see <xref ref-type="sec" rid="sec011">Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005016.s005">S5 Fig</xref>), the difference in CrI width (reflecting uncertainty/precision) between the two compared methods scaled by the average parameter estimate is computed and shown as a histogram. Atop the histogram are the percent of GCCs having at least a 20% precision advantage in one method vs. the other in the indicated comparison (see <xref ref-type="sec" rid="sec011">Methods</xref>). <bold>(B)</bold> Differential heterogeneity (DH) comparisons. The empirical cumulative distribution function (CDF) of a t-like fold-change statistic for assessing differences between IFNT vs. CNT in the indicated parameter is shown. The statistic corresponds to the difference between the average estimate in the two conditions divided by the average uncertainty (CrI width). The indicated CDF fraction (y axis) is out of all successfully modeled genes, which is 71 for KC, 58 for SC and 41.5 (median) across different SCKC runs.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.g003" xlink:type="simple"/>
</fig>
<p>We next evaluated whether using single-cell data alone would lead to inferred parameters consistent with k-cell data and vice versa. In a perfect world where the single-cell assays have 100% detection and the value of k is sufficiently small so that masking of biological cell-to-cell heterogeneity due to convolution of k cells is minimal, single- and k-cell data would reveal similar information about cell-to-cell heterogeneity. In reality, these two data types may provide different parameter estimates due to a variety of reasons, including their differences in susceptibility to detection limit problems, and thus it would be informative using simultaneously generated single- and k-cell data to formally assess their consistency. Towards this end, we performed a cross-validation analysis by randomly dividing our data (84 single- and randomly down-sampled 84 ten-cell samples per condition (IFNT and CNT)) in 2:1 ratio into training and testing sets (<xref ref-type="fig" rid="pcbi.1005016.g004">Fig 4A</xref>). We used the training data to infer models separately using SC or KC and the testing fraction to assess how well the inferred model fits using our AD-test model assessment criteria (see <xref ref-type="fig" rid="pcbi.1005016.g001">Fig 1B</xref> and <xref ref-type="sec" rid="sec011">Methods</xref>). This analysis showed SC-inferred models tend to explain only the corresponding single-cell test data well but not the k-cell test data, and similarly but to a lesser degree, the KC-inferred models are more aligned with the k- than single-cell test data (<xref ref-type="fig" rid="pcbi.1005016.g004">Fig 4B</xref>). However when both training data types were used (SCKC), the inferred models fit both the single and k-cell test data substantially better than using the SC or KC inferred models alone (<xref ref-type="fig" rid="pcbi.1005016.g004">Fig 4B</xref>). To an extent, these observations are to be expected given that SCKC uses both single- and k-cell training data (half of each to keep the same sample size across methods). Yet, importantly, our results revealed that single- or k-cell analysis on their own could lead to models irreconcilable with the other data type, each of which contains important information about the expression distribution of a gene across single cells. Given the highly multiplexed nature of modern gene expression assays, a sizable number of genes could fall under such “incompatible” scenarios, thus providing support for the generation, cross-checking and proper integration of both data types when possible.</p>
<fig id="pcbi.1005016.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005016.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Cross-validation of SC, KC and SCKC methods using real data.</title>
<p><bold>(A)</bold> Illustration of the 2:1 cross-validation scheme. Note that the SCKC method’s input data is of the same sample size as the SC or KC method. <bold>(B)</bold> Bar plots showing the number of GCC models trained using 2/3<sup>rd</sup> of the data via the indicated method (SC, KC or SCKC) that successfully fit the unseen 1/3<sup>rd</sup> of the data. Here the fit is evaluated based on applying our AD-test model assessment criteria on either single-cell (green bars) or k-cell (red bars) test data.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008">
<title>Using bulk RNA-Seq data and differential expression (DE) performance to assess QVARKS</title>
<p>While the focus of QVARKS is to infer CHPs within a single condition or compare CHPs between two conditions, several existing single-cell approaches focus on assessing differential expression between conditions using single-cell data. QVARKS can also be used to assess DE using one of the three possible input data modes. Assessing DE affords us another way to check our model assumptions and the overall method because QVARKS computes DE using the posterior distribution of its model parameters and thus achieving reasonable DE results require that our inferred posterior distributions be accurate. Here following previous studies [<xref ref-type="bibr" rid="pcbi.1005016.ref011">11</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref018">18</xref>], we view the DE estimates (log<sub>2</sub>-fold-change (log<sub>2</sub>(FC)) of the average expression of a gene between two conditions) computed from bulk, cell population-level RNA-Seq data as “ground truths”. Our bulk RNA-Seq data was generated in a related study in the same macrophage conditions as our single- and k-cell data. In addition to comparing against bulk RNA-seq, we also assessed QVARKS’ performance in recapitulating bulk DE relative to that of two other single-cell based DE methods: MAST [<xref ref-type="bibr" rid="pcbi.1005016.ref018">18</xref>] and SCDE [<xref ref-type="bibr" rid="pcbi.1005016.ref011">11</xref>] (<xref ref-type="supplementary-material" rid="pcbi.1005016.s006">S6 Fig</xref>). Specifically, we applied MAST and SCDE to our macrophage qPCR data and compared with QVARKS running in SC, KC or SCKC modes using relative (Pearson correlation shown in <xref ref-type="supplementary-material" rid="pcbi.1005016.s006">S6A and S6B Fig</xref>) and absolute (average squared error shown in <xref ref-type="supplementary-material" rid="pcbi.1005016.s006">S6C and S6D Fig</xref>) measures of recovering ground-truth fold-change values. Evaluation based on the relative, correlation based measure revealed that QVARKS SCKC and KC nicely capture bulk level DE and perform comparably to MAST and SCDE, and QVARKS SC performs comparably once genes with large CrI are removed (<xref ref-type="supplementary-material" rid="pcbi.1005016.s006">S6A Fig</xref>). QVARKS SC in general yields more parameter estimates with large uncertainty (large CrI) as has also been observed above (<xref ref-type="fig" rid="pcbi.1005016.g003">Fig 3A</xref>), thus removal of these genes led to improved performance. Evaluation based on the absolute measure showed that DE estimates from all QVARKS input modes were well-calibrated with respect to the ground-truth values, and thus all had relatively low absolute error (<xref ref-type="supplementary-material" rid="pcbi.1005016.s006">S6C Fig</xref>). Thus, the overall DE performance of QVARKS suggests that our model assumptions and inference procedures are reasonable and capture the data well.</p>
</sec>
<sec id="sec009">
<title>QVARKS reveals condition-dependent CEV in resting vs. inflammatory human macrophages</title>
<p>To assess and illustrate the practical applicability and utility of QVARKS, we next applied QVARKS to the full single/10-cell macrophage data set introduced above. Here we focused our analysis using SCKC as the input data so that we can use all available data; SCKC also tends to provide the most robust results as suggested by the evaluations above. The data was obtained in a related study using fluorescence activated cell sorting (FACS) of single and ten cells followed by microfluidic qPCR (measuring 93 transcripts and 3 spike-in control RNAs; see <xref ref-type="sec" rid="sec011">Methods</xref>). Macrophages are immune cells that exhibit diverse environment-dependent phenotypes and hence are good models to study how the environment shapes CEV in transcript levels, such as changes in the fraction of ON cells (<italic>π</italic>). Environment- or signal-induced changes in gene expression have largely been assessed by measuring alterations in average expression using a population of cells, but measuring the average alone could miss changes in CEV. By taking advantage of the posterior distributions containing measures of statistical uncertainty around the inferred heterogeneity parameters, we can begin to quantitatively assess changes in CEV in resting vs. IFNT-activated (inflammatory) macrophages.</p>
<p>Our Bayesian procedure successfully modeled and obtained posterior distributions of model parameters for 53 and 60 genes in CNT and IFNT, respectively. Of these, 41 are shared between CNT and IFNT, and hence their CEV can be quantitatively compared across these two conditions (see below). A majority of the remaining genes failed model assessment due to scarcity of detected cells (observed ON cells less than 5 in single-cell data for 23 failed genes in CNT and 17 failed genes in IFNT). Since these genes are inherently difficult to work with for inferring CHPs (e.g. inferring ON-cell variance from 5 or fewer cells is challenging), they could essentially be filtered out <italic>a priori</italic>. Under such a filter, the model assessment rate increases to 71–75% (47 out of 66 filtered genes in CNT, and 51 out of 68 in IFNT were successfully modeled). Thus, consistent with our DE assessment above, our model assessment indicates that for many genes, the data is captured well by our models, suggesting that our model assumptions, including distribution choices, are also robustly supported by the data.</p>
<p>Despite the relatively high sensitivity of qPCR assays, signs of imperfect detection were apparent given that the average expression derived from single-cell data tended to be consistently lower than that obtained from 10-cell data (divided by 10) for transcripts expressed at medium or low levels (<xref ref-type="supplementary-material" rid="pcbi.1005016.s007">S7 Fig</xref>). Thus, some apparently “OFF” cells likely had some non-zero level of expression that simply escaped detection. Indeed, the <italic>inferred</italic> fraction of OFF cells (1-<italic>π</italic>) for a majority of genes in both conditions was consistently lower, albeit only slightly in most cases, than that observed on single-cell data alone (<xref ref-type="fig" rid="pcbi.1005016.g005">Fig 5A</xref>). As expected, genes with a higher observed fraction of OFF cells also tended to have larger uncertainty for <italic>π</italic> because it is more difficult to narrow down model parameters (including ones associated with detection) using information from just a few ON cells (analogous to the “high difficulty” simulation scenario; see <xref ref-type="fig" rid="pcbi.1005016.g002">Fig 2</xref>). However, even for such “difficult” genes, not all of the OFF cells can be attributed to escaped detection–the inferred fraction of OFF cells is at least 25% for a majority of these genes even after accounting for statistical uncertainty (based on counting genes whose CrI is above 0.25 in <xref ref-type="fig" rid="pcbi.1005016.g005">Fig 5A</xref>). Thus, our Bayesian analysis integrating single- and 10-cell data helped estimate the proportion of OFF cells attributable to detection issues and thereby helped obtain better estimates of the expression distribution among single cells for a majority of the genes we measured.</p>
<fig id="pcbi.1005016.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005016.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Application of QVARKS SCKC reveals technical drop-offs and basis of bulk differential expression.</title>
<p><bold>(A)</bold> Extent of technical noise. Comparing the inferred (y) vs. observed (x) fraction of OFF cells across genes shows that genes with higher fractions of OFF cells were affected the most by imperfect detection. Only genes successfully modeled in either the IFNT or CNT conditions are shown; the 90% credible interval (Crl) is indicated by the lightly shaded line around the mean of the posterior distribution. Several example genes associated with inflammatory or anti-inflammatory processes in macrophages are marked. <bold>(B)</bold> Distinct modes of regulating differential expression. The 23 differentially expressed genes based on average expression in the cell population in resting vs. IFNT conditions are shown in a scatter plot depicting differences in the fraction of ON cells (x) against differences in the mean of ON cells (y). The CHPs inferred using QVARKS are used to classify these genes into those with significant (adjP &lt; 0.05) changes in: 1) only the fraction of ON cells, 2) only the mean expression of ON cells, 3) both, or 4) neither. The 90% Crl is indicated by the lightly shaded lines around the mean of the posterior distribution as before.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.g005" xlink:type="simple"/>
</fig>
<p>Bulk differential expression (DE) between two conditions can be attributed to a combination of changes in the fraction of ON cells and in the mean expression level among ON cells [<xref ref-type="bibr" rid="pcbi.1005016.ref007">7</xref>]. Here QVARKS provides a rigorous framework to explore the relationship between bulk differential expression (DE) and alterations in heterogeneity parameters <italic>π</italic> and <italic>μ</italic> [<xref ref-type="bibr" rid="pcbi.1005016.ref007">7</xref>] upon inflammatory activation. We assessed the status of these parameters for 23 DE genes between IFNT and CNT conditions (adjusted P-value or adjP &lt; 0.05) determined using the posterior distribution of the average mRNA level (reflected by the mean <italic>μ</italic> of ON-cells weighted by <italic>π</italic>; see <xref ref-type="sec" rid="sec011">Methods</xref>)–these genes were largely similar to DE genes obtained directly from 10-cell data (see <xref ref-type="sec" rid="sec011">Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005016.s008">S8 Fig</xref>). Eight of the DE genes had significant changes in <italic>π</italic> but not <italic>μ</italic> (e.g., <italic>RELA</italic>), while four had the opposite behavior (e.g., <italic>FTL</italic>), and the rest either had significant changes in both (e.g., <italic>CD274</italic>) or neither (<xref ref-type="fig" rid="pcbi.1005016.g005">Fig 5B</xref>). Note that many genes in the last category lacked significant change in <italic>π</italic> and <italic>μ</italic> not necessarily because the mean fold changes are small, but more because the statistical uncertainty around their inferred fold changes is large. Taken together, our results show that in macrophages adapting to inflammatory stimulation, both “digital” (altering <italic>π</italic>) and “fine-tuning” (altering <italic>μ</italic>) modes of regulating gene expression are prevalent.</p>
<p>A key application of QVARKS is to assess changes in heterogeneity parameters (or DH), such as asking whether environment shapes cellular heterogeneity. Thus, we next inferred differences between IFNT and CNT in terms of 1) the standard deviation of expression in ON cells (<italic>σ</italic>) reflecting continuous heterogeneity and 2) the ON-fraction (<italic>π</italic>) reflecting discrete heterogeneity (<xref ref-type="fig" rid="pcbi.1005016.g006">Fig 6</xref>). The inferred differences in these CHPs for successfully modeled genes were also verified to be robust against well-to-well variation in detection efficiency quantitated using spiked-in ERCC control mRNAs (see <xref ref-type="supplementary-material" rid="pcbi.1005016.s009">S9 Fig</xref>; note that detection efficiency was a major source of technical noise assessed in [<xref ref-type="bibr" rid="pcbi.1005016.ref012">12</xref>]). In addition to <italic>π</italic> and <italic>σ</italic>, comparative assessment of heterogeneity across conditions can also be extended to other notions of heterogeneity, such as the Shannon entropy function computed using <italic>π</italic>, by taking advantage of our Bayesian approach’s ability to handle inference of any function of the CHPs (see <xref ref-type="supplementary-material" rid="pcbi.1005016.s010">S10 Fig</xref> and <xref ref-type="sec" rid="sec011">Methods</xref>).</p>
<fig id="pcbi.1005016.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005016.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Application of QVARKS SCKC to assess differential heterogeneity.</title>
<p>QVARKS was applied to assess significant (adjP &lt; 0.05) changes in <italic>π</italic> and <italic>σ</italic> using joint single- and 10-cell data obtained from human macrophages in resting (CNT) vs. IFNT-activated conditions. <bold>(A,D)</bold> Continuous heterogeneity as reflected by <italic>σ</italic> (A) or discrete heterogeneity as reflected by <italic>π</italic> (D) were significantly altered in IFNT (y) relative to CNT (x) for some (indicated in red) of the 41 successfully modeled genes. The 90% Crl is indicated by the lightly shaded lines around the mean of the posterior distribution. <bold>(B,C)</bold> The posterior distribution of <italic>σ</italic> for <italic>DUSP1</italic> (B) and <italic>RELA</italic> (C) are shown to illustrate why only <italic>RELA</italic> was deemed significantly changed between the two conditions. The 90% CrI around the posterior mean shown in (A) is indicated here as red lines.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.g006" xlink:type="simple"/>
</fig>
<p>Our analyses revealed both shared and condition-specific patterns of CEV (Fig <xref ref-type="fig" rid="pcbi.1005016.g006">6A and 6D</xref>). Genes such as <italic>FTL</italic> had similar continuous and discrete heterogeneity across conditions. However, <italic>RELA</italic>, a component of the NFκB complex, for example, had a higher fraction of ON cells (adjP = 2.15e-05, calculated as described in Methods) as well as higher variability among ON cells in IFNT than CNT (adjP = 0.012, <xref ref-type="fig" rid="pcbi.1005016.g006">Fig 6C</xref>). Such changes in continuous variability could not be solely attributed to differences in average expression among ON cells (<italic>μ</italic>) or fraction of ON cells (<italic>π</italic>) between the conditions (<xref ref-type="supplementary-material" rid="pcbi.1005016.s011">S11 Fig</xref>). The inferred change in <italic>σ</italic> across the two conditions for genes such as <italic>RELA</italic> was also robust against sampling noise when random (50%) downsamplings of the data were assessed (<xref ref-type="supplementary-material" rid="pcbi.1005016.s012">S12 Fig</xref>), and is thus potentially reflective of changes in biological cell-to-cell variation. Since NFκB is a key transcription factor mediating responses to diverse inflammatory signals in macrophages [<xref ref-type="bibr" rid="pcbi.1005016.ref025">25</xref>], an increase in the heterogeneity of <italic>RELA</italic> expression upon inflammatory activation by IFNT suggests that elevating the response diversity among cells in, for example, infected tissues may play an important functional role, such as to counteract bacterial targeting of activated cells or to prevent detrimental over-inflammation. <italic>CLEC7A</italic> also showed changes in both types of heterogeneity, albeit in opposite directions, i.e., up in continuous (adjP = 0.002) and down in discrete (adjP = 0.0006) variations. Differences in <italic>σ</italic> could, for instance, reflect changes in stochastic dynamics during transcription and mRNA degradation, or in negative feedback regulation. Thus, changes in both heterogeneity parameters in inflammatory vs. resting macrophages can be robustly detected by our approach. It will be interesting in the future to study the underlying mechanisms and function of such distinct gene regulation modes revealed by the differential heterogeneity and differential expression tests enabled by QVARKS.</p>
</sec>
</sec>
<sec id="sec010" sec-type="conclusions">
<title>Discussion</title>
<p>Environment- or signal-induced changes in gene expression have largely been assessed by measuring alterations in average expression using a population of cells. However, measuring the average alone could miss changes in cell-to-cell heterogeneity. Assessing such changes in a statistically rigorous manner has been challenging, in part due to difficulties in disentangling technical vs. biological variations in single-cell measurements. To help overcome these challenges, we have developed a flexible computational method for inferring CHPs within a cell population or across two cell populations using single-cell, k-cell, or both data types simultaneously, by obtaining measures of statistical uncertainty around the inferred heterogeneity parameters so that the significance of an observed change can be evaluated. Here using inflammatory activation of human macrophages as a first biological application, we have uncovered a number of significant changes in the fraction (<italic>π</italic>) of and/or variance (<italic>σ</italic>) among ON cells. Furthermore, we have shown that changing <italic>π</italic> alone (“digital” gene expression) can contribute to changes in mean expression at the bulk level. Our approach can also be used to explore whether cellular heterogeneity can change without accompanying changes in average expression, e.g., increasing <italic>π</italic> and <italic>σ</italic> while reducing <italic>μ</italic> such that the population average is unaltered. Indeed, it is increasingly recognized that cell-to-cell variations could themselves be regulated both genetically and environmentally without affecting the average expression level to, for example, reduce the chance of noise-induced cellular activation by lowering heterogeneity or hedge against environmental fluctuations by ensuring sufficient variation across cells in a population [<xref ref-type="bibr" rid="pcbi.1005016.ref017">17</xref>]. However, it is worth noting that despite our modeling of technical factors such as misdetection, interpreting continuous CEV parameters (the variation among ON cells, or <italic>σ</italic>) can be more challenging in general than interpreting discrete CEV parameters (the fraction of ON cells, or <italic>π</italic>). For example, other sources of technical noise are still possible and thus the biological and technical sources may not be fully disentangled, and additional checks, such as those in <xref ref-type="supplementary-material" rid="pcbi.1005016.s011">S11 Fig</xref> based on linear regression, do not account for non-linear relationship between mean and variance, and could violate some linear regression assumptions (such as error-free measurement of independent variables and homoscedasticity). One way to help disentangle biological from technical variation in the future is to utilize dilution-series experiments to obtain an estimate of the technical variation of all gene assays at different average expression levels, although sampling/pipetting noise also need to be considered properly at lower ends of the concentration scale.</p>
<p>The unique ability of QVARKS in handling the three input data types (SC, KC and SCKC) allowed us to assess their relative performance for the first time under a common Bayesian analysis framework. While analyses of both simulated and real data suggest that there are situations under which each of single- or k-cell input data types can offer advantages, in general combining single- and k-cell data—when both are generated simultaneously—could yield more robust estimates of CHPs compared to using single- or k-cell data alone across a range of scenarios, particularly for genes with moderate to poor detection. A further practical appeal of using single- and k-cell data jointly, particularly in multiplexed settings such as microfluidic qPCR and RNA-Seq where tens to thousands of genes are measured, is that the single-cell data for genes with good detection (e.g., highly expressed genes) can be directly analyzed to enable applications that require measurements of multiple genes within individual cells, such as identifying novel cell subsets. However, our approach is flexible and therefore can also be applied to single-cell data for assessing CHPs within a single condition or comparatively between two conditions.</p>
<p>Our methodological framework can be extended to incorporate additional parameters or use alternative model parameterizations to account for features such as multimodality within ON cells, e.g., in samples comprising mixed cell types or subsets. But the inference accuracy would be constrained by sample size. For example, each additional mode would require three extra parameters per biological condition in order to capture its frequency, mean and variance (assuming using a log-normal distribution). Thus, it would only become feasible to learn the extra parameters for such models when larger sample sizes are available, which will likely be the case in the near future as the experimental cost of profiling continues to drop with the introduction of new technologies [<xref ref-type="bibr" rid="pcbi.1005016.ref005">5</xref>]. Here we chose to use the unimodal distribution for ON cells for several reasons. First, it is simple, yet captures our single- and k-cell data well—as discussed above, our model assessment criteria indicated that this parameterization was sufficient to successfully fit a majority of genes. Among the remaining genes, the predominant reason for the lack of fit appeared to be the scarcity of ON cells rather than bimodality among them: there are only two GCCs with more than 10% ON cells that appeared to be multi-modal (TIGD6 in CNT and PTGS1 in IFNT according to Hartigan’s Dip test for unimodality using a relaxed P &lt; = 0.2 cutoff). While additional multimodal genes may be present in our study, they were not evident at our current sample size.</p>
<p>The model assessment procedure used in this study, the default in the R package implementing our QVARKS approach, leans on the stringent/conservative side (i.e., allows less genes to pass model assessment), in that we required most data sets generated from each of the posterior parameter draws to be statistically indistinguishable from the observed data (see <xref ref-type="sec" rid="sec011">Methods</xref>). Users of the R package can choose other forms of model assessment, including a variant of the one used here where data simulated from different posterior parameter draws are concatenated into one dataset, and a single AD test is carried out to assess the concordance of this dataset against the observed data. This approach can work well for genes with just a few ON cells since concatenating all simulated datasets into one provides a larger sample size to enable a more robust comparison against observed data. However, one advantage of the default approach is that it matches the sample sizes of the simulated and observed data when performing each of the multiple AD tests. Another model assessment criterion that our R package supports is based on the well-accepted posterior predictive p values (ppp; [<xref ref-type="bibr" rid="pcbi.1005016.ref023">23</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref024">24</xref>]), wherein we empirically test if a particular aspect of the observed data, such as mean or variance of observed ON cells, is captured well by simulated datasets generated from the posterior parameter draws. However, the ppp requires the user to choose which aspect of the data (e.g., mean and/or variance) to use, and does not use information from the whole data distribution the way the AD test does. The vignette/manual of the QVARKS R package illustrates and compares these model assessment options. Having multiple model assessment options allows the users to have more means to determine whether to trust a particular gene’s fitted model, and depending on the goals of the analysis, proper tradeoffs can be made between ensuring that model assumptions are comprehensively met vs. discarding expensive single- or k-cell data. For example, consider a gene that is expressed in a high number of ON cells in condition A but in very few in condition B. If the goal were to compare the continuous heterogeneity of genes between the two conditions, it would be challenging to analyze this gene as the very few ON cells in condition B would yield unreliable estimates for <italic>σ</italic> in that condition. However, changes in the discrete heterogeneity (<italic>π</italic>) or average differential expression can be more reliably studied for this gene between the two conditions.</p>
<p>When the k-cell approach is used, the optimal value of k could depend on the cell type and assayed genes, thus empirical assessment is needed for choosing k. For example, a dilution series of bulk mRNA can be profiled to estimate the minimum value of k that would provide reasonable detection for most genes. Our simulation assessment suggests a tradeoff between the value of k and sensitivity: increasing k would better mitigate detection issues at the cost of masking biologically relevant heterogeneity from convolving single-cell samples. Indeed, in general k should be large enough to avoid detection issues, but sufficiently small to avoid such masking effects where the relative contribution of biological cell-to-cell variations would become increasingly small and thus undetectable due to technical noise. Similarly, the optimal proportion of single- vs. k-cell samples to profile is context-dependent and best chosen using an empirical approach. When no prior information is available, as in this study, one could start with an equal proportion of both data types (e.g., 100 single- and 100 k-cell samples). One can then use this data to estimate the relative contributions of each data type to the model likelihoods and use this information to help determine the relative proportion of single- and k-cell samples to profile in the next round of experiments. This process can be iterated to fine-tune the proportion until a fixed profiling budget is reached. However, until the cost and time of sample preparation and sequencing drop to negligibly low levels, this iterative strategy can be prohibitive; thus, in practice, it is best to simply profile an equal number of single- and k-cells and only generate more data of one of the data types if it is quantitatively clear that additional data would help with answering the biological question of interest.</p>
<p>The vignette document distributed along with our QVARKS R package describes the functionality of our package using actual data examples and discusses issues related to experimental design (e.g., the dilution-series experiments discussed above when k-cell data is desired) as well as statistical considerations (e.g., data quality assessment, preprocessing, transformation steps, and model assessment) and computational considerations (e.g., scalability of the inference procedure to process a large number of genes via parallelization). Though QVARKS was primarily developed to analyze single-cell qPCR datasets, as a proof of concept, the vignette also illustrates how QVARKS can be applied to an externally pre-processed single-cell RNA-Seq dataset using a parallel computing cluster. Our approach thus provides a principled and practical method to explore cellular heterogeneity in diverse settings.</p>
</sec>
<sec id="sec011" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec012">
<title>Ethics statement</title>
<p>Peripheral blood was obtained by leukapheresis from a de-identified healthy donor by the NIH Blood Bank, Department of Transfusion Medicine, National Institutes of Health Clinical Center under IRB-approved protocol 99-CC-0168.</p>
</sec>
<sec id="sec013">
<title>Model description and likelihood function</title>
<p>We motivated and described the parametric model of gene expression in single- and k-cell samples from a cell population in the main text. Here, we formally specify the model along with the likelihood function of model parameters. As shown below, the choices of specific distributions in our model are inspired by earlier single-cell modeling studies (eg. bimodal mixtures of ON/OFF cells and log-normally distributed ON-cell transcript levels assayed using qPCR [<xref ref-type="bibr" rid="pcbi.1005016.ref007">7</xref>] or RNA-Seq [<xref ref-type="bibr" rid="pcbi.1005016.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref021">21</xref>], and logistic detection behavior of qPCR [<xref ref-type="bibr" rid="pcbi.1005016.ref008">8</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref022">22</xref>] or RNA-Seq [<xref ref-type="bibr" rid="pcbi.1005016.ref011">11</xref>] assays). We extend the existing single-cell models by integrating both single- and k-cell data, explicitly modeling imperfect detection assays and handling more than one environmental condition under which a gene is profiled. Multiple environmental conditions are handled by keeping the detection behavior parameters the same across conditions (which is reasonable as the same gene assay is used across conditions) and letting the CHPs (π, μ and σ) be condition-specific. We present the single-condition model first and then point out what changes need to be made to handle the two conditions focused in this study. An interesting future direction would be to extend these single/two-condition models to handle more complex experimental designs, e.g., those involving more than two conditions and handling covariates such as donor information, batch effects, and cell size.</p>
<p>We extend a model of “underlying” or “true” single-cell expression in an earlier study [<xref ref-type="bibr" rid="pcbi.1005016.ref007">7</xref>] to obtain a model of “measured” single-cell expression that handles imperfect detection as follows. Let G denote the expression of a gene transcript (i.e., counts of transcript copies without any log transformation) in a random cell in the population. Then the bimodal mixture model for G could be written in random variable notation as G = I X, where I ∼ Bernoulli(π) is an indicator variable that is 1 for an ON-cell of the gene with probability <italic>π</italic> and 0 otherwise, and <italic>log</italic><sub>2</sub><italic>X</italic> ∼ <italic>Normal</italic>(<italic>μ</italic>, <italic>σ</italic>). Note that the log of average overall expression is given by log<sub>2</sub>(<italic>E</italic>(<italic>G</italic>)) = <italic>log</italic><sub>2</sub>(<italic>E</italic>(<italic>I</italic>)<italic>E</italic>(<italic>X</italic>)) = log<sub>2</sub> <italic>π</italic> + <italic>μ</italic> + <italic>σ</italic><sup>2</sup> log<sub><italic>e</italic></sub>(2)/2 (in line with the intuition that both fraction and mean expression of ON cells determines the overall expression output, with <italic>σ</italic><sup>2</sup> contribution coming from cells in the tail of a log-normal distribution). The measured expression <italic>H</italic> (e.g., 2<sup><italic>Et</italic></sup> values of the gene across single-cell samples in a given condition, where Et = 40-Ct is a unit of measurement for qPCR assays as described below) is either detected at the true underlying measurement <italic>G</italic> with a certain detection probability <italic>DP</italic>(<italic>G</italic>) (which ranges from 0 to 1 and increases with expression strength in a logistic manner) or not detected (2<sup><italic>Et</italic></sup> = 0) otherwise. So <italic>H</italic> = <italic>J</italic>(<italic>G</italic>) <italic>G</italic>, where <italic>J</italic>(<italic>G</italic>) ∼ <italic>Bernoulli</italic>(<italic>DP</italic>(<italic>G</italic>)) is an indicator variable that is 1 for detected measurements and 0 for non-detects, and <italic>DP</italic>(<italic>G</italic>) is a logistic function with intercept <italic>c</italic> and slope <italic>m</italic>, i.e., <inline-formula id="pcbi.1005016.e001"><alternatives><graphic id="pcbi.1005016.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005016.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:msub><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>. This parameterization reflects the standard way of modeling the probability of a binary response, such as non-detect vs. detects in expression profiles. We can now write the likelihood function of the model parameters given single-cell expression measurements <italic>h</italic><sub>1</sub>,<italic>h</italic><sub>2</sub>,…,<italic>h</italic><sub><italic>n</italic></sub> of the gene in <italic>n</italic> cells for a given condition as below. Here, <italic>P</italic><sub><italic>μ</italic>,<italic>σ</italic></sub>(<italic>X</italic> = <italic>x</italic>) denotes the log-normal probability density function evaluated at <italic>x</italic> or equivalently the normal density function with mean <italic>μ</italic> and variance <italic>σ</italic><sup>2</sup> evaluated at <italic>log</italic><sub>2</sub>(<italic>x</italic>).</p>
<disp-formula id="pcbi.1005016.e002">
<alternatives>
<graphic id="pcbi.1005016.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005016.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mspace width="0.25em"/><mml:mo>|</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mspace width="0.25em"/><mml:mo>|</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.15em"/><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mspace width="0.25em"/><mml:mo>|</mml:mo><mml:mspace width="0.25em"/><mml:mi>h</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>π</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mo>)</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>h</mml:mi><mml:mo>)</mml:mo><mml:mspace width="6em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.25em"/><mml:mi>h</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.15em"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="7.5em"/><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>π</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:msubsup><mml:mstyle displaystyle="false"><mml:mo>∫</mml:mo></mml:mstyle><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mspace width="0.25em"/><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.25em"/><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
</disp-formula>
<p>Since each k-cell measurement is modeled as aggregating mRNAs from k randomly chosen independent cells and subjecting it to the same imperfect detection as single-cell data, we can write “true” k-cell expression <inline-formula id="pcbi.1005016.e003"><alternatives><graphic id="pcbi.1005016.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005016.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (with the <italic>G</italic><sub><italic>i</italic></sub>s being independent and identically distributed as <italic>G</italic> above, and hence fully defined by the single-cell expression parameters π, μ and σ) and the k-cell measurement <italic>W</italic> = <italic>J</italic>(<italic>V</italic>) <italic>V</italic> (in the same way that <italic>H</italic> is obtained from <italic>G</italic> using the <italic>c</italic>,<italic>m</italic>-parameter logistic “assay”). Since the true single-cell distribution <italic>G</italic> is bimodal, the true k-cell distribution <italic>V</italic> is multimodal depending on how many ON cells constitute a particular k-cell pool (denoted <inline-formula id="pcbi.1005016.e004"><alternatives><graphic id="pcbi.1005016.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005016.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mi mathvariant="script">l</mml:mi></mml:math></alternatives></inline-formula>). The likelihood function of this multimodal distribution can be approximated either empirically or analytically [<xref ref-type="bibr" rid="pcbi.1005016.ref015">15</xref>]:</p>
<list list-type="order">
<list-item><p>The empirical (or Monte Carlo) approximation is straightforward and can work seamlessly for any choice of single-cell distribution, probabilistic detection models and k value, but it is more computationally intensive. This approach involves building kernel density estimate (KDE; using R’s density function with default values for instance) from repeatedly drawn k-cell measurements, where each repeat involves summing k independent samples from the underlying single-cell distribution and simulating their detection by the logistic “assay”.</p></list-item>
<list-item><p>The analytical approximation is more computationally efficient—it involves marginalizing out the unknown value of <inline-formula id="pcbi.1005016.e005"><alternatives><graphic id="pcbi.1005016.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005016.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mi mathvariant="script">l</mml:mi></mml:math></alternatives></inline-formula> and approximating the distribution of a sum of <inline-formula id="pcbi.1005016.e006"><alternatives><graphic id="pcbi.1005016.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005016.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mi mathvariant="script">l</mml:mi></mml:math></alternatives></inline-formula> ON-cell transcript counts for each <inline-formula id="pcbi.1005016.e007"><alternatives><graphic id="pcbi.1005016.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005016.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mi mathvariant="script">l</mml:mi></mml:math></alternatives></inline-formula> (denoted <inline-formula id="pcbi.1005016.e008"><alternatives><graphic id="pcbi.1005016.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005016.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow/></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, with <italic>X</italic><sub><italic>i</italic></sub>s being independent and log-normally distributed as <italic>X</italic> above) by another mean/variance-matched log-normal distribution as done in an earlier study [<xref ref-type="bibr" rid="pcbi.1005016.ref015">15</xref>].</p></list-item>
</list>
<p>The empirical approximation becomes more accurate by increasing the number of repeated samples but at the burden of increased computational time, and the log-normal sum approximation we use, called the Fenton-Wilkinson approximation, is accurate when the standard deviation <italic>σ</italic> is not too large [<xref ref-type="bibr" rid="pcbi.1005016.ref026">26</xref>]. Both approaches yielded similar likelihood values for the parameter configurations we checked (involving <italic>σ</italic> values ranging from 0.25 to 2, and using 10,000 samples to build each KDE)–so we eventually chose the analytical approach in this study for computational efficiency reasons. The likelihood function of the model parameters given k-cell measurements <italic>w</italic><sub>1</sub>,<italic>w</italic><sub>2</sub>,…,<italic>w</italic><sub><italic>n</italic></sub> of a gene in <italic>n</italic> k-cell pools for a given condition can either be directly read off from the KDE for each measurement and multiplied together in the empirical approach, or given by the formula below in the analytical approach. Here, <italic>P</italic><sub><italic>μ</italic>,<italic>σ</italic></sub>(<italic>X</italic><sub>(<italic>l</italic>)</sub> = <italic>x</italic>) denotes the Fenton-Wilkinson approximated probability density function of the sum of <inline-formula id="pcbi.1005016.e009"><alternatives><graphic id="pcbi.1005016.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005016.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mi mathvariant="script">l</mml:mi></mml:math></alternatives></inline-formula> ON-cell transcripts evaluated at <italic>x</italic>, and <inline-formula id="pcbi.1005016.e010"><alternatives><graphic id="pcbi.1005016.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005016.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>#</mml:mi><mml:mspace width="0.25em"/><mml:mi>O</mml:mi><mml:mi>N</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="script">l</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">l</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">l</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="script">l</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> denotes the probability of observing <inline-formula id="pcbi.1005016.e011"><alternatives><graphic id="pcbi.1005016.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005016.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mi mathvariant="script">l</mml:mi></mml:math></alternatives></inline-formula> ON-cells in a random k-cell pool.</p>
<disp-formula id="pcbi.1005016.e012">
<alternatives>
<graphic id="pcbi.1005016.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005016.e012" xlink:type="simple"/>
<mml:math display="block" id="M12">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mspace width="0.15em"/><mml:mo>|</mml:mo><mml:mspace width="0.15em"/><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow/></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow/></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow/></mml:msubsup><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow/></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.15em"/><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mspace width="0.15em"/><mml:mo>|</mml:mo><mml:mspace width="0.15em"/><mml:mi>w</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="script">l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>#</mml:mi><mml:mspace width="0.25em"/><mml:mi>O</mml:mi><mml:mi>N</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="script">l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mspace width="3em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.25em"/><mml:mi>w</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="2.5em"/><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="script">l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>#</mml:mi><mml:mspace width="0.25em"/><mml:mi>O</mml:mi><mml:mi>N</mml:mi><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="script">l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mspace width="0.25em"/><mml:mrow><mml:msubsup><mml:mstyle displaystyle="false"><mml:mo>∫</mml:mo></mml:mstyle><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow/></mml:msubsup><mml:mo>=</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mspace width="0.25em"/><mml:mi>d</mml:mi><mml:mi>v</mml:mi><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.25em"/><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
</disp-formula>
<p>This likelihood function agrees with intuition that pools of small number of cells retain information on single-cell variations, but that of large number of cells lead to “bulk or masked-out” effect that makes the <italic>π</italic> and <italic>μ</italic> parameters inseparable, as also noted in the main text when presenting simulation results. Because as <italic>k</italic> increases, the binomially distributed number of ON cells in a random k-cell pool becomes more tightly concentrated around the value <italic>kπ</italic>, and so the k-cell mixture asymptotically collapses from (<italic>k</italic> + 1) components corresponding to different numbers of ON cells to a single component whose distribution is the sum of <italic>kπ</italic> i.i.d. log-normal variables. Note that the sum of <italic>kπ</italic> i.i.d. log-normal variables can be (Fenton-Wilkinson) approximated by another log-normal with log-space parameters <italic>μ</italic>’ = ln(<italic>kπe</italic><sup><italic>μ</italic></sup>) + (<italic>σ</italic><sup>2</sup> − <italic>σ</italic>’<sup>2</sup>)/2 and <inline-formula id="pcbi.1005016.e013"><alternatives><graphic id="pcbi.1005016.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005016.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mi>σ</mml:mi><mml:msup><mml:mi>’</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>–</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mi>π</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>. Such a k-cell mixture essentially makes the three heterogeneity parameters inseparable (or non-identifiable) using k-cell data alone, since the same k-cell distribution (given by the same <italic>μ</italic>’, <italic>σ</italic>’) can be explained equally well by different combinations of <italic>π</italic>, <italic>μ</italic> and <italic>σ</italic>. Note that though in reality the k-cell mixture model collapses to more than a single component for large k values, the log-space parameters of these different components would be so close to each other that it would be difficult to separate them out using reasonable sample sizes.</p>
<p>To integrate single/k-cell data and obtain overall log likelihood of the five model parameters given both single/k-cell data, we simply add the log of the k-cell likelihood and log of the single-cell likelihood specified above. To handle two environmental conditions, we add three new parameters <italic>π</italic>″,<italic>μ</italic>″ and <italic>σ</italic>″ for the new condition and use the same likelihood function specified above to compute the likelihood of all eight model parameters given each condition’s single/k-cell measurements separately and finally add the log-likelihood corresponding to all measurements together. Since we use a non-informative prior, the joint posterior distribution is proportional to the likelihood function. In case of an informative prior, the posterior is proportional to the product of the prior probability and the likelihood function (i.e., <italic>P</italic>(<italic>parameters</italic> | <italic>data</italic>) ∝ <italic>P</italic>(<italic>parameters</italic>) <italic>P</italic>(<italic>data</italic> | <italic>parameters</italic>)). In other words, what you know about the parameters after the data arrive is what you knew before, and what the data told you [<xref ref-type="bibr" rid="pcbi.1005016.ref027">27</xref>].</p>
</sec>
<sec id="sec014">
<title>Model inference using MCMC-based Bayesian approach</title>
<p>To infer the joint posterior distribution of all parameters, we use a random walk Metropolis (RWM) Markov Chain Monte Carlo (MCMC) procedure with an adaptive tuning phase [<xref ref-type="bibr" rid="pcbi.1005016.ref027">27</xref>]. The proposal distribution or proposed jump for a RWM MCMC is an independent Gaussian variable in each direction (each of the five parameters for single-condition or eight parameters for two-condition gene expression) with mean 0 and a certain fixed proposal variance. This would work for a posterior with unbounded support, but would be too computationally inefficient for our posterior with bounded support (due to MCMC steps being wasted in non-permissible values of the parameter, which do not satisfy parameter constraints such as 0 ≤ π ≤ 1 and σ ≥ 0). Therefore we use a truncated Gaussian proposal for each parameter, with the truncation ensuring that each new proposed state of the MCMC is always within the constrained parameter range. Note that the pdf (probability density function) of a Gaussian distribution truncated to the interval [<italic>a</italic>,<italic>b</italic>] is 0 outside this interval, and same as the normal Gaussian pdf otherwise, except for a uniform scaling of pdf values within the interval by a constant so that the integral is unity. In the case of qPCR expression data in Et = 40-Ct units [<xref ref-type="bibr" rid="pcbi.1005016.ref007">7</xref>] (also see below for our qPCR data description), we imposed additional constraints to further improve computational efficiency including 0 ≤ μ, σ, c ≤ 40 and 0 ≤ m ≤ 5. These constraints can also work for other data types such as RNA-Seq data, once the RNA-Seq-based read counts have underwent additional pre-processing steps (such as expression noise thresholding and log-transformation [<xref ref-type="bibr" rid="pcbi.1005016.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1005016.ref021">21</xref>]) that are required to reveal the bimodal mixture of OFF/ON cells and log-normal distribution of ON-cells for conforming genes. Our implementation is in the R statistical environment and extends the RWM MCMC implementation in the R package <italic>mcmc</italic> that works for any unbounded continuous distribution on R<sup>d</sup> to the case of a continuous distribution with bounded support (which in our case is the posterior or likelihood function for non-informative priors).</p>
<p>The whole MCMC-based inference procedure involves three phases: a) an adaptive phase where the proposal variance is tuned to achieve good mixing–we use a noisy gradient algorithm as implemented in the R package <italic>JAGS</italic> for this phase using a maximum of 400,000 iterations, b) a burn-in phase where the tuned proposal variance is fixed and the chain is allowed to mix for 20,000 iterations and all resulting samples discarded, and c) a final sampling phase where the actual samples are collected over 200,000 iterations. These iteration counts for single-condition inference are multiplied by two for a two-condition inference, and were determined based on pilot MCMC runs and inspection of convergence diagnostics. Convergence diagnostics such as MCMC trace plots and autocorrelation times are also reported alongside each gene’s inference, and could be used to filter out genes with poor convergence; however we rely instead on model assessment “fit” criteria of the parameter posteriors as described below to filter out poorly fit genes. The 90% credible interval (shortest interval containing 90% mass) is constructed from the empirical cumulative density of the posterior samples of each parameter using the R package <italic>coda</italic>.</p>
<p>For model assessment, i.e., to assess whether the data is captured well by our inferred models and satisfies our model assumptions including specific choices of distributions, we used concepts from the posterior predictive checking framework [<xref ref-type="bibr" rid="pcbi.1005016.ref023">23</xref>]. We specifically check the agreement between the distribution of observed data and of data generated from (“predicted by”) 100 inferred models, each of which was specified by parameters independently drawn from the posterior distribution, following the framework of Graphical posterior predictive checks but replacing the graphical check with a more quantitative AD-test check (Section 6.4 of [<xref ref-type="bibr" rid="pcbi.1005016.ref023">23</xref>]). The specific model assessment criterion we used required more than 75% of the models drawn to be capable of generating data samples statistically indistinguishable from the observed single- and 10-cell data (i.e., AD-test P ≥ 0.1). The Anderson-Darling or AD test is similar to the KS-test in that it tests if the same distribution could have yielded two sets of data samples (which in our case are the observed single- or k-cell samples and the same number of samples simulated from the inferred single- or k-cell model respectively). We use the ad.test implementation in the R package <italic>kSamples</italic>. In addition to filtering out genes that do not pass this AD-test criteria, we also excluded genes with extremely high variance of ON cells (posterior mean of <italic>σ</italic> greater than 5 in any of the two conditions) as part of model assessment. Genes whose inferred models pass these model assessment criteria in both conditions are referred to as <italic>successfully modeled</italic> genes, and genes that pass model assessment in a given condition are referred to as <italic>successfully modeled</italic> gene-condition models or gene-condition combinations (GCCs). Note that besides the default model assessment approach just described, our R package QVARKS also supports other model assessment options, including a single AD-test approach and posterior predictive pvalues (see <xref ref-type="sec" rid="sec010">Discussion</xref> above and vignette/manual provided with our R package).</p>
<p>When comparing two conditions for changes in an inferred quantity (either the parameter such as σ or a function of the parameters such as average overall expression of single-cells specified above as the log mean of <italic>G</italic>), we reduced the joint posterior distribution of the quantity in both conditions into a P-value. We chose to report P-values, instead of other hypotheses comparison measures such as the Bayes factor, to facilitate interpretation by researchers more familiar with classical “frequentist” statistical notions and to permit us to adjust P-values of all tested genes to account for multiple testing (using the Benjamini-Hochberg FDR procedure). We specifically converted the posterior probability that a parameter/variable in one condition is different than that in another condition to a P-value using a half-space approach [<xref ref-type="bibr" rid="pcbi.1005016.ref028">28</xref>]; this approach requires specification or estimation of the proportion of null hypotheses among all tested genes and we specify it conservatively at 100%. Several strengths of MCMC-based Bayesian inference are at play here in comparative assessment of heterogeneity in different conditions:</p>
<list list-type="order">
<list-item><p>We are making inference about parameters of interest (<italic>π</italic>, <italic>μ</italic> and <italic>σ</italic>) in two conditions by averaging over uncertainty in the “nuisance” parameters related to detection behavior in a consistent fashion in both conditions (i.e., each MCMC sample is an eight-parameter configuration with detection parameters tied consistently to the same value across both conditions).</p></list-item>
<list-item><p>Posterior samples of the inferred parameters can be used to obtain posterior distribution of any function of the parameters, thereby allowing us to assess quantities such as the Shannon entropy based on the fraction of ON cells or the average overall expression of the entire cell population.</p></list-item>
<list-item><p>Bayesian approach provides a systematic way to incorporate <italic>a priori</italic> information available for any parameter (for instance, detection behavior parameters derived from a dilution-series experiment). For this study, we focused on non-informative priors to broaden the applicability of our strategy to settings where information from such <italic>a priori</italic> pilot experiments are not available.</p></list-item>
</list>
</sec>
<sec id="sec015">
<title>Macrophage single/10-cell data generation, normalization and downsampling</title>
<p>CD14+CD16- human peripheral blood monocytes were purified to &gt;98% purity by magnetic bead negative selection (Dynabeads Monocyte selection kit, Invitrogen, Carlsbad, CA). These monocytes were aliquoted and frozen in 10% DMSO, 40% human serum, and 50% X-vivo 15. Frozen monocytes were thawed and differentiated into macrophages by <italic>in vitro</italic> culture on tissue culture-treated plastic dishes in X-Vivo-15 media (Lonza, Walkersville, MD) supplemented with 100 ng/mL macrophage-colony stimulating factor (M-CSF, R&amp;D Systems, Minneapolis, MN) treatment over a period of 6 days with a full media change and M-CSF re-addition at day 3 and day 6. Fresh media on day 6 was supplemented with M-CSF + 100 ng/mL Interferon (IFN)γ and 100 ng/mL Tumor necrosis factor α (IFNγ+TNFα or IFNT; both from Peprotech, Rocky Hill, NJ), or M-CSF alone (Control or CNT). Cells were harvested for analysis 24 hours after treatment (day 7 of differentiation) by scraping in cold media.</p>
<p>We used fluorescence activated cell sorting (FACS) on a BD FACS-Aria II (Becton-Dickinson, Mountain View, CA) to sort single and ten cells into individual wells of 96-well low-profile PCR plates (Bio-rad, Richmond, CA) followed by reverse transcription and 18 cycles of specific-target pre-amplification using Celldirect one-step RT-PCR kit (Invitrogen). Preamplified cDNA was quantified using microfluidic qPCR (Taqman probe-based qPCR assays (Life Technologies, Carlsbad, CA) targeting 93 gene transcripts (selected based on their relevance in macrophage activation and core cellular processes (e.g., metabolism, RNA processing, core transcriptional and translational regulators) as well as representative genes from modules of co-expressed transcripts having myeloid-enriched expression patterns obtained using published gene expression data [<xref ref-type="bibr" rid="pcbi.1005016.ref029">29</xref>]) and three spike-in artificial control RNAs from the ERCC spike-in set (Life Technologies)) to comparatively assess cell-to-cell expression heterogeneity of human macrophages between CNT and IFNT conditions. The single-cell and 10-cell samples in each condition were profiled in four Fluidigm 96.96 plates (Fluidigm Corporation, South San Francisco, CA). To reduce technical confounding when comparing single cell responses between conditions, we FACS sorted cells from each of the conditions (CNT and IFNT conditions, as well as two other conditions from a related study) using a balanced distribution across multiple 96-well plates, followed by qPCR profiling.</p>
<p>QPCR was performed on a Fluidigm Biomark instrument using the normal speed cycling gene expression protocol. Data was exported from Fluidigm Real-time PCR Analysis software version 3.1.3, using Linear (Derivative) Baseline method, a global threshold of 0.01, and a 0.65 quality threshold, parameters which were found to exclude non-specific amplification and reduce plate-to-plate variation. We converted gene expression data exported from Fluidigm Real-time PCR Analysis software from Ct (Cycle threshold) units to the more convenient Et = 40-Ct units, as in previous studies [<xref ref-type="bibr" rid="pcbi.1005016.ref007">7</xref>], so that transcript copy counts can be approximated by 2<sup><italic>Et</italic></sup> values upto a scaling factor as assumed in our model. Even if this copy count assumption does not hold exactly (or even approximately) for certain gene assays due to less than 100% qPCR efficiency, the model assessments performed after our MCMC-based Bayesian inference should automatically exclude such problematic assays. In the future, we could recover such gene assays if we know their qPCR efficiency (e.g., based on independent titration standards experiments) and use it to derive the copy counts instead of the 100% efficiency that is often assumed. We assigned samples where a gene is not detected an Et of–Infinity, and called them as non-detected samples (non-detects). After excluding samples with fewer than 10% of all assayed genes detected (as they may reflect wells that failed to amplify or receive a sorted cell), we had 84 single-cell and 88 10-cell samples available per condition for downstream analysis.</p>
<p>Since the single and 10-cell pool samples in CNT and IFNT conditions (along with samples in the two other conditions from a related study) had to be spread across 8 Fluidigm plates, all of which could not be run at the exact same time, we used spiked-in ERCC control RNA levels to track and correct for potential batch/plate effects. The ERCC control RNA were added at the same concentration to all the wells of each 96-well sorting plate prior to cell sorting, and we normalized all detected (i.e., Et &gt; 0) gene measurements using the plate median of the ERCC spike-in with the highest Et value (ERCC-0003). In detail, we shifted all detected gene measurements in a plate by a plate-specific global factor, which is chosen such that the median ERCC-0003 level of the shifted data across all (non-standard) samples in the plate becomes the same across all plates. After removing plate effects using this plate-level normalization, the different plates’ data are concatenated to obtain one single/10-cell dataset per experiment.</p>
<p>In certain analyses where we had to compare the precision of SCKC against SC or KC (<xref ref-type="fig" rid="pcbi.1005016.g003">Fig 3</xref>), to ensure the same sample size (n = 80) across all three methods, we first randomly downsample the 84 single- and 88 ten-cell samples available per condition to 80 samples each per condition, and then run SCKC method on a random half of the single-cell and a random half of the 10-cell samples (repeating this random halving ten times to inspect run-to-run variation), and SC or KC method on all single- or all 10-cell samples respectively.</p>
</sec>
<sec id="sec016">
<title>RNA-seq data generation, processing and DE analysis</title>
<p>Note that to obtain the bulk population-level log<sub>2</sub>(FC) values, data from a related study was used. Similar experimental setup as described for generating our Fluidigm qPCR data was used to obtain and differentiate cells from donors, but instead of using qPCR on single- and 10-cell samples in CNT or IFNT (24 hour post stimulation) conditions, we analyzed bulk RNA material in CNT or IFNT (18 hours post stimulation) conditions from three different human donors using the Illumina TruSeq Ribozero RNA-Seq protocol with 500ng of total RNA according to manufacturer’s instructions. Standard RNA-Seq data analysis methods were used: Tophat2 [<xref ref-type="bibr" rid="pcbi.1005016.ref030">30</xref>] for splice-aware mapping, featureCounts [<xref ref-type="bibr" rid="pcbi.1005016.ref031">31</xref>] for counting reads mapped to gene exons, and DESeq2 [<xref ref-type="bibr" rid="pcbi.1005016.ref032">32</xref>] to perform the DE test and generate the log<sub>2</sub>(FC) values using the design”<italic>gene expression ~ Donor + Treatment</italic>” in R’s formula notation.</p>
</sec>
<sec id="sec017">
<title>Identifying differentially expressed (DE) genes using an approximate posterior-free method</title>
<p>We identified DE genes using the posterior probabilities converted to P-values as specified above. As described in the main text, we could also identify DE genes in a model-free or posterior-free fashion by directly testing for changes in k-cell expression mean in both conditions. The idea behind this test is that k-cell data is closer to bulk population-level data than single-cell data, and that bulk data when analyzed using t test or similar tests often is considered to yield more accurate (“ground-truth”) estimates of changes in overall expression of a gene (DE) than single-cell data (though this is not the case for estimating CHPs, where single- and k-cell data are valuable). But this posterior-free method treats all non-detects in the k-cell data as truly zero expression, which may not be valid for some lowly expressed genes or low values of k.</p>
<p>The posterior-free method uses a linear regression model of each gene’s k-cell measurement across two conditions against these dependent variables: <italic>treatment</italic> to model fold change between the two conditions, <italic>ERCC expression</italic> to adjust for potential well effects, and <italic>plate variable</italic> to adjust for potential plate effects. Non-detects are assumed to be have zero expression. In R notation, the linear model is “<italic>k-cell expression of a given gene ~ treatment + ERCC-0002-expression + ERCC-0003-expression + ERCC-0044-expression + plate</italic>”. We extract the P-values of the significance of the <italic>treatment</italic> coefficients (log fold change between two conditions such as IFNT vs. CNT) being different from zero, and adjust them for multiple testing using the Benjamini-Hochberg procedure. Only genes at adjusted P or adjP &lt; 0.05 are declared as DE hits.</p>
</sec>
<sec id="sec018">
<title>Simulation scenarios and posterior surface scanning</title>
<p>We simulated datasets under different levels of biological and technical variation, thereby translating to different levels of difficulty when inferring the true parameters. We first explain this procedure for single-condition simulations and then outline changes to the procedure for comparative two-condition simulations. The mean of ON-cells <italic>μ</italic> is set at 10 Et units in all scenarios, whereas the other parameters are set at</p>
<list list-type="order">
<list-item><p><italic>π</italic> = 0.8, <italic>σ</italic> = 0.5 for the low inference difficulty,</p></list-item>
<list-item><p><italic>π</italic> = 0.5, <italic>σ</italic> = 1.0 for the medium inference difficulty and</p></list-item>
<list-item><p><italic>π</italic> = 0.2, <italic>σ</italic> = 2.0 for the high inference difficulty scenarios.</p></list-item>
</list>
<p>These three biological variation scenarios are illustrated in <xref ref-type="supplementary-material" rid="pcbi.1005016.s001">S1A Fig</xref>.</p>
<p>The detection efficiency of the gene assay as given by the logistic function is also set at three levels. Specifically we set the logistic function’s parameters at:</p>
<list list-type="order">
<list-item><p><italic>c</italic> = <italic>μ</italic> − <italic>σ</italic>, <italic>m</italic> = <italic>σ</italic>/4 for a good assay that detects 82% of single-cell samples on average,</p></list-item>
<list-item><p><italic>c</italic> = <italic>μ</italic>, <italic>m</italic> = <italic>σ</italic>/4 for a medium assay that detects 50% of single-cell samples on average, and</p></list-item>
<list-item><p><italic>c</italic> = <italic>μ</italic> + <italic>σ</italic>, <italic>m</italic> = <italic>σ</italic>/4 for a bad assay that detects 18% of single-cell samples on average.</p></list-item>
</list>
<p>These settings of the logistic “assay” leads to negligible loss of k-cell samples on average, since the mean k-cell expression is k-fold higher than mean single-cell expression and the slope <italic>m</italic> of the logistic function is set above such that the detection probability changes from 0 to 100% in a steep fashion as a function of the increasing expression strength. Note that this likely favors the k-cell only approach when comparing its performance against our single/k-cell strategy (since assay drop-offs may occur for certain genes in real k-cell data when k is smaller). Larger values of <italic>m</italic> that lead to a more gradual increase in detection probability with expression increase (and hence drop-off or loss in both single/k-cell samples) could also be tested for simulations in future, if dilution standards experiments of typical gene assays have this detection behavior.</p>
<p>Besides noise from imperfect detection of gene transcripts, there could be additional experimental noise when measuring gene expression [<xref ref-type="bibr" rid="pcbi.1005016.ref012">12</xref>]. So we ran our simulations under four realistic configurations of measurement noise and a reference configuration of no additional noise. The four realistic configurations were based on quantitative measures of total technical noise in our experimental setup (encompassing all noise sources such as efficiency, amplification and sampling noise [<xref ref-type="bibr" rid="pcbi.1005016.ref012">12</xref>]) derived from a dilution series experiment conducted alongside our macrophage single/k-cell experiments. This titration data exhibited similar patterns of dependency between the level of total noise and mean expression (<xref ref-type="supplementary-material" rid="pcbi.1005016.s001">S1B Fig</xref>) as previously observed [<xref ref-type="bibr" rid="pcbi.1005016.ref012">12</xref>], and thereby helped select these noise settings:</p>
<list list-type="order">
<list-item><p>[C0.5] Constant white noise sampled from a Gaussian distribution with a mean 0 and standard deviation (std) of 0.5 Et is added to the simulated Et value of detected single/k-cell expression samples (the “detects” simulated under one of the “3 biological variation x 3 assay sensitivity” scenarios above). This scenario is representative of noise characteristics of highly expressed genes in our experiment, whose measurements exhibit similar noise levels in both single- and k-cell measurements (the plateau region in <xref ref-type="supplementary-material" rid="pcbi.1005016.s001">S1B Fig</xref>, with 0.5 Et chosen for std to represent gene assays that are more challenging than the median gene in the figure with 0.25 Et noise levels).</p></list-item>
<list-item><p>[C1] Constant white noise of std = 1 Et is added to test how the different methods behave under high levels of noise.</p></list-item>
<list-item><p>[T0.5,0.25] A two-step noise that adds a white noise of std = 0.5 Et to single-cell detects and std = 0.25 Et to k-cell detects. This corresponds to the transition in <xref ref-type="supplementary-material" rid="pcbi.1005016.s001">S1B Fig</xref> and captures the notion that single-cell samples are typically measured with higher technical noise than k-cell samples due to lower transcript levels in the former. Please note that since the mean-noise relation in <xref ref-type="supplementary-material" rid="pcbi.1005016.s001">S1B Fig</xref> can differ substantially from gene to gene (and was extrapolated to expression levels not observed in the experiment), we opted to employ a simpler two-step noise configuration instead of the observed mean-noise relation to account for these uncertainties.</p></list-item>
<list-item><p>[T1,0.5] Another two-step noise that adds a white noise of std = 1 Et to single-cell detects and std = 0.5 Et to k-cell detects.</p></list-item>
<list-item><p>[No white noise] Reference configuration that adds no additional noise to single/k-cell detects.</p></list-item>
</list>
<p>We simulate single-cell/k-cell data (SC/KC) under any of the above “3 biological variation x 3 assay sensitivity x 5 noise configuration” scenarios = 45 settings using our model, and infer back the true values using only the simulated data. We could have used our MCMC procedure for inference, but wanted to rule out potential differences in the MCMC convergence behavior of the SC, KC or SCKC approaches from confounding the intrinsic differences among these methods. So we opted for a simpler posterior surface scanning procedure that involved computing the posterior in each combination of the parameter values listed below and using this coarse grid of likelihood values to approximate the posterior distribution and calculate its mode and 90% CrI (credible interval) reported in <xref ref-type="fig" rid="pcbi.1005016.g002">Fig 2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005016.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005016.s003">S3</xref> Figs discussed in the main text. The posterior surface is scanned at the grid points defined by these parameter values:</p>
<list list-type="order">
<list-item><p>Vary π from 0 to 1 in steps of 0.02.</p></list-item>
<list-item><p>Vary μ from 0 to 40 in in steps of 1 Et unit.</p></list-item>
<list-item><p>Vary σ from 0 to 5 in steps of 0.1 Et unit.</p></list-item>
<list-item><p>Set c,m to the true value, since we assume it is known to the inference procedure. This is a realistic assumption since data from titration experiments of known mRNA inputs can be used to independently determine these parameters.</p></list-item>
</list>
<p>Note that the posterior (derived from single-cell or Fenton-Wilkinson approximated k-cell likelihoods) is a function of just the five parameters above and not of any additional measurement noise configuration parameter, since our model is unaware of the additional measurement noise added to simulated data.</p>
<p>We performed the comparative two-condition simulations similar to the single-condition simulations described above (e.g., under the same 3 assay sensitivity and 5 noise configuration settings), but with the following changes. Since we need to assess the performance of different methods in identifying changes in heterogeneity parameters between two conditions (as opposed to inferring the parameter values within one condition as in the three single-condition biological variation scenarios), we now tested three comparative scenarios. A gene has</p>
<list list-type="order">
<list-item><p>80% vs. 50% ON cells (<italic>π</italic> of 0.8 vs. 0.5) between the two conditions,</p></list-item>
<list-item><p><italic>π</italic> of 0.6 vs. 0.4, and</p></list-item>
<list-item><p><italic>π</italic> of 0.5 vs. 0.2.</p></list-item>
</list>
<p>In all these scenarios, the ON cells have a mean (<italic>μ</italic>) of 10 Et and a standard deviation (<italic>σ</italic>) of 1 Et in both conditions, so that both conditions are simulated using an assay with the same logistic detection behavior (note that the logistic parameters in our simulations are derived from <italic>μ</italic>, <italic>σ</italic> as described above). Grid-based posterior scan is now run separately on both conditions of a simulated gene to approximate the posterior distribution of a parameter in each condition, and the two resulting distributions jointly analyzed to approximate the posterior of the difference in the parameter between the conditions. Relevant code snippets implementing the single/two-condition simulations are provided (see Data Availability for download URL).</p>
</sec>
</sec>
<sec id="sec019">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005016.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Inference difficulty and measurement noise of simulation scenarios.</title>
<p>Three levels of inference difficulty were used for single-condition simulations and four configurations of measurement noise (and one more configuration of no noise) were used for both single- and two-condition simulations. These configurations, in combination with different assay sensitivity (detection) settings, yield the diverse simulation scenarios employed to compare the performance of SC, KC and SCKC methods. A. Levels of inference difficulty when simulating gene expression profiles. Low inference difficulty simulation scenario for instance corresponds to a gene with a high fraction of ON cells with tight expression distribution. B. Measurement noise configurations when simulating gene expression profiles. Technical noise vs. average expression relationship observed in a dilution-series experiment was used to define the four realistic noise configurations for the simulation analyses. The estimate of total technical noise (including amplification, efficiency and sampling noise) when measuring different genes (different colored lines) at different dilutions of a standard bulk mRNA sample is shown. The average expression of the gene (x axis) is plotted against the standard deviation of the technical replicate measurements (y axis). The dilution series experiment was done using bulk mRNA pooled from human macrophages residing in diverse conditions in a related study—a total of seven dilutions were performed spanning a range of medium to high mRNA concentrations, and each dilution had eight technical replicates (except for one dilution which had only seven replicates due to an outlying measurement). Only genes that pass our quality control criteria are shown here: 1) The gene must exhibit a range of detection behaviors along the standard curve, or specifically its non-detect frequency should be at least 0.7 at the lowest concentration and at most 0.1 at the highest concentration (with the concentrations with zero or unity non-detect frequencies ignored for further analysis), and 2) the measured non-detect frequency and Et value of the gene at different concentrations should be concordant, or specifically the baseline Et value corresponding to single transcript copy detection (estimated using Poisson statistics from both the non-detect frequency and measured Et value at each concentration as in digital PCR or digital RNA-Seq (Grün et al. 2014, Nat. Methods 11, 637–640 [<xref ref-type="bibr" rid="pcbi.1005016.ref012">12</xref>]) should not vary by more than 0.5 standard deviation units across different concentrations. Note that this baseline Et value estimate, averaged across different concentrations, is subtracted from the average measured Et value of a gene at every concentration to obtain the average gene expression shown in x axis. Also shown is a local regression fit along with its 95% confidence level band (visualized using R package <italic>ggplot2</italic>’s stat_smooth function with default options).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005016.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>SC <italic>vs</italic>. KC <italic>vs</italic>. SCKC performance for single-condition simulations.</title>
<p>Single-condition simulation results for sample size n = 1000 shown in main text <xref ref-type="fig" rid="pcbi.1005016.g002">Fig 2</xref> is repeated here, but additional results on KC vs. SC comparison and additional simulation scenarios pertaining to medium inference difficulty and medium assay sensitivity are shown. All other aspects of this figure including x/y-axis format are same as main text <xref ref-type="fig" rid="pcbi.1005016.g002">Fig 2</xref> - for instance, parameter inferences (posterior mode and 90% CrI (Credible Interval) based on a grid-based posterior scan) were made for ten simulated datasets (sample size n = 1000) and averaged before display for each simulation scenario and method. Guide to understand the plots is also shown alongside the legends. A. Simulation results for single-condition parameter inferences, where each dot corresponds to an inferred parameter for a gene simulated under one condition according to a simulation scenario. Note that SC provides worse estimates than SCKC or KC under all noise configurations for most of the high-difficulty scenarios (red symbols), and better estimates with lower error particularly for σ in some noise settings for the medium/low-difficulty scenarios (blue/green symbols); but this advantage of SC disappears in a two-condition, comparative simulation setup (<xref ref-type="supplementary-material" rid="pcbi.1005016.s003">S3 Fig</xref>) where error in the two conditions tend to cancel out (<xref ref-type="supplementary-material" rid="pcbi.1005016.s004">S4 Fig</xref>). B. Simulation results shown in (A) are copied here, but the shapes of dots (simulation scenario genes) now indicate measurement noise configuration instead of assay sensitivity of the simulation scenarios.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005016.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>SC <italic>vs</italic>. KC <italic>vs</italic>. SCKC performance for two-condition simulations.</title>
<p>Simulation results for sample size n = 1000 on assessing CHP differences between two conditions under different assay sensitivity and noise configurations. This figure is similar to the above <xref ref-type="supplementary-material" rid="pcbi.1005016.s002">S2 Fig</xref> in its x/y-axis format and legend, except that the estimate of the parameter difference between two conditions is shown here instead of the single-condition parameter estimate. Guide to understand the plots is also shown alongside the legends. A. Simulation results for the comparative two-condition parameter inferences, where each dot corresponds to condition-specific change in inferred parameter for a gene simulated under two conditions according to a simulation/comparison scenario. Note that SCKC performs comparable to KC in most settings, with better performance for large k (lighter symbols), similar to what was observed in the single-condition simulations but to a lesser extent (in terms of absolute error advantages, since errors in both conditions tend to cancel out in a comparative analysis as shown in <xref ref-type="supplementary-material" rid="pcbi.1005016.s004">S4 Fig</xref>). B. Simulation results shown in (A) are copied here, but the shapes of dots (simulation/comparison scenario genes) now indicate measurement noise configuration instead of assay sensitivity of the simulation scenarios. This shows for instance that KC is better than SCKC in the T0.5,0.25 noise setting where a very low amount of measurement noise is added to the k-cell data.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005016.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Bias/error in parameter estimates in two- <italic>vs</italic>. one- condition simulation settings.</title>
<p>Error in parameter estimates is significantly mitigated in two-condition compared to one-condition simulation settings, particularly for the σ parameter. The x-axis is showing the absolute error of a parameter (difference between its inferred and true value), averaged across both conditions and all ten simulation runs; the y-axis is showing the absolute error of the parameter difference between the two conditions, averaged across all ten simulation runs. Both x- and y- axis are divided (scaled) by the true value of the parameter difference between the two conditions (if non-zero).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005016.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>SC <italic>vs</italic>. KC <italic>vs</italic>. SCKC precision comparisons at similar bias/error on real data.</title>
<p>Experimental data were generated from untreated (CNT) and IFN+TNF-treated (IFNT) human macrophages, and the three methods assessed on this data. Density plots of parameter inferences for all gene-condition combinations (GCCs) successfully modeled by all three assessed methods are shown. Each plot compares the performance of the two indicated methods as follows: The x-axis indicates the difference in the two methods’ estimates (posterior means); the y-axis is the difference in the CrI width of the two methods’ estimates; and both x- and y- axis values are divided (scaled) by the average parameter estimate if non-zero (specifically posterior mean estimate, averaged across SC, KC and SCKC methods, and used in place of the unknown true parameter value). To compare two methods when ground truth is not known (see also text), we only consider GCCs whose parameter estimates are similar between the compared methods (shown as red dots within the x = -0.2 to 0.2 red band i.e., GCCs whose estimates by the two methods differ by less than 20% of the average parameter estimate). Shown alongside are the histogram of red dots and the (method1 vs method2) percentages indicating the percentage of GCCs inside the red band whose method1 (or method2) CrI is tighter than that of the other method by at least the same band width of 0.2 units (these histograms and percentages are also shown in main text <xref ref-type="fig" rid="pcbi.1005016.g003">Fig 3A</xref>, as the same downsampling for SCKC chosen in <xref ref-type="fig" rid="pcbi.1005016.g003">Fig 3A</xref> is chosen here as well).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005016.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Comparison of QVARKS, MAST and SCDE methods on differential expression (DE).</title>
<p>Different methods were applied on our macrophage IFNT vs. CNT data and evaluated by checking if their estimated log<sub>2</sub>-fold-change (log<sub>2</sub>(FC)) in average gene expression between IFNT vs. CNT conditions are correlated (A-B) or close (C-D) to the “ground truth” log<sub>2</sub>(FC) estimated from bulk RNA-Seq data. These correlations are shown for different values of bulk RNA-Seq log<sub>2</sub>(FC) cutoffs (x axis) (i.e., for each cutoff value, the correlation is only computed across the starting set of genes that satisfy “abs(bulk log<sub>2</sub>(FC)) ≤ cutoff”). We similarly compute the closeness to true values, quantified conversely by the average squared error (square of the difference between the bulk RNA-Seq log<sub>2</sub>(FC) value and the log<sub>2</sub>(FC) value estimated by a given method, averaged across the genes under consideration). We first evaluate all methods using a starting set of 55 genes that have more than 5 observed ON cells in both conditions (the “ON-cells filter” that ensures sufficient data is available to estimate QVARKS parameters). We also evaluate our QVARKS methods on other starting gene sets obtained by combining the “ON-cells filter” with two other filters: i) genes whose log<sub>2</sub>(FC) CrI width estimated by our method is at most 5 units, so that the point estimate of DE used in these comparisons are reliable, and ii) genes that passed our AD-test based model assessment criteria. A. QVARKS SCKC and KC correlation to bulk RNA-Seq DE is comparable to that of MAST and SCDE across all scenarios, and QVARKS SC performs comparable to other methods once CrI filter is used to remove genes with large uncertainty in their estimates. B. QVARKS SCKC correlation to bulk RNA-Seq DE using ten random 50% downsamplings of the dataset (the same downsamplings as in main text <xref ref-type="fig" rid="pcbi.1005016.g003">Fig 3</xref> to make QVARKS SCKC the same sample size as QVARKS SC or KC) shows the extent of run-to-run or sampling variation in our DE performance metric. C. Same as (A) but showing average squared error instead of Pearson correlation. All input modes of QVARKS perform better than MAST and SCDE. D. Same as (B) but showing average squared error instead of Pearson correlation.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005016.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Checking the concordance of single-/10-cell average expression.</title>
<p>Average expression derived from single-cell data tended to be consistently lower than that obtained from 10-cell data (divided by 10) for transcripts expressed at medium or low levels. Note that average expression here refers to average of the 2<sup>Et</sup> measurement values, after assuming non-detects as zero expression (i.e., setting their 2<sup>Et</sup> to 0).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005016.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Posterior-based vs. posterior-free differential expression.</title>
<p>For the genes successfully modeled in both IFNT and CNT conditions by our approach, we show the log<sub>2</sub> fold change of their bulk/overall mean expression between the two conditions and the list of significant differentially expressed (DE) genes at adjusted P &lt; 0.05, as determined by two methods. Though the DE results from both methods are not expected to be exactly equal (as explained in Methods), the concordance between them as shown here reinforces each method’s discoveries.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005016.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Changes in heterogeneity parameters are largely robust against well-to-well technical noise.</title>
<p>We augmented our method with an additional pre-processing/normalization step that accounts for one of the key noise sources: well-to-well variation in sampling efficiency (inspired by the “Model 1” strategy used in (Grün et al. 2014, Nat. Methods 11, 637–640 [<xref ref-type="bibr" rid="pcbi.1005016.ref012">12</xref>])). This normalization involved inferring this noise using the Et values of three ERCC control mRNAs spiked in at the same concentration across wells, and then removing the effect of this noise from the data and applying our Bayesian inference procedure on the corrected data. A. Technical factors contributed to well-to-well variations. The mean Et value of the three control ERCC spike-in mRNAs is significantly correlated with the median of highly expressed genes across wells, both within and across plates, suggesting that well-to-well differences in the starting amount of mRNA, or sampling efficiency, or other related technical factors likely contributed substantially to well-to-well variations. This plot also shows that the magnitude of this particular noise is not large in our data. Here a highly expressed gene is defined as a gene with non-zero expression level in at least 90% of all single/k-cell samples measured in either condition. Also shown are robust linear regression fits along with 95% confidence level bands (visualized using R package <italic>ggplot2</italic>’s stat_smooth function with “rlm” method and default options). B. The changes in parameter estimates between IFNT vs. CNT are largely similar before or after performing the new per-well normalization designed to remove well-to-well variations shown in (A) (the black line is the x = y diagonal line). This comparison is done using the 39 overlapping genes out of the 41 and 47 genes passing model assessment (in both CNT and IFNT conditions) in our macrophage data before and after performing the per-well normalization respectively. Note that the per-well normalization factor subtracted from each gene measurement within a well is a weighted sum of the three ERCC levels in the well, where the weights are the corresponding coefficients of a linear regression model fitted separately for single/k-cell data in each condition (in R notation: “Median expression of highly expressed genes ∼ ERCC-0002 + ERCC-0003 + ERCC-0044”).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005016.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.s010" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Alternate notions of discrete heterogeneity.</title>
<p>The Shannon entropy function computed using π (entropy(π) = −π log<sub>2</sub>(π) − (1 − π)log<sub>2</sub>(1 − π)) captures the intuitive notion that a cell population containing a balanced number of ON and OFF cells is more heterogeneous than another where almost all cells are ON or almost all are OFF. A. Inferred alterations in entropy in IFNT treatment relative to CNT is shown for the genes successfully modeled in both conditions. The 23 differentially expressed genes identified using overall expression changes, along with whether they are increased or decreased, is also indicated. The 90% Crl is indicated by the lightly shaded lines around the mean of the posterior distribution. B. Genes with significant (adjP &lt; 0.05) changes in entropy between the conditions (and gene RELA) are shown along the entropy function’s curve.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005016.s011" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.s011" xlink:type="simple">
<label>S11 Fig</label>
<caption>
<title>Mean-variation relationship and related checks.</title>
<p>Linear regression fit of changes in continuous variation (σ) as a function of changes in the average expression among ON cells (µ; A) or ON rate (π; B) between IFNT and CNT conditions using the genes successfully modeled in both conditions. For genes with significant alterations in σ (from main text <xref ref-type="fig" rid="pcbi.1005016.g006">Fig 6A</xref> and labeled here), changes in σ cannot simply be explained by differences in μ or π between the conditions. Confidence bands around the linear regression fits are at 95% confidence level (and visualized using R package <italic>ggplot2</italic>’s stat_smooth function with “lm” method and default options).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005016.s012" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005016.s012" xlink:type="simple">
<label>S12 Fig</label>
<caption>
<title>Robustness of Differential Heterogeneity (DH).</title>
<p>For genes with significant alterations in σ (DH genes from main text <xref ref-type="fig" rid="pcbi.1005016.g006">Fig 6A</xref>, with adjusted Pvalues reported here), difference in σ was non-zero for many of the ten random 50% downsamplings of the dataset (the same downsamplings as in main text <xref ref-type="fig" rid="pcbi.1005016.g003">Fig 3</xref>). Also shown here for comparison are the inferences made by QVARKS on two non-overlapping subsets of the data: single-cell (SC) samples alone vs. k-cell (KC) samples alone. The 90% Crl is indicated by the line around the mean of the posterior distribution.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Yong Lu for numerous discussions, Thorsten Prustel and Vinod Prabhakaran for valuable inputs, Katherine Wendelsdorf for help with qPCR gene panel design, all members of SGBU (Systems Genomics and Bioinformatics Unit) for feedback and discussion, Ronald Germain for critical reading of the manuscript, as well as Cal Eigsti and Kevin Holmes (Flow Cytometry Core, NIAID Research Technology Branch) for assisting with cell sorting.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005016.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Islam</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kjällquist</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Moliner</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zajac</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Fan J-</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Lönnerberg</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Characterization of the single-cell transcriptional landscape by highly multiplex RNA-seq</article-title>. <source>Genome Res</source>. <year>2011</year>;<volume>21</volume>: <fpage>1160</fpage>–<lpage>1167</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.110882.110" xlink:type="simple">10.1101/gr.110882.110</ext-link></comment> <object-id pub-id-type="pmid">21543516</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jaitin</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Kenigsberg</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Keren-Shaul</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Elefant</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Paul</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Zaretsky</surname> <given-names>I</given-names></name>, <etal>et al</etal>. <article-title>Massively Parallel Single-Cell RNA-Seq for Marker-Free Decomposition of Tissues into Cell Types</article-title>. <source>Science</source>. <year>2014</year>;<volume>343</volume>: <fpage>776</fpage>–<lpage>779</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1247651" xlink:type="simple">10.1126/science.1247651</ext-link></comment> <object-id pub-id-type="pmid">24531970</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwanhäusser</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Busse</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Dittmar</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Schuchhardt</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wolf</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Global quantification of mammalian gene expression control</article-title>. <source>Nature</source>. <year>2011</year>;<volume>473</volume>: <fpage>337</fpage>–<lpage>342</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature10098" xlink:type="simple">10.1038/nature10098</ext-link></comment> <object-id pub-id-type="pmid">21593866</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marinov</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>McCue</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Schroth</surname> <given-names>GP</given-names></name>, <name name-style="western"><surname>Gertz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>RM</given-names></name>, <etal>et al</etal>. <article-title>From single-cell to cell-pool transcriptomes: Stochasticity in gene expression and RNA splicing</article-title>. <source>Genome Res</source>. <year>2013</year>; <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.161034.113" xlink:type="simple">10.1101/gr.161034.113</ext-link></comment> <object-id pub-id-type="pmid">24299736</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Klein</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Mazutis</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Akartuna</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Tallapragada</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Veres</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>V</given-names></name>, <etal>et al</etal>. <article-title>Droplet Barcoding for Single-Cell Transcriptomics Applied to Embryonic Stem Cells</article-title>. <source>Cell</source>. <year>2015</year>;<volume>161</volume>: <fpage>1187</fpage>–<lpage>1201</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2015.04.044" xlink:type="simple">10.1016/j.cell.2015.04.044</ext-link></comment> <object-id pub-id-type="pmid">26000487</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brennecke</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Anders</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Kołodziejczyk</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Proserpio</surname> <given-names>V</given-names></name>, <etal>et al</etal>. <article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title>. <source>Nat Methods</source>. <year>2013</year>;<volume>10</volume>: <fpage>1093</fpage>–<lpage>1095</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2645" xlink:type="simple">10.1038/nmeth.2645</ext-link></comment> <object-id pub-id-type="pmid">24056876</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McDavid</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Finak</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Chattopadyay</surname> <given-names>PK</given-names></name>, <name name-style="western"><surname>Dominguez</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lamoreaux</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>SS</given-names></name>, <etal>et al</etal>. <article-title>Data exploration, quality control and testing in single-cell qPCR-based gene expression experiments</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>: <fpage>461</fpage>–<lpage>467</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts714" xlink:type="simple">10.1093/bioinformatics/bts714</ext-link></comment> <object-id pub-id-type="pmid">23267174</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McCall</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>McMurray</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Land</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Almudevar</surname> <given-names>A</given-names></name>. <article-title>On non-detects in qPCR data</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>: <fpage>2310</fpage>–<lpage>2316</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu239" xlink:type="simple">10.1093/bioinformatics/btu239</ext-link></comment> <object-id pub-id-type="pmid">24764462</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McDavid</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dennis</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Danaher</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Finak</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Krouse</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Modeling Bi-modality Improves Characterization of Cell Cycle on Gene Expression in Single Cells</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>: <fpage>e1003696</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003696" xlink:type="simple">10.1371/journal.pcbi.1003696</ext-link></comment> <object-id pub-id-type="pmid">25032992</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vallejos</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Marioni</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>S</given-names></name>. <article-title>BASiCS: Bayesian Analysis of Single-Cell Sequencing Data</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>: <fpage>e1004333</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004333" xlink:type="simple">10.1371/journal.pcbi.1004333</ext-link></comment> <object-id pub-id-type="pmid">26107944</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kharchenko</surname> <given-names>PV</given-names></name>, <name name-style="western"><surname>Silberstein</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Scadden</surname> <given-names>DT</given-names></name>. <article-title>Bayesian approach to single-cell differential expression analysis</article-title>. <source>Nat Methods</source>. <year>2014</year>;<volume>11</volume>: <fpage>740</fpage>–<lpage>742</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2967" xlink:type="simple">10.1038/nmeth.2967</ext-link></comment> <object-id pub-id-type="pmid">24836921</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Grün</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kester</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>van Oudenaarden</surname> <given-names>A</given-names></name>. <article-title>Validation of noise models for single-cell transcriptomics</article-title>. <source>Nat Methods</source>. <year>2014</year>;<volume>11</volume>: <fpage>637</fpage>–<lpage>640</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2930" xlink:type="simple">10.1038/nmeth.2930</ext-link></comment> <object-id pub-id-type="pmid">24747814</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Janes</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Wang C-</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Holmberg</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Cabral</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Brugge</surname> <given-names>JS</given-names></name>. <article-title>Identifying single-cell molecular programs by stochastic profiling</article-title>. <source>Nat Methods</source>. <year>2010</year>;<volume>7</volume>: <fpage>311</fpage>–<lpage>317</lpage>. 42 <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1442" xlink:type="simple">10.1038/nmeth.1442</ext-link></comment> <object-id pub-id-type="pmid">20228812</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Janes</surname> <given-names>KA</given-names></name>. <article-title>Stochastic profiling of transcriptional regulatory heterogeneities in tissues, tumors and cultured cells</article-title>. <source>Nat Protoc</source>. <year>2013</year>;<volume>8</volume>: <fpage>282</fpage>–<lpage>301</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nprot.2012.158" xlink:type="simple">10.1038/nprot.2012.158</ext-link></comment> <object-id pub-id-type="pmid">23306461</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bajikar</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Fuchs</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Roller</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Theis</surname> <given-names>FJ</given-names></name>, <name name-style="western"><surname>Janes</surname> <given-names>KA</given-names></name>. <article-title>Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles</article-title>. <source>Proc Natl Acad Sci</source>. <year>2014</year>;<volume>111</volume>: <fpage>E626</fpage>–<lpage>E635</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1311647111" xlink:type="simple">10.1073/pnas.1311647111</ext-link></comment> <object-id pub-id-type="pmid">24449900</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Raj</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>van Oudenaarden</surname> <given-names>A</given-names></name>. <article-title>Nature, nurture, or chance: stochastic gene expression and its consequences</article-title>. <source>Cell</source>. <year>2008</year>;<volume>135</volume>: <fpage>216</fpage>–<lpage>226</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2008.09.050" xlink:type="simple">10.1016/j.cell.2008.09.050</ext-link></comment> <object-id pub-id-type="pmid">18957198</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eldar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Elowitz</surname> <given-names>MB</given-names></name>. <article-title>Functional roles for noise in genetic circuits</article-title>. <source>Nature</source>. <year>2010</year>;<volume>467</volume>: <fpage>167</fpage>–<lpage>173</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature09326" xlink:type="simple">10.1038/nature09326</ext-link></comment> <object-id pub-id-type="pmid">20829787</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Finak</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>McDavid</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Yajima</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Deng</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gersuk</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Shalek</surname> <given-names>AK</given-names></name>, <etal>et al</etal>. <article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>. <year>2015</year>;<volume>16</volume>: <fpage>278</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s13059-015-0844-5" xlink:type="simple">10.1186/s13059-015-0844-5</ext-link></comment> <object-id pub-id-type="pmid">26653891</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fan</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Salathia</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kaeser</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Yung</surname> <given-names>YC</given-names></name>, <name name-style="western"><surname>Herman</surname> <given-names>JL</given-names></name>, <etal>et al</etal>. <article-title>Characterizing transcriptional heterogeneity through pathway and gene set overdispersion analysis</article-title>. <source>Nat Methods</source>. <year>2016</year>;<volume>13</volume>: <fpage>241</fpage>–<lpage>244</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.3734" xlink:type="simple">10.1038/nmeth.3734</ext-link></comment> <object-id pub-id-type="pmid">26780092</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schultze</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Schmieder</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Goerdt</surname> <given-names>S</given-names></name>. <article-title>Macrophage activation in human diseases</article-title>. <source>Semin Immunol</source>. <year>2015</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.smim.2015.07.003" xlink:type="simple">10.1016/j.smim.2015.07.003</ext-link></comment> <object-id pub-id-type="pmid">26303100</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shalek</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Satija</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Shuga</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Trombetta</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Gennert</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Single-cell RNA-seq reveals dynamic paracrine control of cellular variation</article-title>. <source>Nature</source>. <year>2014</year>;<volume>510</volume>: <fpage>363</fpage>–<lpage>369</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature13437" xlink:type="simple">10.1038/nature13437</ext-link></comment> <object-id pub-id-type="pmid">24919153</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ellison</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>English</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Burns</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Keer</surname> <given-names>JT</given-names></name>. <article-title>Routes to improving the reliability of low level DNA analysis using real-time PCR</article-title>. <source>BMC Biotechnol</source>. <year>2006</year>;<volume>6</volume>: <fpage>33</fpage>. <object-id pub-id-type="pmid">16824215</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref023"><label>23</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Carlin</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Stern</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Dunson</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Vehtari</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>. <source>Bayesian Data Analysis</source>, <edition>Third Edition</edition>. <publisher-name>CRC Press</publisher-name>; <year>2013</year>.</mixed-citation></ref>
<ref id="pcbi.1005016.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meng</surname> <given-names>X-L</given-names></name>. <article-title>Posterior Predictive p-Values</article-title>. <source>Ann Stat</source>. <year>1994</year>;<volume>22</volume>: <fpage>1142</fpage>–<lpage>1160</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005016.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lawrence</surname> <given-names>T</given-names></name>. <article-title>The nuclear factor NF-kappaB pathway in inflammation</article-title>. <source>Cold Spring Harb Perspect Biol</source>. <year>2009</year>;<volume>1</volume>: <fpage>a001651</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/cshperspect.a001651" xlink:type="simple">10.1101/cshperspect.a001651</ext-link></comment> <object-id pub-id-type="pmid">20457564</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mehta</surname> <given-names>NB</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Molisch</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>J</given-names></name>. <article-title>Approximating a Sum of Random Variables with a Lognormal</article-title>. <source>IEEE Trans Wirel Commun</source>. <year>2007</year>;<volume>6</volume>: <fpage>2690</fpage>–<lpage>2699</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005016.ref027"><label>27</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>MacKay</surname> <given-names>DJC</given-names></name>. <source>Information Theory, Inference and Learning Algorithms</source>. <publisher-loc>Cambridge, UK ; New York</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>; <year>2003</year>.</mixed-citation></ref>
<ref id="pcbi.1005016.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Labbe</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Thompson</surname> <given-names>ME</given-names></name>. <article-title>Multiple testing using the posterior probabilities of directional alternatives, with application to genomic studies</article-title>. <source>Can J Stat</source>. <year>2007</year>;<volume>35</volume>: <fpage>51</fpage>–<lpage>68</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005016.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Novershtern</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Subramanian</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lawton</surname> <given-names>LN</given-names></name>, <name name-style="western"><surname>Mak</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Haining</surname> <given-names>WN</given-names></name>, <name name-style="western"><surname>McConkey</surname> <given-names>ME</given-names></name>, <etal>et al</etal>. <article-title>Densely interconnected transcriptional circuits control cell states in human hematopoiesis</article-title>. <source>Cell</source>. <year>2011</year>;<volume>144</volume>: <fpage>296</fpage>–<lpage>309</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2011.01.004" xlink:type="simple">10.1016/j.cell.2011.01.004</ext-link></comment> <object-id pub-id-type="pmid">21241896</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kim</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Pertea</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Trapnell</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pimentel</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kelley</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Salzberg</surname> <given-names>SL</given-names></name>. <article-title>TopHat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions</article-title>. <source>Genome Biol</source>. <year>2013</year>;<volume>14</volume>: <fpage>R36</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2013-14-4-r36" xlink:type="simple">10.1186/gb-2013-14-4-r36</ext-link></comment> <object-id pub-id-type="pmid">23618408</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Smyth</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>W</given-names></name>. <article-title>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</article-title>. <source>Bioinforma Oxf Engl</source>. <year>2014</year>;<volume>30</volume>: <fpage>923</fpage>–<lpage>930</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btt656" xlink:type="simple">10.1093/bioinformatics/btt656</ext-link></comment> <object-id pub-id-type="pmid">24227677</object-id></mixed-citation></ref>
<ref id="pcbi.1005016.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Love</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Huber</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Anders</surname> <given-names>S</given-names></name>. <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol</source>. <year>2014</year>;<volume>15</volume>: <fpage>550</fpage>. <object-id pub-id-type="pmid">25516281</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>