<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="other" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004763</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-00095</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Topic Page</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Molecular biology assays and analysis techniques</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Molecular biology assays and analysis techniques</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biogeography</subject><subj-group><subject>Phylogeography</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Biogeography</subject><subj-group><subject>Phylogeography</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Earth sciences</subject><subj-group><subject>Geography</subject><subj-group><subject>Biogeography</subject><subj-group><subject>Phylogeography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Phylogeography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Phylogeography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population genetics</subject><subj-group><subject>Phylogeography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Animal genomics</subject><subj-group><subject>Bird genomics</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical mechanics</subject><subj-group><subject>Continuum mechanics</subject><subj-group><subject>Fluid mechanics</subject><subj-group><subject>Fluid dynamics</subject><subj-group><subject>Brownian motion</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Stochastic processes</subject><subj-group><subject>Brownian motion</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Nucleotide sequencing</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Nucleotide sequencing</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov models</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Ancestral Reconstruction</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Joy</surname>
<given-names>Jeffrey B.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Liang</surname>
<given-names>Richard H.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>McCloskey</surname>
<given-names>Rosemary M.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Nguyen</surname>
<given-names>T.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Poon</surname>
<given-names>Art F. Y.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>BC Centre for Excellence in HIV/AIDS, Vancouver, British Columbia, Canada</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>University of British Columbia, Department of Medicine, Vancouver, British Columbia, Canada</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">apoon@cfenet.ubc.ca</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>12</day>
<month>7</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="collection">
<month>7</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>7</issue>
<elocation-id>e1004763</elocation-id>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Joy et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004763"/>
<funding-group>
<funding-statement>The authors of this review were supported in part by an operating grant from the Canadian Institutes for Health Research awarded to AFYP (CIHR HOP111406). In addition, AFYP is supported by a Career Investigator Scholar Award from the Michael Smith Foundation for Health Research, St. Paul's Hospital Foundation and the Providence Health Care Research Institute, and by a CIHR New Investigator Award under the Canadian HIV Vaccine Initiative (CHVI) for Vaccine Discovery and Social Research. RMM was supported by a Vice President Research Undergraduate Student Research Award (VPR USRA) from Simon Fraser University. This work was partly supported by the Bill and Melinda Gates Foundation Award Number OPP1110049. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="1"/>
<page-count count="20"/>
</counts>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Ancestral reconstruction is the extrapolation back in time from measured characteristics of individuals (or populations) to their <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Common_descent" xlink:type="simple">common ancestors</ext-link>. It is an important application of <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Phylogenetics" xlink:type="simple">phylogenetics</ext-link>, the reconstruction and study of the <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Evolution" xlink:type="simple">evolutionary</ext-link> relationships among individuals, populations, or <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Species" xlink:type="simple">species</ext-link> to their ancestors. In the context of <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Biology" xlink:type="simple">biology</ext-link>, ancestral reconstruction can be used to recover different kinds of ancestral character states, including the <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Nucleic_acid_sequence" xlink:type="simple">genetic sequence</ext-link> (ancestral sequence reconstruction), the <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Peptide_sequence" xlink:type="simple">amino acid sequence</ext-link> of a <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Protein" xlink:type="simple">protein</ext-link>, the composition of a <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Genome" xlink:type="simple">genome</ext-link> (e.g., gene order), a measurable characteristic of an organism (phenotype), and the <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Species_distribution" xlink:type="simple">geographic range</ext-link> of an ancestral population or species (ancestral range reconstruction). Nonbiological applications include the reconstruction of the vocabulary or phonemes of <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Ancient_language" xlink:type="simple">ancient languages</ext-link> [<xref ref-type="bibr" rid="pcbi.1004763.ref001">1</xref>] and cultural characteristics of ancient societies such as oral traditions [<xref ref-type="bibr" rid="pcbi.1004763.ref002">2</xref>] or marriage practices [<xref ref-type="bibr" rid="pcbi.1004763.ref003">3</xref>].</p>
<p>Ancestral reconstruction relies on a sufficiently realistic <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Substitution_model" xlink:type="simple">model of evolution</ext-link> to accurately recover ancestral states. No matter how well the model approximates the actual evolutionary history, however, one's ability to accurately reconstruct an ancestor deteriorates with increasing evolutionary time between that ancestor and its observed descendants. Additionally, more realistic models of evolution are inevitably more complex and difficult to calculate. Progress in the field of ancestral reconstruction has relied heavily on the <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Moore%27s_law" xlink:type="simple">exponential growth of computing power</ext-link> and the concomitant development of efficient <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Algorithm" xlink:type="simple">computational algorithms</ext-link> (e.g., a <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Dynamic_programming" xlink:type="simple">dynamic programming</ext-link> algorithm for the joint <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Maximum_likelihood" xlink:type="simple">maximum likelihood</ext-link> [ML] reconstruction of ancestral sequences [<xref ref-type="bibr" rid="pcbi.1004763.ref004">4</xref>]). Methods of ancestral reconstruction are often applied to a given <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Phylogenetic_tree" xlink:type="simple">phylogenetic tree</ext-link> that has already been inferred from the same data. While convenient, this approach has the disadvantage that its results are contingent on the accuracy of a single phylogenetic tree. In contrast, some researchers advocate a more computationally intensive <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Bayesian_statistics" xlink:type="simple">Bayesian</ext-link> approach that accounts for uncertainty in tree reconstruction by evaluating ancestral reconstructions over many trees [<xref ref-type="bibr" rid="pcbi.1004763.ref005">5</xref>].</p>
</sec>
<sec id="sec002">
<title>History</title>
<p>The concept of ancestral reconstruction is often credited to <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Emile_Zuckerkandl" xlink:type="simple">Emile Zuckerkandl</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Linus_Pauling" xlink:type="simple">Linus Pauling</ext-link>. Motivated by the development of techniques for determining the <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Peptide_sequence" xlink:type="simple">primary (amino acid) sequence</ext-link> of proteins by <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Frederick_Sanger" xlink:type="simple">Frederick Sanger</ext-link> in 1955 [<xref ref-type="bibr" rid="pcbi.1004763.ref006">6</xref>], Pauling and Zuckerkandl postulated [<xref ref-type="bibr" rid="pcbi.1004763.ref007">7</xref>] that such sequences could be used to infer not only the phylogeny relating the observed protein sequences but also the ancestral protein sequence at the earliest point (root) of this tree. However, the idea of reconstructing ancestors from measurable biological characteristics had already been developing in the field of <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Cladistics" xlink:type="simple">cladistics</ext-link>, one of the precursors of modern phylogenetics. Cladistic methods, which appeared as early as 1901, infer the evolutionary relationships of species on the basis of the distribution of shared characteristics, of which some are inferred to be descended from common ancestors. Furthermore, <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Theodosius_Dobzhansky" xlink:type="simple">Theodoseus Dobzhansky</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Alfred_Sturtevant" xlink:type="simple">Alfred Sturtevant</ext-link> articulated the principles of ancestral reconstruction in a phylogenetic context in 1938, when inferring the evolutionary history of <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Chromosomal_inversion" xlink:type="simple">chromosomal inversions</ext-link> in <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Drosophila_pseudoobscura" xlink:type="simple"><italic>Drosophila pseudoobscura</italic></ext-link> [<xref ref-type="bibr" rid="pcbi.1004763.ref008">8</xref>]. Thus, ancestral reconstruction has its roots in several disciplines. Today, computational methods for ancestral reconstruction continue to be extended and applied in a diversity of settings so that ancestral states are being inferred not only for biological characteristics and the molecular sequences but also for the structure of folded proteins [<xref ref-type="bibr" rid="pcbi.1004763.ref009">9</xref>,<xref ref-type="bibr" rid="pcbi.1004763.ref010">10</xref>], the geographic location of populations and species (<ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Phylogeography" xlink:type="simple">phylogeography</ext-link>) [<xref ref-type="bibr" rid="pcbi.1004763.ref011">11</xref>,<xref ref-type="bibr" rid="pcbi.1004763.ref012">12</xref>], and the higher-order structure of genomes [<xref ref-type="bibr" rid="pcbi.1004763.ref013">13</xref>].</p>
</sec>
<sec id="sec003">
<title>Methods and Algorithms</title>
<p>Any attempt at ancestral reconstruction begins with a <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Phylogenetic_tree" xlink:type="simple">phylogeny</ext-link>. In general, a phylogeny is a tree-based <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Hypothesis" xlink:type="simple">hypothesis</ext-link> about the order in which populations (referred to as <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Taxon" xlink:type="simple">taxa</ext-link>) are related by descent from common ancestors. Observed taxa are represented by the tips or terminal nodes of the tree that are progressively connected by branches to their common ancestors, which are represented by the branching points of the tree that are usually referred to as the ancestral or internal nodes. Eventually, all lineages converge to the <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Most_recent_common_ancestor" xlink:type="simple">most recent common ancestor</ext-link> of the entire sample of taxa. In the context of ancestral reconstruction, a phylogeny is often treated as though it were a known quantity (with Bayesian approaches being an important exception). Because there can be an enormous number of phylogenies that are nearly equally effective at explaining the data, reducing the subset of phylogenies supported by the data to a single representative, or point estimate, can be a convenient and sometimes necessary simplifying assumption. Ancestral reconstruction can be thought of as the direct result of applying a hypothetical model of evolution to a given phylogeny. When the model contains one or more free parameters, the overall objective is to estimate these parameters on the basis of measured characteristics among the observed taxa (sequences) that descended from common ancestors. <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Occam%27s_razor" xlink:type="simple">Parsimony</ext-link> is an important exception to this paradigm: though it has been shown that there are mathematical models for which it is the ML estimator [<xref ref-type="bibr" rid="pcbi.1004763.ref014">14</xref>], at its core, it is simply based on the heuristic that changes in character state are rare, without attempting to quantify that rarity.</p>
</sec>
<sec id="sec004">
<title>Maximum Parsimony</title>
<p>Parsimony, known colloquially as "Occam's razor," refers to the principle of selecting the simplest of competing hypotheses. In the context of ancestral reconstruction, parsimony endeavors to find the distribution of ancestral states within a given tree that minimizes the total number of character state changes that would be necessary to explain the states observed at the tips of the tree. This method of <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Maximum_parsimony_(phylogenetics" xlink:type="simple">maximum parsimony</ext-link>) [<xref ref-type="bibr" rid="pcbi.1004763.ref015">15</xref>] is one of the earliest formalized algorithms for reconstructing ancestral states. Maximum parsimony can be implemented by one of several algorithms. One of the earliest examples is <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Walter_M._Fitch" xlink:type="simple">Fitch's method</ext-link> [<xref ref-type="bibr" rid="pcbi.1004763.ref016">16</xref>], which assigns ancestral character states by parsimony via two traversals of a <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Binary_tree" xlink:type="simple">rooted binary tree</ext-link>. The first stage is a <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Tree_traversal#Post-order_2" xlink:type="simple">postorder traversal</ext-link> that proceeds from the tips toward the root of a tree by visiting descendant (child) nodes before their parents. Initially, we are determining the set of possible character states <italic>S</italic><sub><italic>i</italic></sub> for the <italic>i</italic>-th ancestor based on the observed character states of its descendants. Each assignment is the <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Intersection_(set_theory" xlink:type="simple">set intersection</ext-link>) of the character states of the ancestor's descendants; if the intersection is the empty set, then it is the <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Union_(set_theory" xlink:type="simple">set union</ext-link>). In the latter case, it is implied that a character state change has occurred between the ancestor and one of its two immediate descendants. Each such event counts towards the algorithm's cost function, which may be used to discriminate among alternative trees on the basis of maximum parsimony. Next, a <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Tree_traversal#Pre-order_2" xlink:type="simple">preorder traversal</ext-link> of the tree is performed, proceeding from the root towards the tips. Character states are then assigned to each descendant based on which character states it shares with its parent. Since the root has no parent node, one may be required to select a character state arbitrarily, specifically when more than one possible state has been reconstructed at the root. For example, consider a phylogeny recovered for a genus of plants containing six species, A–F (<xref ref-type="fig" rid="pcbi.1004763.g001">Fig 1</xref>), where each plant is pollinated by either a "bee," "hummingbird," or "wind." One obvious question is what the pollinators at deeper nodes were in the phylogeny of this genus of plants. Under maximum parsimony, an ancestral state reconstruction for this clade reveals that "hummingbird" is the most parsimonious ancestral state for the lower clade (plants D, E, F), that the ancestral states for the nodes in the top clade (plants A, B, C) are equivocal, and that both "hummingbird" or "bee" pollinators are equally plausible for the pollination state at the root of the phylogeny, supposing we have strong evidence from the fossil record that the root state is "hummingbird." Resolution of the root to "hummingbird" would yield the pattern of ancestral state reconstruction depicted by the symbols at the nodes (<xref ref-type="fig" rid="pcbi.1004763.g001">Fig 1</xref>) with the state requiring the fewest number of changes circled. Parsimony methods are intuitively appealing and highly efficient, such that they are still used in some cases to seed ML optimization algorithms with an initial phylogeny [<xref ref-type="bibr" rid="pcbi.1004763.ref017">17</xref>]. However, they suffer from several issues:</p>
<fig id="pcbi.1004763.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004763.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Phylogeny of a hypothetical genus of plants with pollination states of either “bees”, “hummingbirds”, or “wind” denoted by pictues at the tips.</title>
<p>Pollination state nodes in the phylogenetic tree inferred under maximum parsimony are coloured on the branches leading into them (yellow represents “bee” pollination, red representing “hummingbird” pollination, and black representing “wind” pollination, dual coloured branches are equally parsimonious for the two states coloured). Assignment of “hummingbird” as the root state (because of prior knowledge from the fossil record) leads to the pattern of ancestral states represented by symbols at the nodes of the phylogeny, the state requiring the fewest number of changes to give rise to the pattern observed at the tips is circled at each node.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004763.g001" xlink:type="simple"/>
</fig>
<list list-type="order">
<list-item><p>Variation in rates of evolution. Fitch's method assumes that changes between all character states are equally likely to occur; thus, any change incurs the same cost for a given tree. This assumption is often unrealistic and can limit the accuracy of such methods. For example, <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Transition_(genetics" xlink:type="simple">transitions</ext-link>) tend to occur more often than <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Transversion" xlink:type="simple">transversions</ext-link> in the evolution of nucleic acids. This assumption can be relaxed by assigning differential costs to specific character state changes, resulting in a weighted parsimony algorithm [<xref ref-type="bibr" rid="pcbi.1004763.ref018">18</xref>].</p></list-item>
<list-item><p>Rapid evolution. The upshot of the "minimum evolution" heuristic underlying such methods is that such methods assume that changes are rare and thus are inappropriate in cases where change is the norm rather than the exception [<xref ref-type="bibr" rid="pcbi.1004763.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1004763.ref020">20</xref>].</p></list-item>
<list-item><p>Variation in time among lineages. Parsimony methods implicitly assume that the same amount of evolutionary time has passed along every branch of the tree. Thus, they do not account for variation in branch lengths in the tree, which are often used to quantify the passage of evolutionary or chronological time. This limitation makes the technique liable to infer that one change occurred on a very short branch rather than multiple changes occurring on a very long branch, for example [<xref ref-type="bibr" rid="pcbi.1004763.ref021">21</xref>]. This shortcoming is addressed by model-based methods (both ML and Bayesian methods) that infer the stochastic process of evolution as it unfolds along each branch of a tree [<xref ref-type="bibr" rid="pcbi.1004763.ref022">22</xref>].</p></list-item>
<list-item><p>Statistical justification. Without a statistical model underlying the method, its estimates do not have well-defined uncertainties [<xref ref-type="bibr" rid="pcbi.1004763.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1004763.ref021">21</xref>,<xref ref-type="bibr" rid="pcbi.1004763.ref023">23</xref>].</p></list-item>
</list>
</sec>
<sec id="sec005">
<title>ML</title>
<p>ML methods of ancestral state reconstruction treat the character states at internal nodes of the tree as parameters and attempt to find the parameter values that maximize the probability of the data (the observed character states) given the hypothesis (a model of evolution and a phylogeny relating the observed sequences or taxa). Some of the earliest ML approaches to ancestral reconstruction were developed in the context of <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Molecular_evolution" xlink:type="simple">genetic sequence evolution</ext-link> [<xref ref-type="bibr" rid="pcbi.1004763.ref024">24</xref>,<xref ref-type="bibr" rid="pcbi.1004763.ref025">25</xref>]; similar models were also developed for the analogous case of discrete character evolution [<xref ref-type="bibr" rid="pcbi.1004763.ref026">26</xref>].</p>
<p>These approaches employ the same probabilistic framework as used to infer the phylogenetic tree [<xref ref-type="bibr" rid="pcbi.1004763.ref027">27</xref>]. In brief, the evolution of a genetic sequence is modelled by a time-reversible continuous time <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Models_of_DNA_evolution#DNA_evolution_as_a_continuous-time_Markov_chain" xlink:type="simple">Markov process</ext-link>. In the simplest of these, all characters undergo independent state transitions (such as nucleotide substitutions) at a constant rate over time. This basic model is frequently extended to allow different rates on each branch of the tree. In reality, mutation rates may also vary over time (due, for example, to environmental changes); this can be modelled by allowing the rate parameters to evolve along the tree, at the expense of having an increased number of parameters. A model defines transition probabilities from states <italic>i</italic> to <italic>j</italic> along a branch of length <italic>t</italic> (in units of evolutionary time). The likelihood of a phylogeny is computed from a nested sum of transition probabilities that corresponds to the hierarchical structure of the proposed tree. At each node, the likelihood of its descendants is summed over all possible ancestral character states at that node:
<disp-formula id="pcbi.1004763.e001">
<alternatives>
<graphic id="pcbi.1004763.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004763.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>Ω</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>Ω</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>Ω</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where we are computing the likelihood of the <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Tree_(data_structure)#Terminology" xlink:type="simple">subtree</ext-link> rooted at node <italic>x</italic> with direct descendants <italic>y</italic> and <italic>z</italic>, <italic>S</italic><sub><italic>i</italic></sub> denotes the character state of the <italic>i</italic>-th node, <italic>t</italic><sub><italic>ij</italic></sub> is the branch length (evolutionary time) between nodes <italic>i</italic> and <italic>j</italic>, and <italic>Ω</italic> is the set of all possible character states (for example, the nucleotides A, C, G, and T). Thus, the objective of ancestral reconstruction is to find the assignment to <italic>S</italic><sub><italic>x</italic></sub> for all <italic>x</italic> internal nodes that maximizes the likelihood of the observed data for a given tree.</p>
<sec id="sec006">
<title>Marginal and joint likelihood</title>
<p>Rather than compute the overall likelihood for alternative trees, the problem for ancestral reconstruction is to find the combination of character states at each ancestral node with the highest marginal ML. Generally speaking, there are two approaches to this problem. First, one may work upwards from the descendants of a tree to progressively assign the most likely character state to each ancestor taking into consideration only its immediate descendants. This approach is referred to as marginal reconstruction. It is akin to a <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Greedy_algorithm" xlink:type="simple">greedy algorithm</ext-link> that makes the locally optimal choice at each stage of the optimization problem. While it can be highly efficient, it is not guaranteed to attain a globally optimal solution to the problem. Second, one may instead attempt to find the joint combination of ancestral character states throughout the tree that jointly maximizes the likelihood of the data. Thus, this approach is referred to as joint reconstruction. While it is not as rapid as marginal reconstruction, it is also less likely to be caught in the local optima in nonconvex objective functions that <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Global_optimization" xlink:type="simple">modern optimization methods and heuristics</ext-link> are designed to avoid. In the context of ancestral reconstruction, this means that a marginal reconstruction may assign a character state to the immediate ancestor that is locally optimal but deflects the joint distribution of ancestral character states away from the global optimum (for examples, see Pupko and colleagues [<xref ref-type="bibr" rid="pcbi.1004763.ref004">4</xref>]). Not surprisingly, joint reconstruction is more <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Computational_complexity_theory" xlink:type="simple">computationally complex</ext-link> than marginal reconstruction. Nevertheless, efficient algorithms for joint reconstruction have been developed with a time complexity that is generally linear with the number of observed taxa or sequences.</p>
<p>ML-based methods of ancestral reconstruction tend to provide greater accuracy than MP methods in the presence of variation in rates of evolution among characters (or across sites in a genome) [<xref ref-type="bibr" rid="pcbi.1004763.ref028">28</xref>,<xref ref-type="bibr" rid="pcbi.1004763.ref029">29</xref>]. However, these methods are not yet able to accommodate variation in rates of evolution over time, otherwise known as <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Heterotachy" xlink:type="simple">heterotachy</ext-link>. If the rate of evolution for a specific character accelerates on a branch of the phylogeny, then the amount of evolution that has occurred on that branch will be underestimated for a given length of the branch and assuming a constant rate of evolution for that character. In addition to that, it is difficult to distinguish heterotachy from variation among characters in rates of evolution [<xref ref-type="bibr" rid="pcbi.1004763.ref030">30</xref>].</p>
<p>Since ML (unlike maximum parsimony) requires the investigator to specify a model of evolution, its accuracy may be affected by the use of a grossly incorrect model (model misspecification). Furthermore, ML can only provide a single reconstruction of character states (what is often referred to as a "point estimate")—when the likelihood surface is highly nonconvex, comprising multiple peaks (local optima), then a single point estimate cannot provide an adequate representation, and a Bayesian approach may be more suitable.</p>
</sec>
</sec>
<sec id="sec007">
<title>Bayesian Inference</title>
<p><ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Bayesian_inference" xlink:type="simple">Bayesian inference</ext-link> uses the likelihood of observed data to update the investigator's belief, or <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Prior_probability" xlink:type="simple">prior distribution</ext-link>, to yield the <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Posterior_probability" xlink:type="simple">posterior distribution</ext-link>. In the context of ancestral reconstruction, the objective is to infer the posterior probabilities of ancestral character states at each internal node of a given tree. Moreover, one can integrate these probabilities over the posterior distributions over the parameters of the evolutionary model and the space of all possible trees. This can be expressed as an application of <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Bayes%27_theorem" xlink:type="simple">Bayes' theorem</ext-link>:
<disp-formula id="pcbi.1004763.e002">
<alternatives>
<graphic id="pcbi.1004763.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004763.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mspace width="0.25em"/><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="4.15em"/><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mspace width="0.25em"/><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mspace width="0.25em"/><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
</disp-formula>
where <italic>S</italic> represents the ancestral states, <italic>D</italic> corresponds to the observed data, and <italic>θ</italic> represents both the evolutionary model and the phylogenetic tree. <italic>P</italic>(<italic>D</italic>|<italic>S</italic>,<italic>θ</italic>) is the likelihood of the observed data that can be computed by <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Felsenstein%27s_tree-pruning_algorithm" xlink:type="simple">Felsenstein's pruning algorithm</ext-link> as given above. <italic>P</italic>(<italic>S</italic>|<italic>θ</italic>) is the prior probability of the ancestral states for a given model and tree. Finally, <italic>P</italic>(<italic>D</italic>|<italic>θ</italic>) is the probability of the data for a given model and tree, integrated over all possible ancestral states. We have given two formulations to emphasize the two different applications of Bayes' theorem, which we discuss in the following section.</p>
<sec id="sec008">
<title>Empirical and hierarchical Bayes</title>
<p>One of the first implementations of a Bayesian approach to ancestral sequence reconstruction was developed by Yang and colleagues, where the ML estimates of the evolutionary model and tree, respectively, were used to define the prior distributions. Thus, their approach is an example of an <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Empirical_Bayes_method" xlink:type="simple">empirical Bayes method</ext-link> to compute the posterior probabilities of ancestral character states; this method was first implemented in the software package PAML [<xref ref-type="bibr" rid="pcbi.1004763.ref031">31</xref>]. In terms of the above Bayesian rule formulation, the empirical Bayes method fixes to the empirical estimates of the model and tree obtained from the data, effectively dropping from the posterior likelihood and prior terms of the formula. Moreover, Yang and colleagues [<xref ref-type="bibr" rid="pcbi.1004763.ref024">24</xref>] used the empirical distribution of site patterns (i.e., assignments of nucleotides to tips of the tree) in their alignment of observed nucleotide sequences in the denominator in place of exhaustively computing <italic>P</italic>(<italic>D</italic>) over all possible values of <italic>S</italic>, given <italic>θ</italic>. Computationally, the empirical Bayes method is akin to the ML reconstruction of ancestral states except that, rather than searching for the ML assignment of states based on their respective probability distributions at each internal node, the probability distributions themselves are reported directly.</p>
<p>Empirical Bayes methods for ancestral reconstruction require the investigator to assume that the evolutionary model parameters and tree are known without error. When the size or complexity of the data makes this an unrealistic assumption, it may be more prudent to adopt the fully hierarchical Bayesian approach and infer the joint posterior distribution over the ancestral character states, model, and tree [<xref ref-type="bibr" rid="pcbi.1004763.ref032">32</xref>]. Huelsenbeck and Bollback [<xref ref-type="bibr" rid="pcbi.1004763.ref032">32</xref>] first proposed a hierarchical Bayes method to ancestral reconstruction by using <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo" xlink:type="simple">Markov chain Monte Carlo</ext-link> (MCMC) methods to sample ancestral sequences from this joint posterior distribution. A similar approach was also used to reconstruct the evolution of symbiosis with algae in fungal species (<ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Lichen" xlink:type="simple">lichenization</ext-link>) [<xref ref-type="bibr" rid="pcbi.1004763.ref033">33</xref>]. For example, the <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm" xlink:type="simple">Metropolis-Hastings algorithm</ext-link> for MCMC explores the joint posterior distribution by accepting or rejecting parameter assignments on the basis of the ratio of posterior probabilities.</p>
<p>Put simply, the empirical Bayes approach calculates the probabilities of various ancestral states for a specific tree and model of evolution. By expressing the reconstruction of ancestral states as a set of probabilities, one can directly quantify the uncertainty for assigning any particular state to an ancestor. On the other hand, the hierarchical Bayes approach averages these probabilities over all possible trees and models of evolution, in proportion to how likely these trees and models are, given the data that has been observed.</p>
<p>However, whether the hierarchical Bayes method confers a substantial advantage in practice remains controversial [<xref ref-type="bibr" rid="pcbi.1004763.ref034">34</xref>]. Moreover, this fully Bayesian approach is limited to analyzing relatively small numbers of sequences or taxa because the space of <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Phylogenetic_tree#Bifurcating_tree" xlink:type="simple">all possible trees</ext-link> rapidly becomes too vast, making it computationally infeasible for <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo" xlink:type="simple">chain samples</ext-link> to converge in a reasonable amount of time.</p>
</sec>
</sec>
<sec id="sec009">
<title>Calibration</title>
<p>Ancestral reconstruction can be informed by the observed states in historical samples of known age, such as fossils or archival specimens. Since the accuracy of ancestral reconstruction generally decays with increasing time, the use of such specimens provides data that are closer to the ancestors being reconstructed and will most likely improve the analysis, especially when rates of character change vary through time. This concept has been validated by an experimental evolutionary study in which replicate populations of <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/T7_phage" xlink:type="simple">bacteriophage T7</ext-link> were propagated to generate an artificial phylogeny [<xref ref-type="bibr" rid="pcbi.1004763.ref035">35</xref>]. In revisiting these experimental data, Oakley and Cunningham [<xref ref-type="bibr" rid="pcbi.1004763.ref036">36</xref>] found that maximum parsimony methods were unable to accurately reconstruct the known ancestral state of a continuous character (<ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Viral_plaque" xlink:type="simple">plaque size</ext-link>); these results were verified by computer simulation. This failure of ancestral reconstruction was attributed to a directional bias in the evolution of plaque size (from large to small plaque diameters) that required the inclusion of "fossilized" samples to address.</p>
<p>Studies of both mammalian carnivores [<xref ref-type="bibr" rid="pcbi.1004763.ref037">37</xref>] and fishes [<xref ref-type="bibr" rid="pcbi.1004763.ref038">38</xref>] have demonstrated that, without incorporating fossil data, the reconstructed estimates of ancestral body sizes are unrealistically large. Moreover, Graham Slater and colleagues showed using <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Caniformia" xlink:type="simple"><italic>Caniform carnivorans</italic></ext-link> that incorporating fossil data into prior distributions improved both the Bayesian inference of ancestral states and evolutionary model selection, relative to analyses using only contemporaneous data [<xref ref-type="bibr" rid="pcbi.1004763.ref039">39</xref>].</p>
</sec>
<sec id="sec010" sec-type="materials|methods">
<title>Models</title>
<p>Many models have been developed to estimate ancestral states of discrete and continuous characters from extant descendants [<xref ref-type="bibr" rid="pcbi.1004763.ref040">40</xref>]. Such models assume that the evolution of a trait through time may be modelled as a stochastic process. For discrete-valued traits (such as "pollinator type"), this process is typically taken to be a <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo" xlink:type="simple">Markov chain</ext-link>; for continuous-valued traits (such as "<ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Brain_size" xlink:type="simple">brain size</ext-link>"), the process is frequently taken to be a <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Brownian_motion" xlink:type="simple">Brownian motion</ext-link> or an <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Ornstein%E2%80%93Uhlenbeck_process" xlink:type="simple">Ornstein–Uhlenbeck process</ext-link>. Using this model as the basis for statistical inference, one can now use <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Maximum_likelihood" xlink:type="simple">ML</ext-link> methods or <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Bayesian_inference" xlink:type="simple">Bayesian inference</ext-link> to estimate the ancestral states.</p>
<sec id="sec011">
<title>Discrete-state models</title>
<p>Suppose the trait in question may fall into one of <italic>k</italic> states, labeled 1,…,<italic>k</italic>. The typical means of modelling evolution of this trait is via a continuous-time Markov chain, which may be briefly described as follows (cf. <xref ref-type="fig" rid="pcbi.1004763.g002">Fig 2</xref>). Each state has associated to it rates of transition to all of the other states. The trait is modelled as stepping between the <italic>k</italic> states; when it reaches a given state, it starts an exponential "clock" for each of the other states that it can step to. It then "races" the clocks against each other, and it takes a step towards the state whose clock is the first to ring. In such a model, the parameters are the transition rates <bold><italic>q</italic></bold> = {<italic>q</italic><sub><italic>ij</italic></sub>: 1 ≤ <italic>i</italic>,<italic>j</italic> ≤ <italic>k</italic>, <italic>i</italic> ≠ <italic>j</italic>}, which can be estimated using, for example, ML methods, where one maximizes over the set of all possible configurations of states of the ancestral nodes.</p>
<fig id="pcbi.1004763.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004763.g002</object-id>
<label>Fig 2</label>
<caption>
<title/>
<p><bold>A general two-state Markov chain representing the rate of jumps from allele <italic>a</italic> to allele <italic>A</italic>.</bold> The different types of jumps are allowed to have different rates.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004763.g002" xlink:type="simple"/>
</fig>
<p>In order to recover the state of a given ancestral node in the phylogeny (call this node <italic>α</italic>) by ML, the procedure is: find the ML estimate <inline-formula id="pcbi.1004763.e003"><alternatives><graphic id="pcbi.1004763.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004763.e003" xlink:type="simple"/>
<mml:math display="inline" id="M3"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math>
</alternatives></inline-formula> of <bold><italic>q</italic></bold>; then compute the likelihood of each possible state for <italic>α</italic> conditioning on <inline-formula id="pcbi.1004763.e004"><alternatives><graphic id="pcbi.1004763.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004763.e004" xlink:type="simple"/>
<mml:math display="inline" id="M4"><mml:mi mathvariant="bold-italic">q</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math>
</alternatives></inline-formula>; finally, choose the ancestral state that maximizes this [<xref ref-type="bibr" rid="pcbi.1004763.ref019">19</xref>]. One may also use this substitution model as the basis for a Bayesian inference procedure, which would consider the posterior belief in the state of an ancestral node given some user-chosen prior.</p>
<p>Because such models may have as many as <italic>k</italic>(<italic>k</italic> − 1) parameters, overfitting may be an issue. Some common choices that reduce the parameter space are:</p>
<list list-type="bullet">
<list-item><p>Markov <italic>k</italic>-state 1 parameter model (<xref ref-type="fig" rid="pcbi.1004763.g003">Fig 3</xref>): this model is the reverse-in-time <italic>k</italic>-state counterpart of the <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Models_of_DNA_evolution#JC69_model_.28Jukes_and_Cantor.2C_1969.29.5B1.5D" xlink:type="simple">Jukes–Cantor</ext-link> model. In this model, all transitions have the same rate <italic>q</italic>, regardless of their start and end states. Some transitions may be disallowed by declaring that their rates are simply 0; this may be the case, for example, if certain states cannot be reached from other states in a single transition.</p></list-item>
</list>
<fig id="pcbi.1004763.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004763.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Example of a four-state 1 parameter Markov chain model.</title>
<p>Note that in this diagram, transitions between states <italic>A</italic> and <italic>D</italic> have been disallowed; it is conventional to not draw the arrow rather than to draw it with a rate of 0.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004763.g003" xlink:type="simple"/>
</fig>
<list list-type="bullet">
<list-item><p>Asymmetrical Markov <italic>k</italic>-state 2 parameter model (<xref ref-type="fig" rid="pcbi.1004763.g004">Fig 4</xref>): in this model, the state space is ordered (so that, for example, state 1 is smaller than state 2, which is smaller than state 3, and transitions may only occur between adjacent states). This model contains two parameters <italic>q</italic><sub>inc</sub> and <italic>q</italic><sub>dec</sub>: one for the rate of increase of state (e.g., 0 to 1, 1 to 2, etc.) and one for the rate of decrease in state (e.g., from 2 to 1, 1 to 0, etc.).</p></list-item>
</list>
<fig id="pcbi.1004763.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004763.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Graphical representation of an asymmetrical five-state 2-parameter Markov chain model.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004763.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec012">
<title>Example: Binary state speciation and extinction model</title>
<p>The binary state speciation and extinction model [<xref ref-type="bibr" rid="pcbi.1004763.ref041">41</xref>] (BiSSE) is a discrete-space model that does not directly follow the framework of those mentioned above. It allows estimation of ancestral binary character states jointly with diversification rates associated with different character states; it may also be straightforwardly extended to a more general multiple-discrete-state model. In its most basic form, this model involves six parameters: two speciation rates (one each for lineages in states 0 and 1); similarly, two extinction rates; and two rates of character change. This model allows for hypothesis testing on the rates of speciation/extinction/character change, at the cost of increasing the number of parameters.</p>
</sec>
<sec id="sec013">
<title>Continuous-state models</title>
<p>In the case where the trait instead takes nondiscrete values, one must instead turn to a model where the trait evolves as some continuous process. Inference of ancestral states by ML (or by Bayesian methods) would proceed as above but with the likelihoods of transitions in state between adjacent nodes given by some other continuous probability distribution.</p>
<list list-type="bullet">
<list-item><p>Brownian motion: in this case, if nodes <italic>U</italic> and <italic>V</italic> are adjacent in the phylogeny (say <italic>U</italic> is the ancestor of <italic>V</italic>) and separated by a branch of length <italic>t</italic>, the likelihood of a transition from <italic>U</italic> being in state <italic>x</italic> to <italic>V</italic> being in state <italic>y</italic> is given by a Gaussian density with mean 0 and variance <italic>σ</italic><sup>2</sup><italic>t</italic>. In this case, there is only one parameter (<italic>σ</italic><sup>2</sup>), and the model assumes that the trait evolves freely without a bias toward increase or decrease, and that the rate of change is constant throughout the branches of the phylogenetic tree [<xref ref-type="bibr" rid="pcbi.1004763.ref042">42</xref>].</p></list-item>
<list-item><p>Ornstein–Uhlenbeck process: in brief, an Ornstein–Uhlenbeck process is a continuous stochastic process that behaves like a Brownian motion, but attracted toward some central value, where the strength of the attraction increases with the distance from that value. This is useful for modelling scenarios where the trait is subject to stabilizing selection around a certain value (say 0). Under this model, the above-described transition of <italic>U</italic> being in state <italic>x</italic> to <italic>V</italic> being in state <italic>y</italic> would have a likelihood defined by the transition density of an Ornstein–Uhlenbeck process with two parameters: <italic>σ</italic><sup>2</sup>, which describes the variance of the driving Brownian motion, and <italic>α</italic>, which describes the strength of its attraction to 0. As <italic>α</italic> tends to 0, the process is less and less constrained by its attraction to 0 and the process becomes a Brownian motion (<xref ref-type="fig" rid="pcbi.1004763.g005">Fig 5</xref>). Because of this, the models may be nested, and log-likelihood ratio tests discerning which of the two models is appropriate may be carried out.</p></list-item>
</list>
<fig id="pcbi.1004763.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004763.g005</object-id>
<label>Fig 5</label>
<caption>
<title/>
<p><bold>Plots of 200 trajectories of each of: Brownian motion with drift 0 and <italic>σ</italic><sup>2</sup> = 1 (black); Ornstein–Uhlenbeck with <italic>σ</italic><sup>2</sup> = 1 and <italic>α</italic> = −4 (green); and Ornstein–Uhlenbeck with <italic>σ</italic><sup>2</sup> = 1 and <italic>α</italic> = −40 (orange)</bold>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004763.g005" xlink:type="simple"/>
</fig>
<list list-type="bullet">
<list-item><p>Stable models of continuous character evolution [<xref ref-type="bibr" rid="pcbi.1004763.ref043">43</xref>]: though Brownian motion is appealing and tractable as a model of continuous evolution, it does not permit non-neutrality in its basic form, nor does it provide for any variation in the rate of evolution over time. Instead, one may use a <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Stable_process" xlink:type="simple">stable process</ext-link>, one whose values at fixed times are distributed as <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Stable_distribution" xlink:type="simple">stable distributions</ext-link>, to model the evolution of traits. Stable processes, roughly speaking, behave as Brownian motions that also incorporate discontinuous jumps. This allows us to appropriately model scenarios in which short bursts of fast trait evolution are expected. In this setting, ML methods are poorly suited because of a rugged likelihood surface and because the likelihood may be made arbitrarily large, so Bayesian methods are more appropriate.</p></list-item>
</list>
</sec>
</sec>
<sec id="sec014">
<title>Applications</title>
<sec id="sec015">
<title>Character evolution</title>
<sec id="sec016">
<title>Behaviour and life history evolution</title>
<p><italic>Diet reconstruction in Galapagos finches</italic>: Both phylogenetic and character data are available for the radiation of <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Finch" xlink:type="simple">finches</ext-link> inhabiting the <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Gal%C3%A1pagos_Islands" xlink:type="simple">Galapagos Islands</ext-link>. These data allow testing of hypotheses concerning the timing and ordering of character state changes through time via ancestral state reconstruction. During the dry season, the diets of the 13 species of <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Darwin%27s_finches" xlink:type="simple">Galapagos finches</ext-link> may be assorted into three broad diet categories, first those that consume grain-like foods are considered “<ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Seed_predation" xlink:type="simple">granivores</ext-link>,” those that ingest arthropods are termed “<ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Insectivore" xlink:type="simple">insectivores</ext-link>,” and those that consume vegetation are classified as “<ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Folivore" xlink:type="simple">folivores</ext-link>” [<xref ref-type="bibr" rid="pcbi.1004763.ref019">19</xref>]. Dietary ancestral state reconstruction under maximum parsimony recovers two major shifts from an insectivorous state: one to granivory and one to folivory. Maximum-likelihood ancestral state reconstruction recovers broadly similar results, with one significant difference: the common ancestor of the tree finch (<ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Camarhynchus" xlink:type="simple"><italic>Camarhynchus</italic></ext-link>) and ground finch (<ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Geospiza" xlink:type="simple"><italic>Geospiza</italic></ext-link>) clades is most likely granivorous rather than insectivorous (as judged by parsimony). In this case, this difference between ancestral states returned by maximum parsimony and ML likely occurs as a result of the fact that ML estimates consider branch lengths of the phylogenetic tree [<xref ref-type="bibr" rid="pcbi.1004763.ref019">19</xref>].</p>
</sec>
<sec id="sec017">
<title>Morphological character evolution mammalian body mass</title>
<p>In an analysis of the body mass of 1,679 <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Placentalia" xlink:type="simple">placental mammal</ext-link> species comparing stable models of continuous character evolution to Brownian motion models, Elliot and Mooers [<xref ref-type="bibr" rid="pcbi.1004763.ref043">43</xref>] showed that the evolutionary process describing mammalian body mass evolution is best characterized by a stable model of continuous character evolution, which accommodates rare changes of large magnitude. Under a stable model, ancestral mammals retained a low body mass through early diversification, with large increases in body mass coincident with the origin of several orders of large body massed species (e.g., ungulates). By contrast, simulation under a Brownian motion model recovered a less realistic, order of magnitude larger body mass among ancestral mammals, requiring significant reductions in body size prior to the evolution of orders exhibiting small body size (e.g., <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Rodent" xlink:type="simple">Rodentia</ext-link>). Thus, stable models recover a more realistic picture of mammalian body mass evolution by permitting large transformations to occur on a small subset of branches [<xref ref-type="bibr" rid="pcbi.1004763.ref043">43</xref>].</p>
</sec>
<sec id="sec018">
<title>Correlated character evolution</title>
<p><ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Phylogenetic_comparative_methods" xlink:type="simple">Comparative methods</ext-link> (inferences drawn through comparison of related taxa) are often used to identify biological characteristics that do not evolve independently, which can reveal an underlying dependence. For example, the evolution of the shape of a finch's beak may be associated with its foraging behaviour. However, it is not advisable to search for these associations by the direct comparison of measurements or genetic sequences, as these observations are not independent because of their descent from common ancestors. For discrete characters, this problem was first addressed in the framework of maximum parsimony by evaluating whether two characters tended to undergo a change on the same branches of the tree [<xref ref-type="bibr" rid="pcbi.1004763.ref044">44</xref>,<xref ref-type="bibr" rid="pcbi.1004763.ref045">45</xref>]. <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Joseph_Felsenstein" xlink:type="simple">Felsenstein</ext-link> identified this problem for continuous character evolution and proposed a solution similar to ancestral reconstruction, in which the phylogenetic structure of the data was accommodated by directing the analysis on "independent contrasts" between nodes of the tree related by nonoverlapping branches [<xref ref-type="bibr" rid="pcbi.1004763.ref023">23</xref>].</p>
</sec>
<sec id="sec019">
<title>Molecular evolution</title>
<p>On a molecular level, <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Amino_acid" xlink:type="simple">amino acid residues</ext-link> at different locations of a protein may evolve nonindependently, because they have a direct physicochemical interaction, or indirectly by their interactions with a common substrate, or through long-range interactions in the protein structure. Conversely, the folded structure of a protein could potentially be inferred from the distribution of residue interactions [<xref ref-type="bibr" rid="pcbi.1004763.ref046">46</xref>]. One of the earliest applications of ancestral reconstruction, to predict the <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Protein_tertiary_structure" xlink:type="simple">three-dimensional structure of a protein</ext-link> through residue contacts, was published by Shindyalov and colleagues [<xref ref-type="bibr" rid="pcbi.1004763.ref047">47</xref>]. Phylogenies relating 67 different protein families were generated by a distance-based clustering method (<ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/UPGMA" xlink:type="simple">unweighted pair group method with arithmetic mean</ext-link>, UPGMA), and ancestral sequences were reconstructed by parsimony. The authors reported a weak but significant tendency for <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Coevolution" xlink:type="simple">coevolving</ext-link> pairs of residues to be colocated in the known three-dimensional structure of the proteins.</p>
<p>More recently, this concept has been applied to identify coevolving residues in protein sequences using more advanced methods for the reconstruction of phylogenies and ancestral sequences. For example, ancestral reconstruction has been used to identify coevolving residues in proteins encoded by RNA virus genomes, particularly in the human immunodeficiency virus (HIV) [<xref ref-type="bibr" rid="pcbi.1004763.ref048">48</xref>–<xref ref-type="bibr" rid="pcbi.1004763.ref050">50</xref>].</p>
</sec>
<sec id="sec020">
<title>Vaccine design</title>
<p>RNA viruses such as <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/HIV" xlink:type="simple">HIV</ext-link> evolve at an extremely rapid rate, orders of magnitude faster than mammals or birds. For these organisms, ancestral reconstruction can be applied on a much shorter time scale; for example, in order to reconstruct the global or regional progenitor of an <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Epidemic" xlink:type="simple">epidemic</ext-link> that has spanned decades rather than millions of years. A team around Brian Gaschen [<xref ref-type="bibr" rid="pcbi.1004763.ref051">51</xref>] proposed that such reconstructed strains be used as targets for <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Vaccine" xlink:type="simple">vaccine</ext-link> design efforts as opposed to sequences isolated from patients in the present day. Because HIV is extremely diverse, a vaccine designed to work on one patient's viral population might not work for a different patient, because the evolutionary distance between these two viruses may be large. However, their most recent common ancestor is closer to each of the two viruses than they are to each other. Thus, a vaccine designed for a common ancestor could have a better chance of being effective for a larger proportion of circulating strains. Another team took this idea further by developing a center-of-tree (COT) reconstruction method to produce a sequence whose total evolutionary distance to contemporary strains is as small as possible [<xref ref-type="bibr" rid="pcbi.1004763.ref052">52</xref>]. Strictly speaking, this method was not ancestral reconstruction, as the COT sequence does not necessarily represent a sequence that has ever existed in the evolutionary history of the virus. However, Rolland and colleagues did find that, in the case of HIV, the COT virus was functional when synthesized. Similar experiments with synthetic ancestral sequences obtained by ML reconstruction have likewise shown that these ancestors are both functional and immunogenic, lending some credibility to these methods [<xref ref-type="bibr" rid="pcbi.1004763.ref053">53</xref>,<xref ref-type="bibr" rid="pcbi.1004763.ref054">54</xref>]. Furthermore, ancestral reconstruction can potentially be used to infer the genetic sequence of the transmitted HIV variants that have gone on to establish the next infection, with the objective of identifying distinguishing characteristics of these variants (as a nonrandom selection of the transmitted population of viruses) that may be targeted for vaccine design [<xref ref-type="bibr" rid="pcbi.1004763.ref055">55</xref>].</p>
</sec>
<sec id="sec021">
<title>Genome rearrangements</title>
<p>Rather than inferring the ancestral DNA sequence, one may be interested in the larger-scale molecular structure of an ancestral genome. This problem is often approached in a combinatorial framework, by modelling genomes as <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Permutation" xlink:type="simple">permutations</ext-link> of genes or homologous regions. Various operations are allowed on these permutations, such as an inversion (a segment of the permutation is reversed in-place), <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Deletion_(genetics" xlink:type="simple">deletion</ext-link>) (a segment is removed), or <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Transposable_element" xlink:type="simple">transposition</ext-link> (a segment is removed from one part of the permutation and spliced in somewhere else). The "genome rearrangement problem," first posed by Watterson and colleagues [<xref ref-type="bibr" rid="pcbi.1004763.ref013">13</xref>], asks: given two genomes (permutations) and a set of allowable operations, what is the shortest sequence of operations that will transform one genome into the other? A generalization of this problem applicable to ancestral reconstruction is the "multiple genome rearrangement problem" [<xref ref-type="bibr" rid="pcbi.1004763.ref056">56</xref>]: given a set of genomes and a set of allowable operations, find (i) a binary tree with the given genomes as its leaves, and (ii) an assignment of genomes to the internal nodes of the tree, such that the total number of operations across the whole tree is minimized. This approach is similar to parsimony, except that the tree is inferred along with the ancestral sequences. Unfortunately, even the single genome rearrangement problem is <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/NP-hardness" xlink:type="simple">NP-hard</ext-link> [<xref ref-type="bibr" rid="pcbi.1004763.ref057">57</xref>], although it has received much attention in mathematics and computer science (for a review, see Fertin and colleagues [<xref ref-type="bibr" rid="pcbi.1004763.ref058">58</xref>]).</p>
</sec>
<sec id="sec022">
<title>Spatial applications migration</title>
<p>Ancestral reconstruction is not limited to biological traits. Spatial location is also a trait, and ancestral reconstruction methods can infer the locations of ancestors of the individuals under consideration. Such techniques were used by Lemey and colleagues to geographically trace the ancestors of 192 <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Influenza_A_virus_subtype_H5N1" xlink:type="simple">Avian influenza A-H5N1</ext-link> strains sampled from 20 localities in Europe and Asia and of 101 <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Rabies_virus" xlink:type="simple">rabies virus</ext-link> sequences sampled across 12 African countries [<xref ref-type="bibr" rid="pcbi.1004763.ref012">12</xref>].</p>
<p>Treating locations as discrete states (countries, cities, etc.) allows for the application of the discrete-state models described above. However, unlike in a model where the state space for the trait is small, there may be many locations, and transitions between certain pairs of states may rarely or never occur; for example, migration between distant locales may never happen directly if air travel between the two places does not exist, so such migrations must pass through intermediate locales first. This means that there could be many parameters in the model which are zero or close to zero. To this end, Lemey and colleagues used a Bayesian procedure to not only estimate the parameters and ancestral states but also to select which migration parameters are not zero; their work suggests that this procedure does lead to more efficient use of the data. They also explore the use of prior distributions that incorporate geographical structure or hypotheses about migration dynamics, finding that those they considered had little effect on the findings.</p>
<p>Using this analysis, the team around Lemey found that the most likely hub of diffusion of A-H5N1 is <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Guangdong" xlink:type="simple">Guangdong</ext-link>, with <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Hong_Kong" xlink:type="simple">Hong Kong</ext-link> also receiving posterior support. Further, their results support the hypothesis of long-standing presence of African rabies in <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/West_Africa" xlink:type="simple">West Africa</ext-link> [<xref ref-type="bibr" rid="pcbi.1004763.ref012">12</xref>].</p>
</sec>
<sec id="sec023">
<title>Species ranges</title>
<p>Inferring historical <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Biogeography" xlink:type="simple">biogeographic</ext-link> patterns often requires reconstructing ancestral ranges of species on phylogenetic trees [<xref ref-type="bibr" rid="pcbi.1004763.ref059">59</xref>]. For instance, a well-resolved phylogeny of plant species in the genus <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Cyrtandra" xlink:type="simple"><italic>Cyrtandra</italic></ext-link> [<xref ref-type="bibr" rid="pcbi.1004763.ref059">59</xref>] was used together with information of their geographic ranges to compare four methods of ancestral range reconstruction. The team compared Fitch parsimony [<xref ref-type="bibr" rid="pcbi.1004763.ref016">16</xref>] (FP; parsimony), stochastic mapping (SM; ML) [<xref ref-type="bibr" rid="pcbi.1004763.ref060">60</xref>], <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Vicariance" xlink:type="simple">dispersal-vicariance analysis</ext-link> [<xref ref-type="bibr" rid="pcbi.1004763.ref061">61</xref>] (DIVA; parsimony), and dispersal-extinction-cladogenesis (DEC; maximum-likelihood) [<xref ref-type="bibr" rid="pcbi.1004763.ref011">11</xref>,<xref ref-type="bibr" rid="pcbi.1004763.ref062">62</xref>]. Results indicated that both parsimony methods performed poorly, which was likely due to the fact that parsimony methods do not consider branch lengths. Both maximum-likelihood methods performed better; however, DEC analyses that additionally allow incorporation of geological priors gave more realistic inferences about range evolution in <italic>Cyrtandra</italic> relative to other methods [<xref ref-type="bibr" rid="pcbi.1004763.ref059">59</xref>].</p>
<p>Another ML method recovers the phylogeographic history of a gene by reconstructing the ancestral locations of the sampled taxa [<xref ref-type="bibr" rid="pcbi.1004763.ref063">63</xref>]. This method assumes a spatially explicit random walk model of migration to reconstruct ancestral locations given the geographic coordinates of the individuals represented by the tips of the phylogenetic tree. When applied to a phylogenetic tree of chorus frogs <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Upland_chorus_frog" xlink:type="simple"><italic>Pseudacris feriarum</italic></ext-link>, this method recovered recent northward expansion, higher per-generation dispersal distance in the recently colonized region, a noncentral ancestral location, and directional migration.</p>
<p>The first consideration of the multiple genome rearrangement problem, long before its formalization in terms of permutations, was presented by Sturtevant and Dobzhansky in 1936 (<xref ref-type="fig" rid="pcbi.1004763.g006">Fig 6</xref>) [<xref ref-type="bibr" rid="pcbi.1004763.ref064">64</xref>]. They examined genomes of several strains of fruit fly from different geographic locations, and observed that one configuration, which they called "standard," was the most common throughout all the studied areas. Remarkably, they also noticed that four different strains could be obtained from the standard sequence by a single inversion, and two others could be related by a second inversion. This allowed them to hypothesize a phylogeny for the sequences and to infer that the standard sequence was probably also the ancestral one.</p>
<fig id="pcbi.1004763.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004763.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Phylogeny of seven regional strains of <italic>Drosophila pseudoobscura</italic>, as inferred by Sturtevant and Dobzhansky [<xref ref-type="bibr" rid="pcbi.1004763.ref064">64</xref>].</title>
<p>Displayed sequences do not correspond to the original paper, but were derived from the notation in the authors' companion paper [<xref ref-type="bibr" rid="pcbi.1004763.ref008">8</xref>] as follows: A (63A–65B), B (65C–68D), C (69A–70A), D (70B–70D), E (71A–71B), F (71A–73C), G (74A–74C), H (75A–75C), I (76A–76B), J (76C–77B), K (78A–79D), L (80A–81D). Inversions inferred by the authors are highlighted in blue along branches.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004763.g006" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec024">
<title>Linguistic evolution</title>
<p>Reconstructions of the words and phenomes of ancient <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Proto-language" xlink:type="simple">protolanguages</ext-link> such as <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Proto-Indo-European_language" xlink:type="simple">Proto-Indo-European</ext-link> have been performed based on the observed analogues in present-day languages. Typically, these analyses are carried out manually using the "comparative method" [<xref ref-type="bibr" rid="pcbi.1004763.ref065">65</xref>]. First, words from different languages with a common etymology (<ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Cognate" xlink:type="simple">cognates</ext-link>) are identified in the contemporary languages under study, analogous to the identification of <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Homology_(biology)#Orthology" xlink:type="simple">orthologous</ext-link> biological sequences. Second, correspondences between individual sounds in the cognates are identified, a step similar to biological <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Sequence_alignment" xlink:type="simple">sequence alignment</ext-link>, although performed manually. Finally, likely ancestral sounds are hypothesized by manual inspection and various heuristics (such as the fact that most languages have both <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Nasal_vowel" xlink:type="simple">nasal and non-nasal vowels</ext-link>) [<xref ref-type="bibr" rid="pcbi.1004763.ref065">65</xref>].</p>
</sec>
</sec>
<sec id="sec025">
<title>Software</title>
<p>There are many software packages available that perform ancestral state reconstruction. Generally, these software packages have been developed and maintained through the efforts of scientists in related fields and released under <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Free_software_license" xlink:type="simple">free software licenses</ext-link>. The following table is not meant to be a comprehensive itemization of all available packages, but provides a representative sample of the extensive variety of packages that implement methods of ancestral reconstruction with different strengths and features (<xref ref-type="table" rid="pcbi.1004763.t001">Table 1</xref>).</p>
<table-wrap id="pcbi.1004763.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004763.t001</object-id>
<label>Table 1</label> <caption><title>List of software for ancestral reconstruction.</title></caption>
<alternatives>
<graphic id="pcbi.1004763.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004763.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Name</th>
<th align="center">Methods</th>
<th align="center">Platform</th>
<th align="center">Supported Input Formats</th>
<th align="center">Character Types</th>
<th align="center">Continuous (C) or Discrete (D) Characters</th>
<th align="center">Software Licence</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">PAML</td>
<td align="left">ML</td>
<td align="left">Unix, Mac, Win</td>
<td align="left">PHYLIP, NEXUS, FASTA</td>
<td align="left">Nucleotide, Protein</td>
<td align="center">D</td>
<td align="left">Proprietary</td>
</tr>
<tr>
<td align="left">BEAST2</td>
<td align="left">Bayesian</td>
<td align="left">Unix, Mac, Win</td>
<td align="left">NEXUS, BEAST XML</td>
<td align="left">Nucleotide, Protein, Geographic</td>
<td align="center">C, D</td>
<td align="left">GNU Lesser General Public License</td>
</tr>
<tr>
<td align="left">APE</td>
<td align="left">ML</td>
<td align="left">Unix, Mac, Win</td>
<td align="left">NEXUS, FASTA, CLUSTAL</td>
<td align="left">Nucleotide, Protein</td>
<td align="center">C, D</td>
<td align="left">GNU General Public License</td>
</tr>
<tr>
<td align="left">Diversitree</td>
<td align="left">ML</td>
<td align="left">Unix, Mac, Win</td>
<td align="left">NEXUS</td>
<td align="left">Qualitative and quantitative traits, Geographic</td>
<td align="center">C, D</td>
<td align="left">GNU General Public License, version 2</td>
</tr>
<tr>
<td align="left">HyPhy</td>
<td align="left">ML</td>
<td align="left">Unix, Mac, Win</td>
<td align="left">MEGA, NEXUS, FASTA, PHYLIP</td>
<td align="left">Nucleotide, Protein (customizable)</td>
<td align="center">D</td>
<td align="left">GNU Free Documentation License 1.3</td>
</tr>
<tr>
<td align="left">BayesTraits</td>
<td align="left">Bayesian</td>
<td align="left">Unix, Mac, Win</td>
<td align="left">TSV or space delimited table. Rows are species, columns are traits.</td>
<td align="left">Qualitative and quantitative traits</td>
<td align="center">C, D</td>
<td align="left">Creative Commons Attribution License</td>
</tr>
<tr>
<td align="left">Lagrange</td>
<td align="left">ML</td>
<td align="left">Linux, Mac, Win</td>
<td align="left">TSV/CSV of species regions. Rows are species and columns are geographic regions</td>
<td align="left">Geographic</td>
<td align="center">-</td>
<td align="left">GNU General Public License, version 2</td>
</tr>
<tr>
<td align="left">Mesquite</td>
<td align="left">Parsimony, ML</td>
<td align="left">Unix, Mac, Win</td>
<td align="left">Fasta, NBRF, Genbank, PHYLIP, CLUSTAL, TSV</td>
<td align="left">Nucleotide, Protein,Geographic</td>
<td align="center">C, D</td>
<td align="left">Creative Commons Attribution 3.0 License</td>
</tr>
<tr>
<td align="left">Phylomapper</td>
<td align="left">ML, Bayesian (version 2)</td>
<td align="left">Unix, Mac, Win</td>
<td align="left">NEXUS</td>
<td align="left">Geographic, Ecological niche</td>
<td align="center">C, D</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left">Ancestors</td>
<td align="left">ML</td>
<td align="left">Web</td>
<td align="left">Fasta</td>
<td align="left">Nucleotide (indels)</td>
<td align="center">D</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left">Phyrex</td>
<td align="left">Maximum Parsimony</td>
<td align="left">Linux</td>
<td align="left">Fasta</td>
<td align="left">Gene expression</td>
<td align="center">C, D</td>
<td align="left">Proprietary</td>
</tr>
<tr>
<td align="left">SIMMAP</td>
<td align="left">SM</td>
<td align="left">Mac</td>
<td align="left">XML-like format</td>
<td align="left">Nucleotide, qualitative traits</td>
<td align="center">D</td>
<td align="left">Proprietary</td>
</tr>
<tr>
<td align="left">MrBayes</td>
<td align="left">Bayesian</td>
<td align="left">Unix, Mac, Win</td>
<td align="left">NEXUS</td>
<td align="left">Nucleotide, Protein</td>
<td align="center">D</td>
<td align="left">GNU General Public License</td>
</tr>
<tr>
<td align="left">PARANA</td>
<td align="left">Maximum Parsimony</td>
<td align="left">Unix, Mac, Win</td>
<td align="left">Newick</td>
<td align="left">Biological networks</td>
<td align="center">D</td>
<td align="left">Apache License</td>
</tr>
<tr>
<td align="left">PHAST (PREQUEL)</td>
<td align="left">ML</td>
<td align="left">Unix, Mac, Win</td>
<td align="left">Multiple Alignment</td>
<td align="left">Nucleotide</td>
<td align="center">D</td>
<td align="left">BSD License</td>
</tr>
<tr>
<td align="left">RASP</td>
<td align="left">ML, Bayesian</td>
<td align="left">Unix, Mac, Win</td>
<td align="left">Newick</td>
<td align="left">Geographic</td>
<td align="center">D</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left">VIP</td>
<td align="left">Maximum Parsimony</td>
<td align="left">Linux, Win</td>
<td align="left">Newick</td>
<td align="left">Geographic</td>
<td align="center">D (grid)</td>
<td align="left">GPL Creative Commons</td>
</tr>
<tr>
<td align="left">FastML</td>
<td align="left">ML</td>
<td align="left">Web, Unix</td>
<td align="left">Fasta</td>
<td align="left">Nucleotide, Protein</td>
<td align="center">D</td>
<td align="left">Copyright</td>
</tr>
<tr>
<td align="left">MLGO</td>
<td align="left">ML</td>
<td align="left">Web</td>
<td align="left">Custom</td>
<td align="left">Gene order permutation</td>
<td align="center">D</td>
<td align="left">GNU</td>
</tr>
<tr>
<td align="left">BADGER</td>
<td align="left">Bayesian</td>
<td align="left">Unix, Mac, Win</td>
<td align="left">Custom</td>
<td align="left">Gene order permutation</td>
<td align="center">D</td>
<td align="left">GNU GPL version 2</td>
</tr>
<tr>
<td align="left">COUNT</td>
<td align="left">Maximum Parsimony</td>
<td align="left">Unix, Mac, Win</td>
<td align="left">Tab-delimited text file of rows for taxa and count data in columns</td>
<td align="left">Count data (homolog family size)</td>
<td align="center">D</td>
<td align="left">BSD</td>
</tr>
<tr>
<td align="left">MEGA</td>
<td align="left">Maximum parsimony, ML</td>
<td align="left">Mac, Win</td>
<td align="left">MEGA</td>
<td align="left">Nucleotide, Protein</td>
<td align="center">D</td>
<td align="left">Proprietary</td>
</tr>
<tr>
<td align="left">ANGES</td>
<td align="left">Local Parsimony</td>
<td align="left">Unix</td>
<td align="left">Custom</td>
<td align="left">Genome maps</td>
<td align="center">D</td>
<td align="left">GNU General Public License, version 3</td>
</tr>
<tr>
<td align="left">EREM</td>
<td align="left">ML</td>
<td align="left">Win, Unix, Matlab module</td>
<td align="left">Custom text format for model parameters, tree, observed character values</td>
<td align="left">Binary</td>
<td align="center">D</td>
<td align="left">None specified, although site indicates software is freely available</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
</sec>
<sec id="sec026">
<title>Package Descriptions</title>
<sec id="sec027">
<title>Molecular evolution</title>
<p>The majority of these software packages are designed for analyzing genetic sequence data. For example, PAML [<xref ref-type="bibr" rid="pcbi.1004763.ref031">31</xref>] is a collection of programs for the phylogenetic analysis of DNA and protein sequence alignments by ML. Ancestral reconstruction can be performed using the codeml program. <ext-link ext-link-type="uri" xlink:href="http://hyphy.org/w/index.php/Main_Page" xlink:type="simple">HyPhy</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://mesquiteproject.org/Mesquite_Folder/docs/mesquite/manual.html" xlink:type="simple">Mesquite</ext-link>, and <ext-link ext-link-type="uri" xlink:href="http://www.megasoftware.net/" xlink:type="simple">MEGA</ext-link> are also software packages for the phylogenetic analysis of sequence data, but are designed to be more modular and customizable. HyPhy [<xref ref-type="bibr" rid="pcbi.1004763.ref066">66</xref>] implements a joint ML method of ancestral sequence reconstruction [<xref ref-type="bibr" rid="pcbi.1004763.ref004">4</xref>] that can be readily adapted to reconstructing a more generalized range of discrete ancestral character states such as geographic locations by specifying a customized model in its batch language. Mesquite [<xref ref-type="bibr" rid="pcbi.1004763.ref067">67</xref>] provides ancestral state reconstruction methods for both discrete and continuous characters using both maximum parsimony and ML methods. It also provides several visualization tools for interpreting the results of ancestral reconstruction. MEGA [<xref ref-type="bibr" rid="pcbi.1004763.ref068">68</xref>] is a modular system, too, but places greater emphasis on ease-of-use than customization of analyses. As of version 5, MEGA allows the user to reconstruct ancestral states using maximum parsimony, ML, and empirical Bayes methods [<xref ref-type="bibr" rid="pcbi.1004763.ref068">68</xref>].</p>
<p>The Bayesian analysis of genetic sequences may confer greater robustness to model misspecification. MrBayes [<xref ref-type="bibr" rid="pcbi.1004763.ref069">69</xref>] allows inference of ancestral states at ancestral nodes using the full hierarchical Bayesian approach. The PREQUEL program distributed in the PHAST package performs comparative evolutionary genomics using ancestral sequence reconstruction [<xref ref-type="bibr" rid="pcbi.1004763.ref070">70</xref>]. SIMMAP stochastically maps mutations on phylogenies [<xref ref-type="bibr" rid="pcbi.1004763.ref071">71</xref>]. BayesTraits [<xref ref-type="bibr" rid="pcbi.1004763.ref026">26</xref>] analyses discrete or continuous characters in a Bayesian framework to evaluate models of evolution, reconstruct ancestral states, and detect correlated evolution between pairs of traits.</p>
<sec id="sec028">
<title>Other character types</title>
<p>Other software packages are more oriented towards the analysis of qualitative and quantitative traits (phenotypes). For example, the ape package [<xref ref-type="bibr" rid="pcbi.1004763.ref072">72</xref>] in the statistical computing environment R also provides methods for ancestral state reconstruction for both discrete and continuous characters through the <ext-link ext-link-type="uri" xlink:href="http://www.inside-r.org/packages/cran/ape/docs/ace" xlink:type="simple"><italic>ace</italic></ext-link> function, including ML. Note that <italic>ace</italic> performs reconstruction by computing scaled conditional likelihoods instead of the marginal or joint likelihoods used by other ML-based methods for ancestral reconstruction, which may adversely affect the accuracy of reconstruction at nodes other than the root. Phyrex implements a maximum parsimony-based algorithm to reconstruct ancestral gene expression profiles in addition to a ML method for reconstructing ancestral genetic sequences (by wrapping around the baseml function in PAML) [<xref ref-type="bibr" rid="pcbi.1004763.ref073">73</xref>].</p>
<p>Several software packages also reconstruct <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Phylogeography" xlink:type="simple">phylogeography</ext-link>. BEAST (Bayesian Evolutionary Analysis by Sampling Trees [<xref ref-type="bibr" rid="pcbi.1004763.ref074">74</xref>]) provides tools for reconstructing ancestral geographic locations from observed sequences annotated with location data using Bayesian MCMC sampling methods. Diversitree [<xref ref-type="bibr" rid="pcbi.1004763.ref075">75</xref>] is an R package providing methods for ancestral state reconstruction under Mk2 (a <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Continuous-time_Markov_chain" xlink:type="simple">continuous time Markov model</ext-link> of binary character evolution [<xref ref-type="bibr" rid="pcbi.1004763.ref076">76</xref>]) and BiSSE models. Lagrange performs analyses on reconstruction of geographic range evolution on phylogenetic trees [<xref ref-type="bibr" rid="pcbi.1004763.ref011">11</xref>]. Phylomapper [<xref ref-type="bibr" rid="pcbi.1004763.ref063">63</xref>] is a statistical framework for estimating historical patterns of gene flow and ancestral geographic locations. RASP [<xref ref-type="bibr" rid="pcbi.1004763.ref077">77</xref>] infers ancestral state using statistical DIVA, Lagrange, Bayes-Lagrange, BayArea, and BBM methods. VIP [<xref ref-type="bibr" rid="pcbi.1004763.ref078">78</xref>] infers historical biogeography by examining disjunct geographic distributions.</p>
<p>Genome rearrangements provide valuable information in <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Comparative_genomics" xlink:type="simple">comparative genomics</ext-link> between species. ANGES [<xref ref-type="bibr" rid="pcbi.1004763.ref079">79</xref>] compares extant-related genomes through ancestral reconstruction of genetic markers. BADGER [<xref ref-type="bibr" rid="pcbi.1004763.ref080">80</xref>] uses a Bayesian approach to examining the history of gene rearrangement. Count [<xref ref-type="bibr" rid="pcbi.1004763.ref081">81</xref>] reconstructs the evolution of the size of gene families. EREM [<xref ref-type="bibr" rid="pcbi.1004763.ref082">82</xref>] analyses the gain and loss of genetic features encoded by binary characters. PARANA [<xref ref-type="bibr" rid="pcbi.1004763.ref083">83</xref>] performs parsimony-based inference of ancestral biological networks that represent gene loss and duplication.</p>
</sec>
<sec id="sec029">
<title>Web applications</title>
<p>Finally, there are several web server-based applications that allow investigators to use ML methods for ancestral reconstruction of different character types without having to install any software. For example, Ancestors [<xref ref-type="bibr" rid="pcbi.1004763.ref084">84</xref>] is a web server for ancestral genome reconstruction by the identification and arrangement of <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Synteny" xlink:type="simple">syntenic</ext-link> regions. FastML [<xref ref-type="bibr" rid="pcbi.1004763.ref085">85</xref>] is a web server for probabilistic reconstruction of ancestral sequences by ML that uses a gap character model for reconstructing <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Indel" xlink:type="simple">indel</ext-link> variation. MLGO [<xref ref-type="bibr" rid="pcbi.1004763.ref086">86</xref>] is a web server for ML gene order analysis.</p>
</sec>
</sec>
</sec>
<sec id="sec030">
<title>Future Directions</title>
<p>The development and application of computational algorithms for ancestral reconstruction continues to be an active area of research across disciplines. For example, the reconstruction of sequence insertions and deletions (indels) has lagged behind the more straightforward application of substitution models. Bouchard-Côté and Jordan recently described a new model (the Poisson Indel Process [<xref ref-type="bibr" rid="pcbi.1004763.ref087">87</xref>]) that represents an important advance on the archetypal Thorne-Kishino-Felsenstein model of indel evolution [<xref ref-type="bibr" rid="pcbi.1004763.ref088">88</xref>]. In addition, the field is being driven forward by rapid advances in the area of <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/DNA_sequencing#Next-generation_methods" xlink:type="simple">next-generation sequencing</ext-link> technology, where sequences are generated from millions of nucleic acid templates by extensive parallelization of sequencing reactions in a custom apparatus. These advances have made it possible to generate a <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Deep_sequencing" xlink:type="simple">"deep" snapshot</ext-link> of the genetic composition of a rapidly-evolving population, such as RNA viruses [<xref ref-type="bibr" rid="pcbi.1004763.ref089">89</xref>] or tumour cells [<xref ref-type="bibr" rid="pcbi.1004763.ref090">90</xref>], in a relatively short amount of time. At the same time, the massive amount of data and platform-specific sequencing error profiles has created new bioinformatic challenges for processing these data for ancestral sequence reconstruction.</p>
<p>The version history of the text file and the peer reviews (and response to reviews) are available as supporting information in <xref ref-type="supplementary-material" rid="pcbi.1004763.s001">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004763.s002">S2</xref> Texts.</p>
</sec>
<sec id="sec031">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004763.s001" mimetype="text/xml" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004763.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Version history of the text file.</title>
<p>(XML)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004763.s002" mimetype="text/xml" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004763.s002" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Peer reviews and response to reviews.</title>
<p>Human-readable versions of the reviews and authors' responses are available as comments on this article.</p>
<p>(XML)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<glossary>
<title>Abbreviations</title>
<def-list>
<def-item><term>BEAST</term>
<def><p>Bayesian Evolutionary Analysis by Sampling Trees</p></def>
</def-item>
<def-item><term>BiSSE</term>
<def><p>binary state speciation and extinction model</p></def>
</def-item>
<def-item><term>COT</term>
<def><p>center-of-tree</p></def>
</def-item>
<def-item><term>DEC</term>
<def><p>dispersal-extinction-cladogenesis</p></def>
</def-item>
<def-item><term>DIVA</term>
<def><p>dispersal-vicariance analysis</p></def>
</def-item>
<def-item><term>FP</term>
<def><p>Fitch parsimony</p></def>
</def-item>
<def-item><term>HIV</term>
<def><p>human immunodeficiency virus</p></def>
</def-item>
<def-item><term>MCMC</term>
<def><p>Markov chain Monte Carlo</p></def>
</def-item>
<def-item><term>ML</term>
<def><p>maximum likelihood</p></def>
</def-item>
<def-item><term>SM</term>
<def><p>stochastic mapping</p></def>
</def-item>
<def-item><term>UPGMA</term>
<def><p>unweighted pair group method with arithmetic mean</p></def>
</def-item>
</def-list>
</glossary>
<ref-list>
<title>References</title>
<ref id="pcbi.1004763.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Platnick</surname> <given-names>NI</given-names></name>, <name name-style="western"><surname>Cameron</surname> <given-names>HD</given-names></name>. <article-title>Cladistic methods in textual, linguistic, and phylogenetic analysis</article-title>. <source>Systematic Biology</source>. <year>1977</year>;<volume>26</volume>(<issue>4</issue>):<fpage>380</fpage>–<lpage>5</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tehrani</surname> <given-names>JJ</given-names></name>. <article-title>The phylogeny of little red riding hood</article-title>. <source>PloS ONE</source>. <year>2013</year>;<volume>8</volume>(<issue>11</issue>):<fpage>e78871</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0078871" xlink:type="simple">10.1371/journal.pone.0078871</ext-link></comment> <object-id pub-id-type="pmid">24236061</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Walker</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Hill</surname> <given-names>KR</given-names></name>, <name name-style="western"><surname>Flinn</surname> <given-names>MV</given-names></name>, <name name-style="western"><surname>Ellsworth</surname> <given-names>RM</given-names></name>. <article-title>Evolutionary history of hunter-gatherer marriage practices</article-title>. <source>PLoS ONE</source>. <year>2011</year>;<volume>6</volume>(<issue>4</issue>):<fpage>e19066</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0019066" xlink:type="simple">10.1371/journal.pone.0019066</ext-link></comment> <object-id pub-id-type="pmid">21556360</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pupko</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Pe</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Shamir</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Graur</surname> <given-names>D</given-names></name>. <article-title>A fast algorithm for joint reconstruction of ancestral amino acid sequences</article-title>. <source>Molecular Biology and Evolution</source>. <year>2000</year>;<volume>17</volume>(<issue>6</issue>):<fpage>890</fpage>–<lpage>6</lpage>. <object-id pub-id-type="pmid">10833195</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pagel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Meade</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Barker</surname> <given-names>D</given-names></name>. <article-title>Bayesian Estimation of Ancestral Character States on Phylogenies</article-title>. <source>Systematic Biology</source>. <year>2004</year>;<volume>53</volume>(<issue>5</issue>):<fpage>673</fpage>–<lpage>84</lpage>. <object-id pub-id-type="pmid">15545248</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sanger</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Thompson</surname> <given-names>EOP</given-names></name>, <name name-style="western"><surname>Kitai</surname> <given-names>R</given-names></name>. <article-title>The amide groups of insulin</article-title>. <source>Biochemical Journal</source>. <year>1955</year>;<volume>59</volume>(<issue>3</issue>):<fpage>509</fpage>. <object-id pub-id-type="pmid">14363129</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pauling</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Zuckerkand</surname> <given-names>E</given-names></name>. <article-title>Chemical Paleogenetics: Molecular "Restoration Studies" of Extinct Forms of Life</article-title>. <source>Acta Chemica Scandinavica</source>. <year>1963</year>;<volume>17</volume>:<fpage>9</fpage>–<lpage>16</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3891/acta.chem.scand.17s-0009" xlink:type="simple">10.3891/acta.chem.scand.17s-0009</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004763.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dobzhansky</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Sturtevant</surname> <given-names>AH</given-names></name>. <article-title>Inversions in the chromosomes of Drosophila pseudoobscura</article-title>. <source>Genetics</source>. <year>1938</year>;<volume>23</volume>(<issue>1</issue>):<fpage>28</fpage>. <object-id pub-id-type="pmid">17246876</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Harms</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Thornton</surname> <given-names>JW</given-names></name>. <article-title>Analyzing protein structure and function using ancestral gene reconstruction</article-title>. <source>Current opinion in structural biology</source>. <year>2010</year>;<volume>20</volume>(<issue>3</issue>):<fpage>360</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.sbi.2010.03.005" xlink:type="simple">10.1016/j.sbi.2010.03.005</ext-link></comment> <object-id pub-id-type="pmid">20413295</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Williams</surname> <given-names>PD</given-names></name>, <name name-style="western"><surname>Pollock</surname> <given-names>DD</given-names></name>, <name name-style="western"><surname>Blackburne</surname> <given-names>BP</given-names></name>, <name name-style="western"><surname>Goldstein</surname> <given-names>RA</given-names></name>. <article-title>Assessing the accuracy of ancestral protein reconstruction methods</article-title>. <source>PLoS Comput Biol</source>. <year>2006</year>;<volume>2</volume>(<issue>6</issue>):<fpage>e69</fpage>. <object-id pub-id-type="pmid">16789817</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ree</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>SA</given-names></name>. <article-title>Maximum likelihood inference of geographic range evolution by dispersal, local extinction, and cladogenesis</article-title>. <source>Systematic Biology</source>. <year>2008</year>;<volume>57</volume>(<issue>1</issue>):<fpage>4</fpage>–<lpage>14</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/10635150701883881" xlink:type="simple">10.1080/10635150701883881</ext-link></comment> <object-id pub-id-type="pmid">18253896</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lemey</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Rambaut</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Drummond</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Suchard</surname> <given-names>MA</given-names></name>. <article-title>Bayesian Phylogeography Finds Its Roots</article-title>. <source>PLoS Comput Biol</source>. <year>2009</year>;<volume>5</volume>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Watterson</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Ewens</surname> <given-names>WJ</given-names></name>, <name name-style="western"><surname>Hall</surname> <given-names>TE</given-names></name>, <name name-style="western"><surname>Morgan</surname> <given-names>A</given-names></name>. <article-title>The chromosome inversion problem</article-title>. <source>Journal of Theoretical Biology</source>. <year>1982</year>;<volume>99</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>7</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tuffley</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Steel</surname> <given-names>M</given-names></name>. <article-title>Links between maximum likelihood and maximum parsimony under a simple model of site substitution</article-title>. <source>Bulletin of mathematical biology</source>. <year>1997</year>;<volume>59</volume>(<issue>3</issue>):<fpage>581</fpage>–<lpage>607</lpage>. <object-id pub-id-type="pmid">9172826</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Swofford</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Maddison</surname> <given-names>WP</given-names></name>. <article-title>Reconstructing ancestral character states under Wagner parsimony</article-title>. <source>Mathematical Biosciences</source>. <year>1987</year>;<volume>87</volume>(<issue>2</issue>):<fpage>199</fpage>–<lpage>229</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fitch</surname> <given-names>WM</given-names></name>. <article-title>Toward defining the course of evolution: minimum change for a specific tree topology</article-title>. <source>Systematic Biology</source>. <year>1971</year>;<volume>20</volume>(<issue>4</issue>):<fpage>406</fpage>–<lpage>16</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stamatakis</surname> <given-names>A</given-names></name>. <article-title>RAxML-VI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>:<fpage>2688</fpage>–<lpage>90</lpage>. <object-id pub-id-type="pmid">16928733</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sankoff</surname> <given-names>D</given-names></name>. <article-title>Minimal mutation trees of sequences</article-title>. <source>SIAM Journal on Applied Mathematics</source>. <year>1975</year>;<volume>28</volume>(<issue>1</issue>):<fpage>35</fpage>–<lpage>42</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schluter</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Price</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Mooers</surname> <given-names>AO</given-names></name>, <name name-style="western"><surname>Ludwig</surname> <given-names>D</given-names></name>. <article-title>Likelihood of ancestor states in adaptive radiation</article-title>. <source>Evolution</source>. <year>1997</year>;<volume>51</volume>(<issue>6</issue>):<fpage>1699</fpage>–<lpage>711</lpage>. <object-id pub-id-type="pmid">ISI:000071652200001</object-id>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Felsenstein</surname> <given-names>J</given-names></name>. <article-title>Maximum likelihood and minimum-steps methods for estimating evolutionary trees from data on discrete characters</article-title>. <source>Systematic Biology</source>. <year>1973</year>;<volume>22</volume>(<issue>3</issue>):<fpage>240</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cunningham</surname> <given-names>CW</given-names></name>, <name name-style="western"><surname>Omland</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Oakley</surname> <given-names>TH</given-names></name>. <article-title>Reconstructing ancestral character states: a critical reappraisal</article-title>. <source>Trends in Ecology &amp; Evolution</source>. <year>1998</year>;<volume>13</volume>(<issue>9</issue>):<fpage>361</fpage>–<lpage>6</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Steel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>L</given-names></name>. <article-title>More taxa are not necessarily better for the reconstruction of ancestral character states</article-title>. <source>Systematic biology</source>. <year>2008</year>;<volume>57</volume>(<issue>4</issue>):<fpage>647</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/10635150802203898" xlink:type="simple">10.1080/10635150802203898</ext-link></comment> <object-id pub-id-type="pmid">18709600</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Felsenstein</surname> <given-names>J</given-names></name>. <article-title>Phylogenies and the comparative method</article-title>. <source>American Naturalist</source>. <year>1985</year>:<fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Kumar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Nei</surname> <given-names>M</given-names></name>. <article-title>A new method of inference of ancestral nucleotide and amino acid sequences</article-title>. <source>Genetics</source>. <year>1995</year>;<volume>141</volume>(<issue>4</issue>):<fpage>1641</fpage>–<lpage>50</lpage>. <object-id pub-id-type="pmid">8601501</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koshi</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Goldstein</surname> <given-names>RA</given-names></name>. <article-title>Probabilistic reconstruction of ancestral protein sequences</article-title>. <source>Journal of Molecular Evolution</source>. <year>1996</year>;<volume>42</volume>(<issue>2</issue>):<fpage>313</fpage>–<lpage>20</lpage>. <object-id pub-id-type="pmid">8919883</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pagel</surname> <given-names>M</given-names></name>. <article-title>The maximum likelihood approach to reconstructing ancestral character states of discrete characters on phylogenies</article-title>. <source>Systematic biology</source>. <year>1999</year>;<volume>48</volume>(<issue>3</issue>):<fpage>612</fpage>–<lpage>22</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Felsenstein</surname> <given-names>J</given-names></name>. <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>. <source>Journal of molecular evolution</source>. <year>1981</year>;<volume>17</volume>(<issue>6</issue>):<fpage>368</fpage>–<lpage>76</lpage>. <object-id pub-id-type="pmid">7288891</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eyre-Walker</surname> <given-names>A</given-names></name>. <article-title>Problems with parsimony in sequences of biased base composition</article-title>. <source>Journal of Molecular Evolution</source>. <year>1998</year>;<volume>47</volume>(<issue>6</issue>):<fpage>686</fpage>–<lpage>90</lpage>. <object-id pub-id-type="pmid">9847410</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pupko</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Pe'er</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Hasegawa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Graur</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Friedman</surname> <given-names>N</given-names></name>. <article-title>A branch-and-bound algorithm for the inference of ancestral amino-acid sequences when the replacement rate varies among sites: Application to the evolution of five gene families</article-title>. <source>Bioinformatics</source>. <year>2002</year>;<volume>18</volume>(<issue>8</issue>):<fpage>1116</fpage>–<lpage>23</lpage>. <object-id pub-id-type="pmid">12176835</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gruenheit</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Lockhart</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Steel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>W</given-names></name>. <article-title>Difficulties in testing for covarion-like properties of sequences under the confounding influence of changing proportions of variable sites</article-title>. <source>Molecular Biology and Evolution</source>. <year>2008</year>;<volume>25</volume>(<issue>7</issue>):<fpage>1512</fpage>–<lpage>20</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msn098" xlink:type="simple">10.1093/molbev/msn098</ext-link></comment> <object-id pub-id-type="pmid">18424773</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname> <given-names>Z</given-names></name>. <article-title>PAML 4: phylogenetic analysis by maximum likelihood</article-title>. <source>Molecular biology and evolution</source>. <year>2007</year>;<volume>24</volume>(<issue>8</issue>):<fpage>1586</fpage>–<lpage>91</lpage>. <object-id pub-id-type="pmid">17483113</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huelsenbeck</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Bollback</surname> <given-names>JP</given-names></name>. <article-title>Empirical and hierarchical Bayesian estimation of ancestral states</article-title>. <source>Systematic Biology</source>. <year>2001</year>;<volume>50</volume>(<issue>3</issue>):<fpage>351</fpage>–<lpage>66</lpage>. <object-id pub-id-type="pmid">ISI:000169823200006</object-id>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lutzoni</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Pagel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Reeb</surname> <given-names>V</given-names></name>. <article-title>Major fungal lineages are derived from lichen symbiotic ancestors</article-title>. <source>Nature</source>. <year>2001</year>;<volume>411</volume>(<issue>6840</issue>):<fpage>937</fpage>–<lpage>40</lpage>. <object-id pub-id-type="pmid">11418855</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hanson-Smith</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Kolaczkowski</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Thornton</surname> <given-names>JW</given-names></name>. <article-title>Robustness of ancestral sequence reconstruction to phylogenetic uncertainty</article-title>. <source>Molecular biology and evolution</source>. <year>2010</year>;<volume>27</volume>(<issue>9</issue>):<fpage>1988</fpage>–<lpage>99</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msq081" xlink:type="simple">10.1093/molbev/msq081</ext-link></comment> <object-id pub-id-type="pmid">20368266</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hillis</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Bull</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Badgett</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Molineux</surname> <given-names>IJ</given-names></name>. <article-title>Experimental phylogenetics: generation of a known phylogeny</article-title>. <source>Science</source>. <year>1992</year>;<volume>255</volume>(<issue>5044</issue>):<fpage>589</fpage>–<lpage>92</lpage>. <object-id pub-id-type="pmid">1736360</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oakley</surname> <given-names>TH</given-names></name>, <name name-style="western"><surname>Cunningham</surname> <given-names>CW</given-names></name>. <article-title>Independent contrasts succeed where ancestor reconstruction fails in a known bacteriophage phylogeny</article-title>. <source>Evolution</source>. <year>2000</year>;<volume>54</volume>(<issue>2</issue>):<fpage>397</fpage>–<lpage>405</lpage>. <object-id pub-id-type="pmid">10937216</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Finarelli</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Flynn</surname> <given-names>JJ</given-names></name>. <article-title>Ancestral state reconstruction of body size in the Caniformia (Carnivora, Mammalia): the effects of incorporating data from the fossil record</article-title>. <source>Systematic Biology</source>. <year>2006</year>;<volume>55</volume>(<issue>2</issue>):<fpage>301</fpage>–<lpage>13</lpage>. <object-id pub-id-type="pmid">16611601</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Albert</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Knouft</surname> <given-names>JH</given-names></name>. <article-title>Fossils provide better estimates of ancestral body size than do extant taxa in fishes</article-title>. <source>Acta Zoologica</source>. <year>2009</year>;<volume>90</volume>(<issue>s1</issue>):<fpage>357</fpage>–<lpage>84</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Slater</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Harmon</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Alfaro</surname> <given-names>ME</given-names></name>. <article-title>Integrating fossils with molecular phylogenies improves inference of trait evolution</article-title>. <source>Evolution</source>. <year>2012</year>;<volume>66</volume>(<issue>12</issue>):<fpage>3931</fpage>–<lpage>44</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1558-5646.2012.01723.x" xlink:type="simple">10.1111/j.1558-5646.2012.01723.x</ext-link></comment> <object-id pub-id-type="pmid">23206147</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Webster</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Purvis</surname> <given-names>A</given-names></name>. <article-title>Testing the accuracy of methods for reconstructing ancestral states of continuous characters</article-title>. <source>Proceedings of the Royal Society of London B: Biological Sciences</source>. <year>2002</year>;<volume>269</volume>(<issue>1487</issue>):<fpage>143</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maddison</surname> <given-names>WP</given-names></name>, <name name-style="western"><surname>Midford</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Otto</surname> <given-names>SP</given-names></name>. <article-title>Estimating a binary character's effect on speciation and extinction</article-title>. <source>Systematic biology</source>. <year>2007</year>;<volume>56</volume>(<issue>5</issue>):<fpage>701</fpage>–<lpage>10</lpage>. <object-id pub-id-type="pmid">17849325</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Martins</surname> <given-names>EP</given-names></name>. <article-title>Estimating the rate of phenotypic evolution from comparative data</article-title>. <source>American Naturalist</source>. <year>1994</year>:<fpage>193</fpage>–<lpage>209</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Elliot</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Mooers</surname> <given-names>AØ</given-names></name>. <article-title>Inferring ancestral states without assuming neutrality or gradualism using a stable model of continuous character evolution</article-title>. <source>BMC evolutionary biology</source>. <year>2014</year>;<volume>14</volume>(<issue>1</issue>):<fpage>226</fpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref044"><label>44</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Ridley</surname> <given-names>M</given-names></name>. <chapter-title>The explanation of organic diversity: the comparative method and adaptations for mating</chapter-title>. <publisher-loc>Oxford</publisher-loc>: <publisher-name>Clarendon Press</publisher-name>; <year>1983</year>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maddison</surname> <given-names>WP</given-names></name>. <article-title>A method for testing the correlated evolution of two binary characters: are gains or losses concentrated on certain branches of a phylogenetic tree?</article-title> <source>Evolution</source>. <year>1990</year>:<fpage>539</fpage>–<lpage>57</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Göbel</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Schneider</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Valencia</surname> <given-names>A</given-names></name>. <article-title>Correlated mutations and residue contacts in proteins</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>. <year>1994</year>;<volume>18</volume>(<issue>4</issue>):<fpage>309</fpage>–<lpage>17</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shindyalov</surname> <given-names>IN</given-names></name>, <name name-style="western"><surname>Kolchanov</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>. <article-title>Can three-dimensional contacts in protein structures be predicted by analysis of correlated mutations?</article-title> <source>Protein Engineering</source>. <year>1994</year>;<volume>7</volume>(<issue>3</issue>):<fpage>349</fpage>–<lpage>58</lpage>. <object-id pub-id-type="pmid">8177884</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Korber</surname> <given-names>BT</given-names></name>, <name name-style="western"><surname>Farber</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Wolpert</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Lapedes</surname> <given-names>AS</given-names></name>. <article-title>Covariation of mutations in the V3 loop of human immunodeficiency virus type 1 envelope protein: an information theoretic analysis</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1993</year>;<volume>90</volume>(<issue>15</issue>):<fpage>7176</fpage>–<lpage>80</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shapiro</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Rambaut</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Pybus</surname> <given-names>OG</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>EC</given-names></name>. <article-title>A phylogenetic method for detecting positive epistasis in gene sequences and its application to RNA virus evolution</article-title>. <source>Molecular biology and evolution</source>. <year>2006</year>;<volume>23</volume>(<issue>9</issue>):<fpage>1724</fpage>–<lpage>30</lpage>. <object-id pub-id-type="pmid">16774976</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Poon</surname> <given-names>AFY</given-names></name>, <name name-style="western"><surname>Lewis</surname> <given-names>FI</given-names></name>, <name name-style="western"><surname>Pond</surname> <given-names>SLK</given-names></name>, <name name-style="western"><surname>Frost</surname> <given-names>SDW</given-names></name>. <article-title>An evolutionary-network model reveals stratified interactions in the V3 loop of the HIV-1 envelope</article-title>. <source>PLoS Comput Biol</source>. <year>2007</year>;<volume>3</volume>(<issue>11</issue>):<fpage>e231</fpage>. <object-id pub-id-type="pmid">18039027</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gaschen</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Taylor</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Yusim</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Foley</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gao</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Lang</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Diversity considerations in HIV-1 vaccine selection</article-title>. <source>Science</source>. <year>2002</year>;<volume>296</volume>(<issue>5577</issue>):<fpage>2354</fpage>–<lpage>60</lpage>. <object-id pub-id-type="pmid">12089434</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rolland</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Jensen</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Nickle</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Yan</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Learn</surname> <given-names>GH</given-names></name>, <name name-style="western"><surname>Heath</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Reconstruction and function of ancestral center-of-tree human immunodeficiency virus type 1 proteins</article-title>. <source>Journal of virology</source>. <year>2007</year>;<volume>81</volume>(<issue>16</issue>):<fpage>8507</fpage>–<lpage>14</lpage>. <object-id pub-id-type="pmid">17537854</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kothe</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Decker</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Bibollet-Ruche</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Zammit</surname> <given-names>KP</given-names></name>, <name name-style="western"><surname>Salazar</surname> <given-names>MG</given-names></name>, <etal>et al</etal>. <article-title>Ancestral and consensus envelope immunogens for HIV-1 subtype C</article-title>. <source>Virology</source>. <year>2006</year>;<volume>352</volume>(<issue>2</issue>):<fpage>438</fpage>–<lpage>49</lpage>. <object-id pub-id-type="pmid">16780913</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Doria-Rose</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Learn</surname> <given-names>GH</given-names></name>, <name name-style="western"><surname>Rodrigo</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Nickle</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Mahalanabis</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Human immunodeficiency virus type 1 subtype B ancestral envelope protein is functional and elicits neutralizing antibodies in rabbits similar to those elicited by a circulating subtype B envelope</article-title>. <source>Journal of virology</source>. <year>2005</year>;<volume>79</volume>(<issue>17</issue>):<fpage>11214</fpage>–<lpage>24</lpage>. <object-id pub-id-type="pmid">16103173</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McCloskey</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Liang</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Harrigan</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Brumme</surname> <given-names>ZL</given-names></name>, <name name-style="western"><surname>Poon</surname> <given-names>AFY</given-names></name>. <article-title>An evaluation of phylogenetic methods for reconstructing transmitted HIV variants using longitudinal clonal HIV sequence data</article-title>. <source>Journal of virology</source>. <year>2014</year>;<volume>88</volume>(<issue>11</issue>):<fpage>6181</fpage>–<lpage>94</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/JVI.00483-14" xlink:type="simple">10.1128/JVI.00483-14</ext-link></comment> <object-id pub-id-type="pmid">24648453</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bourque</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Pevzner</surname> <given-names>PA</given-names></name>. <article-title>Genome-scale evolution: reconstructing gene orders in the ancestral species</article-title>. <source>Genome research</source>. <year>2002</year>;<volume>12</volume>(<issue>1</issue>):<fpage>26</fpage>–<lpage>36</lpage>. <object-id pub-id-type="pmid">11779828</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref057"><label>57</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Even</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Goldreich</surname> <given-names>O</given-names></name>. <article-title>The minimum-length generator sequence problem is NP-hard</article-title>. <source>Journal of Algorithms</source>. <year>1981</year>;<volume>2</volume>(<issue>3</issue>):<fpage>311</fpage>–<lpage>3</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref058"><label>58</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Fertin</surname> <given-names>G</given-names></name>. <chapter-title>Combinatorics of genome rearrangements</chapter-title>: <publisher-name>MIT press</publisher-name>; <year>2009</year>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref059"><label>59</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Clark</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Ree</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Alfaro</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>King</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Wagner</surname> <given-names>WL</given-names></name>, <name name-style="western"><surname>Roalson</surname> <given-names>EH</given-names></name>. <article-title>A comparative study in ancestral range reconstruction methods: retracing the uncertain histories of insular lineages</article-title>. <source>Systematic Biology</source>. <year>2008</year>;<volume>57</volume>(<issue>5</issue>):<fpage>693</fpage>–<lpage>707</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/10635150802426473" xlink:type="simple">10.1080/10635150802426473</ext-link></comment> <object-id pub-id-type="pmid">18853357</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref060"><label>60</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huelsenbeck</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Nielsen</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bollback</surname> <given-names>JP</given-names></name>. <article-title>Stochastic mapping of morphological characters</article-title>. <source>Systematic Biology</source>. <year>2003</year>;<volume>52</volume>(<issue>2</issue>):<fpage>131</fpage>–<lpage>58</lpage>. <object-id pub-id-type="pmid">ISI:000181839200001</object-id>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref061"><label>61</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Ronquist</surname> <given-names>F</given-names></name>. <chapter-title>DIVA version 1.2. Computer program for MacOS and Win32</chapter-title>. <publisher-name>Evolutionary Biology Centre, Uppsala University</publisher-name> Available at <ext-link ext-link-type="uri" xlink:href="http://www.ebcuuse/systzoo/research/diva/diva" xlink:type="simple">http://www.ebcuuse/systzoo/research/diva/diva</ext-link> html. <year>2001</year>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref062"><label>62</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ree</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Moore</surname> <given-names>BR</given-names></name>, <name name-style="western"><surname>Webb</surname> <given-names>CO</given-names></name>, <name name-style="western"><surname>Donoghue</surname> <given-names>MJ</given-names></name>. <article-title>A likelihood framework for inferring the evolution of geographic range on phylogenetic trees</article-title>. <source>Evolution</source>. <year>2005</year>;<volume>59</volume>(<issue>11</issue>):<fpage>2299</fpage>–<lpage>311</lpage>. <object-id pub-id-type="pmid">16396171</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref063"><label>63</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lemmon</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Lemmon</surname> <given-names>EM</given-names></name>. <article-title>A likelihood framework for estimating phylogeographic history on a continuous landscape</article-title>. <source>Systematic Biology</source>. <year>2008</year>;<volume>57</volume>(<issue>4</issue>):<fpage>544</fpage>–<lpage>61</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/10635150802304761" xlink:type="simple">10.1080/10635150802304761</ext-link></comment> <object-id pub-id-type="pmid">18686193</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref064"><label>64</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sturtevant</surname> <given-names>AH</given-names></name>, <name name-style="western"><surname>Dobzhansky</surname> <given-names>T</given-names></name>. <article-title>Geographical Distribution and Cytology of" Sex Ratio" in Drosophila Pseudoobscura and Related Species</article-title>. <source>Genetics</source>. <year>1936</year>;<volume>21</volume>(<issue>4</issue>):<fpage>473</fpage>. <object-id pub-id-type="pmid">17246805</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref065"><label>65</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Campbell</surname> <given-names>L</given-names></name>. <chapter-title>Historical linguistics</chapter-title>: <publisher-name>Edinburgh University Press</publisher-name>; <year>2013</year>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref066"><label>66</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Pond</surname> <given-names>SLK</given-names></name>, <name name-style="western"><surname>Muse</surname> <given-names>SV</given-names></name>. <chapter-title>HyPhy: hypothesis testing using phylogenies</chapter-title>. <source>Statistical methods in molecular evolution:</source> <publisher-name>Springer</publisher-name>; <year>2005</year>. p. <fpage>125</fpage>–<lpage>81</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref067"><label>67</label><mixed-citation publication-type="other" xlink:type="simple">Maddison W, Maddison D. Mesquite: a modular system for evolutionary analysis. 2.75 ed20011.</mixed-citation></ref>
<ref id="pcbi.1004763.ref068"><label>68</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tamura</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Dudley</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Nei</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kumar</surname> <given-names>S</given-names></name>. <article-title>MEGA4: molecular evolutionary genetics analysis (MEGA) software version 4.0</article-title>. <source>Molecular biology and evolution</source>. <year>2007</year>;<volume>24</volume>(<issue>8</issue>):<fpage>1596</fpage>–<lpage>9</lpage>. <object-id pub-id-type="pmid">17488738</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref069"><label>69</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huelsenbeck</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Ronquist</surname> <given-names>F</given-names></name>. <article-title>MRBAYES: Bayesian inference of phylogenetic trees</article-title>. <source>Bioinformatics</source>. <year>2001</year>;<volume>17</volume>(<issue>8</issue>):<fpage>754</fpage>–<lpage>5</lpage>. <object-id pub-id-type="pmid">ISI:000171021000016</object-id>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref070"><label>70</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hubisz</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Pollard</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Siepel</surname> <given-names>A</given-names></name>. <article-title>PHAST and RPHAST: phylogenetic analysis with space/time models</article-title>. <source>Briefings in bioinformatics</source>. <year>2011</year>;<volume>12</volume>(<issue>1</issue>):<fpage>41</fpage>–<lpage>51</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bib/bbq072" xlink:type="simple">10.1093/bib/bbq072</ext-link></comment> <object-id pub-id-type="pmid">21278375</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref071"><label>71</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bollback</surname> <given-names>JP</given-names></name>. <article-title>SIMMAP: stochastic character mapping of discrete traits on phylogenies</article-title>. <source>BMC bioinformatics</source>. <year>2006</year>;<volume>7</volume>(<issue>1</issue>):<fpage>88</fpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref072"><label>72</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Paradis</surname> <given-names>E</given-names></name>. <chapter-title>Analysis of phylogenetics and evolution with R</chapter-title>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>2006</year>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref073"><label>73</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rossnes</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Eidhammer</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Liberles</surname> <given-names>DA</given-names></name>. <article-title>Phylogenetic reconstruction of ancestral character states for gene expression and mRNA splicing data</article-title>. <source>BMC bioinformatics</source>. <year>2005</year>;<volume>6</volume>(<issue>1</issue>):<fpage>127</fpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref074"><label>74</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bouckaert</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Heled</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kühnert</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Vaughan</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Wu C-</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>BEAST 2: a software platform for Bayesian evolutionary analysis</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>(<issue>4</issue>):<fpage>e1003537</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003537" xlink:type="simple">10.1371/journal.pcbi.1003537</ext-link></comment> <object-id pub-id-type="pmid">24722319</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref075"><label>75</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>FitzJohn</surname> <given-names>RG</given-names></name>. <article-title>Diversitree: comparative phylogenetic analyses of diversification in R</article-title>. <source>Methods in Ecology and Evolution</source>. <year>2012</year>;<volume>3</volume>(<issue>6</issue>):<fpage>1084</fpage>–<lpage>92</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref076"><label>76</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pagel</surname> <given-names>M</given-names></name>. <article-title>Detecting Correlated Evolution on Phylogenies—a General- Method for the Comparative-Analysis of Discrete Characters</article-title>. <source>Proceedings of the Royal Society of London Series B-Biological Sciences</source>. <year>1994</year>;<volume>255</volume>(<issue>1342</issue>):<fpage>37</fpage>–<lpage>45</lpage>. <object-id pub-id-type="pmid">ISI:A1994MT55500006</object-id>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref077"><label>77</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Harris</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Blair</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>He</surname> <given-names>X</given-names></name>. <article-title>RASP (Reconstruct Ancestral State in Phylogenies): a tool for historical biogeography</article-title>. <source>Molecular Phylogenetics and Evolution</source>. <year>2015</year>;<volume>87</volume>:<fpage>46</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.ympev.2015.03.008" xlink:type="simple">10.1016/j.ympev.2015.03.008</ext-link></comment> <object-id pub-id-type="pmid">25819445</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref078"><label>78</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Arias</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Szumik</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Goloboff</surname> <given-names>PA</given-names></name>. <article-title>Spatial analysis of vicariance: a method for using direct geographical information in historical biogeography</article-title>. <source>Cladistics</source>. <year>2011</year>;<volume>27</volume>(<issue>6</issue>):<fpage>617</fpage>–<lpage>28</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref079"><label>79</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jones</surname> <given-names>BR</given-names></name>, <name name-style="western"><surname>Rajaraman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tannier</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Chauve</surname> <given-names>C</given-names></name>. <article-title>ANGES: reconstructing ANcestral GEnomeS maps</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>18</issue>):<fpage>2388</fpage>–<lpage>90</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts457" xlink:type="simple">10.1093/bioinformatics/bts457</ext-link></comment> <object-id pub-id-type="pmid">22820205</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref080"><label>80</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Larget</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Kadane</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Simon</surname> <given-names>DL</given-names></name>. <article-title>A Bayesian approach to the estimation of ancestral genome arrangements</article-title>. <source>Molecular phylogenetics and evolution</source>. <year>2005</year>;<volume>36</volume>(<issue>2</issue>):<fpage>214</fpage>–<lpage>23</lpage>. <object-id pub-id-type="pmid">15893477</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref081"><label>81</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Csűös</surname> <given-names>M</given-names></name>. <article-title>Count: evolutionary analysis of phylogenetic profiles with parsimony and likelihood</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>15</issue>):<fpage>1910</fpage>–<lpage>2</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq315" xlink:type="simple">10.1093/bioinformatics/btq315</ext-link></comment> <object-id pub-id-type="pmid">20551134</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref082"><label>82</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Affre</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Thompson</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Debussche</surname> <given-names>M</given-names></name>. <article-title>Genetic structure of continental and island populations of the Mediterranean endemic Cyclamen balearicum (Primulaceae)</article-title>. <source>American Journal of Botany</source>. <year>1997</year>;<volume>84</volume>(<issue>4</issue>):<fpage>437</fpage>–<lpage>51</lpage>. <object-id pub-id-type="pmid">ISI:A1997WV34000002</object-id>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref083"><label>83</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Patro</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Sefer</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Malin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Marçais</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Navlakha</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kingsford</surname> <given-names>C</given-names></name>. <article-title>Parsimonious reconstruction of network evolution</article-title>. <source>Algorithms for Molecular Biology</source>. <year>2012</year>;<volume>7</volume>(<issue>1</issue>):<fpage>1</fpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref084"><label>84</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Diallo</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Makarenkov</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Blanchette</surname> <given-names>M</given-names></name>. <article-title>Ancestors 1.0: a web server for ancestral sequence reconstruction</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>1</issue>):<fpage>130</fpage>–<lpage>1</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp600" xlink:type="simple">10.1093/bioinformatics/btp600</ext-link></comment> <object-id pub-id-type="pmid">19850756</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref085"><label>85</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ashkenazy</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Penn</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Doron-Faigenboim</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Cannarozzi</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Zomer</surname> <given-names>O</given-names></name>, <etal>et al</etal>. <article-title>FastML: a web server for probabilistic reconstruction of ancestral sequences</article-title>. <source>Nucleic acids research</source>. <year>2012</year>;<volume>40</volume>(<issue>W1</issue>):<fpage>W580</fpage>–<lpage>W4</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref086"><label>86</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hu</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>J</given-names></name>. <article-title>MLGO: phylogeny reconstruction and ancestral inference from gene-order data</article-title>. <source>BMC bioinformatics</source>. <year>2014</year>;<volume>15</volume>(<issue>1</issue>):<fpage>1</fpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref087"><label>87</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bouchard-Côté</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jordan</surname> <given-names>MI</given-names></name>. <article-title>Evolutionary inference via the Poisson indel process</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2013</year>;<volume>110</volume>(<issue>4</issue>):<fpage>1160</fpage>–<lpage>6</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004763.ref088"><label>88</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thorne</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Kishino</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Felsenstein</surname> <given-names>J</given-names></name>. <article-title>An evolutionary model for maximum likelihood alignment of DNA sequences</article-title>. <source>Journal of Molecular Evolution</source>. <year>1991</year>;<volume>33</volume>(<issue>2</issue>):<fpage>114</fpage>–<lpage>24</lpage>. <object-id pub-id-type="pmid">1920447</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref089"><label>89</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Poon</surname> <given-names>AFY</given-names></name>, <name name-style="western"><surname>Swenson</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Bunnik</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Edo-Matas</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Schuitemaker</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>van't Wout</surname> <given-names>AB</given-names></name>, <etal>et al</etal>. <article-title>Reconstructing the dynamics of HIV evolution within hosts from serial deep sequence data</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>11</issue>):<fpage>e1002753</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002753" xlink:type="simple">10.1371/journal.pcbi.1002753</ext-link></comment> <object-id pub-id-type="pmid">23133358</object-id></mixed-citation></ref>
<ref id="pcbi.1004763.ref090"><label>90</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwarz</surname> <given-names>RF</given-names></name>, <name name-style="western"><surname>Trinh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sipos</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Brenton</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Goldman</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Markowetz</surname> <given-names>F</given-names></name>. <article-title>Phylogenetic quantification of intra-tumour heterogeneity</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>(<issue>4</issue>):<fpage>e1003535</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003535" xlink:type="simple">10.1371/journal.pcbi.1003535</ext-link></comment> <object-id pub-id-type="pmid">24743184</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>