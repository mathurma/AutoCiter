<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01813</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005507</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Condensed matter physics</subject><subj-group><subject>Mesoscopic physics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population dynamics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population metrics</subject><subj-group><subject>Population density</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Single neuron function</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Single neuron function</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Towards a theory of cortical columns: From spiking neurons to interacting neural populations of finite size</article-title>
<alt-title alt-title-type="running-head">Mesoscopic dynamics of interacting populations of spiking neurons</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5422-3723</contrib-id>
<name name-style="western">
<surname>Schwalger</surname> <given-names>Tilo</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2775-2611</contrib-id>
<name name-style="western">
<surname>Deger</surname> <given-names>Moritz</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Gerstner</surname> <given-names>Wulfram</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Brain Mind Institute, School of Computer and Communication Sciences and School of Life Sciences, École Polytechnique Fédérale de Lausanne (EPFL), Lausanne, Switzerland</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Institute for Zoology, Faculty of Mathematics and Natural Sciences, University of Cologne, Cologne, Germany</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Graham</surname> <given-names>Lyle J.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Université Paris Descartes, Centre National de la Recherche Scientifique, FRANCE</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item>
<p><bold>Conceptualization:</bold> WG TS MD.</p>
</list-item>
<list-item>
<p><bold>Data curation:</bold> MD TS.</p>
</list-item>
<list-item>
<p><bold>Formal analysis:</bold> TS.</p>
</list-item>
<list-item>
<p><bold>Funding acquisition:</bold> WG.</p>
</list-item>
<list-item>
<p><bold>Investigation:</bold> TS MD.</p>
</list-item>
<list-item>
<p><bold>Methodology:</bold> TS.</p>
</list-item>
<list-item>
<p><bold>Software:</bold> TS MD.</p>
</list-item>
<list-item>
<p><bold>Supervision:</bold> WG.</p>
</list-item>
<list-item>
<p><bold>Visualization:</bold> TS.</p>
</list-item>
<list-item>
<p><bold>Writing – original draft:</bold> TS WG MD.</p>
</list-item>
<list-item>
<p><bold>Writing – review &amp; editing:</bold> TS WG MD.</p>
</list-item>
</list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">tilo.schwalger@epfl.ch</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>4</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>19</day>
<month>4</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>4</issue>
<elocation-id>e1005507</elocation-id>
<history>
<date date-type="received">
<day>4</day>
<month>11</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>7</day>
<month>4</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Schwalger et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005507"/>
<abstract>
<p>Neural population equations such as neural mass or field models are widely used to study brain activity on a large scale. However, the relation of these models to the properties of single neurons is unclear. Here we derive an equation for several interacting populations at the mesoscopic scale starting from a microscopic model of randomly connected generalized integrate-and-fire neuron models. Each population consists of 50–2000 neurons of the same type but different populations account for different neuron types. The stochastic population equations that we find reveal how spike-history effects in single-neuron dynamics such as refractoriness and adaptation interact with finite-size fluctuations on the population level. Efficient integration of the stochastic mesoscopic equations reproduces the statistical behavior of the population activities obtained from microscopic simulations of a full spiking neural network model. The theory describes nonlinear emergent dynamics such as finite-size-induced stochastic transitions in multistable networks and synchronization in balanced networks of excitatory and inhibitory neurons. The mesoscopic equations are employed to rapidly integrate a model of a cortical microcircuit consisting of eight neuron types, which allows us to predict spontaneous population activities as well as evoked responses to thalamic input. Our theory establishes a general framework for modeling finite-size neural population dynamics based on single cell and synapse parameters and offers an efficient approach to analyzing cortical circuits and computations.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Understanding the brain requires mathematical models on different spatial scales. On the “microscopic” level of nerve cells, neural spike trains can be well predicted by phenomenological spiking neuron models. On a coarse scale, neural activity can be modeled by phenomenological equations that summarize the total activity of many thousands of neurons. Such population models are widely used to model neuroimaging data such as EEG, MEG or fMRI data. However, it is largely unknown how large-scale models are connected to an underlying microscale model. Linking the scales is vital for a correct description of rapid changes and fluctuations of the population activity, and is crucial for multiscale brain models. The challenge is to treat realistic spiking dynamics as well as fluctuations arising from the finite number of neurons. We obtained such a link by deriving stochastic population equations on the mesoscopic scale of 100–1000 neurons from an underlying microscopic model. These equations can be efficiently integrated and reproduce results of a microscopic simulation while achieving a high speed-up factor. We expect that our novel population theory on the mesoscopic scale will be instrumental for understanding experimental data on information processing in the brain, and ultimately link microscopic and macroscopic activity patterns.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100007601</institution-id>
<institution>Horizon 2020</institution>
</institution-wrap>
</funding-source>
<award-id>720270</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5422-3723</contrib-id>
<name name-style="western">
<surname>Schwalger</surname> <given-names>Tilo</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100007601</institution-id>
<institution>Horizon 2020</institution>
</institution-wrap>
</funding-source>
<award-id>720270</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2775-2611</contrib-id>
<name name-style="western">
<surname>Deger</surname> <given-names>Moritz</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100007601</institution-id>
<institution>Horizon 2020</institution>
</institution-wrap>
</funding-source>
<award-id>720270</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Gerstner</surname> <given-names>Wulfram</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution>European Research Council (BE)</institution>
</funding-source>
<award-id>268689</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5422-3723</contrib-id>
<name name-style="western">
<surname>Schwalger</surname> <given-names>Tilo</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000781</institution-id>
<institution>European Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>268689</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Gerstner</surname> <given-names>Wulfram</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This project received funding from the European Union’s Horizon 2020 research and innovation programme under grant agreement No. 720270 and from the European Research Council under grant agreement No. 268689, MultiRules. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="12"/>
<table-count count="2"/>
<page-count count="63"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-05-03</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>When neuroscientists report electrophysiological, genetic, or anatomical data from a cortical neuron, they typically refer to the cell type, say, a layer 2/3 fast-spiking interneuron, a parvalbumin-positive neuron in layer 5, or a Martinotti cell in layer 4, together with the area, say primary visual cortex or somatosensory cortex [<xref ref-type="bibr" rid="pcbi.1005507.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref004">4</xref>]. Whatever the specific taxonomy used, the fact that a taxonomy is plausible at all indicates that neurons can be viewed as being organized into populations of cells with similar properties. In simulation studies of cortical networks with spiking neurons, the number of different cell types, or neuronal populations, per cortical column ranges from eight [<xref ref-type="bibr" rid="pcbi.1005507.ref005">5</xref>] to about 200 [<xref ref-type="bibr" rid="pcbi.1005507.ref006">6</xref>] with 31’000 to 80’000 simulated neurons for one cortical column, but larger simulations of several columns adding up to a million neurons (and 22 cells types) have also been performed [<xref ref-type="bibr" rid="pcbi.1005507.ref007">7</xref>]. In the following, we will refer to a model where each neuron in each population is simulated explicitly by a spiking neuron model as a <italic>microscopic</italic> model.</p>
<p>On a much coarser level, neural mass models [<xref ref-type="bibr" rid="pcbi.1005507.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref010">10</xref>], also called field models [<xref ref-type="bibr" rid="pcbi.1005507.ref011">11</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref013">13</xref>], population activity equations [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>], rate models [<xref ref-type="bibr" rid="pcbi.1005507.ref015">15</xref>], or Wilson-Cowan models [<xref ref-type="bibr" rid="pcbi.1005507.ref016">16</xref>] represent the activity of a cortical column at location <italic>x</italic> by one or at most a few variables, such as the mean activity of excitatory and inhibitory neurons located in the region around <italic>x</italic>. Computational frameworks related to neural mass models have been used to interpret data from fMRI [<xref ref-type="bibr" rid="pcbi.1005507.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref018">18</xref>] and EEG [<xref ref-type="bibr" rid="pcbi.1005507.ref009">9</xref>]. Since neural mass models give a compact summary of coarse neural activity, they can be efficiently simulated and fit to experimental data [<xref ref-type="bibr" rid="pcbi.1005507.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref018">18</xref>].</p>
<p>However, neural mass models have several disadvantages. While the stationary state of neural mass activity can be matched to the single-neuron gain function and hence to detailed neuron models [<xref ref-type="bibr" rid="pcbi.1005507.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref019">19</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref022">22</xref>], the dynamics of neural mass models in response to a rapid change in the input does not correctly reproduce a microscopic simulation of a population of neurons [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref023">23</xref>]. Second, fluctuations of activity variables in neural mass models are either absent or described by an <italic>ad hoc</italic> noise model. Moreover, the links of neural mass models to local field potentials are difficult to establish [<xref ref-type="bibr" rid="pcbi.1005507.ref024">24</xref>]. Because a systematic link to microscopic models at the level of spiking neurons is missing, existing neural mass models must be considered as heuristic phenomenological, albeit successful, descriptions of neural activity.</p>
<p>In this paper we address the question of whether equations for the activity of populations, similar in spirit but not necessarily identical to Wilson-Cowan equations [<xref ref-type="bibr" rid="pcbi.1005507.ref016">16</xref>], can be systematically derived from the interactions of spiking neurons at the level of microscopic models. At the microscopic level, we start from generalized integrate-and-fire (GIF) models [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref026">26</xref>] because, first, the parameters of such GIF models can be directly, and efficiently, extracted from experiments [<xref ref-type="bibr" rid="pcbi.1005507.ref027">27</xref>] and, second, GIF models can predict neuronal adaptation under step-current input [<xref ref-type="bibr" rid="pcbi.1005507.ref028">28</xref>] as well as neuronal firing times under in-vivo-like input [<xref ref-type="bibr" rid="pcbi.1005507.ref026">26</xref>]. In our modeling framework, the GIF neurons are organized into different interacting populations. The populations may correspond to different cell types within a cortical column with known statistical connectivity patterns [<xref ref-type="bibr" rid="pcbi.1005507.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref006">6</xref>]. Because of the split into different cell types, the number of neurons per population (e.g., fast-spiking inhibitory interneurons in layer 2/3) is finite and in the range of 50–2000 [<xref ref-type="bibr" rid="pcbi.1005507.ref003">3</xref>]. We call a model at the level of interacting cortical populations of finite size a <italic>mesoscopic</italic> model. The mathematical derivation of the mesoscopic model equations from the microscopic model (i.e. network of generalized integrate-and-fire neurons) is the main topic of this paper. The small number of neurons per population is expected to lead to characteristic fluctuations of the activity which should match those of the microscopic model.</p>
<p>The overall aims of our approach are two-fold. As a first aim, this study would like to develop a theoretical framework for cortical information processing. The main advantage of a systematic link between neuronal parameters and mesoscopic activity is that we can quantitatively predict the effect of changes of neuronal parameters in (or of input to) one population on the activation pattern of this as well as other populations. In particular, we expect that a valid mesoscopic model of interacting cortical populations will become useful to predict the outcome of experiments such as optogenetic stimulation of a subgroup of neurons [<xref ref-type="bibr" rid="pcbi.1005507.ref029">29</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref031">31</xref>]. A better understanding of the activity patterns within a cortical column may in turn, after suitable postprocessing, provide a novel basis for models of EEG, fMRI, or LFP [<xref ref-type="bibr" rid="pcbi.1005507.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref024">24</xref>]. While we cannot address all these points in this paper, we present an example of nontrivial activity patterns in a network model with stochastic switching between different activity states potentially linked to perceptual bistability [<xref ref-type="bibr" rid="pcbi.1005507.ref032">32</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref034">34</xref>] or resting state activity [<xref ref-type="bibr" rid="pcbi.1005507.ref018">18</xref>].</p>
<p>As a second aim, this study would like to contribute to multiscale simulation approaches [<xref ref-type="bibr" rid="pcbi.1005507.ref035">35</xref>] in the neurosciences by providing a new tool for efficient and consistent coarse-grained simulation at the mesoscopic scale. Understanding the computations performed by the nervous system is likely to require models on different levels of spatial scales, ranging from pharmacological interactions at the subcellular and cellular levels to cognitive processes at the level of large-scale models of the brain. Ideally, a modeling framework should be efficient and consistent across scales in the following sense. Suppose, for example, that we are interested in neuronal membrane potentials in one specific group of neurons which receives input from many other groups of neurons. In a microscopic model, all neurons would be simulated at the same level; in a multi-scale simulation approach, only the group of neurons where we study the membrane potentials is simulated at the microscopic level, whereas the input from other groups is replaced by the activity of the mesoscopic model. A multiscale approach is consistent, if the replacement of parts of the microscopic simulation by a mesoscopic simulation does not lead to any change in the observed pattern of membrane potentials in the target population. The approach is efficient if the change of simulation scale leads to a significant speed-up of simulation. While we do not intend to present a systematic comparison of computational performance, we provide an example and measure the speed-up factor between mesoscopic and microscopic simulation for the case of a cortical column consisting of eight populations [<xref ref-type="bibr" rid="pcbi.1005507.ref005">5</xref>].</p>
<p>Despite of its importance, a quantitative link between mesoscopic population models and microscopic neuronal parameters is still largely lacking. This is mainly due to two obstacles: First, in a cortical column the number of neurons of the same type is small (50–2000 [<xref ref-type="bibr" rid="pcbi.1005507.ref003">3</xref>]) and hence far from the <italic>N</italic> → ∞ limit of classic “macroscopic” theories in which fluctuations vanish [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref036">36</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref038">38</xref>]. Systematic treatments of finite-size networks using methods from statistical physics (system size expansion [<xref ref-type="bibr" rid="pcbi.1005507.ref039">39</xref>], path integral methods [<xref ref-type="bibr" rid="pcbi.1005507.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref041">41</xref>], neural Langevin equations [<xref ref-type="bibr" rid="pcbi.1005507.ref042">42</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref045">45</xref>]) have so far been limited to simplified Markov models that lack, however, a clear connection to single neuron physiology.</p>
<p>Second, spikes generated by a neuron are generally correlated in time due to refractoriness [<xref ref-type="bibr" rid="pcbi.1005507.ref046">46</xref>], adaptation and other spike history dependencies [<xref ref-type="bibr" rid="pcbi.1005507.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref047">47</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref051">51</xref>]. Therefore spike trains are often not well described by an (inhomogeneous) Poisson process, especially during periods of high firing rates [<xref ref-type="bibr" rid="pcbi.1005507.ref046">46</xref>]. As a consequence, the mesoscopic population activity (i.e. the sum of spike trains) is generally not simply captured by a Poisson model either [<xref ref-type="bibr" rid="pcbi.1005507.ref052">52</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref054">54</xref>], even in the absence of synaptic couplings [<xref ref-type="bibr" rid="pcbi.1005507.ref055">55</xref>]. These non-Poissonian finite-size fluctuations on the mesoscopic level in turn imply temporally correlated synaptic input to other neurons (colored noise) that can drastically influence the population activity [<xref ref-type="bibr" rid="pcbi.1005507.ref053">53</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref054">54</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref056">56</xref>] but which is hard to tackle analytically [<xref ref-type="bibr" rid="pcbi.1005507.ref057">57</xref>]. Therefore, most theoretical approaches rely on a white-noise or Poisson assumption to describe the synaptic input [<xref ref-type="bibr" rid="pcbi.1005507.ref058">58</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref062">62</xref>], thereby neglecting temporal correlations caused by spike-history dependencies in single neuron activity. Here, we will exploit earlier approaches to treating refractoriness [<xref ref-type="bibr" rid="pcbi.1005507.ref023">23</xref>] and spike frequency adaptation [<xref ref-type="bibr" rid="pcbi.1005507.ref055">55</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref063">63</xref>] and combine these with a novel treatment of finite-size fluctuations.</p>
<p>Our approach is novel for several reasons. First, we use generalized integrate-and-fire models that accurately describe neuronal data [<xref ref-type="bibr" rid="pcbi.1005507.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref026">26</xref>] as our microscopic reference. Second, going beyond earlier studies [<xref ref-type="bibr" rid="pcbi.1005507.ref058">58</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref060">60</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref064">64</xref>], we derive stochastic population equations that account for both strong neuronal refractoriness and finite population size in a consistent manner. Third, our theory has a non-perturbative character as it neither assumes the self-coupling (refractoriness and adaptation) to be weak [<xref ref-type="bibr" rid="pcbi.1005507.ref065">65</xref>] nor does it hinge on an expansion around the <italic>N</italic> → ∞ solution for large but finite <italic>N</italic> [<xref ref-type="bibr" rid="pcbi.1005507.ref055">55</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref066">66</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref067">67</xref>]. Thus, it is also valid for relatively small populations and non-Gaussian fluctuations. And forth, in contrast to linear response theories [<xref ref-type="bibr" rid="pcbi.1005507.ref055">55</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref068">68</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref072">72</xref>], our mesoscopic equations work far away from stationary states and reproduce large fluctuations in multistable networks.</p>
<p>In the R<sc>esults</sc> section we present our mesoscopic population equations, suggest an efficient numerical implementation, and illustrate the main dynamical effects via a selected number of examples. To validate the mesoscopic theory we numerically integrate the stochastic differential equations for the mesoscopic population activities and compare their statistics to those of the population activities derived from a microscopic simulation. A detailed account of the derivation is presented in the M<sc>ethods</sc> section. In the discussion section we point out limitations and possible applications of our mesoscopic theory.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>We consider a structured network of interacting homogeneous populations. Homogeneous here means that each population consists of spiking neurons with similar intrinsic properties and random connectivity within and between populations. To define such populations, one may think of grouping neurons into genetically-defined cell classes of excitatory and inhibitory neurons [<xref ref-type="bibr" rid="pcbi.1005507.ref004">4</xref>], or, more traditionally, into layers and cell types (<xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1A</xref>). For example, pyramidal cells in layer 2/3 of rodent somatosensory cortex corresponding to whisker C2 form a population of about 1700 neurons [<xref ref-type="bibr" rid="pcbi.1005507.ref003">3</xref>]. Pyramidal cells in layer 5 of the same cortical column form another one (∼1200 neurons [<xref ref-type="bibr" rid="pcbi.1005507.ref003">3</xref>]), fast-spiking inhibitory cells in layer 2/3 a third one (∼100 neurons [<xref ref-type="bibr" rid="pcbi.1005507.ref003">3</xref>]) and non-fast-spiking inhibitory cells in layer 2/3 a fourth one (∼130 neurons [<xref ref-type="bibr" rid="pcbi.1005507.ref003">3</xref>]), and so on [<xref ref-type="bibr" rid="pcbi.1005507.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref073">73</xref>]. We suppose that the parameters of typical neurons from each population [<xref ref-type="bibr" rid="pcbi.1005507.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref073">73</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref074">74</xref>], the number of neurons per population [<xref ref-type="bibr" rid="pcbi.1005507.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref073">73</xref>] and the typical connection probabilities [<xref ref-type="bibr" rid="pcbi.1005507.ref005">5</xref>] and strengths within and between populations [<xref ref-type="bibr" rid="pcbi.1005507.ref073">73</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref075">75</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref079">79</xref>] are known from experimental data. The resulting spiking neural network can be simulated on a cellular level by numerical integration of the spiking dynamics of each individual neuron (<xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1B</xref>). In the following, we will refer to this level of description as the <italic>microscopic</italic> level. Apart from being computationally expensive, the full microscopic network dynamics is highly complex and hence difficult to understand. To overcome these shortcomings, we have developed a new mean-field description for the mesoscopic dynamics of interacting populations.</p>
<fig id="pcbi.1005507.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005507.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Illustration of population models on the microscopic and mesoscopic level.</title>
<p>(A) Cortical column model [<xref ref-type="bibr" rid="pcbi.1005507.ref005">5</xref>] with ∼ 80’000 neurons organized into four layers (L2/3, L4, L5, L6) each consisting of an excitatory (“e”) and an inhibitory (“i”) population. On the microscopic level, each individual neuron is described by a generalized integrate-and-fire (GIF) model with membrane potential <inline-formula id="pcbi.1005507.e001"><alternatives><graphic id="pcbi.1005507.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, dynamic threshold <inline-formula id="pcbi.1005507.e002"><alternatives><graphic id="pcbi.1005507.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and conditional intensity <inline-formula id="pcbi.1005507.e003"><alternatives><graphic id="pcbi.1005507.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msup><mml:mi>f</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Inset: GIF dynamics for a specific neuron <italic>i</italic> of population L4e (<italic>α</italic> = L4e). The neuron receives spikes from neurons in L4e, L4i and L6e, which drive the membrane potential <inline-formula id="pcbi.1005507.e004"><alternatives><graphic id="pcbi.1005507.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Spikes are elicited stochastically by a conditional intensity <inline-formula id="pcbi.1005507.e005"><alternatives><graphic id="pcbi.1005507.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>f</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> that depends on the instantaneous difference between <inline-formula id="pcbi.1005507.e006"><alternatives><graphic id="pcbi.1005507.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and the dynamic threshold <inline-formula id="pcbi.1005507.e007"><alternatives><graphic id="pcbi.1005507.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Spike feedback (voltage reset and spike-triggered threshold movement) gives rise to spike history effects like refractoriness and adaptation. (B) Spike raster plot of the first 200 neurons of each population. The panels correspond to the populations in (A). Layer 4 and 6 are stimulated by a step current during the interval (0.06s, 0.09s) mimicking thalamic input (gray bars). Solid lines show the population activities <inline-formula id="pcbi.1005507.e008"><alternatives><graphic id="pcbi.1005507.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> computed with temporal resolution Δ<italic>t</italic> = 0.5 ms, cf. <xref ref-type="disp-formula" rid="pcbi.1005507.e016">Eq (2)</xref>. The activities are stochastic due to the finite population size. (C) On the mesoscopic level, the model reduces to a network of 8 populations, each represented by its population activity <inline-formula id="pcbi.1005507.e009"><alternatives><graphic id="pcbi.1005507.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Inset: The mesoscopic model generates realizations of <inline-formula id="pcbi.1005507.e010"><alternatives><graphic id="pcbi.1005507.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> from an expected rate <inline-formula id="pcbi.1005507.e011"><alternatives><graphic id="pcbi.1005507.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, which is a deterministic functional of the past population activities. (D) A corresponding simulation of the mesoscopic model yields population activities with the same temporal statistics as in (B).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005507.g001" xlink:type="simple"/>
</fig>
<sec id="sec003">
<title>Mesoscopic population equations</title>
<p>A population <italic>α</italic> of size <italic>N</italic><sup><italic>α</italic></sup> is represented by its population activity <inline-formula id="pcbi.1005507.e012"><alternatives><graphic id="pcbi.1005507.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (Greek superscripts label the populations, <xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1C</xref>) defined as
<disp-formula id="pcbi.1005507.e013"><alternatives><graphic id="pcbi.1005507.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msup><mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msup></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msup><mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msup></mml:munderover> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
Here, <inline-formula id="pcbi.1005507.e014"><alternatives><graphic id="pcbi.1005507.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> with the Dirac <italic>δ</italic>-function denotes the spike train of an individual neuron <italic>i</italic> in population <italic>α</italic> with spike times <inline-formula id="pcbi.1005507.e015"><alternatives><graphic id="pcbi.1005507.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. Empirically, the population activity is measured with a finite temporal resolution Δ<italic>t</italic>. In this case, we define the coarse-grained population activity as
<disp-formula id="pcbi.1005507.e016"><alternatives><graphic id="pcbi.1005507.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo> <mml:msup><mml:mi>n</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msup><mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where Δ<italic>n</italic><sup><italic>α</italic></sup>(<italic>t</italic>) is the number of neurons in population <italic>α</italic> that have fired in a time bin of size Δ<italic>t</italic> starting at time <italic>t</italic>. The two definitions converge in the limit Δ<italic>t</italic> → 0.</p>
<p>An example of population activities derived from spiking activity in a cortical circuit model under a step current stimulation is shown in <xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1B</xref>. To bridge the scales between neurons and populations, the corresponding mean-field model should ideally result in the same population activities as obtained from the full microscopic model (<xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1D</xref>). Because of the stochastic nature of the population activities, however, the qualifier “same” has to be interpreted in a statistical sense. The random fluctuations apparent in <xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1B and 1D</xref> are a consequence of the finite number of neurons because microscopic stochasticity is not averaged out in the finite sum in <xref ref-type="disp-formula" rid="pcbi.1005507.e013">Eq (1)</xref>. This observation is important because estimated neuron numbers reported in experiments on local cortical circuits are relatively small [<xref ref-type="bibr" rid="pcbi.1005507.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref073">73</xref>]. Therefore, a quantitatively valid population model needs to account for finite-size fluctuations. As mentioned above, we will refer to the population-level with finite size populations (<italic>N</italic> ∼ 50 to 2000 per population) as the <italic>mesoscopic</italic> level. In summary, we face the following question: is it possible to derive a closed set of evolution equations for the mesoscopic variables <inline-formula id="pcbi.1005507.e017"><alternatives><graphic id="pcbi.1005507.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> that follow the same statistics as the original microscopic model?</p>
<p>To address this question, we describe neurons by generalized integrate-and-fire (GIF) neuron models (<xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1A</xref> (inset) and <xref ref-type="sec" rid="sec018">M<sc>ethods</sc></xref>, Sec. “Generalized integrate-and-fire model”) with escape noise [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>]. In particular, neuron <italic>i</italic> of population <italic>α</italic> is modeled by a leaky integrate-and-fire model with dynamic threshold [<xref ref-type="bibr" rid="pcbi.1005507.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref080">80</xref>]. The variables of this model are the membrane potential <inline-formula id="pcbi.1005507.e018"><alternatives><graphic id="pcbi.1005507.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and the dynamic threshold <inline-formula id="pcbi.1005507.e019"><alternatives><graphic id="pcbi.1005507.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>th</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msup><mml:mi>θ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1A</xref>, inset), where <italic>u</italic><sub>th</sub> is a baseline threshold and <italic>θ</italic><sup><italic>α</italic></sup>(<italic>t</italic>) is a spike-triggered adaptation kernel or filter function that accounts for adaptation [<xref ref-type="bibr" rid="pcbi.1005507.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref081">81</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref084">84</xref>] and other spike-history effects [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref084">84</xref>] via a convolution with the neurons spike train <inline-formula id="pcbi.1005507.e020"><alternatives><graphic id="pcbi.1005507.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. In other words, the dynamic threshold depends on earlier spikes <inline-formula id="pcbi.1005507.e021"><alternatives><graphic id="pcbi.1005507.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> of neuron <italic>i</italic>: <inline-formula id="pcbi.1005507.e022"><alternatives><graphic id="pcbi.1005507.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:msup><mml:mi>ϑ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Spikes are elicited stochastically depending on the present state of the neuron (<xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1A</xref>, inset). Specifically, the probability that neuron <italic>i</italic> fires a spike in the next time step [<italic>t</italic>, <italic>t</italic> + Δ<italic>t</italic>] is given by λ<sub><italic>i</italic></sub>(<italic>t</italic>)Δ<italic>t</italic>, where <inline-formula id="pcbi.1005507.e023"><alternatives><graphic id="pcbi.1005507.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the conditional intensity of neuron <italic>i</italic> (also called conditional rate or hazard rate):
<disp-formula id="pcbi.1005507.e024"><alternatives><graphic id="pcbi.1005507.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>f</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mi>ϑ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
with an exponential function <inline-formula id="pcbi.1005507.e025"><alternatives><graphic id="pcbi.1005507.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:msup><mml:mi>f</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>c</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msubsup><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Analysis of experimental data has shown that the “softness” parameter <inline-formula id="pcbi.1005507.e026"><alternatives><graphic id="pcbi.1005507.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:msubsup><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> of the threshold is in the range of 1 to 5 mV [<xref ref-type="bibr" rid="pcbi.1005507.ref085">85</xref>]. The parameter <italic>c</italic><sup><italic>α</italic></sup> can be interpreted as the instantaneous rate at threshold.</p>
<p>Besides the effect of a spike on the threshold as mediated by the filter function <italic>θ</italic><sup><italic>α</italic></sup>(<italic>t</italic>), a spike also triggers a change of the membrane potential. In the GIF model (<xref ref-type="sec" rid="sec018">M<sc>ethods</sc></xref>, Sec. “Generalized integrate-and-fire model”), the membrane potential <inline-formula id="pcbi.1005507.e027"><alternatives><graphic id="pcbi.1005507.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is reset after spiking to a reset potential <italic>u</italic><sub>r</sub>, to which <inline-formula id="pcbi.1005507.e028"><alternatives><graphic id="pcbi.1005507.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is clamped for an absolute refractory period <italic>t</italic><sub>ref</sub>. Absolute refractoriness is followed by a period of relative refractoriness, where the conditional intensity <xref ref-type="disp-formula" rid="pcbi.1005507.e024">Eq (3)</xref> is reduced. This period is determined by the relaxation of the membrane potential from the reset potential to the unperturbed or “free” potential, denoted <italic>h</italic>(<italic>t</italic>), which corresponds to the membrane potential dynamics in the absence of resets.</p>
<p>The GIF model accurately predicts spikes of cortical neurons under noisy current stimulation mimicking in-vivo like input [<xref ref-type="bibr" rid="pcbi.1005507.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref026">26</xref>] and its parameters can be efficiently extracted from single neuron recordings [<xref ref-type="bibr" rid="pcbi.1005507.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref027">27</xref>]. Variants of this model have also been suggested that explicitly incorporate biophysical properties such as fast sodium inactivation [<xref ref-type="bibr" rid="pcbi.1005507.ref086">86</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref087">87</xref>], conductance-based currents [<xref ref-type="bibr" rid="pcbi.1005507.ref088">88</xref>] and synaptically-filtered background noise [<xref ref-type="bibr" rid="pcbi.1005507.ref089">89</xref>].</p>
<sec id="sec004">
<title>Mean-field approximations</title>
<p>In order to derive a mesoscopic mean-field theory for populations of GIF neurons, we first approximate the conditional intensity <inline-formula id="pcbi.1005507.e029"><alternatives><graphic id="pcbi.1005507.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> of an individual neuron by an effective rate <inline-formula id="pcbi.1005507.e030"><alternatives><graphic id="pcbi.1005507.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> that only depends on its last spike time <inline-formula id="pcbi.1005507.e031"><alternatives><graphic id="pcbi.1005507.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and on the history of the population activity <inline-formula id="pcbi.1005507.e032"><alternatives><graphic id="pcbi.1005507.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <italic>t</italic>′ &lt; <italic>t</italic> (as expressed by the subscript “<italic>A</italic>”). This is called the quasi-renewal approximation [<xref ref-type="bibr" rid="pcbi.1005507.ref063">63</xref>]. Taking into account the dependence on the last spike is particularly important because of neuronal refractoriness.</p>
<p>To obtain such a quasi-renewal description we make two approximations. Firstly, we approximate the random connectivity by an effective full connectivity with proportionally scaled down synaptic weights (“mean-field approximation”). As a result, all neurons of the same population are driven by identical synaptic input (see <xref ref-type="sec" rid="sec018">M<sc>ethods</sc></xref>). This implies that for all neurons that had the same last spike time, the time course of the membrane potential is identical, <inline-formula id="pcbi.1005507.e033"><alternatives><graphic id="pcbi.1005507.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Secondly, we make the quasi-renewal approximation for GIF neurons [<xref ref-type="bibr" rid="pcbi.1005507.ref063">63</xref>], which replaces the threshold <italic>ϑ</italic><sub><italic>i</italic></sub>(<italic>t</italic>) by an effective threshold <inline-formula id="pcbi.1005507.e034"><alternatives><graphic id="pcbi.1005507.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Again, the effective threshold only depends on the last spike time and the history of the population activity. As a final result we obtain the conditional intensity for all neurons with a given last spike time <inline-formula id="pcbi.1005507.e035"><alternatives><graphic id="pcbi.1005507.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> as
<disp-formula id="pcbi.1005507.e036"><alternatives><graphic id="pcbi.1005507.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>f</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
(<xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1C</xref>, inset). A comparison of <xref ref-type="disp-formula" rid="pcbi.1005507.e036">Eq (4)</xref> with <xref ref-type="disp-formula" rid="pcbi.1005507.e024">Eq (3)</xref> shows that the explicit dependence on <italic>all</italic> past spike times <inline-formula id="pcbi.1005507.e037"><alternatives><graphic id="pcbi.1005507.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> of a given neuron <italic>i</italic> has disappeared. Instead, the conditional intensity now only depends on the <italic>last</italic> firing time <inline-formula id="pcbi.1005507.e038"><alternatives><graphic id="pcbi.1005507.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and the past population activity <inline-formula id="pcbi.1005507.e039"><alternatives><graphic id="pcbi.1005507.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <italic>t</italic>′ &lt; <italic>t</italic>. To keep the notation simple, we omit in the following the population label <italic>α</italic> at all quantities.</p>
</sec>
<sec id="sec005">
<title>Finite-size mean field theory</title>
<p>In this section, we present the main theoretical results with a focus on the finite-size effects arising from neuronal refractoriness. So far, we have effectively reduced the firing probability of a neuron to a function <inline-formula id="pcbi.1005507.e066"><alternatives><graphic id="pcbi.1005507.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> that only depends on its last spike time <inline-formula id="pcbi.1005507.e067"><alternatives><graphic id="pcbi.1005507.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1005507.g002">Fig 2A</xref>). This allows us to describe the evolution of the system by the density of the last spike time [<xref ref-type="bibr" rid="pcbi.1005507.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref068">68</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref088">88</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref089">89</xref>]. Because the last spike time characterizes the refractory state of the neuron, this density will also be referred to as the refractory density. Before we describe the novel finite-<italic>N</italic> theory, it is instructive to first recall the population equations for the case of infinite <italic>N</italic> (<xref ref-type="fig" rid="pcbi.1005507.g002">Fig 2B and 2C</xref>). Let us look at the population of neurons at time <italic>t</italic> and ask the following question: What fraction of these neurons has fired their last spike between <inline-formula id="pcbi.1005507.e068"><alternatives><graphic id="pcbi.1005507.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005507.e069"><alternatives><graphic id="pcbi.1005507.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>? This fraction is given by the number of neurons <inline-formula id="pcbi.1005507.e070"><alternatives><graphic id="pcbi.1005507.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mrow><mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> that have fired in this interval multiplied by the survival probability <inline-formula id="pcbi.1005507.e071"><alternatives><graphic id="pcbi.1005507.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> that such a neuron has not fired again until time <italic>t</italic>. In other words, the product <inline-formula id="pcbi.1005507.e072"><alternatives><graphic id="pcbi.1005507.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mrow><mml:msub><mml:mi>Q</mml:mi> <mml:mi>∞</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> evaluated at time <italic>t</italic> represents the density of last spike times <inline-formula id="pcbi.1005507.e073"><alternatives><graphic id="pcbi.1005507.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. Because a neuron with last spike time <inline-formula id="pcbi.1005507.e074"><alternatives><graphic id="pcbi.1005507.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> emits a spike with rate <inline-formula id="pcbi.1005507.e075"><alternatives><graphic id="pcbi.1005507.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, the total population activity at time <italic>t</italic> is given by the integral [<xref ref-type="bibr" rid="pcbi.1005507.ref023">23</xref>]
<disp-formula id="pcbi.1005507.e076"><alternatives><graphic id="pcbi.1005507.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e076" xlink:type="simple"/><mml:math display="block" id="M76"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
This situation is depicted in <xref ref-type="fig" rid="pcbi.1005507.g002">Fig 2B</xref>. At the same time, the survival probability <inline-formula id="pcbi.1005507.e077"><alternatives><graphic id="pcbi.1005507.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of neurons that fired their last spike at <inline-formula id="pcbi.1005507.e078"><alternatives><graphic id="pcbi.1005507.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> decays according to
<disp-formula id="pcbi.1005507.e079"><alternatives><graphic id="pcbi.1005507.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e079" xlink:type="simple"/><mml:math display="block" id="M79"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
with initial condition <inline-formula id="pcbi.1005507.e080"><alternatives><graphic id="pcbi.1005507.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1005507.g002">Fig 2E and 2F</xref> red line). Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e076">5</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e079">6</xref>) define the population dynamics for <italic>N</italic> → ∞ [<xref ref-type="bibr" rid="pcbi.1005507.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref089">89</xref>].</p>
<fig id="pcbi.1005507.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005507.g002</object-id>
<label>Fig 2</label>
<caption>
<title>How fluctuations of the refractory density effect the population activity.</title>
<p>(A) The conditional intensity <inline-formula id="pcbi.1005507.e040"><alternatives><graphic id="pcbi.1005507.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> shown as a function of <inline-formula id="pcbi.1005507.e041"><alternatives><graphic id="pcbi.1005507.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (left) and <italic>t</italic> (right). Typically, the conditional intensity increases as the time since the last spike grows and the neuron recovers from refractoriness. (B) For <italic>N</italic> → ∞, the population activity <italic>A</italic>(<italic>t</italic>) (hatched bin) results from <inline-formula id="pcbi.1005507.e042"><alternatives><graphic id="pcbi.1005507.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> averaged over the last spike times <inline-formula id="pcbi.1005507.e043"><alternatives><graphic id="pcbi.1005507.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> with a weighting factor <inline-formula id="pcbi.1005507.e044"><alternatives><graphic id="pcbi.1005507.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (blue) corresponding to the density of last spike times. Here, <inline-formula id="pcbi.1005507.e045"><alternatives><graphic id="pcbi.1005507.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the survival probability. (C) The last spike times <inline-formula id="pcbi.1005507.e046"><alternatives><graphic id="pcbi.1005507.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are discretized into time bins. In the bin immediately before <italic>t</italic>, a large fluctuation (blue peak) was induced by forcing some of the neurons with last spike time around <italic>t</italic>* to fire. At time <italic>t</italic>, the density of last spike times (blue) has a hole and a peak of equal probability mass. The red line shows the pseudo-density <inline-formula id="pcbi.1005507.e047"><alternatives><graphic id="pcbi.1005507.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> that would be obtained if we had used the survival probability <inline-formula id="pcbi.1005507.e048"><alternatives><graphic id="pcbi.1005507.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> of the unperturbed system. The peak at <inline-formula id="pcbi.1005507.e049"><alternatives><graphic id="pcbi.1005507.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> does not contribute to the activity <italic>A</italic>(<italic>t</italic>) because of refractoriness, but the hole at <inline-formula id="pcbi.1005507.e050"><alternatives><graphic id="pcbi.1005507.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> contributes with a non-vanishing rate (A), implying a reduction of <italic>A</italic>(<italic>t</italic>) (hatched bin). (D) For a finite population size (here <italic>N</italic> = 400), the refractory density <inline-formula id="pcbi.1005507.e051"><alternatives><graphic id="pcbi.1005507.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (blue), determines the expectation <inline-formula id="pcbi.1005507.e052"><alternatives><graphic id="pcbi.1005507.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (hatched bin) of the fluctuating activity <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>). Analogous to the forced fluctuation in (C), the finite-size fluctuations are associated with negative and positive deviations in the refractory density (holes and overshoots) compared to the non-normalized density <inline-formula id="pcbi.1005507.e053"><alternatives><graphic id="pcbi.1005507.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:mrow><mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (red line) that would be obtained if only the mean <inline-formula id="pcbi.1005507.e054"><alternatives><graphic id="pcbi.1005507.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and not the exact survival fraction <inline-formula id="pcbi.1005507.e055"><alternatives><graphic id="pcbi.1005507.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> had been taken into account. The variance of the deviations is proportional to <inline-formula id="pcbi.1005507.e056"><alternatives><graphic id="pcbi.1005507.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:mrow><mml:mi>v</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> given by <xref ref-type="disp-formula" rid="pcbi.1005507.e146">Eq (12)</xref>. As a function of <inline-formula id="pcbi.1005507.e057"><alternatives><graphic id="pcbi.1005507.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005507.e058"><alternatives><graphic id="pcbi.1005507.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:mrow><mml:mi>v</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> shows the range of <inline-formula id="pcbi.1005507.e059"><alternatives><graphic id="pcbi.1005507.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> where deviations are most prominent (bottom). (E, F) Given the number of neurons firing in the bin <inline-formula id="pcbi.1005507.e060"><alternatives><graphic id="pcbi.1005507.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005507.e061"><alternatives><graphic id="pcbi.1005507.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, the fraction of neurons that survive until time <italic>t</italic> is shown for ten realizations (gray lines, one highlighted in black for clarity). The mean fraction equals the survival probability <inline-formula id="pcbi.1005507.e062"><alternatives><graphic id="pcbi.1005507.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (red line, top panel). The variance of the number of survived neurons at time <italic>t</italic>, <inline-formula id="pcbi.1005507.e063"><alternatives><graphic id="pcbi.1005507.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:mrow><mml:mi>v</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo> <mml:mi>N</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, is shown at the bottom (red line: semi-analytic theory, <xref ref-type="disp-formula" rid="pcbi.1005507.e146">Eq (12)</xref>; circles: simulation). (E) <inline-formula id="pcbi.1005507.e064"><alternatives><graphic id="pcbi.1005507.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, (F) <inline-formula id="pcbi.1005507.e065"><alternatives><graphic id="pcbi.1005507.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>40</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005507.g002" xlink:type="simple"/>
</fig>
<p>In the limit <italic>N</italic> → ∞, the dynamics of <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) = <italic>A</italic>(<italic>t</italic>) is deterministic because microscopic noise averages out. Nevertheless, the infinite-<italic>N</italic> case is useful to understand the main effect of fluctuations in the finite-<italic>N</italic> case. To this end, let us perform the following thought experiment: in a small time interval of length Δ<italic>t</italic> immediately before time <italic>t</italic>, we induce a large, positive fluctuation in the activity by forcing many of the neurons with last spike close to a given time <inline-formula id="pcbi.1005507.e081"><alternatives><graphic id="pcbi.1005507.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> to fire a spike (<xref ref-type="fig" rid="pcbi.1005507.g002">Fig 2C</xref>). As a result, the density of last spike times at time <italic>t</italic> exhibits a large peak just prior to time <italic>t</italic> corresponding to the large number of neurons that have been forced to fire in the time interval [<italic>t</italic> − Δ<italic>t</italic>, <italic>t</italic>). At the same time, these neurons leave behind a “hole” in the density around <inline-formula id="pcbi.1005507.e082"><alternatives><graphic id="pcbi.1005507.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Because the number of neurons is conserved, this hole exactly balances the area under the peak, and hence, the density of last spike times remains normalized. However, the two fluctuations (the hole and the peak) have two different effects on the population activity after time <italic>t</italic>. Specifically, the hole implies that some of the neurons which normally would have fired at time <italic>t</italic> with a nonzero rate λ<sub><italic>A</italic></sub>(<italic>t</italic>|<italic>t</italic>*) &gt; 0 are no longer available. Moreover, neural refractoriness implies that neurons which fired in the peak have a small or even vanishing rate λ<sub><italic>A</italic></sub>(<italic>t</italic>|<italic>t</italic> − Δ<italic>t</italic>) ≈ 0 at time <italic>t</italic>. As a result, the population activity is reduced shortly after the perturbation (<xref ref-type="fig" rid="pcbi.1005507.g002">Fig 2C</xref>). This example highlights the importance of the normalization of the refractory density as well as the state-dependence of the firing probability for understanding the effect of fluctuations. In particular, the normalization condition and neuronal refractoriness imply that a positive fluctuation of the population activity is succeeded by a negative fluctuation, and vice versa. This behavior is characteristic for spiking neurons, which are known to exhibit negative auto-correlations of their mean-centered spike trains at short time lags (see e.g. [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref053">53</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref090">90</xref>]).</p>
<p>We now turn to the finite-size case. In this case, it is advantageous to discretize the last spike times into small bins of size Δ<italic>t</italic> that begin at the grid points <inline-formula id="pcbi.1005507.e083"><alternatives><graphic id="pcbi.1005507.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>k</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005507.e084"><alternatives><graphic id="pcbi.1005507.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Furthermore, we adopt the definition of the coarse-grained population activity, <xref ref-type="disp-formula" rid="pcbi.1005507.e016">Eq (2)</xref>, i.e. we consider the number of spikes <inline-formula id="pcbi.1005507.e085"><alternatives><graphic id="pcbi.1005507.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in the time bin <inline-formula id="pcbi.1005507.e086"><alternatives><graphic id="pcbi.1005507.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Instead of the survival probability, we introduce the fraction of survived neurons <inline-formula id="pcbi.1005507.e087"><alternatives><graphic id="pcbi.1005507.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e087" xlink:type="simple"/><mml:math display="inline" id="M87"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005507.e088"><alternatives><graphic id="pcbi.1005507.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:mrow><mml:mi>t</mml:mi> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, such that <inline-formula id="pcbi.1005507.e089"><alternatives><graphic id="pcbi.1005507.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the number of neurons from bin <italic>k</italic> that have not fired again until time <italic>t</italic> (<xref ref-type="fig" rid="pcbi.1005507.g002">Fig 2D and 2E</xref>). Dividing this number by <italic>N</italic>Δ<italic>t</italic> and taking the continuum limit Δ<italic>t</italic> → 0, yields the density of last spike times <inline-formula id="pcbi.1005507.e090"><alternatives><graphic id="pcbi.1005507.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:mrow><mml:msub><mml:mi>Q</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> in the case of finite <italic>N</italic>. Since all neurons are uniquely identified by their last spike time, this density is normalized [<xref ref-type="bibr" rid="pcbi.1005507.ref023">23</xref>]
<disp-formula id="pcbi.1005507.e091"><alternatives><graphic id="pcbi.1005507.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e091" xlink:type="simple"/><mml:math display="block" id="M91"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
We note that differentiating this equation with respect to time <italic>t</italic> yields the population activity <inline-formula id="pcbi.1005507.e092"><alternatives><graphic id="pcbi.1005507.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e092" xlink:type="simple"/><mml:math display="inline" id="M92"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> as the formal finite-size analog of <xref ref-type="disp-formula" rid="pcbi.1005507.e076">Eq (5)</xref>. The change of the survival fraction <inline-formula id="pcbi.1005507.e093"><alternatives><graphic id="pcbi.1005507.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e093" xlink:type="simple"/><mml:math display="inline" id="M93"><mml:mrow><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, however, is not deterministic anymore as in <xref ref-type="disp-formula" rid="pcbi.1005507.e079">Eq (6)</xref> but follows a stochastic jump process (<xref ref-type="fig" rid="pcbi.1005507.g002">Fig 2E and 2F</xref>): In the time step [<italic>t</italic>, <italic>t</italic> + Δ<italic>t</italic>), the number of survived neurons for a given bin <inline-formula id="pcbi.1005507.e094"><alternatives><graphic id="pcbi.1005507.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e094" xlink:type="simple"/><mml:math display="inline" id="M94"><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> in the past, <inline-formula id="pcbi.1005507.e095"><alternatives><graphic id="pcbi.1005507.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e095" xlink:type="simple"/><mml:math display="inline" id="M95"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, makes a downstep <inline-formula id="pcbi.1005507.e096"><alternatives><graphic id="pcbi.1005507.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e096" xlink:type="simple"/><mml:math display="inline" id="M96"><mml:mrow><mml:mi>X</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> that corresponds to the number of neurons that fire in the group with last spike time <inline-formula id="pcbi.1005507.e097"><alternatives><graphic id="pcbi.1005507.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e097" xlink:type="simple"/><mml:math display="inline" id="M97"><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. For sufficiently small Δ<italic>t</italic>, this number is Poisson-distributed with mean <inline-formula id="pcbi.1005507.e098"><alternatives><graphic id="pcbi.1005507.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e098" xlink:type="simple"/><mml:math display="inline" id="M98"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Hence, the fraction of survived neurons <inline-formula id="pcbi.1005507.e099"><alternatives><graphic id="pcbi.1005507.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e099" xlink:type="simple"/><mml:math display="inline" id="M99"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> evolves in time like a random stair case according to the update rule <inline-formula id="pcbi.1005507.e100"><alternatives><graphic id="pcbi.1005507.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e100" xlink:type="simple"/><mml:math display="inline" id="M100"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The activity <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) = Δ<italic>n</italic>(<italic>t</italic>)/(<italic>N</italic>Δ<italic>t</italic>) in the time bin starting at <italic>t</italic> is given by the sum of all the downsteps, <inline-formula id="pcbi.1005507.e101"><alternatives><graphic id="pcbi.1005507.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e101" xlink:type="simple"/><mml:math display="inline" id="M101"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mtext> </mml:mtext> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where the sum runs over all possible last spike times. This updating procedure represents the evolution of the density of last spike times, <inline-formula id="pcbi.1005507.e102"><alternatives><graphic id="pcbi.1005507.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e102" xlink:type="simple"/><mml:math display="inline" id="M102"><mml:mrow><mml:msub><mml:mi>Q</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, for finite <italic>N</italic> under the quasi-renewal approximation (cf. <xref ref-type="sec" rid="sec018">M<sc>ethods</sc></xref>, Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e351">41</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e358">42</xref>)). Although it is possible to simulate such a finite-<italic>N</italic> stochastic process using the downsteps <inline-formula id="pcbi.1005507.e103"><alternatives><graphic id="pcbi.1005507.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e103" xlink:type="simple"/><mml:math display="inline" id="M103"><mml:mrow><mml:mi>X</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, this process will not yield the reduced mesoscopic dynamics that we are looking for. The reason is that the variable <inline-formula id="pcbi.1005507.e104"><alternatives><graphic id="pcbi.1005507.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e104" xlink:type="simple"/><mml:math display="inline" id="M104"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> refers to the subpopulation of neurons that fired in the small time bin at <inline-formula id="pcbi.1005507.e105"><alternatives><graphic id="pcbi.1005507.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e105" xlink:type="simple"/><mml:math display="inline" id="M105"><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. For small Δ<italic>t</italic>, the size of the subpopulation, <inline-formula id="pcbi.1005507.e106"><alternatives><graphic id="pcbi.1005507.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e106" xlink:type="simple"/><mml:math display="inline" id="M106"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, is a <italic>small</italic> number, much smaller than <italic>N</italic>. In particular, in the limit Δ<italic>t</italic> → 0, the simulation of <inline-formula id="pcbi.1005507.e107"><alternatives><graphic id="pcbi.1005507.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e107" xlink:type="simple"/><mml:math display="inline" id="M107"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for all <inline-formula id="pcbi.1005507.e108"><alternatives><graphic id="pcbi.1005507.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e108" xlink:type="simple"/><mml:math display="inline" id="M108"><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> in the past would be as complex as the original microscopic dynamics of <italic>N</italic> neurons. Therefore we must consider such a simulation as a microscopic simulation. To see the difference to a mescoscopic simulation, we note that the population activity <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) involves the summation of many random processes (the downsteps <inline-formula id="pcbi.1005507.e109"><alternatives><graphic id="pcbi.1005507.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e109" xlink:type="simple"/><mml:math display="inline" id="M109"><mml:mrow><mml:mi>X</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>) over many small bins. If we succeed to simulate directly <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) from an underlying rate dynamics that depends deterministically on the past activities <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>′), <italic>t</italic>′ &lt; <italic>t</italic>, we will have a truely mescoscopic simulation. How to arrive at a formulation directly at the level of mescocopic quantities will be the topic of the rest of this section.</p>
<p>The crucial question is whether the stochasticity of the many different random processes <inline-formula id="pcbi.1005507.e110"><alternatives><graphic id="pcbi.1005507.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e110" xlink:type="simple"/><mml:math display="inline" id="M110"><mml:msub><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> can be reduced to a single effective noise process that drives the dynamics on the mesoscopic level. To this end, we note that for small Δ<italic>t</italic> and given history <inline-formula id="pcbi.1005507.e111"><alternatives><graphic id="pcbi.1005507.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e111" xlink:type="simple"/><mml:math display="inline" id="M111"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005507.e112"><alternatives><graphic id="pcbi.1005507.e112g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e112" xlink:type="simple"/><mml:math display="inline" id="M112"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, each bin <inline-formula id="pcbi.1005507.e113"><alternatives><graphic id="pcbi.1005507.e113g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e113" xlink:type="simple"/><mml:math display="inline" id="M113"><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> contributes with rate <inline-formula id="pcbi.1005507.e114"><alternatives><graphic id="pcbi.1005507.e114g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e114" xlink:type="simple"/><mml:math display="inline" id="M114"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> a Poisson random number of spikes to the total activity at time <italic>t</italic> (<xref ref-type="fig" rid="pcbi.1005507.g002">Fig 2D</xref>). Therefore, the total number of spikes Δ<italic>n</italic>(<italic>t</italic>) is Poisson distributed with mean <inline-formula id="pcbi.1005507.e115"><alternatives><graphic id="pcbi.1005507.e115g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e115" xlink:type="simple"/><mml:math display="inline" id="M115"><mml:mrow><mml:mi>N</mml:mi> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1005507.e116"><alternatives><graphic id="pcbi.1005507.e116g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e116" xlink:type="simple"/><mml:math display="inline" id="M116"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the <italic>expected</italic> population rate
<disp-formula id="pcbi.1005507.e117"><alternatives><graphic id="pcbi.1005507.e117g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e117" xlink:type="simple"/><mml:math display="block" id="M117"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
Here, the integral extends over all last spike times <inline-formula id="pcbi.1005507.e118"><alternatives><graphic id="pcbi.1005507.e118g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e118" xlink:type="simple"/><mml:math display="inline" id="M118"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> up to but not including time <italic>t</italic>. <xref ref-type="disp-formula" rid="pcbi.1005507.e117">Eq (8)</xref> still depends on the stochastic variables <inline-formula id="pcbi.1005507.e119"><alternatives><graphic id="pcbi.1005507.e119g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e119" xlink:type="simple"/><mml:math display="inline" id="M119"><mml:msub><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. The main strategy to remove this microscopic stochasticity is to use the evolution of the survival probability <inline-formula id="pcbi.1005507.e120"><alternatives><graphic id="pcbi.1005507.e120g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e120" xlink:type="simple"/><mml:math display="inline" id="M120"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, given by <xref ref-type="disp-formula" rid="pcbi.1005507.e079">Eq (6)</xref>, and the normalization condition <xref ref-type="disp-formula" rid="pcbi.1005507.e091">Eq (7)</xref>. For finite <italic>N</italic>, the quantity <inline-formula id="pcbi.1005507.e121"><alternatives><graphic id="pcbi.1005507.e121g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e121" xlink:type="simple"/><mml:math display="inline" id="M121"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is formally defined as the solution of <xref ref-type="disp-formula" rid="pcbi.1005507.e079">Eq (6)</xref> and can be interpreted as the mean of the survival fraction <inline-formula id="pcbi.1005507.e122"><alternatives><graphic id="pcbi.1005507.e122g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e122" xlink:type="simple"/><mml:math display="inline" id="M122"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1005507.g002">Fig 2E and 2F</xref>, see <xref ref-type="sec" rid="sec018">M<sc>ethods</sc></xref>). Importantly, <inline-formula id="pcbi.1005507.e123"><alternatives><graphic id="pcbi.1005507.e123g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e123" xlink:type="simple"/><mml:math display="inline" id="M123"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is a valid mesoscopic quantity since it only depends on the mesoscopic population activity <italic>A</italic><sub><italic>N</italic></sub> (through <inline-formula id="pcbi.1005507.e124"><alternatives><graphic id="pcbi.1005507.e124g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e124" xlink:type="simple"/><mml:math display="inline" id="M124"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, cf. <xref ref-type="disp-formula" rid="pcbi.1005507.e079">Eq (6)</xref>), and not on a specific microscopic realization. Combining the survival probability <inline-formula id="pcbi.1005507.e125"><alternatives><graphic id="pcbi.1005507.e125g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e125" xlink:type="simple"/><mml:math display="inline" id="M125"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> with the actual history of the mesoscopic activity <inline-formula id="pcbi.1005507.e126"><alternatives><graphic id="pcbi.1005507.e126g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e126" xlink:type="simple"/><mml:math display="inline" id="M126"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for <inline-formula id="pcbi.1005507.e127"><alternatives><graphic id="pcbi.1005507.e127g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e127" xlink:type="simple"/><mml:math display="inline" id="M127"><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> yields the pseudo-density <inline-formula id="pcbi.1005507.e128"><alternatives><graphic id="pcbi.1005507.e128g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e128" xlink:type="simple"/><mml:math display="inline" id="M128"><mml:mrow><mml:mi>Q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. In contrast to the macroscopic density <inline-formula id="pcbi.1005507.e129"><alternatives><graphic id="pcbi.1005507.e129g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e129" xlink:type="simple"/><mml:math display="inline" id="M129"><mml:mrow><mml:msub><mml:mi>Q</mml:mi> <mml:mi>∞</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1005507.e076">Eq (5)</xref> or the microscopic density <inline-formula id="pcbi.1005507.e130"><alternatives><graphic id="pcbi.1005507.e130g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e130" xlink:type="simple"/><mml:math display="inline" id="M130"><mml:mrow><mml:msub><mml:mi>Q</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, the pseudo-density is not normalized. However, the pseudo-density <inline-formula id="pcbi.1005507.e131"><alternatives><graphic id="pcbi.1005507.e131g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e131" xlink:type="simple"/><mml:math display="inline" id="M131"><mml:mrow><mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> has the advantage that it is based on mesoscopic quantities only.</p>
<p>Let us split the survival fraction into the mesoscopic quantity <inline-formula id="pcbi.1005507.e132"><alternatives><graphic id="pcbi.1005507.e132g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e132" xlink:type="simple"/><mml:math display="inline" id="M132"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and a microscopic deviation, <inline-formula id="pcbi.1005507.e133"><alternatives><graphic id="pcbi.1005507.e133g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e133" xlink:type="simple"/><mml:math display="inline" id="M133"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>δ</mml:mi> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. In analogy to the artificial fluctuation in our thought experiment, endogenously generated fluctuations in the finite-size system are accompanied by deviations of the microscopic density <inline-formula id="pcbi.1005507.e134"><alternatives><graphic id="pcbi.1005507.e134g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e134" xlink:type="simple"/><mml:math display="inline" id="M134"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> from the pseudo-density <inline-formula id="pcbi.1005507.e135"><alternatives><graphic id="pcbi.1005507.e135g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e135" xlink:type="simple"/><mml:math display="inline" id="M135"><mml:mrow><mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1005507.g002">Fig 2C and 2D</xref>, red line). A negative deviation (<inline-formula id="pcbi.1005507.e136"><alternatives><graphic id="pcbi.1005507.e136g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e136" xlink:type="simple"/><mml:math display="inline" id="M136"><mml:mrow><mml:mi>δ</mml:mi> <mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>) can be interpreted as a hole and a positive deviation (<inline-formula id="pcbi.1005507.e137"><alternatives><graphic id="pcbi.1005507.e137g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e137" xlink:type="simple"/><mml:math display="inline" id="M137"><mml:mrow><mml:mi>δ</mml:mi> <mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>) as an overshoot (compare red curve and blue histogram in <xref ref-type="fig" rid="pcbi.1005507.g002">Fig 2D</xref>). Similar to the thought experiment, the effect of these deviations needs to be weighted by the conditional intensity <inline-formula id="pcbi.1005507.e138"><alternatives><graphic id="pcbi.1005507.e138g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e138" xlink:type="simple"/><mml:math display="inline" id="M138"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> in order to arrive at the population activity. <xref ref-type="disp-formula" rid="pcbi.1005507.e117">Eq (8)</xref> yields
<disp-formula id="pcbi.1005507.e139"><alternatives><graphic id="pcbi.1005507.e139g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e139" xlink:type="simple"/><mml:math display="block" id="M139"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
Analogously, the normalization of the refractory density, <xref ref-type="disp-formula" rid="pcbi.1005507.e091">Eq (7)</xref>, can be written as
<disp-formula id="pcbi.1005507.e140"><alternatives><graphic id="pcbi.1005507.e140g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e140" xlink:type="simple"/><mml:math display="block" id="M140"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>δ</mml:mi> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
We refer to the second integral in <xref ref-type="disp-formula" rid="pcbi.1005507.e139">Eq (9)</xref> as a correction term because it corrects for the error that one would make if one sets <italic>S</italic><sub><italic>N</italic></sub> = <italic>S</italic> in <xref ref-type="disp-formula" rid="pcbi.1005507.e117">Eq (8)</xref>. This correction term represents the overall contribution of the holes (<italic>δS</italic> &lt; 0) and overshoots (<italic>δS</italic> &gt; 0) to the expected activity.</p>
<p>To eliminate the microscopic deviations <inline-formula id="pcbi.1005507.e141"><alternatives><graphic id="pcbi.1005507.e141g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e141" xlink:type="simple"/><mml:math display="inline" id="M141"><mml:mrow><mml:mi>δ</mml:mi> <mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1005507.e139">Eq (9)</xref> we use the normalization condition, <xref ref-type="disp-formula" rid="pcbi.1005507.e140">Eq (10)</xref>. This is possible because the correction term is tightly constrained by the sum of all holes and overshoots, <inline-formula id="pcbi.1005507.e142"><alternatives><graphic id="pcbi.1005507.e142g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e142" xlink:type="simple"/><mml:math display="inline" id="M142"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>δ</mml:mi> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, which by <xref ref-type="disp-formula" rid="pcbi.1005507.e140">Eq (10)</xref>, is completely determined by the past mesoscopic activities. Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e139">9</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e140">10</xref>) suggest to make the deterministic ansatz <inline-formula id="pcbi.1005507.e143"><alternatives><graphic id="pcbi.1005507.e143g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e143" xlink:type="simple"/><mml:math display="inline" id="M143"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mi>δ</mml:mi> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>≈</mml:mo> <mml:mo>Λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>δ</mml:mi> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> for the correction term. As shown in M<sc>ethods</sc> (“Mesoscopic population equations”), the optimal rate Λ(<italic>t</italic>) that minimizes the mean squared error of this approximation is given by
<disp-formula id="pcbi.1005507.e144"><alternatives><graphic id="pcbi.1005507.e144g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e144" xlink:type="simple"/><mml:math display="block" id="M144"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
Here, the quantity <inline-formula id="pcbi.1005507.e145"><alternatives><graphic id="pcbi.1005507.e145g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e145" xlink:type="simple"/><mml:math display="inline" id="M145"><mml:mrow><mml:mi>v</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, called variance function, obeys the differential equation
<disp-formula id="pcbi.1005507.e146"><alternatives><graphic id="pcbi.1005507.e146g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e146" xlink:type="simple"/><mml:math display="block" id="M146"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>v</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>v</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
with initial condition <inline-formula id="pcbi.1005507.e147"><alternatives><graphic id="pcbi.1005507.e147g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e147" xlink:type="simple"/><mml:math display="inline" id="M147"><mml:mrow><mml:mi>v</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> (see <xref ref-type="sec" rid="sec018">M<sc>ethods</sc></xref>, <xref ref-type="disp-formula" rid="pcbi.1005507.e386">Eq (51)</xref>. Importantly, the dynamics of <italic>v</italic> involves mesoscopic quantities only, and hence <italic>v</italic> is mesoscopic. As shown in M<sc>ethods</sc> and illustrated in <xref ref-type="fig" rid="pcbi.1005507.g002">Fig 2D</xref> (bottom), we can interpret <inline-formula id="pcbi.1005507.e148"><alternatives><graphic id="pcbi.1005507.e148g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e148" xlink:type="simple"/><mml:math display="inline" id="M148"><mml:mrow><mml:mi>v</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mi>N</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> as the variance of the number of survived neurons, <inline-formula id="pcbi.1005507.e149"><alternatives><graphic id="pcbi.1005507.e149g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e149" xlink:type="simple"/><mml:math display="inline" id="M149"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. To provide an interpretation of the effective rate Λ(<italic>t</italic>) we note that, for fixed <italic>t</italic>, the normalized variance <inline-formula id="pcbi.1005507.e150"><alternatives><graphic id="pcbi.1005507.e150g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e150" xlink:type="simple"/><mml:math display="inline" id="M150"><mml:mrow><mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> is a probability density over <inline-formula id="pcbi.1005507.e151"><alternatives><graphic id="pcbi.1005507.e151g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e151" xlink:type="simple"/><mml:math display="inline" id="M151"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. Thus, the effective rate Λ(<italic>t</italic>) can be regarded as a weighted average of the conditional intensity <inline-formula id="pcbi.1005507.e152"><alternatives><graphic id="pcbi.1005507.e152g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e152" xlink:type="simple"/><mml:math display="inline" id="M152"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> that accounts for the expected amplitude of the holes and overshoots.</p>
<p>Using the effective rate Λ(<italic>t</italic>) in <xref ref-type="disp-formula" rid="pcbi.1005507.e139">Eq (9)</xref> results in the expected activity
<disp-formula id="pcbi.1005507.e153"><alternatives><graphic id="pcbi.1005507.e153g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e153" xlink:type="simple"/><mml:math display="block" id="M153"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:mo>Λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
Looking at the structure of <xref ref-type="disp-formula" rid="pcbi.1005507.e153">Eq (13)</xref>, we find that the first term is the familiar population integral known from the infinite-<italic>N</italic> case, <xref ref-type="disp-formula" rid="pcbi.1005507.e076">Eq (5)</xref>. The second term is a correction that is only present in the finite-<italic>N</italic> case. In fact, in the limit <italic>N</italic> → ∞, the pseudo-density <inline-formula id="pcbi.1005507.e154"><alternatives><graphic id="pcbi.1005507.e154g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e154" xlink:type="simple"/><mml:math display="inline" id="M154"><mml:mrow><mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> converges to the macroscopic density <inline-formula id="pcbi.1005507.e155"><alternatives><graphic id="pcbi.1005507.e155g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e155" xlink:type="simple"/><mml:math display="inline" id="M155"><mml:mrow><mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>A</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, which is normalized to unity. Hence the correction term vanishes and we recover the population <xref ref-type="disp-formula" rid="pcbi.1005507.e076">Eq (5)</xref> for the infinite system.</p>
<p>To obtain the population activity we consider an infinitesimally small time scale <italic>dt</italic> such that the probability of a neuron to fire during an interval [<italic>t</italic>, <italic>t</italic> + <italic>dt</italic>) is much smaller than one, i.e. <inline-formula id="pcbi.1005507.e156"><alternatives><graphic id="pcbi.1005507.e156g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e156" xlink:type="simple"/><mml:math display="inline" id="M156"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>≪</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. On this time scale, the total number of spikes <italic>dn</italic>(<italic>t</italic>) is an independent, Poisson distributed random number with mean <inline-formula id="pcbi.1005507.e157"><alternatives><graphic id="pcbi.1005507.e157g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e157" xlink:type="simple"/><mml:math display="inline" id="M157"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>N</mml:mi> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1005507.e158"><alternatives><graphic id="pcbi.1005507.e158g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e158" xlink:type="simple"/><mml:math display="inline" id="M158"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is given by <xref ref-type="disp-formula" rid="pcbi.1005507.e153">Eq (13)</xref>. From <xref ref-type="disp-formula" rid="pcbi.1005507.e016">Eq (2)</xref> thus follows the population activity
<disp-formula id="pcbi.1005507.e159"><alternatives><graphic id="pcbi.1005507.e159g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e159" xlink:type="simple"/><mml:math display="block" id="M159"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>n</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:mtext>Pois</mml:mtext> <mml:mrow><mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>N</mml:mi> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
Alternatively, the population activity can be represented as a <italic>δ</italic>-spike train, or “shot noise”, <inline-formula id="pcbi.1005507.e160"><alternatives><graphic id="pcbi.1005507.e160g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e160" xlink:type="simple"/><mml:math display="inline" id="M160"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mtext>pop</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1005507.e161"><alternatives><graphic id="pcbi.1005507.e161g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e161" xlink:type="simple"/><mml:math display="inline" id="M161"><mml:msub><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mtext>pop</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is a random point process with a conditional intensity function <inline-formula id="pcbi.1005507.e162"><alternatives><graphic id="pcbi.1005507.e162g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e162" xlink:type="simple"/><mml:math display="inline" id="M162"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mtext>pop</mml:mtext></mml:msub> <mml:mo>(</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Here, the condition <inline-formula id="pcbi.1005507.e163"><alternatives><graphic id="pcbi.1005507.e163g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e163" xlink:type="simple"/><mml:math display="inline" id="M163"><mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula> denotes the history of the point process {<italic>t</italic><sub>pop,<italic>k</italic></sub>} up to (but not including) time <italic>t</italic>, or equivalently the history of the population activity <inline-formula id="pcbi.1005507.e164"><alternatives><graphic id="pcbi.1005507.e164g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e164" xlink:type="simple"/><mml:math display="inline" id="M164"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for <inline-formula id="pcbi.1005507.e165"><alternatives><graphic id="pcbi.1005507.e165g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e165" xlink:type="simple"/><mml:math display="inline" id="M165"><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. The conditional intensity means that the conditional expectation of the population activity is given by <inline-formula id="pcbi.1005507.e166"><alternatives><graphic id="pcbi.1005507.e166g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e166" xlink:type="simple"/><mml:math display="inline" id="M166"><mml:mrow><mml:mo>〈</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo> <mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, which according to <xref ref-type="disp-formula" rid="pcbi.1005507.e153">Eq (13)</xref> is indeed a deterministic functional of the past activities. Finally, we note that the case of large but finite populations permits a Gaussian approximation, which yields the more explicit form
<disp-formula id="pcbi.1005507.e167"><alternatives><graphic id="pcbi.1005507.e167g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e167" xlink:type="simple"/><mml:math display="block" id="M167"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msqrt><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>N</mml:mi></mml:mfrac></mml:msqrt> <mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
Here, <italic>ξ</italic>(<italic>t</italic>) is a Gaussian white noise with correlation function 〈<italic>ξ</italic>(<italic>t</italic>)<italic>ξ</italic>(<italic>t</italic>′)〉 = <italic>δ</italic>(<italic>t</italic> − <italic>t</italic>′). The correlations of <italic>ξ</italic>(<italic>t</italic>) are white because spikes at <italic>t</italic>′ and <italic>t</italic> &gt; <italic>t</italic>′ are independent <italic>given</italic> the expected population activity <inline-formula id="pcbi.1005507.e168"><alternatives><graphic id="pcbi.1005507.e168g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e168" xlink:type="simple"/><mml:math display="inline" id="M168"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> at time <italic>t</italic>. However, we emphasize that the expected population activity <inline-formula id="pcbi.1005507.e169"><alternatives><graphic id="pcbi.1005507.e169g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e169" xlink:type="simple"/><mml:math display="inline" id="M169"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> does include information on the past fluctuations <italic>ξ</italic>(<italic>t</italic>′) at time <italic>t</italic>′. Therefore the fluctuations of the total activity <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) are not white but a sum of a colored process <inline-formula id="pcbi.1005507.e170"><alternatives><graphic id="pcbi.1005507.e170g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e170" xlink:type="simple"/><mml:math display="inline" id="M170"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and a white-noise process <italic>ξ</italic>(<italic>t</italic>) [<xref ref-type="bibr" rid="pcbi.1005507.ref055">55</xref>]. The white noise gives rise to the delta peak of the auto-correlation function at zero time lag which is a standard feature of any spike train, and hence also of <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>). The colored process <inline-formula id="pcbi.1005507.e171"><alternatives><graphic id="pcbi.1005507.e171g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e171" xlink:type="simple"/><mml:math display="inline" id="M171"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, on the other hand, arises from <xref ref-type="disp-formula" rid="pcbi.1005507.e153">Eq (13)</xref> via a filtering of the <italic>actual</italic> population activity <inline-formula id="pcbi.1005507.e172"><alternatives><graphic id="pcbi.1005507.e172g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e172" xlink:type="simple"/><mml:math display="inline" id="M172"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> which includes the past fluctuations <inline-formula id="pcbi.1005507.e173"><alternatives><graphic id="pcbi.1005507.e173g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e173" xlink:type="simple"/><mml:math display="inline" id="M173"><mml:mrow><mml:mi>ξ</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. For neurons with refractoriness, <inline-formula id="pcbi.1005507.e174"><alternatives><graphic id="pcbi.1005507.e174g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e174" xlink:type="simple"/><mml:math display="inline" id="M174"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is negatively correlated with recent fluctuations <inline-formula id="pcbi.1005507.e175"><alternatives><graphic id="pcbi.1005507.e175g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e175" xlink:type="simple"/><mml:math display="inline" id="M175"><mml:mrow><mml:mi>ξ</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (cf. the thought experiment of <xref ref-type="fig" rid="pcbi.1005507.g002">Fig 2B</xref>) leading to a trough at small time lags in the spike auto-correlation function [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref053">53</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref090">90</xref>].</p>
<p>The set of coupled Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e079">6</xref>), (<xref ref-type="disp-formula" rid="pcbi.1005507.e146">12</xref>), (<xref ref-type="disp-formula" rid="pcbi.1005507.e144">11</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1005507.e159">14</xref>) constitute the desired mesoscopic population dynamics and is the main result of the paper. The dynamics is fully determined by the history of the mesoscopic population activity <italic>A</italic><sub><italic>N</italic></sub>. The Gaussian white noise in <xref ref-type="disp-formula" rid="pcbi.1005507.e167">Eq (15)</xref> or the independent random number involved in the generation of the population activity via <xref ref-type="disp-formula" rid="pcbi.1005507.e159">Eq (14)</xref> is the only source of stochasticity and summarizes the effect of microscopic noise on the mesoscopic level. Microscopic detail such as the knowledge of how many neurons occupy a certain microstate <inline-formula id="pcbi.1005507.e176"><alternatives><graphic id="pcbi.1005507.e176g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e176" xlink:type="simple"/><mml:math display="inline" id="M176"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> has been removed.</p>
<p>One may wonder where the neuronal interactions enter in the population equation. Synaptic interactions are contained in the conditional intensity <inline-formula id="pcbi.1005507.e177"><alternatives><graphic id="pcbi.1005507.e177g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e177" xlink:type="simple"/><mml:math display="inline" id="M177"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> which depends on the membrane potential <inline-formula id="pcbi.1005507.e178"><alternatives><graphic id="pcbi.1005507.e178g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e178" xlink:type="simple"/><mml:math display="inline" id="M178"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, which in turn is driven by the synaptic current that depends on the population activity via <xref ref-type="disp-formula" rid="pcbi.1005507.e288">Eq (29)</xref> in M<sc>ethods</sc>. An illustration of the derived mesoscopic model is shown in <xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1C</xref> (inset). In this section, we considered a single population to keep the notation simple. However, it is straightforward to formulate the corresponding equations for the case of several equations as shown in M<sc>ethods</sc>, Sec. “Several populations”.</p>
</sec>
<sec id="sec006">
<title>Stochastic population dynamics can be efficiently simulated forward in time</title>
<p>The stochastic population equations provide a rapid means to integrate the population dynamics on a mesoscopic level. To this end, we devised an efficient integration algorithm based on approximating the infinite integrals in the population equation <xref ref-type="disp-formula" rid="pcbi.1005507.e153">Eq (13)</xref> by discrete sums over a finite number of refractory states <inline-formula id="pcbi.1005507.e179"><alternatives><graphic id="pcbi.1005507.e179g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e179" xlink:type="simple"/><mml:math display="inline" id="M179"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (<xref ref-type="sec" rid="sec018">M<sc>ethods</sc></xref>, Sec. “Numerical implementation”). The algorithm involves the generation of only one random number per time step and population, because the activity is sampled from the mesoscopic rate <inline-formula id="pcbi.1005507.e180"><alternatives><graphic id="pcbi.1005507.e180g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e180" xlink:type="simple"/><mml:math display="inline" id="M180"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. In contrast, the microscopic simulation requires in each time step to draw a random number for each neuron. Furthermore, because the population equations do not depend on the number of neurons, we expect a significant speed-up factor for large neural networks compared to a corresponding microscopic simulation. For example, the microscopic simulation of the cortical column in <xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1B</xref> took 13.5 minutes to simulate 10 seconds of biological time, whereas the corresponding forward integration of the stochastic population dynamics (<xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1D</xref>) took only 6.6 seconds on the same machine (see Sec. “Comparison of microscopic and mesoscopic simulations”).</p>
<p>A pseudocode of the algorithm to simulate neural population dynamics is provided in M<sc>ethods</sc> (Sec. “Numerical implementation”). In addition to that, a reference implementation of this algorithm is publicly available under <ext-link ext-link-type="uri" xlink:href="https://github.com/schwalger/mesopopdyn_gif" xlink:type="simple">https://github.com/schwalger/mesopopdyn_gif</ext-link>, and will be integrated in the Neural Simulation Tool (NEST) [<xref ref-type="bibr" rid="pcbi.1005507.ref091">91</xref>], <ext-link ext-link-type="uri" xlink:href="https://github.com/nest/nest-simulator" xlink:type="simple">https://github.com/nest/nest-simulator</ext-link>, as a module presumably named <monospace>gif_pop_psc_exp</monospace>.</p>
</sec>
</sec>
<sec id="sec007">
<title>Two different consequences of finite <italic>N</italic></title>
<p>For a first analysis of the finite-size effects, we consider the special case of a fully-connected network of Poisson neurons with absolute refractory period [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>]. In this case, the conditional intensity can be represented as <inline-formula id="pcbi.1005507.e181"><alternatives><graphic id="pcbi.1005507.e181g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e181" xlink:type="simple"/><mml:math display="inline" id="M181"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>f</mml:mi> <mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>Θ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>t</italic><sub>ref</sub> is the absolute refractory period, Θ(⋅) is the Heaviside step function and <italic>h</italic>(<italic>t</italic>) is the free membrane potential, which obeys the passive membrane dynamics
<disp-formula id="pcbi.1005507.e182"><alternatives><graphic id="pcbi.1005507.e182g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e182" xlink:type="simple"/><mml:math display="block" id="M182"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext></mml:msub> <mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>h</mml:mi></mml:mrow> <mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>h</mml:mi> <mml:mo>+</mml:mo> <mml:mi>μ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext></mml:msub> <mml:mi>J</mml:mi> <mml:mspace width="0.166667em"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>*</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
where <italic>τ</italic><sub>m</sub> is the membrane time constant, <italic>μ</italic>(<italic>t</italic>) = <italic>u</italic><sub>rest</sub> + <italic>RI</italic>(<italic>t</italic>) (where <italic>u</italic><sub>rest</sub> is the resting potential and <italic>R</italic> is the membrane resistance) accounts for all currents <italic>I</italic>(<italic>t</italic>) that are independent of the population activities, <italic>J</italic> is the synaptic strength and <italic>ϵ</italic>(<italic>t</italic>) is a synaptic filter kernel (see <xref ref-type="sec" rid="sec018">M<sc>ethods</sc></xref>, <xref ref-type="disp-formula" rid="pcbi.1005507.e260">Eq (27)</xref> for details). For the mathematical analysis, we assume that the activity <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) and input <italic>μ</italic>(<italic>t</italic>) have started at <italic>t</italic> = −∞ so that we do not need to worry about initial conditions. In a simulation, we could for example start at <italic>t</italic> = 0 with initial conditions <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) = <italic>δ</italic>(<italic>t</italic>) for <italic>t</italic> ≤ 0 and <italic>h</italic>(0) = 0.</p>
<p>For the conditional intensity given above, the effective rate Λ(<italic>t</italic>), <xref ref-type="disp-formula" rid="pcbi.1005507.e144">Eq (11)</xref>, is given by Λ(<italic>t</italic>) = <italic>f</italic>(<italic>h</italic>(<italic>t</italic>)) because the variance <inline-formula id="pcbi.1005507.e183"><alternatives><graphic id="pcbi.1005507.e183g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e183" xlink:type="simple"/><mml:math display="inline" id="M183"><mml:mrow><mml:mi>v</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is zero during the absolute refractory period <inline-formula id="pcbi.1005507.e184"><alternatives><graphic id="pcbi.1005507.e184g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e184" xlink:type="simple"/><mml:math display="inline" id="M184"><mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>≤</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. As a result, the mesoscopic population <xref ref-type="disp-formula" rid="pcbi.1005507.e153">Eq (13)</xref> reduces to the simple form
<disp-formula id="pcbi.1005507.e185"><alternatives><graphic id="pcbi.1005507.e185g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e185" xlink:type="simple"/><mml:math display="block" id="M185"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mfenced close="]" open="[" separators=""><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
This mesoscopic equation is exact and could have been constructed directly in this simple case. For <italic>N</italic> → ∞, where <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) becomes identical to <inline-formula id="pcbi.1005507.e186"><alternatives><graphic id="pcbi.1005507.e186g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e186" xlink:type="simple"/><mml:math display="inline" id="M186"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, this equation has been derived by Wilson and Cowan [<xref ref-type="bibr" rid="pcbi.1005507.ref016">16</xref>], see also [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref092">92</xref>]. The intuitive interpretation of <xref ref-type="disp-formula" rid="pcbi.1005507.e185">Eq (17)</xref> is that the activity at time <italic>t</italic> consists of two factors, the “free” rate λ<sub>free</sub>(<italic>t</italic>) = <italic>f</italic>(<italic>h</italic>(<italic>t</italic>)) that would be expected in the absence of refractoriness and the fraction of actually available (“free”) neurons that are not in the refractory period. For finite-size populations, these two factors explicitly reveal two distinct finite-size effects: firstly, the free rate is driven by the fluctuating population activity <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) via <xref ref-type="disp-formula" rid="pcbi.1005507.e182">Eq (16)</xref> and hence the free rate exhibits finite-size fluctuations. This effect originates from the transmission of the fluctuations through the recurrent synaptic connectivity. Secondly, the fluctuations of the population activity impacts the refractory state of the population, i.e. the fraction of free neurons, as revealed by the second factor in <xref ref-type="disp-formula" rid="pcbi.1005507.e185">Eq (17)</xref>. In particular, a large positive fluctuations of <italic>A</italic><sub><italic>N</italic></sub> in the recent past reduces the fraction of free neurons, which causes a negative fluctuation of the number <inline-formula id="pcbi.1005507.e187"><alternatives><graphic id="pcbi.1005507.e187g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e187" xlink:type="simple"/><mml:math display="inline" id="M187"><mml:mrow><mml:mi>N</mml:mi> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> of expected firings in the next time step. Therefore, refractoriness generates negative correlations of the fluctuations 〈Δ<italic>A</italic>(<italic>t</italic>)Δ<italic>A</italic>(<italic>t</italic>′)〉 for small |<italic>t</italic> − <italic>t</italic>′|. We note that such a decrease of the expected rate would not have been possible if the correction term in <xref ref-type="disp-formula" rid="pcbi.1005507.e153">Eq (13)</xref> was absent. However, incorporating the effect of recent fluctuations (i.e. fluctuations in the number of refractory neurons) on the number of free neurons by adding the correction term, and thereby balancing the total number of neurons, recovers the correct <xref ref-type="disp-formula" rid="pcbi.1005507.e185">Eq (17)</xref>.</p>
<p>The same arguments can be repeated in the general setting of <xref ref-type="disp-formula" rid="pcbi.1005507.e153">Eq (13)</xref>. Firstly, the conditional intensity <inline-formula id="pcbi.1005507.e188"><alternatives><graphic id="pcbi.1005507.e188g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e188" xlink:type="simple"/><mml:math display="inline" id="M188"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> depends on the past fluctuations of the population activity because of network feedback. Secondly, the fluctuations lead to an imbalance in the number of neurons across different states of relative refractoriness (i.e. fluctuations do not add up to zero) which gives rise to the “correction term”, i.e. the second term on the r.h.s. of <xref ref-type="disp-formula" rid="pcbi.1005507.e153">Eq (13)</xref>.</p>
</sec>
<sec id="sec008">
<title>Comparison of microscopic and mesoscopic simulations</title>
<p>We wondered how well the statistics of the population activities obtained from the integration of the mesoscopic equations compare with the corresponding activities generated by a microscopic simulation. As we deal with a finite-size system, not only to the first-order statistics (mean activity) but also higher-order statistics needs to be considered. Because there are several approximations involved (e.g. full connectivity, quasi-renewal approximation and effective rate of fluctuations in the refractory density), we do not expect a perfect match. To compare first- and second-order statistics, we will mainly use the power spectrum of the population activities in the stationary state (see <xref ref-type="sec" rid="sec018">M<sc>ethods</sc></xref>, Sec. “Power spectrum”).</p>
<sec id="sec009">
<title>Mesoscopic equations capture refractoriness</title>
<p>Our theory describes the interplay between finite-size fluctuations and spike-history effects. The most prominent spike-history effect is refractoriness, i.e. the strong effect of the last spike on the current probability to spike. To study this effect, we first focus on a population of uncoupled neurons with a constant threshold corresponding to leaky integrate-and-fire (LIF) models without adaptation (<xref ref-type="fig" rid="pcbi.1005507.g003">Fig 3</xref>). The reset of the membrane potential after each spike introduces a period of relative refractoriness, where spiking is less likely due to a hyper-polarized membrane potential (<xref ref-type="fig" rid="pcbi.1005507.g003">Fig 3A</xref>). Because of the reset to a fixed value, the spike trains of the LIF neurons are renewal processes. In the stationary state, the fluctuation statistics as characterized by the power spectrum is known analytically for the case of a population of independent renewal spike trains (<xref ref-type="disp-formula" rid="pcbi.1005507.e575">Eq (134)</xref> in <xref ref-type="sec" rid="sec018">M<sc>ethods</sc></xref>).</p>
<fig id="pcbi.1005507.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005507.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Population activity of uncoupled leaky integrate-and-fire neurons without adaptation.</title>
<p>(A) Neurons were stimulated by a step current <italic>I</italic><sub>ext</sub>(<italic>t</italic>) such that <italic>μ</italic> = <italic>u</italic><sub>rest</sub> + <italic>RI</italic><sub>ext</sub>(<italic>t</italic>) increased from <italic>μ</italic> = 15 mV to <italic>μ</italic> = 30 mV (top). Voltage trace of one of 500 neurons (bottom). Stationary firing statistics (rate and coefficient of variation (CV) of the interspike intervals) corresponding to the two stimuli are indicated above the step current. (B) Realizations of the population activity <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) for the microscopic (top) and mesoscopic (bottom, blue line) simulation. The magenta line shows the expected population rate <inline-formula id="pcbi.1005507.e189"><alternatives><graphic id="pcbi.1005507.e189g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e189" xlink:type="simple"/><mml:math display="inline" id="M189"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> given the past actual realization <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>′) for <italic>t</italic>′ &lt; <italic>t</italic>. (C) The power spectrum of the stationary activity <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) obtained from renewal theory, <xref ref-type="disp-formula" rid="pcbi.1005507.e575">Eq (134)</xref>, (black solid line) and from the mesoscopic simulation (blue circles). The top and bottom panel corresponds to weak (<italic>μ</italic> = 15 mV) and strong (<italic>μ</italic> = 30 mV) constant stimulation (transient removed).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005507.g003" xlink:type="simple"/>
</fig>
<p>A single realization of the population activity <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) fluctuates around the expected activity <inline-formula id="pcbi.1005507.e190"><alternatives><graphic id="pcbi.1005507.e190g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e190" xlink:type="simple"/><mml:math display="inline" id="M190"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> that exhibits a typical ringing in response to a step current stimulation [<xref ref-type="bibr" rid="pcbi.1005507.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref093">93</xref>]. The time course of the expected activity as well as the size of fluctuations are roughly similar for microscopic simulation (<xref ref-type="fig" rid="pcbi.1005507.g003">Fig 3B</xref>, top) and the numerical integration of the population equations (<xref ref-type="fig" rid="pcbi.1005507.g003">Fig 3B</xref>, bottom). We also note that the expected activity <inline-formula id="pcbi.1005507.e191"><alternatives><graphic id="pcbi.1005507.e191g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e191" xlink:type="simple"/><mml:math display="inline" id="M191"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is not constant in the stationary regime but shows weak fluctuations. This is because of the feedback of the actual realization of <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>′) for <italic>t</italic>′ &lt; <italic>t</italic> onto the dynamics of <inline-formula id="pcbi.1005507.e192"><alternatives><graphic id="pcbi.1005507.e192g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e192" xlink:type="simple"/><mml:math display="inline" id="M192"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <xref ref-type="disp-formula" rid="pcbi.1005507.e153">Eq (13)</xref>.</p>
<p>A closer inspection confirms that the fluctuations generated by the mesoscopic population dynamics in the stationary state exhibit the same power spectrum (<xref ref-type="fig" rid="pcbi.1005507.g003">Fig 3C</xref>) as the theoretically predicted one, which is given by <xref ref-type="disp-formula" rid="pcbi.1005507.e575">Eq (134)</xref>. In particular, the mesoscopic equations capture the fluctuation statistics even at high firing rates, where the power spectrum strongly deviates from the white (flat) power spectrum of a Poisson process (<xref ref-type="fig" rid="pcbi.1005507.g003">Fig 3C</xref> bottom). The pronounced dip at low-frequencies is a well-known signature of neuronal refractoriness [<xref ref-type="bibr" rid="pcbi.1005507.ref094">94</xref>].</p>
</sec>
<sec id="sec010">
<title>Mesoscopic equations capture adaptation and burstiness</title>
<p>Further important spike-history effects can be realized by a dynamic threshold. For instance, spike-frequency adaptation, where a neuron adapts its firing rate in response to a step current after an initial strong response (<xref ref-type="fig" rid="pcbi.1005507.g004">Fig 4A and 4B</xref>), can be modeled by an accumulating threshold that slowly decays between spikes [<xref ref-type="bibr" rid="pcbi.1005507.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref049">49</xref>]. In single realizations, the mean population rate as well as the size of fluctuations appear to be similar for microscopic and mesoscopic case (<xref ref-type="fig" rid="pcbi.1005507.g004">Fig 4B</xref>, top and bottom, respectively). For a more quantitative comparison we compared the ensemble statistics as quantified by the power spectrum. This comparison reveals that the fluctuation statistics is well captured by the mesoscopic model (<xref ref-type="fig" rid="pcbi.1005507.g004">Fig 4C</xref>). The main effect of adaptation is a marked reduction in the power spectrum at low frequencies compared to the non-adaptive neurons of <xref ref-type="fig" rid="pcbi.1005507.g003">Fig 3</xref>. The small discrepancies compared to the microscopic simulation originate from the quasi-renewal approximation, which does not account for the individual spike history of a neuron before the last spike but only uses the population averaged history. This approximation is expected to work well if the threshold kernel changes slowly, effectively averaging the spike history locally in time [<xref ref-type="bibr" rid="pcbi.1005507.ref063">63</xref>].</p>
<fig id="pcbi.1005507.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005507.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Population dynamics captures adaptation and burstiness.</title>
<p>(A) 500 adapting leaky integrate-and-fire neurons were stimulated by a step current <italic>I</italic><sub>ext</sub> that increased <italic>μ</italic> = <italic>u</italic><sub>rest</sub> + <italic>RI</italic><sub>ext</sub>(<italic>t</italic>) from <italic>μ</italic> = 12 mV to <italic>μ</italic> = 27 mV (top). Voltage trace of one neuron (bottom). Stationary firing statistics (rate and coefficient of variation (CV)) corresponding to the two stimuli are indicated above the step current. (B) Realizations of the population activity obtained from microscopic simulation (black) and mesoscopic population equation (blue) as well as <inline-formula id="pcbi.1005507.e193"><alternatives><graphic id="pcbi.1005507.e193g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e193" xlink:type="simple"/><mml:math display="inline" id="M193"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (magenta). (C) Power spectra corresponding to the stationary activity (averaged over 1024 trials each of 20 s length) at low and high firing rates as in (A), circles and lines depict microscopic and mesoscopic case, respectively. Parameters in (A)–(C): <italic>u</italic><sub>th</sub> = 10 mV, <italic>u</italic><sub>r</sub> = 25 mV, threshold kernel <inline-formula id="pcbi.1005507.e194"><alternatives><graphic id="pcbi.1005507.e194g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e194" xlink:type="simple"/><mml:math display="inline" id="M194"><mml:mrow><mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ℓ</mml:mi></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ℓ</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> for <italic>t</italic> ≥ <italic>t</italic><sub>ref</sub> with <italic>J</italic><sub><italic>θ</italic>,1</sub> = 1.5 mV⋅s, <italic>τ</italic><sub><italic>θ</italic>,1</sub> = 0.01 s, <italic>J</italic><sub><italic>θ</italic>,2</sub> = 1.5 mV⋅s, <italic>τ</italic><sub><italic>θ</italic>,2</sub> = 1 s. (D) Bursty neuron model. (i) Biphasic threshold kernel <italic>θ</italic>(<italic>t</italic>), where a combination of a negative part (facilitation) and a positive part (adaptation) yields a bursty spike pattern, (ii) sample firing pattern of one neuron. (iii) The interspike interval distribution with values of rate and CV. (E) Power spectrum of the population activity <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) shown in (D)-(iv). Parameters in (D) and (E): <italic>μ</italic> = 20, <italic>u</italic><sub>th</sub> = 10 mV, <italic>u</italic><sub>r</sub> = 0 mV, <italic>τ</italic><sub>m</sub> = 0.01 s, facilitation: <italic>J</italic><sub><italic>θ</italic>,1</sub> = −0.45 mV⋅s, <italic>τ</italic><sub><italic>θ</italic>,1</sub> = 0.05 s; adaptation: <italic>J</italic><sub><italic>θ</italic>,2</sub> = 2.5 mV⋅s, <italic>τ</italic><sub><italic>θ</italic>,2</sub> = 1 s.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005507.g004" xlink:type="simple"/>
</fig>
<p>In the case of fast changes of the threshold kernel, we do not expect that the quasi-renewal approximation holds. For example, a biphasic kernel [<xref ref-type="bibr" rid="pcbi.1005507.ref095">95</xref>] with a facilitating part at short interspike intervals (ISI) and an adaptation part for large ISIs (<xref ref-type="fig" rid="pcbi.1005507.g004">Fig 4D-(i)</xref>) can realize bursty spike patterns (<xref ref-type="fig" rid="pcbi.1005507.g004">Fig 4D-(ii)</xref>). The burstiness is reflected in the ISI density by a peak at small ISIs, corresponding to ISIs within a burst, and a tail that extends to large ISIs representing interburst intervals (<xref ref-type="fig" rid="pcbi.1005507.g004">Fig 4D-(iii)</xref>). Remarkably, the mesoscopic equations with the quasi-renewal approximation qualitatively capture the burstiness, as can be seen by the strong low-frequency power at about 1 Hz (<xref ref-type="fig" rid="pcbi.1005507.g004">Fig 4E</xref>). At the same time, the effect of adaptation manifests itself in a reduced power at even lower frequencies. The systematic overestimation of the power across frequencies implies a larger variance of the empirical population activity obtained from the mesoscopic simulation, which is indeed visible by looking at the single realizations (<xref ref-type="fig" rid="pcbi.1005507.g004">Fig 4D-(iv)</xref>). As an aside, we note that facilitation which is strong compared to adaptation can lead to unstable neuron dynamics even for isolated neurons [<xref ref-type="bibr" rid="pcbi.1005507.ref096">96</xref>].</p>
</sec>
<sec id="sec011">
<title>Recurrent network of randomly connected neurons</title>
<p>So far, we have studied populations of uncoupled neurons. This allowed us to demonstrate that the mesoscopic dynamics captures effects of single neuron dynamics on the fluctuations of the population activity. Let us now suppose that each neuron in a population <italic>α</italic> is randomly connected to presynaptic neurons in population <italic>β</italic> with probability <italic>p</italic><sup><italic>αβ</italic></sup> such that the in-degree is fixed to <italic>p</italic><sup><italic>αβ</italic></sup> <italic>N</italic><sup><italic>β</italic></sup> connections. In the presence of synaptic coupling, the fluctuations at time <italic>t</italic> are propagated through the recurrent connectivity and may significantly influence the population activity at time <italic>t</italic>′ &gt; <italic>t</italic>. For instance, in a fully-connected network (<italic>p</italic><sup><italic>αβ</italic></sup> = <italic>p</italic> = 1 for all <italic>α</italic> and <italic>β</italic>) of excitatory and inhibitory neurons (E-I network, <xref ref-type="fig" rid="pcbi.1005507.g005">Fig 5B and 5C</xref>), all neurons within a population receive identical inputs given by the population activities <inline-formula id="pcbi.1005507.e199"><alternatives><graphic id="pcbi.1005507.e199g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e199" xlink:type="simple"/><mml:math display="inline" id="M199"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (cf. <xref ref-type="disp-formula" rid="pcbi.1005507.e288">Eq (29)</xref>). Finite-size fluctuations of <inline-formula id="pcbi.1005507.e200"><alternatives><graphic id="pcbi.1005507.e200g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e200" xlink:type="simple"/><mml:math display="inline" id="M200"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> generate common input to all neurons and tend to synchronize neurons. This effect manifests itself in large fluctuations of the population activity (<xref ref-type="fig" rid="pcbi.1005507.g005">Fig 5B</xref>). Since the mean-field approximation of the synaptic input becomes exact in the limit <italic>p</italic> → 1, we expect a good match between the microscopic and mesoscopic simulation in this case. Interestingly, the power spectra of the population activities obtained from these simulations coincide well even for an extremely small E-I network consisting of only one inhibitory and four excitatory neurons (<xref ref-type="fig" rid="pcbi.1005507.g005">Fig 5C</xref>). This extreme case of <italic>N</italic> = 5 neurons with strong synapses (here, <italic>w</italic><sup><italic>EE</italic></sup> = <italic>w</italic><sup><italic>IE</italic></sup> = 12 mV, <italic>w</italic><sup><italic>II</italic></sup> = <italic>w</italic><sup><italic>EI</italic></sup> = −60 mV) highlights the non-perturbative character of our theory for fully-connected networks, which does not require the inverse system size or the synaptic strength to be small. In general, the power spectra reveal pronounced oscillations that are induced by finite size fluctuations [<xref ref-type="bibr" rid="pcbi.1005507.ref043">43</xref>]. The amplitude of these stochastic oscillations decreases as the network size increases and vanishes in the large-<italic>N</italic> limit.</p>
<fig id="pcbi.1005507.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005507.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Mesoscopic dynamics of E-I network for varying network size <italic>N</italic>, connection probability <italic>p</italic> and number of synapses per neuron <italic>C</italic>.</title>
<p>(A) Left: Schematic of the network of <italic>N</italic><sup><italic>E</italic></sup> excitatory and <italic>N</italic><sup><italic>I</italic></sup> = <italic>N</italic><sup><italic>E</italic></sup>/4 inhibitory leaky integrate-and-fire (LIF) neurons, each receiving <italic>C</italic><sup><italic>E</italic></sup> = <italic>pN</italic><sup><italic>E</italic></sup> (<italic>C</italic><sup><italic>I</italic></sup> = <italic>pN</italic><sup><italic>I</italic></sup>) connections from a random subset of excitatory (inhibitory) neurons. Total numbers are <italic>N</italic> = <italic>N</italic><sup><italic>E</italic></sup> + <italic>N</italic><sup><italic>I</italic></sup> and <italic>C</italic> = <italic>C</italic><sup><italic>E</italic></sup> + <italic>C</italic><sup><italic>I</italic></sup>. At <italic>C</italic> = 200, the synaptic strength is <italic>w</italic> = 0.3 mV and −<italic>gw</italic> = −1.5 mV for excitatory and inhibitory connections, respectively. To preserve a constant mean synaptic input, the synaptic strength is scaled such that <italic>Cw</italic> = <italic>const</italic>‥ Right: Schematic of a corresponding mesoscopic model of two interacting populations. (B) Trajectories of <italic>u</italic>(<italic>t</italic>) for five example neurons (top) and of the excitatory population activity <inline-formula id="pcbi.1005507.e195"><alternatives><graphic id="pcbi.1005507.e195g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e195" xlink:type="simple"/><mml:math display="inline" id="M195"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>E</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> obtained from the network simulation (middle) and the mesoscopic simulation (bottom, dark green) for <italic>C</italic> = <italic>N</italic> = 50; time resolution Δ<italic>t</italic> = 0.2 ms. The light green trajectory (bottom panel) depicts the expected population activity <inline-formula id="pcbi.1005507.e196"><alternatives><graphic id="pcbi.1005507.e196g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e196" xlink:type="simple"/><mml:math display="inline" id="M196"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>E</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> given the past activity. (C) Power spectra of <inline-formula id="pcbi.1005507.e197"><alternatives><graphic id="pcbi.1005507.e197g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e197" xlink:type="simple"/><mml:math display="inline" id="M197"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>E</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for different network sizes while keeping <italic>p</italic> = 1 fixed (microscopic: symbols, mesoscopic: solid lines with corresponding dark colors). (D) Sample trajectories corresponding to the green curve in (E) (<italic>N</italic> = 1000, <italic>p</italic> = 0.2). (E) Analogously to (C) but varying the connection probabilities while keeping <italic>C</italic> = <italic>pN</italic> = 200 fixed. (F) Sample trajectories corresponding to the green curve in (G) (<italic>N</italic> = 200, <italic>C</italic> = 40). (G) Analogously to (C) but varying the number of synapses <italic>C</italic> while keeping <italic>N</italic> = 200 fixed. Note that the mesoscopic theory (black solid line) is independent of <italic>C</italic> because the product <italic>Cw</italic>, which determines the interaction strength in the mesoscopic model (see, left panel of (A)), is kept constant. Parameters: <italic>μ</italic><sup><italic>E</italic>/<italic>I</italic></sup> = 24 mV, <inline-formula id="pcbi.1005507.e198"><alternatives><graphic id="pcbi.1005507.e198g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e198" xlink:type="simple"/><mml:math display="inline" id="M198"><mml:mrow><mml:msubsup><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>/</mml:mo> <mml:mi>I</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> mV and <italic>θ</italic><sup><italic>E</italic>/<italic>I</italic></sup>(<italic>t</italic>) ≡ 0 (no adaptation).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005507.g005" xlink:type="simple"/>
</fig>
<p>If the network is not fully but randomly-connected (0 &lt; <italic>p</italic> &lt; 1), neurons still share a part of the finite-size fluctuations of the population activity. Earlier theoretical studies [<xref ref-type="bibr" rid="pcbi.1005507.ref058">58</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref068">68</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref097">97</xref>] have pointed out that these common fluctuations inevitably yield correlated and partially synchronized neural activity, as observed in simulations (<xref ref-type="fig" rid="pcbi.1005507.g005">Fig 5D and 5F</xref>). This genuine finite-size effect decreases for larger networks approaching an asynchronous state [<xref ref-type="bibr" rid="pcbi.1005507.ref098">98</xref>] (<xref ref-type="fig" rid="pcbi.1005507.g005">Fig 5C and 5E</xref>). As argued in previous studies [<xref ref-type="bibr" rid="pcbi.1005507.ref058">58</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref060">60</xref>], the fluctuations of the synaptic input can be decomposed into two components, a coherent and an incoherent one. The coherent fluctuations are given by the fluctuations of the population activity and are thus common to all neurons of a population. This component is exactly described by our mean-field approximation, <inline-formula id="pcbi.1005507.e201"><alternatives><graphic id="pcbi.1005507.e201g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e201" xlink:type="simple"/><mml:math display="inline" id="M201"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> used in <xref ref-type="disp-formula" rid="pcbi.1005507.e036">Eq (4)</xref> (cf. <xref ref-type="sec" rid="sec018">M<sc>ethods</sc></xref>, <xref ref-type="disp-formula" rid="pcbi.1005507.e299">Eq (31)</xref>). The incoherent fluctuations are caused by the quenched randomness of the network (i.e. each neuron receives input from a different subpopulation of the network) and have been described as independent Poisson input in earlier studies [<xref ref-type="bibr" rid="pcbi.1005507.ref058">58</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref060">60</xref>]. If we compare the membrane potential of a <italic>single</italic> neuron with the one expected from the mean-field approximation (<xref ref-type="fig" rid="pcbi.1005507.g006">Fig 6A, 6C and 6E</xref>, top), we indeed observe a significant difference in fluctuations. This difference originates from the incoherent component. Differences in membrane potential will lead to differences in the instantaneous spike emission probability for each individual neuron; cf. <xref ref-type="disp-formula" rid="pcbi.1005507.e024">Eq (3)</xref>. However, in order to calculate the population activity we need to average the conditional firing rate of <xref ref-type="disp-formula" rid="pcbi.1005507.e024">Eq (3)</xref> over all neurons in the population (see <xref ref-type="sec" rid="sec018">Methods</xref>, <xref ref-type="disp-formula" rid="pcbi.1005507.e280">Eq (28)</xref> for details). Despite the fact that each neuron is characterized by a different last firing time <inline-formula id="pcbi.1005507.e202"><alternatives><graphic id="pcbi.1005507.e202g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e202" xlink:type="simple"/><mml:math display="inline" id="M202"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, the differences in firing rate caused by voltage fluctuations will, for sufficiently large <italic>N</italic> and not too small <italic>p</italic>, average out whereas common fluctuations caused by past fluctuations in the population activity will survive (<xref ref-type="fig" rid="pcbi.1005507.g006">Fig 6A, 6C and 6E</xref>, bottom). In other words, the coherent component is the one that dominates the finite-N activity whereas the incoherent one is washed out. Therefore, mesoscopic population activities can be well described by our mean-field approximation even when the network is not fully connected (Figs <xref ref-type="fig" rid="pcbi.1005507.g005">5E, 5G</xref> and <xref ref-type="fig" rid="pcbi.1005507.g006">6B, 6D, 6F</xref>). Remarkably, even for <italic>C</italic> = 200 synapses per neuron and <italic>p</italic> = 0.05, the mesoscopic model agrees well with the microscopic model. However, if both <italic>N</italic> and <italic>p</italic> are small, the mesoscopic theory breaks down as expected (<xref ref-type="fig" rid="pcbi.1005507.g005">Fig 5G</xref>, blue circles). Furthermore, strong synaptic weights imply strong incoherent noise, which is then passed through the exponential nonlinearity of the hazard function. This may lead to deviations of the population-averaged hazard rate from the corresponding mean-field approximation (<xref ref-type="fig" rid="pcbi.1005507.g006">Fig 6E</xref>, bottom), and, consequently, to deviations between microscopic and mesoscopic population activities in networks with strong random connections (<xref ref-type="fig" rid="pcbi.1005507.g006">Fig 6F</xref>).</p>
<fig id="pcbi.1005507.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005507.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Mean-field approximation of synaptic input for randomly connected networks.</title>
<p>The same E-I network as in <xref ref-type="fig" rid="pcbi.1005507.g005">Fig 5</xref> with <italic>N</italic> = 500 neurons and connection probability <italic>p</italic> = 0.2 was simulated for increasing synaptic strength <italic>w</italic><sup><italic>EE</italic></sup> = <italic>w</italic><sup><italic>IE</italic></sup> = <italic>w</italic> (<italic>w</italic><sup><italic>EI</italic></sup> = <italic>w</italic><sup><italic>II</italic></sup> = −5<italic>w</italic>) of excitatory (inhibitory) connections: (A, B) <italic>w</italic> = 0.25 mV, (C, D) <italic>w</italic> = 0.5 mV (E, F) <italic>w</italic> = 1 mV. (A, C, E) Top: Membrane potential of one example neuron shows fluctuations due to spike input from <italic>C</italic> = 100 presynaptic neurons (black line), which represent a random subset of all 500 neurons. The mean-field approximation of the membrane potential (dashed red line) assumes that the neuron had the same firing times but was driven by all neurons, i.e. by the population activities <inline-formula id="pcbi.1005507.e203"><alternatives><graphic id="pcbi.1005507.e203g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e203" xlink:type="simple"/><mml:math display="inline" id="M203"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>E</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005507.e204"><alternatives><graphic id="pcbi.1005507.e204g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e204" xlink:type="simple"/><mml:math display="inline" id="M204"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>I</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, with rescaled synaptic strength <inline-formula id="pcbi.1005507.e205"><alternatives><graphic id="pcbi.1005507.e205g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e205" xlink:type="simple"/><mml:math display="inline" id="M205"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi> <mml:mtext>MF</mml:mtext> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>/</mml:mo> <mml:mi>I</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:msup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>/</mml:mo> <mml:mi>I</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Although individual membrane potentials differ significantly from the mean-field approximation (top), the relevant population-averaged hazard rates <inline-formula id="pcbi.1005507.e206"><alternatives><graphic id="pcbi.1005507.e206g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e206" xlink:type="simple"/><mml:math display="inline" id="M206"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>micro</mml:mtext> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>/</mml:mo> <mml:mi>I</mml:mi></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>/</mml:mo> <mml:mi>I</mml:mi></mml:mrow></mml:msup></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>/</mml:mo> <mml:mi>I</mml:mi></mml:mrow></mml:msup></mml:msubsup> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (bottom) are well predicted by the mean-field approximation. (B, D, F) Corresponding power spectra of the (excitatory) population activity for microscopic (circles) and mesoscopic (blue solid line) simulation. Parameters as in <xref ref-type="fig" rid="pcbi.1005507.g005">Fig 5</xref> except <italic>μ</italic><sup><italic>E</italic>/<italic>I</italic></sup> = 18 mV.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005507.g006" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec012">
<title>Finite-size induced switching in bistable networks</title>
<p>In large but finite E-I networks, the main effect of weak finite-size fluctuations is to distort the deterministic population dynamics of the infinitely large network (stable asynchronous state or limit cycle motion) leading to stochastic oscillations and phase diffusion that can be understood analytically by linear response theory [<xref ref-type="bibr" rid="pcbi.1005507.ref043">43</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref055">55</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref060">60</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref069">69</xref>] and weakly nonlinear analysis [<xref ref-type="bibr" rid="pcbi.1005507.ref058">58</xref>]. This is qualitatively different in networks with multiple stable states. In such networks, finite-size fluctuations may have a drastic effect because they enable large switch-like transitions between metastable states that cannot be described by a linear or weakly nonlinear theory. We will show now that our mesoscopic population equation accurately captures strongly nonlinear effects, such as large fluctuations in multistable networks.</p>
<p>Multistability in spiking neural networks can emerge as a collective effect in balanced E-I networks with clustered connectivity [<xref ref-type="bibr" rid="pcbi.1005507.ref099">99</xref>], and, generically, in networks with a winner-take-all architecture, where excitatory populations compete through inhibitory interactions mediated by a common inhibitory population (see, e.g. [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref100">100</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref104">104</xref>] and <xref ref-type="fig" rid="pcbi.1005507.g007">Fig 7A</xref>). Jumps between metastable states have been used to model switchings in bistable perception [<xref ref-type="bibr" rid="pcbi.1005507.ref032">32</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref034">34</xref>]. To understand such finite-size induced switching in spiking neural networks on a qualitative level, phenomenological rate models have been usually employed [<xref ref-type="bibr" rid="pcbi.1005507.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref104">104</xref>]. In these models, stochastic switchings are enabled by noise added to the deterministic rate equations in an <italic>ad hoc</italic> manner. Our mesoscopic mean-field equations keep the spirit of such rate equations, however with the important difference that the noisy dynamics is systematically derived from the underlying spiking neural network without any free parameter. Here, we show that the mesoscopic mean-field equations <italic>quantitatively</italic> reproduce finite-size induced transitions between metastable states of spiking neural networks. We emphasize that the switching statistics depends sensitively on the properties of the noise that drive the transitions [<xref ref-type="bibr" rid="pcbi.1005507.ref105">105</xref>]. Therefore, an accurate account of finite-size fluctuations is expected to be particularly important in this case.</p>
<fig id="pcbi.1005507.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005507.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Finite-size induced switching in a bistable network.</title>
<p>(A) Schematic of a winner-take-all network architecture: Two competing excitatory populations (<italic>N</italic><sup><italic>E</italic>1</sup> = <italic>N</italic><sup><italic>E</italic>2</sup> = 400) interact with a common inhibitory population (<italic>N</italic><sup><italic>I</italic></sup> = 200). (B)-(D) In the absence of adaptation (<italic>θ</italic><sup><italic>E</italic>/<italic>I</italic></sup>(<italic>t</italic>) ≡ 0), the excitatory populations switch between low and high activities in an irregular fashion (B). Activities in (B, E) are low-pass-filtered by a moving average of 100 ms. Top: full network simulation. Inset: Magnified view of the activities for 1 s (without moving average) showing fast large-amplitude oscillations. Bottom: mesoscopic simulation. (C) The power spectrum of the activity of the excitatory populations exhibits large low-frequency power and a high-frequency peak corresponding to the slow stochastic switching between high- and low-activity states and the fast oscillations, respectively. (D) The density of the dominance times (i.e. the residence time in the high-activity states) has an exponential form. (E-G) Like (B-D) but excitatory neurons exhibit weak and slow adaptation (<inline-formula id="pcbi.1005507.e207"><alternatives><graphic id="pcbi.1005507.e207g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e207" xlink:type="simple"/><mml:math display="inline" id="M207"><mml:mrow><mml:msup><mml:mi>θ</mml:mi> <mml:mi>E</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> with <italic>J</italic><sub><italic>θ</italic></sub> = 0.1 mV⋅s, <italic>τ</italic><sub><italic>θ</italic></sub> = 1 s for <italic>t</italic> ≥ <italic>t</italic><sub>ref</sub>). Switching between high- and low-activity states is more regular than in the non-adapting case as revealed by a low-frequency peak in the power spectrum (F) and a narrow, unimodal density of dominance times (G). In (C, D) and (F, G) microscopic and mesoscopic simulation correspond to cyan symbols/bars and dark blue solid lines, respectively. Parameters: <italic>μ</italic><sup><italic>E</italic>/<italic>I</italic></sup> = 36 mV except for <italic>μ</italic><sup><italic>E</italic></sup> = 36.5 in (E-G) to compensate adaptation. Time step Δ<italic>t</italic> = 0.01 ms (microscopic), Δ<italic>t</italic> = 0.2 ms (mesoscopic). Efficacies of excitatory and inhibitory connections: <italic>w</italic><sup><italic>E</italic></sup> = 0.0624 mV and <italic>w</italic><sup><italic>I</italic></sup> = −0.2496 mV (B-D), and <italic>w</italic><sup><italic>E</italic></sup> = 0.096 mV and <italic>w</italic><sup><italic>I</italic></sup> = −0.384 mV (E-G), <italic>p</italic> = 1, <inline-formula id="pcbi.1005507.e208"><alternatives><graphic id="pcbi.1005507.e208g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e208" xlink:type="simple"/><mml:math display="inline" id="M208"><mml:mrow><mml:msubsup><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mo>/</mml:mo> <mml:mi>I</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> mV.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005507.g007" xlink:type="simple"/>
</fig>
<p>We consider a simple bistable network of two excitatory populations with activities <italic>A</italic><sup><italic>E</italic>1</sup> and <italic>A</italic><sup><italic>E</italic>2</sup>, respectively, that are reciprocally connected to a common inhibitory population with activity <italic>A</italic><sup><italic>I</italic></sup> (<xref ref-type="fig" rid="pcbi.1005507.g007">Fig 7A</xref>). We choose the mean input and the connection strength such that in the large-<italic>N</italic> limit the population activities exhibited two stable equilibrium states, one corresponding to a situation, where <italic>A</italic><sup><italic>E</italic>1</sup> is high and <italic>A</italic><sup><italic>E</italic>2</sup> is low, the other state corresponding to the inverse situation, where <italic>A</italic><sup><italic>E</italic>1</sup> is low and <italic>A</italic><sup><italic>E</italic>2</sup> is high. We found that in smaller networks, finite-size fluctuations are indeed sufficient to induce transitions between the two states leading to repeated switches between high- and low-activity states (<xref ref-type="fig" rid="pcbi.1005507.g007">Fig 7B and 7E</xref>). The regularity of the switching appears to depend crucially on the presence of adaptation, as has been suggested previously [<xref ref-type="bibr" rid="pcbi.1005507.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref034">34</xref>]. Remarkably, both in the presence and absence of adaptation, the switching dynamics of the spiking neural network appears to be well reproduced by the mesoscopic mean-field model.</p>
<p>For a more quantitative comparison, we use several statistical measures that characterize the bistable activity. Let us first consider the case without adaptation. As before, we compare the power spectra of the population activity for both microscopic and mesoscopic simulation and find a good agreement (<xref ref-type="fig" rid="pcbi.1005507.g007">Fig 7C</xref>). The peak in the power spectrum at relatively high-frequency reveals strong, rapid oscillations that are visible in the population activity after a switch to the high-activity state (inset of <xref ref-type="fig" rid="pcbi.1005507.g007">Fig 7B</xref> with magnified view). In contrast, the large power at low frequencies corresponds to the slow fluctuations caused by the switching of activity between the two excitatory populations, as revealed by the low-pass filtered population activity (<xref ref-type="fig" rid="pcbi.1005507.g007">Fig 7B</xref>). The Lorentzian shape of the power spectrum caused by the slow switching dynamics is consistent with stochastically independent, exponentially distributed residence times in each of the two activity states (i.e., a homogeneous Poisson process). The residence time distribution shows indeed a monotonic, exponential decay (<xref ref-type="fig" rid="pcbi.1005507.g007">Fig 7D</xref>) both in the microscopic and mesoscopic model. Furthermore, we found that residence times do not exhibit significant serial correlations. Together, this confirms the Poissonian nature of bistable switching in our three-population model of neurons without adaptation.</p>
<p>In models for perceptual bistability, residence times in the high-activity state are often called dominance times. The distribution of dominance times is usually not exponential but has been described by a more narrow, gamma-like distribution (see, e.g. [<xref ref-type="bibr" rid="pcbi.1005507.ref106">106</xref>]). Such a more narrow distribution emerges in a three-population network where excitatory neurons are weakly adaptive. When the population enters a high-activity state, the initial strong increase of the population activity is now followed by a slow adaptation to a somewhat smaller, stationary activity (<xref ref-type="fig" rid="pcbi.1005507.g007">Fig 7E</xref>). Eventually, the population jumps back to the low-activity state. The switching dynamics is much more regular with than without adaptation leading to slow stochastic oscillations as highlighted by a second peak in the power spectrum at low frequencies (<xref ref-type="fig" rid="pcbi.1005507.g007">Fig 7F</xref>) and a narrow distribution of dominance times (<xref ref-type="fig" rid="pcbi.1005507.g007">Fig 7G</xref>), in line with previous theoretical studies [<xref ref-type="bibr" rid="pcbi.1005507.ref032">32</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref034">34</xref>]. We emphasize, however, that in contrast to these studies the underlying deterministic dynamics for <italic>N</italic> → ∞ is in our case not oscillatory but bistable, because the adaptation level is below the critical value necessary in the deterministic model to switch back to the low-activity state.</p>
<p>The emergence of regular switching due to finite-size noise can be understood by interpreting the residence time of a given population in the high-activity state as arising from two stages: (i) the initial transient of the activity to a decreased (but still large) stationary value due to adaptation and (ii) the subsequent noise-induced escape from the stationary adapted state. The first stage is deterministic and hence does not contribute to the variability of the residence times. The variability results mainly from the second stage. The duration of the first stage is determined by the adaptation time scale. If this time covers a considerable part of the total residence time, we expect that the coefficient of variation (CV), defined as the ratio of standard deviation and mean residence time, is small. In the case without adaptation, a deterministic relaxation stage can be neglected against the mean noise-induced escape time so that the CV is larger.</p>
</sec>
<sec id="sec013">
<title>Mesoscopic dynamics of cortical microcolumn</title>
<p>As a final example, we applied the mesoscopic population equations to a biologically more detailed model of a local cortical microcircuit. Specifically, we used the multi-laminar column model of V1 proposed by Potjans and Diesmann [<xref ref-type="bibr" rid="pcbi.1005507.ref005">5</xref>] (see also [<xref ref-type="bibr" rid="pcbi.1005507.ref072">72</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref107">107</xref>] for an analysis of this model). It consists of about 80′000 non-adapting integrate-and-fire neurons organized into four layers (L2/3, L4, L5 and L6), each accommodating an excitatory and an inhibitory population (see schematic in <xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1A</xref>). The neurons are randomly connected within and across the eight populations. We slightly changed this model to include spike-frequency adaptation of excitatory neurons, as observed in experiments (see e.g. [<xref ref-type="bibr" rid="pcbi.1005507.ref026">26</xref>]). Furthermore, we replaced the Poissonian background noise in the original model by an increase of mean current drive and escape noise (both in the microscopic and mesoscopic model). The mean current drive was chosen such that the firing rates of the spontaneous activity were matched to the firing rates in the original model. We note that the fitting of the mean current was made possible by the use of our population equations, which allow for an efficient evaluation of the firing rates. The complete set of parameters is listed in M<sc>ethods</sc>, Sec. “Modified Potjans-Diesmann model”.</p>
<p>Sample trajectories of the population activities have already served as an illustration of our approach in <xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1</xref>, where neurons in layer 4 and 6 are stimulated by a step current of 30 ms duration, mimicking input from the thalamus as in the original study [<xref ref-type="bibr" rid="pcbi.1005507.ref005">5</xref>]. Individual realizations obtained from the microscopic and mesoscopic simulation differ due to the marked stochasticity of the population activities (<xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1B and 1D</xref>). However, trial-averaging reveals that the mean time-dependent activities that can be estimated from a peri-stimulus-time histogram (PSTH) obtained from microscopic and mesoscopic simulations indeed agree well, except for a slight underestimation of the oscillatory peak during stimulus offset compared to the microscopic simulation (<xref ref-type="fig" rid="pcbi.1005507.g008">Fig 8A</xref>). However, during the short moments where the mean time-dependent activity (PSTH) of the mescoscopic and microscopic simulation do not match, the time-dependent standard deviation across hundreds of trials (<xref ref-type="fig" rid="pcbi.1005507.g008">Fig 8B</xref>) is extremely high in both mesoscopic and microscopic simulation, indicating that fluctuations of the activity between one trial and the next are high after stimulus offset at 0.09s. The standard deviation as a function of time (<xref ref-type="fig" rid="pcbi.1005507.g008">Fig 8B</xref>) agrees overall nicely between microscopic and mesoscopic simulation, suggesting a good match of second-order statistics. A closer look at the second-order statistics, as provided by the power spectra of spontaneous activities (“ground state” of cortical activity), also reveals a good agreement at all frequencies (<xref ref-type="fig" rid="pcbi.1005507.g009">Fig 9</xref>). This agreement is remarkable in view of the low connection probabilities (<italic>p</italic> &lt; 0.14, see table 5 in [<xref ref-type="bibr" rid="pcbi.1005507.ref005">5</xref>]) that violate the assumption of dense random connectivity used in the derivation of the mesoscopic mean-field equations. More generally, this example demonstrates that the range of validity of our mesoscopic theory covers relevant cortical circuit models.</p>
<fig id="pcbi.1005507.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005507.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Time-dependent statistics of the population activities in a cortical column model.</title>
<p>(A) Trial-averaged population activities (peri-stimulus-time histogram, PSTH) in the modified Potjans-Diesmann model as illustrated for a single trial in <xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1</xref>. Circles and blue solid line show microscopic simulation (250 trials, simulation time step Δ<italic>t</italic> = 0.01 ms) and mesoscopic simulation (1000 trials, Δ<italic>t</italic> = 0.5 ms), respectively. A step current mimicking thalamic input is provided to neurons in layer 4 and 6 during a time window of 30 ms as indicated by the gray bar. Rows correspond to the layers L2/3, L4, L5 and L6, respectively, as indicated. Columns correspond to excitatory and inhibitory populations, respectively. (B) Corresponding, time-dependent standard deviation of <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) measured with temporal resolution Δ<italic>t</italic> = 0.5 ms.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005507.g008" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005507.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005507.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Stationary statistics of population activities in a cortical column model.</title>
<p>Power spectra of the spontaneous population activities <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) in the modified Potjans-Diesmann model in the absence of time-dependent thalamic input (corresponding to the activities shown in <xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1B</xref> (microscopic) and <xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1D</xref> (mesoscopic) outside of the stimulation window. Circles and blue solid lines represent microscopic and mesoscopic simulation, respectively. Rows correspond to the layers L2/3, L4, L5 and L6, respectively, as indicated. Columns correspond to excitatory and inhibitory populations, respectively.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005507.g009" xlink:type="simple"/>
</fig>
<p>Finally, we mention that the numerical integration of the mesoscopic population equations yields a significant speed-up compared to the microscopic simulation. While a systematic and fair comparison of the efficiencies depends on many details and is thus beyond the scope of this paper, we note that a simulation on a single core of 10s of biological time took 811.2s using the microscopic model, whereas that of the mesoscopic model only took 6.6s. This corresponds to a speed-up factor of around 120 achieved by using the mesoscopic population model. In the simulation, we employed the same integration time step of Δ<italic>t</italic> = 0.5 ms for both models for a first naive assessment of the performance. However, a more detailed comparison of the performance should be based on simulation parameters that achieve a given accuracy. In this case, we expect an even larger speed-up of the mesoscopic simulation because for the same accuracy the temporally coarse-grained population equations allow for a significantly larger time step than the microscopic simulation of spiking neurons.</p>
</sec>
</sec>
</sec>
<sec id="sec014" sec-type="conclusions">
<title>Discussion</title>
<p>In the present study we have derived stochastic population equations that govern the evolution of mesoscopic neural activity arising from a finite number of stochastic neurons. To our knowledge, this is the first time that such a mesoscopic dynamics has been derived from an underlying microscopic model of spiking neurons with pronounced spike-history effects. The microscopic model consists of interacting homogeneous populations of generalized integrate-and-fire (GIF) neuron models [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref026">26</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref028">28</xref>], or alternatively, spike-response (SRM) [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>] or generalized linear models (GLMs) [<xref ref-type="bibr" rid="pcbi.1005507.ref055">55</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref108">108</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref109">109</xref>]. These classes of neuron models account for various spike-history effects like refractoriness and adaptation [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref084">84</xref>]. Importantly, parameters of these models can be efficiently extracted from single cell experiments [<xref ref-type="bibr" rid="pcbi.1005507.ref027">27</xref>] providing faithful representations of real cortical cells under somatic current injection. The resulting population equations on the mesoscopic level yield the expected activity of each population at the present time as a functional of population activities in the past. Given the expected activities at the present time, the actual mesoscopic activities can be obtained by drawing independent random numbers. The derived mesoscopic dynamics captures nonlinear emergent dynamics as well as finite-size effects, such as noisy oscillations and stochastic transitions in multistable networks. Realizations generated by the mesoscopic model have the same statistics as the original microscopic model to a high degree of accuracy (as quantified by power spectra and residence time distributions). The equivalence of the population dynamics (mesoscopic model) and the network of spiking neurons (microscopic model) holds for a wide range of population sizes and coupling strengths, for time-dependent external stimulation, random connectivity within and between populations, and even if the single neurons are bursty or have spike-frequency adaptation.</p>
<sec id="sec015">
<title>Quantitative modeling of mesoscopic neural data: Applications and experimental predictions</title>
<p>Our theory provides a general framework to replace spiking neural networks that are organized into homogeneous populations by a network of interacting mesoscopic populations. For example, the excitatory and inhibitory neurons of a layer of a cortical column [<xref ref-type="bibr" rid="pcbi.1005507.ref005">5</xref>] may be represented by one population each, as in <xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1</xref>. Weak heterogeneity in the neuronal parameters are allowed in our theory because the mesoscopic equations describe the population-averaged behavior. Further subdivisions of the populations are possible, however, such as a subdivision of the inhibitory neurons into fast-spiking and non fast-spiking types [<xref ref-type="bibr" rid="pcbi.1005507.ref026">26</xref>]. Populations that show initially a large degree of heterogeneity can be further subdivided into smaller populations. In this case, a correct description of finite-size fluctuations, as provided by our theory, will be particularly important. However, as with any mean-field theory, we expect that our theory breaks down if neural activity and information processing is driven by a few “outlier” neurons such that a mean-field description becomes meaningless. Further limitations may result from the mean-field and quasi-renewal approximation, <xref ref-type="disp-formula" rid="pcbi.1005507.e036">Eq (4)</xref>. Formally, the mean-field approximation of the synaptic input requires dense connectivity and the heterogeneity in synaptic efficacies and in synapse numbers to be weak. Moreover, the quasi-renewal approximation assumes slow threshold dynamics. However, as we have demonstrated here, our mesoscopic population equations can provide in concrete applications excellent predictions even for sparse connectivity (Figs <xref ref-type="fig" rid="pcbi.1005507.g005">5D–5G</xref>, <xref ref-type="fig" rid="pcbi.1005507.g008">8</xref> and <xref ref-type="fig" rid="pcbi.1005507.g009">9</xref>) and may qualitatively reproduce the mesoscopic statistics in the presence of fast threshold dynamics (<xref ref-type="fig" rid="pcbi.1005507.g004">Fig 4D and 4E</xref>).</p>
<p>Using our mesoscopic population equations it is possible to make specific predictions about the response properties of local cortical circuits. For instance, recent progress in genetic methods now enables experimentalists to selectively label and record from genetically identified cell types, such as intratelencephalic (IT), pyramidal tract (PT) and corticothalamic (CT) neurons among the excitatory neurons, and vasoactive intestinal peptide (VIP), somatostatin (Sst) and parvalbumin (Pvalb) expressing neurons among the interneurons [<xref ref-type="bibr" rid="pcbi.1005507.ref004">4</xref>]. These cell types have received much attention recently as it has been proposed that they may form a basic functional module of cortex, the canonical circuit [<xref ref-type="bibr" rid="pcbi.1005507.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref110">110</xref>]. The genetic classification of cells defines subpopulations of the cortical network. A model of the canonical circuits of the cortex in terms of interacting mesoscopic populations can be particularly useful if used to describe experiments that use optogenetic stimulation of genetically-defined populations by light, which in our framework can be represented as a transient external input current. To build a mesoscopic population model based on our theory demands some assumptions about microscopic parameters such as (i) typical neuron parameters for each subpopulation, (ii) structural parameters as characterized by average synaptic efficacies and time scales of connections between and within populations, and (iii) estimates of neuron numbers per subpopulation. Parameters for a typical neuron of each population could be extracted by the efficient fitting procedures presented in [<xref ref-type="bibr" rid="pcbi.1005507.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref027">27</xref>]. Structural parameters and neuron numbers have been estimated, for instance, for barrel columns in rodents somato-sensory cortex [<xref ref-type="bibr" rid="pcbi.1005507.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref073">73</xref>] and other studies (see e.g., [<xref ref-type="bibr" rid="pcbi.1005507.ref005">5</xref>]). Our population equations could then be used to make predictions about circuit responses to light stimuli, e.g. by imaging the activity of a genetically-defined subpopulation in one column in response to optogenetic stimulation of another cell class in another column.</p>
<p>As a first step in this direction, we have demonstrated here that our population equations correctly predict the mesoscopic activities (means and fluctuations) of a simulation of a detailed, microscopic network model of a cortical microcircuit [<xref ref-type="bibr" rid="pcbi.1005507.ref005">5</xref>] under thalamic stimulation of layer 4 and 6 neurons. Using a population density method, mean activities of this model have also been predicted in a recent study to analyze its computational properties [<xref ref-type="bibr" rid="pcbi.1005507.ref107">107</xref>] with a special focus on predictive coding. Our population density approach goes beyond that study by also predicting finite-size fluctuations of the activities and their effects on the mesoscopic network dynamics such as finite-size induced stochastic oscillations. Predicting activities in real experiments is, however, complicated by the fact that the parameters of a microscopic network model are typically underconstrained given the lack or uncertainty of measured or estimated parameters [<xref ref-type="bibr" rid="pcbi.1005507.ref111">111</xref>]. Here, our population equations provide an efficient means to constrain unknown microscopic parameters by requiring consistence with mesoscopic experimental data.</p>
<p>While the canonical circuit represents a model of interacting populations on the mesoscopic level, recent interest in macroscopic models of entire brain areas or even of whole brains has risen [<xref ref-type="bibr" rid="pcbi.1005507.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref007">7</xref>]. Population dynamics can be used in this context as a means to reduce large parts of the macroscopic neuronal network to a system of interacting populations that is numerically manageable, and requires less detailed knowledge of synaptic connectivity (mean synaptic coupling of populations as opposed to individual synapses). However, even this information about mesoscopic network structure might not be available given that it corresponds to an <italic>M</italic> × <italic>M</italic> matrix of mean synaptic efficacies, where the number <italic>M</italic> of populations, or respectively cell types, might be large. In this case, our population equations can be utilized to efficiently constrain unknown structural parameters, such as synaptic weights, such that the resulting mesoscopic activities are consistent with experimental data. This leads in turn to experimentally testable predictions for synaptic connectivities. Such an approach [<xref ref-type="bibr" rid="pcbi.1005507.ref111">111</xref>] has been recently applied to a network model of primate visual cortex demonstrating the usefulness of mean-field theories for predicting structural properties of large-scale cortical networks.</p>
<p>An interesting complementary route for further studies is a multiscale model, in which a large-scale model is simulated in terms of reduced, mesoscopic populations but with one or several areas in focus that are simulated in full microscopic detail. As knowledge of anatomy and computational capacity increases, more and more mesoscopic populations can be replaced by a microscopic simulation, while at any time in this process the full system is represented in the model. We therefore expect our population dynamics model to be a useful tool to continuously integrate experimental data into multiscale models of whole mammalian brains.</p>
<p>Simplified whole brain models of interacting neuronal areas have recently been proposed [<xref ref-type="bibr" rid="pcbi.1005507.ref112">112</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref113">113</xref>]. Furthermore, large-scale neuro imaging data are routinely modeled by phenomenological population models such as neural mass, Wilson-Cowan, or neural field models [<xref ref-type="bibr" rid="pcbi.1005507.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref022">22</xref>]. Our new population dynamics theory could be used in such approaches as an accurate representation of the fluctuations of neural activity in the reduced areas. For example, in macroscopic data such as resting state fMRI, EEG or MEG, the endogenously generated fluctuations of brain activity are of major interest [<xref ref-type="bibr" rid="pcbi.1005507.ref113">113</xref>]. A fortiori the same applies to mesoscopic data such as local field potentials (LFP) or voltage-sensitive dye (VSD), in which finite-size fluctuation are expected to be large. Our theory paves the way for relating macroscale fluctuations to the underlying networks of spiking neurons and their activity, and so to the neuronal circuits that underlie the computations of the brain.</p>
<p>Another interesting application of our population model is to predict the activity of neural networks grown in cultures. This model system is much more accessible and controllable (e.g., by optogenetic stimulations) than cortical networks in-vivo but may still provide valuable insights into the complex network activity of excitatory and inhibitory neurons as proposed in a recent study [<xref ref-type="bibr" rid="pcbi.1005507.ref114">114</xref>]. In particular, in that study the authors propose a critical role for short-term plasticity [<xref ref-type="bibr" rid="pcbi.1005507.ref115">115</xref>]. Although we have here used static synapses, an extension of our mesoscopic mean-field theory to synaptic short-term plasticity is feasible. Furthermore, finite-size fluctuations appear to be particularly important in cell cultures as suggested by a previous theoretical study [<xref ref-type="bibr" rid="pcbi.1005507.ref062">62</xref>]. Our mesoscopic population theory thus represents a framework to predict spontaneous as well as evoked activity in neuronal cell cultures.</p>
</sec>
<sec id="sec016">
<title>Theoretical aspects</title>
<p>From a theoretical point of view, our study represents a generalization of <italic>deterministic</italic>, macroscopic population equations for an infinite number of spiking neurons with refractoriness [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref063">63</xref>] to <italic>stochastic</italic>, mesoscopic population equations for a finite number of neurons. The resulting dynamics can be directly used to generate single stochastic realizations of mesoscopic activities, in analogy to a Langevin dynamics. Our work is thus conceptually different from earlier studies of finite-size effects [<xref ref-type="bibr" rid="pcbi.1005507.ref066">66</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref068">68</xref>], who also considered finite networks of spiking neurons and refractoriness but derived deterministic evolution equations for moment and cross-correlation functions and hence characterized the ensemble dynamics. Furthermore, in contrast to these studies, our theory is not based on a perturbation expansion around the <italic>N</italic> → ∞ limit, and thus captures large and non-Gaussian fluctuations in strongly nonlinear population dynamics such as bistable networks.</p>
<p>Outside the low-rate Poisson firing regime, spiking neurons exhibit history dependencies in their spike trains, the most prominent of which is neuronal refractoriness, i.e. the strongly reduced firing probability depending on the time since the last spike. On the population level this means that a positive (negative) fluctuation of the population rate affects the underlying refractory state of the population because more (less) neurons than expected become refractory. This altered refractory state in turn tends to decrease (increase) the mean and variance of the population activity shortly after the fluctuation. More generally, fluctuations of the population activity influence the population density of state variables, which in turn influences fluctuations. In this study, we have worked out how to incorporate this interplay between fluctuations of the population activity and fluctuations of the refractory density into a mesoscopic population dynamics. The key insight to achieve this was (i) to exploit the normalization condition for the density of microscopic states (in our case, the density of last spike times) and (ii) to associate density fluctuations with a time-dependent but state-independent average rate that emphasizes the microscopic rates of those states that exhibit the largest finite-size fluctuations (in our case, the weighted average rate with respect to the variance <inline-formula id="pcbi.1005507.e209"><alternatives><graphic id="pcbi.1005507.e209g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e209" xlink:type="simple"/><mml:math display="inline" id="M209"><mml:mrow><mml:mi>v</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>).</p>
<p>Our work is thus in marked contrast to previous stochastic rate models for finite-size systems in the form of stochastic Wilson-Cowan equations [<xref ref-type="bibr" rid="pcbi.1005507.ref062">62</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref104">104</xref>], or stochastic neural field equations [<xref ref-type="bibr" rid="pcbi.1005507.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref116">116</xref>]. In these models, finite-size fluctuations of the rate may feed back through the recurrent connections but the strong negative self-feedback due to refractoriness is neglected. This is the case even if the stationary or dynamic transfer function employed in the rate dynamics corresponds to a spiking neuron model [<xref ref-type="bibr" rid="pcbi.1005507.ref062">62</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref072">72</xref>]. Furthermore, fluctuations of the population rate have often been implemented <italic>ad hoc</italic> by a phenomenological white-noise source, which was added to the macroscopic (i.e. deterministic) rate dynamics [<xref ref-type="bibr" rid="pcbi.1005507.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref102">102</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref112">112</xref>]. The intensity of the noise is a free parameter in these cases. Our mesoscopic equations are also driven by a noise source, but two differences to these studies are noteworthy: First, it is derived from a microscopic model and does not contain any free parameter; and second, the noise is white <italic>given</italic> the predicted mean activity but since the activity predicted in one time step depends on fluctuations in all earlier time steps, the effective noise leads to a colored noise spectrum—even if coupling is removed (see <xref ref-type="fig" rid="pcbi.1005507.g003">Fig 3</xref>). This observation is consistent with previous studies [<xref ref-type="bibr" rid="pcbi.1005507.ref055">55</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref058">58</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref060">60</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref069">69</xref>], in which the power spectrum of the fluctuations about a steady-state has been calculated analytically.</p>
<p>On the population level, refractoriness can be taken into account by population density equations such as the Fokker-Planck equation for the membrane potential density (see e.g. [<xref ref-type="bibr" rid="pcbi.1005507.ref036">36</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref058">58</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref059">59</xref>], or [<xref ref-type="bibr" rid="pcbi.1005507.ref107">107</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref117">117</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref118">118</xref>] for related master equations), or the population integral equation for the refractory density [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref088">88</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref089">89</xref>]. These studies were mainly concerned with macroscopic populations, which formally correspond to the limit <italic>N</italic> → ∞. For the refractory density formalism, we have shown here how to extend the population integral equation to the case of finite population size. To this end, we corrected for the missing normalization of the mesoscopic density (e.g. <inline-formula id="pcbi.1005507.e210"><alternatives><graphic id="pcbi.1005507.e210g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e210" xlink:type="simple"/><mml:math display="inline" id="M210"><mml:mrow><mml:mi>Q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1005507.e153">Eq (13)</xref> or <inline-formula id="pcbi.1005507.e211"><alternatives><graphic id="pcbi.1005507.e211g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e211" xlink:type="simple"/><mml:math display="inline" id="M211"><mml:mrow><mml:mi>q</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1005507.e472">Eq (80)</xref>), and thereby accounted for the interplay between fluctuations and refractoriness. Finite-size fluctuations of the population rate have also been used in the Fokker-Planck formalism [<xref ref-type="bibr" rid="pcbi.1005507.ref058">58</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref060">60</xref>] but the immediate effect of these fluctuations on the membrane potential density at threshold, and hence the refractoriness, has been neglected: in fact, a positive (negative) fluctuation of the population rate increases (decreases) the number of neurons at the reset potential while the number of neurons close to the threshold has to decrease (increase) such that the microscopic density remains normalized. The finite-<italic>N</italic> membrane potential density used by Mattia and Del Giudice [<xref ref-type="bibr" rid="pcbi.1005507.ref060">60</xref>] does not account for this normalization effect. Whereas the numerical integration of their equation may still give a satisfying solution in the low-rate, Poissonian-firing regime, where refractory effects can be neglected, it becomes unstable at higher rates unless the density is renormalized manually at every time step [<xref ref-type="bibr" rid="pcbi.1005507.ref119">119</xref>]. How to correct for the missing normalization in the Fokker-Planck approach is still an unsolved theoretical question. In this respect, using analogies to and insights from our approach might be promising.</p>
<p>The quasi-renewal approximation [<xref ref-type="bibr" rid="pcbi.1005507.ref055">55</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref063">63</xref>] allowed us to develop a finite-size theory for an effectively one-dimensional population density equation even in the presence of adaptation. Here, the only microscopic state variable is the last spike time <inline-formula id="pcbi.1005507.e212"><alternatives><graphic id="pcbi.1005507.e212g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e212" xlink:type="simple"/><mml:math display="inline" id="M212"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, or equivalently the age of the neuron <inline-formula id="pcbi.1005507.e213"><alternatives><graphic id="pcbi.1005507.e213g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e213" xlink:type="simple"/><mml:math display="inline" id="M213"><mml:mrow><mml:mi>τ</mml:mi> <mml:mo>=</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>. Longer lasting spike history effects such as adaptation are captured by the dependence of the conditional intensity on the population activity <italic>A</italic><sub><italic>N</italic></sub>, which as a mesoscopic mean-field variable does not need to be treated as a state variable. Furthermore, Chizhov and Graham have shown that the one-dimensional population density method in terms of the age <italic>τ</italic> can also capture multiple gating variables in conductance-based neuron models with adaptation [<xref ref-type="bibr" rid="pcbi.1005507.ref088">88</xref>]. Such one-dimensional descriptions have great advantages compared to population density equations that include adaptation by additional state variables and which thus require a multi-dimensional state-space [<xref ref-type="bibr" rid="pcbi.1005507.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref120">120</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref122">122</xref>]: Firstly, the numerical solution of the density equations grows exponentially with the number of dimensions and becomes quickly infeasible if multiple adaptation variables are needed as e.g. in the case of multi-timescale adaptation [<xref ref-type="bibr" rid="pcbi.1005507.ref028">28</xref>] or if an adiabatic approximation of slow variables [<xref ref-type="bibr" rid="pcbi.1005507.ref064">64</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref120">120</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref123">123</xref>] is not possible. Secondly, it is unclear how to treat finite-size fluctuations in the multi-dimensional case.</p>
<p>Our theory is based on an effective fully-connected network, in which neurons are coupled by the actual realization of the stochastic population activity (the “mean field”), both in the microscopic and mesoscopic model. Thus, in the limit of a fully-connected network, the problem of self-consistently matching the input and output statistics, which arises in mean-field theories, is automatically satisfied to any order by our finite-size theory. This is in marked contrast to the opposite limit of a sparsely-connected network [<xref ref-type="bibr" rid="pcbi.1005507.ref059">59</xref>]. In that case, the mean-field variables correspond to the <italic>statistics</italic> of the spike trains (e.g. rate and auto-correlation function) rather than to the actual realization of the population activity. These statistics must be matched self-consistently for input and output, which is a hard theoretical problem [<xref ref-type="bibr" rid="pcbi.1005507.ref056">56</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref057">57</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref124">124</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref125">125</xref>]. Between these two limit cases, where the network is randomly connected with some finite connection probability 0 &lt; <italic>p</italic> &lt; 1, our examples (Figs <xref ref-type="fig" rid="pcbi.1005507.g005">5</xref>, <xref ref-type="fig" rid="pcbi.1005507.g008">8</xref> and <xref ref-type="fig" rid="pcbi.1005507.g009">9</xref>) indicate that the approximation by an effective fully-connected network can still yield reasonable results even for relatively sparse networks with <italic>p</italic> = 5%. We emphasize that in our microscopic network model we used a fixed in-degree in order to avoid additional variability due to the quenched randomness in the number of synapses. This allowed us to focus on dynamic finite-size noise in homogeneous populations and its interactions with refractoriness. In contrast, the heterogeneity caused by the quenched randomness is a further finite-size effect [<xref ref-type="bibr" rid="pcbi.1005507.ref058">58</xref>] that needs to be examined in a future study.</p>
<p>As an integral equation, the mesoscopic population model is formally infinitely dimensional and represents a non-Markovian dynamics for the population activity <italic>A</italic><sub><italic>N</italic></sub>. Such complexity is expected given that the derived population equations are general and not limited to a specific dynamical regime. Loosely speaking, the equations must be rich enough, and hence sufficiently complex, in order to reproduce the rich repertoire of dynamical regimes that fully connected networks of spiking neurons are able to exhibit (e.g. limit cycles, multi-stability, cluster states [<xref ref-type="bibr" rid="pcbi.1005507.ref023">23</xref>]). For a mathematical analysis, however, it is often desirable to have a low-dimensional representation of the population dynamics in terms of a few differential equations, at least for a certain parameter range. Apart from the dynamics in the neighborhood of an equilibrium point (see e.g. [<xref ref-type="bibr" rid="pcbi.1005507.ref126">126</xref>]) or in the limit of slow synapses [<xref ref-type="bibr" rid="pcbi.1005507.ref127">127</xref>], such “firing rate models” are difficult to link to the microscopic model already in the deterministic (macroscopic) case (for notable exceptions see [<xref ref-type="bibr" rid="pcbi.1005507.ref128">128</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref129">129</xref>]), let alone the stochastic, finite-size case. Here, our mesoscopic population rate equations can serve as a suitable starting point for deriving low-dimensional dynamics that links microscopic models to mesoscopic rate equations with realistic finite-size noise.</p>
</sec>
<sec id="sec017">
<title>Extensions of the model</title>
<p>There are several ways to extend our mesoscopic population model towards more biological realism. We already mentioned the possibility to include short-term synaptic plasticity in our mean-field framework. Furthermore, the hazard function could be generalized to capture Gaussian current noise as arising from background spiking activity [<xref ref-type="bibr" rid="pcbi.1005507.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref057">57</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref060">60</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref098">98</xref>]. Approximate mappings of white and colored current noise to an effective hazard function in the escape noise formalism are available [<xref ref-type="bibr" rid="pcbi.1005507.ref088">88</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref089">89</xref>] and might be combined with our mesoscopic population model. Yet another extension concerns the synaptic input model. Here we only looked at current input but, as shown by Chizhov and Graham [<xref ref-type="bibr" rid="pcbi.1005507.ref088">88</xref>], it is straightforward to extend population theories of the renewal type to the case of conductance inputs. In the simplest case, the synaptic current of neuron <italic>i</italic> embedded in population <italic>α</italic> and driven by populations <italic>β</italic> can be modelled by a linear voltage-dependence:
<disp-formula id="pcbi.1005507.e214"><alternatives><graphic id="pcbi.1005507.e214g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e214" xlink:type="simple"/><mml:math display="block" id="M214"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi> <mml:mrow><mml:mtext>syn</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>β</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mi>E</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup></mml:mfenced> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mo>Γ</mml:mo> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mi>β</mml:mi></mml:msubsup></mml:mrow></mml:munder> <mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mi>g</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mo>*</mml:mo> <mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>j</mml:mi></mml:mrow> <mml:mi>β</mml:mi></mml:msubsup></mml:mfenced> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
(cf. corresponding expression <xref ref-type="disp-formula" rid="pcbi.1005507.e226">Eq (22)</xref> in <xref ref-type="sec" rid="sec018">M<sc>ethods</sc></xref> for current-based synapses). Here, <italic>E</italic><sup><italic>αβ</italic></sup> is the reversal potential of a synapse from population <italic>β</italic>, and <italic>g</italic><sup><italic>αβ</italic></sup>(<italic>t</italic>) is the conductance response (in nS) elicited by a spike of a presynaptic neuron in population <italic>β</italic>. The same mean-field arguments as for the current-based model carry over to the case of conductance-based synapses. For example, the membrane potential <inline-formula id="pcbi.1005507.e215"><alternatives><graphic id="pcbi.1005507.e215g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e215" xlink:type="simple"/><mml:math display="inline" id="M215"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> of a current-based leaky integrate-and-fire neuron with a last spike time at time <inline-formula id="pcbi.1005507.e216"><alternatives><graphic id="pcbi.1005507.e216g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e216" xlink:type="simple"/><mml:math display="inline" id="M216"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> follows the equation
<disp-formula id="pcbi.1005507.e217"><alternatives><graphic id="pcbi.1005507.e217g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e217" xlink:type="simple"/><mml:math display="block" id="M217"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>μ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>β</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:msup><mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msup> <mml:msup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mo>*</mml:mo> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula>
where at <inline-formula id="pcbi.1005507.e218"><alternatives><graphic id="pcbi.1005507.e218g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e218" xlink:type="simple"/><mml:math display="inline" id="M218"><mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> and during an absolute refractory period <inline-formula id="pcbi.1005507.e219"><alternatives><graphic id="pcbi.1005507.e219g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e219" xlink:type="simple"/><mml:math display="inline" id="M219"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>r</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is at the reset potential (see <xref ref-type="sec" rid="sec018">M<sc>ethods</sc></xref>, <xref ref-type="disp-formula" rid="pcbi.1005507.e292">Eq (30)</xref> for details). In the case of conductance-based input, <xref ref-type="disp-formula" rid="pcbi.1005507.e214">Eq (18)</xref>, we only need to replace <xref ref-type="disp-formula" rid="pcbi.1005507.e217">Eq (19)</xref> by
<disp-formula id="pcbi.1005507.e220"><alternatives><graphic id="pcbi.1005507.e220g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e220" xlink:type="simple"/><mml:math display="block" id="M220"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>μ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>β</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:msup><mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msup><mml:mi>E</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup></mml:mfenced> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>g</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mo>*</mml:mo> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula>
where <italic>R</italic><sup><italic>α</italic></sup> is the membrane resistance. How to model nonlinear voltage-dependence of synaptic currents such as N-methyl-D-aspartate (NMDA) currents within a mean-field approximation is less obvious but approximations also exist for this case [<xref ref-type="bibr" rid="pcbi.1005507.ref020">20</xref>]. It will be an interesting question for the future how well these approaches work with the finite-N theory developed in the present study. Alternatively, effective current models [<xref ref-type="bibr" rid="pcbi.1005507.ref130">130</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref131">131</xref>] with activity-dependent, effective time constant <italic>τ</italic><sub>m</sub>(<italic>t</italic>) and effective resting potential <italic>u</italic><sub>rest</sub>(<italic>t</italic>) could be another solution to treat conductance inputs.</p>
<p>Here, we have used a discrete set of populations. In large-scale models of the brain, one often regards the spatial continuum limit, resulting in so-called stochastic neural field equations [<xref ref-type="bibr" rid="pcbi.1005507.ref116">116</xref>]. These equations represent a compact description of neural activity and do not depend on a specific discretization of space. Just as discrete firing rate models, these field equations must be considered phenomenological because the link to neuronal parameters is not clear (note however that such equations have been derived from non-spiking, two-state neuron models for <italic>N</italic> &lt; ∞ [<xref ref-type="bibr" rid="pcbi.1005507.ref039">39</xref>], and from spiking models for <italic>N</italic> → ∞ [<xref ref-type="bibr" rid="pcbi.1005507.ref132">132</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref133">133</xref>]). By taking the spatial continuum limit, our mesoscopic population equations can be formulated as a stochastic neural field equation that is directly derived from a finite-size, spiking neural network. It would be interesting to employ this continuous extension of our mesoscopic equations to study the effect of spike-history effects on the stochastic behavior of bumps and waves in neural fields.</p>
<p>A first simple comparison of the computational performance in R<sc>esults</sc>, “M<sc>esoscopic dynamics of cortical microcolumn</sc>”, demonstrated already that the mesoscopic population dynamics outperformed the microscopic simulation by a speed-up factor of around 120. In this example, the numerical integration of the population dynamics has not been particularly optimized with respect to time step Δ<italic>t</italic> and history length <italic>T</italic>. A systematic comparison under the condition of some given accuracy, has the potential for an even larger speed-up because the population equations can be integrated with a larger time step than the spiking neural network. In addition to that, we have also compared the mesoscopic model to the full microscopic simulation of the refractory density (cf. R<sc>esults</sc>, “F<sc>inite-size mean-field theory</sc>”) and found a moderate enhancement in performance for sufficiently large networks (<inline-formula id="pcbi.1005507.e221"><alternatives><graphic id="pcbi.1005507.e221g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e221" xlink:type="simple"/><mml:math display="inline" id="M221"><mml:mrow><mml:mi>N</mml:mi> <mml:mtext> </mml:mtext><mml:mo>≳</mml:mo><mml:mtext> </mml:mtext> <mml:mn>100</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>). These computational aspects will be investigated in a separate study.</p>
</sec>
</sec>
<sec id="sec018" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec019">
<title>Model</title>
<sec id="sec020">
<title>Network setup</title>
<p>We consider a network of <italic>M</italic> populations each consisting of <italic>N</italic><sup><italic>α</italic></sup> interconnected neurons of the same type (the superscript <italic>α</italic> = 1, …, <italic>M</italic> labels the populations). Neuron <italic>i</italic> in population <italic>α</italic> receives <italic>p</italic><sup><italic>αβ</italic></sup><italic>N</italic><sup><italic>β</italic></sup> connections (synapses) from a random subset <inline-formula id="pcbi.1005507.e222"><alternatives><graphic id="pcbi.1005507.e222g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e222" xlink:type="simple"/><mml:math display="inline" id="M222"><mml:msubsup><mml:mo>Γ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>β</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> of presynaptic neurons in population <italic>β</italic>. Here, <italic>p</italic><sup><italic>αβ</italic></sup> denotes the probability for a connection from a neuron in population <italic>β</italic> to a neuron in population <italic>α</italic>. That is, the connections between any two populations are random with fixed in-degree.</p>
<p>Let the spike train of neuron <italic>i</italic> in population <italic>α</italic> be denoted by
<disp-formula id="pcbi.1005507.e223"><alternatives><graphic id="pcbi.1005507.e223g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e223" xlink:type="simple"/><mml:math display="block" id="M223"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:munder> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula>
where <inline-formula id="pcbi.1005507.e224"><alternatives><graphic id="pcbi.1005507.e224g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e224" xlink:type="simple"/><mml:math display="inline" id="M224"><mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is its <italic>k</italic>-th spike time and <italic>δ</italic> denotes the Dirac <italic>δ</italic>-function. The neuron receives spike train input from its presynaptic partners in population <italic>β</italic> with a transmission delay Δ<sup><italic>αβ</italic></sup> and synaptic weight <italic>w</italic><sup><italic>αβ</italic></sup>. More precisely, the synaptic input current <inline-formula id="pcbi.1005507.e225"><alternatives><graphic id="pcbi.1005507.e225g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e225" xlink:type="simple"/><mml:math display="inline" id="M225"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi> <mml:mrow><mml:mtext>syn</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is modeled as a sum of post-synaptic currents caused by each spike of presynaptic neurons:
<disp-formula id="pcbi.1005507.e226"><alternatives><graphic id="pcbi.1005507.e226g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e226" xlink:type="simple"/><mml:math display="block" id="M226"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>R</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:msubsup><mml:mi>I</mml:mi> <mml:mrow><mml:mtext>syn</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mrow><mml:mtext>m</mml:mtext></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>β</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mo>Γ</mml:mo> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mi>β</mml:mi></mml:msubsup></mml:mrow></mml:munder> <mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mo>*</mml:mo> <mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>j</mml:mi></mml:mrow> <mml:mi>β</mml:mi></mml:msubsup></mml:mfenced> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
where <italic>R</italic><sup><italic>α</italic></sup> and <inline-formula id="pcbi.1005507.e227"><alternatives><graphic id="pcbi.1005507.e227g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e227" xlink:type="simple"/><mml:math display="inline" id="M227"><mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> are the membrane resistance and membrane time constant of a neuron in population <italic>α</italic>, respectively, and <italic>w</italic><sup><italic>αβ</italic></sup> sets the synaptic weights in units of mV. The synaptic kernel <italic>ϵ</italic><sup><italic>αβ</italic></sup>(<italic>t</italic>) is defined as the postsynaptic current (PSC) normalized by its charge that is induced by one input spike from a neuron of population <italic>β</italic>. More precisely, <italic>ϵ</italic><sup><italic>αβ</italic></sup> is the PSC divided by its integral, and therefore it has units of 1/sec. In <xref ref-type="disp-formula" rid="pcbi.1005507.e226">Eq (22)</xref>, the first sum runs over all populations <italic>β</italic>, whereas the second sum runs over the set <inline-formula id="pcbi.1005507.e228"><alternatives><graphic id="pcbi.1005507.e228g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e228" xlink:type="simple"/><mml:math display="inline" id="M228"><mml:msubsup><mml:mo>Γ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>β</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> of all neurons in population <italic>β</italic> that project onto neuron <italic>i</italic> in population <italic>α</italic>.</p>
<p>In general, the filtered total synaptic input from population <italic>β</italic>, <inline-formula id="pcbi.1005507.e229"><alternatives><graphic id="pcbi.1005507.e229g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e229" xlink:type="simple"/><mml:math display="inline" id="M229"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mo>Γ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>β</mml:mi></mml:msubsup></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mo>*</mml:mo> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>j</mml:mi> <mml:mi>β</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, may be modeled by a set of differential equations for a finite number of synaptic variables <inline-formula id="pcbi.1005507.e230"><alternatives><graphic id="pcbi.1005507.e230g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e230" xlink:type="simple"/><mml:math display="inline" id="M230"><mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ℓ</mml:mi></mml:mrow> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, <italic>ℓ</italic> = 1, …, <italic>L</italic>. In simulations, we model the synaptic kernel by a single exponential with constant delay Δ<sup><italic>αβ</italic></sup> = Δ, <inline-formula id="pcbi.1005507.e231"><alternatives><graphic id="pcbi.1005507.e231g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e231" xlink:type="simple"/><mml:math display="inline" id="M231"><mml:mrow><mml:msup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>Θ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>s</mml:mtext> <mml:mi>β</mml:mi></mml:msubsup></mml:mrow></mml:msup> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>s</mml:mtext> <mml:mi>β</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, where Θ(<italic>t</italic>) denotes the Heaviside step function. The synaptic time constants are <inline-formula id="pcbi.1005507.e232"><alternatives><graphic id="pcbi.1005507.e232g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e232" xlink:type="simple"/><mml:math display="inline" id="M232"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>s</mml:mtext> <mml:mi>E</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>3</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> ms and <inline-formula id="pcbi.1005507.e233"><alternatives><graphic id="pcbi.1005507.e233g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e233" xlink:type="simple"/><mml:math display="inline" id="M233"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>s</mml:mtext> <mml:mi>I</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>6</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> ms for excitatory and inhibitory synapses, respectively. This kernel can be realized by a single synaptic variable <inline-formula id="pcbi.1005507.e234"><alternatives><graphic id="pcbi.1005507.e234g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e234" xlink:type="simple"/><mml:math display="inline" id="M234"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, which obeys the first-order kinetics <inline-formula id="pcbi.1005507.e235"><alternatives><graphic id="pcbi.1005507.e235g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e235" xlink:type="simple"/><mml:math display="inline" id="M235"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>s</mml:mtext> <mml:mi>β</mml:mi></mml:msubsup> <mml:msubsup><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mo>Γ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>β</mml:mi></mml:msubsup></mml:mrow></mml:msub> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>j</mml:mi> <mml:mi>β</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> with <italic>β</italic> ∈ {<italic>E</italic>, <italic>I</italic>}.</p>
</sec>
<sec id="sec021">
<title>Generalized integrate-and-fire model</title>
<p>Neurons are modeled by a leaky integrate-and-fire model with a dynamic threshold [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref080">80</xref>] and an escape noise mechanism [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref026">26</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref028">28</xref>]. Following [<xref ref-type="bibr" rid="pcbi.1005507.ref027">27</xref>], we refer to this model as the generalized integrate-and-fire (GIF) model. The crucial variables of this model are the membrane potential <inline-formula id="pcbi.1005507.e236"><alternatives><graphic id="pcbi.1005507.e236g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e236" xlink:type="simple"/><mml:math display="inline" id="M236"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and the dynamic threshold <inline-formula id="pcbi.1005507.e237"><alternatives><graphic id="pcbi.1005507.e237g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e237" xlink:type="simple"/><mml:math display="inline" id="M237"><mml:mrow><mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The membrane potential obeys the subthreshold dynamics
<disp-formula id="pcbi.1005507.e238"><alternatives><graphic id="pcbi.1005507.e238g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e238" xlink:type="simple"/><mml:math display="block" id="M238"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup> <mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:mrow> <mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>μ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:msubsup><mml:mi>I</mml:mi> <mml:mrow><mml:mtext>syn</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
where <inline-formula id="pcbi.1005507.e239"><alternatives><graphic id="pcbi.1005507.e239g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e239" xlink:type="simple"/><mml:math display="inline" id="M239"><mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the membrane time constant and <inline-formula id="pcbi.1005507.e240"><alternatives><graphic id="pcbi.1005507.e240g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e240" xlink:type="simple"/><mml:math display="inline" id="M240"><mml:mrow><mml:msup><mml:mi>μ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>rest</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:msubsup><mml:mi>I</mml:mi> <mml:mrow><mml:mtext>ext</mml:mtext></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the drive in the absence of synaptic input consisting of a constant resting potential <italic>u</italic><sub>rest</sub> and an external stimulus <inline-formula id="pcbi.1005507.e241"><alternatives><graphic id="pcbi.1005507.e241g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e241" xlink:type="simple"/><mml:math display="inline" id="M241"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi> <mml:mrow><mml:mtext>ext</mml:mtext></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The synaptic current <inline-formula id="pcbi.1005507.e242"><alternatives><graphic id="pcbi.1005507.e242g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e242" xlink:type="simple"/><mml:math display="inline" id="M242"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi> <mml:mrow><mml:mtext>syn</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> has been defined in <xref ref-type="disp-formula" rid="pcbi.1005507.e226">Eq (22)</xref>.</p>
<p>After each spike the voltage is reset to the potential <italic>u</italic><sub>r</sub>, where it is clamped for an absolute refractory period <italic>t</italic><sub>ref</sub> = 4 ms. Furthermore, each spike <inline-formula id="pcbi.1005507.e243"><alternatives><graphic id="pcbi.1005507.e243g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e243" xlink:type="simple"/><mml:math display="inline" id="M243"><mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> adds a contribution <inline-formula id="pcbi.1005507.e244"><alternatives><graphic id="pcbi.1005507.e244g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e244" xlink:type="simple"/><mml:math display="inline" id="M244"><mml:mrow><mml:msup><mml:mi>θ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> to the dynamic threshold:
<disp-formula id="pcbi.1005507.e245"><alternatives><graphic id="pcbi.1005507.e245g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e245" xlink:type="simple"/><mml:math display="block" id="M245"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mtext>th</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:munder> <mml:msup><mml:mi>θ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mtext>th</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msup><mml:mi>θ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula>
where <inline-formula id="pcbi.1005507.e246"><alternatives><graphic id="pcbi.1005507.e246g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e246" xlink:type="simple"/><mml:math display="inline" id="M246"><mml:msubsup><mml:mi>u</mml:mi> <mml:mtext>th</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is a baseline threshold and <italic>θ</italic><sup><italic>α</italic></sup>(<italic>t</italic>) is called the spike-triggered kernel [<xref ref-type="bibr" rid="pcbi.1005507.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref027">27</xref>]. Since the increases in spike threshold accumulate over several spikes, the spike-triggered kernel causes spike-frequency adaptation. We set <italic>θ</italic><sup><italic>α</italic></sup>(<italic>t</italic>) = ∞ for <italic>t</italic> ∈ (0, <italic>t</italic><sub>ref</sub>) so as to ensure absolute refractoriness. For the sake of simplicity, we assumed here that all spike-triggered accumulation effects can be lumped into the threshold variable (cf. Sec. “Mapping onto a generalized linear model” below). However, if realistic membrane potentials are needed (e.g., for fitting membrane potential data [<xref ref-type="bibr" rid="pcbi.1005507.ref027">27</xref>] or in a conductance-based extension of the model (see <xref ref-type="sec" rid="sec014">D<sc>iscussion</sc></xref>) and [<xref ref-type="bibr" rid="pcbi.1005507.ref088">88</xref>]), adaptation mechanisms affecting the voltage should be kept in the voltage dynamics.</p>
<p>Spikes are elicited stochastically by a conditional intensity (also called hazard rate, escape rate or conditional rate)
<disp-formula id="pcbi.1005507.e247"><alternatives><graphic id="pcbi.1005507.e247g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e247" xlink:type="simple"/><mml:math display="block" id="M247"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>f</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula>
which depends on the momentary distance between the membrane potential and the threshold via the exponential link function <inline-formula id="pcbi.1005507.e248"><alternatives><graphic id="pcbi.1005507.e248g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e248" xlink:type="simple"/><mml:math display="inline" id="M248"><mml:mrow><mml:msup><mml:mi>f</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>c</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>/</mml:mo> <mml:msubsup><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The parameter <italic>c</italic><sup><italic>α</italic></sup> is the escape rate at threshold and the parameter <inline-formula id="pcbi.1005507.e249"><alternatives><graphic id="pcbi.1005507.e249g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e249" xlink:type="simple"/><mml:math display="inline" id="M249"><mml:mrow><mml:msubsup><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> characterizes the softness of the threshold (<xref ref-type="fig" rid="pcbi.1005507.g001">Fig 1A</xref>, inset). Intuitively, a neuron fires immediately if its membrane potential is <inline-formula id="pcbi.1005507.e250"><alternatives><graphic id="pcbi.1005507.e250g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e250" xlink:type="simple"/><mml:math display="inline" id="M250"><mml:mrow><mml:mn>2</mml:mn> <mml:mo>·</mml:mo> <mml:msubsup><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> millivolts above the threshold and is unlikely to fire if its membrane potential is <inline-formula id="pcbi.1005507.e251"><alternatives><graphic id="pcbi.1005507.e251g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e251" xlink:type="simple"/><mml:math display="inline" id="M251"><mml:mrow><mml:mn>2</mml:mn> <mml:mo>·</mml:mo> <mml:msubsup><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> millivolts below the threshold [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>]. In the limit <inline-formula id="pcbi.1005507.e252"><alternatives><graphic id="pcbi.1005507.e252g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e252" xlink:type="simple"/><mml:math display="inline" id="M252"><mml:mrow><mml:msubsup><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>→</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, the model turns into a deterministic (but adaptive) leaky integrate-and-fire model with a hard threshold. We emphasize that our standard choice of <inline-formula id="pcbi.1005507.e253"><alternatives><graphic id="pcbi.1005507.e253g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e253" xlink:type="simple"/><mml:math display="inline" id="M253"><mml:mrow><mml:msubsup><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>∼</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> mV is consistent with the intrinsic stochasticity of neurons in cortical slices [<xref ref-type="bibr" rid="pcbi.1005507.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref085">85</xref>]. Alternatively, the softness of the threshold <inline-formula id="pcbi.1005507.e254"><alternatives><graphic id="pcbi.1005507.e254g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e254" xlink:type="simple"/><mml:math display="inline" id="M254"><mml:msubsup><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> may also be regarded as a phenomenological parameter that accounts for all incoherent noise sources that are individual to each neuron. This includes, e.g., any intrinsic noise but also fluctuations of external background input from other neural populations that are not modeled explicitly. For instance, to account for the external Poisson input used in the original cortical column model by Potjans an Diesmann [<xref ref-type="bibr" rid="pcbi.1005507.ref005">5</xref>], we increase in Figs <xref ref-type="fig" rid="pcbi.1005507.g001">1</xref>, <xref ref-type="fig" rid="pcbi.1005507.g008">8</xref> and <xref ref-type="fig" rid="pcbi.1005507.g009">9</xref> the softness to <inline-formula id="pcbi.1005507.e255"><alternatives><graphic id="pcbi.1005507.e255g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e255" xlink:type="simple"/><mml:math display="inline" id="M255"><mml:mrow><mml:msubsup><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> mV. We note that for more detailed comparisons with the original model, more elaborate approximations of the escape rate for the case of colored noise exist [<xref ref-type="bibr" rid="pcbi.1005507.ref089">89</xref>], which in principle could be used to approximate external Poisson noise without a free parameter. However, because such a mapping is not the focus of the current study, we stick here for the sake of simplicity to the phenomenological escape rate, <xref ref-type="disp-formula" rid="pcbi.1005507.e247">Eq (25)</xref>, of the exponential form.</p>
<p>The parameters of the model used in simulations (unless specified differently) are summarized in <xref ref-type="table" rid="pcbi.1005507.t001">Table 1</xref>.</p>
<table-wrap id="pcbi.1005507.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005507.t001</object-id>
<label>Table 1</label>
<caption>
<title>Default values of parameters used in simulations unless stated otherwise.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005507.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005507.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<tbody>
<tr>
<td align="left"><italic>τ</italic><sub>m</sub></td>
<td align="left">20 ms</td>
<td align="left">membrane time constant</td>
</tr>
<tr>
<td align="left"><italic>t</italic><sub>ref</sub></td>
<td align="left">4 ms</td>
<td align="left">absolute refractory period</td>
</tr>
<tr>
<td align="left"><italic>u</italic><sub>th</sub></td>
<td align="left">15 mV</td>
<td align="left">threshold (non-adapting part)</td>
</tr>
<tr>
<td align="left"><italic>u</italic><sub>r</sub></td>
<td align="left">0 mV</td>
<td align="left">reset potential</td>
</tr>
<tr>
<td align="left"><italic>c</italic></td>
<td align="left">10 Hz</td>
<td align="left">escape rate at threshold</td>
</tr>
<tr>
<td align="left">Δ<sub><italic>u</italic></sub></td>
<td align="left">2 mV</td>
<td align="left">noise level</td>
</tr>
<tr>
<td align="left">Δ</td>
<td align="left">1 ms</td>
<td align="left">transmission delay</td>
</tr>
<tr>
<td align="left">
<inline-formula id="pcbi.1005507.e256">
<alternatives>
<graphic id="pcbi.1005507.e256g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e256" xlink:type="simple"/>
<mml:math display="inline" id="M256">
<mml:msubsup>
<mml:mi>τ</mml:mi>
<mml:mtext>s</mml:mtext>
<mml:mi>E</mml:mi>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left">3 ms</td>
<td align="left">decay time constant of excitatory synapses</td>
</tr>
<tr>
<td align="left">
<inline-formula id="pcbi.1005507.e257">
<alternatives>
<graphic id="pcbi.1005507.e257g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e257" xlink:type="simple"/>
<mml:math display="inline" id="M257">
<mml:msubsup>
<mml:mi>τ</mml:mi>
<mml:mtext>s</mml:mtext>
<mml:mi>I</mml:mi>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</td>
<td align="left">6 ms</td>
<td align="left">decay time constant of inhibitory synapses</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec022">
<title>Mapping onto a generalized linear model</title>
<p>We also considered a slightly different variant of the model, called <italic>spike-response model</italic> [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>] or <italic>generalized linear model (GLM)</italic> [<xref ref-type="bibr" rid="pcbi.1005507.ref055">55</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref066">66</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref084">84</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref108">108</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref109">109</xref>]. This model does not reqire the reset rule of the integrate-and-fire model but instead relies on spike-triggered kernels to implement refractoriness and other spike-history effects. Specifically, the membrane potential is given by
<disp-formula id="pcbi.1005507.e258"><alternatives><graphic id="pcbi.1005507.e258g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e258" xlink:type="simple"/><mml:math display="block" id="M258"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>h</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:munder> <mml:msup><mml:mi>η</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula>
where <inline-formula id="pcbi.1005507.e259"><alternatives><graphic id="pcbi.1005507.e259g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e259" xlink:type="simple"/><mml:math display="inline" id="M259"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the free membrane potential given by
<disp-formula id="pcbi.1005507.e260"><alternatives><graphic id="pcbi.1005507.e260g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e260" xlink:type="simple"/><mml:math display="block" id="M260"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:msup><mml:mi>κ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mo>*</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mi>μ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:msubsup><mml:mi>I</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>y</mml:mi> <mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup></mml:mfenced> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(27)</label></disp-formula>
For a membrane filter kernel <inline-formula id="pcbi.1005507.e261"><alternatives><graphic id="pcbi.1005507.e261g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e261" xlink:type="simple"/><mml:math display="inline" id="M261"><mml:mrow><mml:msup><mml:mi>κ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>Θ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup></mml:mrow></mml:msup> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, where Θ(<italic>t</italic>) denotes the Heaviside step function, the dynamics of <inline-formula id="pcbi.1005507.e262"><alternatives><graphic id="pcbi.1005507.e262g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e262" xlink:type="simple"/><mml:math display="inline" id="M262"><mml:msubsup><mml:mi>h</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is equivalent to the dynamics of <inline-formula id="pcbi.1005507.e263"><alternatives><graphic id="pcbi.1005507.e263g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e263" xlink:type="simple"/><mml:math display="inline" id="M263"><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1005507.e238">Eq (23)</xref>), except that <inline-formula id="pcbi.1005507.e264"><alternatives><graphic id="pcbi.1005507.e264g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e264" xlink:type="simple"/><mml:math display="inline" id="M264"><mml:msubsup><mml:mi>h</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is not reset upon spiking. Spike-history effects on the level of the membrane potential are captured by the second term in <xref ref-type="disp-formula" rid="pcbi.1005507.e258">Eq (26)</xref>. This term represents the convolution <inline-formula id="pcbi.1005507.e265"><alternatives><graphic id="pcbi.1005507.e265g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e265" xlink:type="simple"/><mml:math display="inline" id="M265"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>η</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mo>*</mml:mo> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> of the output spike train with a spike-triggered kernel <italic>η</italic>(<italic>t</italic>) and generates a spike-after-potential that accumulates over spikes. As before, the threshold <inline-formula id="pcbi.1005507.e266"><alternatives><graphic id="pcbi.1005507.e266g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e266" xlink:type="simple"/><mml:math display="inline" id="M266"><mml:mrow><mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> obeys <xref ref-type="disp-formula" rid="pcbi.1005507.e245">Eq (24)</xref>. Given the membrane potential <inline-formula id="pcbi.1005507.e267"><alternatives><graphic id="pcbi.1005507.e267g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e267" xlink:type="simple"/><mml:math display="inline" id="M267"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and the dynamic threshold <inline-formula id="pcbi.1005507.e268"><alternatives><graphic id="pcbi.1005507.e268g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e268" xlink:type="simple"/><mml:math display="inline" id="M268"><mml:mrow><mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, spikes are generated by the same hazard rate <inline-formula id="pcbi.1005507.e269"><alternatives><graphic id="pcbi.1005507.e269g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e269" xlink:type="simple"/><mml:math display="inline" id="M269"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> given by <xref ref-type="disp-formula" rid="pcbi.1005507.e247">Eq (25)</xref>.</p>
<p>At low firing rates, the spike-triggered kernel <italic>η</italic> can be used to approximate the integrate-and-fire dynamics by choosing <inline-formula id="pcbi.1005507.e270"><alternatives><graphic id="pcbi.1005507.e270g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e270" xlink:type="simple"/><mml:math display="inline" id="M270"><mml:mrow><mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>r</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>th</mml:mtext></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mtext>ref</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup></mml:mrow></mml:msup> <mml:mo>Θ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. However, this is not an exact mapping because the value of the membrane potential is not reset to a fixed value <italic>u</italic><sub>r</sub> after spiking, in contrast to the GIF model. This is due to the accumulation of the threshold and the variability in the voltage at the moment of firing.</p>
<p>We also mention that the kernel <italic>η</italic> can be transformed into the kernel <italic>θ</italic> of the threshold dynamics [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>]. This is possible because we are only interested in the spike emissions of the neurons and not the membrane potentials. In fact, the conditional firing rate, <xref ref-type="disp-formula" rid="pcbi.1005507.e247">Eq (25)</xref>, is invariant under the transformation <italic>θ</italic> → <italic>θ</italic> − <italic>η</italic>, <italic>η</italic> → 0.</p>
</sec>
</sec>
<sec id="sec023">
<title>Mean-field approximation</title>
<p>An important variable that characterizes the internal state of a neuron is the time of its last spike, or, equivalently, the time elapsed since the last spike (“age” of the neuron) [<xref ref-type="bibr" rid="pcbi.1005507.ref088">88</xref>]. The time since the last spike is a good predictor of the refractory state of a neuron at time <italic>t</italic>. Our approach is to use a population density description for this refractory state [<xref ref-type="bibr" rid="pcbi.1005507.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref068">68</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref088">88</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref089">89</xref>], in which the coupling of neurons as well as the adaptation of single neurons are mediated by the mesoscopic population activities <inline-formula id="pcbi.1005507.e271"><alternatives><graphic id="pcbi.1005507.e271g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e271" xlink:type="simple"/><mml:math display="inline" id="M271"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> defined by <xref ref-type="disp-formula" rid="pcbi.1005507.e013">Eq (1)</xref>. To this end, we replace the conditional firing rate <inline-formula id="pcbi.1005507.e272"><alternatives><graphic id="pcbi.1005507.e272g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e272" xlink:type="simple"/><mml:math display="inline" id="M272"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> of a neuron <italic>i</italic> in population <italic>α</italic> by an effective rate <inline-formula id="pcbi.1005507.e273"><alternatives><graphic id="pcbi.1005507.e273g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e273" xlink:type="simple"/><mml:math display="inline" id="M273"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> that only depends on its last spike time <inline-formula id="pcbi.1005507.e274"><alternatives><graphic id="pcbi.1005507.e274g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e274" xlink:type="simple"/><mml:math display="inline" id="M274"><mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and the history of the population activity <inline-formula id="pcbi.1005507.e275"><alternatives><graphic id="pcbi.1005507.e275g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e275" xlink:type="simple"/><mml:math display="inline" id="M275"><mml:msub><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1005507.ref063">63</xref>]. Here and in the following, the subscript <italic>A</italic> indicates the dependence on the history of <inline-formula id="pcbi.1005507.e276"><alternatives><graphic id="pcbi.1005507.e276g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e276" xlink:type="simple"/><mml:math display="inline" id="M276"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. We note that the expected total activity <inline-formula id="pcbi.1005507.e277"><alternatives><graphic id="pcbi.1005507.e277g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e277" xlink:type="simple"/><mml:math display="inline" id="M277"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> of population <italic>α</italic> at time <italic>t</italic> is the average of all the conditional firing rates summed over all neurons in this population: <inline-formula id="pcbi.1005507.e278"><alternatives><graphic id="pcbi.1005507.e278g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e278" xlink:type="simple"/><mml:math display="inline" id="M278"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The effective rate <inline-formula id="pcbi.1005507.e279"><alternatives><graphic id="pcbi.1005507.e279g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e279" xlink:type="simple"/><mml:math display="inline" id="M279"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is determined such that it approximates the conditional intensity on average:
<disp-formula id="pcbi.1005507.e280"><alternatives><graphic id="pcbi.1005507.e280g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e280" xlink:type="simple"/><mml:math display="block" id="M280"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:msup><mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msup></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msup><mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msup></mml:munderover> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msup><mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msup></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msup><mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msup></mml:munderover> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(28)</label></disp-formula>
To find such an approximation, we proceed in two steps [<xref ref-type="bibr" rid="pcbi.1005507.ref055">55</xref>]: first, the membrane potential <inline-formula id="pcbi.1005507.e281"><alternatives><graphic id="pcbi.1005507.e281g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e281" xlink:type="simple"/><mml:math display="inline" id="M281"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is approximated by a function <inline-formula id="pcbi.1005507.e282"><alternatives><graphic id="pcbi.1005507.e282g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e282" xlink:type="simple"/><mml:math display="inline" id="M282"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> using a mean-field approximation of the synaptic input. For fully connected populations, this first approximation turns into an exact statement. Second, the dynamic threshold <inline-formula id="pcbi.1005507.e283"><alternatives><graphic id="pcbi.1005507.e283g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e283" xlink:type="simple"/><mml:math display="inline" id="M283"><mml:mrow><mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is approximated by a function <inline-formula id="pcbi.1005507.e284"><alternatives><graphic id="pcbi.1005507.e284g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e284" xlink:type="simple"/><mml:math display="inline" id="M284"><mml:mrow><mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> using the quasi-renewal approximation [<xref ref-type="bibr" rid="pcbi.1005507.ref063">63</xref>]. For renewal neurons, the second approximation becomes exact. Once we have found an expression for the mean-field approximation <xref ref-type="disp-formula" rid="pcbi.1005507.e280">Eq (28)</xref>, we are in a position to use a population density description with respect to the last spike times <inline-formula id="pcbi.1005507.e285"><alternatives><graphic id="pcbi.1005507.e285g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e285" xlink:type="simple"/><mml:math display="inline" id="M285"><mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. In the following two paragraphs we explain the above two steps in detail.</p>
<sec id="sec024">
<title>Mean-field approximation of synaptic input</title>
<p>In the special case of a fully connected network (<italic>p</italic><sup><italic>αβ</italic></sup> = 1), the membrane potential can be completely inferred from the last spike time <inline-formula id="pcbi.1005507.e286"><alternatives><graphic id="pcbi.1005507.e286g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e286" xlink:type="simple"/><mml:math display="inline" id="M286"><mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and the mean field <inline-formula id="pcbi.1005507.e287"><alternatives><graphic id="pcbi.1005507.e287g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e287" xlink:type="simple"/><mml:math display="inline" id="M287"><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. In this case, the synaptic input <xref ref-type="disp-formula" rid="pcbi.1005507.e226">Eq (22)</xref> can be rewritten as
<disp-formula id="pcbi.1005507.e288"><alternatives><graphic id="pcbi.1005507.e288g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e288" xlink:type="simple"/><mml:math display="block" id="M288"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>R</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:msubsup><mml:mi>I</mml:mi> <mml:mrow><mml:mtext>syn</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mrow><mml:mtext>m</mml:mtext></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>β</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:msup><mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msup> <mml:msup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mo>*</mml:mo> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(29)</label></disp-formula>
Thus, in a fully connected network all neurons in population <italic>α</italic> “see” the same synaptic input <inline-formula id="pcbi.1005507.e289"><alternatives><graphic id="pcbi.1005507.e289g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e289" xlink:type="simple"/><mml:math display="inline" id="M289"><mml:mrow><mml:msup><mml:mi>R</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:msubsup><mml:mi>I</mml:mi> <mml:mtext>syn</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> given by the “mean field” <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>). From <xref ref-type="disp-formula" rid="pcbi.1005507.e238">Eq (23)</xref> follows that GIF neurons with the same last spike time <inline-formula id="pcbi.1005507.e290"><alternatives><graphic id="pcbi.1005507.e290g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e290" xlink:type="simple"/><mml:math display="inline" id="M290"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> all have the same membrane potential <inline-formula id="pcbi.1005507.e291"><alternatives><graphic id="pcbi.1005507.e291g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e291" xlink:type="simple"/><mml:math display="inline" id="M291"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> that obeys the differential equation
<disp-formula id="pcbi.1005507.e292"><alternatives><graphic id="pcbi.1005507.e292g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e292" xlink:type="simple"/><mml:math display="block" id="M292"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>μ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>β</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msup><mml:mi>J</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mo>*</mml:mo> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(30)</label></disp-formula>
with <italic>J</italic><sup><italic>αβ</italic></sup> = <italic>p</italic><sup><italic>αβ</italic></sup> <italic>N</italic><sup><italic>β</italic></sup> <italic>w</italic><sup><italic>αβ</italic></sup>. The initial condition is <inline-formula id="pcbi.1005507.e293"><alternatives><graphic id="pcbi.1005507.e293g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e293" xlink:type="simple"/><mml:math display="inline" id="M293"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>r</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> corresponding to the reset of the membrane potential after the last spike. If we use this insight for the conditional intensity <inline-formula id="pcbi.1005507.e294"><alternatives><graphic id="pcbi.1005507.e294g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e294" xlink:type="simple"/><mml:math display="inline" id="M294"><mml:mrow><mml:msup><mml:mi>f</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> we see that the explicit dependence upon <inline-formula id="pcbi.1005507.e295"><alternatives><graphic id="pcbi.1005507.e295g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e295" xlink:type="simple"/><mml:math display="inline" id="M295"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> can be dropped as long as we keep track of the last spike time <inline-formula id="pcbi.1005507.e296"><alternatives><graphic id="pcbi.1005507.e296g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e296" xlink:type="simple"/><mml:math display="inline" id="M296"><mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, cf. <xref ref-type="disp-formula" rid="pcbi.1005507.e280">Eq (28)</xref>; hence <inline-formula id="pcbi.1005507.e297"><alternatives><graphic id="pcbi.1005507.e297g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e297" xlink:type="simple"/><mml:math display="inline" id="M297"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>In a randomly connected network (<italic>p</italic><sup><italic>αβ</italic></sup> &lt; 1), the synaptic input is different for each neuron. On the population level, however, this heterogeneity is averaged allowing us to still use the mean-field approximation, <xref ref-type="disp-formula" rid="pcbi.1005507.e292">Eq (30)</xref>. To see this, we note that in our network with fixed in-degree, each neuron <italic>i</italic> in population <italic>α</italic> has <italic>p</italic><sup><italic>αβ</italic></sup><italic>N</italic><sup><italic>β</italic></sup> presynaptic neurons in population <italic>β</italic> (<italic>β</italic> = <italic>α</italic> is possible). This means that in <xref ref-type="disp-formula" rid="pcbi.1005507.e226">Eq (22)</xref> we can approximate the sum <inline-formula id="pcbi.1005507.e298"><alternatives><graphic id="pcbi.1005507.e298g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e298" xlink:type="simple"/><mml:math display="inline" id="M298"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mo>Γ</mml:mo> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mi>β</mml:mi></mml:msubsup></mml:mrow></mml:msub> <mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>j</mml:mi></mml:mrow> <mml:mi>β</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> over the <italic>p</italic><sup><italic>αβ</italic></sup> <italic>N</italic><sup><italic>β</italic></sup> presynapic neurons by
<disp-formula id="pcbi.1005507.e299"><alternatives><graphic id="pcbi.1005507.e299g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e299" xlink:type="simple"/><mml:math display="block" id="M299"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:msup><mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:msup><mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msup></mml:mrow></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mo>Γ</mml:mo> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mi>β</mml:mi></mml:msubsup></mml:mrow></mml:munder> <mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>j</mml:mi></mml:mrow> <mml:mi>β</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>≈</mml:mo> <mml:msup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:msup><mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msup> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(31)</label></disp-formula>
(cf. definition of <inline-formula id="pcbi.1005507.e300"><alternatives><graphic id="pcbi.1005507.e300g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e300" xlink:type="simple"/><mml:math display="inline" id="M300"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1005507.e013">Eq (1)</xref>). The mean-field approximation, <xref ref-type="disp-formula" rid="pcbi.1005507.e299">Eq (31)</xref>, only depends on the population activity and is thus identical for all neurons. Therefore, fluctuations of the population activity can be regarded as common input fluctuations that are coherent across neurons. On the other hand, the deviation from the mean-field approximation (i.e. the difference between the left- and right-hand side of <xref ref-type="disp-formula" rid="pcbi.1005507.e299">Eq (31)</xref>) is different for each neuron and can be regarded as incoherent noise. For low connection probabilities, this incoherent part of the fluctuations may lead to a significant deviation of the membrane potential <inline-formula id="pcbi.1005507.e301"><alternatives><graphic id="pcbi.1005507.e301g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e301" xlink:type="simple"/><mml:math display="inline" id="M301"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> from the mean-field approximation <inline-formula id="pcbi.1005507.e302"><alternatives><graphic id="pcbi.1005507.e302g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e302" xlink:type="simple"/><mml:math display="inline" id="M302"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1005507.g006">Fig 6A, 6C and 6E</xref>, top). On the mesoscopic scale, however, the total number of spikes in a small time step Δ<italic>t</italic> is determined by the population-averaged conditional firing rate, <xref ref-type="disp-formula" rid="pcbi.1005507.e280">Eq (28)</xref>, (cf. <xref ref-type="disp-formula" rid="pcbi.1005507.e365">Eq (46)</xref> below). Hence, for sufficiently large <italic>N</italic><sup><italic>α</italic></sup>, incoherent noise average out, whereas common finite-size fluctuations survive (<xref ref-type="fig" rid="pcbi.1005507.g006">Fig 6A, 6C and 6E</xref>, bottom). Note, however, that incoherent noise may cause a small bias because we average a nonlinear function of the noisy membrane potential on the l.h.s. of <xref ref-type="disp-formula" rid="pcbi.1005507.e280">Eq (28)</xref>. Effectively, the incoherent noise softens the threshold of the escape noise mechanism.</p>
</sec>
<sec id="sec025">
<title>Quasi-renewal approximation</title>
<p>So far we have reduced the conditional intensity to <inline-formula id="pcbi.1005507.e303"><alternatives><graphic id="pcbi.1005507.e303g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e303" xlink:type="simple"/><mml:math display="inline" id="M303"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:mi>f</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. This expression still involves the individual threshold <inline-formula id="pcbi.1005507.e304"><alternatives><graphic id="pcbi.1005507.e304g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e304" xlink:type="simple"/><mml:math display="inline" id="M304"><mml:mrow><mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> of neuron <italic>i</italic> in population <italic>α</italic>, which depends on the full spike history of that neuron. This means that the spike-train is generally not a time-dependent renewal process. Here, we employ the quasi-renewal approximation [<xref ref-type="bibr" rid="pcbi.1005507.ref063">63</xref>] and average over the spikes before the last spike time assuming that they occurred according to an inhomogeneous Poisson process with rate <inline-formula id="pcbi.1005507.e305"><alternatives><graphic id="pcbi.1005507.e305g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e305" xlink:type="simple"/><mml:math display="inline" id="M305"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005507.e306"><alternatives><graphic id="pcbi.1005507.e306g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e306" xlink:type="simple"/><mml:math display="inline" id="M306"><mml:mrow><mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>&lt;</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. Averaging the conditional intensity, <xref ref-type="disp-formula" rid="pcbi.1005507.e247">Eq (25)</xref>, in this way, conditioned on a given last spike time <inline-formula id="pcbi.1005507.e307"><alternatives><graphic id="pcbi.1005507.e307g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e307" xlink:type="simple"/><mml:math display="inline" id="M307"><mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and a given history <inline-formula id="pcbi.1005507.e308"><alternatives><graphic id="pcbi.1005507.e308g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e308" xlink:type="simple"/><mml:math display="inline" id="M308"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005507.e309"><alternatives><graphic id="pcbi.1005507.e309g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e309" xlink:type="simple"/><mml:math display="inline" id="M309"><mml:mrow><mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>&lt;</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, yields [<xref ref-type="bibr" rid="pcbi.1005507.ref063">63</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref134">134</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref135">135</xref>]
<disp-formula id="pcbi.1005507.e310"><alternatives><graphic id="pcbi.1005507.e310g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e310" xlink:type="simple"/><mml:math display="block" id="M310"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:msup><mml:mi>f</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>≡</mml:mo> <mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(32)</label></disp-formula>
where <inline-formula id="pcbi.1005507.e311"><alternatives><graphic id="pcbi.1005507.e311g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e311" xlink:type="simple"/><mml:math display="inline" id="M311"><mml:mrow><mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is an effective dynamic threshold given by
<disp-formula id="pcbi.1005507.e312"><alternatives><graphic id="pcbi.1005507.e312g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e312" xlink:type="simple"/><mml:math display="block" id="M312"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>ϑ</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>th</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:msubsup> <mml:msup><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(33)</label></disp-formula>
Here, <inline-formula id="pcbi.1005507.e313"><alternatives><graphic id="pcbi.1005507.e313g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e313" xlink:type="simple"/><mml:math display="inline" id="M313"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msubsup><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:mrow></mml:msup> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the so-called quasi-renewal kernel [<xref ref-type="bibr" rid="pcbi.1005507.ref063">63</xref>], while <inline-formula id="pcbi.1005507.e314"><alternatives><graphic id="pcbi.1005507.e314g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e314" xlink:type="simple"/><mml:math display="inline" id="M314"><mml:mrow><mml:msup><mml:mi>θ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> describes the increase of the threshold induced by the last spike. Note that as a result of the two approximations, the conditional firing rate no longer depends on the precise spiking history of a given neuron and its presynaptic neurons, but only on its last firing time, cf. Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e247">25</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e310">32</xref>). This ends our explanation of <xref ref-type="disp-formula" rid="pcbi.1005507.e280">Eq (28)</xref>.</p>
</sec>
</sec>
<sec id="sec026">
<title>Discretized population density equations</title>
<p>Using the mean-field approximation <xref ref-type="disp-formula" rid="pcbi.1005507.e310">Eq (32)</xref>, we have reduced the model to a population of time-dependent renewal processes [<xref ref-type="bibr" rid="pcbi.1005507.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref068">68</xref>], where the conditional intensity of neuron <italic>i</italic> is <inline-formula id="pcbi.1005507.e315"><alternatives><graphic id="pcbi.1005507.e315g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e315" xlink:type="simple"/><mml:math display="inline" id="M315"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Neurons are effectively coupled through the dependence of <inline-formula id="pcbi.1005507.e316"><alternatives><graphic id="pcbi.1005507.e316g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e316" xlink:type="simple"/><mml:math display="inline" id="M316"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> upon the membrane potential <inline-formula id="pcbi.1005507.e317"><alternatives><graphic id="pcbi.1005507.e317g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e317" xlink:type="simple"/><mml:math display="inline" id="M317"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, which in turn depends on the activities <inline-formula id="pcbi.1005507.e318"><alternatives><graphic id="pcbi.1005507.e318g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e318" xlink:type="simple"/><mml:math display="inline" id="M318"><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> of all populations <italic>β</italic> that are connected to population <italic>α</italic>. This is the only place where population labels different from <italic>α</italic> appear. For the sake of notational simplicity, we will omit the population label <italic>α</italic> and the subscript <italic>A</italic> in this section, keeping in mind that all quantities refer to population <italic>α</italic> and that the coupling with other populations is implicitly contained in <inline-formula id="pcbi.1005507.e319"><alternatives><graphic id="pcbi.1005507.e319g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e319" xlink:type="simple"/><mml:math display="inline" id="M319"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>A</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<sec id="sec027">
<title>Microscopic dynamics of the refractory density</title>
<p>Because the firing probability of a neuron only depends on its last spike time and the mesoscopic population activity in the past, we can use a population density description of all last spike times <inline-formula id="pcbi.1005507.e320"><alternatives><graphic id="pcbi.1005507.e320g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e320" xlink:type="simple"/><mml:math display="inline" id="M320"><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> in the population. To derive such representation it is useful to discretize time by introducing the discrete time points <italic>t</italic><sub><italic>k</italic></sub> = <italic>t</italic><sub>0</sub> + <italic>k</italic>Δ<italic>t</italic>, <inline-formula id="pcbi.1005507.e321"><alternatives><graphic id="pcbi.1005507.e321g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e321" xlink:type="simple"/><mml:math display="inline" id="M321"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, and the corresponding intervals <inline-formula id="pcbi.1005507.e322"><alternatives><graphic id="pcbi.1005507.e322g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e322" xlink:type="simple"/><mml:math display="inline" id="M322"><mml:mrow><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Time is measured relative to a reference time <italic>t</italic><sub>0</sub>, which, however, is irrelevant for the following arguments. We require that the size of the intervals Δ<italic>t</italic> is sufficiently small so that each neuron fires at most once during any interval. Specifically, we require that Δ<italic>t</italic> ≤ <italic>t</italic><sub>ref</sub>. We also require that the sum of axonal and synaptic delays is not smaller than Δ<italic>t</italic>. Furthermore, we identify the discrete time point <italic>t</italic><sub><italic>l</italic></sub> as the current time, whereas indices <italic>k</italic> with <italic>k</italic> &lt; <italic>l</italic> correspond to the past. In the population density approach, we do not keep track of the last spike time of each individual neuron but for each past time interval <inline-formula id="pcbi.1005507.e323"><alternatives><graphic id="pcbi.1005507.e323g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e323" xlink:type="simple"/><mml:math display="inline" id="M323"><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> we only track the number of those neurons that have their last spike time in this interval. This number is denoted by <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>). The collection <inline-formula id="pcbi.1005507.e324"><alternatives><graphic id="pcbi.1005507.e324g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e324" xlink:type="simple"/><mml:math display="inline" id="M324"><mml:msub><mml:mrow><mml:mo>{</mml:mo> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">Z</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> of these numbers for all intervals <inline-formula id="pcbi.1005507.e325"><alternatives><graphic id="pcbi.1005507.e325g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e325" xlink:type="simple"/><mml:math display="inline" id="M325"><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, <italic>k</italic> &lt; <italic>l</italic>, represents the current distribution of last spike times <inline-formula id="pcbi.1005507.e326"><alternatives><graphic id="pcbi.1005507.e326g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e326" xlink:type="simple"/><mml:math display="inline" id="M326"><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> in the population at time <italic>t</italic><sub><italic>l</italic></sub> (<xref ref-type="fig" rid="pcbi.1005507.g010">Fig 10A</xref>). Because each neuron has exactly one last spike time, the distribution <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>) is normalized to the total number of neurons:
<disp-formula id="pcbi.1005507.e327"><alternatives><graphic id="pcbi.1005507.e327g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e327" xlink:type="simple"/><mml:math display="block" id="M327"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(34)</label></disp-formula>
Since the last spike time determines the refractory state of a neuron, the distribution <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>) will be also called refractory distribution and the function <italic>Q</italic><sub><italic>N</italic></sub>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>) ≡ <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>)/(<italic>N</italic>Δ<italic>t</italic>) can be regarded as the corresponding refractory density. The refractory distribution fully characterizes the microscopic state of the population.</p>
<fig id="pcbi.1005507.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005507.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Different interpretations of the function <inline-formula id="pcbi.1005507.e333"><alternatives><graphic id="pcbi.1005507.e333g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e333" xlink:type="simple"/><mml:math display="inline" id="M333"><mml:mrow><mml:mi>m</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (red line).</title>
<p>(A) As a function of <inline-formula id="pcbi.1005507.e334"><alternatives><graphic id="pcbi.1005507.e334g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e334" xlink:type="simple"/><mml:math display="inline" id="M334"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (or as a function of <italic>k</italic> in discrete time), <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>) represents the distribution of last spike times <inline-formula id="pcbi.1005507.e335"><alternatives><graphic id="pcbi.1005507.e335g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e335" xlink:type="simple"/><mml:math display="inline" id="M335"><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> across the population at time <italic>t</italic> = <italic>t</italic><sub><italic>l</italic></sub>. (B) As a function of time <italic>t</italic> (or as a function of the index <italic>l</italic> in discrete time), <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>) represents the survival number, i.e. the number of neurons which fired in the interval [<italic>t</italic><sub><italic>k</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub> + Δ<italic>t</italic>) which survived (did not fire) until time <italic>t</italic> = <italic>t</italic><sub><italic>l</italic></sub>. The activity Δ<italic>n</italic>(<italic>t</italic><sub><italic>k</italic></sub>), i.e. the number of neurons that fired in the <italic>k</italic>-th time bin, is depicted by a blue line. The population size is <italic>N</italic> = 1000.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005507.g010" xlink:type="simple"/>
</fig>
<p>We now introduce the number of neurons that fired a spike in the interval <inline-formula id="pcbi.1005507.e328"><alternatives><graphic id="pcbi.1005507.e328g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e328" xlink:type="simple"/><mml:math display="inline" id="M328"><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (not necessarily the last spike). This number is denoted by Δ<italic>n</italic>(<italic>t</italic><sub><italic>k</italic></sub>) (<xref ref-type="fig" rid="pcbi.1005507.g010">Fig 10A</xref>) and is related to the population activity by <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic><sub><italic>k</italic></sub>) = Δ<italic>n</italic>(<italic>t</italic><sub><italic>k</italic></sub>)/(<italic>N</italic>Δ<italic>t</italic>). Therefore, Δ<italic>n</italic>(<italic>t</italic><sub><italic>k</italic></sub>) will be often referred to as simply the “activity” at time <italic>t</italic><sub><italic>k</italic></sub>. Knowing the past activities Δ<italic>n</italic>(<italic>t</italic><sub><italic>k</italic>′</sub>) for <italic>k</italic>′ &lt; <italic>l</italic> and the last spike time <italic>t</italic><sub><italic>k</italic></sub> fully determines the membrane potentials <italic>u</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>) and thresholds <italic>ϑ</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>), and hence the escape rate λ(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>) = <italic>f</italic>(<italic>u</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>) − <italic>ϑ</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>)) associated with the interval <inline-formula id="pcbi.1005507.e329"><alternatives><graphic id="pcbi.1005507.e329g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e329" xlink:type="simple"/><mml:math display="inline" id="M329"><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. Thus, the knowledge of the past activities and the distribution of last spike times at time <italic>t</italic><sub><italic>l</italic></sub> is sufficient to statistically determine these quantities at time <italic>t</italic><sub><italic>l</italic>+1</sub>. In other words, the evolution of the system can be described by a Markov process if we define the microscopic state <inline-formula id="pcbi.1005507.e330"><alternatives><graphic id="pcbi.1005507.e330g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e330" xlink:type="simple"/><mml:math display="inline" id="M330"><mml:mrow><mml:mi mathvariant="script">X</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of the population at time <italic>t</italic><sub><italic>l</italic></sub> by the sequence of pairs
<disp-formula id="pcbi.1005507.e331"><alternatives><graphic id="pcbi.1005507.e331g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e331" xlink:type="simple"/><mml:math display="block" id="M331"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mfenced close="}" open="{"><mml:mfenced close=")" open="(" separators=""><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mfenced> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">Z</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(35)</label></disp-formula>
In the following, the main task will be to derive the statistics of the number of spikes Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic></sub>) in the next time interval [<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>l</italic></sub> + Δ<italic>t</italic>) and the distribution <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub> + Δ<italic>t</italic>, <italic>t</italic><sub><italic>k</italic></sub>) of last spike times at time <italic>t</italic><sub><italic>l</italic>+1</sub> given the state <inline-formula id="pcbi.1005507.e332"><alternatives><graphic id="pcbi.1005507.e332g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e332" xlink:type="simple"/><mml:math display="inline" id="M332"><mml:mrow><mml:mi mathvariant="script">X</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> at time <italic>t</italic><sub><italic>l</italic></sub>. We mention that what we have lost in this population density description is only the information about the identity of the neurons, which, however, is irrelevant for the mesoscopic description of homogeneous populations.</p>
<p>There is a second interpretation of <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>): let us consider the group of neurons that have fired in the interval <inline-formula id="pcbi.1005507.e336"><alternatives><graphic id="pcbi.1005507.e336g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e336" xlink:type="simple"/><mml:math display="inline" id="M336"><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, <italic>k</italic> &lt; <italic>l</italic>. The number of neurons from this group that have “survived” (i.e. that have not fired again) until time <italic>t</italic><sub><italic>l</italic></sub> is exactly given by <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>). We will therefore also call it number of survived neurons or survival number for the refractory state <italic>k</italic>. Correspondingly, the ratio <italic>S</italic><sub><italic>N</italic></sub>(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>) = <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>)/Δ<italic>n</italic>(<italic>t</italic><sub><italic>k</italic></sub>) is the fraction of survived neurons. As time <italic>t</italic><sub><italic>l</italic></sub> evolves, the number of survived neurons diminishes whenever there is a spike in that group (<xref ref-type="fig" rid="pcbi.1005507.g010">Fig 10B</xref>). Thus, if the group fires <italic>X</italic><sub><italic>lk</italic></sub> spikes in the time step [<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>l</italic></sub> + Δ<italic>t</italic>), then <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>) decreases by <italic>X</italic><sub><italic>lk</italic></sub>. For <italic>l</italic> &gt; <italic>k</italic>, this gives rise to the evolution equation
<disp-formula id="pcbi.1005507.e337"><alternatives><graphic id="pcbi.1005507.e337g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e337" xlink:type="simple"/><mml:math display="block" id="M337"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>m</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(36)</label></disp-formula>
The initial condition is given by <italic>m</italic>(<italic>t</italic><sub><italic>k</italic></sub> + Δ<italic>t</italic>, <italic>t</italic><sub><italic>k</italic></sub>) = Δ<italic>n</italic>(<italic>t</italic><sub><italic>k</italic></sub>), which follows from the absolute refractoriness during the first time step after a spike. Absolute refractoriness also entails that each neuron can fire only one spike per time step (Δ<italic>t</italic> ≤ <italic>t</italic><sub>ref</sub>) with a firing probability
<disp-formula id="pcbi.1005507.e338"><alternatives><graphic id="pcbi.1005507.e338g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e338" xlink:type="simple"/><mml:math display="block" id="M338"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msubsup> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>s</mml:mi></mml:mfenced> <mml:mo>≈</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mo>λ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(37)</label></disp-formula>
In the last step, we introduced the average hazard rate <inline-formula id="pcbi.1005507.e339"><alternatives><graphic id="pcbi.1005507.e339g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e339" xlink:type="simple"/><mml:math display="inline" id="M339"><mml:mrow><mml:mover accent="true"><mml:mo>λ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Because the past activities Δ<italic>n</italic>(<italic>t</italic><sub><italic>k</italic></sub>), <italic>k</italic> &lt; <italic>l</italic>, completely determine the probability to fire <italic>P</italic><sub>λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>), each neuron decides independently from the others whether it fires in the next time step. Furthermore, there is a total number of <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>) neurons from the considered group that could potentially fire in the interval [<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>l</italic></sub> + Δ<italic>t</italic>). Therefore, the number of spikes <italic>X</italic><sub><italic>lk</italic></sub> is the result of <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>) independent Bernoulli trials with success probability <italic>P</italic><sub>λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>). This implies that <italic>X</italic><sub><italic>lk</italic></sub> follows a binomial distribution:
<disp-formula id="pcbi.1005507.e340"><alternatives><graphic id="pcbi.1005507.e340g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e340" xlink:type="simple"/><mml:math display="block" id="M340"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∼</mml:mo> <mml:mi>B</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(38)</label></disp-formula>
Moreover, the random numbers <italic>X</italic><sub><italic>lk</italic></sub> associated with different past time intervals <inline-formula id="pcbi.1005507.e341"><alternatives><graphic id="pcbi.1005507.e341g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e341" xlink:type="simple"/><mml:math display="inline" id="M341"><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> are conditionally independent given the current state of the system <inline-formula id="pcbi.1005507.e342"><alternatives><graphic id="pcbi.1005507.e342g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e342" xlink:type="simple"/><mml:math display="inline" id="M342"><mml:mrow><mml:mi mathvariant="script">X</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (cf. <xref ref-type="disp-formula" rid="pcbi.1005507.e331">Eq (35)</xref>).</p>
<p>The total number of spikes emitted in the current interval [<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>l</italic></sub>+Δ<italic>t</italic>) is equal to the total reduction of survivals in that interval, hence
<disp-formula id="pcbi.1005507.e343"><alternatives><graphic id="pcbi.1005507.e343g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e343" xlink:type="simple"/><mml:math display="block" id="M343"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(39)</label></disp-formula>
Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e337">36</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1005507.e343">39</xref>) define the microscopic kinetics in discrete time. In a simulation, for each past time interval <inline-formula id="pcbi.1005507.e344"><alternatives><graphic id="pcbi.1005507.e344g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e344" xlink:type="simple"/><mml:math display="inline" id="M344"><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> one independent Poisson random number <italic>X</italic><sub><italic>lk</italic></sub> needs to be drawn per time step and population. These random numbers determine the current spike count via <xref ref-type="disp-formula" rid="pcbi.1005507.e343">Eq (39)</xref> and the update of the distribution of last spike times <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>), via <xref ref-type="disp-formula" rid="pcbi.1005507.e337">Eq (36)</xref>. We call this description microscopic because for small time steps, there will be many (order of <italic>N</italic>) intervals <inline-formula id="pcbi.1005507.e345"><alternatives><graphic id="pcbi.1005507.e345g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e345" xlink:type="simple"/><mml:math display="inline" id="M345"><mml:msub><mml:mi mathvariant="script">I</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> that contain survived neurons, i.e. for which <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>) &gt; 0 and for each of which one needs to draw a random number <italic>X</italic><sub><italic>lk</italic></sub> in a simulation. In the limit Δ<italic>t</italic> → 0, such a simulation would be as complex as the original microscopic simulation of <italic>N</italic> neurons.</p>
<p>The microscopic population density description can be summarized in a particularly compact form by performing the continuum limit Δ<italic>t</italic> → 0 and by assuming large <italic>N</italic>. For large <italic>N</italic>, the statistics of <italic>X</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>) becomes Gaussian with mean and variance <italic>P</italic><sub>λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>)<italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>). Thus, the dynamics of <inline-formula id="pcbi.1005507.e346"><alternatives><graphic id="pcbi.1005507.e346g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e346" xlink:type="simple"/><mml:math display="inline" id="M346"><mml:mrow><mml:mi>m</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <xref ref-type="disp-formula" rid="pcbi.1005507.e337">Eq (36)</xref>, can be rewritten as
<disp-formula id="pcbi.1005507.e347"><alternatives><graphic id="pcbi.1005507.e347g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e347" xlink:type="simple"/><mml:math display="block" id="M347"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msqrt><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:msqrt> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(40)</label></disp-formula>
where <inline-formula id="pcbi.1005507.e348"><alternatives><graphic id="pcbi.1005507.e348g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e348" xlink:type="simple"/><mml:math display="inline" id="M348"><mml:msub><mml:mrow><mml:mo>{</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> are independent, standard normal random numbers and the ramp function [<italic>x</italic>]<sub>+</sub> = <italic>x</italic>Θ(<italic>x</italic>) ensures non-negativity of <italic>m</italic>. Using the density of last spike times <italic>Q</italic><sub><italic>N</italic></sub>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>) ≡ <italic>S</italic><sub><italic>N</italic></sub>(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>)<italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic><sub><italic>k</italic></sub>) ≡ <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>)/(<italic>N</italic>Δ<italic>t</italic>), setting <italic>t</italic><sub><italic>l</italic></sub> = <italic>t</italic> and <inline-formula id="pcbi.1005507.e349"><alternatives><graphic id="pcbi.1005507.e349g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e349" xlink:type="simple"/><mml:math display="inline" id="M349"><mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, and expanding <inline-formula id="pcbi.1005507.e350"><alternatives><graphic id="pcbi.1005507.e350g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e350" xlink:type="simple"/><mml:math display="inline" id="M350"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> for small Δ<italic>t</italic> we arrive at the following dynamics in the limit Δ<italic>t</italic> → 0:
<disp-formula id="pcbi.1005507.e351"><alternatives><graphic id="pcbi.1005507.e351g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e351" xlink:type="simple"/><mml:math display="block" id="M351"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msqrt><mml:mfrac><mml:mrow><mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>+</mml:mo></mml:msub></mml:mrow> <mml:mi>N</mml:mi></mml:mfrac></mml:msqrt> <mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(41)</label></disp-formula>
Here, <inline-formula id="pcbi.1005507.e352"><alternatives><graphic id="pcbi.1005507.e352g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e352" xlink:type="simple"/><mml:math display="inline" id="M352"><mml:mrow><mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:msub><mml:mo form="prefix" movablelimits="true">lim</mml:mo> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>→</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mtext> </mml:mtext><mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is a Gaussian random field with zero mean and correlation function <inline-formula id="pcbi.1005507.e353"><alternatives><graphic id="pcbi.1005507.e353g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e353" xlink:type="simple"/><mml:math display="inline" id="M353"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo> <mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. For a given last spike time <inline-formula id="pcbi.1005507.e354"><alternatives><graphic id="pcbi.1005507.e354g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e354" xlink:type="simple"/><mml:math display="inline" id="M354"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <xref ref-type="disp-formula" rid="pcbi.1005507.e351">Eq (41)</xref> has the form of a Langevin equation. Its initial condition is <inline-formula id="pcbi.1005507.e355"><alternatives><graphic id="pcbi.1005507.e355g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e355" xlink:type="simple"/><mml:math display="inline" id="M355"><mml:mrow><mml:msub><mml:mi>Q</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The population activity results from <xref ref-type="disp-formula" rid="pcbi.1005507.e343">Eq (39)</xref> as the integral of changes of the refractory density <inline-formula id="pcbi.1005507.e356"><alternatives><graphic id="pcbi.1005507.e356g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e356" xlink:type="simple"/><mml:math display="inline" id="M356"><mml:mrow><mml:msub><mml:mi>Q</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> over all refractory states, i.e. <inline-formula id="pcbi.1005507.e357"><alternatives><graphic id="pcbi.1005507.e357g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e357" xlink:type="simple"/><mml:math display="inline" id="M357"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, or using <xref ref-type="disp-formula" rid="pcbi.1005507.e351">Eq (41)</xref>:
<disp-formula id="pcbi.1005507.e358"><alternatives><graphic id="pcbi.1005507.e358g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e358" xlink:type="simple"/><mml:math display="block" id="M358"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msqrt><mml:mfrac><mml:mrow><mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>+</mml:mo></mml:msub></mml:mrow> <mml:mi>N</mml:mi></mml:mfrac></mml:msqrt> <mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(42)</label></disp-formula>
Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e351">41</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e358">42</xref>) represent the microscopic population density equations in continuous time under the Gaussian and quasi-renewal approximations.</p>
</sec>
<sec id="sec028">
<title>Mesoscopic description</title>
<p>At the mesoscopic level, we want to describe the state of the population at time <italic>t</italic><sub><italic>l</italic></sub> only by the mesoscopic variables Δ<italic>n</italic>(<italic>t</italic><sub><italic>k</italic></sub>), <italic>k</italic> &lt; <italic>l</italic>, that have been observed so far. Therefore, we define the history of <italic>n</italic> at time <italic>t</italic><sub><italic>l</italic></sub> by
<disp-formula id="pcbi.1005507.e359"><alternatives><graphic id="pcbi.1005507.e359g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e359" xlink:type="simple"/><mml:math display="block" id="M359"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">H</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mfenced close="}" open="{" separators=""><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mfenced> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">Z</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(43)</label></disp-formula>
which completely determines the mesoscopic state. In contrast to the microscopic state <inline-formula id="pcbi.1005507.e360"><alternatives><graphic id="pcbi.1005507.e360g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e360" xlink:type="simple"/><mml:math display="inline" id="M360"><mml:mrow><mml:mi mathvariant="script">X</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> defined in <xref ref-type="disp-formula" rid="pcbi.1005507.e331">Eq (35)</xref>, the mesoscopic state does not require the knowledge of the detailed distribution of last spike times <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>). We call a variable mesoscopic if it only depends on the history <inline-formula id="pcbi.1005507.e361"><alternatives><graphic id="pcbi.1005507.e361g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e361" xlink:type="simple"/><mml:math display="inline" id="M361"><mml:mrow><mml:mi mathvariant="script">H</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Likewise, an equation is called mesoscopic if it only involves mesoscopic variables. In the following sections, all averages at a given time <italic>t</italic><sub><italic>l</italic></sub> have to be understood as conditional averages given the history <inline-formula id="pcbi.1005507.e362"><alternatives><graphic id="pcbi.1005507.e362g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e362" xlink:type="simple"/><mml:math display="inline" id="M362"><mml:mrow><mml:mi mathvariant="script">H</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. We will therefore often omit an explicit notation of this condition.</p>
<p>To derive a mesoscopic equation, we want to find an approximate dynamics with only one effective, mesoscopic noise term that summarizes the effect of all microscopic random variables <italic>X</italic><sub><italic>lk</italic></sub>. In a simulation, this would imply to draw only one random number per time step and per population. Towards that end, we assume that Δ<italic>t</italic> can be chosen sufficiently small such that <italic>P</italic><sub>λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>) ≪ 1, which is always possible if neurons are stochastic und hence do not perfectly synchronize. Under this assumption, the binomially-distributed random numbers <italic>X</italic><sub><italic>lk</italic></sub> are approximately Poisson-distributed, i.e.
<disp-formula id="pcbi.1005507.e363"><alternatives><graphic id="pcbi.1005507.e363g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e363" xlink:type="simple"/><mml:math display="block" id="M363"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>∼</mml:mo> <mml:mtext>Pois</mml:mtext> <mml:mfenced close=")" open="(" separators=""><mml:mtext>E</mml:mtext> <mml:mfenced close="]" open="[" separators=""><mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>m</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(44)</label></disp-formula>
where
<disp-formula id="pcbi.1005507.e364"><alternatives><graphic id="pcbi.1005507.e364g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e364" xlink:type="simple"/><mml:math display="block" id="M364"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>E</mml:mtext><mml:mfenced close="]" open="[" separators=""><mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>m</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>=</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(45)</label></disp-formula>
is the conditional mean of <italic>X</italic><sub><italic>lk</italic></sub> given the current survival number <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>). Given the conditional independence of <italic>X</italic><sub><italic>lk</italic></sub> for different <italic>k</italic>, the Poisson property implies that the global activity Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic></sub>) in <xref ref-type="disp-formula" rid="pcbi.1005507.e343">Eq (39)</xref> is also Poisson-distributed given the current refractory distribution {<italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>)}<sub><italic>k</italic>&lt;<italic>l</italic></sub>, i.e.
<disp-formula id="pcbi.1005507.e365"><alternatives><graphic id="pcbi.1005507.e365g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e365" xlink:type="simple"/><mml:math display="block" id="M365"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:mtext>Pois</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(46)</label></disp-formula>
with mean
<disp-formula id="pcbi.1005507.e366"><alternatives><graphic id="pcbi.1005507.e366g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e366" xlink:type="simple"/><mml:math display="block" id="M366"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:mtext>E</mml:mtext> <mml:mfenced close="]" open="[" separators=""><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mrow><mml:mo>{</mml:mo> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">H</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>∞</mml:mi></mml:munderover> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(47)</label></disp-formula>
Because of the definition of refractory densities and <italic>P</italic><sub>λ</sub> ≤ 1, we find that <inline-formula id="pcbi.1005507.e367"><alternatives><graphic id="pcbi.1005507.e367g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e367" xlink:type="simple"/><mml:math display="inline" id="M367"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≤</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is automatically satisfied at any moment in time. However, for the numerical implementation with finite Δ<italic>t</italic> later on we need to keep in mind that the Poisson number Δ<italic>n</italic>(<italic>t</italic>) could become larger than <italic>N</italic>, if <inline-formula id="pcbi.1005507.e368"><alternatives><graphic id="pcbi.1005507.e368g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e368" xlink:type="simple"/><mml:math display="inline" id="M368"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is close to <italic>N</italic>. In this case, using a binomial statistics will be more appropriate, as explained in Sec. “Numerical implementation”.</p>
<p>Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e365">46</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e366">47</xref>) suggest the possibility to generate Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic></sub>) by a <italic>single</italic> Poisson-distributed random number. However, <xref ref-type="disp-formula" rid="pcbi.1005507.e366">Eq (47)</xref> is not a mesoscopic equation yet because it still depends on the dynamics of <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>), <xref ref-type="disp-formula" rid="pcbi.1005507.e337">Eq (36)</xref>, which contains the microscopic random variables <italic>X</italic><sub><italic>lk</italic></sub>. There is another, more subtle problem if we want to use Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e365">46</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e366">47</xref>) as a mesoscopic dynamics that generates the activities Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic></sub>). If we regard Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic></sub>) as an <italic>independent</italic> random variable, the conservation of neurons, <xref ref-type="disp-formula" rid="pcbi.1005507.e343">Eq (39)</xref>, imposes a constraint on the microscopic random numbers {<italic>X</italic><sub><italic>lk</italic></sub>}<sub><italic>k</italic>&lt;<italic>l</italic></sub>, which will therefore not be independent anymore. Conversely, if we consider both {<italic>X</italic><sub><italic>lk</italic></sub>}<sub><italic>k</italic>&lt;<italic>l</italic></sub> and Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic></sub>) as independent variables, we almost certainly violate the conservation of neurons, <xref ref-type="disp-formula" rid="pcbi.1005507.e343">Eq (39)</xref>, or equivalently, the normalization condition <xref ref-type="disp-formula" rid="pcbi.1005507.e327">Eq (34)</xref>. This problem does not occur in the microscopic dynamics, where Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic></sub>) is a <italic>dependent</italic> variable generated from the independent random variables {<italic>X</italic><sub><italic>lk</italic></sub>}<sub><italic>k</italic>&lt;<italic>l</italic></sub> via <xref ref-type="disp-formula" rid="pcbi.1005507.e343">Eq (39)</xref>, and hence the correct normalization is guaranteed at any time. Nevertheless, the “non-normalized” or “unconstrained” process, in which {<italic>X</italic><sub><italic>lk</italic></sub>}<sub><italic>k</italic>&lt;<italic>l</italic></sub> and Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic></sub>) are drawn independently, will be useful for deriving mesoscopic equations because it allows us to calculate the moments of the survival numbers <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>). Our main strategy is to use these moments in conjunction with the normalization condition to express the expected spike count <inline-formula id="pcbi.1005507.e369"><alternatives><graphic id="pcbi.1005507.e369g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e369" xlink:type="simple"/><mml:math display="inline" id="M369"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <xref ref-type="disp-formula" rid="pcbi.1005507.e366">Eq (47)</xref>, as a deterministic functional of the past activities. In this way, <inline-formula id="pcbi.1005507.e370"><alternatives><graphic id="pcbi.1005507.e370g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e370" xlink:type="simple"/><mml:math display="inline" id="M370"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> will not depend anymore on the actual microscopic realizations of the constrained noise <inline-formula id="pcbi.1005507.e371"><alternatives><graphic id="pcbi.1005507.e371g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e371" xlink:type="simple"/><mml:math display="inline" id="M371"><mml:msub><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:msup><mml:mi>l</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>l</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">Z</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>&lt;</mml:mo> <mml:msup><mml:mi>l</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>&lt;</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> (constrained by a given history {Δ<italic>n</italic>(<italic>t</italic><sub><italic>k</italic></sub>)}<sub><italic>k</italic>&lt;<italic>l</italic></sub> via <xref ref-type="disp-formula" rid="pcbi.1005507.e343">Eq (39)</xref>) and can thus be used to generate Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic></sub>) as a Poisson random number from the knowledge of the past activities.</p>
</sec>
<sec id="sec029">
<title>Moment equations</title>
<p>To achieve such deterministic relationship, we first derive mesoscopic equations for the mean and variance of <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>) given the history <inline-formula id="pcbi.1005507.e372"><alternatives><graphic id="pcbi.1005507.e372g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e372" xlink:type="simple"/><mml:math display="inline" id="M372"><mml:mrow><mml:mi mathvariant="script">H</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in the so-called <italic>non-normalized ensemble</italic> or <italic>unconstrained</italic> ensemble. This means that the history determines the initial conditions of the dynamics of <italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>), <xref ref-type="disp-formula" rid="pcbi.1005507.e337">Eq (36)</xref>, as well as the conditional intensities λ(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>), but it does not impose the constraint <xref ref-type="disp-formula" rid="pcbi.1005507.e343">Eq (39)</xref> on the random numbers {<italic>X</italic><sub><italic>l</italic>′, <italic>k</italic></sub>}<sub><italic>l</italic>′≤<italic>l</italic></sub>. Although this unconstrained noise leads to a non-normalized distribution <inline-formula id="pcbi.1005507.e373"><alternatives><graphic id="pcbi.1005507.e373g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e373" xlink:type="simple"/><mml:math display="inline" id="M373"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, it still yields a very good approximation of its mean and variance in the actual constrained ensemble. Taking the average of <xref ref-type="disp-formula" rid="pcbi.1005507.e337">Eq (36)</xref>, and using <xref ref-type="disp-formula" rid="pcbi.1005507.e363">Eq (44)</xref> yields the evolution of the mean:
<disp-formula id="pcbi.1005507.e374"><alternatives><graphic id="pcbi.1005507.e374g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e374" xlink:type="simple"/><mml:math display="block" id="M374"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(48)</label></disp-formula>
with initial condition <inline-formula id="pcbi.1005507.e375"><alternatives><graphic id="pcbi.1005507.e375g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e375" xlink:type="simple"/><mml:math display="inline" id="M375"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>〉</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Here and in the following, <inline-formula id="pcbi.1005507.e376"><alternatives><graphic id="pcbi.1005507.e376g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e376" xlink:type="simple"/><mml:math display="inline" id="M376"><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is short-hand for <inline-formula id="pcbi.1005507.e377"><alternatives><graphic id="pcbi.1005507.e377g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e377" xlink:type="simple"/><mml:math display="inline" id="M377"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> to simplify the notation, and 〈⋅〉 denotes the ensemble average of the unconstrained process for a given history <inline-formula id="pcbi.1005507.e378"><alternatives><graphic id="pcbi.1005507.e378g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e378" xlink:type="simple"/><mml:math display="inline" id="M378"><mml:mrow><mml:mi mathvariant="script">H</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Actually, the condition for the average 〈⋅〉 can be extended to the history <inline-formula id="pcbi.1005507.e379"><alternatives><graphic id="pcbi.1005507.e379g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e379" xlink:type="simple"/><mml:math display="inline" id="M379"><mml:mrow><mml:mi mathvariant="script">H</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (and to any future activities) because in the unconstrained ensemble neither <inline-formula id="pcbi.1005507.e380"><alternatives><graphic id="pcbi.1005507.e380g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e380" xlink:type="simple"/><mml:math display="inline" id="M380"><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> nor <inline-formula id="pcbi.1005507.e381"><alternatives><graphic id="pcbi.1005507.e381g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e381" xlink:type="simple"/><mml:math display="inline" id="M381"><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> depend on the most recent activity Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic></sub>) (clearly, this also holds for any future activity). Importantly, <xref ref-type="disp-formula" rid="pcbi.1005507.e374">Eq (48)</xref> is a mesoscopic equation because it is fully determined by the past activities.</p>
<p>As a next step we derive an equation for the variance of <inline-formula id="pcbi.1005507.e382"><alternatives><graphic id="pcbi.1005507.e382g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e382" xlink:type="simple"/><mml:math display="inline" id="M382"><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. To this end, let
<disp-formula id="pcbi.1005507.e383"><alternatives><graphic id="pcbi.1005507.e383g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e383" xlink:type="simple"/><mml:math display="block" id="M383"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(49)</label></disp-formula>
denote the deviation from the mean. Using the law of total variance, we find for the variance in the next time step
<disp-formula id="pcbi.1005507.e384"><alternatives><graphic id="pcbi.1005507.e384g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e384" xlink:type="simple"/><mml:math display="block" id="M384"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mtext>Var</mml:mtext> <mml:mfenced close="]" open="[" separators=""><mml:mi mathvariant="normal">E</mml:mi> <mml:mfenced close="]" open="[" separators=""><mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>l</mml:mi></mml:msub></mml:mfenced></mml:mfenced> <mml:mo>+</mml:mo> <mml:mfenced close="⟩" open="⟨" separators=""><mml:mtext>Var</mml:mtext> <mml:mfenced close="]" open="[" separators=""><mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>l</mml:mi></mml:msub></mml:mfenced></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(50)</label></disp-formula>
The conditional mean of <italic>m</italic><sub><italic>l</italic>+1,<italic>k</italic></sub> given the current value <italic>m</italic><sub><italic>l</italic>,<italic>k</italic></sub>, denoted by <italic>E</italic>[<italic>m</italic><sub><italic>l</italic>+1,<italic>k</italic></sub>|<italic>m</italic><sub><italic>l</italic>,<italic>k</italic></sub>], follows from the evolution Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e337">36</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e364">45</xref>) as [1 − <italic>P</italic><sub>λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>)]<italic>m</italic><sub><italic>l</italic>,<italic>k</italic></sub>. Therefore, its variance is <inline-formula id="pcbi.1005507.e385"><alternatives><graphic id="pcbi.1005507.e385g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e385" xlink:type="simple"/><mml:math display="inline" id="M385"><mml:mrow><mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>〈</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. For the second term in <xref ref-type="disp-formula" rid="pcbi.1005507.e384">Eq (50)</xref>, we note that the conditional variance Var[<italic>m</italic><sub><italic>l</italic>+1,<italic>k</italic></sub>|<italic>m</italic><sub><italic>l</italic>, <italic>k</italic></sub>] is equal to the variance Var[<italic>X</italic><sub><italic>lk</italic></sub>|<italic>m</italic><sub><italic>l</italic>, <italic>k</italic></sub>] of the decrement <italic>X</italic><sub><italic>lk</italic></sub>. Because <italic>X</italic><sub><italic>lk</italic></sub> is a Poisson variable, this variance is equal to the mean given by <xref ref-type="disp-formula" rid="pcbi.1005507.e364">Eq (45)</xref>. Taken together, we find the following update rule for the total variance
<disp-formula id="pcbi.1005507.e386"><alternatives><graphic id="pcbi.1005507.e386g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e386" xlink:type="simple"/><mml:math display="block" id="M386"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>⟨</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(51)</label></disp-formula>
with initial condition <inline-formula id="pcbi.1005507.e387"><alternatives><graphic id="pcbi.1005507.e387g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e387" xlink:type="simple"/><mml:math display="inline" id="M387"><mml:mrow><mml:mo>〈</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>〉</mml:mo> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. As a function of <italic>t</italic><sub><italic>l</italic></sub> (<xref ref-type="fig" rid="pcbi.1005507.g002">Fig 2C</xref> bottom), the variance <inline-formula id="pcbi.1005507.e388"><alternatives><graphic id="pcbi.1005507.e388g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e388" xlink:type="simple"/><mml:math display="inline" id="M388"><mml:mrow><mml:mo>〈</mml:mo> <mml:mo>Δ</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is initially zero because all neurons have still survived immediately after firing at time <italic>t</italic><sub><italic>k</italic></sub>. On the other hand, at long times <italic>t</italic><sub><italic>l</italic></sub> ≫ <italic>t</italic><sub><italic>k</italic></sub>, the variance also vanishes because according to <xref ref-type="disp-formula" rid="pcbi.1005507.e374">Eq (48)</xref>, the mean number of survived neurons 〈<italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>)〉 appearing in <xref ref-type="disp-formula" rid="pcbi.1005507.e386">Eq (51)</xref> goes to zero. As a consequence, the variance obtains a maximum at an intermediate time. Similarly, the dependence of the variance at time <italic>t</italic><sub><italic>l</italic></sub> for different last spike times <inline-formula id="pcbi.1005507.e389"><alternatives><graphic id="pcbi.1005507.e389g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e389" xlink:type="simple"/><mml:math display="inline" id="M389"><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> shows the same limiting behavior which implies a maximum at an intermediate last spike time <inline-formula id="pcbi.1005507.e390"><alternatives><graphic id="pcbi.1005507.e390g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e390" xlink:type="simple"/><mml:math display="inline" id="M390"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1005507.g002">Fig 2B</xref> bottom). However, the rugged shape of this function with many local maxima reflects the discontinuity of the driving force 〈<italic>m</italic>(<italic>t</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>k</italic></sub>)〉 as a function of <italic>t</italic><sub><italic>k</italic></sub> that arises from the stochastic initial condition 〈<italic>m</italic>(<italic>t</italic><sub><italic>k</italic>+1</sub>, <italic>t</italic><sub><italic>k</italic></sub>)〉 = Δ<italic>n</italic>(<italic>t</italic><sub><italic>k</italic></sub>).</p>
</sec>
<sec id="sec030">
<title>Mesoscopic population equations</title>
<p>Let us return to <xref ref-type="disp-formula" rid="pcbi.1005507.e366">Eq (47)</xref> for the expected activity <inline-formula id="pcbi.1005507.e391"><alternatives><graphic id="pcbi.1005507.e391g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e391" xlink:type="simple"/><mml:math display="inline" id="M391"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, which is used to draw the activity Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic></sub>) as a Poisson random number (cf. <xref ref-type="disp-formula" rid="pcbi.1005507.e365">Eq (46)</xref>). Because we condition on the history {Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic>′</sub>)}<sub><italic>l</italic>′&lt;<italic>l</italic></sub>, the processes <italic>m</italic><sub><italic>l</italic>,<italic>k</italic></sub> in this equation belong to the “constrained” ensemble, in which the normalization condition, <xref ref-type="disp-formula" rid="pcbi.1005507.e327">Eq (34)</xref>, is obeyed. We note that these constrained processes could in principle be generated microscopically by <xref ref-type="disp-formula" rid="pcbi.1005507.e337">Eq (36)</xref> if at each time <italic>t</italic><sub><italic>l</italic>′</sub> in the past, the microscopic noise <italic>X</italic><sub><italic>l</italic>′<italic>k</italic></sub> was sampled from a joint distribution that ensures the conservation of neurons, <xref ref-type="disp-formula" rid="pcbi.1005507.e343">Eq (39)</xref>, i.e. ∑<sub><italic>k</italic></sub> <italic>X</italic><sub><italic>l</italic>′<italic>k</italic></sub> = Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic>′</sub>). However, as we will show in the following, such a construction is not needed because the dependence of the expected activity <inline-formula id="pcbi.1005507.e392"><alternatives><graphic id="pcbi.1005507.e392g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e392" xlink:type="simple"/><mml:math display="inline" id="M392"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> on a specific realization of <italic>m</italic><sub><italic>l</italic>,<italic>k</italic></sub> can be eliminated by exploiting the normalization condition, <xref ref-type="disp-formula" rid="pcbi.1005507.e327">Eq (34)</xref>. To this end, we take advantage of the fact that the mean <inline-formula id="pcbi.1005507.e393"><alternatives><graphic id="pcbi.1005507.e393g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e393" xlink:type="simple"/><mml:math display="inline" id="M393"><mml:mrow><mml:mo>〈</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>〉</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of the unconstrained process is a mesoscopic variable. This suggests to split the constrained processes <italic>m</italic><sub><italic>l</italic>,<italic>k</italic></sub> into the mean of the unconstrained process and a fluctuation part:
<disp-formula id="pcbi.1005507.e394"><alternatives><graphic id="pcbi.1005507.e394g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e394" xlink:type="simple"/><mml:math display="block" id="M394"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(52)</label></disp-formula>
The first contribution is deterministic given the past activities Δ<italic>n</italic>(<italic>t</italic><sub><italic>k</italic></sub>) while the second contribution represents the microscopic fluctuations. We note that the fluctuation <italic>δm</italic><sub><italic>l</italic>,<italic>k</italic></sub> is not equivalent to the deviation <inline-formula id="pcbi.1005507.e395"><alternatives><graphic id="pcbi.1005507.e395g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e395" xlink:type="simple"/><mml:math display="inline" id="M395"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> of the unconstrained process because <inline-formula id="pcbi.1005507.e396"><alternatives><graphic id="pcbi.1005507.e396g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e396" xlink:type="simple"/><mml:math display="inline" id="M396"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>〉</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> does not obey the normalization condition, <xref ref-type="disp-formula" rid="pcbi.1005507.e327">Eq (34)</xref>, whereas <inline-formula id="pcbi.1005507.e397"><alternatives><graphic id="pcbi.1005507.e397g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e397" xlink:type="simple"/><mml:math display="inline" id="M397"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>〉</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> does.</p>
<p>To remove the microscopic fluctuations <italic>δm</italic><sub><italic>l</italic>,<italic>k</italic></sub>, we require that both Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e327">34</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e366">47</xref>) are simultaneously satisfied. Substituting <xref ref-type="disp-formula" rid="pcbi.1005507.e394">Eq (52)</xref> into these equations leads to
<disp-formula id="pcbi.1005507.e398"><alternatives><graphic id="pcbi.1005507.e398g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e398" xlink:type="simple"/><mml:math display="block" id="M398"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mi>N</mml:mi><mml:mrow><mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(53)</label></disp-formula>
<disp-formula id="pcbi.1005507.e399"><alternatives><graphic id="pcbi.1005507.e399g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e399" xlink:type="simple"/><mml:math display="block" id="M399"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(54)</label></disp-formula>
The microscopic fluctuations <italic>δm</italic><sub><italic>l</italic>,<italic>k</italic></sub> enter the dynamics only in the form of two sums. First, the normalization condition <xref ref-type="disp-formula" rid="pcbi.1005507.e398">Eq (53)</xref> imposes a strict relation between the summed deviation ∑<sub><italic>k</italic></sub> <italic>δm</italic><sub><italic>l</italic>,<italic>k</italic></sub> and the means of the unconstrained processes, <inline-formula id="pcbi.1005507.e400"><alternatives><graphic id="pcbi.1005507.e400g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e400" xlink:type="simple"/><mml:math display="inline" id="M400"><mml:mrow><mml:mo>〈</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>〉</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, irrespective of the specific, underlying microscopic dynamics of <italic>m</italic><sub><italic>l</italic>,<italic>k</italic></sub>. In particular, we can solve for <inline-formula id="pcbi.1005507.e401"><alternatives><graphic id="pcbi.1005507.e401g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e401" xlink:type="simple"/><mml:math display="inline" id="M401"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mtext> </mml:mtext><mml:mi>δ</mml:mi> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>〈</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> with terms on the r.h.s. that are completely determined given the past activities. Second, the total effect of the deviations on the expected activity <inline-formula id="pcbi.1005507.e402"><alternatives><graphic id="pcbi.1005507.e402g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e402" xlink:type="simple"/><mml:math display="inline" id="M402"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is given by the weighted sum ∑<sub><italic>k</italic></sub> <italic>P</italic><sub>λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>)<italic>δm</italic><sub><italic>l</italic>,<italic>k</italic></sub> in <xref ref-type="disp-formula" rid="pcbi.1005507.e399">Eq (54)</xref> with <italic>P</italic><sub>λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>) ≤ 1 for all <italic>k</italic> &lt; <italic>l</italic>. The weighted sum ∑<sub><italic>k</italic></sub> <italic>P</italic><sub>λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>)<italic>δm</italic><sub><italic>l</italic>,<italic>k</italic></sub> is therefore tightly constrained by the value of the summed fluctuation ∑<sub><italic>k</italic></sub> <italic>δm</italic><sub><italic>l</italic>,<italic>k</italic></sub>. These considerations suggest to make the following decoupling approximation:
<disp-formula id="pcbi.1005507.e403"><alternatives><graphic id="pcbi.1005507.e403g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e403" xlink:type="simple"/><mml:math display="block" id="M403"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>≈</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mo>Λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(55)</label></disp-formula>
with a still unknown factor <italic>P</italic><sub>Λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>), that we call effective firing probability. To determine the effective firing probability, we require that in the unconstrained ensemble the corresponding approximation
<disp-formula id="pcbi.1005507.e404"><alternatives><graphic id="pcbi.1005507.e404g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e404" xlink:type="simple"/><mml:math display="block" id="M404"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mo>Λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ε</mml:mi> <mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(56)</label></disp-formula>
minimizes the mean squared error <inline-formula id="pcbi.1005507.e405"><alternatives><graphic id="pcbi.1005507.e405g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e405" xlink:type="simple"/><mml:math display="inline" id="M405"><mml:mrow><mml:mi mathvariant="script">E</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mo>Λ</mml:mo></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>〈</mml:mo> <mml:msubsup><mml:mi>ε</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>P</italic><sub>Λ</sub> is short-hand for <italic>P</italic><sub>Λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>). We use the unconstrained deviations <inline-formula id="pcbi.1005507.e406"><alternatives><graphic id="pcbi.1005507.e406g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e406" xlink:type="simple"/><mml:math display="inline" id="M406"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> here because we are only interested in the typical error. Note that if <italic>ε</italic><sub><italic>l</italic></sub> is Gaussian distributed, minimizing the mean squared error yields the optimal estimation of <italic>P</italic><sub>Λ</sub> in the sense that it maximizes the log-likelihood of <inline-formula id="pcbi.1005507.e407"><alternatives><graphic id="pcbi.1005507.e407g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e407" xlink:type="simple"/><mml:math display="inline" id="M407"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mtext> </mml:mtext><mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> given <inline-formula id="pcbi.1005507.e408"><alternatives><graphic id="pcbi.1005507.e408g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e408" xlink:type="simple"/><mml:math display="inline" id="M408"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mtext> </mml:mtext><mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> under the linear approximation <xref ref-type="disp-formula" rid="pcbi.1005507.e404">Eq (56)</xref>. The error can be rewritten as <italic>ε</italic><sub><italic>l</italic></sub> = ∑<sub><italic>k</italic></sub>[<italic>P</italic><sub>λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>) − <italic>P</italic><sub>Λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>)]Δ<italic>m</italic><sub><italic>l</italic>, <italic>k</italic></sub>, which for <italic>N</italic> ≫ 1 is a sum of many independent variables that can indeed be considered to be Gaussian. The derivative of <inline-formula id="pcbi.1005507.e409"><alternatives><graphic id="pcbi.1005507.e409g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e409" xlink:type="simple"/><mml:math display="inline" id="M409"><mml:mi mathvariant="script">E</mml:mi></mml:math></alternatives></inline-formula> with respect to <italic>P</italic><sub>Λ</sub> is
<disp-formula id="pcbi.1005507.e410"><alternatives><graphic id="pcbi.1005507.e410g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e410" xlink:type="simple"/><mml:math display="block" id="M410"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi mathvariant="script">E</mml:mi></mml:mrow> <mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:msub><mml:mi>P</mml:mi> <mml:mo>Λ</mml:mo></mml:msub></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:msub><mml:mi>P</mml:mi> <mml:mo>Λ</mml:mo></mml:msub> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>&lt;</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:munder> <mml:mrow><mml:mo>⟨</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>&lt;</mml:mo> <mml:mi>l</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>⟨</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(57)</label></disp-formula>
where we have exploited that <italic>P</italic><sub>λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>) is deterministic given the past activities Δ<italic>n</italic>(<italic>t</italic><sub><italic>k</italic></sub>), <italic>k</italic> &lt; <italic>l</italic>. Furthermore, under this condition, the fluctuations <inline-formula id="pcbi.1005507.e411"><alternatives><graphic id="pcbi.1005507.e411g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e411" xlink:type="simple"/><mml:math display="inline" id="M411"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005507.e412"><alternatives><graphic id="pcbi.1005507.e412g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e412" xlink:type="simple"/><mml:math display="inline" id="M412"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> with <italic>k</italic> ≠ <italic>k</italic>′ are conditionally independent. Using this property and setting <inline-formula id="pcbi.1005507.e413"><alternatives><graphic id="pcbi.1005507.e413g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e413" xlink:type="simple"/><mml:math display="inline" id="M413"><mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi mathvariant="script">E</mml:mi> <mml:mo>/</mml:mo> <mml:mi mathvariant="normal">d</mml:mi> <mml:msub><mml:mi>P</mml:mi> <mml:mo>Λ</mml:mo></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> we find that the optimal effective firing probability is
<disp-formula id="pcbi.1005507.e414"><alternatives><graphic id="pcbi.1005507.e414g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e414" xlink:type="simple"/><mml:math display="block" id="M414"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mo>Λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>⟨</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>⟩</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>⟨</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(58)</label></disp-formula>
The variance <inline-formula id="pcbi.1005507.e415"><alternatives><graphic id="pcbi.1005507.e415g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e415" xlink:type="simple"/><mml:math display="inline" id="M415"><mml:mrow><mml:mo>〈</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>〉</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in this formula obeys the mesoscopic dynamics derived above in <xref ref-type="disp-formula" rid="pcbi.1005507.e386">Eq (51)</xref>. Hence, the effective firing probability is itself mesoscopic.</p>
<p>Using Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e398">53</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e403">55</xref>), ∑<sub><italic>k</italic></sub> <italic>δm</italic><sub><italic>l</italic>, <italic>k</italic></sub> can be eliminated in <xref ref-type="disp-formula" rid="pcbi.1005507.e399">Eq (54)</xref> resulting in
<disp-formula id="pcbi.1005507.e416"><alternatives><graphic id="pcbi.1005507.e416g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e416" xlink:type="simple"/><mml:math display="block" id="M416"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mo>Λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mfenced close=")" open="(" separators=""><mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(59)</label></disp-formula>
Thus, we obtain an equation that yields the mean spike count <inline-formula id="pcbi.1005507.e417"><alternatives><graphic id="pcbi.1005507.e417g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e417" xlink:type="simple"/><mml:math display="inline" id="M417"><mml:mrow><mml:mo>Δ</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> at the present time as a function of the past spike counts {Δ<italic>n</italic>(<italic>t</italic><sub><italic>k</italic></sub>)}<sub><italic>k</italic>&lt;<italic>l</italic></sub>. <xref ref-type="disp-formula" rid="pcbi.1005507.e416">Eq (59)</xref> is the desired mesoscopic equation in discrete time. For sufficiently small time steps Δ<italic>t</italic>, the present spike count Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic></sub>) can be generated by drawing a Poisson random number with mean <inline-formula id="pcbi.1005507.e418"><alternatives><graphic id="pcbi.1005507.e418g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e418" xlink:type="simple"/><mml:math display="inline" id="M418"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> according to <xref ref-type="disp-formula" rid="pcbi.1005507.e365">Eq (46)</xref>.</p>
</sec>
</sec>
<sec id="sec031">
<title>Mesoscopic population density equations in continuous time</title>
<p>In continuous time, we consider the rescaled variables
<disp-formula id="pcbi.1005507.e419"><alternatives><graphic id="pcbi.1005507.e419g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e419" xlink:type="simple"/><mml:math display="block" id="M419"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(60)</label></disp-formula>
Here, <inline-formula id="pcbi.1005507.e420"><alternatives><graphic id="pcbi.1005507.e420g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e420" xlink:type="simple"/><mml:math display="inline" id="M420"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> can be interpreted as the <italic>expected population activity</italic> given the past activity <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>′), <italic>t</italic>′ &lt; <italic>t</italic>. For Δ<italic>t</italic> small but positive, the spike count Δ<italic>n</italic>(<italic>t</italic>) is an independent Poisson number with mean <inline-formula id="pcbi.1005507.e421"><alternatives><graphic id="pcbi.1005507.e421g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e421" xlink:type="simple"/><mml:math display="inline" id="M421"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Thus, on a coarse-grained time scale, the continuum limit of the population activity may be written in the following suggestive way
<disp-formula id="pcbi.1005507.e422"><alternatives><graphic id="pcbi.1005507.e422g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e422" xlink:type="simple"/><mml:math display="block" id="M422"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>n</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>N</mml:mi> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:mtext>Pois</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(61)</label></disp-formula>
where d<italic>t</italic> denotes an infinitesimal (but temporally coarse-grained) time step and d<italic>n</italic>(<italic>t</italic>) is an independent Poisson-distributed random number with mean <inline-formula id="pcbi.1005507.e423"><alternatives><graphic id="pcbi.1005507.e423g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e423" xlink:type="simple"/><mml:math display="inline" id="M423"><mml:mrow><mml:mi>N</mml:mi> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. In the limit d<italic>t</italic> → 0, the spike count in an infinitesimal time step is a Bernoulli random number, where d<italic>n</italic>(<italic>t</italic>) = 1 with probability <inline-formula id="pcbi.1005507.e424"><alternatives><graphic id="pcbi.1005507.e424g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e424" xlink:type="simple"/><mml:math display="inline" id="M424"><mml:mrow><mml:mi>N</mml:mi> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and <italic>n</italic>(<italic>t</italic>) = 0 with probability <inline-formula id="pcbi.1005507.e425"><alternatives><graphic id="pcbi.1005507.e425g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e425" xlink:type="simple"/><mml:math display="inline" id="M425"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>N</mml:mi> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Therefore, in this limit the population activity <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) converges to a sequence of Dirac <italic>δ</italic>-functions occurring at random times <italic>t</italic><sub>pop,<italic>k</italic></sub> with rate <inline-formula id="pcbi.1005507.e426"><alternatives><graphic id="pcbi.1005507.e426g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e426" xlink:type="simple"/><mml:math display="inline" id="M426"><mml:mrow><mml:mi>N</mml:mi> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Thus, <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) can be written more formally as a population spike train or “shot-noise”
<disp-formula id="pcbi.1005507.e427"><alternatives><graphic id="pcbi.1005507.e427g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e427" xlink:type="simple"/><mml:math display="block" id="M427"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:munder> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mtext>pop</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(62)</label></disp-formula>
where <inline-formula id="pcbi.1005507.e428"><alternatives><graphic id="pcbi.1005507.e428g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e428" xlink:type="simple"/><mml:math display="inline" id="M428"><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mtext>pop</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is a point process with conditional intensity <inline-formula id="pcbi.1005507.e429"><alternatives><graphic id="pcbi.1005507.e429g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e429" xlink:type="simple"/><mml:math display="inline" id="M429"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mtext>pop</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Here, the condition <inline-formula id="pcbi.1005507.e430"><alternatives><graphic id="pcbi.1005507.e430g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e430" xlink:type="simple"/><mml:math display="inline" id="M430"><mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula> denotes the history of the population activity {<italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>′)}<sub><italic>t</italic>′&lt;<italic>t</italic></sub>, or equivalently, the history of spike times {<italic>t</italic><sub>pop,<italic>k</italic></sub>}<sub><italic>t</italic><sub>pop,<italic>k</italic></sub>&lt;<italic>t</italic></sub>, up to (but not including) time <italic>t</italic>.</p>
<p>To obtain the dynamics for <inline-formula id="pcbi.1005507.e431"><alternatives><graphic id="pcbi.1005507.e431g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e431" xlink:type="simple"/><mml:math display="inline" id="M431"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, we also introduce the rescaled variables
<disp-formula id="pcbi.1005507.e432"><alternatives><graphic id="pcbi.1005507.e432g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e432" xlink:type="simple"/><mml:math display="block" id="M432"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>⟨</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(63)</label></disp-formula>
The function <inline-formula id="pcbi.1005507.e433"><alternatives><graphic id="pcbi.1005507.e433g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e433" xlink:type="simple"/><mml:math display="inline" id="M433"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> can be interpreted as the survival probability of neurons that have fired their last spike at time <inline-formula id="pcbi.1005507.e434"><alternatives><graphic id="pcbi.1005507.e434g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e434" xlink:type="simple"/><mml:math display="inline" id="M434"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. Furthermore, for small Δ<italic>t</italic> the firing probability is given by <italic>P</italic><sub>λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>) = λ(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>)Δ<italic>t</italic> + <italic>O</italic>(Δ<italic>t</italic><sup>2</sup>). Thus, the continuum limit of <xref ref-type="disp-formula" rid="pcbi.1005507.e416">Eq (59)</xref> reads
<disp-formula id="pcbi.1005507.e435"><alternatives><graphic id="pcbi.1005507.e435g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e435" xlink:type="simple"/><mml:math display="block" id="M435"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>lim</mml:mtext></mml:mrow><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mi>t</mml:mi><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:mi>k</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi></mml:mrow> <mml:mo>|</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow> </mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mrow><mml:mtext>  </mml:mtext><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mi>t</mml:mi><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>k</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mi>t</mml:mi><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mi>t</mml:mi><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>k</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(64)</label></disp-formula>
The sums in this equation can be regarded as the definition of stochastic integrals, which allows us to rewrite <xref ref-type="disp-formula" rid="pcbi.1005507.e435">Eq (64)</xref> as
<disp-formula id="pcbi.1005507.e436"><alternatives><graphic id="pcbi.1005507.e436g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e436" xlink:type="simple"/><mml:math display="block" id="M436"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:mo>Λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(65)</label></disp-formula>
Here,
<disp-formula id="pcbi.1005507.e437"><alternatives><graphic id="pcbi.1005507.e437g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e437" xlink:type="simple"/><mml:math display="block" id="M437"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(66)</label></disp-formula>
is an effective rate corresponding to the effective firing probability <italic>P</italic><sub>Λ</sub>(<italic>t</italic>). Note that according to <xref ref-type="disp-formula" rid="pcbi.1005507.e435">Eq (64)</xref>, the stochastic integrals in <xref ref-type="disp-formula" rid="pcbi.1005507.e436">Eq (65)</xref> extend only over last spike times <inline-formula id="pcbi.1005507.e438"><alternatives><graphic id="pcbi.1005507.e438g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e438" xlink:type="simple"/><mml:math display="inline" id="M438"><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> not including time <inline-formula id="pcbi.1005507.e439"><alternatives><graphic id="pcbi.1005507.e439g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e439" xlink:type="simple"/><mml:math display="inline" id="M439"><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Taking the continuum limit of <xref ref-type="disp-formula" rid="pcbi.1005507.e374">Eq (48)</xref> we find that the survival probability satisfies the differential equation
<disp-formula id="pcbi.1005507.e440"><alternatives><graphic id="pcbi.1005507.e440g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e440" xlink:type="simple"/><mml:math display="block" id="M440"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>S</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(67)</label></disp-formula>
This equation has the simple solution
<disp-formula id="pcbi.1005507.e441"><alternatives><graphic id="pcbi.1005507.e441g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e441" xlink:type="simple"/><mml:math display="block" id="M441"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(68)</label></disp-formula>
Similarly, we find from <xref ref-type="disp-formula" rid="pcbi.1005507.e386">Eq (51)</xref> that the rescaled variance obeys the differential equation
<disp-formula id="pcbi.1005507.e442"><alternatives><graphic id="pcbi.1005507.e442g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e442" xlink:type="simple"/><mml:math display="block" id="M442"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>v</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>v</mml:mi> <mml:mo>+</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(69)</label></disp-formula>
The set of coupled Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e427">62</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1005507.e442">69</xref>) defines the mesoscopic population dynamics. We emphasize that not only <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) depends on <inline-formula id="pcbi.1005507.e443"><alternatives><graphic id="pcbi.1005507.e443g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e443" xlink:type="simple"/><mml:math display="inline" id="M443"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (cf. <xref ref-type="disp-formula" rid="pcbi.1005507.e427">Eq (62)</xref>) but that there is also a feedback of <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) onto the dynamics of <inline-formula id="pcbi.1005507.e444"><alternatives><graphic id="pcbi.1005507.e444g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e444" xlink:type="simple"/><mml:math display="inline" id="M444"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, cf. <xref ref-type="disp-formula" rid="pcbi.1005507.e436">Eq (65)</xref>. In fact, <inline-formula id="pcbi.1005507.e445"><alternatives><graphic id="pcbi.1005507.e445g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e445" xlink:type="simple"/><mml:math display="inline" id="M445"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> can be regarded as a deterministic functional of the past activities up to but not including time <italic>t</italic>. In particular, <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) is <italic>not</italic> an inhomogeneous Poisson spike train because the specific realization of the spike history of <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) determines the conditional intensity function for the point process (<italic>t</italic><sub>pop,<italic>k</italic></sub>) via <xref ref-type="disp-formula" rid="pcbi.1005507.e436">Eq (65)</xref>. Furthermore, we note that, in the case of synaptic coupling or adaptation, also the variables <italic>S</italic> and <italic>v</italic> depend on the history of the population activity through the dependence of <inline-formula id="pcbi.1005507.e446"><alternatives><graphic id="pcbi.1005507.e446g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e446" xlink:type="simple"/><mml:math display="inline" id="M446"><mml:mrow><mml:mo>λ</mml:mo> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> on the membrane potential <inline-formula id="pcbi.1005507.e447"><alternatives><graphic id="pcbi.1005507.e447g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e447" xlink:type="simple"/><mml:math display="inline" id="M447"><mml:mrow><mml:mi>u</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and the threshold <inline-formula id="pcbi.1005507.e448"><alternatives><graphic id="pcbi.1005507.e448g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e448" xlink:type="simple"/><mml:math display="inline" id="M448"><mml:mrow><mml:mi>ϑ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (cf. Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e292">30</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e312">33</xref>)).</p>
<p>For large <italic>N</italic>, the population activity can be approximated by a Gaussian process. To this end, we note that in the discrete time description the spike counts Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic></sub>) are conditionally independent random numbers with mean and variance <inline-formula id="pcbi.1005507.e449"><alternatives><graphic id="pcbi.1005507.e449g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e449" xlink:type="simple"/><mml:math display="inline" id="M449"><mml:mrow><mml:mi>N</mml:mi> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Therefore, in the large-<italic>N</italic> limit, the variable
<disp-formula id="pcbi.1005507.e450"><alternatives><graphic id="pcbi.1005507.e450g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e450" xlink:type="simple"/><mml:math display="block" id="M450"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>W</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>N</mml:mi> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:msqrt><mml:mrow><mml:mi>N</mml:mi> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(70)</label></disp-formula>
is normally distributed with mean zero and variance Δ<italic>t</italic>, and hence corresponds to the increment of a Wiener process. Using <xref ref-type="disp-formula" rid="pcbi.1005507.e419">Eq (60)</xref> for the population activity and taking the continuum limit Δ<italic>t</italic> → 0, we obtain
<disp-formula id="pcbi.1005507.e451"><alternatives><graphic id="pcbi.1005507.e451g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e451" xlink:type="simple"/><mml:math display="block" id="M451"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msqrt><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>N</mml:mi></mml:mfrac></mml:msqrt> <mml:mi>ξ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(71)</label></disp-formula>
where <italic>ξ</italic>(<italic>t</italic>) = lim<sub>Δ<italic>t</italic>→0</sub> Δ<italic>W</italic>(<italic>t</italic>)/Δ<italic>t</italic> is a Gaussian white noise with correlation function 〈<italic>ξ</italic>(<italic>t</italic>)<italic>ξ</italic>(<italic>t</italic>′)〉 = <italic>δ</italic>(<italic>t</italic> − <italic>t</italic>′). This Gaussian approximation has the advantage that the multiplicative character of the noise in <xref ref-type="disp-formula" rid="pcbi.1005507.e451">Eq (71)</xref> becomes explicit because <italic>ξ</italic>(<italic>t</italic>) is independent of the state of the system. It also explicitly reveals that the finite-size fluctuations scale like <inline-formula id="pcbi.1005507.e452"><alternatives><graphic id="pcbi.1005507.e452g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e452" xlink:type="simple"/><mml:math display="inline" id="M452"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msqrt><mml:mi>N</mml:mi></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>. We stress again that <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) is not a white-noise process with time-dependent mean, as <xref ref-type="disp-formula" rid="pcbi.1005507.e451">Eq (71)</xref> might suggest at first glance, but it is a sum of two mutually correlated processes, (i) a white-noise term proportional to <italic>ξ</italic>(<italic>t</italic>) that reflects the fact that the population activity is a <italic>δ</italic>-spike train and (ii) a colored “noise” <inline-formula id="pcbi.1005507.e453"><alternatives><graphic id="pcbi.1005507.e453g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e453" xlink:type="simple"/><mml:math display="inline" id="M453"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> that arises from the filtering of <italic>ξ</italic>(<italic>t</italic>) through the dynamics in <xref ref-type="disp-formula" rid="pcbi.1005507.e436">Eq (65)</xref>. As a result, the auto-correlation function of <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) contains a <italic>δ</italic>-peak and a continuous part, consistent with previous theoretical findings [<xref ref-type="bibr" rid="pcbi.1005507.ref055">55</xref>]. In particular, at short lags the auto-correlation function may be negative as a result of refractoriness: in this case, <italic>ξ</italic> and <inline-formula id="pcbi.1005507.e454"><alternatives><graphic id="pcbi.1005507.e454g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e454" xlink:type="simple"/><mml:math display="inline" id="M454"><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are anti-correlated in line with the intuitive picture discussed in the R<sc>esults</sc> section, <xref ref-type="fig" rid="pcbi.1005507.g002">Fig 2</xref>, that a positive fluctuation <italic>ξ</italic>(<italic>t</italic>) is associated with the creation of a “hole” in the distribution of last spike times leading to a reduced activity after time <italic>t</italic>. In the frequency domain, refractoriness corresponds to a trough in the power spectrum at low frequencies [<xref ref-type="bibr" rid="pcbi.1005507.ref094">94</xref>] as visible, for instance, in <xref ref-type="fig" rid="pcbi.1005507.g003">Fig 3</xref>. These considerations clearly highlight the non-white character of the finite-size fluctuations in our theory.</p>
</sec>
<sec id="sec032">
<title>Several populations</title>
<p>It is straightforward to generalize the population equations to several populations by adding a population label <italic>α</italic> = 1, …, <italic>M</italic>. For the sake of completeness, we explicitly state the full set of equations. The activity of population <italic>α</italic> is given by
<disp-formula id="pcbi.1005507.e455"><alternatives><graphic id="pcbi.1005507.e455g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e455" xlink:type="simple"/><mml:math display="block" id="M455"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msup><mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msup></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:munder> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mtext>pop</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(72)</label></disp-formula>
where <inline-formula id="pcbi.1005507.e456"><alternatives><graphic id="pcbi.1005507.e456g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e456" xlink:type="simple"/><mml:math display="inline" id="M456"><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mtext>pop</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mi>α</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is a point process with conditional intensity <inline-formula id="pcbi.1005507.e457"><alternatives><graphic id="pcbi.1005507.e457g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e457" xlink:type="simple"/><mml:math display="inline" id="M457"><mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mtext>pop</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:msup><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Here, the expected activity <inline-formula id="pcbi.1005507.e458"><alternatives><graphic id="pcbi.1005507.e458g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e458" xlink:type="simple"/><mml:math display="inline" id="M458"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> depends explicitly on the history <inline-formula id="pcbi.1005507.e459"><alternatives><graphic id="pcbi.1005507.e459g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e459" xlink:type="simple"/><mml:math display="inline" id="M459"><mml:mrow><mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>β</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> by the following set of equations
<disp-formula id="pcbi.1005507.e460"><alternatives><graphic id="pcbi.1005507.e460g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e460" xlink:type="simple"/><mml:math display="block" id="M460"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msup><mml:mo>λ</mml:mo> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>S</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:msup><mml:mo>Λ</mml:mo> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msup><mml:mi>S</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(73)</label></disp-formula>
<disp-formula id="pcbi.1005507.e461"><alternatives><graphic id="pcbi.1005507.e461g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e461" xlink:type="simple"/><mml:math display="block" id="M461"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mo>λ</mml:mo> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mi>c</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mtext> </mml:mtext><mml:mo form="prefix">exp</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:msup><mml:mi>u</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mi>ϑ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:msubsup><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:mfrac></mml:mfenced> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:msup><mml:mo>Λ</mml:mo> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msup><mml:mo>λ</mml:mo> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>v</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msup><mml:mi>v</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(74)</label></disp-formula>
<disp-formula id="pcbi.1005507.e462"><alternatives><graphic id="pcbi.1005507.e462g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e462" xlink:type="simple"/><mml:math display="block" id="M462"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msup><mml:mi>S</mml:mi> <mml:mi>α</mml:mi></mml:msup></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>S</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:msup><mml:mi>S</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(75)</label></disp-formula>
<disp-formula id="pcbi.1005507.e463"><alternatives><graphic id="pcbi.1005507.e463g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e463" xlink:type="simple"/><mml:math display="block" id="M463"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mi>α</mml:mi></mml:msup></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:msup><mml:mo>λ</mml:mo> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>v</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>S</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:msup><mml:mi>v</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(76)</label></disp-formula>
<disp-formula id="pcbi.1005507.e464"><alternatives><graphic id="pcbi.1005507.e464g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e464" xlink:type="simple"/><mml:math display="block" id="M464"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msup><mml:mi>u</mml:mi> <mml:mi>α</mml:mi></mml:msup></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mi>u</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mo>-</mml:mo> <mml:msup><mml:mi>μ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext> <mml:mi>α</mml:mi></mml:msubsup></mml:mfrac> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>β</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:msup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:msup><mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mo>*</mml:mo> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:msup><mml:mi>u</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>r</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(77)</label></disp-formula>
<disp-formula id="pcbi.1005507.e465"><alternatives><graphic id="pcbi.1005507.e465g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e465" xlink:type="simple"/><mml:math display="block" id="M465"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>ϑ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>th</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:msup><mml:mi>θ</mml:mi> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:msubsup> <mml:msup><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(78)</label></disp-formula>
For each population, the system of Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e460">73</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1005507.e465">78</xref>) contains a family of ordinary differential equations for the variables <italic>S</italic>, <italic>u</italic> and <italic>v</italic> parametrized by the continuous parameter <inline-formula id="pcbi.1005507.e466"><alternatives><graphic id="pcbi.1005507.e466g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e466" xlink:type="simple"/><mml:math display="inline" id="M466"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> with <inline-formula id="pcbi.1005507.e467"><alternatives><graphic id="pcbi.1005507.e467g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e467" xlink:type="simple"/><mml:math display="inline" id="M467"><mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, and five integrals over this parameter. In the next section, we show that the family of ordinary differential equations is equivalent to three first-order partial differential equations. Furthermore, in Sec. “Population equations for a finite history”, we reduce the infinite integrals to integrals over a finite range, which will be useful for the numerical implementation of the population equations.</p>
</sec>
<sec id="sec033">
<title>Refractory density representation</title>
<p>There is an equivalent formulation of the population equation in terms of first-order partial differential equations for the density of ages <inline-formula id="pcbi.1005507.e468"><alternatives><graphic id="pcbi.1005507.e468g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e468" xlink:type="simple"/><mml:math display="inline" id="M468"><mml:mrow><mml:mi>τ</mml:mi> <mml:mo>=</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1005507.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref068">68</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref088">88</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref089">89</xref>]. The representation in terms of age <italic>τ</italic> as a state variable is useful because it parallels the Fokker-Planck formalism for the membrane potential density [<xref ref-type="bibr" rid="pcbi.1005507.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref036">36</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref058">58</xref>–<xref ref-type="bibr" rid="pcbi.1005507.ref060">60</xref>] or related density equations [<xref ref-type="bibr" rid="pcbi.1005507.ref117">117</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref118">118</xref>], in which the state variable is the membrane potential of a neuron. To keep the notation simple we consider in the following population <italic>α</italic> but drop the index <italic>α</italic> wherever confusion is not possible. Thus, we write e.g. <italic>S</italic> for <italic>S</italic><sup><italic>α</italic></sup> and <italic>A</italic><sub><italic>N</italic></sub> for <inline-formula id="pcbi.1005507.e469"><alternatives><graphic id="pcbi.1005507.e469g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e469" xlink:type="simple"/><mml:math display="inline" id="M469"><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>α</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> but we keep the index <italic>β</italic> as well as double indices <italic>αβ</italic> occurring in <xref ref-type="disp-formula" rid="pcbi.1005507.e464">Eq (77)</xref>.</p>
<p>The density of ages at time <italic>t</italic> is defined as <italic>q</italic>(<italic>t</italic>, <italic>τ</italic>) = <italic>S</italic>(<italic>t</italic>|<italic>t</italic> − <italic>τ</italic>)<italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic> − <italic>τ</italic>). We recall that because of finite-size fluctuations, <italic>q</italic> is not a normalized probability density. Furthermore, we regard the functions λ, <italic>u</italic> and <italic>v</italic> as functions of <italic>t</italic> and <italic>τ</italic>. With these definitions the population equation, <xref ref-type="disp-formula" rid="pcbi.1005507.e436">Eq (65)</xref>, can be rewritten as
<disp-formula id="pcbi.1005507.e470"><alternatives><graphic id="pcbi.1005507.e470g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e470" xlink:type="simple"/><mml:math display="block" id="M470"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>τ</mml:mi> <mml:mo>+</mml:mo> <mml:mo>Λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>τ</mml:mi></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(79)</label></disp-formula>
The stochastic activity <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) then follows from Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e159">14</xref>) or (<xref ref-type="disp-formula" rid="pcbi.1005507.e167">15</xref>). <xref ref-type="disp-formula" rid="pcbi.1005507.e470">Eq (79)</xref> yields the expected population rate at time <italic>t</italic> for a given density of ages. In the Fokker-Planck formalism, this would correspond to the calculation of the rate from the membrane potential density as the probability flux across the threshold.</p>
<p>Noting that <inline-formula id="pcbi.1005507.e471"><alternatives><graphic id="pcbi.1005507.e471g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e471" xlink:type="simple"/><mml:math display="inline" id="M471"><mml:mrow><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>∂</mml:mi> <mml:mi>τ</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, we find from <xref ref-type="disp-formula" rid="pcbi.1005507.e440">Eq (67)</xref> the following first-order partial differential equation for the density of ages <italic>q</italic>(<italic>t</italic>, <italic>τ</italic>):
<disp-formula id="pcbi.1005507.e472"><alternatives><graphic id="pcbi.1005507.e472g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e472" xlink:type="simple"/><mml:math display="block" id="M472"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>∂</mml:mi> <mml:mi>τ</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>q</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>q</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(80)</label></disp-formula>
Similarly, <italic>u</italic> and <italic>v</italic> obey from Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e464">77</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e463">76</xref>), respectively,
<disp-formula id="pcbi.1005507.e473"><alternatives><graphic id="pcbi.1005507.e473g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e473" xlink:type="simple"/><mml:math display="block" id="M473"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>∂</mml:mi> <mml:mi>τ</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mi>μ</mml:mi></mml:mrow> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext></mml:msub></mml:mfrac> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>β</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:msup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:msup><mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mo>*</mml:mo> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(81)</label></disp-formula>
<disp-formula id="pcbi.1005507.e474"><alternatives><graphic id="pcbi.1005507.e474g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e474" xlink:type="simple"/><mml:math display="block" id="M474"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>∂</mml:mi> <mml:mi>τ</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>[</mml:mo> <mml:mn>2</mml:mn> <mml:mi>v</mml:mi> <mml:mo>-</mml:mo> <mml:mi>q</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(82)</label></disp-formula>
with boundary conditions <italic>u</italic>(<italic>t</italic>, 0) = <italic>u</italic><sub>r</sub> and <italic>v</italic>(<italic>t</italic>, 0) = 0. These functions, together with the threshold dynamics
<disp-formula id="pcbi.1005507.e475"><alternatives><graphic id="pcbi.1005507.e475g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e475" xlink:type="simple"/><mml:math display="block" id="M475"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ϑ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>th</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>τ</mml:mi></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>τ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>τ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:msup><mml:mi>τ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(83)</label></disp-formula>
determine λ(<italic>t</italic>, <italic>τ</italic>) and Λ(<italic>t</italic>) via <xref ref-type="disp-formula" rid="pcbi.1005507.e461">Eq (74)</xref>, i.e.
<disp-formula id="pcbi.1005507.e476"><alternatives><graphic id="pcbi.1005507.e476g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e476" xlink:type="simple"/><mml:math display="block" id="M476"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>c</mml:mi> <mml:mtext> </mml:mtext><mml:mo form="prefix">exp</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>u</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>-</mml:mo> <mml:mi>ϑ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi></mml:msub></mml:mfrac></mml:mfenced> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mo>Λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>τ</mml:mi></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>τ</mml:mi></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(84)</label></disp-formula>
The Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e462">75</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1005507.e464">77</xref>) of the previous section can be regarded as the characteristic equations corresponding to the partial differential Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e472">80</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1005507.e474">82</xref>) (“method of characteristics”).</p>
</sec>
<sec id="sec034">
<title>Population equations for a finite history</title>
<p>To simulate the population activity forward in time, the integrals in <xref ref-type="disp-formula" rid="pcbi.1005507.e436">Eq (65)</xref> over the past need to be evaluated, starting at <inline-formula id="pcbi.1005507.e477"><alternatives><graphic id="pcbi.1005507.e477g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e477" xlink:type="simple"/><mml:math display="inline" id="M477"><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. For biological systems, however, it is sufficient to limit the integrals to a finite history of length <italic>T</italic>. This history corresponds to the range <inline-formula id="pcbi.1005507.e478"><alternatives><graphic id="pcbi.1005507.e478g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e478" xlink:type="simple"/><mml:math display="inline" id="M478"><mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi> <mml:mo>≤</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, where we have to explicitly account for the dependence of the conditional firing rate <inline-formula id="pcbi.1005507.e479"><alternatives><graphic id="pcbi.1005507.e479g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e479" xlink:type="simple"/><mml:math display="inline" id="M479"><mml:mrow><mml:mo>λ</mml:mo> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> on the last spike time <inline-formula id="pcbi.1005507.e480"><alternatives><graphic id="pcbi.1005507.e480g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e480" xlink:type="simple"/><mml:math display="inline" id="M480"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. We will call neurons with last spike time in this range “refractory” because they still experience some degree of (relative) refractoriness caused by the last spike. The remaining part of the integral corresponding to the range <inline-formula id="pcbi.1005507.e481"><alternatives><graphic id="pcbi.1005507.e481g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e481" xlink:type="simple"/><mml:math display="inline" id="M481"><mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> receives a separate, compact evaluation. We will refer to neurons with their last spike time in this range as “free” because their conditional intensity is free of the influence of the last spike.</p>
<p>How should we choose the length of the explicit history <italic>T</italic>? First of all, this length can be different for different populations and is mainly determined by the time scale of refractoriness, i.e. the time it needs to forget the individual effect of a single spike in the past. Furthermore, it depends on the properties of the spike-triggered kernel, i.e. the dynamic threshold that is responsible for adaptation. More precisely, we determine the length of the history by the following conditions: first, the conditional intensity is insensitive to the precise timing of the last spike at <inline-formula id="pcbi.1005507.e482"><alternatives><graphic id="pcbi.1005507.e482g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e482" xlink:type="simple"/><mml:math display="inline" id="M482"><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> if
<disp-formula id="pcbi.1005507.e483"><alternatives><graphic id="pcbi.1005507.e483g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e483" xlink:type="simple"/><mml:math display="block" id="M483"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>T</mml:mi> <mml:mo>≫</mml:mo> <mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>rel</mml:mtext></mml:msub> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(85)</label></disp-formula>
Here, <italic>t</italic><sub>ref</sub> is the absolute refractory period and <italic>τ</italic><sub>rel</sub> is the time scale of the relative refractory period. For the GIF model <italic>τ</italic><sub>rel</sub> = <italic>τ</italic><sub>m</sub>. Second, we demand that <italic>T</italic> is chosen such that for <italic>t</italic> &gt; <italic>T</italic>, the quasi-renewal kernel <inline-formula id="pcbi.1005507.e484"><alternatives><graphic id="pcbi.1005507.e484g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e484" xlink:type="simple"/><mml:math display="inline" id="M484"><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi></mml:msub> <mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> can be well approximated by the original spike-triggered kernel <italic>θ</italic>(<italic>t</italic>). Taylor expansion of the exponential yields the condition
<disp-formula id="pcbi.1005507.e485"><alternatives><graphic id="pcbi.1005507.e485g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e485" xlink:type="simple"/><mml:math display="block" id="M485"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≪</mml:mo> <mml:msub><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mo>∀</mml:mo> <mml:mi>t</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mi>T</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(86)</label></disp-formula>
The length of the history <italic>T</italic> needs to be chosen such that both conditions, Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e483">85</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e485">86</xref>) are fulfilled. It is important to note that condition <xref ref-type="disp-formula" rid="pcbi.1005507.e485">Eq (86)</xref> does not require the time window <italic>T</italic> to be larger than the largest time scale of the spike-triggered kernel. For instance, consider the kernel <inline-formula id="pcbi.1005507.e486"><alternatives><graphic id="pcbi.1005507.e486g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e486" xlink:type="simple"/><mml:math display="inline" id="M486"><mml:mrow><mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>J</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>J</italic><sub><italic>θ</italic></sub> and <italic>τ</italic><sub><italic>θ</italic></sub> are adaptation strength and time scale, respectively. In particular, the adaptation strength <italic>J</italic><sub><italic>θ</italic></sub> sets the reduction in firing rate compared to a non-adapting neuron in the limit of strong drive irrespective of the time scale <italic>τ</italic><sub><italic>θ</italic></sub> (see e.g. [<xref ref-type="bibr" rid="pcbi.1005507.ref080">80</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref082">82</xref>]). Condition <xref ref-type="disp-formula" rid="pcbi.1005507.e485">Eq (86)</xref> can be fulfilled for a given <italic>T</italic> if either <italic>τ</italic><sub><italic>θ</italic></sub> is small enough such that the exponential <inline-formula id="pcbi.1005507.e487"><alternatives><graphic id="pcbi.1005507.e487g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e487" xlink:type="simple"/><mml:math display="inline" id="M487"><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> is small, or, for a fixed adaptation strength <italic>J</italic><sub><italic>θ</italic></sub>, by increasing the adaptation time scale <italic>τ</italic><sub><italic>θ</italic></sub> such that <italic>J</italic><sub><italic>θ</italic></sub>/<italic>τ</italic><sub><italic>θ</italic></sub> ≪ Δ<sub><italic>u</italic></sub>.</p>
<sec id="sec035">
<title>Dynamic threshold of refractory and free neurons</title>
<p>For free neurons, i.e. for <inline-formula id="pcbi.1005507.e488"><alternatives><graphic id="pcbi.1005507.e488g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e488" xlink:type="simple"/><mml:math display="inline" id="M488"><mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, we use the average threshold under the assumption that spikes occurred in the range <inline-formula id="pcbi.1005507.e489"><alternatives><graphic id="pcbi.1005507.e489g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e489" xlink:type="simple"/><mml:math display="inline" id="M489"><mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> according to an inhomogeneous Poisson process with rate <inline-formula id="pcbi.1005507.e490"><alternatives><graphic id="pcbi.1005507.e490g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e490" xlink:type="simple"/><mml:math display="inline" id="M490"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. This average is given by [<xref ref-type="bibr" rid="pcbi.1005507.ref063">63</xref>, <xref ref-type="bibr" rid="pcbi.1005507.ref134">134</xref>]
<disp-formula id="pcbi.1005507.e491"><alternatives><graphic id="pcbi.1005507.e491g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e491" xlink:type="simple"/><mml:math display="block" id="M491"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϑ</mml:mi> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>th</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:msubsup> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>≈</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>th</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:msubsup> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(87)</label></disp-formula>
where in the last step we used <xref ref-type="disp-formula" rid="pcbi.1005507.e485">Eq (86)</xref>. We assume that for <italic>t</italic> &gt; <italic>T</italic> the spike-triggered kernel can be sufficiently well approximated by a sum of exponentials
<disp-formula id="pcbi.1005507.e492"><alternatives><graphic id="pcbi.1005507.e492g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e492" xlink:type="simple"/><mml:math display="block" id="M492"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>Θ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:munderover> <mml:mfrac><mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ℓ</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
This allows us to express the threshold for free neurons as
<disp-formula id="pcbi.1005507.e493"><alternatives><graphic id="pcbi.1005507.e493g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e493" xlink:type="simple"/><mml:math display="block" id="M493"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϑ</mml:mi> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>th</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>ℓ</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:munderover> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ℓ</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup> <mml:msub><mml:mi>g</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(88)</label></disp-formula>
where the variables <italic>g</italic><sub>ℓ</sub>(<italic>t</italic>) satisfy the differential equations
<disp-formula id="pcbi.1005507.e494"><alternatives><graphic id="pcbi.1005507.e494g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e494" xlink:type="simple"/><mml:math display="block" id="M494"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ℓ</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(89)</label></disp-formula>
For refractory neurons, i.e. if <inline-formula id="pcbi.1005507.e495"><alternatives><graphic id="pcbi.1005507.e495g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e495" xlink:type="simple"/><mml:math display="inline" id="M495"><mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi> <mml:mo>≤</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, we need to evaluate in the effective threshold, <xref ref-type="disp-formula" rid="pcbi.1005507.e312">Eq (33)</xref>, an integral over the exact quasi-renewal kernel <inline-formula id="pcbi.1005507.e496"><alternatives><graphic id="pcbi.1005507.e496g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e496" xlink:type="simple"/><mml:math display="inline" id="M496"><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Splitting this integral into the free and refractory part yields the threshold of refractory neurons:
<disp-formula id="pcbi.1005507.e497"><alternatives><graphic id="pcbi.1005507.e497g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e497" xlink:type="simple"/><mml:math display="block" id="M497"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ϑ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϑ</mml:mi> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:msubsup> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(90)</label></disp-formula>
We can use the threshold for free and refractory neurons, Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e493">88</xref>), (<xref ref-type="disp-formula" rid="pcbi.1005507.e494">89</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e497">90</xref>), respectively, to obtain the respective conditional intensities:
<disp-formula id="pcbi.1005507.e498"><alternatives><graphic id="pcbi.1005507.e498g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e498" xlink:type="simple"/><mml:math display="block" id="M498"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>f</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mi>h</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>ϑ</mml:mi> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>f</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mi>u</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(91)</label></disp-formula>
where <italic>h</italic>(<italic>t</italic>) is the free membrane potential given by <xref ref-type="disp-formula" rid="pcbi.1005507.e260">Eq (27)</xref>. Let us remind the reader that <italic>h</italic>(<italic>t</italic>) obeys the dynamics <xref ref-type="disp-formula" rid="pcbi.1005507.e238">Eq (23)</xref> but without resetting of the membrane potential after a spike.</p>
</sec>
<sec id="sec036">
<title>Population equations</title>
<p>We now apply the split of the history to the integrals that appear in the population equations, specifically Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e436">65</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e437">66</xref>). By definition, the conditional intensity of free neurons does not depend explicitly on the last spike time <inline-formula id="pcbi.1005507.e499"><alternatives><graphic id="pcbi.1005507.e499g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e499" xlink:type="simple"/><mml:math display="inline" id="M499"><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. That is, <inline-formula id="pcbi.1005507.e500"><alternatives><graphic id="pcbi.1005507.e500g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e500" xlink:type="simple"/><mml:math display="inline" id="M500"><mml:mrow><mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for <inline-formula id="pcbi.1005507.e501"><alternatives><graphic id="pcbi.1005507.e501g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e501" xlink:type="simple"/><mml:math display="inline" id="M501"><mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, where the free hazard rate λ<sub>free</sub>(<italic>t</italic>) is given by <xref ref-type="disp-formula" rid="pcbi.1005507.e498">Eq (91)</xref>. In the free part of the integrals in Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e436">65</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e437">66</xref>), the free hazard rate can be pulled out of the integral, which yields
<disp-formula id="pcbi.1005507.e502"><alternatives><graphic id="pcbi.1005507.e502g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e502" xlink:type="simple"/><mml:math display="block" id="M502"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>N</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mspace width="2.em"/><mml:mo>+</mml:mo> <mml:mo>Λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>N</mml:mi></mml:mfrac></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(92)</label></disp-formula>
<disp-formula id="pcbi.1005507.e503"><alternatives><graphic id="pcbi.1005507.e503g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e503" xlink:type="simple"/><mml:math display="block" id="M503"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Λ</mml:mo> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>z</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mi>N</mml:mi></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:mi>z</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(93)</label></disp-formula>
Here we have introduced the expected number of free neurons <inline-formula id="pcbi.1005507.e504"><alternatives><graphic id="pcbi.1005507.e504g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e504" xlink:type="simple"/><mml:math display="inline" id="M504"><mml:mrow><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:msubsup> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> and the partial integral over the variance function <inline-formula id="pcbi.1005507.e505"><alternatives><graphic id="pcbi.1005507.e505g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e505" xlink:type="simple"/><mml:math display="inline" id="M505"><mml:mrow><mml:mi>z</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:msubsup> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>. Differentiating these new variables and employing Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e432">63</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e442">69</xref>), we find that they obey the differential equations
<disp-formula id="pcbi.1005507.e506"><alternatives><graphic id="pcbi.1005507.e506g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e506" xlink:type="simple"/><mml:math display="block" id="M506"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>x</mml:mi> <mml:mo>+</mml:mo> <mml:mi>N</mml:mi> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(94)</label></disp-formula>
<disp-formula id="pcbi.1005507.e507"><alternatives><graphic id="pcbi.1005507.e507g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e507" xlink:type="simple"/><mml:math display="block" id="M507"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>z</mml:mi></mml:mrow> <mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:msub><mml:mo>λ</mml:mo> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>z</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>x</mml:mi> <mml:mo>+</mml:mo> <mml:mi>N</mml:mi> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(95)</label></disp-formula>
Thus, the integrals no longer run from −∞ to <italic>t</italic> but are now limited to the range [<italic>t</italic> − <italic>T</italic>, <italic>t</italic>). The long tails over the past have been reduced to differential equations.</p>
</sec>
</sec>
<sec id="sec037">
<title>Numerical implementation</title>
<sec id="sec038">
<title>Discretization of time</title>
<p>We discretize the time axis into a grid with step size Δ<italic>t</italic> and grid points
<disp-formula id="pcbi.1005507.e508"><alternatives><graphic id="pcbi.1005507.e508g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e508" xlink:type="simple"/><mml:math display="block" id="M508"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>k</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">Z</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(96)</label></disp-formula>
Because we keep track of a finite history with the oldest last spike time <inline-formula id="pcbi.1005507.e509"><alternatives><graphic id="pcbi.1005507.e509g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e509" xlink:type="simple"/><mml:math display="inline" id="M509"><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, the history consists of a finite number <italic>K</italic> of bins such that <italic>T</italic> = <italic>K</italic>Δ<italic>t</italic>. If the index <italic>k</italic> = <italic>l</italic> corresponds to the current time, the oldest last spike time of the explicit history corresponds to an index <italic>k</italic> = <italic>l</italic> − <italic>K</italic> and the most recent one corresponds to the index <italic>k</italic> = <italic>l</italic> − 1. Note that the numerical implementation requires the absolute refractory period <italic>t</italic><sub>ref</sub> to be at least as large as the integration time step Δ<italic>t</italic> (see below).</p>
<p>To facilitate the notation of the update rules, it is convenient to introduce the following notations:
<disp-formula id="pcbi.1005507.e510"><alternatives><graphic id="pcbi.1005507.e510g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e510" xlink:type="simple"/><mml:math display="block" id="M510"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>≡</mml:mo> <mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(97)</label></disp-formula>
<disp-formula id="pcbi.1005507.e511"><alternatives><graphic id="pcbi.1005507.e511g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e511" xlink:type="simple"/><mml:math display="block" id="M511"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>≡</mml:mo> <mml:mrow><mml:mo>⟨</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mi>v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(98)</label></disp-formula>
<disp-formula id="pcbi.1005507.e512"><alternatives><graphic id="pcbi.1005507.e512g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e512" xlink:type="simple"/><mml:math display="block" id="M512"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>≡</mml:mo> <mml:mi>u</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(99)</label></disp-formula>
<disp-formula id="pcbi.1005507.e513"><alternatives><graphic id="pcbi.1005507.e513g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e513" xlink:type="simple"/><mml:math display="block" id="M513"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>≡</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(100)</label></disp-formula>
In particular, <inline-formula id="pcbi.1005507.e514"><alternatives><graphic id="pcbi.1005507.e514g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e514" xlink:type="simple"/><mml:math display="inline" id="M514"><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <italic>v</italic><sub><italic>k</italic></sub> correspond to the mean and variance of the unconstrained survival numbers, respectively. We also recall that the population index <italic>α</italic> is dropped wherever confusion is not possible, while the index <italic>β</italic> as well as double indices <italic>αβ</italic> will be kept.</p>
</sec>
<sec id="sec039">
<title>Choice of Δ<italic>t</italic></title>
<p>A crucial assumption of the derivation of the population equations in discrete time was that the time step Δ<italic>t</italic> is small enough such that each neuron fires at most one spike per time step. This can be achieved by the condition
<disp-formula id="pcbi.1005507.e515"><alternatives><graphic id="pcbi.1005507.e515g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e515" xlink:type="simple"/><mml:math display="block" id="M515"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(101)</label></disp-formula>
(cf. Sec. “Discretized population density equations”). Clearly, this condition implies that the total number of spikes per time step must be bounded by the number of neurons, i.e. the population activity must obey Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic></sub>) ≤ <italic>N</italic>. The equality sign corresponds to the case that all neurons fire in the same time step. In addition to condition <xref ref-type="disp-formula" rid="pcbi.1005507.e515">Eq (101)</xref>, we also had to require that Δ<italic>t</italic> is not larger than the transmission delay Δ, i.e.
<disp-formula id="pcbi.1005507.e516"><alternatives><graphic id="pcbi.1005507.e516g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e516" xlink:type="simple"/><mml:math display="block" id="M516"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>≤</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(102)</label></disp-formula>
In order to justify the use of the Poisson statistics in the derivation of the population equations, we further assumed that Δ<italic>t</italic> is sufficiently small such that the expected number of spikes per time step, <inline-formula id="pcbi.1005507.e517"><alternatives><graphic id="pcbi.1005507.e517g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e517" xlink:type="simple"/><mml:math display="inline" id="M517"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, is much smaller than <italic>N</italic>, or equivalently <inline-formula id="pcbi.1005507.e518"><alternatives><graphic id="pcbi.1005507.e518g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e518" xlink:type="simple"/><mml:math display="inline" id="M518"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>⪡</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. While this does not pose a problem for the theory, which ultimately concerns with the continuum limit Δ<italic>t</italic> → 0, an efficient numerical integration of the population equations benefits from a time step that is as large as possible and should thus not be limited by such a condition. In particular, we should allow a large fraction of neurons to fire during one time step, either as a result of an external synchronization of many neurons (e.g. by a strong, sudden stimulus) or because of synchronous oscillations emerging from the network dynamics. In this case, a Poisson-distributed spike count Δ<italic>n</italic>(<italic>t</italic>) may exceed the number of neurons <italic>N</italic>. This problem can be remedied by drawing Δ<italic>n</italic>(<italic>t</italic>) from a binomial distribution with mean <inline-formula id="pcbi.1005507.e519"><alternatives><graphic id="pcbi.1005507.e519g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e519" xlink:type="simple"/><mml:math display="inline" id="M519"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and maximal value <italic>N</italic>. For <inline-formula id="pcbi.1005507.e520"><alternatives><graphic id="pcbi.1005507.e520g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e520" xlink:type="simple"/><mml:math display="inline" id="M520"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⪡</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, this binomial distribution agrees with the Poisson distribution used in our theory, whereas at large <inline-formula id="pcbi.1005507.e521"><alternatives><graphic id="pcbi.1005507.e521g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e521" xlink:type="simple"/><mml:math display="inline" id="M521"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> it ensures that the spike count is bounded by the total number of neurons <italic>N</italic>. Although the binomial distribution does not follow strictly from our theory, it is expected to yield a very good approximation even at large <inline-formula id="pcbi.1005507.e522"><alternatives><graphic id="pcbi.1005507.e522g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e522" xlink:type="simple"/><mml:math display="inline" id="M522"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The reason is as follows: A statement analogous to our argument that the sum of Poisson numbers [<xref ref-type="disp-formula" rid="pcbi.1005507.e343">Eq (39)</xref>] yields again a Poisson number [<xref ref-type="disp-formula" rid="pcbi.1005507.e365">Eq (46)</xref>] is, in general, not valid for binomial random numbers if the random numbers (i.e. the firing probabilities <italic>P</italic><sub>λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>) in our model) are very different. However, if neurons are strongly synchronized, and hence <inline-formula id="pcbi.1005507.e523"><alternatives><graphic id="pcbi.1005507.e523g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e523" xlink:type="simple"/><mml:math display="inline" id="M523"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, they fire with a similar probability, which implies indeed a binomial distribution of the spike count Δ<italic>n</italic>(<italic>t</italic>).</p>
<p>Besides Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e515">101</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e516">102</xref>), a third condition concerns the approximation of the integral <inline-formula id="pcbi.1005507.e524"><alternatives><graphic id="pcbi.1005507.e524g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e524" xlink:type="simple"/><mml:math display="inline" id="M524"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mi>t</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msubsup> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1005507.e338">Eq (37)</xref> by <inline-formula id="pcbi.1005507.e525"><alternatives><graphic id="pcbi.1005507.e525g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e525" xlink:type="simple"/><mml:math display="inline" id="M525"><mml:mrow><mml:mover accent="true"><mml:mo>λ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> (trapezoidal rule). This approximation is valid if the membrane potential <italic>u</italic> and threshold <italic>ϑ</italic> do not vary too strongly during a time step. More precisely, the absolute error of the trapezoidal rule is known to be Δ<italic>t</italic><sup>3</sup>|λ′′|/12, which we require to be much smaller than λΔ<italic>t</italic>. Thus, the relative error is of order Δ<italic>t</italic><sup>2</sup>. Using the definition of λ, <xref ref-type="disp-formula" rid="pcbi.1005507.e247">Eq (25)</xref>, this leads to the condition
<disp-formula id="pcbi.1005507.e526"><alternatives><graphic id="pcbi.1005507.e526g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e526" xlink:type="simple"/><mml:math display="block" id="M526"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>u</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>ϑ</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mfenced> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi></mml:msub> <mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:msup><mml:mi>∂</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mi>u</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mi>∂</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mi>ϑ</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mfenced></mml:mfenced> <mml:mo>Δ</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>≪</mml:mo> <mml:mn>12</mml:mn> <mml:msubsup><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(103)</label></disp-formula>
In summary, Δ<italic>t</italic> should be chosen such that all three conditions, Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e515">101</xref>)–(<xref ref-type="disp-formula" rid="pcbi.1005507.e526">103</xref>) are satisfied for all populations.</p>
</sec>
<sec id="sec040">
<title>Update of the membrane potential</title>
<p>To compute the firing probabilities, we need to update both the membrane potential and the threshold. In the presence of an exponential synaptic filter <inline-formula id="pcbi.1005507.e527"><alternatives><graphic id="pcbi.1005507.e527g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e527" xlink:type="simple"/><mml:math display="inline" id="M527"><mml:mrow><mml:msup><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>Θ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>s</mml:mtext> <mml:mi>β</mml:mi></mml:msubsup></mml:mrow></mml:msup> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>s</mml:mtext> <mml:mi>β</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, the membrane potential of free neurons <italic>u</italic>(<italic>t</italic>) = <italic>h</italic>(<italic>t</italic>) in population <italic>α</italic> obeys the differential equation
<disp-formula id="pcbi.1005507.e528"><alternatives><graphic id="pcbi.1005507.e528g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e528" xlink:type="simple"/><mml:math display="block" id="M528"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext></mml:msub> <mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>h</mml:mi></mml:mrow> <mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>h</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>rest</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:mi>R</mml:mi> <mml:msub><mml:mi>I</mml:mi> <mml:mtext>ext</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext></mml:msub> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>β</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:msup><mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msup> <mml:msup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:msup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(104)</label></disp-formula>
<disp-formula id="pcbi.1005507.e529"><alternatives><graphic id="pcbi.1005507.e529g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e529" xlink:type="simple"/><mml:math display="block" id="M529"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>s</mml:mtext> <mml:mi>β</mml:mi></mml:msubsup> <mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:msup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup></mml:mrow> <mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="right"><mml:mrow><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>β</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>M</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(105)</label></disp-formula>
Assuming that the external stimulus <italic>I</italic><sub>ext</sub>(<italic>t</italic>) and the population activity <italic>A</italic><sub><italic>N</italic></sub>(<italic>t</italic>) are constant during one time step, the solution over one time step is given by
<disp-formula id="pcbi.1005507.e530"><alternatives><graphic id="pcbi.1005507.e530g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e530" xlink:type="simple"/><mml:math display="block" id="M530"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>h</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>rest</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mi>h</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>rest</mml:mtext></mml:msub></mml:mfenced> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext></mml:msub></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mtext>tot</mml:mtext></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(106)</label></disp-formula>
<disp-formula id="pcbi.1005507.e531"><alternatives><graphic id="pcbi.1005507.e531g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e531" xlink:type="simple"/><mml:math display="block" id="M531"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:msup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>s</mml:mtext> <mml:mi>β</mml:mi></mml:msubsup></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>β</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>M</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(107)</label></disp-formula>
where <italic>h</italic><sub>tot</sub> is the total input of population <italic>α</italic> given by
<disp-formula id="pcbi.1005507.e532"><alternatives><graphic id="pcbi.1005507.e532g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e532" xlink:type="simple"/><mml:math display="block" id="M532"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>h</mml:mi> <mml:mtext>tot</mml:mtext></mml:msub></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mi>R</mml:mi> <mml:msub><mml:mi>I</mml:mi> <mml:mtext>ext</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:mfenced> <mml:mo>+</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext></mml:msub> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>β</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msup><mml:mi>p</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:msup><mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msup> <mml:msup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mfenced close="" open="{" separators=""><mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mphantom><mml:mpadded width="0pt"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>s</mml:mtext> <mml:mi>β</mml:mi></mml:msubsup> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>s</mml:mtext> <mml:mi>β</mml:mi></mml:msubsup></mml:mfrac></mml:mrow></mml:msup> <mml:mfenced close="]" open="[" separators=""><mml:msup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow> <mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>s</mml:mtext> <mml:mi>β</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext></mml:msub></mml:mrow></mml:mfrac></mml:mpadded></mml:mphantom></mml:mfenced></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo> <mml:mfenced close="}" open="" separators=""><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>s</mml:mtext> <mml:mi>β</mml:mi></mml:msubsup> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>s</mml:mtext> <mml:mi>β</mml:mi></mml:msubsup></mml:mfrac></mml:mrow></mml:msup> <mml:mfenced close="]" open="[" separators=""><mml:msup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>-</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext></mml:msub></mml:mfrac></mml:mrow></mml:msup> <mml:mfenced close="]" open="[" separators=""><mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>s</mml:mtext> <mml:mi>β</mml:mi></mml:msubsup> <mml:msup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>β</mml:mi></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext></mml:msub> <mml:msubsup><mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>β</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow> <mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mtext>s</mml:mtext> <mml:mi>β</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(108)</label></disp-formula>
For refractory neurons, we obtain the membran potential in the GLM model by the simple formula <italic>u</italic><sub><italic>k</italic></sub>(<italic>t</italic><sub><italic>l</italic>+1</sub>) = <italic>h</italic>(<italic>t</italic><sub><italic>l</italic>+1</sub>) + <italic>η</italic>(<italic>t</italic><sub><italic>l</italic>+1</sub> − <italic>t</italic><sub><italic>k</italic></sub>). For the GIF model, the same update rule as for <italic>h</italic>(<italic>t</italic>), <xref ref-type="disp-formula" rid="pcbi.1005507.e530">Eq (106)</xref>, can be applied for <italic>k</italic> = <italic>l</italic> − <italic>K</italic>, …, <italic>l</italic> − <italic>k</italic><sub>ref</sub>:
<disp-formula id="pcbi.1005507.e533"><alternatives><graphic id="pcbi.1005507.e533g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e533" xlink:type="simple"/><mml:math display="block" id="M533"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>rest</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>u</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>rest</mml:mtext></mml:msub></mml:mfenced> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext></mml:msub></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mtext>tot</mml:mtext></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(109)</label></disp-formula>
For the absolute refractory period, <italic>l</italic> − <italic>k</italic><sub>ref</sub> &lt; <italic>k</italic> &lt; <italic>l</italic>, the membrane potential remains at <italic>u</italic><sub><italic>k</italic></sub>(<italic>t</italic><sub><italic>l</italic>+1</sub>) = <italic>u</italic><sub>r</sub>. Note that the total integrated input <italic>h</italic><sub>tot</sub> needs to be computed only once per time step.</p>
</sec>
<sec id="sec041">
<title>Update of the threshold</title>
<p>Let us first discuss, how to compute the threshold at time <italic>t</italic><sub><italic>l</italic></sub> given the values of <italic>g</italic><sub>ℓ</sub>(<italic>t</italic><sub><italic>l</italic></sub>) and Δ<italic>n</italic>(<italic>t</italic><sub><italic>k</italic></sub>) for <italic>k</italic> = <italic>l</italic> − <italic>K</italic>, …, <italic>l</italic> − 1. For free neurons, the threshold <italic>ϑ</italic><sub>free</sub>(<italic>t</italic><sub><italic>l</italic></sub>) is given by <xref ref-type="disp-formula" rid="pcbi.1005507.e493">Eq (88)</xref> evaluated at time <italic>t</italic> = <italic>t</italic><sub><italic>l</italic></sub>. For refractory neurons, we find from <xref ref-type="disp-formula" rid="pcbi.1005507.e497">Eq (90)</xref> that the threshold can be written in the discretized form
<disp-formula id="pcbi.1005507.e534"><alternatives><graphic id="pcbi.1005507.e534g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e534" xlink:type="simple"/><mml:math display="block" id="M534"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϑ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϑ</mml:mi> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi></mml:mrow> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:msup><mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:msup><mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(110)</label></disp-formula> <italic>k</italic> = <italic>l</italic> − <italic>K</italic>, …, <italic>l</italic> − <italic>k</italic><sub>ref</sub>. <xref ref-type="disp-formula" rid="pcbi.1005507.e534">Eq (110)</xref> can be rewritten as
<disp-formula id="pcbi.1005507.e535"><alternatives><graphic id="pcbi.1005507.e535g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e535" xlink:type="simple"/><mml:math display="block" id="M535"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϑ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ϑ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>θ</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(111)</label></disp-formula>
where the variables <inline-formula id="pcbi.1005507.e536"><alternatives><graphic id="pcbi.1005507.e536g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e536" xlink:type="simple"/><mml:math display="inline" id="M536"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϑ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> can be calculated iteratively starting at <italic>k</italic> = <italic>l</italic> − <italic>K</italic>:
<disp-formula id="pcbi.1005507.e537"><alternatives><graphic id="pcbi.1005507.e537g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e537" xlink:type="simple"/><mml:math display="block" id="M537"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϑ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ϑ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mfenced> <mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(112)</label></disp-formula>
with initial condition <inline-formula id="pcbi.1005507.e538"><alternatives><graphic id="pcbi.1005507.e538g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e538" xlink:type="simple"/><mml:math display="inline" id="M538"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϑ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϑ</mml:mi> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Thus, at each time step <italic>t</italic><sub><italic>l</italic></sub>, the threshold can be rapidly evaluated in one sweep via Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e493">88</xref>), (<xref ref-type="disp-formula" rid="pcbi.1005507.e535">111</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e537">112</xref>).</p>
<p>For the computation of the firing probabilities below, it is necessary to compute the threshold one time step ahead, i.e. at time <italic>t</italic><sub><italic>l</italic>+1</sub>. To this end, we first update the variables <italic>g</italic><sub>ℓ</sub> according to <xref ref-type="disp-formula" rid="pcbi.1005507.e494">Eq (89)</xref>:
<disp-formula id="pcbi.1005507.e539"><alternatives><graphic id="pcbi.1005507.e539g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e539" xlink:type="simple"/><mml:math display="block" id="M539"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>ℓ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mfenced close=")" open="(" separators=""><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(113)</label></disp-formula>
This yields the threshold <italic>ϑ</italic><sub>free</sub>(<italic>t</italic><sub><italic>l</italic>+1</sub>) of free neurons via the formula <xref ref-type="disp-formula" rid="pcbi.1005507.e493">Eq (88)</xref>. For refractory neurons we find from Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e535">111</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e537">112</xref>)
<disp-formula id="pcbi.1005507.e540"><alternatives><graphic id="pcbi.1005507.e540g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e540" xlink:type="simple"/><mml:math display="block" id="M540"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϑ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ϑ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>θ</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(114)</label></disp-formula>
where <inline-formula id="pcbi.1005507.e541"><alternatives><graphic id="pcbi.1005507.e541g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e541" xlink:type="simple"/><mml:math display="inline" id="M541"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϑ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> can be iterated by
<disp-formula id="pcbi.1005507.e542"><alternatives><graphic id="pcbi.1005507.e542g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e542" xlink:type="simple"/><mml:math display="block" id="M542"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϑ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ϑ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mfenced> <mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(115)</label></disp-formula>
with initial condition
<disp-formula id="pcbi.1005507.e543"><alternatives><graphic id="pcbi.1005507.e543g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e543" xlink:type="simple"/><mml:math display="block" id="M543"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϑ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϑ</mml:mi> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:msub></mml:mfenced> <mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(116)</label></disp-formula></p>
</sec>
<sec id="sec042">
<title>Firing probabilities</title>
<p>The firing probabilities for free and refractory neurons are given by
<disp-formula id="pcbi.1005507.e544"><alternatives><graphic id="pcbi.1005507.e544g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e544" xlink:type="simple"/><mml:math display="block" id="M544"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mo>λ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mo>λ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(117)</label></disp-formula>
respectively. Here,
<disp-formula id="pcbi.1005507.e545"><alternatives><graphic id="pcbi.1005507.e545g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e545" xlink:type="simple"/><mml:math display="block" id="M545"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo>λ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(118)</label></disp-formula>
<disp-formula id="pcbi.1005507.e546"><alternatives><graphic id="pcbi.1005507.e546g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e546" xlink:type="simple"/><mml:math display="block" id="M546"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mo>λ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(119)</label></disp-formula>
are the arithmetic mean of the respective intensities at the beginning and end of the time interval (cf. <xref ref-type="disp-formula" rid="pcbi.1005507.e338">Eq (37)</xref>). The free intensity λ<sub>free</sub>(<italic>t</italic>) is given by <xref ref-type="disp-formula" rid="pcbi.1005507.e498">Eq (91)</xref>. For refractory neurons, the conditional intensities are given by
<disp-formula id="pcbi.1005507.e547"><alternatives><graphic id="pcbi.1005507.e547g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e547" xlink:type="simple"/><mml:math display="block" id="M547"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>f</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>u</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>ϑ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(120)</label></disp-formula>
where the last case corresponds to the absolute refractory period.</p>
</sec>
<sec id="sec043">
<title>Population dynamics</title>
<p>We can directly use the discretized form of the population equations given by Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e414">58</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e416">59</xref>). As in <xref ref-type="disp-formula" rid="pcbi.1005507.e502">Eq (92)</xref> the infinite sums in <xref ref-type="disp-formula" rid="pcbi.1005507.e416">Eq (59)</xref> can be split into an explicit, finite history of length <italic>K</italic> and a remaining part corresponding to <italic>k</italic> &lt; <italic>l</italic> − <italic>K</italic>. This results in
<disp-formula id="pcbi.1005507.e548"><alternatives><graphic id="pcbi.1005507.e548g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e548" xlink:type="simple"/><mml:math display="block" id="M548"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>+</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mo>Λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mfenced close=")" open="(" separators=""><mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(121)</label></disp-formula>
where
<disp-formula id="pcbi.1005507.e549"><alternatives><graphic id="pcbi.1005507.e549g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e549" xlink:type="simple"/><mml:math display="block" id="M549"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mo>Λ</mml:mo></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mo>λ</mml:mo></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mtext>free</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(122)</label></disp-formula>
is the firing probability of “neurons” belonging to the “holes and overshoots” <italic>δm</italic><sub><italic>l</italic>,<italic>k</italic></sub> (cf. R<sc>esults</sc>, Sec. “Mesoscopic population equations”). The variables <italic>x</italic> and <italic>z</italic> have the discrete time definition
<disp-formula id="pcbi.1005507.e550"><alternatives><graphic id="pcbi.1005507.e550g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e550" xlink:type="simple"/><mml:math display="block" id="M550"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mi>z</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msub><mml:mi>v</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(123)</label></disp-formula>
corresponding to a discretization of their integral definition above. Having calculated the expected spike count <inline-formula id="pcbi.1005507.e551"><alternatives><graphic id="pcbi.1005507.e551g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e551" xlink:type="simple"/><mml:math display="inline" id="M551"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, the actual spike count Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic></sub>) is obtained by drawing a binomially distributed random number
<disp-formula id="pcbi.1005507.e552"><alternatives><graphic id="pcbi.1005507.e552g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e552" xlink:type="simple"/><mml:math display="block" id="M552"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:mi>B</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mi>N</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mi>N</mml:mi></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(124)</label></disp-formula>
as discussed above. In <xref ref-type="disp-formula" rid="pcbi.1005507.e552">Eq (124)</xref>, <italic>B</italic>(<italic>N</italic>, <italic>p</italic><sub><italic>B</italic></sub>) denotes the binomial distribution corresponding to <italic>N</italic> Bernoulli trials with success probability <italic>p</italic><sub><italic>B</italic></sub>.</p>
<p>The discrete evolution equations for <inline-formula id="pcbi.1005507.e553"><alternatives><graphic id="pcbi.1005507.e553g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e553" xlink:type="simple"/><mml:math display="inline" id="M553"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <italic>v</italic><sub><italic>k</italic></sub>(<italic>t</italic><sub><italic>l</italic></sub>) are given by Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e374">48</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e386">51</xref>), respectively, which we repeat here for convenience:
<disp-formula id="pcbi.1005507.e554"><alternatives><graphic id="pcbi.1005507.e554g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e554" xlink:type="simple"/><mml:math display="block" id="M554"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(125)</label></disp-formula>
<disp-formula id="pcbi.1005507.e555"><alternatives><graphic id="pcbi.1005507.e555g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e555" xlink:type="simple"/><mml:math display="block" id="M555"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:msub><mml:mi>v</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(126)</label></disp-formula>
To find the update rule for <italic>x</italic>, we use the definition <xref ref-type="disp-formula" rid="pcbi.1005507.e550">Eq (123)</xref> and the update rule for <inline-formula id="pcbi.1005507.e556"><alternatives><graphic id="pcbi.1005507.e556g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e556" xlink:type="simple"/><mml:math display="inline" id="M556"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <xref ref-type="disp-formula" rid="pcbi.1005507.e554">Eq (125)</xref>:
<disp-formula id="pcbi.1005507.e557"><alternatives><graphic id="pcbi.1005507.e557g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e557" xlink:type="simple"/><mml:math display="block" id="M557"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:munderover> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:munderover> <mml:mrow><mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(127)</label></disp-formula>
Here, we have exploited that <italic>P</italic><sub>λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>) = <italic>P</italic><sub>free</sub>(<italic>t</italic><sub><italic>l</italic></sub>) for <italic>k</italic> &lt; <italic>l</italic> − <italic>K</italic>. Using again <xref ref-type="disp-formula" rid="pcbi.1005507.e554">Eq (125)</xref> we find
<disp-formula id="pcbi.1005507.e558"><alternatives><graphic id="pcbi.1005507.e558g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e558" xlink:type="simple"/><mml:math display="block" id="M558"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(128)</label></disp-formula>
This equation is the discrete analog of the continuous-time <xref ref-type="disp-formula" rid="pcbi.1005507.e506">Eq (94)</xref>. Note that <inline-formula id="pcbi.1005507.e559"><alternatives><graphic id="pcbi.1005507.e559g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e559" xlink:type="simple"/><mml:math display="inline" id="M559"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is given by <xref ref-type="disp-formula" rid="pcbi.1005507.e554">Eq (125)</xref>.</p>
<p>An update rule for <italic>z</italic> can be found from the definition <xref ref-type="disp-formula" rid="pcbi.1005507.e550">Eq (123)</xref> and the update rule for <inline-formula id="pcbi.1005507.e560"><alternatives><graphic id="pcbi.1005507.e560g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e560" xlink:type="simple"/><mml:math display="inline" id="M560"><mml:mrow><mml:mo>〈</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>m</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>〉</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <xref ref-type="disp-formula" rid="pcbi.1005507.e555">Eq (126)</xref>. A similar calculation that led to <xref ref-type="disp-formula" rid="pcbi.1005507.e558">Eq (128)</xref> results in
<disp-formula id="pcbi.1005507.e561"><alternatives><graphic id="pcbi.1005507.e561g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e561" xlink:type="simple"/><mml:math display="block" id="M561"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>z</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mi>z</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mtext>free</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(129)</label></disp-formula>
This equation is the discrete analog of the continuous-time <xref ref-type="disp-formula" rid="pcbi.1005507.e507">Eq (95)</xref>. Note that <italic>v</italic><sub><italic>l</italic>−<italic>K</italic></sub>(<italic>t</italic><sub><italic>l</italic>+1</sub>) is given by <xref ref-type="disp-formula" rid="pcbi.1005507.e555">Eq (126)</xref>.</p>
<p>Finally, the initial conditions can be accounted for by setting
<disp-formula id="pcbi.1005507.e562"><alternatives><graphic id="pcbi.1005507.e562g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e562" xlink:type="simple"/><mml:math display="block" id="M562"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>l</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:msub><mml:mi>v</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:msub><mml:mi>u</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>r</mml:mtext></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(130)</label></disp-formula>
The last update step corresponding to the reset of the membrane potential only needs to be performed for the GIF model.</p>
</sec>
<sec id="sec044">
<title>Initialization and storage of history</title>
<p>One simple way to initialize the system is to fully synchronize the network at time −Δ<italic>t</italic> such that at time <italic>t</italic><sub>0</sub> = 0 all neurons are refractory. This gives rise to the sharp initial condition <inline-formula id="pcbi.1005507.e563"><alternatives><graphic id="pcbi.1005507.e563g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e563" xlink:type="simple"/><mml:math display="inline" id="M563"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <italic>v</italic><sub><italic>k</italic></sub>(0) = <italic>u</italic><sub><italic>k</italic></sub>(0) = 0 for the refractory epoch (<italic>k</italic> = −<italic>K</italic>, …, −1). Here, <italic>δ</italic><sub><italic>k</italic>,<italic>l</italic></sub> denotes the Kronecker delta, which is unity for <italic>k</italic> = <italic>l</italic> and zero otherwise. After synchronization there are no free neurons, hence <italic>x</italic>(<italic>t</italic><sub>0</sub>) = <italic>z</italic>(<italic>t</italic><sub>0</sub>) = 0 and, if there were no further spikes in the past, <italic>g</italic><sub>ℓ</sub>(<italic>t</italic><sub>0</sub>) = 0 for ℓ = 1, …, <italic>N</italic><sub><italic>θ</italic></sub>. The initialization of <italic>g</italic><sub>ℓ</sub> corresponds to a zero adaptation level at the beginning of the simulation.</p>
<p>For the representation of the variables <inline-formula id="pcbi.1005507.e564"><alternatives><graphic id="pcbi.1005507.e564g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e564" xlink:type="simple"/><mml:math display="inline" id="M564"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <italic>v</italic><sub><italic>k</italic></sub>(<italic>t</italic><sub><italic>l</italic></sub>), <italic>u</italic><sub><italic>k</italic></sub>(<italic>t</italic><sub><italic>l</italic></sub>) and λ<sub><italic>k</italic></sub>(<italic>t</italic><sub><italic>l</italic></sub>), <italic>k</italic> = <italic>l</italic> − <italic>K</italic>, …, <italic>l</italic> − 1, in memory, it is convenient to employ circular buffers. That is, the “running” range of the explicit history <italic>k</italic> = <italic>l</italic> − <italic>K</italic>, …, <italic>l</italic> − 1 is mapped to a static range <inline-formula id="pcbi.1005507.e565"><alternatives><graphic id="pcbi.1005507.e565g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e565" xlink:type="simple"/><mml:math display="inline" id="M565"><mml:mrow><mml:mover accent="true"><mml:mi>k</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> in memory by applying the modulo operation
<disp-formula id="pcbi.1005507.e566"><alternatives><graphic id="pcbi.1005507.e566g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e566" xlink:type="simple"/><mml:math display="block" id="M566"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>k</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mspace width="4.pt"/><mml:mtext>mod</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>K</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(131)</label></disp-formula>
to all temporal indices.</p>
</sec>
<sec id="sec045">
<title>Summary of the update step and pseudocode</title>
<p>Let us summarize the steps needed to evolve the population equation from time <italic>t</italic><sub><italic>l</italic></sub> to time <italic>t</italic><sub><italic>l</italic>+1</sub>:</p>
<list list-type="order">
<list-item>
<p>Calculate the total integrated input <italic>h</italic><sub>tot</sub> using <xref ref-type="disp-formula" rid="pcbi.1005507.e532">Eq (108)</xref> and then update the synaptic variables <italic>y</italic><sup><italic>αβ</italic></sup>(<italic>t</italic><sub><italic>l</italic>+1</sub>) according to <xref ref-type="disp-formula" rid="pcbi.1005507.e531">Eq (107)</xref>.</p>
</list-item>
<list-item>
<p>Update the free membrane potential <italic>h</italic>(<italic>t</italic><sub><italic>l</italic>+1</sub>) and threshold variable <italic>g</italic><sub>ℓ</sub>(<italic>t</italic><sub><italic>l</italic>+1</sub>) for free neurons using Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e530">106</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e539">113</xref>) and use these values to compute the threshold <italic>ϑ</italic><sub>free</sub>(<italic>t</italic><sub><italic>l</italic>+1</sub>) and conditional intensity λ<sub>free</sub>(<italic>t</italic><sub><italic>l</italic>+1</sub>) of free neurons by means of Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e493">88</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e498">91</xref>). This yields the firing probability of free neurons <italic>P</italic><sub>free</sub>(<italic>t</italic><sub><italic>l</italic></sub>) via Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e544">117</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e545">118</xref>).</p>
</list-item>
<list-item>
<p>For all refractory states <italic>k</italic> = <italic>l</italic> − <italic>K</italic>, …, <italic>l</italic> − <italic>k</italic><sub>ref</sub>, compute the membrane potential <italic>u</italic><sub><italic>k</italic></sub>(<italic>t</italic><sub><italic>l</italic>+1</sub>) from <xref ref-type="disp-formula" rid="pcbi.1005507.e533">Eq (109)</xref>, the threshold <italic>ϑ</italic><sub><italic>k</italic></sub>(<italic>t</italic><sub><italic>l</italic>+1</sub>) from <xref ref-type="disp-formula" rid="pcbi.1005507.e542">Eq (115)</xref> and the conditional intensity λ<sub><italic>k</italic></sub>(<italic>t</italic><sub><italic>l</italic>+1</sub>) from <xref ref-type="disp-formula" rid="pcbi.1005507.e547">Eq (120)</xref>. The firing probabilities <italic>P</italic><sub>λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>|<italic>t</italic><sub><italic>k</italic></sub>) are then given by Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e544">117</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e546">119</xref>).</p>
</list-item>
<list-item>
<p>Calculate the effective firing probability <italic>P</italic><sub>Λ</sub>(<italic>t</italic><sub><italic>l</italic></sub>) from <xref ref-type="disp-formula" rid="pcbi.1005507.e549">Eq (122)</xref>.</p>
</list-item>
<list-item>
<p>Calculate the expected activity <inline-formula id="pcbi.1005507.e567"><alternatives><graphic id="pcbi.1005507.e567g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e567" xlink:type="simple"/><mml:math display="inline" id="M567"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>n</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> by <xref ref-type="disp-formula" rid="pcbi.1005507.e548">Eq (121)</xref>. The empirical population activity Δ<italic>n</italic>(<italic>t</italic><sub><italic>l</italic></sub>) can be obtained by drawing a binomially distributed random number according to <xref ref-type="disp-formula" rid="pcbi.1005507.e552">Eq (124)</xref>.</p>
</list-item>
<list-item>
<p>Update the mean and variance of the survival numbers <inline-formula id="pcbi.1005507.e568"><alternatives><graphic id="pcbi.1005507.e568g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e568" xlink:type="simple"/><mml:math display="inline" id="M568"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <italic>v</italic><sub><italic>k</italic></sub>(<italic>t</italic><sub><italic>l</italic>+1</sub>), <italic>x</italic>(<italic>t</italic><sub><italic>l</italic>+1</sub>) and <italic>z</italic>(<italic>t</italic><sub><italic>l</italic>+1</sub>) using Eqs (<xref ref-type="disp-formula" rid="pcbi.1005507.e554">125</xref>), (<xref ref-type="disp-formula" rid="pcbi.1005507.e555">126</xref>), (<xref ref-type="disp-formula" rid="pcbi.1005507.e558">128</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005507.e561">129</xref>).</p>
</list-item>
<list-item>
<p>Realize the boundary conditions at <inline-formula id="pcbi.1005507.e569"><alternatives><graphic id="pcbi.1005507.e569g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e569" xlink:type="simple"/><mml:math display="inline" id="M569"><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> according to <xref ref-type="disp-formula" rid="pcbi.1005507.e562">Eq (130)</xref>.</p>
</list-item>
</list>
<p>These steps have to be performed for all populations <italic>α</italic> = 1, …, <italic>M</italic>. A detailed implementation of the algorithm is provided by the pseudocode shown in Figs <xref ref-type="fig" rid="pcbi.1005507.g011">11</xref> and <xref ref-type="fig" rid="pcbi.1005507.g012">12</xref>.</p>
<fig id="pcbi.1005507.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005507.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Pseudocode for the integration of the mesoscopic population equation.</title>
<p>Note that procedure <monospace>UpdatePopulation</monospace> in line 12 is shown in <xref ref-type="fig" rid="pcbi.1005507.g012">Fig 12</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005507.g011" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005507.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005507.g012</object-id>
<label>Fig 12</label>
<caption>
<title>Pseudocode for the update of the variables of a given population.</title>
<p>Note that the adaptation kernel <italic>θ</italic><sub><italic>k</italic>′</sub> ≡ <italic>θ</italic>((<italic>K</italic> − <italic>k</italic>′)Δ<italic>t</italic>), the quasi-renewal kernel <inline-formula id="pcbi.1005507.e570"><alternatives><graphic id="pcbi.1005507.e570g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e570" xlink:type="simple"/><mml:math display="inline" id="M570"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:msup><mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>≡</mml:mo> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>(</mml:mo> <mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, <xref ref-type="disp-formula" rid="pcbi.1005507.e312">Eq (33)</xref>, as well as the exponentials <inline-formula id="pcbi.1005507.e571"><alternatives><graphic id="pcbi.1005507.e571g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e571" xlink:type="simple"/><mml:math display="inline" id="M571"><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext></mml:msub></mml:mfrac></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005507.e572"><alternatives><graphic id="pcbi.1005507.e572g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e572" xlink:type="simple"/><mml:math display="inline" id="M572"><mml:mrow><mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ℓ</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>K</mml:mi> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> can be precomputed.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005507.g012" xlink:type="simple"/>
</fig>
<p>Whereas the complexity of the microscopic simulation is of order <italic>O</italic>(<italic>N</italic>Δ<italic>t</italic><sup>−1</sup>), the integration of the population equation is of order <italic>O</italic>(Δ<italic>t</italic><sup>−2</sup>) because in each time step one has to update a history of length <italic>K</italic> = <italic>T</italic>/Δ<italic>t</italic> (step 3, 4 and 6). Hence, at low neuron numbers (e.g. <italic>N</italic> &lt; 100), the direct simulation of the microscopic system may become more efficient. We emphasize, however, that to achieve a comparable accuracy, the integration of the mesoscopic population equation can be performed on a coarser, millisecond time scale (e.g., Δ<italic>t</italic> = 1 ms), whereas the microscopic simulation requires precise spike times and hence a sub-millisecond simulation (e.g., Δ<italic>t</italic> = 0.1 ms). If we take advantage of this fact, the mesoscopic population model performs well even at low neuron numbers.</p>
</sec>
</sec>
<sec id="sec046">
<title>Power spectrum</title>
<p>We characterize the fluctuations of the stationary population activity
by the power spectrum defined as
<disp-formula id="pcbi.1005507.e573"><alternatives><graphic id="pcbi.1005507.e573g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e573" xlink:type="simple"/><mml:math display="block" id="M573"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>C</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">lim</mml:mo> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>→</mml:mo> <mml:mi>∞</mml:mi></mml:mrow></mml:munder> <mml:mfrac><mml:mrow><mml:mo>⟨</mml:mo> <mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>;</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mo>|</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(132)</label></disp-formula>
where
<disp-formula id="pcbi.1005507.e574"><alternatives><graphic id="pcbi.1005507.e574g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e574" xlink:type="simple"/><mml:math display="block" id="M574"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>;</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>T</mml:mi></mml:msubsup> <mml:msub><mml:mi>A</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mi>f</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(133)</label></disp-formula>
is the Fourier transform of the population activity on a time window of length <italic>T</italic>.</p>
<p>For a population of renewal neurons the power spectrum is known analytically. It is given by [<xref ref-type="bibr" rid="pcbi.1005507.ref134">134</xref>]
<disp-formula id="pcbi.1005507.e575"><alternatives><graphic id="pcbi.1005507.e575g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e575" xlink:type="simple"/><mml:math display="block" id="M575"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>C</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>r</mml:mi> <mml:mi>N</mml:mi></mml:mfrac> <mml:mfrac><mml:mrow><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>ISI</mml:mtext></mml:msub> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>ISI</mml:mtext></mml:msub> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(134)</label></disp-formula>
where <inline-formula id="pcbi.1005507.e576"><alternatives><graphic id="pcbi.1005507.e576g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e576" xlink:type="simple"/><mml:math display="inline" id="M576"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>ISI</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the Fourier transform of the interspike interval density
<disp-formula id="pcbi.1005507.e577"><alternatives><graphic id="pcbi.1005507.e577g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e577" xlink:type="simple"/><mml:math display="block" id="M577"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mtext>ISI</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>|</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>s</mml:mi></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(135)</label></disp-formula>
and <italic>r</italic> is the stationary firing rate given by
<disp-formula id="pcbi.1005507.e578"><alternatives><graphic id="pcbi.1005507.e578g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e578" xlink:type="simple"/><mml:math display="block" id="M578"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>r</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mfenced close="]" open="[" separators=""><mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>|</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>s</mml:mi></mml:mfenced> <mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>t</mml:mi></mml:mfenced> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(136)</label></disp-formula>
Note that the power of the fluctuations in <xref ref-type="disp-formula" rid="pcbi.1005507.e575">Eq (134)</xref> scales like 1/<italic>N</italic>, vanishing in the macroscopic limit <italic>N</italic> → ∞. For the LIF model with escape noise, the hazard rate λ(<italic>t</italic>|0) is given by
<disp-formula id="pcbi.1005507.e579"><alternatives><graphic id="pcbi.1005507.e579g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e579" xlink:type="simple"/><mml:math display="block" id="M579"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>f</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:mi>u</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>th</mml:mtext></mml:msub></mml:mfenced> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mi>u</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mtext>r</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub></mml:mrow> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext>m</mml:mtext></mml:msub></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(137)</label></disp-formula>
for <italic>t</italic> &gt; <italic>t</italic><sub>ref</sub> and λ(<italic>t</italic>|0) = 0 for <italic>t</italic> ≤ <italic>t</italic><sub>ref</sub>.</p>
</sec>
<sec id="sec047">
<title>Modified Potjans-Diesmann model</title>
<p>To model the cortical column of [<xref ref-type="bibr" rid="pcbi.1005507.ref005">5</xref>] in our framework, we used the parameters of the original publication and modified the model in two ways: First, the background Poisson input was replaced by a constant drive and an increased escape noise such that the populations exhibited roughly the same stationary firing rates. Specifically, we set <italic>u</italic><sub>r</sub> = 0 mV, <italic>u</italic><sub>th</sub> = 15 mV andΔ<sub><italic>u</italic></sub> = 5 mV; and, using the mesoscopic dynamics, fitted the resting potentials of the GIF model (here denoted by <inline-formula id="pcbi.1005507.e580"><alternatives><graphic id="pcbi.1005507.e580g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e580" xlink:type="simple"/><mml:math display="inline" id="M580"><mml:msup><mml:mover accent="true"><mml:mi>μ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msup></mml:math></alternatives></inline-formula>) without adaptation <italic>J</italic><sub><italic>θ</italic></sub> = 0 to obtain firing rates <inline-formula id="pcbi.1005507.e581"><alternatives><graphic id="pcbi.1005507.e581g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e581" xlink:type="simple"/><mml:math display="inline" id="M581"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> that roughly match the target firing rates. Second, we introduced adaptation on excitatory cells with strength <italic>J</italic><sub><italic>θ</italic></sub> and time scale <italic>τ</italic><sub><italic>θ</italic></sub>, and re-adjusted the resting potential as follows <inline-formula id="pcbi.1005507.e582"><alternatives><graphic id="pcbi.1005507.e582g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e582" xlink:type="simple"/><mml:math display="inline" id="M582"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mtext>rest</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>μ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>. This yielded correct stationary firing rates in the presence of adaptation. The resulting parameters of the modified model are summarized in <xref ref-type="table" rid="pcbi.1005507.t002">Table 2</xref>.</p>
<table-wrap id="pcbi.1005507.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005507.t002</object-id>
<label>Table 2</label>
<caption>
<title>Parameters of the modified Potjans-Diesmann model.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005507.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005507.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">population</th>
<th align="left">L2/3e</th>
<th align="left">L2/3i</th>
<th align="left">L4e</th>
<th align="left">L4i</th>
<th align="left">L5e</th>
<th align="left">L5i</th>
<th align="left">L6e</th>
<th align="left">L6i</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><italic>τ</italic><sub>m</sub> [s]</td>
<td align="center" colspan="8">0.01</td>
</tr>
<tr>
<td align="left"><italic>τ</italic><sub>s</sub> [s]</td>
<td align="center" colspan="8">0.0005</td>
</tr>
<tr>
<td align="left">Δ [s]</td>
<td align="center" colspan="8">0.0015</td>
</tr>
<tr>
<td align="left"><italic>t</italic><sub>ref</sub> [s]</td>
<td align="center" colspan="8">0.002</td>
</tr>
<tr>
<td align="left">Δ<sub><italic>u</italic></sub> [mV]</td>
<td align="center" colspan="8">5.0</td>
</tr>
<tr>
<td align="left">
<inline-formula id="pcbi.1005507.e583">
<alternatives>
<graphic id="pcbi.1005507.e583g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e583" xlink:type="simple"/>
<mml:math display="inline" id="M583">
<mml:mover accent="true">
<mml:mi>μ</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
</mml:math>
</alternatives>
</inline-formula> [mV]</td>
<td align="left">19.149</td>
<td align="left">20.362</td>
<td align="left">30.805</td>
<td align="left">28.069</td>
<td align="left">29.437</td>
<td align="left">29.33</td>
<td align="left">34.932</td>
<td align="left">32.081</td>
</tr>
<tr>
<td align="left">
<inline-formula id="pcbi.1005507.e584">
<alternatives>
<graphic id="pcbi.1005507.e584g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e584" xlink:type="simple"/>
<mml:math display="inline" id="M584">
<mml:mover accent="true">
<mml:mi>r</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
</mml:math>
</alternatives>
</inline-formula> [Hz]</td>
<td align="left">0.974</td>
<td align="left">2.861</td>
<td align="left">4.673</td>
<td align="left">5.65</td>
<td align="left">8.141</td>
<td align="left">9.013</td>
<td align="left">0.988</td>
<td align="left">7.53</td>
</tr>
<tr>
<td align="left" colspan="9">adaptation: <inline-formula id="pcbi.1005507.e585"><alternatives><graphic id="pcbi.1005507.e585g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e585" xlink:type="simple"/><mml:math display="inline" id="M585"><mml:mrow><mml:mi>θ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> for <italic>t</italic> &gt; <italic>t</italic><sub>ref</sub></td>
</tr>
<tr>
<td align="left"><italic>J</italic><sub><italic>θ</italic></sub> [mV s]</td>
<td align="left">1.0</td>
<td align="left">0.0</td>
<td align="left">1.0</td>
<td align="left">0.0</td>
<td align="left">1.0</td>
<td align="left">0.0</td>
<td align="left">1.0</td>
<td align="left">0.0</td>
</tr>
<tr>
<td align="left"><italic>τ</italic><sub><italic>θ</italic></sub> [s]</td>
<td align="left">1.0</td>
<td align="left">-</td>
<td align="left">1.0</td>
<td align="left">-</td>
<td align="left">1.0</td>
<td align="left">-</td>
<td align="left">1.0</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left">
<inline-formula id="pcbi.1005507.e586">
<alternatives>
<graphic id="pcbi.1005507.e586g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005507.e586" xlink:type="simple"/>
<mml:math display="inline" id="M586">
<mml:mrow>
<mml:msub>
<mml:mi>u</mml:mi>
<mml:mtext>rest</mml:mtext>
</mml:msub>
<mml:mo>=</mml:mo>
<mml:mover accent="true">
<mml:mi>μ</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
<mml:mo>+</mml:mo>
<mml:msub>
<mml:mi>J</mml:mi>
<mml:mi>θ</mml:mi>
</mml:msub>
<mml:mover accent="true">
<mml:mi>r</mml:mi>
<mml:mo>^</mml:mo>
</mml:mover>
</mml:mrow>
</mml:math>
</alternatives>
</inline-formula> [mV]</td>
<td align="left">20.123</td>
<td align="left">20.362</td>
<td align="left">35.478</td>
<td align="left">28.069</td>
<td align="left">37.578</td>
<td align="left">29.33</td>
<td align="left">35.92</td>
<td align="left">32.081</td>
</tr>
<tr>
<td align="left" colspan="9">step stimulus (“thalamic input”)</td>
</tr>
<tr>
<td align="left"><italic>RI</italic><sub>ext</sub> [mV]</td>
<td align="left">0.</td>
<td align="left">0.</td>
<td align="left">19.</td>
<td align="left">11.964</td>
<td align="left">0.</td>
<td align="left">0.</td>
<td align="left">9.896</td>
<td align="left">3.788</td>
</tr>
<tr>
<td align="left"><italic>μ</italic>(<italic>t</italic>) [mV]</td>
<td align="center" colspan="8"><italic>u</italic><sub>rest</sub> + <italic>RI</italic><sub>ext</sub> for <italic>t</italic> ∈ [0.06<italic>s</italic>, 0.09<italic>s</italic>], else <italic>u</italic><sub>rest</sub></td>
</tr>
<tr>
<td align="left" colspan="9">network parameters</td>
</tr>
<tr>
<td align="left"><italic>N</italic></td>
<td align="left">20683</td>
<td align="left">5834</td>
<td align="left">21915</td>
<td align="left">5479</td>
<td align="left">4850</td>
<td align="left">1065</td>
<td align="left">14395</td>
<td align="left">2948</td>
</tr>
<tr>
<td align="left">connection prob. <italic>p</italic><sup><italic>αβ</italic></sup></td>
<td align="center" colspan="8">from population <italic>β</italic></td>
</tr>
<tr>
<td align="left"><italic>α</italic> = L2/3e</td>
<td align="left">0.1009</td>
<td align="left">0.1689</td>
<td align="left">0.0437</td>
<td align="left">0.0818</td>
<td align="left">0.0323</td>
<td align="left">0.0</td>
<td align="left">0.0076</td>
<td align="left">0.0</td>
</tr>
<tr>
<td align="left"><italic>α</italic> = L2/3i</td>
<td align="left">0.1346</td>
<td align="left">0.1371</td>
<td align="left">0.0316</td>
<td align="left">0.0515</td>
<td align="left">0.0755</td>
<td align="left">0.0</td>
<td align="left">0.0042</td>
<td align="left">0.0</td>
</tr>
<tr>
<td align="left"><italic>α</italic> = L4e</td>
<td align="left">0.0077</td>
<td align="left">0.0059</td>
<td align="left">0.0497</td>
<td align="left">0.135</td>
<td align="left">0.0067</td>
<td align="left">0.0003</td>
<td align="left">0.0453</td>
<td align="left">0.0</td>
</tr>
<tr>
<td align="left"><italic>α</italic> = L4i</td>
<td align="left">0.0691</td>
<td align="left">0.0029</td>
<td align="left">0.0794</td>
<td align="left">0.1597</td>
<td align="left">0.0033</td>
<td align="left">0.0</td>
<td align="left">0.1057</td>
<td align="left">0.0</td>
</tr>
<tr>
<td align="left"><italic>α</italic> = L5e</td>
<td align="left">0.1004</td>
<td align="left">0.0622</td>
<td align="left">0.0505</td>
<td align="left">0.0057</td>
<td align="left">0.0831</td>
<td align="left">0.3726</td>
<td align="left">0.0204</td>
<td align="left">0.0</td>
</tr>
<tr>
<td align="left"><italic>α</italic> = L5i</td>
<td align="left">0.0548</td>
<td align="left">0.0269</td>
<td align="left">0.0257</td>
<td align="left">0.0022</td>
<td align="left">0.06</td>
<td align="left">0.3158</td>
<td align="left">0.0086</td>
<td align="left">0.0</td>
</tr>
<tr>
<td align="left"><italic>α</italic> = L6e</td>
<td align="left">0.0156</td>
<td align="left">0.0066</td>
<td align="left">0.0211</td>
<td align="left">0.0166</td>
<td align="left">0.0572</td>
<td align="left">0.0197</td>
<td align="left">0.0396</td>
<td align="left">0.2252</td>
</tr>
<tr>
<td align="left"><italic>α</italic> = L6i</td>
<td align="left">0.0364</td>
<td align="left">0.001</td>
<td align="left">0.0034</td>
<td align="left">0.0005</td>
<td align="left">0.0277</td>
<td align="left">0.008</td>
<td align="left">0.0658</td>
<td align="left">0.1443</td>
</tr>
<tr>
<td align="left"><italic>w</italic><sup><italic>αβ</italic></sup> [mV], <italic>α</italic> = L4e</td>
<td align="left">0.176</td>
<td align="left">-0.702</td>
<td align="left">0.351</td>
<td align="left">-0.702</td>
<td align="left">0.176</td>
<td align="left">-0.702</td>
<td align="left">0.176</td>
<td align="left">-0.702</td>
</tr>
<tr>
<td align="left"><italic>w</italic><sup><italic>αβ</italic></sup> [mV], <italic>α</italic>≠ L4e</td>
<td align="left">0.176</td>
<td align="left">-0.702</td>
<td align="left">0.176</td>
<td align="left">-0.702</td>
<td align="left">0.176</td>
<td align="left">-0.702</td>
<td align="left">0.176</td>
<td align="left">-0.702</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
</sec>
</body>
<back>
<ack>
<p>We thank Hesam Setareh for useful discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005507.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Toledo-Rodriguez</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gupta</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Silberberg</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Luo</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Anatomical, physiological and molecular properties of Martinotti cells in the somatosensory cortex of the juvenile rat</article-title>. <source>J Physiol</source>. <year>2004</year>;<volume>561</volume>(<issue>1</issue>):<fpage>65</fpage>–<lpage>90</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1113/jphysiol.2004.073353" xlink:type="simple">10.1113/jphysiol.2004.073353</ext-link></comment> <object-id pub-id-type="pmid">15331670</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sugino</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hempel</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Hattox</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Shapiro</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Molecular taxonomy of major neuronal classes in the adult mouse forebrain</article-title>. <source>Nat Neurosci</source>. <year>2006</year>;<volume>9</volume>(<issue>1</issue>):<fpage>99</fpage>–<lpage>107</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1618" xlink:type="simple">10.1038/nn1618</ext-link></comment> <object-id pub-id-type="pmid">16369481</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lefort</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tomm</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sarria</surname> <given-names>JCF</given-names></name>, <name name-style="western"><surname>Petersen</surname> <given-names>CCH</given-names></name>. <article-title>The excitatory neuronal network of the C2 barrel column in mouse primary somatosensory cortex</article-title>. <source>Neuron</source>. <year>2009</year>;<volume>61</volume>(<issue>2</issue>):<fpage>301</fpage>–<lpage>316</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2008.12.020" xlink:type="simple">10.1016/j.neuron.2008.12.020</ext-link></comment> <object-id pub-id-type="pmid">19186171</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Harris</surname> <given-names>KD</given-names></name>, <name name-style="western"><surname>Shepherd</surname> <given-names>GMG</given-names></name>. <article-title>The neocortical circuit: themes and variations</article-title>. <source>Nat Neurosci</source>. <year>2015</year>;<volume>18</volume>(<issue>2</issue>):<fpage>170</fpage>–<lpage>181</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3917" xlink:type="simple">10.1038/nn.3917</ext-link></comment> <object-id pub-id-type="pmid">25622573</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Potjans</surname> <given-names>TC</given-names></name>, <name name-style="western"><surname>Diesmann</surname> <given-names>M</given-names></name>. <article-title>The cell-type specific cortical microcircuit: relating structure and activity in a full-scale spiking network model</article-title>. <source>Cereb Cortex</source>. <year>2014</year>;<volume>24</volume>(<issue>3</issue>):<fpage>785</fpage>–<lpage>806</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/cercor/bhs358" xlink:type="simple">10.1093/cercor/bhs358</ext-link></comment> <object-id pub-id-type="pmid">23203991</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Muller</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Ramaswamy</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Reimann</surname> <given-names>MW</given-names></name>, <name name-style="western"><surname>Abdellah</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sanchez</surname> <given-names>CA</given-names></name>, <etal>et al</etal>. <article-title>Reconstruction and simulation of neocortical microcircuitry</article-title>. <source>Cell</source>. <year>2015</year>;<volume>163</volume>(<issue>2</issue>):<fpage>456</fpage>–<lpage>492</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2015.09.029" xlink:type="simple">10.1016/j.cell.2015.09.029</ext-link></comment> <object-id pub-id-type="pmid">26451489</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Izhikevich</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Edelman</surname> <given-names>GM</given-names></name>. <article-title>Large-scale model of mammalian thalamocortical systems</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2008</year>;<volume>105</volume>(<issue>9</issue>):<fpage>3593</fpage>–<lpage>3598</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0712231105" xlink:type="simple">10.1073/pnas.0712231105</ext-link></comment> <object-id pub-id-type="pmid">18292226</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref008">
<label>8</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Freeman</surname> <given-names>WJ</given-names></name>. <source>Mass action in the nervous system</source>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Academic Press</publisher-name>; <year>1975</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005507.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>David</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>. <article-title>A neural mass model for MEG/EEG: coupling and neuronal dynamics</article-title>. <source>Neuroimage</source>. <year>2003</year>;<volume>20</volume>(<issue>3</issue>):<fpage>1743</fpage>–<lpage>1755</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2003.07.015" xlink:type="simple">10.1016/j.neuroimage.2003.07.015</ext-link></comment> <object-id pub-id-type="pmid">14642484</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Moran</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Pinotsis</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>. <article-title>Neural masses and fields in dynamic causal modeling</article-title>. <source>Front Computat Neuroscie</source>. <year>2013</year>;<volume>7</volume>:<fpage>57</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005507.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jirsa</surname> <given-names>VK</given-names></name>, <name name-style="western"><surname>Haken</surname> <given-names>H</given-names></name>. <article-title>A derivation of a macroscopic field theory of the brain from the quasi-microscopic neural dynamics</article-title>. <source>Physica D</source>. <year>1997</year>;<volume>99</volume>(<issue>4</issue>):<fpage>503</fpage>–<lpage>526</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0167-2789(96)00166-2" xlink:type="simple">10.1016/S0167-2789(96)00166-2</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Coombes</surname> <given-names>S</given-names></name>. <article-title>Large-scale neural dynamics: simple and complex</article-title>. <source>NeuroImage</source>. <year>2010</year>;<volume>52</volume>(<issue>3</issue>):<fpage>731</fpage>–<lpage>739</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2010.01.045" xlink:type="simple">10.1016/j.neuroimage.2010.01.045</ext-link></comment> <object-id pub-id-type="pmid">20096791</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bojak</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Oostendorp</surname> <given-names>TF</given-names></name>, <name name-style="western"><surname>Reid</surname> <given-names>AT</given-names></name>, <name name-style="western"><surname>Kötter</surname> <given-names>R</given-names></name>. <article-title>Connecting mean field models of neural activity to EEG and fMRI data</article-title>. <source>Brain Topogr</source>. <year>2010</year>;<volume>23</volume>(<issue>2</issue>):<fpage>139</fpage>–<lpage>149</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10548-010-0140-3" xlink:type="simple">10.1007/s10548-010-0140-3</ext-link></comment> <object-id pub-id-type="pmid">20364434</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref014">
<label>14</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Kistler</surname> <given-names>WM</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>. <source>Neuronal Dynamics: From Single Neurons to Networks and Models of Cognition</source>. <publisher-loc>Cambridge</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>; <year>2014</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005507.ref015">
<label>15</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Abbott</surname> <given-names>LF</given-names></name>. <source>Theoretical Neuroscience: Computational and Mathematical Modeling of Neural Systems</source>. <edition>1st ed</edition>. <publisher-name>The MIT Press</publisher-name>; <year>2005</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005507.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilson</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Cowan</surname> <given-names>JD</given-names></name>. <article-title>Excitatory and inhibitory interactions in localized populations of model neurons</article-title>. <source>Biophys J</source>. <year>1972</year>;<volume>12</volume>(<issue>1</issue>):<fpage>1</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(72)86068-5" xlink:type="simple">10.1016/S0006-3495(72)86068-5</ext-link></comment> <object-id pub-id-type="pmid">4332108</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Harrison</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Penny</surname> <given-names>W</given-names></name>. <article-title>Dynamic causal modelling</article-title>. <source>Neuroimage</source>. <year>2003</year>;<volume>19</volume>(<issue>4</issue>):<fpage>1273</fpage>–<lpage>1302</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S1053-8119(03)00202-7" xlink:type="simple">10.1016/S1053-8119(03)00202-7</ext-link></comment> <object-id pub-id-type="pmid">12948688</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deco</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Jirsa</surname> <given-names>VK</given-names></name>, <name name-style="western"><surname>McIntosh</surname> <given-names>AR</given-names></name>. <article-title>Emerging concepts for the dynamical organization of resting-state activity in the brain</article-title>. <source>Nat Rev Neurosci</source>. <year>2011</year>;<volume>12</volume>(<issue>1</issue>):<fpage>43</fpage>–<lpage>56</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn2961" xlink:type="simple">10.1038/nrn2961</ext-link></comment> <object-id pub-id-type="pmid">21170073</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>van Hemmen</surname> <given-names>JL</given-names></name>. <article-title>Universality in neural networks: the importance of the’mean firing rate’</article-title>. <source>Biol Cybern</source>. <year>1992</year>;<volume>67</volume>(<issue>3</issue>):<fpage>195</fpage>–<lpage>205</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF00204392" xlink:type="simple">10.1007/BF00204392</ext-link></comment> <object-id pub-id-type="pmid">1498186</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>XJ</given-names></name>. <article-title>Effects of Neuromodulation in a Cortical Network Model of Object Working Memory Dominated by Recurrent Inhibition</article-title>. <source>J Comput Neurosci</source>. <year>2001</year>;<volume>11</volume>:<fpage>63</fpage>–<lpage>85</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1023/A:1011204814320" xlink:type="simple">10.1023/A:1011204814320</ext-link></comment> <object-id pub-id-type="pmid">11524578</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deco</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Rolls</surname> <given-names>ET</given-names></name>. <article-title>Neurodynamics of Biased Competition and Cooperation for Attention: A Model With Spiking Neurons</article-title>. <source>J Neurophysiol</source>. <year>2005</year>;<volume>94</volume>:<fpage>295</fpage>–<lpage>313</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.01095.2004" xlink:type="simple">10.1152/jn.01095.2004</ext-link></comment> <object-id pub-id-type="pmid">15703227</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deco</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Jirsa</surname> <given-names>VK</given-names></name>, <name name-style="western"><surname>Robinson</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Breakspear</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>. <article-title>The dynamic brain: from spiking neurons to neural masses and cortical fields</article-title>. <source>PLoS Comput Biol</source>. <year>2008</year>;<volume>4</volume>(<issue>8</issue>):<fpage>e1000092</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000092" xlink:type="simple">10.1371/journal.pcbi.1000092</ext-link></comment> <object-id pub-id-type="pmid">18769680</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Population Dynamics of Spiking Neurons: Fast Transients, Asynchronous States, and Locking</article-title>. <source>Neural Comput</source>. <year>2000</year>;<volume>12</volume>:<fpage>43</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/089976600300015899" xlink:type="simple">10.1162/089976600300015899</ext-link></comment> <object-id pub-id-type="pmid">10636933</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Einevoll</surname> <given-names>GT</given-names></name>, <name name-style="western"><surname>Kayser</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Logothetis</surname> <given-names>NK</given-names></name>, <name name-style="western"><surname>Panzeri</surname> <given-names>S</given-names></name>. <article-title>Modelling and analysis of local field potentials for studying the function of cortical circuits</article-title>. <source>Nat Rev Neurosci</source>. <year>2013</year>;<volume>14</volume>(<issue>11</issue>):<fpage>770</fpage>–<lpage>785</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn3599" xlink:type="simple">10.1038/nrn3599</ext-link></comment> <object-id pub-id-type="pmid">24135696</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>. <article-title>Neuroscience</article-title>. <source>How good are neuron models? Science</source>. <year>2009</year> <month>Oct</month>;<volume>326</volume>(<issue>5951</issue>):<fpage>379</fpage>–<lpage>380</lpage>. <object-id pub-id-type="pmid">19833951</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mensi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Pozzorini</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Avermann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Petersen</surname> <given-names>CCH</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Parameter Extraction and Classification of Three Cortical Neuron Types Reveals Two Distinct Adaptation Mechanisms</article-title>. <source>J Neurophysiol</source>. <year>2012</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00408.2011" xlink:type="simple">10.1152/jn.00408.2011</ext-link></comment> <object-id pub-id-type="pmid">22157113</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pozzorini</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Mensi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hagens</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Automated High-Throughput Characterization of Single Neurons by Means of Simplified Spiking Models</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>6</issue>):<fpage>e1004275</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004275" xlink:type="simple">10.1371/journal.pcbi.1004275</ext-link></comment> <object-id pub-id-type="pmid">26083597</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pozzorini</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Mensi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Temporal whitening by power-law adaptation in neocortical neurons</article-title>. <source>Nat Neurosci</source>. <year>2013</year>;<volume>16</volume>(<issue>7</issue>):<fpage>942</fpage>–<lpage>948</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3431" xlink:type="simple">10.1038/nn.3431</ext-link></comment> <object-id pub-id-type="pmid">23749146</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Boyden</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Bamberg</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Nagel</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Deisseroth</surname> <given-names>K</given-names></name>. <article-title>Millisecond-timescale, genetically targeted optical control of neural activity</article-title>. <source>Nat Neurosci</source>. <year>2005</year>;<volume>8</volume>(<issue>9</issue>):<fpage>1263</fpage>–<lpage>1268</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1525" xlink:type="simple">10.1038/nn1525</ext-link></comment> <object-id pub-id-type="pmid">16116447</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deisseroth</surname> <given-names>K</given-names></name>. <article-title>Optogenetics</article-title>. <source>Nat Methods</source>. <year>2011</year>;<volume>8</volume>(<issue>1</issue>):<fpage>26</fpage>–<lpage>29</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.f.324" xlink:type="simple">10.1038/nmeth.f.324</ext-link></comment> <object-id pub-id-type="pmid">21191368</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Ramirez</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Pang</surname> <given-names>PT</given-names></name>, <name name-style="western"><surname>Puryear</surname> <given-names>CB</given-names></name>, <name name-style="western"><surname>Govindarajan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Deisseroth</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Optogenetic stimulation of a hippocampal engram activates fear memory recall</article-title>. <source>Nature</source>. <year>2012</year>;<volume>484</volume>(<issue>7394</issue>):<fpage>381</fpage>–<lpage>385</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11028" xlink:type="simple">10.1038/nature11028</ext-link></comment> <object-id pub-id-type="pmid">22441246</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Moreno-Bote</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rinzel</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>N</given-names></name>. <article-title>Noise-induced alternations in an attractor network model of perceptual bistability</article-title>. <source>J Neurophysiol</source>. <year>2007</year>;<volume>98</volume>(<issue>3</issue>):<fpage>1125</fpage>–<lpage>1139</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00116.2007" xlink:type="simple">10.1152/jn.00116.2007</ext-link></comment> <object-id pub-id-type="pmid">17615138</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shpiro</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Moreno-Bote</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Rinzel</surname> <given-names>J</given-names></name>. <article-title>Balance between noise and adaptation in competition models of perceptual bistability</article-title>. <source>J Comput Neurosci</source>. <year>2009</year>;<volume>27</volume>(<issue>1</issue>):<fpage>37</fpage>–<lpage>54</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10827-008-0125-3" xlink:type="simple">10.1007/s10827-008-0125-3</ext-link></comment> <object-id pub-id-type="pmid">19125318</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Theodoni</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kovács</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Greenlee</surname> <given-names>MW</given-names></name>, <name name-style="western"><surname>Deco</surname> <given-names>G</given-names></name>. <article-title>Neuronal adaptation effects in decision making</article-title>. <source>J Neurosci</source>. <year>2011</year>;<volume>31</volume>(<issue>1</issue>):<fpage>234</fpage>–<lpage>246</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.2757-10.2011" xlink:type="simple">10.1523/JNEUROSCI.2757-10.2011</ext-link></comment> <object-id pub-id-type="pmid">21209209</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>E</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>J</given-names></name>. <article-title>Multiscale modeling</article-title>. <source>Scholarpedia</source>. <year>2011</year>;<volume>6</volume>(<issue>10</issue>):<fpage>11527</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4249/scholarpedia.11527" xlink:type="simple">10.4249/scholarpedia.11527</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nykamp</surname> <given-names>DQ</given-names></name>, <name name-style="western"><surname>Tranchina</surname> <given-names>D</given-names></name>. <article-title>A population density approach that facilitates large-scale modeling of neural networks: Analysis and an application to orientation tuning</article-title>. <source>J Comput Neurosci</source>. <year>2000</year>;<volume>8</volume>(<issue>1</issue>):<fpage>19</fpage>–<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1023/A:1008912914816" xlink:type="simple">10.1023/A:1008912914816</ext-link></comment> <object-id pub-id-type="pmid">10798498</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Muller</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Buesing</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Schemmel</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Meier</surname> <given-names>K</given-names></name>. <article-title>Spike-Frequency Adapting Neural Ensembles: Beyond Mean Adaptation and Renewal Theories</article-title>. <source>Neural Comp</source>. <year>2007</year>;<volume>19</volume>(<issue>11</issue>):<fpage>2958</fpage>–<lpage>3110</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.2007.19.11.2958" xlink:type="simple">10.1162/neco.2007.19.11.2958</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Baladron</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Fasoli</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Faugeras</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Touboul</surname> <given-names>J</given-names></name>. <article-title>Mean-field description and propagation of chaos in networks of Hodgkin-Huxley and FitzHugh-Nagumo neurons</article-title>. <source>J Math Neurosci</source>. <year>2012</year>;<volume>2</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/2190-8567-2-10" xlink:type="simple">10.1186/2190-8567-2-10</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bressloff</surname> <given-names>PC</given-names></name>. <article-title>Stochastic neural field theory and the system-size expansion</article-title>. <source>SIAM J Appl Math</source>. <year>2009</year>;<volume>70</volume>(<issue>5</issue>):<fpage>1488</fpage>–<lpage>1521</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/090756971" xlink:type="simple">10.1137/090756971</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buice</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Cowan</surname> <given-names>JD</given-names></name>. <article-title>Field-theoretic approach to fluctuation effects in neural networks</article-title>. <source>Phys Rev E</source>. <year>2007</year>;<volume>75</volume>(<issue>5</issue>):<fpage>051919</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.75.051919" xlink:type="simple">10.1103/PhysRevE.75.051919</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buice</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Cowan</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Chow</surname> <given-names>CC</given-names></name>. <article-title>Systematic fluctuation expansion for neural network activity equations</article-title>. <source>Neural Comput</source>. <year>2010</year>;<volume>22</volume>(<issue>2</issue>):<fpage>377</fpage>–<lpage>426</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.2009.02-09-960" xlink:type="simple">10.1162/neco.2009.02-09-960</ext-link></comment> <object-id pub-id-type="pmid">19852585</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bressloff</surname> <given-names>PC</given-names></name>. <article-title>Metastable states and quasicycles in a stochastic Wilson-Cowan model of neuronal population dynamics</article-title>. <source>Phys Rev E</source>. <year>2010</year>;<volume>82</volume>(<issue>5</issue>):<fpage>051903</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.82.051903" xlink:type="simple">10.1103/PhysRevE.82.051903</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wallace</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Benayoun</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Van Drongelen</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Cowan</surname> <given-names>JD</given-names></name>. <article-title>Emergent oscillations in networks of stochastic spiking neurons</article-title>. <source>Plos one</source>. <year>2011</year>;<volume>6</volume>(<issue>5</issue>):<fpage>e14804</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0014804" xlink:type="simple">10.1371/journal.pone.0014804</ext-link></comment> <object-id pub-id-type="pmid">21573105</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Touboul</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Ermentrout</surname> <given-names>GB</given-names></name>. <article-title>Finite-size and correlation-induced effects in mean-field dynamics</article-title>. <source>J Comput Neurosci</source>. <year>2011</year>;<volume>31</volume>(<issue>3</issue>):<fpage>453</fpage>–<lpage>484</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10827-011-0320-5" xlink:type="simple">10.1007/s10827-011-0320-5</ext-link></comment> <object-id pub-id-type="pmid">21384156</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Goychuk</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Goychuk</surname> <given-names>A</given-names></name>. <article-title>Stochastic Wilson–Cowan models of neuronal network dynamics with memory and delay</article-title>. <source>New J Phys</source>. <year>2015</year>;<volume>17</volume>(<issue>4</issue>):<fpage>045029</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1367-2630/17/4/045029" xlink:type="simple">10.1088/1367-2630/17/4/045029</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Berry</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Meister</surname> <given-names>M</given-names></name>. <article-title>Refractoriness and neural precision</article-title>. <source>J Neurosci</source>. <year>1998</year>;<volume>18</volume>(<issue>6</issue>):<fpage>2200</fpage>–<lpage>2211</lpage>. <object-id pub-id-type="pmid">9482804</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Geisler</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Goldberg</surname> <given-names>JM</given-names></name>. <article-title>A Stochastic Model of the Repetitive Activity of Neurons</article-title>. <source>Biophys J</source>. <year>1966</year>;<volume>6</volume>(<issue>1</issue>):<fpage>53</fpage>–<lpage>69</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(66)86639-0" xlink:type="simple">10.1016/S0006-3495(66)86639-0</ext-link></comment> <object-id pub-id-type="pmid">19431343</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ratnam</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>ME</given-names></name>. <article-title>Nonrenewal Statistics of Electrosensory Afferent Spike Trains: Implications for the Detection of Weak Sensory Signals</article-title>. <source>J Neurosci</source>. <year>2000</year>;<volume>20</volume>:<fpage>6672</fpage>. <object-id pub-id-type="pmid">10964972</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chacron</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Longtin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>St-Hilaire</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Maler</surname> <given-names>L</given-names></name>. <article-title>Suprathreshold stochastic firing dynamics with memory in P-type electroreceptors</article-title>. <source>Phys Rev Lett</source>. <year>2000</year>;<volume>85</volume>:<fpage>1576</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.85.1576" xlink:type="simple">10.1103/PhysRevLett.85.1576</ext-link></comment> <object-id pub-id-type="pmid">10970558</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nawrot</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Boucsein</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rodriguez-Molina</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Aertsen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Grun</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>. <article-title>Serial interval statistics of spontaneous activity in cortical neurons in vivo and in vitro</article-title>. <source>Neurocomp</source>. <year>2007</year>;<volume>70</volume>:<fpage>1717</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neucom.2006.10.101" xlink:type="simple">10.1016/j.neucom.2006.10.101</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fisch</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Schwalger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Lindner</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Herz</surname> <given-names>AVM</given-names></name>, <name name-style="western"><surname>Benda</surname> <given-names>J</given-names></name>. <article-title>Channel noise from both slow adaptation currents and fast currents is required to explain spike-response variability in a sensory neuron</article-title>. <source>J Neurosci</source>. <year>2012</year>;<volume>32</volume>(<issue>48</issue>):<fpage>17332</fpage>–<lpage>17344</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.6231-11.2012" xlink:type="simple">10.1523/JNEUROSCI.6231-11.2012</ext-link></comment> <object-id pub-id-type="pmid">23197724</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lindner</surname> <given-names>B</given-names></name>. <article-title>Superposition of many independent spike trains is generally not a Poisson process</article-title>. <source>Phys Rev E</source>. <year>2006</year>;<volume>73</volume>:<fpage>022901</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.73.022901" xlink:type="simple">10.1103/PhysRevE.73.022901</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Câteau</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Reyes</surname> <given-names>AD</given-names></name>. <article-title>Relation between Single Neuron and Population Spiking Statistics and Effects on Network Activity</article-title>. <source>Phys Rev Lett</source>. <year>2006</year>;<volume>96</volume>:<fpage>058101</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.96.058101" xlink:type="simple">10.1103/PhysRevLett.96.058101</ext-link></comment> <object-id pub-id-type="pmid">16486995</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deger</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Helias</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Boucsein</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>. <article-title>Statistical properties of superimposed stationary spike trains</article-title>. <source>J Comput Neurosci</source>. <year>2012</year>;<volume>32</volume>:<fpage>443</fpage>–<lpage>463</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10827-011-0362-8" xlink:type="simple">10.1007/s10827-011-0362-8</ext-link></comment> <object-id pub-id-type="pmid">21964584</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deger</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Schwalger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Fluctuations and information filtering in coupled populations of spiking neurons with adaptation</article-title>. <source>Phys Rev E</source>. <year>2014</year> <month>Dec</month>;<volume>90</volume>(<issue>6–1</issue>):<fpage>062704</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.90.062704" xlink:type="simple">10.1103/PhysRevE.90.062704</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wieland</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bernardi</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Schwalger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Lindner</surname> <given-names>B</given-names></name>. <article-title>Slow fluctuations in recurrent networks of spiking neurons</article-title>. <source>Phys Rev E</source>. <year>2015</year>;<volume>92</volume>(<issue>4</issue>):<fpage>040901</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.92.040901" xlink:type="simple">10.1103/PhysRevE.92.040901</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schwalger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Droste</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Lindner</surname> <given-names>B</given-names></name>. <article-title>Statistical structure of neural spiking under non-Poissonian or other non-white stimulation</article-title>. <source>J Comput Neurosci</source>. <year>2015</year>; <volume>39</volume>: <fpage>29</fpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10827-015-0560-x" xlink:type="simple">http://dx.doi.org/10.1007/s10827-015-0560-x</ext-link></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Hakim</surname> <given-names>V</given-names></name>. <article-title>Fast global oscillations in networks of integrate-and-fire neurons with low firing rates</article-title>. <source>Neural Comput</source>. <year>1999</year>;<volume>11</volume>:<fpage>1621</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/089976699300016179" xlink:type="simple">10.1162/089976699300016179</ext-link></comment> <object-id pub-id-type="pmid">10490941</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>. <article-title>Sparsely Connected Networks of Spiking Neurons</article-title>. <source>J Comput Neurosci</source>. <year>2000</year>;<volume>8</volume>:<fpage>183</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005507.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mattia</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Del Giudice</surname> <given-names>P</given-names></name>. <article-title>Population dynamics of interacting spiking neurons</article-title>. <source>Phys Rev E</source>. <year>2002</year>;<volume>66</volume>:<fpage>051917</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.66.051917" xlink:type="simple">10.1103/PhysRevE.66.051917</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lagzi</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>. <article-title>A Markov model for the temporal dynamics of balanced random networks of finite size</article-title>. <source>Front Comput Neurosci</source>. <year>2014</year>;<volume>8</volume>:<fpage>142</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncom.2014.00142" xlink:type="simple">10.3389/fncom.2014.00142</ext-link></comment> <object-id pub-id-type="pmid">25520644</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gigante</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Deco</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Marom</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Del Giudice</surname> <given-names>P</given-names></name>. <article-title>Network events on multiple space and time scales in cultured neural networks and in a stochastic rate model</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>11</issue>):<fpage>e1004547</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004547" xlink:type="simple">10.1371/journal.pcbi.1004547</ext-link></comment> <object-id pub-id-type="pmid">26558616</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Coding and decoding with adapting neurons: a population approach to the peri-stimulus time histogram</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>10</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002711" xlink:type="simple">10.1371/journal.pcbi.1002711</ext-link></comment> <object-id pub-id-type="pmid">23055914</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gigante</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Mattia</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Del Giudice</surname> <given-names>P</given-names></name>. <article-title>Diverse Population-Bursting Modes of Adapting Spiking Neurons</article-title>. <source>Phys Rev Lett</source>. <year>2007</year>;<volume>98</volume>(<issue>14</issue>):<fpage>148101</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.98.148101" xlink:type="simple">10.1103/PhysRevLett.98.148101</ext-link></comment> <object-id pub-id-type="pmid">17501315</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref065">
<label>65</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Ocker</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Josić</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Shea-Brown</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Buice</surname> <given-names>MA</given-names></name>. <chapter-title>Linking structure and activity in nonlinear spiking networks</chapter-title>. <source>ArXiv e-prints</source>. <year>2016</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1005507.ref066">
<label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Toyoizumi</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Rad</surname> <given-names>KR</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>. <article-title>Mean-field approximations for coupled populations of generalized linear model spiking neurons with Markov refractoriness</article-title>. <source>Neural Comput</source>. <year>2009</year>;<volume>21</volume>(<issue>5</issue>):<fpage>1203</fpage>–<lpage>1243</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.2008.04-08-757" xlink:type="simple">10.1162/neco.2008.04-08-757</ext-link></comment> <object-id pub-id-type="pmid">19718814</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref067">
<label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buice</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Chow</surname> <given-names>CC</given-names></name>. <article-title>Dynamic finite size effects in spiking neural networks</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year>;<volume>9</volume>(<issue>1</issue>):<fpage>e1002872</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002872" xlink:type="simple">10.1371/journal.pcbi.1002872</ext-link></comment> <object-id pub-id-type="pmid">23359258</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref068">
<label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Meyer</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>van Vreeswijk</surname> <given-names>C</given-names></name>. <article-title>Temporal correlations in stochastic networks of spiking neurons</article-title>. <source>Neural Comput</source>. <year>2002</year>;<volume>14</volume>(<issue>2</issue>):<fpage>369</fpage>–<lpage>404</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/08997660252741167" xlink:type="simple">10.1162/08997660252741167</ext-link></comment> <object-id pub-id-type="pmid">11802917</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref069">
<label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lindner</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Doiron</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Longtin</surname> <given-names>A</given-names></name>. <article-title>Theory of oscillatory firing induced by spatially correlated noise and delayed inhibitory feedback</article-title>. <source>Phys Rev E</source>. <year>2005</year>;<volume>72</volume>(<issue>6</issue>):<fpage>061919</fpage>–<lpage>14</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.72.061919" xlink:type="simple">10.1103/PhysRevE.72.061919</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref070">
<label>70</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Trousdale</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Shea-Brown</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Josić</surname> <given-names>K</given-names></name>. <article-title>Impact of network structure and cellular response on spike time correlations</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>3</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002408" xlink:type="simple">10.1371/journal.pcbi.1002408</ext-link></comment> <object-id pub-id-type="pmid">22457608</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref071">
<label>71</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barbieri</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Mazzoni</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Logothetis</surname> <given-names>NK</given-names></name>, <name name-style="western"><surname>Panzeri</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>. <article-title>Stimulus dependence of local field potential spectra: experiment versus theory</article-title>. <source>J Neurosci</source>. <year>2014</year>;<volume>34</volume>(<issue>44</issue>):<fpage>14589</fpage>–<lpage>14605</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.5365-13.2014" xlink:type="simple">10.1523/JNEUROSCI.5365-13.2014</ext-link></comment> <object-id pub-id-type="pmid">25355213</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref072">
<label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bos</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Diesmann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Helias</surname> <given-names>M</given-names></name>. <article-title>Identifying Anatomical Origins of Coexisting Oscillations in the Cortical Microcircuit</article-title>. <source>PLoS Comput Biol</source>. <year>2016</year>;<volume>12</volume>(<issue>10</issue>):<fpage>e1005132</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1005132" xlink:type="simple">10.1371/journal.pcbi.1005132</ext-link></comment> <object-id pub-id-type="pmid">27736873</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref073">
<label>73</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Avermann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tomm</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Mateo</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Petersen</surname> <given-names>CCH</given-names></name>. <article-title>Microcircuits of excitatory and inhibitory neurons in layer 2/3 of mouse barrel cortex</article-title>. <source>J Neurophysiol</source>. <year>2012</year>;<volume>107</volume>(<issue>11</issue>):<fpage>3116</fpage>–<lpage>3134</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00917.2011" xlink:type="simple">10.1152/jn.00917.2011</ext-link></comment> <object-id pub-id-type="pmid">22402650</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref074">
<label>74</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gentet</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Kremer</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Taniguchi</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>ZJ</given-names></name>, <name name-style="western"><surname>Staiger</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Petersen</surname> <given-names>CCH</given-names></name>. <article-title>Unique functional properties of somatostatin-expressing GABAergic neurons in mouse barrel cortex</article-title>. <source>Nat Neurosci</source>. <year>2012</year>;<volume>15</volume>(<issue>4</issue>):<fpage>607</fpage>–<lpage>612</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3051" xlink:type="simple">10.1038/nn.3051</ext-link></comment> <object-id pub-id-type="pmid">22366760</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref075">
<label>75</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cruikshank</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Lewis</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Connors</surname> <given-names>BW</given-names></name>. <article-title>Synaptic basis for intense thalamocortical activation of feedforward inhibitory cells in neocortex</article-title>. <source>Nat Neurosci</source>. <year>2007</year>;<volume>10</volume>(<issue>4</issue>):<fpage>462</fpage>–<lpage>468</lpage>. <object-id pub-id-type="pmid">17334362</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref076">
<label>76</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Packer</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>. <article-title>Dense, unspecific connectivity of neocortical parvalbumin-positive interneurons: a canonical microcircuit for inhibition?</article-title> <source>J Neurosci</source>. <year>2011</year>;<volume>31</volume>(<issue>37</issue>):<fpage>13260</fpage>–<lpage>13271</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3131-11.2011" xlink:type="simple">10.1523/JNEUROSCI.3131-11.2011</ext-link></comment> <object-id pub-id-type="pmid">21917809</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref077">
<label>77</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pfeffer</surname> <given-names>CK</given-names></name>, <name name-style="western"><surname>Xue</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>He</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>ZJ</given-names></name>, <name name-style="western"><surname>Scanziani</surname> <given-names>M</given-names></name>. <article-title>Inhibition of inhibition in visual cortex: the logic of connections between molecularly distinct interneurons</article-title>. <source>Nat Neurosci</source>. <year>2013</year>;<volume>16</volume>(<issue>8</issue>):<fpage>1068</fpage>–<lpage>1076</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3446" xlink:type="simple">10.1038/nn.3446</ext-link></comment> <object-id pub-id-type="pmid">23817549</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref078">
<label>78</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ji</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Liang</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Xiao</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Tao</surname> <given-names>HW</given-names></name>, <etal>et al</etal>. <article-title>A feedforward inhibitory circuit mediates lateral refinement of sensory representation in upper layer 2/3 of mouse primary auditory cortex</article-title>. <source>J Neurosci</source>. <year>2014</year>;<volume>34</volume>(<issue>41</issue>):<fpage>13670</fpage>–<lpage>13683</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.1516-14.2014" xlink:type="simple">10.1523/JNEUROSCI.1516-14.2014</ext-link></comment> <object-id pub-id-type="pmid">25297094</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref079">
<label>79</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Karnani</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ayzenshtat</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Tucciarone</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Manoocheri</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Snider</surname> <given-names>WG</given-names></name>, <etal>et al</etal>. <article-title>Cooperative subnetworks of molecularly similar interneurons in mouse neocortex</article-title>. <source>Neuron</source>. <year>2016</year>;<volume>90</volume>(<issue>1</issue>):<fpage>86</fpage>–<lpage>100</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2016.02.037" xlink:type="simple">10.1016/j.neuron.2016.02.037</ext-link></comment> <object-id pub-id-type="pmid">27021171</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref080">
<label>80</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liu</surname> <given-names>YH</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>XJ</given-names></name>. <article-title>Spike-frequency adaptation of a generalized leaky integrate-and-fire model neuron</article-title>. <source>J Comp Neurosci</source>. <year>2001</year>;<volume>10</volume>:<fpage>25</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1023/A:1008916026143" xlink:type="simple">10.1023/A:1008916026143</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref081">
<label>81</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bibikov</surname> <given-names>NG</given-names></name>, <name name-style="western"><surname>Ivanitskii</surname> <given-names>GA</given-names></name>. <article-title>Modelling spontaneous pulsation and short-term adaptation in the fibres of the auditory nerve</article-title>. <source>Biophysics</source>. <year>1985</year>;<volume>30</volume>:<fpage>152</fpage>–<lpage>156</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005507.ref082">
<label>82</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schwalger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Fisch</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Benda</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lindner</surname> <given-names>B</given-names></name>. <article-title>How Noisy Adaptation of Neurons Shapes Interspike Interval Histograms and Correlations</article-title>. <source>PLoS Comput Biol</source>. <year>2010</year>;<volume>6</volume>(<issue>12</issue>):<fpage>e1001026</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1001026" xlink:type="simple">10.1371/journal.pcbi.1001026</ext-link></comment> <object-id pub-id-type="pmid">21187900</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref083">
<label>83</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schwalger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Lindner</surname> <given-names>B</given-names></name>. <article-title>Patterns of interval correlations in neural oscillators with adaptation</article-title>. <source>Front Comput Neurosci</source>. <year>2013</year>;<volume>7</volume>(<issue>164</issue>):<fpage>164</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncom.2013.00164" xlink:type="simple">10.3389/fncom.2013.00164</ext-link></comment> <object-id pub-id-type="pmid">24348372</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref084">
<label>84</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Weber</surname> <given-names>AI</given-names></name>, <name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>. <chapter-title>Capturing the dynamical repertoire of single neurons with generalized linear models</chapter-title>. <source>ArXiv e-prints</source>. <year>2016</year> <month>Feb</month>;.</mixed-citation>
</ref>
<ref id="pcbi.1005507.ref085">
<label>85</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jolivet</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rauch</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lüscher</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Predicting spike timing of neocortical pyramidal neurons by simple threshold models</article-title>. <source>J Comput Neurosci</source>. <year>2006</year>;<volume>21</volume>(<issue>1</issue>):<fpage>35</fpage>–<lpage>49</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10827-006-7074-5" xlink:type="simple">10.1007/s10827-006-7074-5</ext-link></comment> <object-id pub-id-type="pmid">16633938</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref086">
<label>86</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Platkiewicz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Brette</surname> <given-names>R</given-names></name>. <article-title>Impact of Fast Sodium Channel Inactivation on Spike Threshold Dynamics and Synaptic Integration</article-title>. <source>PLoS Comput Biol</source>. <year>2011</year>;<volume>7</volume>(<issue>5</issue>):<fpage>1</fpage>–<lpage>15</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1001129" xlink:type="simple">10.1371/journal.pcbi.1001129</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref087">
<label>87</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mensi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hagens</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Pozzorini</surname> <given-names>C</given-names></name>. <article-title>Enhanced sensitivity to rapid input fluctuations by nonlinear threshold dynamics in neocortical pyramidal neurons</article-title>. <source>PLoS Comput Biol</source>. <year>2016</year>;<volume>12</volume>(<issue>2</issue>):<fpage>e1004761</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004761" xlink:type="simple">10.1371/journal.pcbi.1004761</ext-link></comment> <object-id pub-id-type="pmid">26907675</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref088">
<label>88</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chizhov</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>Graham</surname> <given-names>LJ</given-names></name>. <article-title>Population model of hippocampal pyramidal neurons, linking a refractory density approach to conductance-based neurons</article-title>. <source>Phys Rev E</source>. <year>2007</year>;<volume>75</volume>(<issue>1</issue>):<fpage>011924</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.75.011924" xlink:type="simple">10.1103/PhysRevE.75.011924</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref089">
<label>89</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chizhov</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>Graham</surname> <given-names>LJ</given-names></name>. <article-title>Efficient evaluation of neuron populations receiving colored-noise current based on a refractory density method</article-title>. <source>Phys Rev E</source>. <year>2008</year>;<volume>77</volume>(<issue>1</issue>):<fpage>011910</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.77.011910" xlink:type="simple">10.1103/PhysRevE.77.011910</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref090">
<label>90</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Perkel</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Gerstein</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Moore</surname> <given-names>GP</given-names></name>. <article-title>Neuronal spike trains and stochastic point processes. I. The single spike train</article-title>. <source>Biophys J</source>. <year>1967</year>;<volume>7</volume>(<issue>4</issue>):<fpage>391</fpage>–<lpage>418</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(67)86596-2" xlink:type="simple">10.1016/S0006-3495(67)86596-2</ext-link></comment> <object-id pub-id-type="pmid">4292791</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref091">
<label>91</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gewaltig</surname> <given-names>MO</given-names></name>, <name name-style="western"><surname>Diesmann</surname> <given-names>M</given-names></name>. <article-title>NEST (NEural Simulation Tool)</article-title>. <source>Scholarpedia</source>. <year>2007</year>;<volume>2</volume>(<issue>4</issue>):<fpage>1430</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4249/scholarpedia.1430" xlink:type="simple">10.4249/scholarpedia.1430</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref092">
<label>92</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deger</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Helias</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Cardanobile</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Atay</surname> <given-names>FM</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>. <article-title>Nonequilibrium dynamics of stochastic point processes with refractoriness</article-title>. <source>Phys Rev E</source>. <year>2010</year>;<volume>82</volume>(<issue>2</issue>):<fpage>021129</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.82.021129" xlink:type="simple">10.1103/PhysRevE.82.021129</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref093">
<label>93</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Knight</surname> <given-names>BW</given-names></name>. <article-title>Dynamics of encoding in a population of neurons</article-title>. <source>J Gen Physiol</source>. <year>1972</year>;<volume>59</volume>:<fpage>734</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1085/jgp.59.6.734" xlink:type="simple">10.1085/jgp.59.6.734</ext-link></comment> <object-id pub-id-type="pmid">5025748</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref094">
<label>94</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Franklin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bair</surname> <given-names>W</given-names></name>. <article-title>The effect of a refractory period on the power spectrum of neuronal discharge</article-title>. <source>SIAM J Appl Math</source>. <year>1995</year>;<volume>55</volume>:<fpage>1074</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/S0036139993258691" xlink:type="simple">10.1137/S0036139993258691</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref095">
<label>95</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Van Hemmen</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Cowan</surname> <given-names>JD</given-names></name>. <article-title>What matters in neuronal locking?</article-title> <source>Neural Comput</source>. <year>1996</year>;<volume>8</volume>(<issue>8</issue>):<fpage>1653</fpage>–<lpage>1676</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.1996.8.8.1653" xlink:type="simple">10.1162/neco.1996.8.8.1653</ext-link></comment> <object-id pub-id-type="pmid">8888612</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref096">
<label>96</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerhard</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Deger</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Truccolo</surname> <given-names>W</given-names></name>. <article-title>On the stability and dynamics of stochastic spiking neuron models: nonlinear Hawkes process and point process GLMs</article-title>. <source>PLOS Computat Biol</source>. <year>2017</year>;<volume>13</volume>(<issue>2</issue>):<fpage>e1005390</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1005390" xlink:type="simple">10.1371/journal.pcbi.1005390</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref097">
<label>97</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Helias</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tetzlaff</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Diesmann</surname> <given-names>M</given-names></name>. <article-title>The correlation structure of local neuronal networks intrinsically results from recurrent dynamics</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>(<issue>1</issue>):<fpage>e1003428</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003428" xlink:type="simple">10.1371/journal.pcbi.1003428</ext-link></comment> <object-id pub-id-type="pmid">24453955</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref098">
<label>98</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Renart</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>De La Rocha</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bartho</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Hollender</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Parga</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Reyes</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>The asynchronous state in cortical circuits</article-title>. <source>Science</source>. <year>2010</year>;<volume>327</volume>(<issue>5965</issue>):<fpage>587</fpage>–<lpage>590</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1179850" xlink:type="simple">10.1126/science.1179850</ext-link></comment> <object-id pub-id-type="pmid">20110507</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref099">
<label>99</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Litwin-Kumar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Doiron</surname> <given-names>B</given-names></name>. <article-title>Slow dynamics and high variability in balanced cortical networks with clustered connections</article-title>. <source>Nature Neurosci</source>. <year>2012</year>;<volume>15</volume>(<issue>11</issue>):<fpage>1498</fpage>–<lpage>1505</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3220" xlink:type="simple">10.1038/nn.3220</ext-link></comment> <object-id pub-id-type="pmid">23001062</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref100">
<label>100</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hertz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Krogh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Palmer</surname> <given-names>RG</given-names></name>. <source>Introduction to the theory of neural computation</source>. <publisher-loc>Redwood City Calif</publisher-loc>: <publisher-name>Addison-Wesley</publisher-name>; <year>1991</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005507.ref101">
<label>101</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>XJ</given-names></name>. <article-title>Calcium Coding and Adaptive Temporal Computation in Cortical Pyramidal Neurons</article-title>. <source>J Neurophysiol</source>. <year>1998</year>;<volume>79</volume>(<issue>3</issue>):<fpage>1549</fpage>–<lpage>1566</lpage>. <object-id pub-id-type="pmid">9497431</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref102">
<label>102</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wong</surname> <given-names>KF</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>XJ</given-names></name>. <article-title>A recurrent network mechanism of time integration in perceptual decisions</article-title>. <source>J Neurosci</source>. <year>2006</year>;<volume>26</volume>(<issue>4</issue>):<fpage>1314</fpage>–<lpage>1328</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3733-05.2006" xlink:type="simple">10.1523/JNEUROSCI.3733-05.2006</ext-link></comment> <object-id pub-id-type="pmid">16436619</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref103">
<label>103</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mazzucato</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Fontanini</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>La Camera</surname> <given-names>G</given-names></name>. <article-title>Dynamics of multistable states during ongoing and evoked cortical activity</article-title>. <source>J Neurosci</source>. <year>2015</year>;<volume>35</volume>(<issue>21</issue>):<fpage>8214</fpage>–<lpage>8231</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4819-14.2015" xlink:type="simple">10.1523/JNEUROSCI.4819-14.2015</ext-link></comment> <object-id pub-id-type="pmid">26019337</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref104">
<label>104</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lagzi</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>. <article-title>Dynamics of Competition between Subnetworks of Spiking Neuronal Networks in the Balanced State</article-title>. <source>PloS one</source>. <year>2015</year>;<volume>10</volume>(<issue>9</issue>):<fpage>e0138947</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0138947" xlink:type="simple">10.1371/journal.pone.0138947</ext-link></comment> <object-id pub-id-type="pmid">26407178</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref105">
<label>105</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hänggi</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Talkner</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Borkovec</surname> <given-names>M</given-names></name>. <article-title>Reaction Rate Theory: Fifty Years After Kramers</article-title>. <source>Rev Mod Phys</source>. <year>1990</year>;<volume>62</volume>:<fpage>251</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/RevModPhys.62.251" xlink:type="simple">10.1103/RevModPhys.62.251</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref106">
<label>106</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cao</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Pastukhov</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mattia</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Braun</surname> <given-names>J</given-names></name>. <article-title>Collective Activity of Many Bistable Assemblies Reproduces Characteristic Dynamics of Multistable Perception</article-title>. <source>J Neurosci</source>. <year>2016</year>;<volume>36</volume>(<issue>26</issue>):<fpage>6957</fpage>–<lpage>6972</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4626-15.2016" xlink:type="simple">10.1523/JNEUROSCI.4626-15.2016</ext-link></comment> <object-id pub-id-type="pmid">27358454</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref107">
<label>107</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cain</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Iyer</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Mihalas</surname> <given-names>S</given-names></name>. <article-title>The Computational Properties of a Simplified Cortical Column Model</article-title>. <source>PLoS Comput Biol</source>. <year>2016</year>;<volume>12</volume>(<issue>9</issue>):<fpage>e1005045</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1005045" xlink:type="simple">10.1371/journal.pcbi.1005045</ext-link></comment> <object-id pub-id-type="pmid">27617444</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref108">
<label>108</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Truccolo</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>, <name name-style="western"><surname>Fellows</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Donoghue</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <article-title>A point process framework for relating neural spiking activity to spiking history, neural ensemble, and extrinsic covariate effects</article-title>. <source>J Neurophysiol</source>. <year>2005</year>;<volume>93</volume>(<issue>2</issue>):<fpage>1074</fpage>–<lpage>1089</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00697.2004" xlink:type="simple">10.1152/jn.00697.2004</ext-link></comment> <object-id pub-id-type="pmid">15356183</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref109">
<label>109</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Shlens</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Sher</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Litke</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Chichilnisky</surname> <given-names>EJ</given-names></name>, <etal>et al</etal>. <article-title>Spatio-temporal correlations and visual signalling in a complete neuronal population</article-title>. <source>Nature</source>. <year>2008</year>;<volume>454</volume>(<issue>7207</issue>):<fpage>995</fpage>–<lpage>999</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature07140" xlink:type="simple">10.1038/nature07140</ext-link></comment> <object-id pub-id-type="pmid">18650810</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref110">
<label>110</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Carandini</surname> <given-names>M</given-names></name>. <article-title>From circuits to behavior: a bridge too far?</article-title> <source>Nat Neurosci</source>. <year>2012</year>;<volume>15</volume>(<issue>4</issue>):<fpage>507</fpage>–<lpage>509</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3043" xlink:type="simple">10.1038/nn.3043</ext-link></comment> <object-id pub-id-type="pmid">22449960</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref111">
<label>111</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schuecker</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schmidt</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>van Albada</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Diesmann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Helias</surname> <given-names>M</given-names></name>. <article-title>Fundamental Activity Constraints Lead to Specific Interpretations of the Connectome</article-title>. <source>PLOS Comput Biol</source>. <year>2017</year>;<volume>13</volume>(<issue>2</issue>):<fpage>1</fpage>–<lpage>25</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1005179" xlink:type="simple">10.1371/journal.pcbi.1005179</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref112">
<label>112</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Deco</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Ponce-Alvarez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hagmann</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Romani</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Mantini</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Corbetta</surname> <given-names>M</given-names></name>. <article-title>How local excitation—inhibition ratio impacts the whole brain dynamics</article-title>. <source>J Neurosci</source>. <year>2014</year>;<volume>34</volume>(<issue>23</issue>):<fpage>7886</fpage>–<lpage>7898</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.5068-13.2014" xlink:type="simple">10.1523/JNEUROSCI.5068-13.2014</ext-link></comment> <object-id pub-id-type="pmid">24899711</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref113">
<label>113</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gilson</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Moreno-Bote</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ponce-Alvarez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ritter</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Deco</surname> <given-names>G</given-names></name>. <article-title>Estimation of Directed Effective Connectivity from fMRI Functional Connectivity Hints at Asymmetries of Cortical Connectome</article-title>. <source>PLoS Comput Biol</source>. <year>2016</year>;<volume>12</volume>(<issue>3</issue>):<fpage>e1004762</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004762" xlink:type="simple">10.1371/journal.pcbi.1004762</ext-link></comment> <object-id pub-id-type="pmid">26982185</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref114">
<label>114</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pulizzi</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Musumeci</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Van den Haute</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Van De Vijver</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Baekelandt</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Giugliano</surname> <given-names>M</given-names></name>. <article-title>Brief wide-field photostimuli evoke and modulate oscillatory reverberating activity in cortical networks</article-title>. <source>Sci Rep</source>. <year>2016</year>;<volume>6</volume>:<fpage>24701</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/srep24701" xlink:type="simple">10.1038/srep24701</ext-link></comment> <object-id pub-id-type="pmid">27099182</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref115">
<label>115</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tsodyks</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pawelzik</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name>. <article-title>Neural networks with dynamic synapses</article-title>. <source>Neural Comput</source>. <year>1998</year>;<volume>10</volume>(<issue>4</issue>):<fpage>821</fpage>–<lpage>835</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/089976698300017502" xlink:type="simple">10.1162/089976698300017502</ext-link></comment> <object-id pub-id-type="pmid">9573407</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref116">
<label>116</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Faugeras</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Inglis</surname> <given-names>J</given-names></name>. <article-title>Stochastic neural field equations: a rigorous footing</article-title>. <source>J Math Biol</source>. <year>2015</year>;<volume>71</volume>(<issue>2</issue>):<fpage>259</fpage>–<lpage>300</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00285-014-0807-6" xlink:type="simple">10.1007/s00285-014-0807-6</ext-link></comment> <object-id pub-id-type="pmid">25069787</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref117">
<label>117</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Iyer</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Menon</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Buice</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Mihalas</surname> <given-names>S</given-names></name>. <article-title>The influence of synaptic weight distribution on neuronal population dynamics</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year>;<volume>9</volume>(<issue>10</issue>):<fpage>e1003248</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003248" xlink:type="simple">10.1371/journal.pcbi.1003248</ext-link></comment> <object-id pub-id-type="pmid">24204219</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref118">
<label>118</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Lai</surname> <given-names>YM</given-names></name>, <name name-style="western"><surname>de Kamps</surname> <given-names>M</given-names></name>. <chapter-title>Population Density Equations for Stochastic Processes with Memory Kernels</chapter-title>. <source>ArXiv e-prints</source>. <year>2016</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1005507.ref119">
<label>119</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Baumann</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Augustin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ladenbauer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Obermayer</surname> <given-names>K</given-names></name>. <chapter-title>A stochastic Fokker-Planck equation for the dynamics of finite-sized neuronal populations</chapter-title>. In: <source>Bernstein Conference</source> <year>2016</year>; <volume>2016</volume>.</mixed-citation>
</ref>
<ref id="pcbi.1005507.ref120">
<label>120</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Augustin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ladenbauer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Obermayer</surname> <given-names>K</given-names></name>. <article-title>How adaptation shapes spike rate oscillations in recurrent neuronal networks</article-title>. <source>Front Comput Neurosci</source>. <year>2013</year>;<volume>7</volume>(<issue>9</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncom.2013.00009" xlink:type="simple">10.3389/fncom.2013.00009</ext-link></comment> <object-id pub-id-type="pmid">23450654</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref121">
<label>121</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hertäg</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Durstewitz</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>. <article-title>Analytical approximations of the firing rate of an adaptive exponential integrate-and-fire neuron in the presence of synaptic noise</article-title>. <source>Front Comput Neurosci</source>. <year>2014</year>;<volume>8</volume>:<fpage>116</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncom.2014.00116" xlink:type="simple">10.3389/fncom.2014.00116</ext-link></comment> <object-id pub-id-type="pmid">25278872</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref122">
<label>122</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schwalger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Lindner</surname> <given-names>B</given-names></name>. <article-title>Analytical approach to an integrate-and-fire model with spike-triggered adaptation</article-title>. <source>Phys Rev E</source>. <year>2015</year> <month>Dec</month>;<volume>92</volume>:<fpage>062703</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.92.062703" xlink:type="simple">10.1103/PhysRevE.92.062703</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref123">
<label>123</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Richardson</surname> <given-names>MJE</given-names></name>. <article-title>Dynamics of populations and networks of neurons with voltage-activated and calcium-activated currents</article-title>. <source>Phys Rev E</source>. <year>2009</year>;<volume>80</volume>(<issue>2</issue>):<fpage>021928</fpage>–<lpage>16</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.80.021928" xlink:type="simple">10.1103/PhysRevE.80.021928</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref124">
<label>124</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lerchner</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ursta</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hertz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ahmadi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ruffiot</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Enemark</surname> <given-names>S</given-names></name>. <article-title>Response variability in balanced cortical networks</article-title>. <source>Neural Comput</source>. <year>2006</year>;<volume>18</volume>(<issue>3</issue>):<fpage>634</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.2006.18.3.634" xlink:type="simple">10.1162/neco.2006.18.3.634</ext-link></comment> <object-id pub-id-type="pmid">16483411</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref125">
<label>125</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Renart</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Moreno-Bote</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>XJ</given-names></name>, <name name-style="western"><surname>Parga</surname> <given-names>N</given-names></name>. <article-title>Mean-driven and fluctuation-driven persistent activity in recurrent networks</article-title>. <source>Neural Computat</source>. <year>2007</year>;<volume>19</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>46</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.2007.19.1.1" xlink:type="simple">10.1162/neco.2007.19.1.1</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref126">
<label>126</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schaffer</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Ostojic</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Abbott</surname> <given-names>LF</given-names></name>. <article-title>A complex-valued firing-rate model that approximates the dynamics of spiking networks</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year>;<volume>9</volume>(<issue>10</issue>):<fpage>e1003301</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003301" xlink:type="simple">10.1371/journal.pcbi.1003301</ext-link></comment> <object-id pub-id-type="pmid">24204236</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref127">
<label>127</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Ermentrout</surname> <given-names>GB</given-names></name>, <name name-style="western"><surname>Terman</surname> <given-names>DH</given-names></name>. <source>Mathematical Foundations of Neuroscience</source>. <publisher-name>Springer</publisher-name>; <year>2010</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005507.ref128">
<label>128</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Montbrió</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Pazó</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Roxin</surname> <given-names>A</given-names></name>. <article-title>Macroscopic description for networks of spiking neurons</article-title>. <source>Phys Rev X</source>. <year>2015</year>;<volume>5</volume>(<issue>2</issue>):<fpage>021028</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005507.ref129">
<label>129</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Augustin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ladenbauer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Baumann</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Obermayer</surname> <given-names>K</given-names></name>. <chapter-title>Low-dimensional spike rate models derived from networks of adaptive integrate-and-fire neurons: comparison and implementation</chapter-title>. <source>ArXiv e-prints</source>. <year>2016</year> <month>Nov</month>;.</mixed-citation>
</ref>
<ref id="pcbi.1005507.ref130">
<label>130</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Richardson</surname> <given-names>MJE</given-names></name>. <article-title>Effects of synaptic conductance on the voltage distribution and firing rate of spiking neurons</article-title>. <source>Phys Rev E</source>. <year>2004</year>;<volume>69</volume>:<fpage>051918</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.69.051918" xlink:type="simple">10.1103/PhysRevE.69.051918</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref131">
<label>131</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Richardson</surname> <given-names>MJE</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Synaptic shot noise and conductance fluctuations affect the membrane voltage with equal significance</article-title>. <source>Neural Comput</source>. <year>2005</year>;<volume>17</volume>:<fpage>923</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/0899766053429444" xlink:type="simple">10.1162/0899766053429444</ext-link></comment> <object-id pub-id-type="pmid">15829095</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref132">
<label>132</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Spiridon</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Effect of lateral connections on the accuracy of the population code for a network of spiking neurons</article-title>. <source>Network</source>. <year>2001</year>;<volume>12</volume>(<issue>4</issue>):<fpage>409</fpage>–<lpage>421</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/0954-898X/12/4/301" xlink:type="simple">10.1088/0954-898X/12/4/301</ext-link></comment> <object-id pub-id-type="pmid">11762897</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005507.ref133">
<label>133</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Kistler</surname> <given-names>WM</given-names></name>. <source>Spiking Neuron Models: Single Neurons, Populations, Plasticity</source>. <publisher-loc>Cambridge</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>; <year>2002</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005507.ref134">
<label>134</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Stratonovich</surname> <given-names>RL</given-names></name>. <source>Topics in the Theory of Random Noise</source>. <volume>vol. 1</volume>. <publisher-loc>New York</publisher-loc>: <publisher-name>Gordon and Breach</publisher-name>; <year>1967</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005507.ref135">
<label>135</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>van Kampen</surname> <given-names>NG</given-names></name>. <source>Stochastic Processes in Physics and Chemistry</source>. <publisher-loc>Amsterdam</publisher-loc>: <publisher-name>North-Holland</publisher-name>; <year>1992</year>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>