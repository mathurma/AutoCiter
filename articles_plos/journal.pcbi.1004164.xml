<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004164</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-01576</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Theory of Choice in Bandit, Information Sampling and Foraging Tasks</article-title>
<alt-title alt-title-type="running-head">Theory of Choice</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Averbeck</surname>
<given-names>Bruno B.</given-names>
</name>
<xref rid="cor001" ref-type="corresp">*</xref>
<xref rid="aff001" ref-type="aff"/>
</contrib>
</contrib-group>
<aff id="aff001"><addr-line>Laboratory of Neuropsychology, National Institute of Mental Health, National Institutes of Health, Bethesda, Maryland, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Schrater</surname>
<given-names>Paul</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Minnesota, United States of America</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: BBA. Performed the experiments: BBA. Analyzed the data: BBA. Contributed reagents/materials/analysis tools: BBA. Wrote the paper: BBA. BBA.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">bruno.averbeck@nih.gov</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>27</day>
<month>3</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="collection">
<month>3</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>3</issue>
<elocation-id>e1004164</elocation-id>
<history>
<date date-type="received">
<day>28</day>
<month>8</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>30</day>
<month>1</month>
<year>2015</year>
</date>
</history>
<permissions>
<license xlink:href="https://creativecommons.org/publicdomain/zero/1.0/" xlink:type="simple">
<license-p>This is an open access article, free of all copyright, and may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose. The work is made available under the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/" xlink:type="simple">Creative Commons CC0</ext-link> public domain dedication</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004164" xlink:type="simple"/>
<abstract>
<p>Decision making has been studied with a wide array of tasks. Here we examine the theoretical structure of bandit, information sampling and foraging tasks. These tasks move beyond tasks where the choice in the current trial does not affect future expected rewards. We have modeled these tasks using Markov decision processes (MDPs). MDPs provide a general framework for modeling tasks in which decisions affect the information on which future choices will be made. Under the assumption that agents are maximizing expected rewards, MDPs provide normative solutions. We find that all three classes of tasks pose choices among actions which trade-off immediate and future expected rewards. The tasks drive these trade-offs in unique ways, however. For bandit and information sampling tasks, increasing uncertainty or the time horizon shifts value to actions that pay-off in the future. Correspondingly, decreasing uncertainty increases the relative value of actions that pay-off immediately. For foraging tasks the time-horizon plays the dominant role, as choices do not affect future uncertainty in these tasks.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Numerous choice tasks have been used to study decision processes. Some of these choice tasks, specifically n-armed bandit, information sampling and foraging tasks, pose choices that trade-off immediate and future reward. Specifically, the best choice may not be the choice that pays off the highest reward immediately, and exploration of unknown options vs. exploiting known options can be a normatively useful strategy. We characterized the optimal choice strategies across these tasks using Markov Decision Processes (MDPs). The MDP framework can characterize optimal choice strategies when choices are affected by the value of future rewards. We found that uncertainty and time horizon have important effects on the choice strategies in these tasks. Specifically, in bandit and information sampling tasks, increasing uncertainty increases the value of exploring choice options that tend to pay off in the future, while decreasing uncertainty increases the value of choice options that pay off immediately. These effects are increased when time horizons are longer. Foraging tasks differ in that uncertainty plays a minimal role. However, time horizon is still important in foraging. Specifically, for long time horizons, travel delays to rewards become less relevant.</p>
</abstract>
<funding-group>
<funding-statement>BBA was the recipient of an NIH grant: ZIA MH002928-01. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="0"/>
<page-count count="28"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Decision making has been studied with a wide array of tasks. Choices in many of these tasks either do not affect future choices or are modeled as if they do not affect future choices. For example, when asked to choose between gambles (e.g. 50% chance of $20 or 100% chance of $11), the choice in the current trial does not affect the gambles presented in the next trial, or the information on which one decides in the next trial. Correspondingly, even reinforcement learning tasks, where choices do affect the information that will be available for future choices, are often modeled using delta rule reinforcement learning (DRRL) or logistic regression, neither of which provides a normative description of the task. These modeling approaches assume that current choices should be driven entirely by past outcomes without considering how they will affect the future.</p>
<p>Many interesting decision making problems, however, require consideration of how current choices will affect the future [<xref rid="pcbi.1004164.ref001" ref-type="bibr">1</xref>–<xref rid="pcbi.1004164.ref007" ref-type="bibr">7</xref>]. For example, there has been interest in the explore-exploit tradeoff [<xref rid="pcbi.1004164.ref008" ref-type="bibr">8</xref>–<xref rid="pcbi.1004164.ref017" ref-type="bibr">17</xref>], information sampling [<xref rid="pcbi.1004164.ref004" ref-type="bibr">4</xref>,<xref rid="pcbi.1004164.ref006" ref-type="bibr">6</xref>], and foraging [<xref rid="pcbi.1004164.ref018" ref-type="bibr">18</xref>,<xref rid="pcbi.1004164.ref019" ref-type="bibr">19</xref>]. Explore-exploit trade-offs exist in any real-world decision making context where one has to choose between continuing to exploit a known option, for example a familiar restaurant, vs. exploring an unknown or novel restaurant. Similarly, information sampling underlies many deliberative choice processes where one collects information before committing to a decision. For example, one might study product reviews or ratings before making a large purchase. These tasks require more sophisticated choice strategies because choices can be driven by future expected values. In other words, the best choice may not be the one that delivers the largest immediate reward. The best choice may lead to larger rewards in the future at the expense of smaller immediate rewards. Choices in these tasks can be modeled with markov decision processes (MDPs). MDPs provide a general modeling framework, useful in tasks where the future depends upon what one chooses in the present. If one assumes that an agent is maximizing the expected (discounted or undiscounted) total reward, MDPs can be used to provide normative, or at least approximately normative, solutions to most current decision problems.</p>
<p>While the choice behavior of subjects often deviates from normative behavior [<xref rid="pcbi.1004164.ref004" ref-type="bibr">4</xref>], particularly in patient groups [<xref rid="pcbi.1004164.ref005" ref-type="bibr">5</xref>,<xref rid="pcbi.1004164.ref020" ref-type="bibr">20</xref>,<xref rid="pcbi.1004164.ref021" ref-type="bibr">21</xref>], normative models are still important. Specifically, normative models identify the information on which decisions should be based, and the computations that must be carried out on that information. These two points can be conceptualized as the strategy optimal for the task. Further, normative models can be parameterized to fit the behavior of individual subjects [<xref rid="pcbi.1004164.ref004" ref-type="bibr">4</xref>,<xref rid="pcbi.1004164.ref005" ref-type="bibr">5</xref>,<xref rid="pcbi.1004164.ref022" ref-type="bibr">22</xref>]. This approach can provide insight into how subjects are deviating from the normative model and therefore it can suggest specific deficits or biases, as opposed to an overall change in task performance.</p>
<p>Here, we used MDPs to model n-armed bandit, information sampling, and foraging tasks. Normative solutions to some of these tasks, to our knowledge, do not currently exist in the literature. There is, however, a long theoretical literature on binary bandit tasks [<xref rid="pcbi.1004164.ref023" ref-type="bibr">23</xref>,<xref rid="pcbi.1004164.ref024" ref-type="bibr">24</xref>], and some foraging tasks have been modeled using the marginal value theorem [<xref rid="pcbi.1004164.ref025" ref-type="bibr">25</xref>]. For MDPs, the development of approximation techniques using basis functions has opened up the solution of a much larger class of problems than was tractable previously [<xref rid="pcbi.1004164.ref026" ref-type="bibr">26</xref>]. The normative solutions provide insight into the optimal strategies. We also used the models to examine several specific questions. For example, when is it useful to explore in a bandit task, and which features of the task can increase the value of exploring? How can non-stationarity drive exploration? Furthermore, once the tasks were mapped into the MDP framework we could examine their similarities and differences. This showed that decisions in all of these tasks pose a trade-off between immediate and future expected rewards. Further, we identified two factors that are important to this trade-off in these tasks. The first is uncertainty and the second is the time horizon. In bandit and information sampling tasks future expected values are relatively higher for options about which there is more uncertainty. When there is less uncertainty, action values are driven more by immediate expected reward. Further, uncertainty, and the value of exploring uncertain options is more valuable when the time horizon is longer. We also show that reward rate maximization in foraging tasks with an undiscounted, infinite time horizon is insensitive to travel delays to patches. In general with MDPs, infinite horizon undiscounted models are insensitive to finite delays to rewards.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>We used markov decision processes, either partially observed (POMDPs) or fully observed (MDPs) to model several choice tasks. For these models we are interested in the utility, u<sub>t</sub>. For MDPs the utility depends on the state, and for POMDPs it depends on the information state. We indicate both states and information states by s<sub>t</sub>. The utility is then given by the action, a, that maximizes action value, Q(s<sub>t,</sub>a):
<disp-formula id="pcbi.1004164.e001">
<alternatives>
<graphic id="pcbi.1004164.e001g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e001" xlink:type="simple"/>
<mml:math display="block" id="M1" overflow="scroll">
<mml:msub><mml:mrow><mml:mi mathvariant="normal">u</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mi mathvariant="normal">Q</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
The action value:
<disp-formula id="pcbi.1004164.e002">
<alternatives>
<graphic id="pcbi.1004164.e002g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e002" xlink:type="simple"/>
<mml:math display="block" id="M2" overflow="scroll">
<mml:mi mathvariant="normal">Q</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi mathvariant="normal">C</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">a</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">γ</mml:mi><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">a</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">u</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="normal">j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
can be broken down into the immediate: r(s<sub>t</sub>,a)+C(s<sub>t</sub>,a) and future: γΣ<sub>j∊s</sub>p(j|s<sub>t</sub>,a)u<sub>t+1</sub>(j) expected values, which we will call IEV and FEV respectively. The IEV is the expected reward, r(s<sub>t</sub>,a), for taking action a in state s<sub>t</sub> plus a possible cost to sample, C(s<sub>t</sub>,a). These occur immediately. The FEV is the expected value of the utility of the next state, where the state transition function or the probability of transitioning to state j when taking action a in state s<sub>t</sub>, is p(j|s<sub>t</sub>,a). The FEV is an estimate of the (possibly) discounted future rewards that will be obtained, given the current action. The state is the information on which decisions are based. For most of the tasks, except the foraging tasks, the state is a hidden variable, and this hidden variable gives rise to observations through an observation model. In this case, one is dealing with a partially observable Markov Decision Process (POMDP). The observations define the information state, and one can infer the value of the hidden state using the observations. We explicitly refer to the state as the information state for POMDPs.</p>
<sec id="sec003">
<title>Exploration in a stationary two-armed bandit</title>
<p>When the environment is unknown, and model-free reinforcement learning (RL) is used to learn the environment [<xref rid="pcbi.1004164.ref027" ref-type="bibr">27</xref>], exploration can be used to drive the RL algorithm to sample from the complete space of possible options. Here we deal with tasks where the environment is specified and MDPs (or POMDPs) can be used to calculate expected values for each state. Therefore heuristic exploration does not have to be used to make choices. Exploration, if it is defined as selecting options which have a smaller IEV but a larger action value, however, can still be optimal [<xref rid="pcbi.1004164.ref027" ref-type="bibr">27</xref>]. If an agent is maximizing total expected reward, an option with a smaller IEV can be selected if its FEV is relatively larger. Thus, immediate rewards can be foregone to obtain more total rewards over the relevant time horizon. We began by examining the explore-exploit trade-off in a stationary 2-armed bandit task, in which both bandits paid-off with the same fixed reward. The bandits varied, however, in the fraction of times they delivered a reward if chosen. In this case the explore-exploit trade-off affects the first few choices, before both targets have been sampled a few times. We modeled this as a finite state, finite horizon, undiscounted POMDP, where the information states were the number of times each bandit was chosen, C<sub>i</sub> and the number of times each bandit was rewarded, R<sub>i</sub>. This information state space is formed by the sufficient statistics for the two bandit processes. Transitions through the information state space occur after each choice and its associated outcome and they correspond to belief updates for the process.</p>
<p>To examine the information state space for the bandit task more quantitatively, we can examine the distributions over expected future reward values generated in the task. Each of the bandit options is represented by a tree of possible outcomes (<xref rid="pcbi.1004164.g001" ref-type="fig">Fig. 1A</xref>). Each node in the tree defines the information state (i.e. R<sub>i</sub>,C<sub>i</sub>) for that option. The information state can be used to estimate the underlying reward probability, q for each bandit option, where q is the hidden state of the system. As one of the options is sampled, the tree is traversed. With a binomial likelihood function and a beta(α,β) prior, the posterior over reward probability is given by
<disp-formula id="pcbi.1004164.e003">
<alternatives>
<graphic id="pcbi.1004164.e003g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e003" xlink:type="simple"/>
<mml:math display="block" id="M3" overflow="scroll">
<mml:mi mathvariant="normal">p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="normal">q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∝</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">q</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="normal">q</mml:mi></mml:mrow></mml:mfenced>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004164.e004">
<alternatives>
<graphic id="pcbi.1004164.e004g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e004" xlink:type="simple"/>
<mml:math display="block" id="M4" overflow="scroll">
<mml:mrow><mml:mtext>p</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>q</mml:mtext><mml:mo>|</mml:mo><mml:msub><mml:mtext>r</mml:mtext><mml:mtext>i</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mtext>c</mml:mtext><mml:mtext>i</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:msup><mml:mtext>q</mml:mtext><mml:mrow><mml:msub><mml:mtext>r</mml:mtext><mml:mtext>i</mml:mtext></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>q</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mtext>c</mml:mtext><mml:mtext>i</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mtext>r</mml:mtext><mml:mtext>i</mml:mtext></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mtext>q</mml:mtext><mml:mrow><mml:mo>α</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>q</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>β</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004164.e005">
<alternatives>
<graphic id="pcbi.1004164.e005g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e005" xlink:type="simple"/>
<mml:math display="block" id="M5" overflow="scroll">
<mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">q</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>∝</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">q</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">α</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="normal">q</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">β</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup>
</mml:math>
</alternatives>
</disp-formula>
The beta prior is the natural conjugate prior for the binomial likelihood function. Therefore, the prior can be interpreted as data. The posterior expected value is <inline-formula id="pcbi.1004164.e006"><alternatives><graphic id="pcbi.1004164.e006g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e006" xlink:type="simple"/><mml:math display="inline" id="M6" overflow="scroll"><mml:mfenced open="〈" close="〉" separators="|"><mml:mrow><mml:mi mathvariant="normal">q</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">α</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">α</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>, where we have defined the actual choices and rewards as r<sub>i</sub>,c<sub>i</sub>, and the posterior choices and rewards as the data plus the prior R<sub>i</sub> = r<sub>i</sub> + α,C<sub>i</sub> = c<sub>i</sub> +α + β. If we start with a beta(α = 1,β = 1) prior we have posterior values of R<sub>i</sub> = 1,C<sub>i</sub> = 2 for each bandit arm before any options have been sampled (<xref rid="pcbi.1004164.g001" ref-type="fig">Fig. 1A</xref>). The possible posterior expected values are given by the nodes of the tree (<xref rid="pcbi.1004164.g001" ref-type="fig">Fig. 1A</xref>). These nodes are also the immediate expected value for a choice, i.e. &lt;<inline-formula id="pcbi.1004164.e007"><alternatives><graphic id="pcbi.1004164.e007g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e007" xlink:type="simple"/><mml:math display="inline" id="M7" overflow="scroll"><mml:mi mathvariant="normal">r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>, and these values also define the transition probabilities. Thus, if one is in state, R<sub>i</sub>,C<sub>i</sub> one transitions to R<sub>i</sub>+1,C<sub>i</sub>+1 with probability <inline-formula id="pcbi.1004164.e008"><alternatives><graphic id="pcbi.1004164.e008g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e008" xlink:type="simple"/><mml:math display="inline" id="M8" overflow="scroll"><mml:mi mathvariant="normal">p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> and one transitions to R<sub>i</sub>,C<sub>i</sub>+1 with probability <inline-formula id="pcbi.1004164.e009"><alternatives><graphic id="pcbi.1004164.e009g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e009" xlink:type="simple"/><mml:math display="inline" id="M9" overflow="scroll"><mml:mi mathvariant="normal">p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>. This defines two of the terms on the r.h.s. of equation 2 (ignoring the cost to sample). The other term on the r.h.s. of equation 2 is the utility of the next state, u<sub>t+1</sub>. These utilities are recursively related to future utilities, u<sub>t+2</sub>, etc. However, in the final trial, assuming a task where there are a finite number of trials and the number is known a-priori, there is no FEV because there will be no choices in the following trial. Therefore, utilities in the final trial, t = N, are given by the IEV, &lt;r<sub>t</sub>(s<sub>t</sub>,a)&gt;. The IEV for each state that can exist in the final trial can be directly calculated from these information states. Once these are calculated, one can calculate the utilities for t-1, and continue backwards until the utilities for the current trial can be calculated. This is the backwards induction algorithm ([<xref rid="pcbi.1004164.ref028" ref-type="bibr">28</xref>]; see <xref rid="sec014" ref-type="sec">methods</xref>).</p>
<fig id="pcbi.1004164.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004164.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Bandit state space.</title>
<p>A. A portion of the reward distribution tree, starting from a Beta(1,1) prior for one of the bandit options. As one of the options is chosen, the outcomes traverse this tree. The number at each node indicates the posterior over the number of rewards (numerator) and the number of times the option has been sampled (denominator). B. Product space across both bandit options. Blue lines (and fractions) indicate choice of option 1, red lines (and fractions) indicate choice of option 2. The numerator and denominator of the fractions are as in panel A and define the posterior probability of a reward. Thick lines show actions that would be taken from each node by an optimal policy, thin dashed lines show options that are not taken by an optimal policy. C. Distribution of reward probabilities (i.e. choices/rewards) over a finite horizon (N = 8 choices) starting from two different beta priors (Option 1: Beta(1,1) and Option 2: Beta(2,2)) which can be interpreted as different amounts of experience with the options. These priors correspond to being in the state 1/2:2/4 indicated in panel b with a box. The solid black bar under the x axis indicates q values for which p(q) is identical. Asterisks superimposed on the plots show the means of the two distributions (0.575 and 0.585 for option 2 and option 1 respectively).</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.g001" position="float" xlink:type="simple"/>
</fig>
<p>When an option has not been sampled, any point in the tree can potentially be reached, although not under the optimal policy, and the distribution over reward probabilities is broad. This tree, therefore, represents the possible outcomes if one of the options is chosen repeatedly (<xref rid="pcbi.1004164.g001" ref-type="fig">Fig. 1A</xref>). The state space for the task is, however, the product space over the nodes of two of these trees (<xref rid="pcbi.1004164.g001" ref-type="fig">Fig. 1B</xref>), as it is constructed of all combinations of possible outcomes from each individual tree. When the FEV is calculated for one of the options, it is only calculated across the nodes in the full tree that are visited by the optimal policy. This is because the max operator in equation 1 is an expectation over the policy that optimizes choices in each state. Thus, when the FEV is calculated the expectation is taken over the portion of the product space (<xref rid="pcbi.1004164.g001" ref-type="fig">Fig. 1B</xref>) where the expected action value of an option is greater than the other option (thick lines in <xref rid="pcbi.1004164.g001" ref-type="fig">Fig. 1B</xref>). The expectation is not computed over the dotted lines (<xref rid="pcbi.1004164.g001" ref-type="fig">Fig. 1B</xref>) because an optimal policy does not choose these actions. If we examine the distribution of reward probabilities over a representative finite horizon (<xref rid="pcbi.1004164.g001" ref-type="fig">Fig. 1C</xref>) we see that options which have been sampled less have higher expected values, when IEVs are each 0.5. In this example it is less likely that one will encounter a reward probability (q) of 0.5 for options that have been sampled less, and more likely that one will encounter options that have a reward probability greater than 0.8. This increased mass over higher reward probability nodes in the tree drives exploration in bandit tasks.</p>
<p>As an example, we examined a scenario in which bandit option 1 was sampled 6 times, and rewarded three times (<xref rid="pcbi.1004164.g002" ref-type="fig">Fig. 2A</xref>). (Note that in this example the agent is not following the optimal policy. Rather we have defined choices and outcomes to illustrate action values under particular scenarios.) The action value for option 1 exceeds the action value for option 2 during the first three trials while it is being rewarded. The FEV, however, of option 2 is larger than the FEV of option 1, even in the first 3 trials, during which option 1 is being rewarded. After option 1 is not rewarded once, it becomes more valuable to sample option 2 (i.e. Q(s,2) &gt; Q(s,1) in trial 5). After option 1 had been sampled 6 times and rewarded three times, its IEV is the same as option 2, which had an expected value of 0.5 because of its prior. However, the action value (IEV + FEV) favors option 2 at this point (i.e. trial 7). If option 2 is then sampled 6 times and rewarded 3 times, the action values of the two options are again the same (i.e. trial 13). The exploration bonus (here taken as the difference in FEV between the two options on trial 4) is also larger when the time horizon is longer (<xref rid="pcbi.1004164.g002" ref-type="fig">Fig. 2B</xref>). This is because option 2 can be exploited for a longer time horizon if it is sampled and found to be better. When the first option chosen is rewarded, and it continues to be chosen and rewarded, the action value of the second option will not exceed the value of the first option (<xref rid="pcbi.1004164.g002" ref-type="fig">Fig. 2C</xref>), given these finite time horizons.</p>
<fig id="pcbi.1004164.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004164.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Two armed bandit example.</title>
<p>Panels A and C are shown for a 50 trial fixed horizon model. A. Difference in action value between option 1 and option 2. Blue dots indicate rewarded choice, black dots indicate unrewarded choice (R+ = rewarded, R- = unrewarded). Bracket indicates difference in future expected value shown in panel B. Results are for a finite time horizon model with a 50 trial horizon and no discounting. The agent is not following the optimal policy in this example. Choices and outcomes were fixed to illustrate a specific point. B. Difference in future expected value on trial 4 as a function of time horizon. C. Difference in action value in a scenario in which one of the targets is chosen, and it is rewarded every time except in trial 16.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.g002" position="float" xlink:type="simple"/>
</fig>
<p>The exploration bonus is driven by three factors. Continuing on the example above, assume option 1 has been sampled and option 2 has not been sampled. First, there is uncertainty about option 2 (i.e. the prior distribution over possible reward probabilities for unsampled options is broad, assuming a vague prior). Therefore, option 2 might be better than option 1. If option 1 cannot be better than option 2, because of the structure of prior knowledge, there is no exploration bonus. The second factor, as shown above (<xref rid="pcbi.1004164.g002" ref-type="fig">Fig. 2B</xref>) is the time horizon [<xref rid="pcbi.1004164.ref017" ref-type="bibr">17</xref>]. If the time horizon is too short one cannot obtain enough additional rewards when option 2 is found to be better than option 1, to make up for the scenarios (i.e. other episodes of the task) when option 2 is found to be not as good as option 1. This factor relies on the assumption that option 2 might be better than option 1. Third, if option 2 is sampled and it is not as good as option 1, then one can switch back to option 1. On the other hand, if option 2 is better than option 1, then one can stick with option 2. This preference for the option which will be found to be better in the future, drives choices in the present via the max operator over action values in the utility equation (equation 1), which operates on the distribution of future outcomes via the embedded recursion.</p>
</sec>
<sec id="sec004">
<title>3-armed bandit novelty task</title>
<p>We next examined a novelty task [<xref rid="pcbi.1004164.ref005" ref-type="bibr">5</xref>,<xref rid="pcbi.1004164.ref008" ref-type="bibr">8</xref>,<xref rid="pcbi.1004164.ref029" ref-type="bibr">29</xref>]. This is a 3-armed bandit task similar in several ways to the 2-armed bandit task described above. The size of the reward is the same for each bandit option, but the probability of receiving a reward when each option is selected differs. In addition to this, however, choice options are replaced by novel choice options at stochastic intervals. Thus, after subjects accumulate experience with the current set of 3 bandit options for a period of time, one of the options is replaced by a novel option. These replacements are stochastic and not known in advance, but they are indicated to the subject. We modeled this task with an infinite horizon, finite state, discounted POMDP. Consistent with the 2-armed bandit, the information state is defined by R<sub>i</sub>,C<sub>i</sub> for each option. The full information state is now a product space across 3 trees (<xref rid="pcbi.1004164.g001" ref-type="fig">Fig. 1A</xref>), so it is larger.</p>
<p>To examine this task we considered a scenario similar to the one examined for the 2-armed stationary bandit. The action value of the chosen option (option 1) increased while it was being rewarded in trials 1–3 (<xref rid="pcbi.1004164.g003" ref-type="fig">Fig. 3A</xref>, for the choices and rewards see <xref rid="pcbi.1004164.g003" ref-type="fig">Fig. 3D</xref>; note that these actions are not chosen by the optimal policy. Rather they were chosen to illustrate the effect of experience with an option). The FEV also increased for all 3 options because of the overall increase in the expected reward in the environment (<xref rid="pcbi.1004164.g003" ref-type="fig">Fig. 3C</xref>). However, similar to what was seen in the 2-armed bandit (<xref rid="pcbi.1004164.g002" ref-type="fig">Fig. 2A</xref>), the FEV was larger for unexplored options (<xref rid="pcbi.1004164.g003" ref-type="fig">Fig. 3B</xref>). Further, when option 1 was replaced, after each of the options had been chosen a few times, its FEV increased relative to the other two options (<xref rid="pcbi.1004164.g003" ref-type="fig">Fig. 3B</xref>, trial 15). Similarly, when option two was replaced on trial 20, its FEV increased (<xref rid="pcbi.1004164.g003" ref-type="fig">Fig. 3B</xref>). As with the 2-armed bandit, when the discount parameter was increased towards 1 (<xref rid="pcbi.1004164.g003" ref-type="fig">Fig. 3E</xref>), the exploration bonus increased (<xref rid="pcbi.1004164.g003" ref-type="fig">Fig. 3F</xref>). Thus, when a long time-horizon is available to exploit a novel option if it is found to be more valuable, the FEV for exploring that option increases. Every time a novel option is introduced, it is equivalent to resetting that option to the beta(1,1) prior, resetting it to the start of the tree (<xref rid="pcbi.1004164.g001" ref-type="fig">Fig. 1A</xref>). Thus, uncertainty drives an exploration bonus as long as a sufficient time horizon is available to exploit the novel option if it turns out to be better than the alternative options available. Correspondingly, the substitution rate of novel options also affects the novelty bonus, by effectively limiting the time horizon (<xref rid="pcbi.1004164.g003" ref-type="fig">Fig. 3F</xref>). If the substitution rate is high, one likely will have less time to exploit novel options that turn out to be good, before they are again replaced.</p>
<fig id="pcbi.1004164.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004164.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Utilities in the novelty task.</title>
<p>Panels A-D, γ = 0.95. A. Total expected value for the three options across a 25 trial sample. Stars indicate trials on which novel choice options were introduced. Colors indicate each choice option. B. Difference in future expected values (FEV: 1–2: difference between future expected value for choosing 1 vs. 2, etc.). C. Future expected values for the three options. Stars indicate trials on which novel choice options were introduced. Colors indicate each of the 3 choice options. D. Choices and rewards for the 25 trial sequence shown in panels A-C. Stars indicate where novel options were introduced. Blue symbols indicate choices that were rewarded (R+), black symbols indicate choices that were not rewarded (R-). Position on the y-axis indicates the choice (e.g. Ch 1 is choose option 1). E. Discount function for different discount rates. F. Exploration bonus (i.e. difference between option 1 and option 2 when option 1 is replaced at trial 15) as a function of discount parameter, and as a function of the probability of substituting a novel option. As discount parameter approaches 1, and the time horizon extends further into the future, the novelty bonus increases. There are 3 x-axes. The first two correspond to plotting the novelty bonus as a function of either the calculated time horizon, or the discount. The x-axis enumerated in trials is the number of trials, N = -1/log<sub>e</sub>(γ), at which the utility is discounted by 1/e. The third is the x-axis for the substitution rate, plotted with γ = 0.95. Substitution rate is p = 0.05 for time horizon line and all other data.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.g003" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>Exploration in non-stationary bandits</title>
<p>To examine exploration in related bandit tasks, we used an infinite horizon, discounted, continuous state, POMDP to model a non-stationary two-armed bandit task [<xref rid="pcbi.1004164.ref009" ref-type="bibr">9</xref>]. The information state in this model is given by the mean and variance of the bandits, which are the sufficient statistics for the two processes. The bandits in this task returned continuous valued rewards (e.g. 0–100). The means of the returned values for each bandit were non-stationary in time, following independent, random walks that decayed to 50. The actual reward earned on an individual trial was given by a sample from a Gaussian distribution with the current mean, and a standard deviation of 4. The IEV is given by the estimated mean of each bandit. The utility depends on the estimated means of the two options (<xref rid="pcbi.1004164.g004" ref-type="fig">Fig. 4A</xref>) as well as the estimated variance of the options (<xref rid="pcbi.1004164.g004" ref-type="fig">Fig. 4B</xref>). The effect of variance on utility also depends on the time-horizon (<xref rid="pcbi.1004164.g004" ref-type="fig">Fig. 4B</xref>). The variance has a larger effect when the time horizon is longer. The effect of the variance of the utility can be understood in the framework developed above for the stationary bandit (<xref rid="pcbi.1004164.g001" ref-type="fig">Fig. 1</xref>). Specifically, when an option is not sampled its variance grows because of the nonstationarity of the underlying generative model, effectively driving it backwards in the tree (<xref rid="pcbi.1004164.g001" ref-type="fig">Fig. 1A</xref>). On the other hand, when an option is sampled its variance decreases, effectively driving it forwards in the tree (<xref rid="pcbi.1004164.g001" ref-type="fig">Fig. 1A</xref>). Thus, an option which has not been sampled for several trials becomes similar to a novel option, and it should be explored.</p>
<fig id="pcbi.1004164.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004164.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Utilities in nonstationary 2-armed bandit.</title>
<p>A. Utility as a function of mean of option 1 and mean of option 2, with standard deviation of both options set to 4 and discount rate, γ = 0.90. B. Utility as a function of standard deviation for 2 discount values when mean is 50 for both options and standard deviation is 4 for option 2. C. Estimate of mean and standard deviation of options 1 and 2 as they are sampled under a condition where means are fixed at 45 and 55. Black line indicates choice of option 1 (y = 5) or option 2 (y = 15). Discount rate γ = 0.90. D. Same as panel C, except γ = 0.99. E. Plot of action value for two options for data plotted in C, γ = 0.90. F. Action value for two options for data plotted in panel D, γ = 0.99. G. Example sequence of samples and estimates of mean and variance, γ = 0.90 for means drawn from the generative model. H. Example sequence of samples and estimates of mean and variance, γ = 0.99.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.g004" position="float" xlink:type="simple"/>
</fig>
<p>We examined the choice sequence of the algorithm for some examples. If we consider an artificial case where the means are locked at 45 and 55 (but the algorithm still assumes the means are non-stationary), and compare the sampling under two different discount parameters (effective time horizons) we see that the algorithm periodically samples the option with a smaller estimated mean, as its variance grows (<xref rid="pcbi.1004164.g004" ref-type="fig">Fig. 4C</xref>). In addition, when the discount parameter is larger (γ = 0.90 vs γ = 0.99) the algorithm samples more often, consistent with the larger difference in utility for a given standard deviation for larger discount parameters (<xref rid="pcbi.1004164.g004" ref-type="fig">Fig. 4B</xref>). This can also be seen clearly in the action values (<xref rid="pcbi.1004164.g004" ref-type="fig">Fig. 4E</xref> and F—Note that the algorithm stochastically sampled option 1 first in panel E and option 2 first in panel F, which gives rise to the initial downward vs. upward fluctuation). With the means fixed, the action values depend only on the variance of the two processes, if we ignore the decay of the process to 50. When an option is sampled its variance decreases and its utility decreases, and when an option is not sampled its variance increases and its utility increases. The combination of these eventually drives the action value of the recently unsampled option to exceed the action value of the option currently being sampled (<xref rid="pcbi.1004164.g004" ref-type="fig">Fig. 4E and F</xref>), and the option which has not been recently sampled is then sampled. This can be seen in example sequences drawn from the actual generative process as well (<xref rid="pcbi.1004164.g004" ref-type="fig">Fig. 4G-H</xref>, the actual process values are identical for these two examples). In this case when the algorithm is modeled with a longer time horizon it samples more (<xref rid="pcbi.1004164.g004" ref-type="fig">Fig. 4H</xref>).</p>
</sec>
<sec id="sec006">
<title>Information sampling</title>
<p>We next examined an information sampling task, often referred to as the beads or urn task [<xref rid="pcbi.1004164.ref004" ref-type="bibr">4</xref>,<xref rid="pcbi.1004164.ref005" ref-type="bibr">5</xref>,<xref rid="pcbi.1004164.ref020" ref-type="bibr">20</xref>,<xref rid="pcbi.1004164.ref021" ref-type="bibr">21</xref>,<xref rid="pcbi.1004164.ref030" ref-type="bibr">30</xref>]. In this task subjects are shown a sequence of beads drawn from one of two possible urns (<xref rid="pcbi.1004164.g005" ref-type="fig">Fig. 5A</xref>). One of the urns has q orange beads and 1-q blue beads and the other has q blue beads and 1-q orange beads. After each bead is drawn subjects have three choices. They can either draw another bead from the urn, guess that beads are being drawn from the predominantly blue urn, or guess that beads are being drawn from the predominantly orange urn. Sampling another bead usually involves an explicit cost-to-sample. In other words, subjects are charged for collecting more information. In this task, the value of choosing an urn is given by the IEV, because no more samples are allowed after an urn is chosen so FEV is zero, whereas the value of sampling another bead is given by the FEV (minus the cost-to-sample), because there is no reward if one does not try to infer the urn. Thus, this task explicitly sets up a trade-off between immediate and future expected rewards, and in this sense it is similar to the explore-exploit trade-off in bandit tasks.</p>
<fig id="pcbi.1004164.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004164.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Beads task.</title>
<p>A. Example distribution of beads in the beads in the jar task. B. State space for beads task. Example sequence of draws is taken from panel C. C-F. Action value for the three choice options as a function of draws for example sequences. Bead outcomes are shown as orange and blue beads. The star indicates the first trial on which the expected value of choosing an urn is greater than the expected value of drawing again. In this case an ideal observer would guess the urn with the highest value. Not that this is the value after seeing the bead shown in the corresponding trial. In panels C-E, cost to sample is C(s<sub>t</sub>,a) = -0.005. In panel F, C(s<sub>t</sub>,a) = -0.025.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.g005" position="float" xlink:type="simple"/>
</fig>
<p>In most cases subjects are told that they can draw only up to a maximum number of beads and after the last bead is drawn they have to guess an urn. As such, the task can be modeled as a finite horizon, finite state, undiscounted, POMDP. The information state space is simpler than the state space in the bandit task, as it is given by a single tree (<xref rid="pcbi.1004164.g005" ref-type="fig">Fig. 5B</xref>), where instead of rewards and no rewards, the state is given by the number of blue (or orange) beads that have been drawn, and the total number of beads drawn. These form the sufficient statistics for the process. As one draws beads, one works through the state space, similar to the situation with the bandit tasks. For example, the first 3 bead draws for the example sequence shown in <xref rid="pcbi.1004164.g005" ref-type="fig">Fig. 5C</xref> would go through the set of states shown (<xref rid="pcbi.1004164.g005" ref-type="fig">Fig. 5B</xref>). Unlike the bandit task, this task was modeled with an uninformative prior on bead draws, because it is normally implemented by showing subjects one bead before asking them to decide [<xref rid="pcbi.1004164.ref021" ref-type="bibr">21</xref>]. The action values for guessing either of the urns or sampling again show that the value of guessing an urn increases as evidence for that urn increases (i.e. more beads drawn of the corresponding color), and decreases as evidence for the urn decreases, in a cumulative fashion (<xref rid="pcbi.1004164.g005" ref-type="fig">Fig. 5C-F</xref>). The value of sampling again is initially above the value of guessing an urn, but at some point it drops slightly below. Note that without a cost-to-sample (C(s<sub>t</sub>,a) = -0.005 in panels C-E and C(s<sub>t</sub>,a) = -0.025 in panel F) it is always best to sample all of the available beads. To examine the effect of the cost-to-sample, we calculated values for two costs, on identical sequences of bead draws (<xref rid="pcbi.1004164.g005" ref-type="fig">Fig. 5E-F</xref>). When the cost was lower (C(s<sub>t</sub>,a) = -0.005; <xref rid="pcbi.1004164.g005" ref-type="fig">Fig. 5E</xref>), it was optimal to delay the decision until after the 11<sup>th</sup> bead was drawn, whereas when the cost was higher (C(s<sub>t</sub>,a) = -0.025; <xref rid="pcbi.1004164.g005" ref-type="fig">Fig. 5F</xref>) it was optimal to decide after 2 beads. This task can be considered a pure exploration task: how long does one explore before committing to (exploiting) one of the choices? This is similar to exploring a novel option for several trials, while always considering whether to switch back to the known option, or sticking with the novel option. As the certainty about which urn is being drawn from increases, picking an urn (which will deliver an IEV), as opposed to drawing again (which is valuable because of the FEV), becomes more valuable.</p>
</sec>
<sec id="sec007">
<title>Foraging tasks</title>
<p>The final tasks we considered were foraging tasks. Much like the tasks examined above, these tasks trade-off immediate and future expected values. Should one stay in the current patch whose resources are being depleted (i.e. choose IEV) or travel to a new patch (i.e. choose FEV) [<xref rid="pcbi.1004164.ref019" ref-type="bibr">19</xref>]? Or, should one sample again (i.e. choose FEV) or commit to the current gamble on offer (i.e. choose IEV) [<xref rid="pcbi.1004164.ref018" ref-type="bibr">18</xref>]? The state spaces for these tasks differ in a fundamental way from the state spaces in the bandit and information sampling tasks (<xref rid="pcbi.1004164.g006" ref-type="fig">Fig. 6A</xref> and <xref rid="pcbi.1004164.g007" ref-type="fig">7A</xref>). The state spaces for the foraging tasks are recursive. Stated another way, the state spaces for the foraging tasks do not represent learning or information accumulation. Learning or information accumulation are not recursive because you do not return to the same state (technically, this is not completely accurate, as one can with some probability, return to a previous state in either the non-stationary bandit or the novelty bandit). Rather, in the foraging tasks the current state is provided to the animal and the animal does not have to estimate beliefs or distributions over states. Therefore these tasks are MDPs, as opposed to POMDPs where the state is hidden. In the foraging tasks one observes the state directly.</p>
<fig id="pcbi.1004164.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004164.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Patch leaving foraging task.</title>
<p>A. State space model for the task. The full state space has been collapsed. The state space shown would be repeated, one for each juice, travel delay combination. We show this here by indexing the choice state by these variables. B. Difference in action value for stay in patch vs. travel as a function of current juice and current travel delay. Yellow line indicates point of indifference between stay and travel. C. Difference in action value (same data as plotted in B) with each line representing a different travel delay. D. Average time in patch as a function of current travel delay. Note the curve is discontinuous because of the discretization of the problem. E. Difference in utility with an infinite, undiscounted time horizon. Yellow line indicates point of indifference between stay and travel. F. Difference in action values with an undiscounted, infinite time horizon. Note that the travel delay does not affect value, as would be expected.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.g006" position="float" xlink:type="simple"/>
</fig>
<fig id="pcbi.1004164.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004164.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Sampling foraging task.</title>
<p>A. State space model for the foraging task. The numbers in the circles indicate one of the offer pairs. As there were 6 available individual gambles, there were 15 offer pairs possible in each foraging round. Bottom of panel shows gambles that would be available in a specific foraging bout. In each trial subjects are shown a randomly sampled pair from the 6. If they accept the pair, they move on to the decision stage. If they sample again, a new pair is shown, and they have to decide whether to accept the pair, or sample again, etc. B. Expected value for accepting the current gamble or sampling again for an example sequence of draws. Option below trial number is the option pair that was presented on that trial.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.g007" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008">
<title>Patch leaving task</title>
<p>In the patch leaving time task the subjects chose between staying in the current patch or traveling to a new patch [<xref rid="pcbi.1004164.ref019" ref-type="bibr">19</xref>] in each trial. The state relevant to choices is defined by the current amount of juice and the travel delay. If they stay in the current patch, they receive a (slightly delayed) reward, and the amount of reward that they will receive in the next trial if they again choose to stay in the current patch is decreased. If they choose to leave the current patch they have to wait for a known travel delay and they receive no immediate reward. The amount of reward that will be received in the new patch is reset to a fixed level and the travel time to the next new patch is sampled from the distribution of possible travel times (<xref rid="pcbi.1004164.g006" ref-type="fig">Fig. 6A</xref>). The patch leaving time task was modeled as an infinite horizon, discounted MDP. The relevant state variables when a decision is made are given by the current travel delay and the current reward estimate (<xref rid="pcbi.1004164.g006" ref-type="fig">Fig. 6A</xref>). From the model one can calculate the difference in action value for staying in the patch vs. leaving for another patch (<xref rid="pcbi.1004164.g006" ref-type="fig">Fig. 6B and 6C</xref>). It can be seen that the longer the travel time, the longer one stays in the patch (<xref rid="pcbi.1004164.g006" ref-type="fig">Fig. 6D</xref>), consistent with what was shown previously with heuristic models [<xref rid="pcbi.1004164.ref019" ref-type="bibr">19</xref>]. However, this effect only occurs for discount parameters less than 1. The undiscounted model is insensitive to finite travel times (<xref rid="pcbi.1004164.g006" ref-type="fig">Fig. 6E and 6F</xref>). This is because undiscounted infinite horizon MDPs are insensitive to finite time delays. Stated another way, if K is the mean first passage time to a state s<sub>t</sub> = j and from state j one follows the optimal policy, then with an infinite horizon the value function can be written [<xref rid="pcbi.1004164.ref026" ref-type="bibr">26</xref>]:
<disp-formula id="pcbi.1004164.e010">
<alternatives>
<graphic id="pcbi.1004164.e010g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e010" xlink:type="simple"/>
<mml:math display="block" id="M10" overflow="scroll">
<mml:msubsup><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">π</mml:mi></mml:mrow></mml:msubsup><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">lim</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> ∞</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mfenced open="⟨" close="⟩" separators="|"><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">π</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">lim</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> ∞</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mfenced open="⟨" close="⟩" separators="|"><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">π</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
From this it can be seen that actions taken prior to entering state j, at time K, do not matter. This is because the first sum is finite if the rewards are finite, and so it goes to zero in the limit. In the foraging task, if K is the time to get to the inter-trial interval (ITI) after choosing to travel, it doesn’t matter how long K is for finite K.</p>
</sec>
<sec id="sec009">
<title>Foraging-by-sampling</title>
<p>The final task is a variant on standard foraging tasks. The state for this task is given by the current gamble pair on offer and the state space includes all the possible gamble pairs. In most foraging tasks a decreasing marginal reward in the current patch eventually drives the action value to leave the patch above the action value to stay in the patch, because leaving has a fixed expected value. This task, however, used a paradigm in which one samples, in each trial, two gambles from a set of six possible individual gambles (<xref rid="pcbi.1004164.g007" ref-type="fig">Fig. 7A</xref>). The six individual gambles from which the pairs were drawn were shown for the current foraging bout and their reward values were known (e.g. gamble 1 may have had a value of 12 points). In each round, a pair of gambles from the set of individual gambles was sampled (15 possible pairs assuming sampling without replacement from the 6, and symmetry of gambles). For example, if the gambles for a given session were g1 … g6, a subject might be shown in a single trial g3 and g5. They then have to decide whether to engage with that offer pair, or sample again. If they sampled again, a new pair was drawn from the current set of six possible gambles (perhaps g2 and g3). Every time the subjects sampled again they also incurred a cost-to-sample. (Note that a cost-to-sample is paid at the time of sampling, and it does not decrease the value of future gambles, in an MDP.) If they decided to accept the offer, they moved to a decision stage. In this stage the probability that the reward associated with each gamble would be delivered was revealed, and this probability was randomly assigned to each gamble every time the decision stage was entered. The subjects had to choose one of the two gambles in the decision stage based on its magnitude and the associated probability. For example they might be choosing between p<sub>1</sub>g<sub>1</sub> and p<sub>4</sub>g<sub>4</sub> where pi is the probability that the subjects will receive reward gi if they choose that gamble in the decision stage. The agent then selects the gamble that has the highest expected value.</p>
<p>The value of sampling again is given by the FEV. The FEV is not equal to the average values of the individual gambles. The FEV is the expected value of future draws (see <xref rid="sec014" ref-type="sec">methods</xref>), plus the cost-to-sample. The time horizon is long, and many future samples could be drawn. However, the cost-to-sample decreases the value of future samples linearly with time, when viewed from the present decision. This can be compared to exponential discounting which exponentially decreases the value of future samples. With a sufficient time horizon the FEV is fixed. The task provided no explicit time horizon so we modeled it as a finite (although long) time horizon MDP. Therefore one simply samples until the IEV of the offered pair exceeds the (constant) FEV (<xref rid="pcbi.1004164.g007" ref-type="fig">Fig. 7B</xref>). It is important to point out that sampling more in this foraging task, unlike the beads task, does not improve the IEV. In other words, the IEV does not necessarily increase with samples, although one can sample a pair with a better IEV. This is related to the state space of the problem. Additionally, without a cost-to-sample, the optimum strategy would be to sample until the pair with the highest value is drawn. The cost-to-sample creates a situation where choice of a gamble pair that is not the largest is optimal, because it may cost too much to obtain a better pair.</p>
</sec>
</sec>
<sec id="sec010" sec-type="conclusions">
<title>Discussion</title>
<p>We have applied markov decision process models (MDPs/POMDPs) to choice tasks that have been used to study the explore-exploit tradeoff, information sampling and foraging. The models allowed us to determine the normative choice mechanisms in these tasks, and therefore they provide insight into their similarities and differences. All of the tasks manipulate trade-offs between immediate and future expected values (IEVs vs. FEVs). Temporal-discounting tasks explicitly manipulate this trade-off. We have not considered them in the present study, but we have modeled them previously using MDPs [<xref rid="pcbi.1004164.ref005" ref-type="bibr">5</xref>]. Normative exploration in the bandit tasks can be defined as the choice of an option whose IEV is smaller but whose FEV is larger than an option with which one has more experience. This also drives exploration when there is non-stationarity, or when novel options are presented, because both of these increase uncertainty. In information sampling tasks an explicit trade-off is setup between sampling again, the action value for which is driven by the FEV (plus a small cost-to-sample), vs. inferring an option, the action value for which is driven by the IEV. Finally, foraging tasks also present the option of staying in the current patch, which has a larger IEV but a decreasing FEV, or traveling to a new patch, an action for which the IEV is zero but the FEV is larger. Across these tasks the IEVs and FEVs are calculated in different ways. In other words, the mechanisms that underlie value estimation differ across tasks. When trying to understand the neural circuits and underlying neural processes that carry out decisions in these tasks, it will be important to understand how these computations are carried out in the brain.</p>
<sec id="sec011">
<title>Task specific results</title>
<p>We began by examining the explore exploit trade-off in a two-armed bandit task, in which the reward amount for both options was the same, but they differed on the fraction of times that they were rewarded. Bandit tasks have been used to study learning in healthy and clinical populations [<xref rid="pcbi.1004164.ref031" ref-type="bibr">31</xref>,<xref rid="pcbi.1004164.ref032" ref-type="bibr">32</xref>]. In the first few trials there is value to sampling both options, and unsampled options have a larger FEV. This future expected value depends on three factors. First, the distribution over possible reward probabilities for the unsampled option is broad, given by the prior. Thus, the unsampled option may be more rewarding than the options which have been sampled. Second, if the unsampled option is sampled, and it is not as good as the other options, the subject can switch back to the other options. However, if the (previously) unsampled option is better than the other options, the subject can stick with it. Finally, the time horizon must be long enough to reap the rewards of investing samples in the novel option.</p>
<p>Heuristically, one could consider the following approximate example. Assume that one has sampled one of two available options (call it option 1) and found that it is being rewarded 70% of the time, and that one now has 100 more trials. One could then sample the alternative option (option 2) 10 times. If option 2 is rewarded 80% of the time one could then stick with that option, gaining on average 80 rewards over the 100 trial horizon. If it is found that option 2 is only rewarded 20% of the time, then one could switch back to option 1, gaining 0.2*10 + 0.7*90 = 65 rewards on average. If option 2’s (i.e. all option 2’s that one encounters, in repeated plays of the task) are either rewarded 80% of the time, or 20% of the time, the average reward with this simplified strategy will be 72.5 over the 100 trials, whereas it would only be 70 if one always stuck with option 1. The 2.5 additional rewards on average is the exploration bonus. It depends on the possibility that the novel option is better than the current option, the fact that one will switch back to the alternative if it is better than the novel option, and having a sufficient time horizon.</p>
<p>We also examined two other tasks which are extensions of the bandit task. Specifically, a non-stationary bandit [<xref rid="pcbi.1004164.ref009" ref-type="bibr">9</xref>], and a novelty task [<xref rid="pcbi.1004164.ref005" ref-type="bibr">5</xref>,<xref rid="pcbi.1004164.ref008" ref-type="bibr">8</xref>,<xref rid="pcbi.1004164.ref029" ref-type="bibr">29</xref>,<xref rid="pcbi.1004164.ref033" ref-type="bibr">33</xref>]. In the non-stationary bandit the mean reward magnitudes of the two options follow independent random walks. When an option is sampled several times, a relatively accurate (i.e. low variance) estimate of its mean can be derived. However, when an option is not sampled, the distribution of its mean becomes broad. When a random walk is not observed for a period of time, the variance of its estimate grows linearly with time. One way to conceptualize this, relative to the stationary bandit, is to say that when an option has not been sampled for some time, it becomes like a new option, and there is value in exploring it. This is true of any tasks that have an underlying non-stationarity in the reward [<xref rid="pcbi.1004164.ref034" ref-type="bibr">34</xref>]. It is, however, variance in the estimate of the mean that drives the exploration bonus. When the variance gets large, the option might be better than the current options, and exploration is advantageous. Similarly in the novelty task, when a novel option is substituted for one of the options that has been sampled, the reward probability for the novel option is unknown, and therefore it is valuable to explore it.</p>
<p>Next we examined the beads or urn task [<xref rid="pcbi.1004164.ref004" ref-type="bibr">4</xref>,<xref rid="pcbi.1004164.ref005" ref-type="bibr">5</xref>,<xref rid="pcbi.1004164.ref020" ref-type="bibr">20</xref>–<xref rid="pcbi.1004164.ref022" ref-type="bibr">22</xref>,<xref rid="pcbi.1004164.ref030" ref-type="bibr">30</xref>,<xref rid="pcbi.1004164.ref035" ref-type="bibr">35</xref>]. This is an information sampling task, similar in structure to other sampling tasks [<xref rid="pcbi.1004164.ref036" ref-type="bibr">36</xref>]. The POMDP model for this task only optimized choices in single trials with an explicit cost-to-sample. It did not optimize reward rates over multiple trials. Subjects are given the option to sample as much information as they would like, before guessing an urn. The choice to sample rests on the belief that the FEV of sampling is greater than the IEV of guessing an urn. In this respect, sampling is similar to exploring, as it is a choice in favor of the FEV, relative to the IEV. It differs from exploration, however, in that exploration in bandit tasks usually has some IEV. That is, choice of the unknown option in bandit tasks usually leads to some reward. This does not need to be true in general. In information sampling tasks, however, choosing to sample usually leads to zero IEV (or a slightly negative IEV, given by the cost to sample). In this way, sampling is more similar to foraging. It is also worth pointing out that reaction time versions of perceptual inference tasks can be modeled within a framework that is equivalent to the approach used here to model information sampling [<xref rid="pcbi.1004164.ref037" ref-type="bibr">37</xref>,<xref rid="pcbi.1004164.ref038" ref-type="bibr">38</xref>]. Perceptual inference tasks, as well as many other choice tasks, are often modeled using a drift-diffusion framework, and it is assumed that when an evidence bearing particle crosses a threshold a decision is made. The “threshold” crossing is a choice to stop sampling. It is often inferred for drift diffusion models in perceptual inference tasks, on the basis of behavioral reaction times. But with an MDP the threshold can be calculated dynamically, on the basis of current levels of belief, costs-to-sample, and transition probabilities [<xref rid="pcbi.1004164.ref038" ref-type="bibr">38</xref>]. Thus, an optimal threshold can be inferred for any tractable task.</p>
<p>The final tasks we considered were foraging tasks. These tasks also trade-off immediate vs. future expected values. The choice to forage leads to a zero IEV. The action value of choosing to forage is entirely an FEV. Foraging tasks differ from the tasks considered above, because their state spaces have a recursive structure and the state is observed, not inferred from information bearing observations. The tasks loop through their recursive state spaces over and over again. The choice is defined as a comparison between current and future stochastic offers. The current offer can be to stay in the patch and collect an approximately known, decreasing reward, or take the current pair of gambles that have been offered. The future stochastic offer can be explicitly calculated from the information given. It is either the value of a new patch, given the current travel time, or the expected value of the decision stage for the set of gambles that can be drawn from the current set. These average values are fixed with a sufficient time horizon. Therefore the strategy is to either stay in the current patch until the reward value drops below the value of leaving, or to sample gambles until the sampled gamble is worth more than the expected value of future samples. In foraging tasks there is generally no updating of distribution estimates, and therefore foraging differs fundamentally from exploration, in this respect.</p>
</sec>
<sec id="sec012">
<title>Factors driving choice strategies across tasks</title>
<p>There are two important factors that drive choice preferences across these tasks. The first is uncertainty, and the second is the time horizon. Uncertainty affects these models in two ways. First, in bandit tasks when novel options are available, or equivalently when non-stationary options have not been explored for some time, the distribution of possible reward values is broad and uncertainty is high. Therefore, sampling the options a few times to learn about them is valuable, given a sufficient time horizon. The value of this uncertainty is driven by the future expected value. The sampling itself, however, decreases uncertainty about the options. When one learns that an option either is, or is not valuable, then one can act accordingly. Thus, increased uncertainty drives value through the FEV. Because we used models that maximize expected reward, uncertainty does not affect IEV. However, as uncertainty can lead to a larger FEV, decreasing uncertainty and therefore decreasing FEV increases the relative importance of IEV on the total action value. The same reasoning applies to the information sampling tasks. As long as uncertainty is high, the FEV is high. When uncertainty is decreased, however, the IEV of guessing an urn becomes larger. Interestingly, and in contrast to this, increasing uncertainty in temporal-discounting tasks actually decreases preference for delayed, larger rewards [<xref rid="pcbi.1004164.ref005" ref-type="bibr">5</xref>]. (Temporal-discounting tasks are tasks in which subjects are offered a choice between an immediate smaller reward and a delayed larger reward.) This is because of the state space of temporal-discounting tasks. One can model temporal discounting tasks using an MDP which, at each time step, includes the possibility of exiting the path to the reward and terminating in a state with no reward, with some probability. If this probability of terminating in a no reward state increases, it becomes less likely that one will get to the reward, for a fixed delay to the reward. Interestingly, this is thought to be a fundamental factor that drives crime [<xref rid="pcbi.1004164.ref039" ref-type="bibr">39</xref>].</p>
<p>Time horizon is also important. In infinite horizon problems the time horizon is controlled by the discount parameter. In bandit problems, the time horizon affects the relative value of exploration. In stationary problems the time-horizon affects the relative value of exploring novel or unknown options. Longer time-horizons, or discount parameters closer to 1, increase the value of exploration. In non-stationary environments this relationship is more complex, as the non-stationarity limits the effective time-horizon of any policy. In foraging tasks, however, time horizon is also important. In undiscounted infinite horizon problems, travel times are irrelevant. If one has an infinite, undiscounted time horizon, then any finite travel time does not affect value. In the non-stationary bandit task, when the discount parameter approaches one, the algorithm samples options with lower means more often. As another example, consider the simplified MDP shown in <xref rid="pcbi.1004164.g008" ref-type="fig">Fig. 8</xref>. The undiscounted, infinite horizon solution to this problem does not favor action 1 over action 2 [<xref rid="pcbi.1004164.ref040" ref-type="bibr">40</xref>] because the relative value of this initial transient reward will be zero in the infinite time limit. Methods such as sensitive discount optimality exist to deal with such situations, although these can only be applied to tractable state spaces [<xref rid="pcbi.1004164.ref040" ref-type="bibr">40</xref>]. However, a discounted MDP favors action 1, in this case. This suggests that temporal discounting, in some form, is ubiquitous because it is always biologically (or computationally) relevant. Whether discounting is specifically exponential or hyperbolic, or takes on some other form is less the issue. More important is some sort of monotonic decrease in the value of future rewards with distance into the future.</p>
<fig id="pcbi.1004164.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004164.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Example MDP.</title>
<p>Note that from state 1, picking action 1 leads to a reward of 1000, and a deterministic transition to state 2. Picking action 2 from state 1 leads to a reward of 1 and a deterministic transition to state 2. Only one action is available in state 2. It leads to a reward of 1 and a deterministic self-transition.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.g008" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec013" sec-type="conclusions">
<title>Conclusion</title>
<p>The explore-exploit trade-off is often modeled with heuristics. A strong criticism of heuristics is that they explain no more than they assume, and tell us no more than the data does [<xref rid="pcbi.1004164.ref028" ref-type="bibr">28</xref>]. Heuristics, however, can provide reasonable solutions to engineering problems, often provide insight into patterns in the data, and may better approximate behavior than normative models [<xref rid="pcbi.1004164.ref015" ref-type="bibr">15</xref>]. For example, recent work has explicitly examined the role of noisy vs. directed exploration, and found that human subjects use both directed and noisy exploration strategies [<xref rid="pcbi.1004164.ref031" ref-type="bibr">31</xref>]. In some cases, however, heuristics can be difficult to interpret. For example, the beta or inverse temperature parameter in delta-rule reinforcement learning (DRRL) is often thought to control the “explore-exploit” trade-off. This parameter can only control noise in choice processes, however, and standard implementations of DRRL do not turn this noise down as reward values are learned. Therefore, exploration cannot be differentiated from noise in the choice process using this parameter and poor learning looks like exploration. Several more sophisticated variants including Thompson sampling [<xref rid="pcbi.1004164.ref041" ref-type="bibr">41</xref>,<xref rid="pcbi.1004164.ref042" ref-type="bibr">42</xref>] and related algorithms [<xref rid="pcbi.1004164.ref043" ref-type="bibr">43</xref>], however, decrease exploration with learning and can achieve minimal regret.</p>
<p>In an MDP framework exploration need not be undirected or noisy. Exploration can be an intentional, directed, normative strategy if there is sufficient knowledge of the environment and the agent has sufficient computational resources. One does not necessarily explore so much as one learns or accumulates information (bandit or information sampling tasks) until the additional information indicates that an alternative choice is better. Every choice delivers some information, because one is always transitioning through states as choices deliver information in these tasks. Equivalently, leaving the current patch in a foraging task is an explicit calculation of the relative value of traveling to a new patch, the expected value of which is characterized by some probability distribution over patch values. It is possible that animals have relatively unsophisticated strategies for dealing with these issues. It seems likely, however, that they have developed at least a good approximation to the underlying normative utilities, at least in tasks that match the animal’s ecological nitch or on which the animals have extensive experience.</p>
</sec>
</sec>
<sec id="sec014" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec015">
<title>Markov decision processes</title>
<p>We modeled the tasks using markov decision processes with either observable (MDP) or partially observable (POMDP) states. Tasks were modeled as finite or infinite horizon, discrete time, and discounted (i.e. with a discount parameter <italic>γ</italic> &lt; 1) or undiscounted (i.e. with a discount parameter <italic>γ</italic> = 1) as indicated in the manuscript. Some models also included a cost-to-sample. For discrete state models the utility, <italic>u</italic>, of a state, <italic>s</italic>, at time t is
<disp-formula id="pcbi.1004164.e011">
<alternatives>
<graphic id="pcbi.1004164.e011g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e011" xlink:type="simple"/>
<mml:math display="block" id="M11" overflow="scroll"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>a</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
</disp-formula>
where <inline-formula id="pcbi.1004164.e012"><alternatives><graphic id="pcbi.1004164.e012g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e012" xlink:type="simple"/><mml:math display="inline" id="M12" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the set of available actions in state s at time t, <italic>r</italic>(<italic>s</italic><sub><italic>t</italic></sub>,<italic>α</italic>) is the reward that will be obtained in state s at time t if action a is taken. The variable <italic>C</italic>(<italic>s</italic><sub><italic>t</italic></sub>,<italic>α</italic>) is a cost-to-sample, which may be zero. The summation on j is taken over the set of possible subsequent states, S at time t+1. It is the expected future utility, taken across the transition probability distribution <italic>p</italic>(<italic>j</italic>|<italic>s</italic><sub><italic>t</italic></sub>,<italic>α</italic>). The transition probability is the probability of transitioning into each state j from the current state, s<sub>t</sub> if one takes action a. The <italic>γ</italic> term represents a discount factor. The terms inside the curly brackets are the action value, <italic>Q</italic>(<italic>s</italic><sub><italic>t</italic></sub>,<italic>α</italic>) = <italic>r</italic>(<italic>s</italic><sub><italic>t</italic></sub>,<italic>α</italic>) + <italic>C</italic>(<italic>s</italic><sub><italic>t</italic></sub>,<italic>α</italic>) + <italic>γ</italic>Σ<sub><italic>j</italic>∈<italic>s</italic></sub><italic>p</italic>(<italic>j</italic>|<italic>s</italic><sub><italic>t</italic></sub>,<italic>α</italic>)<italic>u</italic><sub><italic>t</italic>+1</sub>(<italic>j</italic>), for each available action. For continuous state models the utility is
<disp-formula id="pcbi.1004164.e013">
<alternatives>
<graphic id="pcbi.1004164.e013g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e013" xlink:type="simple"/>
<mml:math display="block" id="M13" overflow="scroll">
<mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mrow><mml:msubsup><mml:mo stretchy="false">∫</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow/></mml:msubsup><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
All state integrals over continuous states were calculated with discrete approximations. Equations 1 and 2 assume a reward maximizing agent, through the max operator.</p>
<p>For discrete state, finite horizon models with tractable state spaces, we used the backward induction algorithm to calculate utilities and action values [<xref rid="pcbi.1004164.ref028" ref-type="bibr">28</xref>]. This was done for the 2-armed stationary bandit, beads and sampling foraging tasks. With a finite horizon the final state delivers a reward, but no further actions are possible. Therefore, if we start by defining the utilities of the final states, we can work backwards and define the utilities of all previous states. Specifically, the algorithm proceeds as follows [<xref rid="pcbi.1004164.ref040" ref-type="bibr">40</xref>], where N is the final state.</p>
<p>1. Set t = N
<disp-formula id="pcbi.1004164.e014"><alternatives><graphic id="pcbi.1004164.e014g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e014" xlink:type="simple"/><mml:math display="block" id="M14" overflow="scroll"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">N</mml:mi></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">ϵ</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
<p>2. Substitute t-1 for t and compute
<disp-formula id="pcbi.1004164.e015">
<alternatives>
<graphic id="pcbi.1004164.e015g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e015" xlink:type="simple"/>
<mml:math display="block" id="M15" overflow="scroll">
<mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi>m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
Set
<disp-formula id="pcbi.1004164.e016">
<alternatives>
<graphic id="pcbi.1004164.e016g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e016" xlink:type="simple"/>
<mml:math display="block" id="M16" overflow="scroll">
<mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>3. If t = 1 stop, otherwise return to 2.</p>
<p>The non-stationary 2-armed bandit, novelty and patch-leaving foraging tasks were modeled as infinite horizon POMDPs or MDPs. The utilities were fit using the value iteration algorithm [<xref rid="pcbi.1004164.ref040" ref-type="bibr">40</xref>]. This algorithm proceeds as follows. First, the vector of utilities across states, <italic>v</italic><sup>0</sup>, was initialized to random values. We set the iteration index, n = 0. Then computed:
<disp-formula id="pcbi.1004164.e017">
<alternatives>
<graphic id="pcbi.1004164.e017g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e017" xlink:type="simple"/>
<mml:math display="block" id="M17" overflow="scroll">
<mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
After each iteration we calculated the change in the value estimate, <inline-formula id="pcbi.1004164.e018"><alternatives><graphic id="pcbi.1004164.e018g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e018" xlink:type="simple"/><mml:math display="inline" id="M18" overflow="scroll"><mml:mo>Δ</mml:mo><mml:mi>v</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, and examined either ||Δ<italic>v</italic>||&lt;∈ or span(Δ<italic>v</italic>) &lt;∈. The span is defined as.<italic>span</italic>(<italic>v</italic>) = <italic>max</italic><sub><italic>s∈S</italic></sub> <italic>v</italic>(<italic>s</italic>)—<italic>min</italic><sub><italic>s∈S</italic></sub> <italic>v</italic>(<italic>s</italic>) For infinite horizon undiscounted models the value continues to grow with iterations of <xref rid="pcbi.1004164.e017" ref-type="disp-formula">equation 3</xref>, but the spans converge [<xref rid="pcbi.1004164.ref040" ref-type="bibr">40</xref>]. This is because the final state values are the average costs per stage plus a differential. This only applied to the foraging patch leaving example with discount parameter equal to 1. We only examined differential values, in that case, so the average cost per stage is subtracted out, because it is added to all states.</p>
<p>We also used approximate methods for the non-stationary 2-armed bandit and the novelty task, as their state spaces were intractable over relevant time horizons. For these POMDPs we defined a basis, and then approximated the utility with
<disp-formula id="pcbi.1004164.e019">
<alternatives>
<graphic id="pcbi.1004164.e019g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e019" xlink:type="simple"/>
<mml:math display="block" id="M19" overflow="scroll">
<mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:mrow></mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
In all cases we used fixed basis functions so we could calculate the basis coefficients, a<sub>i</sub> using least squares techniques. We assembled a matrix Φ<sub><italic>i</italic>,<italic>j</italic></sub> = ϕ<sub><italic>i</italic></sub>(<italic>s</italic><sub><italic>j</italic></sub>), which contains the values of the basis functions for specific states, <italic>s</italic><sub><italic>j</italic></sub>. We then calculated a projection matrix
<disp-formula id="pcbi.1004164.e020">
<alternatives>
<graphic id="pcbi.1004164.e020g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e020" xlink:type="simple"/>
<mml:math display="block" id="M20" overflow="scroll">
<mml:mi>H</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msup><mml:mrow><mml:mi>Φ</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>Φ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup><mml:mi>Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>Φ</mml:mi><mml:mi mathvariant="normal">'</mml:mi>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
And calculated the approximation
<disp-formula id="pcbi.1004164.e021">
<alternatives>
<graphic id="pcbi.1004164.e021g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e021" xlink:type="simple"/>
<mml:math display="block" id="M21" overflow="scroll">
<mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>H</mml:mi><mml:mi>v</mml:mi><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
The bold indicates the vector over states, or the sampled states at which we computed the approximation. When using the approximation in the value iteration algorithm, we first compute the approximation,<inline-formula id="pcbi.1004164.e022"><alternatives><graphic id="pcbi.1004164.e022g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e022" xlink:type="simple"/><mml:math display="inline" id="M22" overflow="scroll"><mml:mi mathvariant="normal"> </mml:mi><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. We then plug the approximation into the right hand side of <xref rid="pcbi.1004164.e017" ref-type="disp-formula">equation 3</xref>, <inline-formula id="pcbi.1004164.e023"><alternatives><graphic id="pcbi.1004164.e023g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e023" xlink:type="simple"/><mml:math display="inline" id="M23" overflow="scroll"><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. We then calculate approximations to the new values <inline-formula id="pcbi.1004164.e024"><alternatives><graphic id="pcbi.1004164.e024g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e024" xlink:type="simple"/><mml:math display="inline" id="M24" overflow="scroll"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>H</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>. This is repeated until convergence.</p>
<p>For basis functions we used piece-wise polynomials and/or b-splines [<xref rid="pcbi.1004164.ref044" ref-type="bibr">44</xref>]. For b-splines see [<xref rid="pcbi.1004164.ref044" ref-type="bibr">44</xref>]. For piecewise polynomials, the first basis functions are given by <italic>h</italic><sub><italic>i</italic></sub>(<italic>x</italic>) = x<sup><italic>i-1</italic></sup>. For an order K spline (i.e. for cubic K = 3), i goes from 1 to K+1. In addition to these global polynomials, we also add <italic>hj</italic>(<italic>x</italic>) = (<italic>x-t</italic><sub><italic>j</italic></sub>)<sup><italic>K</italic></sup> for the J knots, <italic>t</italic><sub><italic>j</italic></sub>. Because all of the state spaces were multidimensional and the piece-wise polynomial basis varied between knots, we also had to compute products of the basis functions across dimensions. Computing the full tensor product basis space was usually intractable. It created a projection matrix that either could not be stored in memory or iteration over the very large projection matrix was so slow that the algorithm would not converge in a reasonable amount of time. Therefore we started with linear terms and added interaction terms of increasing order (i.e. second order, third order, …) until the approximation stopped improving. We did not find an improvement by going beyond the quadratic terms.</p>
<p>Knot locations were explored systematically to find locations that led to good approximations. Approximations were checked in several ways. First, we plotted <italic>v</italic><sup><italic>n+1</italic></sup> vs. <inline-formula id="pcbi.1004164.e025"><alternatives><graphic id="pcbi.1004164.e025g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e025" xlink:type="simple"/><mml:math display="inline" id="M25" overflow="scroll"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> to see that they were consistent after convergence, as well as checking the variance of the residual. Second, we added knots to see if the fit was improved. Third, we increased the order of the polynomial to see if the fit was improved. Cubic polynomials (i.e. K = 3) were used in all cases. When the order was increased beyond cubic the value iteration often diverged. Finally, performance of the approximate inference MDP for the novelty task could be compared to a corresponding finite horizon model, at least for short time horizons to see if they made consistent predictions.</p>
<p>For the novelty task, the numerics were easier to implement if we approximated the number of samples for each option (N) and the probability that it was rewarded (p). We used a 3<sup>rd</sup> order B-spline basis. Knot locations for N were 0 and 150, and the algorithm was optimized at (using Matlab colon operator notation) N = <inline-formula id="pcbi.1004164.e026"><alternatives><graphic id="pcbi.1004164.e026g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e026" xlink:type="simple"/><mml:math display="inline" id="M26" overflow="scroll"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>:</mml:mo><mml:mfrac><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:mo>:</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> and p = 0: 0.25: 1. The N values were not integers, but this does not affect evaluation of the value function. Interactions up to second order were included. For the non-stationary two-armed bandit, the means were fit with a 3<sup>rd</sup> order B-spline, and the standard deviations were fit with a 2nd order piece-wise polynomial. This approach gave well-behaved value functions. The node locations for the means were given by -30 50 and 130. The means were evaluated at 0, 12.5, 25, 37.5, 50, 62.5, 75, 87.5, 100. The node locations for the standard deviations were given by 0.25, 1, 3, 5, and 15. The standard deviations were evaluated at 0.5, 1, 2, 3, 4, 5, 7 and 14. Interactions between all basis functions up to second order were included in the model.</p>
</sec>
<sec id="sec016">
<title>Task specific details of the MPD models</title>
<sec id="sec017">
<title>The stationary two-armed bandit task</title>
<p>In the stationary two-armed bandit task one can select one of two possible bandits (actions) in each trial. Each bandit pays out with some fixed, stationary probability, and the reward amount is always the same. We modeled the task with a finite horizon, finite state, undiscounted POMDP. The state space is a discrete information state, therefore the underlying model is a discrete MDP. The state space is given by the number of times each option is chosen, and the number of times each option is rewarded, including prior information. This state space grows with trials, limiting the time horizon that can be modeled. We use lower case to indicate actual choices and rewards (r<sub>1</sub>, c<sub>1</sub>, r<sub>2</sub>, c<sub>2</sub>), and upper case to indicate posterior expected values, that incorporate prior information about choices and rewards (R<sub>1</sub>, C<sub>1</sub>, R<sub>2</sub>, C<sub>2</sub>). For a single option, assuming a beta(α,β) prior, the expected posterior reward probability, q, is <inline-formula id="pcbi.1004164.e027"><alternatives><graphic id="pcbi.1004164.e027g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e027" xlink:type="simple"/><mml:math display="inline" id="M27" overflow="scroll"><mml:mfenced open="〈" close="〉" separators="|"><mml:mrow><mml:mi>q</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>. The expected reward for each option under a beta(1,1) prior is
<inline-formula id="pcbi.1004164.e028"><alternatives><graphic id="pcbi.1004164.e028g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e028" xlink:type="simple"/><mml:math display="inline" id="M28" overflow="scroll"><mml:mo>&lt;</mml:mo><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>q</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>. State transitions are given by q. If option i is chosen, there is a transition to <italic>R</italic><sub><italic>i</italic></sub>+1,<italic>C</italic><sub><italic>i</italic></sub>+1 with probability <italic>R</italic><sub><italic>i</italic></sub>/<italic>C</italic><sub><italic>i</italic></sub> and there is a transition to <italic>R</italic><sub><italic>i</italic></sub>,<italic>C</italic><sub><italic>i</italic></sub>+1 with probability <italic>1-R</italic><sub><italic>i</italic></sub>/<italic>C</italic><sub><italic>i</italic></sub>. Utilities for this model can be calculated using backwards induction.</p>
</sec>
<sec id="sec018">
<title>The non-stationary two-armed bandit task</title>
<p>In this task there are again two bandit options. The reward delivered by each bandit is continuous, and the expected reward follows a decaying random walk. We modeled this task using an infinite horizon, continuous state, discounted, POMDP. In this case the information state is continuous, so the model is more complex than the previous POMDPs. The utilities were modeled using a basis approximation. The state space is an information space given by the current estimate of the mean and variance of the payout for each bandit [<xref rid="pcbi.1004164.ref045" ref-type="bibr">45</xref>]. We used the state transition model given in the original publication [<xref rid="pcbi.1004164.ref009" ref-type="bibr">9</xref>], except we only modeled two bandits to constrain the dimensionality of the model and make it tractable. The mean of the reward payout is given by a decaying random walk:
<disp-formula id="pcbi.1004164.e029">
<alternatives>
<graphic id="pcbi.1004164.e029g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e029" xlink:type="simple"/>
<mml:math display="block" id="M29" overflow="scroll">
<mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>λ</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mfenced><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula>
The payout is given by:
<disp-formula id="pcbi.1004164.e030">
<alternatives>
<graphic id="pcbi.1004164.e030g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e030" xlink:type="simple"/>
<mml:math display="block" id="M30" overflow="scroll">
<mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula>
With <inline-formula id="pcbi.1004164.e031"><alternatives><graphic id="pcbi.1004164.e031g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e031" xlink:type="simple"/><mml:math display="inline" id="M31" overflow="scroll"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>7.84</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>16</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi></mml:math></alternatives></inline-formula><italic>λ</italic> = 0.9836 and <italic>θ</italic> = 50. Both noise distributions were i.i.d. A Kalman filter can be used to track the mean for this model. The Kalman filter update for the mean and variance of the chosen option, following a reward, <italic>y</italic><sub><italic>i</italic></sub>(<italic>t</italic>),is given by:
<disp-formula id="pcbi.1004164.e032">
<alternatives>
<graphic id="pcbi.1004164.e032g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e032" xlink:type="simple"/>
<mml:math display="block" id="M32" overflow="scroll">
<mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula>
<disp-formula id="pcbi.1004164.e033">
<alternatives>
<graphic id="pcbi.1004164.e033g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e033" xlink:type="simple"/>
<mml:math display="block" id="M33" overflow="scroll">
<mml:msub><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004164.e034">
<alternatives>
<graphic id="pcbi.1004164.e034g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e034" xlink:type="simple"/>
<mml:math display="block" id="M34" overflow="scroll">
<mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup>
</mml:math>
</alternatives>
</disp-formula>
And for the unchosen option
<disp-formula id="pcbi.1004164.e035">
<alternatives>
<graphic id="pcbi.1004164.e035g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e035" xlink:type="simple"/>
<mml:math display="block" id="M35" overflow="scroll">
<mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>λ</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mfenced><mml:mi>θ</mml:mi>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula>
<disp-formula id="pcbi.1004164.e036">
<alternatives>
<graphic id="pcbi.1004164.e036g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e036" xlink:type="simple"/>
<mml:math display="block" id="M36" overflow="scroll">
<mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup>
</mml:math>
</alternatives>
</disp-formula>
The information state is all past observed outcomes [<xref rid="pcbi.1004164.ref045" ref-type="bibr">45</xref>]. Because the non-stationary bandit model is Gaussian, however, the sufficient statistics are given by the mean and variance of the Gaussian distribution for each bandit. Therefore the information space for this POMDP, equivalent to the state space for the MDP, can be compactly represented: <inline-formula id="pcbi.1004164.e037"><alternatives><graphic id="pcbi.1004164.e037g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e037" xlink:type="simple"/><mml:math display="inline" id="M37" overflow="scroll"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> as the estimated mean and standard deviation (or variance) of each bandit. We do not have to retain all past outcomes, and the size of the information state space does not grow with time. For this model, the utility equation requires computation of an expectation over the observed variable given the information state. Specifically,
<disp-formula id="pcbi.1004164.e038">
<alternatives>
<graphic id="pcbi.1004164.e038g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e038" xlink:type="simple"/>
<mml:math display="block" id="M38" overflow="scroll">
<mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mfenced open="〈" close="〉" separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mrow><mml:msubsup><mml:mo stretchy="false">∫</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mi>ϵ</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mrow/></mml:msubsup><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula>
This integral was calculated numerically by discretizing y over +/- 2 standard deviations, and sampling 10 points. Increasing the range of y or density of sampling had minimal impact on the result. The reward expectation is given by:
<disp-formula id="pcbi.1004164.e039">
<alternatives>
<graphic id="pcbi.1004164.e039g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e039" xlink:type="simple"/>
<mml:math display="block" id="M39" overflow="scroll">
<mml:msub><mml:mrow><mml:mfenced open="〈" close="〉" separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:munderover><mml:mo stretchy="false">∫</mml:mo><mml:mrow/><mml:mrow/></mml:munderover><mml:mrow><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mi>p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula>
which is the mean of the Gaussian. The distribution over observed values is given by:
<disp-formula id="pcbi.1004164.e040">
<alternatives>
<graphic id="pcbi.1004164.e040g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e040" xlink:type="simple"/>
<mml:math display="block" id="M40" overflow="scroll">
<mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:msubsup><mml:mo stretchy="false">∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow/></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow/></mml:msubsup><mml:mrow><mml:mi>p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced open="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula>
Because of the linear Gaussian statistics, the integral in 16, which calculates the marginal distribution of <italic>x</italic><sub><italic>t</italic>+1</sub> and <italic>y</italic><sub><italic>t</italic>+1</sub> gives <inline-formula id="pcbi.1004164.e041"><alternatives><graphic id="pcbi.1004164.e041g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e041" xlink:type="simple"/><mml:math display="inline" id="M41" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004164.e042"><alternatives><graphic id="pcbi.1004164.e042g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e042" xlink:type="simple"/><mml:math display="inline" id="M42" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> [<xref rid="pcbi.1004164.ref046" ref-type="bibr">46</xref>].</p>
</sec>
<sec id="sec019">
<title>The novelty task</title>
<p>The novelty task is a 3-armed bandit task. As with the 2-armed bandit, the options are rewarded with different probabilities but the amount of reward is always 1. The reward probabilities for each bandit are stationary while that option is available. On each trial there is a 5% chance that one of the bandit options will be replaced with a new option. We have previously modeled this task with a truncated time horizon [<xref rid="pcbi.1004164.ref005" ref-type="bibr">5</xref>]. However, the exploration bonus increases with increasing time horizon. Therefore we wanted an approach that allowed us to examine longer time horizons. We used approximate methods to fit an infinite horizon, discrete state, discounted POMDP. The underlying model is, however, a discrete MDP. The state space is the number of times each option has been chosen, and the number of times it has been rewarded, s<sub>t</sub> = {R<sub>1</sub>, C<sub>1</sub>, R<sub>2</sub>, C<sub>2</sub>, R<sub>3</sub>, C<sub>3</sub>}. This state space was approximated using a continuous approximation sampled discretely. The immediate reward estimate is given by the maximum a-posteriori estimate, <inline-formula id="pcbi.1004164.e043"><alternatives><graphic id="pcbi.1004164.e043g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e043" xlink:type="simple"/><mml:math display="inline" id="M43" overflow="scroll"><mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>. The set of possible next states, s<sub>t+1</sub>, is given by the chosen target, whether or not it is rewarded, and whether one of the options is replaced with a novel option [<xref rid="pcbi.1004164.ref005" ref-type="bibr">5</xref>]. Thus, each state leads to 21 unique subsequent states. We define <italic>qi</italic> = <italic>r</italic><sub><italic>t</italic></sub>(<italic>s</italic><sub><italic>t</italic></sub>,<italic>α</italic> = <italic>i</italic>), and p<sub>switch</sub> = 0.05, as the probability of a novel substitution. The transition to a subsequent state without a novel choice substitution and no reward is given by:
<disp-formula id="pcbi.1004164.e044">
<alternatives>
<graphic id="pcbi.1004164.e044g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e044" xlink:type="simple"/>
<mml:math display="block" id="M44" overflow="scroll">
<mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
and for reward by
<disp-formula id="pcbi.1004164.e045">
<alternatives>
<graphic id="pcbi.1004164.e045g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e045" xlink:type="simple"/>
<mml:math display="block" id="M45" overflow="scroll">
<mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
When a novel option was introduced, it could replace the chosen stimulus, or one of the other two stimuli. In this case if the chosen target, i, was not rewarded and a different target, j, was replaced, we have
<disp-formula id="pcbi.1004164.e046">
<alternatives>
<graphic id="pcbi.1004164.e046g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e046" xlink:type="simple"/>
<mml:math display="block" id="M46" overflow="scroll">
<mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>3</mml:mn>
</mml:math>
</alternatives>
</disp-formula>
and if the chosen target was not rewarded and was replaced
<disp-formula id="pcbi.1004164.e047">
<alternatives>
<graphic id="pcbi.1004164.e047g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e047" xlink:type="simple"/>
<mml:math display="block" id="M47" overflow="scroll">
<mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>3</mml:mn>
</mml:math>
</alternatives>
</disp-formula>
And correspondingly, following a reward and replacement of a different target, j, we have
<disp-formula id="pcbi.1004164.e048">
<alternatives>
<graphic id="pcbi.1004164.e048g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e048" xlink:type="simple"/>
<mml:math display="block" id="M48" overflow="scroll">
<mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>3</mml:mn>
</mml:math>
</alternatives>
</disp-formula>
and
<disp-formula id="pcbi.1004164.e049">
<alternatives>
<graphic id="pcbi.1004164.e049g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e049" xlink:type="simple"/>
<mml:math display="block" id="M49" overflow="scroll">
<mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mn>3</mml:mn>
</mml:math>
</alternatives>
</disp-formula>
Note that when a novel option is substituted for the chosen stimulus, the same subsequent state is reached with or without a reward.</p>
</sec>
<sec id="sec020">
<title>The beads task</title>
<p>In the beads task, the goal is to infer which of two urns is being drawn from, given a sequence of draws from one of the urns [<xref rid="pcbi.1004164.ref004" ref-type="bibr">4</xref>]. The proportion of beads in the urns is given. Beads are drawn from one of the urns, one at a time. After each bead is drawn, one can either guess that the urn with mostly blue beads is being drawn from, or that the urn with mostly orange beads is being drawn from, or one can ask to see another bead. We modeled the task as a finite horizon, discrete state, undiscounted POMDP. Because the information state space is discrete (i.e. outcomes can only be blue or orange beads) the underlying model is given by a discrete state MDP. For the current simulations the ratio of beads in the urns was always 60/40. The maximum number of beads that could be drawn was 12. The reward for being correct was 1, and the penalty for being wrong was 0, and the cost to sample was -0.005. The state space is given by the number of draws (<italic>n</italic><sub><italic>d</italic></sub>), and the number of blue (<italic>n</italic><sub><italic>b</italic></sub>) beads that have been drawn, <italic>s</italic><sub><italic>t</italic></sub> = {<italic>n</italic><sub><italic>d</italic></sub>,<italic>n</italic><sub><italic>b</italic></sub>}. For guessing the blue urn, a = blue, we have:
<disp-formula id="pcbi.1004164.e050">
<alternatives>
<graphic id="pcbi.1004164.e050g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e050" xlink:type="simple"/>
<mml:math display="block" id="M50" overflow="scroll">
<mml:mi>r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>b</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula>
where C<sub>e</sub> is the cost of an error (0 for the results here) and C<sub>c</sub> is the reward for being correct, which we set to 1. The probability that we are drawing from the blue urn p<sub>b</sub> is given by
<disp-formula id="pcbi.1004164.e051">
<alternatives>
<graphic id="pcbi.1004164.e051g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e051" xlink:type="simple"/>
<mml:math display="block" id="M51" overflow="scroll">
<mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msup><mml:mrow><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula>
where q is the fraction of beads in the majority urn. The probability of the orange urn, <italic>p</italic><sub><italic>o</italic></sub>, is then 1-<italic>p</italic><sub><italic>b</italic></sub>. The second term in equation 1, which is the value of the next state, is 0 for choosing either blue or orange urns, because choosing an urn terminates the sequence. For drawing again, a = draw, we have
<disp-formula id="pcbi.1004164.e052">
<alternatives>
<graphic id="pcbi.1004164.e052g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e052" xlink:type="simple"/>
<mml:math display="block" id="M52" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>w</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mrow/></mml:msubsup><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula>
where C<sub>s</sub> is the cost of drawing (-0.005 unless otherwise stated). From a given state, s<sub>t</sub>, if one draws again, one draws either a blue or an orange bead, so the two subsequent states are, s<sub>t+1</sub> = n<sub>d</sub>+1, n<sub>b</sub>+1 if a blue bead is drawn or s<sub>t+1</sub> = n<sub>d</sub>+1, n<sub>b</sub> if not. And the transition probabilities are
<disp-formula id="pcbi.1004164.e053">
<alternatives>
<graphic id="pcbi.1004164.e053g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e053" xlink:type="simple"/>
<mml:math display="block" id="M53" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:msub><mml:mrow><mml:mtext>|s</mml:mtext></mml:mrow><mml:mtext>t</mml:mtext></mml:msub><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mtext>n</mml:mtext><mml:mtext>d</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mtext>n</mml:mtext><mml:mtext>b</mml:mtext></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mtext>a </mml:mtext><mml:mo>=</mml:mo><mml:mtext> draw</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext> qp</mml:mtext></mml:mrow><mml:mtext>b</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>q</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mtext>p</mml:mtext><mml:mtext>o</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mtext> and</mml:mtext></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004164.e056">
<alternatives>
<graphic id="pcbi.1004164.e056g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e056" xlink:type="simple"/>
<mml:math display="block" id="M56" overflow="scroll">
<mml:mrow><mml:msub><mml:mtext>p</mml:mtext><mml:mtext>t</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mtext>n</mml:mtext><mml:mtext>d</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mtext>n</mml:mtext><mml:mtext>b</mml:mtext></mml:msub><mml:msub><mml:mrow><mml:mtext>|s</mml:mtext></mml:mrow><mml:mtext>t</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mtext>n</mml:mtext><mml:mtext>d</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mtext>n</mml:mtext><mml:mtext>b</mml:mtext></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mtext>a</mml:mtext><mml:mo>=</mml:mo><mml:mtext>draw</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>q</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mtext>p</mml:mtext><mml:mtext>b</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mtext>qp</mml:mtext></mml:mrow><mml:mtext>o</mml:mtext></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math>
</alternatives>
</disp-formula></p>
</sec>
<sec id="sec021">
<title>Patch foraging task</title>
<p>The state spaces for the foraging tasks are shown in Figs. <xref rid="pcbi.1004164.g006" ref-type="fig">6A</xref> and <xref rid="pcbi.1004164.g007" ref-type="fig">7A</xref>. We modeled the patch leaving task [<xref rid="pcbi.1004164.ref019" ref-type="bibr">19</xref>], as an infinite horizon discrete state MDP. We examined both discounted and undiscounted cases. The state space was given by the current juice level, the current travel delay, travel time (0 if not traveling), reward delay time (0 if not in the reward delay) and inter-trial interval (ITI) time (0 if not in the ITI). To simplify the state space we used a time-scale of 100 ms, and juice units of 20 µL. The ITI (1500 ms), travel (variable from 500 ms to 10,500 ms) and reward (400 ms) delays were modeled as a series of states with deterministic transitions. These are not shown explicitly in <xref rid="pcbi.1004164.g006" ref-type="fig">Fig. 6A</xref>. Thus, one always transitioned from ITI<sub>1</sub> to ITI<sub>2</sub>, … to ITI<sub>15</sub> (i.e. a 1500 ms ITI), and then transitioned from ITI<sub>15</sub> to the choice state. There was a corresponding sequence of deterministic transitions for the travel and reward delays, both of which terminated in the ITI. The final state of the reward delay delivered a reward amount equal to the current reward. In this way, time was modeled explicitly. Reward was deterministically, not stochastically, reduced by 20 ul per choice to stay in the current patch, to simplify the model. The choice state was the only state that had more than one action available, and at that point one could stay in the current patch, or travel to a new patch. The only stochastic transition in the model was the transition to a new travel delay for the new patch, after the current patch was left. The probability of transitioning to each of the travel delays was uniform. Thus, p(travel delay = i|s<sub>t</sub>,a = leave patch) = 1/11, with 11 travel delays (500 ms to 10500 ms with 1000 ms intervals).</p>
</sec>
<sec id="sec022">
<title>Foraging by sampling task</title>
<p>In the foraging by sampling task, subjects are shown a set of 6 gambles for each foraging bout [<xref rid="pcbi.1004164.ref018" ref-type="bibr">18</xref>]. Each gamble has a different reward associated with it. At each point, two gambles are sampled as a pair from the 6 and offered to the subjects. If the subjects reject the current pair, that pair is returned to the set, and a new pair of gambles is sampled from the set of 6. If subjects accept the gamble, they move on to a decision stage. In the decision stage subjects are told the probability that gamble 1 of the pair will pay out its reward and the probability that gamble two will pay out its reward. The subjects then have to select either gamble 1 or gamble 2 from the pair. They are then told whether or not they “won” on that trial. They then return to a new gambling bout, with 6 new individual gambles.</p>
<p>For this task [<xref rid="pcbi.1004164.ref018" ref-type="bibr">18</xref>], we only modeled the foraging stage. The decision stage is deterministic. It is assumed that subjects will select the option that has the highest expected value in that stage. We modeled the task using a finite horizon (60 sample max), undiscounted, discrete state MDP. The horizon could be shortened because of the cost-to-sample, but the state space for this task is small and the algorithm runs quickly. Utilities were modeled using backwards induction. The average values define the utilities in the last state (i.e. trial 60) where it is assumed the subjects would have to take the gamble on offer, and then these utilities were propagated backwards to the current trial. The state space was given by the number of combinations of gambles because at each point in the foraging stage, one pair was on offer. The 6 individual gambles leads to 15 pairs of gambles, assuming sampling without replacement from the gambles on offer, and combining symmetric pairs (i.e. gamble 2,3 is the same as gamble 3,2). Individual gambles ranged in value from 20 to 130 units in steps of 10. The cost to sample, C<sub>s</sub>, was set at its expected value, -7 points. From each state, subjects could choose to engage the current gamble, which led to the decision stage and the end of the foraging bout, or they could sample again, in which case they transitioned to a new gamble pair, that was sampled uniformly from the pairs of possible gambles. Thus, p(s<sub>t</sub> = i|s<sub>t</sub>,a = sample) = 1/15. The expected value of each gamble pair was not given by the average of the two gambles, or by the max of the average value of each gamble. Rather, the expected value of a given pair was given by:
<disp-formula id="pcbi.1004164.e054">
<alternatives>
<graphic id="pcbi.1004164.e054g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e054" xlink:type="simple"/>
<mml:math display="block" id="M54" overflow="scroll">
<mml:mo>&lt;</mml:mo><mml:mi mathvariant="normal">r</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:msubsup><mml:mo stretchy="false">∫</mml:mo><mml:mrow><mml:mn>0.2</mml:mn></mml:mrow><mml:mrow><mml:mn>0.9</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∫</mml:mo><mml:mrow><mml:mn>0.2</mml:mn></mml:mrow><mml:mrow><mml:mn>0.9</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">aϵ</mml:mi><mml:mn>1,2</mml:mn></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>.</mml:mo><mml:mi mathvariant="normal"> </mml:mi>
</mml:math>
</alternatives>
<label>(17)</label>
</disp-formula>
This is because it is assumed that the subjects will select the gamble with the highest expected value. Therefore the probabilities operate under the max operator.</p>
</sec>
<sec id="sec023">
<title>Gittins indices and bandit tasks</title>
<p>It is also possible to use Gittins indices to select optimal actions in stationary bandit tasks [<xref rid="pcbi.1004164.ref047" ref-type="bibr">47</xref>]. Gittins indices (GI), or dynamic allocation indices, allow one to separate multi-armed bandit problems into a set of single armed bandit problems. The state value of each bandit is compared to a reference process. Because multi-armed bandits can be separated into single-armed bandit problems, the state space over which one calculates values is considerably smaller. However, computing the indices is more complicated for each single bandit. In addition, the indices can only be calculated over a finite horizon, so infinite horizon, undiscounted estimates cannot be obtained. Because of the simplified states, however, relatively long time horizons can be examined. Therefore, we describe here a basic calculation, based on the restart formulation given by Katehakis and Veinott [<xref rid="pcbi.1004164.ref048" ref-type="bibr">48</xref>]. We do not give any results, as they have been tabled previous [<xref rid="pcbi.1004164.ref024" ref-type="bibr">24</xref>,<xref rid="pcbi.1004164.ref048" ref-type="bibr">48</xref>]. For the stationary n-armed bandit task, the GI for state i, of a single bandit can be estimated by finding the fixed point of:
<disp-formula id="pcbi.1004164.e055">
<alternatives>
<graphic id="pcbi.1004164.e055g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004164.e055" xlink:type="simple"/>
<mml:math display="block" id="M55" overflow="scroll">
<mml:mrow><mml:msub><mml:mtext>u</mml:mtext><mml:mtext>t</mml:mtext></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mtext>s</mml:mtext><mml:mtext>t</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mtext>a</mml:mtext><mml:mo>∈</mml:mo><mml:msub><mml:mtext>A</mml:mtext><mml:mrow><mml:msub><mml:mtext>s</mml:mtext><mml:mtext>t</mml:mtext></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mtext>s</mml:mtext><mml:mtext>t</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mtext>a</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> Q</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mtext>s</mml:mtext><mml:mtext>t</mml:mtext></mml:msub><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> i</mml:mtext><mml:mo>,</mml:mo><mml:mtext>a</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math>
</alternatives>
<label>(18)</label>
</disp-formula>
The fixed point can be found with value iteration, as was done above. The strategy is to plug in a state, i, solve <xref rid="pcbi.1004164.e055" ref-type="disp-formula">equation 18</xref> using value iteration, and then use u<sub>t</sub>(s<sub>t</sub> = i) as the GI for that state. This must be done for every state for which an index is required. Not that the action set here is only over the single bandit vs. the reference action, and not the set of bandits. Therefore, the indexes are valid for n bandits, once computed for a single bandit. After the GIs are calculated for all the states, one chooses the bandit whose GI is the largest, given its state in each trial. The GIs are not, however, value estimates.</p>
</sec>
</sec>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1004164.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Niv</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name> (<year>2005</year>) <article-title>Uncertainty-based competition between prefrontal and dorsolateral striatal systems for behavioral control</article-title>. <source>Nature Neuroscience</source> <volume>8</volume>: <fpage>1704</fpage>–<lpage>1711</lpage>. <object-id pub-id-type="pmid">16286932</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Seymour</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name> (<year>2011</year>) <article-title>Model-based influences on humans' choices and striatal prediction errors</article-title>. <source>Neuron</source> <volume>69</volume>: <fpage>1204</fpage>–<lpage>1215</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2011.02.027" xlink:type="simple">10.1016/j.neuron.2011.02.027</ext-link></comment> <object-id pub-id-type="pmid">21435563</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilson</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Takahashi</surname> <given-names>YK</given-names></name>, <name name-style="western"><surname>Schoenbaum</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Niv</surname> <given-names>Y</given-names></name> (<year>2014</year>) <article-title>Orbitofrontal cortex as a cognitive map of task space</article-title>. <source>Neuron</source> <volume>81</volume>: <fpage>267</fpage>–<lpage>279</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2013.11.005" xlink:type="simple">10.1016/j.neuron.2013.11.005</ext-link></comment> <object-id pub-id-type="pmid">24462094</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Furl</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Averbeck</surname> <given-names>BB</given-names></name> (<year>2011</year>) <article-title>Parietal cortex and insula relate to evidence seeking relevant to reward-related decisions</article-title>. <source>The Journal of neuroscience: the official journal of the Society for Neuroscience</source> <volume>31</volume>: <fpage>17572</fpage>–<lpage>17582</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4236-11.2011" xlink:type="simple">10.1523/JNEUROSCI.4236-11.2011</ext-link></comment> <object-id pub-id-type="pmid">22131418</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Averbeck</surname> <given-names>BB</given-names></name>, <name name-style="western"><surname>Djamshidian</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>O'Sullivan</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Housden</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Roiser</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Lees</surname> <given-names>AJ</given-names></name> (<year>2013</year>) <article-title>Uncertainty about mapping future actions into rewards may underlie performance on multiple measures of impulsivity in behavioral addiction: Evidence from Parkinson's disease</article-title>. <source>Behavioral neuroscience</source> <volume>127</volume>: <fpage>245</fpage>–<lpage>255</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1037/a0032079" xlink:type="simple">10.1037/a0032079</ext-link></comment> <object-id pub-id-type="pmid">23565936</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref006"><label>6</label><mixed-citation publication-type="other" xlink:type="simple">Costa VD, Averbeck BB (2013) Frontal-Parietal and Limbic-Striatal Activity Underlies Information Sampling in the Best Choice Problem. Cerebral cortex.</mixed-citation></ref>
<ref id="pcbi.1004164.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilson</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Nassar</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Gold</surname> <given-names>JI</given-names></name> (<year>2010</year>) <article-title>Bayesian online learning of the hazard rate in change-point problems</article-title>. <source>Neural Computation</source> <volume>22</volume>: <fpage>2452</fpage>–<lpage>2476</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00007" xlink:type="simple">10.1162/NECO_a_00007</ext-link></comment> <object-id pub-id-type="pmid">20569174</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Costa</surname> <given-names>VD</given-names></name>, <name name-style="western"><surname>Tran</surname> <given-names>VL</given-names></name>, <name name-style="western"><surname>Turchi</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Averbeck</surname> <given-names>BB</given-names></name> (<year>2014</year>) <article-title>Dopamine modulates novelty seeking behavior during decision making</article-title>. <source>Behavioral neuroscience</source> <volume>128</volume>: <fpage>556</fpage>–<lpage>566</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1037/a0037128" xlink:type="simple">10.1037/a0037128</ext-link></comment> <object-id pub-id-type="pmid">24911320</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>O'Doherty</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Seymour</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name> (<year>2006</year>) <article-title>Cortical substrates for exploratory decisions in humans</article-title>. <source>Nature</source> <volume>441</volume>: <fpage>876</fpage>–<lpage>879</lpage>. <object-id pub-id-type="pmid">16778890</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meyer</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>Y</given-names></name> (<year>1995</year>) <article-title>Sequential Choice under Ambiguity—Intuitive Solutions to the Armed-Bandit Problem</article-title>. <source>Management Science</source> <volume>41</volume>: <fpage>817</fpage>–<lpage>834</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004164.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Frank</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Doll</surname> <given-names>BB</given-names></name>, <name name-style="western"><surname>Oas-Terpstra</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Moreno</surname> <given-names>F</given-names></name> (<year>2009</year>) <article-title>Prefrontal and striatal dopaminergic genes predict individual differences in exploration and exploitation</article-title>. <source>Nature Neuroscience</source> <volume>12</volume>: <fpage>1062</fpage>–<lpage>1068</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2342" xlink:type="simple">10.1038/nn.2342</ext-link></comment> <object-id pub-id-type="pmid">19620978</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Steyvers</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Wagenmakers</surname> <given-names>EJ</given-names></name> (<year>2009</year>) <article-title>A Bayesian analysis of human decision-making on bandit problems</article-title>. <source>Journal of Mathematical Psychology</source> <volume>53</volume>: <fpage>168</fpage>–<lpage>179</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004164.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>SN</given-names></name>, <name name-style="western"><surname>Munro</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Steyvers</surname> <given-names>M</given-names></name> (<year>2011</year>) <article-title>Psychological models of human and optimal performance in bandit problems</article-title>. <source>Cognitive Systems Research</source> <volume>12</volume>: <fpage>164</fpage>–<lpage>174</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2474-12-164" xlink:type="simple">10.1186/1471-2474-12-164</ext-link></comment> <object-id pub-id-type="pmid">21762512</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Payzan-LeNestour</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Bossaerts</surname> <given-names>P</given-names></name> (<year>2011</year>) <article-title>Risk, Unexpected Uncertainty, and Estimation Uncertainty: Bayesian Learning in Unstable Settings</article-title>. <source>Plos Computational Biology</source> <volume>7</volume>.</mixed-citation></ref>
<ref id="pcbi.1004164.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>AJ</given-names></name> (<year>2013</year>) <article-title>Forgetful Bayes and myopic planning: Human learning and decision making in a bandit setting</article-title>. <source>Advances in Neural Information Processing Systems</source> <volume>26</volume>: <fpage>2607</fpage>–<lpage>2615</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004164.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Payzan-LeNestour</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Bossaerts</surname> <given-names>P</given-names></name> (<year>2012</year>) <article-title>Do not bet on the unknown versus try to find out more: estimation uncertainty and “unexpected uncertainty” both modulate exploration</article-title>. <source>Frontiers in neuroscience</source> <volume>6</volume>: <fpage>1</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fnins.2012.00001" xlink:type="simple">10.3389/fnins.2012.00001</ext-link></comment> <object-id pub-id-type="pmid">22294978</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilson</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Geana</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Ludvig</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>JD</given-names></name> (<year>2014</year>) <article-title>Humans use directed and random exploration to solve the explore-exploit dilemma</article-title>. <source>Journal of Experimental Psychology: General</source>.</mixed-citation></ref>
<ref id="pcbi.1004164.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kolling</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Behrens</surname> <given-names>TE</given-names></name>, <name name-style="western"><surname>Mars</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Rushworth</surname> <given-names>MF</given-names></name> (<year>2012</year>) <article-title>Neural mechanisms of foraging</article-title>. <source>Science</source> <volume>336</volume>: <fpage>95</fpage>–<lpage>98</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1216930" xlink:type="simple">10.1126/science.1216930</ext-link></comment> <object-id pub-id-type="pmid">22491854</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hayden</surname> <given-names>BY</given-names></name>, <name name-style="western"><surname>Pearson</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Platt</surname> <given-names>ML</given-names></name> (<year>2011</year>) <article-title>Neuronal basis of sequential foraging decisions in a patchy environment</article-title>. <source>Nature Neuroscience</source> <volume>14</volume>: <fpage>933</fpage>–<lpage>939</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2856" xlink:type="simple">10.1038/nn.2856</ext-link></comment> <object-id pub-id-type="pmid">21642973</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Djamshidian</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>O'Sullivan</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Sanotsky</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Sharman</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Matviyenko</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Foltynie</surname> <given-names>T</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Decision making, impulsivity, and addictions: Do Parkinson's disease patients jump to conclusions?</article-title> <source>Movement disorders: official journal of the Movement Disorder Society</source> <volume>27</volume>: <fpage>1137</fpage>–<lpage>1145</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/mds.25105" xlink:type="simple">10.1002/mds.25105</ext-link></comment> <object-id pub-id-type="pmid">22821557</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Averbeck</surname> <given-names>BB</given-names></name>, <name name-style="western"><surname>Evans</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Chouhan</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Bristow</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Shergill</surname> <given-names>SS</given-names></name> (<year>2011</year>) <article-title>Probabilistic learning and inference in schizophrenia</article-title>. <source>Schizophrenia Research</source> <volume>127</volume>: <fpage>115</fpage>–<lpage>122</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.schres.2010.08.009" xlink:type="simple">10.1016/j.schres.2010.08.009</ext-link></comment> <object-id pub-id-type="pmid">20810252</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moutoussis</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bentall</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>El-Deredy</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name> (<year>2011</year>) <article-title>Bayesian modelling of Jumping-to-Conclusions bias in delusional patients</article-title>. <source>Cognitive Neuropsychiatry</source> <volume>16</volume>: <fpage>422</fpage>–<lpage>447</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/13546805.2010.548678" xlink:type="simple">10.1080/13546805.2010.548678</ext-link></comment> <object-id pub-id-type="pmid">21480015</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bellman</surname> <given-names>R</given-names></name> (<year>1956</year>) <article-title>A problem in the sequential design of exeriments</article-title>. <source>Sankhya</source> <volume>16</volume>: <fpage>221</fpage>–<lpage>229</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004164.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gittins</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>DM</given-names></name> (<year>1979</year>) <article-title>Dynamic Allocation Index for the Discounted Multi-Armed Bandit Problem</article-title>. <source>Biometrika</source> <volume>66</volume>: <fpage>561</fpage>–<lpage>565</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004164.ref025"><label>25</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Stephens</surname> <given-names>DW</given-names></name>, <name name-style="western"><surname>Krebs</surname> <given-names>JR</given-names></name> (<year>1986</year>) <source>Foraging theory</source>. <publisher-loc>Princeton, N.J.</publisher-loc>: <publisher-name>Princeton University Press</publisher-name>. <volume>xiv</volume>, <fpage>247</fpage> p. p.</mixed-citation></ref>
<ref id="pcbi.1004164.ref026"><label>26</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Bertsekas</surname> <given-names>DP</given-names></name>, <name name-style="western"><surname>Tsitsiklis</surname> <given-names>JN</given-names></name> (<year>1996</year>) <source>Neuro-dynamic programming</source>. <publisher-loc>Belmont, Mass.</publisher-loc>: <publisher-name>Athena Scientific</publisher-name>. <volume>xiii</volume>, <fpage>491</fpage> p. p.</mixed-citation></ref>
<ref id="pcbi.1004164.ref027"><label>27</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Sutton</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Barto</surname> <given-names>AG</given-names></name> (<year>1998</year>) <source>Reinforcement learning: an introduction</source>. <publisher-loc>Cambridge, Mass.</publisher-loc>: <publisher-name>MIT Press</publisher-name>. <volume>xviii</volume>, <fpage>322</fpage> p. p.</mixed-citation></ref>
<ref id="pcbi.1004164.ref028"><label>28</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Bellman</surname> <given-names>R</given-names></name>, <collab xlink:type="simple">Rand Corporation</collab>. (<year>1957</year>) <source>Dynamic programming</source>. <publisher-loc>Princeton</publisher-loc>,: <publisher-name>Princeton University Press</publisher-name>. <volume>xxv</volume>, <fpage>342</fpage> p. p.</mixed-citation></ref>
<ref id="pcbi.1004164.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Djamshidian</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>O'Sullivan</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Wittmann</surname> <given-names>BC</given-names></name>, <name name-style="western"><surname>Lees</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Averbeck</surname> <given-names>BB</given-names></name> (<year>2011</year>) <article-title>Novelty seeking behaviour in Parkinson's disease</article-title>. <source>Neuropsychologia</source> <volume>49</volume>: <fpage>2483</fpage>–<lpage>2488</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuropsychologia.2011.04.026" xlink:type="simple">10.1016/j.neuropsychologia.2011.04.026</ext-link></comment> <object-id pub-id-type="pmid">21565210</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Evans</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Almahdi</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Sultan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Sohanpal</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Brandner</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Collier</surname> <given-names>T</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Performance on a probabilistic inference task in healthy subjects receiving ketamine compared with patients with schizophrenia</article-title>. <source>Journal of psychopharmacology</source>.</mixed-citation></ref>
<ref id="pcbi.1004164.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pessiglione</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Seymour</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Flandin</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Frith</surname> <given-names>CD</given-names></name> (<year>2006</year>) <article-title>Dopamine-dependent prediction errors underpin reward-seeking behaviour in humans</article-title>. <source>Nature</source> <volume>442</volume>: <fpage>1042</fpage>–<lpage>1045</lpage>. <object-id pub-id-type="pmid">16929307</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Djamshidian</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jha</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>O'Sullivan</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Silveira-Moriyama</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Jacobson</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>P</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Risk and learning in impulsive and nonimpulsive patients with Parkinson's disease</article-title>. <source>Movement disorders: official journal of the Movement Disorder Society</source> <volume>25</volume>: <fpage>2203</fpage>–<lpage>2210</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/mds.23247" xlink:type="simple">10.1002/mds.23247</ext-link></comment> <object-id pub-id-type="pmid">20721918</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wittmann</surname> <given-names>BC</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Seymour</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name> (<year>2008</year>) <article-title>Striatal activity underlies novelty-based choice in humans</article-title>. <source>Neuron</source> <volume>58</volume>: <fpage>967</fpage>–<lpage>973</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2008.04.027" xlink:type="simple">10.1016/j.neuron.2008.04.027</ext-link></comment> <object-id pub-id-type="pmid">18579085</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Walton</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Croxson</surname> <given-names>PL</given-names></name>, <name name-style="western"><surname>Behrens</surname> <given-names>TE</given-names></name>, <name name-style="western"><surname>Kennerley</surname> <given-names>SW</given-names></name>, <name name-style="western"><surname>Rushworth</surname> <given-names>MF</given-names></name> (<year>2007</year>) <article-title>Adaptive decision making and value in the anterior cingulate cortex</article-title>. <source>Neuroimage</source> <volume>36</volume> <issue>Suppl 2</issue>: <fpage>T142</fpage>–<lpage>154</lpage>. <object-id pub-id-type="pmid">17499161</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Djamshidian</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sanotsky</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Matviyenko</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>O'Sullivan</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Sharman</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Selikhova</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Increased reflection impulsivity in patients with ephedrone-induced Parkinsonism</article-title>. <source>Addiction</source> <volume>108</volume>: <fpage>771</fpage>–<lpage>779</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/add.12080" xlink:type="simple">10.1111/add.12080</ext-link></comment> <object-id pub-id-type="pmid">23228208</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Crockett</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Smillie</surname> <given-names>LD</given-names></name>, <name name-style="western"><surname>Robbins</surname> <given-names>TW</given-names></name> (<year>2012</year>) <article-title>The effects of acute tryptophan depletion on costly information sampling: impulsivity or aversive processing?</article-title> <source>Psychopharmacology</source> <volume>219</volume>: <fpage>587</fpage>–<lpage>597</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00213-011-2577-9" xlink:type="simple">10.1007/s00213-011-2577-9</ext-link></comment> <object-id pub-id-type="pmid">22094531</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Seo</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Averbeck</surname> <given-names>BB</given-names></name> (<year>2012</year>) <article-title>Action selection and action value in frontal-striatal circuits</article-title>. <source>Neuron</source> <volume>74</volume>: <fpage>947</fpage>–<lpage>960</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2012.03.037" xlink:type="simple">10.1016/j.neuron.2012.03.037</ext-link></comment> <object-id pub-id-type="pmid">22681697</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Drugowitsch</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Moreno-Bote</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Churchland</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Shadlen</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Pouget</surname> <given-names>A</given-names></name> (<year>2012</year>) <article-title>The cost of accumulating evidence in perceptual decision making</article-title>. <source>The Journal of neuroscience: the official journal of the Society for Neuroscience</source> <volume>32</volume>: <fpage>3612</fpage>–<lpage>3628</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4010-11.2012" xlink:type="simple">10.1523/JNEUROSCI.4010-11.2012</ext-link></comment> <object-id pub-id-type="pmid">22423085</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Simons</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Burt</surname> <given-names>CH</given-names></name> (<year>2011</year>) <article-title>Learning to Be Bad: Adverse Social Conditions, Social Schemas, and Crime</article-title>. <source>Criminology</source> <volume>49</volume>: <fpage>553</fpage>–<lpage>598</lpage>. <object-id pub-id-type="pmid">21760641</object-id></mixed-citation></ref>
<ref id="pcbi.1004164.ref040"><label>40</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Puterman</surname> <given-names>ML</given-names></name> (<year>1994</year>) <source>Markov decision processes: discrete stochastic dynamic programming</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Wiley</publisher-name>. <volume>xvii</volume>, <fpage>649</fpage> p. p.</mixed-citation></ref>
<ref id="pcbi.1004164.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thompson</surname> <given-names>WR</given-names></name> (<year>1933</year>) <article-title>On the likelihood that one unknown probability exceeds another in view of the evidence of two samples</article-title>. <source>Biometrika</source> <volume>25</volume>: <fpage>285</fpage>–<lpage>294</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004164.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Agrawal</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Goyal</surname> <given-names>N</given-names></name> (<year>2012</year>) <article-title>Analysis of Thompson sampling for the multi-armed bandit problem</article-title>. <source>JMLR Workshop and Conference Proceedings</source> <volume>23</volume>: <fpage>39</fpage>.<fpage>31</fpage>–<lpage>39</lpage>.<fpage>26</fpage>.</mixed-citation></ref>
<ref id="pcbi.1004164.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Auer</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Cesa-Bianchi</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Fischer</surname> <given-names>P</given-names></name> (<year>2002</year>) <article-title>Finite-time analysis of the multiarmed bandit problem</article-title>. <source>Machine Learning</source> <volume>47</volume>: <fpage>235</fpage>–<lpage>256</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004164.ref044"><label>44</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Hastie</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Friedman</surname> <given-names>J</given-names></name> (<year>2001</year>) <source>The elements of statistical learning</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1004164.ref045"><label>45</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Bertsekas</surname> <given-names>DP</given-names></name> (<year>1995</year>) <source>Dynamic programming and optimal control</source>. <publisher-loc>Belmont, Mass.</publisher-loc>: <publisher-name>Athena Scientific</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1004164.ref046"><label>46</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Bishop</surname> <given-names>CM</given-names></name> (<year>2006</year>) <source>Pattern recognition and machine learning</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer</publisher-name>. <volume>xx</volume>, <fpage>738</fpage> p. p.</mixed-citation></ref>
<ref id="pcbi.1004164.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gittins</surname> <given-names>JC</given-names></name> (<year>1979</year>) <article-title>Bandit Processes and Dynamic Allocation Indexes</article-title>. <source>Journal of the Royal Statistical Society Series B-Methodological</source> <volume>41</volume>: <fpage>148</fpage>–<lpage>177</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004164.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Katehakis</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Veinott</surname> <given-names>AF</given-names></name> (<year>1987</year>) <article-title>The Multiarmed Bandit Problem—Decomposition and Computation</article-title>. <source>Mathematics of Operations Research</source> <volume>12</volume>: <fpage>262</fpage>–<lpage>268</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>