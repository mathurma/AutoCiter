<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004991</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-02172</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Sequence assembly tools</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Sequence assembly tools</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov models</subject><subj-group><subject>Hidden Markov models</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Biological databases</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein domains</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Database searching</subject><subj-group><subject>Sequence similarity searching</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Database searching</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Metagenome and Metatranscriptome Analyses Using Protein Family Profiles</article-title>
<alt-title alt-title-type="running-head">Protein Family-Based Metagenomics Analysis</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Zhong</surname>
<given-names>Cuncong</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Edlund</surname>
<given-names>Anna</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Yang</surname>
<given-names>Youngik</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9934-5137</contrib-id>
<name name-style="western">
<surname>McLean</surname>
<given-names>Jeffrey S.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Yooseph</surname>
<given-names>Shibu</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>J. Craig Venter Institute, La Jolla, California, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>School of Dentistry, University of California Los Angeles, Los Angeles, California, United States of America</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Department of Periodontics, University of Washington, Seattle, Washington, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Elofsson</surname>
<given-names>Arne</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Stockholm University, SWEDEN</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: CZ SY. Performed the experiments: CZ. Analyzed the data: CZ AE YY SY. Wrote the paper: CZ AE YY JSM SY.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">syooseph@jcvi.org</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>11</day>
<month>7</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="collection">
<month>7</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>7</issue>
<elocation-id>e1004991</elocation-id>
<history>
<date date-type="received">
<day>29</day>
<month>12</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>13</day>
<month>5</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Zhong et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004991"/>
<abstract>
<p>Analyses of metagenome data (MG) and metatranscriptome data (MT) are often challenged by a paucity of complete reference genome sequences and the uneven/low sequencing depth of the constituent organisms in the microbial community, which respectively limit the power of reference-based alignment and <italic>de novo</italic> sequence assembly. These limitations make accurate protein family classification and abundance estimation challenging, which in turn hamper downstream analyses such as abundance profiling of metabolic pathways, identification of differentially encoded/expressed genes, and <italic>de novo</italic> reconstruction of complete gene and protein sequences from the protein family of interest. The profile hidden Markov model (HMM) framework enables the construction of very useful probabilistic models for protein families that allow for accurate modeling of position specific matches, insertions, and deletions. We present a novel homology detection algorithm that integrates banded Viterbi algorithm for profile HMM parsing with an iterative simultaneous alignment and assembly computational framework. The algorithm searches a given profile HMM of a protein family against a database of fragmentary MG/MT sequencing data and simultaneously assembles complete or near-complete gene and protein sequences of the protein family. The resulting program, HMM-GRASPx, demonstrates superior performance in aligning and assembling homologs when benchmarked on both simulated marine MG and real human saliva MG datasets. On real supragingival plaque and stool MG datasets that were generated from healthy individuals, HMM-GRASPx accurately estimates the abundances of the antimicrobial resistance (AMR) gene families and enables accurate characterization of the resistome profiles of these microbial communities. For real human oral microbiome MT datasets, using the HMM-GRASPx estimated transcript abundances significantly improves detection of differentially expressed (DE) genes. Finally, HMM-GRASPx was used to reconstruct comprehensive sets of complete or near-complete protein and nucleotide sequences for the query protein families. HMM-GRASPx is freely available online from <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/hmm-graspx" xlink:type="simple">http://sourceforge.net/projects/hmm-graspx</ext-link>.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Accurate analysis of microbial metabolism and function from metagenome and metatranscriptome data sets relies heavily on the comprehensive identification of protein family homologs present in these data. The task is routinely being done through alignment of the individual reads against the profile hidden Markov Models (HMM) of protein families in the reference database. This strategy, however, is hindered by the fact that the reads usually only represent partial protein sequences, which contain insufficient information for their accurate classification. To tackle this problem, we present a targeted assembly algorithm that, based on the sequence overlap information, simultaneously reconstructs complete or near-complete protein sequences and estimates their homology given the HMMs of the protein families of interest. The reconstructed protein sequences contain more complete information regarding the function of the corresponding protein, thus facilitating accurate annotation of themselves as well as the constituent sequencing reads. The resulting program, HMM-GRASPx, has been shown to have significantly improved performance (&gt;40% higher recall rate with a similar level of precision rate) over other state-of-the-art counterparts such as RPS-BLAST and HMMER3.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>DBI-1262295</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Yooseph</surname>
<given-names>Shibu</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>K99DE024543</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Edlund</surname>
<given-names>Anna</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>1R01GM095373</award-id>
<principal-award-recipient>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9934-5137</contrib-id>
<name name-style="western">
<surname>McLean</surname>
<given-names>Jeffrey S.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>1R01DE020102</award-id>
<principal-award-recipient>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9934-5137</contrib-id>
<name name-style="western">
<surname>McLean</surname>
<given-names>Jeffrey S.</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>CZ, YY, and SY were supported by the National Science Foundation (<ext-link ext-link-type="uri" xlink:href="http://www.nsf.gov" xlink:type="simple">www.nsf.gov</ext-link>) under grant number DBI-1262295. AE was supported by a National Institute of Health (<ext-link ext-link-type="uri" xlink:href="http://www.nih.gov" xlink:type="simple">www.nih.gov</ext-link>) K99 Pathway to Independence ward (K99DE024543). JSM was supported by the National Institute of Health (<ext-link ext-link-type="uri" xlink:href="http://www.nih.gov" xlink:type="simple">www.nih.gov</ext-link>) under grant number 1R01GM095373 and 1R01DE020102. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="4"/>
<table-count count="3"/>
<page-count count="22"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Metagenomics (MG) and Metatranscriptomics (MT) are culture-independent methodologies [<xref ref-type="bibr" rid="pcbi.1004991.ref001">1</xref>,<xref ref-type="bibr" rid="pcbi.1004991.ref002">2</xref>] empowered by next-generation sequencing (NGS) technologies [<xref ref-type="bibr" rid="pcbi.1004991.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1004991.ref004">4</xref>], which respectively enable genome and transcriptome profiling (RNA-seq) of the microbes in a given environment. MG studies allow the estimation of gene abundances to reconstruct the metabolic potential [<xref ref-type="bibr" rid="pcbi.1004991.ref005">5</xref>] as well as the taxonomic profile [<xref ref-type="bibr" rid="pcbi.1004991.ref006">6</xref>] of the microbial community. MT studies, on the other hand, can capture transcriptome-level changes of the microbial communities, possibly induced by longitudinal, cross-sectional environmental changes and/or intra- and inter-species interactions [<xref ref-type="bibr" rid="pcbi.1004991.ref007">7</xref>–<xref ref-type="bibr" rid="pcbi.1004991.ref010">10</xref>]. Identification of differentially expressed (DE) genes is based on comparisons of mRNA abundances across different conditions. Both MG and MT approaches rely heavily on accurate estimation of the DNA/mRNA abundances in the sample.</p>
<p>The abundance estimation in MG/MT data is traditionally solved through homology search, which aims at finding all homologs (as measured by sequence similarity) of the query reference. Given the reference sequence, individual NGS reads can be aligned against it using alignment programs such as Bowtie [<xref ref-type="bibr" rid="pcbi.1004991.ref011">11</xref>], BWA [<xref ref-type="bibr" rid="pcbi.1004991.ref012">12</xref>], BLAST [<xref ref-type="bibr" rid="pcbi.1004991.ref013">13</xref>], FASTM [<xref ref-type="bibr" rid="pcbi.1004991.ref014">14</xref>], RAPSearch [<xref ref-type="bibr" rid="pcbi.1004991.ref015">15</xref>,<xref ref-type="bibr" rid="pcbi.1004991.ref016">16</xref>], and DIAMOND [<xref ref-type="bibr" rid="pcbi.1004991.ref017">17</xref>]. Alternatively, the individual reads can be assembled into longer contig sequences using <italic>de novo</italic> assembly tools prior to the alignment [<xref ref-type="bibr" rid="pcbi.1004991.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1004991.ref019">19</xref>]. Long contigs contain more complete structural features of the corresponding protein product and thus facilitate correct annotations. However, <italic>de novo</italic> assembly can be challenging due to uneven and/or low-coverage of the constituent organisms, leading to fragmentary assembly for many data sets. These issues have been partly alleviated through the <italic>de novo</italic> short peptide assembly approach [<xref ref-type="bibr" rid="pcbi.1004991.ref020">20</xref>,<xref ref-type="bibr" rid="pcbi.1004991.ref021">21</xref>] that aims at reconstructing complete protein sequences, and is not hampered by synonymous DNA mutations.</p>
<p>Previously, we developed a framework for identifying the homologs of a query protein sequence from a database of peptide reads that were translated from NGS reads (using fragmentary gene caller such as MetaGeneAnnotator [<xref ref-type="bibr" rid="pcbi.1004991.ref022">22</xref>] or FragGeneScan [<xref ref-type="bibr" rid="pcbi.1004991.ref023">23</xref>]). This framework, referred to as the simultaneous alignment and assembly (SAA) approach for short peptides, uses iterative alignment and assembly steps to improve homology detection, and integrates both the reference-based alignment and the targeted fragment assembly as a unified component [<xref ref-type="bibr" rid="pcbi.1004991.ref024">24</xref>,<xref ref-type="bibr" rid="pcbi.1004991.ref025">25</xref>]. It computes sequence similarity at each stage of contig extension, thus providing auxiliary sequence similarity information for guiding the graph traversal. Meanwhile, the alignments computed between the reference and the assembled contigs also more accurately reflect the true homology. Given the reference protein sequence, the algorithm attempts to recruit all of its homologous short peptide reads and assemble them into full-length proteins. This approach allows integration of the sequence overlapping information (i.e. between reads) with the sequence alignment information (i.e. between the read and the reference) while assessing homology. Intuitively, if a peptide read overlaps significantly with a second peptide read that aligns well with the reference protein sequence, it is more likely that the first read is also a homolog of the reference. The resulting program called GRASP (Guided Reference-based Assembly of Short Peptides) [<xref ref-type="bibr" rid="pcbi.1004991.ref024">24</xref>] and its computationally efficient version GRASPx [<xref ref-type="bibr" rid="pcbi.1004991.ref025">25</xref>] was shown to significantly improve sensitivity of homology search when compared to programs such as BLASTP and FASTM, and subsequently provide more accurate abundance estimation from MG/MT data. Currently, the SAA algorithm has only been implemented to accept a single sequence as the query. Motivated by improved homology detection capabilities of profile hidden Markov models (HMM), here we extend the SAA approach to enable the use of a profile HMM as a query.</p>
<p>Currently several methods are available for protein family profile-based homology search. HMMER3 [<xref ref-type="bibr" rid="pcbi.1004991.ref026">26</xref>–<xref ref-type="bibr" rid="pcbi.1004991.ref029">29</xref>] and RPS-BLAST [<xref ref-type="bibr" rid="pcbi.1004991.ref030">30</xref>,<xref ref-type="bibr" rid="pcbi.1004991.ref031">31</xref>] directly operate on individual reads and demonstrate low sensitivity [<xref ref-type="bibr" rid="pcbi.1004991.ref032">32</xref>,<xref ref-type="bibr" rid="pcbi.1004991.ref033">33</xref>]. To improve sensitivity, the Sensitive and Accurate protein domain cLassification Tool (SALT) [<xref ref-type="bibr" rid="pcbi.1004991.ref032">32</xref>] attempts to excessively recruit candidate homologous reads of the reference through a loose cutoff; then it applies <italic>de novo</italic> assembly on these recruited reads. Excessive recruitment of candidate homologs can have an impact on the running time of the program; the program is therefore only designed for analyzing single-genome data instead of large and complex MG/MT community data. SALT was later redesigned and extended to Xander [<xref ref-type="bibr" rid="pcbi.1004991.ref034">34</xref>], which was built on the spectrum alignment algorithm that was originally used for guided homology search on microarray data [<xref ref-type="bibr" rid="pcbi.1004991.ref035">35</xref>]. Xander also requires relatively large amount of computational resources to analyze tens or hundreds of protein families. On the other hand, the Ultrafast Protein Classification (UProC) toolbox [<xref ref-type="bibr" rid="pcbi.1004991.ref033">33</xref>] implements a computationally efficient approach to compare the MG/MT reads to the sequences of all members in the querying protein family (using the Pfam FULL alignment database), which makes it reference database-dependent. In summary, an accurate, efficient, and reference database-independent profile-based homology search program would greatly improve current MG/MT data analysis.</p>
<p>In this work we present a novel algorithm for profile HMM-based homology search that couples the banded Viterbi algorithm with the SAA framework. The resulting program HMM-GRASPx provides two important utilities. It can be used both as a homology search program that provides more accurate abundance estimation of the reference protein family, as well as a targeted assembly program that focuses on the reconstruction of genes sequences for the same protein family. Both of these features of HMM-GRASPx were benchmarked against HMMER3 [<xref ref-type="bibr" rid="pcbi.1004991.ref028">28</xref>], RPS-BLAST [<xref ref-type="bibr" rid="pcbi.1004991.ref030">30</xref>] and UProC [<xref ref-type="bibr" rid="pcbi.1004991.ref033">33</xref>]; and HMM-GRASPx demonstrated significantly improved performances. Moreover, its utility as a homology search program was further showcased using MG data sets from the Human Microbiome Project (HMP) [<xref ref-type="bibr" rid="pcbi.1004991.ref036">36</xref>] as well as MT data sets that were generated from <italic>in vitro</italic> grown oral biofilms [<xref ref-type="bibr" rid="pcbi.1004991.ref007">7</xref>]. HMM-GRASPx outperformed HMMER3 both in predicting the abundance of the antimicrobial resistance (AMR) gene families from the MG data set and in detecting DE genes that encode known biosynthesis pathways from the MT data set. In addition, HMM-GRASPx’s utility as a targeted assembly program was further demonstrated using the same <italic>in vitro</italic> oral biofilm MT data set. Targeted assembly using HMM-GRASPx predictions reconstructed more and longer contigs than using HMMER3 predictions, both in protein and nucleotide space. HMM-GRASPx is freely available online from <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/hmm-graspx" xlink:type="simple">http://sourceforge.net/projects/hmm-graspx</ext-link>.</p>
</sec>
<sec id="sec002" sec-type="conclusions">
<title>Results and Discussion</title>
<sec id="sec003">
<title>The HMM-GRASPx design principle and analysis pipeline</title>
<p>Typical MG/MT data sets are generated from microbial communities whose compositions are not fully known <italic>a priori</italic> and often contain taxonomic groups that do not have representative reference sequences. In this case, the analysis of such MG/MT data sets involves homology search with available reference sequences that may be evolutionarily distant to some of the taxa in the sampled community. Computationally, the search for the remote homologs of a given query protein sequence is confounded by the combination of homologous and non-homologous protein sequences in the low sequence similarity alignment space [<xref ref-type="bibr" rid="pcbi.1004991.ref037">37</xref>]. The problem is further compounded by the current high-throughput sequencing technologies that generate short reads, which usually leads to short alignments that only contain partial information regarding the structural features of the protein. GRASP was designed to address these limitations by evaluating the sequence similarity between the query sequence and the reconstructed protein contigs, which resulted in longer alignments and improved accuracy [<xref ref-type="bibr" rid="pcbi.1004991.ref024">24</xref>]. HMM-GRASPx adopts a similar principle as GRASP for solving this problem, and further extends the utility to protein family profile-based homology search.</p>
<p>The detailed algorithm for HMM-GRASPx is presented in the Methods section. An MG/MT data analysis pipeline using HMM-GRASPx as its core component is summarized in <xref ref-type="fig" rid="pcbi.1004991.g001">Fig 1</xref> and includes the following steps.</p>
<fig id="pcbi.1004991.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004991.g001</object-id>
<label>Fig 1</label>
<caption>
<title>The HMM-GRASPx pipeline for homology search and gene-centric assembly.</title>
<p>Blue shading of the objects indicates that the corresponding data or operation is in nucleotide space, while purple shading indicates amino-acid space.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.g001" xlink:type="simple"/>
</fig>
<list list-type="bullet">
<list-item><p>Partial protein coding sequences (referred to as <italic>short peptide reads</italic>) are identified from the raw MG/MT nucleotide reads using a gene-calling program (for instance, MetaGeneAnnotator [<xref ref-type="bibr" rid="pcbi.1004991.ref022">22</xref>] or FragGeneScan [<xref ref-type="bibr" rid="pcbi.1004991.ref023">23</xref>]). These short peptide reads, together with a query profile HMM, serve as the input to HMM-GRASPx.</p></list-item>
<list-item><p>The SAA algorithm implemented in HMM-GRASPx uses the query profile HMM as a guide and operates on the short peptide reads database, assembling protein contigs that are subsequently verified through HMMER3 realignment.</p></list-item>
<list-item><p>Homologous short peptide reads are recruited by mapping all reads to the verified contigs that are generated in the previous step.</p></list-item>
<list-item><p>Targeted protein assembly can be performed using peptide assembler (e.g. SFA-SPA [<xref ref-type="bibr" rid="pcbi.1004991.ref021">21</xref>]) on HMM-GRASPx recruited short peptides.</p></list-item>
<list-item><p>Targeted nucleotide assembly can be performed using nucleotide assembler (e.g. SPAdes [<xref ref-type="bibr" rid="pcbi.1004991.ref018">18</xref>]) on the original nucleotide sequences that correspond to the HMM-GRASPx recruited short peptides.</p></list-item>
</list>
<p>The “Mapping” step in <xref ref-type="fig" rid="pcbi.1004991.g001">Fig 1</xref> corresponds to the homology search utility of HMM-GRASPx, while the “Nucleotide assembly” and “Protein assembly” steps in <xref ref-type="fig" rid="pcbi.1004991.g001">Fig 1</xref> fully exploit its potential for targeted assembly. The current implementation of HMM-GRASPx outputs all possible traversals of its overlap graph as long as the corresponding contigs align well with the query, which may be redundant. Therefore, we recommend using other <italic>de novo</italic> assembly programs to further refine the set of output contigs (e.g. SPAdes [<xref ref-type="bibr" rid="pcbi.1004991.ref018">18</xref>] for nucleotide assembly and SFA-SPA [<xref ref-type="bibr" rid="pcbi.1004991.ref021">21</xref>] for protein assembly). In summary, the HMM-GRASPx based MG/MT analysis pipeline allows for estimation of gene/transcript abundances and targeted reconstruction of both protein and nucleotide sequences.</p>
<p>Asymptotic behavior for the running time of HMM-GRASPx is shown in <xref ref-type="supplementary-material" rid="pcbi.1004991.s013">S1 Fig</xref>. The expected running time of HMM-GRASPx grows linearly with the length of the sequences that are being assembled/searched.</p>
</sec>
<sec id="sec004">
<title>HMM-GRASPx accurately identifies homolog reads from simulated and real metagenomic data sets</title>
<p>HMM-GRASPx was benchmarked with homology search/classification programs including HMMER3 (version 3.1b2) [<xref ref-type="bibr" rid="pcbi.1004991.ref028">28</xref>], RPS-BLAST (version ncbi-blast+2.2.28) [<xref ref-type="bibr" rid="pcbi.1004991.ref030">30</xref>], and UProC (version 1.2.0) [<xref ref-type="bibr" rid="pcbi.1004991.ref033">33</xref>] on a simulated marine data set that contains 23 marine microbial genomes from the <italic>Alteromonas</italic>, <italic>Candidatus</italic>, <italic>Erythrobacter</italic>, <italic>Flavobacteriales</italic>, <italic>Nitrosococcus</italic>, <italic>Photobacterium</italic>, <italic>Prochlorococcus</italic>, <italic>Roseobacter</italic>, <italic>Shewanella</italic>, <italic>Synechococcus</italic>, and <italic>Vibrio</italic> groups (see <xref ref-type="sec" rid="sec010">Methods</xref>). The relative abundances of these bacteria were simulated according to their natural composition (coverages of each genome range from 1.25X to 10X with an average of 4X, see <xref ref-type="supplementary-material" rid="pcbi.1004991.s001">S1 Table</xref>). Three hundred and three Pfam protein families that are involved in important metabolic pathways were selected as the queries (<xref ref-type="supplementary-material" rid="pcbi.1004991.s002">S2 Table</xref>). Ground-truth homologous reads were defined by searching these protein families against the complete genomes and recruiting reads onto the identified homologous regions (see <xref ref-type="sec" rid="sec010">Methods</xref>). Given the ground-truth homologous reads, the recall rate, precision rate, and F-measure of the programs were calculated and compared (see <xref ref-type="sec" rid="sec010">Methods</xref>).</p>
<p>The performances of the four programs are summarized in <xref ref-type="table" rid="pcbi.1004991.t001">Table 1</xref>. HMM-GRASPx shows the highest recall rate (~64.1% on average) among all programs. Both HMMER3 and RPS-BLAST show equivalently the highest precision rate (~94.3%); and HMM-GRASPx also shows reasonably high precision rate (~90.6%). Overall, HMM-GRASPx demonstrates the highest F-measure of ~75.0% on average, followed by RPS-BLAST which has an F-measure of ~47.4%. Furthermore, note that the increase of sequencing coverage would improve the assembly performance of HMM-GRASPx, which would in turn improve its overall performance. For example, when repeating the same experiment on a simulated data set in which all the 23 marine microbial genomes were <italic>in silico</italic> sequenced with an even 10X coverage, the average F-measure of HMM-GRASPx increased from ~75.0% to ~82.5%; the other programs were not benefited from the increased sequencing coverage (<xref ref-type="supplementary-material" rid="pcbi.1004991.s003">S3 Table</xref>).</p>
<table-wrap id="pcbi.1004991.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004991.t001</object-id>
<label>Table 1</label> <caption><title>Performances of the programs for searching metabolic protein family profiles against the simulated marine data set with uneven coverage.</title></caption>
<alternatives>
<graphic id="pcbi.1004991.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="2">Pathway</th>
<th align="left" rowspan="2">#Families</th>
<th align="center" colspan="3">HMM-GRASPx</th>
<th align="center" colspan="3">HMMER3</th>
<th align="center" colspan="3">RPS-BLAST</th>
<th align="center" colspan="3">UProC</th>
</tr>
<tr>
<th align="left">Rec.</th>
<th align="left">Prec.</th>
<th align="left">F.</th>
<th align="left">Rec.</th>
<th align="left">Prec.</th>
<th align="left">F.</th>
<th align="left">Rec.</th>
<th align="left">Prec.</th>
<th align="left">F.</th>
<th align="left">Rec.</th>
<th align="left">Prec.</th>
<th align="left">F.</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold>KO00010</bold></td>
<td align="left">47</td>
<td align="justify"><bold>70.2</bold></td>
<td align="justify">94.3</td>
<td align="justify"><bold>80.5</bold></td>
<td align="justify">25.0</td>
<td align="justify">95.7</td>
<td align="justify">39.7</td>
<td align="justify">43.8</td>
<td align="justify"><bold>97.6</bold></td>
<td align="justify">60.4</td>
<td align="justify">26.8</td>
<td align="justify">68.0</td>
<td align="justify">38.5</td>
</tr>
<tr>
<td align="left"><bold>KO00020</bold></td>
<td align="left">69</td>
<td align="justify"><bold>61.6</bold></td>
<td align="justify">86.5</td>
<td align="justify"><bold>72.0</bold></td>
<td align="justify">18.0</td>
<td align="justify">92.2</td>
<td align="justify">30.1</td>
<td align="justify">31.4</td>
<td align="justify"><bold>94.5</bold></td>
<td align="justify">47.2</td>
<td align="justify">28.7</td>
<td align="justify">70.1</td>
<td align="justify">40.7</td>
</tr>
<tr>
<td align="left"><bold>KO00030</bold></td>
<td align="left">21</td>
<td align="justify"><bold>78.0</bold></td>
<td align="justify">96.2</td>
<td align="justify"><bold>86.1</bold></td>
<td align="justify">28.6</td>
<td align="justify"><bold>98.5</bold></td>
<td align="justify">44.4</td>
<td align="justify">49.2</td>
<td align="justify">97.7</td>
<td align="justify">65.5</td>
<td align="justify">33.1</td>
<td align="justify">56.4</td>
<td align="justify">41.7</td>
</tr>
<tr>
<td align="left"><bold>KO00051</bold></td>
<td align="left">111</td>
<td align="justify"><bold>58.7</bold></td>
<td align="justify">87.4</td>
<td align="justify"><bold>70.2</bold></td>
<td align="justify">15.6</td>
<td align="justify"><bold>94.1</bold></td>
<td align="justify">26.7</td>
<td align="justify">24.4</td>
<td align="justify">90.9</td>
<td align="justify">38.4</td>
<td align="justify">17.8</td>
<td align="justify">57.1</td>
<td align="justify">27.1</td>
</tr>
<tr>
<td align="left"><bold>KO00620</bold></td>
<td align="left">80</td>
<td align="justify"><bold>60.2</bold></td>
<td align="justify">89.4</td>
<td align="justify"><bold>72.0</bold></td>
<td align="justify">15.3</td>
<td align="justify">92.9</td>
<td align="justify">26.3</td>
<td align="justify">27.1</td>
<td align="justify"><bold>95.0</bold></td>
<td align="justify">42.2</td>
<td align="justify">23.6</td>
<td align="justify">75.6</td>
<td align="justify">35.9</td>
</tr>
<tr>
<td align="left"><bold>KO00680</bold></td>
<td align="left">124</td>
<td align="justify"><bold>59.3</bold></td>
<td align="justify">89.7</td>
<td align="justify"><bold>71.4</bold></td>
<td align="justify">17.2</td>
<td align="justify"><bold>95.1</bold></td>
<td align="justify">29.1</td>
<td align="justify">27.6</td>
<td align="justify">92.8</td>
<td align="justify">42.5</td>
<td align="justify">21.0</td>
<td align="justify">73.3</td>
<td align="justify">32.7</td>
</tr>
<tr>
<td align="left"><bold>KO00910</bold></td>
<td align="left">49</td>
<td align="justify"><bold>61.9</bold></td>
<td align="justify">87.3</td>
<td align="justify"><bold>72.4</bold></td>
<td align="justify">16.3</td>
<td align="justify"><bold>92.2</bold></td>
<td align="justify">27.7</td>
<td align="justify">29.5</td>
<td align="justify">88.8</td>
<td align="justify">44.2</td>
<td align="justify">26.7</td>
<td align="justify">76.9</td>
<td align="justify">39.6</td>
</tr>
<tr>
<td align="left"><bold>KO00920</bold></td>
<td align="left">7</td>
<td align="justify"><bold>62.7</bold></td>
<td align="justify">93.7</td>
<td align="justify"><bold>75.1</bold></td>
<td align="justify">11.1</td>
<td align="justify">93.4</td>
<td align="justify">19.8</td>
<td align="justify">24.3</td>
<td align="justify"><bold>97.0</bold></td>
<td align="justify">38.9</td>
<td align="justify">8.3</td>
<td align="justify">25.1</td>
<td align="justify">12.4</td>
</tr>
<tr>
<td align="left"><bold>Average</bold></td>
<td align="left">-</td>
<td align="justify"><bold>64.1</bold></td>
<td align="justify">90.6</td>
<td align="justify"><bold>75.0</bold></td>
<td align="justify">18.4</td>
<td align="justify"><bold>94.3</bold></td>
<td align="justify">30.5</td>
<td align="justify">32.2</td>
<td align="justify"><bold>94.3</bold></td>
<td align="justify">47.4</td>
<td align="justify">23.2</td>
<td align="justify">62.8</td>
<td align="justify">33.6</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001"><p>Pathway names: KO00010 (Glycolysis/Glycogenesis), KO00020 (TCA cycle), KO00030 (Pentose phosphate pathway), KO00051 (Fructose and mannose metabolism), KO00620 (Pyruvate metabolism), KO00680 (Methane metabolism), KO00910 (Nitrogen metabolism), KO00920 (Sulfur metabolism). The column “#Families” indicates the number of protein (domain) families involved in the corresponding pathway. The columns “Rec.”, “Prec.”, and “F.” indicate Recall, Precision, and F-measure, respectively. All performances are presented as percentages. The highest performances among all programs are bolded.</p></fn>
<fn id="t001fn002"><p>Running time for all programs on the simulated marine data set is available in <xref ref-type="supplementary-material" rid="pcbi.1004991.s004">S4 Table</xref>.</p></fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="sec005">
<title>HMM-GRASPx accurately and completely reconstructs homolog protein sequences of query protein families</title>
<p>The utility of HMM-GRASPx as a protein family-specific targeted assembly program was evaluated on a real human saliva data set SRS013942 together with HMMER3, RPS-BLAST and UProC. A list of secondary metabolite synthesizing protein families collected from the antiSMASH2.0 database [<xref ref-type="bibr" rid="pcbi.1004991.ref038">38</xref>] were used as queries (<xref ref-type="supplementary-material" rid="pcbi.1004991.s005">S5 Table</xref>). The <italic>de novo</italic> peptide assembly program SFA-SPA [<xref ref-type="bibr" rid="pcbi.1004991.ref021">21</xref>] was used to assemble the homolog reads recruited by each of the programs (see <xref ref-type="sec" rid="sec010">Methods</xref>). The correctness of these assembled contigs was evaluated by re-aligning them against the querying profiles (see <xref ref-type="sec" rid="sec010">Methods</xref>), and we correspondingly define the true contigs (<italic>t</italic>.<italic>c</italic>.), true reads (<italic>t</italic>.<italic>r</italic>.), contig-level precision (<italic>c</italic>.<italic>P</italic>.), and the read-level precision (<italic>r</italic>.<italic>P</italic>.) (see <xref ref-type="sec" rid="sec010">Methods</xref>).</p>
<p>The performances of HMM-GRASPx, RPS-BLAST, and UProC are summarized in <xref ref-type="table" rid="pcbi.1004991.t002">Table 2</xref>. HMMER3 was excluded from the precision benchmark because the program was used to define the ground-truth and will consistently have precision close to 100% (for number of true reads and true contigs for HMMER3 see <xref ref-type="supplementary-material" rid="pcbi.1004991.s006">S6 Table</xref>). HMMER-GRASPx recruited as much as two times and ~25% more true homologous reads compared to RPS-BLAST and UProC, respectively. Using RPS-BLAST predictions, SFA-SPA was able to assemble more true homologous contigs. However, the lengths of the RPS-BLAST contigs were considerably shorter than the ones assembled from HMM-GRASPx predictions (as measured by N50, see <xref ref-type="supplementary-material" rid="pcbi.1004991.s007">S7 Table</xref>). Aside from HMM-GRASPx’s higher sensitivity, the majority of its predicted reads were assembled into true homologous contigs, which corresponds to 96.8% read-level and 84.7% contig-level precision on average. RPS-BLAST was the second best-performing program with averaged values of 62.6% and 54.5%, respectively. These results show that HMM-GRASPx is well suited to perform protein family-specific targeted assembly.</p>
<table-wrap id="pcbi.1004991.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004991.t002</object-id>
<label>Table 2</label> <caption><title>Performances of the programs for searching biosynthetic protein family profiles against the human saliva data set SRS013942.</title></caption>
<alternatives>
<graphic id="pcbi.1004991.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="2">Name</th>
<th align="center" rowspan="2">#Pfams</th>
<th align="center" colspan="4">HMM-GRASPx</th>
<th align="center" colspan="4">RPS-BLAST</th>
<th align="center" colspan="4">UProC</th>
</tr>
<tr>
<th align="justify">#t.r.</th>
<th align="justify">r.P.</th>
<th align="justify">#t.c.</th>
<th align="justify">c.P.</th>
<th align="justify">#t.r.</th>
<th align="justify">r.P.</th>
<th align="justify">#t.c.</th>
<th align="justify">c.P.</th>
<th align="justify">#t.r.</th>
<th align="justify">r.P.</th>
<th align="justify">#t.c.</th>
<th align="justify">c.P.</th>
</tr>
</thead>
<tbody>
<tr>
<td align="justify">Bacteriocin</td>
<td align="justify">13</td>
<td align="justify"><bold>436</bold></td>
<td align="justify"><bold>99.8</bold></td>
<td align="justify">29</td>
<td align="justify"><bold>96.7</bold></td>
<td align="justify">182</td>
<td align="justify">69.2</td>
<td align="justify"><bold>35</bold></td>
<td align="justify">49.3</td>
<td align="justify">56</td>
<td align="justify">0.2</td>
<td align="justify">17</td>
<td align="justify">0.1</td>
</tr>
<tr>
<td align="justify">B. Lactone</td>
<td align="justify">1</td>
<td align="justify">6</td>
<td align="justify"><bold>100</bold></td>
<td align="justify">2</td>
<td align="justify"><bold>100</bold></td>
<td align="justify"><bold>9</bold></td>
<td align="justify">13.0</td>
<td align="justify"><bold>4</bold></td>
<td align="justify">16.0</td>
<td align="justify">2</td>
<td align="justify">0.0</td>
<td align="justify">1</td>
<td align="justify">0.0</td>
</tr>
<tr>
<td align="justify">H. Lactone</td>
<td align="justify">1</td>
<td align="justify">9</td>
<td align="justify"><bold>81.8</bold></td>
<td align="justify">1</td>
<td align="justify"><bold>50.0</bold></td>
<td align="justify"><bold>15</bold></td>
<td align="justify">10.3</td>
<td align="justify"><bold>4</bold></td>
<td align="justify">11.4</td>
<td align="justify">0</td>
<td align="justify">0.0</td>
<td align="justify">0</td>
<td align="justify">0.0</td>
</tr>
<tr>
<td align="justify">Lanti pep.</td>
<td align="justify">6</td>
<td align="justify"><bold>131</bold></td>
<td align="justify"><bold>100</bold></td>
<td align="justify">21</td>
<td align="justify"><bold>100</bold></td>
<td align="justify">46</td>
<td align="justify">82.1</td>
<td align="justify"><bold>22</bold></td>
<td align="justify">73.3</td>
<td align="justify">36</td>
<td align="justify">0.1</td>
<td align="justify">13</td>
<td align="justify">0.0</td>
</tr>
<tr>
<td align="justify">NRPS</td>
<td align="justify">3</td>
<td align="justify"><bold>15,037</bold></td>
<td align="justify"><bold>98.9</bold></td>
<td align="justify">479</td>
<td align="justify">86.5</td>
<td align="justify">6,125</td>
<td align="justify">98.7</td>
<td align="justify"><bold>623</bold></td>
<td align="justify"><bold>93.1</bold></td>
<td align="justify">13,786</td>
<td align="justify">32.8</td>
<td align="justify">475</td>
<td align="justify">2.4</td>
</tr>
<tr>
<td align="justify">Oligo sac.</td>
<td align="justify">3</td>
<td align="justify"><bold>32,393</bold></td>
<td align="justify"><bold>98.5</bold></td>
<td align="justify">1,315</td>
<td align="justify"><bold>89.9</bold></td>
<td align="justify">15,463</td>
<td align="justify"><bold>98.5</bold></td>
<td align="justify"><bold>1,662</bold></td>
<td align="justify">94.4</td>
<td align="justify">27,232</td>
<td align="justify">48.7</td>
<td align="justify">1,372</td>
<td align="justify">7.6</td>
</tr>
<tr>
<td align="justify">PKS</td>
<td align="justify">1</td>
<td align="justify"><bold>913</bold></td>
<td align="justify"><bold>96.8</bold></td>
<td align="justify"><bold>11</bold></td>
<td align="justify"><bold>52.4</bold></td>
<td align="justify">48</td>
<td align="justify">23.8</td>
<td align="justify">10</td>
<td align="justify">18.5</td>
<td align="justify">0</td>
<td align="justify">0.0</td>
<td align="justify">0</td>
<td align="justify">0.0</td>
</tr>
<tr>
<td align="justify">Terpene</td>
<td align="justify">3</td>
<td align="justify"><bold>1,483</bold></td>
<td align="justify"><bold>95.9</bold></td>
<td align="justify"><bold>126</bold></td>
<td align="justify"><bold>86.9</bold></td>
<td align="justify">411</td>
<td align="justify">94.0</td>
<td align="justify">92</td>
<td align="justify">86.8</td>
<td align="justify">19</td>
<td align="justify">0.1</td>
<td align="justify">7</td>
<td align="justify">0.0</td>
</tr>
<tr>
<td align="justify">Thiopeptide</td>
<td align="justify">1</td>
<td align="justify"><bold>642</bold></td>
<td align="justify"><bold>100</bold></td>
<td align="justify">19</td>
<td align="justify"><bold>100</bold></td>
<td align="justify">333</td>
<td align="justify">74.0</td>
<td align="justify"><bold>33</bold></td>
<td align="justify">47.1</td>
<td align="justify">350</td>
<td align="justify">0.8</td>
<td align="justify">17</td>
<td align="justify">0.0</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001"><p>“#Pfams” indicates the number of Pfam families involved in the biosynthesis of the corresponding secondary metabolite. Abbreviations: “B. Lactone”: Butyrolactones; “H. Lactone”: Homoserine lactone; “Lanti pep.”: Lantipeptides; “Oligo sac.”: Oligosaccharide. “#t.r.”: number of true reads; “r.P.”: read-level precision (percentage); “#t.c.”: number of true contigs; “c.P.”: contig-level precision (percentage). The highest performances among all programs are bolded.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>Running time for all programs on the simulated marine data set is available in <xref ref-type="supplementary-material" rid="pcbi.1004991.s008">S8 Table</xref>.</p>
</sec>
<sec id="sec006">
<title>Antibiotic resistance gene family profiling of metagenomic data</title>
<p>Here we demonstrate the utility of HMM-GRASPx for functional profiling of bacterial communities by studying Anti-Microbial Resistance (AMR) gene families’ abundance profiles in HMP MG data sets [<xref ref-type="bibr" rid="pcbi.1004991.ref036">36</xref>]. AMRs are globally distributed and exist in most organisms and environments due to the ubiquitous presence of microbes. AMR represents a natural bacterial defense mechanism but has become a serious problem in treating infectious diseases due to the rapid spread of resistance genes, which makes it possible for bacteria to evade treatment [<xref ref-type="bibr" rid="pcbi.1004991.ref039">39</xref>,<xref ref-type="bibr" rid="pcbi.1004991.ref040">40</xref>]. Knowledge of the resistome profile in an individual has potential applications for clinical treatment of bacterial infections.</p>
<p>The AMR protein families registered in RESFAM [<xref ref-type="bibr" rid="pcbi.1004991.ref041">41</xref>] were selected as queries to profile the resistome (<xref ref-type="supplementary-material" rid="pcbi.1004991.s009">S9 Table</xref>). Twelve MG data representing six individuals, where each individual contributed to both a supragingival and a stool data set, were selected for this experiment (<xref ref-type="supplementary-material" rid="pcbi.1004991.s010">S10 Table</xref>). HMM-GRASPx and HMMER3 were individually applied to search the AMR profiles against these data sets (see <xref ref-type="sec" rid="sec010">Methods</xref>). Presented AMR protein families were selected (<xref ref-type="supplementary-material" rid="pcbi.1004991.s009">S9 Table</xref>) and their raw counts were further normalized into Reads Per Kilobase per Million (RPKM) to represent their abundance profile of the given MG data set (see <xref ref-type="sec" rid="sec010">Methods</xref>). The predicted AMR abundance profiles were further clustered using hierarchical clustering algorithm to show body site-specific resistome (see <xref ref-type="sec" rid="sec010">Methods</xref>). The clustering results of HMM-GRASPx- and HMMER3-predicted profiles are shown in <xref ref-type="fig" rid="pcbi.1004991.g002">Fig 2A and 2B</xref>, respectively.</p>
<fig id="pcbi.1004991.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004991.g002</object-id>
<label>Fig 2</label>
<caption>
<title>AMR protein-family profiles from the six supragingival and six stool samples as predicted by HMM-GRASPx and HMMER3.</title>
<p>(A) AMR Profile predicted by HMM-GRASPx. (B) AMR Profile predicted by HMMER3. Hierarchical clustering was performed sample-wise (column-wise). Color bars on the left-hand-sides of the heat maps indicate AMR classification by RESFAM (bottom right legend). Abundance values (RPKM) were row-wise normalized into Z-scores (bottom right color key).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.g002" xlink:type="simple"/>
</fig>
<p>The results indicate that different body sites harbor bacterial communities containing distinct resistome profiles, which is in line with previous findings of the human microbiome where distinct biogeographical signatures were observed for bacterial species at 22 different body sites (including stool and oral plaque) [<xref ref-type="bibr" rid="pcbi.1004991.ref042">42</xref>]. For example, a clear difference between body sites was revealed by both programs for several genes involved in vancomycin resistance (i.e. D-Ala-D-Ala ligase genes <italic>vanA</italic>, <italic>vanB</italic>, <italic>vanC</italic>, and <italic>vanD</italic>) (<xref ref-type="fig" rid="pcbi.1004991.g002">Fig 2A and 2B</xref>, see Glycopeptide_Resistance category), which could only be identified in MG libraries obtained from oral supragingival plaque and not from the stool samples. This difference may be due to that vancomycin targets Gram-positive bacteria (the outer membrane of most Gram-negative bacteria is impermeable to large glycopeptide molecules such as vancomycin), which are highly abundant in the oral plaque and less abundant in stool. On the other hand, while the biological environment does show a stronger impact in shaping the resistome, personalized difference can indeed be observed for several AMR protein families. For example, both programs predicted high abundance of <italic>ErmA</italic>, <italic>ErmB</italic>, and <italic>ErmC</italic> genes specifically in the stool sample SRX877102 (<xref ref-type="fig" rid="pcbi.1004991.g002">Fig 2A and 2B</xref>, see rRNA_Methyltransferace category). The observation of personalized resistome profile may be explained by the antibiotics exposure history of the specific individual [<xref ref-type="bibr" rid="pcbi.1004991.ref043">43</xref>], and can be referred to when designing personalized treatment plans.</p>
<p>Although both HMM-GRASPx and HMMER3 made similar predictions on abundances of the AMR protein families for most of the cases, a notable difference is that HMM-GRASPx predicted a high abundance of all ten resistance-nodulation-division (RND) antibiotic efflux gene families in stool samples, while the HMMER3 predicted abundance profiles for these gene families are less consistent (five with higher abundances in supragingival plaque samples and the other five with higher abundances in stool samples). It is clear that HMM-GRASPx generated more biological meaningful predictions, because RND gene families are unique for Gram-negative bacteria (e.g. <italic>Bacteroides</italic>, which is abundant in healthy stool samples) and should be in low abundance in the Gram-positive rich healthy supragingival plaque samples. In addition, differences in abundance predictions further affect clustering of gene families based on the abundance profiles. Further gene family-wise WPGMA clustering algorithm clustered 7 out of the 10 RND gene families together using HMM-GRASPx predictions (<xref ref-type="supplementary-material" rid="pcbi.1004991.s014">S2 Fig</xref>), compared to only 2 out of 10 using HMMER3 predictions (<xref ref-type="supplementary-material" rid="pcbi.1004991.s015">S3 Fig</xref>). These results suggest that HMM-GRASPx improves accuracy of functional characterization and profiling for MG data sets.</p>
</sec>
<sec id="sec007">
<title>HMM-GRASPx improves differential expression analysis for metatranscriptomic data</title>
<p>MT data is routinely generated to profile the transcription level of genes, and comparison of MT data sets across different conditions and/or time points can be used to identify DE genes. Such information can be used to investigate which genes and metabolic pathways are critical in responding to environmental disturbances and how microbial communities adapt to environmental changes. The majority of the MT annotation analysis workflows rely heavily on available reference genomes, which serve as templates for read mapping. Other transcriptome assembly approaches are hampered by a similar issue of low/uneven coverage of the expressed transcripts by the microbial community. MT analysis of unexplored environments with high microbial-community complexity and very few genome sequence representatives is still an open problem.</p>
<p>To demonstrate both the utility of HMM-GRASPx for protein family-level MT analysis and how its improved homology search performance also improve DE analysis, we selected eight human oral biofilm MT data sets generated from a taxonomically well-defined oral <italic>in vitro</italic> biofilm model system [<xref ref-type="bibr" rid="pcbi.1004991.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1004991.ref044">44</xref>]. These data sets were generated to study health-associated molecular processes, which contribute to protection from caries diseases (tooth enamel mineralization). Gene transcription responses were monitored in a temporal manner while the oral <italic>in vitro</italic> biofilm community metabolized sugar which resulted in a classic pH drop of the growth media followed by a health-associated pH recovery [<xref ref-type="bibr" rid="pcbi.1004991.ref007">7</xref>]. The MT data sets (SRA: SRP049210) contain replicate libraries obtained from biofilm samples collected at 0 hour (pH 7.0, three replicates), 6 hours (pH 4.2, two replicates), and 9 hours (pH 5.2, three replicates) after glucose amendment (<xref ref-type="supplementary-material" rid="pcbi.1004991.s011">S11 Table</xref>). Since very little knowledge exists on the role of bacterial interactions and cell-to-cell signaling (i.e. antagonist or cooperative interactions) in human oral health, we focused on the identification of biosynthetic protein families that potentially synthesize signaling molecules. The biosynthetic protein families were selected from the antiSMASH2.0 database [<xref ref-type="bibr" rid="pcbi.1004991.ref038">38</xref>] (<xref ref-type="supplementary-material" rid="pcbi.1004991.s012">S12 Table</xref>). HMM-GRASPx and HMMER3 were applied individually to search all MT libraries (see <xref ref-type="sec" rid="sec010">Methods</xref>).</p>
<p>Previous analysis of the MT data sets showed that 14 key bacterial species were highly active across different pH stages [<xref ref-type="bibr" rid="pcbi.1004991.ref007">7</xref>]. These species belong to the <italic>Streptococcus</italic>, <italic>Lactobacillus</italic>, <italic>Fusobacterium</italic>, <italic>Gemella</italic>, <italic>Klebsiella</italic>, and <italic>Veillonella</italic> genera. The reference sequences of these 14 strains were used to construct the ground-truth set for benchmarking purpose (see <xref ref-type="sec" rid="sec010">Methods</xref>). Benchmark results are summarized in <xref ref-type="table" rid="pcbi.1004991.t003">Table 3</xref>, which shows that HMM-GRASPx has a higher recall rate (~80% compared to ~15%) but a lower precision rate (~80% compared to ~90%) than HMMER3. The results are consistent with the previous benchmark results on the simulated marine data set. Overall, HMM-GRASPx showed &gt;50% higher F-measure. Spearman’s correlation between the predicted and the ground-truth abundance was calculated for both HMM-GRASPx (<xref ref-type="fig" rid="pcbi.1004991.g003">Fig 3A</xref>) and HMMER3 (<xref ref-type="fig" rid="pcbi.1004991.g003">Fig 3B</xref>). The abundances predicted by HMM-GRASPx were more consistent (Spearman’s correlation 0.714) to the ground-truth abundances than HMMER3 (Spearman’s correlation 0.333). Linear regression analysis also showed that HMM-GRASPx over-predicted the abundance by 18% (slope 1.18), while HMMER3 underestimated the true abundances by 79% (slope 0.21).</p>
<fig id="pcbi.1004991.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004991.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Comparison of HMM-GRASPx- and HMMER3-generated results from the <italic>in vitro</italic> human oral plaque biofilm MT data set.</title>
<p>(A) Abundances correlation between HMM-GRASPx predictions and the ground-truth (i.e. BWA). The x- and y-axis indicate the number of homologous reads recruited by the corresponding programs. Colors indicate different conditions where the libraries were constructed (blue for 0hr/pH 7.0, red for 6hr/pH 4.2, and yellow for 9hr/pH 5.2). Different marks indicate different replicates. (B) Abundances correlation between HMMER3 predictions and the ground-truth. (C) Venn diagram showing the overlap between detected DE genes using HMM-GRASPx predictions (green), HMMER3 predictions (red), and the ground-truth homologous reads (blue).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.g003" xlink:type="simple"/>
</fig>
<table-wrap id="pcbi.1004991.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004991.t003</object-id>
<label>Table 3</label> <caption><title>Performance of HMM-GRASPx and HMMER3 for searching biosynthetic protein family profiles against the <italic>in vitro</italic> human oral plaque biofilm MT data sets.</title></caption>
<alternatives>
<graphic id="pcbi.1004991.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.t003" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="2">Sample</th>
<th align="center" rowspan="2">#Reads</th>
<th align="center" colspan="3">HMM-GRASPx</th>
<th align="center" colspan="3">HMMER3</th>
</tr>
<tr>
<th align="center">Recall</th>
<th align="center">Precision</th>
<th align="center">F-measure</th>
<th align="center">Recall</th>
<th align="center">Precision</th>
<th align="center">F-measure</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><bold>0H.1</bold></td>
<td align="center">22,280,139</td>
<td align="center"><bold>81.5</bold></td>
<td align="center">83.0</td>
<td align="center"><bold>82.3</bold></td>
<td align="center">15.8</td>
<td align="center"><bold>90.5</bold></td>
<td align="center">26.9</td>
</tr>
<tr>
<td align="center"><bold>0H.2</bold></td>
<td align="center">17,687,166</td>
<td align="center"><bold>81.9</bold></td>
<td align="center">88.4</td>
<td align="center"><bold>85.1</bold></td>
<td align="center">16.4</td>
<td align="center"><bold>91.6</bold></td>
<td align="center">27.8</td>
</tr>
<tr>
<td align="center"><bold>0H.3</bold></td>
<td align="center">23,106,973</td>
<td align="center"><bold>82.4</bold></td>
<td align="center">88.0</td>
<td align="center"><bold>85.1</bold></td>
<td align="center">16.0</td>
<td align="center"><bold>91.6</bold></td>
<td align="center">27.3</td>
</tr>
<tr>
<td align="center"><bold>6H.1</bold></td>
<td align="center">31,229,289</td>
<td align="center"><bold>81.0</bold></td>
<td align="center">74.2</td>
<td align="center"><bold>77.4</bold></td>
<td align="center">16.2</td>
<td align="center"><bold>90.4</bold></td>
<td align="center">27.5</td>
</tr>
<tr>
<td align="center"><bold>6H.2</bold></td>
<td align="center">43,702,127</td>
<td align="center"><bold>83.2</bold></td>
<td align="center">78.5</td>
<td align="center"><bold>80.8</bold></td>
<td align="center">16.7</td>
<td align="center"><bold>95.0</bold></td>
<td align="center">28.4</td>
</tr>
<tr>
<td align="center"><bold>9H.1</bold></td>
<td align="center">15,550,857</td>
<td align="center"><bold>79.2</bold></td>
<td align="center">84.1</td>
<td align="center"><bold>81.6</bold></td>
<td align="center">16.7</td>
<td align="center"><bold>91.8</bold></td>
<td align="center">28.2</td>
</tr>
<tr>
<td align="center"><bold>9H.2</bold></td>
<td align="center">37,336,599</td>
<td align="center"><bold>82.6</bold></td>
<td align="center">86.8</td>
<td align="center"><bold>84.6</bold></td>
<td align="center">14.5</td>
<td align="center"><bold>93.2</bold></td>
<td align="center">25.1</td>
</tr>
<tr>
<td align="center"><bold>9H.3</bold></td>
<td align="center">42,394,221</td>
<td align="center"><bold>81.9</bold></td>
<td align="center">77.3</td>
<td align="center"><bold>79.5</bold></td>
<td align="center">14.5</td>
<td align="center"><bold>91.4</bold></td>
<td align="center">25.1</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The gene-expression underestimation by HMMER3 represents a reduced statistical power in downstream DE analysis, which subsequently leads to false negative predictions. The abundances predicted by HMM-GRASPx and HMMER3 were used to identify the DE genes in the 14 key species of the community using the DESeq2 program [<xref ref-type="bibr" rid="pcbi.1004991.ref045">45</xref>] (see <xref ref-type="sec" rid="sec010">Methods</xref>). <xref ref-type="fig" rid="pcbi.1004991.g003">Fig 3C</xref> shows that the majority of the true DE genes were successfully identified using HMM-GRASPx predictions, resulting in a Jaccard similarity of 0.74 with the ground-truth. On the other hand, HMMER3-based DE gene detection only showed a Jaccard similarity of 0.23. The majority (89.7%) of the HMMER3-based DE genes were contained in the set of HMM-GRASPx-based DE genes. The results suggest that the improved homology search accuracy brought by HMM-GRASPx will also improve DE gene analysis.</p>
</sec>
<sec id="sec008">
<title>HMM-GRASPx improves targeted assembly of metatranscriptomic data</title>
<p>The above benchmark for strain-level DE analysis was made possible through using the reference sequences of the 14 core genomes to partition the recruited homolog reads. In practice, reference genomes may not always be available, especially for less-explored environments. In this case, it might be challenging to obtain strain-level expression of the protein families from direct application of homology search programs such as HMM-GRASPx, HMMER3, or RPS-BLAST. A potential solution to this problem is to first assemble the recruited homologous reads (<xref ref-type="fig" rid="pcbi.1004991.g001">Fig 1</xref>, “Peptide assembly” and “Nucleotide assembly”) followed by taxonomic binning of the resulting contigs [<xref ref-type="bibr" rid="pcbi.1004991.ref046">46</xref>,<xref ref-type="bibr" rid="pcbi.1004991.ref047">47</xref>]. DE analysis within individual taxonomic bins would allow for monitoring of transcription activities of different taxonomic groups among environmental changes.</p>
<p>Here, using the <italic>in vitro</italic> oral biofilm MT data sets, we benchmarked the qualities of the assemblies that were generated by using HMM-GRASPx- and HMMER3-recruited reads. Protein families in the antiSMASH2.0 database [<xref ref-type="bibr" rid="pcbi.1004991.ref038">38</xref>] that are longer than 200 HMM states were used as the queries for this experiment (<xref ref-type="supplementary-material" rid="pcbi.1004991.s012">S12 Table</xref>). Peptide assembly was performed using SFA-SPA [<xref ref-type="bibr" rid="pcbi.1004991.ref021">21</xref>]; and nucleotide assembly was performed using SPAdes [<xref ref-type="bibr" rid="pcbi.1004991.ref018">18</xref>] (see <xref ref-type="sec" rid="sec010">Methods</xref>). Only peptide contigs that are longer than 60aa and nucleotide contigs that are longer than 180nt were considered (see <xref ref-type="sec" rid="sec010">Methods</xref>). Refer to the targeted assembly of a query protein family on a MT data set as an <italic>assembly case</italic>.</p>
<p>For protein assembly, SFA-SPA was able to assemble more and longer contigs using HMM-GRASPx predicted reads. Concretely, SFA-SPA generated at least one contig for 227 assembly cases using HMM-GRASPx-predicted reads (blue bars in <xref ref-type="fig" rid="pcbi.1004991.g004">Fig 4A</xref>), while it generated at least one contig for only 64 assembly cases using HMMER3-predicted reads (red bars in <xref ref-type="fig" rid="pcbi.1004991.g004">Fig 4A</xref>). <xref ref-type="fig" rid="pcbi.1004991.g004">Fig 4A</xref> also shows that for the overlapping cases between HMM-GRASPx-based assembly and HMMER3 based assembly (totaling 63), HMM-GRASPx-based contigs have higher normalized N50 (see <xref ref-type="sec" rid="sec010">Methods</xref>) than HMMER3-based contigs (in <xref ref-type="fig" rid="pcbi.1004991.g004">Fig 4A</xref> where blue and red bars overlap, blue bars are generally higher than red bars). <xref ref-type="fig" rid="pcbi.1004991.g004">Fig 4C</xref> shows that on average, the normalized N50 for HMM-GRASPx-based peptide contigs is 2.3 fold higher than HMMER3-based peptide contigs. <xref ref-type="fig" rid="pcbi.1004991.g004">Fig 4D</xref> also shows that HMM-GRASPx-based peptide assembly recruited 18.3 fold more reads than HMMER3-based peptide assembly. We subsequently assess the precision of the assembled contigs by realigning them back to the query HMM using HMMER3. Among the 1,263 HMM-GRASPx-based contigs, 1,154 can be aligned to the corresponding query HMM (precision 91.4%, see <xref ref-type="sec" rid="sec010">Methods</xref>). As expected, all 279 HMMER3-based contigs were successfully aligned (due to that HMMER3 was used in both the search and verification steps).</p>
<fig id="pcbi.1004991.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004991.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Targeted assembly of secondary metabolite synthesizing protein families from the <italic>in vitro</italic> human oral biofilm MT data set.</title>
<p>Only the protein contigs longer than 60aa and nucleotide contigs longer than 180nt were considered. (A) Normalized N50 for protein assembly. (B) Normalized N50 for nucleotide assembly. For (A) and (B), red color indicates the performance of HMMER3 and blue color indicates HMM-GRASPx. The x-axes indicate assembly cases and were sorted based on the decreasing values of the HMMER3 performance and then the decreasing values of the HMM-GRASPx performance. Assembly cases without corresponding red bars indicate that no contig was assembled using HMMER3 predictions. (C) Log2 fold change for the N50 measures in assembly cases where contigs can be assembled using either HMMER3 or HMM-GRASPx prediction. (D) Log2 fold change for the number of assembled reads in assembly cases where contigs can be assembled using either HMMER3 or HMM-GRASPx prediction.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.g004" xlink:type="simple"/>
</fig>
<p>For targeted nucleotide assembly, the same trend that HMM-GRASPx-based assembly generated more and longer contigs and maintains high precision was also observed. Specifically, <xref ref-type="fig" rid="pcbi.1004991.g004">Fig 4B</xref> shows that SPAdes [<xref ref-type="bibr" rid="pcbi.1004991.ref018">18</xref>] generated at least one contig for 220 assembly cases using HMM-GRASPx-predicted reads (blue bars), while it generated at least one contig for only 41 assembly cases using HMMER3-predicted reads (red bars). <xref ref-type="fig" rid="pcbi.1004991.g004">Fig 4B</xref> also shows that the normalized N50 measures of the HMM-GRASPx-based contigs are generally higher than those of HMMER3-based contigs for the overlapping 41 assembly cases. <xref ref-type="fig" rid="pcbi.1004991.g004">Fig 4C</xref> shows that on average, the normalized N50 for HMM-GRASPx-based peptide contigs is 1.5 fold higher than HMMER3-based nucleotide contigs. <xref ref-type="fig" rid="pcbi.1004991.g004">Fig 4D</xref> also shows that HMM-GRASPx-based peptide assembly recruited 91.8 fold more reads than HMMER3-based nucleotide assembly. Among the 3,842 HMM-GRASPx-based contigs, 3,437 of them were successfully verified with E-value less than 0.01 (precision 89.4%). All 412 HMMER3 based contigs were successfully verified.</p>
<p>For the 3,437 verified nucleotide contigs, we further evaluated their taxonomic origins by searching these sequences using BLASTN against the NT (non-redundant nucleotide) and using BLASTX against the NR (non-redundant protein) databases (see <xref ref-type="sec" rid="sec010">Methods</xref>). BLASTX was able to identify high-scoring hits from the NR database for all 3,437 nucleotide contigs, while BLASTN failed to align 507 (14.8%) of them against the NT database. We also attempted to use KRAKEN [<xref ref-type="bibr" rid="pcbi.1004991.ref048">48</xref>] with the entire RefSeq as the reference database to annotate these 507 contigs but failed on 506 or 99.8% of them (see <xref ref-type="sec" rid="sec010">Methods</xref>). A potential reason for not finding these contigs’ homologs from the NT database is that they might harbor a significant amount of neutral mutations and originate from previously uncharacterized microbial species. The BLASTX search results for these contigs can be used to infer the relationship between these uncharacterized microbial species and known bacterial species (<xref ref-type="supplementary-material" rid="pcbi.1004991.s016">S4 Fig</xref>). In additional to taxonomic inference, the nucleotide sequences assembled using HMM-GRASPx can also provide valuable information for further design experiments (e.g. PCR primer design) for evaluating the expression levels or investigating the functions of the protein families.</p>
</sec>
<sec id="sec009">
<title>Conclusions</title>
<p>In summary, we developed a novel profile-based SAA algorithm and implemented the idea into the HMM-GRASPx program. HMM-GRASPx aims at highly accurate MG/MT data analysis in the absence of complete reference databases. Here we demonstrate that HMM-GRASPx significantly improves homology search and facilitates functional profiling of MG data sets for accurate and robust characterization and comparison of microbial communities. The program was also shown to improve DE detection in MT data sets, which will lead to improved identification of metabolic pathways and coverage of genes within these pathways that are under differential regulation. Finally, HMM-GRASPx can also be used for targeted assembly, which can subsequently enable a more in-depth analysis of taxonomy and protein family function. The program HMM-GRASPx is freely available online from <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/hmm-graspx" xlink:type="simple">http://sourceforge.net/projects/hmm-graspx</ext-link><underline>.</underline></p>
</sec>
</sec>
<sec id="sec010" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec011">
<title>HMM-GRASPx algorithm</title>
<p>The core algorithm of HMM-GRASPx was developed as an integration of the banded Viterbi algorithm for HMM parsing and the GRASPx SAA engine that iteratively computes sequence similarity and extends contigs based on overlapping short peptide sequences in the database. The seeding and the alignment modules are substantially different from GRASPx; and we focus on describing them here. Details for the other modules can be found in Zhong <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1004991.ref025">25</xref>].</p>
<p>HMM-GRASPx begins with seeding, a process that aims at anchoring the initial alignment based on highly similar regions shared between the reference and the target. When searching an HMM against the short-peptide database, seeding is performed by identifying high-scores matchings <italic>k</italic>-grams (<italic>k</italic>-gram refers to <italic>k</italic> consecutive match states in the reference HMM model or <italic>k</italic> consecutive amino acids in the target). Define the <italic>maximum seed score</italic> for the <italic>k</italic>-grams in the reference as the highest log odds-ratio for any sequence that can be emitted from the <italic>k</italic>-grams. A score scale (between 0 and 1) can be applied to the maximum seed score to define a position-specific cutoff for seeding. HMM-GRASPx further incorporates an efficient seeding heuristic through adopting the idea of reduced-alphabet [<xref ref-type="bibr" rid="pcbi.1004991.ref015">15</xref>] for pre-filtering target <italic>k</italic>-grams.</p>
<p>The alignment component of HMM-GRASPx adopts the banded Viterbi algorithm. The Viterbi algorithm computes the most probable parse of a sequence given the HMM. The dynamic programming algorithm can be summarized as the following recursive functions (for extension to the C-terminus; extension to the N terminus can be derived analogously).</p>
<disp-formula id="pcbi.1004991.e001">
<alternatives>
<graphic id="pcbi.1004991.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004991.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>M</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>I</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>D</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="0.25em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004991.e002">
<alternatives>
<graphic id="pcbi.1004991.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004991.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>M</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>I</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="0.2em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004991.e003">
<alternatives>
<graphic id="pcbi.1004991.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004991.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>M</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>D</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="0.2em"/><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<p>The first index <italic>i</italic> refers to the reference and the second index <italic>j</italic> refers to target. The tables <italic>M</italic>, <italic>I</italic>, and <italic>D</italic> store scores (log odds-ratio) for the most-likely parse, provided that the current-stage parse ends in the match, insert, or delete states of the HMM, respectively. The emission probabilities <italic>emit</italic> and the transition probabilities <italic>trans</italic> are coded in the HMM models. The banding was implemented through only computing table entries which satisfy the condition |<italic>i</italic> − <italic>j</italic>| ≤ <italic>d</italic>, where <italic>d</italic> is the band size.</p>
<p>The limitations of the above Viterbi algorithm are two-fold. First, the seeding and banding constraints violate the compositional assumption (i.e. the probabilities of all possible sequences no longer add up to 1 for the given parameters); the resulting statistics should only be used for ranking the targets. Second, the Viterbi algorithm only computes the best parse of the sequence, while the Forward-backward algorithm considers all parses and provides more meaningful statistical measures [<xref ref-type="bibr" rid="pcbi.1004991.ref049">49</xref>]. To avoid both limitations, HMMER3 is used re-compute the scores for HMM-GRASPx assembled protein contigs. The overhead of this step is marginal compared to the main assembly module.</p>
<p>The HMM-GRASPx algorithm can be summarized in the following steps:</p>
<list list-type="order">
<list-item><p>Indexing: HMM-GRASPx constructs the extension links for the given MG/MT database, which is conceptually analogous to the overlap graph [<xref ref-type="bibr" rid="pcbi.1004991.ref025">25</xref>].</p></list-item>
<list-item><p>Seeding: The seeds are identified through identifying high-score <italic>k</italic>-grams between the reference and the target. The reads that contain the corresponding <italic>k</italic>-grams are used as initial contigs for further extension.</p></list-item>
<list-item><p>Extension: HMM-GRASPx extends the current contigs based on the pre-constructed extension links that are associated with the contigs’ terminating reads. For more details please refer to [<xref ref-type="bibr" rid="pcbi.1004991.ref025">25</xref>].</p></list-item>
<list-item><p>Alignment: The alignment between the querying HMM and the current contig is evaluated using the banded Viterbi’s algorithm described above. HMM-GRASPx at this step decides whether to continue using both log odds-ratio drop-off and read redundancy [<xref ref-type="bibr" rid="pcbi.1004991.ref025">25</xref>]. If it decides to continue, the algorithm loops back to the previous Extension step.</p></list-item>
<list-item><p>Recalibration: After all initial contigs being extended, the algorithm attempts to further assemble this contigs to increase their lengths. For more details please refer to [<xref ref-type="bibr" rid="pcbi.1004991.ref025">25</xref>].</p></list-item>
<list-item><p>Realignment: The recalibrated contigs are realigned with the querying profile HMM to recalculate the statistics using HMMER3.</p></list-item>
<list-item><p>Mapping: Short peptides are subsequently mapped against the trusted contigs.</p></list-item>
</list>
</sec>
<sec id="sec012">
<title>Benchmark experiment on the simulated marine metagenomic data set</title>
<p>Twenty three bacterial genomes were chosen for the simulation as they were found prevalent in marine environments [<xref ref-type="bibr" rid="pcbi.1004991.ref050">50</xref>] (<xref ref-type="supplementary-material" rid="pcbi.1004991.s001">S1 Table</xref>). According to their natural compositions, each genome was <italic>in silico</italic> sequenced with different coverage (min coverage 1.25X, max coverage 10X, mean coverage 4X). WGSIM (version 0.3.0) was used for <italic>in silico</italic> sequencing to generate pair-end reads with error rate 0.01 and expected read length 100; and the number of reads to be generated were calculated using the genome sizes and the expected coverages (parameter for running WGSIM: ‘-e 0.01–1 100–2 100 -N [num_reads]’). The nucleotide reads were then translated into short peptide reads using FragGeneScan (version 1.17) [<xref ref-type="bibr" rid="pcbi.1004991.ref023">23</xref>] with parameters ‘-complete = 0 -train = illumina_10’. The resulting simulated data set is available online from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/SimMarine_23G.fa.tgz" xlink:type="simple">https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/SimMarine_23G.fa.tgz</ext-link>.</p>
<p>A set of Pfam (version 27.0) protein families which involve in important metabolic pathways (protein family-pathway association was made using the Kyoto Encyclopedia of Genes and Genomes, or KEGG, which was obtained in Jan. 2015) was used as queries for the benchmark experiment (<xref ref-type="supplementary-material" rid="pcbi.1004991.s002">S2 Table</xref>). The ground-truth homolog reads for a given protein family was defined by searching the protein family profile against the complete genomes. Concretely, the protein family profile HMM was searched against all proteins encoded (coding regions were extracted from KEGG) by the 23 genomes listed in <xref ref-type="supplementary-material" rid="pcbi.1004991.s001">S1 Table</xref> using HMMER3 with default parameters. All identified regions that are passing the HMMER3 (version 3.1b2) trusted-cutoff (i.e. E-value 0.01) were selected as homologous regions. Such a setting was applied to all HMMER3 runs referred in this work. Note that one protein sequence may contain multiple homolog regions with each of them assigned to different Pfam families; this is because one protein sequence may contain multiple domains. However, each region can be assigned to only one protein family; if the region was able to be aligned to multiple protein families, it would be assigned to the protein family that generates the most significant E-value. The simulated peptide reads were then mapped against these homologous regions using an in-house short-peptide mapper ‘graspx-map’ (with parameters ‘—num_errors = 3—portion_mapped = 0.6’, which requires that a short peptide be mapped to the reference for &gt;60% of its sequence with less than three substitution errors). Such a setting was applied to all ‘graspx-map’ runs referred in this work. The program ‘graspx-map’ is released together with the HMM-GRASPx software package. The ground-truth homologous reads are available online from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/SimMarineGroundTruth.tgz" xlink:type="simple">https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/SimMarineGroundTruth.tgz</ext-link>.</p>
<p>The performance of each homology search program was measured as follows. Define true positives (TP) as the successfully predicted homologous reads, false positives (FP) as the predicted non-homologous reads, and false negatives (FN) as the un-predicted homologous reads. Subsequently, define Recall rate and Precision rate as:
<disp-formula id="pcbi.1004991.e004">
<alternatives>
<graphic id="pcbi.1004991.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004991.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mrow><mml:mtext>Re</mml:mtext><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mtext>Pr</mml:mtext><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>The F-measure, a weighted average of recall and precision, was then defined as
<disp-formula id="pcbi.1004991.e005">
<alternatives>
<graphic id="pcbi.1004991.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004991.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>*</mml:mi><mml:mspace width="0.15em"/><mml:mtext>Re</mml:mtext><mml:mspace width="0.1em"/><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.15em"/><mml:mi>*</mml:mi><mml:mspace width="0.15em"/><mml:mtext>Pr</mml:mtext><mml:mspace width="0.1em"/><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>Re</mml:mtext><mml:mspace width="0.1em"/><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mtext>Pr</mml:mtext><mml:mspace width="0.1em"/><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>The profile HMMs of the selected protein families were retrieved from of Pfam version 27.0. The corresponding position-specific scoring matrix (PSSM) profiles (required by RPS-BLAST as inputs) for these protein families were retrieved from the Conserved Domain Database (CDD, downloaded on Oct. 24<sup>th</sup>, 2014) [<xref ref-type="bibr" rid="pcbi.1004991.ref030">30</xref>]. HMM-GRASPx was run in its default mode. Default parameters of HMM-GRASPx are detailed as follows. The seed length for alignment initialization is set to 6 (in reduced alphabet GBMR4, see definition in [<xref ref-type="bibr" rid="pcbi.1004991.ref015">15</xref>]); the minimum overlap length for assembly is set to 10; the alignment band-size is set to 20; the maximum assembly depth is set to 5; the HMM-GRASPx <italic>P</italic>-value cutoff was set to 0.05; and the HMMER3 verification E-value cutoff was set to 0.01. Such a setting was applied to all HMM-GRASPx runs referred in this work. Read recruitment was performed using ‘graspx-map’. HMMER3 [<xref ref-type="bibr" rid="pcbi.1004991.ref028">28</xref>] was run with its default parameters. RPS-BLAST (version ncbi-blast+2.2.28) [<xref ref-type="bibr" rid="pcbi.1004991.ref030">30</xref>] was run with its default parameters except that its E-value cutoff was set to 0.001 (‘-evalue 0.001’). We tuned this parameter so as to match the precision rate of RPS-BLAST with the other programs (~90%). Such a setting was applied to all RPS-BLAST runs referred in this work. UProC (version 1.2.0) [<xref ref-type="bibr" rid="pcbi.1004991.ref033">33</xref>] was run using its default parameters with Pfam seed alignments as the reference database. We chose Pfam seed alignments instead of Pfam full alignments for fair comparison; because the query profiles of the other programs, i.e. HMM-GRASPx, HMMER3, and RPS-BLAST, were built from Pfam seed alignments.</p>
</sec>
<sec id="sec013">
<title>Benchmark experiment on the human saliva metagenomic data set SRS013942</title>
<p>The data set was first retrieved from NCBI Sequence Read Archive (SRA) using the accession ID SRS013942 and then quality trimmed using CLC Assembly Cell (version 4.0.12) using parameters ‘-f 33 -m 55’, which only keeps reads that are longer than 55bp after the trimming. Low-complexity regions of the reads were detected using DUST (from ncbi-blast+2.2.28) with default parameters; reads with &gt;40% of their sequences being masked were subsequently discarded. The preprocessed nucleotide reads were then translated into peptide reads using FragGeneScan (version 1.17) [<xref ref-type="bibr" rid="pcbi.1004991.ref023">23</xref>] with parameters ‘-complete = 0 -train = illumina_10’. The data set contains 12,036,685 reads in total and is available online from FragGeneScan-called peptide reads available from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/Saliva.faa.tgz" xlink:type="simple">https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/Saliva.faa.tgz</ext-link>.</p>
<p>A list of protein family profiles compiled from the antiSMASH2.0 database (downloaded on May 29<sup>th</sup>, 2015) was used as the queries (<xref ref-type="supplementary-material" rid="pcbi.1004991.s005">S5 Table</xref>). Because RPS-BLAST does not build PSSMs out of the multiple alignments from scratch, only the Pfam profiles in the antiSMASH2.0 database were used as the queries for this exercise because their corresponding PSSMs can be directly retrieved from CDD. HMM-GRASPx, HMMER3, and RPS-BLAST were run with the parameters described in the previous section. Note that UProC was allowed to use Pfam full alignments as its reference database as recommended by the UProC authors to optimize its performance. The reads recruited by each of the programs were then assembled using SFA-SPA (version 0.2.1) [<xref ref-type="bibr" rid="pcbi.1004991.ref021">21</xref>] using default parameters. The resulting assembled contigs are available online at <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/SalivaAssembledContigs.faa.tgz" xlink:type="simple">https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/SalivaAssembledContigs.faa.tgz</ext-link>. True contigs (<italic>t</italic>.<italic>c</italic>.) were defined as the contigs that can be aligned with the querying protein family profile using HMMER3 and passing the trusted E-value cutoff 0.01; true homologous reads (<italic>t</italic>.<italic>r</italic>.) were defined as the reads that can be mapped onto the true contigs using ‘graspx-map’. Correspondingly, the read-level (<italic>r</italic>.<italic>P</italic>.) and contig-level (<italic>c</italic>.<italic>P</italic>.) precision rate for each programs were respectively defined as follows:
<disp-formula id="pcbi.1004991.e006">
<alternatives>
<graphic id="pcbi.1004991.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004991.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:mrow><mml:mi>r</mml:mi><mml:mo>.</mml:mo><mml:mi>P</mml:mi><mml:mo>.</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>#</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.1em"/><mml:mtext>Re</mml:mtext><mml:mspace width="0.1em"/><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>#</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mspace width="0.1em"/><mml:mtext>Re</mml:mtext><mml:mspace width="0.1em"/><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="0.25em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.25em"/><mml:mi>c</mml:mi><mml:mo>.</mml:mo><mml:mi>P</mml:mi><mml:mo>.</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>#</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>#</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
</sec>
<sec id="sec014">
<title>Analysis of the human supragingival and stool metagenomic data sets</title>
<p>Twelve metagenomic data sets from six healthy individuals (each individual contributing to one supragingival and one stool data set) were downloaded from NCBI SRA using the accession numbers provided in <xref ref-type="supplementary-material" rid="pcbi.1004991.s004">S4 Table</xref>. Trimmomatic [<xref ref-type="bibr" rid="pcbi.1004991.ref051">51</xref>] was used to trim the reads with parameters ‘ILLUMINACLIP:TruSeq3-PE-2.fa:2:30:10 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:75’. The trimmed nucleotide reads were then translated into peptide reads using FragGeneScan (version 1.17) [<xref ref-type="bibr" rid="pcbi.1004991.ref023">23</xref>] with parameters ‘-complete = 0 -train = illumina_10’.</p>
<p>A list of AMR gene families from RESFAM (downloaded on Aug. 12<sup>th</sup>, 2015) [<xref ref-type="bibr" rid="pcbi.1004991.ref041">41</xref>] was used as the query (see <xref ref-type="supplementary-material" rid="pcbi.1004991.s005">S5 Table</xref>). HMM-GRASPx and HMMER3 were run as previously described. Only the protein families that had at least 10 homolog reads predicted by both HMM-GRASPx and HMMER3 were selected for further analysis. In total 77 protein families were selected. The abundances of these 77 protein families were represented as the RPKM; and the RPKM data is available online from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/RESFAMResults.tgz" xlink:type="simple">https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/RESFAMResults.tgz</ext-link>. Sample-wise hierarchical clustering was performed on the RPKMs using the R function ‘heatmap.2’ with one minus Spearman’s correlation as the distance measure and the Weighted Pair Group Method with Averaging (WPGMA) as the clustering algorithm (parameters used: ‘scale = "col", hclust = function(x) hclust(x,method = "mcquitty"), distfun = function(x) as.dist(1-cor(t(x), method = "spearman"))’).</p>
</sec>
<sec id="sec015">
<title>Analysis of the human oral metatranscriptomic data set SRP049210</title>
<p>All data sets from the project SRP049210 were downloaded from NCBI SRA database. Quality trimming was performed using CLC Assembly Cell (version 4.0.12) using parameters ‘-f 33 -m 55’ and low-complexity regions of the reads were detected using DUST (from ncbi-blast+2.2.28) with default parameters; reads with &gt;40% of their sequences being masked were subsequently discarded. The remaining reads were then further checked for ribosomal sequences using RIBOPICKER (version 0.4.3) [<xref ref-type="bibr" rid="pcbi.1004991.ref052">52</xref>]. The nucleotide reads were then translated into peptide reads using FragGeneScan (version 1.17) [<xref ref-type="bibr" rid="pcbi.1004991.ref023">23</xref>] with parameters ‘-complete = 0 -train = illumina_10’.</p>
<p>Fourteen strains were found important and prevailing across all samples as their genomes recruits the largest amount of reads from all time points (&gt;70%, BWA version 0.7.12 was used for the mapping with default parameters, see ref. [<xref ref-type="bibr" rid="pcbi.1004991.ref007">7</xref>]). These strains include <italic>Streptococcus salivarius</italic> CCHSS3, <italic>S</italic>. <italic>vestibularis</italic> F0396, <italic>S</italic>. <italic>sp</italic>. C-150, <italic>S</italic>. <italic>mitis</italic> bv_2_str F0392, <italic>S</italic>. <italic>thermophilus</italic> LMD-9, <italic>S</italic>. <italic>parasanguinis</italic> ATCC15912, <italic>S</italic>. <italic>sanguinis</italic> ATCC 49296, <italic>S</italic>. <italic>agalactiae</italic> ATCC 13813, <italic>Veillonella atypica</italic> ACS-134-V-Col7a, <italic>V</italic>. <italic>dispar</italic> ATCC 17748, <italic>Lactobacillus fermentum</italic> IFO3956, <italic>Klebsiella</italic> sp. MS 92–3, <italic>Gemella haemolysans</italic> ATCC 10379 and <italic>Fusobacterium sp</italic>. 2_1_31 [<xref ref-type="bibr" rid="pcbi.1004991.ref007">7</xref>]. Only the reads that can be mapped onto these 14 genomes were selected for the benchmark experiments. Because the majority of the reads can be mapped onto these 14 strains (64–75%, see <xref ref-type="supplementary-material" rid="pcbi.1004991.s011">S11 Table</xref>), the benchmark data set will largely reflect the actual performance of the programs on these human oral MT data sets.</p>
<p>A list of biosynthetic gene cluster profiles registered in antiSMASH2.0 was used as the quires (<xref ref-type="supplementary-material" rid="pcbi.1004991.s003">S3 Table</xref>). Ground-truth homologous reads were constructed as by first calling the protein coding regions of these 14 complete genomes using FragGeneScan (using parameter ‘-complete = 1 -train = illumina_10’), searching the querying profiles against the called proteins using HMMER3 and identifying the homologous regions, and then extracting the reads that were mapped to the corresponding genomic intervals of these homologous regions. The ground-truth homologous reads are available online from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/OralGroundTruth.tgz" xlink:type="simple">https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/OralGroundTruth.tgz</ext-link>. HMM-GRASPx and HMMER3 were run as previously described; and the search results of the programs are available online from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/OralSearchResults.tgz" xlink:type="simple">https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/OralSearchResults.tgz</ext-link>.</p>
<p>To perform DE analysis, given a protein family, the reads recruited by HMM-GRASPx/HMMER3 were partitioned according to their BWA mappings against the 14 genomes. The ground-truth read count for a given protein family of a given genome was computed by summing all reads that were mapped to the homologous regions of the corresponding protein family of the corresponding genome. The raw read count generated by HMM-GRASPx and HMMER3 and the ground-truth read count are available from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/OralAbundanceCorrelation.tgz" xlink:type="simple">https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/OralAbundanceCorrelation.tgz</ext-link>. The raw read counts were fed into DESeq2 (version 1.10.1) to perform DE analysis between samples that were collected at 0hr and 6hr. To define condition group in DESeq2, experiments SRX739395, SRX745225, and SRX748266 were pooled as condition 0hr; and experiments SRX748253 and SRX748263 were pooled as condition 6hr. Protein families that were predicted with <italic>P</italic>-values less than 0.05 were considered as differentially expressed. The DE results are available from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/OralDEResults.tgz" xlink:type="simple">https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/OralDEResults.tgz</ext-link>.</p>
<p>For the targeted assembly experiment, all reads from the data sets were searched using HMM-GRASPx and HMMER3. The recruited reads were further assembled in both nucleotide level and protein level. Both protein- and nucleotide-level targeted assembly experiments were performed on 81 antiSMASH2.0 protein families that are longer than 200 HMM states (<xref ref-type="supplementary-material" rid="pcbi.1004991.s008">S8 Table</xref>). All corresponding peptide/nucleotide reads from the eight samples whose peptide-products have been recruited by a given program (HMM-GRASPx or HMMER3) were pooled together for assembly.</p>
<p>For protein-level targeted assembly, the peptide reads were assembled using SFA-SPA (version 0.2.1) [<xref ref-type="bibr" rid="pcbi.1004991.ref021">21</xref>] using default parameters. Short contigs (that are shorter than 60aa, i.e. the expected sum of lengths of two peptide-reads) were discarded. The assembled protein contigs are available online from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/OralTargetedAssembly.tgz" xlink:type="simple">https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/OralTargetedAssembly.tgz</ext-link>. The normalized N50 was calculated as the N50 for the contig set over the length of the corresponding querying protein family. Correctness of the contigs was verified by aligning them to the corresponding querying protein family profile using HMMER3 with default parameters. Contigs with a resulting E-value that is more significant than 0.01 was considered as true contigs. The peptide reads were mapped against the contigs using ‘graspx-map’ to estimate the assembly rate.</p>
<p>For nucleotide-level targeted assembly, the nucleotide reads were assembled using SPAdes (version 3.5.0) [<xref ref-type="bibr" rid="pcbi.1004991.ref018">18</xref>]. Single-end assembly mode was used and no error correction was performed (using ‘—only-assembler’). Short contigs (that are shorter than 180nt, i.e. the expected sum of lengths of two nucleotide-reads) were discarded. The assembled nucleotide contigs are available online from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/OralTargetedAssembly.tgz" xlink:type="simple">https://sourceforge.net/projects/hmm-graspx/files/SupplementaryData/OralTargetedAssembly.tgz</ext-link>. The normalized N50 was calculated as the N50 for the contig set over the length of the corresponding querying protein family multiplied by three, i.e. the codon length. Correctness of the contigs was verified by first translating them into proteins using FragGeneScan with parameters ‘-complete = 1 -train = illumina_10’ and then aligning them to the corresponding querying protein family profile using HMMER3 with default parameters. Contigs with a resulting E-value that is more significant than 0.01 were considered as true contigs. The nucleotide reads were mapped against the remaining contigs using BWA with default parameters to estimate the assembly rate.</p>
<p>To infer the taxonomic origin of the nucleotide contigs assembled using HMM-GRASPx recruitments, the true nucleotide contigs were further searched against the NCBI non-redundant nucleotide database (NT, downloaded on Oct. 20<sup>th</sup>, 2015) using BLASTN (ncbi-blast+2.2.28) with default parameters and the NCBI non-redundant protein database (NR, downloaded on Oct. 20<sup>th</sup>, 2015) using BLASTX (ncbi-blast+2.2.28). Taxonomy of the contigs that did not hit any NT entries was inferred using KRAKEN (version 0.10.5-beta) [<xref ref-type="bibr" rid="pcbi.1004991.ref048">48</xref>] with default parameters and RefSeq (downloaded on Jan 13<sup>th</sup>, 2015) as the reference database.</p>
</sec>
</sec>
<sec id="sec016">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004991.s001" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.s001" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Taxonomic composition of the simulated marine data set.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004991.s002" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.s002" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>The Pfam families that were selected as the queries for the benchmark experiment on the simulated marine data set.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004991.s003" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.s003" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Benchmark results of HMM-GRASPx, HMMER3, RPS-BLAST, and UProC on a simulated data set where every single genome (the 23 genomes in use is listed in <xref ref-type="supplementary-material" rid="pcbi.1004991.s001">S1 Table</xref>) has an even 10X coverage.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004991.s004" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.s004" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>The Pfam families that were selected as the queries for the benchmark experiment on the human saliva data set SRS013942.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004991.s005" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.s005" xlink:type="simple">
<label>S5 Table</label>
<caption>
<title>The number of true reads (#t.r.) recruited and the number of true contigs (#t.c.) assembled using HMMER3 predicted homologous reads on the human saliva data set SRS013942.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004991.s006" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.s006" xlink:type="simple">
<label>S6 Table</label>
<caption>
<title>The N50 for the contigs that were assembled by SFA-SPA using the HMM-GRASPx-, HMMER3-, RPS-BLAST-, and UProC-predicted homolog reads from the human saliva data set SRS013942.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004991.s007" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.s007" xlink:type="simple">
<label>S7 Table</label>
<caption>
<title>Running time for each program on searching against the simulated marine data set.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004991.s008" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.s008" xlink:type="simple">
<label>S8 Table</label>
<caption>
<title>Running time for each program on searching against the human saliva data set SRS013942.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004991.s009" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.s009" xlink:type="simple">
<label>S9 Table</label>
<caption>
<title>The Pfam families that were selected as the queries for analyzing the AMR profile of the human supragingival and stool metagenomic data sets.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004991.s010" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.s010" xlink:type="simple">
<label>S10 Table</label>
<caption>
<title>Accession numbers for the human supragingival and stool metagenomic data sets that were selected for the AMR protein family profiling experiment.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004991.s011" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.s011" xlink:type="simple">
<label>S11 Table</label>
<caption>
<title>Accession numbers for the human oral metatranscriptomic data set SRP049210 that were selected for the differential expression and targeted assembly experiments.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004991.s012" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.s012" xlink:type="simple">
<label>S12 Table</label>
<caption>
<title>The antiSMASH2.0 profile HMMs that were chosen for the differential expression and targeted assembly experiments on the human oral metatranscriptomic data set SRP049210.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004991.s013" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.s013" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Running time of HMM-GRASPx when searching 303 Pfam protein-family profiles.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004991.s014" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.s014" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>The two-dimensional hierarchical clustering results generated by using the HMM-GRASPx-predicted AMR families abundance profiles for the human supragingival and stool data sets.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004991.s015" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.s015" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>The two-dimensional hierarchical clustering results generated by using the HMMER3-predicted AMR families abundance profiles for the human supragingival and stool data sets.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004991.s016" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004991.s016" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Taxonomic profile of the 507 unannotated contigs that were assembled from the in vitro human oral biofilm metatranscriptomic data set through using HMM-GRASPx-based targeted assembly.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1004991.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Williamson</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Yooseph</surname> <given-names>S</given-names></name> (<year>2012</year>) <article-title>From bacterial to microbial ecosystems (metagenomics)</article-title>. <source>Methods in Molecular Biology</source> <volume>804</volume>: <fpage>35</fpage>–<lpage>55</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-1-61779-361-5_3" xlink:type="simple">10.1007/978-1-61779-361-5_3</ext-link></comment> <object-id pub-id-type="pmid">22144147</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Venter</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Remington</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Heidelberg</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Halpern</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Rusch</surname> <given-names>D</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Environmental genome shotgun sequencing of the Sargasso Sea</article-title>. <source>Science</source> <volume>304</volume>: <fpage>66</fpage>–<lpage>74</lpage>. <object-id pub-id-type="pmid">15001713</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bentley</surname> <given-names>DR</given-names></name> (<year>2006</year>) <article-title>Whole-genome re-sequencing</article-title>. <source>Curr Opin Genet Dev</source> <volume>16</volume>: <fpage>545</fpage>–<lpage>552</lpage>. <object-id pub-id-type="pmid">17055251</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mardis</surname> <given-names>ER</given-names></name> (<year>2008</year>) <article-title>Next-generation DNA sequencing methods</article-title>. <source>Annu Rev Genomics Hum Genet</source> <volume>9</volume>: <fpage>387</fpage>–<lpage>402</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev.genom.9.081307.164359" xlink:type="simple">10.1146/annurev.genom.9.081307.164359</ext-link></comment> <object-id pub-id-type="pmid">18576944</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Abubucker</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Segata</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Goll</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schubert</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Izard</surname> <given-names>J</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Metabolic reconstruction for metagenomic data and its application to the human microbiome</article-title>. <source>PLoS Comput Biol</source> <volume>8</volume>: <fpage>e1002358</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002358" xlink:type="simple">10.1371/journal.pcbi.1002358</ext-link></comment> <object-id pub-id-type="pmid">22719234</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huttenhower</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gevers</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Knight</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Abubucker</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Badger</surname> <given-names>JH</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Structure, function and diversity of the healthy human microbiome</article-title>. <source>Nature</source> <volume>486</volume>: <fpage>207</fpage>–<lpage>214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11234" xlink:type="simple">10.1038/nature11234</ext-link></comment> <object-id pub-id-type="pmid">22699609</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Edlund</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Yooseph</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hall</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Nguyen</surname> <given-names>DD</given-names></name>, <etal>et al</etal>. (<year>2015</year>) <article-title>Meta-omics uncover temporal regulation of pathways across oral microbiome genera during in vitro sugar metabolism</article-title>. <source>ISME J</source>.</mixed-citation></ref>
<ref id="pcbi.1004991.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Frias-Lopez</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Tyson</surname> <given-names>GW</given-names></name>, <name name-style="western"><surname>Coleman</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Schuster</surname> <given-names>SC</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Microbial community gene expression in ocean surface waters</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>105</volume>: <fpage>3805</fpage>–<lpage>3810</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0708897105" xlink:type="simple">10.1073/pnas.0708897105</ext-link></comment> <object-id pub-id-type="pmid">18316740</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gilbert</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Field</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Edwards</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>W</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Detection of large numbers of novel sequences in the metatranscriptomes of complex marine microbial communities</article-title>. <source>PLoS One</source> <volume>3</volume>: <fpage>e3042</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0003042" xlink:type="simple">10.1371/journal.pone.0003042</ext-link></comment> <object-id pub-id-type="pmid">18725995</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Urich</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Lanzen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Qi</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Huson</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Schleper</surname> <given-names>C</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Simultaneous assessment of soil microbial community structure and function through analysis of the meta-transcriptome</article-title>. <source>PLoS One</source> <volume>3</volume>: <fpage>e2527</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0002527" xlink:type="simple">10.1371/journal.pone.0002527</ext-link></comment> <object-id pub-id-type="pmid">18575584</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Langmead</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Salzberg</surname> <given-names>SL</given-names></name> (<year>2012</year>) <article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat Methods</source> <volume>9</volume>: <fpage>357</fpage>–<lpage>359</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1923" xlink:type="simple">10.1038/nmeth.1923</ext-link></comment> <object-id pub-id-type="pmid">22388286</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Durbin</surname> <given-names>R</given-names></name> (<year>2009</year>) <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>1754</fpage>–<lpage>1760</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp324" xlink:type="simple">10.1093/bioinformatics/btp324</ext-link></comment> <object-id pub-id-type="pmid">19451168</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Altschul</surname> <given-names>SF</given-names></name>, <name name-style="western"><surname>Madden</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Schaffer</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Z</given-names></name>, <etal>et al</etal>. (<year>1997</year>) <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res</source> <volume>25</volume>: <fpage>3389</fpage>–<lpage>3402</lpage>. <object-id pub-id-type="pmid">9254694</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goujon</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>McWilliam</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Valentin</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Squizzato</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>A new bioinformatics analysis tools framework at EMBL-EBI</article-title>. <source>Nucleic Acids Res</source> <volume>38</volume>: <fpage>W695</fpage>–<lpage>699</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkq313" xlink:type="simple">10.1093/nar/gkq313</ext-link></comment> <object-id pub-id-type="pmid">20439314</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ye</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Choi</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>H</given-names></name> (<year>2011</year>) <article-title>RAPSearch: a fast protein similarity search tool for short reads</article-title>. <source>BMC Bioinformatics</source> <volume>12</volume>: <fpage>159</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-12-159" xlink:type="simple">10.1186/1471-2105-12-159</ext-link></comment> <object-id pub-id-type="pmid">21575167</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ye</surname> <given-names>Y</given-names></name> (<year>2012</year>) <article-title>RAPSearch2: a fast and memory-efficient protein similarity search tool for next-generation sequencing data</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>125</fpage>–<lpage>126</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr595" xlink:type="simple">10.1093/bioinformatics/btr595</ext-link></comment> <object-id pub-id-type="pmid">22039206</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buchfink</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Huson</surname> <given-names>DH</given-names></name> (<year>2015</year>) <article-title>Fast and sensitive protein alignment using DIAMOND</article-title>. <source>Nat Methods</source> <volume>12</volume>: <fpage>59</fpage>–<lpage>60</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.3176" xlink:type="simple">10.1038/nmeth.3176</ext-link></comment> <object-id pub-id-type="pmid">25402007</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bankevich</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Nurk</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Antipov</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Gurevich</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Dvorkin</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>SPAdes: a new genome assembly algorithm and its applications to single-cell sequencing</article-title>. <source>J Comput Biol</source> <volume>19</volume>: <fpage>455</fpage>–<lpage>477</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2012.0021" xlink:type="simple">10.1089/cmb.2012.0021</ext-link></comment> <object-id pub-id-type="pmid">22506599</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Peng</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Leung</surname> <given-names>HC</given-names></name>, <name name-style="western"><surname>Yiu</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Chin</surname> <given-names>FY</given-names></name> (<year>2012</year>) <article-title>IDBA-UD: a de novo assembler for single-cell and metagenomic sequencing data with highly uneven depth</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>1420</fpage>–<lpage>1428</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts174" xlink:type="simple">10.1093/bioinformatics/bts174</ext-link></comment> <object-id pub-id-type="pmid">22495754</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Yooseph</surname> <given-names>S</given-names></name> (<year>2013</year>) <article-title>SPA: a short peptide assembler for metagenomic data</article-title>. <source>Nucleic Acids Res</source> <volume>41</volume>: <fpage>e91</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt118" xlink:type="simple">10.1093/nar/gkt118</ext-link></comment> <object-id pub-id-type="pmid">23435317</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Zhong</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Yooseph</surname> <given-names>S</given-names></name> (<year>2015</year>) <article-title>SFA-SPA: a suffix array based short peptide assembler for metagenomic data</article-title>. <source>Bioinformatics</source>.</mixed-citation></ref>
<ref id="pcbi.1004991.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Noguchi</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Taniguchi</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Itoh</surname> <given-names>T</given-names></name> (<year>2008</year>) <article-title>MetaGeneAnnotator: detecting species-specific patterns of ribosomal binding site for precise gene prediction in anonymous prokaryotic and phage genomes</article-title>. <source>DNA Res</source> <volume>15</volume>: <fpage>387</fpage>–<lpage>396</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/dnares/dsn027" xlink:type="simple">10.1093/dnares/dsn027</ext-link></comment> <object-id pub-id-type="pmid">18940874</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rho</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ye</surname> <given-names>Y</given-names></name> (<year>2010</year>) <article-title>FragGeneScan: predicting genes in short and error-prone reads</article-title>. <source>Nucleic Acids Res</source> <volume>38</volume>: <fpage>e191</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkq747" xlink:type="simple">10.1093/nar/gkq747</ext-link></comment> <object-id pub-id-type="pmid">20805240</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhong</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Yooseph</surname> <given-names>S</given-names></name> (<year>2014</year>) <article-title>GRASP: Guided Reference-based Assembly of Short Peptides</article-title>. <source>Nucleic Acids Res</source>.</mixed-citation></ref>
<ref id="pcbi.1004991.ref025"><label>25</label><mixed-citation publication-type="other" xlink:type="simple">Zhong C, Yang Y, Yooseph S (2015) GRASPx: Efficient Homolog-Search of Short-Peptide Metagenome Database through Simultaneous Alignment and Assembly. 11th International Symposium on Bioinformatics Research and Applications. Norfolk, VA.</mixed-citation></ref>
<ref id="pcbi.1004991.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Finn</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Clements</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name> (<year>2011</year>) <article-title>HMMER web server: interactive sequence similarity searching</article-title>. <source>Nucleic Acids Res</source> <volume>39</volume>: <fpage>W29</fpage>–<lpage>37</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr367" xlink:type="simple">10.1093/nar/gkr367</ext-link></comment> <object-id pub-id-type="pmid">21593126</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name> (<year>2009</year>) <article-title>A new generation of homology search tools based on probabilistic inference</article-title>. <source>Genome Inform</source> <volume>23</volume>: <fpage>205</fpage>–<lpage>211</lpage>. <object-id pub-id-type="pmid">20180275</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name> (<year>2011</year>) <article-title>Accelerated Profile HMM Searches</article-title>. <source>PLoS Comput Biol</source> <volume>7</volume>: <fpage>e1002195</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002195" xlink:type="simple">10.1371/journal.pcbi.1002195</ext-link></comment> <object-id pub-id-type="pmid">22039361</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mistry</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Finn</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Bateman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Punta</surname> <given-names>M</given-names></name> (<year>2013</year>) <article-title>Challenges in homology search: HMMER3 and convergent evolution of coiled-coil regions</article-title>. <source>Nucleic Acids Res</source> <volume>41</volume>: <fpage>e121</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt263" xlink:type="simple">10.1093/nar/gkt263</ext-link></comment> <object-id pub-id-type="pmid">23598997</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marchler-Bauer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bryant</surname> <given-names>SH</given-names></name> (<year>2004</year>) <article-title>CD-Search: protein domain annotations on the fly</article-title>. <source>Nucleic Acids Res</source> <volume>32</volume>: <fpage>W327</fpage>–<lpage>331</lpage>. <object-id pub-id-type="pmid">15215404</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Derbyshire</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Gonzales</surname> <given-names>NR</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>He</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Marchler</surname> <given-names>GH</given-names></name>, <etal>et al</etal>. (<year>2015</year>) <article-title>Improving the consistency of domain annotation within the Conserved Domain Database</article-title>. <source>Database (Oxford)</source> 2015.</mixed-citation></ref>
<ref id="pcbi.1004991.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Cole</surname> <given-names>JR</given-names></name> (<year>2013</year>) <article-title>A Sensitive and Accurate protein domain cLassification Tool (SALT) for short reads</article-title>. <source>Bioinformatics</source> <volume>29</volume>: <fpage>2103</fpage>–<lpage>2111</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btt357" xlink:type="simple">10.1093/bioinformatics/btt357</ext-link></comment> <object-id pub-id-type="pmid">23782615</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meinicke</surname> <given-names>P</given-names></name> (<year>2014</year>) <article-title>UProC: tools for ultra-fast protein domain classification</article-title>. <source>Bioinformatics</source>.</mixed-citation></ref>
<ref id="pcbi.1004991.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Fish</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Gilman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>CT</given-names></name>, <etal>et al</etal>. (<year>2015</year>) <article-title>Xander: employing a novel method for efficient gene-targeted metagenomic assembly</article-title>. <source>Microbiome</source> <volume>3</volume>: <fpage>32</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s40168-015-0093-6" xlink:type="simple">10.1186/s40168-015-0093-6</ext-link></comment> <object-id pub-id-type="pmid">26246894</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pe'er</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Shamir</surname> <given-names>R</given-names></name> (<year>2000</year>) <article-title>Spectrum alignment: efficient resequencing by hybridization</article-title>. <source>Proc Int Conf Intell Syst Mol Biol</source> <volume>8</volume>: <fpage>260</fpage>–<lpage>268</lpage>. <object-id pub-id-type="pmid">10977087</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Peterson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Garges</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Giovanni</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>McInnes</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>L</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>The NIH Human Microbiome Project</article-title>. <source>Genome Res</source> <volume>19</volume>: <fpage>2317</fpage>–<lpage>2323</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.096651.109" xlink:type="simple">10.1101/gr.096651.109</ext-link></comment> <object-id pub-id-type="pmid">19819907</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rost</surname> <given-names>B</given-names></name> (<year>1999</year>) <article-title>Twilight zone of protein sequence alignments</article-title>. <source>Protein Eng</source> <volume>12</volume>: <fpage>85</fpage>–<lpage>94</lpage>. <object-id pub-id-type="pmid">10195279</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blin</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Medema</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Kazempour</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Fischbach</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Breitling</surname> <given-names>R</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>antiSMASH 2.0—a versatile platform for genome mining of secondary metabolite producers</article-title>. <source>Nucleic Acids Res</source> <volume>41</volume>: <fpage>W204</fpage>–<lpage>212</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt449" xlink:type="simple">10.1093/nar/gkt449</ext-link></comment> <object-id pub-id-type="pmid">23737449</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Witte</surname> <given-names>W</given-names></name> (<year>1999</year>) <article-title>Antibiotic resistance in gram-positive bacteria: epidemiological aspects</article-title>. <source>J Antimicrob Chemother</source> <volume>44</volume> <issue>Suppl A</issue>: <fpage>1</fpage>–<lpage>9</lpage>. <object-id pub-id-type="pmid">10511391</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Livermore</surname> <given-names>DM</given-names></name> (<year>2012</year>) <article-title>Fourteen years in resistance</article-title>. <source>Int J Antimicrob Agents</source> <volume>39</volume>: <fpage>283</fpage>–<lpage>294</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.ijantimicag.2011.12.012" xlink:type="simple">10.1016/j.ijantimicag.2011.12.012</ext-link></comment> <object-id pub-id-type="pmid">22386741</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gibson</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Forsberg</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Dantas</surname> <given-names>G</given-names></name> (<year>2015</year>) <article-title>Improved annotation of antibiotic resistance determinants reveals microbial resistomes cluster by ecology</article-title>. <source>ISME J</source> <volume>9</volume>: <fpage>207</fpage>–<lpage>216</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ismej.2014.106" xlink:type="simple">10.1038/ismej.2014.106</ext-link></comment> <object-id pub-id-type="pmid">25003965</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhou</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Gao</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Mihindukulasuriya</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>La Rosa</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Wylie</surname> <given-names>KM</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Biogeography of the ecosystems of the healthy human body</article-title>. <source>Genome Biol</source> <volume>14</volume>: <fpage>R1</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2013-14-1-r1" xlink:type="simple">10.1186/gb-2013-14-1-r1</ext-link></comment> <object-id pub-id-type="pmid">23316946</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Forslund</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sunagawa</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kultima</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Mende</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Arumugam</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Country-specific antibiotic use practices impact the human gut resistome</article-title>. <source>Genome Res</source> <volume>23</volume>: <fpage>1163</fpage>–<lpage>1169</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.155465.113" xlink:type="simple">10.1101/gr.155465.113</ext-link></comment> <object-id pub-id-type="pmid">23568836</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Edlund</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hall</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Lux</surname> <given-names>R</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>An in vitro biofilm model system maintaining a highly reproducible species and metabolic diversity approaching that of the human oral microbiome</article-title>. <source>Microbiome</source> <volume>1</volume>: <fpage>25</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/2049-2618-1-25" xlink:type="simple">10.1186/2049-2618-1-25</ext-link></comment> <object-id pub-id-type="pmid">24451062</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Love</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Huber</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Anders</surname> <given-names>S</given-names></name> (<year>2014</year>) <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol</source> <volume>15</volume>: <fpage>550</fpage>. <object-id pub-id-type="pmid">25516281</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alneberg</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bjarnason</surname> <given-names>BS</given-names></name>, <name name-style="western"><surname>de Bruijn</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Schirmer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Quick</surname> <given-names>J</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Binning metagenomic contigs by coverage and composition</article-title>. <source>Nat Methods</source> <volume>11</volume>: <fpage>1144</fpage>–<lpage>1146</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.3103" xlink:type="simple">10.1038/nmeth.3103</ext-link></comment> <object-id pub-id-type="pmid">25218180</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Droge</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>McHardy</surname> <given-names>AC</given-names></name> (<year>2012</year>) <article-title>Taxonomic binning of metagenome samples generated by next-generation sequencing technologies</article-title>. <source>Brief Bioinform</source> <volume>13</volume>: <fpage>646</fpage>–<lpage>655</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bib/bbs031" xlink:type="simple">10.1093/bib/bbs031</ext-link></comment> <object-id pub-id-type="pmid">22851513</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wood</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Salzberg</surname> <given-names>SL</given-names></name> (<year>2014</year>) <article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>. <source>Genome Biol</source> <volume>15</volume>: <fpage>R46</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2014-15-3-r46" xlink:type="simple">10.1186/gb-2014-15-3-r46</ext-link></comment> <object-id pub-id-type="pmid">24580807</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref049"><label>49</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Durbin</surname> <given-names>R</given-names></name> (<year>1998</year>) <chapter-title>Biological sequence analysis: probabalistic models of proteins and nucleic acids</chapter-title>. <publisher-loc>Cambridge, UK New York</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>. xi, 356 p. p.</mixed-citation></ref>
<ref id="pcbi.1004991.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yooseph</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Nealson</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Rusch</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>McCrow</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Dupont</surname> <given-names>CL</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Genomic and functional adaptation in surface ocean planktonic prokaryotes</article-title>. <source>Nature</source> <volume>468</volume>: <fpage>60</fpage>–<lpage>66</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature09530" xlink:type="simple">10.1038/nature09530</ext-link></comment> <object-id pub-id-type="pmid">21048761</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bolger</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Lohse</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Usadel</surname> <given-names>B</given-names></name> (<year>2014</year>) <article-title>Trimmomatic: a flexible trimmer for Illumina sequence data</article-title>. <source>Bioinformatics</source> <volume>30</volume>: <fpage>2114</fpage>–<lpage>2120</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu170" xlink:type="simple">10.1093/bioinformatics/btu170</ext-link></comment> <object-id pub-id-type="pmid">24695404</object-id></mixed-citation></ref>
<ref id="pcbi.1004991.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schmieder</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Lim</surname> <given-names>YW</given-names></name>, <name name-style="western"><surname>Edwards</surname> <given-names>R</given-names></name> (<year>2012</year>) <article-title>Identification and removal of ribosomal RNA sequences from metatranscriptomes</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>433</fpage>–<lpage>435</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr669" xlink:type="simple">10.1093/bioinformatics/btr669</ext-link></comment> <object-id pub-id-type="pmid">22155869</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>