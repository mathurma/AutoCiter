<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004509</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-01740</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Beyond the <italic>E</italic>-Value: Stratified Statistics for Protein Domain Prediction</article-title>
<alt-title alt-title-type="running-head">Stratified Statistics for Protein Domain Prediction</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Ochoa</surname>
<given-names>Alejandro</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
<xref rid="aff003" ref-type="aff"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Storey</surname>
<given-names>John D.</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
<xref rid="aff003" ref-type="aff"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Llinás</surname>
<given-names>Manuel</given-names>
</name>
<xref rid="aff004" ref-type="aff"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Singh</surname>
<given-names>Mona</given-names>
</name>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
<xref rid="aff005" ref-type="aff"><sup>5</sup></xref>
<xref rid="cor001" ref-type="corresp">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Molecular Biology, Princeton University, Princeton, New Jersey, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Lewis-Sigler Institute for Integrative Genomics, Princeton University, Princeton, New Jersey, United States of America</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Center for Statistics and Machine Learning, Princeton University, Princeton, New Jersey, United States of America</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Department of Biochemistry and Molecular Biology, and the Huck Institutes of the Life Sciences, Pennsylvania State University, University Park, Pennsylvania, United States of America</addr-line></aff>
<aff id="aff005"><label>5</label> <addr-line>Department of Computer Science, Princeton University, Princeton, New Jersey, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Listgarten</surname>
<given-names>Jennifer</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Microsoft Research, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: AO MS. Performed the experiments: AO. Analyzed the data: AO JDS ML MS. Contributed reagents/materials/analysis tools: AO. Wrote the paper: AO JDS ML MS.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">mona@cs.princeton.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>17</day>
<month>11</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="collection">
<month>11</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>11</issue>
<elocation-id>e1004509</elocation-id>
<history>
<date date-type="received">
<day>23</day>
<month>9</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>3</day>
<month>8</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Ochoa et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004509" xlink:type="simple"/>
<abstract>
<p><italic>E</italic>-values have been the dominant statistic for protein sequence analysis for the past two decades: from identifying statistically significant local sequence alignments to evaluating matches to hidden Markov models describing protein domain families. Here we formally show that for “stratified” multiple hypothesis testing problems—that is, those in which statistical tests can be partitioned naturally—controlling the local False Discovery Rate (lFDR) per stratum, or partition, yields the most predictions across the data at any given threshold on the FDR or <italic>E</italic>-value over all strata combined. For the important problem of protein domain prediction, a key step in characterizing protein structure, function and evolution, we show that stratifying statistical tests by domain family yields excellent results. We develop the first FDR-estimating algorithms for domain prediction, and evaluate how well thresholds based on <italic>q</italic>-values, <italic>E</italic>-values and lFDRs perform in domain prediction using five complementary approaches for estimating empirical FDRs in this context. We show that stratified <italic>q</italic>-value thresholds substantially outperform <italic>E</italic>-values. Contradicting our theoretical results, <italic>q</italic>-values also outperform lFDRs; however, our tests reveal a small but coherent subset of domain families, biased towards models for specific repetitive patterns, for which weaknesses in random sequence models yield notably inaccurate statistical significance measures. Usage of lFDR thresholds outperform <italic>q</italic>-values for the remaining families, which have as-expected noise, suggesting that further improvements in domain predictions can be achieved with improved modeling of random sequences. Overall, our theoretical and empirical findings suggest that the use of stratified <italic>q</italic>-values and lFDRs could result in improvements in a host of structured multiple hypothesis testing problems arising in bioinformatics, including genome-wide association studies, orthology prediction, and motif scanning.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Despite decades of research, it remains a challenge to distinguish homologous relationships between proteins from sequence similarities arising due to chance alone. This is an increasingly important problem as sequence database sizes continue to grow, and even today many computational analyses require that the statistics of billions of sequence comparisons be assessed automatically. Here we explore statistical significance evaluation on data that is stratified—that is, naturally partitioned into subsets that may differ in their amount of signal—and find a theoretically optimal criterion for automatically setting thresholds of significance for each stratum. For the task of domain prediction, an important component of efforts to annotate protein sequences and identify remote sequence homologs, we empirically show that our stratified analysis of statistical significance greatly improves upon a combined analysis. Further, we identify weaknesses in the prevailing random sequence model for assessing statistical significance for a small subset of domain families with repetitive sequence patterns and known biological, structural, and evolutionary properties. Our theoretical findings in statistics are relevant not only for identifying protein domains, but for arbitrary stratified problems in genomics and beyond.</p>
</abstract>
<funding-group>
<funding-statement>This work was supported by the National Science Foundation [Graduate Research Fellowship DGE 0646086 to AO, ABI 1062371 to MS, <ext-link ext-link-type="uri" xlink:href="http://www.nsf.gov/" xlink:type="simple">http://www.nsf.gov/</ext-link>]; and the National Institutes of Health [1 R21-AI085415 to MS and ML, R01-GM076275 to MS, R01-HG002913 to JDS, Center of Excellence P50 GM071508 to the Lewis-Sigler Institute, <ext-link ext-link-type="uri" xlink:href="http://www.nih.gov/" xlink:type="simple">http://www.nih.gov/</ext-link>]. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="0"/>
<page-count count="21"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>Our research is based entirely on the following public data: the Pfam domain database (<ext-link ext-link-type="uri" xlink:href="http://pfam.xfam.org/" xlink:type="simple">http://pfam.xfam.org/</ext-link>), the UniProt protein sequence database (<ext-link ext-link-type="uri" xlink:href="http://www.uniprot.org/" xlink:type="simple">http://www.uniprot.org/</ext-link>), the OrthoMCL orthology prediction database (<ext-link ext-link-type="uri" xlink:href="http://orthomcl.org/" xlink:type="simple">http://orthomcl.org/</ext-link>), and the Gene Ontology database (<ext-link ext-link-type="uri" xlink:href="http://geneontology.org/" xlink:type="simple">http://geneontology.org/</ext-link>).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The evaluation of statistical significance is crucial in genome-wide studies, such as detecting differentially-expressed genes in microarray or proteomic studies, performing genome-wide association studies, and uncovering homologous sequences. Different biological applications have settled for different statistics to set thresholds on. In biological sequence analysis, accurate statistics for pairwise alignments and their use in database search [<xref rid="pcbi.1004509.ref001" ref-type="bibr">1</xref>–<xref rid="pcbi.1004509.ref003" ref-type="bibr">3</xref>] were introduced with the use of random sequence models and <italic>E</italic>-values two decades ago [<xref rid="pcbi.1004509.ref004" ref-type="bibr">4</xref>,<xref rid="pcbi.1004509.ref005" ref-type="bibr">5</xref>]. Sequence similarity searches have evolved further, from the pairwise comparison tools of FASTA [<xref rid="pcbi.1004509.ref003" ref-type="bibr">3</xref>] and BLAST [<xref rid="pcbi.1004509.ref005" ref-type="bibr">5</xref>], to sequence-profile [<xref rid="pcbi.1004509.ref006" ref-type="bibr">6</xref>–<xref rid="pcbi.1004509.ref008" ref-type="bibr">8</xref>] and profile-profile [<xref rid="pcbi.1004509.ref009" ref-type="bibr">9</xref>–<xref rid="pcbi.1004509.ref012" ref-type="bibr">12</xref>] comparisons. While different approaches to detect sequence similarity have relied on a variety of statistics, including bit scores [<xref rid="pcbi.1004509.ref013" ref-type="bibr">13</xref>,<xref rid="pcbi.1004509.ref014" ref-type="bibr">14</xref>] and <italic>Z</italic>-scores [<xref rid="pcbi.1004509.ref003" ref-type="bibr">3</xref>], most modern approaches are based on <italic>E</italic>-values.</p>
<p>Detecting sequence similarity in order to uncover homologous relationships between proteins remains the single most powerful tool for function prediction. Many modern sequence similarity approaches are based on identifying domains, which are fundamental units of protein structure, function, and evolution. Homologous domains are grouped into “families” that may be associated with specific functions and structures, and these domain families organize protein space. Domain families are typically modeled with profile hidden Markov models (HMMs) [<xref rid="pcbi.1004509.ref013" ref-type="bibr">13</xref>,<xref rid="pcbi.1004509.ref015" ref-type="bibr">15</xref>]. There are many domain HMM databases, each providing a different focus and organization of domain space, including Pfam [<xref rid="pcbi.1004509.ref014" ref-type="bibr">14</xref>], Superfamily [<xref rid="pcbi.1004509.ref016" ref-type="bibr">16</xref>], and Smart [<xref rid="pcbi.1004509.ref017" ref-type="bibr">17</xref>]. Although HMM-based software, such as the state-of-the-art HMMER program [<xref rid="pcbi.1004509.ref018" ref-type="bibr">18</xref>], has features that make it superior to its predecessors, accurate significance measures arose only recently [<xref rid="pcbi.1004509.ref019" ref-type="bibr">19</xref>].</p>
<p>At its core, domain prediction is a multiple hypothesis testing problem, where tens of thousands of homology models (one for each domain) are scored against tens of millions of sequences. Each comparison yields a score <italic>s</italic> and a <italic>p</italic>-value, defined as the probability of obtaining a score equal to or larger than <italic>s</italic> if the null hypothesis holds. While a small <italic>p</italic>-value threshold (for example, 0.05 or smaller) is acceptable to declare a single test significant, this is inappropriate for a large number of tests. Instead, thresholds for domain prediction are typically based on the <italic>E</italic>-value. The <italic>E</italic>-value can be computed from a <italic>p</italic>-value thresholds as <italic>E</italic> = <italic>pN</italic>, where <italic>N</italic> is the number of tests, and yields the expected number of false positives at this <italic>p</italic>-value threshold. <italic>E</italic>-value thresholds make sense for a single database search, especially if few positives are expected. However, <italic>E</italic>-values are less meaningful when millions of positives are obtained, and a relatively larger number of false positives might be tolerated. Moreover, in multiple database query problems, such as BLAST-based orthology prediction [<xref rid="pcbi.1004509.ref020" ref-type="bibr">20</xref>] or genome-wide domain prediction [<xref rid="pcbi.1004509.ref021" ref-type="bibr">21</xref>], <italic>E</italic>-values are usually not valid because many searches are performed without the additional multiple hypothesis correction required.</p>
<p>Control of the False Discovery Rate (FDR) is an alternative and appealing approach for multiple hypothesis testing [<xref rid="pcbi.1004509.ref022" ref-type="bibr">22</xref>]. The FDR is loosely defined as the proportion of all significant tests that are expected to be false, and can be estimated as the <italic>E</italic>-value divided by the number of predictions made. The FDR does not increase with the database size <italic>N</italic> the way the <italic>E</italic>-value does; thus, predictions do not usually lose significance with the FDR as the database grows. The FDR also does not require additional correction in the case of multiple database queries. The FDR is controlled from <italic>p</italic>-values using the Benjamini-Hochberg procedure [<xref rid="pcbi.1004509.ref022" ref-type="bibr">22</xref>]. The <italic>q</italic>-value statistic is the FDR-analog of the <italic>p</italic>-value, and it provides conservative and powerful FDR control [<xref rid="pcbi.1004509.ref023" ref-type="bibr">23</xref>]. The <italic>q</italic>-value of a statistic <italic>t</italic> is the minimum FDR incurred by declaring <italic>t</italic> significant [<xref rid="pcbi.1004509.ref023" ref-type="bibr">23</xref>]. Thus, <italic>q</italic>-values vary monotonically with <italic>p</italic>-values, and they are easily estimated from <italic>p</italic>-values [<xref rid="pcbi.1004509.ref023" ref-type="bibr">23</xref>]. While <italic>E</italic>-values control the number of false positives, <italic>q</italic>-values control their proportion. The local FDR (lFDR) measures the proportion of false positives in the infinitesimal vicinity of the threshold, and hence it is a “local” version of the FDR [<xref rid="pcbi.1004509.ref024" ref-type="bibr">24</xref>]; it is also equivalent to the Bayesian posterior probability that a prediction is false [<xref rid="pcbi.1004509.ref024" ref-type="bibr">24</xref>]. However, <italic>q</italic>-value estimates are much more robust than lFDR estimates, since the former are based on empirical cumulative densities, which converge uniformly to the true cumulative densities [<xref rid="pcbi.1004509.ref025" ref-type="bibr">25</xref>,<xref rid="pcbi.1004509.ref026" ref-type="bibr">26</xref>]. On the other hand, lFDR estimates are local fits to the density, so they are comparably more susceptible to noise, especially on the most significant tail of the distribution. The FDR [<xref rid="pcbi.1004509.ref022" ref-type="bibr">22</xref>], <italic>q</italic>-value [<xref rid="pcbi.1004509.ref023" ref-type="bibr">23</xref>], and lFDR [<xref rid="pcbi.1004509.ref024" ref-type="bibr">24</xref>] have all been successfully used in many areas of bioinformatics, including gene expression microarray analysis [<xref rid="pcbi.1004509.ref024" ref-type="bibr">24</xref>,<xref rid="pcbi.1004509.ref027" ref-type="bibr">27</xref>,<xref rid="pcbi.1004509.ref028" ref-type="bibr">28</xref>], genome-wide association studies (GWAS) [<xref rid="pcbi.1004509.ref027" ref-type="bibr">27</xref>,<xref rid="pcbi.1004509.ref029" ref-type="bibr">29</xref>], and proteomics analysis [<xref rid="pcbi.1004509.ref030" ref-type="bibr">30</xref>–<xref rid="pcbi.1004509.ref034" ref-type="bibr">34</xref>].</p>
<p>Here we introduce the first FDR- and lFDR-estimating algorithms for domain prediction. An essential feature of our approach is that statistical tests are stratified by domain family, rather than pooled. We prove that stratified problems are optimally tackled using the lFDR. For domain prediction, we evaluate how well thresholds based on stratified lFDRs and <italic>q</italic>-values perform using five independent approaches for estimating empirical FDRs. Through extensive benchmarking using the Pfam database and HMMER, we find that using stratified <italic>q</italic>-values increases domain predictions by 6.7% compared to the Standard Pfam thresholds on UniRef50 [<xref rid="pcbi.1004509.ref035" ref-type="bibr">35</xref>]. In contrast to theory, we also find that <italic>q</italic>-values outperform lFDRs. Further, while the empirical FDRs for most domain families agree with our <italic>q</italic>-value thresholds, some families tend to have larger FDRs; the standard null model appears to be inappropriate for them and yields inaccurate <italic>p</italic>-values. Specifically, families with larger-than-expected empirical FDRs are enriched for those containing repetitive patterns, such as coiled-coils, transmembrane domains, and other low-complexity regions. When only families with as-expected FDRs are considered, the use of <italic>q</italic>-values increases domain predictions by 8.8% compared to the Standard Pfam, and lFDRs further outperform <italic>q</italic>-values, suggesting that further performance improvements are possible if the statistical modeling of repetitive families is improved.</p>
<p>Stratified FDR analyses have been previously explored [<xref rid="pcbi.1004509.ref036" ref-type="bibr">36</xref>–<xref rid="pcbi.1004509.ref039" ref-type="bibr">39</xref>], and have been successfully applied to GWAS in particular [<xref rid="pcbi.1004509.ref029" ref-type="bibr">29</xref>,<xref rid="pcbi.1004509.ref040" ref-type="bibr">40</xref>,<xref rid="pcbi.1004509.ref041" ref-type="bibr">41</xref>]. Thus, the same solution we introduce for domain recognition applies to a wide variety of problems in which statistical tests can be analyzed separately, including GWAS (stratifying by candidate or genic regions), orthology prediction (stratifying by each ortholog database search), motif scanning (stratifying by each motif search across a genome), multi-microarray analysis (stratifying by each microarray), and other multi-dataset analyses. Overall, we expect the use of stratified <italic>q</italic>-values and lFDRs to yield improvements in many applications in bioinformatics and beyond.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>FDR definitions</title>
<p>We briefly review the relevant FDR definitions; for a comprehensive overview, see [<xref rid="pcbi.1004509.ref042" ref-type="bibr">42</xref>]. Given a <italic>p</italic>-value threshold <italic>t</italic>, let <italic>V</italic> be the number of false positive predictions, and <italic>R</italic> be the total number of significant tests. Assuming independent <italic>p</italic>-values drawn from a two-component distribution of null and alternative hypotheses (<xref rid="pcbi.1004509.g001" ref-type="fig">Fig 1</xref>), <italic>V</italic> and <italic>R</italic> have expected values of
<disp-formula id="pcbi.1004509.e001">
<alternatives>
<graphic id="pcbi.1004509.e001g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.e001" xlink:type="simple"/>
<mml:math display="block" id="M1" overflow="scroll">
<mml:mtable><mml:mtr><mml:mtd><mml:mtext>E</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>N</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>E</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
</disp-formula>
where π<sub>0</sub> is the proportion of tests which are truly null, <italic>N</italic> is the total number of tests, and <italic>F</italic>(<italic>t</italic>) is the cumulative density of <italic>p</italic>-values [<xref rid="pcbi.1004509.ref023" ref-type="bibr">23</xref>,<xref rid="pcbi.1004509.ref024" ref-type="bibr">24</xref>,<xref rid="pcbi.1004509.ref043" ref-type="bibr">43</xref>]. Note that E[<italic>V</italic>(<italic>t</italic>)] gives the <italic>E</italic>-value.</p>
<fig id="pcbi.1004509.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004509.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Overview of false discovery rates.</title>
<p>Both quantities assume a two-component <italic>p</italic>-value distribution: “null” <italic>p</italic>-values are uniformly distributed (with height <italic>π</italic><sub>0</sub> <italic>≤</italic> 1), and “alternative” <italic>p</italic>-values that should peak at <italic>p</italic> = 0. The area of the null component with <italic>p ≤ t</italic> is simply <italic>π</italic><sub>0</sub><italic>t</italic>, while the total area is the cumulative density function <italic>F</italic>(<italic>t</italic>). The total height at <italic>t</italic> is the density function <italic>f</italic>(<italic>t</italic>). The FDR is the proportion of the area with <italic>p ≤ t</italic> that corresponds to the null component. The lFDR parallels the FDR but is a ratio of densities (heights) rather than areas.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.g001" position="float" xlink:type="simple"/>
</fig>
<p>There are two closely-related versions of the FDR used in our work: the positive FDR (pFDR) and marginal FDR (mFDR) [<xref rid="pcbi.1004509.ref042" ref-type="bibr">42</xref>,<xref rid="pcbi.1004509.ref043" ref-type="bibr">43</xref>], defined as
<disp-formula id="pcbi.1004509.e002">
<alternatives>
<graphic id="pcbi.1004509.e002g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.e002" xlink:type="simple"/>
<mml:math display="block" id="M2" overflow="scroll">
<mml:mtable><mml:mtr><mml:mtd><mml:mtext>pFDR</mml:mtext><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mi>V</mml:mi><mml:mi>R</mml:mi></mml:mfrac></mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>mFDR</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>V</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>R</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
</disp-formula></p>
<p>The advantages of the pFDR compared to the original FDR definition of Benjamini and Hochberg [<xref rid="pcbi.1004509.ref022" ref-type="bibr">22</xref>] are discussed in [<xref rid="pcbi.1004509.ref043" ref-type="bibr">43</xref>]. If <italic>p</italic>-values are drawn independently from the two-component distribution of <xref rid="pcbi.1004509.g001" ref-type="fig">Fig 1</xref>, the pFDR and mFDR were proven to be equivalent to the following posterior probability [<xref rid="pcbi.1004509.ref043" ref-type="bibr">43</xref>]:
<disp-formula id="pcbi.1004509.e003">
<alternatives>
<graphic id="pcbi.1004509.e003g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.e003" xlink:type="simple"/>
<mml:math display="block" id="M3" overflow="scroll">
<mml:mrow><mml:mtext>pFDR</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>mFDR</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>H</italic> = 0 denotes that the null hypothesis holds. This quantity is sometimes called the “Bayesian FDR” [<xref rid="pcbi.1004509.ref024" ref-type="bibr">24</xref>]. The pFDR and mFDR are also asymptotically equal under certain forms of “weak dependence,” as defined in [<xref rid="pcbi.1004509.ref044" ref-type="bibr">44</xref>]. Our domain prediction problem has large sample sizes and weak dependence: our dataset contains millions of protein sequences and thousands of HMMs, and null <italic>p</italic>-values are only dependent for very similar sequences and similar HMMs. Dependent tests represent a very small subset of all hypotheses tested, even on each stratum (for any one HMM). For this reason, we use FDR to refer loosely to all these FDR definitions.</p>
<p>The local FDR (lFDR) is the Bayesian posterior error probability defined as [<xref rid="pcbi.1004509.ref024" ref-type="bibr">24</xref>]
<disp-formula id="pcbi.1004509.e004">
<alternatives>
<graphic id="pcbi.1004509.e004g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.e004" xlink:type="simple"/>
<mml:math display="block" id="M4" overflow="scroll">
<mml:mrow><mml:mtext>lFDR</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="0.03em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>f</italic>(<italic>t</italic>) = <italic>F</italic>'(<italic>t</italic>) is the <italic>p</italic>-value density at <italic>t</italic>. Thus, while the pFDR is a ratio of areas, the lFDR is a ratio of densities (<xref rid="pcbi.1004509.g001" ref-type="fig">Fig 1</xref>) [<xref rid="pcbi.1004509.ref045" ref-type="bibr">45</xref>].</p>
<p>The <italic>q</italic>-value of a statistic <italic>t</italic> is the minimum pFDR incurred by declaring <italic>t</italic> significant [<xref rid="pcbi.1004509.ref023" ref-type="bibr">23</xref>]. Estimated <italic>q</italic>-values are efficiently constructed from <italic>p</italic>-values, and conservatively estimate the pFDR [<xref rid="pcbi.1004509.ref023" ref-type="bibr">23</xref>]. Specifically, <italic>q</italic>-value and lFDR estimation are based on the above formulas, where π<sub>0,</sub> <italic>F</italic>(<italic>t</italic>) and <italic>f</italic>(<italic>t</italic>) are replaced by estimates. See the Supp. Methods in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref> for the algorithms for estimating <italic>q</italic>-values and lFDRs.</p>
</sec>
<sec id="sec004">
<title>Equal stratified lFDR thresholds maximize predictions while controlling the combined FDR</title>
<p>Here we prove that the lFDR gives optimal thresholds for stratified problems. For domain prediction, each domain family defines a stratum. We wish to find <italic>p</italic>-value thresholds <italic>t</italic><sub><italic>i</italic></sub> per stratum <italic>i</italic> that maximize the number of predictions across strata while constraining the maximum FDR of the strata combined. Optimality of the lFDR here is consistent with the related Bayesian classification problem, where posterior error probabilities are also optimal [<xref rid="pcbi.1004509.ref043" ref-type="bibr">43</xref>].</p>
<p>Let the FDR model quantities <italic>N</italic><sub><italic>i</italic></sub>, <italic>π</italic><sub>0,i</sub>, <italic>F</italic><sub><italic>i</italic></sub>(<italic>t</italic><sub><italic>i</italic></sub>) and <italic>f</italic><sub><italic>i</italic></sub>(<italic>t</italic><sub><italic>i</italic></sub>) be given per stratum <italic>i</italic>. We desire to maximize the expected number of predictions across strata
<disp-formula id="pcbi.1004509.e005">
<alternatives>
<graphic id="pcbi.1004509.e005g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.e005" xlink:type="simple"/>
<mml:math display="block" id="M5" overflow="scroll">
<mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.05em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
while constraining the “combined” FDR, which we define as the sum of expected false positives across strata divided by the total number of expected predictions, to a maximum value of <italic>Q</italic>, or
<disp-formula id="pcbi.1004509.e006">
<alternatives>
<graphic id="pcbi.1004509.e006g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.e006" xlink:type="simple"/>
<mml:math display="block" id="M6" overflow="scroll">
<mml:mrow><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mo>≤</mml:mo><mml:mi>Q</mml:mi><mml:mspace width="0.05em"/><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>This problem is solved using the Lagrangian multiplier function <italic>Λ</italic>, with the constraint set to strict equality, in a formulation that avoids quotients:
<disp-formula id="pcbi.1004509.e007">
<alternatives>
<graphic id="pcbi.1004509.e007g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.e007" xlink:type="simple"/>
<mml:math display="block" id="M7" overflow="scroll">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>Λ</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>−</mml:mo><mml:mi>Q</mml:mi><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.7em"/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mi>Q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Taking the partial derivative of <italic>Λ</italic> with respect to <italic>t</italic><sub><italic>j</italic></sub>, we obtain a necessary condition for optimality,
<disp-formula id="pcbi.1004509.e008">
<alternatives>
<graphic id="pcbi.1004509.e008g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.e008" xlink:type="simple"/>
<mml:math display="block" id="M8" overflow="scroll">
<mml:mtable><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mi>Q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.5em"/><mml:mo>⇔</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>Q</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>λ</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mtext>lFDR</mml:mtext><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
</disp-formula>
which shows that the lFDR of each stratum must be equal, since the last equation has the same value for every <italic>j</italic>. Optimality of the lFDR also holds when constraining the combined <italic>E</italic>-value instead of the combined FDR (Supp. Methods in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
</sec>
<sec id="sec005">
<title>Obtaining <italic>E</italic>-values, <italic>q</italic>-values, and lFDRs for domains</title>
<p>Each of the 12,273 Pfam domain families was used to scan for domains in each of 3.8 million proteins of UniRef50 (Supp. Methods in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>), resulting in a total of 47 billion tests. Domain predictions are stratified by family (HMM), and each stratum contains <italic>p</italic>-values from which we estimate <italic>q</italic>-values and lFDRs. We note that standard <italic>q</italic>-value and lFDR implementations fail for domain data for two reasons. First, modern HMM software only reports the smallest <italic>p</italic>-values due to heuristic filters [<xref rid="pcbi.1004509.ref019" ref-type="bibr">19</xref>]. Second, homologous families (grouped into “superfamilies” [<xref rid="pcbi.1004509.ref016" ref-type="bibr">16</xref>] or “clans” [<xref rid="pcbi.1004509.ref014" ref-type="bibr">14</xref>]) produce frequent overlaps that are resolved by removal of all but the most significant match, and thus there are fewer predictions than an independent family analysis would predict, which leads to underestimated FDRs. To address these issues, we remove overlapping domains (keeping those with the smallest <italic>p</italic>-values), and then estimate <italic>q</italic>-values and lFDRs with methods adapted for censored <italic>p</italic>-values (Methods). For comparison, we also use <italic>E</italic>-value thresholds and the “Standard Pfam” curated bitscore thresholds (also called “Gathering” or “GA” [<xref rid="pcbi.1004509.ref014" ref-type="bibr">14</xref>]). Note that a stratified <italic>E</italic>-values approach (separating families) is no different from a combined <italic>E</italic>-value approach in that the ranking of predictions is preserved, since the number of proteins, or tests, is the same per stratum; the stratified <italic>E</italic>-value threshold equals the combined <italic>E</italic>-value threshold divided by the number of strata. Similarly, a combined <italic>q</italic>-value or lFDR approach (obtained by combining the <italic>p</italic>-values of all strata) also preserves the <italic>E</italic>-value rankings.</p>
</sec>
<sec id="sec006">
<title>Empirical FDR tests</title>
<p>We estimate the true FDR via “empirical” FDR tests, to compare all methods on an equal footing, but also to test the accuracy of <italic>q</italic>-value estimates. We created or adapted five tests, each of which labels domain predictions as either true or false positives (TP, FP) using different statistical and biological criteria. The proportion of predictions labeled FP estimates the FDR.</p>
<p>For simplicity, only two tests are described here in detail and are featured in the main figures. First, the ClanOv (“Clan Overlap”) test is based on the expectation that overlapping domain predictions should be evolutionarily related [<xref rid="pcbi.1004509.ref046" ref-type="bibr">46</xref>]. Pfam annotates related families via clans. In this test, domain predictions are ranked by <italic>p</italic>-value, highest ranking domains are considered as TPs, domains that overlap a higher-ranking domain of the same clan are removed (since they would not be counted as separate predictions), and domains that overlap a higher-ranking domain of a different clan are considered FPs (Methods, <xref rid="pcbi.1004509.g002" ref-type="fig">Fig 2A</xref>). All FPs in this test would not be predicted by our method when overlaps are removed; nevertheless, this method estimates well the amount of noise. Second, the ContextC (“Context Coherence”) test is based on whether domain pairs predicted within a sequence have been observed together before [<xref rid="pcbi.1004509.ref047" ref-type="bibr">47</xref>]. For each sequence, domain predictions are ranked by <italic>p</italic>-value, and the highest ranking domain is always a TP. Subsequently, a domain is a TP if its family has previously been observed with the family of at least one higher-ranking domain, and otherwise it is a FP (Methods, <xref rid="pcbi.1004509.g002" ref-type="fig">Fig 2B</xref>).</p>
<fig id="pcbi.1004509.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004509.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Illustration of the empirical FDR tests ClanOv and ContextC.</title>
<p>Both tests rank domain predictions (teal boxes) by <italic>p</italic>-value (numbers within boxes are ranks). (<bold>A)</bold> In ClanOv (“Clan Overlap”), highest-ranking domains are considered as TPs, domains that overlap higher-ranking domains of the same clan (green connections) are removed (not counted toward the FDR or downstream overlaps), and domains that overlap higher-ranking domains of different clans (red connections) are considered FPs. (<bold>B)</bold> In ContextC (“Context Coherence”), the highest-ranking domain prediction in a sequence is considered a TP. Subsequent domains are considered TPs if there is at least one higher-ranking domain such that their families have been observed together before in UniProt (green connections), and otherwise they are considered FPs (all red connections).</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.g002" position="float" xlink:type="simple"/>
</fig>
<p>The principles behind the other three tests are described here briefly: OrthoC (“Ortholog Set Coherence”) is based on the expectation that orthologous proteins contain similar domains [<xref rid="pcbi.1004509.ref048" ref-type="bibr">48</xref>], RevSeq (“Reverse Sequence”) estimates noise based on domains predicted on reversed amino acid sequences [<xref rid="pcbi.1004509.ref049" ref-type="bibr">49</xref>], and MarkovR (“Markov Random”) estimates noise based on domains predicted on random sequences generated from a second-order Markov model (Supp. Methods and Fig A in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
<p>Methods are compared at the same empirical FDR based on the number of domain predictions (<xref rid="pcbi.1004509.g003" ref-type="fig">Fig 3</xref> and Fig B in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>), unique families per protein (Fig C in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>), amino acids covered (Fig D in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>), and proteins with predictions (Fig E in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>), as well as their total “GO information content” scores (derived from the Gene Ontology [<xref rid="pcbi.1004509.ref050" ref-type="bibr">50</xref>] and MultiPfam2GO [<xref rid="pcbi.1004509.ref051" ref-type="bibr">51</xref>]; Supp. Methods and Fig F in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
<fig id="pcbi.1004509.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004509.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Change in domain predictions while controlling empirical FDRs.</title>
<p>In each panel, a different empirical FDR test (<italic>x</italic>-axis, note log scale) is used to evaluate each method at a series of thresholds. The number of domain predictions is turned into a percent change relative to the number of Standard Pfam predictions (<italic>y</italic>-axis). Curves correspond to: <italic>E</italic>-values (black), cross marks p <italic>≤</italic> 1.3e-8; stratified <italic>q</italic>-values (red), cross marks <italic>q ≤</italic> 4e-4; stratified lFDRs (green), cross marks lFDR <italic>≤</italic> 2.5e-2. The <italic>q</italic>-value and lFDR thresholds marked with crosses correspond to the median across domain families of the Standard Pfam thresholds mapped theoretically to those statistics (Supp. Results in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). All curves have standard error bars in both dimensions, which are not always visible. Standard Pfam is not plotted as both the ClanOv and ContextC tests are based on Standard Pfam predictions.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.g003" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec007">
<title>Stratified <italic>q</italic>-values predict more domains than the Standard Pfam, <italic>E</italic>-values, and lFDRs</title>
<p>Stratified <italic>q</italic>-value thresholds outperform <italic>E</italic>-values in all tests (<xref rid="pcbi.1004509.g003" ref-type="fig">Fig 3</xref>, Fig B in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). While stratified lFDR thresholds are superior to <italic>E</italic>-values in all tests, they are unexpectedly outperformed by <italic>q</italic>-values on most tests. We hypothesize that lFDR estimates are less robust than <italic>q</italic>-values due to errors in <italic>p</italic>-values; these errors most likely arise because of weaknesses in the standard null model. The Standard Pfam is not evaluated using ClanOv and ContextC (<xref rid="pcbi.1004509.g003" ref-type="fig">Fig 3</xref>); these tests are based on the Pfam clans and observed domain pairs, so the Standard Pfam has zero empirical FDRs in both. However, <italic>q</italic>-values outperform the Standard Pfam in two of the three fair tests (OrthoC, MarkovR) and perform similarly in RevSeq (Fig B in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). The same trends hold if the combined empirical <italic>E</italic>-value is controlled (Supp. Methods and Fig G in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
</sec>
<sec id="sec008">
<title><italic>Q</italic>-value predictions are more informative than those of Standard Pfam, dPUC</title>
<p>We measure improvements not only of domain counts, which may be inflated for families with many small repeating units, but also of unique family counts. We also measure the information content based on the GO terms associated with domain predictions [<xref rid="pcbi.1004509.ref051" ref-type="bibr">51</xref>] (Supp. Methods in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). To have amounts of noise comparable to Pfam, we calculate <italic>p</italic>- and <italic>q</italic>-value equivalents to the Standard Pam thresholds for each family (Supp. Results in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). The medians of these distributions give thresholds of <italic>q</italic> ≤ 4e-4, and for <italic>E</italic>-values, <italic>p</italic> ≤ 1.3e-8 (Supp. Results in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). <italic>Q</italic>-values improve all metrics consistently relative to the Standard Pfam (between 4–7%, <xref rid="pcbi.1004509.g004" ref-type="fig">Fig 4</xref>). <italic>E</italic>-values predict 2% fewer domains than the Standard Pfam, but slightly outperform Pfam in the other metrics (<xref rid="pcbi.1004509.g004" ref-type="fig">Fig 4</xref>).</p>
<fig id="pcbi.1004509.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004509.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Percent changes for several metrics relative to the Standard Pfam.</title>
<p>We count “domain” predictions in UniRef50; unique “families” per protein over all proteins; “amino acids” covered by domains over all proteins, without double-counting amino acids covered by multiple domains; “protein” counts with any predicted domain; and “GO info content”, which sums the functional information content of all proteins with domain predictions (Supp. Methods in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). All quantities are turned into percent changes relative to the respective numbers from the Standard Pfam. <italic>Q</italic>-value uses <italic>q ≤</italic> 4e-4, <italic>E</italic>-value uses <italic>p ≤</italic> 1.3e-8, and dPUC uses a “candidate domain <italic>p</italic>-value threshold” of 1e-4, which gives comparable empirical FDRs as the Standard Pfam.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.g004" position="float" xlink:type="simple"/>
</fig>
<p>We also evaluated dPUC, a prediction method based on domain context [<xref rid="pcbi.1004509.ref048" ref-type="bibr">48</xref>,<xref rid="pcbi.1004509.ref052" ref-type="bibr">52</xref>]. dPUC also improves upon the Standard Pfam in all cases (<xref rid="pcbi.1004509.g004" ref-type="fig">Fig 4</xref>). dPUC increases domains more than <italic>q</italic>-values, but their unique family count and amino acid coverage are comparable, and <italic>q</italic>-values best dPUC for protein counts and GO information content. This is because dPUC predicts more repeat domains (of the same family) and tends to restrict new predictions to proteins that already had Standard Pfam predictions. In contrast, <italic>q</italic>-values increase domains at the same rate as they increase protein coverage, which increases information the most. Thus, while stratified <italic>q</italic>-values predict fewer domains than dPUC, those domains tend to be more informative than the dPUC predictions at comparable FDRs.</p>
</sec>
<sec id="sec009">
<title>Empirical FDRs and <italic>q</italic>-values disagree in few domain families</title>
<p>We find large disagreements between <italic>q</italic>-values and our empirical FDRs tests (except for MarkovR; <xref rid="pcbi.1004509.g005" ref-type="fig">Fig 5</xref>, Fig H in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). Interestingly, the disagreement is proportionally larger for smaller FDRs, and shrinks as the FDR grows (<xref rid="pcbi.1004509.g005" ref-type="fig">Fig 5</xref>). We hypothesize that a few families are too noisy at stringent thresholds, and this subset becomes proportionally smaller as all families are allowed greater noise. To test this, we compute empirical FDRs separately per family at a threshold of <italic>q ≤</italic> 1e-2 (Methods). This threshold gives a greater FDR than the Standard Pfam (Supp. Results in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>), which is desirable here as many families have few predictions at more stringent thresholds. Since large deviations between the empirical FDRs and <italic>q</italic>-values may arise due to low sampling, significance is assessed by modeling this random sampling (Methods). We find that most families (92–99%, Table A in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>) have FDRs close to the <italic>q</italic>-value threshold or have statistically insignificant differences (blue and black data in <xref rid="pcbi.1004509.g006" ref-type="fig">Fig 6</xref>, Fig I in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
<fig id="pcbi.1004509.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004509.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Comparison of <italic>q</italic>-value thresholds and empirical FDRs.</title>
<p>In each panel, for each <italic>q</italic>-value threshold, observed empirical FDRs are computed (by ClanOv, left, and ContextC, right) and the relationship between these two quantities is shown in red. Since <italic>q</italic>-values control FDRs when input <italic>p</italic>-values are correct, ideally these data fall on the <italic>y</italic> = <italic>x</italic> line (dashed black lines). Values below the dashed line correspond to empirical FDRs that are larger than <italic>q</italic>-values. Smaller FDRs correspond to more stringent predictions and therefore include fewer predictions. All <italic>x</italic> and <italic>y</italic>-axes have the same range for ease of comparison and are in log scale. The red cross marks <italic>q ≤</italic> 4e-4.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.g005" position="float" xlink:type="simple"/>
</fig>
<fig id="pcbi.1004509.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004509.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Identification of domain families with empirical FDRs that differ significantly from expectation.</title>
<p>In each panel, the empirical FDR is computed (by ClanOv, left, and ContextC, right) for each domain family at <italic>q ≤</italic> 1e-2, and the log-deviation (LD) of this empirical FDR from the threshold is plotted on the <italic>y</italic>-axis relative to the number of predictions at this threshold (<italic>x</italic>-axis). Zero LD corresponds to perfect agreement, while positive and negative numbers correspond to underestimated and overestimated empirical FDRs, respectively. The LD values of 0, 2, and -2 are marked with horizontal black, gray, and gray dashed lines respectively. Families are plotted as black dots if their deviations are insignificant via a Poisson test (Methods), blue if the deviations are significant but the effect size is small (|LD| <italic>≤</italic> 2), red if the deviations are significant and have a large positive effect size (LD &gt; 2), and green if the deviations are significant and have a large negative effect size (LD &lt; -2).</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.g006" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec010">
<title>Empirical FDRs elevated in families with repetitive patterns</title>
<p>Four tests (ClanOv, ContextC, OrthoC, and RevSeq) detect many families with significantly larger FDRs than expected (3–8%, Table A in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). These families are significantly enriched for those containing coiled-coils, transmembrane domains, and low-complexity regions (<xref rid="pcbi.1004509.g007" ref-type="fig">Fig 7</xref>; Methods). There are fewer families with significantly smaller FDRs than expected (0–2%, Table A in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>), and they do not appear to share common patterns. Only the MarkovR test conforms to expectation, with no families having significantly larger FDRs than expected and 0.1% of families having significantly smaller FDRs than expected.</p>
<fig id="pcbi.1004509.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004509.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Families with increased noise are enriched for repetitive patterns.</title>
<p>Each Pfam family is classified as transmembrane domain, low-complexity region, coiled-coil, or “other” (Methods). The “background” bars correspond to all Pfam families, and the other bars correspond to noisy families, or those with significantly larger empirical FDRs than expected with <italic>q ≤</italic> 1e-2 using either ClanOv, ContextC, OrthoC, RevSeq, at least three of these tests (3 votes), or all four tests (4 votes). The top (gray) bars show the set size, and the bottom bars (colors) show the set composition. Category enrichments are evaluated using the hypergeometric distribution, and two-sided <italic>p</italic>-values with <italic>p ≤</italic> 0.01 are declared significant. All noisy sets are significantly enriched for coiled coils and de-enriched for “other” families. Low-complexity regions are significantly enriched in all sets except ClanOv. Transmembrane domains are significantly enriched in all sets except OrthoC and “4 votes.”</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.g007" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec011">
<title>Assigning domain families to noise classes</title>
<p>We use the four tests (excluding MarkovR) to assign families into mutually-exclusive classes by majority rule. The “increased-noise” families have significantly large positive deviations (see <xref rid="sec015" ref-type="sec">Methods</xref>; red in <xref rid="pcbi.1004509.g006" ref-type="fig">Fig 6</xref>) in at least three tests. The “decreased-noise” families have significantly large negative deviations (green in <xref rid="pcbi.1004509.g006" ref-type="fig">Fig 6</xref>) in at least three tests. Lastly, the families with “as-expected-noise” have small deviations (blue and some black in <xref rid="pcbi.1004509.g006" ref-type="fig">Fig 6</xref>) in at least three tests. There are 327 increased-noise families (2.7% of Pfam, <xref rid="pcbi.1004509.s002" ref-type="supplementary-material">S1 File</xref>), one decreased-noise family (HemolysinCabind), and 4433 as-expected-noise families (36%, <xref rid="pcbi.1004509.s003" ref-type="supplementary-material">S2 File</xref>). There are 7512 unclassified families in Pfam (61%). Using these classes, we find that the Standard Pfam has more stringent thresholds (in terms of <italic>q</italic>-values) for increased-noise as compared to as-expected-noise families, but many increased-noise family thresholds remain too permissive (Supp. Results and Fig J in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
</sec>
<sec id="sec012">
<title>The lFDR outperforms <italic>q</italic>-values in families with as-expected noise</title>
<p>Empirical FDRs agree more with <italic>q</italic>-values in as-expected-noise families than in all families combined, although some disagreement remains (Fig K in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). In these families, lFDRs outperform <italic>q</italic>-values (<xref rid="pcbi.1004509.g008" ref-type="fig">Fig 8</xref>), as we expect from our theoretical results when the underlying <italic>p</italic>-values are correct. Compared to the Standard Pfam, domain counts at <italic>q ≤</italic> 4e-4 increase from 6.7% in all families to 8.8% in as-expected noise families (similar increases are observed on all metrics; Fig L in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>), and lFDRs further improve upon <italic>q</italic>-values. Thus, lFDRs may become more useful should <italic>p</italic>-values for all families improve in the future.</p>
<fig id="pcbi.1004509.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004509.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Domain change while controlling empirical FDRs, restricted to families with as-expected noise.</title>
<p>This figure is exactly like <xref rid="pcbi.1004509.g003" ref-type="fig">Fig 3</xref> except that only families with “as-expected noise” are used in the benchmarks. See <xref rid="pcbi.1004509.g003" ref-type="fig">Fig 3</xref>.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.g008" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec013">
<title>Tiered stratified <italic>q</italic>-values</title>
<p>The previous methods describe a single “domain” threshold set via the stratified <italic>q</italic>-value or lFDR analysis. However, HMMER provides additional information in the form of “sequence” <italic>p</italic>-values, which score the presence of domain families combining the evidence of repeating domains. Only 2.3% families have different sequence and domain Standard Pfam thresholds [<xref rid="pcbi.1004509.ref014" ref-type="bibr">14</xref>]. Here we define “two-tier” thresholds using the FDR. In the first tier, we compute <italic>q</italic>-values from the sequence <italic>p</italic>-values and set the threshold <italic>Q</italic><sub><italic>seq</italic></sub>. In the second tier, we compute <italic>q</italic>-values on the domain <italic>p</italic>-values, only for the domains in sequences that satisfied the sequence threshold, and set the threshold <italic>Q</italic><sub><italic>dom|seq</italic></sub> (corresponding to a FDR conditional on the first threshold). The final FDR is approximately <italic>Q</italic><sub><italic>seq</italic></sub><italic>+Q</italic><sub><italic>dom|seq</italic></sub> if both thresholds are small and under an independence assumption (Supp. Methods in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). For simplicity, we only evaluate the case where <italic>Q</italic><sub><italic>seq</italic></sub> = <italic>Q</italic><sub><italic>dom|seq</italic></sub>.</p>
<p>Tiered <italic>q</italic>-values predict many more domains, at any fixed empirical FDR, than domain <italic>q</italic>-values and domain lFDRs, our previous two best statistics, consistently and by very large margins (Fig B in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). Tiered <italic>q</italic>-values also outperform other methods in predicting new families per sequence (Fig C in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>); the entire signal of these families comes from combining repeating units, none of which is significant by itself. There is also a large increase in amino acid coverage (Fig D in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>), and a smaller increase in protein coverage (Fig E in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>) and GO information content (Fig F in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). Tiered <italic>q</italic>-values also compare favorably to dPUC [<xref rid="pcbi.1004509.ref048" ref-type="bibr">48</xref>], matching the superior domain improvements of dPUC, and outperforming dPUC in all other metrics (Fig M in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). Thus, tiered <italic>q</italic>-values retain the strengths of domain <italic>q</italic>-values while powerfully leveraging the limited context information of repeating domains present in sequence <italic>q</italic>-values. However, the estimated FDRs of tiered <italic>q</italic>-values are less accurate than for domain <italic>q</italic>-values (Fig H in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>), and remain less accurate in as-expected-noise families (Fig K in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). For this reason, tiered stratified <italic>q</italic>-values are experimental: although they are more powerful than domain-only <italic>q</italic>-values, they do not, as described, control the FDR as well.</p>
</sec>
</sec>
<sec id="sec014" sec-type="conclusions">
<title>Discussion</title>
<p>In multiple hypothesis testing, the FDR and lFDR are straightforward approaches for controlling the proportion of false positives and the posterior error probability, respectively. The <italic>q</italic>-value is a statistic for controlling the FDR that is less biased and more flexible than previous FDR procedures such as the one from Benjamini and Hochberg [<xref rid="pcbi.1004509.ref022" ref-type="bibr">22</xref>]. Benchmarks based on empirical FDRs have been a part of recent works studying protein and DNA homology [<xref rid="pcbi.1004509.ref047" ref-type="bibr">47</xref>,<xref rid="pcbi.1004509.ref048" ref-type="bibr">48</xref>,<xref rid="pcbi.1004509.ref052" ref-type="bibr">52</xref>,<xref rid="pcbi.1004509.ref053" ref-type="bibr">53</xref>]; however, those approaches have used expensive simulations rather than estimating FDRs directly from <italic>p</italic>-<italic>v</italic>alues (or <italic>E</italic>-<italic>v</italic>alues), as <italic>q</italic>-<italic>v</italic>alues do very efficiently. Our work is, to the best of our knowledge, the first attempt at applying <italic>q</italic>-<italic>v</italic>alues and lFDRs to domain identification, thus advancing the statistics of this field.</p>
<p>Our theoretical work revealed that the lFDR, which is the Bayesian posterior probability that a prediction is false, is the optimal quantity to control in stratified problems. Stratified lFDR control has previously been found to optimize stratified thresholds in the related problem of minimizing the combined false non-discovery rate while controlling the combined FDR [<xref rid="pcbi.1004509.ref037" ref-type="bibr">37</xref>]. The lFDR also arises naturally in Bayesian classification problems [<xref rid="pcbi.1004509.ref043" ref-type="bibr">43</xref>]. Stratified lFDR thresholds ensure the least confident predictions of each stratum have the same posterior error probability. However, we found that estimated <italic>q</italic>-values are more robust than our lFDR estimates for domain predictions, where the underlying <italic>p</italic>-value estimates are imperfect [<xref rid="pcbi.1004509.ref045" ref-type="bibr">45</xref>] (<xref rid="pcbi.1004509.g003" ref-type="fig">Fig 3</xref>).</p>
<p>We extended the domain stratified <italic>q</italic>-value approach into what we call tiered stratified <italic>q</italic>-values, by setting <italic>q</italic>-value thresholds on both the sequence and domain statistics reported by HMMER. While accurate FDR estimation of this procedure remains a challenge, tiered <italic>q</italic>-values successfully leverage the additional signal of repeating domains to increase predictions (Fig M in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). There are other successful approaches, such as dPUC [<xref rid="pcbi.1004509.ref048" ref-type="bibr">48</xref>] and CODD [<xref rid="pcbi.1004509.ref052" ref-type="bibr">52</xref>], that use the broader concept of domain context (or co-occurrence) to improve domain predictions. Remarkably, tiered <italic>q</italic>-values perform as well or better than as dPUC under all metrics (Fig M in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>), even though tiered <italic>q</italic>-values only utilize the context signal of repeating domains, while dPUC additionally considers context between families [<xref rid="pcbi.1004509.ref048" ref-type="bibr">48</xref>]. In the future, tiered <italic>q</italic>-values could be combined with dPUC to yield further improvements in domain prediction.</p>
<p>We introduced a suite of empirical FDR tests to evaluate domain predictions. Altogether, these tests are powerful means for evaluating the correctness of predictions (“Evaluation of empirical FDR tests” Supp. Results in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). Four of our tests consistently revealed flaws in the estimates of statistical significance for some families. We found a strong enrichment among noisy families for coiled coils, transmembrane domains, and other low-complexity regions. These problematic domain categories have been noted elsewhere [<xref rid="pcbi.1004509.ref046" ref-type="bibr">46</xref>,<xref rid="pcbi.1004509.ref054" ref-type="bibr">54</xref>,<xref rid="pcbi.1004509.ref055" ref-type="bibr">55</xref>], and <italic>ad hoc</italic> solutions have been proposed [<xref rid="pcbi.1004509.ref054" ref-type="bibr">54</xref>,<xref rid="pcbi.1004509.ref056" ref-type="bibr">56</xref>]. However, none of these solutions are implemented by standard software such as BLAST and HMMER [<xref rid="pcbi.1004509.ref056" ref-type="bibr">56</xref>]. In our view, obtaining correct statistics for these repetitive families should be the top priority of the field of sequence homology. Nevertheless, most families in Pfam appear to have correct statistics, and the advantage of using <italic>q</italic>-values and lFDRs is clear. In the future, the standard sequence similarity software packages should be able to report these stratified statistics natively rather than as a post-processing step as is done here.</p>
<p>Domain prediction is one case where stratified FDR and lFDR control are desirable, since domain families occur with vastly different frequencies and are thus associated with differing amounts of true signal. However, the same holds for other applications, such as BLAST-based orthology prediction [<xref rid="pcbi.1004509.ref020" ref-type="bibr">20</xref>], since some ortholog groups are orders of magnitude larger than others. FDR and lFDR control may also improve iterative profile database searches, such as PSI-BLAST [<xref rid="pcbi.1004509.ref006" ref-type="bibr">6</xref>], as well as numerous other sequence analysis problems.</p>
<p>The basis of our work is a general theorem applicable to naturally stratified statistical tests. Whether the combined FDR or <italic>E</italic>-value is constrained, equal stratified lFDR thresholds are required to maximize predictions. Besides limits on sample size, the strata may be arbitrary, so our result can be broadly applied to multiple hypothesis testing problems. In motif scanning, for example <italic>in silico</italic> transcription factor (TF) binding site identification, the position weight matrix of each TF may yield a <italic>p</italic>-value per match [<xref rid="pcbi.1004509.ref057" ref-type="bibr">57</xref>], and the number of binding sites per TF may vary by orders of magnitude across different TFs. Here, we recommend computing lFDRs stratified by TF, and setting equal lFDR thresholds across TFs. For protein domains, one could further stratify <italic>p</italic>-values using taxonomy, since domain family abundances vary greatly across the kingdoms of life (archaea, bacteria, eukarya, and viruses) [<xref rid="pcbi.1004509.ref058" ref-type="bibr">58</xref>,<xref rid="pcbi.1004509.ref059" ref-type="bibr">59</xref>]. In sum, we have demonstrated the practical utility of our theoretical contributions to domain prediction, which are likely to influence many applications in bioinformatics and beyond.</p>
</sec>
<sec id="sec015" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec016">
<title>HMMER <italic>p</italic>-values</title>
<p>A <italic>p</italic>-value distribution is required to estimate <italic>q</italic>-values and lFDRs. HMMER reports two kinds of <italic>p</italic>-values. The “sequence” <italic>p</italic>-value combines every domain of the same family on a protein sequence, while the “domain” <italic>p</italic>-value is limited to each domain instance. The sequence <italic>p</italic>-value thus reports whether the protein sequence as a whole contains similarity to the HMM, whereas the domain <italic>p</italic>-value scores individual domain units within the sequence. We obtained domain predictions with <italic>p</italic>-values on UniRef50 [<xref rid="pcbi.1004509.ref035" ref-type="bibr">35</xref>] and OrthoMCL5 [<xref rid="pcbi.1004509.ref020" ref-type="bibr">20</xref>] proteins using hmmsearch from HMMER 3.0 and HMMs from Pfam 25 with these parameters: the heuristic filters “--F1 1e-1--F2 1e-1--F3 1e-2” allow sequence predictions with “stage 1/2/3” <italic>p</italic>-value thresholds of 0.1, 0.1, and 0.01, respectively. Moreover, we obtain <italic>p</italic>-values using “-Z 1--domZ 1”. Lastly, we remove domains with <italic>p</italic>&gt;0.01 by adding “-E 1e-2--domE 1e-2”.</p>
</sec>
<sec id="sec017">
<title>Overview of <italic>q</italic>-value and lFDR estimation for domains</title>
<p>For each domain family HMM, we use its HMMER <italic>p</italic>-values over a protein database to estimate <italic>q</italic>-values and lFDRs. We use standard methods [<xref rid="pcbi.1004509.ref027" ref-type="bibr">27</xref>,<xref rid="pcbi.1004509.ref045" ref-type="bibr">45</xref>] adapted for censored tests since HMMER3 only reports the most significant <italic>p</italic>-values while standard methods require all <italic>p</italic>-values. Notably, HMMER3 does not provide complete <italic>p</italic>-values even if filters are removed [<xref rid="pcbi.1004509.ref060" ref-type="bibr">60</xref>], and only small <italic>p</italic>-values are accurate [<xref rid="pcbi.1004509.ref019" ref-type="bibr">19</xref>], so the full set of <italic>p</italic>-values is not useful. Moreover, the filters are desirable to reduce HMMER3's runtime. The Supp. Methods (<xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>) reviews these standard methods for estimating <italic>q</italic>-values and lFDRs, and details our adaptations for domains. Briefly, we remove overlaps between domain predictions ranking by <italic>p</italic>-value, before computing <italic>q</italic>-values and lFDRs; otherwise, the amount of true positive may be overestimated because overlapping domains will be counted double, a common case within Pfam clans. Secondly, the standard approaches require all <italic>p</italic>-values solely to estimate <italic>π</italic><sub>0</sub>, here roughly the proportion of proteins that do not contain a domain family. We set <italic>π</italic><sub>0</sub> = 1, which gives slightly more conservative <italic>q</italic>-values and lFDRs than otherwise. Our software for computing stratified <italic>q</italic>-values, lFDR estimates and tiered <italic>q</italic>-values from HMMER3 is DomStratStats 1.03, available at <ext-link ext-link-type="uri" xlink:href="https://github.com/alexviiia/DomStratStats" xlink:type="simple">https://github.com/alexviiia/DomStratStats</ext-link>.</p>
</sec>
<sec id="sec018">
<title>Baseline threshold methods</title>
<p>We compare new and standard domain prediction approaches over a range of relevant empirical FDRs. We vary thresholds based on stratified <italic>q</italic>-values and lFDRs, and compare their performances to thresholds varied by <italic>E</italic>-values and extensions of the Standard Pfam. Stratified domain <italic>E</italic>-values are computed from the HMMER <italic>p</italic>-values by multiplying them by the number of proteins in UniRef50, as hmmsearch would compute them. The “Standard Pfam” has two expert-curated thresholds per family, for domain and sequence bitscores respectively (Pfam calls them “gathering” thresholds) [<xref rid="pcbi.1004509.ref014" ref-type="bibr">14</xref>]. For all methods, domain overlaps are removed ranking by <italic>p</italic>-value. Overlaps between families in the “nesting” list are not removed (Supp. Methods in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). All methods use a permissive overlap definition [<xref rid="pcbi.1004509.ref061" ref-type="bibr">61</xref>] (Supp. Methods in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>), except for the Standard Pfam (there overlaps of even one amino acid are removed [<xref rid="pcbi.1004509.ref014" ref-type="bibr">14</xref>]). The Standard Pfam thresholds are mapped to <italic>p</italic>-values, <italic>q</italic>-values, and lFDRs, and the medians of these distributions are used in comparisons (Supp. Results and Fig N in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
</sec>
<sec id="sec019">
<title>Empirical FDR tests</title>
<p>We introduce a suite of tests that measure empirical FDRs using biologically-motivated definitions of TPs and FPs. The “standard” biological sequence null model, which most software from BLAST to HMMER use, consists of random sequences generated assuming independent and identically distributed amino acids. Domains predicted on these random sequences produce a distribution of random bit scores from which <italic>p</italic>-values are computed. The five empirical tests we use instead label every prediction as either a TP or a FP, and these labels are used to compute empirical FDRs and <italic>E</italic>-values (number of type I errors, or FPs). Each test makes different assumptions, and together they provide independent and complementary evaluations. We describe our two primary tests in detail next; for the other three, see Supp. Methods (<xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
<sec id="sec020">
<title>Clan Overlap (ClanOv)</title>
<p>This test is inspired by [<xref rid="pcbi.1004509.ref046" ref-type="bibr">46</xref>]. After domains are predicted on a sequence and ranked by <italic>p</italic>-value, only overlaps between domains of the same clan are eliminated. Each remaining domain is labeled a FP if it overlaps a higher-ranking domain of a different clan, and otherwise it is labeled a TP. The “permissive” overlap definition is used (Supp. Methods in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>). Overlaps are removed before counting domains (<italic>y</italic>-axis of plots such as <xref rid="pcbi.1004509.g003" ref-type="fig">Fig 3</xref>). Since <italic>q</italic>-values and lFDRs are computed on domains without overlaps, but ClanOv requires overlaps to measure empirical FDRs, here domains that overlap higher-ranking domains must be preserved and must have <italic>q</italic>-values and lFDRs, which are assigned by interpolation. This test does not evaluate the Standard Pfam fairly, which gets an FDR of zero, partly because the Standard Pfam thresholds are directly optimized on a similar test to prevent inter-clan overlaps [<xref rid="pcbi.1004509.ref014" ref-type="bibr">14</xref>], but also because our “nesting” list of allowed overlaps is defined using the Standard Pfam (Supp. Methods in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
</sec>
<sec id="sec021">
<title>Context Coherence (ContextC)</title>
<p>This test extends one that previously used domain co-occurrence to estimate the FDR [<xref rid="pcbi.1004509.ref047" ref-type="bibr">47</xref>]. Here, given a list <italic>L</italic> of context family pairs (families that co-occur within the same sequence) and domains ranked by <italic>p</italic>-value, a domain is labeled as a TP if it is the highest-ranking domain or a higher-ranking domain can be found such that their family pair is in <italic>L</italic>; otherwise it is labeled a FP. This test does not evaluate the Standard Pfam fairly, which gets an FDR of zero, since <italic>L</italic> is defined by the Standard Pfam observations (Supp. Methods in <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
</sec>
</sec>
<sec id="sec022">
<title>Computing empirical FDRs</title>
<p>Given domain predictions labeled as either TPs or FPs as above, we compute empirical FDRs at two levels. Briefly, the “method-level” FDR evaluates an entire scoring method (<italic>q</italic>-values, <italic>E</italic>-values, etc.) combining all domain families, whereas the “family-level” FDR evaluates the accuracy of <italic>q</italic>-values separately per family. These quantities are consistent estimators of the corresponding true pFDRs under weak dependence [<xref rid="pcbi.1004509.ref044" ref-type="bibr">44</xref>]. At a threshold <italic>t</italic>, let TP<sub><italic>ij</italic></sub>(<italic>t</italic>) and FP<sub><italic>ij</italic></sub>(<italic>t</italic>) be the observed number of true positives and false positives, respectively, for domain family <italic>j</italic> in protein sequence <italic>i</italic>.</p>
<sec id="sec023">
<title>Method-level FDR</title>
<p>The empirical protein-level FDR, or epFDR, of a protein <italic>i</italic> with predictions, combines all domain families <italic>j</italic>,
<disp-formula id="pcbi.1004509.e009">
<alternatives>
<graphic id="pcbi.1004509.e009g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.e009" xlink:type="simple"/>
<mml:math display="block" id="M9" overflow="scroll">
<mml:mrow><mml:msub><mml:mrow><mml:mtext>epFDR</mml:mtext></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext>TP</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>The method-level empirical FDR is the mean epFDR<sub>i</sub>(<italic>t</italic>) over all proteins <italic>i</italic> with predictions, which corresponds to the expected FDR per protein. This per-protein FDR normalizes for domain counts, so proteins with hundreds of domain instances are weighted the same as proteins with fewer domains. Similarly, the empirical <italic>E</italic>-value is <inline-formula id="pcbi.1004509.e010"><alternatives><graphic id="pcbi.1004509.e010g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.e010" xlink:type="simple"/><mml:math display="inline" id="M10" overflow="scroll"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> across all proteins and families. The standard errors used in plots are computed from the epFDR<sub>i</sub>(<italic>t</italic>) and <inline-formula id="pcbi.1004509.e011"><alternatives><graphic id="pcbi.1004509.e011g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.e011" xlink:type="simple"/><mml:math display="inline" id="M11" overflow="scroll"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> distributions over proteins, for FDRs and <italic>E</italic>-values respectively.</p>
</sec>
<sec id="sec024">
<title>Family-level FDR</title>
<p>This procedure measures per-family deviations between the empirical FDRs and the <italic>q</italic>-value threshold of 1e-2; ideally they agree. The empirical family-level FDR, or efFDR, of family <italic>j</italic> is defined as
<disp-formula id="pcbi.1004509.e012">
<alternatives>
<graphic id="pcbi.1004509.e012g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.e012" xlink:type="simple"/>
<mml:math display="block" id="M12" overflow="scroll">
<mml:mrow><mml:msub><mml:mrow><mml:mtext>efFDR</mml:mtext></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext>TP</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mspace width="0.03em"/><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
combining observations across proteins <italic>i</italic>, and the log-deviation is defined as
<disp-formula id="pcbi.1004509.e013">
<alternatives>
<graphic id="pcbi.1004509.e013g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.e013" xlink:type="simple"/>
<mml:math display="block" id="M13" overflow="scroll">
<mml:mrow><mml:msub><mml:mrow><mml:mtext>LD</mml:mtext></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>log</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mtext>efFDR</mml:mtext></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>q</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>A pseudocount of 1 is used in efFDR<sub>j</sub>(<italic>q</italic>) so LD<sub>j</sub> is defined when there are no observed FPs. For families with few predictions, the LD may be artificially large or small. We compute a two-tailed <italic>p</italic>-value (<italic>p</italic><sub><italic>Poisson</italic></sub>) of the empirical <italic>E</italic>-value <inline-formula id="pcbi.1004509.e014"><alternatives><graphic id="pcbi.1004509.e014g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.e014" xlink:type="simple"/><mml:math display="inline" id="M14" overflow="scroll"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> using the Poisson distribution with parameter <inline-formula id="pcbi.1004509.e015"><alternatives><graphic id="pcbi.1004509.e015g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004509.e015" xlink:type="simple"/><mml:math display="inline" id="M15" overflow="scroll"><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mtext>TP</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mtext>FP</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, which is the expected number of FPs given the number of observations, excluding the pseudocount. The <italic>p</italic><sub><italic>Poisson</italic></sub> distribution across families is used to compute <italic>q</italic>-values (<italic>q</italic><sub><italic>Poisson</italic></sub>, unrelated to the domain <italic>q</italic>-value threshold), and a measurement is deemed significant if <italic>q</italic><sub><italic>Poisson</italic></sub> <italic>≤</italic> 1e-3. Families are also separated by effect size: positive deviations if LD<sub>j</sub> &gt; 2, negative deviations if LD<sub>j</sub> &lt; -2, and small deviations if |LD<sub>j</sub>| <italic>≤</italic> 2.</p>
</sec>
</sec>
<sec id="sec025">
<title>Domain Prediction Using Context (dPUC)</title>
<p>DPUC improves domain prediction by taking into account the “context,” or presence of other domain predictions [<xref rid="pcbi.1004509.ref048" ref-type="bibr">48</xref>]. A newer version of dPUC now works with HMMER3, among other improvements that will be described elsewhere. Context family pair counts were derived from Pfam 25 on UniProt proteins. The “candidate domain <italic>p</italic>-value threshold” of dPUC is a tunable parameter, which when set to <italic>p ≤</italic> 1e-4 gives comparable empirical FDRs to <italic>q ≤</italic> 4e-4 on the MarkovR and OrthoC tests. dPUC is not evaluated in ContextC because both are based on domain context (dPUC would have a zero empirical FDR), nor in ClanOv because dPUC requires overlap removal while ClanOv requires observing overlaps to compute its FDR. DPUC 2.0 is available at <ext-link ext-link-type="uri" xlink:href="http://compbio.cs.princeton.edu/dpuc" xlink:type="simple">http://compbio.cs.princeton.edu/dpuc</ext-link>.</p>
</sec>
<sec id="sec026">
<title>Categorizing families with repetitive patterns</title>
<p>PairCoil2 [<xref rid="pcbi.1004509.ref062" ref-type="bibr">62</xref>], TMHMM [<xref rid="pcbi.1004509.ref063" ref-type="bibr">63</xref>], and SEG [<xref rid="pcbi.1004509.ref064" ref-type="bibr">64</xref>], were run on UniRef50 using standard parameters to predict coiled coils, transmembrane domains, and low-complexity regions, respectively. Each Pfam family observed at least 4 times in UniRef50 was associated with a category if more than half of its domains overlapped the category's predictions. For families with multiple categories, only the one with the greatest amino acid overlap was kept. Unassigned families were categorized as “other”.</p>
</sec>
</sec>
<sec id="sec027">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004509.s001" xlink:href="info:doi/10.1371/journal.pcbi.1004509.s001" mimetype="application/pdf" position="float" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supplementary information.</title>
<p>Contains the supplementary methods, results, tables and figures.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004509.s002" xlink:href="info:doi/10.1371/journal.pcbi.1004509.s002" mimetype="text/plain" position="float" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>Pfam families with as-expected noise.</title>
<p>Table with family accessions and annotation, number of “votes” (how many tests declare it as having an insignificant or small effect size difference from the expected FDR), HMM length, and “type” is the repetitive pattern category: T = transmembrane domain, L = low-complexity region, C = coiled coil, and N = other (normal).</p>
<p>(TXT)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004509.s003" xlink:href="info:doi/10.1371/journal.pcbi.1004509.s003" mimetype="text/plain" position="float" xlink:type="simple">
<label>S2 File</label>
<caption>
<title>Pfam families with increased noise.</title>
<p>Table with family accessions and annotation, number of “votes” (how many tests declare it as having a significantly large positive effect size difference from the expected FDR), HMM length, and “type” is the repetitive pattern category: T = transmembrane domain, L = low-complexity region, C = coiled coil, and N = other (normal).</p>
<p>(TXT)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004509.s004" xlink:href="info:doi/10.1371/journal.pcbi.1004509.s004" position="float" xlink:type="simple">
<label>S3 Files</label>
<caption>
<title>Random protein sequences, based on a 2nd order Markov model derived from UniRef50.</title>
<p>This dataset is used for one of our empirical FDR tests (see <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
<p>(FA)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004509.s005" xlink:href="info:doi/10.1371/journal.pcbi.1004509.s005" position="float" xlink:type="simple">
<label>S4 Files</label>
<caption>
<title>Random protein sequences, based on a 2nd order Markov model derived from UniRef50.</title>
<p>This dataset is used for one of our empirical FDR tests (see <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
<p>(FA)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004509.s006" xlink:href="info:doi/10.1371/journal.pcbi.1004509.s006" position="float" xlink:type="simple">
<label>S5 Files</label>
<caption>
<title>Random protein sequences, based on a 2nd order Markov model derived from UniRef50.</title>
<p>This dataset is used for one of our empirical FDR tests (see <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
<p>(FA)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004509.s007" xlink:href="info:doi/10.1371/journal.pcbi.1004509.s007" position="float" xlink:type="simple">
<label>S6 Files</label>
<caption>
<title>Random protein sequences, based on a 2nd order Markov model derived from UniRef50.</title>
<p>This dataset is used for one of our empirical FDR tests (see <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
<p>(FA)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004509.s008" xlink:href="info:doi/10.1371/journal.pcbi.1004509.s008" position="float" xlink:type="simple">
<label>S7 Files</label>
<caption>
<title>Random protein sequences, based on a 2nd order Markov model derived from UniRef50.</title>
<p>This dataset is used for one of our empirical FDR tests (see <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
<p>(FA)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004509.s009" xlink:href="info:doi/10.1371/journal.pcbi.1004509.s009" position="float" xlink:type="simple">
<label>S8 Files</label>
<caption>
<title>Random protein sequences, based on a 2nd order Markov model derived from UniRef50.</title>
<p>This dataset is used for one of our empirical FDR tests (see <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
<p>(FA)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004509.s010" xlink:href="info:doi/10.1371/journal.pcbi.1004509.s010" position="float" xlink:type="simple">
<label>S9 Files</label>
<caption>
<title>Random protein sequences, based on a 2nd order Markov model derived from UniRef50.</title>
<p>This dataset is used for one of our empirical FDR tests (see <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
<p>(FA)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004509.s011" xlink:href="info:doi/10.1371/journal.pcbi.1004509.s011" position="float" xlink:type="simple">
<label>S10 Files</label>
<caption>
<title>Random protein sequences, based on a 2nd order Markov model derived from UniRef50.</title>
<p>This dataset is used for one of our empirical FDR tests (see <xref rid="pcbi.1004509.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
<p>(FA)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank all members of the Singh, Llinás, and Storey groups for helpful discussions about this work.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004509.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Needleman</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Wunsch</surname> <given-names>CD</given-names></name>. <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>. <source>Journal of Molecular Biology</source>. <year>1970</year>;<volume>48</volume>: <fpage>443</fpage>–<lpage>453</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0022-2836(70)90057-4" xlink:type="simple">10.1016/0022-2836(70)90057-4</ext-link></comment> <object-id pub-id-type="pmid">5420325</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname> <given-names>TF</given-names></name>, <name name-style="western"><surname>Waterman</surname> <given-names>MS</given-names></name>. <article-title>Identification of common molecular subsequences</article-title>. <source>Journal of Molecular Biology</source>. <year>1981</year>;<volume>147</volume>: <fpage>195</fpage>–<lpage>197</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0022-2836(81)90087-5" xlink:type="simple">10.1016/0022-2836(81)90087-5</ext-link></comment> <object-id pub-id-type="pmid">7265238</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lipman</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Pearson</surname> <given-names>WR</given-names></name>. <article-title>Rapid and sensitive protein similarity searches</article-title>. <source>Science</source>. <year>1985</year>;<volume>227</volume>: <fpage>1435</fpage>–<lpage>1441</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.2983426" xlink:type="simple">10.1126/science.2983426</ext-link></comment> <object-id pub-id-type="pmid">2983426</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Karlin</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Altschul</surname> <given-names>SF</given-names></name>. <article-title>Methods for assessing the statistical significance of molecular sequence features by using general scoring schemes</article-title>. <source>P Natl Acad Sci U S A</source>. <year>1990</year>;<volume>87</volume>: <fpage>2264</fpage>–<lpage>2268</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004509.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Altschul</surname> <given-names>SF</given-names></name>, <name name-style="western"><surname>Gish</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>EW</given-names></name>, <name name-style="western"><surname>Lipman</surname> <given-names>DJ</given-names></name>. <article-title>Basic local alignment search tool</article-title>. <source>J Mol Biol</source>. <year>1990</year>;<volume>215</volume>: <fpage>403</fpage>–<lpage>10</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jmbi.1990.9999" xlink:type="simple">10.1006/jmbi.1990.9999</ext-link></comment> <object-id pub-id-type="pmid">2231712</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Altschul</surname> <given-names>SF</given-names></name>, <name name-style="western"><surname>Madden</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Schäffer</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res</source>. <year>1997</year>;<volume>25</volume>: <fpage>3389</fpage>–<lpage>3402</lpage>. <object-id pub-id-type="pmid">9254694</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name>. <article-title>Profile hidden Markov models</article-title>. <source>Bioinformatics</source>. <year>1998</year>;<volume>14</volume>: <fpage>755</fpage>–<lpage>763</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/14.9.755" xlink:type="simple">10.1093/bioinformatics/14.9.755</ext-link></comment> <object-id pub-id-type="pmid">9918945</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Barrett</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hughey</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Karplus</surname> <given-names>K</given-names></name>. <article-title>Scoring hidden Markov models</article-title>. <source>Comput Appl Biosci</source>. <year>1997</year>;<volume>13</volume>: <fpage>191</fpage>–<lpage>199</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/13.2.191" xlink:type="simple">10.1093/bioinformatics/13.2.191</ext-link></comment> <object-id pub-id-type="pmid">9146967</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Madera</surname> <given-names>M</given-names></name>. <article-title>Profile Comparer: a program for scoring and aligning profile hidden Markov models</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>: <fpage>2630</fpage>–<lpage>2631</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btn504" xlink:type="simple">10.1093/bioinformatics/btn504</ext-link></comment> <object-id pub-id-type="pmid">18845584</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Söding</surname> <given-names>J</given-names></name>. <article-title>Protein homology detection by HMM-HMM comparison</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>: <fpage>951</fpage>–<lpage>960</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bti125" xlink:type="simple">10.1093/bioinformatics/bti125</ext-link></comment> <object-id pub-id-type="pmid">15531603</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sadreyev</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Grishin</surname> <given-names>N</given-names></name>. <article-title>COMPASS: A Tool for Comparison of Multiple Protein Alignments with Assessment of Statistical Significance</article-title>. <source>Journal of Molecular Biology</source>. <year>2003</year>;<volume>326</volume>: <fpage>317</fpage>–<lpage>336</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0022-2836(02)01371-2" xlink:type="simple">10.1016/S0022-2836(02)01371-2</ext-link></comment> <object-id pub-id-type="pmid">12547212</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Altschul</surname> <given-names>SF</given-names></name>, <name name-style="western"><surname>Wootton</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Zaslavsky</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>Y-K</given-names></name>. <article-title>The Construction and Use of Log-Odds Substitution Scores for Multiple Sequence Alignment</article-title>. <source>PLoS Comput Biol</source>. <year>2010</year>;<volume>6</volume>: <fpage>e1000852</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000852" xlink:type="simple">10.1371/journal.pcbi.1000852</ext-link></comment> <object-id pub-id-type="pmid">20657661</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Haussler</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Krogh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mian</surname> <given-names>IS</given-names></name>, <name name-style="western"><surname>Sjolander</surname> <given-names>K</given-names></name>. <article-title>Protein modeling using hidden Markov models: analysis of globins</article-title>. <source>System Sciences, 1993, Proceeding of the Twenty-Sixth Hawaii International Conference on</source>. <year>1993</year>. pp. <fpage>792</fpage>–<lpage>802</lpage> vol.<volume>1</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/HICSS.1993.270611" xlink:type="simple">10.1109/HICSS.1993.270611</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004509.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Punta</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Coggill</surname> <given-names>PC</given-names></name>, <name name-style="western"><surname>Eberhardt</surname> <given-names>RY</given-names></name>, <name name-style="western"><surname>Mistry</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Tate</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Boursnell</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>The Pfam protein families database</article-title>. <source>Nucleic Acids Research</source>. <year>2011</year>;<volume>40</volume>: <fpage>D290</fpage>–<lpage>D301</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr1065" xlink:type="simple">10.1093/nar/gkr1065</ext-link></comment> <object-id pub-id-type="pmid">22127870</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Krogh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mian</surname> <given-names>IS</given-names></name>, <name name-style="western"><surname>Sjölander</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Haussler</surname> <given-names>D</given-names></name>. <article-title>Hidden Markov Models in Computational Biology : Applications to Protein Modeling</article-title>. <source>J Mol Biol</source>. <year>1994</year>;<volume>235</volume>: <fpage>1501</fpage>–<lpage>1531</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jmbi.1994.1104" xlink:type="simple">10.1006/jmbi.1994.1104</ext-link></comment> <object-id pub-id-type="pmid">8107089</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Pethica</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Talbot</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Vogel</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Madera</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>SUPERFAMILY—sophisticated comparative genomics, data mining, visualization and phylogeny</article-title>. <source>Nucl Acids Res</source>. <year>2009</year>;<volume>37</volume>: <fpage>D380</fpage>–<lpage>386</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkn762" xlink:type="simple">10.1093/nar/gkn762</ext-link></comment> <object-id pub-id-type="pmid">19036790</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Letunic</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Doerks</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Bork</surname> <given-names>P</given-names></name>. <article-title>SMART 6: recent updates and new developments</article-title>. <source>Nucl Acids Res</source>. <year>2009</year>;<volume>37</volume>: <fpage>D229</fpage>–<lpage>232</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkn808" xlink:type="simple">10.1093/nar/gkn808</ext-link></comment> <object-id pub-id-type="pmid">18978020</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name>. <article-title>Accelerated Profile HMM Searches</article-title>. <source>PLoS Comput Biol</source>. <year>2011</year>;<volume>7</volume>: <fpage>e1002195</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002195" xlink:type="simple">10.1371/journal.pcbi.1002195</ext-link></comment> <object-id pub-id-type="pmid">22039361</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name>. <article-title>A Probabilistic Model of Local Sequence Alignment That Simplifies Statistical Significance Estimation</article-title>. <source>PLoS Comput Biol</source>. <year>2008</year>;<volume>4</volume>: <fpage>e1000069</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000069" xlink:type="simple">10.1371/journal.pcbi.1000069</ext-link></comment> <object-id pub-id-type="pmid">18516236</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chen</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Mackey</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Jr</surname> <given-names>CJS</given-names></name>, <name name-style="western"><surname>Roos</surname> <given-names>DS</given-names></name>. <article-title>OrthoMCL-DB: querying a comprehensive multi-species collection of ortholog groups</article-title>. <source>Nucleic Acids Res</source>. <year>2006</year>;<volume>34</volume>: <fpage>D363</fpage>–<lpage>D368</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkj123" xlink:type="simple">10.1093/nar/gkj123</ext-link></comment> <object-id pub-id-type="pmid">16381887</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sonnhammer</surname> <given-names>ELL</given-names></name>, <name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Durbin</surname> <given-names>R</given-names></name>. <article-title>Pfam: A comprehensive database of protein domain families based on seed alignments</article-title>. <source>Proteins: Structure, Function, and Genetics</source>. <year>1997</year>;<volume>28</volume>: <fpage>405</fpage>–<lpage>420</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/(SICI)1097-0134(199707)28:3&lt;405::AID-PROT10&gt;3.0.CO;2-L" xlink:type="simple">10.1002/(SICI)1097-0134(199707)28:3&lt;405::AID-PROT10&gt;3.0.CO;2-L</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004509.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benjamini</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hochberg</surname> <given-names>Y</given-names></name>. <article-title>Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source>. <year>1995</year>;<volume>57</volume>: <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004509.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Storey</surname> <given-names>JD</given-names></name>. <article-title>A direct approach to false discovery rates</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2002</year>;<volume>64</volume>: <fpage>479</fpage>–<lpage>498</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/1467-9868.00346" xlink:type="simple">10.1111/1467-9868.00346</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004509.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Efron</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Storey</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Tusher</surname> <given-names>V</given-names></name>. <article-title>Empirical Bayes Analysis of a Microarray Experiment</article-title>. <source>Journal of the American Statistical Association</source>. <year>2001</year>;<volume>96</volume>: <fpage>1151</fpage>–<lpage>1160</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/016214501753382129" xlink:type="simple">10.1198/016214501753382129</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004509.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Glivenko</surname> <given-names>V</given-names></name>. <article-title>Sulla determinazione empirica della legge di probabilita</article-title>. <source>Giorn Ist Ital Attuari</source>. <year>1933</year>;<volume>4</volume>: <fpage>92</fpage>–<lpage>99</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004509.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cantelli</surname> <given-names>FP</given-names></name>. <article-title>Sulla determinazione empirica delle leggi di probabilita</article-title>. <source>Giorn Ist Ital Attuari</source>. <year>1933</year>;<volume>4</volume>: <fpage>221</fpage>–<lpage>424</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004509.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Storey</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>R</given-names></name>. <article-title>Statistical significance for genomewide studies</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2003</year>;<volume>100</volume>: <fpage>9440</fpage>–<lpage>9445</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1530509100" xlink:type="simple">10.1073/pnas.1530509100</ext-link></comment> <object-id pub-id-type="pmid">12883005</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sun</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Cai</surname> <given-names>TT</given-names></name>. <article-title>Oracle and Adaptive Compound Decision Rules for False Discovery Rate Control</article-title>. <source>Journal of the American Statistical Association</source>. <year>2007</year>;<volume>102</volume>: <fpage>901</fpage>–<lpage>912</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/016214507000000545" xlink:type="simple">10.1198/016214507000000545</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004509.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schork</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Thompson</surname> <given-names>WK</given-names></name>, <name name-style="western"><surname>Pham</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Torkamani</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Roddey</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Sullivan</surname> <given-names>PF</given-names></name>, <etal>et al</etal>. <article-title>All SNPs Are Not Created Equal: Genome-Wide Association Studies Reveal a Consistent Pattern of Enrichment among Functionally Annotated SNPs</article-title>. <source>PLoS Genet</source>. <year>2013</year>;<volume>9</volume>: <fpage>e1003449</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1003449" xlink:type="simple">10.1371/journal.pgen.1003449</ext-link></comment> <object-id pub-id-type="pmid">23637621</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Keller</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Nesvizhskii</surname> <given-names>AI</given-names></name>, <name name-style="western"><surname>Kolker</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Aebersold</surname> <given-names>R</given-names></name>. <article-title>Empirical statistical model to estimate the accuracy of peptide identifications made by MS/MS and database search</article-title>. <source>Anal Chem</source>. <year>2002</year>;<volume>74</volume>: <fpage>5383</fpage>–<lpage>5392</lpage>. <object-id pub-id-type="pmid">12403597</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Käll</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Storey</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>MacCoss</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Noble</surname> <given-names>WS</given-names></name>. <article-title>Assigning Significance to Peptides Identified by Tandem Mass Spectrometry Using Decoy Databases</article-title>. <source>J Proteome Res</source>. <year>2008</year>;<volume>7</volume>: <fpage>29</fpage>–<lpage>34</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/pr700600n" xlink:type="simple">10.1021/pr700600n</ext-link></comment> <object-id pub-id-type="pmid">18067246</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Käll</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Storey</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>MacCoss</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Noble</surname> <given-names>WS</given-names></name>. <article-title>Posterior error probabilities and false discovery rates: two sides of the same coin</article-title>. <source>J Proteome Res</source>. <year>2008</year>;<volume>7</volume>: <fpage>40</fpage>–<lpage>44</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/pr700739d" xlink:type="simple">10.1021/pr700739d</ext-link></comment> <object-id pub-id-type="pmid">18052118</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Choi</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Nesvizhskii</surname> <given-names>AI</given-names></name>. <article-title>Semisupervised model-based validation of peptide identifications in mass spectrometry-based proteomics</article-title>. <source>J Proteome Res</source>. <year>2008</year>;<volume>7</volume>: <fpage>254</fpage>–<lpage>265</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/pr070542g" xlink:type="simple">10.1021/pr070542g</ext-link></comment> <object-id pub-id-type="pmid">18159924</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Choi</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ghosh</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Nesvizhskii</surname> <given-names>AI</given-names></name>. <article-title>Statistical validation of peptide identifications in large-scale proteomics using the target-decoy database search strategy and flexible mixture modeling</article-title>. <source>J Proteome Res</source>. <year>2008</year>;<volume>7</volume>: <fpage>286</fpage>–<lpage>292</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/pr7006818" xlink:type="simple">10.1021/pr7006818</ext-link></comment> <object-id pub-id-type="pmid">18078310</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><collab xlink:type="simple">The UniProt Consortium</collab>. <article-title>Reorganizing the protein space at the Universal Protein Resource (UniProt)</article-title>. <source>Nucleic Acids Research</source>. <year>2011</year>; <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr981" xlink:type="simple">10.1093/nar/gkr981</ext-link></comment> <object-id pub-id-type="pmid">22102590</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Efron</surname> <given-names>B</given-names></name>. <article-title>Simultaneous inference: When should hypothesis testing problems be combined?</article-title> <source>Ann Appl Stat</source>. <year>2008</year>;<volume>2</volume>: <fpage>197</fpage>–<lpage>223</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/07-AOAS141" xlink:type="simple">10.1214/07-AOAS141</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004509.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cai</surname> <given-names>TT</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>W</given-names></name>. <article-title>Simultaneous Testing of Grouped Hypotheses: Finding Needles in Multiple Haystacks</article-title>. <source>Journal of the American Statistical Association</source>. <year>2009</year>;<volume>104</volume>: <fpage>1467</fpage>–<lpage>1481</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/jasa.2009.tm08415" xlink:type="simple">10.1198/jasa.2009.tm08415</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004509.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hu</surname> <given-names>JX</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>HH</given-names></name>. <article-title>False Discovery Rate Control With Groups</article-title>. <source>J Am Stat Assoc</source>. <year>2010</year>;<volume>105</volume>: <fpage>1215</fpage>–<lpage>1227</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/jasa.2010.tm09329" xlink:type="simple">10.1198/jasa.2010.tm09329</ext-link></comment> <object-id pub-id-type="pmid">21931466</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref039"><label>39</label><mixed-citation publication-type="other" xlink:type="simple">Zou J, Hong G, Zheng J, Hao C, Wang J, Guo Z. Evaluating FDR and stratified FDR control approaches for high-throughput biological studies. 2012 IEEE Symposium on Robotics and Applications (ISRA). 2012. pp. 684–686. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/ISRA.2012.6219282" xlink:type="simple">10.1109/ISRA.2012.6219282</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004509.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sun</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Craiu</surname> <given-names>RV</given-names></name>, <name name-style="western"><surname>Paterson</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Bull</surname> <given-names>SB</given-names></name>. <article-title>Stratified false discovery control for large-scale hypothesis testing with application to genome-wide association studies</article-title>. <source>Genetic Epidemiology</source>. <year>2006</year>;<volume>30</volume>: <fpage>519</fpage>–<lpage>530</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/gepi.20164" xlink:type="simple">10.1002/gepi.20164</ext-link></comment> <object-id pub-id-type="pmid">16800000</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lange</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Watanabe</surname> <given-names>RM</given-names></name>. <article-title>Prioritized Subset Analysis: Improving Power in Genome-wide Association Studies</article-title>. <source>Hum Hered</source>. <year>2007</year>;<volume>65</volume>: <fpage>129</fpage>–<lpage>141</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1159/000109730" xlink:type="simple">10.1159/000109730</ext-link></comment> <object-id pub-id-type="pmid">17934316</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref042"><label>42</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Storey</surname> <given-names>JD</given-names></name>. <chapter-title>False Discovery Rate</chapter-title>. In: <name name-style="western"><surname>Lovric</surname> <given-names>M</given-names></name>, editor. <source>International Encyclopedia of Statistical Science</source>. <publisher-name>Springer Berlin</publisher-name> <publisher-loc>Heidelberg</publisher-loc>; <year>2014</year>. pp. <fpage>504</fpage>–<lpage>508</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://link.springer.com/referenceworkentry/10.1007/978-3-642-04898-2_248" xlink:type="simple">http://link.springer.com/referenceworkentry/10.1007/978-3-642-04898-2_248</ext-link></mixed-citation></ref>
<ref id="pcbi.1004509.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Storey</surname> <given-names>JD</given-names></name>. <article-title>The positive false discovery rate: a Bayesian interpretation and the q-value</article-title>. <source>Ann Statist</source>. <year>2003</year>;<volume>31</volume>: <fpage>2013</fpage>–<lpage>2035</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/aos/1074290335" xlink:type="simple">10.1214/aos/1074290335</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004509.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Storey</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Taylor</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Siegmund</surname> <given-names>D</given-names></name>. <article-title>Strong control, conservative point estimation and simultaneous conservative consistency of false discovery rates: a unified approach</article-title>. <source>Journal of the Royal Statistical Society Series B</source>. <year>2004</year>;<volume>66</volume>: <fpage>187</fpage>–<lpage>205</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1467-9868.2004.00439.x" xlink:type="simple">10.1111/j.1467-9868.2004.00439.x</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004509.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Strimmer</surname> <given-names>K</given-names></name>. <article-title>A unified approach to false discovery rate estimation</article-title>. <source>BMC Bioinformatics</source>. <year>2008</year>;<volume>9</volume>: <fpage>303</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-9-303" xlink:type="simple">10.1186/1471-2105-9-303</ext-link></comment> <object-id pub-id-type="pmid">18613966</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mistry</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Finn</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Bateman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Punta</surname> <given-names>M</given-names></name>. <article-title>Challenges in homology search: HMMER3 and convergent evolution of coiled-coil regions</article-title>. <source>Nucl Acids Res</source>. <year>2013</year>;<volume>41</volume>: <fpage>e121</fpage>–<lpage>e121</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt263" xlink:type="simple">10.1093/nar/gkt263</ext-link></comment> <object-id pub-id-type="pmid">23598997</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Terrapon</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Gascuel</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Marechal</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Brehelin</surname> <given-names>L</given-names></name>. <article-title>Fitting hidden Markov models of protein domains to a target species: application to Plasmodium falciparum</article-title>. <source>BMC Bioinformatics</source>. <year>2012</year>;<volume>13</volume>: <fpage>67</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-13-67" xlink:type="simple">10.1186/1471-2105-13-67</ext-link></comment> <object-id pub-id-type="pmid">22548871</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ochoa</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Llinás</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Singh</surname> <given-names>M</given-names></name>. <article-title>Using context to improve protein domain identification</article-title>. <source>BMC Bioinformatics</source>. <year>2011</year>;<volume>12</volume>: <fpage>90</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-12-90" xlink:type="simple">10.1186/1471-2105-12-90</ext-link></comment> <object-id pub-id-type="pmid">21453511</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Karplus</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Karchin</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Shackelford</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Hughey</surname> <given-names>R</given-names></name>. <article-title>Calibrating E-values for hidden Markov models using reverse-sequence null models</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>: <fpage>4107</fpage>–<lpage>4115</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bti629" xlink:type="simple">10.1093/bioinformatics/bti629</ext-link></comment> <object-id pub-id-type="pmid">16123115</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ashburner</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ball</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Blake</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Botstein</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Butler</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Cherry</surname> <given-names>JM</given-names></name>, <etal>et al</etal>. <article-title>Gene Ontology: tool for the unification of biology</article-title>. <source>Nat Genet</source>. <year>2000</year>;<volume>25</volume>: <fpage>25</fpage>–<lpage>29</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/75556" xlink:type="simple">10.1038/75556</ext-link></comment> <object-id pub-id-type="pmid">10802651</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Forslund</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sonnhammer</surname> <given-names>ELL</given-names></name>. <article-title>Predicting protein function from domain content</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>: <fpage>1681</fpage>–<lpage>1687</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btn312" xlink:type="simple">10.1093/bioinformatics/btn312</ext-link></comment> <object-id pub-id-type="pmid">18591194</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Terrapon</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Gascuel</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Marechal</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Brehelin</surname> <given-names>L</given-names></name>. <article-title>Detection of new protein domains using co-occurrence: application to Plasmodium falciparum</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>: <fpage>3077</fpage>–<lpage>3083</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp560" xlink:type="simple">10.1093/bioinformatics/btp560</ext-link></comment> <object-id pub-id-type="pmid">19786484</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wheeler</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Clements</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Hubley</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Jurka</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Dfam: a database of repetitive DNA based on profile hidden Markov models</article-title>. <source>Nucleic Acids Research</source>. <year>2012</year>;<volume>41</volume>: <fpage>D70</fpage>–<lpage>D82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gks1265" xlink:type="simple">10.1093/nar/gks1265</ext-link></comment> <object-id pub-id-type="pmid">23203985</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rackham</surname> <given-names>OJL</given-names></name>, <name name-style="western"><surname>Madera</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Armstrong</surname> <given-names>CT</given-names></name>, <name name-style="western"><surname>Vincent</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Woolfson</surname> <given-names>DN</given-names></name>, <name name-style="western"><surname>Gough</surname> <given-names>J</given-names></name>. <article-title>The Evolution and Structure Prediction of Coiled Coils across All Genomes</article-title>. <source>Journal of Molecular Biology</source>. <year>2010</year>;<volume>403</volume>: <fpage>480</fpage>–<lpage>493</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jmb.2010.08.032" xlink:type="simple">10.1016/j.jmb.2010.08.032</ext-link></comment> <object-id pub-id-type="pmid">20813113</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wong W-</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Maurer-Stroh</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Eisenhaber</surname> <given-names>F</given-names></name>. <article-title>More Than 1,001 Problems with Protein Domain Databases: Transmembrane Regions, Signal Peptides and the Issue of Sequence Homology</article-title>. <source>PLoS Comput Biol</source>. <year>2010</year>;<volume>6</volume>: <fpage>e1000867</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000867" xlink:type="simple">10.1371/journal.pcbi.1000867</ext-link></comment> <object-id pub-id-type="pmid">20686689</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wong</surname> <given-names>W-C</given-names></name>, <name name-style="western"><surname>Maurer-Stroh</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schneider</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Eisenhaber</surname> <given-names>F</given-names></name>. <article-title>Transmembrane Helix: Simple or Complex</article-title>. <source>Nucl Acids Res</source>. <year>2012</year>; <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gks379" xlink:type="simple">10.1093/nar/gks379</ext-link></comment> <object-id pub-id-type="pmid">22564899</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref057"><label>57</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hartmann</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Guthöhrlein</surname> <given-names>EW</given-names></name>, <name name-style="western"><surname>Siebert</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Luehr</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Söding</surname> <given-names>J</given-names></name>. <article-title>P-value-based regulatory motif discovery using positional weight matrices</article-title>. <source>Genome Res</source>. <year>2013</year>;<volume>23</volume>: <fpage>181</fpage>–<lpage>194</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.139881.112" xlink:type="simple">10.1101/gr.139881.112</ext-link></comment> <object-id pub-id-type="pmid">22990209</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref058"><label>58</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Apic</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gough</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Teichmann</surname> <given-names>SA</given-names></name>. <article-title>Domain combinations in archaeal, eubacterial and eukaryotic proteomes</article-title>. <source>Journal of Molecular Biology</source>. <year>2001</year>;<volume>310</volume>: <fpage>311</fpage>–<lpage>325</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jmbi.2001.4776" xlink:type="simple">10.1006/jmbi.2001.4776</ext-link></comment> <object-id pub-id-type="pmid">11428892</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref059"><label>59</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bourne</surname> <given-names>PE</given-names></name>. <article-title>The Evolutionary History of Protein Domains Viewed by Species Phylogeny</article-title>. <source>PLoS ONE</source>. <year>2009</year>;<volume>4</volume>: <fpage>e8378</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0008378" xlink:type="simple">10.1371/journal.pone.0008378</ext-link></comment> <object-id pub-id-type="pmid">20041107</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref060"><label>60</label><mixed-citation publication-type="other" xlink:type="simple">Eddy SR. HMMER3 is stubborn. In: Cryptogenomicon [Internet]. 19 Sep 2011 [cited 4 Jan 2013]. Available: <ext-link ext-link-type="uri" xlink:href="http://selab.janelia.org/people/eddys/blog/?p=508" xlink:type="simple">http://selab.janelia.org/people/eddys/blog/?p=508</ext-link></mixed-citation></ref>
<ref id="pcbi.1004509.ref061"><label>61</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yeats</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Redfern</surname> <given-names>OC</given-names></name>, <name name-style="western"><surname>Orengo</surname> <given-names>C</given-names></name>. <article-title>A fast and automated solution for accurately resolving protein domain architectures</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>: <fpage>745</fpage>–<lpage>751</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq034" xlink:type="simple">10.1093/bioinformatics/btq034</ext-link></comment> <object-id pub-id-type="pmid">20118117</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref062"><label>62</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McDonnell</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>Jiang</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Keating</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Berger</surname> <given-names>B</given-names></name>. <article-title>Paircoil2: Improved Prediction of Coiled Coils from Sequence</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>: <fpage>356</fpage>–<lpage>358</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bti797" xlink:type="simple">10.1093/bioinformatics/bti797</ext-link></comment> <object-id pub-id-type="pmid">16317077</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref063"><label>63</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Krogh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Larsson</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>von Heijne</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Sonnhammer</surname> <given-names>ELL</given-names></name>. <article-title>Predicting transmembrane protein topology with a hidden markov model: application to complete genomes</article-title>. <source>Journal of Molecular Biology</source>. <year>2001</year>;<volume>305</volume>: <fpage>567</fpage>–<lpage>580</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jmbi.2000.4315" xlink:type="simple">10.1006/jmbi.2000.4315</ext-link></comment> <object-id pub-id-type="pmid">11152613</object-id></mixed-citation></ref>
<ref id="pcbi.1004509.ref064"><label>64</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wootton</surname> <given-names>JC</given-names></name>. <article-title>Non-globular domains in protein sequences: Automated segmentation using complexity measures</article-title>. <source>Computers &amp; Chemistry</source>. <year>1994</year>;<volume>18</volume>: <fpage>269</fpage>–<lpage>285</lpage>.<object-id pub-id-type="pmid">7952898</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>