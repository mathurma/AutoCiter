<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1007243</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01745</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Surgical and invasive medical procedures</subject><subj-group><subject>Biopsy</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cell processes</subject><subj-group><subject>Cell death</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cell processes</subject><subj-group><subject>Cell cycle and cell division</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Mutation</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Oncology</subject><subj-group><subject>Carcinogenesis</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genetic loci</subject><subj-group><subject>Alleles</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Spatially constrained tumour growth affects the patterns of clonal selection and neutral drift in cancer genomic data</article-title>
<alt-title alt-title-type="running-head">Spatial tumour growth affects the patterns of selection and drift in cancer genomic data</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Chkhaidze</surname>
<given-names>Ketevan</given-names>
</name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1386-7469</contrib-id>
<name name-style="western">
<surname>Heide</surname>
<given-names>Timon</given-names>
</name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Werner</surname>
<given-names>Benjamin</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Williams</surname>
<given-names>Marc J.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Huang</surname>
<given-names>Weini</given-names>
</name>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4240-3265</contrib-id>
<name name-style="western">
<surname>Caravagna</surname>
<given-names>Giulio</given-names>
</name>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9582-1597</contrib-id>
<name name-style="western">
<surname>Graham</surname>
<given-names>Trevor A.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6709-9533</contrib-id>
<name name-style="western">
<surname>Sottoriva</surname>
<given-names>Andrea</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Evolutionary Genomics and Modelling Lab, Centre for Evolution and Cancer, The Institute of Cancer Research, London, United Kingdom</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Evolution and Cancer Lab, Barts Cancer Institute, Queen Mary University of London, London, United Kingdom</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Reiter</surname>
<given-names>Johannes</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Stanford University School of Medicine, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">t.graham@qmul.ac.uk</email> (TAG); <email xlink:type="simple">andrea.sottoriva@icr.ac.uk</email> (AS)</corresp>
</author-notes>
<pub-date pub-type="epub">
<day>29</day>
<month>7</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="collection">
<month>7</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>7</issue>
<elocation-id>e1007243</elocation-id>
<history>
<date date-type="received">
<day>18</day>
<month>10</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>5</day>
<month>7</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Chkhaidze et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1007243"/>
<abstract>
<p>Quantification of the effect of spatial tumour sampling on the patterns of mutations detected in next-generation sequencing data is largely lacking. Here we use a spatial stochastic cellular automaton model of tumour growth that accounts for somatic mutations, selection, drift and spatial constraints, to simulate multi-region sequencing data derived from spatial sampling of a neoplasm. We show that the spatial structure of a solid cancer has a major impact on the detection of clonal selection and genetic drift from both bulk and single-cell sequencing data. Our results indicate that spatial constrains can introduce significant sampling biases when performing multi-region bulk sampling and that such bias becomes a major confounding factor for the measurement of the evolutionary dynamics of human tumours. We also propose a statistical inference framework that incorporates spatial effects within a growing tumour and so represents a further step forwards in the inference of evolutionary dynamics from genomic data. Our analysis shows that measuring cancer evolution using next-generation sequencing while accounting for the numerous confounding factors remains challenging. However, mechanistic model-based approaches have the potential to capture the sources of noise and better interpret the data.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Sequencing the DNA of cancer cells from human tumours has become one of the main tools to study cancer biology. However, sequencing data are complex and often difficult to interpret. In particular, the way in which the tissue is sampled and the data are collected impact the interpretation of the results significantly. We argue that understanding cancer genomic data requires mechanistic mathematical and computational models that tell us what we expect the data to look like, with the aim of understanding the impact of confounding factors and biases in the data generation step. In this study, we develop a spatial computational model of tumour growth that also simulates the data generation process, and demonstrate that biases in the sampling step and current technological limitations severely impact the interpretation of the results. We then provide a statistical framework that can be used to start overcoming these biases and more robustly measure aspects of the biology of tumours from the data.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000289</institution-id>
<institution>Cancer Research UK</institution>
</institution-wrap>
</funding-source>
<award-id>A22909</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6709-9533</contrib-id>
<name name-style="western">
<surname>Sottoriva</surname>
<given-names>Andrea</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000289</institution-id>
<institution>Cancer Research UK</institution>
</institution-wrap>
</funding-source>
<award-id>A19771</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9582-1597</contrib-id>
<name name-style="western">
<surname>Graham</surname>
<given-names>Trevor A.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100004440</institution-id>
<institution>Wellcome Trust</institution>
</institution-wrap>
</funding-source>
<award-id>202778/B/16/Z</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6709-9533</contrib-id>
<name name-style="western">
<surname>Sottoriva</surname>
<given-names>Andrea</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100004440</institution-id>
<institution>Wellcome Trust</institution>
</institution-wrap>
</funding-source>
<award-id>202778/Z/16/Z</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9582-1597</contrib-id>
<name name-style="western">
<surname>Graham</surname>
<given-names>Trevor A.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100004440</institution-id>
<institution>Wellcome Trust</institution>
</institution-wrap>
</funding-source>
<award-id>105104/Z/14/Z</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6709-9533</contrib-id>
<name name-style="western">
<surname>Sottoriva</surname>
<given-names>Andrea</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award006">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000265</institution-id>
<institution>Medical Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>MR/P000789/1</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6709-9533</contrib-id>
<name name-style="western">
<surname>Sottoriva</surname>
<given-names>Andrea</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This study has been supported by Medical Research Council funding to AS (MR/P000789/1). AS is also supported by the Wellcome Trust (202778/B/16/Z) and Cancer Research UK (A22909). TAG is supported by the Wellcome Trust (202778/Z/16/Z) and Cancer Research UK (A19771). We acknowledge funding from the National Institute of Health (NCI U54 CA217376) to TAG and AS. This work was also supported by a Wellcome Trust award to the Centre for Evolution and Cancer (105104/Z/14/Z). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="0"/>
<page-count count="26"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-08-08</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All simulation code is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/kchkhaidze/CHESS.cpp" xlink:type="simple">https://github.com/kchkhaidze/CHESS.cpp</ext-link>. All simulation data are available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/kchkhaidze/chkhaidze_et_al_2019_figures" xlink:type="simple">https://github.com/kchkhaidze/chkhaidze_et_al_2019_figures</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Cancer is an evolutionary process fuelled by genomic instability and intra-tumour heterogeneity (ITH) [<xref ref-type="bibr" rid="pcbi.1007243.ref001">1</xref>]. ITH leads to therapy resistance, arguably the biggest problem in cancer treatment today [<xref ref-type="bibr" rid="pcbi.1007243.ref002">2</xref>]. Recently, seminal studies have attempted to quantify ITH by either looking at subclonal mutations in deep sequencing data from single bulk samples [<xref ref-type="bibr" rid="pcbi.1007243.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref004">4</xref>], or by taking multiple samples of the same tumour, the so-called multi-region sequencing approach (reviewed in [<xref ref-type="bibr" rid="pcbi.1007243.ref005">5</xref>]). Phylogenetic approaches are then used to reconstruct the ancestral history of cancer cell lineages [<xref ref-type="bibr" rid="pcbi.1007243.ref006">6</xref>]. However, one important difference between phylogenetic analyses in cancer and classical phylogenetic analyses of species is that each cancer sample is not a single individual, but a mixture of different cancer cell subpopulations and non-cancer cells [<xref ref-type="bibr" rid="pcbi.1007243.ref007">7</xref>].</p>
<p>The problem is usually tackled by performing subclonal deconvolution of the samples to separate the different subpopulations [<xref ref-type="bibr" rid="pcbi.1007243.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref008">8</xref>]. However, these approaches do not account for the spatio-temporal dynamics that generated the data. To study the evolutionary dynamics of individual tumours, mathematical and computational models of evolutionary processes are widely employed [<xref ref-type="bibr" rid="pcbi.1007243.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1007243.ref012">12</xref>]. Many of these models are rooted in theoretical population genetics, a field that quantifies the evolution of alleles in populations and that is central to the modern evolutionary synthesis [<xref ref-type="bibr" rid="pcbi.1007243.ref013">13</xref>]. More recently, spatial models have also been used [<xref ref-type="bibr" rid="pcbi.1007243.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1007243.ref023">23</xref>]. However, seldom have mathematical and computational models of cancer evolution been directly connected to next-generation sequencing data from human tumours. Recent work from us and others has shown that combining theoretical modelling and cancer genomic data allows for measurement of fundamental properties of the tumour evolutionary process <italic>in vivo</italic>, such as mutation rates and strength and onset of subclonal selection events [<xref ref-type="bibr" rid="pcbi.1007243.ref022">22</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref024">24</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref025">25</xref>].</p>
<p>Here, we study how spatial constrains of a growing tumour impact our ability to infer cancer evolutionary dynamics. We combine explicit spatial evolutionary modelling with synthetic generation of multi-region bulk and single-cell data, thus providing a generative framework in which we know the evolutionary trajectories of all cells in a tumour and can examine the genomic patterns that emerge from the sampling experiment. We show that spatial constrains, stochastic spatial growth and sampling biases can have unexpected effects that confound both the interpretation and inference of the perceived evolutionary dynamics from cancer sequencing data. We also present a statistical inference framework that begins to account for some of these confounding factors and recover aspects of the cancer evolutionary dynamics from various types of multi-region sequencing data as well as single-cell data.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Simulating spatial tumour growth, sampling and data generation</title>
<p>Here we develop and analyse a stochastic spatial cellular automaton model of tumour growth that incorporates cell division, cell death, random mutations and clonal selection (Material and Methods). Each tumour simulation starts with a single ‘transformed’ cell in the centre of either a 2D or a 3D lattice, and we model the resulting expansion of this first cancer cell. All events, such as cell proliferation, death, mutation and selection are modelled according to a Gillespie algorithm [<xref ref-type="bibr" rid="pcbi.1007243.ref026">26</xref>]. In our model we account for different spatial constraints that are parameterised within our simulation. In order for a cell to divide, a new empty space for its progeny is required within the 8 neighbouring cells if we consider a 2D grid with Von Neumann neighbourhood. If no empty space is present, a cell can generate a new space by pushing neighbouring cells outwards (choosing a random direction of the push). In this scenario, the growth is ‘homogeneous’ and all cells in the neoplasm can divide (<xref ref-type="fig" rid="pcbi.1007243.g001">Fig 1A and 1B</xref>). Because all cells in the tumour can divide, this scenario leads to an overall exponential expansion (<xref ref-type="supplementary-material" rid="pcbi.1007243.s001">S1A and S1B Fig</xref>). At some point during the simulation (<xref ref-type="fig" rid="pcbi.1007243.g001">Fig 1A–1D</xref>), within the original tumour population (blue cells), we introduce a new mutant (a new subclone–red cells) which may or may not have a selective advantage. In the case of a neutral subclone (no selective advantage), the mutant cells proliferate as all the other cells (<xref ref-type="fig" rid="pcbi.1007243.g001">Fig 1A</xref>). We note that in this case, colouring a new subclone in red at a certain point during neutral growth is arbitrary, and equivalent to the marking of a lineage by a random neutral (passenger) mutation. In the case where the subclone has a fitness advantage, the mutant will, on average, grow more rapidly compared to the parental background clone, thus increasing in relative proportion over time (<xref ref-type="fig" rid="pcbi.1007243.g001">Fig 1B</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007243.s001">S1B Fig</xref>).</p>
<fig id="pcbi.1007243.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007243.g001</object-id>
<label>Fig 1</label>
<caption>
<title>A spatial tumour growth model that simulates sequencing data.</title>
<p>In our model we introduce a mutant at a given time t (blue = background clone; red = mutant subclone; shade is proportional to the number of generations the cell has gone through). <bold>(A)</bold> The new mutant subclone can have no fitness advantage (mutation is a passenger), giving rise to a neutrally growing neoplasm, or <bold>(B)</bold> have a fitness advantage s&gt;0 with respect to the background population (mutation is a driver), giving rise to differential selection in the tumour population. In addition, cells accumulate unique passenger mutations during each cell division. <bold>(C)</bold> In some tumours, it is likely that only cells close to the tumour border are able to proliferate due to the abundance of resources and space. We simulate this in our model as boundary driven growth, which gives rise to complex radial patterns. <bold>(D)</bold> When boundary driven growth is combined with selection, spatial effect can either amplify the growth of the new subclone, as in this exemplary case, or even decrease the effects of selection if the subclone, by chance, gets imprisoned behind the growing front. <bold>(E)</bold> In our simulation we also model the raising and spread of point mutations in the genome of cancer cells (all passengers and, when subclone is selective, one additional driver). We can simulate the sampling of punch biopsies (squares), needle biopsies (thin stripes) and single cells. <bold>(F)</bold> By simulating the noise and measurement errors of next-generation sequencing, we can generate synthetic realistic variant allele frequency distributions from the spatial simulations. <bold>(G)</bold> Single-cell data can also be simulated, in this case clearly showing the presence of a selected subclone demonstrated by the clade of “red” cells with a recent common ancestor.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.g001" xlink:type="simple"/>
</fig>
<p>We also model ‘boundary driven’ growth, where only cells that are sufficiently close to the border of the tumour can proliferate. Other cells may remain ‘imprisoned’ in the centre of the tumour unable to proliferate because of the lack of empty space around them. Boundary-driven growth has been observed experimentally [<xref ref-type="bibr" rid="pcbi.1007243.ref027">27</xref>–<xref ref-type="bibr" rid="pcbi.1007243.ref029">29</xref>] as well as in model systems [<xref ref-type="bibr" rid="pcbi.1007243.ref030">30</xref>]. The magnitude of this effect is controlled in our simulation with the parameter <italic>a</italic>, which considers cell location and defines the probability that a cell will push neighbouring cells to create empty spots depending on how far is the cell from the boundary (see <xref ref-type="sec" rid="sec009">Materials and Methods</xref>). Boundary driven growth leads to a polynomial expansion (<xref ref-type="supplementary-material" rid="pcbi.1007243.s001">S1C Fig</xref>). Importantly, in both the case of neutral mutants (<xref ref-type="fig" rid="pcbi.1007243.g001">Fig 1C</xref>) and selected mutants (<xref ref-type="fig" rid="pcbi.1007243.g001">Fig 1D</xref>), the spatial distribution of mutant cells in this scenario is strongly affected by the spatial constraints.</p>
<p>At each division, a cell has a certain probability to acquire additional somatic mutations, modelled with a Poisson distribution, with mean <italic>u</italic>, in line with many other previous models [<xref ref-type="bibr" rid="pcbi.1007243.ref011">11</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref024">24</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref025">25</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref031">31</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref032">32</xref>]. Notably, <italic>u</italic> is the average number of new somatic mutations per division for the whole genome of a single cell. We assume that both daughter cells can acquire mutations, that mutations are unique (infinite site model) and we neglect back mutations (infinite allele model). Finally, the large majority of mutations are assumed to be passengers (neutral), with a few driver alterations allowing for subclonal fitness advantages (e.g. subclonal populations in <xref ref-type="fig" rid="pcbi.1007243.g001">Fig 1B and 1D</xref>). This is consistent with large-scale genomic sequencing studies indicating that in any given tumour, the number of driver events is generally small, while the number of passengers is often orders of magnitude larger [<xref ref-type="bibr" rid="pcbi.1007243.ref031">31</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref033">33</xref>].</p>
<p>Importantly, our spatial model of tumour growth allows for the simulation of tissue sampling and genomic data generation. For instance, we can simulate the collection of punch biopsies, where spatially localised chunks of tumour are collected (<xref ref-type="fig" rid="pcbi.1007243.g001">Fig 1E</xref>). We can also simulate needle biopsies, where a long and thin piece of tissue is sampled (<xref ref-type="fig" rid="pcbi.1007243.g001">Fig 1E</xref>). We can then simulate the genomic data generation process starting from the cells in the sample and the identification of somatic mutations. For example, we can simulate the sequencing at a given coverage using Binomial sampling of the alleles, the limits of low frequency mutation detection (e.g. minimum number of reads with a variant, minimum coverage), as well as non-uniformity of coverage leading to over-dispersion of the variant allele frequency (VAF) of detected mutations. This allows generating realistic data from simulated tumours, e.g. in the case of the simulation of a diploid tumour with one selected subclone in <xref ref-type="fig" rid="pcbi.1007243.g001">Fig 1E</xref>, all needles and punch biopsies contained clonal mutations, shown as a cluster of variants around VAF = 0.5 (<xref ref-type="fig" rid="pcbi.1007243.g001">Fig 1F</xref>), and in the case of punch biopsy 1 and needle biopsy 4, also a subclonal cluster representing the growing subclone.</p>
<p>We previously showed, using a non-spatial stochastic branching process model of tumour growth, that assuming a well-mixed population and exponential growth, the expected VAF distribution of subclonal mutations in cancer under neutral growth follows a power-law with a <italic>1/f</italic><sup><italic>2</italic></sup> scaling behaviour, where <italic>f</italic> is the variant allele frequency of subclonal mutations [<xref ref-type="bibr" rid="pcbi.1007243.ref024">24</xref>]. This has been previously demonstrated to be the scaling solution of the fully stochastic Luria-Delbruck model [<xref ref-type="bibr" rid="pcbi.1007243.ref034">34</xref>–<xref ref-type="bibr" rid="pcbi.1007243.ref036">36</xref>]. The 1/f<sub>2</sub>-like neutral subclonal tail can be observed in all samples of <xref ref-type="fig" rid="pcbi.1007243.g001">Fig 1F</xref>. In the presence of subclonal selection, we expect to observe an additional subclonal ‘cluster’ of mutations all at the same frequency [<xref ref-type="bibr" rid="pcbi.1007243.ref003">3</xref>], that are the passenger mutations hitchhiking in the expanding clone (as we previously described [<xref ref-type="bibr" rid="pcbi.1007243.ref025">25</xref>]). This is exemplified in needle 4 and punch 1 in <xref ref-type="fig" rid="pcbi.1007243.g001">Fig 1F</xref>. We note that a 1/f<sub>2</sub>-like tail remains in the VAF frequency spectrum of all samples, as a consequence of within-clone neutral dynamics that remain on-going throughout the tumour’s growth [<xref ref-type="bibr" rid="pcbi.1007243.ref025">25</xref>]. Furthermore, our framework allows simulating single-cell data. For example, from the simulated tumour in <xref ref-type="fig" rid="pcbi.1007243.g001">Fig 1B</xref> we sample individual cells at random and simulate single-cell whole-genome sequencing (<xref ref-type="fig" rid="pcbi.1007243.g001">Fig 1G</xref>).</p>
</sec>
<sec id="sec004">
<title>Spatial effects on bulk sequencing data</title>
<p>For each representative simulation of spatial constraints in <xref ref-type="fig" rid="pcbi.1007243.g001">Fig 1</xref>, we modelled the sampling of 6 punch biopsies (small square regions), 2 needle biopsies (long and thin regions), as well as hypothetically sampling the whole tumour. From each sample, we simulated the generation of 100x depth whole-genome data (see <xref ref-type="sec" rid="sec009">Materials and Methods</xref> for details about the sequencing noise model). <xref ref-type="fig" rid="pcbi.1007243.g002">Fig 2A</xref> shows the variant allele frequency (VAF) distributions of samples from the neutral homogeneous growth case in <xref ref-type="fig" rid="pcbi.1007243.g001">Fig 1A</xref>, with clonal mutations (truncal) in grey, subclonal mutations exclusive to the parental background clone in light blue and subclonal mutations within the mutant in pink. All samples show the characteristic 1/f<sup>2</sup> distribution corresponding to neutral evolutionary dynamics [<xref ref-type="bibr" rid="pcbi.1007243.ref024">24</xref>], as one would expect theoretically [<xref ref-type="bibr" rid="pcbi.1007243.ref034">34</xref>]. The Area Under the Curve (AUC) test for neutrality we previously proposed [<xref ref-type="bibr" rid="pcbi.1007243.ref025">25</xref>] (p&lt;0.05 means neutrality is rejected) is reported on top of each VAF plot and shows that even in the presence of a spatial structure, homogeneous (exponential) neutral growth follows a 1/f<sup>2</sup> distribution (<xref ref-type="fig" rid="pcbi.1007243.g002">Fig 2A-i</xref> to <xref ref-type="fig" rid="pcbi.1007243.g002">2A-iv</xref>). As we have shown previously, it is possible to recover the mutation rate per cell doubling from the ~1/f<sup>2</sup> neutral tail, which in this case without cell death was 10 mutations per division (~10<sup>−9</sup> mutations/bp/division). This was correctly recovered in all samples from <xref ref-type="fig" rid="pcbi.1007243.g002">Fig 2A</xref> (recovered mutation rate reported in each plot as <italic>u</italic>).</p>
<fig id="pcbi.1007243.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007243.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Variant allele frequency distributions of punch and needle biopsies from representative scenarios.</title>
<p><bold>(A)</bold> In the illustrative example of neutral homogeneous growth, a neutral mutant was introduced at generation time t = 4 with a selection coefficient of s = 0 (neutral) and homogeneous growth (a = 1). The mutation rate was u = 10. Tumour was simulated until ~100K cells. From the final tumour, we sampled 6 punch biopsies (1–6), 2 needle biopsies (7–8) and a “whole-tumour” sample, and simulated 100× whole-genome sequencing data. VAF distributions of each sample are shown (i-iv). <bold>(B)</bold> In this case, a differentially selected subclone with s = 3 was introduced at time t = 8 in a homogeneous growth scenario (a = 1) and u = 10. Final population size was ~80K cells. In those samples where both the background and the mutant subclone were present (i and iv), the VAF distribution showed evidence of subclonal selection, with a subclonal cluster (purple) generated by mutations in the selected subclone that hitchhiked to high frequency due to selection. <bold>(C)</bold> In the case of neutral boundary driven growth, a new (neutral) mutant was introduced at t = 4 with s = 1 and boundary driven growth parameter a = 0.025. Even though the tumour grew neutrally, the spatial effects of boundary driven growth led to deviations from the neutral expected null under homogeneous growth. Moreover, clusters in the VAF spectrum are detectable in iii, where sampling bias produced an over-representation of a lineage that was not due to selection. <bold>(D)</bold> Boundary driven growth with selection (mutant introduced at t = 8 with s = 2 and a = 0.025) produced even more complex patterns of drift and sampling bias. The data represents tumour simulations in 2D space. Birth rate b is 1 in all simulation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.g002" xlink:type="simple"/>
</fig>
<p>In the case of homogeneous growth with subclonal selection (<xref ref-type="fig" rid="pcbi.1007243.g002">Fig 2B</xref>), neutrality could be rejected based in all those samples containing a mix of the background clone and the new subclone (<xref ref-type="fig" rid="pcbi.1007243.g002">Fig 2B-i and 2B-iv</xref>, see subclonal cluster in purple). Specifically, needle 4 and punch 1 showed the expected signature of selection, with a subclonal cluster a consequence of the over-representation of passenger mutations in the expanded clone [<xref ref-type="bibr" rid="pcbi.1007243.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref025">25</xref>]. The 1/f<sup>2</sup>-like tail resulting from the within-clone accumulation of passenger mutations remains in the frequency spectrum [<xref ref-type="bibr" rid="pcbi.1007243.ref025">25</xref>]. Specifically, in the plots in <xref ref-type="fig" rid="pcbi.1007243.g002">Fig 2B</xref> we report the mutations that were present in the first subclone cell in purple. Those are mutations that increased in frequency by hitchhiking on the selected mutant. Importantly, we note that these mutations are not exclusive to the subclone but are also found in other lineages (e.g. in the ‘cousins’ of the selected subclone). The same dynamics are observed if it is the death rate to decrease, rather than the birth rate to increase (<xref ref-type="supplementary-material" rid="pcbi.1007243.s002">S2A and S2B Fig</xref>). Importantly, the cell death <italic>d</italic> not only increases the rate of genetic drift, as expected, but also the level of clonal intermixing due to the additional stochasticity introduced by high cell replacement (<xref ref-type="supplementary-material" rid="pcbi.1007243.s002">S2C–S2F Fig</xref>, examples of neutral cases). Selection could not be detected in other spatially-distinct samples from the same tumour when they did not contain differentially selected populations, and either captured only the background clone (blue) or only the selected mutant (red) (<xref ref-type="fig" rid="pcbi.1007243.g002">Fig 2B-ii and 2B-ii</xref>). This is correct as in those samples ITH is neutral.</p>
<p>This initial spatial analysis produced similar results to our previous well-mixed non-spatial models [<xref ref-type="bibr" rid="pcbi.1007243.ref024">24</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref025">25</xref>]. We next investigated the effect of boundary driven growth. Here, only cells close to the borders grow, leaving other cells ‘imprisoned’ inside the tumour mass (see <xref ref-type="sec" rid="sec009">Materials and Methods</xref> for details), a pattern called <italic>gene surfing</italic> that causes radial patterns of cells growing only at the front of the expanding wave (<xref ref-type="fig" rid="pcbi.1007243.g002">Fig 2C</xref>). This has been previously documented both theoretically and experimentally in bacteria [<xref ref-type="bibr" rid="pcbi.1007243.ref037">37</xref>], in mathematical models of tumour growth [<xref ref-type="bibr" rid="pcbi.1007243.ref016">16</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref017">17</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref038">38</xref>], as well as in cancer model systems, where the neutral expansion of the cancer cell population under boundary driven growth led to lineages growing just because they were ‘lucky’ to be in the right place at the right time [<xref ref-type="bibr" rid="pcbi.1007243.ref029">29</xref>]. This has implications for the impact of the immune system during the evolution of a tumour, which exert a negative selection pressure on the cancer cell population through neoantigen recognition and removal [<xref ref-type="bibr" rid="pcbi.1007243.ref039">39</xref>], especially because neoantigen recognition is clone size dependent [<xref ref-type="bibr" rid="pcbi.1007243.ref040">40</xref>]. Importantly, boundary driven growth leads to non-exponential population dynamics [<xref ref-type="bibr" rid="pcbi.1007243.ref027">27</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref028">28</xref>] that also impact the distribution of mutations between the centre and the periphery of a solid neoplasm, as shown in a case of liver cancer sampled at high resolution [<xref ref-type="bibr" rid="pcbi.1007243.ref041">41</xref>]. The accumulation of subclonal mutations in a neutrally expanding tumour under boundary driven growth is expected to follow a 1/f<sup>2</sup> scaling form within most of the detectable frequency range (f&gt;5%), although at low frequency deviations are expected [<xref ref-type="bibr" rid="pcbi.1007243.ref037">37</xref>]. This is largely driven by the increasing difference in mutational burden between the centre and the border of the tumour, which could lead to rejection of the standard neutral expectation under exponential growth, as seen when the whole tumour is sampled with respect to when only a localised bulk/needle biopsy is collected (<xref ref-type="fig" rid="pcbi.1007243.g002">Fig 2C</xref>).</p>
<p>Because the population is no longer homogeneously distributed however, this can lead to significant spatial bias, causing over- or under-representation of mutations in the VAF distributions solely due to spatial effects and not because of selection. This causes deviations from the neutral expectation of the mutant allele distributions that risk being wrongly interpreted as the consequence of on-going subclonal selection, as in <xref ref-type="fig" rid="pcbi.1007243.g002">Fig 2C</xref>. In this scenario, we know that subclonal clusters (e.g. punch 6 in <xref ref-type="fig" rid="pcbi.1007243.g002">Fig 2C-iii</xref>) are not differentially selected subclones, but the over-representation of alleles is solely induced by the spatial structure. Furthermore, even when we observe distributions that appear to follow the neutral expectation (AUC p&gt;0.05), boundary driven growth results in much higher mutational loads than would be expected in the well mixed case. Here our inferred mutation rates are up to 10 times higher than the ground truth. This can be observed more explicitly in <xref ref-type="supplementary-material" rid="pcbi.1007243.s003">S3 Fig</xref>, where we sample each representative tumour from the centre towards the periphery by taking samples along concentric circles (<xref ref-type="supplementary-material" rid="pcbi.1007243.s003">S3A Fig</xref>) and compare the mutational loads of the samples (<xref ref-type="supplementary-material" rid="pcbi.1007243.s003">S3B Fig</xref>). This was indeed observed in a case of neutrally growing liver cancer [<xref ref-type="bibr" rid="pcbi.1007243.ref041">41</xref>] and a similar phenomenon is also observed in species evolution [<xref ref-type="bibr" rid="pcbi.1007243.ref042">42</xref>].</p>
<p>If we combine boundary driven growth and subclonal selection the situation is further complicated: selective effects are now modulated by spatial constraints. In some cases, the selected mutant emerges and remains directly at the front of tumour growth. In this scenario the outgrowth caused by its selective advantage is amplified further just because it occurred at the growing front (<xref ref-type="fig" rid="pcbi.1007243.g002">Fig 2D</xref>). In other cases, the selected mutant may, by chance, remain ‘imprisoned’ within the tumour (assuming the mechanism of selective advantage is unable to overcome this spatial entrapment) and stops proliferating despite its selective advantage (e.g. <xref ref-type="supplementary-material" rid="pcbi.1007243.s004">S4 Fig</xref>). In both these cases, further sampling biases occur. In the case of punch 5 for example (<xref ref-type="fig" rid="pcbi.1007243.g002">Fig 2D-iii</xref>), where the new subclone is fixed (clone fraction = 100%), there is an overrepresentation of a cluster of mutations that is only due to spatial drift and not selection. These dynamics are recapitulated in larger cohorts of simulated tumours with the same parameters (<xref ref-type="supplementary-material" rid="pcbi.1007243.s005">S5 Fig</xref>). The distributions of p-values for the AUC measurements for all simulations for different modes of growth are illustrated in <xref ref-type="supplementary-material" rid="pcbi.1007243.s006">S6A Fig</xref>. This figure shows that neutrality is accepted in the majority of homogeneous cases without selection, and it is rejected in the majority of homogeneous cases with selection. In the case of boundary driven growth things are more complicated. In <xref ref-type="supplementary-material" rid="pcbi.1007243.s006">S6B Fig</xref> we show the AUC tests for neutrality applied to whole-tumour samples versus punch/needle biopsies. In the case of neutral boundary driven growth, neutrality is accepted in the majority of cases when we use localised punch/needle biopsies, but rejected when the whole-tumour sample is examined. This is due to the deviation from strict neutrality caused by boundary driven growth, that can be detected only when a large region of the tumour is sampled (and hence differences between centre and periphery of the tumour are captured). In the case of selective boundary driven growth, we observe similar dynamics but with the ability of rejecting neutrality if differential selection of the growing subclone is captured within the punch/needle sample. We note that under selective boundary driven growth, the subclone often remains imprisoned, leading to neutral-like dynamics. Similar dynamics to <xref ref-type="fig" rid="pcbi.1007243.g002">Fig 2B</xref> are observed when positive selection is modelled as the probability of growing in the absence of space (increased pushing probability parameter <italic>a</italic>) rather than the increased birth rate. This leads to dynamics dominated by the homogeneous growth of the subclone rather than boundary growth of the background clone (<xref ref-type="supplementary-material" rid="pcbi.1007243.s007">S7 Fig</xref>). Moreover, removal of the majority of cells (99%) by treatment leads to enhancement of outgrowth of selected clones due to competitive release (<xref ref-type="supplementary-material" rid="pcbi.1007243.s008">S8</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007243.s009">S9</xref> Figs).</p>
<p>We then looked at the pairwise VAF distributions between samples. The amount of subclonal mutations scattered through the frequency spectrum (<xref ref-type="fig" rid="pcbi.1007243.g003">Fig 3</xref>) and the number of subclonal clusters due to sampling bias and spatial drift was significant (e.g. <xref ref-type="fig" rid="pcbi.1007243.g003">Fig 3D</xref>). As per ground truth, only the dark purple mutations should show a subclonal clustering pattern (e.g. <xref ref-type="fig" rid="pcbi.1007243.g003">Fig 3B</xref>, punch 1). We found that scattered variants were mostly due to the effect of neutral lineages spreading in space, and then subsampled in different ways in each tumour region. In the case of boundary driven growth, sampling bias produces evident clusters that do not correspond to differently selected subclones in the tumour. This makes the reconstruction of the true clonal phylogeny and its evolutionary interpretation problematic.</p>
<fig id="pcbi.1007243.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007243.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Sample vs sample scatterplots of mutations.</title>
<p>For each of the representative cases: <bold>(A)</bold> neutral homogeneous, <bold>(B)</bold> selective homogeneous, <bold>(C)</bold> neutral boundary driven, <bold>(D)</bold> selective boundary driven, we report the scatterplots of somatic mutations in selected samples. Clearly, the presence of passenger subclonal mutations in the neutral tail of growing clones that spread in space as the tumour grows produces scattered variants (e.g. A). Even more striking is the formation of subclonal clusters of mutations particularly in the presence of boundary driven growth (e.g. C, D) where some lineages are over-represented not because of differential selection, but because of sampling bias and spatial drift.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>Spatial effects on single-cell sequencing</title>
<p>Most of the confounding factors we have described so far result from the limitations of bulk sequencing, where the genomes of many cells are convolved within samples. Single-cell sequencing does not suffer from this particular limitation and promises high-resolution cancer evolutionary analysis devoid of the drawbacks of bulk sequencing [<xref ref-type="bibr" rid="pcbi.1007243.ref043">43</xref>].</p>
<p>To examine the effect of single cell sequencing, we simulated whole-genome sequencing of 10 single cells taken at random from the tumour and reconstructed their phylogenetic relationship (<xref ref-type="fig" rid="pcbi.1007243.g004">Fig 4A-i</xref>). For the neutral cases (<xref ref-type="fig" rid="pcbi.1007243.g004">Fig 4A and 4C</xref>), the patterns are consistent with a typical 'balanced' neutral tree, wherein all lineages contribute roughly equally to the final cell populations. In a balanced tree, the average distance between the trunk and each leaf of the tree is similar in each lineage. In cases with selection (<xref ref-type="fig" rid="pcbi.1007243.g004">Fig 4B-i and 4D-i</xref>), the selected subclonal lineages are over-represented on the tree (as reflected in VAF distributions), as the red lineage is introduced at time t = 8 and would have been much smaller if it was not selected for. Here the average distance between trunk and any leaf is different in the background vs the new clone. The pattern is even clearer if we sample 400 single cells and performed WGS (<xref ref-type="fig" rid="pcbi.1007243.g004">Fig 4B-ii and 4D-ii</xref>). We note that if we use randomly sampled single cell sequencing and plot the site frequency spectrum (frequency distribution of mutations within the population of sampled cells) we recapitulate the VAF distribution, including subclonal clusters and 1/f<sup>2</sup> tails (<xref ref-type="supplementary-material" rid="pcbi.1007243.s010">S10 Fig</xref>). This is because the site-frequency spectra derived from single-cell sequencing data corresponds to a VAF distribution.</p>
<fig id="pcbi.1007243.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007243.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Single-cell sequencing data from spatial tumour simulations.</title>
<p><bold>(A)</bold> From each representative scenario we sampled 10 single-cells at random (i) as well as 400 single-cells at random (ii) and performed synthetic whole-genome sequencing. In both homogeneous <bold>(A)</bold> and boundary driven growth <bold>(C)</bold>, single-cell sequencing significantly reduces the sampling bias that we found in bulk samples and the only overrepresented lineages were due to selection <bold>(B, D)</bold>. However, due to the currently high error rate of single-cell sequencing, several studies rely on single-cell genotyping using mutations found in bulks. We simulated this by genotyping on 400 single-cells the mutations found at VAF&gt;5% in needle biopsy 8 of each tumour (iii). The resulting trees are hard to interpret in terms of the clonal phylogeny due to the bias in the selection of variants to be genotyped.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.g004" xlink:type="simple"/>
</fig>
<p>However, as whole-genome mutational profiling of single cells is still difficult due to allele dropout [<xref ref-type="bibr" rid="pcbi.1007243.ref044">44</xref>], often single-cell genotyping has to be performed instead [<xref ref-type="bibr" rid="pcbi.1007243.ref045">45</xref>]. In this approach, a bulk sample is sequenced and all mutations in that bulk sample are then tested in single cells for presence/absence of the mutation. Integrating bulk sequencing with single-cell information is extremely powerful [<xref ref-type="bibr" rid="pcbi.1007243.ref046">46</xref>], but requires careful interpretation of the results. In <xref ref-type="fig" rid="pcbi.1007243.g004">Fig 4A-iii</xref> we show that this approach, although informative, can lead to very distorted phylogenetic trees where branch lengths are heavily biased by the initial choice of mutations to be assayed, and consequently the signature of selection vs neutrality is not readily identifiable from these data alone.</p>
<p>Moreover, significant sampling bias is still apparent for single-cell sequencing when individual cells are not sampled uniformly at random from the whole tumour, but instead isolated in ‘clumps’ from different bulk samples. In <xref ref-type="fig" rid="pcbi.1007243.g005">Fig 5</xref> we have simulated the collection of 4 single cells from each of the 6 punch biopsies in <xref ref-type="fig" rid="pcbi.1007243.g002">Fig 2</xref> (these are the same simulations used to generate <xref ref-type="fig" rid="pcbi.1007243.g004">Fig 4</xref>). The trees are quite different from those sampled in <xref ref-type="fig" rid="pcbi.1007243.g004">Fig 4</xref> and moreover, it is interesting to see how the underlying patterns of growth are reflected in the mixing of cells from different bulks. For instance, homogeneous growth leads to very high intermixing of cells in different bulks, whereas boundary driven growth tends to spatially segregate bulks. We have quantified the level of intermixing for different modes of growth in all our simulation cohort, highlighting this pattern (<xref ref-type="supplementary-material" rid="pcbi.1007243.s011">S11 Fig</xref>). We have observed these patterns in real data from carcinomas vs adenomas, where carcinomas were characterised by clonal intermixing, but adenomas were not [<xref ref-type="bibr" rid="pcbi.1007243.ref047">47</xref>]. Similar patterns of intermixing have also been found more recently using single-cell seeded organoid sequencing [<xref ref-type="bibr" rid="pcbi.1007243.ref048">48</xref>].</p>
<fig id="pcbi.1007243.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007243.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Biases of single-cell sequencing when cells are taken from spatially separated bulk samples.</title>
<p>Whereas taking N random cells from a tumour highly reduces sampling bias, this is often not how single-cell from neoplasms are sampled. Often first small chunks of the tumour are dissected and then single-cells are isolated from those. <bold>(A)</bold> neutral homogeneous, <bold>(B)</bold> selective homogeneous, <bold>(C)</bold> neutral boundary driven, <bold>(D)</bold> selective boundary driven. For each of our representative examples, we simulated this type of sampling and show how this impacts severely on the phylogenetic tree and patterns of clonal intermixing. In particular, single-cell sampling from bulks alters the detected phylogenetic relationship of the cells because, since groups of cells come from spatially segregated regions, those appear more closely related than expected by chance. This is an important source of sampling bias that needs to be considered when analysing single-cell phylogenies. Cells coming from the ‘red’ mutant subclone are highlighted in the red shaded box.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec006">
<title>Resolving spatial effects with inference</title>
<p>The spatial effects of drift and sampling bias one can observe are remarkable and represent a major challenge for the correct subclonal reconstruction of tumours growing in three-dimensional space. Due to the inherent complexity, analytical solutions to this problem that take space into the account remain challenging, although some attempts to tackle this difficult question are being undertaken [<xref ref-type="bibr" rid="pcbi.1007243.ref049">49</xref>]. Understanding the complex impact of spatially growing cell populations on the actual genomic data requires an approach based on computational simulations.</p>
<p>Here we devise a statistical inference framework, similar in spirit to what we previously proposed for well mixed populations [<xref ref-type="bibr" rid="pcbi.1007243.ref025">25</xref>], that aims at recovering the evolutionary parameters of each individual tumour from the type of data we have discussed so far (see <xref ref-type="sec" rid="sec009">Materials and Methods</xref> for details). We constructed a test-set of 34 synthetic tumours simulated with different parameters (see <xref ref-type="supplementary-material" rid="pcbi.1007243.s016">S1 Table</xref>) and assessed the error in recovering the parameters used to generate these tumours after statistical inference with an Approximate Bayesian Computation–Sampling Monte Carlo (ABC-SMC) approach [<xref ref-type="bibr" rid="pcbi.1007243.ref025">25</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref050">50</xref>–<xref ref-type="bibr" rid="pcbi.1007243.ref052">52</xref>]. The details of the inference algorithm are detailed in Material and Methods. We used approximately one million simulation instances to perform parameter inference using priors in <xref ref-type="supplementary-material" rid="pcbi.1007243.s017">S2 Table</xref>. We were particularly interested in comparing the accuracy provided by the different spatial sampling methods in recovery evolutionary dynamics. We studied three different sets of tumours. In the first set, we investigated parameter recovery in tumours with homogeneous (exponential) growth, with and without selection but with no cell death. In the second set, we added stochastic cell death as an additional factor. In the third set, we studied cases of boundary driven growth where we also examined our ability to recover the extent of the boundary driven parameter <italic>a</italic>. In all three sets, we studied the differences in the ability to recover parameter if we used a single bulk sample of the whole tumour multi-region punch biopsies, multi-region needle biopsies or single-cell sequencing. Following the inference of the parameters, we calculate the percentage error for each parameter as a difference between the true parameter value and inferred parameter value (mode of a parameter posterior distribution) scaled by the true parameter value. Then we plot the distributions of the percentage errors for each parameter per growth model and sampling strategy in <xref ref-type="fig" rid="pcbi.1007243.g006">Fig 6</xref>.</p>
<fig id="pcbi.1007243.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007243.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Statistical inference framework to recover evolutionary parameters.</title>
<p>We combined our model with a statistical inference framework (Approximate Bayesian Computation–Sequential Monte Carlo) in order to infer the evolutionary parameters of selection and growth from the data. We tested this framework on 34 synthetic (target) tumours for which we generated genomic data. Our of these 34 target cases, 13 were characterised by homogeneous growth with no cell death <bold>(A, Set 1)</bold>, 11 were homogeneous but with cell death <bold>(B, Set 2)</bold>, and 10 where characterised by boundary driven growth <bold>(C, Set 3)</bold>, see all parameters in <xref ref-type="supplementary-material" rid="pcbi.1007243.s016">S1 Table</xref>. We tested the ability to recovery parameters of 4 different sampling schemes: punch samples, needle biopsies, single cell phylogenetic trees and whole-tumour sampling (see <xref ref-type="sec" rid="sec009">Materials and Methods</xref> for details). We report the percentage error of the inference (true parameter value–inferred value based on the mode of the posterior probability) for each parameter and scenario. See prior parameter ranges in <xref ref-type="supplementary-material" rid="pcbi.1007243.s017">S2 Table</xref>. <bold>(D)</bold> For the homogeneous stochastic cell death scenario (Set 2), we also report the error in recovering the death rate parameter d. <bold>(E)</bold> For the boundary driven growth scenario we report the error in recovering boundary driven growth parameter a (Set 3).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.g006" xlink:type="simple"/>
</fig>
<p>Not surprisingly, the scenario with exponential homogeneous growth without cell death was the one where the evolutionary parameters were the easiest to recover because spatial constrains were limited and the number of unknown parameters lowest (<xref ref-type="fig" rid="pcbi.1007243.g006">Fig 6A–6C</xref>, “Set 1”). In particular, the percentage-error in recovering the mutation rate <italic>u</italic> was particularly low, especially using single-cell sequencing (<xref ref-type="fig" rid="pcbi.1007243.g006">Fig 6A</xref>, “Set 1”). The mean percent error of the parameters <italic>t</italic> (Gillespie time when a new mutant is introduced) and <italic>s</italic> (selective coefficient of the new mutant), in the case of homogeneous growth were also within 20% and overall agrees with our previous observations in well-mixed populations [<xref ref-type="bibr" rid="pcbi.1007243.ref025">25</xref>]. The presence of stochastic cell death, even within a homogeneously growing tumour, introduced significant spatial and sampling biases (spatial drift) that led to a higher error in the recovery of the parameters (<xref ref-type="fig" rid="pcbi.1007243.g006">Fig 6A–6C</xref>, “Set 2”). Furthermore, some of the evolutionary parameters became unidentifiable (mutation and death rate). In this scenario, the best sampling strategies to recovery the death parameter <italic>d</italic> were single-cell sequencing or whole-tumour sequencing, reflecting the need to collect large population of cells for the correct estimation of this parameter (<xref ref-type="fig" rid="pcbi.1007243.g006">Fig 6D</xref>). Boundary driven growth also introduced significant biases that led to higher percent-error values in the recovered parameters (<xref ref-type="fig" rid="pcbi.1007243.g006">Fig 6A–6C</xref>, “Set 3”). Here, single-cell sequencing was best in recovering the boundary driven growth parameter <italic>a</italic> (<xref ref-type="fig" rid="pcbi.1007243.g006">Fig 6E</xref>). See <xref ref-type="supplementary-material" rid="pcbi.1007243.s012">S12 Fig</xref> for summary statistics from the simulations in <xref ref-type="fig" rid="pcbi.1007243.g006">Fig 6</xref>. The full posterior distributions of each parameter in each context is reported in <xref ref-type="supplementary-material" rid="pcbi.1007243.s013">S13 Fig</xref>. Parameter dependency in the inference of <italic>t</italic> and <italic>s</italic> combinations is reported in <xref ref-type="supplementary-material" rid="pcbi.1007243.s014">S14 Fig</xref>. We performed the same inference approach but with 3-dimensionally growing tumours using a test set of a single simulated ‘target’ tumour and inferred the parameters using approximately 10 million simulated cancers and found similar results (<xref ref-type="supplementary-material" rid="pcbi.1007243.s015">S15 Fig</xref>). We do recognise that for complex scenarios that are heavily affected by spatial constrains, such as boundary driven growth, inferred parameter values still suffer from high uncertainty in our ABC framework. This suggests the need for further model development and generation of higher resolution data for high confidence estimation of evolutionary parameters in cancer.</p>
</sec>
</sec>
<sec id="sec007" sec-type="conclusions">
<title>Discussion</title>
<p>It is now widely accepted that tumour growth is governed by evolutionary principles. Thus, recovering the evolutionary histories of tumours is essential to the understanding patient-specific tumour growth and treatment response. However, these analyses are inevitably based on limited information due to sampling biases, noise of known and unknown nature, lack of time resolved data amongst many others. Despite these limitations, many approaches based on single sampling, multi-region bulk profiling, or single cell sequencing have been developed. Information from such data is often derived using purely statistical bioinformatics methods such as clustering analyses, without consideration of the confounding underlying influence of the cellular mechanics of tumour growth. Here we explicitly investigated spatial effects on the evolutionary interpretation of typical multi-region sequencing data of tumours. We found that the effects of sampling bias and spatial distributions of spatially intermixed cell populations critically depend on the mode of tumour growth as well as the details of the underlying sampling and data generation procedure. Most surprisingly, we could observe clusters of over-represented alleles in the VAF distribution of some tumour samples that were indistinguishable from positively selected subclonal populations, despite emerging solely due to the spatial distribution of cells. Such clusters vary depending on how one samples a tumour, and would therefore cause a major challenge for the evolutionary interpretation of cancer genomic data based on subclonal reconstruction.</p>
<p>We furthermore presented a Bayesian inference framework to recover evolutionary parameters from our spatial distributions. Evolutionary parameters such as strength of selection or mutation rates may be important surrogate measurements of evolvability, and hence linked to progression and treatment resistance, as it has been demonstrated for the rates of chromosomal instability [<xref ref-type="bibr" rid="pcbi.1007243.ref053">53</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref054">54</xref>]. Again, we observe that our ability to precisely recover certain evolutionary parameters depend on the scenarios of tumour growth and spatial sampling strategies. However, we do believe that although complex, the situation is far from hopeless. More involved statistical frameworks based on first principles of tumour growth can help resolving some of the evolutionary parameters on an individualised patient basis. Importantly, careful spatial sampling and single-cell sequencing can mitigate some of the confounding issues. We do acknowledge that our model has some important limitations, such as the infinite allele assumption (which could be violated by copy number loss [<xref ref-type="bibr" rid="pcbi.1007243.ref044">44</xref>]). We also recognise that we tested our inference framework only using our own generative model, and that despite the generative model matching the assumptions intrinsic to the inference the posterior parameter estimates still suffered from high uncertainty in some cases, reflecting the complexity of the problem. Also, for computational feasibility we mostly focus on 2D spatial analyses and of a relatively limited number of cells with respect to the billions of cells present in a human tumour. We also acknowledge that we do not offer a closed mathematical formulation for the distribution of alleles under spatial effects, which would be very useful but remains a very difficult problem that can only be tackled partially (e.g. [<xref ref-type="bibr" rid="pcbi.1007243.ref037">37</xref>]). Additionally, more realistic models of tumour growth dynamics that account for force fields between cells [<xref ref-type="bibr" rid="pcbi.1007243.ref055">55</xref>] have been developed that could improve on the study of spatial patterns of growth [<xref ref-type="bibr" rid="pcbi.1007243.ref023">23</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref056">56</xref>]. For computational feasibility, especially in regards to the necessity of performing statistical inference on the data and generate thousands of simulations, we restricted our analysis to the stochastic cellular automaton model we propose here. Nevertheless, our approach highlights the importance of spatial modelling of real data and the impact of confounding factor in our estimate and understanding of tumour evolution.</p>
<p>Importantly, future versions of the model could help guiding optimal sample collection that would minimise the spatial biases in the data. Due to the current technical limitations of these types of approaches, we are still far from direct application in the clinic. Additional effort should also be directed towards the use of measurements from other clinical data, such as imaging, where estimations of necrosis for example, can help parameterise computational models. However, we argue it remains extremely important to understand the confounding factors and spatial biases we expect to find in samples from which often we need to base clinical decisions on. Mathematical modelling of cancer evolution is a growing field with a fast expanding repertoire of models and approaches [<xref ref-type="bibr" rid="pcbi.1007243.ref011">11</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref057">57</xref>], however attention to clinical and biological relevance of modelling approaches is necessary to ensure these efforts are not dead ends.</p>
</sec>
<sec id="sec008" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec009">
<title>Details of the model</title>
<p>We developed a computational stochastic model of spatial tumour growth that allows simulating different strategies of multi-region tissue sampling followed by synthetic generation of high-throughput sequencing data. We consider tumour cells as asexually reproducing individuals that die and divide with certain pre-defined probabilities. If <italic>b</italic> is the birth rate for each cell and <italic>d</italic> the death rate, then the growth of the population over time <italic>t</italic> is:
<disp-formula id="pcbi.1007243.e001">
<alternatives>
<graphic id="pcbi.1007243.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007243.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup>
</mml:math>
</alternatives>
<label>[1]</label>
</disp-formula>
where <italic>N(t)</italic> is a population size at time <italic>t</italic>, and <italic>b-d</italic> is the net growth rate. At first, we assume that birth and death rates are constant over time, whereas the overall growth rate can vary over time due to the randomness of each birth or death event, as well as due to spatial constrains that can limit or promote cell division over time. We model spatial constraints with the boundary proliferation parameter <italic>a</italic>, which models the distance from the border of the tumour within which cells are allowed to proliferate even in the absence of space (by pushing neighbouring cells outwards). When <italic>a</italic>~1 all cells can proliferate (homogeneous growth), and their growth is equivalent to an exponential expansion. When <italic>a</italic>~0, cells can only proliferate if they have an empty space in their neighbourhood, resulting in only a small layer of cells at the tumour border being able to divide. In this case the growth curve can significantly deviate from Eq [<xref ref-type="disp-formula" rid="pcbi.1007243.e001">1</xref>].</p>
<p>In addition to cell division, we also model mutation and selection, where the latter can change birth and/or death rates. We model somatic mutations acquired by each cell after division as a Poisson random variable – Pois(<italic>u</italic>), where <italic>u</italic> is the mean mutation rate. Thus, after each cell division, a random set of new unique mutations occur in each cell of the two cells resulting from the division. The majority of these mutations are passenger mutations and hence do not affect a cell’s phenotype. However, they enable us to trace cell lineages uniquely in the final tumour. In addition, we also allow for driver mutation ‘events’ that can lead to positive selection of a subpopulation of cancer cells: a driver event conveys a fitness advantage to that particular cell and its offspring, thus allowing the lineage to increase in frequency. Since we ask what is the distribution of mutations across space, rather than the expected waiting time of driver events as previously analysed [<xref ref-type="bibr" rid="pcbi.1007243.ref058">58</xref>], we introduce a driver mutation at a fixed time in our simulations, also to make simulations comparable and computationally efficient.</p>
<p>To simulate tumour growth in space with these four stochastic events–birth, death, mutation and selection–we have used a modification of the Gillespie algorithm [<xref ref-type="bibr" rid="pcbi.1007243.ref026">26</xref>].</p>
<p>Specifically, the simulation framework works as follows:</p>
<list list-type="bullet">
<list-item><p><bold>Initialization:</bold> start with a 2D/3D grid with Von Neumann neighbourhood. Place the first tumour cell in the centre of the grid. Set time <italic>t = 0</italic>.</p></list-item>
</list>
<p>Until a cell reaches a predefined grid boundary, repeat the following steps</p>
<list list-type="order">
<list-item><p>Compute the reaction propensities according to the Gillespie algorithm. Each reaction event of birth (or death) has a functional form <italic>f</italic>(<italic>x</italic>) = <italic>kx</italic>; where <italic>x</italic> is the number of cells of type “x” (wild-type or mutant), and <italic>k</italic> is either the birth or death rate. The time of each event is obtained by sampling an exponential random variable with mean given by its propensity. The next event chosen is the one completing first (i.e., with the smallest clock value, as in the so-called next reaction method [<xref ref-type="bibr" rid="pcbi.1007243.ref026">26</xref>]). Given the event, we increment the time by its clock. Note that these time steps do not correspond to population doubling times i.e. generations; doubling times can be retrieved scaling time by a factor log(2).</p></list-item>
<list-item><p>If the next event is a cell division, we use a heuristic method to place the 2 daughter cells on the grid. We first replace the parent cell with the first daughter, and search for a suitable position to place the second daughter cell. We use a Von Neumann neighbourhood and check if any of the 8 (in 2D grid) neighbouring spots of the parent cell is empty; if one or more are, we locate the second cell in one of those spots at random. Otherwise, with a probability determined by a parameter <italic>a</italic>, we push all cells along a randomly chosen direction until we hit the grid boundary, and place the second daughter at the nearest emptied spot. With the parameter <italic>a</italic> we can model boundary driven growth, as it represents the fraction of the radius of the growing tumour where cells are allowed to proliferate; that is, <italic>a</italic> = 0.2 creates a tumour periphery of width equal to 20% of the whole tumour width in which cells are allowed to proliferate even without empty space by pushing neighbouring cells outwards (when <italic>a</italic> = 1, periphery width is 100%, every cell can always push and divide, and the tumour grows exponentially). When a cell divides, we generate passenger mutations by drawing a number from Pois(<italic>u</italic>). These mutations will be assigned to both daughter cells.</p></list-item>
<list-item><p>If the next event is cell death, we simply free the position allocated to the cell.</p></list-item>
<list-item><p>At the end of this step, we check if the clock is greater than the time of the next scheduled driver event <italic>t</italic><sub><italic>driver</italic></sub>; if it is, we convert a single wild type (WT) cell into a new mutant and increase its birth rate, or decrease its death rate. This will result in mutant cells having a proliferative advantage. To quantify the effect, we define the fitness <italic>s</italic> as: 1 + <italic>s</italic> = (<italic>birth_mutant</italic> – <italic>death_mutant</italic>)/(<italic>birth_wt</italic> – <italic>death_wt</italic>).</p></list-item>
</list>
<p><bold>Details of the data generation and error modelling.</bold> At the end of the simulation, we can collect bulk or single-cells and simulate sequencing data generation. Bulk Samples are spatially separated tumour chunks ‘cut out’ from the tumour. We model two different shapes:</p>
<list list-type="order">
<list-item><p>Squares, which are referred to in the paper as ‘punch biopsies’</p></list-item>
<list-item><p>Long thin rectangles that resemble a ‘needle biopsy’</p></list-item>
</list>
<p>A bulk sample is a set of adjacent cells from the final tumour population. Each cell has its unique ID, a position on a grid and its list of somatic mutations. From the sampled cells (in a bulk) joined list of mutations we can construct the Variant Allele Frequency (VAF) distribution as in a real sequencing experiment.</p>
<p>To construct a VAF distribution from a simulated bulk tumour sample, we mimic realistic next generation sequencing steps, specifically sequencing coverage and limits of detectability of low frequency mutations. We proceed as follows:</p>
<list list-type="order">
<list-item><p>We generate (dispersed) coverage values for the input mutations by sampling a coverage from a Poisson distribution <italic>D</italic>~<italic>Poisson</italic>(<italic>λ</italic> = <italic>Z</italic>) with mean <italic>λ</italic> equal to a desired sequencing depth.</p></list-item>
<list-item><p>Once we have sampled a depth value <italic>k</italic> for a mutation, we sample its frequency (number of reads with the variant allele) with a Binomial trial. We use <italic>f</italic>~Binomial(<italic>n</italic>,<italic>k</italic>) where <italic>n</italic> is the proportion of cells carrying this mutation in the sample.</p></list-item>
</list>
<p>This procedure guarantees that the generated read counts reflect the proportions of mutations in the simulated tumour. To model limits of detection of a mutation, after resampling a mutation, we discard it if the corresponding number of reads containing the variant allele is less than 5 (using the fixed coverage 100, which accounts for a ~0.05 minimum VAF).</p>
<p>We also performed single cell sequencing taking either random single cells across the whole tumour population, or from spatially structured biopsies (mimicking bulk tissue collection followed by single-cell isolation). We used the obtained single cells to construct maximum parsimony phylogenetic trees. In addition to single cell sequencing, we also model genotyping cells with a given list of mutations, corresponding to targeted sequencing of mutations found using e.g. exome or whole-genome sequencing. To implement this, we take one of the bulk samples as reference genotype and check for the presence of each individual mutation in a random set of 200 cells. Similarly, we use the obtained genotyped single cells to infer phylogenetic trees and check how much the genotyped trees differ from the single cell trees.</p>
</sec>
<sec id="sec010">
<title>Details of the ABC framework</title>
<p>Due to the complexity captured by our spatial model of tumour growth, we do not have explicit formulas for the stationary probabilities of the stochastic process, and hence cannot derive a likelihood function. Thus, we have to use likelihood-free methods to perform statistical inference on the parameters and compute the posterior distribution of the parameters <bold><italic>θ</italic></bold>.</p>
<p>Here we use Approximate Bayesian Computation (ABC) [<xref ref-type="bibr" rid="pcbi.1007243.ref051">51</xref>,<xref ref-type="bibr" rid="pcbi.1007243.ref059">59</xref>] to infer the parameters of our model. ABC is based on the idea of scanning a large grid of plausible values for <bold><italic>θ</italic></bold>, and simulating the model many times with such parameters. Outputs of the model are stored and compared using a predefined set of summary statistics that are initially evaluated on real data. We can then rank sets of parameters that lead to the generation of synthetic data that are close to the observed data. We can estimate a posterior distribution <italic>p</italic>(<bold><italic>θ</italic></bold>|<bold><italic>D</italic></bold>) for the model parameters <bold><italic>θ</italic>,</bold> using the available data <bold><italic>D</italic></bold> and the prior for <bold><italic>θ</italic></bold>. This method is computationally intensive, and requires running several hundred (ideally thousands or millions) simulations. In our case we have generated ~74 million simulations that we use to perform the inference step.</p>
<p>There are different approaches to implement ABC, the simplest is rejection-sampling. More advanced implementations such as ABC with Markov Chain Monte Carlo (MCMC) can result in significant increases in efficiency. In our paper we implemented a simple rejection-sampling algorithm first, and then added Monte Carlo simulation techniques to speed up convergence. The simple ABC rejection-sampling algorithm consists of the following steps:</p>
<list list-type="order">
<list-item><p>Sample parameter vector <bold><italic>θ</italic></bold> from a prior distribution <italic>p</italic>(<bold><italic>θ</italic></bold>).</p></list-item>
<list-item><p>Run the model with the given parameter set and generate the synthetic dataset</p></list-item>
<list-item><p>Evaluate the distance between the simulated dataset and the target data</p></list-item>
<list-item><p>If the distance is less than a desired threshold, accept the parameters.</p></list-item>
<list-item><p>Return to step 1 and repeat until <italic>N</italic> parameter values are accepted.</p></list-item>
</list>
<p>In this study we use uniform priors for all parameters: <italic>u</italic>~Uniform(0, 100), <italic>s</italic>,<italic>d</italic>,<italic>a</italic>~Uniform(0, 1), <italic>t</italic><sub><italic>driver</italic></sub>~Uniform(0, 15). One of the most important factors that affect the ABC outcome is the number of simulations that one can afford to run, and the summary statistics were chosen to evaluate the distance between a target and a simulated dataset. Summary statistics can be any quantitative measurement that captures the information from the multidimensional data without losing too much information. As for our distance metric, we use Euclidean and Wasserstein distances between summary statistics for different parameters as discussed below.</p>
<p>Wasserstein metric estimates the distance between probability distributions by treating each distribution as a unit amount of dirt piled up on a given metric space and calculates the minimum cost required to convert one pile into another. If <italic>x</italic> and <italic>y</italic> are two vectors we want to evaluate the distance of, first we calculate their empirical distribution functions <inline-formula id="pcbi.1007243.e002"><alternatives><graphic id="pcbi.1007243.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007243.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mi mathvariant="double-struck">l</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007243.e003"><alternatives><graphic id="pcbi.1007243.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007243.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mi mathvariant="double-struck">l</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (for weights <inline-formula id="pcbi.1007243.e004"><alternatives><graphic id="pcbi.1007243.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007243.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007243.e005"><alternatives><graphic id="pcbi.1007243.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007243.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> we took 1/<italic>m</italic> and 1/<italic>n</italic> respectively), the Wasserstein distance is defined by evaluating the following:
<disp-formula id="pcbi.1007243.e006">
<alternatives>
<graphic id="pcbi.1007243.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007243.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup>
</mml:math>
</alternatives>
</disp-formula>
where we took <italic>p = 1</italic> for our analysis. We used the R package transport (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=transport" xlink:type="simple">https://CRAN.R-project.org/package=transport</ext-link>) to implement the distance calculation.</p>
<p>We used different summary statistics for each sampling scheme. For punch, needle biopsy and the whole tumour sampling–we used the VAF distribution to compute our summary statistics. For the whole tumour VAFs, our ABC procedure was similar to the one in ref [<xref ref-type="bibr" rid="pcbi.1007243.ref025">25</xref>]. For the bulk samples, since our model implements multi-region sampling, we first evaluate the multivariate VAF distribution (which is a joint probability distribution of all sampled bulk VAFs) and then calculated the Euclidean distance between the obtained empirical probability distribution vectors:
<disp-formula id="pcbi.1007243.e007">
<alternatives>
<graphic id="pcbi.1007243.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007243.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>u</mml:mi><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo>_</mml:mo><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mo>_</mml:mo><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi><mml:mi>A</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</disp-formula></p>
<p>With single cell samples, we constructed phylogenetic trees per tumour and used different tree-based summary statistics to evaluate the distance. Since the inferred phylogenetic tree branch length is proportional to the number of unique mutations belonging to a node, we decided to compare the vectors of all branch lengths (between a simulated and target tumour trees) by computing the Wasserstein distance. For the subclone introduction time <italic>t</italic><sub><italic>driver</italic></sub>, death rate <italic>d</italic> and the boundary driven growth parameter <italic>a</italic>, we chose to compare the vectors of branching times for each node of the phylogenetic trees.</p>
<p>Due to computational costs, we are limited to run the ABC framework with a small tumour size (~100k cells) or simulate smaller datasets per inference, both of which can significantly affect the outcome. To therefore speed up our ABC framework we implemented a Sequential Monte Carlo (SMC) algorithm to increase the acceptance rate of the simple ABC rejection algorithm. Our ABC SMC algorithm uses sequential importance sampling by running several rounds of resampling around the accepted parameters (correlating the rounds), and gradually decreasing the acceptance threshold while converging to the posterior distribution. This approach significantly increases the acceptance rate of the simulated datasets [<xref ref-type="bibr" rid="pcbi.1007243.ref060">60</xref>].</p>
<p>Our implementation of the ABC SMC algorithm is as follows:</p>
<list list-type="order">
<list-item><p>Initialise the indicator to rounds <italic>r</italic> and the acceptance threshold <italic>ε</italic></p></list-item>
<list-item><p><bold><italic>If</italic></bold> <italic>r</italic> = 1
<list list-type="simple">
<list-item><label>2.1</label><p>Run the simple ABC rejection algorithm (described above).</p></list-item>
<list-item><label>2.2</label><p>Order the simulated parameters set according to their corresponding distance values.</p></list-item>
<list-item><label>2.3</label><p>Keep the top Q per cent of the parameters.</p></list-item>
</list></p></list-item>
<list-item><p><bold><italic>Else</italic></bold>
<list list-type="simple">
<list-item><label>3.1</label><p>Sample next particle <italic>θ</italic> = (<italic>u</italic>,<italic>t</italic>,<italic>s</italic>,<italic>d</italic>,<italic>a</italic>) from the accepted set of parameters from round <italic>r</italic> − 1 with weights <italic>W</italic><sub><italic>r</italic>−1</sub>.</p></list-item>
<list-item><label>3.2</label><p>Perturb each sampled parameter <italic>p</italic><sub><italic>i</italic></sub> using uniform perturbation kernel <italic>K</italic> = <italic>Unif</italic>(<italic>p</italic><sub><italic>i</italic></sub> − <italic>σ</italic>,<italic>p</italic><sub><italic>i</italic></sub> + <italic>σ</italic>), where <inline-formula id="pcbi.1007243.e008"><alternatives><graphic id="pcbi.1007243.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007243.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>.</p></list-item>
<list-item><label>3.3</label><p><bold><italic>If</italic></bold> <italic>π</italic>(<italic>θ</italic>) &gt; 0, keep <italic>θ</italic></p>
<p><bold><italic>Else</italic></bold> go to step 3.2.</p></list-item>
<list-item><label>3.4</label><p>Simulate data from the model using the sampled particle <italic>θ</italic>.</p></list-item>
<list-item><label>3.5</label><p>Calculate distance D between the target and the simulated data.</p></list-item>
<list-item><label>3.6</label><p><bold><italic>If</italic></bold> <italic>D</italic> &lt; <italic>ε</italic>, keep <italic>θ</italic></p>
<p><bold><italic>Else</italic></bold> go to step 3.1.</p></list-item>
</list></p></list-item>
<list-item><p>Calculate the weights for all accepted particles 1 ≤ <italic>j</italic> ≤ <italic>N</italic>:
<list list-type="simple">
<list-item><label>4.1</label><p><bold><italic>If</italic></bold> <italic>r</italic> = 1, set <italic>W</italic><sub>(<italic>j</italic>,<italic>r</italic>)</sub> = 1</p></list-item>
<list-item><label>4.2</label><p><bold>Else</bold>
<disp-formula id="pcbi.1007243.e009">
<alternatives>
<graphic id="pcbi.1007243.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007243.e009" xlink:type="simple"/>
<mml:math display="block" id="M9">
<mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>π</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mi>K</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
</disp-formula></p></list-item>
</list></p></list-item>
<list-item><p>Update the threshold <italic>ε</italic> to the top Q-th percentile of the accepted particles.</p></list-item>
<list-item><p>Repeat until <italic>ε</italic> is less than a desired convergence threshold.</p></list-item>
</list>
<p>Our ABC-SMC framework tries to recover all the parameters (referred to as a particle in the algorithm above) at the same time. We notice that once one of the parameters converges, the acceptance rate decreases significantly. We then decided to fix the converged parameter at the inferred value (mode of its posterior) and rerun the inference varying the rest of the parameters until other parameters converge, and repeat the procedure. We found that this significantly improved the convergence speed. For the 2D inference in <xref ref-type="fig" rid="pcbi.1007243.g006">Fig 6</xref> we started with N = 100 simulated particles, performed r = 10 rounds with quantile Q = 0.5, leading to ~200k simulations for each parameter and ~1M simulations in total. For the 3D inference in <xref ref-type="supplementary-material" rid="pcbi.1007243.s015">S15 Fig</xref> we started with N = 1000 simulated particles, performed r = 10 rounds with quantile Q = 0.5, leading to ~2M simulations for each parameter and ~10M simulations in total.</p>
</sec>
<sec id="sec011">
<title>Input data format</title>
<p>The package implements three sampling strategies for the inference:</p>
<list list-type="order">
<list-item><p>Bulk samples (punch or needle biopsies)—ABCSMCwithBulkSamples()</p></list-item>
<list-item><p>Single cell sample phylogenetic trees—ABCSMCwithTreeSampleBL() and ABCSMCwithTreeSampleBT() (using Branch Lengths or Branching Times as summary statistics)</p></list-item>
<list-item><p>Whole tumour bulk sample—ABCSMCwithWholeTumour()</p></list-item>
</list>
<p>Depending on the strategy, a user would need to provide real or synthetic target data in the form of tumour bulk sample VAFs (list of R data.frames where each row should correspond to a unique mutation with the following columns: clone (Clone type label set to 0), alt (Number of reads with the variant), depth (Sequencing depth), id (Unique mutation ID)), an array of whole tumour sample VAFs or single cell sampling phylogenetic trees. Alternatively, a user can provide a set of parameters (please refer to the package documentation for the details of each input parameter format) to simulate a synthetic target tumour to then recover these input parameters.</p>
<p>The functions output sequence of files containing sets of inferred parameters corresponding to each SMC round (that can then be used to construct the posterior distributions for each parameter).</p>
</sec>
<sec id="sec012">
<title>Phylogenetic tree reconstruction</title>
<p>For <xref ref-type="fig" rid="pcbi.1007243.g004">Fig 4</xref> and parameter inference framework with single cell sequenced trees we used maximum parsimony phylogenetic algorithm implemented in paup [<xref ref-type="bibr" rid="pcbi.1007243.ref061">61</xref>]. For the genotyped phylogenetic trees in <xref ref-type="fig" rid="pcbi.1007243.g004">Fig 4</xref>, we manually constructed input genotype files for paup by recording presence/absence of a given mutation from the sampled 200 cells with respect to the reference mutations list (in our case mutations list taken from a bulk sample).</p>
</sec>
<sec id="sec013">
<title>Neutrality test</title>
<p>To test for the presence of selection and the mutation rate inference, we fit 1/f<sub>2</sub> distribution to the empirical cumulative distributions of sampled VAFs using the R package developed in ref [<xref ref-type="bibr" rid="pcbi.1007243.ref025">25</xref>].</p>
</sec>
</sec>
<sec id="sec014">
<title>Supporting information</title>
<supplementary-material id="pcbi.1007243.s001" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Growth curves.</title>
<p>Tumour cell population growth curves for each of the representative cases: <bold>(A)</bold> neutral homogeneous, <bold>(B)</bold> selective homogeneous, <bold>(C)</bold> neutral boundary driven, <bold>(D)</bold> selective boundary driven. Wild type (WT) and mutant growth curves are plotted separately in addition to the whole population growth curves. Without the spatial constraints of our model, the growth curves are exponential as expected. <bold>(A, B)</bold> With the boundary driven growth the growth becomes polynomial. We can also see for the tumours with selection <bold>(B, D)</bold> how the mutant subpopulation outcompetes wild type cell population.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007243.s002" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Examples where selection is modelled by varying death rates instead of birth rates, and neutral growth under high cell death.</title>
<p>Two examples where fitness advantage is modelled by decreasing cell death the mutant subpopulations and increasing for the wild type. <bold>(A)</bold> The death rate of the mutant subpopulation is 0.2 while for the WT is 0.8. <bold>(B)</bold> The death rate of the mutant subpopulation is 0.3 while for the WT is 0.9. <bold>(C-F)</bold> Examples of neutral growth with high cell death, which increases the level of genetic drift (especially noticeable in <bold>(F)</bold>) as well as the level of spatial intermixing due to stochasticity of cell replacement. Birth rate <italic>b</italic> was 1 in all simulations.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007243.s003" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Mutational load comparison for different growth cases.</title>
<p><bold>(A)</bold> We sample each representative example tumours (T1 –neutral homogenous, T2 –selective homogenous, T3 –neutral boundary driven, T4 –selective boundary driven) from the tumour centre (bulk sample C1) towards the periphery following the concentric circles in four directions: W–west, E–east, N–north, S–south. The bulk indexes (2W, 3W, 4W) are proportional to the distance from the centre to the periphery. <bold>(B)</bold> We observe how the number of mutations per bulk sample increases proportionally to the distance from the tumour centre in the case of boundary driven growth. Also, the total number of mutations is much higher for the constrained boundary driven growth than for the homogenous tumour due to increased cell turnover in the former case.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007243.s004" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Example of imprisonment.</title>
<p>Example of selective boundary driven growth when the driver mutant subpopulation gets trapped within the wild type population despite being fitter than the WT clone.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007243.s005" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>The effect of stochasticity and sampling bias on the shapes of VAF distributions for the four representative scenarios.</title>
<p>For each of the representative cases: <bold>(A)</bold> neutral homogeneous, <bold>(B)</bold> selective homogeneous, <bold>(C)</bold> neutral boundary driven, <bold>(D)</bold> selective boundary driven, we simulated 100 different runs of each case keeping the underlying parameters constant and varying only the random seed of the simulation. For each simulated tumour, we constructed needle and punch biopsy sample VAF distributions along with the whole tumour VAFs. Overall there is a less variation among the distributions for neutral <bold>(A,C)</bold> versus selective <bold>(B,D)</bold> cases. In addition, punch biopsy VAFs scatter more than needle biopsy samples in comparison to the whole tumour VAF distributions. <bold>(E)</bold> We separated the VAF distributions for the selective boundary driven between cases where the new clone escaped and grew to fixation, versus escaped by not yet fixed (signature of ongoing subclonal selection), versus imprisoned (leading to neutral dynamics)</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007243.s006" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Distribution of AUC based neutrality test p-values.</title>
<p><bold>(A)</bold> We simulate 100 different tumours for each 4 representative growth models and fit 1/f test to their corresponding whole tumour sample VAFs. Reported are the distributions of p-values obtained from each test using the AUC statistics. <bold>(B)</bold> For the cases of boundary-driven growth modes we compared tests of neutrality using the whole-tumour sample versus punch/needle biopsies.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007243.s007" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Example of selection when mutant subpopulation has higher push power instead than higher birth rate.</title>
<p>Example of a selective exponential growth when the mutant subpopulation has higher ‘push power’ than the wild type population.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007243.s008" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Killing 99% of the cell population and re-growing tumours.</title>
<p>For each of the representative cases: <bold>(A)</bold> neutral homogeneous, <bold>(B)</bold> selective homogeneous, <bold>(C)</bold> neutral boundary driven, <bold>(D)</bold> selective boundary driven, we simulated procedures of removing large cell population (here 99%) by the end of tumour growth and wait for it to regrow to its original size.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007243.s009" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Growth curves through cell killing.</title>
<p>Tumour cell population growth curves for each of the representative cases: <bold>(A)</bold> neutral homogeneous, <bold>(B)</bold> selective homogeneous, <bold>(C)</bold> neutral boundary driven, <bold>(D)</bold> selective boundary driven, where by the end of tumour growth we remove 99% of the cell population and wait for the tumour to regrow to its original size.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007243.s010" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.s010" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Allele frequency distributions derived from single cell sequencing.</title>
<p>We construct the allele frequency distributions from sequencing the randomly sampled 400 single cells (same as in <xref ref-type="fig" rid="pcbi.1007243.g004">Fig 4</xref>) from the four representative tumour examples: T1 –neutral homogenous, T2 –selective homogenous, T3 –neutral boundary driven, T4 –selective boundary driven.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007243.s011" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.s011" xlink:type="simple">
<label>S11 Fig</label>
<caption>
<title>Distribution of Moran’s test effect size.</title>
<p>We simulate 100 different tumours for each 4 representative growth models and test intermixing of subpopulations within each simulation lattice using Moran’s entropy-based test. Each individual test output significant p-values indicating to high spatial correlation between tumour cell types (mutant vs WT) and their location on tumour lattice. Although the test effect size (the observed values of the Moran’s test statistic) differ as we can see from their distributions per model scenario. The median values of each observed statistics are reported at the bottom of each violin plot.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007243.s012" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.s012" xlink:type="simple">
<label>S12 Fig</label>
<caption>
<title>Comparing the site frequency spectrum and phylogenetic tree balance index statistics for each representative scenario and sampling strategy.</title>
<p><bold>(A)</bold> Distributions of different summary statistics from single cell sampling (100x) phylogenetic trees for the four representative cases. The balance index-based statistics (sackin, colless with their different normalisation approaches–Yule, PDA) seem to have similar shapes among all four tumour cases, while tip and node Cophenetic distance-based statistics show different trends for neutral versus selective examples with not observable variation between homogenous and boundary driven tumours. Branch length-based statistics give similar results as cophenetic distances. Only one statistic, maximum node depth, tend to have longer flat tails for boundary driven tumours compared to homogenous tumour simulations. <bold>(B)</bold> For each of four tumour examples, we compare the total number of passenger mutations and final population sizes along with the time the simulations finish and the final frequency of the new sub-population (introduced after a driver event).</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007243.s013" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.s013" xlink:type="simple">
<label>S13 Fig</label>
<caption>
<title>Posterior distributions of model parameters from each synthetic tumour.</title>
<p>The violin plots of the posterior distributions for each model parameter per synthetic tumour inferred by our ABC-SMC framework. The three sets of tumours corresponding to the three tumour growth scenarios are plotted separately: exponential <bold>(A)</bold>, death <bold>(B)</bold> and boundary driven <bold>(C)</bold>. The number on the violin plots is the target value of each parameter.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007243.s014" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.s014" xlink:type="simple">
<label>S14 Fig</label>
<caption>
<title>The effect of stochasticity on the dependence of t and s parameter combinations on the VAF distribution.</title>
<p>To explore the interdependence of the parameter pair <italic>t</italic> and <italic>s</italic>, for their different values we simulate tumour growth while fixing all the other parameters (2D grid size = 400, u = 10, d = 0, a = 1). We summarised the obtained tumours by calculating either the Euclidean norm of the obtained whole tumour VAFs <bold>(C, D)</bold> or the calculating Euclidean distance between the cumulative VAF distributions of the simulated and a chosen target tumour (in this case target tumour parameters are t = 7, s = 3) <bold>(A, B).</bold> To reduce the effect of stochasticity we fix the random seed in <bold>(B)</bold> and <bold>(D)</bold> and they indeed showed less scattered patterns of <bold>(A)</bold> and <bold>(C)</bold> plots respectively.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007243.s015" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.s015" xlink:type="simple">
<label>S15 Fig</label>
<caption>
<title>Posterior distributions for a 3D model.</title>
<p>ABC SMC inference for a selective homogenous growth simulation in 3D space. Real ‘target’ values are reported as dashed lines. We run this ABC framework similarly to 2D simulations, where we recover each parameter at a time; first varying all parameters, once one is converged, fixing it at its inferred value and rerunning the simulation varying the parameters left to infer. Here we first recovered mutation rate, then time and selective advantage (together), and finally death rate and aggression (together as well). Similar to 2D models, our ABC framework with whole tumour sampling performs the best compared to other sampling strategies.</p>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007243.s016" mimetype="text/csv" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.s016" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Parameters of the set of synthetic tumours used to test the ABC inference framework.</title>
<p>(CSV)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007243.s017" mimetype="text/csv" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007243.s017" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Prior parameter ranges used for the synthetic ABC inference testing.</title>
<p>(CSV)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Daniel Nichol and Haider Tari for the fruitful discussion.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1007243.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Greaves</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Maley</surname> <given-names>CC</given-names></name>. <article-title>Clonal evolution in cancer</article-title>. <source>Nature</source>. <year>2012</year>;<volume>481</volume>: <fpage>306</fpage>–<lpage>313</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature10762" xlink:type="simple">10.1038/nature10762</ext-link></comment> <object-id pub-id-type="pmid">22258609</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McGranahan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Swanton</surname> <given-names>C</given-names></name>. <article-title>Biological and therapeutic impact of intratumor heterogeneity in cancer evolution</article-title>. <source>Cancer Cell</source>. <year>2015</year>;<volume>27</volume>: <fpage>15</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ccell.2014.12.001" xlink:type="simple">10.1016/j.ccell.2014.12.001</ext-link></comment> <object-id pub-id-type="pmid">25584892</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nik-Zainal</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Van Loo</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wedge</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Alexandrov</surname> <given-names>LB</given-names></name>, <name name-style="western"><surname>Greenman</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Lau</surname> <given-names>KW</given-names></name>, <etal>et al</etal>. <article-title>The life history of 21 breast cancers</article-title>. <source>Cell</source>. <year>2012</year>;<volume>149</volume>: <fpage>994</fpage>–<lpage>1007</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2012.04.023" xlink:type="simple">10.1016/j.cell.2012.04.023</ext-link></comment> <object-id pub-id-type="pmid">22608083</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Griffith</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Griffith</surname> <given-names>OL</given-names></name>, <name name-style="western"><surname>Krysiak</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Skidmore</surname> <given-names>ZL</given-names></name>, <name name-style="western"><surname>Ramu</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Optimizing Cancer Genome Sequencing and Analysis</article-title>. <source>Cell Systems</source>. <year>2015</year>;<volume>1</volume>: <fpage>210</fpage>–<lpage>223</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cels.2015.08.015" xlink:type="simple">10.1016/j.cels.2015.08.015</ext-link></comment> <object-id pub-id-type="pmid">26645048</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McGranahan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Swanton</surname> <given-names>C</given-names></name>. <article-title>Clonal Heterogeneity and Tumor Evolution: Past, Present, and the Future</article-title>. <source>Cell</source>. Elsevier; <year>2017</year>;<volume>168</volume>: <fpage>613</fpage>–<lpage>628</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2017.01.018" xlink:type="simple">10.1016/j.cell.2017.01.018</ext-link></comment> <object-id pub-id-type="pmid">28187284</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwartz</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Schäffer</surname> <given-names>AA</given-names></name>. <article-title>The evolution of tumour phylogenetics: principles and practice</article-title>. <source>Nat Rev Genet</source>. Nature Publishing Group; <year>2017</year>;<volume>18</volume>: <fpage>213</fpage>–<lpage>229</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg.2016.170" xlink:type="simple">10.1038/nrg.2016.170</ext-link></comment> <object-id pub-id-type="pmid">28190876</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alves</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Prieto</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Posada</surname> <given-names>D</given-names></name>. <article-title>Multiregional Tumor Trees Are Not Phylogenies</article-title>. <source>Trends in Cancer</source>. Elsevier; <year>2017</year>;<volume>3</volume>: <fpage>546</fpage>–<lpage>550</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.trecan.2017.06.004" xlink:type="simple">10.1016/j.trecan.2017.06.004</ext-link></comment> <object-id pub-id-type="pmid">28780931</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Deshwar</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Vembu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Yung</surname> <given-names>CK</given-names></name>, <name name-style="western"><surname>Jang</surname> <given-names>GH</given-names></name>, <name name-style="western"><surname>Stein</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Morris</surname> <given-names>Q</given-names></name>. <article-title>PhyloWGS: Reconstructing subclonal composition and evolution from whole-genome sequencing of tumors</article-title>. <source>Genome Biol. BioMed Central</source>; <year>2015</year>;<volume>16</volume>: <fpage>35</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s13059-015-0602-8" xlink:type="simple">10.1186/s13059-015-0602-8</ext-link></comment> <object-id pub-id-type="pmid">25786235</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Anderson</surname> <given-names>ARA</given-names></name>, <name name-style="western"><surname>Tomlin</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Couch</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gallahan</surname> <given-names>D</given-names></name>. <article-title>Mathematics of the Integrative Cancer Biology Program</article-title>. <source>Interface Focus. Royal Society</source>; <year>2013</year>;<volume>3</volume>: <fpage>20130023</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsfs.2013.0023" xlink:type="simple">10.1098/rsfs.2013.0023</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1007243.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beerenwinkel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Schwarz</surname> <given-names>RF</given-names></name>, <name name-style="western"><surname>Gerstung</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Markowetz</surname> <given-names>F</given-names></name>. <article-title>Cancer evolution: mathematical models and computational inference</article-title>. <source>Syst Biol</source>. Oxford University Press; <year>2014</year>;: syu081. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/sysbio/syu081" xlink:type="simple">10.1093/sysbio/syu081</ext-link></comment> <object-id pub-id-type="pmid">25293804</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Altrock</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>LL</given-names></name>, <name name-style="western"><surname>Michor</surname> <given-names>F</given-names></name>. <article-title>The mathematics of cancer: integrating quantitative models</article-title>. <source>Nat Rev Cancer</source>. <year>2015</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/scitranslmed.3002356" xlink:type="simple">10.1126/scitranslmed.3002356</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1007243.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Byrne</surname> <given-names>HM</given-names></name>. <article-title>Dissecting cancer through mathematics: from the cell to the animal model</article-title>. <source>Nat Rev Cancer</source>. Nature Publishing Group; <year>2010</year>;<volume>10</volume>: <fpage>221</fpage>–<lpage>230</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrc2808" xlink:type="simple">10.1038/nrc2808</ext-link></comment> <object-id pub-id-type="pmid">20179714</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref013"><label>13</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Hartl</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>AG</given-names></name>. <source>Principles of Population Genetics</source>. <edition>4 ed.</edition> <publisher-name>Sinauer Associates, Inc</publisher-name>; <year>2006</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg1877" xlink:type="simple">10.1038/nrg1877</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1007243.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Anderson</surname> <given-names>ARA</given-names></name>, <name name-style="western"><surname>Weaver</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Cummings</surname> <given-names>PT</given-names></name>, <name name-style="western"><surname>Quaranta</surname> <given-names>V</given-names></name>. <article-title>Tumor morphology and phenotypic evolution driven by selective pressure from the microenvironment</article-title>.—PubMed—NCBI. <source>Cell</source>. <year>2006</year>;<volume>127</volume>: <fpage>905</fpage>–<lpage>915</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2006.09.042" xlink:type="simple">10.1016/j.cell.2006.09.042</ext-link></comment> <object-id pub-id-type="pmid">17129778</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Enderling</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>ARA</given-names></name>, <name name-style="western"><surname>Chaplain</surname> <given-names>MAJ</given-names></name>, <name name-style="western"><surname>Beheshti</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hlatky</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Hahnfeldt</surname> <given-names>P</given-names></name>. <article-title>Paradoxical dependencies of tumor dormancy and progression on basic cell kinetics</article-title>. <source>Cancer Res</source>. American Association for Cancer Research; <year>2009</year>;<volume>69</volume>: <fpage>8814</fpage>–<lpage>8821</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1158/0008-5472.CAN-09-2115" xlink:type="simple">10.1158/0008-5472.CAN-09-2115</ext-link></comment> <object-id pub-id-type="pmid">19887613</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sottoriva</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Verhoeff</surname> <given-names>JJC</given-names></name>, <name name-style="western"><surname>Borovski</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>McWeeney</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Naumov</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Medema</surname> <given-names>JP</given-names></name>, <etal>et al</etal>. <article-title>Cancer stem cell tumor model reveals invasive morphology and increased phenotypical heterogeneity</article-title>. <source>Cancer Res</source>. American Association for Cancer Research; <year>2010</year>;<volume>70</volume>: <fpage>46</fpage>–<lpage>56</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1158/0008-5472.CAN-09-3663" xlink:type="simple">10.1158/0008-5472.CAN-09-3663</ext-link></comment> <object-id pub-id-type="pmid">20048071</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sottoriva</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Vermeulen</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Tavaré</surname> <given-names>S</given-names></name>. <article-title>Modeling evolutionary dynamics of epigenetic mutations in hierarchically organized tumors</article-title>. <source>PLoS Comput Biol</source>. <year>2011</year>;<volume>7</volume>: <fpage>e1001132</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1001132" xlink:type="simple">10.1371/journal.pcbi.1001132</ext-link></comment> <object-id pub-id-type="pmid">21573198</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Scott</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Basanta</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>ARA</given-names></name>, <name name-style="western"><surname>Gerlee</surname> <given-names>P</given-names></name>. <article-title>A mathematical model of tumour self-seeding reveals secondary metastatic deposits as drivers of primary tumour growth</article-title>. <source>J R Soc Interface</source>. <year>2013</year>;<volume>10</volume>: <fpage>20130011</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2013.0011" xlink:type="simple">10.1098/rsif.2013.0011</ext-link></comment> <object-id pub-id-type="pmid">23427099</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Massey</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Rockne</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Hawkins-Daarud</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gallaher</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>ARA</given-names></name>, <name name-style="western"><surname>Canoll</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Simulating PDGF-Driven Glioma Growth and Invasion in an Anatomically Accurate Brain Domain</article-title>. <source>Bull Math Biol</source>. Springer US; <year>2018</year>;<volume>80</volume>: <fpage>1292</fpage>–<lpage>1309</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11538-017-0312-3" xlink:type="simple">10.1007/s11538-017-0312-3</ext-link></comment> <object-id pub-id-type="pmid">28842831</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robertson-Tessi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gillies</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Gatenby</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>ARA</given-names></name>. <article-title>Impact of Metabolic Heterogeneity on Tumor Growth, Invasion, and Treatment Outcomes</article-title>. <source>Cancer Res</source>. <year>2015</year>;<volume>75</volume>: <fpage>1567</fpage>–<lpage>1579</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1158/0008-5472.CAN-14-1428" xlink:type="simple">10.1158/0008-5472.CAN-14-1428</ext-link></comment> <object-id pub-id-type="pmid">25878146</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Waclaw</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Bozic</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Pittman</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Hruban</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Vogelstein</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Nowak</surname> <given-names>MA</given-names></name>. <article-title>A spatial model predicts that dispersal and cell turnover limit intratumour heterogeneity</article-title>. <source>Nature</source>. Nature Publishing Group; <year>2015</year>;<volume>525</volume>: <fpage>261</fpage>–<lpage>264</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature14971" xlink:type="simple">10.1038/nature14971</ext-link></comment> <object-id pub-id-type="pmid">26308893</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sun</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Sottoriva</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Graham</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Harpak</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>Z</given-names></name>, <etal>et al</etal>. <article-title>Between-region genetic divergence reflects the mode and tempo of tumor evolution</article-title>. <source>Nature Genetics</source>. <year>2017</year>;<volume>49</volume>: <fpage>1015</fpage>–<lpage>1024</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.3891" xlink:type="simple">10.1038/ng.3891</ext-link></comment> <object-id pub-id-type="pmid">28581503</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ghaffarizadeh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Heiland</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Friedman</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Mumenthaler</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Macklin</surname> <given-names>P</given-names></name>. <article-title>PhysiCell: An open source physics-based cell simulator for 3-D multicellular systems. Poisot T, editor</article-title>. <source>PLoS Comput Biol</source>. Public Library of Science; <year>2018</year>;<volume>14</volume>: <fpage>e1005991</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005991" xlink:type="simple">10.1371/journal.pcbi.1005991</ext-link></comment> <object-id pub-id-type="pmid">29474446</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Williams</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Werner</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Barnes</surname> <given-names>CP</given-names></name>, <name name-style="western"><surname>Graham</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Sottoriva</surname> <given-names>A</given-names></name>. <article-title>Identification of neutral tumor evolution across cancer types</article-title>. <source>Nature Genetics</source>. <year>2016</year>;<volume>48</volume>: <fpage>238</fpage>–<lpage>244</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.3489" xlink:type="simple">10.1038/ng.3489</ext-link></comment> <object-id pub-id-type="pmid">26780609</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Williams</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Werner</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Heide</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Curtis</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Barnes</surname> <given-names>CP</given-names></name>, <name name-style="western"><surname>Sottoriva</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Quantification of subclonal selection in cancer from bulk sequencing data</article-title>. <source>Nature Genetics</source>. Nature Publishing Group; <year>2018</year>;<volume>50</volume>: <fpage>895</fpage>–<lpage>903</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41588-018-0128-6" xlink:type="simple">10.1038/s41588-018-0128-6</ext-link></comment> <object-id pub-id-type="pmid">29808029</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gillespie</surname> <given-names>DT</given-names></name>. <article-title>Exact stochastic simulation of coupled chemical reactions</article-title>. <source>The Journal of Physical Chemistry</source>. American Chemical Society; <year>1977</year>;<volume>81</volume>: <fpage>2340</fpage>–<lpage>2361</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/j100540a008" xlink:type="simple">10.1021/j100540a008</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1007243.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rodriguez-Brenes</surname> <given-names>IA</given-names></name>, <name name-style="western"><surname>Komarova</surname> <given-names>NL</given-names></name>, <name name-style="western"><surname>Wodarz</surname> <given-names>D</given-names></name>. <article-title>Tumor growth dynamics: insights into evolutionary processes</article-title>. <source>Trends Ecol Evol (Amst)</source>. <year>2013</year>;<volume>28</volume>: <fpage>597</fpage>–<lpage>604</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tree.2013.05.020" xlink:type="simple">10.1016/j.tree.2013.05.020</ext-link></comment> <object-id pub-id-type="pmid">23816268</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schröder</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rahmann</surname> <given-names>S</given-names></name>. <article-title>Decelerating growth and human breast cancer.—PubMed—NCBI. Algorithms for Molecular Biology 2017 12:1</article-title>. <source>BioMed Central</source>; <year>2017</year>;<volume>12</volume>: <fpage>2118</fpage>–<lpage>2019</lpage>.</mixed-citation></ref>
<ref id="pcbi.1007243.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lenos</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Miedema</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Lodestijn</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Nijman</surname> <given-names>LE</given-names></name>, <name name-style="western"><surname>van den Bosch</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ros</surname> <given-names>XR</given-names></name>, <etal>et al</etal>. <article-title>Stem cell functionality is microenvironmentally defined during tumour expansion and therapy response in colon cancer</article-title>. <source>Nature Cell Biology</source>. Nature Publishing Group; <year>2018</year>;<volume>20</volume>: <fpage>1193</fpage>–<lpage>1202</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41556-018-0179-z" xlink:type="simple">10.1038/s41556-018-0179-z</ext-link></comment> <object-id pub-id-type="pmid">30177776</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van der Heijden</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Miedema</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Waclaw</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Veenstra</surname> <given-names>VL</given-names></name>, <name name-style="western"><surname>Lecca</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Nijman</surname> <given-names>LE</given-names></name>, <etal>et al</etal>. <article-title>Spatiotemporal regulation of clonogenicity in colorectal cancer xenografts</article-title>. <source>Proc Natl Acad Sci USA</source>. National Academy of Sciences; <year>2019</year>;<volume>8</volume>: <fpage>201813417</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1813417116" xlink:type="simple">10.1073/pnas.1813417116</ext-link></comment> <object-id pub-id-type="pmid">30850544</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bozic</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Antal</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ohtsuki</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ohtsuki</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Carter</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Carter</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Accumulation of driver and passenger mutations during tumor progression</article-title>. <source>Proc Natl Acad Sci USA</source>. National Acad Sciences; <year>2010</year>;<volume>107</volume>: <fpage>18545</fpage>–<lpage>18550</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1010978107" xlink:type="simple">10.1073/pnas.1010978107</ext-link></comment> <object-id pub-id-type="pmid">20876136</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Durrett</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Schweinsberg</surname> <given-names>J</given-names></name>. <article-title>Approximating selective sweeps</article-title>. <source>Theor Popul Biol</source>. <year>2004</year>;<volume>66</volume>: <fpage>129</fpage>–<lpage>138</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tpb.2004.04.002" xlink:type="simple">10.1016/j.tpb.2004.04.002</ext-link></comment> <object-id pub-id-type="pmid">15302222</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Martincorena</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Raine</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Gerstung</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dawson</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Haase</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Van Loo</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Universal Patterns of Selection in Cancer and Somatic Tissues</article-title>. <source>Cell</source>. Elsevier; <year>2017</year>;<volume>171</volume>: <fpage>1</fpage>–<lpage>13</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2017.09.011" xlink:type="simple">10.1016/j.cell.2017.09.011</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1007243.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kessler</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Levine</surname> <given-names>H</given-names></name>. <article-title>Large population solution of the stochastic Luria-Delbruck evolution model</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2013</year>;<volume>110</volume>: <fpage>11682</fpage>–<lpage>11687</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1309667110" xlink:type="simple">10.1073/pnas.1309667110</ext-link></comment> <object-id pub-id-type="pmid">23818583</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kessler</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Levine</surname> <given-names>H</given-names></name>. <article-title>Scaling solution in the large population limit of the general asymmetric stochastic Luria-Delbrück evolution process</article-title>. <source>J Stat Phys</source>. Springer US; <year>2015</year>;<volume>158</volume>: <fpage>783</fpage>–<lpage>805</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10955-014-1143-3" xlink:type="simple">10.1007/s10955-014-1143-3</ext-link></comment> <object-id pub-id-type="pmid">26900175</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Durrett</surname> <given-names>R.</given-names></name> <article-title>Population genetics of neutral mutations in exponentially growing cancer cell populations</article-title>. <source>The Annals of Applied Probability</source>. Institute of Mathematical Statistics; <year>2013</year>;<volume>23</volume>: <fpage>230</fpage>–<lpage>250</lpage>. <object-id pub-id-type="pmid">23471293</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fusco</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Gralka</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kayser</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hallatschek</surname> <given-names>O</given-names></name>. <article-title>Excess of mutational jackpot events in expanding populations revealed by spatial Luria–Delbrück experiments</article-title>. <source>Nat Comms</source>. Nature Publishing Group; <year>2016</year>;<volume>7</volume>: <fpage>12760</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms12760" xlink:type="simple">10.1038/ncomms12760</ext-link></comment> <object-id pub-id-type="pmid">27694797</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kostadinov</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Maley</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Kuhner</surname> <given-names>MK</given-names></name>. <article-title>Bulk Genotyping of Biopsies Can Create Spurious Evidence for Hetereogeneity in Mutation Content</article-title>. <name name-style="western"><surname>Wang</surname> <given-names>E</given-names></name>, editor. <source>PLoS Comput Biol</source>. Public Library of Science; <year>2016</year>;<volume>12</volume>: <fpage>e1004413</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004413" xlink:type="simple">10.1371/journal.pcbi.1004413</ext-link></comment> <object-id pub-id-type="pmid">27105344</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zapata</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Pich</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Serrano</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Kondrashov</surname> <given-names>FA</given-names></name>, <name name-style="western"><surname>Ossowski</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schaefer</surname> <given-names>MH</given-names></name>. <article-title>Negative selection in tumor genome evolution acts on essential cellular functions and the immunopeptidome</article-title>. <source>Genome Biol</source>. <year>2018</year>;<volume>19</volume>: <fpage>924</fpage>.</mixed-citation></ref>
<ref id="pcbi.1007243.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gejman</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>AY</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>HF</given-names></name>, <name name-style="western"><surname>DiKun</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hakimi</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Schietinger</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Rejection of immunogenic tumor clones is limited by clonal fraction</article-title>. <source>eLife Sciences</source>. <year>2018</year>;<volume>7</volume>: <fpage>635</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.41090" xlink:type="simple">10.7554/eLife.41090</ext-link></comment> <object-id pub-id-type="pmid">30499773</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ling</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Extremely high genetic diversity in a single tumor points to prevalence of non-Darwinian cell evolution</article-title>. <source>PNAS</source>. <year>2015</year>;<volume>112</volume>: <fpage>E6496</fpage>–<lpage>505</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1519556112" xlink:type="simple">10.1073/pnas.1519556112</ext-link></comment> <object-id pub-id-type="pmid">26561581</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref042"><label>42</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Peischl</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Dupanloup</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Kirkpatrick</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Excoffier</surname> <given-names>L</given-names></name>. <chapter-title>On the accumulation of deleterious mutations during range expansions</chapter-title>. <source>Molecular Ecology</source>. <edition>6 ed.</edition> <publisher-name>Wiley/Blackwell (10.1111)</publisher-name>; <year>2013</year>;<volume>22</volume>: <fpage>5972</fpage>–<lpage>5982</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/mec.12524" xlink:type="simple">10.1111/mec.12524</ext-link></comment> <object-id pub-id-type="pmid">24102784</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Navin</surname> <given-names>NE</given-names></name>. <article-title>The first five years of single-cell cancer genomics and beyond</article-title>. <source>Genome Res</source>. Cold Spring Harbor Laboratory Press; <year>2015</year>;<volume>25</volume>: <fpage>1499</fpage>–<lpage>1507</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.191098.115" xlink:type="simple">10.1101/gr.191098.115</ext-link></comment> <object-id pub-id-type="pmid">26430160</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jahn</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kuipers</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Beerenwinkel</surname> <given-names>N</given-names></name>. <article-title>Tree inference for single-cell data</article-title>. <source>Genome Biol. BioMed Central</source>; <year>2016</year>;<volume>17</volume>: <fpage>1</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s13059-016-0936-x" xlink:type="simple">10.1186/s13059-016-0936-x</ext-link></comment> <object-id pub-id-type="pmid">27149953</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eirew</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Steif</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Khattra</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ha</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Yap</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Farahani</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Dynamics of genomic clones in breast cancer patient xenografts at single-cell resolution</article-title>. <source>Nature</source>. <year>2015</year>;<volume>518</volume>: <fpage>422</fpage>–<lpage>426</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature13952" xlink:type="simple">10.1038/nature13952</ext-link></comment> <object-id pub-id-type="pmid">25470049</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Salehi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Steif</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Roth</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Aparicio</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bouchard-Côté</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shah</surname> <given-names>SP</given-names></name>. <article-title>ddClone: joint statistical inference of clonal populations from single cell and bulk tumour sequencing data</article-title>. <source>Genome Biol. BioMed Central</source>; <year>2017</year>;<volume>18</volume>: <fpage>44</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s13059-017-1169-3" xlink:type="simple">10.1186/s13059-017-1169-3</ext-link></comment> <object-id pub-id-type="pmid">28249593</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sottoriva</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Graham</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Salomon</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>A Big Bang model of human colorectal tumor growth</article-title>. <source>Nature Genetics</source>. <year>2015</year>;<volume>47</volume>: <fpage>209</fpage>–<lpage>216</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.3214" xlink:type="simple">10.1038/ng.3214</ext-link></comment> <object-id pub-id-type="pmid">25665006</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Roerink</surname> <given-names>SF</given-names></name>, <name name-style="western"><surname>Sasaki</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Lee-Six</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Young</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Alexandrov</surname> <given-names>LB</given-names></name>, <name name-style="western"><surname>Behjati</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Intra-tumour diversification in colorectal cancer at the single-cell level</article-title>. <source>Nature.</source> Nature Publishing Group; <year>2018</year>;: <volume>1</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41586-018-0024-3" xlink:type="simple">10.1038/s41586-018-0024-3</ext-link></comment> <object-id pub-id-type="pmid">29643510</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref049"><label>49</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Nanda</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Durrett</surname> <given-names>R</given-names></name>. <chapter-title>Genotype patterns in growing solid tumors</chapter-title>. bioRxiv. <publisher-name>Cold Spring Harbor Laboratory</publisher-name>; <year>2018</year>;: <fpage>390385</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/390385" xlink:type="simple">10.1101/390385</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1007243.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beaumont</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Balding</surname> <given-names>DJ</given-names></name>. <article-title>Approximate Bayesian computation in population genetics</article-title>. <source>Genetics</source>. <year>2002</year>;<volume>162</volume>: <fpage>2025</fpage>–<lpage>2035</lpage>. <object-id pub-id-type="pmid">12524368</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beaumont</surname> <given-names>MA</given-names></name>. <article-title>Approximate Bayesian Computation in Evolution and Ecology</article-title><source>.</source> <ext-link ext-link-type="uri" xlink:href="http://dxdoiorg/101146/annurev-ecolsys-102209-144621" xlink:type="simple">http://dxdoiorg/101146/annurev-ecolsys-102209-144621</ext-link>. Annual Reviews; <year>2010</year>;<volume>41</volume>: <fpage>379</fpage>–<lpage>406</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev-ecolsys-102209-144621" xlink:type="simple">10.1146/annurev-ecolsys-102209-144621</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1007243.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buzbas</surname> <given-names>EO</given-names></name>, <name name-style="western"><surname>Rosenberg</surname> <given-names>NA</given-names></name>. <article-title>AABC: Approximate approximate Bayesian computation for inference in population-genetic models</article-title>. <source>Theor Popul Biol</source>. <year>2015</year>;<volume>99</volume>: <fpage>31</fpage>–<lpage>42</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tpb.2014.09.002" xlink:type="simple">10.1016/j.tpb.2014.09.002</ext-link></comment> <object-id pub-id-type="pmid">25261426</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maley</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Galipeau</surname> <given-names>PC</given-names></name>, <name name-style="western"><surname>Finley</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Wongsurawat</surname> <given-names>VJ</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Sanchez</surname> <given-names>CA</given-names></name>, <etal>et al</etal>. <article-title>Genetic clonal diversity predicts progression to esophageal adenocarcinoma</article-title>. <source>Nature Genetics</source>. Nature Publishing Group; <year>2006</year>;<volume>38</volume>: <fpage>468</fpage>–<lpage>473</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng1768" xlink:type="simple">10.1038/ng1768</ext-link></comment> <object-id pub-id-type="pmid">16565718</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jamal-Hanjani</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>McGranahan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Birkbak</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Watkins</surname> <given-names>TBK</given-names></name>, <name name-style="western"><surname>Veeriah</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Tracking the Evolution of Non–Small-Cell Lung Cancer</article-title>. <source>New England Journal of Medicine</source>. <year>2017</year>;: NEJMoa1616288. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1056/NEJMoa1616288" xlink:type="simple">10.1056/NEJMoa1616288</ext-link></comment> <object-id pub-id-type="pmid">28445112</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ponder</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Case</surname> <given-names>DA</given-names></name>. <article-title>Force fields for protein simulations</article-title>. <source>Adv Protein Chem</source>. <year>2003</year>;<volume>66</volume>: <fpage>27</fpage>–<lpage>85</lpage>. <object-id pub-id-type="pmid">14631816</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mirams</surname> <given-names>GR</given-names></name>, <name name-style="western"><surname>Arthurs</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Bernabeu</surname> <given-names>MO</given-names></name>, <name name-style="western"><surname>Bordas</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Cooper</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Corrias</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Chaste: An Open Source C++ Library for Computational Physiology and Biology.</article-title> <name name-style="western"><surname>Prlic</surname> <given-names>A</given-names></name>, editor. <source>PLoS Comput Biol</source>. Public Library of Science; <year>2013</year>;<volume>9</volume>: <fpage>e1002970</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002970" xlink:type="simple">10.1371/journal.pcbi.1002970</ext-link></comment> <object-id pub-id-type="pmid">23516352</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref057"><label>57</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Anderson</surname> <given-names>ARA</given-names></name>, <name name-style="western"><surname>Quaranta</surname> <given-names>V</given-names></name>. <article-title>Integrative mathematical oncology</article-title>. <source>Nat Rev Cancer</source>. Nature Publishing Group; <year>2008</year>;<volume>8</volume>: <fpage>227</fpage>–<lpage>234</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrc2329" xlink:type="simple">10.1038/nrc2329</ext-link></comment> <object-id pub-id-type="pmid">18273038</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref058"><label>58</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beerenwinkel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Antal</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Dingli</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Traulsen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kinzler</surname> <given-names>KW</given-names></name>, <name name-style="western"><surname>Velculescu</surname> <given-names>VE</given-names></name>, <etal>et al</etal>. <article-title>Genetic Progression and the Waiting Time to Cancer</article-title>. <source>PLoS Comput Biol</source>. Public Library of Science; <year>2007</year>;<volume>3</volume>: <fpage>e225</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.0030225" xlink:type="simple">10.1371/journal.pcbi.0030225</ext-link></comment> <object-id pub-id-type="pmid">17997597</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref059"><label>59</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Plagnol</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Tavaré</surname> <given-names>S</given-names></name>. <source>Approximate Bayesian Computation and MCMC</source>. <publisher-loc>Berlin, Heidelberg</publisher-loc>: <publisher-name>Springer Berlin Heidelberg</publisher-name>; <year>2004</year>. pp. <fpage>99</fpage>–<lpage>113</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/978-3-642-18743-8_5" xlink:type="simple">10.1007/978-3-642-18743-8_5</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1007243.ref060"><label>60</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Toni</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Welch</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Strelkowa</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ipsen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Stumpf</surname> <given-names>MPH</given-names></name>. <article-title>Approximate Bayesian computation scheme for parameter inference and model selection in dynamical systems</article-title>. <source>Journal of The Royal Society Interface</source>. The Royal Society; <year>2009</year>;<volume>6</volume>: <fpage>187</fpage>–<lpage>202</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2008.0172" xlink:type="simple">10.1098/rsif.2008.0172</ext-link></comment> <object-id pub-id-type="pmid">19205079</object-id></mixed-citation></ref>
<ref id="pcbi.1007243.ref061"><label>61</label><mixed-citation publication-type="other" xlink:type="simple">Swofford DL. PAUP*: Phylogenetic Analysis Using Parsimony (and Other Methods) 4.0 Beta. In: Sinauer, Sunderland, MA [Internet]. 9 Mar 2005 [cited 9 Mar 2015]. Available: <ext-link ext-link-type="uri" xlink:href="http://www.sinauer.com/paup-phylogenetic-analysis-using-parsimony-and-other-methods-4-0-beta.html" xlink:type="simple">http://www.sinauer.com/paup-phylogenetic-analysis-using-parsimony-and-other-methods-4-0-beta.html</ext-link></mixed-citation></ref>
</ref-list>
</back>
</article>