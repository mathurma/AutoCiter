<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004517</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00470</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>A Generative Statistical Algorithm for Automatic Detection of Complex Postures</article-title>
<alt-title alt-title-type="running-head">A Generative Statistical Algorithm for Detecting Complex Postures</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Nagy</surname>
<given-names>Stanislav</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Goessling</surname>
<given-names>Marc</given-names>
</name>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Amit</surname>
<given-names>Yali</given-names>
</name>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
<xref rid="aff003" ref-type="aff"><sup>3</sup></xref>
<xref rid="cor001" ref-type="corresp">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Biron</surname>
<given-names>David</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
<xref rid="aff004" ref-type="aff"><sup>4</sup></xref>
<xref rid="cor001" ref-type="corresp">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>The Institute for Biophysical Dynamics, The University of Chicago, Chicago, Illinois, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Department of Statistics, The University of Chicago, Chicago, Illinois, United States of America</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Department of Computer Science, The University of Chicago, Chicago, Illinois, United States of America</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Department of Physics and the James Franck Institute, The University of Chicago, Chicago, Illinois, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Faisal</surname>
<given-names>Aldo A</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Imperial College London, UNITED KINGDOM</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: SN MG YA DB. Performed the experiments: SN. Analyzed the data: SN MG DB. Contributed reagents/materials/analysis tools: SN MG YA DB. Wrote the paper: SN MG YA DB.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">amit@galton.uchicago.edu</email> (YA); <email xlink:type="simple">dbiron@uchicago.edu</email> (DB)</corresp>
</author-notes>
<pub-date pub-type="epub">
<day>6</day>
<month>10</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="collection">
<month>10</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>10</issue>
<elocation-id>e1004517</elocation-id>
<history>
<date date-type="received">
<day>23</day>
<month>3</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>25</day>
<month>8</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Nagy et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004517" xlink:type="simple"/>
<abstract>
<p>This paper presents a method for automated detection of complex (non-self-avoiding) postures of the nematode <italic>Caenorhabditis elegans</italic> and its application to analyses of locomotion defects. Our approach is based on progressively detailed statistical models that enable detection of the head and the body even in cases of severe coilers, where data from traditional trackers is limited. We restrict the input available to the algorithm to a single digitized frame, such that manual initialization is not required and the detection problem becomes embarrassingly parallel. Consequently, the proposed algorithm does not propagate detection errors and naturally integrates in a “big data” workflow used for large-scale analyses. Using this framework, we analyzed the dynamics of postures and locomotion of wild-type animals and mutants that exhibit severe coiling phenotypes. Our approach can readily be extended to additional automated tracking tasks such as tracking pairs of animals (e.g., for mating assays) or different species.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>The roundworm <italic>Caenorhabditis elegans</italic> is a widely used model organism. Its locomotion, for instance, enables the study of genetic and cellular mechanisms that underlie behavior and may be broadly conserved. Characterizing <italic>C</italic>. <italic>elegans</italic> locomotion requires identifying its body posture and tracking how posture changes with time. Existing machine vision approaches have greatly aided this effort. However, they have been limited in cases where the body of the animal curved strongly such that one part of the animal rested or slid against another part. We present a method for automated detection of such complex body postures and its application to the analysis of locomotion. At the core of our method are progressively detailed statistical models of the shape of the animal. These models enable us to assess the probability that a given image contains a suggested posture. Our approach does not require manual initialization and can be readily parallelized for large-scale applications. We used our approach to analyze locomotion in mutants that severely exaggerate their body bends, called coilers. This approach can readily be extended to additional automated tracking tasks such as pairs of interacting roundworms or different organisms.</p>
</abstract>
<funding-group>
<funding-statement>The CGC is funded by NIH Office of Research Infrastructure Programs (P40 OD010440). This work was supported by the NSF (IOS 1256989). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="0"/>
<page-count count="23"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files. Our source code and documentation are publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/david-biron/pycelegans-2.0" xlink:type="simple">https://github.com/david-biron/pycelegans-2.0</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods article</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The nematode <italic>Caenorhabditis elegans</italic> is a simple animal model system, widely used to study the genetic foundations of behavior. Among its key advantages are its tractable genetics, short life cycle, relatively simple anatomy and behavior patterns, and evolutionary conserved pathways [<xref rid="pcbi.1004517.ref001" ref-type="bibr">1</xref>–<xref rid="pcbi.1004517.ref003" ref-type="bibr">3</xref>]. The locomotion patterns of <italic>C</italic>. <italic>elegans</italic> have been extensively studied. Historically, this was largely done relying on visual phenotyping.</p>
<p>In recent years, several machine vision tools have been developed for automated posture analysis, collectively referred to as “trackers”, and spanning a range of capabilities [<xref rid="pcbi.1004517.ref004" ref-type="bibr">4</xref>–<xref rid="pcbi.1004517.ref010" ref-type="bibr">10</xref>]. Accurate identification of head and tail and reconstruction of the midline of the body are important steps in automated analyses of <italic>C</italic>. <italic>elegans</italic> postures. Typically, the topological genus of images of wild-type animals is zero, i.e., the body image only rarely forms closed loops. However, loops are observed in coiling mutants and more rarely in wild-type or other mutants.</p>
<p>Existing trackers were rarely used to automate the study of severe coiler phenotypes, plausibly because in such cases they either require frequent manual intervention or may misidentify the posture [<xref rid="pcbi.1004517.ref011" ref-type="bibr">11</xref>–<xref rid="pcbi.1004517.ref014" ref-type="bibr">14</xref>]. Therefore, we refer to such non-self-avoiding postures as complex.</p>
<p>Generative statistical models describe the expected images given a particular posture. This expectation is formulated in terms of a probability distribution, referred to as the data or likelihood term [<xref rid="pcbi.1004517.ref015" ref-type="bibr">15</xref>]. Knowledge about the data, such as expected body length or smoothness, is accounted for by specifying an a priori distribution of postures. The algorithm then optimizes the posterior probability of the posture, i.e., the product of the likelihood and the prior term. This framework can enable the identification of complex postures.</p>
<p>Here, we present a posture detection method based on generative statistical models and a coarse-to-fine strategy. Our approach allows a computationally efficient implementation and yields reliable detections of many complex postures. First, a small set of characteristic features for the head and body regions is defined as functions of oriented edges in the image. Next, we formulate a statistical model describing the likely configurations of these features given a hypothesized posture. At run time, we search for the maximum a posteriori posture of the worm given the observed image. This calculation yields a coarse outline of the animal.</p>
<p>To refine the outline, a second statistical model is employed which directly uses the edge information in the image and hence enables more precise identification. The advantage of this coarse-to-fine technique is computational efficiency. The coarse search runs over a grid which is much smaller than the original image grid. The fine search is then initialized using the result of the coarse detection and is only required to explore a small subset of possibilities. Searching for the posture at the fine scale without considering the information obtained from a coarse search would have been computationally intractable. To demonstrate the utility of our method, we assayed wild-type animals and several mutant strains that were previously associated with a coiler phenotype.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>A coarse statistical model can efficiently approximate complex postures</title>
<p>A coarse statistical model was defined to identify approximate positions of the head, tail and midline of the animal. The model is based on prominent features of the head and the body that are identified on a coarse-grained grid <italic>H</italic>, in which every point corresponds to a block of pixels in the original image grid <italic>G</italic>. Through trial and error, we found that a coarse grid unit length of one quarter of the width of the worm offered a good tradeoff between efficiency and accuracy. The key components of this model and the resulting detection are descried below.</p>
<sec id="sec004">
<title>(i) Body and head features</title>
<p>To construct mid-level local image features which are characteristic for the body or head region of the worm, we follow the approach in [<xref rid="pcbi.1004517.ref015" ref-type="bibr">15</xref>] and use a set <italic>E</italic> of eight types of binary edges corresponding to four possible orientations (horizontal, vertical, and diagonal) with two possible polarities. Edges in the digitized image are detected by computing the intensity difference between adjacent pixels. If this difference exceeds the edge detection threshold (<xref rid="pcbi.1004517.s005" ref-type="supplementary-material">S1 Table</xref>) and the magnitude of the difference exceeds the magnitude of the differences between neighboring pairs, then the presence of the corresponding edge is noted and its polarity is determined by the sign of the difference (<xref rid="pcbi.1004517.g001" ref-type="fig">Fig 1A</xref>). Multiple edge orientations can be detected at the same location. This yields edge arrays <italic>X</italic><sub><italic>e</italic></sub> for <italic>e</italic> ∈ <italic>E</italic>, where <italic>X</italic><sub><italic>e</italic></sub>(<italic>y</italic>) = 1 if an edge of type <italic>e</italic> was found at pixel <italic>y</italic> ∈ <italic>G</italic> and <italic>X</italic><sub><italic>e</italic></sub>(<italic>y</italic>) = 0 otherwise (<xref rid="pcbi.1004517.g001" ref-type="fig">Fig 1A</xref>). The binary criteria for identifying edges are largely photometric invariant, i.e., insensitive to details of brightness and contrast. This makes our method robust to changes in imaging conditions (see, e.g., <xref rid="pcbi.1004517.s001" ref-type="supplementary-material">S1 Fig</xref>).</p>
<fig id="pcbi.1004517.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004517.g001</object-id>
<label>Fig 1</label>
<caption>
<p>(A) Left: detected edges in an image of a wild-type animal exhibiting a (rare) coiled posture. The red/blue colors indicate the two possible edge polarities. Right: Detected body (yellow) and head (cyan) features with indicators of the corresponding orientations. (B) Graphical representations of the four head features and the four body features. Each feature corresponds to a spatial arrangement of areas with elevated probabilities for specific edge types. The red and blue shade colors represent areas with increased probabilities for positive and negative polarity edges, respectively. Green areas represent an overlap of red and blue areas. Red and blue dashed lines represent the orientation of positive and negative polarity edges, respectively. These masks introduce invariance to the exact location of the edges and are hence robust to variations in the width of the worm. (C) Left: a detected subinstantiation at an intermediate search step. The magenta blocks indicate which coarse locations have been visited so far during the search for the body. Right: Final detection of the posture using the coarse detection algorithm. Scale bars represent 100 μm.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.g001" position="float" xlink:type="simple"/>
</fig>
<p>The edge configurations in body and head regions of the worm can be described through simple masks (<xref rid="pcbi.1004517.g001" ref-type="fig">Fig 1B</xref>). Body segments exhibit inversely polarized edges separated by a characteristic distance and head segments exhibit inversely polarized outer edges as well as inversely polarized inner edges. We use one mask for each of four head segment orientations and one mask for each of four body segment orientations. The size of these feature masks is scaled to the expected worm width. Formally, the image features are defined as statistical models for local regions of the edge arrays with elevated probabilities for corresponding edges in the specified areas. It is assumed that edges are independent given the feature type. Feature detection is based on likelihood ratio tests, which compare each of these models to a background model under which edges of all types have a low probability. The null hypothesis that the edges follow the background model is rejected whenever the number of corresponding edges in the specified areas exceeds a threshold (<xref rid="pcbi.1004517.s005" ref-type="supplementary-material">S1 Table</xref>). The oriented feature is then declared to be `on’ at the test location and registered on the coarse grid <italic>H</italic> (<xref rid="pcbi.1004517.g001" ref-type="fig">Fig 1A</xref>). This results in feature arrays <italic>X</italic><sub><italic>f</italic></sub>(<italic>Z</italic>) for <italic>f</italic> ∈ <italic>F</italic>,<italic>z</italic> ∈ <italic>H</italic>, where <italic>F</italic> is the set of eight features types.</p>
</sec>
<sec id="sec005">
<title>(ii) Admissible instantiations and the prior</title>
<p>The posture of <italic>C</italic>. <italic>elegans</italic> in a given image is described by a sequence <inline-formula id="pcbi.1004517.e001"><alternatives><graphic id="pcbi.1004517.e001g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e001" xlink:type="simple"/><mml:math display="inline" id="M1" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of neighboring points on the coarse grid <italic>H</italic>. The locations of these points as well as the length of the sequence are unknown. Biomechanical constraints limit the maximal curvature that the body of the animal can support [<xref rid="pcbi.1004517.ref007" ref-type="bibr">7</xref>]. We thus restrict the set of admissible instantiations to incorporate the smoothness of attainable postures into our model. We require that for each triple of points <italic>θ</italic><sub><italic>i</italic>-1</sub>,<italic>θ</italic><sub><italic>i</italic></sub>,<italic>θ</italic><sub><italic>i</italic>+1</sub> the directions defined by {<italic>θ</italic><sub><italic>i</italic>-1</sub>,<italic>θ</italic><sub><italic>i</italic></sub>} and {<italic>θ</italic><sub><italic>i</italic></sub>,<italic>θ</italic><sub><italic>i</italic>+1</sub>} differ by either <italic>0°</italic> or <italic>±45°</italic>. In other words, given <italic>θ</italic><sub><italic>i</italic>-1</sub> and <italic>θ</italic><sub><italic>i</italic></sub> there are three possible positions for <italic>θ</italic><sub><italic>i</italic>+1</sub>. An additional hard constraint we use is that the midline (but not necessarily the entire body) of the animal is self-avoiding, i.e., every point can appear at most once in the sequence. This constraint can be relaxed and replaced by a penalty term for self-crossing. Taken together, these restrictions successfully suppress erroneous detections corresponding to postures that are not naturally observed while maintaining sufficient flexibility for approximating all observed postures.</p>
<p>A reliable coarse detection of the posture can typically be obtained using a uniform prior on the space of admissible instantiations. However, we found that our method identifies complex postures more robustly when information about the expected length of the animal was taken into consideration. This was done using the prior <italic>P</italic>(<italic>θ</italic>) exp[−<italic>A</italic>(<italic>n</italic>−<italic>λ</italic>)<sup>2</sup>], where <italic>n</italic> is the number of points in the sequence, <italic>λ</italic> is the expected length of the worm and A &gt; 0 is a constant that determines the precision of the prior.</p>
</sec>
<sec id="sec006">
<title>(iii) The data model</title>
<p>We now specify the probability distribution of the features given an instantiation <inline-formula id="pcbi.1004517.e002"><alternatives><graphic id="pcbi.1004517.e002g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e002" xlink:type="simple"/><mml:math display="inline" id="M2" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>. As seen in <xref rid="pcbi.1004517.g001" ref-type="fig">Fig 1A</xref>, features with the correct orientation appear on the midline with high probability and in the vicinity of the midline with medium probability. Features with different orientations, as well as any features away from the midline, occur with low probability. This motivated the following model.</p>
<p>We denote the feature type with orientation parallel to the direction {<italic>θ</italic><sub><italic>i</italic>-1</sub>,<italic>θ</italic><sub><italic>i</italic></sub>} by <italic>f</italic><sub><italic>i</italic></sub>. For each point <italic>θ</italic><sub><italic>i</italic></sub> in the sequence <inline-formula id="pcbi.1004517.e003"><alternatives><graphic id="pcbi.1004517.e003g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e003" xlink:type="simple"/><mml:math display="inline" id="M3" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> we denote the two nearest neighbors in the direction orthogonal to {<italic>θ</italic><sub><italic>i</italic>-1</sub>,<italic>θ</italic><sub><italic>i</italic></sub>} by <italic>θ</italic><sub><italic>i</italic>−</sub> and <italic>θ</italic><sub><italic>i</italic>+</sub>. In addition, define <italic>H</italic><sub><italic>θ</italic></sub> to be the set of locations on the coarse grid consisting of all points in <inline-formula id="pcbi.1004517.e004"><alternatives><graphic id="pcbi.1004517.e004g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e004" xlink:type="simple"/><mml:math display="inline" id="M4" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> and all of their respective orthogonal neighbors. Assuming that all features are conditionally independent given <inline-formula id="pcbi.1004517.e005"><alternatives><graphic id="pcbi.1004517.e005g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e005" xlink:type="simple"/><mml:math display="inline" id="M5" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> we obtain:
<disp-formula id="pcbi.1004517.e006">
<alternatives>
<graphic id="pcbi.1004517.e006g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e006" xlink:type="simple"/>
<mml:math display="block" id="M6" overflow="scroll">
<mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mtext>          </mml:mtext><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mi>F</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>≠</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
<disp-formula id="pcbi.1004517.e007">
<alternatives>
<graphic id="pcbi.1004517.e007g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e007" xlink:type="simple"/>
<mml:math display="block" id="M7" overflow="scroll">
<mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mtext>          </mml:mtext><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>±</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mi>F</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>±</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>±</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>≠</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>±</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>±</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
<disp-formula id="pcbi.1004517.e008">
<alternatives>
<graphic id="pcbi.1004517.e008g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e008" xlink:type="simple"/>
<mml:math display="block" id="M8" overflow="scroll">
<mml:mrow><mml:mo>∀</mml:mo><mml:mi>y</mml:mi><mml:mo>∉</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mtext>        </mml:mtext><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mi>F</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula></p>
<p>Estimates for <italic>p</italic><sub><italic>high</italic></sub>, <italic>p</italic><sub><italic>med</italic></sub>, and <italic>p</italic><sub><italic>low</italic></sub> were obtained from regions in a small number of images where body and head segments were identified manually together with their orientation. With this data model the posterior probability of an instantiations <inline-formula id="pcbi.1004517.e009"><alternatives><graphic id="pcbi.1004517.e009g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e009" xlink:type="simple"/><mml:math display="inline" id="M9" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> will be high if the orientations {<italic>θ</italic><sub><italic>i</italic>-1</sub>,<italic>θ</italic><sub><italic>i</italic></sub>} are in agreement with the detected features.</p>
</sec>
<sec id="sec007">
<title>(iv) The coarse detection algorithm</title>
<p>The posture detection algorithm starts by exclusively using the head features in order to identify a sub-instantiation (<italic>θ</italic><sub>1</sub>,…,<italic>θ</italic><sub><italic>m</italic></sub>) corresponding to the head of the worm. This leverages the observation that head features are much sparser than body features. Also, simple heuristics can be used to find candidates of starting points (<italic>θ</italic><sub>1</sub>,<italic>θ</italic><sub>2</sub>). After the head is identified a search starting from either end (<italic>θ</italic><sub>1</sub> or <italic>θ</italic><sub><italic>m</italic></sub>) is performed to detect the body and determine the full instantiation (<italic>θ</italic><sub>1</sub>,…,<italic>θ</italic><sub><italic>n</italic></sub>).</p>
<p>The algorithm summarized below successively searches for instantiations that possess one additional point while keeping track of multiple instantiations as long as they have potential to grow to the instantiation with overall best posterior.</p>
<p>Input: feature maps <italic>X</italic><sub><italic>f</italic></sub>, feature probabilities <italic>p</italic><sub><italic>low/high/medium</italic></sub>, a priori length <italic>λ</italic> and prior precision <italic>A</italic>.</p>
<list list-type="order">
<list-item><p>Identify the starting points (<italic>θ</italic><sub>1</sub>,<italic>θ</italic><sub>2</sub>) and initialize the variables <italic>candidates</italic>←{(<italic>θ</italic><sub>1</sub>,<italic>θ</italic><sub>2</sub>)} and <italic>best</italic>←{(<italic>θ</italic><sub>1</sub>,<italic>θ</italic><sub>2</sub>)}.</p></list-item>
<list-item><p>For <italic>n = 3</italic>, <italic>4</italic>,…
<list list-type="alpha-lower">
<list-item><p>Find admissible instantiations {<italic>inst</italic><sub>1</sub>,<italic>inst</italic><sub>2</sub>,…} of length n by adding a single point to each of the instantiations from <italic>candidates</italic> (there are at most three possible extensions for each candidate due to the constraint on triplets of consecutive points). Empty the list <italic>candidates</italic>.</p></list-item>
<list-item><p>Calculate the posterior of the new instantiations {<italic>inst</italic><sub>1</sub>,<italic>inst</italic><sub>2</sub>,…}.</p></list-item>
<list-item><p>If log[<italic>posterior</italic>(<italic>inst</italic><sub><italic>n</italic></sub>)] ≥ log[<italic>posterior</italic>(<italic>best</italic>)]−<italic>DIFF</italic> store the instantiation <italic>inst</italic><sub><italic>n</italic></sub> in <italic>candidates</italic> (for multiple instantiations with the same endpoint only store the best one).</p></list-item>
<list-item><p>Replace <italic>best</italic> if the instantiation with the highest posterior is better.</p></list-item>
</list></p></list-item>
<list-item><p>Stop the loop when no improvement occurred, i.e., when <italic>best</italic> was not replaced for a small number of iterations (2 for the head search and 3 for the body search).</p></list-item>
</list>
<p>Output: detected coarse instantiation (<italic>θ</italic><sub>1</sub>,…,<italic>θ</italic><sub><italic>n</italic></sub>).</p>
<p>It is important to keep searching for a few iterations even if no improvement was found in order to be able to pass through regions where features are missing. The parameter <italic>DIFF</italic> determines how permissive the search is, i.e., how many candidates are tracked at a time. Throughout this work, we used <italic>DIFF</italic> = <italic>α</italic>{[log(<italic>p</italic><sub><italic>high</italic></sub>)+2log(<italic>p</italic><sub><italic>med</italic></sub>)−3log(<italic>p</italic><sub><italic>low</italic></sub>)]−[log(1−<italic>p</italic><sub><italic>high</italic></sub>)+2log(1−<italic>p</italic><sub><italic>med</italic></sub>)−3log(1−<italic>p</italic><sub><italic>low</italic></sub>)]} with <italic>α</italic> = 3. In words, this is a small multiple of the difference in log-likelihood ratio between a perfect and a worse case additional point for a coarse instantiation.</p>
<p>Our algorithm is adaptive in the sense that multiple hypothetical body midlines are traced until the uncertainty is resolved. In regions with informative features the procedure essentially behaves as a depth-first search. However, in regions with no detected features it works as a breadth-first search. <xref rid="pcbi.1004517.g001" ref-type="fig">Fig 1C</xref> shows how the detected posture can change as the search progresses and more data are incorporated into the evaluation. In our experiments, the candidate list typically consisted of 10 to 30 instantiations and the runtime of the coarse detection was approximately 100 ms on a standard desktop machine, where approximately half of the time was spent to compute the edges and the features.</p>
</sec>
</sec>
<sec id="sec008">
<title>A fine statistical model can accurately identify complex postures</title>
<p>The estimated point sequence <inline-formula id="pcbi.1004517.e010"><alternatives><graphic id="pcbi.1004517.e010g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e010" xlink:type="simple"/><mml:math display="inline" id="M10" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> on the coarse grid facilitates finding the boundaries of the animal body at the resolution of the original grid, from which a refined midline can be derived. The key components of this model and the resulting detection are described below.</p>
<sec id="sec009">
<title>(i) Admissible instantiations and the prior</title>
<p>The boundaries of the animal body are described through a sequence of points <inline-formula id="pcbi.1004517.e011"><alternatives><graphic id="pcbi.1004517.e011g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e011" xlink:type="simple"/><mml:math display="inline" id="M11" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> on the image grid <italic>G</italic>. The points <italic>η</italic><sub>0</sub> and <italic>η</italic><sub>2n</sub> correspond to the left and right side of the tail, while <italic>η</italic><sub><italic>n</italic></sub> corresponds to the tip of the head. For every point <italic>η</italic><sub><italic>i</italic></sub> a small subset <italic>G</italic><sub><italic>i</italic></sub> ⊂ <italic>G</italic> of admissible locations is derived from the coarse instantiation (see <xref rid="pcbi.1004517.g002" ref-type="fig">Fig 2A</xref>). In addition, the expected orientation for each line segment {<italic>η</italic><sub>i−1</sub>,<italic>η</italic><sub><italic>i</italic></sub>}, denoted <italic>β</italic><sub><italic>i</italic></sub>, is determined from the corresponding orientation of the coarse detection. The prior <inline-formula id="pcbi.1004517.e012"><alternatives><graphic id="pcbi.1004517.e012g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e012" xlink:type="simple"/><mml:math display="inline" id="M12" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is then imposed on the instantiations <inline-formula id="pcbi.1004517.e013"><alternatives><graphic id="pcbi.1004517.e013g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e013" xlink:type="simple"/><mml:math display="inline" id="M13" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>a<sub>i</sub></italic> denotes the actual orientation of the line segment {<italic>η</italic><sub><italic>i</italic>−1</sub>,<italic>η</italic><sub><italic>i</italic></sub>} and B &gt; 0 is a constant that determines the precision of the prior.</p>
<fig id="pcbi.1004517.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004517.g002</object-id>
<label>Fig 2</label>
<caption>
<p>(A) Left: a smoothed midline and admissible regions (magenta) for the fine detection of the posture of a wild-type animal. Right: the corresponding fine instantiation. (B) Additional examples of detected non-self-avoiding postures, rarely exhibited by wild-type animals. The midline and edges of the animal are depicted in yellow and green, respectively. The head and the tail of the animal are depicted in blue and red, respectively. Scale bar represents 100 μm.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.g002" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec010">
<title>(ii) The data model</title>
<p>We approximate the orientations <italic>α</italic><sub><italic>i</italic></sub> to be horizontal, vertical or at <italic>±45°</italic>. This allows us to associate each line segment {<italic>η</italic><sub><italic>i</italic>−1</sub>,<italic>η</italic><sub><italic>i</italic></sub>} on the image grid <italic>G</italic> with an edge type <italic>e</italic><sub><italic>i</italic></sub>. The statistical model for the original edge data is then motivated by the following observations. Edges with the appropriate orientation appear on the boundaries of the body with a high probability <italic>p</italic><sub><italic>obj</italic></sub>. However, edges of different orientations at these locations or any edge away from the boundaries of the body are only detected with low probability <italic>p</italic><sub><italic>bg</italic></sub>. Analogously to the coarse model we assume that the edges <italic>X</italic><sub><italic>e</italic></sub>(<italic>y</italic>), <italic>e</italic> ∈ <italic>E</italic>, <italic>y</italic> ∈ <italic>G</italic> are conditional independent given the instantiation <inline-formula id="pcbi.1004517.e014"><alternatives><graphic id="pcbi.1004517.e014g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e014" xlink:type="simple"/><mml:math display="inline" id="M14" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1004517.e015">
<alternatives>
<graphic id="pcbi.1004517.e015g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e015" xlink:type="simple"/>
<mml:math display="block" id="M15" overflow="scroll">
<mml:mrow><mml:mo>∀</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mtext>           </mml:mtext><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>η</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>≠</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>b</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
<disp-formula id="pcbi.1004517.e016">
<alternatives>
<graphic id="pcbi.1004517.e016g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e016" xlink:type="simple"/>
<mml:math display="block" id="M16" overflow="scroll">
<mml:mrow><mml:mo>∀</mml:mo><mml:mi>y</mml:mi><mml:mo>∉</mml:mo><mml:mtext>any line segment    </mml:mtext><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>η</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>b</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula></p>
</sec>
<sec id="sec011">
<title>(iii) The fine detection algorithm</title>
<p>The boundaries of the body can efficiently be detected with a dynamic programming procedure, successively reducing the problem by one variable. This is possible because the log-posterior is of the form <inline-formula id="pcbi.1004517.e017"><alternatives><graphic id="pcbi.1004517.e017g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e017" xlink:type="simple"/><mml:math display="inline" id="M17" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula>, i.e., it is a sum of functions of successive points in the sequence <inline-formula id="pcbi.1004517.e018"><alternatives><graphic id="pcbi.1004517.e018g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e018" xlink:type="simple"/><mml:math display="inline" id="M18" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>. A detailed presentation of dynamic programming for a similar statistical model can be found in [<xref rid="pcbi.1004517.ref015" ref-type="bibr">15</xref>]. The resulting boundaries and refined midlines for sample images are shown in <xref rid="pcbi.1004517.g002" ref-type="fig">Fig 2B</xref>. The runtime of the fine detection procedure is typically less than 50 ms on a standard desktop machine.</p>
</sec>
<sec id="sec012">
<title>The statistical framework can be readily extended or refined</title>
<p>Although the approach as described above offered significant improvement as compared to traditional trackers, it exhibited limited success rates for certain classes of postures. These included fully and tightly coiled postures, which readily occurred when body boundaries remained in continuous contact for extended periods, or postures that were enriched when a large number of collisions of the head and the tail occurred in quick succession. In order to enable the detection of such difficult postures we designed a more sophisticated version of the algorithm for the analysis of a single image.</p>
<p>First, we introduced an additional body feature where the edge areas are two worm widths apart instead of one. If the test is positive corresponding features are placed at the hypothesized centers of the two body segments. This was necessary in order to detect locations where two parts of the body aligned against each other, which previously led to regions with missing features. Second, the coarse statistical algorithm was changed to retain multiple candidate sub-instantiations for the head (one for each cluster of head features) rather than simply choosing the most likely one. Often, only a single cluster of head features was present, but in complex cases 2–3 clusters may have been generated. A search for the full head and body instantiation was then initiated using each of the candidate head detections <inline-formula id="pcbi.1004517.e019"><alternatives><graphic id="pcbi.1004517.e019g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e019" xlink:type="simple"/><mml:math display="inline" id="M19" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The full instantiation <inline-formula id="pcbi.1004517.e020"><alternatives><graphic id="pcbi.1004517.e020g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.e020" xlink:type="simple"/><mml:math display="inline" id="M20" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>n</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> with the highest posterior was declared as the solution to the detection problem. Avoiding an all-or-none decision at the stage of the coarse head identification enabled treatment of false positive detections of head features, which were a key cause of errors in the basic implementation. An example of the resulting detection steps in a case where large portions of the body boundaries are in continuous contact is shown in <xref rid="pcbi.1004517.g003" ref-type="fig">Fig 3A–3D</xref> and <xref rid="pcbi.1004517.s006" ref-type="supplementary-material">S1 Movie</xref>. The total runtime of this improved search was typically less than 200 ms per frame on a standard desktop machine.</p>
<fig id="pcbi.1004517.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004517.g003</object-id>
<label>Fig 3</label>
<caption>
<p>(A) Head (cyan) and body (yellow) features of an <italic>egl-30</italic> mutant, as determined by the basic algorithm. (B) Same as (A) with added double-body (magenta) features, as determined by the improved algorithm. (C) Coarse detection of the posture of the <italic>egl-30</italic> mutant using the improved algorithm. (D) Fine detection of the posture of the <italic>egl-30</italic> mutant. (E) Examples of non-self-avoiding postures detected in six mutants that exhibit coiler phenotypes. The midline and edges of the animal are depicted in green and red, respectively. Scale bars represent 100 μm.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.g003" position="float" xlink:type="simple"/>
</fig>
<p>These modifications demonstrate the flexibility of the proposed approach: image features can be replaced or added in response to the appearance of the observed object. More generally, adapting the statistical model or the search algorithm allows for improving detection in a wide range of experimental conditions. We note that no additional parameters or tuning of the existing values was necessary. All parameter values, as listed in <xref rid="pcbi.1004517.s005" ref-type="supplementary-material">S1 Table</xref>, were set once during the development of the analysis code and were not further tuned for any of the experiments.</p>
</sec>
</sec>
<sec id="sec013">
<title>Statistical image detection enables automatic characterization of coiling phenotypes</title>
<p>To test the proposed algorithm we assayed wild-type animals and mutants that were previously reported to exhibit coiling. Of particular interest were three strains with severe locomotion defects. The G<sub>q</sub> protein alpha subunit ortholog, encoded by <italic>egl-30</italic>, was shown to affect locomotion, viability, egg laying, synaptic transmission, and pharyngeal pumping [<xref rid="pcbi.1004517.ref016" ref-type="bibr">16</xref>–<xref rid="pcbi.1004517.ref028" ref-type="bibr">28</xref>]. The voltage-insensitive cation leak channel, a subunit of which is encoded by <italic>unc-77/nca-1</italic>, assists transmission of presynaptic activation from the cell body to the synapses [<xref rid="pcbi.1004517.ref029" ref-type="bibr">29</xref>,<xref rid="pcbi.1004517.ref030" ref-type="bibr">30</xref>]. The <italic>unc-8</italic> gene encodes a putative mechanosensory channel [<xref rid="pcbi.1004517.ref031" ref-type="bibr">31</xref>]. A gain-of-function (gf) allele of either of these genes result in exaggerated body bends and coiling [<xref rid="pcbi.1004517.ref027" ref-type="bibr">27</xref>,<xref rid="pcbi.1004517.ref030" ref-type="bibr">30</xref>,<xref rid="pcbi.1004517.ref031" ref-type="bibr">31</xref>].</p>
<p>Examples of successfully detected complex postures for six mutants that display a coiler phenotype are shown in <xref rid="pcbi.1004517.g003" ref-type="fig">Fig 3E</xref> and <xref rid="pcbi.1004517.s007" ref-type="supplementary-material">S2 Movie</xref>. In this work, anterior coils were defined as periods when the head was in close proximity to any point along the body (within 5% of the midline). Posterior coils were similarly defined for the tail. We note that these definitions were not mutually exclusive (<xref rid="pcbi.1004517.g004" ref-type="fig">Fig 4A</xref>). The rate of detections using the generative statistical algorithm was compared to that of a previously described image analysis tool [<xref rid="pcbi.1004517.ref009" ref-type="bibr">9</xref>], which uses a standard morphological approach for single-frame detection that solely relies on the contrast between object and background (see also the <xref rid="sec017" ref-type="sec">Discussion</xref> section). The statistical approach yielded midlines of appropriate length for &gt;90% of the images and these midlines were very similar to those obtained using the morphological approach, when the latter was available. For coiler mutants, the differences between the two algorithms mirrored the abundance of coils, indicating that detecting complex postures was key to the observed improvements (<xref rid="pcbi.1004517.g004" ref-type="fig">Fig 4B</xref>).</p>
<fig id="pcbi.1004517.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004517.g004</object-id>
<label>Fig 4</label>
<caption>
<p>(A) Anterior coils and posterior coils exhibited by an animal carrying the <italic>egl-30(gf)</italic> allele. Arrows and arrow-heads point to the head (blue) and tail (magenta) of the animals, respectively. (B) Top: the percentage of frames in which posture was successfully identified in wild-type animals and coiler mutants using morphological operations or a generative statistical model. Bottom: the percentage of frames in which a coiled posture was detected. In panel (B), 9–12 L4 larvae of each genotype were imaged at 10 frames per second for 2–4 hours, yielding a total of approximately 10<sup>5</sup> images. Error bars and thin lines depict animal-to-animal variation (mean ± s.e.m).</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.g004" position="float" xlink:type="simple"/>
</fig>
<p>As a coarse measure of the severity of different coiling defects, the durations and frequencies of coiling were measured for each of the strains tested. Typical timescales were obtained by fitting the data to a Weibull distribution [<xref rid="pcbi.1004517.ref032" ref-type="bibr">32</xref>] (<xref rid="pcbi.1004517.g005" ref-type="fig">Fig 5A</xref>) and the full distributions for a severe coiler, <italic>egl-30(gf)</italic>, are depicted in <xref rid="pcbi.1004517.s002" ref-type="supplementary-material">S2 Fig</xref>. The proposed algorithm thus enabled us to obtain a nearly continuous record of posture dynamics, uninterrupted by coiling.</p>
<fig id="pcbi.1004517.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004517.g005</object-id>
<label>Fig 5</label>
<caption>
<p>(A) The characteristic duration (left) and frequency (right) of continuous periods of coiling. (B) The fraction of bouts of forward (left) and backward (right) locomotion that contained coiled postures. The majority of bouts of directed locomotion of <italic>egl-30(gf)</italic> and <italic>unc-8(gf)</italic> mutants involved coiled postures. (C) A continuous period during which the animal was coiled, termed a coiling event, could contain sub-periods of forward or backward locomotion in addition to dwelling. Filled bars depict the fractions of the durations of coiling events that were spent exhibiting locomotion in a given direction. The mean propensities for directed locomotion when the animal was not coiling (empty bars) were measured as a baseline for comparisons. Asterisks denote that the propensity during coiling of the locomotion state in question was higher than its corresponding baseline (p&lt;0.01). In all panels, 9–12 L4 larvae of each genotype were imaged at 10 frames per second for 2–4 hours, yielding a total of approximately 10<sup>5</sup> images. Error bars and thin lines depict animal-to-animal variation (mean ± s.e.m).</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.g005" position="float" xlink:type="simple"/>
</fig>
<p>To examine the relation between coiling and locomotion, we derived the propagation of dorsoventral body-bends from the time-series of postures as previously described (see <xref rid="sec018" ref-type="sec">Materials and Methods</xref> section and [<xref rid="pcbi.1004517.ref009" ref-type="bibr">9</xref>]). Coiling events in wild-type animals were rare, their durations were short, and they rarely interrupted directed locomotion (<xref rid="pcbi.1004517.g005" ref-type="fig">Fig 5A and 5B</xref>). In contrast, the majority of bouts of directed locomotion were interrupted by coiling in <italic>egl-30(gf)</italic>, and <italic>unc-8(gf)</italic> mutants and coils were longer and more frequent than wild-type in these mutants (<xref rid="pcbi.1004517.g005" ref-type="fig">Fig 5A and 5B</xref>).</p>
<p>During continuous periods in which the posture of <italic>C</italic>. <italic>elegans</italic> is non-self-avoiding, the directional propagation of body bends can be disrupted to varying degrees. Therefore, an alternative measure of the impact of coiling can be obtained by asking how it affects directed locomotion. To address this, we measured the propensities for directed locomotion during coiling events. In each case, these propensities were compared to their baseline values, i.e., when coiling was absent (<xref rid="pcbi.1004517.g005" ref-type="fig">Fig 5C</xref>). Wild-type animals mostly progressed forward during a coil. This was the case since wild-type coiling was largely caused by Ω-turns which facilitate turning and are not detrimental to directed locomotion (see below). In <italic>egl-30(gf)</italic> and <italic>unc-77/nca-1(gf)</italic> mutants, propensities for forward or backward locomotion exceeded their baseline levels during anterior or posterior coiling, respectively (<xref rid="pcbi.1004517.g005" ref-type="fig">Fig 5C</xref>). Thus, in these mutants directed propagation of dorsoventral bends could be sustained despite coiling and, as further shown below, locomotion and coiling were likely linked. Taken together, these results suggest that the proposed statistical approach can be used to characterize coiler phenotypes.</p>
</sec>
<sec id="sec014">
<title>Coiler phenotypes can be intuitively classified using projections to low-dimensional spaces</title>
<p>Principal component analysis (PCA) was proposed as an unbiased and efficient approach for describing <italic>C</italic>. <italic>elegans</italic> behavior [<xref rid="pcbi.1004517.ref007" ref-type="bibr">7</xref>]. It has been used to characterize the dimensionality and dynamics of locomotion, as well as behavioral motifs [<xref rid="pcbi.1004517.ref007" ref-type="bibr">7</xref>,<xref rid="pcbi.1004517.ref008" ref-type="bibr">8</xref>,<xref rid="pcbi.1004517.ref033" ref-type="bibr">33</xref>,<xref rid="pcbi.1004517.ref034" ref-type="bibr">34</xref>]. When complex postures are largely inaccessible, two of the leading modes describe sinuous oscillations associated with directed locomotion and a third is associated with turning [<xref rid="pcbi.1004517.ref007" ref-type="bibr">7</xref>,<xref rid="pcbi.1004517.ref034" ref-type="bibr">34</xref>].</p>
<p>We constructed an ensemble of complex postures by equally sampling the coiled postures of the mutants we assayed. The resulting two leading modes were associated predominantly with anterior and posterior curvature. Thus, the severity and direction (dorsal/ventral) of anterior and posterior coils corresponded to the amplitudes and signs of these modes, respectively (<xref rid="pcbi.1004517.g006" ref-type="fig">Fig 6A and 6B</xref>). The third mode contributed opposite curvatures to the edges and the mid-body. Additional modes introduce higher order corrections and more than 95% of the variance in the data was accounted for by the leading six modes (<xref rid="pcbi.1004517.g006" ref-type="fig">Fig 6A and 6B</xref>).</p>
<fig id="pcbi.1004517.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004517.g006</object-id>
<label>Fig 6</label>
<caption>
<p>(A) The leading four PCA modes for individual coiler mutants (thin lines) and for the combined coiler dataset (thick lines). (B) Left: the variance explained by the modes of the combined coiler dataset in order of their significance. Dashed line represents 95%. Middle/right: centroids of posture clusters were projected onto the plane of the two leading modes. Typical coiling postures were reconstructed from centroids. The intuitive interpretation of the two leading modes is demonstrated by the separation between ventral (positive amplitudes) and dorsal (negative amplitudes) coiling. (C) The dynamics of the amplitudes of the three leading modes during continuous periods of coiling. The duration of individual coiling events were normalized such that the horizontal axis depicts the fraction of duration of the coiling event (mean durations for each strain can be seen in <xref rid="pcbi.1004517.g005" ref-type="fig">Fig 5A</xref>). (D) Left: for each strain shown, the 10 most populated cluster centroids for spools (coiled postures for which <italic>a</italic><sub>1</sub>·<italic>a</italic><sub>2</sub> &gt; 1) were projected onto the plane of the two leading modes and their convex hull was calculated. These convex hulls for wild-type animals (red), static coilers (blue shades) and loopy movers (orange shades) are shown in the plane of the two leading modes. Example postures were reconstructed from the cluster centroids (blue curves). Dotted lines point from the position of a cluster centroid to the reconstruction of its respective body posture. Grey circles at edges of reconstructed postures denote the position of the head. Right: the fraction of severe spools exhibited by wild-type animals and coiler mutants in our assays. Error bars and thin lines depict animal-to-animal variation (mean ± s.e.m). Eigenworms are represented using angle differences (49) as opposed to angles with a fixed axis (7) (see <xref rid="sec018" ref-type="sec">Materials and Methods</xref>).</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.g006" position="float" xlink:type="simple"/>
</fig>
<p>Identifying typical coiling postures is ambiguous due to their broad distributions. Nevertheless, a heuristic definition can highlight prominent features and provide a useful starting point. We used k-means clustering to sub-divide the dataset of amplitudes of the modes composing coiled postures. Scree plots [<xref rid="pcbi.1004517.ref035" ref-type="bibr">35</xref>] would typically lead to dividing a coiler dataset to k = 6–8 similarly sized clusters. However, we found that generating a larger number of smaller clusters was useful: the centroids of the most populated small clusters resembled postures that were frequently observed in the raw data. Representative examples of cluster centroids and the postures that were reconstructed from them were projected onto the plane of the two leading modes and depicted in <xref rid="pcbi.1004517.g006" ref-type="fig">Fig 6B</xref>.</p>
<p>The dynamics of the amplitudes during continuous periods of coiling could vary between different animals and different types of coils. At the two extremes, the duration of a coil could be spent in a static posture that is not easily released or in a continuous sequence of exaggerated body-bends (also referred to as loopy motion). The amplitudes of the leading modes demonstrate that posterior coils of <italic>egl-30(gf)</italic> and <italic>unc-77/nca-1(gf)</italic> mutants were highly dynamic, such that ventral (positive amplitudes) and dorsal (negative amplitudes) coiling were averaged out while the animal exhibited a continuous succession of non-self-avoiding postures. In contrast, anterior coils of <italic>unc-8(gf)</italic> and <italic>unc-3</italic> mutants were characterized by locking into a static coiled posture (<xref rid="pcbi.1004517.g006" ref-type="fig">Fig 6C</xref>).</p>
<p>More detailed information can be obtained from focusing on specific families of coils. We defined a spool as any posture for which the product of the two leading amplitudes, <italic>a</italic><sub>1</sub>·<italic>a</italic><sub>2</sub>, was larger than unity, i.e., anterior and posterior curvatures were sufficiently high and in the same direction. The centroids of the 10 most populated clusters of postures that satisfied this condition spanned the observed range of loops typical of Ω-turns to compact spirals. The shaded areas in the left panel of <xref rid="pcbi.1004517.g006" ref-type="fig">Fig 6D</xref> represent the convex hulls of these centroids for wild-type animals and four coiler mutants. The surrounding postures were reconstructed from 26 of these centroids. The center of the panel, where <italic>a</italic><sub>1</sub>·<italic>a</italic><sub>2</sub> was small, was populated by loops that could typically be observed during Ω-turns. As <italic>a</italic><sub>1</sub>·<italic>a</italic><sub>2</sub> grew larger, we preferentially observed spirals in which the head was at the center in <italic>unc-8(gf)</italic> and <italic>unc-122</italic> mutants. In contrast, we observed a significant fraction of spirals in which the tail was at the center in <italic>egl-30(gf)</italic> and <italic>unc-77/nca-1(gf)</italic> mutants. Taken together with the dynamics of the amplitude, these data suggested that the two pairs of mutants preferentially formed spirals differently. Exaggerating an anterior bend prevented dorsoventral undulations and developed into a static head-centered spiral, perhaps through proprioceptive coupling, i.e., the trigger that compels body regions to bend in the same direction as their anterior neighboring region after a short time delay during forward locomotion [<xref rid="pcbi.1004517.ref036" ref-type="bibr">36</xref>]. Reversing into an exaggerated posterior bend formed a tail-centered spiral that did not suppress dorsoventral bending and was more rapidly released. Assaying the propagation of body-bends concurrently with coiling (described below) supported this interpretation.</p>
<p>PCA analysis of spools can also be used to assess the severity of a defect. Wild-type animals rarely exhibit postures for which <italic>a</italic><sub>1</sub>·<italic>a</italic><sub>2</sub> &gt;4, but coilers do (<xref rid="pcbi.1004517.g006" ref-type="fig">Fig 6D</xref>, right panel) and this trend was not sensitive to the exact value of the threshold. Projecting the sub group of spools onto its own low-dimensional space could facilitate testing more detailed hypotheses. Intuitively, the resulting three leading principal components corresponded to nearly uniform curvature, tightening of anterior bending, and tightening of posterior bending (<xref rid="pcbi.1004517.s003" ref-type="supplementary-material">S3 Fig</xref>). Similarly applying the condition <italic>a</italic><sub>1</sub>·<italic>a</italic><sub>2</sub> &lt; −4 would result in charactering number-8-like coils where anterior and posterior curvature have opposite signs. These results demonstrate that complex posture recognition can be integrated with existing analysis methods for large scale and unbiased studies of severe locomotion defects.</p>
</sec>
<sec id="sec015">
<title>Initiating directed locomotion promotes coiling in <italic>egl-30(gf)</italic> and <italic>unc-77/nca-1(gf)</italic> mutants</title>
<p>Is the initiation of directed locomotion particularly favorable for coiling in certain mutant backgrounds? To address this question, we assayed the temporal dynamics of locomotion upon entering and exiting a coiling event (<xref rid="pcbi.1004517.g007" ref-type="fig">Fig 7</xref>). In large part, wild-type coiling resulted from omega turns: acute turns composed of a reversal, an Ω-like posture, and forward locomotion in the new direction [<xref rid="pcbi.1004517.ref037" ref-type="bibr">37</xref>–<xref rid="pcbi.1004517.ref041" ref-type="bibr">41</xref>]. As a result, a rise in the propensity to reverse was observed shortly prior to coiling and high levels of forward locomotion were observed immediately following the coil (<xref rid="pcbi.1004517.g007" ref-type="fig">Fig 7A</xref>). In the cases of <italic>egl-30(gf)</italic> and <italic>unc-77/nca-1(gf)</italic> mutants, the signature of a reversal-to-forward switch was detected immediately prior to entering an anterior coil (<xref rid="pcbi.1004517.g007" ref-type="fig">Fig 7B and 7C</xref>, middle panels). Upon posterior coiling, these mutants exhibited the opposite behavioral switch (<xref rid="pcbi.1004517.g007" ref-type="fig">Fig 7B and 7C</xref>, right panels). However, similar trends were not observed in other coiler mutants (<xref rid="pcbi.1004517.g007" ref-type="fig">Fig 7D and 7E</xref>).</p>
<fig id="pcbi.1004517.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004517.g007</object-id>
<label>Fig 7</label>
<caption>
<p>(A) Left: an overlay of postures before, during, and after coiling of a wild-type animal. Arrows depict the direction of locomotion and the scale bar represents 100 μm. Middle: the probabilities of forward locomotion, reversals, and non-directional dwelling before and after a detected period of anterior coiling. Right: locomotion probabilities before and after a period of posterior coiling. In the case of wild-type animals, most coiling events occur during Ω–turns. The horizontal time axis depicts the time leading to and immediately following a continuous period of coiling, i.e., the entry into and exit from a coiling event. The gaps signify that locomotion during the (variable) time of the coiling events themselves is not plotted. (B)-(E) The same as (A) for mutants exhibiting coiling phenotypes. In all panels, 9–12 L4 larvae of each genotype were imaged at 10 frames per second for 2–4 hours. Thin lines depict animal-to-animal variation (mean ± s.e.m).</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.g007" position="float" xlink:type="simple"/>
</fig>
<p>As a complementary measure of the association of coiling with locomotion transitions, we measured the fraction of coiling events that occurred within 5 sec from the initiation of directed locomotion. The signature of wild-type Ω-turns could be clearly detected: a large fraction of all coils promptly followed the initiation of forward locomotion after a reversal (<xref rid="pcbi.1004517.g008" ref-type="fig">Fig 8A</xref>). In coiler mutants, an exaggerated posterior body-bend upon a forward-to-reversal switch could increase the likelihood of coiling shortly following the initiation of the reversal. This trend (and the opposite one for anterior coiling) was displayed by <italic>egl-30(gf)</italic> and <italic>unc-77/nca-1(gf)</italic> mutants but not by other coilers (<xref rid="pcbi.1004517.g008" ref-type="fig">Fig 8A</xref>).</p>
<fig id="pcbi.1004517.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004517.g008</object-id>
<label>Fig 8</label>
<caption>
<p>(A) The fraction of coiling events that were detected within 5 sec of the initiation of directed locomotion. Loopy movers exhibit increased probabilities of anterior or posterior coiling upon initiating forward or backward locomotion, respectively. (B) Left: the probabilities of forward locomotion, reversals, and non-directional dwelling before and after a period of dwelling, after the onset of which anterior coiling was detected. Right: the probabilities of locomotion states before and after a period of dwelling, after the onset of which coiling was not detected. The horizontal time axis depicts the time leading to and immediately following a continuous period of dwelling, i.e., the entry into and exit from a dwelling event. The gaps signify that locomotion during the (variable) time of the coiling events themselves is not plotted. In all panels, 9–12 L4 larvae of each genotype were assayed for 2–4 hours. Error bars and thin lines depict animal-to-animal variation (mean ± s.e.m).</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.g008" position="float" xlink:type="simple"/>
</fig>
<p>Our analysis typically identified brief periods of dwelling during transitions between forward and backward locomotion. Therefore, to visualize selected behavioral trends at the termination and initiation of directed locomotion, we aligned the data at the initiation and termination of short bouts of dwelling. Locomotion was then compared between two sub-categories of the full dataset: events in which, shortly following the onset of dwelling, anterior coiling was identified or no coiling was detected (<xref rid="pcbi.1004517.g008" ref-type="fig">Fig 8B</xref>; additional examples shown in <xref rid="pcbi.1004517.s004" ref-type="supplementary-material">S4 Fig</xref>). Coiling upon switching by <italic>egl-30</italic> mutants manifested as an exaggerated reversals peak prior to dwelling and elevated forward propensities following dwelling. Thus, in <italic>egl-30(gf)</italic> and <italic>unc-77/nca-1(gf)</italic> mutants, the dorsoventral bends that initiate directed locomotion may be more likely to exaggerate and result in coiling than those that follow.</p>
</sec>
<sec id="sec016">
<title>Posterior hyper-bending is asymmetric in <italic>unc-77/nca-1(gf)</italic> mutants</title>
<p>Are coiler phenotypes asymmetric with respect to the dorsoventral axis? The deep head bend of an Ω- turn is known to be ventral (<xref rid="pcbi.1004517.g009" ref-type="fig">Fig 9A</xref>) [<xref rid="pcbi.1004517.ref037" ref-type="bibr">37</xref>–<xref rid="pcbi.1004517.ref041" ref-type="bibr">41</xref>]. However, ectopic deep bends could potentially arise from the misregulation of bending in either direction. Interestingly, posterior coiling of <italic>unc-77/nca-1(gf)</italic> mutants was more likely when the tail bent dorsally (<xref rid="pcbi.1004517.g009" ref-type="fig">Fig 9B</xref>). The asymmetry in the bending direction of the tail also manifested as higher dorsal (as compared to ventral) posterior curvature in the period leading to a coil (<xref rid="pcbi.1004517.g009" ref-type="fig">Fig 9C</xref>).</p>
<fig id="pcbi.1004517.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004517.g009</object-id>
<label>Fig 9</label>
<caption>
<p>(A) The probabilities of forward locomotion, reversals, and non-directional dwelling of wild-type animals before and after a detected period of anterior coiling. The data was plotted separately for ventral and dorsal coils. The signature of Ω-turns is only apparent in the case of ventral coils. (B) The fraction of the total number of detected coils that were initiated in a given direction. A dorsal preference for posterior coils was only observed in the case of <italic>unc-77/nca-1(gf)</italic> mutants. (C) The posterior relative body angle, i.e., the angle between the most posterior next nearest neighbor intervals out of a total of 20 intervals along the body. Dorsal hyper-bending was more pronounced in <italic>unc-77/nca-1(gf)</italic> (but not <italic>egl-30(gf)</italic> mutants).</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004517.g009" position="float" xlink:type="simple"/>
</fig>
<p>The NCA-1 leak channel was recently implicated in persistent motor circuit activity required for sustaining locomotion [<xref rid="pcbi.1004517.ref042" ref-type="bibr">42</xref>]. Curiously, the gain-of-function of UNC-77/NCA-1 was shown to eliminate some of the spontaneous activity in muscles (miniature postsynaptic currents) [<xref rid="pcbi.1004517.ref030" ref-type="bibr">30</xref>]. The asymmetric behavior of <italic>unc-77/nca-1(gf)</italic> mutants can lead to hypotheses regarding the structure and function of the backward motor circuit. For instance, given the expression of <italic>unc-77/nca-1</italic> in AVA premotor interneurons, AVA may be capable of asymmetrically activating dorsal and ventral motoneurons. Alternatively, <italic>unc-77/nca-1</italic> may be asymmetrically expressed in motoneurons [<xref rid="pcbi.1004517.ref043" ref-type="bibr">43</xref>] or not expressed in AS neurons which innervate only dorsal muscles [<xref rid="pcbi.1004517.ref002" ref-type="bibr">2</xref>,<xref rid="pcbi.1004517.ref030" ref-type="bibr">30</xref>,<xref rid="pcbi.1004517.ref044" ref-type="bibr">44</xref>]. In the latter case, AS may play a role in maintaining dorsoventral balance.</p>
<p>We note that the initiation of coiling is not generally restricted to the initiation of directed locomotion. To demonstrate this we examined animals carrying a gain-of-function mutation in the <italic>unc-8</italic> gene, encoding a putative mechanosensory channel [<xref rid="pcbi.1004517.ref031" ref-type="bibr">31</xref>] or a loss-of-function mutation of <italic>unc-122</italic>, affecting postsynaptic neuromuscular signaling [<xref rid="pcbi.1004517.ref045" ref-type="bibr">45</xref>]. Neither of these mutants exhibited the signature peaks associated with switching before coiling (Figs <xref rid="pcbi.1004517.g007" ref-type="fig">7D, 7E</xref>, <xref rid="pcbi.1004517.g008" ref-type="fig">8D and 8E</xref>). Curiously, <italic>unc-8(gf)</italic> was the only mutant we examined that exhibited significant anterior coiling while reversing, as evident by the unique rise of reversal probability prior to anterior coiling (<xref rid="pcbi.1004517.g007" ref-type="fig">Fig 7D</xref> left and middle panels). These data indicate that the proposed statistical model can be used for testing detailed hypotheses regarding cellular and molecular locomotion mechanisms.</p>
</sec>
</sec>
<sec id="sec017" sec-type="conclusions">
<title>Discussion</title>
<p>The standard approach for identifying <italic>C</italic>. <italic>elegans</italic> in a digitized image applies simple morphological operations and/or heuristically motivated processing steps [<xref rid="pcbi.1004517.ref005" ref-type="bibr">5</xref>]. Typically, a background subtraction step is followed by thresholding to obtain a binary image. The largest connected component in the binary image is identified as the animal. Next, morphological closing (dilations followed by erosions) or morphological hole filling is applied and a skeletonization algorithm computes the midline of the body. The head is distinguished from the tail either by manual inspection or by comparing the regions in vicinity of the end points of the midline. Typically, when imaging in “artificial dirt” chambers, the brighter region is associated with the head.</p>
<p>Alternatively, the boundaries of the body in the binary image are determined by subtracting an eroded version of the image (or an equivalent edge detection method). A spline can then be fitted to all boundary points and the end with the higher peak curvature is associated with the tail [<xref rid="pcbi.1004517.ref010" ref-type="bibr">10</xref>]. If visual inspection is feasible and the duration of the measurement is limited, manual detection of the head and information about the motion of the center of mass can be used to resolve situations where parts of the worm overlap [<xref rid="pcbi.1004517.ref011" ref-type="bibr">11</xref>–<xref rid="pcbi.1004517.ref014" ref-type="bibr">14</xref>]. Such approaches are limited in their ability to reliably detect complex (non-self-avoiding) postures based on a single frame.</p>
<p>The approaches described in [<xref rid="pcbi.1004517.ref011" ref-type="bibr">11</xref>–<xref rid="pcbi.1004517.ref013" ref-type="bibr">13</xref>] have been applied to non-self-avoiding postures (including some cases of self-crossing midlines) and implemented commercially. They are based upon a geometric model for postures and a motion model for deformations of postures during locomotion. The posture in a given frame is assumed to be a small deformation of the posture in the preceding frame. Given this assumption, complex postures are resolved by tracing them back to simpler ones. These approaches require an initially resolved simple posture that sufficiently resembles the complex one. The simple posture is either provided manually [<xref rid="pcbi.1004517.ref011" ref-type="bibr">11</xref>] or assumed to be automatically attainable [<xref rid="pcbi.1004517.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1004517.ref013" ref-type="bibr">13</xref>]. Once such an algorithm loses track of an animal it cannot autonomously recover, but may resume tracking given manual input [<xref rid="pcbi.1004517.ref011" ref-type="bibr">11</xref>].</p>
<p>These and similar approaches were not specifically designed to address severe phenotypes such as the prolonged continuous periods of coiling exhibited by <italic>egl-30(gf)</italic> mutants. Correspondingly, in published datasets, they were strictly applied to short video sequences in which bouts of coiling were brief. Our formulation of the object recognition problem is qualitatively different: we introduce sparse visual features that enable single-frame detection as opposed to solely relying on the differences in brightness between the imaged animal and its background. In addition to minimizing error propagation and manual intervention, single-frame detection can be parallelized easily and applied efficiently to large datasets.</p>
<p>An enhancement of the standard morphological methods is described in [<xref rid="pcbi.1004517.ref046" ref-type="bibr">46</xref>], where the skeleton could be determined for omega or spiral shaped postures. In this work, sophisticated heuristics were used to locate and dissect instances of self-touching for certain coiled body configurations. However, this approach is limited to specific postures and cannot be easily generalized. In addition, a laterally coupled snake model was developed for accurate contour detection of coiled animals [<xref rid="pcbi.1004517.ref047" ref-type="bibr">47</xref>]. When faced with complex postures, this method requires initializations that are close to the correct posture and therefore cannot be used in high-throughput, automated, applications.</p>
<p>Importantly, existing methods do not provide a measure of quality of detection, as they lack a cost function that allows comparison of candidate solutions in a meaningful way. A key advantage of a global generative statistical model is that it is principled: it enables to quantitatively assess the plausibility of the detected posture and can be naturally adapted to different experimental circumstances. An additional advantage of the proposed approach is its scalability. Analyzing a single frame at a time (rather than relying on neighboring frames) is an embarrassingly parallel problem, i.e., one that requires no dependency or communication between the parallel tasks, and eliminates propagation of errors. We implemented our algorithm using open source, freely available tools and libraries that are virtually guaranteed to be available at any research-computing environment. Therefore, our implementation can seamlessly be incorporate in a “big data” workflow for the timely analysis of large volumes of data.</p>
<p>In order to apply our approach to a different species it would be necessary to identify distinct visual features analogous to the edge formations described here. For this work it was sufficient to represent postures as a sequence of instantiation points but more sophisticated representations can be used instead.</p>
<p>To summarize, we presented a computationally efficient method, which correctly detects the posture of <italic>C</italic>. <italic>elegans</italic> in a variety of complex cases where standard morphological operations are inadequate. If higher precision is required, our fine detection method can be extended to a more computationally expensive procedure, e.g., an additional stage of further refinement. The presented analysis of coiler mutants demonstrates the flexibility and usability of this method for generating and testing detailed hypotheses.</p>
</sec>
<sec id="sec018" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec019">
<title>Strains</title>
<p><italic>C</italic>. <italic>elegans</italic> strains were maintained and grown according to standard protocols [<xref rid="pcbi.1004517.ref001" ref-type="bibr">1</xref>]. The following strains were used: wild-type strain N2, CG21 <italic>egl-30(tg26); him-5(e1490)</italic>, DR1089 <italic>unc-77(e625)</italic>, CB15 <italic>unc-8(e15)</italic>, CB4870 <italic>unc-122(e2520)</italic>, CB151 <italic>unc-3(e151)</italic>, CB719 <italic>unc-1(e719)</italic>.</p>
</sec>
<sec id="sec020">
<title>Locomotion assays</title>
<p>Animals were grown at 20°C on standard NGM plates seeded with <italic>E</italic>. <italic>coli</italic> OP50 bacteria. Mid to late L4 individuals were sealed into individual “artificial dirt” chambers filled with an overnight OP50 culture concentrated tenfold and resuspended in NGM medium [<xref rid="pcbi.1004517.ref048" ref-type="bibr">48</xref>]. Animals were imaged at 10 frames per second at a 4.2x magnification for posture-based analysis using a CCD camera (Prosilica GC2450, Allied Vision Technologies, Stadtroda, Germany). Motion and quiescence were identified using previously described methods [<xref rid="pcbi.1004517.ref049" ref-type="bibr">49</xref>].</p>
</sec>
<sec id="sec021">
<title>Analysis of behavior</title>
<p>The proposed algorithm for identifying body features was implemented in Python (performance-critical parts were programmed in Cython) and integrated with our previously described suite of image analysis tools, called PyCelegans [<xref rid="pcbi.1004517.ref009" ref-type="bibr">9</xref>,<xref rid="pcbi.1004517.ref049" ref-type="bibr">49</xref>]. In brief, once we identified the body midline, head, and tail in each frame, each midline was divided into 20 equal intervals and the relative angles of all 18 next-nearest neighbor interval pairs (corresponding to the curvature of the body) were calculated. The dynamics of these 18 relative angles were used to identify quiescence and directed locomotion states. The propagation of body bends from anterior to posterior or vice versa was defined as forward or backward locomotion, respectively. Complete lack of motion was defined as quiescence. All other states were defined as dwelling. Although directional propagation of body bends corresponded well to centroid motion, directed locomotion could be scored even if the animal was slipping and the centroid was not propagating in the laboratory frame of reference. Data analysis was performed using custom Matlab scripts (Mathworks Inc., Natick MA). Our source code and documentation are publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/david-biron/pycelegans-2.0" xlink:type="simple">https://github.com/david-biron/pycelegans-2.0</ext-link>.</p>
</sec>
<sec id="sec022">
<title>Statistical and numerical analysis</title>
<p>Data analysis was performed using custom Matlab scripts. For comparisons in summary statistics panels, significance was calculated using a one-way ANOVA test. Post-hoc correction for multiple comparisons was performed using the Bonferroni adjustment. For the purpose of performing principal component analysis (PCA), the posture of the animal was represented using the same 18 relative angles between next-nearest neighbor intervals that were used for the analysis of locomotion. For the purpose of calculating the principal modes, approximately 5,000 anterior coiled frames and 5,000 posterior coiled frames (or spooled, for <xref rid="pcbi.1004517.s003" ref-type="supplementary-material">S3 Fig</xref>) were randomly picked from the full dataset of each of the six coiler mutants assayed. Thus, PCA modes were calculated using a total of 60,000 frames. K-means clustering was performed with a redundancy of 5 using k = 50 clusters for <xref rid="pcbi.1004517.g006" ref-type="fig">Fig 6</xref> and k = 25 for the more restricted set of spools (<xref rid="pcbi.1004517.s003" ref-type="supplementary-material">S3 Fig</xref>). Results were not sensitive to an exact choice of the number of clusters, k.</p>
</sec>
</sec>
<sec id="sec023">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004517.s001" xlink:href="info:doi/10.1371/journal.pcbi.1004517.s001" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>The posture of a coiled nematode was similarly detected under different imaging conditions without changing the values of any of the model parameters.</title>
<p>(A) The contrast of the image was digitally scaled (top-left = 1.5, top-right = 1.0, bottom-left = 0.75, and bottom-right = 0.5). (B) The top-right image from (A) was blurred using Gaussian filters with standard deviations 2 (left) and 3 (right) pixels.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004517.s002" xlink:href="info:doi/10.1371/journal.pcbi.1004517.s002" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>The distributions of durations (left) and frequencies (right) of continuous periods of coiling of wild-type animals and <italic>egl-30(gf)</italic> mutants.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004517.s003" xlink:href="info:doi/10.1371/journal.pcbi.1004517.s003" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Left four panels: the leading four PCA modes for spools (coiled postures for which <italic>a</italic><sub>1</sub>·<italic>a</italic><sub>2</sub> &gt; 1) in the combined coiler dataset.</title>
<p>Right: The variance explained by the modes of the spools in order of their significance. Dashed line represents 95%. Note that in this work postures and eigenworms are represented using angle differences [<xref rid="pcbi.1004517.ref049" ref-type="bibr">49</xref>] as opposed to angles with a fixed axis [<xref rid="pcbi.1004517.ref007" ref-type="bibr">7</xref>] (see <xref rid="sec018" ref-type="sec">Methods</xref>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004517.s004" xlink:href="info:doi/10.1371/journal.pcbi.1004517.s004" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Left: the probabilities of forward locomotion, reversals, and non-directional dwelling before and after a period of dwelling, during the onset of which anterior coiling was detected.</title>
<p>Right: the probabilities of locomotion states before and after a period of dwelling, during the onset of which coiling was not detected. The horizontal time axis depicts the time leading to and immediately following a continuous period of dwelling. In all panels, 9–12 L4 larvae of each genotype were assayed for 2–4 hours. Thin lines depict animal-to-animal variation (mean ± s.e.m).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004517.s005" xlink:href="info:doi/10.1371/journal.pcbi.1004517.s005" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>A list of the parameters used by the proposed algorithm.</title>
<p>The values of the parameters were determined when the code was implemented and remained fixed throughout this work.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004517.s006" xlink:href="info:doi/10.1371/journal.pcbi.1004517.s006" mimetype="video/quicktime" position="float" xlink:type="simple">
<label>S1 Movie</label>
<caption>
<title>An example of running the statistical algorithm for posture recognition on an <italic>egl-30(gf)</italic> mutant exhibiting loopy motion.</title>
<p>Blue circle—head, magenta circle—tail, green line—body midline, red lines—body edges. The dimensions of the observation chamber are 0.95mm x 4mm.</p>
<p>(MOV)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004517.s007" xlink:href="info:doi/10.1371/journal.pcbi.1004517.s007" mimetype="video/quicktime" position="float" xlink:type="simple">
<label>S2 Movie</label>
<caption>
<title>An example of detection of complex postures of an <italic>egl-30(gf)</italic> mutant exhibiting severe coiling.</title>
<p>(MOV)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We would like to thank Gal Haspel and Mei Zhen for useful discussions. Some strains were provided by the CGC.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004517.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brenner</surname> <given-names>S</given-names></name> (<year>1974</year>) <article-title>The genetics of Caenorhabditis elegans</article-title>. <source>Genetics</source> <volume>77</volume>: <fpage>71</fpage>–<lpage>94</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=4366476&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=4366476&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">4366476</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>White</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Southgate</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Thomson</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Brenner</surname> <given-names>S</given-names></name> (<year>1986</year>) <article-title>The structure of the nervous system of the nematode Caenorhabditis elegans</article-title>. <source>Philos Trans R Soc London Ser B, Biol Sci</source> <volume>314</volume>: <fpage>1</fpage>–<lpage>340</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=22462104&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=22462104&amp;retmode=ref&amp;cmd=prlinks</ext-link>.</mixed-citation></ref>
<ref id="pcbi.1004517.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bargmann</surname> <given-names>CI</given-names></name>, <name name-style="western"><surname>Marder</surname> <given-names>E</given-names></name> (<year>2013</year>) <article-title>From the connectome to brain function</article-title>. <source>Nat Methods</source> <volume>10</volume>: <fpage>483</fpage>–<lpage>490</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=23817126&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=23817126&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">23866325</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Feng</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Cronin</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Wittig</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Sternberg</surname> <given-names>PW</given-names></name>, <name name-style="western"><surname>Schafer</surname> <given-names>WR</given-names></name> (<year>2004</year>) <article-title>An imaging system for standardized quantitative analysis of C. elegans behavior</article-title>. <source>BMC Bioinformatics</source> <volume>5</volume>: <fpage>115</fpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=15331023&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=15331023&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">15331023</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Geng</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Cosman</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Berry</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Schafer</surname> <given-names>WR</given-names></name> (<year>2004</year>) <article-title>Automatic tracking, feature extraction and classification of C elegans phenotypes</article-title>. <source>IEEE Trans Biomed Eng</source> <volume>51</volume>: <fpage>1811</fpage>–<lpage>1820</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=15490828&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=15490828&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">15490828</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ramot</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>MacInnis</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>H-C</given-names></name>, <name name-style="western"><surname>Goodman</surname> <given-names>MB</given-names></name> (<year>2008</year>) <article-title>Thermotaxis is a robust mechanism for thermoregulation in Caenorhabditis elegans nematodes</article-title>. <source>J Neurosci</source> <volume>28</volume>: <fpage>12546</fpage>–<lpage>12557</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=19020047&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=19020047&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.2857-08.2008" xlink:type="simple">10.1523/JNEUROSCI.2857-08.2008</ext-link></comment> <object-id pub-id-type="pmid">19020047</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stephens</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Johnson-Kerner</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Ryu</surname> <given-names>WS</given-names></name> (<year>2008</year>) <article-title>Dimensionality and dynamics in the behavior of C. elegans</article-title>. <source>PLoS Comput Biol</source> <volume>4</volume>: <fpage>e1000028</fpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=18389066&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=18389066&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000028" xlink:type="simple">10.1371/journal.pcbi.1000028</ext-link></comment> <object-id pub-id-type="pmid">18389066</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yemini</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Jucikas</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Grundy</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>AEX</given-names></name>, <name name-style="western"><surname>Schafer</surname> <given-names>WR</given-names></name> (<year>2013</year>) <article-title>A database of Caenorhabditis elegans behavioral phenotypes</article-title>. <source>Nat Methods</source> <volume>10</volume>: <fpage>877</fpage>–<lpage>879</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=23852451&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=23852451&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2560" xlink:type="simple">10.1038/nmeth.2560</ext-link></comment> <object-id pub-id-type="pmid">23852451</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nagy</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Tramm</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Labello</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Burov</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>A longitudinal study of Caenorhabditis elegans larvae reveals a novel locomotion switch, regulated by Gαs signaling</article-title>. <source>Elife</source> <volume>2</volume>: <fpage>e00782</fpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=23840929&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=23840929&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.7554/eLife.00782" xlink:type="simple">10.7554/eLife.00782</ext-link></comment> <object-id pub-id-type="pmid">23840929</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Husson</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Costa</surname> <given-names>WS</given-names></name>, <name name-style="western"><surname>Schmitt</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gottschalk</surname> <given-names>A</given-names></name> (<year>2012</year>) <article-title>Keeping track of worm trackers</article-title>. <source>WormBook</source>: <fpage>1</fpage>–<lpage>17</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=23436808&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=23436808&amp;retmode=ref&amp;cmd=prlinks</ext-link>.</mixed-citation></ref>
<ref id="pcbi.1004517.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fontaine</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Burdick</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Barr</surname> <given-names>A</given-names></name> (<year>2006</year>) <article-title>Automated tracking of multiple C. Elegans</article-title>. <source>Conf Proc IEEE Eng Med Biol Soc</source> <volume>1</volume>: <fpage>3716</fpage>–<lpage>3719</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=17945791&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=17945791&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">17945791</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Roussel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Morton</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Finger</surname> <given-names>FP</given-names></name>, <name name-style="western"><surname>Roysam</surname> <given-names>B</given-names></name> (<year>2007</year>) <article-title>A computational model for C. elegans locomotory behavior: application to multiworm tracking</article-title>. <source>IEEE Trans Biomed Eng</source> <volume>54</volume>: <fpage>1786</fpage>–<lpage>1797</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=17926677&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=17926677&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">17926677</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Roussel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Sprenger</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Tappan</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Glaser</surname> <given-names>JR</given-names></name> (<year>2014</year>) <source>Robust tracking and quanti fi cation of C. elegans body shape and locomotion through coiling, entanglement, and omega bends</source>: <fpage>1</fpage>–<lpage>13</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004517.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Roysam</surname> <given-names>B</given-names></name> (<year>2010</year>) <article-title>Joint tracking and locomotion state recognition of C. elegans from time-lapse image sequences</article-title>. <source>2010 7th IEEE Int Symp Biomed Imaging From Nano to Macro, ISBI 2010—Proc</source>: <fpage>540</fpage>–<lpage>543</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/ISBI.2010.5490291" xlink:type="simple">10.1109/ISBI.2010.5490291</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004517.ref015"><label>15</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Amit</surname> <given-names>Y</given-names></name> (<year>2002</year>) <source>2D Object Detection and Recognition: Models, Algorithms, and Networks—Yali Amit—Google Books</source>. <publisher-name>MIT Press</publisher-name>. Available: papers2://publication/uuid/32613959-F197-42DF-9E78-C6EBA7A727EE.</mixed-citation></ref>
<ref id="pcbi.1004517.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Trent</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Tsuing</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Horvitz</surname> <given-names>HR</given-names></name> (<year>1983</year>) <article-title>Egg-laying defective mutants of the nematode Caenorhabditis elegans</article-title>. <source>Genetics</source> <volume>104</volume>: <fpage>619</fpage>–<lpage>647</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=11813735&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=11813735&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">11813735</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brundage</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Avery</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Katz</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>UJ</given-names></name>, <name name-style="western"><surname>Mendel</surname> <given-names>JE</given-names></name>, <etal>et al</etal>. (<year>1996</year>) <article-title>Mutations in a C. elegans Gqalpha gene disrupt movement, egg laying, and viability</article-title>. <source>Neuron</source> <volume>16</volume>: <fpage>999</fpage>–<lpage>1009</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=8630258&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=8630258&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">8630258</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Miller</surname> <given-names>KG</given-names></name>, <name name-style="western"><surname>Emerson</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Rand</surname> <given-names>JB</given-names></name> (<year>1999</year>) <article-title>Goalpha and diacylglycerol kinase negatively regulate the Gqalpha pathway in C. elegans</article-title>. <source>Neuron</source> <volume>24</volume>: <fpage>323</fpage>–<lpage>333</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=10571227&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=10571227&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">10571227</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lackner</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Nurrish</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Kaplan</surname> <given-names>JM</given-names></name> (<year>1999</year>) <article-title>Facilitation of synaptic transmission by EGL-30 Gqalpha and EGL-8 PLCbeta: DAG binding to UNC-13 is required to stimulate acetylcholine release</article-title>. <source>Neuron</source> <volume>24</volume>: <fpage>335</fpage>–<lpage>346</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=10571228&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=10571228&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">10571228</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Miller</surname> <given-names>KG</given-names></name>, <name name-style="western"><surname>Emerson</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>McManus</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Rand</surname> <given-names>JB</given-names></name> (<year>2000</year>) <article-title>RIC-8 (Synembryn): a novel conserved protein that is required for G(q)alpha signaling in the C. elegans nervous system</article-title>. <source>Neuron</source> <volume>27</volume>: <fpage>289</fpage>–<lpage>299</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=10985349&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=10985349&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">10985349</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robatzek</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Niacaris</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Steger</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Avery</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>JH</given-names></name> (<year>2001</year>) <article-title>eat-11 encodes GPB-2, a Gbeta(5) ortholog that interacts with G(o)alpha and G(q)alpha to regulate C. elegans behavior</article-title>. <source>Curr Biol</source> <volume>11</volume>: <fpage>288</fpage>–<lpage>293</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=11250160&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=11250160&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">11250160</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Doi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Iwasaki</surname> <given-names>K</given-names></name> (<year>2002</year>) <article-title>Regulation of retrograde signaling at neuromuscular junctions by the novel C2 domain protein AEX-1</article-title>. <source>Neuron</source> <volume>33</volume>: <fpage>249</fpage>–<lpage>259</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=11804572&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=11804572&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">11804572</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shyn</surname> <given-names>SI</given-names></name>, <name name-style="western"><surname>Kerr</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Schafer</surname> <given-names>WR</given-names></name> (<year>2003</year>) <article-title>Serotonin and Go modulate functional states of neurons and muscles controlling C. elegans egg-laying behavior</article-title>. <source>Curr Biol</source> <volume>13</volume>: <fpage>1910</fpage>–<lpage>1915</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=14588249&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=14588249&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">14588249</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Matsuki</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kunitomo</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Iino</surname> <given-names>Y</given-names></name> (<year>2006</year>) <article-title>Goalpha regulates olfactory adaptation by antagonizing Gqalpha-DAG signaling in Caenorhabditis elegans</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>103</volume>: <fpage>1112</fpage>–<lpage>1117</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=16418272&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=16418272&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">16418272</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Esposito</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Amoroso</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Bergamasco</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Di Schiavi</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Bazzicalupo</surname> <given-names>P</given-names></name> (<year>2010</year>) <article-title>The G protein regulators EGL-10 and EAT-16, the Giα GOA-1 and the G(q)α EGL-30 modulate the response of the C. elegans ASH polymodal nociceptive sensory neurons to repellents</article-title>. <source>BMC Biol</source> <volume>8</volume>: <fpage>138</fpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=21070627&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=21070627&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1741-7007-8-138" xlink:type="simple">10.1186/1741-7007-8-138</ext-link></comment> <object-id pub-id-type="pmid">21070627</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Aleman-Meza</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gharib</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Labocha</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Cronin</surname> <given-names>CJ</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Systematic profiling of Caenorhabditis elegans locomotive behaviors reveals additional components in G-protein Gαq signaling</article-title>. <source>Proc Natl Acad Sci U S A</source>. <volume>110</volume>(<issue>29</issue>): <fpage>11940</fpage>–<lpage>11945</lpage> Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=23818641&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=23818641&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1310468110" xlink:type="simple">10.1073/pnas.1310468110</ext-link></comment> <object-id pub-id-type="pmid">23818641</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Charlie</surname> <given-names>NK</given-names></name>, <name name-style="western"><surname>Schade</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Thomure</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>KG</given-names></name> (<year>2006</year>) <article-title>Presynaptic UNC-31 (CAPS) is required to activate the G alpha(s) pathway of the Caenorhabditis elegans synaptic signaling network</article-title>. <source>Genetics</source> <volume>172</volume>: <fpage>943</fpage>–<lpage>961</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=16272411&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=16272411&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">16272411</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ailion</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hannemann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dalton</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Pappas</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Watanabe</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Two Rab2 interactors regulate dense-core vesicle maturation</article-title>. <source>Neuron</source> <volume>82</volume>: <fpage>167</fpage>–<lpage>180</lpage>. Available: <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2014.02.017" xlink:type="simple">10.1016/j.neuron.2014.02.017</ext-link></comment> <object-id pub-id-type="pmid">24698274</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Humphrey</surname> <given-names>J a.</given-names></name>, <name name-style="western"><surname>Hamming</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Thacker</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Scott</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Sedensky</surname> <given-names>MM</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>A Putative Cation Channel and Its Novel Regulator: Cross-Species Conservation of Effects on General Anesthesia</article-title>. <source>Curr Biol</source> <volume>17</volume>: <fpage>624</fpage>–<lpage>629</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cub.2007.02.037" xlink:type="simple">10.1016/j.cub.2007.02.037</ext-link></comment> <object-id pub-id-type="pmid">17350263</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yeh</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Ng</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bouhours</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>A putative cation channel, NCA-1, and a novel protein, UNC-80, transmit neuronal activity in C. elegans</article-title>. <source>PLoS Biol</source> <volume>6</volume>: <fpage>0552</fpage>–<lpage>0567</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.0060055" xlink:type="simple">10.1371/journal.pbio.0060055</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004517.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tavernarakis</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Shreffler</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Driscoll</surname> <given-names>M</given-names></name> (<year>1997</year>) <article-title>unc-8, a DEG/ENaC family member, encodes a subunit of a candidate mechanically gated channel that modulates C. elegans locomotion</article-title>. <source>Neuron</source> <volume>18</volume>: <fpage>107</fpage>–<lpage>119</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=9010209&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=9010209&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">9010209</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weibull</surname> <given-names>W</given-names></name> (<year>1951</year>) <article-title>A Statistical Distribution Function of Wide Applicability</article-title>. <source>J Appl Mech Sept</source>.: <fpage>293</fpage>–<lpage>297</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004517.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stephens</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Bueno de Mesquita</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ryu</surname> <given-names>WS</given-names></name>, <name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name> (<year>2011</year>) <article-title>Emergence of long timescales and stereotyped behaviors in Caenorhabditis elegans</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>108</volume>: <fpage>7286</fpage>–<lpage>7289</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=21502536&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=21502536&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1007868108" xlink:type="simple">10.1073/pnas.1007868108</ext-link></comment> <object-id pub-id-type="pmid">21502536</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brown</surname> <given-names>AEX</given-names></name>, <name name-style="western"><surname>Yemini</surname> <given-names>EI</given-names></name>, <name name-style="western"><surname>Grundy</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Jucikas</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Schafer</surname> <given-names>WR</given-names></name> (<year>2013</year>) <article-title>A dictionary of behavioral motifs reveals clusters of genes affecting Caenorhabditis elegans locomotion</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>110</volume>: <fpage>791</fpage>–<lpage>796</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=23267063&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=23267063&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1211447110" xlink:type="simple">10.1073/pnas.1211447110</ext-link></comment> <object-id pub-id-type="pmid">23267063</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref035"><label>35</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Dougherty</surname> <given-names>G</given-names></name> (<year>2012</year>) <source>Pattern Recognition and Classification</source>. 2013 ed. <publisher-name>Springer</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1004517.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wen</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Po</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Hulme</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>X</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Proprioceptive coupling within motor neurons drives C. elegans forward locomotion</article-title>. <source>Neuron</source> <volume>76</volume>: <fpage>750</fpage>–<lpage>761</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=23177960&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=23177960&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2012.08.039" xlink:type="simple">10.1016/j.neuron.2012.08.039</ext-link></comment> <object-id pub-id-type="pmid">23177960</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wallace</surname> <given-names>HR</given-names></name> (<year>1969</year>) <article-title>Wave formation by infective larvae of the plant parasitic nematode Meloidogyne javanica</article-title>. <source>Nematologica</source> <volume>15</volume>: <fpage>65</fpage>–<lpage>75</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="https://requests.lib.uchicago.edu/illiad/illiad.dll?Action=10&amp;Form=75&amp;Value=1541401" xlink:type="simple">https://requests.lib.uchicago.edu/illiad/illiad.dll?Action=10&amp;Form=75&amp;Value=1541401</ext-link>.</mixed-citation></ref>
<ref id="pcbi.1004517.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Croll</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>JM</given-names></name> (<year>1978</year>) <article-title>Integrated behaviour in the feeding phase of Caenorhabditis elegans</article-title>. <source>J Zool</source>. <volume>184</volume>(<issue>4</issue>): <fpage>507</fpage>–<lpage>517</lpage> Available: <ext-link ext-link-type="uri" xlink:href="http://onlinelibrary.wiley.com/doi/10.1111/j.1469-7998.1978.tb03304.x/abstract" xlink:type="simple">http://onlinelibrary.wiley.com/doi/10.1111/j.1469-7998.1978.tb03304.x/abstract</ext-link>.</mixed-citation></ref>
<ref id="pcbi.1004517.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pierce-Shimomura</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Morse</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Lockery</surname> <given-names>SR</given-names></name> (<year>1999</year>) <article-title>The fundamental role of pirouettes in Caenorhabditis elegans chemotaxis</article-title>. <source>J Neurosci</source> <volume>19</volume>: <fpage>9557</fpage>–<lpage>9569</lpage>. <object-id pub-id-type="pmid">10531458</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gray</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Hill</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Bargmann</surname> <given-names>CI</given-names></name> (<year>2005</year>) <article-title>A circuit for navigation in Caenorhabditis elegans</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>102</volume>: <fpage>3184</fpage>–<lpage>3191</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=15689400&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=15689400&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">15689400</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Donnelly</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Leifer</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Pirri</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Haburcak</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Monoaminergic Orchestration of Motor Programs in a Complex C. elegans Behavior</article-title>. <source>PLoS Biol</source> <volume>11</volume>: <fpage>e1001529</fpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=23565061&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=23565061&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.1001529" xlink:type="simple">10.1371/journal.pbio.1001529</ext-link></comment> <object-id pub-id-type="pmid">23565061</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gao</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Kawano</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Po</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Guan</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2015</year>) <article-title>The NCA sodium leak channel is required for persistent motor circuit activity that sustains locomotion</article-title>. <source>Nat Commun</source> <volume>6</volume>: <fpage>1</fpage>–<lpage>10</lpage>. Available: <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ncomms7323" xlink:type="simple">10.1038/ncomms7323</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004517.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hunt-Newbury</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Viveiros</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Johnsen</surname> <given-names>R</given-names></name> (<year>2007</year>) <article-title>High-throughput in vivo analysis of gene expression in Caenorhabditis elegans</article-title>. <source>PLoS Biol</source>. <volume>5</volume>(<issue>9</issue>): <fpage>e237</fpage> Available: <ext-link ext-link-type="uri" xlink:href="http://biology.plosjournals.org/perlserv/?request=get-document&amp;doi=10.1371/journal.pbio.0050237&amp;ct=1" xlink:type="simple">http://biology.plosjournals.org/perlserv/?request=get-document&amp;doi=10.1371/journal.pbio.0050237&amp;ct=1</ext-link>. <object-id pub-id-type="pmid">17850180</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jospin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Watanabe</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Joshi</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Young</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hamming</surname> <given-names>K</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>UNC-80 and the NCA Ion Channels Contribute to Endocytosis Defects in Synaptojanin Mutants</article-title>. <source>Curr Biol</source> <volume>17</volume>: <fpage>1595</fpage>–<lpage>1600</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cub.2007.08.036" xlink:type="simple">10.1016/j.cub.2007.08.036</ext-link></comment> <object-id pub-id-type="pmid">17825559</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Loria</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Hodgkin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hobert</surname> <given-names>O</given-names></name> (<year>2004</year>) <article-title>A conserved postsynaptic transmembrane protein affecting neuromuscular signaling in Caenorhabditis elegans</article-title>. <source>J Neurosci</source> <volume>24</volume>: <fpage>2191</fpage>–<lpage>2201</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.5462-03.2004" xlink:type="simple">10.1523/JNEUROSCI.5462-03.2004</ext-link></comment> <object-id pub-id-type="pmid">14999070</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huang</surname> <given-names>K-M</given-names></name>, <name name-style="western"><surname>Cosman</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Schafer</surname> <given-names>WR</given-names></name> (<year>2006</year>) <article-title>Machine vision based detection of omega bends and reversals in C. elegans</article-title>. <source>J Neurosci Methods</source> <volume>158</volume>: <fpage>323</fpage>–<lpage>336</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=16839609&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=16839609&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <object-id pub-id-type="pmid">16839609</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Ronneberger</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Schulze</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Baumeister</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Burkhardt</surname> <given-names>H</given-names></name> (<year>2009</year>) <article-title>Using Lateral Coupled Snakes for Modeling the Contours of Worms</article-title>. <source>Pattern Recognition (Proc. DAGM), Springer</source>, <volume>Vol. 5748</volume>. pp. <fpage>542</fpage>–<lpage>551</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://www.springerlink.com/index/10.1007/978-3-642-03798-6_55" xlink:type="simple">http://www.springerlink.com/index/10.1007/978-3-642-03798-6_55</ext-link>.</mixed-citation></ref>
<ref id="pcbi.1004517.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lockery</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Lawton</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Doll</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Faumont</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Coulthard</surname> <given-names>SM</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Artificial dirt: microfluidic substrates for nematode neurobiology and behavior</article-title>. <source>J Neurophysiol</source> <volume>99</volume>: <fpage>3136</fpage>–<lpage>3143</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=18337372&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=18337372&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.91327.2007" xlink:type="simple">10.1152/jn.91327.2007</ext-link></comment> <object-id pub-id-type="pmid">18337372</object-id></mixed-citation></ref>
<ref id="pcbi.1004517.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nagy</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Raizen</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Biron</surname> <given-names>D</given-names></name> (<year>2014</year>) <article-title>Measurements of behavioral quiescence in Caenorhabditis elegans</article-title>. <source>Methods</source>. <volume>68</volume>(<issue>3</issue>): <fpage>500</fpage>–<lpage>507</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=24642199&amp;retmode=ref&amp;cmd=prlinks" xlink:type="simple">http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=24642199&amp;retmode=ref&amp;cmd=prlinks</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.ymeth.2014.03.009" xlink:type="simple">10.1016/j.ymeth.2014.03.009</ext-link></comment> <object-id pub-id-type="pmid">24642199</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>