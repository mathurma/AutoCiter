<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004927</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-01960</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Calcium imaging</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Calcium imaging</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Signal transduction</subject><subj-group><subject>Cell signaling</subject><subj-group><subject>Calcium signaling</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Visual cortex</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Brain</subject><subj-group><subject>Visual cortex</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Kernel methods</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Kernel methods</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Model Constrained by Visual Hierarchy Improves Prediction of Neural Responses to Natural Scenes</article-title>
<alt-title alt-title-type="running-head">Hierarchical Model of Mouse V1</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Antolík</surname>
<given-names>Ján</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Hofer</surname>
<given-names>Sonja B.</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Bednar</surname>
<given-names>James A.</given-names>
</name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Mrsic-Flogel</surname>
<given-names>Thomas D.</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Unité de Neurosciences, Information et Complexité, CNRS UPR 3293, Gif-sur-Yvette, France</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Department of Neuroscience, Physiology and Pharmacology, University College London, London, United Kingdom</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Biozentrum, University of Basel, Basel, Switzerland</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Institute for Adaptive and Neural Computation, University of Edinburgh, Edinburgh, United Kingdom</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Bethge</surname>
<given-names>Matthias</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Tübingen and Max Planck Institute for Biologial Cybernetics, GERMANY</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: SBH JA TDMF. Performed the experiments: SBH. Analyzed the data: JA. Contributed reagents/materials/analysis tools: JA TDMF. Wrote the paper: JA TDMF JAB. Discussed the data and commented on the manuscript: JA SBH JAB TDMF.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">antolikjan@gmail.com</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>27</day>
<month>6</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="collection">
<month>6</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>6</issue>
<elocation-id>e1004927</elocation-id>
<history>
<date date-type="received">
<day>7</day>
<month>1</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>18</day>
<month>4</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Antolík et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004927"/>
<abstract>
<p>Accurate estimation of neuronal receptive fields is essential for understanding sensory processing in the early visual system. Yet a full characterization of receptive fields is still incomplete, especially with regard to natural visual stimuli and in complete populations of cortical neurons. While previous work has incorporated known structural properties of the early visual system, such as lateral connectivity, or imposing simple-cell-like receptive field structure, no study has exploited the fact that nearby V1 neurons share common feed-forward input from thalamus and other upstream cortical neurons. We introduce a new method for estimating receptive fields simultaneously for a population of V1 neurons, using a model-based analysis incorporating knowledge of the feed-forward visual hierarchy. We assume that a population of V1 neurons shares a common pool of thalamic inputs, and consists of two layers of simple and complex-like V1 neurons. When fit to recordings of a local population of mouse layer 2/3 V1 neurons, our model offers an accurate description of their response to natural images and significant improvement of prediction power over the current state-of-the-art methods. We show that the responses of a large local population of V1 neurons with locally diverse receptive fields can be described with surprisingly limited number of thalamic inputs, consistent with recent experimental findings. Our structural model not only offers an improved functional characterization of V1 neurons, but also provides a framework for studying the relationship between connectivity and function in visual cortical areas.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>A key goal in sensory neuroscience is to understand the relationship between sensory stimuli and patterns of activity they elicit in networks of sensory neurons. Many models have been proposed in the past; however, these models have largely ignored the known architecture of primary visual cortex revealed in experimental studies, thus limiting their ability to accurately describe neural responses to sensory stimuli. Here we propose a model of primary visual cortex that takes into account the known architecture of visual cortex, specifically the fact that only a limited number of thalamic inputs with stereotypical receptive fields are shared within a local area of visual cortex, and the hierarchical progression from neurons with linear receptive fields (simple cells) to neurons with non-linear receptive fields (complex cells). We show that the proposed model outperforms state-of-the-art methods for receptive field estimation when fitted to two-photon calcium recordings of local populations of mouse V1 neurons responding to natural image stimuli. The model demonstrates how the diverse set of receptive fields in the local population of neurons can be constructed from a limited number (&lt; 20) thalamic inputs.</p>
</abstract>
<funding-group>
<funding-statement>This work was supported by the Wellcome Trust grant 095074 and by the European Research Council. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="0"/>
<page-count count="22"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The fundamental assumption underlying early sensory processing is that different external stimuli elicit distinct activity patterns that encode the content of the stimuli. Patterns of neuronal activity in early sensory areas of cortex are themselves a product of the network in which the neurons are embedded [<xref ref-type="bibr" rid="pcbi.1004927.ref001">1</xref>,<xref ref-type="bibr" rid="pcbi.1004927.ref002">2</xref>]. Understanding the relationship between stimuli and responses in a given neural population, and how these responses are created by the underlying neural circuits, is thus essential for explaining the role of these neurons in sensory processing [<xref ref-type="bibr" rid="pcbi.1004927.ref003">3</xref>].</p>
<p>A common approach for identifying stimulus-response functions is to present a large set of stimuli while recording the responses of individual neurons, and subsequently fit each neuron with a model. The accuracy of the model can be determined by comparing the predicted and actual activities in responses to a novel stimulus set. This data-driven approach to describing stimulus response functions (e.g. spatio-temporal response functions, STRFs) of neurons in the visual system has been refined over the last four decades. Initially, the filter functions of functionally linear neurons in the retina, lateral geniculate nucleus (LGN), or simple cells in primary visual cortex (V1) were obtained using artificial sets of stimuli, such as sparse noise or M-sequences [<xref ref-type="bibr" rid="pcbi.1004927.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1004927.ref006">6</xref>]. More recently, studies advanced to describing the response functions of less linear neurons (complex cells in primary visual cortex, and neurons in V2) [<xref ref-type="bibr" rid="pcbi.1004927.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1004927.ref008">8</xref>] while using stimuli more representative of the natural environment, such as sequences or movies of natural scenes [<xref ref-type="bibr" rid="pcbi.1004927.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1004927.ref012">12</xref>]. However, even in V1, the modest response prediction accuracy from these models indicates that our current ability to characterize the stimulus response functions is incomplete [<xref ref-type="bibr" rid="pcbi.1004927.ref008">8</xref>,<xref ref-type="bibr" rid="pcbi.1004927.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1004927.ref013">13</xref>].</p>
<p>Several major advances in the estimation of response functions have been introduced in recent years. Spike-triggered covariance (STC) [<xref ref-type="bibr" rid="pcbi.1004927.ref007">7</xref>] and multi-layer neural networks [<xref ref-type="bibr" rid="pcbi.1004927.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1004927.ref015">15</xref>] made it possible to estimate the non-linear receptive fields (RFs) of complex cells. Most previous methods for estimating RFs in the early visual system have dealt with data from single cells independently [<xref ref-type="bibr" rid="pcbi.1004927.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1004927.ref006">6</xref>,<xref ref-type="bibr" rid="pcbi.1004927.ref016">16</xref>,<xref ref-type="bibr" rid="pcbi.1004927.ref017">17</xref>]. The introduction of generalized linear models (GLMs) showed that incorporating information about the activity of nearby neurons a few milliseconds in the past can significantly improve predictive power [<xref ref-type="bibr" rid="pcbi.1004927.ref002">2</xref>], but this technique is restricted to a linear representation of the receptive field. More recently, usage of pre-defined banks of linear and non-linear filters to pre-process the visual input, and then using linear regression in this transformed input space to fit the model, has improved prediction accuracy [<xref ref-type="bibr" rid="pcbi.1004927.ref008">8</xref>,<xref ref-type="bibr" rid="pcbi.1004927.ref018">18</xref>]. However, no RF estimation method has taken advantage of the fact the RFs of a local population of neurons are constructed from a limited number of shared LGN inputs [<xref ref-type="bibr" rid="pcbi.1004927.ref019">19</xref>], which have stereotypical center-surround RF structure. The advent of two-photon calcium imaging makes it possible to record the activity from complete local populations of neurons [<xref ref-type="bibr" rid="pcbi.1004927.ref020">20</xref>,<xref ref-type="bibr" rid="pcbi.1004927.ref021">21</xref>], and thus allows estimation of a model containing these constraints.</p>
<p>Here we propose a new method for estimating RFs in V1—the Hierarchical Structural Model (HSM)—which assumes that a local neuronal population shares a limited number of afferent inputs from the LGN. The model explicitly incorporates hierarchical sub-cortical and cortical processing, whereby center-surround thalamo-cortical inputs are summed in the first layer of neurons, consisting of putative simple cells, followed by a second layer of neurons that sum inputs from simple cells to form both simple and complex-cell like RFs. The model takes advantage of the RF redundancies among nearby V1 neurons, by simultaneously fitting the entire local population of recorded neurons, and outperforms current state-of-the-art approaches to RF estimation when predicting neuronal activity measured with two-photon calcium imaging.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>We measured neuronal responses with two-photon calcium imaging of local populations of mouse V1 neurons labeled with Oregon Green Bapta-1 AM (OGB-1), during presentation of a large set of full-field natural images (see <xref ref-type="fig" rid="pcbi.1004927.g001">Fig 1</xref> and <xref ref-type="sec" rid="sec009">Materials and Methods</xref>). We recorded calcium signals in populations of layer 2/3 neurons in V1 (three regions from two mice) in response to unique set of 1260 to 1800 images. To obtain reliable responses we applied a stimulation protocol in which images were presented for 500 ms, interleaved with blank grey screens presented for 1474 ms. An extra 50 images were presented for 8–12 trials each, providing a set of neuronal responses used as a validation dataset. Calcium signals were converted into putative spikes using a fast non-negative de-convolution method [<xref ref-type="bibr" rid="pcbi.1004927.ref022">22</xref>]. Combined cell-attached recordings and calcium imaging were used to validate the spike inference method in a subset of neurons (53±6% single spikes and 95±2% of burst of 2 spikes detected per imaging frame; false positive rate 0.049±0.009 Hz [<xref ref-type="bibr" rid="pcbi.1004927.ref022">22</xref>,<xref ref-type="bibr" rid="pcbi.1004927.ref023">23</xref>]).</p>
<fig id="pcbi.1004927.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004927.g001</object-id>
<label>Fig 1</label>
<caption>
<title>The stimulation protocol and population responses in L2/3 of mouse V1.</title>
<p>(A) Natural images were presented for 500 ms, interleaved by 1474 ms periods of blank gray screens. (B) The responses (inferred spike rate) of 103 measured neurons to the first 600 of the 1800 images presented to the animal as a part of the training set (note that due to copyright restrictions the images presented during experiments were in this figure replaced with different equally pre-processed images which are under Creative Commons CC0 license). (C) Examples of spatial activity patterns to single natural images.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004927.g001" xlink:type="simple"/>
</fig>
<sec id="sec003">
<title>Model-based RF estimation in mouse V1</title>
<p>Our model-based approach to RF estimation is inspired by the anatomical and functional organization of mammalian V1 (see <xref ref-type="fig" rid="pcbi.1004927.g002">Fig 2</xref> and <xref ref-type="sec" rid="sec009">Materials and Methods</xref>). It is based on the following basic assumptions: LGN units can be well described as difference-of-Gaussian functions [<xref ref-type="bibr" rid="pcbi.1004927.ref024">24</xref>]; the local population of V1 neurons shares input from limited number of such LGN units [<xref ref-type="bibr" rid="pcbi.1004927.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1004927.ref025">25</xref>]; simple cells can be constructed by summing several RFs of LGN neurons [<xref ref-type="bibr" rid="pcbi.1004927.ref026">26</xref>,<xref ref-type="bibr" rid="pcbi.1004927.ref027">27</xref>]; complex cells can be constructed by summing inputs from the local population of simple cells that are selective to the same orientation but different RF phases [<xref ref-type="bibr" rid="pcbi.1004927.ref027">27</xref>].</p>
<fig id="pcbi.1004927.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004927.g002</object-id>
<label>Fig 2</label>
<caption>
<title>The architecture of the HSM.</title>
<p>The model consists of a limited number of difference-of-Gaussian kernels, parameterized by the width and weight of the central and surrounding Gaussians, and the <italic>x</italic> and <italic>y</italic> coordinates of their center. This LGN layer is followed by two `cortical`layers of simple integrators with logistic-loss type transfer functions. The two layers are inter-connected by all-to-all connections and the first layer has all-to-all connections from the LGN units. Each unit in the two ‘cortical’ layers is parameterized by the set of incoming weights and the threshold of its logistic-loss transfer function. The log-loss function approximates a linear function with the slope of 1 as (<italic>x</italic> − <italic>t</italic>)→∞.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004927.g002" xlink:type="simple"/>
</fig>
<p>The HSM consists of 3 layers of units: the first layer consists of linear kernels of LGN units that are modeled as 2D difference-of-Gaussians functions (see <xref ref-type="fig" rid="pcbi.1004927.g002">Fig 2</xref>). Units in the second layer sum the responses of LGN-like linear units, and pass on the resulting potential via a logistic-loss non-linearity. In this way units in the second layer construct oriented RFs through feed-forward summation of thalamocortical inputs [<xref ref-type="bibr" rid="pcbi.1004927.ref027">27</xref>]. Linear summation coupled with logistic-loss non-linearity is repeated again in the third layer, which enables construction of RFs that are tuned to orientation but can be insensitive to spatial phase (i.e. units resembling complex cells). Moreover, this approach also allows the generation of RFs that do not conform to the standard idealized models of either simple or complex cells, including, for example, models of cells that are selective to two orthogonal orientations. The HSM therefore leverages the assumed local connectivity in V1, thus potentially improving fits on limited data, while fitting RFs that do not conform to the idealized models of V1 neurons, a requirement that may be important for capturing the full response variability of V1 neurons.</p>
<p>We estimated the RFs for each neuronal population in V1 by applying a gradient ascent method to optimize corresponding log-likelihood functions with respect to the model parameters to reproduce responses to the set of training visual stimuli (see <xref ref-type="sec" rid="sec009">Materials and Methods</xref>). To demonstrate the results of fitting the HSM to a local population of mouse V1 neurons, we plotted the linearized RFs in cortical space with each RF centered on the location of the corresponding neuron’s cell body in the imaged region (<xref ref-type="fig" rid="pcbi.1004927.g003">Fig 3</xref>). The color of the frame around each neuron’s RF represents the value of the non-linearity index (NLI; see <xref ref-type="sec" rid="sec009">Materials and Methods</xref>) for the given neuron, indicating the portion of the predicted responses which is due to non-linear as opposed to linear aspects of the HSM, and can be considered as an estimate of a neuron’s non-linearity. We observed a diversity of RF shapes in local regions of mouse V1, with a full range of linear and non-linear characteristics (<xref ref-type="fig" rid="pcbi.1004927.g003">Fig 3</xref>).</p>
<fig id="pcbi.1004927.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004927.g003</object-id>
<label>Fig 3</label>
<caption>
<title>The distribution of linear RFs in the cortical space obtained from the first recorded region.</title>
<p>Each linear RF is centered on the corresponding neuron’s cell body in the cortical region where recordings took place (displayed in lower right corner). The color of the frame indicates the NLI of the given neuron (blue-green scale bar). A wide variety of linear RFs were observed, and no specific ordering was identified. Each RF was individually normalized to remove differences due to average firing rates. The color scale of the RF maps is shown on the scale bar next to the neuron near the bottom right corner.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004927.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec004">
<title>HSM accurately predicts neuronal responses to natural stimuli</title>
<p>To estimate the performance of the HSM, we measured the correlation between responses predicted by the fitted model and evoked responses to a novel set of validation images (50 images, responses averaged over 8–12 trials) that were not included in the training set (<xref ref-type="fig" rid="pcbi.1004927.g004">Fig 4</xref>). The top neuron depicted in <xref ref-type="fig" rid="pcbi.1004927.g004">Fig 4A</xref> was the best fit neuron (R = 0.9; p&lt;0.001). The model predicted its response with high accuracy, apart from small response deviations at lower response amplitudes. The neuron in <xref ref-type="fig" rid="pcbi.1004927.g004">Fig 4B</xref> exhibited the median correlation between predicted and recorded responses (R = 0.53; p&lt;0.001), where the predicted response captured a considerable part of the neural response, but significant deviations from the measured activity were still observed. The correlation coefficients of neurons from all three imaged regions in V1 were broadly distributed across a range of positive values, with few neurons showing weak anti-correlation (median values of 0.53, 0.45 and 0.47 respectively; p&lt;0.001 for all three regions; <xref ref-type="fig" rid="pcbi.1004927.g004">Fig 4C</xref>). We found a strong negative relationship between the normalized noise power [<xref ref-type="bibr" rid="pcbi.1004927.ref028">28</xref>] in recordings of individual neurons and the performance of the model for those neurons (<xref ref-type="fig" rid="pcbi.1004927.g004">Fig 4D</xref>). This is because response reliability of neurons has a significant impact on the ability of the model to fit individual neurons, as less reliable responses carry less information about the stimulus, and the mean response from the validation image set is likely to deviate more from the true average response for less reliable neurons. This predicts that collecting a larger training set and increasing the number of repetitions in the validation set would further improve the prediction power of the model.</p>
<fig id="pcbi.1004927.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004927.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Responses predicted from the HSM are highly correlated with recorded neuronal responses.</title>
<p>The measured mean activity (full circles) and the predicted responses (empty circles) for a neuron with highest correlation (R = 0.90, P&lt;0.001)(A) and a neuron with median correlation (R = 0.53, P&lt;0.001)(B). (C) The cumulative distribution functions of correlation coefficients across the population of 260 neurons in the three measured regions. (D) Normalized noise power [<xref ref-type="bibr" rid="pcbi.1004927.ref028">28</xref>] and the performance of the model are negatively correlated (R = -0.63, -0.55 and -0.67 for the three regions, P&lt;0.001 for all regions). Higher normalized noise power implies lower and more variable prediction performance. The small dots indicate neurons for which the model performance (correlation between predicted and recorded responses) was not statistically significant (based on bootstrapped 95% confidence intervals).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004927.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>HSM outperforms state-of-the-art methods</title>
<p>In the previous section we showed that the HSM can predict well the responses of many neurons to novel natural stimuli. How does the prediction performance of our model compare to other models, including a regularized variant of the linear-nonlinear model (rLN) [<xref ref-type="bibr" rid="pcbi.1004927.ref009">9</xref>], and the Berkeley wavelet transform (BWT) model [<xref ref-type="bibr" rid="pcbi.1004927.ref029">29</xref>]? Due to its simplicity and interpretability, the linear-nonlinear model is the standard approach for RF estimation and has been used in a wide range of studies [<xref ref-type="bibr" rid="pcbi.1004927.ref030">30</xref>]. On the other hand, the recently proposed BWT model (together with the closely related Gabor pyramid variant [<xref ref-type="bibr" rid="pcbi.1004927.ref018">18</xref>]) represents the state-of-the-art in neural response prediction to naturalistic stimuli, as it can capture linear and non-linear components of the neuronal responses and outperforms most RF identification methods [<xref ref-type="bibr" rid="pcbi.1004927.ref031">31</xref>].</p>
<p><xref ref-type="fig" rid="pcbi.1004927.g005">Fig 5A</xref> compares the performance for the three models (measured as the correlation coefficients of measured and predicted responses to a novel set of natural images) averaged across all neurons in the three recorded cortical regions, while the line-graphs show the performance for the three cortical regions separately. The rLN and the BWT methods achieved averaged performances of R = 0.29 and R = 0.39 respectively, while the HSMs outperformed both consistently across all three regions (P&lt;0.001; Wilcoxon signed ranked test; data pooled across the three regions) showing an average correlation of R = 0.47 (a 20% improvement over the BWT model). Furthermore, if we fit the HSM to each neuron individually, we see that the prediction performance drops to the levels shown by rLN (the HSM(SN) condition, R = 0.30). This indicates that the predictive advantage of HSM largely arises from our ability to constrain the fitting problem by the assumption of limited common feed-forward input into a local population of neurons in V1.</p>
<fig id="pcbi.1004927.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004927.g005</object-id>
<label>Fig 5</label>
<caption>
<title>RFs estimated by HSM explain neuronal responses significantly better than existing methods.</title>
<p>(A) The average correlation coefficients of the rLN, BWT and HSMs, and of an HSM in which each neuron has been fitted individually HSM(SN). (B) The average fraction of explained variance (FEV) for the three compared models. (C) Scatter plot of the FEV of individual neurons by the rLN and HSMs. (D) Scatter plot of the FEV of individual neurons under the BWT and HSMs. Data from individual regions are marked by the colored lines and/or dots while the averages across regions are indicated as bars.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004927.g005" xlink:type="simple"/>
</fig>
<p>To quantify the proportion of the neuronal response captured by our model, we computed the fraction of explained variance (FEV) [<xref ref-type="bibr" rid="pcbi.1004927.ref028">28</xref>]. Since high quality multi-trial data is required to reliably calculate FEV, for this analysis we excluded neurons with normalized noise power greater than 70% (sparing 70 of the 260 imaged neurons). The average fraction of variance explained by the rLN and the BWT models was 0.16 and 0.30 respectively, while the HSMs outperformed both (P&lt;0.001; Wilcoxon signed ranked test; data pooled across the three regions), achieving an average of 0.43, representing a 43% improvement over the BWT model (<xref ref-type="fig" rid="pcbi.1004927.g005">Fig 5B</xref>). Finally, the improvement in the average prediction (fraction of explained variance) of the HSM was not restricted to subset of neurons, but spread almost across the entire measured population (<xref ref-type="fig" rid="pcbi.1004927.g005">Fig 5C and 5D</xref>).</p>
</sec>
<sec id="sec006">
<title>Effects of varying LGN input and hidden layer neuron number</title>
<p>The HSM contains two free meta-parameters that are not optimized during the fitting process: the number of LGN units and the number of neurons in the hidden layer (which we express as the fraction γ of recorded neurons in an imaged region). To assess the influence of these parameters on the performance of the HSM, we performed a parameter search. Due to the high computational requirements of the fitting process and the large number of neurons in our dataset we were not able to explore the full space of these two parameters. Instead we performed a partial one-dimensional search through the parameter space, varying one parameter and fixing the other to a value we found empirically to give good performance (9 for the number of LGN units and 20% for the number of hidden units expressed as fraction of imaged neurons). We limited the number of fitting restarts with different initial seeds for each explored value of the meta-parameters to 20.</p>
<p>The performance of the model on the training set initially increased with the number of LGN inputs (<xref ref-type="fig" rid="pcbi.1004927.g006">Fig 6A</xref>, full lines), however, beyond ~9 LGN units the performance saturated. We observed a similar pattern in the relationship between hidden layer size and performance of the model on the training set (see <xref ref-type="fig" rid="pcbi.1004927.g006">Fig 6B</xref>, full lines). Initially, the performance increased with increasing hidden layer fraction, however, it quickly saturated at a value of ~0.2. A similar relationship between the performance of the model and the meta-parameter values exists when measured against the validation set (<xref ref-type="fig" rid="pcbi.1004927.g006">Fig 6</xref>, dashed lines). Overall, surprisingly few LGN inputs and hidden units are required to capture the responses of large local populations of neurons (&gt;100 neurons). This observation is consistent with the recent evidence showing limited variability in the location of RF subunits in local populations of mouse V1 neurons [<xref ref-type="bibr" rid="pcbi.1004927.ref019">19</xref>]. It should however be emphasized that the values of these two parameters are very likely an underestimation of the true number of LGN cells innervating the imaged cortical region, and the number of linear (simple) cortical cells from which the imaged neurons receive inputs. These numbers are a reflection of the number of parameters we can resolve given our limited training sets. We expect that larger amounts of data would lead to a slight increase in the number of subunits, and a more accurate correspondence between the fitted model parameters and the underlying neural substrate.</p>
<fig id="pcbi.1004927.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004927.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Effect of meta-parameter choice on model performance.</title>
<p>(A) Relationship between the performance of the HSM and the number of LGN inputs for the training set (solid line) and the validation set (dashed line). (B) Relationship between the performance of the HSM and the number of units in the hidden layer expressed as fraction of measured neurons for the training set (solid line) and the validation set (dashed line). Note that the performance on the training set is consistently poorer than on the validation set because the validation set is an average over multiple trials while the training set is single-trial data (see <xref ref-type="sec" rid="sec009">Materials and Methods</xref>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004927.g006" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec007">
<title>The nature of the fitted RFs</title>
<p>It is important to emphasize that the estimated HSM parameters are unlikely to reflect a direct one-to-one relationship with the underlying biological substrate, but rather offer a functional description of the system. To gain a insight into how the HSM captures the responses of the fitted neurons, we show the linear RFs of all the units in the LGN and intermediate layer of the fitted HSM (<xref ref-type="fig" rid="pcbi.1004927.g007">Fig 7A and 7B</xref>). Note that such linear visualization is not possible for the output layer units, due to the non-linearity of the hidden layer unit transfer functions. Unsurprisingly, as a direct consequence of their definition in the HSM, the LGN kernels have isotropic center-surround structure, but some have very weak surround components. Some intermediate units express RFs that can be well described by Gabor functions, yet others have more unusual shapes, while we also observe multiple cells with similar RFs. This is not surprising given that the number of hidden units used in the HSM models was much smaller (&lt; = 20) than the number of linear (simple) cells that can be expected to reside in the corresponding region of V1. Consequently, it is unlikely that the fitted HSM hidden units correspond to RFs of individual neurons in the imaged area, but rather to a low-dimensional subspace in which neural responses are generated. Advanced model regularization and selection methods could in future improve the link between the HSM units and biological neurons, but these will require collection of substantially more data than available in our experiments to be effective.</p>
<fig id="pcbi.1004927.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004927.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Composition of RFs estimated by the HSM.</title>
<p>(A) The kernels of LGN HSM units fitted to the 3 imaged regions in V1. (B) The linear kernels of the hidden units of the HSM fitted to the 3 imaged regions in V1. These have been calculated as the sum of the difference-of-Gaussians kernel of the LGN units weighted by the fitted connections from the LGN to hidden units. (C) The weight matrices between the hidden and output units for HSMs fitted to the 3 imaged regions. For each output neuron the weights were individually normalized. (D) The histograms of the weight matrices shown in C with calculated kurtosis of the respective distributions. Overall, the RFs of the intermediate units in the fitted HSM differ somewhat from standard descriptions of V1 simple cell RFs estimated by rLN (or similar) methods. However, it is possible that the RFs of the hidden units are combined in the HSM output layer to form RFs that—when linearized—match those obtained via the rLN method. To verify this, we performed a rLN analysis using the training set of images and the corresponding responses of the fitted HSM, thus obtaining a linear estimate of the HSM-derived RFs. <xref ref-type="fig" rid="pcbi.1004927.g008">Fig 8</xref> shows the RFs obtained via the rLN method directly from the data (A columns) and using the corresponding HSM predictions (B columns) for neurons in the first imaged region. Neurons for which a linear RF could be estimated showed a close match between rLN and HSM estimations. This indicates that the fits of the HSM are compatible with the previous rLN results. At the same time, the HSM significantly outperforms response predictions of the rLN model for most neurons, indicating that non-linearities in the HSM, which cannot be captured by the inherently linear rLN model, provide significant performance improvements.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004927.g007" xlink:type="simple"/>
</fig>
<fig id="pcbi.1004927.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004927.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Linear components of RFs estimated with HSM are consistent with rLN-derived RFs.</title>
<p>For neurons where RFs can be discerned from the noise, the rLN model produces very similar RFs for both experimental responses (A columns) and HSM responses (B columns), indicating that the HSM is compatible with the RFs estimated by rLN. The numbers above the rLN filters obtained directly from data (A columns) show the performance (R) of the rLN model for the corresponding neuron. The two numbers above the rLN filters obtained using the prediction of the HSM (B columns) indicate the performance of the rLN model derived from the HSM prediction (before slash) and the performance of the full HSM for the corresponding neuron (after slash).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004927.g008" xlink:type="simple"/>
</fig>
<p>How then are the hidden layer RFs combined to generate the fitted RFs of the measured neurons in the HSM? <xref ref-type="fig" rid="pcbi.1004927.g007">Fig 7C</xref> shows the weight matrices between the hidden and output layer for all three regions. Each weight matrix is relatively dense. Based on theories about complex cell construction including the energy model [<xref ref-type="bibr" rid="pcbi.1004927.ref032">32</xref>] or the STC analysis, which suggest a relatively limited number of linear filters in complex cells [<xref ref-type="bibr" rid="pcbi.1004927.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1004927.ref010">10</xref>], one would expect these matrices to be sparse. This does not appear to be the case in the HSM, as is suggested by the negative kurtosis values of the weight distributions <xref ref-type="fig" rid="pcbi.1004927.g007">Fig 7D</xref>. One possibility is that these dense weight matrices are the consequence of over-fitting. Another option is that the model hidden units correspond to linear presynaptic cells (or linear combinations of a set of such cells) and the dense weight matrices between the hidden and output layer reflect the fact that single cortical neurons receive a large number of connections from other local cortical neurons [<xref ref-type="bibr" rid="pcbi.1004927.ref033">33</xref>]. Finally, the small number of hidden HSM units means that a combination of larger numbers of them might be needed to obtain the RFs of the individual recorded neurons, leading to a lack of sparseness in the weight matrices. In the future, simultaneous imaging of layer 4 and 2/3 will be required to resolve this question experimentally.</p>
<p>Finally, we examined the evidence for spatial organization of two model measures in the local cortical network (<xref ref-type="fig" rid="pcbi.1004927.g009">Fig 9</xref>). We found no evidence for a relationship between cortical distance and non-linearity index (<xref ref-type="fig" rid="pcbi.1004927.g009">Fig 9A and 9C</xref>; R &lt; 0.05, P&gt;0.1) or model prediction power (<xref ref-type="fig" rid="pcbi.1004927.g009">Fig 9B and 9D</xref>; R &lt; 0.05, P&gt;0.1). These results are consistent with the findings of several previous studies that—with the exception of retinotopic position—failed to find a spatially organized arrangement of neurons of similar RF properties in local cortical networks of rodent V1 [<xref ref-type="bibr" rid="pcbi.1004927.ref021">21</xref>,<xref ref-type="bibr" rid="pcbi.1004927.ref034">34</xref>].</p>
<fig id="pcbi.1004927.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004927.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Distribution of NLI index and HSM prediction power in cortical space.</title>
<p>(A-B): The scatter plots of the NLI index and HSM prediction power in cortical space from an example cortical region. The points correspond to the positions of cell bodies in cortical coordinates and the gray levels correspond to the two measures (first region shown, scale bar 50μm). (C-D) No correlation between cortical distance and NLI and HSM prediction power. The three recorded cortical regions correspond to the black, blue and orange colors. For both measures and all regions, all correlation coefficients were small (R&lt;0.05) and their signs were not consistent across regions.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004927.g009" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec008" sec-type="conclusions">
<title>Discussion</title>
<p>In this study we introduce a novel model-based method for estimating RFs simultaneously in large populations of V1 neurons, under the assumption that the population shares input from a limited number of thalamo-cortical afferents. We applied the novel model (HSM) to recordings of local populations of neurons in L2/3 of mouse V1 in response to natural images. Our model can explain significant proportions of signal variance of reliably responding neurons in V1 and improves upon existing rLN [<xref ref-type="bibr" rid="pcbi.1004927.ref011">11</xref>] and BWT models [<xref ref-type="bibr" rid="pcbi.1004927.ref029">29</xref>] when applied to the same data.</p>
<p>The improved performance of HSM in comparison to the rLN is due to its greater expressive power. The two layers of non-linearity allow the HSM to account for responses of non-linear cells, such as the complex cells in V1. Furthermore, we have also tested an advanced linear method, the automatic locality determination (ALD) [<xref ref-type="bibr" rid="pcbi.1004927.ref035">35</xref>], but when applied to our data this method showed very similar performance to the rLN model, yielding correlations in the validation set of 0.31, 0.24 and 0.299 in the three recorded regions. When compared to the BWT model, HSM still has the advantage in expressiveness for it allows constructions of RFs that deviate from the stereotypical Gabor-like RFs imposed into BWT structure. Moreover, HSM better constrains the optimization problem by assuming shared afferent input into a cortical column. Thus, unlike rLN or BWT, HSM fits all recorded neurons simultaneously. This makes the HSM parameters constrained by the responses of all recorded neurons, effectively increasing the amount of data available for fitting. Finally, it should be noted that we have also attempted to apply the STC method to the presented data. However, due to the dependence of STC on very large datasets, when applied to our limited data, STC failed to identify any significant eigenvectors for the majority of neurons [<xref ref-type="bibr" rid="pcbi.1004927.ref010">10</xref>]. This further highlights the advantages of the HSM in estimation of non-linear RFs from limited data.</p>
<p>Recent experimental studies have indicated that local populations of V1 neurons in cats and mice share a limited number of inputs from LGN [<xref ref-type="bibr" rid="pcbi.1004927.ref019">19</xref>] [<xref ref-type="bibr" rid="pcbi.1004927.ref025">25</xref>]. Here we offer further support for this hypothesis, by showing that a model assuming feed-forward convergence of thalamic afferents, shared among a population of neighboring cortical neurons, resulted in RF estimates with better predictive power than previous models (see <xref ref-type="fig" rid="pcbi.1004927.g005">Fig 5</xref>). Additionally, removing the assumption of pooled hierarchical input resulted in dramatic drop in quality of estimated RFs (see <xref ref-type="fig" rid="pcbi.1004927.g005">Fig 5</xref>). We show that as few as 9 LGN-like units are sufficient to explain a significant proportion of the stimulus dependent responses in a local population of L2/3 neurons within a ~300x300μm field of view. This is particularly remarkable given the diversity of RFs observed in local populations of mouse V1 neurons (<xref ref-type="fig" rid="pcbi.1004927.g003">Fig 3</xref>) [<xref ref-type="bibr" rid="pcbi.1004927.ref034">34</xref>].</p>
<p>It is important to emphasize that the estimated structure of the HSM cannot be interpreted as direct evidence of the underlying connectivity. This is obvious in the case of the hidden model units which are orders of magnitude fewer in the HSM models used in this study than the expected number of layer 4 neurons within the corresponding region of mouse V1. It is also very likely that we underestimate the actual number of thalamic neurons innervating the imaged regions of mouse V1. This might be because multiple LGN neurons with similar RFs will be approximated with a single LGN DoG model, consistent with a recent study that directly mapped the RFs of LGN axons in V1 [<xref ref-type="bibr" rid="pcbi.1004927.ref036">36</xref>]. Further advances in recording techniques that will allow collection of more data (both in terms of image presentation and sampling ratio of the local neural population) should impose more constraints on the fitting of HSM parameters and thus offer a closer picture of the underlying neural substrate. Furthermore, additional prior knowledge (if available), such as the cortical depth/layer membership of the neurons, or neural type, could be incorporated into the HSM model to further constrain its parameter estimation.</p>
<p>Unlike most previous approaches to RF estimation, the optimization problem HSM poses is not convex, and thus finding the global optimum is not guaranteed. But HSM still outperforms other methods because the non-convexity of the optimization is favorably compensated by its better expressive power. Importantly, the quality of the RF estimation is determined by the optimization algorithm used to fit the HSM parameters. We found the truncated Newton conjugate method worked well for the present form of the model, but adding further nonlinearities into the model dramatically decreased its performance. This is likely because adding nonlinearities transformed HSM into a so-called “deep learning” problem which is known to be difficult to optimize. However, the recent advances in optimization techniques applicable to deep-learning problems [<xref ref-type="bibr" rid="pcbi.1004927.ref037">37</xref>] could improve the fitting of HSM and allow inclusion of additional nonlinear mechanisms.</p>
<p>The limited number of natural images that we could present during each imaging experiment and the relatively slow time-course of spike-related calcium signals constrained this study in three important ways. First, we did not consider the temporal properties of RFs, because the slow sampling (7.6Hz) and kinetics (100s milliseconds) of the calcium signals did not lend this dataset to the analysis of fine-scale temporal response properties of RFs. Second, we did not utilize ‘early-stopping’ criteria to prevent over-fitting, as they require an extra dataset to be separated out of—in our case very limited—training set. We found that such reduction of the training set outweighed the gains due to early stopping. Third, estimation of couplings between neurons using the GLM method has previously been shown to greatly improve prediction power. However, we did not include coupling filters in HSM, as their estimation relies on fine-scale temporal sampling of the recorded neural activity [<xref ref-type="bibr" rid="pcbi.1004927.ref002">2</xref>]. Improvements in functional imaging, including higher sampling rates, improved signal-to-noise ratio, faster calcium indicator kinetics, voltage-based indicators, and better spike estimation techniques, will allow for more accurate reconstructions of underlying spike-trains in large populations of imaged neurons. Moreover, recent applications of genetically encoded calcium indicators and chronic preparations [<xref ref-type="bibr" rid="pcbi.1004927.ref038">38</xref>,<xref ref-type="bibr" rid="pcbi.1004927.ref039">39</xref>] could greatly increase the number of possible stimulus presentations in anaesthetized and awake mice. Overall, such advances would make it possible to overcome all the limitations discussed above, and thus provide a framework for further improvements in understanding the relationship between connectivity and functional properties of V1 and higher visual cortical areas.</p>
</sec>
<sec id="sec009" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec010">
<title>Animals and surgical procedures</title>
<p>All experimental procedures were carried out in accordance with institutional animal welfare guidelines and licensed by the UK Home Office. Experiments were performed on C57Bl/6 mice between postnatal day 30 and 40. Mice were anesthetized with a mixture of fentanyl (0.05 mg/kg), midazolam (5.0 mg/kg), and medetomidine (0.5 mg/kg). During Ca<sup>2+</sup>-imaging experiments, light anesthesia was maintained by Isoflurane (0.3–0.5%) in a 60:40% mixture of O<sub>2</sub>:N<sub>2</sub>O delivered via a small nose cone. Surgically, a small craniotomy (1–2 mm) was carried out over primary visual cortex and sealed after dye injection with 1.6% agarose in HEPES-buffered artificial cerebrospinal fluid (ACSF) and a cover slip.</p>
</sec>
<sec id="sec011">
<title>Dye-loading and Ca<sup>2+</sup>-imaging</title>
<p>For bulk loading of cortical neurons the calcium-sensitive dye Oregon Green Bapta-1 AM (OGB-1 AM; Molecular Probes) was first dissolved in 4 μl DMSO containing 20% Pluronic, and further diluted (1/11) in dye buffer (150 mM NaCl, 2.5 mM KCl and 10 mM HEPES (pH 7.4)) to yield a final concentration of 0.9 mM. Sulforhodamine-101 (50 μM, Molecular Probes) was added to the solution for experiments in C57Bl/6 mice to distinguish neurons and astrocytes [<xref ref-type="bibr" rid="pcbi.1004927.ref040">40</xref>]. The dye was slowly pressure injected into the right visual cortex at a depth of 150–200 μm with a micropipette (3–5 MΩ, 3–10 psi, 2–4 min) under visual control by two-photon imaging (10x water immersion objective, Olympus). Activity of cortical neurons was monitored by imaging fluorescence changes with a custom-built microscope and a mode-locked Ti:sapphire laser (Mai Tai, Spectra-Physics) at 830 nm through a 40x water immersion objective (0.8 NA, Olympus). Scanning and image acquisition were implemented in custom software (Labview, NI). The average laser power delivered to the brain was &lt;50 mW.</p>
</sec>
<sec id="sec012">
<title>Data acquisition in Ca<sup>2+</sup>-imaging experiments</title>
<p>Imaging frames of 256x256 pixels were acquired at 7.6 Hz. After each recording the focal plane and imaging position was checked and realigned with the initial image if necessary. Image sequences were aligned for tangential drift and analyzed with custom programs written in ImageJ (NIH), Matlab (Mathworks) and Labview (NI). Recordings with significant brain movements, vertical drift, or both were excluded from further analysis. Cell outlines were detected using a semi-automated algorithm based on morphological measurements of cell intensity, size, and shape, and subsequently confirmed by visual inspection. After erosion of the cell-based regions of interest, to minimize influence of the neuropil signal around the cell bodies, all pixels within each region of interest were averaged to give a single time course (ΔF/F), which was additionally high-pass filtered at a cut-off frequency of 0.02 Hz to remove slow fluctuations in the signal. Unresponsive neurons during spontaneous and evoked conditions were excluded from further analysis, by testing whether, for each cell, the distribution of all fluorescence values was not significantly different (i.e. positively long-tailed) from a random, normal distribution (Kolmogorov-Smirnov goodness-of-fit test). Astrocytes labeled with Sulforhodamine 101 (red fluorescence) were excluded from the analysis.</p>
<p>Spike trains were inferred from calcium signals using a fast non-negative de-convolution method which approximates the most likely spike train for each neuron, given the observed fluorescence [<xref ref-type="bibr" rid="pcbi.1004927.ref022">22</xref>]. The deconvolved traces represent estimates proportional to the number of action potentials emitted during the corresponding period. These proportional estimates were calibrated based on simultaneous cell attached recordings and calcium imaging in individual neurons [<xref ref-type="bibr" rid="pcbi.1004927.ref023">23</xref>] to represent the estimated number of emitted spikes. The inferred spike trains were further processed by computing the sliding average with a window of three frames. This was done to offset the biases introduced by the temporal quantization due to the relatively slow data acquisition rate.</p>
</sec>
<sec id="sec013">
<title>Stimulus presentation protocol and data pre-processing</title>
<p>Stimuli were presented on 60 Hz LCD monitors, at a resolution of 1024×768 pixels. A retinotopic mapping protocol was used to ensure that the monitor covered the RF of recorded neurons: a patch of moving gratings was presented at 12 different locations on the screen, for 1.4 s in each location with a gap of 1.5 s between locations. The monitor was repositioned such that the preferred retinotopic position of most imaged neurons was roughly in the middle of the monitor.</p>
<p>The stimulus set was composed of static scenes from David Attenborough’s BBC documentary Life of Mammals, depicting natural scenes such as landscapes, animals or humans. Images were scaled to have 256 equally spaced luminance steps, and were composed of 384×208 pixels, and expanded to fill the screen. Each image appeared in the stimulus set four times, in the original form, flipped horizontally and flipped vertically, and with reversed contrast. The onset of image presentation was aligned with the frame rate of the scanning.</p>
<p>To account for the noise and the dynamics of somatic calcium signals, we applied a relatively slow visual stimulation protocol (total time = 1974 ms per image presentation, i.e. 15 imaging frames at 7.6 Hz) to obtain reliable responses of V1 neuronal populations to the naturalistic stimuli. Images were presented for 500 ms, and interleaved with blank grey screens presented for 1474 ms (see <xref ref-type="fig" rid="pcbi.1004927.g001">Fig 1A</xref>). Averaging of the resulting calcium traces across all stimulus presentations and neurons revealed the typical onset and offset dynamics of the neural responses. We define the response of a neuron to single image presentation as the average number of spikes inferred by the spike extraction algorithm across imaging frames 3–7, which we identified to hold the bulk of the onset signal, but likely also an early component of the offset response. This way, for each imaged region, we obtained two datasets of values. The first is an <italic>n</italic>×<italic>m</italic> matrix corresponding to the responses of each of the <italic>m</italic> recorded neurons to <italic>n</italic> single trial image presentations, which we refer to as the training set (see <xref ref-type="fig" rid="pcbi.1004927.g001">Fig 1B</xref>). Additionally, in each region we recorded responses to 8–12 presentations of another 50 images forming the second dataset, a 50×<italic>m</italic>×<italic>r</italic> matrix, we will refer to as the validation set. Three regions in two animals were recorded, containing 103, 55 and 102 neurons, while presenting sequences of 1800, 1260 and 1800 single trial images, respectively. The images were presented in partially interleaved manner. The training images were divided into 10 blocks. Additional blocks were formed by the 50 validation images, in each of these blocks the 50 images were presented multiple times. During the experiment the resulting stimulation blocks were presented in random order.</p>
<p>For each region, we ran a rLN fitting protocol with full-field stimuli to determine the rough position and size of all the neurons' RFs. Consistent with retinotopic map in mouse V1, in all three recorded regions all recovered RFs were located in a restricted region of visual space. This allowed us to determine a region of interest in the visual space, centered on the set of initially recovered RFs and spanning roughly two times the area they covered. The images were constrained to this region of interest and then down-sampled to 31×31 pixels to form the input stimuli set, which was used in all the subsequent analysis.</p>
</sec>
<sec id="sec014">
<title>HSM</title>
<p>The HSM is a feed-forward network consisting of three fully connected layers (see <xref ref-type="fig" rid="pcbi.1004927.g002">Fig 2</xref>). The first layer corresponds to units found in LGN, represented as difference-of-Gaussian kernels. The output of the <italic>i</italic>-th unit in the LGN layer to an image <italic>I</italic> is computed as follows:
<disp-formula id="pcbi.1004927.e001">
<alternatives>
<graphic id="pcbi.1004927.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004927.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo> </mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo> </mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
where <italic>ψ</italic><sub><italic>i</italic>1</sub> is the output of the <italic>i</italic>-th unit in the first layer containing LGN units, <italic>I</italic><sub><italic>kl</italic></sub> is the image intensity at coordinates <italic>k</italic> and <italic>l</italic>, <italic>σ</italic><sub><italic>i</italic></sub> and <italic>ρ</italic><sub><italic>i</italic></sub> are the widths of the center and surround Gaussians of the <italic>i-</italic>th LGN unit, <inline-formula id="pcbi.1004927.e002"><alternatives><graphic id="pcbi.1004927.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004927.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004927.e003"><alternatives><graphic id="pcbi.1004927.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004927.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are the <italic>x</italic> and <italic>y</italic> center coordinates of the <italic>i</italic>-th LGN unit, and <italic>α</italic><sub><italic>i</italic></sub> and <italic>β</italic><sub><italic>i</italic></sub> are the weights of the center and surround respectively.</p>
<p>The two ‘cortical’ layers consist of simple linear integrators with a logistic-loss output non-linearity:
<disp-formula id="pcbi.1004927.e004">
<alternatives>
<graphic id="pcbi.1004927.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004927.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
where <italic>ψ</italic><sub><italic>il</italic></sub>, <italic>l</italic> ∈ {2,3}is the output of the <italic>i-</italic>th unit in layer <italic>l</italic>, <italic>w</italic><sub><italic>ij</italic></sub> is the weight from unit <italic>j</italic> to unit <italic>i</italic> and <italic>f</italic> is a logistic-loss transfer function:
<disp-formula id="pcbi.1004927.e005">
<alternatives>
<graphic id="pcbi.1004927.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004927.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mrow><mml:mtext>f</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mtext>x</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> log</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>x</mml:mtext><mml:mo>−</mml:mo><mml:msub><mml:mtext>t</mml:mtext><mml:mtext>i</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
where <italic>t</italic><sub><italic>i</italic></sub> is the threshold of unit <italic>i</italic>. Thus, the free parameters of the model are the 6 parameters per LGN unit (<italic>α</italic><sub><italic>i</italic></sub>,<italic>β</italic><sub><italic>i</italic></sub>,<inline-formula id="pcbi.1004927.e006"><alternatives><graphic id="pcbi.1004927.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004927.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mi>y</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,<italic>ρ</italic><sub><italic>i</italic></sub>), one parameter per each cortical unit corresponding to its threshold <italic>t</italic><sub><italic>i</italic></sub> and the weights between the layers, totaling 6<italic>s</italic><sub>1</sub> + <italic>s</italic><sub>2</sub> + <italic>s</italic><sub>3</sub> +<italic>s</italic><sub>1</sub><italic>s</italic><sub>2</sub> + <italic>s</italic><sub>2</sub><italic>s</italic><sub>3</sub> parameters, where <italic>S</italic><sub><italic>i</italic></sub> is the size of the layer <italic>i</italic>. Assuming Poisson spiking, we fit the HSM via a maximum-likelihood method by performing gradient descent on the corresponding log-likelihood function [<xref ref-type="bibr" rid="pcbi.1004927.ref041">41</xref>]:
<disp-formula id="pcbi.1004927.e007">
<alternatives>
<graphic id="pcbi.1004927.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004927.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:mrow><mml:mtext>log </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>i</mml:mi></mml:munder><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mtext>log</mml:mtext><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>i</mml:mi></mml:munder><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
where <italic>y</italic> are the measured neural responses, <italic>x</italic> are the input patterns, <italic>ϕ</italic> are the free parameters of the model and <inline-formula id="pcbi.1004927.e008"><alternatives><graphic id="pcbi.1004927.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004927.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:mo> </mml:mo><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the output of the model to image <italic>x</italic><sub><italic>i</italic></sub>. To implement the model and search for optima of its log-likelihood function we use the theano package [<xref ref-type="bibr" rid="pcbi.1004927.ref042">42</xref>,<xref ref-type="bibr" rid="pcbi.1004927.ref043">43</xref>] in combination with the constrained truncated Newton conjugate method (implemented by the Python scipy.fmin.tnc function). This optimization method allows constraining the parameters to lie within intervals, allowing us to enforce the centers of LGN units to lie within the image, and the width of the center and surround Gaussians of LGN units to be positive and smaller than the width of the image.</p>
<p>The model has two free meta-parameters that are not set by the fitting process: the number of LGN units (<italic>s</italic><sub>1</sub>) and the number of units in the hidden layer (<italic>s</italic><sub>2</sub> = <italic>γs</italic><sub>3</sub>), where <italic>γ</italic> expresses the number of hidden units as a fraction of the number of output units. We performed a systematic search for these two parameters with respect to the performance of the model on the training set. We found that the performance of the model on the training set quickly saturates when increasing the number of LGN inputs and the fraction of hidden units, at values of about <italic>s</italic><sub>1</sub> = 9 and <italic>γ</italic> = 0.2 respectively. Therefore, in order to prevent over-fitting and facilitate simple comparison, we decided to use these low values of the two free meta-parameters for fitting of all the three regions, in all the other analysis.</p>
<p>The optimization problem posed by the HSM log-likelihood function is not convex. Therefore we are not guaranteed to find a global optimum and thus the solution found, and consequently its performance, will be dependent on the initial parameter values. To lessen this dependence on initial parameters, each fitting was run multiple times with different randomly seeded initial parameter values, and followed by selecting the model with the best performance on the training set. The initial model parameterizations were obtained by specifying ranges for each HSM parameter, and then randomly selecting values uniformly from within these ranges. For example for the position parameters of the LGN DoG kernels we set the ranges to correspond to the extent of the input images. For the parameter search experiments we performed 20 restarts of the fitting algorithm for each meta-parameter combination, while for the rest of the analysis with the selected meta-parameters we performed 50 restarts.</p>
<p>To show that the initial parameter restarts are an effective method, we have fitted the HSM model using 100 different initial parameterizations (<xref ref-type="supplementary-material" rid="pcbi.1004927.s003">S1 Fig</xref>). The performance of the fitted HSM model on the training set was correlated with the performance on the validation set across the set of initial seeds (panel A in <xref ref-type="supplementary-material" rid="pcbi.1004927.s003">S1 Fig</xref>). Even though the different initial conditions lead to solutions with similar responses and prediction power (<xref ref-type="supplementary-material" rid="pcbi.1004927.s003">S1 Fig</xref>), these solutions correspond to considerably different estimates of the HSM parameters (even if we account for some basic ambiguities: see <xref ref-type="supplementary-material" rid="pcbi.1004927.s003">S1 Fig</xref> caption for details). We observe analogous results if we fix the initial conditions, but instead fit HSM on 100 sub-samples of the training set (<xref ref-type="supplementary-material" rid="pcbi.1004927.s004">S2 Fig</xref>). Overall, the HSM method is successful in consistently finding good functional descriptions of a neuron’s stimulus-response function, but these solutions are not unique, and many different HSM parameterizations can lead to the same input-output relationships. Such many-to-one mappings between HSM parameterizations and input-output functions are consistent with previous observations in machine learning and computational neuroscience [<xref ref-type="bibr" rid="pcbi.1004927.ref044">44</xref>–<xref ref-type="bibr" rid="pcbi.1004927.ref047">47</xref>]. It remains to be seen if incorporating additional constraints by increasing the amount of data for training, or obtaining more complete samples of local neuronal populations, or obtaining other experimental observables (e.g. layer membership or cell type of the recorded neurons) or further extending the HSM model (eg. with coupling filters) could lead to HSM parameterization that is less sensitive to initial conditions and more closely reflects the underlying biological substrate.</p>
<p>The exact time the model training took varied based on the free model parameters, the number of output neurons, and the size of the training set. For the first region (103 neurons, 1800 training examples) and the values of the free parameters used in the model comparison (see <xref ref-type="fig" rid="pcbi.1004927.g005">Fig 5</xref>) the fitting (a single initial condition) took approximately 3 hours on a modern 2.4MHz CPU with 4GB of memory.</p>
<p>To allow for visualization and comparison of the fitted model and to facilitate further analysis we also performed linearization of the model. We did this by fitting the rLN model to the HSM responses to the training set of images. Furthermore, in order to quantify the extent to which the accounted-for portion of the neuronal response predicted by the HSM is linear or non-linear, we define a non-linearity index (NLI) as:
<disp-formula id="pcbi.1004927.e009">
<alternatives>
<graphic id="pcbi.1004927.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004927.e009" xlink:type="simple"/>
<mml:math display="block" id="M9">
<mml:mrow><mml:mi>N</mml:mi><mml:mi>L</mml:mi><mml:mi>I</mml:mi><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mi>C</mml:mi><mml:mo> </mml:mo><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mi>L</mml:mi><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
where <italic>LC</italic> corresponds for the correlation between the activities predicted by the HSM and measured activities in response to the validation set of images, and LLC is the corresponding value but for the linearized HSM. For 53 of the 259 neurons for which <italic>LC</italic> &lt; <italic>LLC</italic> we set <italic>NLI</italic> to zero. For a given neuron, <italic>NLI</italic> will be zero if the correlation between measured activities and predicted activities by HSM is entirely accounted for by the linearized model alone, while the value is 1 if the linear model does not account for any of the correlation—and thus the correlations are due to non-linear aspects of the HSM.</p>
</sec>
<sec id="sec015">
<title>rLN model and the wavelet decomposition model</title>
<p>In order to assess the performance of the HSM against other RF decoding methods we fitted the same data with a regularized least-squares variant of the LN model [<xref ref-type="bibr" rid="pcbi.1004927.ref011">11</xref>], as well as with a recent method using nonlinear Berkeley wavelet transform (BWT) decomposition of the stimuli [<xref ref-type="bibr" rid="pcbi.1004927.ref008">8</xref>,<xref ref-type="bibr" rid="pcbi.1004927.ref029">29</xref>].</p>
<sec id="sec016">
<title>rLN</title>
<p>We used a variant of the linear-nonlinear model with Laplacian regularization [<xref ref-type="bibr" rid="pcbi.1004927.ref011">11</xref>] that has been shown to offer superior results over basic LN models, when applied to datasets composed of naturalistic stimuli. Following the filter estimation, we have also fitted the point non-linearity which significantly increased the performance of the rLN estimates. Briefly, the method is similar to ridge-regression estimation; however, instead of imposing minimal values on individual pixels it imposes a minimal Laplacian in each pixel of the estimated kernel, thus directly biasing the estimated kernels to be locally smooth:
<disp-formula id="pcbi.1004927.e010">
<alternatives>
<graphic id="pcbi.1004927.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004927.e010" xlink:type="simple"/>
<mml:math display="block" id="M10">
<mml:mrow><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo> </mml:mo><mml:mi>S</mml:mi><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mi>α</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo> </mml:mo><mml:mi>r</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
where <italic>k</italic> is the resulting kernel estimate, <italic>S</italic> is the stimulus matrix, <italic>L</italic> is the regularization matrix expressing the Laplacian constraints, <italic>α</italic> is the regularization constant determining the strength of the regularization, <italic>r</italic> is the measured responses of the neuron to the stimuli in <italic>S</italic>, and <italic>pinv</italic> is the Moore-Penrose pseudoinverse of a matrix. We selected the value of the meta-parameter <italic>α</italic> by measuring the performance of the model with respect to different values of the <italic>α</italic> parameter on a portion (10%) of the training set set aside for testing. This yielded a smooth function with a clear maximum. The value of the <italic>α</italic> parameter at this maximum was used in all the following performance comparisons. Next, after obtaining the estimate of the linear kernel <italic>k</italic> we used the training set to estimate the shape of the point non-linearity by doing a simple histogram fit at 20 regular intervals. To predict a response of a neuron given the output <italic>r</italic> of the estimated linear kernel, we find the two bins closest to <italic>r</italic> and use a linear interpolation between these two with respect to <italic>r</italic> to estimate the response of the neuron. Increasing or decreasing the number of bins slightly did not change the performance significantly. Overall, we found that both Laplacian regularization and the point non-linearity estimation greatly improved the performance of the model in comparison to basic rLN or the ridge-regression variant.</p>
</sec>
<sec id="sec017">
<title>Wavelet decomposition model</title>
<p>A detailed description of the wavelet decomposition model can be found in [<xref ref-type="bibr" rid="pcbi.1004927.ref008">8</xref>,<xref ref-type="bibr" rid="pcbi.1004927.ref029">29</xref>]. Briefly, the model consists of two stages. First the stimuli are decomposed using a bank of wavelet filters [<xref ref-type="bibr" rid="pcbi.1004927.ref029">29</xref>], and the response of each filter is half-rectified taking the positive and negative responses separately, forming a vector of half-rectified wavelet responses for each input. The second stage corresponds to a linear model where the final response of the neuron is described as the weighted sum of the half-rectified wavelet responses. This linear model is fitted by minimizing the standard mean-squares error loss function, using the L2Boost algorithm [<xref ref-type="bibr" rid="pcbi.1004927.ref048">48</xref>]. This algorithm iteratively adjusts only a single weight along the steepest gradient. Combined with early stopping to prevent over-fitting, this procedure tends to provide a sparse representation of the linear model.</p>
<p>We used the implementation of the above wavelet decomposition method provided by the freely available STRFLab package [<xref ref-type="bibr" rid="pcbi.1004927.ref049">49</xref>]. Due to the fact that our stimulation protocol suppressed the temporal properties of the neuron’s RF, and because single points in our data set represent the average activity over several hundred milliseconds, we set the temporal size and the number of velocities in the BWT to one, and the list of delays at which the RF was fitted was set to zero. Furthermore, the number of phases and the number of orientations in the BWT was set to 4 and 12 respectively and 2D Gaussians were also included in the set of pre-processing filters. We experimented with several values of these meta-parameters, and picked those showing best performance, to ensure that the BWT model is not disadvantaged in this comparison. The prediction power of both the rLN and Wavelet decomposition model was evaluated on the same separate validation data set as the HSM.</p>
</sec>
</sec>
</sec>
<sec id="sec018">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004927.s001" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004927.s001" xlink:type="simple">
<label>S1 Dataset</label>
<caption>
<title>Dataset of stimuli and corresponding population responses of recorded neurons.</title>
<p>The dataset contains the natural image stimuli used in this study, and the pre-processed population responses of mouse V1 neurons recorded in the 3 cortical regions analyzed in this study.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004927.s002" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004927.s002" xlink:type="simple">
<label>S1 Model</label>
<caption>
<title>Python implementation of the HSM model.</title>
<p>(ZIP)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004927.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004927.s003" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Analysis of sensitivity of HSM to starting conditions.</title>
<p>(A) The model performance on the training vs. validation data set across 100 HSM fits using different initial conditions. The three plots show results for each of the 3 imaged regions separately. The color coding of the regions is the same as throughout the main paper. (B) The correlations between responses of pairs of HSM model fits obtained from different initial conditions. (C) The RFs of matched LGN units of three different fits of the HSM model using different initial conditions (the selected initial conditions are marked in A as seed A,B and C). (D) Matched hidden unit RFs. The ordering of the LGN and hidden units in the HSM is arbitrary which complicates comparison of fitted parameters from different initial conditions. When comparing two model parameterizations, in an ideal case, we would like to find a permutation of the LGN and hidden units that maximizes the similarity (for example measured as the mean correlation across corresponding units) between the two sets of units. Finding such permutation is however intractable. Here we have employed simple greedy strategy to match the two sets of units. In C and D the units from seed B were matched to units from seed A and independently the units from seed C were matched to units from seed A. Furthermore, there is redundancy in the HSM model between the polarity of the LGN units and the weights from the LGN units to hidden units, which are not required to be only positive. For this reason the matching of the LGN units is based on the absolute values of their correlations, and for the visualization the LGN units are flipped such that their polarity matches. (E) The weights from hidden to output units.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004927.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004927.s004" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Analysis of sensitivity of HSM to different re-samplings of training set.</title>
<p>(A) The model performance on training vs. validation data set across 100 HSM fits using different sub-samples of the training set. Each sample was obtained by removing 100 random training stimuli. The three plots show results for each of the 3 imaged regions separately. The color coding of the regions is the same as throughout the main paper. (B) The correlations between responses of pairs of HSM model fits obtained from different training set samples. (C) The RFs of matched LGN units of three fits of HSM to three different samples of training set (the selected samples are marked in A as seed A,B and C). (D) Matched hidden unit RFs. See panel D of <xref ref-type="supplementary-material" rid="pcbi.1004927.s003">S1 Fig</xref> caption for details about the matching procedure. (E) The weights from hidden to output units.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Maneesh Sahani for a helpful discussion, and <ext-link ext-link-type="uri" xlink:href="http://dylan-muir.com/" xlink:type="simple">Dylan R. Muir</ext-link> and Lee Cossell for helpful suggestions and feedback on the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004927.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ko</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hofer</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Pichler</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Buchanan</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Sjöström</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Mrsic-Flogel</surname> <given-names>TD</given-names></name>. <article-title>Functional specificity of local synaptic connections in neocortical networks</article-title>. <source>Nature. Nature Publishing Group, a division of Macmillan Publishers Limited</source>. All Rights Reserved.; <year>2011</year> <month>Apr</month> <day>5</day>;<volume>473</volume>(<issue>7345</issue>):<fpage>1</fpage>–<lpage>7</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004927.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Shlens</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Sher</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Litke</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Chichilnisky</surname> <given-names>EJ</given-names></name>, <etal>et al</etal>. <article-title>Spatio-temporal correlations and visual signalling in a complete neuronal population</article-title>. <source>Nature</source>. <year>2008</year> <month>Aug</month> <day>21</day>;<volume>454</volume>(<issue>7207</issue>):<fpage>995</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature07140" xlink:type="simple">10.1038/nature07140</ext-link></comment> <object-id pub-id-type="pmid">18650810</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carandini</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Demb</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Mante</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Tolhurst</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Dan</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Olshausen</surname> <given-names>BA</given-names></name>, <etal>et al</etal>. <article-title>Do we know what the early visual system does?</article-title> <source>J Neurosci</source>. <year>2005</year>;<volume>25</volume>(<issue>46</issue>):<fpage>10577</fpage>–<lpage>97</lpage>. <object-id pub-id-type="pmid">16291931</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>DeAngelis</surname> <given-names>GC</given-names></name>, <name name-style="western"><surname>Ohzawa</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Freeman</surname> <given-names>R</given-names></name>. <article-title>Spatiotemporal organization of simple-cell receptive fields in the cat’s striate cortex. I. General characteristics and postnatal development</article-title>. <source>J Neurophysiol. Am Physiological Soc</source>; <year>1993</year>;<volume>69</volume>(<issue>4</issue>):<fpage>1091</fpage>.</mixed-citation></ref>
<ref id="pcbi.1004927.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reid</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Victor</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Shapley</surname> <given-names>RM</given-names></name>. <article-title>The use of m-sequences in the analysis of visual neurons: linear receptive field properties</article-title>. <source>Vis Neurosci</source>. <year>1997</year>;<volume>14</volume>(<issue>6</issue>):<fpage>1015</fpage>–<lpage>27</lpage>. <object-id pub-id-type="pmid">9447685</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jones</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Palmer</surname> <given-names>L a</given-names></name>. <article-title>The two-dimensional spatial structure of simple receptive fields in cat striate cortex</article-title>. <source>J Neurophysiol</source>. <year>1987</year> <month>Dec</month>;<volume>58</volume>(<issue>6</issue>):<fpage>1187</fpage>–<lpage>211</lpage>. <object-id pub-id-type="pmid">3437330</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Touryan</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lau</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dan</surname> <given-names>Y</given-names></name>. <article-title>Isolation of Relevant Visual Features from Random Stimuli for cortical complex cells</article-title>. <source>J Neurosci. Soc Neuroscience</source>; <year>2002</year>;<volume>22</volume>(<issue>24</issue>):<fpage>10811</fpage>–<lpage>8</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004927.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Willmore</surname> <given-names>BDB</given-names></name>, <name name-style="western"><surname>Prenger</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Gallant</surname> <given-names>JL</given-names></name>. <article-title>Neural representation of natural images in visual area V2</article-title>. <source>J Neurosci</source>. <year>2010</year> <month>Feb</month> <day>10</day>;<volume>30</volume>(<issue>6</issue>):<fpage>2102</fpage>–<lpage>14</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4099-09.2010" xlink:type="simple">10.1523/JNEUROSCI.4099-09.2010</ext-link></comment> <object-id pub-id-type="pmid">20147538</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smyth</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Willmore</surname> <given-names>BDB</given-names></name>, <name name-style="western"><surname>Baker</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Thompson</surname> <given-names>ID</given-names></name>, <name name-style="western"><surname>Tolhurst</surname> <given-names>DJ</given-names></name>. <article-title>The receptive-field organization of simple cells in primary visual cortex of ferrets under natural scene stimulation</article-title>. <source>J Neurosci</source>. <year>2003</year> <month>Jun</month>;<volume>23</volume>(<issue>11</issue>):<fpage>4746</fpage>–<lpage>59</lpage>. <object-id pub-id-type="pmid">12805314</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Touryan</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Felsen</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Dan</surname> <given-names>Y</given-names></name>. <article-title>Spatial structure of complex cell receptive fields measured with natural images</article-title>. <source>Neuron</source>. <year>2005</year> <month>Mar</month> <day>3</day>;<volume>45</volume>(<issue>5</issue>):<fpage>781</fpage>–<lpage>91</lpage>. <object-id pub-id-type="pmid">15748852</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Willmore</surname> <given-names>BDB</given-names></name>, <name name-style="western"><surname>Smyth</surname> <given-names>D</given-names></name>. <article-title>Methods for first-order kernel estimation: simple-cell receptive fields from responses to natural scenes</article-title>. <source>Network</source>. <year>2003</year> <month>Aug</month>;<volume>14</volume>(<issue>3</issue>):<fpage>553</fpage>–<lpage>77</lpage>. <object-id pub-id-type="pmid">12938771</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Freeman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ziemba</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Heeger</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Simoncelli</surname> <given-names>EP</given-names></name>, <name name-style="western"><surname>Movshon</surname> <given-names>JA</given-names></name>. <article-title>A functional and perceptual signature of the second visual area in primates</article-title>. <source>Nat Neurosci. Nature Publishing Group</source>; <year>2013</year>;<volume>16</volume>(<issue>7</issue>):<fpage>974</fpage>–<lpage>81</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004927.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lau</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Stanley</surname> <given-names>GB</given-names></name>, <name name-style="western"><surname>Dan</surname> <given-names>Y</given-names></name>. <article-title>Computational subunits of visual cortical neurons revealed by artificial neural networks</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2002</year> <month>Jun</month> <day>25</day>;<volume>99</volume>(<issue>13</issue>):<fpage>8974</fpage>–<lpage>9</lpage>. <object-id pub-id-type="pmid">12060706</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Prenger</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>MC-K</given-names></name>, <name name-style="western"><surname>David</surname> <given-names>S V</given-names></name>, <name name-style="western"><surname>Gallant</surname> <given-names>JL</given-names></name>. <article-title>Nonlinear V1 responses to natural scenes revealed by neural network analysis</article-title>. <source>Neural Netw</source>. <year>2004</year>;<volume>17</volume>(<issue>5–6</issue>):<fpage>663</fpage>–<lpage>79</lpage>. <object-id pub-id-type="pmid">15288891</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vintch</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Movshon</surname> <given-names>J a.</given-names></name>, <name name-style="western"><surname>Simoncelli</surname> <given-names>EP</given-names></name>. <article-title>A Convolutional Subunit Model for Neuronal Responses in Macaque V1</article-title>. <source>J Neurosci</source>. <year>2015</year>;<volume>35</volume>(<issue>44</issue>):<fpage>14829</fpage>–<lpage>41</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.2815-13.2015" xlink:type="simple">10.1523/JNEUROSCI.2815-13.2015</ext-link></comment> <object-id pub-id-type="pmid">26538653</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lehky</surname></name>, <name name-style="western"><surname>Sidney</surname> <given-names>R.</given-names></name>;<name name-style="western"><surname>Sejnowski</surname></name>, <name name-style="western"><surname>Terrence</surname> <given-names>J.</given-names></name>;<name name-style="western"><surname>Desimone</surname> <given-names>R</given-names></name>. <article-title>Predicting responses of nonlinear neurons in monkey striate cortex to complex patterns</article-title>. <source>J Neurosci</source>. <year>1992</year>;<volume>12</volume>(<issue>9</issue>):<fpage>3568</fpage>–<lpage>81</lpage>. <object-id pub-id-type="pmid">1527596</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McFarland</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Cui</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Butts</surname> <given-names>DA</given-names></name>. <article-title>Inferring nonlinear neuronal computation based on physiologically plausible inputs</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year> <month>Jan</month>;<volume>9</volume>(<issue>7</issue>):<fpage>e1003143</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003143" xlink:type="simple">10.1371/journal.pcbi.1003143</ext-link></comment> <object-id pub-id-type="pmid">23874185</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kay</surname> <given-names>KN</given-names></name>, <name name-style="western"><surname>Naselaris</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Prenger</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Gallant</surname> <given-names>JL</given-names></name>. <article-title>Identifying natural images from human brain activity</article-title>. <source>Nature. Nature Publishing Group</source>; <year>2008</year> <month>Mar</month> <day>20</day>;<volume>452</volume>(<issue>7185</issue>):<fpage>352</fpage>–<lpage>5</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004927.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Häusser</surname> <given-names>M</given-names></name>. <article-title>Parallel processing of visual space by neighboring neurons in mouse visual cortex</article-title>. <source>Nat Neurosci. Nature Publishing Group</source>; <year>2010</year> <month>Sep</month>;<volume>13</volume>(<issue>9</issue>):<fpage>1144</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004927.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stosiek</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Garaschuk</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Holthoff</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Konnerth</surname> <given-names>A</given-names></name>. <article-title>In vivo two-photon calcium imaging of neuronal networks</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2003</year>;<volume>100</volume>(<issue>12</issue>):<fpage>7319</fpage>–<lpage>24</lpage>. <object-id pub-id-type="pmid">12777621</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ohki</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Chung</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ch’ng</surname> <given-names>YH</given-names></name>, <name name-style="western"><surname>Kara</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Reid</surname> <given-names>RC</given-names></name>. <article-title>Functional imaging with cellular resolution reveals precise micro-architecture in visual cortex</article-title>. <source>Nature</source>. <year>2005</year> <month>Feb</month> <day>10</day>;<volume>433</volume>(<issue>7026</issue>):<fpage>597</fpage>–<lpage>603</lpage>. <object-id pub-id-type="pmid">15660108</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vogelstein</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Packer</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Machado</surname> <given-names>T a</given-names></name>, <name name-style="western"><surname>Sippy</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Babadi</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Fast nonnegative deconvolution for spike train inference from population calcium imaging</article-title>. <source>J Neurophysiol</source>. <year>2010</year> <month>Dec</month>;<volume>104</volume>(<issue>6</issue>):<fpage>3691</fpage>–<lpage>704</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.01073.2009" xlink:type="simple">10.1152/jn.01073.2009</ext-link></comment> <object-id pub-id-type="pmid">20554834</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hofer</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Ko</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Pichler</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Vogelstein</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ros</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Zeng</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Differential connectivity and response dynamics of excitatory and inhibitory neurons in visual cortex</article-title>. <source>Nat Neurosci</source>. <year>2011</year> <month>Aug</month>;<volume>14</volume>(<issue>8</issue>):<fpage>1045</fpage>–<lpage>52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2876" xlink:type="simple">10.1038/nn.2876</ext-link></comment> <object-id pub-id-type="pmid">21765421</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bonin</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Mante</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Carandini</surname> <given-names>M</given-names></name>. <article-title>The suppressive field of neurons in lateral geniculate nucleus</article-title>. <source>J Neurosci</source>. <year>2005</year> <month>Nov</month> <day>23</day>;<volume>25</volume>(<issue>47</issue>):<fpage>10844</fpage>–<lpage>56</lpage>. <object-id pub-id-type="pmid">16306397</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Swadlow</surname> <given-names>HA</given-names></name>, <name name-style="western"><surname>Alonso</surname> <given-names>J-M</given-names></name>. <article-title>Population receptive fields of ON and OFF thalamic inputs to an orientation column in visual cortex</article-title>. <source>Nat Neurosci. Nature Publishing Group</source>; <year>2011</year> <month>Feb</month>;<volume>14</volume>(<issue>2</issue>):<fpage>232</fpage>–<lpage>8</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004927.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reid</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Alonso</surname> <given-names>J-M</given-names></name>. <article-title>Specificity of monosynaptic connections from thalamus to visual cortex</article-title>. <source>Nature</source>. <year>1995</year> <month>Nov</month> <day>16</day>;<volume>378</volume>(<issue>6554</issue>):<fpage>281</fpage>–<lpage>4</lpage>. <object-id pub-id-type="pmid">7477347</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>HUBEL</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>WIESEL</surname> <given-names>TN</given-names></name>. <article-title>Receptive fields, binocular interaction and functional architecture in the cat’s visual cortex</article-title>. <source>J Physiol</source>. <year>1962</year> <month>Jan</month>;<volume>160</volume>:<fpage>106</fpage>–<lpage>54</lpage>. <object-id pub-id-type="pmid">14449617</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reid</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Alonso</surname> <given-names>J-M</given-names></name>. <article-title>Specificity of monosynaptic connections from thalamus to visual cortex</article-title>. <source>Nature</source>. <year>1995</year> <month>Nov</month> <day>16</day>;<volume>378</volume>(<issue>6554</issue>):<fpage>281</fpage>–<lpage>4</lpage>. <object-id pub-id-type="pmid">7477347</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Willmore</surname> <given-names>BDB</given-names></name>, <name name-style="western"><surname>Prenger</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>MC-K</given-names></name>, <name name-style="western"><surname>Gallant</surname> <given-names>JL</given-names></name>. <article-title>The berkeley wavelet transform: a biologically inspired orthogonal wavelet transform</article-title>. <source>Neural Comput</source>. <year>2008</year> <month>Jun</month>;<volume>20</volume>(<issue>6</issue>):<fpage>1537</fpage>–<lpage>64</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.2007.05-07-513" xlink:type="simple">10.1162/neco.2007.05-07-513</ext-link></comment> <object-id pub-id-type="pmid">18194102</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwartz</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Rust</surname> <given-names>NC</given-names></name>, <name name-style="western"><surname>Simoncelli</surname> <given-names>EP</given-names></name>. <article-title>Spike-triggered neural characterization</article-title>. <source>J Vis</source>. <year>2006</year> <month>Jan</month>;<volume>6</volume>(<issue>4</issue>):<fpage>484</fpage>–<lpage>507</lpage>. <object-id pub-id-type="pmid">16889482</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref031"><label>31</label><mixed-citation publication-type="other" xlink:type="simple">Gallant JL. The Neural Prediction Challange [Internet]. 2006. Available from: <ext-link ext-link-type="uri" xlink:href="http://neuralprediction.berkeley.edu/" xlink:type="simple">http://neuralprediction.berkeley.edu/</ext-link></mixed-citation></ref>
<ref id="pcbi.1004927.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Adelson</surname> <given-names>EH</given-names></name>, <name name-style="western"><surname>Bergen</surname> <given-names>JR</given-names></name>. <article-title>Spatiotemporal energy models for the perception of motion</article-title>. <source>J Opt Soc Am A</source>. <year>1985</year> <month>Feb</month> <day>1</day>;<volume>2</volume>(<issue>2</issue>):<fpage>284</fpage>. <object-id pub-id-type="pmid">3973762</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Binzegger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Douglas</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>K a C</given-names></name>. <article-title>A quantitative map of the circuit of cat primary visual cortex</article-title>. <source>J Neurosci</source>. <year>2004</year> <month>Sep</month> <day>29</day>;<volume>24</volume>(<issue>39</issue>):<fpage>8441</fpage>–<lpage>53</lpage>. <object-id pub-id-type="pmid">15456817</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bonin</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Histed</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Yurgenson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Reid</surname> <given-names>RC</given-names></name>. <article-title>Local Diversity and Fine-Scale Organization of Receptive Fields in Mouse Visual Cortex</article-title>. <source>J Neurosci</source>. <year>2011</year> <month>Dec</month> <day>14</day>;<volume>31</volume>(<issue>50</issue>):<fpage>18506</fpage>–<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.2974-11.2011" xlink:type="simple">10.1523/JNEUROSCI.2974-11.2011</ext-link></comment> <object-id pub-id-type="pmid">22171051</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Park</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>. <article-title>Receptive field inference with localized priors</article-title>. <source>PLoS Comput Biol</source>. <year>2011</year>;<volume>7</volume>(<issue>10</issue>).</mixed-citation></ref>
<ref id="pcbi.1004927.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Roth</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Dahmen</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Muir</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Imhof</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Martini</surname> <given-names>FJ</given-names></name>, <name name-style="western"><surname>Hofer</surname> <given-names>SB</given-names></name>. <article-title>Thalamic nuclei convey diverse contextual information to layer 1 of visual cortex</article-title>. <source>Nat Neurosci</source>. <year>2016</year>;<volume>19</volume>(<issue>2</issue>):<fpage>148</fpage>.</mixed-citation></ref>
<ref id="pcbi.1004927.ref037"><label>37</label><mixed-citation publication-type="other" xlink:type="simple">Martens J. Deep learning via Hessian-free optimization. Proceedings of the 27th International Conference on Machine Learning. 2010.</mixed-citation></ref>
<ref id="pcbi.1004927.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Andermann</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Kerlin</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Reid</surname> <given-names>RC</given-names></name>. <article-title>Chronic cellular imaging of mouse visual cortex during operant behavior and passive viewing</article-title>. <source>Front Cell Neurosci</source>. <year>2010</year> <month>Jan</month>;<volume>4</volume>(<issue>March</issue>):<fpage>3</fpage>.</mixed-citation></ref>
<ref id="pcbi.1004927.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mank</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Santos</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Direnberger</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mrsic-Flogel</surname> <given-names>TD</given-names></name>, <name name-style="western"><surname>Hofer</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Stein</surname> <given-names>V</given-names></name>, <etal>et al</etal>. <article-title>A genetically encoded calcium indicator for chronic in vivo two-photon imaging</article-title>. <source>Nat Methods</source>. <year>2008</year> <month>Sep</month>;<volume>5</volume>(<issue>9</issue>):<fpage>805</fpage>–<lpage>11</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1243" xlink:type="simple">10.1038/nmeth.1243</ext-link></comment> <object-id pub-id-type="pmid">19160515</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nimmerjahn</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kirchhoff</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Kerr</surname> <given-names>JND</given-names></name>, <name name-style="western"><surname>Helmchen</surname> <given-names>F</given-names></name>. <article-title>Sulforhodamine 101 as a specific marker of astroglia in the neocortex in vivo</article-title>. <source>Nat Methods</source>. <year>2004</year> <month>Oct</month>;<volume>1</volume>(<issue>1</issue>):<fpage>31</fpage>–<lpage>7</lpage>. <object-id pub-id-type="pmid">15782150</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref041"><label>41</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>. <chapter-title>Likelihood-Based Approaches to Modeling the Neural Code Jonathan Pillow</chapter-title>. In: <name name-style="western"><surname>Doya</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ishii</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Pouget</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rao</surname> <given-names>R</given-names></name>, editors. <source>Bayesian Brain: Probabilistic Approaches to Neural Coding</source>. <publisher-name>MIT press</publisher-name>; <year>2007</year>. p. <fpage>53</fpage>–<lpage>70</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004927.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bastien</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Lamblin</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Pascanu</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bergstra</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Goodfellow</surname> <given-names>IJ</given-names></name>, <name name-style="western"><surname>Bergeron</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Theano: new features and speed improvements</article-title>. <source>NIPS</source>. <year>2012</year>.</mixed-citation></ref>
<ref id="pcbi.1004927.ref043"><label>43</label><mixed-citation publication-type="other" xlink:type="simple">Bergstra J, Breuleux O, Bastien F, Lamblin P, Pascanu R, Desjardins G, et al. Theano: a CPU and GPU Math Expression Compiler. Proceedings of the Python for Scientific Computing Conference (SciPy). 2010.</mixed-citation></ref>
<ref id="pcbi.1004927.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>DiMattina</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>K</given-names></name>. <article-title>How to modify a neural network gradually without changing its input-output functionality</article-title>. <source>Neural Comput</source>. <year>2010</year>;<volume>22</volume>:<fpage>1</fpage>–<lpage>47</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.2009.05-08-781" xlink:type="simple">10.1162/neco.2009.05-08-781</ext-link></comment> <object-id pub-id-type="pmid">19842986</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Prinz</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Bucher</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Marder</surname> <given-names>E</given-names></name>. <article-title>Similar network activity from disparate circuit parameters</article-title>. <source>Nat Neurosci</source>. <year>2004</year>;<volume>7</volume>(<issue>12</issue>):<fpage>1345</fpage>–<lpage>52</lpage>. <object-id pub-id-type="pmid">15558066</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rozell</surname> <given-names>CJ</given-names></name>. <article-title>Modeling Inhibitory Interneurons in Efficient Sensory Coding Models</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>:<fpage>e1004353</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004353" xlink:type="simple">10.1371/journal.pcbi.1004353</ext-link></comment> <object-id pub-id-type="pmid">26172289</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>LeCun</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bengio</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>G</given-names></name>. <article-title>Deep learning</article-title>. <source>Nature</source>. <year>2015</year>;<volume>521</volume>:<fpage>436</fpage>–<lpage>44</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature14539" xlink:type="simple">10.1038/nature14539</ext-link></comment> <object-id pub-id-type="pmid">26017442</object-id></mixed-citation></ref>
<ref id="pcbi.1004927.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friedman</surname> <given-names>JH</given-names></name>. <article-title>Greedy Function Approximation: A Gradient Boosting Machine</article-title>. <source>Ann Stat</source>. <year>2000</year>;<volume>29</volume>:<fpage>1189</fpage>–<lpage>232</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004927.ref049"><label>49</label><mixed-citation publication-type="other" xlink:type="simple">STRFPAK Matlab Toolbox [Internet]. Available from: <ext-link ext-link-type="uri" xlink:href="http://strfpak.berkeley.edu/" xlink:type="simple">http://strfpak.berkeley.edu/</ext-link></mixed-citation></ref>
</ref-list>
</back>
</article>