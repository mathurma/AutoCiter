<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006397</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01264</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Brain mapping</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Diagnostic medicine</subject><subj-group><subject>Diagnostic radiology</subject><subj-group><subject>Magnetic resonance imaging</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Diagnostic radiology</subject><subj-group><subject>Magnetic resonance imaging</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Radiology and imaging</subject><subj-group><subject>Diagnostic radiology</subject><subj-group><subject>Magnetic resonance imaging</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Random variables</subject><subj-group><subject>Covariance</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Monte Carlo method</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Monte Carlo method</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical noise</subject><subj-group><subject>Gaussian noise</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical noise</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Neuroimaging</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuroimaging</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data acquisition</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Methods for computing the maximum performance of computational models of fMRI responses</article-title>
<alt-title alt-title-type="running-head">Methods for computing the maximum performance of computational models of fMRI responses</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2596-1540</contrib-id>
<name name-style="western">
<surname>Lage-Castellanos</surname>
<given-names>Agustin</given-names>
</name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="fn" rid="currentaff001"><sup>¤</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Valente</surname>
<given-names>Giancarlo</given-names>
</name>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5008-2460</contrib-id>
<name name-style="western">
<surname>Formisano</surname>
<given-names>Elia</given-names>
</name>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="fn" rid="currentaff001"><sup>¤</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>De Martino</surname>
<given-names>Federico</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="fn" rid="currentaff001"><sup>¤</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Cognitive Neuroscience, Faculty of Psychology and Neuroscience, Maastricht University, Maastricht, The Netherlands</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Department of NeuroInformatics, Cuban Center for Neuroscience, Cuba</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Maastricht Centre for Systems Biology (MaCSBio), Maastricht University, Maastricht, The Netherlands</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Center for Magnetic Resonance Research, Department of Radiology, University of Minnesota, Minneapolis, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Diedrichsen</surname>
<given-names>Jörn</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Western University, CANADA</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="current-aff" id="currentaff001">
<label>¤</label>
<p>Current address: Department of Cognitive Neuroscience, Faculty of Psychology and Neuroscience, Maastricht University, Maastricht, The Netherlands</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">a.lagecastellanos@maastrichtuniversity.nl</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>8</day>
<month>3</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="collection">
<month>3</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>3</issue>
<elocation-id>e1006397</elocation-id>
<history>
<date date-type="received">
<day>23</day>
<month>7</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>17</day>
<month>1</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Lage-Castellanos et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006397"/>
<abstract>
<p>Computational neuroimaging methods aim to predict brain responses (measured e.g. with functional magnetic resonance imaging [fMRI]) on the basis of stimulus features obtained through computational models. The accuracy of such prediction is used as an indicator of how well the model describes the computations underlying the brain function that is being considered. However, the prediction accuracy is bounded by the proportion of the variance of the brain response which is related to the measurement noise and not to the stimuli (or cognitive functions). This bound to the performance of a computational model has been referred to as the noise ceiling. In previous fMRI applications two methods have been proposed to estimate the noise ceiling based on either a split-half procedure or Monte Carlo simulations. These methods make different assumptions over the nature of the effects underlying the data, and, importantly, their relation has not been clarified yet. Here, we derive an analytical form for the noise ceiling that does not require computationally expensive simulations or a splitting procedure that reduce the amount of data. The validity of this analytical definition is proved in simulations, we show that the analytical solution results in the same estimate of the noise ceiling as the Monte Carlo method. Considering different simulated noise structure, we evaluate different estimators of the variance of the responses and their impact on the estimation of the noise ceiling. We furthermore evaluate the interplay between regularization (often used to estimate model fits to the data when the number of computational features in the model is large) and model complexity on the performance with respect to the noise ceiling. Our results indicate that when considering the variance of the responses across runs, computing the noise ceiling analytically results in similar estimates as the split half estimator and approaches the true noise ceiling under a variety of simulated noise scenarios. Finally, the methods are tested on real fMRI data acquired at 7 Tesla.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Encoding computational models in brain responses measured with fMRI allows testing the algorithmic representations carried out by the neural population within voxels. The accuracy of a model in predicting new responses is used as a measure of the brain validity of the computational model being tested, but the result of this analysis is determined not only by how precisely the model describes the responses but also by the quality of the data. In this article, we evaluate existing approaches to estimate the best possible accuracy that any computational model can achieve conditioned to the amount of measurement noise that is present in the experimental data (i.e. the noise ceiling). Additionally we introduce a close form estimation of the noise ceiling that does not require computationally or data expensive procedures. All the methods are compared using simulated and real fMRI data. We draw conclusions over the impact of regularization procedures and make practical recommendations on how to report the results of computational models in neuroimaging.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Nederlandse Organisatie voor Wetenschappelijk Onderzoek (NL)</institution>
</funding-source>
<award-id>VIDI grant 864-13-012</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2596-1540</contrib-id>
<name name-style="western">
<surname>Lage-Castellanos</surname>
<given-names>Agustin</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>Nederlandse Organisatie voor Wetenschappelijk Onderzoek (NL)</institution>
</funding-source>
<award-id>VIDI grant 864-13-012</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>De Martino</surname>
<given-names>Federico</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003246</institution-id>
<institution>Nederlandse Organisatie voor Wetenschappelijk Onderzoek</institution>
</institution-wrap>
</funding-source>
<award-id>VICI grant 453-12-002</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5008-2460</contrib-id>
<name name-style="western">
<surname>Formisano</surname>
<given-names>Elia</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by the Netherlands Organization for Scientific Research (NWO; VIDI grant 864-13-012 to F.D.M, and VICI grant 453-12-002 to E.F). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="11"/>
<table-count count="1"/>
<page-count count="25"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-03-20</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The data and the matlab codes are achieved and described at zenodo.org. The voxels time series for one subject, the fMRI design matrix, the β images (assuming identity covariance matrix for the noise) and the Matlab codes for computing the noise ceiling can be downloaded from the same zenodo url at: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/deposit/1489531" xlink:type="simple">https://zenodo.org/deposit/1489531</ext-link>, doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.1489531" xlink:type="simple">10.5281/zenodo.1489531</ext-link>. Additional data and codes can be obtained by request to the authors (<email xlink:type="simple">a.lagecastellanos@maastrichtuniversity.nl</email>).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Computational modelling approaches applied to functional magnetic resonance imaging (fMRI) measurements aim to explain and predict the brain responses by expressing them as a function of model features that describe the sensory (or cognitive) stimuli [<xref ref-type="bibr" rid="pcbi.1006397.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1006397.ref005">5</xref>]. By doing so, computational neuroimaging methods have been proposed as a means to test the (brain) validity of the algorithm being evaluated and eventually its refinement.</p>
<p>At the single voxel level, two different approaches, population Receptive Fields (pRF) modelling [<xref ref-type="bibr" rid="pcbi.1006397.ref003">3</xref>] and linearized encoding models [<xref ref-type="bibr" rid="pcbi.1006397.ref006">6</xref>,<xref ref-type="bibr" rid="pcbi.1006397.ref007">7</xref>], have been developed to link computational models and fMRI responses. In the following, we will refer to both these approaches indiscriminately as encoding models (see e.g. [<xref ref-type="bibr" rid="pcbi.1006397.ref008">8</xref>] for the relation between linearized encoding models and pRF approaches).</p>
<p>The performance of a computational model that describes fMRI responses is evaluated in terms of its accuracy in predicting new (test) data. The prediction accuracy is not only affected by inaccuracies in the definition of the algorithm (i.e. mismodelling) but also by other sources of variance in the brain responses that are not expressly modelled (e.g. attention and adaptation) and, most importantly, by physiological (e.g. respiration) and measurement noise. These effects are evidenced by the fact that in real data, presenting multiple times the same stimulus does not result in the same measured brain response. Commonly tested models of sensory (or cognitive) stimuli do not account for the variability in the response between repetitions of the same stimulus which imposes a bound to the ability to encode computational models in fMRI responses. This bound can be interpreted as the performance of the computational model underlying the generation of the responses (i.e. the true underlying model) conditional to the noise (experimental, physiological or other) that is present in the test data (under the assumption of infinite training data). It should be noted here that this represents one of many possible definitions of a bound to the performance of a computational model. This bound is imposed exclusively by the measurement noise in the test data (i.e. <italic>test-data-noise ceiling</italic>). A more realistic definition of the noise ceiling would also consider the influence of the size of the training set and the algorithms used for estimating the computational model, however it has not been proposed yet. Reporting the <italic>test-data-noise ceiling</italic> allows assessing the quality of the predictions obtained when using computational modelling approaches relative to the quality of the data, and thus comparing modelling efforts on different datasets across labs.</p>
<p>In the neuroimaging community, it has been recommended to report the performance of a computational model with respect to the (test data) noise ceiling and, in some cases, these recommendations have led to the use of normalized accuracy scores (e.g. dividing the accuracy by the noise ceiling, [<xref ref-type="bibr" rid="pcbi.1006397.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1006397.ref013">13</xref>]). Different estimation procedures have been proposed for the <italic>test-data-noise ceiling</italic> but the properties of these different estimators have not been compared. The main purpose of this article is to provide a framework in which the concept of the <italic>test-data-noise ceiling</italic> can be clarified for the users of encoding models and in which different estimators can be compared on the basis of their assumptions.</p>
<p>To illustrate the concept of <italic>test-data-noise ceiling</italic> we can consider the two-step procedure that in many cases is used when fitting a computational model. In the first step, responses to the stimuli are estimated from the whole fMRI time series and, in the second step, the computational model is fit to the stimulus response series. While this two-level procedure is not used by all encoding approaches in practice, the unmodelled variability of the response between repetitions of the same stimulus limits the performance of a computational model that predicts the whole fMRI time series as well (see e.g. pRF models [<xref ref-type="bibr" rid="pcbi.1006397.ref003">3</xref>]). As a consequence of this hierarchical estimation framework, the prediction accuracy of the model (step 2) is bound by the uncertainty in the estimation of the response (step 1). This bound corresponds to the intraclass correlation coefficient [<xref ref-type="bibr" rid="pcbi.1006397.ref014">14</xref>] a well-known result in multilevel modelling.</p>
<p>The noise ceiling can be obtained considering the variability across subjects (see e.g. [<xref ref-type="bibr" rid="pcbi.1006397.ref015">15</xref>]), but here we will focus on estimation procedures at the single subject level, where two approaches have been proposed to estimate the <italic>test-data-noise ceiling</italic> of single voxels. The first models the response of a voxel as a univariate normal distribution with two variance components [<xref ref-type="bibr" rid="pcbi.1006397.ref016">16</xref>]. The first variance component corresponds to the variability of the signal around its mean due to genuine differences in the brain response between different stimuli (excluding the effects of measurement noise). The second variance component corresponds to the variability in the brain response due to measurement noise. Having an estimate of the measurement noise allows generating new samples for both the signal without noise (genuine brain response) and the measurement (i.e. signal plus noise) using Monte Carlo simulations. The noise ceiling (measured with correlation or predictive R<sup>2</sup>) is then computed using the simulated signals and measurements (i.e. considering the performance in predicting the noisy measurements of a model whose prediction is the clean signal). In what follows we will refer to this approach as the Monte Carlo noise ceiling (MCnc). Alternatively, the noise ceiling can be estimated as the correlation between the estimates of the responses in two independent repetitions of the same experimental procedure [<xref ref-type="bibr" rid="pcbi.1006397.ref017">17</xref>,<xref ref-type="bibr" rid="pcbi.1006397.ref018">18</xref>]. In absence of two repetitions of the test set, the split-half noise ceiling estimator (SHnc) can be estimated by splitting the available test data in two disjoint sets (i.e. splitting the trials of all test stimuli in two sets to obtain two estimates of the test data), computing the split-half correlation and applying a correction factor that accounts for the reduced number of trials in each half of the data compared to the full dataset. In this article, we describe the differences between these two noise ceiling estimators using simulated data and derive an analytical solution to the calculation of the <italic>test-data-noise ceiling</italic> obviating the need of computationally demanding procedures (i.e. Monte Carlo simulations) or splitting the data in two sets. Importantly, the MCnc and the analytical noise ceiling we propose are based on an estimate of the variability of the estimated responses due to the measurement noise. In simulations, we show how different estimators for this variability impact the resulting <italic>test-data-noise ceiling</italic> depending on the structure of the noise in the data.</p>
<p>When using linearized encoding approaches, regularization is often required because of the dimensionality of the model with respect to the number of stimuli and because of collinearity between the features of the computational model. Here we evaluate how the bias variance tradeoff introduced by the regularization influences the performance of an ideal model and thus the relationship with the noise ceiling (which is model independent) by imposing a second constraint.</p>
<p>Finally, we evaluate the differences between the noise ceiling estimators using real fMRI data, obtained from 7 Tesla acquisitions. Our results are discussed in terms of their implications for the evaluation of computational models and their comparison using fMRI data.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<p>We consider a two-level procedure to fit a computational model to fMRI responses. At the first level, fMRI responses to single stimuli are estimated from the fMRI time series and, at the second level, the computational model is (linearly) fit to the vector of fMRI responses in order to derive the parameter weights (in the space of the features of the computational model).</p>
<p><xref ref-type="fig" rid="pcbi.1006397.g001">Fig 1</xref> illustrates key concepts that underlie the notion of noise ceiling. Brain responses (<bold><italic>β</italic></bold>) can be considered a (linear) function, with weights representing the population receptive field (<bold><italic>P</italic></bold>), of the representation of the stimuli in the space of a computational model (<bold><italic>X</italic></bold> with 3-features in <xref ref-type="fig" rid="pcbi.1006397.g001">Fig 1A</xref>). The measurement of brain responses (<xref ref-type="fig" rid="pcbi.1006397.g001">Fig 1B</xref>) is affected by experimental/measurement noise such that the estimate of the responses of a given voxel to the same stimuli in two independent measurements (<xref ref-type="fig" rid="pcbi.1006397.g001">Fig 1B</xref>) differs. Fitting a computational model to the measured brain responses allows linking the model features to the measurements and thus predicting voxel responses to new (test) stimuli. When this procedure is used on noisy measurements, the experimental noise imposes a limit to the performance of the model in predicting the measured responses.</p>
<fig id="pcbi.1006397.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006397.g001</object-id>
<label>Fig 1</label>
<caption>
<title>General description of linking a computational model to fMRI brain responses.</title>
<p>Encoding approaches assume brain responses (pink in panel A) to be a linear function of the model based representation of the stimuli X (pink dots) (A). Observed fMRI responses (B) are affected by experimental noise which causes estimated responses (green in panel B) to be different from responses predicted by the computational model (pink in panel B) and to be different across repetitions of the same experiment.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006397.g001" xlink:type="simple"/>
</fig>
<p>In what follows we first describe the two-level fitting approach and the different metrics used to evaluate model fitting in order to introduce some relevant concepts, next we introduce a generative framework and derive the bound to the performance. The mathematical notation used in the following sections is presented in <xref ref-type="table" rid="pcbi.1006397.t001">Table 1</xref>.</p>
<table-wrap id="pcbi.1006397.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006397.t001</object-id>
<label>Table 1</label> <caption><title>Mathematical notation.</title></caption>
<alternatives>
<graphic id="pcbi.1006397.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006397.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Symbol</th>
<th align="center">Definitions (size)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><bold><italic>y</italic></bold></td>
<td align="center">Voxel time series (time points x 1)</td>
</tr>
<tr>
<td align="center"><bold>Φ</bold></td>
<td align="center">fMRI design matrix (time points x num of stimuli)</td>
</tr>
<tr>
<td align="center"><inline-formula id="pcbi.1006397.e001"><alternatives><graphic id="pcbi.1006397.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mi mathvariant="bold">Ω</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula></td>
<td align="center">True and estimated covariance matrix of the fMRI noise (num of time points x num of time points)</td>
</tr>
<tr>
<td align="center"><inline-formula id="pcbi.1006397.e002"><alternatives><graphic id="pcbi.1006397.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula></td>
<td align="center">Variance of the noise of the fMRI time series for one voxel (scalar)</td>
</tr>
<tr>
<td align="center"><inline-formula id="pcbi.1006397.e003"><alternatives><graphic id="pcbi.1006397.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula></td>
<td align="center">True and estimated brain responses for one voxel (num of stimuli x 1)</td>
</tr>
<tr>
<td align="center"><inline-formula id="pcbi.1006397.e004"><alternatives><graphic id="pcbi.1006397.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula></td>
<td align="center">Voxel estimated brain response for the stimulus <italic>i</italic> at fMRI run <italic>r</italic> (scalar)</td>
</tr>
<tr>
<td align="left"><inline-formula id="pcbi.1006397.e005"><alternatives><graphic id="pcbi.1006397.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:msub><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula></td>
<td align="center">Voxel true and estimated <inline-formula id="pcbi.1006397.e006"><alternatives><graphic id="pcbi.1006397.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> covariance matrix (num of stimuli x num of stimuli); and component <italic>i</italic> from the diagonal of the <inline-formula id="pcbi.1006397.e007"><alternatives><graphic id="pcbi.1006397.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> covariance matrix (scalar).</td>
</tr>
<tr>
<td align="center"><bold><italic>β</italic></bold><sup><bold>*</bold></sup></td>
<td align="center">Voxel brain responses predicted on the test data with the computational model (num of test stimuli x 1)</td>
</tr>
<tr>
<td align="center"><bold><italic>X</italic>,<italic>X</italic></bold><sup><bold>*</bold></sup></td>
<td align="center">Computational model for training and test data respectively (num of training/testing stimuli x num of features)</td>
</tr>
<tr>
<td align="center"><inline-formula id="pcbi.1006397.e008"><alternatives><graphic id="pcbi.1006397.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula></td>
<td align="center">Voxel true and estimated receptive field vector (number of features x 1)</td>
</tr>
<tr>
<td align="center"><bold><italic>λ</italic></bold></td>
<td align="center">Regularization parameter</td>
</tr>
<tr>
<td align="center"><inline-formula id="pcbi.1006397.e009"><alternatives><graphic id="pcbi.1006397.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula></td>
<td align="center">Voxel mean and variance of the true and estimated voxel brain response across components. (scalars)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<sec id="sec003">
<title>Estimation of the response to single stimuli</title>
<p>The observed fMRI response is assumed to be linearly dependent on the stimuli (design matrix) [<xref ref-type="bibr" rid="pcbi.1006397.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1006397.ref020">20</xref>] and the estimation (for every voxel) is achieved using generalized least squares (GLS):
<disp-formula id="pcbi.1006397.e010">
<alternatives>
<graphic id="pcbi.1006397.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e010" xlink:type="simple"/>
<mml:math display="block" id="M10">
<mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
The covariance matrix for <inline-formula id="pcbi.1006397.e011"><alternatives><graphic id="pcbi.1006397.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is:
<disp-formula id="pcbi.1006397.e012">
<alternatives>
<graphic id="pcbi.1006397.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e012" xlink:type="simple"/>
<mml:math display="block" id="M12">
<mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">Φ</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
For every voxel, <inline-formula id="pcbi.1006397.e013"><alternatives><graphic id="pcbi.1006397.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the vector of the estimated responses to the stimuli, <bold><italic>y</italic></bold> is vector of the voxel time course (the observed fMRI signal) and <bold>Φ</bold> is the design matrix describing the timing of presentation of the stimuli in the experiment, including the effect of the hemodynamic response. The matrix <inline-formula id="pcbi.1006397.e014"><alternatives><graphic id="pcbi.1006397.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the estimated covariance matrix of the fMRI noise, while the <bold>Ω</bold> is the true value of this covariance. This general formulation can accommodate a variety of estimators for computing <inline-formula id="pcbi.1006397.e015"><alternatives><graphic id="pcbi.1006397.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> which depends on the assumptions made with respect to <bold>Ω</bold>. Note that <inline-formula id="pcbi.1006397.e016"><alternatives><graphic id="pcbi.1006397.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> depends of the true <bold>Ω</bold> which is unknown. In practice, estimators of <bold>Ω</bold> should be obtained which leads to the estimator of <inline-formula id="pcbi.1006397.e017"><alternatives><graphic id="pcbi.1006397.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1006397.ref021">21</xref>]:
<disp-formula id="pcbi.1006397.e018">
<alternatives>
<graphic id="pcbi.1006397.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e018" xlink:type="simple"/>
<mml:math display="block" id="M18">
<mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
The assumption of identically independent distributed (i.i.d) noise (which implies <inline-formula id="pcbi.1006397.e019"><alternatives><graphic id="pcbi.1006397.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:math></alternatives></inline-formula>) leads to the ordinary least squares estimator (OLS) [<xref ref-type="bibr" rid="pcbi.1006397.ref020">20</xref>]. Violations of the i.i.d. assumptions (i.e. presence of temporal dependences and lack of stationarity of the fMRI noise) involve computing <inline-formula id="pcbi.1006397.e020"><alternatives><graphic id="pcbi.1006397.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> which is an ill conditioned problem, which is usually solved by imposing some form of regularization. Typically, this is achieved by parametrizations of the noise covariance matrix that accommodate the assumptions about the noise structure (e.g. first order autoregressive model)[<xref ref-type="bibr" rid="pcbi.1006397.ref022">22</xref>–<xref ref-type="bibr" rid="pcbi.1006397.ref024">24</xref>].</p>
</sec>
<sec id="sec004">
<title>Linearized encoding models</title>
<p>Linearized encoding models assume the estimated response vector <inline-formula id="pcbi.1006397.e021"><alternatives><graphic id="pcbi.1006397.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> to be linearly dependent on the description of the stimuli on the basis of a computational model represented by a matrix <bold><italic>X</italic></bold> that projects each of the <italic>n</italic> stimuli onto the model space described by a model with <italic>f</italic> features (<xref ref-type="fig" rid="pcbi.1006397.g001">Fig 1A</xref>). The (linear) weights that link the computational model to the fMRI response are referred to as the population receptive field of the voxel. If the objective of the encoding approach is to model the differences in the brain responses between stimuli as a function of the computational model then, voxels that differ only in their means, but otherwise represent stimuli in the same way, should have the same estimated population receptive field. To do this, the mean of the brain responses (across all stimuli) can be removed from the response vector <inline-formula id="pcbi.1006397.e022"><alternatives><graphic id="pcbi.1006397.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> before fitting the model <bold><italic>X</italic></bold>, or a column of ones can be added to the model <bold><italic>X</italic></bold> before fitting the un normalized responses [<xref ref-type="bibr" rid="pcbi.1006397.ref025">25</xref>]. When there is collinearity across the features or when the number of stimuli <italic>n</italic> is smaller than then number of features <italic>f</italic>, regularization is used. Here we consider the use of ridge regression [<xref ref-type="bibr" rid="pcbi.1006397.ref026">26</xref>] for estimating the population receptive field <inline-formula id="pcbi.1006397.e023"><alternatives><graphic id="pcbi.1006397.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> linking the computational model (represented by the training data matrix <bold><italic>X</italic></bold>) to the estimated voxel response vector on the training data set <inline-formula id="pcbi.1006397.e024"><alternatives><graphic id="pcbi.1006397.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1006397.e025">
<alternatives>
<graphic id="pcbi.1006397.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e025" xlink:type="simple"/>
<mml:math display="block" id="M25">
<mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
where <italic>λ</italic> is the regularization parameter. <inline-formula id="pcbi.1006397.e026"><alternatives><graphic id="pcbi.1006397.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> allows predicting the responses to new (test) stimuli by considering <inline-formula id="pcbi.1006397.e027"><alternatives><graphic id="pcbi.1006397.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, where <bold><italic>X</italic></bold>* contains the representation of the stimuli in the test set in the space of <italic>f</italic> features. Other approaches use grid search or more sophisticated optimization algorithms when a non-linear relationship between the features and the response is assumed [<xref ref-type="bibr" rid="pcbi.1006397.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1006397.ref027">27</xref>].</p>
</sec>
<sec id="sec005">
<title>Evaluating the performance of computational model encoded in fMRI responses</title>
<p>The performance of a computational model can be assessed on test stimuli using e.g. the sample correlation coefficient between the responses predicted by the computational model <bold><italic>β</italic></bold>* and the estimated brain responses in the test data <inline-formula id="pcbi.1006397.e028"><alternatives><graphic id="pcbi.1006397.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (see <xref ref-type="disp-formula" rid="pcbi.1006397.e010">Eq 1</xref>):
<disp-formula id="pcbi.1006397.e029">
<alternatives>
<graphic id="pcbi.1006397.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e029" xlink:type="simple"/>
<mml:math display="block" id="M29">
<mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
Where <inline-formula id="pcbi.1006397.e030"><alternatives><graphic id="pcbi.1006397.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006397.e031"><alternatives><graphic id="pcbi.1006397.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> are the predicted and estimated response to stimulus <italic>i</italic> respectively. Estimated variances refer to the variability between the components of the vector of responses around the mean of the vector: <inline-formula id="pcbi.1006397.e032"><alternatives><graphic id="pcbi.1006397.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The estimated mean <inline-formula id="pcbi.1006397.e033"><alternatives><graphic id="pcbi.1006397.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> corresponds to the sample mean of the estimated response across its components (each component corresponds to one presented stimulus), with consistent definitions for <inline-formula id="pcbi.1006397.e034"><alternatives><graphic id="pcbi.1006397.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006397.e035"><alternatives><graphic id="pcbi.1006397.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>. Alternatively, predictive <italic>R</italic><sup>2</sup> is frequently used for describing the performance of an encoding model:
<disp-formula id="pcbi.1006397.e036">
<alternatives>
<graphic id="pcbi.1006397.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e036" xlink:type="simple"/>
<mml:math display="block" id="M36">
<mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
Note that we are computing the explained variance between the observed and predicted brain responses <inline-formula id="pcbi.1006397.e037"><alternatives><graphic id="pcbi.1006397.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <bold><italic>β</italic></bold>*, which is different than the explained variance at the level of the fMRI time series <bold><italic>y</italic></bold>. When computed on independent test data, <italic>R</italic><sup>2</sup> is defined in the interval [−∞,1]. It is important to note that, while <italic>R</italic><sup>2</sup> is sensitive to scaling transformations of the estimated response, the correlation coefficient measures the similarity between the predicted and observed responses in term of covariations around their mean and is insensitive to scaling transformations. This difference between the metrics is relevant when regularization is used. The relation between predictive <italic>R</italic><sup>2</sup> and <italic>ρ</italic> (see <xref ref-type="supplementary-material" rid="pcbi.1006397.s001">S1 Text</xref>) can be rendered explicit considering that (without loss of generality) the estimated responses were centred to have zero mean (<inline-formula id="pcbi.1006397.e038"><alternatives><graphic id="pcbi.1006397.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> = 0) [<xref ref-type="bibr" rid="pcbi.1006397.ref025">25</xref>]:
<disp-formula id="pcbi.1006397.e039">
<alternatives>
<graphic id="pcbi.1006397.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e039" xlink:type="simple"/>
<mml:math display="block" id="M39">
<mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>ρ</mml:mi><mml:mi>γ</mml:mi><mml:mo>(</mml:mo><mml:mi>λ</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>γ</mml:mi><mml:mo>(</mml:mo><mml:mi>λ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula>
Where <inline-formula id="pcbi.1006397.e040"><alternatives><graphic id="pcbi.1006397.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:msup><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>λ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>λ</mml:mi><mml:mo>)</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> is the ratio between the estimated variances of the predicted and observed response vectors and dependent on the amount of regularization used to estimate the computational model (see Eq 4 in [<xref ref-type="bibr" rid="pcbi.1006397.ref005">5</xref>]). The <inline-formula id="pcbi.1006397.e041"><alternatives><graphic id="pcbi.1006397.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> represents the bias in the mean of the predicted response vector (i.e. how much the mean of the predicted response vector differs from zero, See <xref ref-type="supplementary-material" rid="pcbi.1006397.s001">S1 Text</xref>). Note that the optimal <italic>λ</italic> for the maximization of <italic>R</italic><sup>2</sup> does not necessarily corresponds to the <italic>λ</italic> which maximizes <italic>ρ</italic>. The predictive squared Euclidean distance <italic>D</italic><sup>2</sup> between the vectors <inline-formula id="pcbi.1006397.e042"><alternatives><graphic id="pcbi.1006397.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <bold><italic>β</italic></bold>*, which is also a frequently used metric, is closely related to the explained variance: <inline-formula id="pcbi.1006397.e043"><alternatives><graphic id="pcbi.1006397.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec006">
<title>Estimating the performance of linearized encoding models</title>
<p>As a consequence of the estimation procedure highlighted above (see <xref ref-type="disp-formula" rid="pcbi.1006397.e010">Eq 1</xref>), in linearized encoding models, the estimated response vector <inline-formula id="pcbi.1006397.e044"><alternatives><graphic id="pcbi.1006397.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is assumed to be multivariate normally distributed around the true response vector <bold><italic>β</italic></bold> and with covariance matrix that reflects the variability of the <inline-formula id="pcbi.1006397.e045"><alternatives><graphic id="pcbi.1006397.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> estimator:
<disp-formula id="pcbi.1006397.e046">
<alternatives>
<graphic id="pcbi.1006397.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e046" xlink:type="simple"/>
<mml:math display="block" id="M46">
<mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula>
For linearized encoding models, <bold><italic>β</italic></bold> (i.e. the expected value of the estimated response <inline-formula id="pcbi.1006397.e047"><alternatives><graphic id="pcbi.1006397.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) can be considered to be generated on the basis of the computational model defined by the matrix <bold><italic>X</italic></bold>. In particular we can consider:
<disp-formula id="pcbi.1006397.e048">
<alternatives>
<graphic id="pcbi.1006397.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e048" xlink:type="simple"/>
<mml:math display="block" id="M48">
<mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">P</mml:mi>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula>
This assumes a fixed linear relation between matrix of model features <bold><italic>X</italic></bold> and the underlying “true” brain response <bold><italic>β</italic></bold> (not influenced by measurement noise) which is mediated by the population receptive field vector <bold><italic>P</italic></bold>. Note that the true response <bold><italic>β</italic></bold> can have any shape and is not limited to be a standard gaussian variable. The noise ceiling estimated under such fixed relationship is based on the assumption that the total variance of the underlying <bold><italic>β</italic></bold> can be explained by the features contained in <bold><italic>X</italic></bold>.</p>
</sec>
<sec id="sec007">
<title>Noise ceiling definition and estimation procedures</title>
<p>For infinite training data (and without the use of regularization) the noise ceiling can be defined as the expected performance (measured as correlation or predictive <italic>R</italic><sup><italic>2</italic></sup>) of the model underlying the generation of the responses (i.e. the “true” model <bold><italic>X</italic></bold>). Such model uses the true pRF (<bold><italic>P</italic></bold>) and produces correct predictions for a voxel, i.e. it assumes that the predicted responses <bold><italic>β</italic></bold>* are the true <bold><italic>β</italic></bold>:
<disp-formula id="pcbi.1006397.e049">
<alternatives>
<graphic id="pcbi.1006397.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e049" xlink:type="simple"/>
<mml:math display="block" id="M49">
<mml:msub><mml:mrow><mml:mi mathvariant="normal">ρ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">E</mml:mi><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">*</mml:mi></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">λ</mml:mi><mml:mo>=</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold">∞</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula>
This definition of the noise ceiling is a function of the variability of the test data, is by construction independent of the computational model, and thus is better referred to as <italic>test-data-noise ceiling</italic>. Different assumptions underlying the univariate modeling of fMRI data result in different estimates of the responses (<inline-formula id="pcbi.1006397.e050"><alternatives><graphic id="pcbi.1006397.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) and their variance. Thus, the (true) noise ceiling is affected by the fMRI response estimation procedure. More sophisticated noise ceiling definitions might also consider the performance of the true model conditioned to the actual amount of data available, or conditioned on the particular algorithm that was used to fit the computational model (e.g conditioned on the value of λ).</p>
<sec id="sec008">
<title>Split-half noise ceiling (SHnc)</title>
<p>The split-half noise ceiling estimator is an empirical procedure which consists of correlating the <inline-formula id="pcbi.1006397.e051"><alternatives><graphic id="pcbi.1006397.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> responses to the same stimuli obtained from two disjoint sets of (test) data: (<inline-formula id="pcbi.1006397.e052"><alternatives><graphic id="pcbi.1006397.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006397.e053"><alternatives><graphic id="pcbi.1006397.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>) at every voxel [<xref ref-type="bibr" rid="pcbi.1006397.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1006397.ref029">29</xref>]. Because the number of stimuli in each split is reduced by half, the observed correlations are adjusted using the correction:
<disp-formula id="pcbi.1006397.e054">
<alternatives>
<graphic id="pcbi.1006397.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e054" xlink:type="simple"/>
<mml:math display="block" id="M54">
<mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="normal">ρ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">cov</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="normal">ρ</mml:mi><mml:mrow><mml:mi mathvariant="normal">SHnc</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi mathvariant="normal">ρ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ρ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula>
The split-half noise ceiling is a non-parametric procedure since it does not rely on the estimation of the <inline-formula id="pcbi.1006397.e055"><alternatives><graphic id="pcbi.1006397.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> variances. Therefore, the split-half noise ceiling estimator procedure takes into account all sources of variability that affect the brain responses. Note that the SHnc is defined only for positive split half correlation values. Here we define the SHnc to be zero for negative split half correlations, which is equivalent to assuming that in the case in which the observed correlation between two independent measurements of the same stimuli is negative the maximum performance that any encoding model can achieve is the chance level.</p>
</sec>
<sec id="sec009">
<title>Monte Carlo noise ceiling (MCnc)</title>
<p>The MCnc assumes each element of the response vector <inline-formula id="pcbi.1006397.e056"><alternatives><graphic id="pcbi.1006397.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (i.e. <inline-formula id="pcbi.1006397.e057"><alternatives><graphic id="pcbi.1006397.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, with <italic>i</italic> running across the <italic>n</italic> stimuli) to be samples of the same univariate normal distribution [<xref ref-type="bibr" rid="pcbi.1006397.ref016">16</xref>]. The variance of the responses are split in two components, the experimental noise (<inline-formula id="pcbi.1006397.e058"><alternatives><graphic id="pcbi.1006397.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) and the variability between stimuli of the <italic>noise free</italic> <bold><italic>β</italic></bold> responses (<inline-formula id="pcbi.1006397.e059"><alternatives><graphic id="pcbi.1006397.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>).
<disp-formula id="pcbi.1006397.e060">
<alternatives>
<graphic id="pcbi.1006397.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e060" xlink:type="simple"/>
<mml:math display="block" id="M60">
<mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi mathvariant="normal">ε</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi mathvariant="bold">β</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula>
where <inline-formula id="pcbi.1006397.e061"><alternatives><graphic id="pcbi.1006397.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is the pooled variability of each component of the response vector due to measurement errors (i.e. <inline-formula id="pcbi.1006397.e062"><alternatives><graphic id="pcbi.1006397.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ε</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>). Note that in the definition provided by [<xref ref-type="bibr" rid="pcbi.1006397.ref016">16</xref>], the experimental noise variability (<inline-formula id="pcbi.1006397.e063"><alternatives><graphic id="pcbi.1006397.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) is across experimental conditions (i.e. stimuli) and not across trials (i.e. repetitions) of the same stimulus. When pooling across stimuli the MCnc assumes that the noise affects all stimuli in the same way. An estimate of the variability of the <italic>noise free</italic> signal can be obtained as the difference between the variability of the responses across the <italic>n</italic> stimuli (<inline-formula id="pcbi.1006397.e064"><alternatives><graphic id="pcbi.1006397.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) and the variability of the noise:
<disp-formula id="pcbi.1006397.e065">
<alternatives>
<graphic id="pcbi.1006397.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e065" xlink:type="simple"/>
<mml:math display="block" id="M65">
<mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ε</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula>
After the variability of the <italic>noise free</italic> signal is obtained with <xref ref-type="disp-formula" rid="pcbi.1006397.e060">Eq 12</xref>, Monte Carlo samples of the <italic>noise free</italic> signal can be generated. For every generated noise free signal the experimental noise is added (using a normal distribution with zero mean and variance <inline-formula id="pcbi.1006397.e066"><alternatives><graphic id="pcbi.1006397.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ε</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) and the correlation between the <italic>noise free</italic> signal and the <italic>noise contaminated</italic> signal is computed. The median across all simulations represents an estimate of the noise ceiling.</p>
</sec>
<sec id="sec010">
<title>Analytical derivation of noise ceiling</title>
<p>Considering the definition provided in <xref ref-type="disp-formula" rid="pcbi.1006397.e049">Eq 10</xref>, if the predicted responses <bold><italic>β</italic></bold>* are identical to the true expected value of the responses <bold><italic>β</italic></bold> the prediction accuracy expressed through the correlation coefficient takes the form of:
<disp-formula id="pcbi.1006397.e067">
<alternatives>
<graphic id="pcbi.1006397.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e067" xlink:type="simple"/>
<mml:math display="block" id="M67">
<mml:msub><mml:mrow><mml:mi mathvariant="normal">ρ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula>
Based on the assumption that the measurement error and the true <bold><italic>β</italic></bold> are independent, the noise ceiling can be estimated as (see <xref ref-type="supplementary-material" rid="pcbi.1006397.s001">S1 Text</xref>):
<disp-formula id="pcbi.1006397.e068">
<alternatives>
<graphic id="pcbi.1006397.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e068" xlink:type="simple"/>
<mml:math display="block" id="M68">
<mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">ρ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msqrt><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula>
This means that the noise ceiling can be expressed as the square root of the ratio between the variance of the true brain response (<inline-formula id="pcbi.1006397.e069"><alternatives><graphic id="pcbi.1006397.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) and the variance of estimated brain response (<inline-formula id="pcbi.1006397.e070"><alternatives><graphic id="pcbi.1006397.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>), or equivalently the ratio between the variance of the noise free brain response (<inline-formula id="pcbi.1006397.e071"><alternatives><graphic id="pcbi.1006397.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) and the variance of the noise contaminated brain response (<inline-formula id="pcbi.1006397.e072"><alternatives><graphic id="pcbi.1006397.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) (see <xref ref-type="disp-formula" rid="pcbi.1006397.e060">Eq 12</xref> for the relation between both variances). The denominator <inline-formula id="pcbi.1006397.e073"><alternatives><graphic id="pcbi.1006397.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is easy to compute since <inline-formula id="pcbi.1006397.e074"><alternatives><graphic id="pcbi.1006397.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is estimated from the fMRI time series and its variance can be directly derived from the test data. However, the numerator <inline-formula id="pcbi.1006397.e075"><alternatives><graphic id="pcbi.1006397.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> has to be derived based on the covariance matrix of the estimated <inline-formula id="pcbi.1006397.e076"><alternatives><graphic id="pcbi.1006397.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. The analytical noise ceiling can be estimated using the variance estimates of each component of <inline-formula id="pcbi.1006397.e077"><alternatives><graphic id="pcbi.1006397.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> according to the formula:
<disp-formula id="pcbi.1006397.e078">
<alternatives>
<graphic id="pcbi.1006397.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e078" xlink:type="simple"/>
<mml:math display="block" id="M78">
<mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">ρ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula>
The term <inline-formula id="pcbi.1006397.e079"><alternatives><graphic id="pcbi.1006397.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> refers to the component <italic>i</italic> of the diagonal of the <inline-formula id="pcbi.1006397.e080"><alternatives><graphic id="pcbi.1006397.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> matrix. As for the MCnc, this general formulation allows considering different estimators for <inline-formula id="pcbi.1006397.e081"><alternatives><graphic id="pcbi.1006397.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. Note that in <xref ref-type="disp-formula" rid="pcbi.1006397.e078">Eq 16</xref> a negative number under the square root can be obtained if the average of the variance within components (<inline-formula id="pcbi.1006397.e082"><alternatives><graphic id="pcbi.1006397.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is greater that the variance between components (<inline-formula id="pcbi.1006397.e083"><alternatives><graphic id="pcbi.1006397.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>). This can be caused by one or more stimuli (components of <inline-formula id="pcbi.1006397.e084"><alternatives><graphic id="pcbi.1006397.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) with a brain response that is equal to zero. In these cases we define the analytical noise ceiling to be zero, which corresponds to assume that the maximum accuracy that encoding models can reach is the chance level. The same indeterminacy of obtaining a negative estimation of the variance can occur for the Monte Carlo NC (<xref ref-type="disp-formula" rid="pcbi.1006397.e060">Eq 12</xref>) and the considerations made for the MCnc and the analytical noise ceiling are consistent with the ones made for the SHnc in the case of negative correlations between the splits.</p>
<p>The noise ceiling estimator <inline-formula id="pcbi.1006397.e085"><alternatives><graphic id="pcbi.1006397.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">ρ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> has as expected value ρ<sub>NC</sub>, (see <xref ref-type="supplementary-material" rid="pcbi.1006397.s001">S1 Text</xref> II). The noise ceiling estimator for the explained variance R<sup>2</sup> can be derived transforming the noise ceiling for the correlation coefficient to the R<sup>2</sup> domain with <xref ref-type="disp-formula" rid="pcbi.1006397.e039">Eq 7</xref>. The analytical noise ceiling estimator has the same expected value than the Monte Carlo noise ceiling estimator with the advantage of not requiring a large computational effort.</p>
</sec>
</sec>
<sec id="sec011">
<title>Models of the variance of the estimated brain response</title>
<p>As highlighted above, the MCnc and the analytical approach rely on the estimation of the covariance matrix of the estimated regression coefficients <inline-formula id="pcbi.1006397.e086"><alternatives><graphic id="pcbi.1006397.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula>. Different <inline-formula id="pcbi.1006397.e087"><alternatives><graphic id="pcbi.1006397.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e087" xlink:type="simple"/><mml:math display="inline" id="M87"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> estimates will therefore result in different expected values for the noise ceiling. In particular, as highlighted in <xref ref-type="disp-formula" rid="pcbi.1006397.e018">Eq 3</xref>, <inline-formula id="pcbi.1006397.e088"><alternatives><graphic id="pcbi.1006397.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> depends on the assumptions made about the structure of the noise in the fMRI time series (i.e. the structure of <inline-formula id="pcbi.1006397.e089"><alternatives><graphic id="pcbi.1006397.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1006397.e018">Eq 3</xref>). Different analysis software use different covariance constrains for computing <inline-formula id="pcbi.1006397.e090"><alternatives><graphic id="pcbi.1006397.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>; to account for autocorrelation in the noise, here we followed the SPM-12 (<ext-link ext-link-type="uri" xlink:href="http://www.fil.ion.ucl.ac.uk/spm/software/spm12" xlink:type="simple">http://www.fil.ion.ucl.ac.uk/spm/software/spm12</ext-link>) approach which estimates the brain response in two passes. In the first pass, estimated brain responses are computed assuming <inline-formula id="pcbi.1006397.e091"><alternatives><graphic id="pcbi.1006397.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e091" xlink:type="simple"/><mml:math display="inline" id="M91"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:math></alternatives></inline-formula>, which corresponds to OLS. Next, the noise covariance matrix is computed assuming the same correlation structure for each voxel within each session. A parametrized model of the noise covariance matrix is fit to the pooled covariance matrix using restricted maximum likelihood (spm_reml.m). The covariance constraint for <inline-formula id="pcbi.1006397.e092"><alternatives><graphic id="pcbi.1006397.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e092" xlink:type="simple"/><mml:math display="inline" id="M92"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are obtained with the function (spm_Ce.m) with autocorrelation coefficient of 0.2 (empirically determined). In the second pass the <inline-formula id="pcbi.1006397.e093"><alternatives><graphic id="pcbi.1006397.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e093" xlink:type="simple"/><mml:math display="inline" id="M93"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are obtained with <xref ref-type="disp-formula" rid="pcbi.1006397.e010">Eq 1</xref> which uses the estimate of <inline-formula id="pcbi.1006397.e094"><alternatives><graphic id="pcbi.1006397.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e094" xlink:type="simple"/><mml:math display="inline" id="M94"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> derived in the first pass. To account for non-stationarity we followed the RobustWLS toolbox approach (<ext-link ext-link-type="uri" xlink:href="http://www.diedrichsenlab.org/imaging/robustWLS.html" xlink:type="simple">http://www.diedrichsenlab.org/imaging/robustWLS.html</ext-link>). In particular, the estimation of <inline-formula id="pcbi.1006397.e095"><alternatives><graphic id="pcbi.1006397.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e095" xlink:type="simple"/><mml:math display="inline" id="M95"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is performed using a Newton-Raphson algorithm (spm_rwls_reml.m in the WLS toolbox) [<xref ref-type="bibr" rid="pcbi.1006397.ref030">30</xref>]. Note that autocorrelation and the non-stationarity constraints can be combined in the same estimation of <inline-formula id="pcbi.1006397.e096"><alternatives><graphic id="pcbi.1006397.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e096" xlink:type="simple"/><mml:math display="inline" id="M96"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1006397.ref030">30</xref>]. However, we do not perform this combined estimation here since we used WLS as implemented in the RobustWLS toolbox.</p>
<p>When data are acquired across multiple runs (or sessions), additional sources of variability across runs (sessions), can have an effect on the variance of the <inline-formula id="pcbi.1006397.e097"><alternatives><graphic id="pcbi.1006397.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e097" xlink:type="simple"/><mml:math display="inline" id="M97"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1006397.ref031">31</xref>]. See [<xref ref-type="bibr" rid="pcbi.1006397.ref032">32</xref>] for a proper partitioning of the variance of the fMRI into runs and sessions components. Ignoring this source of variability resulted in the underestimation of the variability of the brain responses with the consequence of overestimating the NC. A solution for this problem is to estimate, for each voxel, the <inline-formula id="pcbi.1006397.e098"><alternatives><graphic id="pcbi.1006397.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e098" xlink:type="simple"/><mml:math display="inline" id="M98"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> responses using a mixed effect model. Two reasons limit the use of mixed models in fMRI: first, estimating such model for each voxel has a large computational cost (impractical for a large number of voxels); second, and more relevant, the design may not allow a reliable estimation of the model when the number of presentations of each stimulus across the runs is too small. An alternative is to compute the variability of <inline-formula id="pcbi.1006397.e099"><alternatives><graphic id="pcbi.1006397.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e099" xlink:type="simple"/><mml:math display="inline" id="M99"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> as the variance of the mean of <inline-formula id="pcbi.1006397.e100"><alternatives><graphic id="pcbi.1006397.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e100" xlink:type="simple"/><mml:math display="inline" id="M100"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> across the fMRI runs (sessions):
<disp-formula id="pcbi.1006397.e101">
<alternatives>
<graphic id="pcbi.1006397.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e101" xlink:type="simple"/>
<mml:math display="block" id="M101">
<mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(17)</label>
</disp-formula>
where <italic>n</italic><sub><italic>r</italic></sub> is the number of runs (or sessions), <inline-formula id="pcbi.1006397.e102"><alternatives><graphic id="pcbi.1006397.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e102" xlink:type="simple"/><mml:math display="inline" id="M102"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is an estimate of the response for stimuli <italic>i</italic> in the run <italic>r</italic> and <inline-formula id="pcbi.1006397.e103"><alternatives><graphic id="pcbi.1006397.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e103" xlink:type="simple"/><mml:math display="inline" id="M103"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is the mean of the response for stimulus <italic>i</italic> across the <italic>n</italic><sub><italic>r</italic></sub> runs. Note that the variance of the mean of <inline-formula id="pcbi.1006397.e104"><alternatives><graphic id="pcbi.1006397.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e104" xlink:type="simple"/><mml:math display="inline" id="M104"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> across <italic>n</italic><sub><italic>r</italic></sub> runs is the estimator of the variance of <inline-formula id="pcbi.1006397.e105"><alternatives><graphic id="pcbi.1006397.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e105" xlink:type="simple"/><mml:math display="inline" id="M105"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> divided by the number of runs. Since the noise ceiling is only a function of the measurement error of each component of <inline-formula id="pcbi.1006397.e106"><alternatives><graphic id="pcbi.1006397.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e106" xlink:type="simple"/><mml:math display="inline" id="M106"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, (and not of the covariance between components) only the diagonal elements of the matrix <inline-formula id="pcbi.1006397.e107"><alternatives><graphic id="pcbi.1006397.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e107" xlink:type="simple"/><mml:math display="inline" id="M107"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> are relevant (See <xref ref-type="disp-formula" rid="pcbi.1006397.e078">Eq 16</xref>). This estimator of the variance does not rely on assumptions on the particular form of <inline-formula id="pcbi.1006397.e108"><alternatives><graphic id="pcbi.1006397.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e108" xlink:type="simple"/><mml:math display="inline" id="M108"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> made by the parametric estimation procedure and can be derived directly from the run to run variability of the <inline-formula id="pcbi.1006397.e109"><alternatives><graphic id="pcbi.1006397.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e109" xlink:type="simple"/><mml:math display="inline" id="M109"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. Such estimator has the attractive of not depending of the assumptions regarding the structure of the fMRI noise, however in fMRI experiments with only few runs it could make the estimator less robust.</p>
</sec>
<sec id="sec012">
<title>Data</title>
<sec id="sec013">
<title>Simulations</title>
<p>To validate the analytical formulation of the noise ceiling and to compare the effect that different estimators of the variance of the responses have on the noise ceiling we performed simulations under different scenarios for the structure of the noise in the fMRI time series. Simulated fMRI time series were obtained starting from a computational model (<bold><italic>X</italic></bold> representing 168 [126 training and 42 test] stimuli in a space of 128 features) and assuming a linear encoding model where the responses to the stimuli <bold><italic>β</italic></bold> are obtained from a linear combination (the population receptive field) of the features of the model (see <xref ref-type="disp-formula" rid="pcbi.1006397.e025">Eq 4</xref>). The number of stimuli (training and test) and the dimensionality of the computational model were selected in correspondence with the experimental design used for the real fMRI data (see next section). The simulated population receptive field vector <bold><italic>P</italic></bold> was sampled from the standard normal distribution.</p>
<p>The <bold>β</bold> vector was then combined with a design matrix <bold>Φ</bold> describing the presentation of the stimuli during an fMRI experiment. We used the design matrix of an fMRI experiment in which stimuli where presented following a fast event related design (as commonly used in fMRI encoding approaches—see real data section) in 6 separate runs. Each simulation was replicated 100 times under identical conditions and we report the average value across the simulations and the [5 95] percentiles of the distribution.</p>
<p>We will refer to the different simulation scenarios on the basis of the structure used for the true covariance matrix of the noise <bold>Ω</bold> and to be distinguished from the assumed covariance matrix of the noise used in estimation <inline-formula id="pcbi.1006397.e110"><alternatives><graphic id="pcbi.1006397.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e110" xlink:type="simple"/><mml:math display="inline" id="M110"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (see previous section).</p>
<list list-type="order">
<list-item><p><bold>i.i.d noise scenario</bold>: we consider <bold>Ω</bold> = <bold><italic>I</italic>,</bold> i.e. the fMRI time series was generated using independent identical distributed gaussian noise and we assumed the same <bold><italic>β</italic></bold> across all runs. We performed simulations in this scenario, as a function of the ratio between the variance of the signal and the variance of the noise (SNR).</p></list-item>
<list-item><p><bold>autocorrelated noise scenario</bold>: We generated the noise of fMRI time series following a first order autoregressive processes with varying autoregressive coefficient (implemented using the Matlab function arima.m). The generated noise was scaled to have SNR equal to one. The results were displayed as function of the lag-1 autocorrelation of the fMRI noise. Considering that the estimation of the noise covariance matrix requires a subset of voxels (see previous section), we simulated 1000 voxels with the same noise covariance structure in each simulation, but we report the noise ceiling estimation for one of them (i.e. the first voxel).</p></list-item>
<list-item><p><bold>non-stationary noise scenario</bold>: the fMRI time series were generated using gaussian i.i.d. noise for which a random subset of 5% of the fMRI volumes of the noise signal were scaled with a non-stationarity factor varying in the interval [<xref ref-type="bibr" rid="pcbi.1006397.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1006397.ref003">3</xref>] (See the simulations in [<xref ref-type="bibr" rid="pcbi.1006397.ref030">30</xref>] for a more detailed description). The non-stationarity factor effectively reduces the SNR for a subset of the volumes, for the other set the SNR was fixed to one. Considering that the estimation of the noise covariance matrix requires a subset of voxels (see previous section), we simulated 1000 voxels with the same noise covariance structure in each simulation, but we report the noise ceiling estimation for one of them (i.e. the first voxel).</p></list-item>
<list-item><p><bold>autocorrelated noise with run to run variability:</bold> we repeated scenario 1 with the inclusion of autocorrelated noise fixing the lag-1 autocorrelation value to 0.25. Here we evaluated the effect on the noise ceiling of the run to run variability in the response vector <bold><italic>β</italic></bold>. For each run, <bold><italic>β</italic></bold> comprised of two additive terms, one common across runs (coming from the model matrix and the population receptive field: <bold><italic>XP</italic></bold>), and the second variable across runs modeled as standard gaussian distribution with zero mean. The proportion between the two terms was selected such that the average correlation between two halves of the experiments (first and second twelve runs) reached 0.6. We performed different simulations by varying the amount of SNR now defined as the ratio of the variance of the term of the response common across runs and the variance of the noise.</p></list-item>
</list>
<p>In each of the simulated scenarios we computed the analytical noise ceiling (<xref ref-type="disp-formula" rid="pcbi.1006397.e078">Eq 16</xref>) using different estimators for <inline-formula id="pcbi.1006397.e111"><alternatives><graphic id="pcbi.1006397.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e111" xlink:type="simple"/><mml:math display="inline" id="M111"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> which are conditioned to the parametric form of <inline-formula id="pcbi.1006397.e112"><alternatives><graphic id="pcbi.1006397.e112g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e112" xlink:type="simple"/><mml:math display="inline" id="M112"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> that determines <inline-formula id="pcbi.1006397.e113"><alternatives><graphic id="pcbi.1006397.e113g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e113" xlink:type="simple"/><mml:math display="inline" id="M113"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. In particular, we tested three estimators depending on different parametric assumptions: 1) <inline-formula id="pcbi.1006397.e114"><alternatives><graphic id="pcbi.1006397.e114g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e114" xlink:type="simple"/><mml:math display="inline" id="M114"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:math></alternatives></inline-formula>, which corresponds to ordinary least square (OLS), 2) an autoregressive model of order 1 (as implemented in SPM 12), and 3) a parametric model of non-stationarity (using the RobustWLS toolbox). We will refer to these three estimators as <inline-formula id="pcbi.1006397.e115"><alternatives><graphic id="pcbi.1006397.e115g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e115" xlink:type="simple"/><mml:math display="inline" id="M115"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:math></alternatives></inline-formula>, AR(1) and NST respectively and thus we will refer to the noise ceiling estimates resulting from them using the same acronyms. The noise ceiling obtained with these parametric estimators of the variance of the <inline-formula id="pcbi.1006397.e116"><alternatives><graphic id="pcbi.1006397.e116g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e116" xlink:type="simple"/><mml:math display="inline" id="M116"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> was compared to the noise ceiling obtained using the run to run variability (R2R) for estimating the variance of the response (using the variance of the estimated responses introduced in <xref ref-type="disp-formula" rid="pcbi.1006397.e101">Eq 17</xref> in the noise ceiling estimate proposed in <xref ref-type="disp-formula" rid="pcbi.1006397.e078">Eq 16</xref>) and the SHnc. Note that for both the R2R noise ceiling and the SHnc the estimated responses <inline-formula id="pcbi.1006397.e117"><alternatives><graphic id="pcbi.1006397.e117g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e117" xlink:type="simple"/><mml:math display="inline" id="M117"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are obtained using ordinary least squares (i.e. assuming <inline-formula id="pcbi.1006397.e118"><alternatives><graphic id="pcbi.1006397.e118g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e118" xlink:type="simple"/><mml:math display="inline" id="M118"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:math></alternatives></inline-formula>). This is to validate that the SHnc and the R2R noise ceiling estimator are robust to violations of the OLS assumptions.</p>
<p>In each simulation scenario all noise ceiling estimators were compared to the true noise ceiling that in simulations can be computed directly knowing the true simulated <bold><italic>β</italic></bold> using <xref ref-type="disp-formula" rid="pcbi.1006397.e067">Eq 14</xref>. Note that the true noise ceiling is dependent on the estimation procedure used to obtain the test <inline-formula id="pcbi.1006397.e119"><alternatives><graphic id="pcbi.1006397.e119g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e119" xlink:type="simple"/><mml:math display="inline" id="M119"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (see section Noise ceiling definition and estimation procedures.). As a consequence, the ground truth noise ceiling values used for comparative purposes in the simulations will also differ depending on the estimation used to obtain <inline-formula id="pcbi.1006397.e120"><alternatives><graphic id="pcbi.1006397.e120g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e120" xlink:type="simple"/><mml:math display="inline" id="M120"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec014">
<title>MRI data</title>
<p>The data presented here are part of a larger study that includes ten healthy participants. The subjects had no history of neurological disease, and gave informed consent before commencement of the measurements. The Ethical Committee of the Faculty for Psychology and Neuroscience at Maastricht University granted approval for the study. Magnetic resonance imaging data were acquired on an actively shielded MAGNETOM 7T whole body system driven by a Siemens console at Scannexus <ext-link ext-link-type="uri" xlink:href="https://scannexus.nl/" xlink:type="simple">https://scannexus.nl/</ext-link>. A Nova Medical head RF coil (single transmit, 32 receive channels) was used to acquire anatomical (T<sub>1</sub>, Proton Density [PD] weighted) and functional (T<sub>2</sub>* weighted BOLD) images. T<sub>1</sub> weighted (0.7 mm isotropic) images were acquired using an MPRAGE sequence (repetition time [TR] = 3100 ms; time to inversion [TI] = 1500 ms; time echo [TE] = 3.5 ms; flip angle = 5°). PD images were acquired with the same MPRAGE as the T<sub>1</sub> weighted image but without the inversion pulse (TR = 2160 ms; TE = 3.5 ms; flip angle = 5°), and were used to minimize inhomogeneities in T<sub>1</sub> weighted images [<xref ref-type="bibr" rid="pcbi.1006397.ref033">33</xref>]. Acquisition time for the T<sub>1</sub> and PD datasets were ~ 9 and 4 minutes respectively. Anatomical data were analyzed with BrainVoyager QX and were resampled (with sinc interpolation) in the normalized Talairach space (Talairach and Tournoux, 1988) at a resolution of 0.5 mm isotropic.</p>
<p>Functional (T<sub>2</sub>* weighted) data were acquired using a clustered Echo Planar Imaging (EPI) technique (1.1 mm isotropic; TR = 2.6 s; GRAPPA = 3; MultiBand = 2; Gap = 1.4 s). The experiments were designed according to a fast event-related scheme and slices were prescribed in a coronal oblique orientation in order to cover the brainstem and auditory cortex (Heschl’s gyrus, planum temporale and planum polare) bilaterally. A total of 168 sounds were presented six times across 24 runs in silent gaps in between volme acquisitions using magnetic compatible earbuds (Sensimetrics inc.). The sounds were divided into four training and testing sets (126 and 42 sounds respectively). The four training and test sets (i.e. the four cross validations) where built such that training sounds and test sounds where presented in separate runs (e.g. for cross validation number 1 runs [<xref ref-type="bibr" rid="pcbi.1006397.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1006397.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006397.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1006397.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1006397.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1006397.ref024">24</xref>] where test runs and the remaining runs where training runs). Within each run, sounds were randomly spaced at a jittered interstimulus interval of 2, 3, or 4 TRs and presented in the middle of the silent gap between acquisitions (leaving 100 ms of silence before and after the sound). Zero trials (trials where no sound was presented [5% of the trials]), and target trials (trials in which a sound was presented two times in a row [5% of the trials]) were included. Subjects were instructed to perform a one-back task, and were required to respond with a button press when the same sound was presented two times consecutively. Target trials were excluded from the analysis. Before starting the experiment (with the ear buds in place), the subjects were instructed to adjust the overall sound intensity to a clearly audible and comfortable level. This resulted in an approximate sound intensity of 65 dB. The total scanning was divided over two sessions that were acquired in two consecutive days.</p>
</sec>
<sec id="sec015">
<title>Functional data analysis</title>
<p>Functional data were analyzed with BrainVoyager QX (v20.4) [<xref ref-type="bibr" rid="pcbi.1006397.ref034">34</xref>]. Preprocessing consisted of slice scan-time correction (with sinc interpolation), 3-dimensional motion correction, and temporal high pass filtering (removing drifts of 4 cycles or less per run). Functional data were co-registered to the anatomical data, normalized in Talairach space (Talairach and Tournoux, 1988), and resampled (with sinc interpolation) at a resolution of 1 mm isotropic.</p>
<p>We calculated the fMRI response to each sound using the following steps. First, for each cross validation, we obtained noise regressors using GLM denoise ([<xref ref-type="bibr" rid="pcbi.1006397.ref016">16</xref>], <ext-link ext-link-type="uri" xlink:href="http://kendrickkay.net/GLMdenoise/" xlink:type="simple">http://kendrickkay.net/GLMdenoise/</ext-link>). GLM denoise was run for each cross validation solely on the training runs with a fixed hemodynamic (canonical form). The selected principal components were then used to derive noise regressors in the test data. In the supplementary figures we reported the difference between the NC estimated with and without the use of GLM denoise. Second, the responses to the stimuli were estimated with SPM12 or RobustWLS, also using the canonical hemodynamic function. Similarly to the simulations, in one subject, we report results obtained using different assumptions on the structure of the noise covariance matrix. In particular, we computed <inline-formula id="pcbi.1006397.e121"><alternatives><graphic id="pcbi.1006397.e121g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e121" xlink:type="simple"/><mml:math display="inline" id="M121"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006397.e122"><alternatives><graphic id="pcbi.1006397.e122g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e122" xlink:type="simple"/><mml:math display="inline" id="M122"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> necessary to calculate the analytical noise ceiling (and the MCnc) using: 1) <inline-formula id="pcbi.1006397.e123"><alternatives><graphic id="pcbi.1006397.e123g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e123" xlink:type="simple"/><mml:math display="inline" id="M123"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:math></alternatives></inline-formula>, which corresponds with OLS estimation, 2) an autoregressive model of order 1 (as implemented in SPM 12), and 3) a parametric model of non-stationarity (using the RobustWLS toolbox). We will refer to these three estimators as: <inline-formula id="pcbi.1006397.e124"><alternatives><graphic id="pcbi.1006397.e124g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e124" xlink:type="simple"/><mml:math display="inline" id="M124"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006397.e125"><alternatives><graphic id="pcbi.1006397.e125g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e125" xlink:type="simple"/><mml:math display="inline" id="M125"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> respectively. The noise ceiling estimators presented in simulations were compared in one arbitrarily selected subject (using 50000 voxels randomly selected). For this subject the voxels time series, the fMRI design matrix, the <inline-formula id="pcbi.1006397.e126"><alternatives><graphic id="pcbi.1006397.e126g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e126" xlink:type="simple"/><mml:math display="inline" id="M126"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> images (assuming <inline-formula id="pcbi.1006397.e127"><alternatives><graphic id="pcbi.1006397.e127g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e127" xlink:type="simple"/><mml:math display="inline" id="M127"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:math></alternatives></inline-formula>), together with the Matlab codes for computing the noise ceiling are publically available at: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/deposit/1489531" xlink:type="simple">https://zenodo.org/deposit/1489531</ext-link>. In all other subjects, we report the values of SHnc and R2R noise ceiling (50000 voxels randomly selected) obtained using OLS for computing <inline-formula id="pcbi.1006397.e128"><alternatives><graphic id="pcbi.1006397.e128g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e128" xlink:type="simple"/><mml:math display="inline" id="M128"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>.</p>
</sec>
</sec>
</sec>
<sec id="sec016" sec-type="results">
<title>Results</title>
<sec id="sec017">
<title>Validating the analytical noise ceiling estimator</title>
<p>In the i.i.d noise scenario, and using an estimation based on the assumption of noise covariance matrix is equal to the identity matrix, we verified that the expected value of the analytical NC corresponds to its definition of <xref ref-type="disp-formula" rid="pcbi.1006397.e067">Eq 14</xref> by comparing (mean and [5 95] percentiles across 100 simulations) the estimated noise ceiling value (using <xref ref-type="disp-formula" rid="pcbi.1006397.e078">Eq 16</xref>) with the true noise ceiling that in simulations can be computed directly knowing the true simulated <bold><italic>β</italic></bold> using <xref ref-type="disp-formula" rid="pcbi.1006397.e067">Eq 14</xref> (red line in <xref ref-type="fig" rid="pcbi.1006397.g002">Fig 2</xref>). This comparison is reported in <xref ref-type="fig" rid="pcbi.1006397.g002">Fig 2</xref> for both correlation and predictive R<sup>2</sup>. The mean value of the analytical NC estimator (blue in <xref ref-type="fig" rid="pcbi.1006397.g002">Fig 2</xref>) matched the mean value and variance of the true noise ceiling. The R<sup>2</sup> showed stronger dependence with the experimental noise than the correlation coefficient. The noise ceiling estimator showed larger variability (blue dashed line) than the true noise ceiling (shaded region) due to the uncertainty associated with the estimation of <inline-formula id="pcbi.1006397.e129"><alternatives><graphic id="pcbi.1006397.e129g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e129" xlink:type="simple"/><mml:math display="inline" id="M129"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> (see <xref ref-type="disp-formula" rid="pcbi.1006397.e018">Eq 3</xref>).</p>
<fig id="pcbi.1006397.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006397.g002</object-id>
<label>Fig 2</label>
<caption>
<title>The analytical noise ceiling estimator (blue) and its true value (red) are presented for different levels of variance of the noise (the variance of the signal is equal to one).</title>
<p>The left panel shows the noise ceiling for the correlation coefficient while the right panel shows the noise ceiling for the explained variance. The grey shadowed area denotes the [5 95] percentiles of the true NC distribution, while the blue dashed line denotes the [5 95] percentiles for the estimated NC across 100 simulations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006397.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec018">
<title>Comparison with the MCnc in the i.i.d scenario</title>
<p>Using simulated data under i.i.d scenario and estimating <inline-formula id="pcbi.1006397.e130"><alternatives><graphic id="pcbi.1006397.e130g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e130" xlink:type="simple"/><mml:math display="inline" id="M130"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> assuming that the noise covariance matrix is equal to the identity matrix we validated the equivalence between the Monte Carlo estimator (MCnc) [<xref ref-type="bibr" rid="pcbi.1006397.ref016">16</xref>] and the analytical estimator (<xref ref-type="disp-formula" rid="pcbi.1006397.e078">Eq 16</xref>). The results are reported in <xref ref-type="fig" rid="pcbi.1006397.g003">Fig 3</xref> for the correlation as evaluation metric (for simplicity). Both NC estimators resulted in the same mean and variance across the 100 simulations (the mean and the [5 95] confidence bands are superimposed in <xref ref-type="fig" rid="pcbi.1006397.g003">Fig 3</xref> left panel). For both NC methods, the variability of the estimated NC increased with decreasing mean value (mean and variance are not independent). The relation between the two NC estimators is presented as a scatter plot in the right panel of <xref ref-type="fig" rid="pcbi.1006397.g003">Fig 3</xref> for all levels of experimental noise (without averaging across simulations).</p>
<fig id="pcbi.1006397.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006397.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Left Panel: The mean of the NC across the 100 simulations is presented in the red line and blue dots for the Monte Carlo NC (MCnc) and the analytical NC respectively as a function of the experimental noise.</title>
<p>Both methods produced identical results thus the curves are perfectly superimposed. The corresponding red dashed lines and blue crosses denote the [5 95] percentiles of the distribution across the 100 simulations. Right Panel: scatter plot of the Monte Carlo noise estimates and analytical noise ceiling estimates.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006397.g003" xlink:type="simple"/>
</fig>
<p>The advantage of using the analytical noise ceiling estimator is that it did not require a computationally expensive resampling procedure at each voxel. The difference in computation time was: analytical NC (7x10<sup>-5</sup> seconds/voxel) vs MCnc (0.06 seconds/voxel, for 1000 Monte-Carlo samples), on a PC with intel(R), i7-6700HQ, CPU 2.6 GHz, 16Gb of RAM processor). We have verified equivalence between the MCnc and the analytical NC also in the other simulation scenarios and using different assumptions about the structure of the covariance matrix of the noise during estimation. As both methods proved to be equivalent we report only the analytical NC estimator for the subsequent analyses.</p>
</sec>
<sec id="sec019">
<title>Comparison between NC estimators in the i.i.d noise scenario</title>
<p><xref ref-type="fig" rid="pcbi.1006397.g004">Fig 4</xref> summarizes the results (for different simulated noise levels) obtained in estimating the noise ceiling in the i.i.d. noise scenario. The first three panels from the left represent the analytical NC obtained using three different parametric estimates of <inline-formula id="pcbi.1006397.e131"><alternatives><graphic id="pcbi.1006397.e131g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e131" xlink:type="simple"/><mml:math display="inline" id="M131"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> (i.e. assuming different structures for the noise covariance matrix during estimation, see <xref ref-type="sec" rid="sec002">Methods</xref> section). The analytical NC based on parametric estimators of <inline-formula id="pcbi.1006397.e132"><alternatives><graphic id="pcbi.1006397.e132g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e132" xlink:type="simple"/><mml:math display="inline" id="M132"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> are compared to the noise ceiling using the run to run variability for estimating the diagonal entries of <inline-formula id="pcbi.1006397.e133"><alternatives><graphic id="pcbi.1006397.e133g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e133" xlink:type="simple"/><mml:math display="inline" id="M133"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> (referred here as R2Rnc) and the split-half noise ceiling estimator (SHnc). In each panel, the true value of the noise ceiling (mean across 100 simulations–red in <xref ref-type="fig" rid="pcbi.1006397.g004">Fig 4</xref>; shaded gray area represents the [5 95] percentile of the true value across the simulations) is compared to the estimated mean (blue in <xref ref-type="fig" rid="pcbi.1006397.g004">Fig 4</xref> –dashed blue lines represent the [5 95] percentiles). All estimators showed the same mean across simulations (blue line). However the parametric noise ceiling estimators showed less variability (dashed lines) than the non parametric noise ceiling estimator (SHnc and R2R). Between the non parametric noise ceiling estimators the SHnc showed larger variability than the R2Rnc. This simulation proves that all the NC estimators are equivalent when the noise is i.i.d.</p>
<fig id="pcbi.1006397.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006397.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Estimated NC for the different methods for variable levels of noise in the i.i.d scenario.</title>
<p>The mean value and the [5 95] percentiles are displayed in continuous and dotted blue lines respectively for the each method. The mean value of the NC computed with the parameters used for generating the data are displayed in red (true NC) with the [5 95] confidence intervals denoted by the shaded region.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006397.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec020">
<title>Comparison between estimators in the presence of autocorrelated noise</title>
<p><xref ref-type="fig" rid="pcbi.1006397.g005">Fig 5</xref> summarizes the results obtained in estimating the noise ceiling in the case of autocorrelated noise. Each panel reports the result obtained with a different estimation procedure (parametric estimators–first three panels from the left; R2R noise ceiling and SHnc) for different levels of the lag-1 autocorrelation in the noise. The true noise ceiling is also reported (red–mean value across 100 simulations; gray shaded areas [5 95] percentiles). The analytical noise ceiling assuming i.i.d noise (<inline-formula id="pcbi.1006397.e134"><alternatives><graphic id="pcbi.1006397.e134g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e134" xlink:type="simple"/><mml:math display="inline" id="M134"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:math></alternatives></inline-formula> - first panel in <xref ref-type="fig" rid="pcbi.1006397.g005">Fig 5</xref>) or using a parametric model of the non-stationarity of the noise (<inline-formula id="pcbi.1006397.e135"><alternatives><graphic id="pcbi.1006397.e135g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e135" xlink:type="simple"/><mml:math display="inline" id="M135"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, third panel in <xref ref-type="fig" rid="pcbi.1006397.g005">Fig 5</xref>) result in overestimating the NC (with larger overestimation at higher levels of autocorrelation in the noise). The reason for this overestimation is the underestimation of the variance of the brain response (<inline-formula id="pcbi.1006397.e136"><alternatives><graphic id="pcbi.1006397.e136g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e136" xlink:type="simple"/><mml:math display="inline" id="M136"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>). Note that for <inline-formula id="pcbi.1006397.e137"><alternatives><graphic id="pcbi.1006397.e137g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e137" xlink:type="simple"/><mml:math display="inline" id="M137"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> we consider only non-stationarity of the noise, but in principle non-stationarity and autoregressive assumptions can be combined in one estimation [<xref ref-type="bibr" rid="pcbi.1006397.ref030">30</xref>]. In this combined NST-AR(1) estimation we would expect the estimated noise ceiling to approach the true noise ceiling. All other estimators resulted in unbiased (i.e. estimated noise ceiling equal to the true noise ceiling) NC values. Interestingly, violating the noise assumption (e.g. assuming i.i.d. noise instead of autocorrelated noise) also results in a lower true noise ceiling. This effect is visible when comparing the true noise ceiling (red curves) across the panels in <xref ref-type="fig" rid="pcbi.1006397.g005">Fig 5</xref>, and is caused by the increased variance in the <inline-formula id="pcbi.1006397.e138"><alternatives><graphic id="pcbi.1006397.e138g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e138" xlink:type="simple"/><mml:math display="inline" id="M138"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> obtained with e.g. an OLS model compared to estimates obtained with AR(1).</p>
<fig id="pcbi.1006397.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006397.g005</object-id>
<label>Fig 5</label>
<caption>
<title>NC estimates using different methods as a function of the lag-1 autocorrelation of the noise.</title>
<p>The mean value and the [5 95] percentiles are displayed in continuous and dashed blue lines respectively. The true noise ceiling is displayed in red with the [5 95] confidence intervals denoted by the shaded region.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006397.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec021">
<title>Comparison between NC estimators in the presence of non-stationary noise</title>
<p>The performance of different estimators of the noise ceiling under violations of the non-stationarity assumption for the noise is presented in <xref ref-type="fig" rid="pcbi.1006397.g006">Fig 6</xref> for an SNR level of one (i.e. when the non-stationarity factor [x-axis in the panels of <xref ref-type="fig" rid="pcbi.1006397.g006">Fig 6</xref>] is equal to one, the simulation is identical to an i.i.d. scenario with SNR = 1). Interestingly, the non-stationarity affected both the true noise ceiling (red curve and shaded grey area in <xref ref-type="fig" rid="pcbi.1006397.g005">Fig 5</xref>) and the estimated noise ceiling (blue curve and dashed blue curves in <xref ref-type="fig" rid="pcbi.1006397.g005">Fig 5</xref>), that are both underestimated when i.i.d. or AR(1) assumptions are used. The SHnc showed the larger variability across simulations. This results from the increased variance for the <inline-formula id="pcbi.1006397.e139"><alternatives><graphic id="pcbi.1006397.e139g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e139" xlink:type="simple"/><mml:math display="inline" id="M139"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> compared to estimates obtained with weighted least squares <inline-formula id="pcbi.1006397.e140"><alternatives><graphic id="pcbi.1006397.e140g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e140" xlink:type="simple"/><mml:math display="inline" id="M140"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> [<xref ref-type="bibr" rid="pcbi.1006397.ref030">30</xref>].</p>
<fig id="pcbi.1006397.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006397.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Estimated NC for the different methods as a function of the non-stationarity factor on the noise for a fixed value of the SNR (SNR = 1).</title>
<p>The mean value and the [5 95] percentiles are displayed in continuous and dashed blue lines respectively for each method. The mean value of the true noise ceiling is displayed in red with the [5 95] confidence intervals denoted by the shaded region.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006397.g006" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec022">
<title>Comparison between NC estimators in the presence of autocorrelated noise and random effects</title>
<p>The last set of simulations tested the presence of autocorrelation combined with run to run variability in the true <bold><italic>β</italic></bold> responses. <xref ref-type="fig" rid="pcbi.1006397.g007">Fig 7</xref> reports results for the different noise ceiling estimation methods at different levels of variance of the noise (i.e. decreasing SNR) and for a fixed level of autocorrelation in the noise (0.25) which corresponds to the level of autocorrelation observed in the real fMRI data presented in this article (see below). In this scenario only the analytical noise ceiling based on the run to run variability (R2Rnc) and the split-half noise ceiling (SHnc) showed mean values consistent with the true noise ceiling (red curves). The SHnc noise ceiling showed the larger variability across all the noise ceiling methods.</p>
<fig id="pcbi.1006397.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006397.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Estimated NC in the presence of autocorrelated noise and run to run variability in the simulated responses as a function of the variance of the noise in the data.</title>
<p>The mean value and the [5 95] percentiles are displayed in continuous and dashed blue lines respectively for the each method. The mean value of the true NC is displayed in red with the [5 95] confidence intervals denoted by the shaded region.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006397.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec023">
<title>Influence of sample size and the interaction with the regularization parameter</title>
<p>The left panel of <xref ref-type="fig" rid="pcbi.1006397.g008">Fig 8</xref> shows, on data simulated with i.i.d. noise, the performance of an encoding model trained using the true underlying computational model (i.e. an encoding model trained using the matrix <bold><italic>X</italic></bold> used for simulating the responses). The performance is measured as the correlation between predicted <bold><italic>β</italic></bold>* and the estimated <inline-formula id="pcbi.1006397.e141"><alternatives><graphic id="pcbi.1006397.e141g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e141" xlink:type="simple"/><mml:math display="inline" id="M141"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> vectors of the test data, for different sample sizes in training (from <italic>n</italic><sub><italic>tr</italic></sub> = 126 up to 10 times more the number of features <italic>n</italic><sub><italic>tr</italic></sub> = 1260) and two levels of regularization (λ = 10<sup>0</sup> and λ = 10<sup>3</sup>) (green and red curves in <xref ref-type="fig" rid="pcbi.1006397.g008">Fig 8</xref>). The variance of the noise was fixed to 0.5.</p>
<fig id="pcbi.1006397.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006397.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Left panel: Model performance as a function of the number of trials for a fixed level of experimental noise.</title>
<p>The analytical noise ceiling estimator for the correlation coefficient in blue and its [5 95] percentiles denoted by the shadowed area is plotted together with the performance of two models that differ in the amount of regularization (green λ = 100; red λ = 103). The corresponding [5 95] percentiles are presented in green and red dotted lines. Right panel: The effect of regularization on the performance. The correlation coefficient is used the metric for describing the performance. The blue line depicts the analytical noise ceiling estimator which is independent of <italic>λ</italic>. The mean accuracy of the model performance and the [5 95] percentiles of the distribution across 100 repetitions of the same simulation are presented by the red dotted line. The vertical bars highlight the λ = 1; red λ = 1000 for correspondence with the left panel.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006397.g008" xlink:type="simple"/>
</fig>
<p>As expected, prediction accuracy increased asymptotically with sample size. However, as a consequence of the bias-variance trade-off introduced by the regularization procedure, the performance did not reach the noise ceiling even for a very large number of samples. High regularization implies less variability in the estimated linearized model weights (i.e. the pRF in fMRI encoding approaches) as depicted by the narrower [5 95] variability bands. Note that the reduced variability in data poor scenarios comes at the cost of an increased bias highlighted by the larger distance to the noise ceiling in data rich scenarios.</p>
<p>The right panel of <xref ref-type="fig" rid="pcbi.1006397.g008">Fig 8</xref> depicts in more detail the influence of the regularization parameter. By keeping the experimental noise variance and sample size constant (0.5 and <italic>n</italic><sub><italic>tr</italic></sub> = 126 respectively) we evaluated the prediction accuracy (measured as correlation) of the model underlying the generation of the data and considering the effect of regularization on the difference between the actual model performance and the noise ceiling. The performance did not reach the noise ceiling even when the optimal regularization parameter was selected (the one that results in the highest performance).</p>
</sec>
<sec id="sec024">
<title>Noise ceiling in a real data example</title>
<p>Using a real fMRI data set we tested the analytical noise ceiling (using parametric and non-parametric estimates for <inline-formula id="pcbi.1006397.e142"><alternatives><graphic id="pcbi.1006397.e142g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e142" xlink:type="simple"/><mml:math display="inline" id="M142"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>) as well as the SHnc. <xref ref-type="fig" rid="pcbi.1006397.g009">Fig 9</xref> shows the results obtained with all the tested approaches in one single individual (50000 randomly selected). The column on the left in <xref ref-type="fig" rid="pcbi.1006397.g009">Fig 9</xref> reports the results for the analytical estimator of the noise ceiling using different estimation of <inline-formula id="pcbi.1006397.e143"><alternatives><graphic id="pcbi.1006397.e143g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e143" xlink:type="simple"/><mml:math display="inline" id="M143"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006397.e144"><alternatives><graphic id="pcbi.1006397.e144g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e144" xlink:type="simple"/><mml:math display="inline" id="M144"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. Similarly to simulations with autocorrelated noise, the results indicate that assuming the noise structure to be either i.i.d or non-stationary (without autocorrelation) results in a higher estimate of the noise ceiling compared to the estimation obtained using an AR(1) assumption (See <xref ref-type="fig" rid="pcbi.1006397.g005">Fig 5</xref>). The second and third column from the left in <xref ref-type="fig" rid="pcbi.1006397.g009">Fig 9</xref> show estimate of the R2Rnc (analytical NC using run to run variances) and SHnc obtained using different estimates for the response vector <inline-formula id="pcbi.1006397.e145"><alternatives><graphic id="pcbi.1006397.e145g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e145" xlink:type="simple"/><mml:math display="inline" id="M145"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (i.e. assuming <inline-formula id="pcbi.1006397.e146"><alternatives><graphic id="pcbi.1006397.e146g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e146" xlink:type="simple"/><mml:math display="inline" id="M146"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006397.e147"><alternatives><graphic id="pcbi.1006397.e147g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e147" xlink:type="simple"/><mml:math display="inline" id="M147"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> from top to bottom respectively). While small differences between the rows can be observed, the R2R noise ceiling and the SHnc are less affected by the method used for the estimation of the response vector compared to the analytical solution that uses a parametric model of the <inline-formula id="pcbi.1006397.e148"><alternatives><graphic id="pcbi.1006397.e148g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e148" xlink:type="simple"/><mml:math display="inline" id="M148"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> (left most column in <xref ref-type="fig" rid="pcbi.1006397.g009">Fig 9</xref>).</p>
<fig id="pcbi.1006397.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006397.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Noise ceiling estimates obtained in real fMRI data.</title>
<p>Histograms represent the noise ceiling obtained for 50000 voxels of the temporal lobe for one subject. Every row in the figure presents the noise ceiling estimated under different parametrizations of the noise covariance matrix (from top to bottom: <inline-formula id="pcbi.1006397.e149"><alternatives><graphic id="pcbi.1006397.e149g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e149" xlink:type="simple"/><mml:math display="inline" id="M149"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="normal">I</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006397.e150"><alternatives><graphic id="pcbi.1006397.e150g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e150" xlink:type="simple"/><mml:math display="inline" id="M150"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>). The left most columns show the analytical noise ceiling using the estimate of the covariance of the responses based on the different parametric models. The R2Rnc and the SHnc are presented in the two right most columns and, in each row, are computed based on the <inline-formula id="pcbi.1006397.e151"><alternatives><graphic id="pcbi.1006397.e151g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e151" xlink:type="simple"/><mml:math display="inline" id="M151"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> obtained under different parametrizations of the noise covariance matrix.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006397.g009" xlink:type="simple"/>
</fig>
<p>The relationship between the SHnc and the R2Rnc (analytical NC using run to run variances) is presented at the upper panel of <xref ref-type="fig" rid="pcbi.1006397.g010">Fig 10</xref> for the data of one participant (all the other participants in the dataset showed a similar behaviour). The two NC estimators converged to similar values for high signal to noise ratio (SNR; i.e. when the estimated NC is high). This is in line with what we observed in the simulations where the variance of the estimated noise ceiling was low when the SNR was high. In those voxels where the SNR is low, the variability of the estimators results in a low correlation between the two NC methods. The lower panel of <xref ref-type="fig" rid="pcbi.1006397.g010">Fig 10</xref>, confirmed the equivalence, in real data between the analytical NC of the noise ceiling and the MCnc.</p>
<fig id="pcbi.1006397.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006397.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Scatter plot and contour plot of the bivariate histograms of the relationship between: The R2Rnc and the SHnc (upper panel) and the R2Rnc and MCnc (lower panel) for 50000 randomly selected voxels at one subject.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006397.g010" xlink:type="simple"/>
</fig>
<p><xref ref-type="fig" rid="pcbi.1006397.g011">Fig 11</xref> shows the results obtained for the R2Rnc (red) and the SHnc (blue) in ten subjects (first two rows and the two left most panels in the bottom row). These results are obtained on 50000 voxels (randomly selected) and assuming i.i.d. noise for estimating the voxel responses. The SHnc showed slightly higher mean values compared with the R2Rnc. These results were obtained including the noise regressors in the fMRI design matrix for estimation of the <bold><italic>β</italic></bold> (see section Functional data analysis). Removing the noise regressors from the estimation of the responses did not affect the results (see supplementary figures).</p>
<fig id="pcbi.1006397.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006397.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Histograms of the noise ceiling obtained with the split half method (blue) and the analytical NC (with variance the run to run variance R2Rnc; red) across 50000 (randomly selected) voxels for ten subjects.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006397.g011" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec025" sec-type="conclusions">
<title>Discussion</title>
<p>In neuroscience applications, computational models are a formal expression of the algorithms that underlie cognitive and sensory processes. Linking a model with non-invasive measures of brain activity (such as fMRI) [<xref ref-type="bibr" rid="pcbi.1006397.ref035">35</xref>,<xref ref-type="bibr" rid="pcbi.1006397.ref036">36</xref>] allows testing the accuracy of the algorithm and eventually refine it to produce brain inspired models. Ultimately this approach can produce an understanding of brain function at the level of fundamental processing units. The accuracy of a computational model is measured in terms of its ability to predict the brain responses to sensory (or cognitive) stimuli. In this regard, the intrinsic noise of the fMRI measurements procedure provides a bound to the accuracy of any model and this bound can be referred to as the <italic>test-data-noise ceiling</italic>.</p>
<p>In this article, we evaluated two existing approaches for the calculation of the noise ceiling using simulations and real data. We also proved that the noise ceiling can be computed directly from the variance of the estimated brain responses. In simulations and real data, we demonstrated that the previously introduced MCnc estimator [<xref ref-type="bibr" rid="pcbi.1006397.ref016">16</xref>] and the analytical NC estimator have the same expected value and variance. The use of the analytical approach is favourable due to the reduced computational time that results from obviating the Monte Carlo sampling performed by the MCnc for every voxel.</p>
<p>To calculate the noise ceiling on a test data set using the analytical solution it is necessary to estimate from the fMRI time series the variance of the response to the stimuli. Following the standard univariate approach, a parametric estimate of the variance of the responses can be obtained based on an estimation of the noise covariance matrix. Otherwise, a non-parametric estimate of the variance can be obtained by considering the variance of the responses across fMRI runs (and or sessions). In simulations, we showed that such an approach is robust to different types of noise (i.i.d., autocorelated noise and non-stationary noise) as well as to random variations of the responses (caused by factors such as fatigue) that cannot be accounted by the computational model. Note that this estimate of the variance can also be used in the MCnc estimator that originally used a parametric estimate of the variance based on the i.i.d. assumption for the noise [<xref ref-type="bibr" rid="pcbi.1006397.ref016">16</xref>].</p>
<p>In simulations we showed that the introduced analytical NC using the run to run variability results in similar noise ceiling estimates to the split half noise ceiling (SHnc), which is based on two independent estimates of the test data responses. In real data the SHnc showed slightly higher NC values than the R2Rnc systematically across the 10 subjects. Two reasons can explain this discrepancy: the reduced number of runs used for computing the run to run <inline-formula id="pcbi.1006397.e152"><alternatives><graphic id="pcbi.1006397.e152g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e152" xlink:type="simple"/><mml:math display="inline" id="M152"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> variances (every sound was presented only in six fMRI runs in this experiment, see section MRI data), or violations in the independence between trials which is assumed by the SHnc when accounting for the reduced amount of data in each half. In light of this discrepancy it may be preferable to use the most conservative estimate of the noise ceiling.</p>
<p>Computational models of cognitive processes can consider a high number of parameters. In these cases regularization can be used to avoid overfitting or collinearity of the stimuli in the model parameter space. Our simulations indicate that, when using regularization, the predicted responses using the true computational model (i.e. the model used to simulate the data) cannot reach the noise ceiling.</p>
<p>It is important to stress that, the noise ceiling is itself a random variable with its corresponding variability. The expected value corresponds to the maximum performance conditioned to the noise in the test data. However, for a particular data sample it is possible that the performance of a model being tested to be above the noise ceiling estimate on the same test set. Our results show that different estimators have different variability with the split half estimator exhibiting the larger variance, which is a reason for preferring an analytic (or Monte Carlo) estimate that uses run to run variability as an estimate of the variance of the responses. These considerations also grant a comment on the practice of reporting noise corrected performance values (see e.g. [<xref ref-type="bibr" rid="pcbi.1006397.ref037">37</xref>]). An evident advantage of this practice is that the noise corrected accuracies allow a direct comparison across experiments (or ROIs) with different levels of noise (e.g. acquired across laboratories or changing MRI acquisition parameters). Nevertheless, considering that the noise ceiling itself is not an observable quantity that is estimated from the data with uncertainty (which is not independent of the mean), this practice is controversial. Different noise ceiling estimators have different variances and rely on different assumptions, and thus at the very least the exact procedure for the estimation of the noise ceiling should be specified. Reporting only noise ceiling corrected performances does not allow assessing (independently) the quality of the data and the observed effect size. Consider the following example: a voxel which reached an accuracy of 0.1 with an estimated NC of 0.2 would result in identical noise corrected accuracy (<inline-formula id="pcbi.1006397.e153"><alternatives><graphic id="pcbi.1006397.e153g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e153" xlink:type="simple"/><mml:math display="inline" id="M153"><mml:mfrac><mml:mrow><mml:mn>0.1</mml:mn></mml:mrow><mml:mrow><mml:mn>0.2</mml:mn></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:math></alternatives></inline-formula>) to a voxel which reached 0.4 with NC of 0.8 (<inline-formula id="pcbi.1006397.e154"><alternatives><graphic id="pcbi.1006397.e154g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e154" xlink:type="simple"/><mml:math display="inline" id="M154"><mml:mfrac><mml:mrow><mml:mn>0.4</mml:mn></mml:mrow><mml:mrow><mml:mn>0.8</mml:mn></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:math></alternatives></inline-formula>). However the statistical significance and the effect size of an accuracy of 0.1 vs an accuracy of 0.4 differs in orders of magnitude and is computed on the uncorrected accuracies values since the null distribution of the noise normalized accuracies has not been determined yet. For these reasons, it seems more appropriate to report both the observed accuracies and the noise ceiling (see e.g. [<xref ref-type="bibr" rid="pcbi.1006397.ref038">38</xref>–<xref ref-type="bibr" rid="pcbi.1006397.ref040">40</xref>]).</p>
<p>The framework proposed in this article is based on a two-level procedure for the estimation of the weights of the encoding models (first responses are estimated from the fMRI time series and then the model is fit to the estimated responses). One conceptual advantage of this two-level approach is that the residual variance can be partitioned in the variance of the experimental noise (level I) and the residual variance after fitting the model (level II). Other approaches directly fit the encoding model convolved with the haemodynamic response to the fMRI time series [<xref ref-type="bibr" rid="pcbi.1006397.ref003">3</xref>]. The interplay between the haemodynamic response and the computational model makes it difficult to assess the experimental variability of the fMRI time series and as a consequence the noise ceiling. One solution would be to report both accuracies and noise ceiling after the removal of the hemodynamic effect. Alternatively, the SHnc can be used for the calculation of the NC at the level of the whole fMRI time series. Finally, here we evaluated approaches to compute noise ceiling at the single subject level for single voxel encoding models. Some of these approaches (e.g. the SHnc) can be extended to calculate noise ceiling for representational similarity analysis (RSA) always at the single subject level. For group level analysis the approaches we have described here are not directly suitable because they only account for the measurement error and not for the variability between subjects. For RSA, a method has been proposed to compute the noise ceiling at the group level [<xref ref-type="bibr" rid="pcbi.1006397.ref041">41</xref>] and can be extended to encoding approaches [<xref ref-type="bibr" rid="pcbi.1006397.ref015">15</xref>].</p>
<sec id="sec026">
<title>Data availability statement</title>
<p>The data and the matlab codes are achieved and described at zenodo.org. The voxels time series for one subject, the fMRI design matrix, the <inline-formula id="pcbi.1006397.e155"><alternatives><graphic id="pcbi.1006397.e155g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e155" xlink:type="simple"/><mml:math display="inline" id="M155"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> images (assuming <inline-formula id="pcbi.1006397.e156"><alternatives><graphic id="pcbi.1006397.e156g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e156" xlink:type="simple"/><mml:math display="inline" id="M156"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:math></alternatives></inline-formula>) and the Matlab codes for computing the noise ceiling can be downloaded from the same zenodo url at: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/deposit/1489531" xlink:type="simple">https://zenodo.org/deposit/1489531</ext-link>, doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.1489531" xlink:type="simple">10.5281/zenodo.1489531</ext-link>. Additional data and codes can be obtained by request to the authors (<email xlink:type="simple">a.lagecastellanos@maastrichtuniversity.nl</email>).</p>
</sec>
</sec>
<sec id="sec027">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006397.s001" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006397.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Relationship between the correlation coefficient and R2.</title>
<p>Derivation of the analytical noise ceiling.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006397.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006397.s002" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Noise ceiling estimates obtained in real fMRI data the inclusion of GLMdenoise noise regressors.</title>
<p>Histograms represent the noise ceiling obtained for 50000 voxels (randomly selected) for one subject. Every row in the figure presents the noise ceiling estimated under different parametrizations of the noise covariance matrix (from top to bottom: <inline-formula id="pcbi.1006397.e157"><alternatives><graphic id="pcbi.1006397.e157g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e157" xlink:type="simple"/><mml:math display="inline" id="M157"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006397.e158"><alternatives><graphic id="pcbi.1006397.e158g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e158" xlink:type="simple"/><mml:math display="inline" id="M158"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Ω</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>). The R2Rnc and the SHnc are presented in the two right most columns and, in each row, are computed based on the <inline-formula id="pcbi.1006397.e159"><alternatives><graphic id="pcbi.1006397.e159g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006397.e159" xlink:type="simple"/><mml:math display="inline" id="M159"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> obtained under different parametrizations of the noise covariance matrix.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006397.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006397.s003" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Histograms of the noise ceiling obtained without the inclusion of the GLMdenoise regressors for ten subjects.</title>
<p>The split half method (blue) and the analytical solution (R2Rnc) were computed in 50000 (randomly selected) voxels for 10 subjects.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1006397.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Naselaris</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kay</surname> <given-names>KN</given-names></name>. <article-title>Resolving ambiguities of MVPA using explicit models of representation</article-title>. <source>Trends Cogn Sci</source>. <year>2016</year>;<volume>19</volume>: <fpage>551</fpage>–<lpage>554</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tics.2015.07.005" xlink:type="simple">10.1016/j.tics.2015.07.005</ext-link></comment> <object-id pub-id-type="pmid">26412094</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van Gerven</surname> <given-names>MAJ</given-names></name>. <article-title>A primer on encoding models in sensory neuroscience</article-title>. <source>J Math Psychol</source>. Elsevier Inc.; <year>2017</year>;<volume>76</volume>: <fpage>172</fpage>–<lpage>183</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jmp.2016.06.009" xlink:type="simple">10.1016/j.jmp.2016.06.009</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006397.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dumoulin</surname> <given-names>SO</given-names></name>, <name name-style="western"><surname>Wandell</surname> <given-names>BA</given-names></name>. <article-title>Population receptive field estimates in human visual cortex</article-title>. <source>Neuroimage</source>. <year>2008</year>;<volume>39</volume>: <fpage>647</fpage>–<lpage>660</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2007.09.034" xlink:type="simple">10.1016/j.neuroimage.2007.09.034</ext-link></comment> <object-id pub-id-type="pmid">17977024</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moerel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>De Martino</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Formisano</surname> <given-names>E</given-names></name>. <article-title>Processing of Natural Sounds in Human Auditory Cortex: Tonotopy, Spectral Tuning, and Relation to Voice Sensitivity</article-title>. <source>J Neurosci</source>. <year>2012</year>;<volume>32</volume>: <fpage>14205 LP</fpage>–<lpage>14216</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://www.jneurosci.org/content/32/41/14205.abstract" xlink:type="simple">http://www.jneurosci.org/content/32/41/14205.abstract</ext-link></mixed-citation></ref>
<ref id="pcbi.1006397.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Diedrichsen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kriegeskorte</surname> <given-names>N</given-names></name>. <article-title>Representational models: A common framework for understanding encoding, pattern-component, and representational-similarity analysis</article-title>. <source>PLoS Computational Biology</source>. <year>2017</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005508" xlink:type="simple">10.1371/journal.pcbi.1005508</ext-link></comment> <object-id pub-id-type="pmid">28437426</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kay</surname> <given-names>KN</given-names></name>, <name name-style="western"><surname>Naselaris</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Prenger</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Gallant</surname> <given-names>JL</given-names></name>. <article-title>Identifying natural images from human brain activity</article-title>. <source>Nature</source>. <year>2008</year>;<volume>452</volume>: <fpage>352</fpage>–<lpage>355</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature06713" xlink:type="simple">10.1038/nature06713</ext-link></comment> <object-id pub-id-type="pmid">18322462</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Santoro</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Moerel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>De Martino</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Goebel</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ugurbil</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Yacoub</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Encoding of Natural Sounds at Multiple Spectral and Temporal Resolutions in the Human Auditory Cortex</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003412" xlink:type="simple">10.1371/journal.pcbi.1003412</ext-link></comment> <object-id pub-id-type="pmid">24391486</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Martino</surname> <given-names>F De</given-names></name>, <name name-style="western"><surname>Yacoub</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Kemper</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Moerel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Uluda</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Weerd</surname> <given-names>P De</given-names></name>, <etal>et al</etal>. <source>NeuroImage The impact of ultra-high fi eld MRI on cognitive and computational neuroimaging</source>. <year>2018</year>;<volume>168</volume>: <fpage>366</fpage>–<lpage>382</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2017.03.060" xlink:type="simple">10.1016/j.neuroimage.2017.03.060</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006397.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lescroart</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Stansbury</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Gallant</surname> <given-names>JL</given-names></name>. <article-title>Fourier power, subjective distance, and object categories all provide plausible models of BOLD responses in scene-selective visual areas</article-title>. <source>Front Comput Neurosci</source>. <year>2015</year>;<volume>9</volume>: <fpage>135</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fncom.2015.00135" xlink:type="simple">10.3389/fncom.2015.00135</ext-link></comment> <object-id pub-id-type="pmid">26594164</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wen</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>Z</given-names></name>. <article-title>Deep Residual Network Predicts Cortical Representation and Organization of Visual Features for Rapid Categorization</article-title>. <source>Sci Rep</source>. Springer US; <year>2018</year>;<volume>8</volume>: <fpage>1</fpage>–<lpage>17</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41598-017-17765-5" xlink:type="simple">10.1038/s41598-017-17765-5</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006397.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nelken</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Tishby</surname> <given-names>N</given-names></name>. <article-title>PLOS Computational Biology The Representation of Prediction Error in Auditory Cortex</article-title>. <source>PLoS Comput Biol</source>. <year>2016</year>;<volume>12</volume>: <fpage>1</fpage>–<lpage>28</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.3m5v5" xlink:type="simple">10.5061/dryad.3m5v5</ext-link></comment> <object-id pub-id-type="pmid">27490251</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kell</surname> <given-names>AJE</given-names></name>, <name name-style="western"><surname>Yamins</surname> <given-names>DLK</given-names></name>, <name name-style="western"><surname>Shook</surname> <given-names>EN</given-names></name>, <name name-style="western"><surname>Norman-Haignere S</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>McDermott</surname> <given-names>JH</given-names></name>. <article-title>A Task-Optimized Neural Network Replicates Human Auditory Behavior, Predicts Brain Responses, and Reveals a Cortical Processing Hierarchy</article-title>. <source>Neuron</source>. United States; <year>2018</year>;<volume>98</volume>: <fpage>630</fpage>–<lpage>644.e16</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2018.03.044" xlink:type="simple">10.1016/j.neuron.2018.03.044</ext-link></comment> <object-id pub-id-type="pmid">29681533</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>de Heer</surname> <given-names>WA</given-names></name>, <name name-style="western"><surname>Huth</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Griffiths</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Gallant</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Theunissen</surname> <given-names>FE</given-names></name>. <article-title>The Hierarchical Cortical Organization of Human Speech Processing</article-title>. <source>J Neurosci</source>. United States; <year>2017</year>;<volume>37</volume>: <fpage>6539</fpage>–<lpage>6557</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.3267-16.2017" xlink:type="simple">10.1523/JNEUROSCI.3267-16.2017</ext-link></comment> <object-id pub-id-type="pmid">28588065</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chen</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Taylor</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Haller</surname> <given-names>SP</given-names></name>, <name name-style="western"><surname>Kircanski</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Stoddard</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pine</surname> <given-names>DS</given-names></name>, <etal>et al</etal>. <article-title>Intraclass correlation: Improved modeling approaches and applications for neuroimaging</article-title>. <source>Hum Brain Mapp</source>. <year>2018</year>;<volume>39</volume>: <fpage>1187</fpage>–<lpage>1206</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/hbm.23909" xlink:type="simple">10.1002/hbm.23909</ext-link></comment> <object-id pub-id-type="pmid">29218829</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carlin</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Kriegeskorte</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Bandettini</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kriegeskorte</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Marslen-Wilson</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Kriegeskorte</surname> <given-names>N</given-names></name>. <article-title>Adjudicating between face-coding models with individual-face fMRI responses</article-title>. <name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>, editor. <source>PLOS Comput Biol</source>. Academic Press; <year>2017</year>;<volume>13</volume>: <fpage>e1005604</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005604" xlink:type="simple">10.1371/journal.pcbi.1005604</ext-link></comment> <object-id pub-id-type="pmid">28746335</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kay</surname> <given-names>KN</given-names></name>, <name name-style="western"><surname>Winawer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mezer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wandell</surname> <given-names>BA</given-names></name>. <article-title>Compressive spatial summation in human visual cortex</article-title>. <source>J Neurophysiol</source>. Bethesda, MD: American Physiological Society; <year>2013</year>;<volume>110</volume>: <fpage>481</fpage>–<lpage>494</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.00105.2013" xlink:type="simple">10.1152/jn.00105.2013</ext-link></comment> <object-id pub-id-type="pmid">23615546</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hsu</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Borst</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Theunissen</surname> <given-names>FE</given-names></name>. <article-title>Quantifying variability in neural responses and its application for the validation of model predictions</article-title>. <source>Netw Comput Neural Syst</source>. <year>2004</year>;<volume>15</volume>: <fpage>91</fpage>–<lpage>109</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1088/0954-898X_15_2_002" xlink:type="simple">10.1088/0954-898X_15_2_002</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006397.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huth</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Nishimoto</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Vu</surname> <given-names>AT</given-names></name>, <name name-style="western"><surname>Gallant</surname> <given-names>JL</given-names></name>. <article-title>A Continuous Semantic Space Describes the Representation of Thousands of Object and Action Categories across the Human Brain</article-title>. <source>Neuron</source>. Elsevier; <year>2017</year>;<volume>76</volume>: <fpage>1210</fpage>–<lpage>1224</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2012.10.014" xlink:type="simple">10.1016/j.neuron.2012.10.014</ext-link></comment> <object-id pub-id-type="pmid">23259955</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Worsley</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Poline</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Frith</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>FraFckowiak</surname> <given-names>RSJ</given-names></name>, <etal>et al</etal>. <article-title>Statistical parametric maps in functional imaging: a general linear approach</article-title>. <source>Hum Brain Mapp</source>. <year>1995</year>;<volume>2</volume>: <fpage>189</fpage>–<lpage>210</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://scholar.google.com/scholar?hl=en&amp;btnG=Search&amp;q=intitle:Statistical+parametric+maps+in+functional+imaging:+a+general+linear+approach#0" xlink:type="simple">http://scholar.google.com/scholar?hl=en&amp;btnG=Search&amp;q=intitle:Statistical+parametric+maps+in+functional+imaging:+a+general+linear+approach#0</ext-link></mixed-citation></ref>
<ref id="pcbi.1006397.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Poline</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Brett</surname> <given-names>M</given-names></name>. <article-title>The general linear model and fMRI: Does love last forever?</article-title> <source>Neuroimage</source>. <year>2012</year>;<volume>62</volume>: <fpage>871</fpage>–<lpage>880</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2012.01.133" xlink:type="simple">10.1016/j.neuroimage.2012.01.133</ext-link></comment> <object-id pub-id-type="pmid">22343127</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Monti</surname> <given-names>M.</given-names></name> <article-title>Statistical Analysis of fMRI Time-Series: A Critical Review of the GLM Approach</article-title>. <source>Front Hum Neurosci</source>. <year>2011</year>;<volume>5</volume>: <fpage>1</fpage>–<lpage>13</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fnhum.2011.00001" xlink:type="simple">10.3389/fnhum.2011.00001</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006397.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Worsley</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>. <article-title>Analysis of fMRI time-series revisited</article-title>. [Internet]. <source>NeuroImage</source>. <year>1995</year>. pp. <fpage>45</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1006/nimg.1995.1007" xlink:type="simple">10.1006/nimg.1995.1007</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006397.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vinckier</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Dehaene</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Jobert</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dubus</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Sigman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>L</given-names></name>. <article-title>Hierarchical Coding of Letter Strings in the Ventral Stream: Dissecting the Inner Organization of the Visual Word-Form System</article-title>. <source>Neuron</source>. <year>2007</year>;<volume>55</volume>: <fpage>143</fpage>–<lpage>156</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2007.05.031" xlink:type="simple">10.1016/j.neuron.2007.05.031</ext-link></comment> <object-id pub-id-type="pmid">17610823</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fodor</surname> <given-names>IK</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>DO</given-names></name>, <name name-style="western"><surname>Alegria-Hartman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Robbins</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Langlois</surname> <given-names>RG</given-names></name>, <name name-style="western"><surname>Turteltaub</surname> <given-names>KW</given-names></name>, <etal>et al</etal>. <article-title>Statistical challenges in the analysis of two-dimensional difference gel electrophoresis experiments using DeCyder???</article-title> <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>: <fpage>3733</fpage>–<lpage>3740</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/bti612" xlink:type="simple">10.1093/bioinformatics/bti612</ext-link></comment> <object-id pub-id-type="pmid">16091413</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Walther</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Nili</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ejaz</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Alink</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kriegeskorte</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Diedrichsen</surname> <given-names>J</given-names></name>. <article-title>Reliability of dissimilarity measures for multi-voxel pattern analysis</article-title>. <source>Neuroimage</source>. Elsevier B.V.; <year>2016</year>;<volume>137</volume>: <fpage>188</fpage>–<lpage>200</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2015.12.012" xlink:type="simple">10.1016/j.neuroimage.2015.12.012</ext-link></comment> <object-id pub-id-type="pmid">26707889</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref026"><label>26</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Bishop</surname> <given-names>CM</given-names></name>. <chapter-title>Pattern Recognition and Machine Learning</chapter-title>. <publisher-name>Springer-Verlag New York, Inc.</publisher-name> <publisher-loc>Secaucus, NJ, USA</publisher-loc> 2006; <year>2006</year>.</mixed-citation></ref>
<ref id="pcbi.1006397.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Adaszewski</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Slater</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Melie-Garcia</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Draganski</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Bogorodzki</surname> <given-names>P</given-names></name>. <article-title>Simultaneous estimation of population receptive field and hemodynamic parameters from single point BOLD responses using Metropolis-Hastings sampling</article-title>. <source>Neuroimage</source>. <year>2018</year>;<volume>172</volume>: <fpage>175</fpage>–<lpage>193</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2018.01.047" xlink:type="simple">10.1016/j.neuroimage.2018.01.047</ext-link></comment> <object-id pub-id-type="pmid">29414493</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schoppe</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Harper</surname> <given-names>NS</given-names></name>, <name name-style="western"><surname>Willmore</surname> <given-names>BDB</given-names></name>, <name name-style="western"><surname>King</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Schnupp</surname> <given-names>JWH</given-names></name>. <article-title>Measuring the Performance of Neural Models</article-title>. <source>Front Comput Neurosci</source>. <year>2016</year>;<volume>10</volume>: <fpage>1</fpage>–<lpage>11</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fncom.2016.00001" xlink:type="simple">10.3389/fncom.2016.00001</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006397.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Luking</surname> <given-names>KR</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>BD</given-names></name>, <name name-style="western"><surname>Infantolino</surname> <given-names>ZP</given-names></name>, <name name-style="western"><surname>Sauder</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Hajcak</surname> <given-names>G</given-names></name>. <article-title>Internal Consistency of Functional Magnetic Resonance Imaging and Electroencephalography Measures of Reward in Late Childhood and Early Adolescence</article-title>. <source>Biol Psychiatry Cogn Neurosci Neuroimaging</source>. Elsevier Inc.; <year>2017</year>;<volume>2</volume>: <fpage>289</fpage>–<lpage>297</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.bpsc.2016.12.004" xlink:type="simple">10.1016/j.bpsc.2016.12.004</ext-link></comment> <object-id pub-id-type="pmid">29057369</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Diedrichsen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Shadmehr</surname> <given-names>R</given-names></name>. <article-title>Detecting and adjusting for artifacts in fMRI time series data</article-title>. <source>Neuroimage</source>. <year>2005</year>;<volume>27</volume>: <fpage>624</fpage>–<lpage>634</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2005.04.039" xlink:type="simple">10.1016/j.neuroimage.2005.04.039</ext-link></comment> <object-id pub-id-type="pmid">15975828</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>de Bertoldi</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Finos</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Maieron</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Weis</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Campanella</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ius</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Improving the reliability of single-subject fMRI by weighting intra-run variability</article-title>. <source>Neuroimage</source>. Elsevier B.V.; <year>2015</year>;<volume>114</volume>: <fpage>287</fpage>–<lpage>293</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2015.03.076" xlink:type="simple">10.1016/j.neuroimage.2015.03.076</ext-link></comment> <object-id pub-id-type="pmid">25862262</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gonzalez-Castillo</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Nichols</surname> <given-names>TE</given-names></name>, <name name-style="western"><surname>Bandettini</surname> <given-names>PA</given-names></name>. <article-title>Variance decomposition for single-subject task-based fMRI activity estimates across many sessions</article-title>. <source>Neuroimage</source>. Elsevier; <year>2017</year>;<volume>154</volume>: <fpage>206</fpage>–<lpage>218</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2016.10.024" xlink:type="simple">10.1016/j.neuroimage.2016.10.024</ext-link></comment> <object-id pub-id-type="pmid">27773827</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moortele</surname> <given-names>P Van De</given-names></name>, <name name-style="western"><surname>Auerbach</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>Olman</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Yacoub</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Kâmil</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Moeller</surname> <given-names>S</given-names></name>. <source>NeuroImage T 1 weighted brain images at 7 Tesla unbiased for Proton Density, T 2 ⁎ contrast and RF coil receive B 1 sensitivity with simultaneous vessel visualization</source>. <year>2009</year>;<volume>46</volume>: <fpage>432</fpage>–<lpage>446</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2009.02.009" xlink:type="simple">10.1016/j.neuroimage.2009.02.009</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006397.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goebel</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Esposito</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Formisano</surname> <given-names>E</given-names></name>. <article-title>Analysis of Functional Image Analysis Contest (FIAC) data with BrainVoyager QX: From single-subject to cortically aligned group General Linear Model analysis and self-organizing group Independent Component Analysis</article-title>. <source>Hum Brain Mapp</source>. <year>2006</year>;<volume>27</volume>: <fpage>392</fpage>–<lpage>401</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/hbm.20249" xlink:type="simple">10.1002/hbm.20249</ext-link></comment> <object-id pub-id-type="pmid">16596654</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Naselaris</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kay</surname> <given-names>KN</given-names></name>, <name name-style="western"><surname>Nishimoto</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gallant</surname> <given-names>JL</given-names></name>. <article-title>Encoding and decoding in fMRI</article-title>. <source>Neuroimage</source>. Elsevier B.V.; <year>2011</year>;<volume>56</volume>: <fpage>400</fpage>–<lpage>410</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2010.07.073" xlink:type="simple">10.1016/j.neuroimage.2010.07.073</ext-link></comment> <object-id pub-id-type="pmid">20691790</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kriegeskorte</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Diedrichsen</surname> <given-names>J</given-names></name>. <article-title>Inferring brain-computational mechanisms with models of activity measurements</article-title>. <source>Philos Trans R Soc B Biol Sci</source>. <year>2016</year>;<volume>371</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.2016.0278" xlink:type="simple">10.1098/rstb.2016.0278</ext-link></comment> <object-id pub-id-type="pmid">27574316</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Güçlü</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>van Gerven</surname> <given-names>MAJ</given-names></name>. <source>Modeling the dynamics of human brain activity with recurrent neural networks</source>. <year>2016</year>;<volume>11</volume>: <fpage>1</fpage>–<lpage>14</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fncom.2017.00007" xlink:type="simple">10.3389/fncom.2017.00007</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006397.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Coggan</surname> <given-names>DD</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Baker</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Andrews</surname> <given-names>TJ</given-names></name>. <article-title>Category-selective patterns of neural response in the ventral visual pathway in the absence of categorical information</article-title>. <source>Neuroimage</source>. <year>2016</year>;<volume>135</volume>: <fpage>107</fpage>–<lpage>114</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2016.04.060" xlink:type="simple">10.1016/j.neuroimage.2016.04.060</ext-link></comment> <object-id pub-id-type="pmid">27132543</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Arbuckle</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Yokoi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Pruszynski</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Diedrichsen</surname> <given-names>J</given-names></name>. <article-title>Stability of representational geometry across a wide range of fMRI activity levels</article-title>. <source>bioRxiv</source>. <year>2018</year>; <fpage>266585</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/266585" xlink:type="simple">10.1101/266585</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006397.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wardle</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Kriegeskorte</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Grootswagers</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Khaligh-Razavi</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Carlson</surname> <given-names>TA</given-names></name>. <article-title>Perceptual similarity of visual patterns predicts dynamic neural activation patterns measured with MEG</article-title>. <source>Neuroimage</source>. Elsevier Inc.; <year>2016</year>;<volume>132</volume>: <fpage>59</fpage>–<lpage>70</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2016.02.019" xlink:type="simple">10.1016/j.neuroimage.2016.02.019</ext-link></comment> <object-id pub-id-type="pmid">26899210</object-id></mixed-citation></ref>
<ref id="pcbi.1006397.ref041"><label>41</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Nili</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Wingfield</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Walther</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Su</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Marslen-Wilson</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Kriegeskorte</surname> <given-names>N</given-names></name>. <chapter-title>A Toolbox for Representational Similarity Analysis</chapter-title>. <name name-style="western"><surname>Prlic</surname> <given-names>A</given-names></name>, editor. <source>PLoS Comput Biol</source>. <publisher-loc>San Francisco, USA</publisher-loc>: <publisher-name>Public Library of Science</publisher-name>; <year>2014</year>;<volume>10</volume>: <fpage>e1003553</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003553" xlink:type="simple">10.1371/journal.pcbi.1003553</ext-link></comment> <object-id pub-id-type="pmid">24743308</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>