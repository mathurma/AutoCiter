<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006759</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01540</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Earth sciences</subject><subj-group><subject>Atmospheric science</subject><subj-group><subject>Atmospheric chemistry</subject><subj-group><subject>Greenhouse gases</subject><subj-group><subject>Methane</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Environmental chemistry</subject><subj-group><subject>Atmospheric chemistry</subject><subj-group><subject>Greenhouse gases</subject><subj-group><subject>Methane</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Environmental chemistry</subject><subj-group><subject>Atmospheric chemistry</subject><subj-group><subject>Greenhouse gases</subject><subj-group><subject>Methane</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical compounds</subject><subj-group><subject>Methane</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical compounds</subject><subj-group><subject>Organic compounds</subject><subj-group><subject>Alcohols</subject><subj-group><subject>Ethanol</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Organic chemistry</subject><subj-group><subject>Organic compounds</subject><subj-group><subject>Alcohols</subject><subj-group><subject>Ethanol</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Biological cultures</subject><subj-group><subject>Cell culturing techniques</subject><subj-group><subject>Enrichment culture</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Energy and power</subject><subj-group><subject>Bioenergy</subject><subj-group><subject>Biofuels</subject><subj-group><subject>Biogas</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Energy and power</subject><subj-group><subject>Fuels</subject><subj-group><subject>Biofuels</subject><subj-group><subject>Biogas</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Materials science</subject><subj-group><subject>Materials</subject><subj-group><subject>Fuels</subject><subj-group><subject>Biofuels</subject><subj-group><subject>Biogas</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Network analysis</subject><subj-group><subject>Metabolic networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Metabolism</subject><subj-group><subject>Metabolites</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical elements</subject><subj-group><subject>Hydrogen</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical compounds</subject><subj-group><subject>Propionates</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>RedCom: A strategy for reduced metabolic modeling of complex microbial communities and its application for analyzing experimental datasets from anaerobic digestion</article-title>
<alt-title alt-title-type="running-head">Reduced metabolic modeling of microbial communities and application for the biogas process</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1761-096X</contrib-id>
<name name-style="western">
<surname>Koch</surname>
<given-names>Sabine</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kohrs</surname>
<given-names>Fabian</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Lahmann</surname>
<given-names>Patrick</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Bissinger</surname>
<given-names>Thomas</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Wendschuh</surname>
<given-names>Stefan</given-names>
</name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Benndorf</surname>
<given-names>Dirk</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Reichl</surname>
<given-names>Udo</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2563-7561</contrib-id>
<name name-style="western">
<surname>Klamt</surname>
<given-names>Steffen</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Max Planck Institute for Dynamics of Complex Technical Systems, Magdeburg, Germany</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Otto-von-Guericke University Magdeburg, Faculty for Process and Systems Engineering, Magdeburg, Germany</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Teusink</surname>
<given-names>Bas</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>VU University, NETHERLANDS</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">klamt@mpi-magdeburg.mpg.de</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>1</day>
<month>2</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="collection">
<month>2</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>2</issue>
<elocation-id>e1006759</elocation-id>
<history>
<date date-type="received">
<day>5</day>
<month>9</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>5</day>
<month>1</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Koch et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006759"/>
<abstract>
<p>Constraint-based modeling (CBM) is increasingly used to analyze the metabolism of complex microbial communities involved in ecology, biomedicine, and various biotechnological processes. While CBM is an established framework for studying the metabolism of single species with linear stoichiometric models, CBM of communities with balanced growth is more complicated, not only due to the larger size of the multi-species metabolic network but also because of the bilinear nature of the resulting community models. Moreover, the solution space of these community models often contains biologically unrealistic solutions, which, even with model linearization and under application of certain objective functions, cannot easily be excluded. Here we present RedCom, a new approach to build reduced community models in which the metabolisms of the participating organisms are represented by net conversions computed from the respective single-species networks. By discarding (single-species) net conversions that violate a minimality criterion in the exchange fluxes, it is ensured that unrealistic solutions in the community model are excluded where a species altruistically synthesizes large amounts of byproducts (instead of biomass) to fulfill the requirements of other species. We employed the RedCom approach for modeling communities of up to nine organisms involved in typical degradation steps of anaerobic digestion in biogas plants. Compared to full (bilinear and linearized) community models, we found that the reduced community models obtained with RedCom are not only much smaller but allow, also in the largest model with nine species, extensive calculations required to fully characterize the solution space and to reveal key properties of communities with maximum methane yield and production rates. Furthermore, the predictive power of the reduced community models is significantly larger because they predict much smaller ranges of feasible community compositions and exchange fluxes still being consistent with measurements obtained from enrichment cultures. For an enrichment culture for growth on ethanol, we also used metaproteomic data to further constrain the solution space of the community models. Both model and proteomic data indicated a dominance of acetoclastic methanogens (Methanosarcinales) and Desulfovibrionales being the least abundant group in this microbial community.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Microbial communities are involved in many fundamental processes in nature, health and biotechnology. The elucidation of interdependencies between the involved players of microbial communities and how the interactions shape the composition, behavior and characteristic features of the consortium has become an important branch of microbiology research. Many communities are based on the exchange of metabolites between the species and constraint-based metabolic modeling has become an important approach for a formal description and quantitative analysis of these metabolic dependencies. However, the complexity of the models rises quickly with a growing number of organisms and the space of predicted feasible behaviors often includes unrealistic solutions. Here we present RedCom, a new approach to build reduced stoichiometric models of balanced microbial communities based on net conversions of the single-species models. We demonstrate the applicability of our RedCom approach by modeling communities of up to nine organisms involved in degradation steps of anaerobic digestion in biogas plants. As one of the first studies in this field, we compare simulation results from the community models with experimental data of laboratory-scale biogas reactors for growth on ethanol and glucose-cellulose media. The results also demonstrate a higher predictive power of the RedCom vs. the full models.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Ministerium für Wissenschaft und Wirtschaft, Land Sachsen-Anhalt (FR)</institution>
</funding-source>
<award-id>Research Center of Dynamic Systems (CDS)</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2563-7561</contrib-id>
<name name-style="western">
<surname>Klamt</surname>
<given-names>Steffen</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>International Max Planck Research School (IMPRS) for Advanced Methods in Process and System Engineering</institution>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1761-096X</contrib-id>
<name name-style="western">
<surname>Koch</surname>
<given-names>Sabine</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>Sabine Koch received financial support by the "International Max Planck Research School (IMPRS) for Advanced Methods in Process and System Engineering” in Magdeburg (URL: <ext-link ext-link-type="uri" xlink:href="https://www.mpi-magdeburg.mpg.de/imprs" xlink:type="simple">https://www.mpi-magdeburg.mpg.de/imprs</ext-link>) and by the EU-program ERDF (European Regional Development Fund) of the German Federal State Saxony-Anhalt within the Research Center of Dynamic Systems (CDS). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="5"/>
<page-count count="32"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-02-13</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the manuscript and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Microbial communities are of major importance for human health [<xref ref-type="bibr" rid="pcbi.1006759.ref001">1</xref>,<xref ref-type="bibr" rid="pcbi.1006759.ref002">2</xref>], geochemical cycles [<xref ref-type="bibr" rid="pcbi.1006759.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1006759.ref004">4</xref>] and biotechnological processes [<xref ref-type="bibr" rid="pcbi.1006759.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1006759.ref007">7</xref>]. Despite of their importance, most microbial communities are still poorly understood due to their complex nature. Mathematical modeling can help to uncover the interactions and dependencies of the members of these communities. Different modeling formalisms have been used to simulate microbial communities including stoichiometric models, which can be analyzed by constraint-based methods [<xref ref-type="bibr" rid="pcbi.1006759.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1006759.ref018">18</xref>]. An increasing number of stoichiometric community models considers <italic>balanced growth</italic> as a key assumption stating that all organisms must grow with the same growth rate in a stable community [<xref ref-type="bibr" rid="pcbi.1006759.ref011">11</xref>,<xref ref-type="bibr" rid="pcbi.1006759.ref015">15</xref>,<xref ref-type="bibr" rid="pcbi.1006759.ref016">16</xref>]. One central goal of these models is the characterization and prediction of possible community compositions and the analysis of the different modes of cross-feeding between the involved organisms.</p>
<p>Stoichiometric models of microbial communities with balanced growth usually result in bilinear models, where, in some equations, independent variables are multiplied with each other. Thus, apart from their increased size, these models have a more complex nature than the linear metabolic models of single species. To make bilinear models amenable to established constraint-based modeling approaches, they can be linearized by fixing either the community growth rate [<xref ref-type="bibr" rid="pcbi.1006759.ref016">16</xref>] or the community composition [<xref ref-type="bibr" rid="pcbi.1006759.ref011">11</xref>,<xref ref-type="bibr" rid="pcbi.1006759.ref015">15</xref>]. In this study, we first provide a unified framework for setting-up, analyzing, and linearizing community models. Even in linearized community models, the application of certain constraint-based techniques becomes quickly infeasible with an increasing number of organisms. Furthermore, one shortcoming of existing methods for modeling of communities is that the solution space often contains unrealistic solutions (where, for example, a species behaves unrealistically altruistic to produce substrates needed by other community members). We therefore introduce a new approach, RedCom, to build reduced community models. The main principle of RedCom is similar to what has been suggested by Taffs et al. [<xref ref-type="bibr" rid="pcbi.1006759.ref010">10</xref>], namely to compute, in a first step, relevant net conversions of the single-species models which serve as reactions for the reduced model. This reduced model can then be used to identify suitable combinations of single-species net conversions to obtain community-level conversions. However, while Taffs et al. [<xref ref-type="bibr" rid="pcbi.1006759.ref010">10</xref>] used elementary modes to describe the single-species net conversions, RedCom is based on the more general concept of elementary flux vectors [<xref ref-type="bibr" rid="pcbi.1006759.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1006759.ref020">20</xref>]. This will be required to ensure balanced growth in the community model and to appropriately account for flux bounds and other (e.g. proteome allocation) constraints. Reduced community models obtained with RedCom do not only focus on most relevant solutions but allow for a comprehensive characterization of solution spaces also for communities with more than only two or three species. In the following, we apply the proposed techniques for different community models with increasing complexity from three up to nine species. The investigated communities are capable of degrading different substrates to biogas, a renewable energy source. Community models of the biogas process give insights on interdependencies and feasible community compositions and may contribute to increase productivity and stability of this process. As one of the first studies, we also compare simulation results from the community models with experimental data of laboratory-scale biogas reactors for growth on ethanol and glucose-cellulose media.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>Constraint-based modeling</title>
<p>Constraint-based (stoichiometric) modeling of metabolic networks [<xref ref-type="bibr" rid="pcbi.1006759.ref021">21</xref>] relies on the assumption of a steady-state for internal metabolite concentrations leading to the mass balance equation:
<disp-formula id="pcbi.1006759.e001">
<alternatives>
<graphic id="pcbi.1006759.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mi mathvariant="bold">N</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mo>=</mml:mo><mml:mn mathvariant="bold">0</mml:mn>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula></p>
<p>The structure of the network is captured by the stoichiometric matrix <bold>N</bold> storing the stoichiometric coefficients of the metabolites (rows) in the metabolic reactions (columns). As consequence of eq. (<xref ref-type="disp-formula" rid="pcbi.1006759.e001">1</xref>), steady-state flux vectors <bold>r</bold> fulfill the condition that no net accumulation or depletion of internal metabolites occurs. Additionally to the steady-state condition, reversibility constraints (2), flux bounds (3) and other types of inhomogeneous linear constraints (4) can be included:
<disp-formula id="pcbi.1006759.e002">
<alternatives>
<graphic id="pcbi.1006759.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mspace width="0.25em"/><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
<disp-formula id="pcbi.1006759.e003">
<alternatives>
<graphic id="pcbi.1006759.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
<disp-formula id="pcbi.1006759.e004">
<alternatives>
<graphic id="pcbi.1006759.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mi mathvariant="bold">A</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mo>≤</mml:mo><mml:mi mathvariant="bold">b</mml:mi><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula></p>
<p>The set <italic>Irrev</italic> contains the indices of irreversible reactions. If only the steady-state (1) and the irreversibility constraints (2) are taken into account, the solution space forms a polyhedral (flux) cone; with any constraint of type (3) or (4) its shape becomes a (flux) polyhedron.</p>
</sec>
<sec id="sec004">
<title>Assembling a compartmented community model from single-species models</title>
<p>In order to create a community model combining all (<italic>n</italic>) single-species models, herein referred to as full model, a compartmented approach is usually employed [<xref ref-type="bibr" rid="pcbi.1006759.ref009">9</xref>,<xref ref-type="bibr" rid="pcbi.1006759.ref011">11</xref>,<xref ref-type="bibr" rid="pcbi.1006759.ref012">12</xref>,<xref ref-type="bibr" rid="pcbi.1006759.ref015">15</xref>,<xref ref-type="bibr" rid="pcbi.1006759.ref022">22</xref>,<xref ref-type="bibr" rid="pcbi.1006759.ref023">23</xref>]. Each organism represents one compartment and an additional exchange compartment allows for exchange of metabolites (substrates/products) between organisms and with the medium (<xref ref-type="fig" rid="pcbi.1006759.g001">Fig 1</xref>). With the new exchange compartment, the former external (unbalanced) metabolites become now internal ones and must be balanced in eq. (<xref ref-type="disp-formula" rid="pcbi.1006759.e001">1</xref>). Exchange metabolites used by several species are combined such that they exist only once in the community model.</p>
<fig id="pcbi.1006759.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006759.g001</object-id>
<label>Fig 1</label>
<caption>
<title/>
<p><bold>Schematic overview of the structure of single-species models (A) and the resulting community model (B).</bold> Metabolites are indicated with boxes, reactions are represented by arrows. External metabolites in single-species models become internal metabolites in the community model.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.g001" xlink:type="simple"/>
</fig>
<p>As described in [<xref ref-type="bibr" rid="pcbi.1006759.ref015">15</xref>] the units of the (specific) single-species reaction rates must be adapted to refer to the total community (instead of single-species) biomass. Accordingly, the units of all reaction rates change from mmol/gDW<sub><italic>i</italic></sub>/h to mmol/gDW<sub><italic>c</italic></sub>/h. Exceptions are the <italic>n</italic> biomass synthesis (growth) reactions producing the species biomasses BM<sub><italic>i</italic></sub> from a (species-specific) set of precursors:
<disp-formula id="pcbi.1006759.e005">
<alternatives>
<graphic id="pcbi.1006759.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mrow><mml:msub><mml:mi mathvariant="normal">γ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">γ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">γ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="normal">p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">B</mml:mi><mml:msub><mml:mi mathvariant="normal">M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.12em"/><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:msub><mml:mi mathvariant="normal">W</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo><mml:mspace width="0.50em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula></p>
<p>In the single-species models, the specific (growth) rates <italic>μ</italic><sub><italic>i</italic></sub> (<italic>i</italic> = 1…<italic>n</italic>) of these <italic>n</italic> reactions referred to unit 1/h, which is now changed to gDW<sub><italic>i</italic></sub>/gDW<sub><italic>c</italic></sub>/h. We indicate the changed units of these reaction rates in the community model by the symbol <inline-formula id="pcbi.1006759.e006"><alternatives><graphic id="pcbi.1006759.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:math></alternatives></inline-formula></p>
<p>Furthermore, <italic>n</italic> new pseudo-reactions are introduced in the community model to describe the integration of the <italic>n</italic> species biomasses into the community biomass BM<sub><italic>c</italic></sub> (<xref ref-type="fig" rid="pcbi.1006759.g001">Fig 1</xref>):
<disp-formula id="pcbi.1006759.e007">
<alternatives>
<graphic id="pcbi.1006759.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">B</mml:mi><mml:msub><mml:mi mathvariant="normal">M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:msub><mml:mi mathvariant="normal">W</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">B</mml:mi><mml:msub><mml:mi mathvariant="normal">M</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:msub><mml:mi mathvariant="normal">W</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">rate</mml:mi><mml:mo>:</mml:mo><mml:mspace width="0.25em"/><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mspace width="0.25em"/><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:msub><mml:mi mathvariant="normal">W</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:msub><mml:mi mathvariant="normal">W</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi mathvariant="normal">h</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula></p>
<p>Finally, a new <italic>community growth reaction</italic> is introduced “exporting” the synthesized community biomass to the medium (<xref ref-type="fig" rid="pcbi.1006759.g001">Fig 1</xref>); the rate of this reaction is the community growth rate μ<sub><italic>c</italic></sub> [1/h]:
<disp-formula id="pcbi.1006759.e008">
<alternatives>
<graphic id="pcbi.1006759.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e008" xlink:type="simple"/>
<mml:math display="block" id="M8">
<mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">B</mml:mi><mml:msub><mml:mi mathvariant="normal">M</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:msub><mml:mi mathvariant="normal">W</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mspace width="3em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">rate</mml:mi><mml:mo>:</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>μ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula></p>
<p>Note that, in steady state, <inline-formula id="pcbi.1006759.e009"><alternatives><graphic id="pcbi.1006759.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>→</mml:mo><mml:mi>B</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006759.e010"><alternatives><graphic id="pcbi.1006759.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>→</mml:mo><mml:mi>B</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. The obtained structure of the whole community network is captured in the community stoichiometric matrix <bold>N</bold><sup><italic>c</italic></sup> and the reaction rates in the community flux vector <bold>r</bold><sup><italic>c</italic></sup> (with units as described above). As for the single-species models, we demand steady-state for the metabolites (including all metabolites in the exchange compartment):
<disp-formula id="pcbi.1006759.e011">
<alternatives>
<graphic id="pcbi.1006759.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e011" xlink:type="simple"/>
<mml:math display="block" id="M11">
<mml:mrow><mml:msup><mml:mi mathvariant="bold">N</mml:mi><mml:mi>c</mml:mi></mml:msup><mml:msup><mml:mi mathvariant="bold">r</mml:mi><mml:mi>c</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula></p>
<p>In a stable continuous culture, the growth rate of microorganisms is typically equal to the dilution rate. We assume that the same is true for a microbial community cultivated in a continuous process. In that case, the growth rates <italic>μ</italic><sub><italic>i</italic></sub> of all organisms (each normalized to the respective specific biomass) must be identical and equal the community growth rate <italic>μ</italic><sub><italic>c</italic></sub>:
<disp-formula id="pcbi.1006759.e012">
<alternatives>
<graphic id="pcbi.1006759.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e012" xlink:type="simple"/>
<mml:math display="block" id="M12">
<mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula></p>
<p>This concept of <italic>balanced growth</italic> of microbial communities has previously been proposed by Khandelwal et al. (2012) and is also an underlying principle of the OptDeg [<xref ref-type="bibr" rid="pcbi.1006759.ref015">15</xref>] and the SteadyCom [<xref ref-type="bibr" rid="pcbi.1006759.ref016">16</xref>] approach. It has been argued that, even if there is no steady state in a continuous cultivation, the specific growth rates of the organisms need to be the same on average because otherwise the fastest organism would outgrow the others. With constant growth rates, also the fractional biomass abundances
<disp-formula id="pcbi.1006759.e013">
<alternatives>
<graphic id="pcbi.1006759.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e013" xlink:type="simple"/>
<mml:math display="block" id="M13">
<mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">BM</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">BM</mml:mi></mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula>
of each species <italic>i</italic> in the community biomass BM<sub><italic>c</italic></sub> must be constant. The fractions <italic>F</italic><sub><italic>i</italic></sub> define the community composition <bold>F</bold> = (<italic>F</italic><sub>1</sub>,…,<italic>F</italic><sub><italic>n</italic></sub>) and sum up to unity:
<disp-formula id="pcbi.1006759.e014">
<alternatives>
<graphic id="pcbi.1006759.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e014" xlink:type="simple"/>
<mml:math display="block" id="M14">
<mml:mrow><mml:msubsup><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula></p>
<p>With balanced growth, the fraction <italic>F</italic><sub><italic>i</italic></sub> of species <italic>i</italic> is given by the ratio of the specific biomass production rate of species <italic>i</italic> (normalized to the community biomass) and the community growth rate:
<disp-formula id="pcbi.1006759.e015">
<alternatives>
<graphic id="pcbi.1006759.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e015" xlink:type="simple"/>
<mml:math display="block" id="M15">
<mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">BM</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">BM</mml:mi></mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(12))</label>
</disp-formula></p>
<p>Note that the fractional contributions to the synthesis of the community biomass (<inline-formula id="pcbi.1006759.e016"><alternatives><graphic id="pcbi.1006759.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>→</mml:mo><mml:mi>B</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>; normalized to BM<sub><italic>c</italic></sub>) are not identical over the species, hence, the <inline-formula id="pcbi.1006759.e017"><alternatives><graphic id="pcbi.1006759.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> need not fulfill (9). However, for the specific growth rates <italic>μ</italic><sub><italic>i</italic></sub> (referring to BM<sub><italic>i</italic></sub>) it holds that <inline-formula id="pcbi.1006759.e018"><alternatives><graphic id="pcbi.1006759.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and thus (9) is indeed satisfied. For each species, we can rewrite (12) to the following constraint:
<disp-formula id="pcbi.1006759.e019">
<alternatives>
<graphic id="pcbi.1006759.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e019" xlink:type="simple"/>
<mml:math display="block" id="M19">
<mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula></p>
<p>(Alternatively we could also use <inline-formula id="pcbi.1006759.e020"><alternatives><graphic id="pcbi.1006759.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> instead of <inline-formula id="pcbi.1006759.e021"><alternatives><graphic id="pcbi.1006759.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>→</mml:mo><mml:mi>B</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> in this equation). In the optimization problems considered below, constraints of type (13) need to be included only for <italic>n</italic>−1 species, because (6), (7), and (11) already imply (13) for the <italic>n</italic>-th species: <inline-formula id="pcbi.1006759.e022"><alternatives><graphic id="pcbi.1006759.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>→</mml:mo><mml:mi>B</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>→</mml:mo><mml:mi>B</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>.</p>
<p>Due to the re-normalization of the reaction rates from specific to community biomass, as the last step in assembling the community model we also need to adjust the normalization of the original flux bounds (3) and other inhomogeneous conditions (4) by multiplying them with the fractional abundances:
<disp-formula id="pcbi.1006759.e023">
<alternatives>
<graphic id="pcbi.1006759.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e023" xlink:type="simple"/>
<mml:math display="block" id="M23">
<mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula>
where <italic>α</italic><sub><italic>ij</italic></sub> and <italic>β</italic><sub><italic>ij</italic></sub> are the lower and upper bounds for reaction <italic>j</italic> in organism <italic>i</italic> and <inline-formula id="pcbi.1006759.e024"><alternatives><graphic id="pcbi.1006759.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is the reaction rate of reaction <italic>j</italic> in organism <italic>i</italic> in the community model. Likewise, constraints (4) are adjusted for each organism to
<disp-formula id="pcbi.1006759.e025">
<alternatives>
<graphic id="pcbi.1006759.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e025" xlink:type="simple"/>
<mml:math display="block" id="M25">
<mml:mrow><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:msubsup><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula></p>
<p>(<bold>A<sub><italic>i</italic></sub></bold>, <bold>b</bold><sub><italic>i</italic></sub> correspond to the respective variables in (4) for species <italic>i</italic>). The irreversibility constraints for the reaction rates are kept from the single-species models:
<disp-formula id="pcbi.1006759.e026">
<alternatives>
<graphic id="pcbi.1006759.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e026" xlink:type="simple"/>
<mml:math display="block" id="M26">
<mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">for</mml:mi><mml:mspace width="0.25em"/><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula></p>
<p>To exclude solutions with non-zero fluxes <inline-formula id="pcbi.1006759.e027"><alternatives><graphic id="pcbi.1006759.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:math></alternatives></inline-formula> in organisms that are not present in the community (<italic>F</italic><sub><italic>i</italic></sub> = 0), we assume that every flux in species <italic>i</italic> is bounded (i.e., <italic>α</italic><sub><italic>ij</italic></sub> and <italic>β</italic><sub><italic>ij</italic></sub> are bounded). With (14), a non-zero flux <inline-formula id="pcbi.1006759.e028"><alternatives><graphic id="pcbi.1006759.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> then implies <italic>F</italic><sub><italic>i</italic></sub>&gt;0. In principle, with the chosen constraints, one can also consider the case where the community is not growing (<italic>μ</italic><sub><italic>c</italic></sub> = 0), i.e., where dependencies arise exclusively from the maintenance metabolism of the participating species. However, if the community is growing (<italic>μ</italic><sub><italic>c</italic></sub>&gt;0), a non-zero flux <inline-formula id="pcbi.1006759.e029"><alternatives><graphic id="pcbi.1006759.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:math></alternatives></inline-formula> in species <italic>i</italic> implies again <italic>F</italic><sub><italic>i</italic></sub>&gt;0 and, due to (13), then also <inline-formula id="pcbi.1006759.e030"><alternatives><graphic id="pcbi.1006759.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>→</mml:mo><mml:mi>B</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:math></alternatives></inline-formula>.</p>
<p>In analogy to classical flux balance analysis (FBA) in single organisms, we may formulate a (linear) objective function maximizing certain (combinations of) reaction rates in the community model:
<disp-formula id="pcbi.1006759.e031">
<alternatives>
<graphic id="pcbi.1006759.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e031" xlink:type="simple"/>
<mml:math display="block" id="M31">
<mml:mtable><mml:mtr><mml:mtd><mml:mi>M</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:msup><mml:mi mathvariant="bold">c</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi mathvariant="bold">r</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mn>8</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>13</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>16</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(17)</label>
</disp-formula></p>
<p>Due to the multiplication of (independent) variables in constraints (13), the community model and the associated optimization problem become bilinear. While non-linear solvers can be employed to solve the optimization problem (e.g., to search for maximum community growth rates or to scan feasible ranges of fluxes or community compositions; see below), a linearization can be applied to enable application of standard linear programming solvers and methods routinely used in (linear) constraint-based modeling.</p>
</sec>
<sec id="sec005">
<title>Linearization of the community model</title>
<p>Two approaches have been used to linearize bilinear community models and to simplify its analysis (<xref ref-type="fig" rid="pcbi.1006759.g002">Fig 2</xref>). In the first approach (utilized in SteadyCom [<xref ref-type="bibr" rid="pcbi.1006759.ref016">16</xref>]), the community growth rate <italic>μ</italic><sub><italic>c</italic></sub> is fixed to a constant (known) value. The constraints (13) become then linear and the optimization problem (17) thus treatable with standard linear programming (LP) solvers. Linearization by fixing the community growth rate is useful, for example, to analyze which community compositions are feasible for a given community growth rate. Repeating these analyses (in discrete steps) for the feasible range of community growth rates yields a more complete picture of the whole solution space.</p>
<fig id="pcbi.1006759.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006759.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Workflow of constructing three different types of community models considered in this study.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.g002" xlink:type="simple"/>
</fig>
<p>An alternative linearization method was used in community FBA [<xref ref-type="bibr" rid="pcbi.1006759.ref011">11</xref>] and in the OptDeg approach [<xref ref-type="bibr" rid="pcbi.1006759.ref015">15</xref>]. Here, instead of the community growth rate, the community composition, i.e. all the fractional abundances <italic>F</italic><sub><italic>i</italic></sub>, are fixed. Eq (<xref ref-type="disp-formula" rid="pcbi.1006759.e019">13</xref>) becomes then again linear allowing the utilization of LP solvers. With given fractional abundances, constraint (11) can be removed from the optimization problem (17).</p>
<p>This second linearization approach is useful to scan, for example, the feasible community flux space for a given community composition. However, with a growing number of organisms, this scanning becomes very expensive in terms of the number of linear programs to be solved [<xref ref-type="bibr" rid="pcbi.1006759.ref016">16</xref>]. In this study, we therefore linearize community models by fixing <italic>μ</italic><sub><italic>c</italic></sub> as proposed in the SteadyCom approach. We used an iterative approach to find the maximum community growth rate <italic>μ</italic><sub><italic>c</italic>,<italic>max</italic></sub> in these linearized models. First, we set <italic>μ</italic><sub><italic>c</italic></sub> to a value of 0.005 h<sup>-1</sup>. If a feasible flux distribution exists (here, any (including a zero) objective function can be used in Eq (<xref ref-type="disp-formula" rid="pcbi.1006759.e031">17</xref>)), we double <italic>μ</italic><sub><italic>c</italic></sub> and check again for a feasible flux distribution. We repeat these steps until no feasible flux distribution is found. We then take the average of this <italic>μ</italic><sub><italic>c</italic></sub> and the last feasible <italic>μ</italic><sub><italic>c</italic></sub> (or zero if the first <italic>μ</italic><sub><italic>c</italic></sub> did not yield a flux distribution). These steps are repeated (check for feasibility, use average of latest feasible and infeasible <italic>μ</italic><sub><italic>c</italic></sub> as new constraint and check again for feasibility) until the difference between the last feasible and infeasible <italic>μ</italic><sub><italic>c</italic></sub> is smaller than 0.00001 h<sup>-1</sup>.</p>
<p>Generally, for both linearization variants, apart from the FBA-like optimization in (17), other constraint-based methods like flux variability analysis (FVA) or metabolic pathway analysis based on elementary flux modes or elementary flux vectors can be carried out (see below).</p>
</sec>
<sec id="sec006">
<title>Species-level optimality in the community models</title>
<p>The described approaches for modeling communities under balanced growth can be used to define and analyze community solution spaces. However, these solution spaces often include unrealistic solutions on the species-level (e.g., a species synthesizes, without any benefit for its own growth, products required by another species in the community [<xref ref-type="bibr" rid="pcbi.1006759.ref015">15</xref>]). Consequently, the predicted ranges for community compositions or growth rates may become very large as they include many non-relevant phenotypes. FBA could be used to find community compositions fulfilling certain optimality criteria, but the question of suitable objective function in communities arises. In single-species models, a typical objective function is maximization of the growth rate. In community models we can also maximize the community growth rate [<xref ref-type="bibr" rid="pcbi.1006759.ref011">11</xref>]. But, again, even these optimal solutions may represent unrealistic community compositions in which some organisms waste substrate to ensure survival of the others [<xref ref-type="bibr" rid="pcbi.1006759.ref015">15</xref>]. We therefore proposed previously an optimization approach to minimize a weighted sum of substrate uptake rates to find community compositions in which all organisms grow with their maximum biomass yields [<xref ref-type="bibr" rid="pcbi.1006759.ref015">15</xref>]. This approach enabled us to narrow down the solution space to community compositions in which all organisms grow optimally with their maximum biomass yields at a given community growth rate. When introducing our model reduction approach below, we will use a similar method to exclude unrealistic community flux distributions.</p>
</sec>
<sec id="sec007">
<title>Elementary flux modes and elementary flux vectors</title>
<p>Elementary flux modes (EFMs) are non-decomposable flux vectors fulfilling Eqs (<xref ref-type="disp-formula" rid="pcbi.1006759.e001">1</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1006759.e002">2</xref>) [<xref ref-type="bibr" rid="pcbi.1006759.ref024">24</xref>]. EFMs represent balanced pathways or cycles and have become an important tool for exploring metabolic networks [<xref ref-type="bibr" rid="pcbi.1006759.ref020">20</xref>,<xref ref-type="bibr" rid="pcbi.1006759.ref025">25</xref>–<xref ref-type="bibr" rid="pcbi.1006759.ref028">28</xref>]. However, one shortcoming of EFMs is that inhomogeneous constraints (Eqs (<xref ref-type="disp-formula" rid="pcbi.1006759.e003">3</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1006759.e004">4</xref>) in the single-species models and (14) and (15) in the community model), such as non-growth associated ATP maintenance demand and substrate-uptake limits, cannot be considered. We therefore make use of the concept of elementary flux vectors (EFVs), a generalization of EFMs which can account for inhomogeneous constraints [<xref ref-type="bibr" rid="pcbi.1006759.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1006759.ref020">20</xref>]. From the theory of EFVs, it is known that the flux polyhedron <bold>P</bold> resulting from a set of linear constraints is generated by convex combinations of bounded EFVs <bold>p</bold><sup><italic>k</italic></sup> and conic linear combinations of unbounded EFVs <bold>x</bold><sup><italic>i</italic></sup> and <bold>y</bold><sup><italic>j</italic></sup>:
<disp-formula id="pcbi.1006759.e032">
<alternatives>
<graphic id="pcbi.1006759.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e032" xlink:type="simple"/>
<mml:math display="block" id="M32">
<mml:mrow><mml:mi mathvariant="bold">P</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>ℜ</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mi mathvariant="bold">r</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msup><mml:mi mathvariant="bold">p</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msup><mml:mi mathvariant="bold">y</mml:mi><mml:mi>j</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(18)</label>
</disp-formula></p>
<p>Due to combinatorial explosion, EFVs can usually only be calculated in medium-scale metabolic networks and, thus, only in smaller community models combining the central metabolism of two or three species.</p>
</sec>
<sec id="sec008">
<title>RedCom: Building reduced community models with balanced growth from net conversions</title>
<p>We present RedCom, a new method to generate community models of reduced size and with reduced solution spaces excluding unrealistic community behaviors. The main idea of the reduction approach, which has some similarities with but is not identical to an approach presented by Taffs et al. [<xref ref-type="bibr" rid="pcbi.1006759.ref010">10</xref>], is to describe the metabolism of each organism by certain net conversions taken from the EFVs of the single-species models (<xref ref-type="fig" rid="pcbi.1006759.g002">Fig 2</xref>). Since we are mainly interested in community compositions and metabolic interactions (exchange reactions) between the community members, it is often sufficient to focus only on net conversions of the respective species instead of taking its whole metabolic reaction network explicitly into account. Furthermore, from the list of all net conversions of a species we select only those that obey certain optimality criteria avoiding unrealistic phenotypes in the community model. The selected net conversions are used as reactions in the reduced community model to be built. The construction of reduced community models with the RedCom approach is described in the following, a detailed example is given in <xref ref-type="supplementary-material" rid="pcbi.1006759.s001">S1 Text</xref> in the Supplements.</p>
<sec id="sec009">
<title>Computation of EFVs</title>
<p>For obtaining the reduced community model, the (community) growth rate <italic>μ</italic><sub><italic>c</italic></sub> is fixed to a particular (e.g., measured) value <italic>μ</italic><sub><italic>c</italic>,<italic>fix</italic></sub> and the growth rate in the single-species models is then also set to this value: <italic>μ</italic><sub><italic>i</italic></sub> = <italic>μ</italic><sub><italic>c</italic>,<italic>fix</italic></sub>. Afterwards, all bounded and unbounded EFVs are calculated for each single-species network. Apart from the fixed community growth rate, other frequently used inhomogeneous constraints are (known) upper bounds for substrate uptake and product formation rates as well as a lower bound for the rate of the ATP consuming pseudo reaction reflecting the maintenance coefficient (<italic>r</italic><sub><italic>ATPmaint</italic></sub>; <xref ref-type="table" rid="pcbi.1006759.t001">Table 1</xref>). We can assume that all thermodynamically feasible solutions involve substrate uptake (internal cycles are discarded) and that substrate uptake is bounded by some upper limit. Therefore, we only need to consider bounded EFVs (<bold>p</bold><sup><italic>k</italic></sup> in Eq (<xref ref-type="disp-formula" rid="pcbi.1006759.e032">18</xref>)) in our approach.</p>
<table-wrap id="pcbi.1006759.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006759.t001</object-id>
<label>Table 1</label> <caption><title>Overview of the single-species models with model dimensions and constraints used for the community model. The last three columns indicate which models were used to build the three-, six- and nine-species community models.</title></caption>
<alternatives>
<graphic id="pcbi.1006759.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="justify">Organism</th>
<th align="left"># internal metabolites × #reactions</th>
<th align="justify">Constraints [mmol/gDW/h]</th>
<th align="justify">Number of EFVs (for<break/><italic>μ</italic><sub><italic>c</italic></sub> = 0.008 h<sup>-1</sup>)</th>
<th align="justify">Three-species model</th>
<th align="justify">Six-species model</th>
<th align="justify">Nine-species model</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><italic>Escherichia coli</italic> (EC)</td>
<td align="left">99 x 117<break/>Substrates: O<sub>2</sub>, Glyc, Glucn, Glc, CO<sub>2</sub><break/>Products: CO<sub>2</sub>, Succ, Lac, Eth, Ac, Form</td>
<td align="left">r<sub>ATPmaint</sub>≥3.15<break/>r<sub>Glcup</sub>≤18.5<break/>r<sub>Glycup</sub> = 0<break/>r<sub>Glucup</sub> = 0<break/>r<sub>O2up</sub> = 0</td>
<td align="left">60653</td>
<td align="left"/>
<td align="left"/>
<td align="left">x</td>
</tr>
<tr>
<td align="left"><italic>Acetobacterium woodii</italic> (AW)</td>
<td align="left">107 x 116<break/>Substrates: Glc, H<sub>2</sub>, Eth, CO<sub>2</sub>, Lac, Fruc, Form, MeOH<break/>Products: Ac, CO<sub>2</sub></td>
<td align="left">r<sub>ATPmaint</sub>≥0.29<break/>r<sub>Glcup</sub>≤2.75<break/>r<sub>Frucup</sub> = 0<break/>r<sub>Lacup</sub>≤3<break/>r<sub>Ethup</sub>≤9<break/>r<sub>MeOHup</sub> = 0<break/>r<sub>H2up</sub>≤19.5<break/>r<sub>Formup</sub>≤19.5<break/>μ≤0.162</td>
<td align="left">4582</td>
<td align="left"/>
<td align="left">x</td>
<td align="left">x</td>
</tr>
<tr>
<td align="left"><italic>Propionibacterium freudenreichii</italic> (PF)</td>
<td align="left">105 x 111<break/>Substrates: Lac, Eth, Glc, CO<sub>2</sub><break/>Products: Prop, Ac, Succ, CO<sub>2</sub></td>
<td align="left">r<sub>ATPmaint</sub>≥0.76<break/>r<sub>Glcup</sub>≤4<break/>r<sub>lacup</sub>≤11<break/>r<sub>EthOHup</sub>≤11<break/>μ≤0.16</td>
<td align="left">23878</td>
<td align="left"/>
<td align="left">x</td>
<td align="left">x</td>
</tr>
<tr>
<td align="left"><italic>Clostridium acetobutylicum</italic> (CA)</td>
<td align="left">111 x 123<break/>Substrates: Glc, Glyc, Ac, Buty<break/>Products: Lac, Eth, Buty, Butol, Ac, Acon, Form, CO<sub>2</sub>, H<sub>2</sub></td>
<td align="left">r<sub>ATPmaint</sub>≥1<break/>r<sub>Glcup</sub>≤12.75<break/>r<sub>Glyc_up</sub> = 0<break/>r<sub>Acon</sub>ex = 0<break/>r<sub>Buolex</sub> = 0</td>
<td align="left">1596</td>
<td align="left"/>
<td align="left"/>
<td align="left">x</td>
</tr>
<tr>
<td align="left"><italic>Syntrophobacter fumaroxidans</italic> (SF)</td>
<td align="left">104 x 114<break/>Substrates: Prop, Fum SO<sub>4</sub><break/>Products: Ac, Form, Succ, CO<sub>2</sub>, H<sub>2</sub>, H<sub>2</sub>S</td>
<td align="left">r<sub>ATPmaint</sub>≥0.14<break/>r<sub>Propup</sub>≤1.6<break/>r<sub>Fumup</sub>≤0.5<break/>r<sub>SO4up</sub> = 0</td>
<td align="left">39932</td>
<td align="left"/>
<td align="left">x</td>
<td align="left">x</td>
</tr>
<tr>
<td align="left"><italic>Syntrophomonas wolfei</italic> (SW)</td>
<td align="left">110 x 114<break/>Substrates: Buty, Crot<break/>Products: Buty, Ac, H<sub>2</sub>, Form, CO<sub>2</sub></td>
<td align="left">r<sub>ATPmaint</sub>≥0.14<break/>r<sub>Butup</sub>≤4.25<break/>r<sub>Crotup</sub>≤2.85</td>
<td align="left">443</td>
<td align="left"/>
<td align="left"/>
<td align="left">x</td>
</tr>
<tr>
<td align="left"><italic>Desulfovibrio vulgaris</italic> (DV)</td>
<td align="left">99 x 115<break/>Substrates: Pyr, Lac, Eth, Ac, CO<sub>2</sub>, H<sub>2</sub>, SO<sub>4</sub><break/>Products: Ac, Form, CO<sub>2</sub>, H<sub>2</sub>, H<sub>2</sub>S</td>
<td align="left">r<sub>ATPmaint</sub>≥4.3<break/>r<sub>Acex</sub>≤50<break/>r<sub>SO4up</sub> = 0</td>
<td align="left">840</td>
<td align="left">x</td>
<td align="left">x</td>
<td align="left">x</td>
</tr>
<tr>
<td align="left"><italic>Methanosarcina barkeri</italic> (MB)</td>
<td align="left">96 x 103<break/>Substrates: Ac, MeOH, H<sub>2</sub>, CO<sub>2</sub><break/>Products: CH<sub>4</sub>, CO<sub>2</sub></td>
<td align="left">r<sub>ATPmaint</sub>≥2.5<break/>r<sub>CH4ex</sub>≤15</td>
<td align="left">35</td>
<td align="left">x</td>
<td align="left">x</td>
<td align="left">x</td>
</tr>
<tr>
<td align="left"><italic>Methanospirillum hungatei</italic> (MH)</td>
<td align="left">95 x 102<break/>Substrates: H<sub>2</sub>, CO<sub>2</sub>, Form<break/>Products: CH<sub>4</sub>, CO<sub>2</sub></td>
<td align="left">r<sub>ATPmaint</sub>≥0.9<break/>r<sub>CH4ex</sub>≤15<break/></td>
<td align="left">23</td>
<td align="left">x</td>
<td align="left">x</td>
<td align="left">x</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec010">
<title>Selecting EFVs with minimal conversions</title>
<p>In a next step, for each organism, we select the EFVs, which we consider as relevant (realistic) “phenotypes”. Criteria for EFV selection can be adjusted as needed. Herein, we select EFVs with minimal (parsimonious) exchange fluxes and discard solutions, which lead to inefficient substrate conversion (e.g. with low biomass or/and ATP yields) and may result in unrealistic altruistic behavior of an organism in a given community. For this purpose, we project each EFV <bold>e</bold> to its (<italic>q</italic>) exchange reactions including the growth rate: <inline-formula id="pcbi.1006759.e033"><alternatives><graphic id="pcbi.1006759.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mi mathvariant="bold">e</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Next, to avoid redundancies, for EFVs with identical projection on the exchange reactions, we keep only one candidate. Assume now we have, for a given species, <italic>s</italic> non-redundant (projected) EFVs. We discard an EFV <bold>e</bold><sup><italic>k</italic></sup> if there exists a convex combination <bold>w</bold> of other projected EFVs in which all rates of the exchange reactions are smaller than or equal to the ones in <bold>e</bold><sup><italic>k</italic></sup>. This condition is fulfilled (and <bold>e</bold><sup><italic>k</italic></sup> removed) if a solution <bold>w</bold> exists for the following system:
<disp-formula id="pcbi.1006759.e034">
<alternatives>
<graphic id="pcbi.1006759.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e034" xlink:type="simple"/>
<mml:math display="block" id="M34">
<mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi mathvariant="bold">E</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mi mathvariant="bold">w</mml:mi><mml:mo>≤</mml:mo><mml:msup><mml:mi mathvariant="bold">e</mml:mi><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⋯</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="bold">w</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold">w</mml:mi><mml:mo>≥</mml:mo><mml:mn mathvariant="bold">0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(19)</label>
</disp-formula>
with <bold>E</bold>* = [<bold>e</bold><sup>1</sup>…<bold>e</bold><sup><italic>k</italic>−1</sup> <bold>e</bold><sup>k+1</sup>…<bold>e</bold><sup><italic>s</italic></sup>]. Note that the combination of the EFVs must be convex (second row in (19)) to ensure that the predefined growth rate and other inhomogeneous constraints are met. We thus only keep EFVs whose total turnover of at least one of the external metabolites is smaller compared to a convex combination of the other EFVs (recall that redundant projected EFV had been discarded before). In particular, this criterion ensures that, for a given combination of substrate(s) and product(s), only biomass-yield optimal EFVs will be kept. If there are, for a given substrate, different potential products, then at least one EFV will be kept for each product, even if it is biomass-yield suboptimal compared to another product. The reason is as follows: in some cases, accumulation of certain products in the medium can inhibit growth and result in a shift to another pathway. With the approach described above, we keep these options in the model to retain a certain metabolic flexibility. We save the retained EFVs in Matrix <bold>E</bold> (each row in <bold>E</bold> represents one selected projected EFV).</p>
</sec>
<sec id="sec011">
<title>Net conversions from EFVs and reduced single-species model</title>
<p>Next, we calculate the stoichiometric matrix <bold>N</bold><sup>red</sup> of the reduced (single-species) network:
<disp-formula id="pcbi.1006759.e035">
<alternatives>
<graphic id="pcbi.1006759.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006759.e035" xlink:type="simple"/>
<mml:math display="block" id="M35">
<mml:msup><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">X</mml:mi></mml:mrow></mml:msup><mml:mo>∙</mml:mo><mml:mi mathvariant="bold">E</mml:mi><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
</disp-formula></p>
<p>(<bold>N</bold><sup>EX</sup> is the sub-matrix of <bold>N</bold> containing the columns and rows corresponding to the exchange reactions and external metabolites.) Hence, the net conversions (in terms of external metabolites) of the selected EFVs become now reactions (columns in <bold>N</bold><sup>red</sup>) in the reduced model. The reversibility of a reaction in <bold>N</bold><sup>red</sup> depends on the reversibility of the respective EFV from which it was derived. Since the EFVs represent net conversions of substrates to products and biomass, the reactions are normally all irreversible.</p>
</sec>
<sec id="sec012">
<title>Constructing the community model</title>
<p>We repeat these steps for all <italic>n</italic> organisms of the community. Afterwards we proceed as described earlier to construct the (reduced) community model from the (reduced) single-species models. By their nature, each reduced species network consists only of exchange metabolites and (overall) reactions converting them. Therefore, effectively only two compartments need to be considered in the community model: the exchange compartment and the medium (see <xref ref-type="fig" rid="pcbi.1006759.g002">Fig 2</xref>). However, each reaction is associated with exactly one of the species. Exchange metabolites occurring in several species are again combined such that they only exist once in the community model. All exchange metabolites, that are not allowed to accumulate in the medium, must fulfill the mass balance Eq (<xref ref-type="disp-formula" rid="pcbi.1006759.e011">8</xref>) and the community growth rate is fixed to the value used in the reduced single-species models (<italic>μ</italic><sub><italic>c</italic></sub> = <italic>μ</italic><sub><italic>c</italic>,<italic>fix</italic></sub>) by which the reduced community model becomes linear. Importantly, no other inhomogeneous constraints need to be considered; all flux bounds (and other constraints) from the original single-species models are automatically fulfilled in the reduced community model as long as <italic>μ</italic><sub><italic>c</italic></sub>&gt;0 (see <xref ref-type="supplementary-material" rid="pcbi.1006759.s002">S2 Text</xref> in the Supplements). <xref ref-type="supplementary-material" rid="pcbi.1006759.s001">S1 Text</xref> in the Supplements illustrates the construction of a reduced community model for an example community and also explains how the special case of <italic>μ</italic><sub><italic>c</italic></sub> = 0 can be treated by a minor modification of the reduced community model.</p>
<p>The linear reduced community model can be explored with standard analysis methods of constraint-based modeling. In particular, the feasible community compositions <bold>F</bold> can be determined and studied. Furthermore, “community EFVs” can be computed and analyzed (which should not be confused with the EFVs computed in the original single-species models to construct the reduced single-species models).</p>
</sec>
</sec>
<sec id="sec013">
<title>Calculations</title>
<p>All models presented in the Results section were implemented and analyzed with <italic>CellNetAnalyzer</italic> version 2018.1, a MATLAB package for structural and functional analysis of metabolic and signaling networks [<xref ref-type="bibr" rid="pcbi.1006759.ref029">29</xref>,<xref ref-type="bibr" rid="pcbi.1006759.ref030">30</xref>]. CPLEX was used as a solver for linear optimizations and <italic>efmtool</italic> for computation of EFVs. For solving bilinear problems, we used the <italic>fmincon</italic> solver for nonlinear optimization in MATLAB. The solver needs an initial flux distribution that we retrieved from the linearized model.</p>
</sec>
<sec id="sec014">
<title>Data from laboratory-scale biogas reactor on glucose-cellulose medium</title>
<p>Experimental data from a laboratory-scale biogas reactor on a defined glucose-cellulose medium were published earlier [<xref ref-type="bibr" rid="pcbi.1006759.ref031">31</xref>] and used for a comparison with predictions from the nine-species biogas producing community (see <xref ref-type="sec" rid="sec016">Results</xref>). The data were taken from steady-state conditions [<xref ref-type="bibr" rid="pcbi.1006759.ref031">31</xref>]. We calculated the average methane and CO<sub>2</sub> production rates over a course of 100 days. To achieve steady-state conditions, the reactors were operated under similar conditions for 190 days prior to this time period. Additionally to the data already published, we estimated biomass dry weights by measuring protein concentrations with the Lowry Assay [<xref ref-type="bibr" rid="pcbi.1006759.ref032">32</xref>] and dividing them by the factor 0.64 (assumed fraction of protein of the total biomass in the model). We used these data to calculate specific production and consumption rates for comparison with simulation results.</p>
</sec>
<sec id="sec015">
<title>Continuous enrichment cultures on ethanol</title>
<p>A detailed description of the procedures applied for inoculation, feeding, and sample analyses along with cultivation setup and parameters is given in the <xref ref-type="supplementary-material" rid="pcbi.1006759.s006">S6 Text</xref>. Briefly, two 1.5 L bioreactor systems were inoculated with sludge from the aforementioned enrichment and fed with the same medium containing 14.6% (v/v) ethanol as main carbon source instead of glucose and cellulose. After an adaption period, continuous cultivation mode was initiated using constant feeding rates and volume control. In the following, different dilution rates were sampled at steady-state conditions, starting from 5.3∙10<sup>−4</sup> h<sup>-1</sup> further increasing until the biogas production collapsed. Sampling and subsequent analyses comprised pH, biomass protein content, biogas composition and biogas volume produced. In addition, samples were analyzed for residual ethanol and accumulated organic acids. Finally, taxonomic analysis was carried out using an established MS-based metaproteomic workflow (see <xref ref-type="supplementary-material" rid="pcbi.1006759.s008">S8 Text</xref>).</p>
</sec>
</sec>
<sec id="sec016" sec-type="results">
<title>Results</title>
<p>In the following, we first describe the construction of metabolic models of nine organisms capturing major degradation steps in the biogas process. Subsequently we combine these single-species models to community models of increasing complexity containing three, six, and nine strains. For each considered community, we construct, analyze and compare three different types of models (bilinear model, linearized full model, reduced model obtained with RedCom) as described in the Methods section. For the six- and nine-species communities, we compare model predictions with experimental data.</p>
<sec id="sec017">
<title>Model organisms</title>
<p>Using KEGG [<xref ref-type="bibr" rid="pcbi.1006759.ref033">33</xref>] and MetaCyc [<xref ref-type="bibr" rid="pcbi.1006759.ref034">34</xref>] as well as various literature references we manually constructed single-species models of the central metabolism of nine different organisms all being relevant for the biogas process: four primary fermenting bacteria (<italic>Acetobacterium woodii</italic>, <italic>Escherichica coli</italic>, <italic>Clostridium acetobutylicum</italic>, <italic>Propionibacterium freudenreichii</italic>), three secondary fermenting bacteria (<italic>Syntrophomonas wolfei</italic>, <italic>Syntrophobacter fumaroxidans</italic>, <italic>Desulfovibrio vulgaris</italic>) and two methanogenic archaea (<italic>Methanospirillum hungatei</italic> and <italic>Methanosarcina barkeri)</italic>. As suggested by Taffs et al. [<xref ref-type="bibr" rid="pcbi.1006759.ref010">10</xref>], we consider each of these organisms as one functional guild in the biogas process with certain metabolic properties. More specifically, under anaerobic conditions, <italic>E</italic>. <italic>coli</italic> produces ethanol as well as different organic acids like formate, lactate, acetate and succinate from glucose, glycerol and gluconate. <italic>A</italic>. <italic>woodii</italic> is an homoacetogenic organism that can either ferment sugars like glucose and fructose but also lactate, formate or hydrogen and CO<sub>2</sub> to produce acetate via the Wood-Ljungdahl pathway [<xref ref-type="bibr" rid="pcbi.1006759.ref035">35</xref>,<xref ref-type="bibr" rid="pcbi.1006759.ref036">36</xref>]. <italic>P</italic>. <italic>freudenreichii</italic> can ferment glucose, glycerol and lactate to succinate and propionate. The organism uses the methyl-malonyl-CoA pathway to produce propionate. Some organisms using the methyl-malonyl-CoA pathway like <italic>Pelobacter propionicus</italic> are also capable of using ethanol as a substrate [<xref ref-type="bibr" rid="pcbi.1006759.ref037">37</xref>]. Since we aimed to represent the functional guild of propionate producing bacteria using the methyl-malonyl-CoA pathway, we also added ethanol oxidation to propionate to the model. <italic>C</italic>. <italic>acetobutylicum</italic> ferments glucose and glycerol to different organic acids and solvents like acetate, butyrate, ethanol, butanol and aceton. The organism is known to grow in two different phases [<xref ref-type="bibr" rid="pcbi.1006759.ref038">38</xref>]. In the first phase, the organism produces organic acids like acetate and butyrate. These pathways have high ATP yields but the acids produced lower the pH in the medium. In the second phase, acids are taken up and solvents like butanol and aceton are the main product. <italic>C</italic>. <italic>acetobutylicum</italic> represents primary fermenting bacteria in our community model and we assumed that mainly production of formate, acetate, butyrate and ethanol is relevant in anaerobic digestion. We therefore disabled production of the other solvents in the community model. <italic>D</italic>. <italic>vulgaris</italic> is a sulfate-reducing bacterium that can grow on organic substrates like pyruvate, lactate and ethanol using sulfate or thiosulfate as an electron acceptor. In the absence of electron acceptors, the organism can also grow in syntrophic associations with hydrogen utilizing organisms. The products formed by <italic>D</italic>. <italic>vulgaris</italic> are either acetate and hydrogen plus CO<sub>2</sub> or formate (in syntrophic cultures) or acetate plus hydrogen sulfide (when sulfate is present). Additionally, the organism can utilize hydrogen with acetate as a carbon source and sulfate as an electron acceptor. <italic>S</italic>. <italic>fumaroxidans</italic> can grow on propionate in syntrophy or with sulfate as an electron acceptor [<xref ref-type="bibr" rid="pcbi.1006759.ref039">39</xref>]. In pure culture the organism can grow on fumarate, fumarate plus propionate or succinate, formate or hydrogen plus sulfate [<xref ref-type="bibr" rid="pcbi.1006759.ref039">39</xref>]. <italic>S</italic>. <italic>wolfei</italic> is a secondary fermenting bacterium that can degrade saturated fatty acids from butyrate through octanoate either to acetate and hydrogen (even number of C-atoms) or to acetate, propionate and hydrogen (odd number off C-atoms) in syntrophic cultures [<xref ref-type="bibr" rid="pcbi.1006759.ref040">40</xref>]. Growth of <italic>S</italic>. <italic>wolfei</italic> is also possible on crotonate in monoculture [<xref ref-type="bibr" rid="pcbi.1006759.ref041">41</xref>].</p>
<p>The methanogenic organism <italic>M</italic>. <italic>hungatei</italic> (cytochrome-free) produces methane from formate or from hydrogen plus CO<sub>2</sub> while <italic>M</italic>. <italic>barkeri</italic> (possesses cytochromes) can use hydrogen plus CO<sub>2</sub>, acetate, methanol and methylamines for methanogenesis. In addition to different substrates utilized by the methanogens they also differ in ATP yields and substrate affinities. <italic>M</italic>. <italic>barkeri</italic> has higher ATP yields but lower substrate affinity for hydrogenotrophic methanogens. In our <italic>M</italic>. <italic>barkeri</italic> model we only implemented methanogenesis from acetate, methanol, and hydrogen with CO<sub>2</sub>.</p>
<p>A summary of the single-species models with model dimensions (number of metabolites and reactions) and constraints is given in <xref ref-type="table" rid="pcbi.1006759.t001">Table 1</xref>. The models of <italic>D</italic>. <italic>vulgaris</italic>, <italic>M</italic>. <italic>barkeri</italic> and <italic>M</italic>. <italic>hungatei</italic> were published before [<xref ref-type="bibr" rid="pcbi.1006759.ref015">15</xref>]. We estimated flux bounds for substrate uptake and product formation from experimental data or existing models, partially also from closely related organisms (see <xref ref-type="supplementary-material" rid="pcbi.1006759.s003">S3 Text</xref>). Maintenance coefficients (<italic>r</italic><sub><italic>ATPmaint</italic></sub>) were taken from literature data but the reported values varied by more than one order of magnitude between the different species (<xref ref-type="table" rid="pcbi.1006759.t001">Table 1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006759.s003">S3 Text</xref>). Below we will therefore carry out a sensitivity analysis to investigate the influence of the maintenance coefficients on simulation results. For model validation, we also compared model predictions with measured biomass yields reported in the literature (see <xref ref-type="supplementary-material" rid="pcbi.1006759.s004">S4 Text</xref>). All models are listed (and also provided in SBML format) in <xref ref-type="supplementary-material" rid="pcbi.1006759.s009">S1 Table</xref> in the Supplements.</p>
<p>For the simulations performed in this work, we focused on ethanol (three and six-species community) and glucose (nine-species community) as the only available substrates and switched the uptake of other substrates (glycerol, gluconate, methanol, fructose, sulfate) off to reflect the composition of media used in the experiments.</p>
</sec>
<sec id="sec018">
<title>Simulations of a three-species community</title>
<p>We investigated a three-species community model (<xref ref-type="table" rid="pcbi.1006759.t002">Table 2</xref>) consisting of <italic>D</italic>. <italic>vulgaris</italic>, <italic>M</italic>. <italic>hungatei</italic> and <italic>M</italic>. <italic>barkeri</italic>. This community can convert ethanol to methane, CO<sub>2</sub>, and acetate and thus covers the last two steps of anaerobic digestion. A similar community was experimentally investigated by Tatton et al. [<xref ref-type="bibr" rid="pcbi.1006759.ref042">42</xref>] and simulated with FBA in a previous study [<xref ref-type="bibr" rid="pcbi.1006759.ref015">15</xref>]. In analogy to the study of Tatton et al. [<xref ref-type="bibr" rid="pcbi.1006759.ref042">42</xref>], the uptake of external CO<sub>2</sub> was allowed to also include solutions in which the acetoclastic methanogen is non-essential.</p>
<table-wrap id="pcbi.1006759.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006759.t002</object-id>
<label>Table 2</label> <caption><title>Model dimensions of full and reduced community model as well as the number of computed EFVs for a chosen scenario.</title> <p>Additionally, the chosen substrate for the community is listed. EFVs could not be computed for communities with five or more species in the full linearized model. For species abbreviations see Table <bold><xref ref-type="table" rid="pcbi.1006759.t001">1</xref></bold>.</p></caption>
<alternatives>
<graphic id="pcbi.1006759.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="2">Number of organisms</th>
<th align="justify" colspan="2">#internal metabolites × #reactions</th>
<th align="justify" rowspan="2">Number of flux-bound constraints</th>
<th align="justify" colspan="2">Number of EFVs<break/>(for <italic>μ</italic><sub><italic>c</italic></sub> = 0.008 <italic>h</italic><sup>−1</sup>)</th>
<th align="justify" rowspan="2">Substrate<break/>(products)</th>
</tr>
<tr>
<th align="justify">Full model</th>
<th align="justify">Reduced model</th>
<th align="justify">Full model</th>
<th align="justify">Reduced model</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">2 (DV, MM)</td>
<td align="left">205 x 233</td>
<td align="left">13 x 24</td>
<td align="left">6</td>
<td align="left">254</td>
<td align="left">2</td>
<td align="left">Lactate (CH<sub>4</sub>,CO<sub>2</sub>,Ac)</td>
</tr>
<tr>
<td align="left">3 (+ MB)</td>
<td align="left">302 x 337</td>
<td align="left">15 x 29</td>
<td align="left">8</td>
<td align="left">13,574</td>
<td align="left">13</td>
<td align="left">Ethanol, CO<sub>2</sub> (CH<sub>4</sub>,CO<sub>2</sub>,Ac)</td>
</tr>
<tr>
<td align="left">4 (+ AW)</td>
<td align="left">411 x 454</td>
<td align="left">18 x 44</td>
<td align="left">17</td>
<td align="left">380,800</td>
<td align="left">14</td>
<td align="left">Ethanol (CH<sub>4</sub>,CO<sub>2</sub>,Ac)</td>
</tr>
<tr>
<td align="left">5 (+ PF)</td>
<td align="left">523 x 568</td>
<td align="left">25 x 80</td>
<td align="left">22</td>
<td align="left">-</td>
<td align="left">28</td>
<td align="left">Ethanol (CH<sub>4</sub>,CO<sub>2</sub>,Ac, Prop)</td>
</tr>
<tr>
<td align="left">6 (+ SF)</td>
<td align="left">628 x 684</td>
<td align="left">27 x 115</td>
<td align="left">26</td>
<td align="left">-</td>
<td align="left">172</td>
<td align="left">Ethanol (CH<sub>4</sub>,CO<sub>2</sub>,Ac, Prop)</td>
</tr>
<tr>
<td align="left">7 (+ CA)</td>
<td align="left">742 x 813</td>
<td align="left">31 x 129</td>
<td align="left">29</td>
<td align="left">-</td>
<td align="left">51,021</td>
<td align="left">Glucose (CH<sub>4</sub>,CO<sub>2</sub>,Ac, Prop, Buty)</td>
</tr>
<tr>
<td align="left">8 (+ SW)</td>
<td align="left">854 x 929</td>
<td align="left">34 x 137</td>
<td align="left">32</td>
<td align="left">-</td>
<td align="left">70,074</td>
<td align="left">Glucose (CH<sub>4</sub>,CO<sub>2</sub>,Ac, Prop, Buty, Mal)</td>
</tr>
<tr>
<td align="left">9 (+ EC)</td>
<td align="left">953 x 1,048</td>
<td align="left">35 x 158</td>
<td align="left">37</td>
<td align="left">-</td>
<td align="left">147,694</td>
<td align="left">Glucose (CH<sub>4</sub>,CO<sub>2</sub>,Ac, Prop, Buty, Mal)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<sec id="sec019">
<title>Simulations with the full (bilinear) model</title>
<p>We constructed the community model by combining the models of the three participating species in a compartmented approach (see <xref ref-type="sec" rid="sec002">Methods</xref>). Initially, neither the community composition <bold>F</bold> nor the community growth rate <italic>μ</italic><sub><italic>c</italic></sub> were fixed resulting in a bilinear community model (see <xref ref-type="sec" rid="sec002">Methods</xref>). We used this bilinear model and a non-linear solver to compute the maximum community growth rate <italic>μ</italic><sub><italic>c</italic>,<italic>max</italic></sub> of the three-species community for growth on ethanol and obtained <italic>μ</italic><sub><italic>c</italic>,<italic>max</italic></sub> = 0.052 h<sup>-1</sup>. As another important characteristic of a community model, we next computed the possible ranges of the fractional abundances (<italic>F</italic><sub><italic>i</italic></sub>), of the exchange reactions, and of the methane yield (by separately minimizing and maximizing each off these values). We considered two different scenarios (with and without allowed accumulation of acetate) and the results can be found in <xref ref-type="supplementary-material" rid="pcbi.1006759.s005">S5 Text</xref>. Generally, the bilinear model predicts broad ranges for exchange rates, community composition, and methane yield. This is not surprising given that these predictions are made for all possible growth rates (dilution rates). The bilinear models also predicts correctly that <italic>D</italic>. <italic>vulgaris</italic> is essential for the community while the methanogens are compositionally variable in the scenario with allowed acetate accumulation and <italic>M</italic>. <italic>barkeri</italic> essential in the second scenario where no acetate accumulation is allowed.</p>
</sec>
<sec id="sec020">
<title>Linearized model with fixed community growth rate</title>
<p>Next, we derived the linearized full model from the bilinear model by fixing the community growth rate (see Methods). We used an iterative approach for fast identification of the maximum community growth rate <italic>μ</italic><sub><italic>c</italic>,<italic>max</italic></sub> via a series of linear optimizations with different (fixed) <italic>μ</italic><sub><italic>c</italic></sub> (see <xref ref-type="sec" rid="sec002">Methods</xref>). The maximum community growth rate for growth on ethanol predicted with the linearized model is 0.052 h<sup>-1</sup> and thus, as expected, identical to the result retrieved with the bilinear model. We then fixed the community growth rate to four different values corresponding to 99%, 50%, 5% and 0% of <italic>μ</italic><sub><italic>c</italic>,<italic>max</italic></sub> and computed the feasible ranges of fractional abundances and exchange rates (via flux variability analysis with linear optimizations) as well as for methane yield (via linear-fractional optimization; see [<xref ref-type="bibr" rid="pcbi.1006759.ref043">43</xref>]), again, for the two scenarios with and without acetate accumulation (<xref ref-type="supplementary-material" rid="pcbi.1006759.s005">S5 Text</xref>). As expected, the predicted ranges are consistent with (lie always within the feasible ranges of) the bilinear model. Due to the fixed growth rates, the predicted ranges are significantly smaller than in the bilinear model (where ranges where computed for all feasible growth rates), however, they are partially still relatively large and thus not very conclusive, especially for exchange rates (<xref ref-type="supplementary-material" rid="pcbi.1006759.s005">S5 Text</xref>). The blue area in <xref ref-type="fig" rid="pcbi.1006759.g003">Fig 3A</xref> illustrates predicted feasible ranges for community compositions, yields and exchange rates in the full linearized model for a fixed <italic>μ</italic><sub><italic>c</italic></sub> = 0.026 h<sup>-1</sup> (corresponding to 50% of <italic>μ</italic><sub><italic>max</italic></sub>).</p>
<fig id="pcbi.1006759.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006759.g003</object-id>
<label>Fig 3</label>
<caption>
<title/>
<p><bold>Elementary flux vectors (EFVs) in the linearized full model (A) and in the reduced three-species community model (B) and their projection onto the fractional biomass abundances (C).</bold> In all cases, ethanol served as substrate, the community growth rate was fixed to <bold><italic>μ</italic></bold><sub><bold><italic>c</italic></bold></sub> = 0.0261 h<sup>-1</sup> and acetate accumulation was allowed (cases in which no acetate accumulates correspond to EFVs with r<sub>Ac</sub> = 0; compare also with <xref ref-type="supplementary-material" rid="pcbi.1006759.s005">S5 Text</xref>). In (A) and (B), the EFVs are projected onto their fractional biomass abundances (F<sub>X</sub>: fractional biomass abundance of species X), methane yields (Y<sub>CH4/Eth</sub>) and exchange rates (r<sub>Eth</sub>: ethanol uptake, r<sub>CH4</sub>: methane production, r<sub>Ac</sub>: acetate production) and are colored from red (highest methane excretion rate) via purple, orange, yellow, green, cyan, blue to black (lowest rate). The blue axes refer to biomass abundances and methane yield and the black axes to the exchange rates. The feasible ranges of compositions, exchange rates, and yields spanned by the EFVs are indicated by a blue area in (A) and (B). The 2D-plot in (C) shows the EFVs of the linearized full model (blue) and of the reduced model (red) projected onto the fractional biomass abundances of <italic>D</italic>. <italic>vulgaris</italic> (F<sub>DV</sub>) and <italic>M</italic>. <italic>hungatei</italic> (F<sub>MH</sub>)). The abundance of <italic>M</italic>. <italic>barkeri</italic> (F<sub>MB</sub>) follows from F<sub>DV</sub>+F<sub>MH</sub>+F<sub>MB</sub> = 1.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.g003" xlink:type="simple"/>
</fig>
<p>While the min/max ranges for fractional organism abundances and exchange rates can be calculated in the bilinear as well as in the linearized full model, interdependencies between these abundances are not immediately obvious. To analyze the space of possible community compositions more thoroughly, a sampling approach could be used where the <italic>F</italic><sub><italic>i</italic></sub> for one (or several) organism(s) is fixed and the influence on the remaining <italic>F</italic><sub><italic>i</italic></sub> is then investigated (see, for example, [<xref ref-type="bibr" rid="pcbi.1006759.ref015">15</xref>] and [<xref ref-type="bibr" rid="pcbi.1006759.ref016">16</xref>]). However, even in medium-scale community models, the computational costs for such a sampling approach become quickly prohibitive when sampling along the abundances of more than four or five species, even in the linearized model. Here, an analysis of elementary flux vectors (EFVs; [<xref ref-type="bibr" rid="pcbi.1006759.ref020">20</xref>]; see also <xref ref-type="sec" rid="sec002">Methods</xref>) can deliver useful insights. In the three-species linearized full model with fixed <italic>μ</italic><sub><italic>c</italic></sub> = 0.026 h<sup>-1</sup> we computed these characteristic vectors yielding 13,574 EFVs (<xref ref-type="fig" rid="pcbi.1006759.g003">Fig 3A and 3C</xref>). The resulting ranges for <bold>F</bold> are the same as obtained by linear optimization but more subtle dependencies are uncovered by the EFVs. Each EFV contains a community composition and corresponding flux rates for all reactions in the model (<xref ref-type="fig" rid="pcbi.1006759.g003">Fig 3A</xref> shows the fractional abundances and community exchange rates for all EFVs, whereas <xref ref-type="fig" rid="pcbi.1006759.g003">Fig 3C</xref> shows a projection of the EFVs onto their fractional abundances). This enables us to immediately identify and characterize community compositions and flux distributions which have high CH<sub>4</sub> production rates or yields and which reactions or pathways are essential for these solutions. In our example, <italic>M</italic>. <italic>barkeri</italic> becomes essential if acetate does not accumulate in the medium or if no external CO<sub>2</sub> is supplied (see also <xref ref-type="supplementary-material" rid="pcbi.1006759.s005">S5 Text</xref>). Additionally, all EFVs with a methane yield above 0.5 require <italic>M</italic>. <italic>barkeri</italic> and the acetoclastic methanogenesis pathway and the highest methane yield is reached with high but not with the highest abundance of <italic>M</italic>. <italic>barkeri</italic>. Acetate produced by <italic>D</italic>. <italic>vulgaris</italic> is an additional substrate for methanogenesis and <italic>M</italic>. <italic>barkeri</italic> is the only organism present in the community, which is capable of converting acetate to methane and CO<sub>2</sub>. Such relationships, which are often non-obvious especially in more complex or less studied communities, can exhaustively be analyzed with EFVs. The information retrieved via EFVs can subsequently also be used to find interventions in the community to increase product yields (e.g. removal of certain species; knockout of certain pathways etc.).</p>
</sec>
<sec id="sec021">
<title>Reduced model based on EFVs of single species models</title>
<p>Next, we constructed a reduced community model of the three-species community using our new reduction approach RedCom (see <xref ref-type="sec" rid="sec002">Methods</xref> and the example in <xref ref-type="supplementary-material" rid="pcbi.1006759.s001">S1 Text</xref> in the Supplements). RedCom is based on reduced single-species models constructed from the net conversions of EFVs that fulfill a minimality criterion in the exchange fluxes. Solutions with inefficient substrate use are discarded by this criterion which also ensures that flux vectors with suboptimal biomass yield for a given substrate and product combination are excluded avoiding solutions in the community model where a species altruistically synthesizes large amounts of products (instead of biomass) required by other species. The reduced community model is constructed for a particular <italic>μ</italic><sub><italic>c</italic></sub> and thus linear.</p>
<p>Using the iterative approach also employed in the full linearized model, we first determined the maximum community growth rate <italic>μ</italic><sub><italic>c</italic></sub> and found that it is, as expected, the same as in the bilinear and linearized full model (0.052 h<sup>-1</sup>). As for the linearized full model, we computed then the feasible ranges of species abundances, exchange reactions and methane yield for four different <italic>μ</italic><sub><italic>c</italic></sub> for each of the two considered scenarios with allowed / not allowed accumulation of acetate. (<xref ref-type="supplementary-material" rid="pcbi.1006759.s005">S5 Text</xref>). Due to the exclusion of unrealistic solutions with low biomass yields in the single-species models, the reduced model has a smaller solution space compared to the linearized full model resulting in significantly smaller predicted ranges, especially for exchange rates. This can exemplarily be seen by comparing the blue areas in <xref ref-type="fig" rid="pcbi.1006759.g003">Fig 3A and 3B</xref> showing the predicted feasible ranges in the linearized full vs. the reduced model for the fixed <italic>μ</italic><sub><italic>c</italic></sub> = 0.026 h<sup>-1</sup> (50% of <italic>μ</italic><sub><italic>c</italic>,<italic>max</italic></sub>). For a more detailed analysis of the reduced model, we also computed the EFVs in the reduced model for a given <italic>μ</italic><sub><italic>c</italic></sub> = 0.026 h<sup>-1</sup> yielding 12 EFVs, a tremendous reduction compared to 13,574 EFVs in the linearized model. The EFVs span the reduced solution space with narrower ranges especially for the exchange reactions (<xref ref-type="fig" rid="pcbi.1006759.g003">Fig 3B</xref>). In the biomass abundance diagram (<xref ref-type="fig" rid="pcbi.1006759.g003">Fig 3C</xref>), they span a smaller subset of the possible biomass compositions from the linearized model. In this region, all organisms use their substrates efficiently. In particular, solutions with larger fractions of <italic>D</italic>. <italic>vulgaris</italic> are excluded favoring solutions with a higher percentage of <italic>M</italic>. <italic>barkeri</italic>. The EFVs of the reduced model also reveal that solutions with high methane yields (green and yellow EFV in <xref ref-type="fig" rid="pcbi.1006759.g003">Fig 3B</xref>) have lower methane production rates whereas in the linearized full model solutions with high methane yields and rates exist which most likely stem from (unrealistic) substrate-wasting pathways of some organism(s) resulting in higher overall conversions.</p>
</sec>
<sec id="sec022">
<title>Computation of EFVs in larger community models</title>
<p>As emphasized before and exemplified in <xref ref-type="fig" rid="pcbi.1006759.g003">Fig 3</xref>, EFVs are very useful to analyze the solution space of community models instead of focusing only on single flux ranges or fractional abundances. However, in general, computation of EFVs becomes quickly infeasible in the linearized full version of complex community models with a larger number of species. To test the limits of both approaches, we stepwise increased the number of organisms in the community model and computed EFVs first for the full linearized and then for the reduced model (which, again, is itself constructed from the net conversions of selected EFVs of the single-species models). While the reduced model approach enables us to compute and analyze EFVs even for the nine-species model (discussed below), the computation of EFVs was not possible in linearized full models of communities with five or more organisms (<xref ref-type="table" rid="pcbi.1006759.t002">Table 2</xref>).</p>
</sec>
</sec>
<sec id="sec023">
<title>A six-species ethanol-degrading community model and comparison with experimental data</title>
<p>We extended the three-species community model to a model with six of the nine model organisms by additionally integrating <italic>A</italic>. <italic>woodii</italic>, <italic>P</italic>. <italic>freudenreichii</italic>, and <italic>S</italic>. <italic>fumaroxidans</italic> (Tables <xref ref-type="table" rid="pcbi.1006759.t001">1</xref> and <xref ref-type="table" rid="pcbi.1006759.t002">2</xref>). The three additional organisms were chosen according to their potential of being part in an ethanol-degrading community; they represent functional guilds that extend the capability of the three-species community investigated above by additional pathways for homoacetogenesis and propionate fermentation. Growth of the other (remaining) three organisms (CA, SW, EC; see <xref ref-type="table" rid="pcbi.1006759.t001">Table 1</xref>) is not supported with ethanol as substrate and they have therefore not been included yet. Note that, at this initial point, no experimental data have been used yet to adjust the composition of the community model; this will later be done when including metaproteomic data from a concrete enrichment culture.</p>
<sec id="sec024">
<title>Full bilinear model</title>
<p>In a first step, we used again the bilinear model to compute the maximum community growth rate. The solver delivered 0.0087 h<sup>-1</sup> which is significantly lower than the predicted rate in the three-species model. Since the latter is a particular solution of the six-species community (where the other three species have zero abundance) the maximum community growth rate should be at least as high as in the three-species model (in fact, the true maximum community growth rate is <italic>μ</italic><sub><italic>c</italic>,<italic>max</italic></sub> = 0.10 h<sup>−1</sup>; see below). We observed that maximizing the growth rate in the bilinear model yields different results depending on the initial flux distribution used by the solver. This is likely due to plateaus in the objective function and indicates potential problems when solving this large non-linear system. Different starting solutions (flux vectors) and/or other solvers must therefore be tested in the bilinear model to obtain predictions with high fidelity. In contrast, the predicted ranges for substrate uptake and product formation rates as well as for methane yield (<xref ref-type="supplementary-material" rid="pcbi.1006759.s007">S7 Text</xref>) appear reasonable but are rather large providing thus only some rough information about the orders of magnitude.</p>
<table-wrap id="pcbi.1006759.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006759.t003</object-id>
<label>Table 3</label> <caption><title>Feasible ranges for exchange rates, methane yields and methane to CO<sub>2</sub> ratio predicted by the linearized full model and the reduced model for the six-species community with ethanol as substrate.</title> <p>For comparison, experimental data from the enrichment culture for growth on ethanol (average of two experiments) are listed. In the simulations, <bold><italic>μ</italic></bold><sub><bold><italic>c</italic></bold></sub> was fixed to the dilution rate of the experiments (0.001 h<sup>-1</sup>) and accumulation of organic acids was switched off (according to experimental data). A table with simulation results and experimental data for other dilution rates can be found in <xref ref-type="supplementary-material" rid="pcbi.1006759.s007">S7 Text</xref>. The six species in the model are: <italic>P</italic>. <italic>freudenreichii</italic>, <italic>A</italic>. <italic>woodii</italic>, <italic>D</italic>. <italic>vulgaris</italic>, <italic>S</italic>. <italic>fumaroxidans</italic>, <italic>M</italic>. <italic>barkeri</italic> and <italic>M</italic>. <italic>hungatei</italic>.</p></caption>
<alternatives>
<graphic id="pcbi.1006759.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.t003" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="justify" rowspan="2"/>
<th align="justify" colspan="3">Exchange rates [mmol/gDW<sub>c</sub>/h]</th>
<th align="justify" colspan="2">Product yields and ratios [mol/mol]</th>
</tr>
<tr>
<th align="justify">Ethanol</th>
<th align="justify">CO<sub>2</sub></th>
<th align="justify">Methane</th>
<th align="justify">CH<sub>4</sub>:CO<sub>2</sub></th>
<th align="justify">CH<sub>4</sub>:Ethanol</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Full model</td>
<td align="left">0.21–8.35</td>
<td align="left">0.086–4.15</td>
<td align="left">0.29–12.50</td>
<td align="left">3.01–3.43</td>
<td align="left">1.40–1.50</td>
</tr>
<tr>
<td align="left">Reduced model</td>
<td align="left">0.21–1.31</td>
<td align="left">0.086–0.63</td>
<td align="left">0.30–1.94</td>
<td align="left">3.06–3.43</td>
<td align="left">1.40–1.48</td>
</tr>
<tr>
<td align="left">Experimental data</td>
<td align="left">0.59</td>
<td align="left">0.27</td>
<td align="left">0.87</td>
<td align="left">3.25</td>
<td align="left">1.48</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec025">
<title>Experimental data of enrichment cultures</title>
<p>We carried out continuous cultivation experiments with enrichment cultures grown on ethanol (see <xref ref-type="sec" rid="sec002">Methods</xref>). Exchange rates calculated from measurement data are shown in <xref ref-type="table" rid="pcbi.1006759.t003">Table 3</xref> and <xref ref-type="fig" rid="pcbi.1006759.g004">Fig 4</xref> for a dilution rate of <italic>D</italic> = <italic>μ</italic><sub><italic>c</italic></sub> = 0.001 h<sup>-1</sup> (additional data for other dilution rates are provided in <xref ref-type="supplementary-material" rid="pcbi.1006759.s007">S7 Text</xref>). To compare the experimental results with the linearized full model and the reduced model (see below) we fixed <italic>μ</italic><sub><italic>c</italic></sub> to 0.001 h<sup>-1</sup> and disabled accumulation of butyrate, propionate and acetate in the models because the concentration of these products were below the limit of quantification in the experiments.</p>
<fig id="pcbi.1006759.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006759.g004</object-id>
<label>Fig 4</label>
<caption>
<title/>
<p><bold>Predicted community compositions (F<sub>X</sub>: fractional abundance of organism X; AW: <italic>A</italic>. <italic>woodii</italic>, PF: <italic>P</italic>. <italic>freudenreichii</italic>, SF: <italic>S</italic>. <italic>wolfei</italic>, DV: <italic>D</italic>. <italic>vulgaris</italic>, MH: <italic>M</italic>. <italic>hungatei</italic>, MB: <italic>M</italic>. <italic>barkeri</italic>), methane yield (Y<sub>CH4/Eth</sub>), ratio of methane to CO<sub>2</sub> in the biogas (Y<sub>CH4/CO2</sub>), substrate uptake (r<sub>Eth</sub>) and product excretion rates (r<sub>CO2</sub>: CO<sub>2</sub> excretion, r<sub>CH4</sub>: methane excretion) of the linearized full six-species model (A) and the reduced six-species model (B) for fixed <bold><italic>μ</italic></bold><sub><bold><italic>c</italic></bold></sub> = 0.001 h<sup>-1</sup>.</bold> The blue axes refer to biomass abundances, methane yield and methane to CO<sub>2</sub> ratio whereas the black axes to the exchange rates. The ranges for the community composition in the full model were computed with flux variability analysis (FVA) (light blue area) whereas in the reduced model the EFVs were computed and plotted (solid lines) together with their convex hull (light blue area in (B)). The EFVs in (B) are colored from red (highest methane excretion rate) via orange, yellow, green, cyan and blue to black (lowest rate). In the linearized full model, we additionally minimized the ethanol uptake rate (corresponds to total biomass yield optimization), fixed the ethanol uptake rate to the computed minimum value and carried out another FVA for the remaining rates (orange area). In panel A as well as in panel B, experimental data (red circles) for a dilution rate of 0.001 h<sup>-1</sup> are plotted (average values from two reactors; see Table <bold><xref ref-type="table" rid="pcbi.1006759.t003">3</xref></bold>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec026">
<title>Linearized full six-species model</title>
<p>As already mentioned above, EFV computation was not possible in the linearized full six-species model, but the ranges of substrate uptake and product formation rates as well as maximum yields could be computed for community growth rates fixed to the respective dilution rate with linear and linear-fractional optimization, respectively (<xref ref-type="table" rid="pcbi.1006759.t003">Table 3</xref>, <xref ref-type="fig" rid="pcbi.1006759.g004">Fig 4A</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006759.s007">S7 Text</xref>). The predicted ranges for the methane yield are very narrow. The experimental data do not always lie within but are very close to the predicted ranges thus largely confirming the community model (Table S7). Regarding the exchange rates, we found that the measured values lie all within the ranges of simulations. However, the ranges predicted by the linearized full model are very large and thus of low predictive power: maximum rates are partially more than 40 times higher than the minimum rates. These results can again be explained by many solutions with energy-wasting pathways where some organisms have a high substrate turnover with only little growth, which demands to take substrate efficiency into account. To focus on most relevant solutions in the full model, we may use flux balance analysis to identify solutions with high substrate efficiency (the same objective as used in the proposed RedCom approach to obtain the reduced model). However, maximizing the biomass yields of all organisms simultaneously is not trivial, especially if some organisms are capable of using multiple substrates [<xref ref-type="bibr" rid="pcbi.1006759.ref015">15</xref>]. One option is to maximize the total community biomass yield by minimizing the ethanol uptake rate for the community. We therefore first minimized the ethanol uptake rate (with fixed community growth rate), fixed the ethanol uptake flux to the minimum value and carried out a flux variability analysis for the remaining fluxes and yields (<xref ref-type="fig" rid="pcbi.1006759.g004">Fig 4A</xref>). Only four of the six organisms (<italic>A</italic>. <italic>woodii</italic>, <italic>P</italic>. <italic>freudenreichii</italic>, <italic>S</italic>. <italic>fumaroxidans</italic> and <italic>M</italic>. <italic>barkeri</italic>) are predicted to be present and no variability in exchange fluxes, yields and community composition was observed (hence, only a single optimal solution with maximal biomass yield exists). Further analysis of the flux ranges revealed that <italic>P</italic>. <italic>freudenreichii</italic> converts ethanol to propionate which is then consumed by <italic>S</italic>. <italic>fumaroxidans</italic> which produces acetate, hydrogen and CO<sub>2</sub>. All hydrogen is converted with CO<sub>2</sub> to acetate by <italic>A</italic>. <italic>woodii</italic> and <italic>M</italic>. <italic>barkeri</italic> metabolizes the acetate to methane and CO<sub>2</sub> by acetoclastic methanogenesis. The total biomass optimization always prefers organisms which have high biomass yields for the same substrate compared to other organisms for the chosen growth rate. Alternatives (in this case: different ethanol oxidizers, hydrogenotrophic methanogenesis) are excluded neglecting that other organisms may still have higher fitness, e.g. due to higher substrate affinities. In fact, in the metaproteomic data analysis described below, we will see that <italic>D</italic>. <italic>vulgaris</italic> and different methanogens are part of the studied enrichment culture while no homoacetogenesis or ethanol oxidation via propionate was observed.</p>
</sec>
<sec id="sec027">
<title>Reduced six-species model</title>
<p>As before, we constructed the reduced six-species community model in which, in contrast to the full model, we could easily compute the (117) EFVs and from them the ranges of exchange rates and product yields (<xref ref-type="table" rid="pcbi.1006759.t003">Table 3</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006759.s007">S7 Text</xref>, and <xref ref-type="fig" rid="pcbi.1006759.g004">Fig 4B</xref>). The experimental data for the specific rates were again in the ranges predicted by the model but considerably smaller and thus more conclusive in the reduced model compared to the linearized full model. Hence, these results support the assumption of substrate-efficient flux distributions. The yield ranges are also very narrow and thus, similar to the full model, with high predictive power and in good agreement with measurements.</p>
<p>Again, the EFVs of the reduced model help to uncover more complex dependencies between fractional abundances and exchange rates in the reduced model and illustrate the enhanced predictive power compared to the linearized full model (<xref ref-type="fig" rid="pcbi.1006759.g004">Fig 4</xref>). While the latter predicts, for example, independent ranges (in blue in <xref ref-type="fig" rid="pcbi.1006759.g004">Fig 4A</xref>) for the community composition, the reduced model shows that e.g. <italic>P</italic>. <italic>freudenreichii</italic> and <italic>S</italic>. <italic>fumaroxidans</italic> always occur together in the community and that the methanogens are anti-correlated but at least one methanogen is always present (<xref ref-type="fig" rid="pcbi.1006759.g004">Fig 4B</xref>). Each EFV represents one possible (minimal) community phenotype with a characteristic community composition and substrate uptake rate as well as product yields and synthesis rates. Furthermore, any feasible community is a convex combination of these EFVs. <xref ref-type="fig" rid="pcbi.1006759.g004">Fig 4</xref> also indicates again much tighter ranges in the exchange fluxes in the reduced model while the range of feasible methane yields is small in both the reduced and the full model. Contrary to the results from the total biomass optimization in the linearized full model (orange line in <xref ref-type="fig" rid="pcbi.1006759.g004">Fig 4A</xref>), we obtained several alternative community compositions and a range of possible exchange fluxes and yields. <italic>A</italic>. <italic>woodii</italic>, <italic>P</italic>. <italic>freudenreichii</italic> and <italic>D</italic>. <italic>vulgaris</italic> are alternative ethanol oxidizers in the community and both methanogens can be involved in methanogenesis. No organism is excluded based on its specific biomass yield since we selected net conversions from each organism with substrate efficiency at single-species level.</p>
<p>We noticed that the maximum community growth rate of <italic>μ</italic><sub><italic>c</italic>,<italic>max</italic></sub> = 0.10 h<sup>−1</sup> calculated with both the reduced and the linearized full model was much higher than the highest dilution rate that supported a stable community in the experiments. Generally, <italic>μ</italic><sub><italic>c</italic>,<italic>max</italic></sub> is limited by the slowest essential organism in the community. The maximum substrate uptake rates (limiting the maximum growth rate) for these organisms were taken from single-species experiments. In these experiments, the growth conditions are usually optimized for that particular organism, which is not the case in the community experiments. In addition, substrates may differ between monocultures and enrichment cultures because growth on some substrates is only possible in the presence of other organisms (e.g. syntrophic acetate or ethanol oxidation) [<xref ref-type="bibr" rid="pcbi.1006759.ref044">44</xref>]. Furthermore, some substrate concentrations (e.g., hydrogen) in the experiments might not suffice for some organism to grow with <italic>μ</italic><sub><italic>max</italic></sub>.</p>
</sec>
<sec id="sec028">
<title>Model predictions are sensitive against ATP maintenance demand</title>
<p>As mentioned earlier, while the measured exchange rates lie within the predicted ranges, these ranges are rather large, especially in the full but–partially—also in the reduced model. We therefore carried out further simulations with the reduced model to find the reasons for this variability. We first compared results using only one of the three different ethanol oxidizers at a time ((i) <italic>D</italic>. <italic>vulgaris</italic>, (ii) <italic>A</italic>. <italic>woodii</italic>, (iii) <italic>P</italic>. <italic>freudenreichii</italic> together with <italic>S</italic>. <italic>fumaroxidans</italic>, which can use propionate produced by <italic>P</italic>. <italic>freudenreichii</italic>; <xref ref-type="fig" rid="pcbi.1006759.g005">Fig 5</xref>). The variability in the exchange rates in these simulations is much smaller. The predicted exchange rates for simulations with <italic>D</italic>. <italic>vulgaris</italic> are considerably higher than the experimental data, with <italic>A</italic>. <italic>woodii</italic>, they are slightly above and with <italic>P</italic>. <italic>freudenreichii</italic> and <italic>S</italic>. <italic>fumaroxidans</italic> slightly lower than the experimental data (<xref ref-type="fig" rid="pcbi.1006759.g005">Fig 5B</xref>). One major difference between the ethanol oxidizers is the non-growth associated ATP maintenance demand. The maintenance coefficient for <italic>D</italic>. <italic>vulgaris</italic> estimated from literature was much higher than for the other organisms (<xref ref-type="table" rid="pcbi.1006759.t001">Table 1</xref>), which may explain why the fractional abundance of <italic>D</italic>. <italic>vulgaris</italic> is predicted to be relatively low (<xref ref-type="fig" rid="pcbi.1006759.g004">Fig 4</xref>).</p>
<fig id="pcbi.1006759.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006759.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Influence of the different ethanol oxidizers in the reduced six-species model on predicted flux and yield ranges (colored areas) for the ethanol uptake rate (r<sub>Eth</sub>), CO<sub>2</sub> excretion rate (r<sub>CO2</sub>), methane excretion rate (r<sub>CH4</sub>), methane to CO<sub>2</sub> ratio (Y<sub>CH4/CO2</sub>) and methane yield (Y<sub>CH4/Eth</sub>).</title>
<p>The blue axes refer to methane yield and methane to CO<sub>2</sub> ratio whereas the black axes refer to the exchange rates. We first simulated all six organisms together (A) (cf. with Fig <bold><xref ref-type="fig" rid="pcbi.1006759.g004">4</xref></bold>B) and then the community with only one of the three different ethanol oxidizers active at a time (B): <italic>D</italic>. <italic>vulgaris</italic>: orange area; <italic>P</italic>. <italic>freudenreichii</italic> (with <italic>S</italic>. <italic>fumaroxidans</italic>, which consumes the propionate produced by <italic>P</italic>. <italic>freudenreichii</italic>): magenta area; <italic>A</italic>. <italic>woodii</italic>: cyan area. Note that the cyan and magenta regions are almost identical. The red circles show data from enrichment culture experiments (averaged values from two reactors for a dilution rate of 0.001 h<sup>-1</sup>; see Table <bold><xref ref-type="table" rid="pcbi.1006759.t003">3</xref></bold>). The community growth rate in the model was set to the measured dilution rate of 0.001 h<sup>-1</sup> with ethanol as the only substrate.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.g005" xlink:type="simple"/>
</fig>
<p>In a second simulation, we therefore investigated the influence of the ATP maintenance coefficient (<xref ref-type="fig" rid="pcbi.1006759.g006">Fig 6</xref>). We used identical maintenance coefficients for all organisms and observed that this leads to smaller ranges for the predicted rates and yields. As expected, higher maintenance coefficients imply higher specific rates. Typically, the energy produced from substrate conversion is partly used for growth and partly for maintenance of the cell. The small growth rates measured in the experiments imply that a large portion of the substrate taken up is dedicated to maintenance processes. Out of the tested “averaged” maintenance coefficients, we found that 1 mmolATP/gDW/h for each organism reflected the experimental data best.</p>
<fig id="pcbi.1006759.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006759.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Influence of the maintenance coefficient on the predicted flux and yield ranges (light blue area) for the ethanol uptake rate (r<sub>Eth</sub>), CO<sub>2</sub> excretion rate (r<sub>CO2</sub>), methane excretion rate (r<sub>CH4</sub>), methane to CO<sub>2</sub> ratio (Y<sub>CH4/CO2</sub>) and methane yield (Y<sub>CH4/Eth</sub>).</title>
<p>The blue axes refer to methane yield and methane to CO<sub>2</sub> ratio whereas the black axes refer to the exchange rates. The maintenance coefficient was set to the original specific values (A) or to equal values of 1 (B), 2 (C) and 3 mmolATP/gDW/h (D) for all organisms. The red circles show data from enrichment culture experiments (averaged values of two reactors for a dilution rate of 0.001 h<sup>-1</sup>, see Table <bold><xref ref-type="table" rid="pcbi.1006759.t003">3</xref></bold>). The community growth rate was fixed to 0.001 h<sup>-1</sup> with ethanol as the only substrate.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.g006" xlink:type="simple"/>
</fig>
<p>While the choice of the ethanol oxidizer as well as the maintenance coefficient clearly affected predicted uptake and production rates, we found that product yields and rate ratios barely changed and are thus less sensitive against uncertainties in these factors.</p>
</sec>
<sec id="sec029">
<title>Mass spectrometric analysis of an ethanol enrichment culture and model refinement</title>
<p>In addition to the abiotic data, we also analyzed metaproteomic data of the enrichment culture aiming for a taxonomic characterization and identification of active metabolic routes in the community (described in detail in <xref ref-type="supplementary-material" rid="pcbi.1006759.s008">S8 Text</xref>). The spectral abundances revealed that the most abundant taxonomic orders were Methanosarcinales, Methanobacteriales, Desulfovibrionales, Enterobacteriales, Methanomicrobiales, Methanococcales, Bacillales, Clostridiales and Archaeoglobales (<xref ref-type="fig" rid="pcbi.1006759.g007">Fig 7</xref>).</p>
<fig id="pcbi.1006759.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006759.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Spectral abundance for different taxonomic orders in the ethanol enrichment culture for different dilution rates.</title>
<p>Spectral counts assigned to the superkingdom of virus or eukaryota and spectra not assigned to any taxonomic order were not considered; taxonomic orders which reached less than 5% in every sample were combined in ‘others’.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.g007" xlink:type="simple"/>
</fig>
<p>Additionally, we looked at the respective spectral counts for pathways potentially involved in the process of anaerobic digestion (<xref ref-type="supplementary-material" rid="pcbi.1006759.s008">S8 Text</xref>). High abundances could be found for enzymes for ethanol oxidation, methanogenesis, acetoclastic methanogenesis and acetate production while homoacetogenesis (<italic>A</italic>. <italic>woodii</italic>) and ethanol oxidation via propionate (<italic>P</italic>. <italic>freudenreichii</italic> and <italic>S</italic>. <italic>fumaroxidans</italic>) seem to be of minor relevance. As a consequence, mainly three out of the six (guild) organisms of the original six-species model are relevant to represent the ethanol enrichment culture. These organisms are <italic>D</italic>. <italic>vulgaris</italic>, <italic>M</italic>. <italic>hungatei</italic> and <italic>M</italic>. <italic>barkeri</italic>, which, accidentally, exactly correspond to the three-species community studied above. Accordingly, we adapted the reduced six-species model to reflect this composition (basically, the fractional biomass abundance of <italic>A</italic>. <italic>woodii</italic>, <italic>P</italic>. <italic>freudenreichii</italic> and <italic>S</italic>. <italic>fumaroxidans</italic> was set to zero). Further analysis also revealed that the majority of the spectral counts in Methanosarcinales belonged to the Methanosaeta species, which can only use acetate for methanogenesis. Since we have Methanosarcina instead of Methanosaeta as guild organism in our model, we also switched off the hydrogen uptake for <italic>M</italic>. <italic>barkeri</italic> to mimic Methanosaeta.</p>
<p>Including the respective constraints for the observations made in the six-species model (which then becomes effectively a three-species model) we can further confine the solution space of the reduced model (<xref ref-type="table" rid="pcbi.1006759.t004">Table 4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006759.s008">S8 Text</xref>). Due to the tighter constraints, the rates of specific ethanol uptake as well as of CO<sub>2</sub> and methane production can now be determined exactly (no range) but the predictions appear, again, to be higher compared to the experimental data (Simulation 1 in <xref ref-type="table" rid="pcbi.1006759.t004">Table 4</xref>). With the results from the six-species model, we may assume that the comparably very high maintenance coefficient of <italic>D</italic>. <italic>vulgaris</italic> (4.3 mmolATP/gDW/h) was overestimated. Indeed, using a common maintenance coefficient of 1 mmolATP/gDW/h for all three species (Simulation 2 in <xref ref-type="table" rid="pcbi.1006759.t004">Table 4</xref>) the simulation results are closer to experimental data thus confirming a likely overestimation of the <italic>D</italic>. <italic>vulgaris</italic> maintenance coefficient. For Simulation 2, rates deviated less than 0.5 mmol/gDW/h and methane yields and methane to CO<sub>2</sub> ratio less than 15% from the experimental data. Given a relatively high variation of the rate and yield measurements (cf. the two datasets for <italic>μ</italic><sub><italic>c</italic></sub> = 0.001 h<sup>-1</sup> in <xref ref-type="supplementary-material" rid="pcbi.1006759.s008">S8 Text</xref>), a reasonable agreement between experimental data and predictions can thus be concluded.</p>
<table-wrap id="pcbi.1006759.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006759.t004</object-id>
<label>Table 4</label> <caption><title>Feasible ranges for exchange rates, methane yields and methane to CO<sub>2</sub> ratio for two simulations with different maintenance coefficients in the six-species model constrained by metaproteomic data (effectively, only the three species <italic>D</italic>. <italic>vulgaris</italic> (DV), <italic>M</italic>. <italic>barkeri</italic> (MB) and <italic>M</italic>. <italic>hungatei</italic> (MH) remain active).</title> <p>Simulation 1: original maintenance coefficients, simulation 2: maintenance coefficients of 1 mmol<sub>ATP</sub>/gDW/h for all species. Additionally, experimental data from the enrichment culture for growth on ethanol (average of two experiments; see <xref ref-type="supplementary-material" rid="pcbi.1006759.s008">S8 Text</xref>) are listed. In the simulations, <bold><italic>μ</italic></bold><sub><bold><italic>c</italic></bold></sub> was fixed to the dilution rate of the experiments (0.001 h<sup>-1</sup>). Accumulation of organic acids was switched off (according to experimental data). A table with simulation results and experimental data for other dilution rates can be found in <xref ref-type="supplementary-material" rid="pcbi.1006759.s008">S8 Text</xref>.</p></caption>
<alternatives>
<graphic id="pcbi.1006759.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.t004" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="justify" rowspan="2"/>
<th align="justify" colspan="3">Exchange rates [mmol/gDW<sub>c</sub>/h]</th>
<th align="justify" colspan="2">Product yields and ratios [mol/mol]</th>
<th align="justify" colspan="3">Community composition</th>
</tr>
<tr>
<th align="justify">Ethanol</th>
<th align="justify">CO<sub>2</sub></th>
<th align="justify">Methane</th>
<th align="justify">CH<sub>4</sub>:CO<sub>2</sub></th>
<th align="justify">CH<sub>4</sub>:Ethanol</th>
<th align="justify">F<sub>DV</sub></th>
<th align="justify">F<sub>MH</sub></th>
<th align="justify">F<sub>MB</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Simulation 1</td>
<td align="left">1.30</td>
<td align="left">0.63</td>
<td align="left">1.93</td>
<td align="left">3.06</td>
<td align="left">1.48</td>
<td align="left">0.05</td>
<td align="left">0.33</td>
<td align="left">0.62</td>
</tr>
<tr>
<td align="left">Simulation 2</td>
<td align="left">0.66</td>
<td align="left">0.31</td>
<td align="left">0.97</td>
<td align="left">3.13</td>
<td align="left">1.46</td>
<td align="left">0.10</td>
<td align="left">0.15</td>
<td align="left">0.75</td>
</tr>
<tr>
<td align="left">Experimental data</td>
<td align="left">0.59</td>
<td align="left">0.27</td>
<td align="left">0.87</td>
<td align="left">3.25</td>
<td align="left">1.48</td>
<td align="left">0.26</td>
<td align="left">0.30</td>
<td align="left">0.44</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The model predicts a community composition of 62% Methanosarcinales, 33% hydrogenotrophic methanogens and 5% Desulfovibrionales when we use the original maintenance coefficients (Simulation 1) and 75% Methanosarcinales, 15% hydrogenotrophic methanogens and 10% of Desulfovibrionales if we use maintenance coefficients of 1 mmolATP/gDW/h for all three organisms (Simulation 2). The spectral abundance of the three taxonomic groups in the experiment was 44% of Methanosarcinales, 30% of the hydrogenotrophic and formate using methanogens and 26% of Desulfovibrionales (<xref ref-type="table" rid="pcbi.1006759.t004">Table 4</xref>). Hence, simulations correctly predict the dominance of archaea and Methanosarcinales. However, the calculated percentage of Methanosarcinales was considerably higher than indicated by the spectral counts. One reason might be that we used a Methanosarcina species as a model organism whereas the experimental data suggest Methanosaeta species for acetoclastic methanogenesis. Methanosaeta has a lower ATP yield per acetate and therefore, also a lower biomass yield compared to Methanosarcina, which could explain this discrepancy. Additionally, many spectra could not be assigned to any of the above mentioned taxonomic orders leading to relatively large uncertainties in these results.</p>
</sec>
</sec>
<sec id="sec030">
<title>Nine-species community model</title>
<p>We finally simulated a community capable of growth on glucose. Here, all of our nine guild organisms can potentially be involved in the process and are thus part of the community model (Tables <xref ref-type="table" rid="pcbi.1006759.t001">1</xref> and <xref ref-type="table" rid="pcbi.1006759.t002">2</xref>). In addition to the six-species community studied above, this model included <italic>E</italic>. <italic>coli</italic>, <italic>C</italic>. <italic>acetobutylicum</italic> and <italic>S</italic>. <italic>wolfei</italic>. We first simulated the community with the bilinear model to predict the maximum community growth rate as well as ranges for substrate uptake, product excretion, biogas composition and methane yield (<xref ref-type="table" rid="pcbi.1006759.t005">Table 5</xref>). As already observed for the six-species model, a reliable prediction for <italic>μ</italic><sub><italic>c</italic>,<italic>max</italic></sub> was thus not possible with this model (with the iterative approach in the linearized models we found that <italic>μ</italic><sub><italic>c</italic>,<italic>max</italic></sub> = 0.23 h<sup>-1</sup>) In contrast, the predicted ranges for reaction rates and yields seem reasonable.</p>
<table-wrap id="pcbi.1006759.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006759.t005</object-id>
<label>Table 5</label> <caption><title>Simulation results of the nine-species community model (bilinear and linearized full model and reduced model).</title> <p>The minimum and maximum substrate uptake and product formation rates were computed with nonlinear optimization (bilinear model), FVA (linearized full model) or EFV analysis (reduced model). The community growth rate was set to 0.00067 h<sup>-1</sup> (linearized full model, reduced model), which was the dilution rate used in an experiment with an enrichment culture grown on glucose-cellulose medium. The experimental data of two experiments and their average is also listed in the table. The nine species in the model are: <italic>E</italic>. <italic>coli</italic>, <italic>C</italic>. <italic>acetobutylicum</italic>, <italic>S</italic>. <italic>wolfei</italic>, <italic>P</italic>. <italic>freudenreichii</italic>, <italic>A</italic>. <italic>wooddii</italic>, <italic>D</italic>. <italic>vulgaris</italic>, <italic>S</italic>. <italic>fumaroxidans</italic>, <italic>M</italic>. <italic>barkeri</italic> and <italic>M</italic>. <italic>hungatei</italic> (see also Tables <bold><xref ref-type="table" rid="pcbi.1006759.t001">1</xref></bold> and <bold><xref ref-type="table" rid="pcbi.1006759.t002">2</xref></bold>).</p></caption>
<alternatives>
<graphic id="pcbi.1006759.t005g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.t005" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="2"/>
<th align="left" rowspan="2">Community growth rate [h<sup>-1</sup>]</th>
<th align="left" colspan="3">Exchange rates [mmol/gDW/h]</th>
<th align="left" colspan="2">Product yields / rate ratios [mol/mol]</th>
</tr>
<tr>
<th align="left">Glucose</th>
<th align="left">CO<sub>2</sub></th>
<th align="left">CH<sub>4</sub></th>
<th align="left">CH<sub>4</sub>:CO<sub>2</sub></th>
<th align="left">CH<sub>4</sub>: Glucose</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Bilinear model (feasible ranges)</td>
<td align="left">Range could not be determined reliably</td>
<td align="left">0.059–4.07</td>
<td align="left">0.18–10.95</td>
<td align="left">0.17–10.95</td>
<td align="left">0.94–1.00</td>
<td align="left">1.91–3.00</td>
</tr>
<tr>
<td align="left">Experiment 1</td>
<td align="left">0.00067</td>
<td align="left">0.042</td>
<td align="left">0.074</td>
<td align="left">0.11</td>
<td align="left">1.44</td>
<td align="left">2.56</td>
</tr>
<tr>
<td align="left">Experiment 2</td>
<td align="left">0.00067</td>
<td align="left">0.074</td>
<td align="left">0.14</td>
<td align="left">0.19</td>
<td align="left">1.38</td>
<td align="left">2.64</td>
</tr>
<tr>
<td align="left">Average of both experiments</td>
<td align="left">0.00067</td>
<td align="left">0.057</td>
<td align="left">0.11</td>
<td align="left">0.15</td>
<td align="left">1.40</td>
<td align="left">2.61</td>
</tr>
<tr>
<td align="left">Linearized full model</td>
<td align="left">0.00067 <break/>(fixed to dilution rate)</td>
<td align="left">0.069–3.65</td>
<td align="left">0.19–10.95</td>
<td align="left">0.19–10.94</td>
<td align="left">0.99–1.00</td>
<td align="left">2.79–3.00</td>
</tr>
<tr>
<td align="left">Reduced model</td>
<td align="left">0.00067<break/>(fixed to dilution rate)</td>
<td align="left">0.069–0.48</td>
<td align="left">0.19–1.41</td>
<td align="left">0.19–1.41</td>
<td align="left">0.99–1.00</td>
<td align="left">2.78–2.97</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>We then compared predictions of the linearized full model and the reduced model with experimental data (<xref ref-type="table" rid="pcbi.1006759.t005">Table 5</xref>) from an enrichment culture grown on glucose-cellulose medium ([<xref ref-type="bibr" rid="pcbi.1006759.ref031">31</xref>]; see also Methods). Data were available for two duplicate experiments with identical dilution rate. Since hydrolysis of cellulose is not included in the model, we used glucose as a starting point and assumed that cellulose is converted to glucose by hydrolytic enzymes. We set the community growth rate to 0.00067 h<sup>-1</sup>, which corresponds to the dilution rate of the experiment and derived the corresponding linearized full community model and the reduced community model. EFV computation was possible with the reduced model (213689 EFVs) but not with the full model where we computed only ranges for biomass compositions, exchange rates, and methane yield via flux variability analysis (<xref ref-type="table" rid="pcbi.1006759.t005">Table 5</xref> and <xref ref-type="fig" rid="pcbi.1006759.g008">Fig 8</xref>).</p>
<fig id="pcbi.1006759.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006759.g008</object-id>
<label>Fig 8</label>
<caption>
<title/>
<p><bold>Community composition (F: fractional biomass abundance, AW: <italic>A</italic>. <italic>woodii</italic>, EC: <italic>E</italic>. <italic>coli</italic>, CA: <italic>C</italic>. <italic>acetobutylicum</italic>, PF: <italic>P</italic>. <italic>freudenreichii</italic>, SF: <italic>S</italic>. <italic>fumaroxidans</italic>, DV: <italic>D</italic>. <italic>vulgaris</italic>, MH: <italic>M</italic>. <italic>hungatei</italic>, MB: <italic>M</italic>. <italic>barkeri</italic>, SW: <italic>S</italic>. <italic>wolfei</italic>), methane yield (Y<sub>CH4/Glc</sub>), methane to CO<sub>2</sub> ratio: (Y<sub>CH4/CO2</sub>)) and metabolic rates (r<sub>Glc</sub>: glucose uptake, r<sub>CO2</sub>: CO<sub>2</sub> excretion, r<sub>CH4</sub>: methane excretion) for the bilinear model (A), linearized full model (B) and the reduced model (C).</bold> The blue axes correspond to the biomass abundances, methane yield and methane to CO<sub>2</sub> ratio whereas the black axes to the exchange rates. In the bilinear model, the ranges (light blue area) were obtained by nonlinear optimization, in the linear model with FVA. For the reduced model, we computed the EFVs (solid colored lines, colored from red (highest methane production rate) via orange, yellow, green, cyan and blue to black (lowest methane production rate). Additionally, the experimental data (average from two reactors) are plotted (red circles) in all three cases. In the linear (full and reduced) models, <italic>μ</italic><sub><italic>c</italic></sub> was set to 0.0067 h<sup>-1</sup> corresponding to the dilution rate of the experiment.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.g008" xlink:type="simple"/>
</fig>
<p>Confirming findings from the three- and six-species models, we observed that the predicted ranges, especially of exchange rates and community compositions, are again considerably smaller in the reduced model compared to the linearized full model. In fact, the calculated ranges of exchange rates of the linearized full model are almost identical to the ones from the bilinear model, although the latter did not consider a fixed growth rate. The measured exchange rates were only slightly smaller than the minimum rates predicted by the models. The predicted ranges of the reduced model lie on the lower end of the range of the linearized full model and are thus closer to the experimental data indicating that the organisms use their substrate efficiently as assumed by our model reduction approach (<xref ref-type="table" rid="pcbi.1006759.t005">Table 5</xref> and <xref ref-type="fig" rid="pcbi.1006759.g008">Fig 8</xref>). The slight overestimation of the rates could again be a consequence of overestimating maintenance coefficients or an underestimation of ATP yields in the models. Furthermore, we noticed a relatively high variance of the measurements for the exchange rates which may partially explain deviations between data and model predictions. We also measured higher methane to CO<sub>2</sub> ratios and lower methane yields than predicted by the models. Typically, we would expect a ratio of 1 methane to one CO<sub>2</sub> for carbohydrates like glucose. However, some of the released CO<sub>2</sub> might have been lost due to its better solubility in water (compared to methane).</p>
</sec>
</sec>
<sec id="sec031" sec-type="conclusions">
<title>Discussion</title>
<p>Microbial communities are of major importance for health, nature, and biotechnological applications. Constraint-based stoichiometric modeling helps to obtain a better understanding of interrelationships in these communities and to make quantitative predictions. However, compared to classical constraint-based modeling of single-species metabolic networks, analysis of community models based on the favored concept of balanced growth is hampered by four major technical difficulties:</p>
<list list-type="order">
<list-item><p>In contrast to linear single-species metabolic models, community models are bilinear due to the necessary explicit consideration of the community composition. In order to solve optimization problems in these models, one either has to rely on non-linear solvers, which may deliver only sub-optimal solutions, or one has to linearize the model, which requires to fix either the fractional abundances of the involved species or the community growth rate. While the latter case is generally easier to handle, multiple optimizations have to be performed to identify, for example, the maximum community growth rate and associated community compositions.</p></list-item>
<list-item><p>Flux variability analysis (FVA) is an essential tool for analysis of community models, especially for computing feasible ranges of community compositions and exchange rates. While min/max values of single abundances can be computed easily, deeper insights in relationships between fractional abundances (and metabolic exchange rates) require an exhaustive scanning of the whole solution space, which, becomes quickly prohibitive for communities with more than five species due to combinatorial reasons.</p></list-item>
<list-item><p>The solution space of a community model often contains spurious solutions in which one species behaves altruistically by synthesizing large amounts of products required by another species (instead of synthesizing its own biomass). Such unrealistic solutions may occur even for community compositions allowing maximum community growth rate [<xref ref-type="bibr" rid="pcbi.1006759.ref015">15</xref>]. It is thus important to identify and remove such solutions from the solution space before starting detailed analyses.</p></list-item>
<list-item><p>Due to their combinatorial complexity, linearized community models are often not amenable to detailed pathway analysis based on elementary flux modes (EFMs) or elementary flux vectors (EFVs), even if the community model has been compiled from smaller single-species core models where the EFVs are actually computable (cf. Tables <xref ref-type="table" rid="pcbi.1006759.t001">1</xref> and <xref ref-type="table" rid="pcbi.1006759.t002">2</xref>). As shown in this paper, EFV analysis of the community models, if feasible, is very useful yielding deeper insights than simple FVA and avoids, for example, the problems mentioned under point (2).</p></list-item>
</list>
<p>Our introduced RedCom approach, where reduced community models are constructed from net conversions of the linear single-species models, addresses three of the above four issues ((2)-(4)). Taffs et al. [<xref ref-type="bibr" rid="pcbi.1006759.ref010">10</xref>] also published an approach where EFMs (instead of EFVs) of single-species models were used as input for the community model (“nested pathway consortium analysis approach”). While the basic principle is the same, our RedCom approach uses EFVs instead of EFMs which is mandatory to guarantee balanced growth of the community and to allow the consideration of flux bounds, maintenance coefficients, and other inhomogeneous constraints. A necessary pre-processing step is the calculation of EFVs in the single-species models for the fixed community growth rate followed by the selection of relevant EFVs projected onto their exchange fluxes. Different optimization or selection criteria can be used for selecting the relevant single-species behaviors. We decided to use all EFVs representing minimal conversions of exchange metabolites, which, as one particular advantage, ensures exclusion of unrealistic (altruistic) community behaviors of the respective species (see point (3)). Dependent on the application, other criteria could be used as well. In the three-, six-, and nine-species community models considered herein, the RedCom approach led to community models with desired properties: the models (a) are much smaller than the full (linearized) models, (b) exclude many spurious solutions, and (c) are amenable for detailed EFV analysis enabling the extraction of many important features of the community while avoiding an elaborate scanning of the solution space. There are two potential disadvantages of the reduction approach. First, the reduced community model contains information on the exchange fluxes while the internal flux distributions are not visible. However, in most applications of community models, the focus is indeed on predictions on the exchange fluxes, product yields, and feasible community compositions, which can all be derived from the respective flux vector of the reduced model. Furthermore, internal flux distributions of single-species could be “unpacked” from particular community net conversions whenever needed. A second potential disadvantage concerns the calculation of EFVs from the single-species models, which is usually not feasible if the latter are at genome-scale. However, with the typical application focus on exchange fluxes, single-species metabolic network models at the level of the central metabolism seem to be sufficient in many cases. Third, since the reduced community model requires eventually only the (minimal) net conversions of the single-species models, the (direct) calculation of elementary conversions might be a feasible approach even in genome-scale models [<xref ref-type="bibr" rid="pcbi.1006759.ref045">45</xref>].</p>
<p>We applied our RedCom approach to build community models of up to nine species relevant for the biogas process. We used a compartmented approach where each functional guild in anaerobic digestion is represented by a core model (central metabolism) of one organism. For the respective communities, we analyzed the maximum community growth rate and the feasible ranges of exchange rates, yields and fractional abundances of the involved species—with the bilinear as well as with the linearized and the reduced community model. Results were always consistent (in bilinear models, as long as the solver could reliably compute the respective minima and maxima). However, the reduced models obtained with the RedCom approach show a significantly narrower solution space by excluding solutions from the single-species models that are physiologically very unlikely resulting in more conclusive model predictions. While bilinear community models are usually linearized to make them amenable to constraint-based analysis techniques, we found that they can, in principle, be used to roughly gauge the community’s solution space. However, in larger models, some solutions found by the solver, especially for the determined maximum community growth rate, depended on starting values used for the solver pointing to potential issues with finding the global optimum in this non-linear optimization problem. Whenever the community growth rate can be fixed (e.g., to the maximum growth rate or to the dilution rate used in an experiment), the bilinear model becomes linear making its analysis and calculations simpler. With increasing numbers of organisms the computational costs, e.g. for an FVA-based scanning of the solution space, increase drastically also in the linearized (full) community model and EFVs could only be computed for models of up to four organisms. With the reduced community models, we were able to compute and analyze EFVs also for the largest community consisting of nine organisms.</p>
<p>In order to compare simulation results with experimental data from biogas communities and to investigate which solutions of the solution space are the most relevant in a concrete culture, we carried out experiments with an ethanol enrichment culture for different dilution rates. First, we compared experimental data with predicted ranges for specific substrate uptake and product formation rates as well as for biogas composition and methane yields obtained from the linearized full and the reduced six-species model. The predicted ranges of the specific rates covered the measured values but were very large and thus of low predictive power, especially in the full model. Confirming earlier findings [<xref ref-type="bibr" rid="pcbi.1006759.ref015">15</xref>], the maintenance coefficient of the different species has a tremendous impact on many properties of the community, especially on the predicted rates and community composition. Therefore, the maintenance coefficient should be determined as precisely as possible to obtain valid community models. As many other microbial communities, anaerobic digestion communities usually have a low growth rate implying that a relatively large fraction of the metabolism is devoted to maintenance processes. Generally, our results for the anaerobic digestion community indicate that the best agreement of model predictions and experimental data can be achieved when the maintenance coefficients of all species are approximately set to 1 mmol/(gDW∙h). In contrast to rates and community compositions, the predicted ranges for methane yields and biogas composition were much smaller and appeared to be less sensitive to the maintenance coefficients making these model predictions generally more reliable. In fact, methane yields and biogas compositions from the experiments were close to the predicted values for both the reduced and the full model. The predicted maximum growth rate of the full and the reduced six-species community model were identical but considerably higher than the maximum dilution rates that supported a stable process with the enrichment culture. Here, maximization of the community growth rate might not be a suitable objective function for communities in a realistic continuous process. In particular, maximum substrate uptake rates used in the models are usually derived from single-species cultures under their respective optimal conditions and it is likely that process conditions do not support optimal conditions and maximum growth rates for all organisms. The slowest (essential) species will then limit the overall community growth rate.</p>
<p>We used metaproteomic data from enrichment cultures for growth on ethanol to find out, which taxonomies and pathways were present in these cultures and to use this information to build a more constrained community model for this culture. The most abundant taxonomic orders identified in the experiments were <italic>Methanosarcinales</italic>, <italic>Methanomicrobiales</italic>, <italic>Methanococcales</italic>, <italic>Methanobacteriales</italic> and <italic>Desulfovibrionales</italic>, which correspond to the guilds represented by <italic>M</italic>. <italic>barkeri</italic>, <italic>M</italic>. <italic>hungatei</italic> and <italic>D</italic>. <italic>vulgaris</italic> in our six-species model. Furthermore, we found enzymes for ethanol oxidatation in <italic>Desulfovibrionales</italic>, acetoclastic and hydrogenotrophic methanogenesis in the archaeal superkingdom. There was little to no evidence for syntrophic acetate oxidation, homoacetogenesis and ethanol oxidation to propionate, which agrees well with the taxonomic analysis. In a last step, we used that information to further constrain the reduced six-species model and explored options to predict community compositions from the remaining solution space. The model predicted <italic>M</italic>. <italic>barkeri</italic> to be the dominant species in the community and <italic>D</italic>. <italic>vulgaris</italic> to be the least abundant organism. In fact, <italic>Methanosarcinales</italic> was also the taxonomic order with the highest spectral count abundance in the experiments while <italic>D</italic>. <italic>vulgaris</italic> had the lowest abundance confirming the model predictions. The experimental data also indicated that mainly <italic>Methanosaeta</italic> species were involved in acetoclastic methanogenesis. These organisms grow with lower biomass yield but higher substrate affinity compared to <italic>Methanosarcina</italic> species. Therefore, <italic>Methanosaeta</italic> should be added as a separate guild to the community model for future studies. Overall, to the best of our knowledge, the presented model-driven analysis of metaproteomic data from communities involved in anaerobic digestion is the biggest of its kind reported so far and demonstrates the high potential of a computer-aided approach to investigate properties and to assess experimental data of microbial communities.</p>
</sec>
<sec id="sec032">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006759.s001" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Example for constructing and analyzing a reduced community model with the RedCom approach.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006759.s002" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.s002" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Consistency of inhomogeneous constraints in single-species models with fluxes in the reduced community model.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006759.s003" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.s003" xlink:type="simple">
<label>S3 Text</label>
<caption>
<title>Flux constraints for the single-species models.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006759.s004" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.s004" xlink:type="simple">
<label>S4 Text</label>
<caption>
<title>Model validation.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006759.s005" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.s005" xlink:type="simple">
<label>S5 Text</label>
<caption>
<title>Simulation results for the three-species community for linearized full model, reduced model and bilinear model for different dilution rates.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006759.s006" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.s006" xlink:type="simple">
<label>S6 Text</label>
<caption>
<title>Detailed description of the experimental setup and analysis of the ethanol enrichment culture experiments.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006759.s007" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.s007" xlink:type="simple">
<label>S7 Text</label>
<caption>
<title>Simulation results for the six-species community model and experimental data from the ethanol enrichment culture.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006759.s008" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.s008" xlink:type="simple">
<label>S8 Text</label>
<caption>
<title>Metaproteomic analysis of ethanol enrichment culture and resulting model adjustments.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006759.s009" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006759.s009" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Single species and reduced community models in text and SBML format.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1006759.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cho</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Blaser</surname> <given-names>MJ</given-names></name>. <article-title>The human microbiome: at the interface of health and disease</article-title>. <source>Nat Rev Genet</source>. <year>2012</year>; <volume>13</volume>: <fpage>260</fpage>–<lpage>270</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg3182" xlink:type="simple">10.1038/nrg3182</ext-link></comment> <object-id pub-id-type="pmid">22411464</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huttenhower</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gevers</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Knight</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Abubucker</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Badger</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chinwalla</surname> <given-names>AT</given-names></name>, <etal>et al</etal>. <article-title>Structure, function and diversity of the healthy human microbiome</article-title>. <source>Nature</source>. <year>2012</year>; <volume>486</volume>: <fpage>207</fpage>–<lpage>214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature11234" xlink:type="simple">10.1038/nature11234</ext-link></comment> <object-id pub-id-type="pmid">22699609</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bardgett</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Freeman</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ostle</surname> <given-names>NJ</given-names></name>. <article-title>Microbial contributions to climate change through carbon cycle feedbacks</article-title>. <source>Isme Journal</source>. <year>2008</year>; <volume>2</volume>: <fpage>805</fpage>–<lpage>814</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ismej.2008.58" xlink:type="simple">10.1038/ismej.2008.58</ext-link></comment> <object-id pub-id-type="pmid">18615117</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McInerney</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Sieber</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Gunsalus</surname> <given-names>RP</given-names></name>. <article-title>Syntrophy in anaerobic global carbon cycles</article-title>. <source>Curr Opin Biotechnol</source>. <year>2009</year>; <volume>20</volume>: <fpage>623</fpage>–<lpage>632</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.copbio.2009.10.001" xlink:type="simple">10.1016/j.copbio.2009.10.001</ext-link></comment> <object-id pub-id-type="pmid">19897353</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kumar</surname> <given-names>CG</given-names></name>, <name name-style="western"><surname>Anand</surname> <given-names>SK</given-names></name>. <article-title>Significance of microbial biofilms in food industry. A review</article-title>. <source>Int J Food Microbiol</source>. <year>1998</year>; <volume>42</volume>: <fpage>9</fpage>–<lpage>27</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0168-1605(98)00060-9" xlink:type="simple">10.1016/S0168-1605(98)00060-9</ext-link></comment> <object-id pub-id-type="pmid">9706794</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Whiteley</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Bailey</surname> <given-names>MJ</given-names></name>. <article-title>Bacterial Community Structure and Physiological State within an Industrial Phenol Bioremediation System</article-title>. <source>Appl. Environ. Microbiol</source>. <year>2000</year>; <volume>66</volume>: <fpage>2400</fpage>–<lpage>2407</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/AEM.66.6.2400–2407.2000" xlink:type="simple">10.1128/AEM.66.6.2400–2407.2000</ext-link></comment> <object-id pub-id-type="pmid">10831417</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wagner</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Loy</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Nogueira</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Purkhold</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Daims</surname> <given-names>H</given-names></name>. <article-title>Microbial community composition and function in wastewater treatment plants</article-title>. <source>Antonie van Leeuwenhoek</source>. <year>2002</year>; <volume>81</volume>: <fpage>665</fpage>–<lpage>680</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1023/A:1020586312170" xlink:type="simple">10.1023/A:1020586312170</ext-link></comment> <object-id pub-id-type="pmid">12448762</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hunt</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Jennings</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Inskeep</surname> <given-names>WP</given-names></name>, <name name-style="western"><surname>Carlson</surname> <given-names>RP</given-names></name>. <article-title>Multiscale analysis of autotroph-heterotroph interactions in a high-temperature microbial community</article-title>. <source>PLoS Comput Biol</source>. <year>2018</year>; <volume>14</volume>: <fpage>e1006431</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1006431" xlink:type="simple">10.1371/journal.pcbi.1006431</ext-link></comment> <object-id pub-id-type="pmid">30260956</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stolyar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>van Dien</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hillesland</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Pinel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Lie</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Leigh</surname> <given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>Metabolic modeling of a mutualistic microbial community</article-title>. <source>Mol Syst Biol</source>. <year>2007</year>; <volume>3</volume>: <fpage>92</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/msb4100131" xlink:type="simple">10.1038/msb4100131</ext-link></comment> <object-id pub-id-type="pmid">17353934</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Taffs</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Aston</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Brileya</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Jay</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Klatt</surname> <given-names>CG</given-names></name>, <name name-style="western"><surname>McGlynn</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>In silico approaches to study mass and energy flows in microbial consortia. a syntrophic case study</article-title>. <source>BMC Syst Biol</source>. <year>2009</year>; <volume>3</volume>: <fpage>114</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1752-0509-3-114" xlink:type="simple">10.1186/1752-0509-3-114</ext-link></comment> <object-id pub-id-type="pmid">20003240</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Khandelwal</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Olivier</surname> <given-names>BG</given-names></name>, <name name-style="western"><surname>Roling</surname> <given-names>WF</given-names></name>, <name name-style="western"><surname>Teusink</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Bruggeman</surname> <given-names>FJ</given-names></name>. <article-title>Community flux balance analysis for microbial consortia at balanced growth</article-title>. <source>PLoS One</source>. <year>2013</year>; <volume>8</volume>: <fpage>e64567</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0064567" xlink:type="simple">10.1371/journal.pone.0064567</ext-link></comment> <object-id pub-id-type="pmid">23741341</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hamilton</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Calixto Contreras</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Reed</surname> <given-names>JL</given-names></name>. <article-title>Thermodynamics and H2 Transfer in a Methanogenic, Syntrophic Community</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>; <volume>11</volume>: <fpage>e1004364</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004364" xlink:type="simple">10.1371/journal.pcbi.1004364</ext-link></comment> <object-id pub-id-type="pmid">26147299</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Biggs</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Medlock</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Kolling</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Papin</surname> <given-names>JA</given-names></name>. <article-title>Metabolic network modeling of microbial communities</article-title>. <source>Wiley Interdiscip Rev Syst Biol Med</source>. <year>2015</year>; <volume>7</volume>: <fpage>317</fpage>–<lpage>334</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/wsbm.1308" xlink:type="simple">10.1002/wsbm.1308</ext-link></comment> <object-id pub-id-type="pmid">26109480</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maarleveld</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Wortel</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Olivier</surname> <given-names>BG</given-names></name>, <name name-style="western"><surname>Teusink</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Bruggeman</surname> <given-names>FJ</given-names></name>. <article-title>Interplay between constraints, objectives, and optimality for genome-scale stoichiometric models</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>; <volume>11</volume>: <fpage>e1004166</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004166" xlink:type="simple">10.1371/journal.pcbi.1004166</ext-link></comment> <object-id pub-id-type="pmid">25849486</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koch</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Benndorf</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Fronk</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Reichl</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Klamt</surname> <given-names>S</given-names></name>. <article-title>Predicting compositions of microbial communities from stoichiometric models with applications for the biogas process</article-title>. <source>Biotechnol Biofuels</source>. <year>2016</year>; <volume>9</volume>: <fpage>17</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s13068-016-0429-x" xlink:type="simple">10.1186/s13068-016-0429-x</ext-link></comment> <object-id pub-id-type="pmid">26807149</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chan</surname> <given-names>SHJ</given-names></name>, <name name-style="western"><surname>Simons</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Maranas</surname> <given-names>CD</given-names></name>. <article-title>SteadyCom: Predicting microbial abundances while ensuring community stability</article-title>. <source>PLoS Comput Biol</source>. <year>2017</year>; <volume>13</volume>: <fpage>e1005539</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005539" xlink:type="simple">10.1371/journal.pcbi.1005539</ext-link></comment> <object-id pub-id-type="pmid">28505184</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bauer</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Thiele</surname> <given-names>I</given-names></name>. <article-title>From Network Analysis to Functional Metabolic Modeling of the Human Gut Microbiota</article-title>. <source>mSystems</source>. <year>2018</year>; <volume>3</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/mSystems.00209-17" xlink:type="simple">10.1128/mSystems.00209-17</ext-link></comment> <object-id pub-id-type="pmid">29600286</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zelezniak</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Andrejev</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ponomarova</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Mende</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Bork</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Patil</surname> <given-names>KR</given-names></name>. <article-title>Metabolic dependencies drive species co-occurrence in diverse microbial communities</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A</source>. <year>2015</year>; <volume>112</volume>: <fpage>6449</fpage>–<lpage>6454</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1421834112" xlink:type="simple">10.1073/pnas.1421834112</ext-link></comment> <object-id pub-id-type="pmid">25941371</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Urbanczik</surname> <given-names>R.</given-names></name> <article-title>Enumerating constrained elementary flux vectors of metabolic networks</article-title>. <source>IET Systems Biology</source>. <year>2007</year>; <volume>1</volume>: <fpage>274</fpage>–<lpage>279</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1049/iet-syb:20060073" xlink:type="simple">10.1049/iet-syb:20060073</ext-link></comment> <object-id pub-id-type="pmid">17907675</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Klamt</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Regensburger</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gerstl</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Jungreuthmayer</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Schuster</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mahadevan</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>From elementary flux modes to elementary flux vectors. Metabolic pathway analysis with arbitrary linear flux constraints</article-title>. <source>PLoS Comput Biol</source>. <year>2017</year>; <volume>13</volume>: <fpage>e1005409</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005409" xlink:type="simple">10.1371/journal.pcbi.1005409</ext-link></comment> <object-id pub-id-type="pmid">28406903</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bordbar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Monk</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>King</surname> <given-names>ZA</given-names></name>, <name name-style="western"><surname>Palsson</surname> <given-names>BO</given-names></name>. <article-title>Constraint-based models predict metabolic and associated cellular functions</article-title>. <source>Nat Rev Genet</source>. <year>2014</year>; <volume>15</volume>: <fpage>107</fpage>–<lpage>120</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg3643" xlink:type="simple">10.1038/nrg3643</ext-link></comment> <object-id pub-id-type="pmid">24430943</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bizukojc</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dietz</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zeng</surname> <given-names>AP</given-names></name>. <article-title>Metabolic modelling of syntrophic-like growth of a 1,3-propanediol producer, Clostridium butyricum, and a methanogenic archeon, Methanosarcina mazei, under anaerobic conditions</article-title>. <source>Bioprocess Biosyst. Eng</source>. <year>2010</year>; <volume>33</volume>: <fpage>507</fpage>–<lpage>523</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00449-009-0359-0" xlink:type="simple">10.1007/s00449-009-0359-0</ext-link></comment> <object-id pub-id-type="pmid">19680695</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thiele</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Heinken</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Fleming</surname> <given-names>RMT</given-names></name>. <article-title>A systems biology approach to studying the role of microbes in human health</article-title>. <source>Curr Opin Biotechnol</source>. <year>2013</year>; <volume>24</volume>: <fpage>4</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.copbio.2012.10.001" xlink:type="simple">10.1016/j.copbio.2012.10.001</ext-link></comment> <object-id pub-id-type="pmid">23102866</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schuster</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hilgetag</surname> <given-names>C</given-names></name>. <article-title>On elementary flux modes in biochemical reaction systems at steady state</article-title>. <source>J. Biol. Syst</source>. <year>1994</year>; <volume>02</volume>: <fpage>165</fpage>–<lpage>182</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1142/S0218339094000131" xlink:type="simple">10.1142/S0218339094000131</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006759.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schuster</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fell</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Dandekar</surname> <given-names>T</given-names></name>. <article-title>A general definition of metabolic pathways useful for systematic organization and analysis of complex metabolic networks</article-title>. <source>Nat Biotechnol</source>. <year>2000</year>; <volume>18</volume>: <fpage>326</fpage>–<lpage>332</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/73786" xlink:type="simple">10.1038/73786</ext-link></comment> <object-id pub-id-type="pmid">10700151</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Poolman</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Venkatesh</surname> <given-names>KV</given-names></name>, <name name-style="western"><surname>Pidcock</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Fell</surname> <given-names>DA</given-names></name>. <article-title>A method for the determination of flux in elementary modes, and its application to Lactobacillus rhamnosus</article-title>. <source>Biotechnol Bioeng</source>. <year>2004</year>; <volume>88</volume>: <fpage>601</fpage>–<lpage>612</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/bit.20273" xlink:type="simple">10.1002/bit.20273</ext-link></comment> <object-id pub-id-type="pmid">15470705</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Trinh</surname> <given-names>CT</given-names></name>, <name name-style="western"><surname>Wlaschin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Srienc</surname> <given-names>F</given-names></name>. <article-title>Elementary mode analysis. A useful metabolic pathway analysis tool for characterizing cellular metabolism</article-title>. <source>Appl. Microbiol. Biotechnol</source>. <year>2009</year>; <volume>81</volume>: <fpage>813</fpage>–<lpage>826</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00253-008-1770-1" xlink:type="simple">10.1007/s00253-008-1770-1</ext-link></comment> <object-id pub-id-type="pmid">19015845</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zanghellini</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ruckerbauer</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Hanscho</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Jungreuthmayer</surname> <given-names>C</given-names></name>. <article-title>Elementary flux modes in a nutshell. Properties, calculation and applications</article-title>. <source>Biotechnol. J</source>. <year>2013</year>; <volume>8</volume>: <fpage>1009</fpage>–<lpage>1016</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/biot.201200269" xlink:type="simple">10.1002/biot.201200269</ext-link></comment> <object-id pub-id-type="pmid">23788432</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Klamt</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Saez-Rodriguez</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gilles</surname> <given-names>ED</given-names></name>. <article-title>Structural and functional analysis of cellular networks with CellNetAnalyzer</article-title>. <source>BMC Syst Biol</source>. <year>2007</year>; <volume>1</volume>: <fpage>2</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1752-0509-1-2" xlink:type="simple">10.1186/1752-0509-1-2</ext-link></comment> <object-id pub-id-type="pmid">17408509</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kamp</surname> <given-names>A von</given-names></name>, <name name-style="western"><surname>Thiele</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hädicke</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Klamt</surname> <given-names>S</given-names></name>. <article-title>Use of CellNetAnalyzer in biotechnology and metabolic engineering</article-title>. <source>J. Biotechnol</source>. <year>2017</year>; <volume>261</volume>: <fpage>221</fpage>–<lpage>228</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jbiotec.2017.05.001" xlink:type="simple">10.1016/j.jbiotec.2017.05.001</ext-link></comment> <object-id pub-id-type="pmid">28499817</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kohrs</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Heyer</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bissinger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kottler</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Schallert</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Püttker</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Proteotyping of laboratory-scale biogas plants reveals multiple steady-states in community composition</article-title>. <source>Anaerobe</source>. <year>2017</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.anaerobe.2017.02.005" xlink:type="simple">10.1016/j.anaerobe.2017.02.005</ext-link></comment> <object-id pub-id-type="pmid">28189830</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lowry</surname> <given-names>OH</given-names></name>, <name name-style="western"><surname>Rosebrough</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Farr</surname> <given-names>AL</given-names></name>, &amp; <name name-style="western"><surname>Randall</surname> <given-names>RJ</given-names></name>. <article-title>Protein Measurement with the folin phenol reagent</article-title>. <source>J. Biol. Chem</source>. <year>1951</year>: <fpage>265</fpage>–<lpage>275</lpage>. <object-id pub-id-type="pmid">14907713</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ogata</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Goto</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sato</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Fujibuchi</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Bono</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kanehisa</surname> <given-names>M</given-names></name>. <article-title>KEGG. Kyoto Encyclopedia of Genes and Genomes</article-title>. <source>Nucleic Acids Res</source>. <year>1999</year>; <volume>27</volume>: <fpage>29</fpage>–<lpage>34</lpage>. <object-id pub-id-type="pmid">9847135</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Caspi</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Altman</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Dreher</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Fulcher</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Subhraveti</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Keseler</surname> <given-names>IM</given-names></name>, <etal>et al</etal>. <article-title>The MetaCyc database of metabolic pathways and enzymes and the BioCyc collection of pathway/genome databases</article-title>. <source>Nucleic Acids Res</source>. <year>2012</year>; <volume>40</volume>: <fpage>53</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkr690" xlink:type="simple">10.1093/nar/gkr690</ext-link></comment> <object-id pub-id-type="pmid">21908398</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Balch</surname> <given-names>WE</given-names></name>, <name name-style="western"><surname>Schoberth</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tanner</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Wolfe</surname> <given-names>RS</given-names></name>. <article-title>Acetobacterium, a New Genus of Hydrogen-Oxidizing, Carbon Dioxide-Reducing, Anaerobic Bacteria</article-title>. <source>Int. J. Syst. Bacteriol</source>. <year>1977</year>; <volume>27</volume>: <fpage>355</fpage>–<lpage>361</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1099/00207713-27-4-355" xlink:type="simple">10.1099/00207713-27-4-355</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006759.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buschhorn</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Dürre</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Gottschalk</surname> <given-names>G</given-names></name>. <article-title>Production and Utilization of Ethanol by the Homoacetogen Acetobacterium woodii</article-title>. <source>Appl. Environ. Microbiol</source>. <year>1989</year>; <volume>55</volume>: <fpage>1835</fpage>–<lpage>1840</lpage>. <object-id pub-id-type="pmid">16347978</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schink</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Kremer</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Hansen</surname> <given-names>TA</given-names></name>. <article-title>Pathway of propionate formation from ethanol in Pelobacter propionicus</article-title>. <source>Arch. Microbiol</source>. <year>1987</year>; <volume>147</volume>: <fpage>321</fpage>–<lpage>327</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00406127" xlink:type="simple">10.1007/BF00406127</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006759.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jones</surname> <given-names>DT</given-names></name>, <name name-style="western"><surname>Woods</surname> <given-names>DR</given-names></name>. <article-title>Acetone-butanol fermentation revisited</article-title>. <source>Microbiol. Rev</source>. <year>1986</year>; <volume>50</volume>: <fpage>484</fpage>–<lpage>524</lpage>. <object-id pub-id-type="pmid">3540574</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Harmsen</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>van Kuijk</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Plugge</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Akkermans</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Vos</surname> <given-names>WM de</given-names></name>, <name name-style="western"><surname>Stams</surname> <given-names>AJ</given-names></name>. <article-title>Syntrophobacter fumaroxidans sp. nov., a syntrophic propionate-degrading sulfate-reducing bacterium</article-title>. <source>Int. J. Syst. Bacteriol</source>. <year>1998</year>; <volume>48</volume> <issue>Pt 4</issue>: <fpage>1383</fpage>–<lpage>1387</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1099/00207713-48-4-1383" xlink:type="simple">10.1099/00207713-48-4-1383</ext-link></comment> <object-id pub-id-type="pmid">9828440</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McInerney</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Bryant</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Hespell</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Costerton</surname> <given-names>JW</given-names></name>. <article-title>Syntrophomonas wolfei gen. nov. sp. nov., an Anaerobic, Syntrophic, Fatty Acid-Oxidizing Bacterium</article-title>. <source>Appl. Environ. Microbiol</source>. <year>1981</year>; <volume>41</volume>: <fpage>1029</fpage>–<lpage>1039</lpage>. <object-id pub-id-type="pmid">16345745</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beaty</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>McInerney</surname> <given-names>MJ</given-names></name>. <article-title>Growth of Syntrophomonas wolfei in pure culture on crotonate</article-title>. <source>Arch. Microbiol</source>. <year>1987</year>; <volume>147</volume>: <fpage>389</fpage>–<lpage>393</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00406138" xlink:type="simple">10.1007/BF00406138</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006759.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tatton</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Archer</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Powell</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Parker</surname> <given-names>ML</given-names></name>. <article-title>Methanogenesis from ethanol by defined mixed continuous cultures</article-title>. <source>Appl. Environ. Microbiol</source>. <year>1989</year>; <volume>55</volume>: <fpage>440</fpage>–<lpage>445</lpage>. <object-id pub-id-type="pmid">16347852</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Klamt</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Müller</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Regensburger</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Zanghellini</surname> <given-names>J</given-names></name>. <article-title>A mathematical framework for yield (vs. rate) optimization in constraint-based modeling and applications in metabolic engineering</article-title>. <source>Metab. Eng</source>. <year>2018</year>; <volume>47</volume>: <fpage>153</fpage>–<lpage>169</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ymben.2018.02.001" xlink:type="simple">10.1016/j.ymben.2018.02.001</ext-link></comment> <object-id pub-id-type="pmid">29427605</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schink</surname> <given-names>B.</given-names></name> <article-title>Energetics of syntrophic cooperation in methanogenic degradation</article-title>. <source>Microbiol Mol Biol Rev</source>. <year>1997</year>; <volume>61</volume>: <fpage>262</fpage>–<lpage>280</lpage>. <object-id pub-id-type="pmid">9184013</object-id></mixed-citation></ref>
<ref id="pcbi.1006759.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Urbanczik</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wagner</surname> <given-names>C</given-names></name>. <article-title>Functional stoichiometric analysis of metabolic networks</article-title>. <source>Bioinformatics</source>. <year>2005</year>; <volume>21</volume>: <fpage>4176</fpage>–<lpage>4180</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/bti674" xlink:type="simple">10.1093/bioinformatics/bti674</ext-link></comment> <object-id pub-id-type="pmid">16188931</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>