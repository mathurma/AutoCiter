<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-02060</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004491</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Perm-seq: Mapping Protein-DNA Interactions in Segmental Duplication and Highly Repetitive Regions of Genomes with Prior-Enhanced Read Mapping</article-title>
<alt-title alt-title-type="running-head">Perm-seq: Prior Enhanced Read Mapping</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Zeng</surname> <given-names>Xin</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Li</surname> <given-names>Bo</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Welch</surname> <given-names>Rene</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Rojo</surname> <given-names>Constanza</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="fn" rid="econtrib001"><sup>‡</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Zheng</surname> <given-names>Ye</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="fn" rid="econtrib001"><sup>‡</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Dewey</surname> <given-names>Colin N.</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Keleş</surname> <given-names>Sündüz</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Statistics, University of Wisconsin, Madison, Wisconsin, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>California Institute for Quantitative Biosciences, University of California, Berkeley, California, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Biostatistics and Medical Informatics, University of Wisconsin, Madison, Wisconsin, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Chen</surname> <given-names>Kevin</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Rutgers University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived the study: SK. Conceived and designed the experiments: SK XZ CND. Performed the experiments: SK XZ BL RW. Analyzed the data: SK XZ RW CR YZ. Contributed reagents/materials/analysis tools: RW BL CR YZ. Wrote the paper: SK XZ.</p>
</fn>
<fn fn-type="other" id="econtrib001">
<p>‡ These authors contributed equally.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">keles@stat.wisc.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>10</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>20</day>
<month>10</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>10</issue>
<elocation-id>e1004491</elocation-id>
<history>
<date date-type="received">
<day>13</day>
<month>11</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>6</day>
<month>8</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Zeng et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004491" xlink:type="simple"/>
<abstract>
<p>Segmental duplications and other highly repetitive regions of genomes contribute significantly to cells’ regulatory programs. Advancements in next generation sequencing enabled genome-wide profiling of protein-DNA interactions by chromatin immunoprecipitation followed by high throughput sequencing (ChIP-seq). However, interactions in highly repetitive regions of genomes have proven difficult to map since short reads of 50–100 base pairs (bps) from these regions map to multiple locations in reference genomes. Standard analytical methods discard such multi-mapping reads and the few that can accommodate them are prone to large false positive and negative rates. We developed Perm-seq, a prior-enhanced read allocation method for ChIP-seq experiments, that can allocate multi-mapping reads in highly repetitive regions of the genomes with high accuracy. We comprehensively evaluated Perm-seq, and found that our prior-enhanced approach significantly improves multi-read allocation accuracy over approaches that do not utilize additional data types. The statistical formalism underlying our approach facilitates supervising of multi-read allocation with a variety of data sources including histone ChIP-seq. We applied Perm-seq to 64 ENCODE ChIP-seq datasets from GM12878 and K562 cells and identified many novel protein-DNA interactions in segmental duplication regions. Our analysis reveals that although the protein-DNA interactions sites are evolutionarily less conserved in repetitive regions, they share the overall sequence characteristics of the protein-DNA interactions in non-repetitive regions.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Chromatin immunoprecipitation followed by high throughput sequencing (ChIP-Seq) is widely used for studying <italic>in vivo</italic> protein-DNA interactions genome-wide. The applicability of this method for profiling repetitive regions of the genome is limited due to short read sizes dominating ChIP-seq applications. We present Perm-seq, which implements a novel generative model for mapping short reads to repetitive regions of genomes. Perm-seq introduces a new class of read alignment algorithms that can combine data from multiple sources. We show with both computational experiments and the analysis of large volumes of ENCODE ChIP-seq data that utilizing DNase-seq derived priors in Perm-seq is especially powerful in mapping protein-DNA interactions in segmental duplication regions. This general approach enables the use of any number of histone ChIP-seq data alone or together with DNase data to supervise read allocation. Our large scale analysis reveals that although the protein-DNA interactions sites are evolutionarily less conserved in repetitive regions, they share the overall sequence characteristics of the protein-DNA interactions in non-repetitive regions.</p>
</abstract>
<funding-group>
<funding-statement>This work was supported by the National Institutes of Health grants HG003747 (SK) and U01 HG007019 (SK and CND). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="0"/>
<page-count count="23"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>The raw datafiles listed in Tables S9, S10, and S11 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref> are available at the ENCODE portal of the UCSC Genome Browser (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://hgdownload.cse.ucsc.edu/goldenpath/hg19/encodeDCC/">http://hgdownload.cse.ucsc.edu/goldenpath/hg19/encodeDCC/</ext-link>). Perm-seq results are available at <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="ftp://ftp.cs.wisc.edu/pub/users/kelesgroup/encode2-perm-seq-peaks/">ftp://ftp.cs.wisc.edu/pub/users/kelesgroup/encode2-perm-seq-peaks/</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods paper</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Chromatin immunoprecipitation followed by sequencing (ChIP-seq) has become a versatile high throughput assay for profiling of transcription factor (TF) binding and histone modifications. A typical ChIP-seq experiment generates millions of short reads (50–100 bps). The first step of any standard ChIP-seq data analysis pipeline involves mapping reads to a reference genome. In any given ChIP-seq experiment, a considerable fraction (5–30%) [<xref ref-type="bibr" rid="pcbi.1004491.ref001">1</xref>] of the reads can align to multiple locations on the genome (multi-reads) thereby creating ambiguity regarding their true origin. Although there have been some prior efforts in developing ChIP-seq specific mappers that can allocate multi-mapping reads to one of their mapping positions based on local counts of uniquely mapping reads [<xref ref-type="bibr" rid="pcbi.1004491.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1004491.ref005">5</xref>] (uni-reads), the standard practice for ChIP-seq experiments is to either use only uniquely mapping reads or retain a conservative set of multi-mapping reads (e.g., with at most 2–3 mapping positions) and utilize one of the mapping positions randomly [<xref ref-type="bibr" rid="pcbi.1004491.ref006">6</xref>]. This bottleneck has serious downstream effects when characterizing regulatory elements common or specific to distinct cell types where, for example, cell-type specific characteristics that reside in repetitive regions are grossly under-represented. Similar observations have been made for MeDIP-seq analysis [<xref ref-type="bibr" rid="pcbi.1004491.ref007">7</xref>], where repetitive elements were severely underestimated in the traditional alignment and analysis of sequencing based data. This is a highly critical barrier especially to the advancement of analysis of large consortia (e.g., Encyclopaedia of DNA Elements (ENCODE)) data because significant fractions of eukaryotic genomes are composed of repetitive regions, e.g., more than half of the human genome. Genomic repeats play important roles in function and evolution of transcriptional regulatory networks [<xref ref-type="bibr" rid="pcbi.1004491.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1004491.ref009">9</xref>] making their functional annotation of highest biological importance. Segmental duplications played roles in creating new primate genes and contributed to human genetic variation [<xref ref-type="bibr" rid="pcbi.1004491.ref010">10</xref>]. Therefore, utilization of multi-mapping reads is especially important for characterizing regulatory activity in segmental duplications or LINE elements that harbor near-identical DNA sequences.</p>
<p>Current state-of-the-art approaches for allocating multi-mapping reads in both RNA-seq [<xref ref-type="bibr" rid="pcbi.1004491.ref011">11</xref>–<xref ref-type="bibr" rid="pcbi.1004491.ref017">17</xref>] and ChIP-seq [<xref ref-type="bibr" rid="pcbi.1004491.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1004491.ref005">5</xref>] studies rely on utilizing read counts of the local neighbourhoods of the mapping positions. Therefore, these approaches have critical limitations when the local neighbourhood read counts of the mapping positions are highly similar. In order to resolve this bottleneck and improve specificity of multi-read allocation in ChIP-seq studies, we develop a novel strategy that utilizes data from DNase I hypersensitive sites sequencing (DNase-seq) experiments to inform read allocation in ChIP-seq. DNase-seq is a high-resolution assay for mapping active <italic>cis</italic>-regulatory elements across the genome [<xref ref-type="bibr" rid="pcbi.1004491.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1004491.ref019">19</xref>]. DNase-seq identifies broader regions of open chromatin which often exhibit transcription factor occupancy. Although these experiments do not provide specificity as to which regulatory factors occupy the captured accessible regions of the genome, there is a growing literature indicating their high predictive ability for identifying protein-DNA binding sites [<xref ref-type="bibr" rid="pcbi.1004491.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1004491.ref021">21</xref>]. Utilizing a large number of ENCODE ChIP-seq datasets from GM12878 and K562 cells, we show that DNase-seq has significant power for discriminating between the mapping locations of multi-reads with similar local ChIP-seq read counts. We develop a probabilistic model that utilizes DNase-seq derived priors (Perm-seq) and maps reads originating from highly repetitive regions with high accuracy. The Perm-seq framework is highly versatile and enables incorporation of multiple sources of data such as histone ChIP-seq for read allocation.</p>
<p>Our reanalysis of a large collection of ENCODE ChIP-seq datasets with Perm-seq identifies many novel protein-DNA interaction targets in highly repetitive regions of the genome, especially in segmental duplications. Our detailed analysis of these novel targets indicate that repetitive and non-repetitive modes of protein-DNA interactions share similar chromatin signatures. Although protein-DNA interaction sites in the repetitive regions are evolutionarily less conserved, they share sequence characteristics of the protein-DNA interaction regions identified by uniquely mapping reads. Furthermore, our analysis identifies that H2a.z ChIP-seq data performs as well as DNase-seq data for supervising allocation of multi-reads in highly repetitive regions.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Discriminative power of DNase-seq for allocating multi-reads in ChIP-seq data</title>
<p>In order to explore the discriminating power of DNase-seq data for allocating multi-mapping ChIP-seq reads, we identified all the reads that map to two different locations on chromosome 2 from an ENCODE Gata2 ChIP-seq experiment performed in Huvec cells [<xref ref-type="bibr" rid="pcbi.1004491.ref022">22</xref>]. Since all the available multi-read allocation methods utilize uni-read counts in local neighbourhoods of the mapping locations, we evaluated how different the local neighbourhoods are for the two locations that each read maps to. In addition, we also counted the number of DNase-seq reads in these neighbourhoods. This investigation revealed that the ChIP uni-read counts of the local neighbours of the two mapping locations are very similar with log base 2 fold changes smaller than 0.5, i.e., | log<sub>2</sub>(ChIP counts at location 1/ChIP counts at location 2)| &lt; 0.5, for majority of the reads (70%, <xref ref-type="fig" rid="pcbi.1004491.g001">Fig 1(a)</xref>). However, DNase read counts together with ChIP read counts can discriminate between the two mapping locations with a log based 2 fold change of at least 0.5 for 49% of the reads, resulting in a 26% increase in the discrimination power. Similar trends in discriminative power are observed for a range of fold change thresholds (Table S1 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>).</p>
<fig id="pcbi.1004491.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004491.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Discriminative power of DNase-seq for mapping locations of multi-reads.</title>
<p>(a) Log base two ratios of DNase-seq versus ChIP-seq read counts in the local neighbourhoods of the two mapping locations of each multi-read in Gata2 ChIP-seq dataset (Huvec). The vertical and horizontal lines depict boundaries with the log base two ratios equal to 0.5. The proportion of read pairs in categories: ChIP: ChIP or both ChIP and DNase discriminates; Neither: Neither ChIP nor DNase discriminates; Only DNase: Only DNase discriminates; Opposite: ChIP and DNase log base 2 ratios have different signs are 23%, 44%, 26%, and 7%, respectively. (b) Classification of multi-reads with two mapping locations based on their local DNase-seq and ChIP-seq read counts into 4 groups as ChIP, Neither, Only DNase, and Opposite. (c) Overall summary of the Perm-seq pipeline.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004491.g001"/>
</fig>
<p>We performed a similar analysis for four additional datasets (<xref ref-type="fig" rid="pcbi.1004491.g001">Fig 1(b)</xref>, Fig. S1 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>): Atf3 and cFos in GM12878 and K562 cells, and observed that utilizing local ChIP read counts helps to distinguish between the two mapping locations of only 17–21% of the reads whereas DNase read counts alone were able to discriminate between two mapping locations for an additional 24–36% of the reads. For a small percentage of the reads (≤ 7%), the fold changes of DNase and ChIP read counts of the two mapping positions appear to be in opposite directions, i.e., DNase read counts in position 1 &gt; DNase read counts in position 2, while ChIP read counts in position 1 &lt; ChIP read counts in in position 2. This is attributable to the fact that signal measured by DNase-seq is not regulatory factor specific as well as to heterogeneity of cells the ChIP- and the DNase-seq experiments are conducted on.</p>
</sec>
<sec id="sec004">
<title>Analytical framework of the Perm-seq algorithm</title>
<p>Perm-seq models observed ChIP-seq read alignments conditional on DNase-seq data and significantly extends our prior work, CSEM [<xref ref-type="bibr" rid="pcbi.1004491.ref001">1</xref>] on multi-read allocation. Specifically, DNase-seq read counts are incorporated into a multinomial read generating distribution with a Dirichlet-multinomial regression model. The Dirichlet-multinomial regression model includes a log-linear prior that is a function of DNase-seq read counts. The Perm-seq framework involves three major components (<xref ref-type="fig" rid="pcbi.1004491.g001">Fig 1(c)</xref>). First, DNase-seq read counts are mapped to the reference genome with CSEM by taking into account multi-reads. In this step, each multi-mapping read is allocated to one of its mapping positions if the allocation probability is at least 0.9. This is quite a conservative mapping strategy for multi-reads; however it avoids generation of spurious DNase signals. Then, ChIP-seq reads are aligned to the reference genome with Bowtie [<xref ref-type="bibr" rid="pcbi.1004491.ref023">23</xref>] (using parameters <monospace>-q -v 2 -a -m 99</monospace>) while retaining both uni- and multi-reads. The next step involves building a log-linear model by regressing ChIP-seq uni-read counts on DNase-seq read counts. We utilize a data aggregation strategy to build such a model. Exploratory analyses of multiple ChIP-Seq datasets indicate that B-spline models provide very good fits (Fig. S2 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>) and capture how ChIP-seq read counts vary with DNase-seq signal. We use this estimated B-spline model to generate prior parameters for the Dirichlet-multinomial model and allocate multi-mapping reads to each of the mapping locations by weighting the evidence from ChIP-seq read counts of the local neighbourhoods and the corresponding DNase-seq priors. The output from Perm-seq is a file with all the uni- and multi-reads and includes final allocation probabilities for each of the mapping locations of the multi-reads. Perm-seq also provides functionality to convert this file into a BED file where each multi-read is allocated to its best mapping position with the largest allocation probability. Such a BED file can then be used by many standard peak calling methods. We used ENCODE’s uniform ChIP-seq processing pipeline [<xref ref-type="bibr" rid="pcbi.1004491.ref024">24</xref>], which is built on the peak caller SPP [<xref ref-type="bibr" rid="pcbi.1004491.ref025">25</xref>] and irreproducible discovery rate (IDR) [<xref ref-type="bibr" rid="pcbi.1004491.ref026">26</xref>] for determining the optimal number of peaks, in the analyses presented in this paper.</p>
</sec>
<sec id="sec005">
<title>Perm-seq accurately discriminates between multiple mapping locations of multi-reads</title>
<p>The overall effect of using prior information in ChIP-seq multi-read allocation with Perm-seq is an increase in the number of detected peaks compared to analyses that utilize only uni-reads (uni-read analysis) (Fig. S3 and Tables S2 and S3 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>) and a decrease in the number of peaks compared to analyses using multi-reads without prior information (CSEM). Analysis of 64 ChIP-seq datasets from GM12878 and K562 cells resulted in an average increase of 8.0% (with a standard deviation of 13.1%) in the number of peaks when comparing uni-read analysis with Perm-seq and a decrease of 4.6% (with standard deviation 9.8%) when comparing Perm-seq with CSEM. <xref ref-type="fig" rid="pcbi.1004491.g002">Fig 2(a)</xref> summarizes the numbers of peaks and peaks overlapping across the three different peak classes, namely, uni-read, CSEM, and Perm-seq in both the optimal and the relaxed mode of peak calling for transcription factor Ctcf. Optimal peak sets are obtained at an IDR of 2%. The relaxed peak sets are super sets of the optimal peaks and include both high signal peaks and regions that do not show any ChIP enrichment. We included comparisons with the relaxed peak sets to ensure that our results hold irrespective of the specific IDR threshold used for peak calling. We observed that 1320 peaks are identified by both Perm-seq and CSEM analyses, whereas Perm-seq identified 187 peaks that are not part of CSEM optimal list, and similarly, CSEM identified 774 peaks that are not part of Perm-seq optimal peak list. We evaluated peaks specific to CSEM and Perm-seq to assess whether utilizing the prior information is eliminating false positive and false negative peaks. Fig. S4, Fig. S5, and Fig. S6 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref> display examples of each type of peak. We also provide circos plots of read allocation by Perm-seq and CSEM for a Perm-seq peak with reads distributed over four segmental duplication regions to elucidate how DNase information is guiding read allocation (<xref ref-type="fig" rid="pcbi.1004491.g002">Fig 2(b)</xref>). The three regions depicted in the circos plots span partially overlapping segmental duplications chr1:143,880,003–143,978,943, chr1:206,072,707–206,171,611, and chr1:143,880,003–144,005,301, chr1:120,872,119–249,250,621. Multi-read allocation without prior information distributes the set of multi-reads over these three regions because of the similarities in their local uni-read ChIP counts and fails to identify a peak in any of them. However, as depicted with the DNase-seq track, only one of these three regions has considerable DNase-seq signal indicating regulatory activity. Utilizing DNase-seq prior allocates most of the multi-reads to the region with high DNase-signal and successfully identifies a peak with a canonical Ctcf motif. Segmental duplication regions are defined as regions in which at least 1000 bps of the total sequence (containing at least 500 bps of non-repeat masked sequence) align with a sequence identity of at least 90% (percentage of matching bases out of the aligning bases) [<xref ref-type="bibr" rid="pcbi.1004491.ref027">27</xref>]. However, high sequence identity does not necessarily imply large fraction of non-unique, i.e., not uniquely mappable, sub-sequences (e.g., 50mers) within the aligning region. Even though ChIP-reads can map to non-unique regions within the segmental duplication, DNase reads can cover more of the uniquely mappable regions and thereby discriminate between two high sequence identity regions. Fig. S7 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref> displays the maximum and the median of the run lengths of adjacent non-unique 50mers across all the segmental duplications as a function of the alignment sequence identity. Overall, only 14.7% of the segmental duplications have a maximum run length larger than 300 bps indicating that for a majority of the segmental duplication regions, there are many mappable positions within and in the immediate vicinity of the 300 bps window a ChIP-seq peak might cover. DNase reads aligning to such bases boost the signal for the ChIP-seq peak and discriminate between highly similar regions.</p>
<fig id="pcbi.1004491.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004491.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Comparison of uni-read, CSEM, and Perm-seq analysis.</title>
<p>(a) Comparison of Ctcf optimal peak lists from uni-read, CSEM, and Perm-seq analyses. Numbers in parentheses denote comparisons of the optimal peak lists with the relaxed peak lists. For example, there are 1320 peaks identified by the Perm-seq and CSEM analyses and missed by the uni-read analyses. 664 of these peaks are still missed by the uni-read analysis even if we consider comparison of the Perm-seq and CSEM optimal peak lists with the uni-read relaxed lists. (b) Circos plots of CSEM (left) and Perm-seq (right) read allocation for reads mapping to four segmental duplication regions with coordinates chr1:143,880,003–143,978,943, chr1:206,072,707–206,171,611, and chr1:143,880,003–144,005,301, chr1:120,872,119–249,250,621. (c) Percentages of Perm-seq specific and CSEM specific peaks with the most significant motifs identified from the <italic>de novo</italic> sequence analysis of the intersection peaks, i.e., peaks common to uni-read, CSEM, and Perm-seq analysis. (d) Comparison of the Ctcf peak sets from GM12878 between Perm-seq, CSEM, Gibbs-based [<xref ref-type="bibr" rid="pcbi.1004491.ref002">2</xref>], and Lonut [<xref ref-type="bibr" rid="pcbi.1004491.ref004">4</xref>]. x.vs.Perm-seq denotes optimal peaks of method “x” not identified by Perm-seq. Similarly, Perm-seq.vs.x denotes optimal peaks of Perm-seq not identified by method “x”. (e) Annotation of the K562 peaks with respect to segmental duplications. Categories are: Prom.Dup: peaks that are in promoter regions (± 2500 bps of TSS) of RefSeq genes that reside in segmental duplications; Prom: Peaks in promoter regions (excludes peaks in Prom.Dup); Genic.Dup: peaks that are within [-10000 bps of TSS, +1000 bps of TES] of RefSeq genes that are in segmental duplications (excludes peaks in Prom.Dup); Genic: peaks that are within [-10000 bps of TSS, +1000 bps of TES] of RefSeq genes (excludes peaks in Genic.Dup, Prom.Dup); Dup: peaks that are in segmental duplications (excludes Prom.Dup and Genic.Dup); None: peaks that do not fall into any of the other defined categories. (f) Genes are ordered with respect to RNA-seq transcripts per million (TPM) values. Genes with a Common Pol2 peak in their promoters are depicted with green whereas genes with only Perm-seq-only peaks are depicted in blue.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004491.g002"/>
</fig>
<p>We further compared the peak sets from Perm-seq and CSEM with sequence analysis. We learnt the most enriched motif in the top 500 peaks of the intersection of the three peak sets (peaks from the uni-read, CSEM, and Perm-seq analyses) using the MEME suite [<xref ref-type="bibr" rid="pcbi.1004491.ref028">28</xref>] and evaluated the occurrence of this motif in the Perm-seq specific and the CSEM specific peak sets. <xref ref-type="fig" rid="pcbi.1004491.g002">Fig 2(c)</xref> displays motif occurrences in these two types of peak sets across 32 factors in GM12878 and K562 cells, respectively (Table S4 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>). On average, 13% more of the Perm-seq specific peaks have a motif occurrence compared to CSEM specific peak sets. Furthermore, 13 of the 64 Perm-seq specific peak sets exhibit at least 25% more motif occurrence compared to CSEM specific peak sets, indicating that much larger fractions of the Perm-seq only peak sets are supported by the sequence analysis. Overall, the differences in motif occurrences of the two methods in both cell types are significant with Wilcoxon-rank-sum test (p-values &lt; 0.001). <xref ref-type="fig" rid="pcbi.1004491.g002">Fig 2(d)</xref> extends this comparison on the Ctcf ChIP-seq data from GM12878 to include a Gibbs-based approach [<xref ref-type="bibr" rid="pcbi.1004491.ref002">2</xref>], which is another multi-read allocation method similar to CSEM, and Lonut [<xref ref-type="bibr" rid="pcbi.1004491.ref004">4</xref>], which is the most recently published multi-read allocation method. Overall, we observe that Perm-seq reduces numbers of peaks without motif and increases the numbers of peaks with the motif.</p>
<sec id="sec006">
<title>Data-driven computational experiments evaluating the improvement in multi-read allocation due to Perm-seq</title>
<p>In addition to evaluating the performance of Perm-seq on a large collection of ENCODE datasets, we also performed data-driven simulations to asses the improvement due to utilization of DNase-seq prior (Section 5 of <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>). These simulations used the actual DNase-seq data and generated reads using the read density estimated from the Atf3 ChIP-seq sample in GM12878 cells. Although the simulation model did not induce any model misspecification for Perm-seq, the resulting simulated data captured the mean ChIP versus DNase read count relationship observed in actual data well (data not shown). We first compared Perm-seq to CSEM, Gibbs-based [<xref ref-type="bibr" rid="pcbi.1004491.ref002">2</xref>], and a random allocation approach that randomly allocates multi-reads to one of their mapping locations. These choices were driven by the ease of the use of the software in the simulations, computational times, and the ability to provide multi-read allocation without relying on peak calling. The latter criterion is especially critical for flexibility in performing downstream peak calling. We simulated read data based on the estimated parameters from the Atf3 ChIP-seq sample from GM12878 cells and evaluated multi-read allocation accuracy for low, medium, and high sequencing depth settings. Since both the random allocation and Gibbs-based approaches assign multi-reads to a single position, we assigned multi-reads allocated by Perm-seq and CSEM to their mapping locations with the maximum allocation probabilities. In the case of two or more positions with the same largest allocation probability, i.e., ambiguous reads, we randomly assigned reads to one of these positions. Fig. S8(a) in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref> displays the proportion of correctly allocated reads at different sequencing depths and indicates that Perm-seq performs better than other three approaches at all depths. On average, Perm-seq results in an average increase of 7.7% to 15.4% compared to CSEM and 9.5% and 34.5% compared to the Gibbs-based approach. These improvements are overall much larger than the typical differences between commonly used aligners with good performances, e.g., bowtie vs. bwa [<xref ref-type="bibr" rid="pcbi.1004491.ref029">29</xref>]. Furthermore, our downstream peak level analysis indicate that these differences in multi-read allocation accuracies translate to higher sensitivity (4.6%-10% higher than CSEM and 3.4%-40.1% higher than the Gibbs-based with all standard errors less than 2% for the three settings) and better positive predictive value (3.7%-5.3% higher than CSEM with all standard errors less than 2% and 4.8%-17.6% higher than Gibbs-based with standard errors up to 2.8% for the three settings) for Perm-seq compared to CSEM and the Gibbs-based approach (Fig. S8(b) in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>).</p>
<p>We next performed a more detailed comparison between Perm-seq and CSEM to understand the added utility of using DNase-seq prior in a more controlled setting where the only difference between Perm-seq and the alternative method is the use of prior. We further stratified the results to evaluate the performances by taking into account the read ambiguity. Overall, we observe up to 20.7% (with a standard error of 0.61%) improvement by Perm-seq compared to CSEM in read allocation accuracy (Fig. S9 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>). Although the overall discrepancy between the performances of the two approaches decreases with increasing sequencing depth, Perm-seq allocates significantly more reads accurately for the cases where DNase-seq data provides discriminating power (Fig. S10(a–c) in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>). These simulations also support that the reads with Perm-seq allocation probability of at least 0.5 are more accurate and have fewer false positives and hence should lead to better downstream analysis for peak calling.</p>
<p>As a final computational experiment, we compared performances of different approaches based on a read trimming experiment. Specifically, we utilized a GM12878 Ctcf experiment with 101bps paired-end (PE) reads [<xref ref-type="bibr" rid="pcbi.1004491.ref030">30</xref>] (GEO accession number: GSM1233887) and set uni-read alignments of the original reads (PE101) as the true origin of the aligning reads. Then, we trimmed the reads and sampled one end of each read pair to generate <italic>in silico</italic> single-end datasets with read lengths 36bps, 50bps, 75bps, and 101bps. As we trimmed the reads, a fraction of PE101 uni-reads became multi-reads. Supplementary Table S5 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref> reports the proportion of correctly aligned multi-reads by different methods for each read design. Overall, we observe that Perm-seq and CSEM perform similarly and they outperform both the random allocation approach and the other multi-read mapping methods. In this particular experiment, we did not observe any gain from using prior data. Further investigation of the Perm-seq and CSEM alignment results indicated that majority of the the multi-reads that were wrongly allocated did not have discriminating DNase-seq data at their mapping locations. Although this is an instance where we are not seeing any gain from using prior data, it illustrates that Perm-seq does not lead to additional false positive alignments when DNase-seq is not providing discriminating power, i.e., impact of weak prior.</p>
</sec>
</sec>
<sec id="sec007">
<title>Perm-seq complements ENCODE-derived peak sets by identifying protein-DNA interaction sites enriched in segmental duplications</title>
<p>After studying the accuracy of Perm-seq for multi-read allocation, we sought to understand the broader impacts of incorporating multi-mapping reads in ChIP-seq analysis. In what follows, the comparisons are focused on (i) peak sets identifiable by both the uni-read and prior-enhanced multi-read analysis with Perm-seq (Common) and are obtained by intersecting optimal peak lists from uni-read and Perm-seq analyses; (ii) peak sets identifiable only with the prior-enhanced multi-read analysis with Perm-seq (Perm-seq-only), i.e., Perm-seq optimal peaks not overlapping the uni-read optimal peaks; and finally, (iii) the subset of the Perm-seq-only peaks that are not overlapping the uni-read relaxed peak sets (Perm-seq-exclusive). Overall, our Common set is highly comparable to the peak sets from the ENCODE project which utilized Bwa [<xref ref-type="bibr" rid="pcbi.1004491.ref006">6</xref>] instead of Bowtie [<xref ref-type="bibr" rid="pcbi.1004491.ref023">23</xref>] for aligning the reads.</p>
<p>We first annotated these peak sets in terms of segmental duplication regions (<xref ref-type="fig" rid="pcbi.1004491.g002">Fig 2(e)</xref> and Fig. S11 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>) and observed that both Perm-seq-only and Perm-seq-exclusive peak sets identify significantly more peaks in segmental duplication regions compared to the Common peak sets. For example, more than 60% (90%) of the Perm-seq-only (Perm-seq-exclusive) Ctcf peaks reside in segmental duplications in contrast to only 2% of the Common Ctcf peaks in segmental duplications. The largest percentage of Common peaks located in segmental duplications is only 3% across all the TFs. In contrast, for all the TFs except for Usf2, Jund, and Max, more than 30% of the Perm-seq-only peaks reside in segmental duplications. Similarly, at least 50% of all but Nfe2 Perm-seq-exclusive peaks overlap with segmental duplications. These results emphasize that characterizing regulatory activity in segmental duplications requires utilization of multi-reads.</p>
<p>Notably, Perm-seq-exclusive peak sets contain many peaks that reside in promoter regions of genes in segmental duplication regions. Our Common peak set has very similar annotation characteristics to the ENCODE peak sets [<xref ref-type="bibr" rid="pcbi.1004491.ref024">24</xref>] and that Perm-seq-exclusive peak sets enhance the ENCODE peak sets by the addition of many peaks in segmental duplication regions.</p>
<p>In Fig. S12 and Fig. S13 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>, we compared enrichment of Common and Perm-seq-exclusive peaks for other classes of repetitive elements including short and long interspersed elements (SINE and LINE retrotransposons), DNA transposons, and long terminal repeat elements (LTRs). In contrast to enrichment for segmental duplications, enrichments of peaks for these other repetitive element classes were comparable between the Common and Perm-seq-exclusive peaks for a majority of the TFs.</p>
<p>Next, we explored Pol2 peaks further to assess whether Perm-seq-only peaks contributed to interpretation of RNA-seq results in GM12878 and K562 cells. <xref ref-type="fig" rid="pcbi.1004491.g002">Fig 2(f)</xref> displays transcripts per million (TPM) on the log base 2 scale versus the rank of 3818 genes with TPM greater than 50 either in GM12878 (2957 genes) or K562 (2921 genes) cells. Genes with a Common peak in their promoters (defined as 5000 bps downstream and 500 bps upstream of the transcription start site) are depicted in green, where as genes with a Perm-seq-only peak are depicted in blue. A total of 38 and 58 genes with low mappable promoters had Pol2 peaks only identifiable with the Perm-seq analysis in the GM12878 and K562 cells, respectively. Notably, CCL4, a chemotactic cytokine, is one of such genes which is specifically expressed in GM12878 (TPM values for K562 and GM12878 are 0 and 707.27, respectively, Fig. S14 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>). It has been recently shown that CCL4 was induced in EBV-infected B cells and was expressed at high levels in all EBV-immortalized lymphoblastoid cell lines [<xref ref-type="bibr" rid="pcbi.1004491.ref031">31</xref>] (i.e., GM12787).</p>
</sec>
<sec id="sec008">
<title>Genes associated with Perm-seq-only peaks exhibit similar expression levels to those of Common peaks</title>
<p>We considered a subset of the peaks across all TFs that resided in the vicinity of genes (within -10000 bps upstream of the transcription start site and +10000 bps downstream of the transcription end site) and classified these genes into three classes as having (i) Common peaks, (ii) Common and Perm-seq-only peaks, (iii) Perm-seq-only peaks. The mean numbers of genes in each of the three categories were 4226.5, 289.5, and 217.4 for GM12878 and 4589.4, 403.9, and 190.5 for K562. We then compared RNA-seq data for these three classes of genes (<xref ref-type="fig" rid="pcbi.1004491.g003">Fig 3(a)</xref>) and observed that they have comparable expression levels, indicating that genes with only Perm-seq-only peaks are transcriptionally similar to genes that harbor Common peaks. We further evaluated the percentage of genes residing in segmental duplications within each class (<xref ref-type="fig" rid="pcbi.1004491.g003">Fig 3(b)</xref>) and observed that a significantly larger percentage of the genes with a Perm-seq-only peak resided in segmental duplications.</p>
<fig id="pcbi.1004491.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004491.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Comparison of uni-read and Perm-seq analysis.</title>
<p>(a) Distribution of expression levels of genes with (i) Common peaks; (ii) Common and Perm-seq-only peaks; (iii) Perm-seq-only peaks. (b) Percentage of genes in segmental duplications with (i) Common peaks; (ii) Common and Perm-seq-only peaks; (iii) Perm-seq-only peaks. (c) Histone modification profiles within ± 2000 bps of the summits of the Common, Perm-seq-only, and Perm-seq-exclusive Bcl3 peaks in GM12878 and K562 cells, respectively. (d) Percentages of Perm-seq-exclusive and Common peak sets with the M1 motifs from the <italic>de novo</italic> sequence analysis of the top 500 Common peaks. Common peak set percentages are replaced by the percentages of occurrences in the subset of the Common peak sets (red circles) that is matched to Perm-seq-exclusive peaks in terms of ChIP signal.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004491.g003"/>
</fig>
</sec>
<sec id="sec009">
<title>Repetitive and non-repetitive modes of protein-DNA interactions share similar chromatin signatures</title>
<p>
<xref ref-type="fig" rid="pcbi.1004491.g003">Fig 3(c)</xref> depicts (and <xref ref-type="supplementary-material" rid="pcbi.1004491.s002">S2 Text</xref> &amp; <xref ref-type="supplementary-material" rid="pcbi.1004491.s003">S3 Text</xref>) average histone modification profiles (H3k9ac, H3k27me3, H3k4me1, H3k4me3) for the [-2000 bps, +2000 bps] window anchored at the peak summit for the three groups of peaks. We observe that Peak-seq-only peaks have almost identical profiles to those of the Common peaks. Peak-seq-exclusive peaks, in general, show lower signal for all the modifications consistent with the fact that ChIP-seq signal for these peaks are also lower; however, their overall average modification profiles match closely to those of the Common and Perm-seq-only peaks.</p>
</sec>
<sec id="sec010">
<title>Repetitive and non-repetitive modes of protein-DNA interactions share similar canonical motifs that are evolutionarily less conserved in the repetitive mode</title>
<p>We next sought to understand whether protein-DNA interactions followed similar sequence-specific features in non-repetitive (Common peak sets) and repetitive (Perm-seq-exclusive peak sets) modes of binding. We performed <italic>de novo</italic> motif analysis of both sets of peaks using the MEME suite [<xref ref-type="bibr" rid="pcbi.1004491.ref028">28</xref>] (Fig. S15 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>). <italic>De novo</italic> analyses on the Perm-seq-exclusive peak sets identified motifs that matched the most significant motifs (denoted as M1 in the MEME analysis) from the <italic>de novo</italic> motif analyses of the Common peaks for 78.1% and 71% of the factors in GM12878 and K562 cells, respectively. The factors for which M1 motifs of the Common peaks were not identified <italic>de novo</italic> in the Perm-seq-exclusive sets are Bclaf1, Chd2, Ets1, Nr2c2, Sin3a, Taf1, and Tbp for GM12878 and Bcl3, Bclaf1, Chd2, Ets1, Nr2c2, Pol3rg, Sin3a, Taf1, and Tbp for K562. The majority of these factors are either chromatin modifiers (Chd2, Sin3a), general Pol2 associated factors (Taf1, Tbp), or the sizes of their Perm-seq-exclusive peak sets are smaller than 500 (Nr2c2, Polr3g, Ets1 (GM12878), Bclaf1 (K562), Bcl3). For 65.6% (GM12878) and 53.1% (K562) of the factors, the most significant motifs (M1s) from the Common peak sets were identified as the M1 motif in the Perm-seq-exclusive analysis.</p>
<p>We next compared the occurrences of the M1 motifs of the non-repetitive mode of each factor in the peak sets. We used all the Perm-seq-exclusive peaks and the subset of the Common peaks that were not utilized in the <italic>de novo</italic> motif analysis, i.e., test peaks from Fig. S15 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>. Similar results were obtained when Common peaks used in the <italic>de novo</italic> motif analysis were included (data not shown). Overall, we observed that Perm-seq-exclusive peaks tend to have lower enrichment for the M1 motif (<xref ref-type="fig" rid="pcbi.1004491.g003">Fig 3(d)</xref>). To evaluate whether this was a consequence of the overall lower ChIP signal of the Perm-seq-exclusive peaks compared to Common peaks, we considered the subset of Common peaks that matched the signal strength of the Perm-seq-exclusive peaks. <xref ref-type="fig" rid="pcbi.1004491.g003">Fig 3(d)</xref> indicates that when the signal strength is taken into account, the enrichment of the M1 motif tends to become more comparable in the non-repetitive and repetitive modes. We also compared the information contents of the M1 motifs of the Common peaks with their best matching motifs from the Perm-seq-exclusive peaks (Fig. S16 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>). This comparison revealed that the overall information contents of the <italic>de novo</italic> learnt canonical motifs are highly correlated: 0.74 (0.73) when using Common peaks versus 0.80 (0.94) when using the subset of the Common peaks that match the overall signal of the Peak-seq-exclusive peaks in GM12878 (K562) cells. Correlation calculations excluded Zbtb33 for both cell types and Srf for K562 as outliers. For these factors, the motif logos from Perm-seq-exclusive peaks revealed extended versions of the logos from Common peaks and had high information content flanking regions (Fig. S17 and Fig. S18 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>).</p>
<p>Having established that binding sites from the repetitive mode exhibit similar sequence contents to those of the binding sites in the non-repetitive mode, we evaluated evolutionary conservation of the binding sites from the two groups. Specifically, we took all the best matches to the M1 motif of the Common peak set from both of the Common and Perm-seq-exclusive peak sets and analyzed their phyloP score [<xref ref-type="bibr" rid="pcbi.1004491.ref032">32</xref>] distributions using the pre-computed phyloP scores from the UCSC Genome Browser. <xref ref-type="fig" rid="pcbi.1004491.g004">Fig 4(a)</xref> compares the phyloP conservation scores averaged over the individual binding sites within each group with an empirical cumulative distribution function plot for transcription factor Usf1. The observed pattern indicates that Perm-seq-exclusive binding sites are overall less conserved. A similar result holds for the majority of the factors (<xref ref-type="supplementary-material" rid="pcbi.1004491.s004">S4 Text</xref> &amp; <xref ref-type="supplementary-material" rid="pcbi.1004491.s005">S5 Text</xref>). A Wilcoxon-rank sum test for each of the 32 factors revealed that only four (Jund, Spi1, Srf, Tbp) and six (Max, Nfe2, Polr2a, Rest, Sin3a, Spi1) factors do not have significantly different conservation levels (adjusted p-value larger than 0.05 according to the Benjamini-Hocberg false discovery rate (FDR) control [<xref ref-type="bibr" rid="pcbi.1004491.ref033">33</xref>]) between the Common and Perm-seq-exclusive binding sites in GM12878 and K562 cells, respectively. We next considered position-specific (nucleotide level) phyloP scores. <xref ref-type="fig" rid="pcbi.1004491.g004">Fig 4(b)</xref> displays average position-specific phyloP scores for binding sites of Common and Perm-seq-exclusive peaks of Usf1. Although the overall nucleotide-level conservation scores for the Perm-seq-exclusive sites are lower than those of the Common sites, the patterns of the mean profiles are very similar and highly correlated (Pearson correlations are 0.81 and 0.85 in GM12878 and K562 cells, respectively). Furthermore, nucleotides within the motif (between vertical dashed lines) tend to have higher scores than those in the adjacent non-motif positions for the Perm-seq-exclusive binding sites. We next tested the correlations between average position-specific phyloP profiles of the Common and Perm-seq-exclusive peaks (<xref ref-type="fig" rid="pcbi.1004491.g004">Fig 4(c)</xref>). All but 5 factors (Chd2, Polr3g, Srf, Tbp, Zbtb33) have significantly correlated mean profiles of position-specific phyloP scores between the repetitive and non-repetitive modes of binding in both of the cell lines. Of the five factors with low correlation, Tbp is conserved in moderate levels in both GM12878 and K562 but does not pass the significance cut-off in GM12878 (adjusted p-value of 0.051). Profiles for the other four factors exhibit starker differences for the Common and Perm-seq-exclusive peaks. Neither Chd2 nor Polr3g are sequence-specific factors and their M1 motifs from the Common set are not identified <italic>de novo</italic> from the analyses of the Perm-seq-exclusive peaks. Serum response factor Srf is a sequence-specific transcription factor. The canonical motif for this factor is identified as the forth significant motif in GM12878 and as the first in K562 Perm-seq-exclusive peak sets. Although the correlations between conservation profiles do not achieve the significance cut-off, they exhibit reasonable correlation (0.41 in K562 with an adjusted p-value of 0.06 and 0.26 in GM12878 with an adjusted p-value of 0.17). Furthermore, there are not notable differences between the canonical motifs identified from the repetitive and non-repetitive regions of binding (Fig. S17 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>). Zbtb33 is a transcriptional regulator with bimodal DNA-binding specificity and is known to bind to methylated CGCG and the non-methylated consensus site TCCTGCNA [<xref ref-type="bibr" rid="pcbi.1004491.ref034">34</xref>]. The position-specific conservation profiles between the Common and Perm-seq-exclusive peak sets exhibit significant lack of correlation, especially at the CGCG core (<xref ref-type="fig" rid="pcbi.1004491.g004">Fig 4(d)</xref>). The “G” nucleotide of the first CpG in the core shows accelerated evolution with a negative phyloP score in K562 and the sequence logos of both of the motifs from GM12878 and K562 Perm-seq-exclusive peaks reveal a degenerate position at this location of the “CGCG” core (Fig. S18 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>). This raises the possibility of Zbtb33 interaction with unmethylated or partially methylated CGCG. To assess this, we calculated the fraction of the Common peaks that exhibited methylation at the CGCG core. Comparisons with the ENCODE Reduced Representation Biosulphite Sequencing (RRBS) data revealed that only 26.3% and 17.2% of CGCGs were methylated in the Common peaks with at least one CGCG core, in GM12878 and K562 cells respectively. This result supports Zbtb33 interaction with unmethylated CGCGs and the possibility of a more degenerate CGCG core for the Zbtb33 motif in the repetitive mode.</p>
<fig id="pcbi.1004491.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004491.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Conservation analysis of the common and Perm-seq-exclusive peak sets.</title>
<p>(a) Empirical cumulative distribution functions (CDFs) for average phyloP scores of Usf1 binding sites from the Common and Perm-seq-exclusive Usf1 peaks in GM12878 and K562 cells, respectively. Positive scores indicate conservation and negative scores indicate acceleration. (b) Mean position-specific phyloP scores of the Usf1 binding sites for Common and Perm-seq-exclusive Usf1 peaks in GM12878 and K562, respectively. Shaded areas denote ± one standard error of the mean profile. (c) Pearson correlations between the mean position-specific phyloP scores of the binding sites from the Common and Perm-seq-exclusive peak sets. Purple and red circles indicate that correlations are not significantly different than zero only in GM12878 and in both GM12878 and K562 cells, respectively. (d) Mean position-specific phyloP scores of the Zbtb33 binding sites from the Common and Perm-seq-exclusive Zbtb33 peaks in GM12878 and K562 cells, respectively.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004491.g004"/>
</fig>
</sec>
</sec>
<sec id="sec011">
<title>Perm-seq with with multiple sources of data</title>
<p>The core of the Perm-seq methodology relies on the innovation of incorporating DNase-seq data to derive priors for read allocation probabilities with a Dirichlet-multinomial regression model. This regression framework is highly versatile and can easily accommodate incorporation of other epigenomic data for prior construction. Various histone modifications contribute different putative functions to gene regulation. For example, acetylation of H3k27 and H3k9 are associated with gene activation, trimethylations of H3k27 and H3k9 are linked to repression and H3k4me1, H3k4me2, and H3k4me3 are correlated with functional enhancers/promoters in various cell types [<xref ref-type="bibr" rid="pcbi.1004491.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1004491.ref036">36</xref>].</p>
<p>Perm-seq incorporates multiple histone datasets as additional covariates in the Dirichlet-multinomial regression model and employs a variable selection procedure with Group Lasso [<xref ref-type="bibr" rid="pcbi.1004491.ref037">37</xref>] to select the histones that are most relevant for read allocation (work-flow in Fig. S19 of <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>).</p>
<sec id="sec012">
<title>Perm-seq analysis with histone ChIP-seq in addition to DNase-seq provides further discriminating power between read mapping positions</title>
<p>We reanalyzed a subset of the ENCODE ChIP-seq datasets (Atf3, Ctcf, Rest, Sin3a, Egr1, Ep300 from GM12878 cells) by utilizing 11 histone ChIP-seq datasets (H2a.z, H3k27ac, H3k27me3, H3k36me3, H3k4me1, H3k4me2, H3k4me3, H3k79me2, H3k9ac, H3k9me3, H4k20me1). In this set, Atf3 and Ctcf function as both transcriptional activators and repressors, Rest and Sin3a are repressors, and Egr1 and Ep300 are activators [<xref ref-type="bibr" rid="pcbi.1004491.ref038">38</xref>]. Table S6 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref> lists the final set of histone marks that were selected for each TF. We observe that histone variant H2a.z and modifications H3k27ac and H3k27me3 significantly contributed to prior construction for at least five of the six datasets. Overall, inclusion of multiple histone data in prior construction resulted in an increase of numbers of peaks for Atf3, Ctcf, and Ep300 and a decrease for the rest of the factors compared to Perm-seq analysis with only DNase-seq (Table S7 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>). On average, the change in the numbers of peaks with the inclusion of histone datasets were much smaller (0.99%) compared to the overall change in the numbers of peaks with and without prior information (4.6%) and with and without multi-reads (8%).</p>
<p>We performed detailed analysis of Perm-seq peaks obtained with DNase alone and DNase and Histone ChIP-seq and did not observe significant differences between the motif occurrence percentages in these peak sets. <xref ref-type="fig" rid="pcbi.1004491.g005">Fig 5(a)</xref> displays the DNase and Histone modification profiles of Ctcf peaks in the Perm-seq analysis. Utilizing histone ChIP-seq in addition to DNase-seq eliminates peaks with low DNase-seq read counts and lacking histone support. The majority of Ctcf Perm-seq-specific (DNase) peaks are located within low DNase and low histone signal regions, with an average DNase read count of 18.94 and average histone read count of 5 (<xref ref-type="fig" rid="pcbi.1004491.g005">Fig 5(a)</xref> (upper panel)). Incorporation of histone datasets identifies novel peaks supported by histone profiles. For the Perm-seq-specific (DNase+Histone) peaks, the average DNase read count is 30.18 and average H2a.z count is 19.51. Further investigation of these regions indicate that additional support from the histone profiles enable discrimination between mapping positions with similar DNase-seq profiles. Fig. S20 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref> provides circos plots of read allocation by Perm-seq-specific (DNase) and Perm-seq-specific (DNase+Histone) for a Perm-seq-specific (DNase+Histone) peak with reads distributed over two segmental duplication regions and elucidates how additional histone information is guiding read allocation. The two regions depicted in the circos plots span partially overlapping segmental duplication regions (chr1: 83,647,856–83,955,427 and chr7: 76,280,701–76,575,579). Multi-read allocation by Perm-seq using only DNase data fails to distribute the set of multi-reads to a single region because of low DNase read counts in both of the regions and, hence, does not identify a peak in any of them. However, as depicted with the H2a.z and H3k27ac tracks (the second and third tracks), only one of these two regions has considerable H2a.z, a variant of histone H2a associated with regulatory elements within dynamic chromatin [<xref ref-type="bibr" rid="pcbi.1004491.ref039">39</xref>], and H3k27ac, mark of active regulatory elements. Utilizing histone information allocates majority of the multi-reads to the region supported by histone information and identifies a peak with a motif.</p>
<fig id="pcbi.1004491.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004491.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Perm-seq analysis of GM12878 Ctcf and Sin3a ChIP-seq dataset with DNase-seq and Histone ChIP-seq priors.</title>
<p>(a) Heatmap of normalized DNase-seq and Histone ChIP-seq read counts for the [-1000 bps, +1000 bps] window anchored at GM12878 Ctcf peak summits depicted by the vertical dashed lines. Perm-seq-specific (DNase+Histone): Perm-seq optimal peaks using DNase-seq and Histone ChIP-seq in prior construction. These peaks are not identified when using only DNase-seq for prior construction or with CSEM. Perm-seq-specific (DNase): Perm-seq optimal peaks using only DNase-seq in prior construction. These peaks are not identified when using DNase-seq and Histone ChIP-seq for prior construction or with CSEM. (b) Heatmap of normalized DNase-seq and H2a.z ChIP-seq read counts for the [-500 bps, +500 bps] window anchored at GM12878 Sin3a peak summits. Perm-seq-specific (DNase): Perm-seq optimal peaks using DNase-seq in prior construction. These peaks are not identified when using only H2a.z ChIP-seq for prior construction or with CSEM. Perm-seq-specific (H2a.z): Perm-seq optimal peaks using only H2a.z ChIP-seq in prior construction. These peaks are not identified when using DNase-seq for prior construction or with CSEM. Next best mapping positions of Perm-seq-specific (DNase) peaks denote the regions where the multi-reads of the peaks map with the next best total allocation scores, i.e., ranked second compared to the allocation scores at the actual peaks.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004491.g005"/>
</fig>
<p>We next explored Egr1 Perm-seq (DNase) specific peaks. Most of these peaks show both strong DNase and histone signals (Fig. S21 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>), yet they are not identified by the Perm-seq (DNase+Histone) analysis. We compared the DNase and histone signals of these peak regions with the signal in the next best alternative mapping regions (mapping regions with the second largest allocation weights compared to peaks). In Fig. S21 of <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>, we observe histone signal both in the next best alternative mapping regions (left panel) and peak regions (right panel). Furthermore, very few peak regions have DNase and histone signal consistently higher than those of the next best possible mapping regions, leading to Perm-seq analysis with both DNase and Histone to miss these regions.</p>
<sec id="sec013">
<title>Perm-seq with H2a.z ChIP-seq performs comparatively to Perm-seq with DNase-seq</title>
<p>We next sought to understand whether the information contributed by DNase can be captured by any single histone modification. Since H2a.z was selected in prior construction for all the six factors (Table S6 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>) and its marginal association with ChIP read counts was most similar to that of the DNase read counts with the ChIP read counts (Fig. S22 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>), we compared Perm-seq with H2a.z ChIP-seq versus DNase-seq for prior construction. Overall, both data sets as priors led to similar numbers of peaks with Perm-seq (Table S8 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>). Furthermore, the set of common peaks identified by using either of the data types as prior was generally larger than the peak sets specific to either of the priors for all the TFs except Sin3a. We next investigated the peak set differences. In general, more Perm-seq-specific (DNase) peaks are associated with strong DNase signal. We defined regions with read counts larger than the 99-th percentile of the read count distribution as strong signal regions. On average, 46% (with a standard deviation of 18.5%) of Perm-seq-specific (DNase) peaks are within strong DNase signal regions compared to 25% (with a standard deviation of 17.1%) within strong H2a.z regions. In contrast, on average 42.5% (with a standard deviation of 11.8%) of the Perm-seq-specific (H2a.z) peaks are associated with strong H2a.z signal while only 27.2% (with a standard deviation of 9.1%) are associated with strong DNase signal. This suggests that peaks in the set differences are similarly supported by their respective data types used for prior construction.</p>
<p>We next focused on Sin3a since Perm-seq peaks with DNase and H2a.z priors differ the most for this factor. Surprisingly, the percentage of Perm-seq-specific (DNase) peaks residing in strong H2a.z signal regions is 47.0%, as high as the percentage of peaks residing in strong DNase signal regions, which is 54.8%. <xref ref-type="fig" rid="pcbi.1004491.g005">Fig 5(b)</xref> (top 2 panels) displays H2a.z and DNase profiles for Sin3a Perm-seq-specific (DNase) peaks and the next best mapping regions (with second largest allocation probability of the reads). We observe that peaks and the next best alternative regions show comparable H2a.z signal while only the peaks exhibit much stronger DNase signal. Therefore, Perm-seq using DNase prior successfully allocates multi-reads to the peaks while H2a.z fails to discriminate between the two mapping regions. Majority of the Perm-seq-specific (H2a.z) peaks have low DNase read counts as depicted in <xref ref-type="fig" rid="pcbi.1004491.g005">Fig 5(b)</xref> (third panel) and, therefore, cannot be identified by Perm-seq with DNase prior. For other TFs, the peak lists obtained by Perm-seq using different priors are quite consistent. Overall, H2a.z ChIP-seq seems to be an equally powerful alternative to DNase-seq for allocating multi-reads with prior information.</p>
</sec>
</sec>
</sec>
<sec id="sec014" sec-type="conclusions">
<title>Discussion</title>
<p>Understanding the nature of protein-DNA interactions in highly repetitive regions of the genome remains a major challenge in deciphering the human transcriptional regulatory code. To expand the capability of ChIP-seq experiments for profiling repetitive regions of genomes, we developed a prior-enhanced read mapping method named Perm-seq that capitalizes on DNase-seq and histone ChIP-seq data and read counts of local neighbourhoods of mapping locations to discriminate between multiple alignment positions of the same read. Perm-seq analysis of a large collection of ENCODE ChIP-seq datasets from GM12878 and K562 cells revealed that Perm-seq leads to higher sequencing depths and, more importantly, identification of novel targets in segmental duplication regions as well as other repetitive regions. We found that these novel targets, to a large extent, share the same sequence characteristics of the known canonical binding sites of the studied TFs. Conservation analysis indicated that canonical binding sites in these regions are evolutionary less conserved compared to their counterparts in non-repetitive regions; however, the patterns of nucleotide-level conservations correlate well between the repetitive and non-repetitive region binding sites. By integrating ChIP-seq data of Pol2 with RNA-seq data, we found that many highly expressed genes originally thought not have Pol2 occupancy in the promoter regions with uni-read analysis of ChIP-seq data indeed have Pol2 peaks revealed by Perm-seq analysis.</p>
<p>Perm-seq assumes that DNase-seq data harbors information regarding the nature of the protein-DNA interactions and the prior building step learns the specifics of this relationship. For most transcription factors, protein-DNA interactions occur in regions of accessible chromatin. However, a number of proteins, e.g., KRAB-associated factors) are observed to bind to inaccessible chromatin [<xref ref-type="bibr" rid="pcbi.1004491.ref040">40</xref>]. Exploratory plots such as Fig. S2 of <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref> indicate whether DNase-seq priors are informative. If this plot does not reveal a systematic relationship between the ChIP and DNase counts, the prior building step generates non-informative priors and, hence, Perm-seq is not expected to improve over methods that do not utilize priors. We also explored the use of multiple histone ChIP-seq datasets in addition to DNase-seq for constructing priors. Although we observed that histone ChIP-seq, in addition to DNase-seq, could further discriminate between the mapping positions, the gain due to using additional histone ChIP-seq was not as large as that of the gain due to using DNase-seq as prior as opposed to no priors. Furthermore, H2a.z ChIP-seq performed as a comparable alternative to DNase-seq for prior construction.</p>
<p>The DNase-seq samples we used have moderate sequencing depths (approximately 61M aligned reads for Huvec, 63M for GM12878, and 49M for K562). We observe that, as expected, the discriminative power of DNase-seq attenuates with lower depths as illustrated in Fig. S23 of <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>. Therefore, we recommend prior construction with high quality DNase-seq data with at least 15–20M reads as recommended by the ENCODE consortium [<xref ref-type="bibr" rid="pcbi.1004491.ref024">24</xref>]. Finally, we focused on read allocation for TF ChIP-seq experiments. The overall framework should also be useful for multi-read allocation of ChIP-experiments for punctuated histone marks.</p>
<p>The current implementation of the Perm-seq pipeline is available at <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="https://github.com/keleslab/permseq">https://github.com/keleslab/permseq</ext-link>.</p>
</sec>
<sec id="sec015" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec016">
<title>Perm-seq generative model</title>
<p>The initial step of Perm-seq is to align reads to the reference genome with a standard aligner that can report both uni- and multi-mapping reads. We utilized Bowtie [<xref ref-type="bibr" rid="pcbi.1004491.ref023">23</xref>] for this task and retained reads with at most 2 mismatches and fewer than 100 reported alignments. These initial aligned set of reads were then modelled with the Perm-seq generative model to probabilistically allocate multi-mapping reads to their mapping locations using DNase-seq data as a prior. We next provide mathematical details of the Perm-seq model.</p>
<p>Let <italic>N</italic> be the number of reads, i.e., sequencing depth, and <italic>M</italic> be the number of genomic positions. Let <italic>i</italic> = 1, …, <italic>N</italic> denote the index for reads, <italic>j</italic> = 1, …, <italic>M</italic> for positions. Let <bold>Z</bold><sub><italic>i</italic></sub> = (<italic>Z</italic><sub><italic>i</italic>1</sub>, …, <italic>Z</italic><sub><italic>iM</italic></sub>) be the true origin indicator for the <italic>i</italic>-th read. If the <italic>i</italic>-th read is generated from <italic>j</italic>-th position, then <italic>Z</italic><sub><italic>ij</italic></sub> = 1 and <italic>Z</italic><sub><italic>ij</italic>′</sub> = 0, for <italic>j</italic>′ ≠ <italic>j</italic>. We assume that {<bold>Z</bold><sub><italic>i</italic></sub>, <italic>i</italic> = 1, …, <italic>N</italic>} are independent and from a multinomial distribution with parameter vector <italic>π</italic> = (<italic>π</italic><sub>1</sub>, …, <italic>π</italic><sub><italic>M</italic></sub>). Here, <italic>π</italic> is the density function for generating reads, and specifically, <italic>P</italic>(<italic>Z</italic><sub><italic>ij</italic></sub> = 1) = <italic>π</italic><sub><italic>j</italic></sub>. In this generative model, <bold>Z</bold><sub><italic>i</italic></sub>s are not directly observable since multi-reads can align to multiple locations on the reference genome. Hence, <bold>Z</bold><sub><italic>i</italic></sub> are hidden random variables. As a result of alignment, we observe binary vectors <bold>Y</bold><sub><italic>i</italic></sub> = (<italic>Y</italic><sub><italic>i</italic>1</sub>, …, <italic>Y</italic><sub><italic>iM</italic></sub>) where <italic>Y</italic><sub><italic>ij</italic></sub> = 1 if <italic>i</italic>-th read is aligned to <italic>j</italic>-th position on the genome and <italic>Y</italic><sub><italic>ij</italic></sub> = 0 otherwise. If the <italic>i</italic>-th read is a uni-read, then <inline-formula id="pcbi.1004491.e001"><alternatives><graphic id="pcbi.1004491.e001g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e001"/><mml:math id="M1" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. If the <italic>i</italic>-th read aligns to <italic>k</italic> different positions with <italic>k</italic> &gt; 1, then <inline-formula id="pcbi.1004491.e002"><alternatives><graphic id="pcbi.1004491.e002g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e002"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. For both uni- and multi-reads, <inline-formula id="pcbi.1004491.e003"><alternatives><graphic id="pcbi.1004491.e003g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e003"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Defining <italic>L</italic><sub><italic>i</italic></sub> = {<italic>j</italic>:<italic>Z</italic><sub><italic>ij</italic></sub> = 1} as the actual position read <italic>i</italic> originates from and <italic>h</italic><sub><italic>ij</italic></sub> = <italic>Pr</italic>(<italic>Y</italic><sub><italic>i</italic></sub> ∣ <italic>L</italic><sub><italic>i</italic></sub> = <italic>j</italic>), we have <inline-formula id="pcbi.1004491.e004"><alternatives><graphic id="pcbi.1004491.e004g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e004"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">Y</mml:mi> <mml:mi mathvariant="bold">i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold">Z</mml:mi> <mml:mi mathvariant="bold">i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Under the assumption that the true origin <italic>L</italic><sub><italic>i</italic></sub> is one of the observed alignment positions, we have <italic>h</italic><sub><italic>ij</italic></sub> = <italic>Y</italic><sub><italic>ij</italic></sub>.</p>
<p>To utilize DNase-seq data, we assign a Dirichlet prior distribution to <bold><italic>π</italic></bold> with the following density function:
<disp-formula id="pcbi.1004491.e005"><alternatives><graphic id="pcbi.1004491.e005g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e005"/><mml:math id="M5" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mi>D</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">π</mml:mi> <mml:mo>;</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Γ</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mo>+</mml:mo></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:mo>Γ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mspace width="1pt"/><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msubsup><mml:mi>π</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:msub><mml:mi>γ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where Γ(.) is the Gamma function, <inline-formula id="pcbi.1004491.e006"><alternatives><graphic id="pcbi.1004491.e006g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e006"/><mml:math id="M6" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>γ</mml:mi> <mml:mo>+</mml:mo></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1004491.e007"><alternatives><graphic id="pcbi.1004491.e007g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e007"/><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Then, we define intermediate variables <italic>S</italic><sub><italic>j</italic></sub>, <italic>S</italic><sub><italic>j</italic></sub> ≥ 0 as the pseudo counts added to position <italic>j</italic>, <italic>j</italic> = 1, ⋯, <italic>M</italic> and set <italic>γ</italic><sub><italic>j</italic></sub> = <italic>S</italic><sub><italic>j</italic></sub> + 1, which enforces <italic>γ</italic><sub><italic>j</italic></sub> ≥ 1 to avoid negative component values in the maximization (M) step in estimation of the allocation probabilities.</p>
<p>DNase-seq data informs the prior parameters with a Dirichlet-multinomial regression by assuming that <italic>S</italic><sub><italic>j</italic></sub> depends on DNase read counts <italic>x</italic><sub><italic>j</italic></sub> via the following log-linear model with B-splines:
<disp-formula id="pcbi.1004491.e008"><alternatives><graphic id="pcbi.1004491.e008g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e008"/><mml:math id="M8" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>∼</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mn mathvariant="bold-italic">1</mml:mn></mml:msub> <mml:mi mathvariant="bold-italic">S</mml:mi> <mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>M</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where <bold><italic>SP</italic></bold>(.) is a vector of piece-wise linear B-spline basis functions and <italic>β</italic><sub>1</sub> are the set of associated parameters. Let <bold><italic>x</italic></bold> = (<italic>x</italic><sub>1</sub>, …, <italic>x</italic><sub><italic>M</italic></sub>). Then, we can rewrite <xref ref-type="disp-formula" rid="pcbi.1004491.e005">Eq (1)</xref> by conditioning on <italic>x</italic> as:
<disp-formula id="pcbi.1004491.e009"><alternatives><graphic id="pcbi.1004491.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e009"/><mml:math id="M9" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mi>D</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">π</mml:mi> <mml:mo>;</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mn mathvariant="bold-italic">1</mml:mn></mml:msub> <mml:mo>,</mml:mo></mml:mrow> <mml:mo>∣</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Γ</mml:mo> <mml:mo>{</mml:mo> <mml:mi>M</mml:mi> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:mo form="prefix">exp</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mn mathvariant="bold-italic">1</mml:mn></mml:msub> <mml:mi mathvariant="bold-italic">S</mml:mi> <mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:mo>Γ</mml:mo> <mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mn mathvariant="bold-italic">1</mml:mn></mml:msub> <mml:mi mathvariant="bold-italic">S</mml:mi> <mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mo>}</mml:mo></mml:mrow></mml:mfrac> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msubsup><mml:mi>π</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo form="prefix">exp</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mn mathvariant="bold-italic">1</mml:mn></mml:msub> <mml:mi mathvariant="bold-italic">S</mml:mi> <mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:msubsup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula></p>
<p>When incorporating multiple histones ChIP-seq datasets, we first convert histone read counts into trinary enrichment indicators indicating low, median, and strong signal strengths. Specifically, for a given histone ChIP-seq dataset, positions with read counts smaller than 90-th percentile of the overall read count distribution are set as non-enriched (0), positions with read counts smaller than 99-th percentile but larger than 90-th percentile are set as moderately-enriched (1), and positions with read counts larger than the 99-th percentile are set as enriched (2). Unlike DNase-seq which measures the extent of chromatin accessibility, histone ChIP-seq identifies regions exhibiting histone modifications, i.e., the true underlying states in a histone ChIP-seq experiment is modified versus unmodified as opposed to a continuous scale. The inclusion of a moderately-enriched group is due to the fact that the multi-read only peaks, in general, exhibit lower signal for all the modifications but their average modification profiles match to those of common peaks that can be identified by both uni- and multi-reads as illustrated in <xref ref-type="fig" rid="pcbi.1004491.g003">Fig 3(c)</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004491.s002">S2 Text</xref> &amp; <xref ref-type="supplementary-material" rid="pcbi.1004491.s003">S3 Text</xref>.</p>
<p>Let <italic>N</italic><sub><italic>h</italic></sub> denote the number of histone ChIP-seq datasets and define <bold>h</bold><sub><italic>j</italic></sub> = (<bold>h</bold><sub>1<italic>j</italic></sub>, …, <bold>h</bold><sub><italic>N<sub>h</sub> j</italic></sub>), where <bold>h</bold><sub><italic>ij</italic></sub> is the dummy variable of i-th histone’s trinary indicator at j-th position. Let <bold>h</bold> = (<bold>h</bold><sub>1</sub>, …, <bold>h</bold><sub><italic>M</italic></sub>) and <bold><italic>β</italic></bold><sub>2</sub> be a vector valued parameter associated with the histone ChIP-seq datasets. Then, <xref ref-type="disp-formula" rid="pcbi.1004491.e009">Eq (3)</xref> can be extended as:
<disp-formula id="pcbi.1004491.e010"><alternatives><graphic id="pcbi.1004491.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e010"/><mml:math id="M10" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">π</mml:mi> <mml:mo>;</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Γ</mml:mo> <mml:mo>{</mml:mo> <mml:mi>M</mml:mi> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:mo form="prefix">exp</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mtext mathvariant="bold">SP</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi mathvariant="bold">h</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>]</mml:mo> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:mo>Γ</mml:mo> <mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mtext mathvariant="bold">SP</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi mathvariant="bold">h</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>]</mml:mo> <mml:mo>}</mml:mo></mml:mrow></mml:mfrac> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msubsup><mml:mi>π</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo form="prefix">exp</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mtext mathvariant="bold">SP</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi mathvariant="bold">h</mml:mi> <mml:mi mathvariant="bold-italic">j</mml:mi></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:msubsup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula></p>
</sec>
</sec>
<sec id="sec017">
<title>Parameter estimation in the Perm-seq model</title>
<p>Theoretically, <bold><italic>π</italic></bold>, <italic>β</italic><sub>0</sub>, and <bold><italic>β</italic><sub>1</sub></bold> can be estimated simultaneously via the Expectation(E)-Maximization(M)-Smoothing(S) algorithm [<xref ref-type="bibr" rid="pcbi.1004491.ref041">41</xref>]. However, since prior parameters <italic>β</italic><sub>0</sub> and <bold><italic>β</italic><sub>1</sub></bold> do not have closed form estimators, simultaneous estimation of all three parameters require repeated numerical optimization in the maximization step of the EMS algorithm. To avoid such high computational cost, we first estimate the prior parameters <italic>β</italic><sub>0</sub> and <bold><italic>β</italic><sub>1</sub></bold> and then estimate <bold><italic>π</italic></bold> while keeping these prior parameter estimates fixed. Our data-driven computational experiments indicate that this estimation procedure can reliably estimate the read density (Fig. S10(d) in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>).</p>
<p>When estimating <italic>β</italic><sub>0</sub> and <bold><italic>β</italic><sub>1</sub></bold>, we first fit the log-linear model (2) using data from positions with only uni-reads with a data aggregation strategy. In the case of uni-reads, <italic>S</italic><sub><italic>j</italic></sub> can be replaced by the actual ChIP read counts. We group positions 1, …, <italic>M</italic> with the same DNase read counts and average <italic>S</italic><sub><italic>j</italic></sub> within each group. When using both DNase and histone data, <italic>S</italic><sub><italic>j</italic></sub> is averaged across positions with the same DNase read counts and combinatorial histone patterns. To avoid the potential estimation bias from regions with ultra-low DNase read counts, we group positions with 0, 1, 2 DNase read counts together. To further decrease computational complexity, we pool positions with ultra-high DNase read counts (larger than the 99.95-th percentile of the DNase read count distribution) together. Then, we put knots at the 90, 99, and 99.9-th percentiles of the averaged DNase read counts and fit the log linear model using these aggregated data. This set of knot points was well supported by our large scale analysis of ENCODE data. When multiple histone ChIP-seq datasets are available for prior construction, we employ Group Lasso [<xref ref-type="bibr" rid="pcbi.1004491.ref037">37</xref>] on the aggregated data to select the most relevant histone datasets. Once we obtain the estimates <inline-formula id="pcbi.1004491.e011"><alternatives><graphic id="pcbi.1004491.e011g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e011"/><mml:math id="M11" display="inline" overflow="scroll"><mml:mover accent="true"><mml:msub><mml:mi>β</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004491.e012"><alternatives><graphic id="pcbi.1004491.e012g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e012"/><mml:math id="M12" display="inline" overflow="scroll"><mml:mover accent="true"><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mn mathvariant="bold-italic">1</mml:mn></mml:msub> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, we use the EMS algorithm to estimate <bold><italic>π</italic></bold> as follows. Let <bold><italic>π</italic></bold><sup>(<italic>t</italic>)</sup> denote the estimate of <bold><italic>π</italic></bold> from the <italic>t</italic>-th iteration,
<list list-type="simple"><list-item><p><bold>E-step:</bold> Taking expectation of <bold>Z</bold><sub><italic>ij</italic></sub> conditional on observed read alignments <bold>Y</bold>, we obtain
<disp-formula id="pcbi.1004491.e013"><alternatives><graphic id="pcbi.1004491.e013g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e013"/><mml:math id="M13" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>≡</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">π</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:msub> <mml:mo>[</mml:mo> <mml:msub><mml:mi mathvariant="bold">Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mi mathvariant="bold">Y</mml:mi> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">y</mml:mi></mml:mrow> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:msubsup><mml:mi>π</mml:mi> <mml:mrow><mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>R</italic><sub><italic>i</italic></sub> is the set of positions that the <italic>i</italic>-th read aligns to and 1(.) is the indicator function.</p></list-item> <list-item><p><bold>M-step:</bold> In the M-step, we obtain an intermediate estimate of <italic>π</italic><sub><italic>j</italic></sub> denoted by <inline-formula id="pcbi.1004491.e014"><alternatives><graphic id="pcbi.1004491.e014g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e014"/><mml:math id="M14" display="inline" overflow="scroll"><mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1004491.e015"><alternatives><graphic id="pcbi.1004491.e015g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e015"/><mml:math id="M15" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi> <mml:mi>N</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>[</mml:mo> <mml:mover accent="true"><mml:msub><mml:mi>β</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>^</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:mover accent="true"><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mn mathvariant="bold-italic">1</mml:mn></mml:msub> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi> <mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:mo form="prefix">exp</mml:mo> <mml:mo>[</mml:mo> <mml:mover accent="true"><mml:msub><mml:mi>β</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>^</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:mover accent="true"><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi> <mml:mn mathvariant="bold-italic">1</mml:mn></mml:msub> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi> <mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p></list-item> <list-item><p><bold>S-step:</bold> In the S-step, we smooth <inline-formula id="pcbi.1004491.e016"><alternatives><graphic id="pcbi.1004491.e016g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e016"/><mml:math id="M16" display="inline" overflow="scroll"><mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> with a moving average smoother to obtain <inline-formula id="pcbi.1004491.e017"><alternatives><graphic id="pcbi.1004491.e017g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e017"/><mml:math id="M17" display="inline" overflow="scroll"><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1004491.e018"><alternatives><graphic id="pcbi.1004491.e018g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004491.e018"/><mml:math id="M18" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>w</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mi>w</mml:mi></mml:mrow> <mml:mrow><mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mi>j</mml:mi> <mml:mo>+</mml:mo> <mml:mi>w</mml:mi></mml:mrow></mml:munderover> <mml:msubsup><mml:mi>μ</mml:mi> <mml:mrow><mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>w</italic> is the half size of the smoothing window. The moving average smoother was also adapted by CSEM where 2<italic>w</italic> + 1 was set to the average library size. This choice was well supported by the computational experiments in CSEM. Estimation with the extended histone ChIP-seq datasets follow the same procedure with the density of <italic>π</italic> given in <xref ref-type="disp-formula" rid="pcbi.1004491.e010">Eq (4)</xref>.</p></list-item></list></p>
<sec id="sec018">
<title>Perm-seq analysis of ENCODE data</title>
<p>All of the data files used in the analysis are listed in Supplementary Tables S8–S10. After processing of all the fastq files with Perm-seq, we assigned each multi-read to its best mapping position if the allocation probability at that position exceeded 0.5, i.e., multi-reads with maximum allocation probability less than 0.5 were discarded. Although this approach is more conservative than utilizing all the multi-mapping reads and all the positions that they are allocated to, it makes the final alignment files compatible with the ENCODE’s ChIP-seq uniform processing pipeline. We used the peak calling and IDR parameters adopted by the ENCODE pipeline and set the IDR to 0.02. This resulted in both optimal peak lists and relaxed peak lists for each factor in both the uni-read and Perm-seq analyses. The Common peak set for each TF is defined as the peaks common to uni-read and Perm-seq optimal peak lists. Perm-seq-only peaks include those that are in the Perm-seq optimal list but not in the optimal list of the uni-read analysis. To identify the set of Perm-seq-only peaks that are extremely unlikely to be identified with the uni-read analysis, we extended the uni-read optimal list with <italic>n</italic><sub>opt</sub> peaks to a total of 5<italic>n</italic><sub>opt</sub> peaks by taking the top 5<italic>n</italic><sub>opt</sub> relaxed peaks. Then, we defined the Perm-seq-exclusive peak sets as the subsets of the Perm-seq-only peak sets that were not part of these relaxed uni-read peak list.</p>
</sec>
<sec id="sec019">
<title>Sequence analysis of peaks</title>
<p>Sequence analysis of the Common and Perm-seq-exclusive peak sets included <italic>de novo</italic> motif finding with the MEME Suite [<xref ref-type="bibr" rid="pcbi.1004491.ref028">28</xref>] using ± 50 bps of summit of the top 500 peaks. For each peak set, we identified the top 5 motifs (M1 to M5) with the smallest E-values (Fig. S15 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref>). Then, the rest of the peak sets were scanned with the fimo tool of the MEME Suite using the default p-value cut-off of 1e-4 for the occurrences of the identified motifs within sequences spanning ± 150 bps of the peak summits. For evaluating the degeneracy of the motifs identified from Perm-seq-exclusive peaks, we generated a subset of the Common peaks that matched the Perm-seq-exclusive peaks in signal strength reported by the peak caller SPP. This set included all the Common peaks with peak signal strengths within the minimum and third quantile of the signal strength of the Perm-seq-exclusive peaks.</p>
</sec>
<sec id="sec020">
<title>Information content calculations of the <italic>de novo</italic> learnt motifs</title>
<p>We manually compared the most significant motif (M1) of the Common peak set with the five motifs (M1–M5) from the Perm-seq-exclusive peak set for each TF. If the M1 motifs of the Common peak sets were not identified in the Perm-seq-exclusive motif sets, we considered the canonical motifs (as defined in literature for each factor) identified <italic>de novo</italic> in the Common peak sets. The factors for which neither the M1 nor the canonical motif from the Common peak sets were identified the among the M1–M5 of the Perm-seq-exclusive peak sets were excluded from the information content analysis. Then, for each motif pair (M1 or canonical from the Common peak set and the corresponding motif from the Perm-seq-exclusive peak set for each TF), we identified the longest sub-motifs with the highest sequence similarity and extended the flanking bases of the sub-motifs to either the full motif lengths or the first non-degenerate position that did not match between the motifs. The information content of each extended sub-motif was calculated [<xref ref-type="bibr" rid="pcbi.1004491.ref042">42</xref>] for comparison.</p>
</sec>
<sec id="sec021">
<title>ChIP-seq aggregation profiles of histone modifications</title>
<p>Histone ChIP-seq datasets were processed with CSEM and reads with allocation probability larger than 0.9 were utilized after being extended to the average library size of 200 bps to calculate aggregation profiles. For each genomic coordinate around the ± 2000 bps of the peak summit, the number of extended reads within a 151 bps window were averaged to generate a smooth aggregation profile. Each profile was then normalized to 1 million reads and the profiles for a given peak set were averaged coordinate-wise. The profile plots were generated using the <monospace>Segvis</monospace> R package (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="https://github.com/keleslab/Segvis">https://github.com/keleslab/Segvis</ext-link>).</p>
</sec>
<sec id="sec022">
<title>Software availability</title>
<p>The perm-seq algorithm is implemented as an <monospace>R</monospace> package named <monospace>permseq</monospace> and is freely available from <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="https://github.com/keleslab/permseq">https://github.com/keleslab/permseq</ext-link>. The raw datafiles listed in Tables S9, S10, and S11 in <xref ref-type="supplementary-material" rid="pcbi.1004491.s001">S1 Text</xref> are available at the ENCODE portal of the UCSC Genome Browser (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://hgdownload.cse.ucsc.edu/goldenpath/hg19/encodeDCC/">http://hgdownload.cse.ucsc.edu/goldenpath/hg19/encodeDCC/</ext-link>). Perm-seq results are available at <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="ftp://ftp.cs.wisc.edu/pub/users/kelesgroup/encode2-perm-seq-peaks/">ftp://ftp.cs.wisc.edu/pub/users/kelesgroup/encode2-perm-seq-peaks/</ext-link>.</p>
</sec>
</sec>
<sec id="sec023">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004491.s001" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004491.s001" mimetype="application/pdf" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supplementary Methods for “Mapping protein-DNA interactions in segmental duplication and highly repetitive regions of genomes with prior-enhanced read mapping”.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004491.s002" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004491.s002" mimetype="application/pdf" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Supplementary Files for Histone Profiles of Atf3 to Nrf1.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004491.s003" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004491.s003" mimetype="application/pdf" xlink:type="simple">
<label>S3 Text</label>
<caption>
<title>Supplementary Files for Histone Profiles of Polr2a to Zbtb33.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004491.s004" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004491.s004" mimetype="application/pdf" xlink:type="simple">
<label>S4 Text</label>
<caption>
<title>Supplementary Files for phyloP Conservation Profiles of Atf3 to Rad21.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004491.s005" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004491.s005" mimetype="application/pdf" xlink:type="simple">
<label>S5 Text</label>
<caption>
<title>Supplementary Files for phyloP Conservation Profiles of Rest to Zbtb33.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Dr. Katherine Pollard of Gladstone Institutes, UC San Francisco for discussions on the phyloP scores. We thank the Keleş Research Group for many useful discussions and feedback.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004491.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Chung</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kuan</surname> <given-names>PF</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Sanalkumar</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Liang</surname> <given-names>K</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Discovering Transcription Factor Binding Sites in Highly Repetitive Regions of Genomes with Multi-Read Analysis of ChIP-Seq Data</article-title>. <source>PLoS Computational Biology</source> <volume>7</volume>: (<issue>7</issue>): <fpage>e1002111</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002111" xlink:type="simple">10.1371/journal.pcbi.1002111</ext-link></comment> <object-id pub-id-type="pmid">21779159</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Huda</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lunyak</surname> <given-names>VV</given-names></name>, <name name-style="western"><surname>Jordan</surname> <given-names>IK</given-names></name> (<year>2010</year>) <article-title>A Gibbs sampling strategy applied to the mapping of ambiguous short-sequence tags</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>2501</fpage>–<lpage>2508</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq460" xlink:type="simple">10.1093/bioinformatics/btq460</ext-link></comment> <object-id pub-id-type="pmid">20871106</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Newkirk</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Biesinger</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chon</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Yokomori</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>X</given-names></name> (<year>2011</year>) <article-title>AREM: Aligning Short Reads from ChIP-Sequencing by Expectation Maximization</article-title>. <source>Journal of Computational Biology</source> <volume>18</volume>: <fpage>1495</fpage>–<lpage>1505</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2011.0185" xlink:type="simple">10.1089/cmb.2011.0185</ext-link></comment> <object-id pub-id-type="pmid">22035330</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Wang</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Hsu</surname> <given-names>HK</given-names></name>, <name name-style="western"><surname>Blattler</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Lan</surname> <given-names>X</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>LOcating non-unique matched tags (LONUT) to improve the detection of the enriched regions for ChIP-seq data</article-title>. <source>PLoS One</source> <volume>8</volume>: <fpage>e67788</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0067788" xlink:type="simple">10.1371/journal.pone.0067788</ext-link></comment> <object-id pub-id-type="pmid">23825685</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Roberts</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Pachter</surname> <given-names>L</given-names></name> (<year>2012</year>) <article-title>Streaming fragment assignment for real-time analysis of sequencing experiments</article-title>. <source>Nature Methods</source> <volume>10</volume>: <fpage>71</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2251" xlink:type="simple">10.1038/nmeth.2251</ext-link></comment> <object-id pub-id-type="pmid">23160280</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>H</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>R</surname> <given-names>D</given-names></name> (<year>2009</year>) <article-title>Fast and accurate short read alignment with Burrows-Wheeler Transform</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>1754</fpage>–<lpage>1760</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004491.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Xie</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hong</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Lowdon</surname> <given-names>RF</given-names></name>, <name name-style="western"><surname>Xing</surname> <given-names>X</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Dna hypomethylation within specific transposable element families associates with tissue-specific enhancer landscape</article-title>. <source>Nature Genetics</source> <volume>45</volume>: <fpage>836</fpage>–<lpage>841</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng.2649" xlink:type="simple">10.1038/ng.2649</ext-link></comment> <object-id pub-id-type="pmid">23708189</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Feschotte</surname> <given-names>C</given-names></name> (<year>2008</year>) <article-title>Transposable elements and the evolution of regulatory networks</article-title>. <source>Nature Reviews Genetics</source> <volume>9</volume>: <fpage>397</fpage>–<lpage>405</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg2337" xlink:type="simple">10.1038/nrg2337</ext-link></comment> <object-id pub-id-type="pmid">18368054</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bourque</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Leong</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Vega</surname> <given-names>VB</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>YL</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Evolution of the mammalian transcription factor binding repertoire via transposable elements</article-title>. <source>Genome Research</source> <volume>18</volume>: <fpage>1752</fpage>–<lpage>1762</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.080663.108" xlink:type="simple">10.1101/gr.080663.108</ext-link></comment> <object-id pub-id-type="pmid">18682548</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bailey</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Eichler</surname> <given-names>EE</given-names></name> (<year>2006</year>) <article-title>Primate segmental duplications: crucibles of evolution, diversity and disease</article-title>. <source>Nature Reviews Genetics</source> <volume>7</volume>: <fpage>552</fpage>–<lpage>564</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg1997" xlink:type="simple">10.1038/nrg1997</ext-link></comment> <object-id pub-id-type="pmid">16770338</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Faulkner</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Forrest</surname> <given-names>ARR</given-names></name>, <name name-style="western"><surname>MChalk</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schroder</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hayashizaki</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>A rescue strategy for multimapping short sequence tags refines surveys of transcriptional activity by CAGE</article-title>. <source>Genomics</source> <volume>91</volume>: <fpage>281</fpage>–<lpage>288</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.ygeno.2007.11.003" xlink:type="simple">10.1016/j.ygeno.2007.11.003</ext-link></comment> <object-id pub-id-type="pmid">18178374</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Li</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Ruotti</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Stewart</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Thomson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Dewey</surname> <given-names>C</given-names></name> (<year>2010</year>) <article-title>RNA-Seq gene expression estimation with read mapping uncertainty</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>493</fpage>–<lpage>500</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp692" xlink:type="simple">10.1093/bioinformatics/btp692</ext-link></comment> <object-id pub-id-type="pmid">20022975</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mortazavi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>McCue</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Schaeffer</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Wold</surname> <given-names>B</given-names></name> (<year>2008</year>) <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>. <source>Nature Methods</source> <volume>5</volume>: <fpage>621</fpage>–<lpage>628</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1226" xlink:type="simple">10.1038/nmeth.1226</ext-link></comment> <object-id pub-id-type="pmid">18516045</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Taub</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lipson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Speed</surname> <given-names>T</given-names></name> (<year>2010</year>) <article-title>Methods for allocating ambiguous short-reads</article-title>. <source>Communications in Information and Systems</source> <volume>10</volume>: <fpage>69</fpage>–<lpage>82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4310/CIS.2010.v10.n2.a1" xlink:type="simple">10.4310/CIS.2010.v10.n2.a1</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="other">Nicolae M, Mangul S, Mandoiu I, Zelikovsky A (2010) Estimation of alternative splicing isoform frequencies from RNA-Seq data. In: Apostolico, A, Dress, A, Parida, L, editors, Structure Discovery in Biology: Motifs, Networks &amp; Phylogenies. Dagstuhl, Germany: Schloss Dagstuhl—Leibniz-Zentrum fuer Informatik, Germany, number 10231 in Dagstuhl Seminar Proceedings, pp. 9+.</mixed-citation>
</ref>
<ref id="pcbi.1004491.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Pasaniuc</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Zaitlen</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Halperin</surname> <given-names>E</given-names></name> (<year>2010</year>) <article-title>Accurate estimation of expression levels of homologous genes in rna-seq experiments</article-title>. In: <source>RECOMB</source>. pp. <fpage>397</fpage>–<lpage>409</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004491.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Li</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dewey</surname> <given-names>CN</given-names></name> (<year>2011</year>) <article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title>. <source>BMC Bioinformatics</source> <volume>12</volume>: <fpage>323</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-12-323" xlink:type="simple">10.1186/1471-2105-12-323</ext-link></comment> <object-id pub-id-type="pmid">21816040</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hesselberth</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Sabo</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Sandstrom</surname> <given-names>R</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Global mapping of protein-DNA interactions in vivo by digital genomic footprinting</article-title>. <source>Nature Methods</source> <volume>6</volume>: <fpage>283</fpage>–<lpage>289</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1313" xlink:type="simple">10.1038/nmeth.1313</ext-link></comment> <object-id pub-id-type="pmid">19305407</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Song</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Crawford</surname> <given-names>GE</given-names></name> (<year>2010</year>) <article-title>DNase-seq: a high-resolution technique for mapping active gene regulatory elements across the genome from mammalian cells</article-title>. <source>Cold Spring Harbor Protocols</source> <volume>2010</volume>: <fpage>pdb</fpage>–<lpage>prot5384</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/pdb.prot5384" xlink:type="simple">10.1101/pdb.prot5384</ext-link></comment> <object-id pub-id-type="pmid">20150147</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Boyle</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Song</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>BK</given-names></name>, <name name-style="western"><surname>London</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Keefe</surname> <given-names>D</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>High-resolution genome-wide in vivo footprinting of diverse transcription factors in human cells</article-title>. <source>Genome research</source> <volume>21</volume>: <fpage>456</fpage>–<lpage>464</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.112656.110" xlink:type="simple">10.1101/gr.112656.110</ext-link></comment> <object-id pub-id-type="pmid">21106903</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Arvey</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Agius</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Noble</surname> <given-names>WS</given-names></name>, <name name-style="western"><surname>Leslie</surname> <given-names>C</given-names></name> (<year>2012</year>) <article-title>Sequence and chromatin determinants of cell-type–specific transcription factor binding</article-title>. <source>Genome research</source> <volume>22</volume>: <fpage>1723</fpage>–<lpage>1734</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.127712.111" xlink:type="simple">10.1101/gr.127712.111</ext-link></comment> <object-id pub-id-type="pmid">22955984</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Linneman</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>O’Geen</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Keleş</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Farnham</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Bresnick</surname> <given-names>EH</given-names></name> (<year>2011</year>) <article-title>Genetic framework for GATA factor function in vascular biology</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>108</volume>: <fpage>13641</fpage>–<lpage>13646</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1108440108" xlink:type="simple">10.1073/pnas.1108440108</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Langmead</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Trapnell</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pop</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Salzberg</surname> <given-names>SL</given-names></name> (<year>2009</year>) <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>. <source>Genome Biology</source> <volume>10</volume>: <fpage>R25</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2009-10-3-r25" xlink:type="simple">10.1186/gb-2009-10-3-r25</ext-link></comment> <object-id pub-id-type="pmid">19261174</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Landt</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Marinov</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Kundaje</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kheradpour</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Pauli</surname> <given-names>F</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>ChIP-seq guidelines and practices of the ENCODE and modENCODE consortia</article-title>. <source>Genome Research</source> <volume>22</volume>: <fpage>1813</fpage>–<lpage>1831</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.136184.111" xlink:type="simple">10.1101/gr.136184.111</ext-link></comment> <object-id pub-id-type="pmid">22955991</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kharchenko</surname> <given-names>PV</given-names></name>, <name name-style="western"><surname>Tolstorukov</surname> <given-names>MY</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>PJ</given-names></name> (<year>2008</year>) <article-title>Design and analysis of ChIP-seq experiments for DNA-binding proteins</article-title>. <source>Nature biotechnology</source> <volume>26</volume>: <fpage>1351</fpage>–<lpage>1359</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.1508" xlink:type="simple">10.1038/nbt.1508</ext-link></comment> <object-id pub-id-type="pmid">19029915</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Li</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bickel</surname> <given-names>PJ</given-names></name> (<year>2011</year>) <article-title>Measuring reproducibility of high-throughput experiments</article-title>. <source>The Annals of Applied Statistics</source> <volume>5</volume>: <fpage>1752</fpage>–<lpage>1779</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/11-AOAS466" xlink:type="simple">10.1214/11-AOAS466</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bailey</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Gu</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Reinert</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Samonte</surname> <given-names>RV</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title>Recent segmental duplications in the human genome</article-title>. <source>Science</source> <volume>297</volume>: <fpage>1003</fpage>–<lpage>1007</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1072047" xlink:type="simple">10.1126/science.1072047</ext-link></comment> <object-id pub-id-type="pmid">12169732</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bailey</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Boden</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Buske</surname> <given-names>FA</given-names></name>, <name name-style="western"><surname>Frith</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Grant</surname> <given-names>CE</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>MEME SUITE: tools for motif discovery and searching</article-title>. <source>Nucleic acids research</source> <volume>37</volume>: <fpage>W202</fpage>–<lpage>W208</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkp335" xlink:type="simple">10.1093/nar/gkp335</ext-link></comment> <object-id pub-id-type="pmid">19458158</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref029">
<label>29</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hatem</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bozdağ</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Toland</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Çatalyürek</surname> <given-names>UV</given-names></name> (<year>2013</year>) <article-title>Benchmarking short sequence mapping tools</article-title>. <source>BMC bioinformatics</source> <volume>14</volume>: <fpage>184</fpage>+. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-14-184" xlink:type="simple">10.1186/1471-2105-14-184</ext-link></comment> <object-id pub-id-type="pmid">23758764</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref030">
<label>30</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kasowski</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Grubert</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Heffelfinger</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hariharan</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Asabere</surname> <given-names>A</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Variation in transcription factor binding among humans</article-title>. <source>Science</source> <volume>328</volume>: <fpage>232</fpage>–<lpage>235</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1183621" xlink:type="simple">10.1126/science.1183621</ext-link></comment> <object-id pub-id-type="pmid">20299548</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref031">
<label>31</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tsai</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Chou</surname> <given-names>YC</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>JH</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Autocrine CCL3 and CCL4 induced by the oncoprotein LMP1 promote EBV-triggered B cell proliferation</article-title>. <source>Journal of Virology</source> <volume>87</volume>: <fpage>9041</fpage>–<lpage>52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/JVI.00541-13" xlink:type="simple">10.1128/JVI.00541-13</ext-link></comment> <object-id pub-id-type="pmid">23760235</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref032">
<label>32</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Pollard</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Hubisz</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Rosenbloom</surname> <given-names>KR</given-names></name>, <name name-style="western"><surname>Siepel</surname> <given-names>A</given-names></name> (<year>2010</year>) <article-title>Detection of nonneutral substitution rates on mammalian phylogenies</article-title>. <source>Genome Research</source> <volume>20</volume>: <fpage>110</fpage>–<lpage>121</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.097857.109" xlink:type="simple">10.1101/gr.097857.109</ext-link></comment> <object-id pub-id-type="pmid">19858363</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref033">
<label>33</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Benjamini</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hochberg</surname> <given-names>Y</given-names></name> (<year>1995</year>) <article-title>Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source> <volume>57</volume>: <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004491.ref034">
<label>34</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Daniel</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Spring</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Crawford</surname> <given-names>HC</given-names></name>, <name name-style="western"><surname>Reynolds</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Baig</surname> <given-names>A</given-names></name> (<year>2002</year>) <article-title>The p120(ctn)-binding partner Kaiso is a bi-modal DNA-binding protein that recognizes both a sequence-specific consensus and methylated CpG dinucleotides</article-title>. <source>Nucleic Acids Research</source> <volume>30</volume>: <fpage>2911</fpage>–<lpage>2919</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkf398" xlink:type="simple">10.1093/nar/gkf398</ext-link></comment> <object-id pub-id-type="pmid">12087177</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref035">
<label>35</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Barski</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Cuddapah</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Cui</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Roh</surname> <given-names>TY</given-names></name>, <name name-style="western"><surname>Schones</surname> <given-names>DE</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>High-resolution profiling of histone methylations in the human genome</article-title>. <source>Cell</source> <volume>129</volume>: <fpage>823</fpage>–<lpage>837</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2007.05.009" xlink:type="simple">10.1016/j.cell.2007.05.009</ext-link></comment> <object-id pub-id-type="pmid">17512414</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref036">
<label>36</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Dunham</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Birney</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lajoie</surname> <given-names>BR</given-names></name>, <name name-style="western"><surname>Sanyal</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dong</surname> <given-names>X</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source> <volume>489</volume>: <fpage>57</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11247" xlink:type="simple">10.1038/nature11247</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref037">
<label>37</label>
<mixed-citation xlink:type="simple" publication-type="other">Friedman J, Hastie T, Tibshirani R (2010) A note on the group lasso and a sparse group lasso. arXiv preprint arXiv:10010736.</mixed-citation>
</ref>
<ref id="pcbi.1004491.ref038">
<label>38</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhuang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Iyer</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Whitfield</surname> <given-names>TW</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Sequence features and chromatin structure around the genomic regions bound by 119 human transcription factors</article-title>. <source>Genome research</source> <volume>22</volume>: <fpage>1798</fpage>–<lpage>1812</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.139105.112" xlink:type="simple">10.1101/gr.139105.112</ext-link></comment> <object-id pub-id-type="pmid">22955990</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref039">
<label>39</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ku</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Jaffe</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Koche</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Rheinbay</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Endoh</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>H2A.Z landscapes and dual modifications in pluripotent and multipotent stem cells underlie complex genome regulatory functions</article-title>. <source>Genome Biology</source> <volume>13</volume>: <fpage>R85</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2012-13-10-r85" xlink:type="simple">10.1186/gb-2012-13-10-r85</ext-link></comment> <object-id pub-id-type="pmid">23034477</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref040">
<label>40</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Thurman</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Rynes</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Humbert</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Vierstra</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Maurano</surname> <given-names>MT</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>The accessible chromatin landscape of the human genome</article-title>. <source>Nature</source> <volume>2012</volume>(<issue>489</issue>): <fpage>75</fpage>–<lpage>82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11232" xlink:type="simple">10.1038/nature11232</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004491.ref041">
<label>41</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Silverman</surname> <given-names>BW</given-names></name>, <name name-style="western"><surname>Nychka</surname> <given-names>DW</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>J</given-names></name> (<year>1990</year>) <article-title>A smoothed EM approach to indirect estimation problems, with particular, reference to stereology and emission tomography</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source>: <fpage>271</fpage>–<lpage>324</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004491.ref042">
<label>42</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Stormo</surname> <given-names>GD</given-names></name> (<year>2000</year>) <article-title>DNA binding sites: representation and discovery</article-title>. <source>Bioinformatics</source> <volume>16</volume>: <fpage>16</fpage>–<lpage>23</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/16.1.16" xlink:type="simple">10.1093/bioinformatics/16.1.16</ext-link></comment> <object-id pub-id-type="pmid">10812473</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>