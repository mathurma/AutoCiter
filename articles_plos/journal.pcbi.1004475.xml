<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article article-type="research-article" dtd-version="3.0" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00150</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004475</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Repeated sequences</subject><subj-group><subject>Tandem repeats</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Bacteria</subject><subj-group><subject>Actinobacteria</subject><subj-group><subject>Mycobacterium tuberculosis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Genotyping</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Genotyping</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Medical microbiology</subject><subj-group><subject>Microbial pathogens</subject><subj-group><subject>Bacterial pathogens</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pathology and laboratory medicine</subject><subj-group><subject>Pathogens</subject><subj-group><subject>Microbial pathogens</subject><subj-group><subject>Bacterial pathogens</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Mycology</subject><subj-group><subject>Fungal evolution</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome complexity</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome complexity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pathology and laboratory medicine</subject><subj-group><subject>Pathogens</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>ClassTR: Classifying Within-Host Heterogeneity Based on Tandem Repeats with Application to <italic>Mycobacterium tuberculosis</italic> Infections</article-title>
<alt-title alt-title-type="running-head">Classifying Complex Infections with Tandem Repeats</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Chindelevitch</surname> <given-names>Leonid</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Colijn</surname> <given-names>Caroline</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Moodley</surname> <given-names>Prashini</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Wilson</surname> <given-names>Douglas</given-names></name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Cohen</surname> <given-names>Ted</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Epidemiology of Microbial Diseases, Yale School of Public Health, New Haven, Connecticut, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Mathematics, Imperial College, London, United Kingdom</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>School of Laboratory Medicine and Medical Sciences, Nelson R Mandela School of Medicine, University of KwaZulu-Natal, Durban, South Africa</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Department of Medicine, Edendale Hospital, Pietermaritzberg, South Africa</addr-line>
</aff>
<aff id="aff005">
<label>5</label>
<addr-line>Nelson R Mandela School of Medicine, University of KwaZulu-Natal, Durban, South Africa</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Tanaka</surname> <given-names>Mark M.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of New South Wales, AUSTRALIA</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: TC LC. Performed the experiments: PM DW LC. Analyzed the data: LC. Wrote the paper: LC CC TC. Suggested the methodology for simulating data: CC. Provided feedback and suggestions on all aspects of development and testing: CC TC. DW Supervised primary collection of data: DW. Supervised laboratory activities: PM.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">leonid@sfu.ca</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>2</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>1</day>
<month>2</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>2</issue>
<elocation-id>e1004475</elocation-id>
<history>
<date date-type="received">
<day>30</day>
<month>1</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>22</day>
<month>7</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Chindelevitch et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004475"/>
<abstract>
<p>Genomic tools have revealed genetically diverse pathogens within some hosts. Within-host pathogen diversity, which we refer to as “complex infection”, is increasingly recognized as a determinant of treatment outcome for infections like tuberculosis. Complex infection arises through two mechanisms: within-host mutation (which results in clonal heterogeneity) and reinfection (which results in mixed infections). Estimates of the frequency of within-host mutation and reinfection in populations are critical for understanding the natural history of disease. These estimates influence projections of disease trends and effects of interventions. The genotyping technique MLVA (multiple loci variable-number tandem repeats analysis) can identify complex infections, but the current method to distinguish clonal heterogeneity from mixed infections is based on a rather simple rule. Here we describe ClassTR, a method which leverages MLVA information from isolates collected in a population to distinguish mixed infections from clonal heterogeneity. We formulate the resolution of complex infections into their constituent strains as an optimization problem, and show its NP-completeness. We solve it efficiently by using mixed integer linear programming and graph decomposition. Once the complex infections are resolved into their constituent strains, ClassTR probabilistically classifies isolates as clonally heterogeneous or mixed by using a model of tandem repeat evolution. We first compare ClassTR with the standard rule-based classification on 100 simulated datasets. ClassTR outperforms the standard method, improving classification accuracy from 48% to 80%. We then apply ClassTR to a sample of 436 strains collected from tuberculosis patients in a South African community, of which 92 had complex infections. We find that ClassTR assigns an alternate classification to 18 of the 92 complex infections, suggesting important differences in practice. By explicitly modeling tandem repeat evolution, ClassTR helps to improve our understanding of the mechanisms driving within-host diversity of pathogens like <italic>Mycobacterium tuberculosis</italic>.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Within-host heterogeneity of an infection can arise through two distinct mechanisms: within-host mutation and reinfection. While current genotyping techniques based on MLVA (multiple loci variable-number tandem repeat analysis) can identify within-host diversity, standard methods for classifying the mechanism driving this diversity have limitations. We present ClassTR, a novel approach for classifying these types of complex infections. ClassTR uses optimization to resolve complex strains into simple strains and explicit models of tandem repeat evolution to classify the infections as clonal (due to within-host diversification) or mixed (due to reinfection). We illustrate ClassTR and validate its findings in the context of <italic>Mycobacterium tuberculosis</italic> infections. We construct simulated datasets to identify the best-performing variant of our method and find that it is significantly more accurate than the standard method of classification. We apply ClassTR to data from a study in South Africa and find substantial differences in the classifications produced by ClassTR and the standard method, demonstrating the real-world relevance of this approach. Our work suggests that an analysis of complex infections based on an evolutionary model improves our understanding of the drivers of within-host diversity.</p>
</abstract>
<funding-group>
<funding-statement>The authors were supported by Award Number U54GM088558 from the National Institute of General Medical Sciences, US National Institutes of Health, as well as by DP2OD006663 from the Office of the Director, US National Institutes of Health. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="3"/>
<table-count count="5"/>
<page-count count="16"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The code for ClassTR is available as an R package under the GPL-3 license. This package is available as a supplementary file, which can be installed using the standard procedure for R package installation. ClassTR requires CPLEX, freely available to academics via the IBM Academic Initiative: <ext-link ext-link-type="uri" xlink:href="http://www-304.ibm.com/ibm/university/academic/pub/page/academic_initiative" xlink:type="simple">www-304.ibm.com/ibm/university/academic/pub/page/academic_initiative</ext-link></meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The genotyping technique known as MLVA (multiple loci variable-number tandem repeats analysis), which identifies the number of copies of tandem repeat regions at specific pre-selected loci, has benefited the study of many bacteria. Data produced by MLVA can be used to glean information about bacterial lineage, pathogenicity and relation to other bacteria of the same species [<xref ref-type="bibr" rid="pcbi.1004475.ref001">1</xref>]. Our study focuses on a specific bacterium, <italic>Mycobacterium tuberculosis</italic>, but our methods are generally applicable to a variety of bacteria.</p>
<p>Genetic and genomic approaches for interrogating the composition of <italic>Mycobacterium tuberculosis</italic> infections occurring within individuals has in some settings revealed an impressive degree of complexity, reflecting both within-host mutation and reinfection as distinct routes to complexity [<xref ref-type="bibr" rid="pcbi.1004475.ref002">2</xref>]. These complex infections, especially those comprising both drug-susceptible and drug-resistant isolates (i.e. heteroresistance), can undermine the effective treatment of individual patients [<xref ref-type="bibr" rid="pcbi.1004475.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1004475.ref005">5</xref>], complicate laboratory testing and evaluation of treatment programs [<xref ref-type="bibr" rid="pcbi.1004475.ref002">2</xref>], and affect the transmission dynamics of disease in communities [<xref ref-type="bibr" rid="pcbi.1004475.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004475.ref007">7</xref>]. While an individual’s clinical response to treatment may not depend on whether heteroresistance has arisen through within-host mutation or by reinfection, our ability to distinguish these mechanisms has profound implications for our understanding of the natural history of disease and for projections of disease trajectories. For example, high contributions of reinfection indicate limited immune protection associated with previous infection, and have implications for the impact of new and existing vaccines [<xref ref-type="bibr" rid="pcbi.1004475.ref008">8</xref>] and for the effectiveness of preventive therapy [<xref ref-type="bibr" rid="pcbi.1004475.ref009">9</xref>]. High contributions of within-host mutation would affect expected rates of acquired resistance and would have implications for optimal antibiotic dosing strategies [<xref ref-type="bibr" rid="pcbi.1004475.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1004475.ref011">11</xref>]. Accordingly, accurate estimates of the prevalence of complex infections among tuberculosis patients and new methods for distinguishing the relative contributions of within-host mutation and reinfection to within-host diversity would be valuable.</p>
<p>Mycobacterial interspersed repetitive unit-variable number tandem repeat (MIRU-VNTR), the specific name of the MLVA technique for <italic>Mycobacterium tuberculosis</italic>, is a currently favored approach for genotyping strains and offers advantages for detecting within-host heterogeneity over other methods such as spacer oligonucleotide sequencing (spoligotyping) and restriction fragment length polymorphism analysis (RFLP). These molecular genetic approaches for TB genotyping are reviewed in Mathema et al. [<xref ref-type="bibr" rid="pcbi.1004475.ref012">12</xref>] and an evaluation of their utility for detecting complex infections is described by Cohen et al [<xref ref-type="bibr" rid="pcbi.1004475.ref002">2</xref>]. MIRU-VNTR is a microsatellite typing system which produces a readout containing the number of copies of a repeat region at several pre-selected loci [<xref ref-type="bibr" rid="pcbi.1004475.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1004475.ref014">14</xref>]. These copy number variants (CNVs) can then be used to compare the <italic>Mycobacterium tuberculosis</italic> strain to other similarly typed strains. If a patient harbors a complex infection, there will frequently be 2 (and sometimes 3) different CNVs at a single locus, and these can result from a clonally heterogeneous or a mixed infection. This situation is illustrated in <xref ref-type="fig" rid="pcbi.1004475.g001">Fig 1</xref>.</p>
<fig id="pcbi.1004475.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004475.g001</object-id>
<label>Fig 1</label>
<caption>
<title>MIRU-VNTR and complex infections.</title>
<p><bold>a</bold>. A simple strain <bold>b</bold>. A complex strain <bold>c</bold>. The two strains contained in the complex strain; they can result from either <bold>d</bold>. a clonally heterogeneous infection or <bold>e</bold>. a mixed infection.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004475.g001" xlink:type="simple"/>
</fig>
<p>Classifying complex MIRU-VNTR patterns as being due to either within-host mutation or reinfection is challenging. The current accepted approach for distinguishing clonal heterogeneity from mixed infection is a simple rule-based method: if two or more loci have multiple CNVs the infection is classified as “mixed”, whereas if only one locus has multiple CNVs the infection is classified as “clonally heterogeneous” [<xref ref-type="bibr" rid="pcbi.1004475.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1004475.ref015">15</xref>]. This approach is sensible given that the more complexity observed within a particular genotype, the more likely it is to be due to reinfection with a distinct second strain. In addition, there are several sources of evidence which suggest that clonal evolution occurring over a relatively short period is unlikely to result in multiple complex loci [<xref ref-type="bibr" rid="pcbi.1004475.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1004475.ref018">18</xref>]. Nonetheless, the rule this approach is based on suffers from several limitations. First, it does not take the context of the infection into account (namely, whether the constituent strains are present in other members of the population). Second, it does not distinguish between copy numbers that are a small genetic distance apart (such as 3 and 4) from ones that are far apart (such as 3 and 15), even though clonal heterogeneity is less plausible in the latter case. Third, this approach does not facilitate the resolution of mixed infections into their constituent strains.</p>
<p>We propose a new method, which we call ClassTR, to classify complex infections using MLVA data. Our method is based on an established model of tandem repeat evolution that accounts for the stepwise character of mutations, which we extend by using differential rates of evolution for different loci. ClassTR leverages the entire set of isolate genotypes collected in a population in order to resolve complex strains into simple strains (i.e. strains with only one CNV at each locus). Then, using a model of tandem repeat evolution it identifies the most likely sources of each simple strain to establish the probability of each patient having a mixed infection. We show that ClassTR outperforms the standard rule-based method, reducing its error rate by 61% on simulated data, and produces significantly different classifications than the standard method on a dataset collected from a community in KwaZulu-Natal, South Africa. ClassTR is implemented in the R Statistical Computing Language [<xref ref-type="bibr" rid="pcbi.1004475.ref019">19</xref>] in <bold>Supplementary Materials</bold> (<xref ref-type="supplementary-material" rid="pcbi.1004475.s002">S1 Code</xref>).</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>The ClassTR algorithm for classifying complex infections</title>
<p>We say that a patient harbors a <italic>complex infection</italic> if at least one of the MIRU-VNTR loci contains 2 different CNVs. We assume that there are always 1 or 2 CNV per locus, and this is indeed what we usually observe in practice. The ClassTR algorithm classifies these complex infections as resulting from either clonal heterogeneity or mixed infection (when both clonal heterogeneity and mixed infection are present, ClassTR classifies the infection as mixed). It includes three steps, each of which is briefly discussed below and described in more detail in the <bold>Methods</bold> section. Briefly, ClassTR starts by creating an optimization problem to resolve the complex strains into their constituent simple strains. After solving this optimization problem, ClassTR uses the resulting simple strain representation of complex strains to infer the possible provenance of each of these complex strains. Finally, it computes the probability of clonal heterogeneity for each patient with a complex infection. We illustrate this process on a small example with 3 simple and 3 complex strains in Figs <xref ref-type="fig" rid="pcbi.1004475.g002">2</xref> and <xref ref-type="fig" rid="pcbi.1004475.g003">3</xref>.</p>
<fig id="pcbi.1004475.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004475.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Example of the ClassTR resolution.</title>
<p><bold>a</bold>. A dataset containing 3 simple strains (<italic>F</italic> in the problem description) and 3 complex strains (<italic>C</italic> in the problem description) <bold>b</bold>. The 2 possible resolutions of the third complex strain (<italic>q</italic> = 2) into simple strains (the first complex strain has 1 possible resolution (<italic>q</italic> = 1) and the second one, 4 possible resolutions (<italic>q</italic> = 3)); the resolution chosen by ClassTR is framed <bold>c</bold>. The three initial (<italic>F</italic> in the problem description) and two newly added (<italic>S</italic> in the problem description) simple strains that form the unique optimal solution, with arrows indicating the resolution of complex strains into simple strains</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004475.g002" xlink:type="simple"/>
</fig>
<fig id="pcbi.1004475.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004475.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Example of the ClassTR classification.</title>
<p><bold>Top right</bold> The precursor sets (in the unweighted constant metric) indicated by arrows from the simple strains chosen to cover the third complex strain <bold>Bottom</bold> Its final classification given by ClassTR</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004475.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec004">
<title>Defining a distance between strains</title>
<p>Following Aandahl et al [<xref ref-type="bibr" rid="pcbi.1004475.ref020">20</xref>] we define distances between strains based on explicit models of tandem repeat evolution: a constant model and a linear model. Both models assume that copy numbers evolve in a stepwise fashion, consistent with the process of slipped-strand mispairing [<xref ref-type="bibr" rid="pcbi.1004475.ref021">21</xref>]. The constant model assumes a Poisson process at each locus by which the copy number increases or decreases by 1 at a constant rate, while the linear model assumes a Poisson process at each copy, so that the rate of mutation is proportional to the current copy number. In both cases the distance between two strains represents the total number of mutation events required to go from one to the other. In addition to these basic models where different loci undergo mutations at the same rate, we also consider weighted models in which different loci mutate at different rates. In order to estimate these locus-specific mutation rates we use measures of locus diversity.</p>
</sec>
<sec id="sec005">
<title>Covering complex strains with simple ones</title>
<p>We say that a set of simple strains <italic>exactly covers</italic> a complex strain if the set of CNVs at each locus of the simple strains is precisely the CNVs at the corresponding locus of the complex strain. In general, a strain with one or more complex loci having 2 CNVs each can be exactly covered by 2 simple strains. However, in the absence of additional constraints there can be as many as 2<sup><italic>q</italic>−1</sup> possible such covers of a strain with <italic>q</italic> complex loci, which is 2048 possibilities for <italic>q</italic> = 12, the largest we observe in our data. We make a parsimony assumption and search for the covers of the complex strains that introduce the smallest possible number of additional simple strains (i.e. ones not observed in the original dataset). This defines an optimization problem which may have multiple solutions, especially when the cases are not densely sampled from the population. We narrow down alternative possibilities by a system of rewards for using a strain frequently observed in the dataset and penalties for strains that are far removed from any other simple strains in the dataset.</p>
</sec>
<sec id="sec006">
<title>Computing predecessors and the final classification</title>
<p>Once the optimization problem is solved, every complex strain is represented as a superposition of simple strains. These simple strains can be present in the original dataset or newly added. For each of the newly added simple strains we compute one or more predecessors among the original simple strains, defined as the closest among these strains according to the distance we chose. The final probabilities are then obtained by comparing the sets of predecessors of the two strains constituting a given complex strain; the more similar they are, the more likely the strain is to be the result of clonal heterogeneity.</p>
</sec>
<sec id="sec007">
<title>Classification of complex infections in a South African dataset</title>
<p>The South African dataset we work with consists of data collected during a prospective study of within-host diversity of <italic>M. tuberculosis</italic>. Briefly, 500 adult, sputum smear-positive TB patients in a geographic cluster of participating clinics in KwaZulu Natal were sequentially recruited for participation at the time of diagnosis and before treatment was initiated. Additional pre-treatment sputum was collected from each participant and cultured in solid and liquid media. Bacterial DNA was isolated from both media and genotyping was done by 24 loci MIRU-VNTR according to standardized protocols [<xref ref-type="bibr" rid="pcbi.1004475.ref014">14</xref>]. Out of the 500 study participants, the isolates of 436 (87%) were successfully typed and included in this study. Of the 436 patients included in the study, 92 (21%) had complex MIRU-VNTR patterns. We note that, like many other South African communities, the one in this study has a high HIV prevalence.</p>
<p>The standard rule-based classification method designated 44 of 92 of the complex strains as clonal and the remaining 48 as mixed, whereas our method classified 50 of them as clonal and 42 as mixed. Only one patient got assigned a probability of 1/4 for clonality and 3/4 for mixed, and we ended up using the majority rule and classifying their infection as mixed. There were a total of 18 discrepant calls, 6 in which a strain was called clonal by the standard method but mixed by ours, and 12 in which the reverse occurred. Our results are summarized in <xref ref-type="table" rid="pcbi.1004475.t001">Table 1</xref>.</p>
<table-wrap id="pcbi.1004475.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004475.t001</object-id>
<label>Table 1</label>
<caption>
<title>Classification results of the standard method and ClassTR on the South African dataset.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004475.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004475.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Standard/ClassTR</th>
<th align="center">Simple</th>
<th align="center">Mixed</th>
<th align="center">Clonal</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Simple</td>
<td align="center">344</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">Mixed</td>
<td align="center">0</td>
<td align="center">36</td>
<td align="center">12</td>
</tr>
<tr>
<td align="center">Clonal</td>
<td align="center">0</td>
<td align="center">6</td>
<td align="center">38</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec008">
<title>Validation of the method on simulated data</title>
<p>In order to evaluate the performance of the 8 different variants of our method (defined by the constant or the linear metric, as well as the commonly used Hamming metric and Goldstein metric, and weighted or unweighted loci), as well as the standard rule-based method based on the count of complex loci, we produced 100 simulated datasets with characteristics similar to our South African dataset. The details of our simulations are described in the <bold>Supplementary Materials</bold> (<xref ref-type="supplementary-material" rid="pcbi.1004475.s001">S1 Text</xref>). We attempted to match the original dataset in terms of its strain clustering characteristics, distribution of the number of complex loci in strains, and distribution of the differences between the CNVs in a complex locus. To this end, we simulated the evolution of an initial population of strains with random but constrained mutation and reinfection events a large number of times, selected a number of subpopulations of appropriate size, and selected the final datasets according to their distance to the two target distributions.</p>
<p>We selected 100 datasets of <italic>N</italic> = 415 strains each, <italic>n</italic> = 83(20%) of which were complex; 42 were the result of clonal heterogeneity and 41 were mixed infections. We applied the standard rule-based method and our method on each dataset. We evaluated the accuracy of each method as the average probability they assigned to the correct classification for the 83 complex strains; namely, if a method returned a probability <italic>p</italic> of clonality, we scored <italic>p</italic> if the complex strain was actually clonal and 1 − <italic>p</italic> if it was actually mixed. The accuracy of the standard rule-based method averaged 48%, not significantly different from the 50% that would be expected from a random classification. On the other hand, the accuracy of ClassTR using our metric of choice, the linear weighted metric, was 80%, for a 61% reduction in error. We also evaluated the correctness of the resolution of complex strains into their constituent simple ones, and found that ClassTR produced the correct resolution in 88% on clonal infections and 95% on mixed infections. The results of running different variants of our method on classification accuracy are shown in <xref ref-type="table" rid="pcbi.1004475.t002">Table 2</xref>.</p>
<table-wrap id="pcbi.1004475.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004475.t002</object-id>
<label>Table 2</label>
<caption>
<title>Percent accuracy of classification methods on simulated datasets.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004475.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004475.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Metric</th>
<th align="center" colspan="2">Hamming metric</th>
<th align="center" colspan="2">Constant metric</th>
<th align="center" colspan="2">Linear metric</th>
<th align="center" colspan="2">Goldstein metric</th>
<th align="center" colspan="2">Standard method</th>
</tr>
<tr>
<th align="center">Correct class</th>
<th align="center">clonal</th>
<th align="center">mixed</th>
<th align="center">clonal</th>
<th align="center">mixed</th>
<th align="center">clonal</th>
<th align="center">mixed</th>
<th align="center">clonal</th>
<th align="center">mixed</th>
<th align="center">clonal</th>
<th align="center">mixed</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Unweighted</td>
<td align="center">87%</td>
<td align="center">68%</td>
<td align="center">91%</td>
<td align="center">65%</td>
<td align="center">89%</td>
<td align="center">66%</td>
<td align="center">85%</td>
<td align="center">64%</td>
<td align="center" rowspan="2">45%</td>
<td align="center" rowspan="2">52%</td>
</tr>
<tr>
<td align="center">Weighted</td>
<td align="center">87%</td>
<td align="center">74%</td>
<td align="center">90%</td>
<td align="center">69%</td>
<td align="center">89%</td>
<td align="center">71%</td>
<td align="center">85%</td>
<td align="center">68%</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>In addition, we created 9 groups of 100 datasets each, with similar characteristics but not constrained to resemble the original dataset as closely. Each group corresponded to a combination of one of three mutation rates (low, medium and high) and one of three reinfection rates (low, medium and high). Our method outperformed the standard rule-based method on all of them except for the classification at the low mutation rate. The results of running ClassTR on those datasets are shown in <xref ref-type="table" rid="pcbi.1004475.t003">Table 3</xref> (for the resolution, using randomly picked resolutions as the baseline) and <xref ref-type="table" rid="pcbi.1004475.t004">Table 4</xref> (for the classification, using the standard method as the baseline). They suggest that although the resolution performance of ClassTR deteriorates quite substantially on mixed infections at high mutation rates, its classification performance remains consistently good, both in absolute terms and in comparison with the standard method. This finding is further substantiated by <xref ref-type="table" rid="pcbi.1004475.t005">Table 5</xref>, which shows that ClassTR finds the correct classification when the correct resolution is given most of the time, with a slight deterioration at high mutation rates. However, it is also able to find the correct classification from an incorrect resolution quite frequently, as evidenced by a comparison of all three tables.</p>
<table-wrap id="pcbi.1004475.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004475.t003</object-id>
<label>Table 3</label>
<caption>
<title>Percent accuracy of ClassTR’s strain resolution on 9 simulated datasets; mutation rates: low, 0.00012; medium, 0.0012; high, 0.012; reinfection rates: low, 0.012; medium, 0.04; high, 0.12 (per year); the percentage in brackets is the corresponding accuracy for the method of picking a random resolution.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004475.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004475.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Mutation/Reinfection</th>
<th align="center" colspan="2">Low mutation</th>
<th align="center" colspan="2">Medium mutation</th>
<th align="center" colspan="2">High mutation</th>
</tr>
<tr>
<th align="center">Correct class</th>
<th align="center">clonal</th>
<th align="center">mixed</th>
<th align="center">clonal</th>
<th align="center">mixed</th>
<th align="center">clonal</th>
<th align="center">mixed</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Low reinfection</td>
<td align="center">100% (98%)</td>
<td align="center">87% (3.8%)</td>
<td align="center">97% (93%)</td>
<td align="center">79% (5.3%)</td>
<td align="center">82% (53%)</td>
<td align="center">32% (2.7%)</td>
</tr>
<tr>
<td align="center">Medium reinfection</td>
<td align="center">100% (99%)</td>
<td align="center">87% (3.9%)</td>
<td align="center">98% (93%)</td>
<td align="center">80% (5.8%)</td>
<td align="center">81% (54%)</td>
<td align="center">32% (2.9%)</td>
</tr>
<tr>
<td align="center">High reinfection</td>
<td align="center">100% (99%)</td>
<td align="center">88% (3.2%)</td>
<td align="center">97% (93%)</td>
<td align="center">80% (5.5%)</td>
<td align="center">78% (54%)</td>
<td align="center">33% (2.2%)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<table-wrap id="pcbi.1004475.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004475.t004</object-id>
<label>Table 4</label>
<caption>
<title>Percent accuracy of ClassTR’s classification on 9 simulated datasets; mutation rates: low, 0.00012; medium, 0.0012; high, 0.012; reinfection rates: low, 0.012; medium, 0.04; high, 0.12 (per year); the percentage in brackets is the corresponding accuracy for the standard method.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004475.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004475.t004" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Mutation/Reinfection</th>
<th align="center" colspan="2">Low mutation</th>
<th align="center" colspan="2">Medium mutation</th>
<th align="center" colspan="2">High mutation</th>
</tr>
<tr>
<th align="center">Correct class</th>
<th align="center">clonal</th>
<th align="center">mixed</th>
<th align="center">clonal</th>
<th align="center">mixed</th>
<th align="center">clonal</th>
<th align="center">mixed</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Low reinfection</td>
<td align="center">96% (96%)</td>
<td align="center">99% (99%)</td>
<td align="center">97% (86%)</td>
<td align="center">96% (98%)</td>
<td align="center">88% (33%)</td>
<td align="center">95% (99%)</td>
</tr>
<tr>
<td align="center">Medium reinfection</td>
<td align="center">96% (97%)</td>
<td align="center">99% (99%)</td>
<td align="center">94% (86%)</td>
<td align="center">96% (97%)</td>
<td align="center">82% (34%)</td>
<td align="center">96% (99%)</td>
</tr>
<tr>
<td align="center">High reinfection</td>
<td align="center">94% (98%)</td>
<td align="center">99% (99%)</td>
<td align="center">92% (87%)</td>
<td align="center">97% (97%)</td>
<td align="center">74% (34%)</td>
<td align="center">97% (99%)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<table-wrap id="pcbi.1004475.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004475.t005</object-id>
<label>Table 5</label>
<caption>
<title>Accuracy of ClassTR’s classification on 9 simulated datasets conditional on correct resolution.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004475.t005g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004475.t005" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Mutation/Reinfection</th>
<th align="center" colspan="2">Low mutation</th>
<th align="center" colspan="2">Medium mutation</th>
<th align="center" colspan="2">High mutation</th>
</tr>
<tr>
<th align="center">Correct class</th>
<th align="center">clonal</th>
<th align="center">mixed</th>
<th align="center">clonal</th>
<th align="center">mixed</th>
<th align="center">clonal</th>
<th align="center">mixed</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Low reinfection</td>
<td align="center">96%</td>
<td align="center">99%</td>
<td align="center">97%</td>
<td align="center">96%</td>
<td align="center">89%</td>
<td align="center">94%</td>
</tr>
<tr>
<td align="center">Medium reinfection</td>
<td align="center">96%</td>
<td align="center">99%</td>
<td align="center">94%</td>
<td align="center">96%</td>
<td align="center">84%</td>
<td align="center">95%</td>
</tr>
<tr>
<td align="center">High reinfection</td>
<td align="center">94%</td>
<td align="center">99%</td>
<td align="center">92%</td>
<td align="center">97%</td>
<td align="center">76%</td>
<td align="center">97%</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
</sec>
<sec id="sec009" sec-type="conclusions">
<title>Discussion</title>
<p>ClassTR is the first alternative method for classifying complex bacterial strains as either clonally heterogeneous or mixed infections. In contrast with the existing rule-based classification method, it includes an explicit model of tandem repeat evolution and utilizes information from other strains collected locally, provides probabilistic rather than deterministic classifications, and allows for the identification of individual strains within complex infections.</p>
<p>There are two computational problems that ClassTR solves. The first one, which we called the Parsimonious Resolution Problem and showed to be NP-complete, is reminiscent of haplotyping problems in eukaryotic genomes [<xref ref-type="bibr" rid="pcbi.1004475.ref022">22</xref>]. The key difference is the haploid nature of the bacterial genomes we analyze; the observed complexity in the strains is the result of the genotyping technique we use rather than an actual allelic variation due to recombination. The second one, which is the classification problem for complex bacterial strains, is reminiscent of the type of problems that arise in cancer genomics [<xref ref-type="bibr" rid="pcbi.1004475.ref023">23</xref>] in deciding whether particular tumor genotypes are related to one another (similar to clonal heterogeneity) or have arisen independently (similar to mixed infection). The key difference is the evolutionary model we adopt for tandem repeats, which may not apply to cancer.</p>
<p>At the current time we lack a “gold standard” approach for determining which infections are actually complex, and whether these complex infections are due to within-host mutation or reinfection. This makes it challenging to evaluate the relative performance of the standard rule-based approach and ClassTR. While future advances in genome sequencing are likely to provide additional data to test ClassTR against the standard rule-based approach, our results on simulated data suggest that ClassTR provides more accurate classifications than the standard approach, and the additional computational resources are justified by the improvement in classification accuracy. While the performance of ClassTR and the standard method for classification of complex infections is similar if the true mutation rate of MIRU-VNTR loci is at the lowest end of the plausible range, ClassTR outperforms the standard method under scenarios with higher mutation rates within this range. Furthermore, applying ClassTR to our data from KwaZulu Natal generates results that are substantially different from the standard rule-based method, which demonstrates that the difference between these approaches is not just theoretical. In addition, ClassTR provides the only available approach to extract the constituent strains involved in a mixed infection from MIRU-VNTR data alone.</p>
<p>There are several opportunities to modify the models we have used to even better reflect the evolutionary process driving copy number variation. First, our evolutionary model does not account for the fact that some evolutionary events may duplicate multiple segments in a single timestep. A more sophisticated model might allow for such duplication events to happen, albeit at a small rate, and this rate could be estimated from available data. Second, we model copy number increases and decreases symmetrically, whereas a more flexible model could allow these events to occur at different rates. Finally, an alternate model might be needed to account for the possibility that two strains may be simultaneously transmitted from one person to another or for the possibility of having more than two strains within a host, which may be relevant for certain types of infectious pathogens [<xref ref-type="bibr" rid="pcbi.1004475.ref024">24</xref>]. In addition, an intriguing opportunity for future work would be to investigate how accurate the classifications of complex infections as clonal or mixed could be at the time that each patient is admitted, rather than at the end of the study as we have done here, as well as to take into account the information about the strains found in a patient’s contacts, such as household contacts, perhaps by using these to constrain resolutions.</p>
<p>In conclusion, ClassTR is a tool which we believe will advance our capacity to identify the mechanisms underlying within-host heterogeneity in TB and other bacteria. By distinguishing within-host mutation from reinfection, we anticipate that this method will improve our understanding of the natural history of pathogenic infection at the individual patient level, and will improve our ability to project transmission dynamics and the effects of interventions in communities.</p>
</sec>
<sec id="sec010" sec-type="materials|methods">
<title>Methods</title>
<p>This part of the paper is organized as follows. First, we define simple and complex strains, and explain how simple strains can cover complex strains. These definitions allow us to formulate our first problem, that of resolving the complex strains into simple strains by introducing as few simple strains unobserved in the data as possible. In the <bold>Supplementary Materials</bold> (<xref ref-type="supplementary-material" rid="pcbi.1004475.s001">S1 Text</xref>) we show that this problem is NP-complete. We continue by showing how this problem can be efficiently solved using a mixed integer linear programming formulation. In the <bold>Supplementary Materials</bold> (<xref ref-type="supplementary-material" rid="pcbi.1004475.s001">S1 Text</xref>) we also explain how this problem can be simplified using graph decomposition, and how the number of solutions can be further reduced by using an idea from information theory known as the <italic>minimum description length</italic>. We conclude by describing the model of tandem repeat evolution and the method we use to classify complex strains as arising from clonal heterogeneity or mixed infection. In the <bold>Supplementary Materials</bold> (<xref ref-type="supplementary-material" rid="pcbi.1004475.s001">S1 Text</xref>) we further elaborate on some alternative models we have considered and how they influence our results.</p>
<sec id="sec011">
<title>Covers of complex strains</title>
<p>In this section we define simple and complex strains and describe the principled way in which ClassTR separates complex strains into simple strains.</p>
<p>We formally define a <italic>simple strain</italic> as a string of length <italic>L</italic> (for MIRU-VNTR, <italic>L</italic> = 12 or <italic>L</italic> = 24) over the alphabet <italic>A</italic> consisting of all integers from 0 to some upper bound <italic>t</italic><sub>max</sub>. If <bold>s</bold> is a simple strain, we denote by <bold>s</bold><sub><italic>j</italic></sub> its <italic>j</italic>-th symbol. We define a <italic>complex strain</italic> as a string of length <italic>L</italic> over the alphabet <inline-formula id="pcbi.1004475.e001"><alternatives><graphic id="pcbi.1004475.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004475.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mstyle mathvariant="script"><mml:mi>P</mml:mi></mml:mstyle> <mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:mi>A</mml:mi> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, the power set of <italic>A</italic>, so that each of its symbols is a subset of <italic>A</italic>. If <bold>s</bold> is a complex strain, we call <bold>s</bold><sub><italic>j</italic></sub> the <italic>content</italic> of <bold>s</bold> at position <italic>j</italic>.</p>
<p>A collection <italic>C</italic> of simple strains will be called a <italic>cover</italic> for a complex strain <bold>s</bold> if at each position 1 ≤ <italic>j</italic> ≤ <italic>L</italic>, we have <bold>s</bold><sub><italic>j</italic></sub> ⊂ ∪<sub><bold>c</bold>∈<italic>C</italic></sub> <bold>c</bold><sub><italic>j</italic></sub>. In other words, the content of the strain <bold>s</bold> at each locus is included in <italic>C</italic>. A collection <italic>C</italic> will be called an <italic>exact cover</italic> for a complex strain <bold>s</bold> if equality holds, i.e. <bold>s</bold><sub><italic>j</italic></sub> = ∪<sub><bold>c</bold>∈<italic>C</italic></sub> <bold>c</bold><sub><italic>j</italic></sub> ∀1 ≤ <italic>j</italic> ≤ <italic>L</italic>; in this case, <italic>C</italic> includes the content of <bold>s</bold> at each locus, and nothing else. A collection <italic>C</italic> will be called a <italic>minimal (exact) cover</italic> of <bold>s</bold> if <italic>C</italic> is an (exact) cover of <bold>s</bold> and no proper subset of <italic>C</italic> is. We always look for minimal exact covers for reasons of parsimony.</p>
<p>When a complex strain <bold>s</bold> has all contents of size 1 or 2, there exist minimal exact covers of size 2, and the number of such covers is 2<sup><italic>q</italic>−1</sup>, where <italic>q</italic> is the number of positions with content of size 2. The value of <italic>q</italic> attains a maximum of 12 in our dataset, meaning that a single complex strain can have up to 2048 different covers.</p>
<p>Given the multiplicity of possible minimal covers for each complex strain, we use a global parsimony assumption to identify the ones that are actually present. Namely, we assume that, all other things being equal, the fewer simple strains we add to the ones in the dataset to cover all the complex strains, the better. Intuitively, this means that we attempt to explain complex infections in terms of strains we have observed as simple infections in the population. Thus we seek to cover all the complex strains by adding the smallest possible number of strains. <xref ref-type="fig" rid="pcbi.1004475.g002">Fig 2</xref> presents a toy example of a dataset with its solution.</p>
</sec>
<sec id="sec012">
<title>The parsimonious resolution problem</title>
<p>In this section we formalize the problem of resolving the complex strains by introducing as few new simple strains as possible, which we call the parsimonious resolution problem. In the <bold>Supplementary Materials</bold> (<xref ref-type="supplementary-material" rid="pcbi.1004475.s001">S1 Text</xref>) we show that the decision version of this problem is NP-complete, even in the case of all copy number variants being 0 or 1. As a corollary, our proof establishes that the parsimonious resolution problem for spoligotype data (where a 0 indicates the absence and a 1 the presence of a particular region), a version of which was studied by Lazzarini et al [<xref ref-type="bibr" rid="pcbi.1004475.ref025">25</xref>], is also NP-complete.</p>
<p>The decision version of the parsimonious resolution problem (PRP) can be stated as follows.</p>
<p>Given: an integer <italic>L</italic>; a finite alphabet <italic>A</italic>; a set of strings <italic>S</italic> = {<italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>, …, <italic>s</italic><sub><italic>k</italic></sub>} of length <italic>L</italic> over <italic>A</italic> ∪ <italic>A</italic><sup>2</sup>, but not entirely over <italic>A</italic> (i.e. each position contains 1 or 2 elements of <italic>A</italic>, with at least one position containing 2 elements of <italic>A</italic>); a set of “free” strings <italic>F</italic> = {<italic>f</italic><sub>1</sub>, …, <italic>f</italic><sub><italic>m</italic></sub>} of length <italic>L</italic> over <italic>A</italic>; an integer <italic>K</italic>.</p>
<p>Decide: whether there exists a collection <italic>C</italic> = {<italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>, …, <italic>c</italic><sub><italic>K</italic></sub>} of <italic>K</italic> strings of length <italic>L</italic> over <italic>A</italic>, such that, for each string <italic>s</italic> ∈ <italic>S</italic> there exist 2 strings <italic>c</italic> and <italic>c</italic>′ in <italic>C</italic> ∪ <italic>F</italic>, such that <italic>c</italic> ∪ <italic>c</italic>′ = <italic>s</italic> (where the union is taken component-wise).</p>
<p>The correspondence between the PRP and the problem we are actually solving is as follows: <italic>L</italic> is the number of loci, <italic>A</italic> is the set of possible CNVs, <italic>S</italic> are the complex infections present in the data and <italic>F</italic> are the simple infections present in the data. Finally, <italic>K</italic> is the number of additional (new) simple strains we are seeking to add to <italic>F</italic> in order to resolve all the complex infections.</p>
</sec>
<sec id="sec013">
<title>Integer linear program formulation</title>
<p>In this section we formulate the 0–1 integer linear program [<xref ref-type="bibr" rid="pcbi.1004475.ref026">26</xref>] for the parsimonious resolution problem. This integer linear program finds a set of simple strains that cover the complex strains in the dataset, paying for each simple strain that is not present in the dataset. It minimizes the total cost of these newly added simple strains. Its inputs are a set of simple strains that can be used “for free” and the set of complex strains to be covered. Its outputs are the variables corresponding to the new simple strains used in covering the complex strains.</p>
<p>Let <italic>N</italic> be the number of simple strains, <italic>n</italic> be the number of complex strains, and <italic>q</italic><sub><italic>i</italic></sub> be the number of complex loci in the <italic>i</italic>th complex strain. For simplicity we assume that there are exactly 2 copy number variants at each complex locus, which is the case for our dataset. Let <italic>S</italic><sub><italic>i</italic></sub> be the set of all simple strains that may be used to cover the <italic>i</italic>th complex strain, so that |<italic>S<sub>i</sub></italic>| = <italic>Q<sub>i</sub></italic> = 2<sup><italic>q<sub>i</sub></italic></sup>. Let us also define <inline-formula id="pcbi.1004475.e002"><alternatives><graphic id="pcbi.1004475.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004475.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mi>Q</mml:mi> <mml:mo>≔</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Let <inline-formula id="pcbi.1004475.e003"><alternatives><graphic id="pcbi.1004475.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004475.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>≔</mml:mo> <mml:msubsup><mml:mo>∪</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <italic>q</italic> := |<italic>S</italic>|. Note that <italic>q</italic> ≤ <italic>Q</italic>.</p>
<p>We define two categories of variables, one to indicate usage, and the other to indicate coverage. The usage variables are denoted <italic>u</italic><sub><italic>j</italic></sub> and are defined for every strain <italic>j</italic> in <italic>S</italic>. The value of <italic>u</italic><sub><italic>j</italic></sub> is 1 if the simple strain <italic>j</italic> is used in the cover of at least one complex strain, and 0 otherwise. The coverage variables are denoted <italic>c</italic><sub><italic>ij</italic></sub> and are defined for every complex strain <italic>i</italic> and every simple strain <italic>j</italic> in <italic>S</italic><sub><italic>i</italic></sub>. The value of <italic>c</italic><sub><italic>ij</italic></sub> is 1 if the simple strain <italic>j</italic> is used to cover the complex strain <italic>i</italic>, and 0 otherwise. For a complex strain <italic>i</italic> and a simple strain <italic>j</italic> in <italic>S</italic><sub><italic>i</italic></sub>, we denote by <italic>i</italic>∖<italic>j</italic> the <italic>complement</italic> of <italic>j</italic> in <italic>i</italic>, namely, the simple strain that, together with <italic>j</italic>, covers <italic>i</italic> (here we use the assumption that every complex locus has exactly 2 CNVs). The complement <italic>i</italic>∖<italic>j</italic> can be obtained by taking the CNV in each complex locus of <italic>i</italic> that was not used in <italic>j</italic>.</p>
<p>For each simple strain <italic>j</italic> in <italic>S</italic> we also define the cost <italic>w</italic><sub><italic>j</italic></sub> of adding it to the cover. The objective function is simply a linear combination of the usage variables <italic>u</italic><sub><italic>j</italic></sub> with the costs <italic>w</italic><sub><italic>j</italic></sub> as coefficients. We always take <italic>w</italic><sub><italic>j</italic></sub> = 0 if the simple strain <italic>j</italic> is present in the dataset, because it is already available to be used in a cover. We also take <italic>w</italic><sub><italic>j</italic></sub> = 1 for any simple strain <italic>j</italic> not present in the dataset, so the total cost ends up being the number of new strains used. The optimal solution is the one minimizing this total cost.</p>
<p>This leads us to the following integer linear program formulation:
<disp-formula id="pcbi.1004475.e004"><alternatives><graphic id="pcbi.1004475.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004475.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mrow><mml:mtext>Minimize</mml:mtext> <mml:mspace width="0.277778em"/><mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msub><mml:mi>w</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>u</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mspace width="0.277778em"/><mml:mtext>subject</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>to</mml:mtext></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula> <disp-formula id="pcbi.1004475.e005"><alternatives><graphic id="pcbi.1004475.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004475.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow> <mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>j</mml:mi></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula> <disp-formula id="pcbi.1004475.e006"><alternatives><graphic id="pcbi.1004475.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004475.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow> <mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula> <disp-formula id="pcbi.1004475.e007"><alternatives><graphic id="pcbi.1004475.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004475.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>\</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula> <disp-formula id="pcbi.1004475.e008"><alternatives><graphic id="pcbi.1004475.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004475.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula> <disp-formula id="pcbi.1004475.e009"><alternatives><graphic id="pcbi.1004475.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004475.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>≤</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>j</mml:mi></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula> <disp-formula id="pcbi.1004475.e010"><alternatives><graphic id="pcbi.1004475.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004475.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>≤</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>∀</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>i</mml:mi></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula></p>
<p>The first two sets of constraints, Eqs (<xref ref-type="disp-formula" rid="pcbi.1004475.e005">2</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004475.e006">3</xref>), ensure that all the variables take values 0 or 1. The next set of constraints, <xref ref-type="disp-formula" rid="pcbi.1004475.e007">Eq (4)</xref>, ensures that the simple strain <italic>j</italic> is used to cover the complex strain <italic>i</italic> if and only if its complement simple strain, <italic>i</italic>∖<italic>j</italic>, is also used to cover the complex strain <italic>i</italic>. The next two sets of constraints ensure that the simple strain <italic>j</italic> is marked as used if (<xref ref-type="disp-formula" rid="pcbi.1004475.e008">Eq (5)</xref>) and only if (<xref ref-type="disp-formula" rid="pcbi.1004475.e009">Eq (6)</xref>) it is used to cover at least one complex strain <italic>i</italic>. Finally, the last set of constraints, <xref ref-type="disp-formula" rid="pcbi.1004475.e010">Eq (7)</xref>, ensure that the complex strain <italic>i</italic> is covered in at least one way by simple strains.</p>
<p>The number of <italic>u</italic><sub><italic>j</italic></sub> variables and constraints in <xref ref-type="disp-formula" rid="pcbi.1004475.e005">Eq (2)</xref> is <italic>q</italic> ≤ <italic>Q</italic>; the number of <italic>c</italic><sub><italic>ij</italic></sub> variables and constraints in <xref ref-type="disp-formula" rid="pcbi.1004475.e006">Eq (3)</xref> is <italic>Q</italic>; the number of constraints in <xref ref-type="disp-formula" rid="pcbi.1004475.e007">Eq (4)</xref> is <italic>Q</italic>/2; the number of constraints in <xref ref-type="disp-formula" rid="pcbi.1004475.e008">Eq (5)</xref> is <italic>Q</italic>; the number of constraints in <xref ref-type="disp-formula" rid="pcbi.1004475.e009">Eq (6)</xref> is <italic>q</italic> ≤ <italic>Q</italic>; and the number of constraints in <xref ref-type="disp-formula" rid="pcbi.1004475.e010">Eq (7)</xref> is <italic>n</italic>, for a total of <italic>Q</italic> + <italic>q</italic> ≤ 2<italic>Q</italic> variables and (5/2)<italic>Q</italic> + 2<italic>q</italic> + <italic>n</italic> ≤ (9/2)<italic>Q</italic> + <italic>n</italic> constraints. In particular, for our South African dataset, <italic>n</italic> = 92 and <italic>Q</italic> is roughly 8,000, while for our simulated datasets, <italic>n</italic> = 83 and <italic>Q</italic> varies from 5,000 to 25,000, so the total number of variables is always under 50,000 and the number of constraints under 100,000. Integer linear programs of this size can typically be solved to optimality in seconds by CPLEX (available from <ext-link ext-link-type="uri" xlink:href="http://www-01.ibm.com/software/integration/optimization/cplex-optimizer" xlink:type="simple">http://www-01.ibm.com/software/integration/optimization/cplex-optimizer</ext-link>). The total time required by ClassTR is about 5 minutes for the South African dataset with <italic>N</italic> = 436 strains. We additionally tested our method on a much larger dataset containing <italic>N</italic> = 4075 strains with <italic>n</italic> = 364 of them complex. Its processing took less than an hour on a single CPU, suggesting that our algorithm scales well with input size in practice.</p>
</sec>
<sec id="sec014">
<title>Distances on simple strains</title>
<p>In this section we define the four distances we use in ClassTR. These distances can be used to construct the predecessor sets which then allow us to calculate the probability of each complex strain being clonally heterogeneous or mixed.</p>
<p>We define the <italic>constant metric</italic> <bold>d</bold><sub><bold>C</bold></sub> between two simple strains as
<disp-formula id="pcbi.1004475.e011"><alternatives><graphic id="pcbi.1004475.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004475.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mrow><mml:msub><mml:mi mathvariant="bold">d</mml:mi> <mml:mi mathvariant="bold">C</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="bold">s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:mrow><mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">s</mml:mi> <mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
This corresponds to the minimum number of mutation events needed to get from one strain to the other in the constant model of tandem repeat evolution defined by Aandahl et al [<xref ref-type="bibr" rid="pcbi.1004475.ref020">20</xref>]. Indeed, since the constant model assumes a Poisson process at each locus, |<italic>i</italic> − <italic>j</italic>| is precisely the number of mutations required to get from <italic>i</italic> to <italic>j</italic>.</p>
<p>We also define the <italic>linear metric</italic> <bold>d</bold><sub><bold>L</bold></sub> between two simple strains as
<disp-formula id="pcbi.1004475.e012"><alternatives><graphic id="pcbi.1004475.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004475.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mrow><mml:msub><mml:mi mathvariant="bold">d</mml:mi> <mml:mi mathvariant="bold">L</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="bold">s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo></mml:mrow> <mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">s</mml:mi> <mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">s</mml:mi> <mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:munderover> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>k</mml:mi></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
This corresponds to the expected number of timesteps needed to get from one strain to the other in the linear model of tandem repeat evolution defined by Aandahl et al [<xref ref-type="bibr" rid="pcbi.1004475.ref020">20</xref>]. Indeed, since the linear model assumes that a Poisson process takes place at each copy, it takes an expected 1/<italic>m</italic> timesteps to go from <italic>m</italic> to <italic>m</italic> − 1 copies.</p>
<p>Two other standard metrics we use are the <italic>Goldstein metric</italic> <bold>d</bold><sub><bold>G</bold></sub> and the <italic>Hamming (categorical) metric</italic> <bold>d</bold><sub><bold>H</bold></sub>, respectively defined as
<disp-formula id="pcbi.1004475.e013"><alternatives><graphic id="pcbi.1004475.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004475.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mrow><mml:msub><mml:mi mathvariant="bold">d</mml:mi> <mml:mi mathvariant="bold">G</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="bold">s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>L</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">s</mml:mi> <mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="1.em"/><mml:mtext>and</mml:mtext> <mml:mspace width="1.em"/><mml:msub><mml:mi mathvariant="bold">d</mml:mi> <mml:mi mathvariant="bold">H</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="bold">s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi mathvariant="bold">s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>≠</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">s</mml:mi> <mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where [<italic>I</italic>] is the Iverson bracket whose value is 1 if expression <italic>I</italic> is true and 0 otherwise. Note that the Goldstein metric is not a metric in the traditional sense because it does not respect the triangle inequality.</p>
<p>In addition we define weighted analogs of all these metrics, which are obtained by multiplying the contribution of each locus by its weight. To estimate the weight of each locus ClassTR uses the Simpson index [<xref ref-type="bibr" rid="pcbi.1004475.ref027">27</xref>], also known as the Hunter-Gaston index [<xref ref-type="bibr" rid="pcbi.1004475.ref028">28</xref>], reasoning that the more diverse a locus is, the faster it evolves and the less weight it should carry. These weights then allow us to compute the corresponding weighted distances in the constant or linear models defined below, which we denote <inline-formula id="pcbi.1004475.e014"><alternatives><graphic id="pcbi.1004475.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004475.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msubsup><mml:mi mathvariant="bold">d</mml:mi> <mml:mi mathvariant="bold">c</mml:mi> <mml:mi mathvariant="bold">w</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004475.e015"><alternatives><graphic id="pcbi.1004475.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004475.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msubsup><mml:mi mathvariant="bold">d</mml:mi> <mml:mi mathvariant="bold">L</mml:mi> <mml:mi mathvariant="bold">w</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, respectively. In our datasets these weights ranged from 0.16 to 1.</p>
</sec>
<sec id="sec015">
<title>Predecessor sets and classification</title>
<p>Given the set of simple strains generated by the optimization, we describe how to produce the final soft classification of complex strains along the clonally heterogeneous to mixed spectrum in this section.</p>
<p>We start by choosing a distance function <bold>d</bold> on simple strains. Given a strain <italic>j</italic>, we define the <italic>predecessor set</italic> <italic>P</italic>(<italic>j</italic>) as the subset of the simple strains <italic>S</italic> present in the original dataset that are closest to <italic>s</italic> according to <bold>d</bold>. Formally,
<disp-formula id="pcbi.1004475.e016"><alternatives><graphic id="pcbi.1004475.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004475.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≔</mml:mo> <mml:mo form="prefix">arg</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:munder> <mml:mi mathvariant="bold">d</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
<p>Of course, for any strain <italic>s</italic> ∈ <italic>S</italic>, the predecessor set only contains <italic>s</italic> itself (we do not take the presence of duplicate strains into account). We also note that the more highly resolving the distance, the smaller the predecessor sets are going to be. Thus, the unweighted constant distance could give rise to ties for the closest strain, but the weighted constant distance or the linear distance is less likely to yield a tie.</p>
<p>Intuitively, the more similar the predecessor sets of the constituent strains are to each other, the more likely the complex strain is to be clonally heterogeneous. For example, if two different covering strains are both very close to the same simple strain in the dataset, the complex strain composed of both of them is more likely to be clonal than if the two strains’ nearest matches in the data are two very different strains. We formalize this by using the Jaccard index [<xref ref-type="bibr" rid="pcbi.1004475.ref029">29</xref>] to evaluate the similarity of two sets <italic>A</italic> and <italic>B</italic>, defined as the size of their intersection divided by the size of their union:
<disp-formula id="pcbi.1004475.e017"><alternatives><graphic id="pcbi.1004475.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004475.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mrow><mml:mi>J</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>,</mml:mo> <mml:mi>B</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≔</mml:mo> <mml:mfrac><mml:mrow><mml:mo>|</mml:mo> <mml:mi>A</mml:mi> <mml:mo>∩</mml:mo> <mml:mi>B</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>A</mml:mi> <mml:mo>∪</mml:mo> <mml:mi>B</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
<p>Suppose that <italic>A</italic> and <italic>B</italic> are the predecessor sets of the constituent strains of a complex strain. Then we take the Jaccard index of <italic>A</italic> and <italic>B</italic> as the probability of the complex strains being clonally heterogeneous. Thus, a complex strain covered by two strains with identical predecessor sets will be classified as clonally heterogeneous, while one with two strains with non-overlapping predecessor sets (for example one covered by two distinct simple strains present in the original dataset) will be classified as mixed, with intermediate variants also possible as shown in <xref ref-type="fig" rid="pcbi.1004475.g003">Fig 3</xref>. This probability is the value we report as our final classification.</p>
</sec>
</sec>
<sec id="sec016">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004475.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004475.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Additional details on the methods used: NP-completeness proof; minimum description length formalism; strain intersection graph; enumeration of optimal solutions; details of the simulation approach; and selection of the best method for ClassTR.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004475.s002" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004475.s002" xlink:type="simple">
<label>S1 Code</label>
<caption>
<title>The R package implementing the ClassTR method.</title>
<p>The zip file must be unzipped using a non-recursive decompression utility that preserves the internal file structure. The extracted package can then be installed via the R command <italic>install.packages(pkgs = “ClassTR_0.1.0.tar.gz”, repos = NULL)</italic> from the directory it is unzipped to.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors would like to thank Mr. Hassan Idrissi Alami for help with the R package, Dr. Sarah Otto for a useful suggestion, Dr. Pia Abel zur Wiesch for helpful discussions and Wendolyn Hill for help in preparing the figures.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004475.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nadon</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Trees</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Ng</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Møller Nielsen</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Reimer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Maxwell</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Development and application of MLVA methods as a tool for inter-laboratory surveillance</article-title>. <source>Euro Surveill</source>. <year>2013</year>;<volume>18</volume>(<issue>35</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2807/1560-7917.ES2013.18.35.20565" xlink:type="simple">10.2807/1560-7917.ES2013.18.35.20565</ext-link></comment> <object-id pub-id-type="pmid">24008231</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cohen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>van Helden</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Colijn</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>McLaughlin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Abubakar</surname> <given-names>I</given-names></name>, <etal>et al</etal>. <article-title>Mixed-strain Mycobacterium tuberculosis infections and the implications for tuberculosis treatment and control</article-title>. <source>Clin Microbiol Rev</source>. <year>2012</year>;<volume>25</volume>(<issue>4</issue>):<fpage>708</fpage>–<lpage>719</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/CMR.00021-12" xlink:type="simple">10.1128/CMR.00021-12</ext-link></comment> <object-id pub-id-type="pmid">23034327</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Rie</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Victor</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>van der Spuy</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Reinfection and mixed infection cause changing Mycobacterium tuberculosis drug-resistance patterns</article-title>. <source>Am J Respir Crit Care Med</source>. <year>2005</year>;<volume>172</volume>:<fpage>636</fpage>–<lpage>642</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1164/rccm.200503-449OC" xlink:type="simple">10.1164/rccm.200503-449OC</ext-link></comment> <object-id pub-id-type="pmid">15947286</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hingley-Wilson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Casey</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Connell</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Bremang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Evans</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hawkey</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Undetected multidrug-resistant tuberculosis amplified by first-line therapy in mixed infection</article-title>. <source>Emerging Infectious Diseases</source>. <year>2013</year>;<volume>19</volume>(<issue>7</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3201/eid1907.130313" xlink:type="simple">10.3201/eid1907.130313</ext-link></comment> <object-id pub-id-type="pmid">23764343</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zetola</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Modongo</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Moonan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ncube</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Matlhagela</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sepako</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Clinical outcomes among persons with pulmonary tuberculosis disease caused by M. tuberculosis isolates with phenotypic DST heterogeneity</article-title>. <source>Journal of Infectious Diseases</source>. <year>2014</year>;<volume>209</volume>(<issue>11</issue>):<fpage>1754</fpage>–<lpage>1763</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/infdis/jiu040" xlink:type="simple">10.1093/infdis/jiu040</ext-link></comment> <object-id pub-id-type="pmid">24443546</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Colijn</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>M</given-names></name>. <article-title>Latent coinfection and the maintenance of strain diversity</article-title>. <source>Bull Math Biol</source>. <year>2009</year>;<volume>71</volume>(<issue>1</issue>):<fpage>247</fpage>–<lpage>263</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s11538-008-9361-y" xlink:type="simple">10.1007/s11538-008-9361-y</ext-link></comment> <object-id pub-id-type="pmid">19082663</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sergeev</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Colijn</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>T</given-names></name>. <article-title>Models to understand the population-level impact of mixed strain M. tuberculosis infections</article-title>. <source>J Theor Biol</source>. <year>2011</year>;<volume>280</volume>:<fpage>88</fpage>–<lpage>100</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2011.04.011" xlink:type="simple">10.1016/j.jtbi.2011.04.011</ext-link></comment> <object-id pub-id-type="pmid">21514304</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gomes</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Franco</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gomes</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Medley</surname> <given-names>G</given-names></name>. <article-title>The reinfection threshold promotes variability in tuberculosis epidemiology and vaccine efficacy</article-title>. <source>Proc Biol Sci</source>. <year>2004</year>;<volume>271</volume>(<issue>1539</issue>):<fpage>617</fpage>–<lpage>623</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspb.2003.2606" xlink:type="simple">10.1098/rspb.2003.2606</ext-link></comment> <object-id pub-id-type="pmid">15156920</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vynnycky</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sumner</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Fielding</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Lewis</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cox</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hayes</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Tuberculosis control in South African gold mines: mathematical modeling of a trial of community-wide isoniazid preventive therapy</article-title>. <source>American Journal of Epidemiology</source>. <year>2015</year>;<volume>181</volume>(<issue>8</issue>):<fpage>619</fpage>–<lpage>632</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/aje/kwu320" xlink:type="simple">10.1093/aje/kwu320</ext-link></comment> <object-id pub-id-type="pmid">25792607</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Read</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Day</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Huijben</surname> <given-names>S</given-names></name>. <article-title>The evolution of drug resistance and the curious orthodoxy of aggressive chemotherapy</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2011</year>;<volume>108</volume>(<issue>Supplement 2</issue>):<fpage>10871</fpage>–<lpage>10877</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1100299108" xlink:type="simple">10.1073/pnas.1100299108</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ankomah</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Levin</surname> <given-names>B</given-names></name>. <article-title>Exploring the collaboration between antibiotics and the immune response in the treatment of acute, self-limiting infections</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2014</year>;<volume>111</volume>(<issue>23</issue>):<fpage>8331</fpage>–<lpage>8338</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1400352111" xlink:type="simple">10.1073/pnas.1400352111</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mathema</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Kurepina</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Bifani</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kreiswirth</surname> <given-names>B</given-names></name>. <article-title>Molecular Epidemiology of Tuberculosis: Current Insights</article-title>. <source>Clin Microbiol Rev</source>. <year>2006</year>;<volume>19</volume>(<issue>4</issue>):<fpage>658</fpage>–<lpage>685</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/CMR.00061-05" xlink:type="simple">10.1128/CMR.00061-05</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref013">
<label>13</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Supply</surname> <given-names>P</given-names></name>. <source>Multilocus Variable Number Tandem Repeat Genotyping of Mycobacterium tuberculosis</source>. <publisher-name>Institut de Biologie/Institut Pasteur de Lille</publisher-name>; <year>2005</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004475.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Supply</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Allix</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lesjean</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Cardoso-Oelemann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rüsch-Gerdes</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Willery</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Proposal for standardization of optimized mycobacterial interspersed repetitive unit-variable-number tandem repeat typing of Mycobacterium tuberculosis</article-title>. <source>Clin Microbiol</source>. <year>2006</year>;<volume>44</volume>(<issue>12</issue>):<fpage>4498</fpage>–<lpage>4510</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/JCM.01392-06" xlink:type="simple">10.1128/JCM.01392-06</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shamputa</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Jugheli</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Sadradze</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Willery</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Portaels</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Supply</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Mixed infection and clonal representativeness of a single sputum sample in tuberculosis patients from a penitentiary hospital in Georgia</article-title>. <source>Respir Res</source>. <year>2006</year>;<volume>7</volume>(<issue>99</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1465-9921-7-99" xlink:type="simple">10.1186/1465-9921-7-99</ext-link></comment> <object-id pub-id-type="pmid">16846493</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Savine</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Warren</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>van der Spuy</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Beyers</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>van Helden</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Locht</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Stability of Variable- Number Tandem Repeats of Mycobacterial Interspersed Repetitive Units from 12 Loci in Serial Isolates of Mycobacterium tuberculosis</article-title>. <source>Clin Microbiol</source>. <year>2002</year>;<volume>40</volume>(<issue>12</issue>):<fpage>4561</fpage>–<lpage>4566</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/JCM.40.12.4561-4566.2002" xlink:type="simple">10.1128/JCM.40.12.4561-4566.2002</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Allix-Béguec</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wahl</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hanekom</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nikolayevskyy</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Drobniewski</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Maeda</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Proposal of a Consensus Set of Hypervariable Mycobacterial Interspersed Repetitive-Unit Variable-Number Tandem-Repeat Loci for Subtyping of Mycobacterium tuberculosis Beijing Isolates</article-title>. <source>Clin Microbiol</source>. <year>2014</year>;<volume>52</volume>(<issue>1</issue>):<fpage>164</fpage>–<lpage>172</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/JCM.02519-13" xlink:type="simple">10.1128/JCM.02519-13</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roetzer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Diel</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kohl</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Rückert</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Nübel</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Blom</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Whole Genome Sequencing versus Traditional Genotyping for Investigation of a Mycobacterium tuberculosis Outbreak: A Longitudinal Molecular Epidemiological Study</article-title>. <source>PLoS Med</source>. <year>2013</year>;<volume>10</volume>(<issue>2</issue>):<fpage>e1001387</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pmed.1001387" xlink:type="simple">10.1371/journal.pmed.1001387</ext-link></comment> <object-id pub-id-type="pmid">23424287</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref019">
<label>19</label>
<mixed-citation publication-type="book" xlink:type="simple">
<collab>R Core Team</collab>. <source>R: A language and environment for statistical computing</source>. <publisher-name>R Foundation for Statistical Computing</publisher-name>, <publisher-loc>Vienna, Austria</publisher-loc>. <year>2015</year>. <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org" xlink:type="simple">https://www.R-project.org</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1004475.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Aandahl</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Reyes</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sisson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tanaka</surname> <given-names>M</given-names></name>. <article-title>A Model-Based Bayesian Estimation of the Rate of Evolution of VNTR Loci in Mycobacterium tuberculosis</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>6</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002573" xlink:type="simple">10.1371/journal.pcbi.1002573</ext-link></comment> <object-id pub-id-type="pmid">22761563</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Belkum</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Scherer</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>van Alphen</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Verbrugh</surname> <given-names>H</given-names></name>. <article-title>Short-Sequence DNA Repeats in Prokaryotic Genomes</article-title>. <source>Microbiol Mol Biol Rev</source>. <year>1998</year>;<volume>62</volume>(<issue>2</issue>):<fpage>275</fpage>–<lpage>293</lpage>. <object-id pub-id-type="pmid">9618442</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref022">
<label>22</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gusfield</surname> <given-names>D</given-names></name>. <chapter-title>An Overview of Combinatorial Methods for Haplotype Inference</chapter-title>. In: <name name-style="western"><surname>Istrail</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Water- man</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>A</given-names></name>, editors. <source>Computational Methods for SNPs and Haplotype Inference. vol. 2983 of Lecture Notes in Computer Science</source>; <year>2004</year>. p. <fpage>9</fpage>–<lpage>25</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004475.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Oesper</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Satas</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Raphael</surname> <given-names>B</given-names></name>. <article-title>Quantifying tumor heterogeneity in whole-genome and whole-exome sequencing data</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>24</issue>):<fpage>3532</fpage>–<lpage>3540</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu651" xlink:type="simple">10.1093/bioinformatics/btu651</ext-link></comment> <object-id pub-id-type="pmid">25297070</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Balmer</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Tanner</surname> <given-names>M</given-names></name>. <article-title>Prevalence and implications of multiple-strain infections</article-title>. <source>Lancet Infectious Diseases</source>. <year>2011</year>;<volume>11</volume>:<fpage>868</fpage>–<lpage>878</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S1473-3099(11)70241-9" xlink:type="simple">10.1016/S1473-3099(11)70241-9</ext-link></comment> <object-id pub-id-type="pmid">22035615</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lazzarini</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Rosenfeld</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Huard</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Hill</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Lapa e Silva</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>DeSalle</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Mycobacterium tuberculosis spoligotypes that may derive from mixed strain infections are revealed by a novel computational approach</article-title>. <source>Infection, Genetics and Evolution</source>. <year>2012</year>;<volume>12</volume>(<issue>4</issue>):<fpage>798</fpage>–<lpage>806</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.meegid.2011.08.028" xlink:type="simple">10.1016/j.meegid.2011.08.028</ext-link></comment> <object-id pub-id-type="pmid">21920466</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref026">
<label>26</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Papadimitriou</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Steiglitz</surname> <given-names>K</given-names></name>. <chapter-title>Combinatorial optimization: algorithms and complexity</chapter-title>. <edition>1st ed</edition>. <source>Dover Books on Computer Science</source>. <publisher-loc>USA</publisher-loc>: <publisher-name>Dover Publications</publisher-name>; <year>1998</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004475.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jost</surname> <given-names>L</given-names></name>. <article-title>Entropy and diversity</article-title>. <source>Oikos</source>. <year>2006</year>;<volume>113</volume>(<issue>2</issue>):<fpage>363</fpage>–<lpage>375</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.2006.0030-1299.14714.x" xlink:type="simple">10.1111/j.2006.0030-1299.14714.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hunter</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Gaston</surname> <given-names>M</given-names></name>. <article-title>Numerical index of the discriminatory ability of typing systems: an applica- tion of Simpsons index of diversity</article-title>. <source>J Clin Microbiol</source>. <year>1988</year>;<volume>26</volume>(<issue>11</issue>):<fpage>2465</fpage>–<lpage>2466</lpage>. <object-id pub-id-type="pmid">3069867</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004475.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jaccard</surname> <given-names>P</given-names></name>. <article-title>Étude comparative de la distribution florale dans une portion des Alpes et des Jura</article-title>. <source>Bulletin de la Société Vaudoise des Sciences Naturelles</source>. <year>1901</year>;<volume>37</volume>:<fpage>547</fpage>–<lpage>579</lpage>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>