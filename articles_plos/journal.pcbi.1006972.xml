<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006972</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01885</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Confidence resets reveal hierarchical adaptive learning in humans</article-title>
<alt-title alt-title-type="running-head">Confidence and hierarchical learning</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Heilbron</surname>
<given-names>Micha</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6992-678X</contrib-id>
<name name-style="western">
<surname>Meyniel</surname>
<given-names>Florent</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="corresp" rid="cor001">*</xref>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001"><addr-line>Cognitive Neuroimaging Unit / NeuroSpin center / Institute for Life Sciences Frédéric Joliot / Fundamental Research Division / Commissariat à l'Energie Atomique et aux énergies alternatives; INSERM, Université Paris-Sud; Université Paris-Saclay; Gif-sur-Yvette, France</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Soltani</surname>
<given-names>Alireza</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Dartmouth College, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">florent.meyniel@cea.fr</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>9</day>
<month>4</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="collection">
<month>4</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>4</issue>
<elocation-id>e1006972</elocation-id>
<history>
<date date-type="received">
<day>6</day>
<month>11</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>21</day>
<month>3</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Heilbron, Meyniel</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006972"/>
<abstract>
<p>Hierarchical processing is pervasive in the brain, but its computational significance for learning under uncertainty is disputed. On the one hand, hierarchical models provide an optimal framework and are becoming increasingly popular to study cognition. On the other hand, non-hierarchical (flat) models remain influential and can learn efficiently, even in uncertain and changing environments. Here, we show that previously proposed hallmarks of hierarchical learning, which relied on reports of learned quantities or choices in simple experiments, are insufficient to categorically distinguish hierarchical from flat models. Instead, we present a novel test which leverages a more complex task, whose hierarchical structure allows generalization between different statistics tracked in parallel. We use reports of confidence to quantitatively and qualitatively arbitrate between the two accounts of learning. Our results support the hierarchical learning framework, and demonstrate how confidence can be a useful metric in learning theory.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Learning and predicting in every-day life is made difficult by the fact that our world is both uncertain (e.g. will it rain tonight?) and changing (e.g. climate change shakes up weather). When a change occurs, what has been learned must be revised: learning should therefore be flexible. One possibility that ensures flexibility is to constantly forget about the remote past and to rely on recent observations. This solution is computationally cheap but effective, and is at the core of many popular learning algorithms. Another possibility is to monitor the occurrence of changes themselves, and revise what has been learned accordingly. This solution requires a hierarchical representation, in which some factors like changes modify other aspects of learning. This solution is computational more complicated but it allows more sophisticated inferences. Here, we provide a direct way to test experimentally whether or not learners use a hierarchical learning strategy. Our results show that humans revise their beliefs and the confidence they hold in their beliefs in a way that is only compatible with hierarchical inference. Our results contribute to the characterization of the putative algorithms our brain may use to learn, and the neural network models that may implement these algorithms.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001665</institution-id>
<institution>Agence Nationale de la Recherche</institution>
</institution-wrap>
</funding-source>
<award-id>ANR-18-CE37-0010</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6992-678X</contrib-id>
<name name-style="western">
<surname>Meyniel</surname>
<given-names>Florent</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by CEA and ANR grant "CONFI-LEARN" (FM) and VSB Fund, Prins Bernhard Cultuurfonds and Institut français des Pays-Bas Descartes fellowships (MH). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="0"/>
<page-count count="24"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-04-19</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the manuscript and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>In real-world environments, learning is made difficult by at least two types of uncertainty [<xref ref-type="bibr" rid="pcbi.1006972.ref001">1</xref>]. First, there is inherent uncertainty in many real-world processes. For instance, the arrival of your daily commute may not be perfectly predictable but subject to occasional delays. Faced with such random fluctuations, learners should integrate as many observations as possible in order to obtain a stable, accurate estimate of the statistics of interest (e.g. the probability of delay) [<xref ref-type="bibr" rid="pcbi.1006972.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref003">3</xref>]. Second, there is the higher-order uncertainty related to sudden changes in those very statistics (<italic>change points</italic>). For instance, engineering works may increase the probability of delay for an extended period. When faced with a change point, learners should discount older observations and rely on recent ones instead, in order to flexibly update their estimate [<xref ref-type="bibr" rid="pcbi.1006972.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref004">4</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref005">5</xref>].</p>
<p>Confronted with both forms of uncertainty, the optimal learning strategy is to track not only the statistic of interest but also the higher-order probability of change points. This enables learners to render their estimate stable when the environment is stable (i.e. between change points) and flexible when the environment changes [<xref ref-type="bibr" rid="pcbi.1006972.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref004">4</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1006972.ref009">9</xref>]. Importantly, this approach assumes that learners use a <italic>hierarchical generative model</italic> of their environment. Such a model comprises multiple levels, of which lower levels depend on higher ones: current observations (level 1) are generated according to statistics of observations (level 2) which themselves may undergo change points (level 3). The hierarchical approach is widely used to study learning in both health [<xref ref-type="bibr" rid="pcbi.1006972.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref010">10</xref>] and disease [<xref ref-type="bibr" rid="pcbi.1006972.ref011">11</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref012">12</xref>]. However, efficient learning in dynamic environments is also possible <italic>without</italic> tracking higher-order factors such as the likelihood of individual change points [<xref ref-type="bibr" rid="pcbi.1006972.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1006972.ref016">16</xref>], and a large body of work indeed uses such a solution to model behavioral and brain responses [<xref ref-type="bibr" rid="pcbi.1006972.ref017">17</xref>–<xref ref-type="bibr" rid="pcbi.1006972.ref019">19</xref>]. Computationally, this approach is very different as it assumes that learners do not take higher-level factors (e.g. change points) into account, and hence use a non-hierarchical or <italic>flat</italic> model of the world.</p>
<p>The possibility that the brain uses internal hierarchical models of the world is an active area of research in cognitive science [<xref ref-type="bibr" rid="pcbi.1006972.ref020">20</xref>], and has important consequences for neurobiology, since hierarchical models [<xref ref-type="bibr" rid="pcbi.1006972.ref021">21</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref022">22</xref>] and non-hierarchical ones [<xref ref-type="bibr" rid="pcbi.1006972.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref018">18</xref>] require different neural architectures. In learning theory however, internal hierarchical models pose somewhat of a conundrum, being simultaneously assumed critical by some frameworks for learning under uncertainty [<xref ref-type="bibr" rid="pcbi.1006972.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref004">4</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref008">8</xref>] and unnecessary by others [<xref ref-type="bibr" rid="pcbi.1006972.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1006972.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref023">23</xref>].</p>
<p>One possible explanation for this conundrum is that the brain might resort to different learning algorithms in different situations. Here, we explore another explanation (compatible with the former): in many situations, flat approximations to hierarchical solutions are so efficient that both accounts become difficult to distinguish in practice. Indeed, previous studies using quantitative model comparison reported conflicting results: some authors found that learning was best explained by hierarchical models [<xref ref-type="bibr" rid="pcbi.1006972.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref011">11</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref024">24</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref025">25</xref>] while others found that flat models best explained their results [<xref ref-type="bibr" rid="pcbi.1006972.ref017">17</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref026">26</xref>].</p>
<p>Here, our goal is to provide an experimental learning situation in which learners demonstrably use a hierarchical model. We provide a task and a simple analysis that reliably tests whether learners use a hierarchical model of the world. Our test relies not just on comparing model fits, but also on detecting a <italic>qualitative signature</italic> or <italic>hallmark</italic> that is uniquely characteristic of an internal hierarchical model.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Modulations of apparent learning rate are not a hallmark of hierarchical processing</title>
<p>By tracking the higher-order probability of change-points, learners using a hierarchical model can adjust their weighting of prior knowledge and new observations to the changeability of the environment. A highly influential result suggesting that human learners might apply this strategy demonstrated that the <italic>apparent learning rate—</italic>technically the ratio between the update size and the prediction error at any given observation—was modulated by change points in humans [<xref ref-type="bibr" rid="pcbi.1006972.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref005">5</xref>]. This was argued a hallmark of hierarchical processing, since increasing the learning rate after change points would only be expected from a hierarchical learner (tracking both the statistics of observations and changes in those statistics) and not from a flat learner (tracking only the statistics). However, we show a counter-example: a flat learning model whose parameters are kept fixed and nevertheless shows systematic modulations of the apparent learning rate without actually tracking the higher-level likelihood of change points (<bold><xref ref-type="fig" rid="pcbi.1006972.g001">Fig 1</xref></bold>, Methods and <bold>Supplementary Results 2 in <xref ref-type="supplementary-material" rid="pcbi.1006972.s005">S1 File</xref></bold>). Although the modulations are smaller in the flat model than in the hierarchical one, they are qualitatively identical, demonstrating that such modulations are not uniquely characteristic of hierarchical models.</p>
<fig id="pcbi.1006972.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006972.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Apparent learning rate modulations in previous designs are not a hallmark of hierarchical processing.</title>
<p>This simulation is inspired by a previous study by Behrens et al [<xref ref-type="bibr" rid="pcbi.1006972.ref002">2</xref>], in which the reward probability was not fixed but changed abruptly; the authors used different volatility levels (i.e. different numbers of change points). Similarly, we generated sequences with low volatility (7 change points, see vertical plain black lines), and high volatility (see additional change points, vertical dashed dashed lines). The sequences were binary (absence or presence of reward) and the reward probability was resampled randomly after each change point. We consider two learning models: a hierarchical model, which estimates the reward rate, taking into account the possibility of change points; and a flat model that computes the reward rate near-optimally based on a fixed leaky count of observations, and a prior count of 1 for either outcome (see <xref ref-type="sec" rid="sec015">Methods</xref>). Each model has a single free parameter (respectively, a priori volatility and leak factor) which we fit to return the best estimate of the actual generative reward probabilities in both the low and high volatility conditions together. Keeping those best fitting parameters equal across both conditions, we measured the dynamic of the apparent learning rates of the models, defined as the ratio between the current update of the reward estimate (θ<sub>t+1</sub>-θ<sub>t</sub>) and the prediction error leading to this update (y<sub>t+1</sub>-θ<sub>t</sub>). The hierarchical model shows a transient increase in its apparent learning rate whenever a change point occurs, reflecting that it gives more weight to the observations that follow a change point. Such a dynamic adjustment of the apparent learning rate was reported in humans [<xref ref-type="bibr" rid="pcbi.1006972.ref005">5</xref>]. The flat model showed a qualitatively similar effect, despite the leakiness of its count being fixed. Note that since there are more change points in the higher volatility condition (dashed lines), the average learning rates of both models also increase overall with volatility, as previously reported in humans [<xref ref-type="bibr" rid="pcbi.1006972.ref002">2</xref>]. The lines show mean values across 1000 simulations; s.e.m. was about the line thickness and therefore omitted.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006972.g001" xlink:type="simple"/>
</fig>
<p>This counter-example suggests that the mere presence of apparent learning rate modulations is not sufficiently specific, and that a new qualitative test must tap into a different property in order to reveal a truly unique hallmark of hierarchical learning.</p>
</sec>
<sec id="sec004">
<title>Simulations suggest confidence can provide valuable information to discriminate models</title>
<p>When developing a new test, we first asked what quantity or metric the test should target. In earlier studies on learning under uncertainty, subjects tracked changing statistics such as the probability of reward or of a stimulus [<xref ref-type="bibr" rid="pcbi.1006972.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref017">17</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref025">25</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref027">27</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref028">28</xref>], or the mean of a physical quantity like the location or magnitude of reward [<xref ref-type="bibr" rid="pcbi.1006972.ref005">5</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref007">7</xref>]. Learning was then probed either from choices guided by the learned statistics [<xref ref-type="bibr" rid="pcbi.1006972.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref017">17</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref025">25</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref026">26</xref>] or using explicit reports of those statistics [<xref ref-type="bibr" rid="pcbi.1006972.ref005">5</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref008">8</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref027">27</xref>]. Both choices and explicit reports are <italic>first-order metrics</italic>, as they only reflect the estimated statistics themselves. However, since a first-order metric only describes the level of observations, and since all models aim at providing a good description of observations, a first-order metric may be seldom unique to a single model. By contrast, <italic>second-order metrics</italic>, such as the learner’s confidence about her estimates, also describe the learner’s inference and may convey additional information to discriminate models, not contained in the first-order estimate [<xref ref-type="bibr" rid="pcbi.1006972.ref029">29</xref>].</p>
<p>For illustration, we simulated a hierarchical model and a flat model (same models as in <bold><xref ref-type="fig" rid="pcbi.1006972.g001">Fig 1</xref></bold>). The latter is minimally different from the classic delta-rule, but extended so as to provide confidence levels (see <xref ref-type="sec" rid="sec015">Methods</xref> and <bold>Supplementary Results 1 in <xref ref-type="supplementary-material" rid="pcbi.1006972.s005">S1 File</xref></bold>). We simulated a typical learning problem, where participants estimate a reward probability that unpredictably changes discontinuously over time. Over a large range of possible task parameters, the probability estimates of the optimal hierarchical model and a near-optimal flat model were highly correlated (Pearson ρ&gt;0.9) whereas their confidence levels were much less correlated (see <bold><xref ref-type="fig" rid="pcbi.1006972.g002">Fig 2</xref> </bold>and <xref ref-type="sec" rid="sec015">Methods</xref>). The same conclusion holds when simulating a more complex learning task that we present below (See panels <bold>A-B in <xref ref-type="supplementary-material" rid="pcbi.1006972.s001">S1 Fig</xref></bold>). Note that while we used confidence, results should be similar when using other, related metrics (see <xref ref-type="sec" rid="sec009">Discussion</xref>).</p>
<fig id="pcbi.1006972.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006972.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Correlation between the hierarchical and flat models in a classic probability learning task is higher for probability estimates than for confidence levels.</title>
<p>We simulated a classic probability learning task, similar to the one by Behrens et al 2007. In this task, the binary observation made on each trial (e.g. presence or absence of reward) is governed by a probability that changes discontinuously at so-called change points. For the sake of generality, we varied the volatility (probability of a change point) and the step size of those changes (minimum fold change, in odds ratio, affecting the generative probability). For each combination of volatility and step size, we simulated 100 sequences to achieve stable results and we fit the single free parameter of each model (respectively, a priori volatility and leak factor) onto the actual generative probabilities of the observed stimuli in the sequences. The resulting parameterized models therefore return their best possible estimate of the hidden regularities, in each volatility-step size condition. We then simulated new sequences (again, 100 per condition) to measure <bold>(A)</bold> the correlation between the estimated probabilities of stimuli between the two models, and <bold>(B)</bold> the correlation (Pearson’s rho) between the confidence (log-precision) that those models entertained in those estimates. The correlations indicate that probability estimates are nearly indistinguishable between the two models, whereas their confidence levels are more different.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006972.g002" xlink:type="simple"/>
</fig>
<p>Importantly, these results only reflect <italic>average correlations</italic> and do not speak to unique hallmarks or signatures. Rather, they simply show that even when first-order estimates of two models are nearly indistinguishable, their second-order metrics can be much less correlated, thus offering an additional source of information not often considered in learning theory.</p>
</sec>
<sec id="sec005">
<title>A task allowing for a more direct test for an internal hierarchical model</title>
<p>A hierarchical model is defined by its levels, the variables in each level and the dependencies between those variables. However, these aspects are often confounded in previous experiments because their task structure was quite simple. In a typical experimental situation [<xref ref-type="bibr" rid="pcbi.1006972.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref005">5</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref017">17</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref025">25</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref027">27</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref028">28</xref>] the observations received by the subject (level 1) are controlled by <italic>only one statistic</italic> (level 2), such as the probability of reward, whose value abruptly changes at change points (level 3). This task structure is hierarchical, but so simple that it takes the form of a linear chain of dependencies: at each level, a single variable depends on a single variable of the next level (see <bold>panel A in <xref ref-type="supplementary-material" rid="pcbi.1006972.s002">S2 Fig</xref></bold>). With such a structure, the notions of hierarchy and changeability are confounded. This enables a learner that can cope with changeability, for instance by using leaky (and perhaps adjustable) integration [<xref ref-type="bibr" rid="pcbi.1006972.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref018">18</xref>], to learn effectively without needing an internal, hierarchical model of the task structure.</p>
<p>By contrast, using a more complex task structure gives rise to forms of inference and learning that are possible only if learners rely on an internal hierarchical model. Here, we build on a previously used task [<xref ref-type="bibr" rid="pcbi.1006972.ref008">8</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref024">24</xref>] in which two changing statistics are governed by the same change points. This breaks the pure linear structure of previous tasks by introducing a branch which renders its hierarchical nature more prominent, see <bold>panel B in <xref ref-type="supplementary-material" rid="pcbi.1006972.s002">S2 Fig</xref></bold>. Crucially, in this situation, <italic>only</italic> a hierarchical model can leverage the coupling of multiple statistics arising from a common higher-order factor and generalize appropriately between the estimated statistics. Probing this generalization will be our test for hierarchy, as we will detail below.</p>
<p>In the task (see <bold><xref ref-type="fig" rid="pcbi.1006972.g003">Fig 3A</xref></bold>), participants observed long sequences of two stimuli (A and B), the occurrence of which was governed by two transition probabilities which subjects had to learn: p(A<sub>t</sub>|A<sub>t-1</sub>) and p(B<sub>t</sub>|B<sub>t-1</sub>). The value of each probability was independent, but at unpredictable moments (<italic>change points</italic>) both simultaneously changed. Subjects were informed about this generative process in advance. They passively observed the stimuli and were asked to report both their estimate of the transition probability leading to the next stimulus, and their confidence in this estimate.</p>
<fig id="pcbi.1006972.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006972.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Behavioral task: Learning of dynamic transition probabilities with confidence reports.</title>
<p><bold>(A)</bold> Probability learning task. Human subjects (N = 23) were presented with random sequences of two stimuli, A and B. The stimuli were, in distinct blocks, either auditory or visual and they were perceived without ambiguity. At each trial, one of either stimulus was sampled according to a probability that depended on the identity of the previous stimulus: p(A<sub>t</sub>|A<sub>t-1</sub>) and P(B<sub>t</sub>|B<sub>t-1</sub>). These transition probabilities underwent occasional, abrupt changes (change points). A change point could occur at any trial with a probability that was fixed throughout the experiment. Subjects were instructed about this generative process and had to continuously estimate the (changing) transition probabilities given the observations received. Occasionally (see black dots in A), we probed their inferences by asking them, first, to report the probability of the next stimulus (i.e. report their estimate of the relevant transition probability) and second, to rate their confidence in this probability estimate. <bold>(B, C)</bold> Subjects’ responses were compared to the optimal Bayesian inference for this task. Numeric values of confidence differ between subjects and models since they are on different scales (from 0 to 1 in the former, in log-precision unit in the latter). For illustration, the optimal values were binned, the dashed line (B) denotes the identity, the plain line (C) is a linear fit, and data points correspond to subjects’ mean ± s.e.m.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006972.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec006">
<title>Probability and confidence estimates closely follow the hierarchical model</title>
<p>Before testing for an internal hierarchical model, we first wanted to verify whether subjects had performed the task well, in the sense that their responses were consistent with the hierarchical, Bayes-optimal solution. As a benchmark, we used the optimal model for this task; this model was not fitted onto subjects’ data, but set so as to optimally solve the task by ‘inverting’ its hierarchical generative structure using Bayes’ rule (see <xref ref-type="sec" rid="sec015">methods</xref>). As displayed in <bold><xref ref-type="fig" rid="pcbi.1006972.g003">Fig 3B and 3C</xref></bold>, linear regressions show an agreement between participants’ probability estimates and optimal probability estimates (defined as the mean of the posterior; regressions are computed at the subject-level: β = 0.66±0.06 s.e.m., t<sub>22</sub> = 11.13, p = 1.7 10<sup>−10</sup>), and subjective confidence reports and optimal confidence (defined as the log precision of the posterior; β = 0.10±0.03 s.e.m., t<sub>22</sub> = 3.06, p = 0.0058); for further checks of robustness, see <bold>Supplementary Results 3 in <xref ref-type="supplementary-material" rid="pcbi.1006972.s005">S1 File</xref></bold>. In order to quantify the variance explained, we also computed the Pearson correlations corresponding to those regressions: ρ = 0.56±0.04 s.e.m. for probability estimates and ρ = 0.19±0.05 s.e.m. for confidence. Despite being somewhat noisier, confidence reports also showed many properties of optimal inference (see <bold>Supplementary Results 4 in <xref ref-type="supplementary-material" rid="pcbi.1006972.s005">S1 File</xref></bold>).</p>
<p>Since we propose that subjects’ confidence reports can convey useful information over and above their first-order estimates, the next thing we verified was that confidence reports indeed conveyed information that was not already conveyed implicitly by the first-order estimates. We tested this in our data by regressing out the (theoretically expected) covariance between subjects’ confidence reports and several metrics derived from first-order estimates (see <bold>Supplementary Results 4 in <xref ref-type="supplementary-material" rid="pcbi.1006972.s005">S1 File</xref></bold>); the residuals of this regression still co-varied with optimal confidence (β = 0.028±0.012, t<sub>22</sub> = 2.3, p = 0.029). This result was replicated by repeating the analysis on another dataset [<xref ref-type="bibr" rid="pcbi.1006972.ref008">8</xref>]: β = 0.023±0.010, t<sub>17</sub> = 2.2, p = 0.0436; and also in the control experiment detailed below: β = 0.015±0.006, t<sub>20</sub> = 2.3, p = 0.034. These results indicate that subjective confidence and probability reports are not redundant, and thus that confidence is worth investigating.</p>
<p>Having verified that confidence and probability reports closely followed estimates of an optimal hierarchical model, and that both metrics were not redundant, we then tested whether subjects’ reports, overall, could not be better explained by a different, computationally less sophisticated model: the flat model introduced above (<bold><xref ref-type="fig" rid="pcbi.1006972.g001">Fig 1</xref></bold>, also see <xref ref-type="sec" rid="sec015">Methods</xref> and <bold>Supplementary Results 1 in <xref ref-type="supplementary-material" rid="pcbi.1006972.s005">S1 File</xref></bold>), that approximates the full Bayesian model extremely well. Both models have the same number of free parameters, so model comparison (at least using standard comparison methods like BIC or AIC) boils down to comparing the goodness-of-fit. We first took the parameters that provide the best estimate of the true generative probabilities. The goodness-of-fit, assessed as mean square error (MSE) between subjects’ and models’ estimates, was better for the hierarchical model than for the flat model (paired difference of MSE, hierarchical minus flat: -0.0051±0.0014 s.e.m., t<sub>22</sub> = -3.7, p = 0.0013). Note that subjects’ estimates of volatility, a key task parameter here, usually deviate from the optimum and show a large variability [<xref ref-type="bibr" rid="pcbi.1006972.ref005">5</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref030">30</xref>], which could bias our conclusion. We therefore fitted the model parameters per subject, and we found that the difference in fit was even more significant (-0.0077±0.0019 s.e.m., t<sub>22</sub> = -3.97, p = 6.5 10<sup>−4</sup>). This result replicates a previous finding [<xref ref-type="bibr" rid="pcbi.1006972.ref024">24</xref>]. We then repeated the comparison for confidence levels. When model parameters were set to best estimate the true transition probabilities, the hierarchical model showed a trend toward a significantly lower MSE compared to the flat model (paired difference of MSE, hierarchical minus flat: -0.0017±0.0010 s.e.m., t<sub>22</sub> = -1.8, p = 0.084). When model parameters were fitted onto each subjects’ confidence reports, this difference was significant (-0.0027±0.0012 s.e.m., t<sub>22</sub> = -2.36, p = 0.028).</p>
<p>In sum, these results show that participants successfully performed the task and that the hierarchical model was quantitatively superior to the flat model in explaining subjects’ probability estimates and confidence ratings. This leaves us with the last and perhaps most important question: did subjects also show a <italic>qualitative signature</italic> that could only be explained by a hierarchical model?</p>
</sec>
<sec id="sec007">
<title>Subjective confidence reveals a hallmark of an internal hierarchical model</title>
<p>Identifying the qualitative signature proposed here was possible because our task involves two transition probabilities, P(A|A) and P(B|B), whose changes were <italic>coupled</italic>, occurring simultaneously. In this context, a flat learner only estimates the value of each transition probability, while a hierarchical model <italic>also</italic> estimates the probability of a <italic>global</italic> change point. Faced with a global change point, the hierarchical learner then reacts optimally and makes its prior knowledge more malleable by becoming uncertain about <italic>both</italic> P(A|A) and P(B|B). Importantly, using this mechanism, an internal hierarchical model should allow for generalization: if a change point is suspected after observing just one type of transition (e.g. AAAAAAA, when P(A|A) was estimated to be low) a hierarchical learner would <italic>also</italic> become uncertain about the other quantity, P(B|B), despite having acquired no direct evidence on this transition (<bold><xref ref-type="fig" rid="pcbi.1006972.g004">Fig 4A</xref></bold>). Critically, this form of indirect inference is unique to hierarchical models and thus offers a powerful test of hierarchical theories of learning.</p>
<fig id="pcbi.1006972.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006972.g004</object-id>
<label>Fig 4</label>
<caption>
<title>A qualitative signature of hierarchical learning in confidence reports.</title>
<p><bold>(A)</bold> Divergent predictions of hierarchical versus flat learning models. Two fragments of sequences are shown in which one stimulus (‘A’) is consecutively repeated 10 times. In the upper fragment, this streak of repetitions is highly unlikely (or ‘suspicious’) given the context, and may indicate that the underlying statistics changed. By contrast, in the lower fragment, the same streak is not unlikely, and does not suggest a change point. The heat maps show the posterior probability distribution of P(B|B), i.e. the probability of a repetition of the other stimulus (B), estimated by the hierarchical and flat models. In a hierarchical model, unlikely streaks arouse the suspicion of a global change in statistics, causing the model to become uncertain about its estimates of both transition probabilities, despite having acquired no direct evidence on P(B|B). In a flat model, by contrast, a suspicious streak of As will not similarly decrease the confidence in P(B|B), because a flat model does not track global change points. To test for this effect, pre/post questions (indicated by a star) were placed immediately before and after selected streaks, to obtain subjective estimates of the transition probability corresponding to the stimulus not observed during the streak. Streaks were categorized as suspicious if they aroused the suspicion of a change point from the hierarchical, Bayes-optimal viewpoint. Note that the flat model also shows a decrease in confidence, because it progressively forgets its estimates about P(B|B) during a streak of As, but, there is no difference between suspicious and non-suspicious streaks. <bold>(B)</bold> For the sequences presented to subjects, the change in confidence (post-streak minus pre-streak) was significantly modulated by streak type in the hierarchical model, but not in a flat model. <bold>(C)</bold> Subjects’ confidence showed an effect of streak type predicted by the optimal hierarchical model. As in Fig 4C, confidence values in subjects and models are on different scales. Error bars correspond to the inter-subject quartiles, distributions show subjects' data; significance levels correspond to paired t-test with p&lt;0.005 (**) and p&lt;<sup>10–12</sup> (***).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006972.g004" xlink:type="simple"/>
</fig>
<p>To test for this generalization effect, we focused on streaks of repetitions, and distinguished between streaks that seem unlikely in context and may signal a change point (<italic>suspicious streaks)</italic> and streaks that do not (<italic>non-suspicious streaks</italic>). Stimulus sequences were carefully selected to contain enough suspicious and non-suspicious streaks and to control for confounds such as streak duration (see <xref ref-type="sec" rid="sec015">Methods</xref>). Questions were inserted just before and after the streak, so that subjects reported their estimate of (and confidence in) the other, non-repeating transition (<bold><xref ref-type="fig" rid="pcbi.1006972.g004">Fig 4A</xref></bold>). Exact theoretical predictions for both models are found in <bold><xref ref-type="fig" rid="pcbi.1006972.g004">Fig 4B</xref></bold>. In the hierarchical model, confidence decreases strongly after suspicious, but much less after non-suspicious streaks. In the flat model, however, there is no such difference. Strikingly, subjective reports followed the hierarchical account (see <bold><xref ref-type="fig" rid="pcbi.1006972.g004">Fig 4C</xref>)</bold>: confidence decreased strongly after suspicious (-0.12±0.04 s.e.m, t<sub>22</sub> = -3.2, p = 0.004) but not after non-suspicious streaks (-0.02±0.03 s.e.m., t<sub>22</sub> = -0.7, p = 0.51), and this interaction was significant (paired difference, 0.10±0.03 s.e.m., t<sub>22</sub> = 3.7, p = 0.001).</p>
</sec>
<sec id="sec008">
<title>Various controls demonstrate the specificity of the effect on confidence</title>
<p>We now rule out a series of potential confounding explanations. First, one concern is that the analysis above uses models optimized to estimate the true transition probabilities of the task. However, our conclusions remain unaffected if we use models fitted onto each subject (<bold>panels C, E in <xref ref-type="supplementary-material" rid="pcbi.1006972.s003">S3 Fig</xref></bold>). Another concern is that our analyses assume subjects were tracking transition probabilities, while they may in fact have been tracking another (heuristic) quantity, perhaps using a flat model. Detailed analysis revealed that subjects did in fact track transition probabilities (see <bold>Supplementary Results 4 in <xref ref-type="supplementary-material" rid="pcbi.1006972.s005">S1 File</xref></bold>) and that no heuristic flat model could explain the selective decrease of confidence (<bold>panels B, D, F in <xref ref-type="supplementary-material" rid="pcbi.1006972.s003">S3 Fig</xref></bold>). Finally, we also considered models that were technically hierarchical but that erroneously assume that the two transition probabilities have independent (rather than identical) change points (see panel C in <bold><xref ref-type="supplementary-material" rid="pcbi.1006972.s002">S2 Fig</xref></bold>). These models did not show the critical effect of streak type (<bold>panels A, C, E in <xref ref-type="supplementary-material" rid="pcbi.1006972.s003">S3 Fig</xref></bold>), indicating that our test is diagnostic of the ability to transfer knowledge between dependent variables. This transfer is not afforded by all hierarchical models, but only those which entertain the correct, relevant dependencies.</p>
<p>One may also wonder whether the effect reported in <bold><xref ref-type="fig" rid="pcbi.1006972.g004">Fig 4</xref></bold> for confidence is also found in another variable. <bold><xref ref-type="supplementary-material" rid="pcbi.1006972.s004">S4 Fig</xref></bold> shows that probability estimates (the ones about which confidence is reported and shown in <bold><xref ref-type="fig" rid="pcbi.1006972.g004">Fig 4</xref></bold>) are not affected by streak types neither in subjects (paired difference between streak types, -0.01±- 0.02 s.e.m., t<sub>22</sub> = -0.5, p = 0.59) nor in the hierarchical model (-0.01±0.01 s.e.m., t<sub>22</sub> = -1.4, p = 0.17). A more subtle effect is that, when a change point is suspected, generalization should reset the estimate of the unobserved transition probability, which should thus get closer to the prior value 0.5. However, this effect is less straightforward, because the estimated transition probability may already be close to 0.5 before the streak. Indeed, even in the hierarchical, Bayes-optimal model, streak type had only a weak effect (paired difference, 0.02±0.01 sem, t<sub>22</sub> = 2.9, p = 0.008), compared to the effect on confidence (<bold><xref ref-type="fig" rid="pcbi.1006972.g004">Fig 4</xref>,</bold> t<sub>22</sub> = 11.7, p = 6.9 10<sup>−11</sup>). The expectedly weaker effect of streak type on the distance to the prior was not detected in participants (-0.0036 +/- 0.01 s.e.m., t<sub>22</sub> = -0.3, p = 0.76). We also tested reaction times since they often co-vary with confidence. Here, when the optimal confidence was lower, subjects took longer to respond to the prediction question (slope of reaction times vs. optimal confidence: -0.57±0.19 s.e.m., t<sub>22</sub> = -3.07, p = 0.005), but not to the confidence question (slope: 0.04±0.08 s.e.m., t<sub>22</sub> = 0.48, p = 0.64). However, this significant correlation is reducible to first-order estimates. We repeated the analysis previously reported for the subjects’ confidence but now with their reaction times: after regressing out several metrics derived from first-order estimates, the residuals of this regression no longer co-varied with optimal confidence (β = -0.103±0.124 s.e.m., t<sub>22</sub> = -0.8, p = 0.41); and standardized regression coefficients indeed differed between the two regressions (paired difference of standardized βs: -0.233±0.080 s.e.m., t<sub>22</sub> = -2.9, p = 0.008). In addition, there was no effect of streak type on (raw) reaction times both for the probability estimate and reports (paired difference between streak types, both p&gt;0.27).</p>
<p>A final alternative explanation for the effect shown in <bold><xref ref-type="fig" rid="pcbi.1006972.g004">Fig 4</xref> </bold>is that suspicious streaks were more surprising and that subjects may become <italic>generally uncertain</italic> after surprising events. In this case, the effect would not reflect hierarchical inference but simply general surprise. We therefore performed a control experiment, in a different group of subjects, in which both probabilities changed independently (<bold>Panel C in <xref ref-type="supplementary-material" rid="pcbi.1006972.s002">S2 Fig</xref></bold>): here, suspicious streaks were equally surprising but no longer signaled a <italic>global</italic> change point (<bold><xref ref-type="fig" rid="pcbi.1006972.g005">Fig 5A</xref></bold>). Indeed, generalization of a decrease in confidence was no longer observed for the hierarchical model with the correct task structure or in subjects (paired difference between suspicious and non-suspicious streaks: 0.03±0.02 s.e.m., t<sub>20</sub> = 1.5, p = 0.15), see <bold><xref ref-type="fig" rid="pcbi.1006972.g005">Fig 5B</xref></bold>. This absence of an effect in the control task is significantly different from the effect found in the main task (difference of paired differences, two-sample t-test, t<sub>42</sub> = -2.03, p = 0.048). This difference is not due poor performance in the control experiment (see <bold><xref ref-type="fig" rid="pcbi.1006972.g005">Fig 5C</xref></bold>): linear regression between the optimal hierarchical model for uncoupled change (the optimal model for this task) and subjects showed a tight agreement for both predictions (β = 0.61±0.06 s.e.m., t<sub>20</sub> = 10.27, p = 2 10<sup>−9</sup>) and confidence (β = 0.08±0.01 s.e.m., t<sub>20</sub> = 6.83, p = 1.2 10<sup>−6</sup>), as in the main task (see <bold><xref ref-type="fig" rid="pcbi.1006972.g003">Fig 3B and 3C</xref></bold>). The difference between the two tasks suggests an effect of higher-level factors (coupled vs. uncoupled change points) and thus further support the hierarchical model.</p>
<fig id="pcbi.1006972.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006972.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Control experiment: Subjects take into account the higher-order structure of the dynamics.</title>
<p>In the control experiment, change points were uncoupled between the two transition probabilities, thereby abolishing the possibility to infer a change in one transition probability by only observing the other transition type. <bold>(A)</bold> Theoretical predictions for changes in confidence around the target streaks. The optimal hierarchical model for the main task assumes that change points are coupled (“hierarchical model, coupled changes”), which is no longer optimal in the case of uncoupled change points. This model was nevertheless used to identify suspicious and non-suspicious streaks and indeed it showed an effect of streak type on the change in confidence here in the control task as in the main task (<xref ref-type="fig" rid="pcbi.1006972.g004">Fig 4C</xref>). The optimal hierarchical Bayesian model for this control experiment is similar to this first model, the only difference is that it assumes that change points are uncoupled (“hierarchical model, uncoupled changes”). As expected, this model correctly showed no effect of streak type on the change in confidence. The flat model, by definition, ignores change points and therefore whether they are coupled or uncoupled, as a result it shows no effect of streak type (as in the main experiment). <bold>(B)</bold> Subjects showed no difference between streak types, like the hierarchical model for uncoupled changes. The results of the main task are reproduced from <xref ref-type="fig" rid="pcbi.1006972.g004">Fig 4C</xref> to facilitate visual comparison. <bold>(C)</bold> Subjects overall perform well in the control task, showing a tight agreement with the optimal hierarchical model for uncoupled change (the optimal model for this task) for both predictions (left) and confidence (right). In panels A and B, the error bars correspond to the inter-subject quartiles, distributions show subjects' data. In panel C, data points are mean ± s.e.m across subjects. In all panels; significance levels correspond to p = 0.048 (*), p&lt;0.01 (**), p&lt;0.001(***) in a two-tailed t-test.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006972.g005" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec009" sec-type="conclusions">
<title>Discussion</title>
<p>We have shown that previously proposed hallmarks of hierarchical processing are insufficient to categorically distinguish hierarchical from non-hierarchical models of learning in uncertain and changing environments, and we introduced a novel test to dissociate the two. The key features of our experiment are that subjects estimate multiple statistics that depend on the same change points, and that we analyze subjects’ confidence about their estimates. Our test taps into a unique property of hierarchical models: the ability to generalize between different probabilities that are coupled by the higher-order structure of the task. This ensured that hierarchical and flat accounts make <italic>qualitatively different</italic> predictions at individual trials. Based on both qualitative and quantitative model comparison, our results provide clear evidence for a hierarchical account. As such, they extend previous work that relied solely on quantitative model comparison or that did not test for hierarchy explicitly, and support the hierarchical learning framework that in recent years became highly influential to study cognition in both health and disease [<xref ref-type="bibr" rid="pcbi.1006972.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref004">4</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1006972.ref012">12</xref>].</p>
<sec id="sec010">
<title>Is confidence necessary to reveal the learner’s computations?</title>
<p>Choices and first-order reports are often used in behavioral science, but other metrics like a subject’s confidence and reaction times also proved useful to study cognition, see [<xref ref-type="bibr" rid="pcbi.1006972.ref031">31</xref>]. A feature that distinguishes our task from previous work on adaptive learning is the use of explicit confidence ratings to dissociate between flat and hierarchical models. Since the flat models considered here are known to provide very accurate first-order approximations to hierarchical (optimal) models [<xref ref-type="bibr" rid="pcbi.1006972.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref015">15</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref032">32</xref>], we reasoned that second-order estimates might prove useful as an additional source of information. Our simulations showed that even when first-order metrics are nearly indistinguishable, confidence was much less correlated between models. Although this conclusion holds both in a standard task in which one non-stationary statistic is learned (<bold><xref ref-type="fig" rid="pcbi.1006972.g002">Fig 2</xref>)</bold> and in our more complex task (<bold><xref ref-type="supplementary-material" rid="pcbi.1006972.s001">S1 Fig</xref></bold>), we acknowledge that this does not guarantee that confidence is generally more diagnostic than first-order metrics. Rather, we take our experiment as an example case showing that second-order metrics can be worth studying in learning theory.</p>
<p>Importantly, while we believe confidence can be useful to discriminate hierarchical and flat models, we do not want to claim confidence is necessary (i.e. that it is impossible with other metrics). In particular, both the low correlations (<bold><xref ref-type="fig" rid="pcbi.1006972.g002">Fig 2</xref>)</bold> and the critical dissociation between models (<bold><xref ref-type="fig" rid="pcbi.1006972.g004">Fig 4</xref>)</bold> should in principle also be detectable using other, related metrics. Reaction times are one obvious candidate, as they are often an implicit measure of a subject’s confidence [<xref ref-type="bibr" rid="pcbi.1006972.ref033">33</xref>–<xref ref-type="bibr" rid="pcbi.1006972.ref036">36</xref>]. In our study, we found a correlation between reaction times and confidence, however, unlike for confidence reports, this correlation was reducible to first-order aspects such as the predictability of the next stimulus, and we found no effect of streak type that serves as our hallmark. Note that in our study, in contrast to accumulation [<xref ref-type="bibr" rid="pcbi.1006972.ref036">36</xref>] or waiting-time [<xref ref-type="bibr" rid="pcbi.1006972.ref035">35</xref>] paradigms, there is no general, principled reason for reaction times to co-vary with confidence. On the contrary, motor effects may even artifactually corrupt the relationship between confidence and reaction times since in our task reporting a more extreme estimate (typically associated with higher confidence) requires to move the response cursor further. This may explain why reaction times showed only a partial correlation with confidence and eventually did not show the hallmark of hierarchical inference.</p>
<p>Another interesting metric is the <italic>apparent learning rate</italic>. Previous studies reported modulations of the apparent learning rate by change points [<xref ref-type="bibr" rid="pcbi.1006972.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref005">5</xref>]. The optimal, hierarchical model indeed shows such modulations because its updates are confidence-weighted [<xref ref-type="bibr" rid="pcbi.1006972.ref004">4</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref024">24</xref>]: for a given prediction error, its updates are larger when confidence about prior estimates is lower, which is typically the case when a change point is suspected. However, we found that in simple experiments that require to monitor only the frequency of a stimulus or a reward, a flat model could exhibit similar modulations, which are therefore not diagnostic of hierarchical inference. In more complex experiments like the one here, the apparent learning rate could nevertheless show our signature of hierarchical inference. Theoretical analysis supports this hypothesis (see <bold>Supplementary Results 5 in <xref ref-type="supplementary-material" rid="pcbi.1006972.s005">S1 File</xref></bold>) but we cannot assess it in our data, since this requires a trial-by-trial measure of the apparent learning rate, and thus trial-by-trial (not occasional) reports of first-order estimates. A trial-by-trial, model-free measure of the apparent learning rate is neither accessible if subjects make choices at each trial. In such studies [<xref ref-type="bibr" rid="pcbi.1006972.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref037">37</xref>], the authors could only use choices to compute an apparent learning rate in a sliding window of trials but this analysis lacks trial-by-trial resolution. In our task, investigating the apparent learning rate would require subjects to report their probability estimates after each trial, and hence to constantly interrupt the stimulus stream. This would probably interfere with the participants’ ability to integrate consecutive observations, which is critical for tracking transition probabilities, and therefore seems difficult to implement in practice. Furthermore, if an effect of streak type were observed on the apparent learning rate, it would probably be mediated by the subject’s confidence [<xref ref-type="bibr" rid="pcbi.1006972.ref004">4</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref024">24</xref>], in that case one may prefer to probe confidence directly.</p>
<p>We acknowledge that there are drawbacks of using confidence as the metric of interest. Although our simulations suggested that in theory confidence might discriminate flat and hierarchical models more reliably, in practice we found that the model fit between participants and the hierarchical, Bayes-optimal model was more precise for probability estimates than for confidence ratings (see <bold>Figs <xref ref-type="fig" rid="pcbi.1006972.g003">3B</xref>, <xref ref-type="fig" rid="pcbi.1006972.g003">3C</xref></bold> and <bold><xref ref-type="fig" rid="pcbi.1006972.g005">5C</xref></bold>). This noisy character of confidence measurements was also reported previously [<xref ref-type="bibr" rid="pcbi.1006972.ref008">8</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref038">38</xref>–<xref ref-type="bibr" rid="pcbi.1006972.ref040">40</xref>] and may hinder the use of confidence as a metric to discriminate between models. This problem may be even worse when using an indirect indicator of confidence, such as reaction times.</p>
<p>We also acknowledge the possibility that asking subjects for explicit confidence reports about their inferences may have promoted the use of a sophisticated learning algorithm of a hierarchical nature. By contrast, simpler tasks in which subjects only make choices without being asked to reflect upon the reliability of their estimates, as we do here with confidence reports, could favor the use of simpler, possibly non-hierarchical learning algorithms. We cannot explore further this cautionary note in our current design because confidence reports are precisely key to detect the use of a hierarchical model here.</p>
</sec>
<sec id="sec011">
<title>Quantitative vs. qualitative model comparison and generality of the results</title>
<p>Quantitative model comparison is a widely used method for contrasting competing models. Following this approach, multiple models are fit onto the subjects’ data, and the model that achieves the best fit with respect to its complexity is deemed most likely [<xref ref-type="bibr" rid="pcbi.1006972.ref041">41</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref042">42</xref>]. This approach is attractive because it is generally applicable and it provides a common metric (e.g. goodness-of-fit, Bayes-Factor, exceedance probability) to compare different models. However, a limitation of quantitative model comparison is that it is not always clear what underlying factors are contributing to differences in fitness, and whether these factors are indeed most relevant to the question at hand. Moreover, quantitative model comparison only allows for relative conclusions, such as one model being <italic>better than other tested models</italic>, and is thus inherently restricted in scope to the models that are tested. Here, we used two models. The choice for the hierarchical model was straightforward: it is the optimal solution and therefore served as a benchmark. The choice for the flat model was motivated by both its resemblance to the classic, widely used delta rule with fixed learning rate [<xref ref-type="bibr" rid="pcbi.1006972.ref015">15</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref019">19</xref>], also see <bold>Supplementary Results 1 in <xref ref-type="supplementary-material" rid="pcbi.1006972.s005">S1 File</xref>;</bold> and because it is known to approximates the hierarchical model extremely well [<xref ref-type="bibr" rid="pcbi.1006972.ref003">3</xref>]. This renders it a worthy competitor, although not representative of all flat models.</p>
<p>A complementary approach is <italic>qualitative</italic> model comparison: analyzing specific, critical trials for the presence of <italic>qualitative signatures</italic> or <italic>hallmarks</italic> that uniquely identify or exclude one type of model. This approach is not only more transparent, but also enables more general conclusions, such as the <italic>falsification</italic> of one type of model [<xref ref-type="bibr" rid="pcbi.1006972.ref043">43</xref>]. Here, generality was granted by the fact that our test taps into a unique property of hierarchical models with an appropriate representation of the task structure. This argument derives from a priori principles, but we verified it by trying several parametrizations, priors and hypotheses of our models <bold>(<xref ref-type="supplementary-material" rid="pcbi.1006972.s002">S2 Fig</xref>),</bold> which supported that a model entertaining the correct dependencies can appropriately generalize. Importantly, we do not claim that the full Bayesian solution is the only model with this property. Other hierarchical models can be envisaged, such as two leaky accumulators (one per transition probability) coupled by a third mechanism that globally increases their leak whenever a change point is suspected in either accumulator.</p>
<p>Note that here, the quantitative and qualitative approaches were indeed complementary: quantitative model comparison provided evidence in favor of a hierarchical account, and the qualitative approach tested for unique hallmarks and thereby falsified a strictly flat account.</p>
<p>Last, we acknowledge that we falsify the flat account only in a strict sense: we rule out that humans <italic>only</italic> make use of a flat algorithm in our task. Our results cannot rule out the existence of flat learning algorithms in general. Several learning algorithms may co-exist and the brain may switch between strategies depending on context. Instead, the results show that humans are capable of hierarchical learning and that they use it even in a task that does not critically requires it, as shown by the near-optimal performance of the flat model. The human capacity of hierarchical learning is compatible with what others have suggested [<xref ref-type="bibr" rid="pcbi.1006972.ref004">4</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref006">6</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref021">21</xref>] and we provide a task for studying it.</p>
</sec>
<sec id="sec012">
<title>Implications for leaky integration and other implementations of adaptive learning</title>
<p>Our results falsify a strictly flat account of learning under uncertainty, therefore they also falsify the use of solely leaky integration by neural networks to solve adaptive learning tasks. Leaky integration is often deemed both biologically plausible and computationally efficient [<xref ref-type="bibr" rid="pcbi.1006972.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref037">37</xref>]. A sophisticated version of the leaky integration with metaplastic synapses allows partial modulation of the apparent learning of the network, without tracking change points or volatility [<xref ref-type="bibr" rid="pcbi.1006972.ref018">18</xref>]. Others have suggested that computational noise itself could enable a flat inference to automatically adapt to volatility [<xref ref-type="bibr" rid="pcbi.1006972.ref016">16</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref044">44</xref>]. Those approximate solutions dismiss the need to compute higher-level factors like volatility, they are thus appealing due to their simplicity; however, we believe that such solutions cannot explain the generalization afforded by hierarchical inference that we showed here. As such, at least for explicitly hierarchical tasks like the one studied here, such models have to be complemented to include higher-level factors.</p>
<p>One previously proposed bio-inspired model seems compatible with our result [<xref ref-type="bibr" rid="pcbi.1006972.ref006">6</xref>]. This model comprises two modules: one for learning and the other for detecting change points, or “unexpected surprise” [<xref ref-type="bibr" rid="pcbi.1006972.ref001">1</xref>]. When a change point is detected, a reset signal is sent to the learning module. Converging evidence indicates that noradrenaline could play such a role [<xref ref-type="bibr" rid="pcbi.1006972.ref045">45</xref>–<xref ref-type="bibr" rid="pcbi.1006972.ref048">48</xref>]. A global reset signal could promote learning for the two transition probabilities that are maintained in parallel in our task, thereby allowing the reset of both when only one arouses the suspicion of a change point. Such a hypothesis nevertheless needs to be refined in order to account for the fact that the two statistics can also be reset independently from one another, as in the control task.</p>
</sec>
<sec id="sec013">
<title>Learning and acting in a structured environment</title>
<p>Our task structure is more complex than many previous experiments which required to monitor only one generative statistic [<xref ref-type="bibr" rid="pcbi.1006972.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref005">5</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref027">27</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref049">49</xref>]. This may hamper translating our results to other experiments, but it has a certain ecological appeal since in real-life situations, multiple regularities are often embedded in a single context. We believe that more complex tasks are well-suited to distinguish complex computations and approximations thereof. Both are likely to be equivalent in simpler situations, whereas in highly structured environments with multiple interdependent levels [<xref ref-type="bibr" rid="pcbi.1006972.ref020">20</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref050">50</xref>], an effective learning algorithm can hardly obliviate the hierarchical nature of the problem to solve. Note that while we believe that hierarchically structured tasks are theoretically and practically <italic>better suited</italic> to test for hierarchical information processing, we do not claim that such tests are <italic>impossible</italic> in simpler tasks.</p>
<p>An interesting and difficult problem that we leave unaddressed here is how subjects may discover the task structure [<xref ref-type="bibr" rid="pcbi.1006972.ref020">20</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref051">51</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref052">52</xref>]. In our task, the optimal hierarchical model is able to correctly identify the current task structure (coupled vs. uncoupled change points), but only with moderate certainty even after observing the entire experiment presented to one subject (log-likelihood ratios range from 2 to 5 depending on subjects). Therefore, in principle, subjects who are not endowed with optimal computing power cannot identify reliably the correct structure from observations alone. We speculate that in real-life situations, some cues or priors inform subjects about the relevant dependencies in their environment; if true, then our experiment in which subjects were instructed about the correct task structure may have some ecological validity.</p>
<p>Interestingly, while the importance of hierarchical inference remains controversial in the learning literature [<xref ref-type="bibr" rid="pcbi.1006972.ref004">4</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref005">5</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref014">14</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1006972.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref026">26</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref027">27</xref>], it seems more clearly established in the domain of decision making and action planning [<xref ref-type="bibr" rid="pcbi.1006972.ref050">50</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref053">53</xref>–<xref ref-type="bibr" rid="pcbi.1006972.ref057">57</xref>]. For instance, it was suggested that the functional organization of cognitive control is nested: low level cues trigger particular actions, depending on a stimulus-response association which is itself selected depending on a particular context [<xref ref-type="bibr" rid="pcbi.1006972.ref058">58</xref>]. In this view, negative outcomes may indicate that the (higher-level) context has changed and thus that a new rule now applies. This inference even seems to be confidence-weighted in humans: the suspicion of a change in context is all the stronger that subjects were confident that their action should have yielded a positive outcome under the previous context [<xref ref-type="bibr" rid="pcbi.1006972.ref059">59</xref>]. Those two studies feature an important aspect of hierarchy: a succession of (higher-level) task contexts separated by change points governs the (lower-level) stimuli. Our task also leverages another feature of hierarchy: it allows generalization and transfer of knowledge. A rule learned in a particular context can be applied in other contexts, for instance see [<xref ref-type="bibr" rid="pcbi.1006972.ref060">60</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref061">61</xref>]. Our results go beyond mere transfer: they show that the brain can <italic>update</italic> a statistic in the absence of direct evidence thanks to higher-level dependencies.</p>
</sec>
<sec id="sec014">
<title>Conclusion</title>
<p>In sum, we showed that previously proposed hallmarks are insufficient to distinguish hierarchical from non-hierarchical models of learning under uncertainty, and provided a new way to test between the two. Our results provide support to the hierarchical framework. Moreover, our work demonstrates the importance of using more complex task structures to test for hierarchy explicitly, and the usefulness of confidence as a source of information in learning theory. We believe our test can be applied beyond human learning to animal and computational models like neural networks, for which it may not be clear whether they make inferences that are hierarchical or not. As such, our test will be of interest to experimentalists and theoreticians alike.</p>
</sec>
</sec>
<sec id="sec015" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec016">
<title>Participants</title>
<p>Participants were recruited by public advertisement. They gave a written informed consent prior to participating and received 20 euros for volunteering in the experiment. The study was approved by the local Ethics Committee (CPP n°08–021 Ile de France VII). 26 participants (17 females, mean age 23.8, s.e.m.: 0.49) performed the main task and 21 other participants performed the control task (11 females, mean age 23.0, s.e.m.: 0.59). We excluded participants who showed poor learning performance, which we quantified as the Pearson ρ coefficient between their probability estimates and the hierarchical, Bayes-optimal estimates. We used a threshold corresponding to 5% of the (lowest) values measured in this task (ρ&lt;0.18, from a total of 105 participants in this study and others) This excluded 3 subjects from the main task, and none from the control task. Including those subjects does not change our main conclusion: regression of subject vs. optimal probability (resp. confidence): p = 3.3 10<sup>–9</sup>, (resp. p = 0.007); quantitative model comparison, with values fitted onto subject’s probability estimates (resp. confidence reports) supports the hierarchical model: p = 0.0003 (res. p = 0.050); effect of streak type of pre-post change in confidence: p = 0.047.</p>
</sec>
<sec id="sec017">
<title>Main task</title>
<p>The task was run using Octave (Version 3.4.2) and PsychToolBox (Version 3.0.11). Each participant completed a total of 5 blocks: 1 training block and 4 experimental blocks (2 auditory, 2 visual). Auditory and visual blocks alternated, with the modality of the first block randomised across participants. In each block, we presented binary sequences of 380 stimuli (1520 total) denoted A and B, which were either visual symbols or sounds and were perceived without ambiguity.</p>
<p>Sequences were generated according to the same principles as in previous studies [<xref ref-type="bibr" rid="pcbi.1006972.ref008">8</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref024">24</xref>]. A and B were randomly drawn based on two hidden transition probabilities which subjects had to learn. These probabilities were stable only for a limited time. The length of stable periods was randomly sampled from a geometric distribution with average length of 75 stimuli, truncated at 300 stimuli to avoid overly long stable periods. Critically, and contrary to other studies [<xref ref-type="bibr" rid="pcbi.1006972.ref002">2</xref>] the volatility was thus fixed (at 1/75). Transition probabilities were sampled independently and uniformly between 0.1–0.9, with the constraint that, for at least one of the two probabilities, the change in odds ratio (p/1-p) between consecutive stable periods was at least fourfold, thus guaranteeing that the change was effective. Across sequences and subjects, the actually used generative values indeed covered the transition probability matrix 0.1–0.9 uniformly, without any correlation (Pearson ρ = −0.0009, p = 0.98). Occasionally, the sequence was interrupted and subjects had to estimate the probability that the next stimulus would be either an A or a B and report their confidence in that estimate. Questions were located quasi-randomly, semi-periodically once each 15 stimuli on average (100 in total). Of the 100 questions, 68 questions were randomly placed; the remaining 32 questions were intentionally located just before and after 16 selected streaks (8 suspicious, 8 non-suspicious) and functioned as pre/post-questions to evaluate the effect of these streaks (see <bold><xref ref-type="fig" rid="pcbi.1006972.g004">Fig 4</xref></bold>). For details on the definition and selection of suspicious/non-suspicious streaks, see below.</p>
<p>To familiarize participants with the task they were carefully instructed and performed one training block of 380 stimuli (or ~12 minutes). To make sure they were fully aware of the volatile nature of the generative process, participants had to report when they detected changes in the hidden regularities. In the experimental blocks, reporting change points was omitted, but participants knew the underlying generative process was the same.</p>
</sec>
<sec id="sec018">
<title>Control task</title>
<p>The control task was very similar to the main one, with only two differences. (1) When a change occurred, it impacted only one of the two transition probabilities (randomly chosen). (2) During the training block, when subjects were required to report when they detected change points, they also reported which of the two transition probabilities had changed.</p>
</sec>
<sec id="sec019">
<title>Selection of sequences</title>
<p>Each randomly generated sequence was evaluated computationally and carefully selected to ensure that each subject encountered enough target moments during which the models make qualitatively different predictions, and that all sequences were balanced in terms of potential confounds such as streak duration and location. To this end, 4 random sequences of 380 stimuli long (each corresponding to one block) were analyzed computationally with the hierarchical and flat learning models, yielding 4 simulated ‘blocks’. The sequences, and associated trial-by-trial transition probability estimates from both models, were concatenated to form a single experimental sequence (of 1520 stimuli). This experimental sequence was then submitted to several selection criteria. First, we assessed whether the sequence contained at least 8 suspicious and 8 non-suspicious ‘streaks’. Consecutive repetitions were defined as ‘streaks’ if they consisted of at least 7 or more stimuli, and started after the 15th stimulus of a block. Streaks were classified as ‘suspicious’ if they aroused the suspicion of a change in the hierarchical, Bayes optimal model. Computationally, this was defined via the confidence in the probability of the observed repetition decreasing on average during the streak. To ensure the effect would be observable, only sequences in which the suspicious streaks led to a sizeable decrease in theoretical confidence levels were selected.</p>
<p>To control for factors that may potentially confound decreases in confidence, only sequences in which the average duration of suspicious and non-suspicious streaks was approximately identical, and in which there was at least one streak of each type in each block, were selected. In addition, subjects were not informed about the distinction between suspicious and non-suspicious streaks or that between random questions and pre-post questions that targeted the critical moments before and after streaks. Interviews performed after the experiment ruled out that subjects understood the goal of the experiment, as no subject had noticed that a sizable fraction (~30%) of questions purposefully targeted streaks.</p>
</sec>
<sec id="sec020">
<title>Learning models</title>
<p>The models used in this study are implemented in a Matlab toolbox available on GitHub and described in a previous publication [<xref ref-type="bibr" rid="pcbi.1006972.ref032">32</xref>]. The model termed “hierarchical” and “flat” here correspond respectively to the hidden Markov model (HMM) and the leaky integrator model in the toolbox. Here, we summarize the essential aspects of those models.</p>
<p>The hierarchical and flat models (M) are both ideal observer models, in the sense that they both use Bayes rule to infer what the posterior distribution of the statistic they estimate, <italic>θ<sub>t</sub></italic>, should be, under a given set of assumptions. However, only for the hierarchical model, the set of assumptions actually corresponds to the generative process, rendering its estimates statistically optimal for the task. Nevertheless, both use Bayes rule to estimate the posterior distribution of <italic>θ</italic><sub><italic>t</italic></sub>, based on a prior on this statistic and the likelihood provided by previous observations, <italic>y</italic><sub><italic>1</italic>:<italic>t</italic></sub> (here, a sequence of As and Bs):
<disp-formula id="pcbi.1006972.e001">
<alternatives>
<graphic id="pcbi.1006972.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006972.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(Eq 1)</label>
</disp-formula></p>
<p>Subscripts denote the observation number within a sequence. In the main text, the models estimate the transition probabilities between successive stimuli, so that θ is a vector with two elements: θ = [p(A|A), p(B|B)]. Note that those two probabilities suffice to describe all transitions, since the others can be derived as p(B|A) = 1-p(A|A) and p(A|B) = 1-p(B|B). In <bold><xref ref-type="supplementary-material" rid="pcbi.1006972.s003">S3 Fig</xref></bold>, we also consider variants in which the model estimates another statistic, the frequency of stimuli: θ = p(A). Note that p(B) is simply 1-p(A).</p>
<p>The estimation of θ depends on the assumption of the ideal observer model (M). The flat model considers that θ is fixed, and evaluates its value based on a leaky count of observations. The internal representation of this model therefore has only one level: θ, the statistic of observations. When the true generative statistic is in fact changing over time, the leakiness of the model enables it to constantly adapt its estimate of the statistic and therefore to cope with changes. If the leakiness is tuned to the rate of change, the estimate can approach optimality (see <bold>panel A in <xref ref-type="supplementary-material" rid="pcbi.1006972.s001">S1 Fig</xref></bold>).</p>
<p>By contrast, the hierarchical model entertains the assumption that θ can abruptly change at any moment. The internal representation of the model therefore has several levels beyond observations: a level characterizing the statistic of observations at a given moment (θ<sub>t</sub>) and a level describing the probability that of a change in θ occurs (p<sub>c</sub>). Conceivably, there could be higher-order levels describing changes in p<sub>c</sub> itself [<xref ref-type="bibr" rid="pcbi.1006972.ref002">2</xref>]; however this sophistication is unnecessary here and we consider that p<sub>c</sub> is fixed.</p>
<sec id="sec021">
<title>Flat model</title>
<p>The flat model assumes that the true value of θ is fixed, and it constantly infers its value given the evidence received. Therefore, the likelihood function can be decomposed as follows:
<disp-formula id="pcbi.1006972.e002">
<alternatives>
<graphic id="pcbi.1006972.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006972.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mtext>|</mml:mtext><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext>|</mml:mtext><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:munderover><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mtext>|</mml:mtext><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(Eq 2)</label>
</disp-formula>
Where <italic>N</italic><sub>A|A</sub>(t) denotes the number of AA pairs in the sequence <italic>y</italic><sub>1:t</sub>. A convenient parametrization for the prior distribution is the beta distribution: p(θ) = Beta(θ<sub>A|A</sub> | N<sup>prior</sup><sub>A|A</sub>, N<sup>prior</sup><sub>B|B</sub>). This parametrization allows for an intuitive interpretation of N<sup>prior</sup><sub>A|A</sub> and N<sup>prior</sup><sub>B|B</sub> as prior observation counts, and due to its conjugacy with the likelihood function (Eq2), inserting Eq2 into Eq1 yields that the posterior probability of θ is the product of two beta functions:
<disp-formula id="pcbi.1006972.e003">
<alternatives>
<graphic id="pcbi.1006972.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006972.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mtext>|</mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(Eq 3)</label>
</disp-formula></p>
<p>We consider here that the count of observations (the number of AA, AB, BA and BB pairs) is leaky, so that observations that are further in the past have a lower weight than recent ones. We modeled this leakiness as an exponential decay ω, such that the k-th past stimulus has a weight e<sup>-k/ω</sup>:
<disp-formula id="pcbi.1006972.e004">
<alternatives>
<graphic id="pcbi.1006972.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006972.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>/</mml:mo><mml:mi>ω</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow>
</mml:math>
</alternatives>
<label>(Eq 4)</label>
</disp-formula></p>
<p>Where X and Y can be A or B, and δ<sub>i,j</sub> is 1 if i = j and 0 otherwise. Note that a perfect integration, in which all observations are given the same weight, corresponds to the special case of ω being infinitely large. Also note that ω*ln(2) corresponds to the “half-life”, i.e. the number of observations after which the weight of a past observation is reduced by half.</p>
<p>In the main text (but <bold><xref ref-type="fig" rid="pcbi.1006972.g001">Fig 1</xref></bold>), we choose [N<sup>prior</sup><sub>A|A</sub>, N<sup>prior</sup><sub>B|B</sub>] = [0 0], for in this case, the mean estimate of the flat model becomes strictly equivalent to the estimate of a “delta rule” as the number of observations increases (see <bold>Supplementary Result 1 in <xref ref-type="supplementary-material" rid="pcbi.1006972.s005">S1 File</xref></bold>). An alternative choice for the prior is the so-called Laplace-Bayes prior [1 1], which is uninformative in that it gives the same prior probability to any value of θ [<xref ref-type="bibr" rid="pcbi.1006972.ref041">41</xref>]. This choice is important for <bold><xref ref-type="fig" rid="pcbi.1006972.g001">Fig 1</xref></bold>, but not for the results in the main text (see <bold><xref ref-type="supplementary-material" rid="pcbi.1006972.s003">S3 Fig</xref></bold>).</p>
</sec>
<sec id="sec022">
<title>Hierarchical model</title>
<p>The hierarchical model evaluates the current value of the generative statistic θ under the assumption that it may change at any new observation with a fixed probability p<sub>c</sub>. Note that, would the location of the change points be known, the inference of θ would be simple: one would simply need to count the number of pairs (<italic>N</italic><sub>A|A</sub>, <italic>N</italic><sub>B|B</sub>, <italic>N</italic><sub>A|B</sub>, <italic>N</italic><sub>B|A</sub>) since the last change point and apply <xref ref-type="disp-formula" rid="pcbi.1006972.e002">Eq 2</xref>. However, without knowing the location of change points, one should in principle average the estimates given all possible locations of change points, which is in practice far too large a number. The computation is rendered tractable by the so-called Markov property of the generative process. If one knows θ at time <italic>t</italic>, then the next observation <italic>y</italic><sub><italic>t</italic>+1</sub> is generated with θ<sub><italic>t</italic>+1</sub> = θ<sub><italic>t</italic></sub> if no change occurred and with another value drawn from the prior distribution otherwise. Therefore, if one knows θ<sub><italic>t</italic></sub>, previous observations are not needed to estimate θ<sub><italic>t</italic>+1</sub>. Casting the generative process as a Hidden Markov Model (HMM) enables to compute the joint distribution of θ and observations iteratively, starting from the prior, and updating this distribution by moving forward in the sequence of observations:
<disp-formula id="pcbi.1006972.e005">
<alternatives>
<graphic id="pcbi.1006972.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006972.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∫</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>∫</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(Eq 5)</label>
</disp-formula></p>
<p>This integral can be computed numerically by discretization on a grid. The posterior probability can be obtained by normalizing this joint distribution.</p>
<p><bold>Probability reports and confidence ratings with the models.</bold></p>
<p>Both the flat and hierarchical models estimate a full posterior distribution for θ, therefore both models have a posterior uncertainty (or conversely, confidence) about their estimate. In that sense, the flat model can be considered as a delta rule that is extended to provide confidence estimates about first-order estimates (see <bold>Supplementary Results 1 in <xref ref-type="supplementary-material" rid="pcbi.1006972.s005">S1 File</xref></bold> for more details about the flat model and delta rule).</p>
<p>The probability of the next stimulus (question #1 asked to subjects) was computed from the posterior using Bayes rule:
<disp-formula id="pcbi.1006972.e006">
<alternatives>
<graphic id="pcbi.1006972.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006972.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow>
</mml:math>
</alternatives>
<label>(Eq 6)</label>
</disp-formula></p>
<p>Note that the first term in the integral, the likelihood, is nothing but the relevant transition probability itself (conditioned on the actual previous observation). This integral is therefore simply the mean of the posterior distribution of the relevant transition probability. The confidence in the reported probability estimate (question #2) was computed as the log-precision of this posterior distribution [<xref ref-type="bibr" rid="pcbi.1006972.ref008">8</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref024">24</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref029">29</xref>,<xref ref-type="bibr" rid="pcbi.1006972.ref062">62</xref>–<xref ref-type="bibr" rid="pcbi.1006972.ref064">64</xref>].</p>
</sec></sec>
<sec id="sec023">
<title>Model fit</title>
<p>The flat and the hierarchical models have one free parameter each, respectively ω (the leakiness) and p<sub>c</sub> (the prior probability of change point).</p>
<p>Unless stated otherwise, the analysis reported in the main text used the parameters that best fit the true probabilities used to generate the sequences of observations presented to subjects. More precisely, for each sequence of observations, we computed the probability of each new observation given the previous ones, as estimated by the models using <xref ref-type="disp-formula" rid="pcbi.1006972.e005">Eq 5</xref> and we compared it to the true generative probability. We adjusted the free parameters ω and p<sub>c</sub> with grid-search to minimize the sum of squared errors (SSE) over all the sequences used for all subjects. The resulting values are ω = 20.3 and p<sub>c</sub> = 0.014 (indeed close to the generative value 1/75).</p>
<p>We also fitted the parameters to the responses of each subject (<bold><xref ref-type="supplementary-material" rid="pcbi.1006972.s003">S3 Fig</xref></bold>). For probability estimates, the above grid-search procedure was repeated after replacing generative values with the subject’s estimates of probabilities at the moment of questions. For confidence reports, we used a similar procedure; note however that subjects used a bounded qualitative slider to report confidence whereas the model confidence is numeric and unbounded, so that there is not a direct mapping between the two. Therefore, the SSE was computed with the residuals of a linear regression between subject’s confidence and the model’s confidence. Here are the fitted values we obtained, reported as median (25–75 percentile): for the hierarchical model p<sub>c</sub> = 0.0360 (0.0043–0.3728) when fitted onto probability estimates and p<sub>c</sub> = 0.0134 (0.0006–0.0526) when fitted onto confidence reports: for the flat model, ω = 34.4 (25.9–100.5) and ω = 20.8 (8.2–50.2), respectively.</p>
</sec>
<sec id="sec024">
<title>Statistical analyses</title>
<p>All linear regressions between dependent variables (e.g. probability estimates, confidence ratings) and explanatory variables (optimal estimates of probabilities and confidence, surprise, prediction error, entropy) included a constant and were estimated at the subject level. The significance of regression coefficients was estimated at the group level with t-tests. For multiple regressions, explanatory variables were z-scored so that regression coefficients can be compared between the variables of a given regression. Unless stated otherwise, all t-tests are two-tailed.</p>
</sec>
</sec>
<sec id="sec025">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006972.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006972.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Correlation between the hierarchical and flat models is higher for probability estimates and than for confidence levels in our task.</title>
<p>Panels <bold>A</bold> and <bold>B</bold> show the result of a simulation that is identical to <bold><xref ref-type="fig" rid="pcbi.1006972.g002">Fig 2</xref></bold>, except that here we simulated our task (see <bold><xref ref-type="fig" rid="pcbi.1006972.g003">Fig 3A</xref></bold>). The correlations indicate that probability estimates are nearly indistinguishable between the two models, whereas their confidence levels are more different. Note that the volatility level (0.013) and step size (4) used in the experiment are among the best values to discriminate between models on the basis of confidence. Those simulations used prior [1 1] for the flat model, but the results are qualitatively similar with prior [0 0] (see <xref ref-type="sec" rid="sec015">Methods</xref>). (<bold>C</bold>) The heatmap shows the histogram of confidence levels of the hierarchical and flat models in our task, i.e. for the sequences actually presented to subjects. Confidence levels appear relatively correlated (ρ = 0.58, consistent with panel <bold>B</bold>) but nevertheless dissociable. Our analysis targeted a particular class of diagnostic trials: red dots show the confidence levels on the trials corresponding the questions inserted after suspicious streaks, in which there is indeed no correlation between the two models (ρ = -0.12).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006972.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006972.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Comparison of different hierarchical task structures.</title>
<p>In all panels, arrows indicate the conditional dependencies across hierarchical levels (plain lines) and time (dashed lines). The hierarchy comprises several levels: the binary observation y (level 1, bottom), the generative statistics of observations θ (level 2) and sudden changes C in those statistics (level 3) whose rate of occurrence depends on a volatility context (level 4, top). (A) Task by Behrens et al 2007: observations are governed by their frequency θ<sub>A</sub>. In this experiment, there are two volatility contexts (high, null) whereas volatility is fixed in our case. (B) Our main task, depicted in <bold><xref ref-type="fig" rid="pcbi.1006972.g003">Fig 3A</xref></bold>: observations are governed by transition probabilities between successive observations, θ<sub>A|B</sub> and θ<sub>B|A</sub> which share the same change points. (C) In our control task, observations are also governed by transition probabilities, but their change points are independent.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006972.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006972.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Theoretical predictions for various alternative models in the main task.</title>
<p>Simulated changes in confidence around the target streaks in the main task. We consider three ideal observer models: the hierarchical model, the flat model with prior [0 0] and with prior [1 1]. Those models tracked either the transition probabilities between successive stimuli (<bold>A</bold>, <bold>C</bold>, <bold>E</bold>) or the frequency of stimuli (<bold>B</bold>, <bold>D</bold>, <bold>F</bold>). In the case of transition probabilities, we further distinguish between hierarchical models that assume that changes are coupled (i.e. identical, <bold>S3 Fig</bold>) or uncoupled (i.e. independent, <bold><xref ref-type="supplementary-material" rid="pcbi.1006972.s002">S2C Fig</xref></bold>) between the two transition probabilities. The free parameters of the models (the prior probability of change point p<sub>c</sub> in the hierarchical model; the leak factor ω in the flat model) were fitted following three procedures: so as to provide the best estimation of the actual generative probabilities of the sequences at all trials (<bold>A</bold>, <bold>B</bold>) or the answers of subjects at the moment of all questions regarding probability estimates (<bold>C</bold>, <bold>D</bold>) or their confidence ratings (<bold>E</bold>, <bold>F</bold>). Panels <bold>A</bold> and <bold>B</bold> therefore show the results of models that were optimized to solve the probability estimation task. By contrast, panels <bold>C</bold>, <bold>D</bold>, <bold>E</bold>, <bold>F</bold>, show the results of models that were optimized to be as close as possible to subjects, which can in principle deviate from <bold>A</bold> and <bold>B</bold>.</p>
<p>Note that panel <bold>A</bold> corresponds to <bold><xref ref-type="fig" rid="pcbi.1006972.g004">Fig 4B</xref></bold>, expanded with two new models. None of the flat models in all plots shows an effect of streak type; some even predict increase (not decrease) in confidence (<bold>B</bold>, <bold>D</bold>, <bold>F</bold>). By contrast, a hierarchical model learning the stimulus frequency (<bold>B</bold>, <bold>D</bold>, <bold>F</bold>) seems more compatible with the subjects’ data: they indeed predict an effect of streak type. One could therefore wonder whether subjects actually monitor the item frequency, instead of transition probabilities in the task. Several pieces of evidence argue against this possibility (see <bold>Supplementary Results 4</bold>). In addition, this possibility is incompatible with the results of the control experiment (<bold><xref ref-type="fig" rid="pcbi.1006972.g005">Fig 5B</xref></bold>): a model that estimates a single statistic, namely the item frequency and the associated confidence, shows the same effect of streak type no matter whether change points are coupled between transition probabilities (main experiment) or uncoupled (control experiment). Last, note that a hierarchical model learning the transition probabilities shows an effect of streak type only if it assumes that change points are coupled (<bold>A</bold>, <bold>C</bold>, <bold>D</bold>).</p>
<p>Data points are mean ± s.e.m of model predictions for each subject; significance levels correspond to p&lt;0.05 (*), p&lt;0.01 (**), p&lt;0.001(***) in paired t-test, except for comparisons involving the flat model with prior [0 0] in <bold>F</bold> for which we used a Wilcoxon sign rank test because of an outlier point (see large error bar).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006972.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006972.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Probability estimates show no effect of streak type.</title>
<p>This figure is analogous to <bold><xref ref-type="fig" rid="pcbi.1006972.g004">Fig 4B and 4C</xref></bold>, except that it shows probability estimates reported at the moment of the pre/post streak questions, rather than the associated confidence levels. The error bars correspond to the inter-subject quartiles, distributions show subjects' data; the significance level ‘ns’ corresponds to paired t-tests with p&gt;0.15.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006972.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006972.s005" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>Supplementary results.</title>
<p>This file presents the result of supplementary analyses.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006972.s006" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006972.s006" xlink:type="simple">
<label>S2 File</label>
<caption>
<title>Full dataset.</title>
<p>We provide the raw data as a Matlab data file. This data file can be read with Matlab, or a freely available software such as GNU Octave or Python. The file contains three cell variables: one for the subjects included in the main task, one for the subjects excluded from the main task, and one for the subjects (all included) in the control task. Each element of a cell corresponds to one subject, and the data are presented as a matrix. Each row is a trial, and the columns should be read as follows:</p>
<p>1. Sensory modality (“1”for visual, “0” for auditory)</p>
<p>2. Block number (1 to 4)</p>
<p>3. Observed binary sequence, coded as “1” and “2”</p>
<p>4. Generative probability of observing “1” when the previous stimulus is “2”</p>
<p>5. Generative probability of observing “2” when the previous stimulus is “1”</p>
<p>6. Subjects estimate of the probability of receiving “1” on the next trial, from 0 to 1 (with NaN when no question is asked)</p>
<p>7. Subject's confidence about the estimated probability, from 0 to 1 (with NaN when no question is asked)</p>
<p>8. Reaction times (s) for the probability report (with NaN when no question is asked).</p>
<p>Reaction time (s) for the confidence report (with NaN when no question is asked).</p>
<p>(MAT)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006972.s007" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006972.s007" xlink:type="simple">
<label>S3 File</label>
<caption>
<title>Code demo.</title>
<p>This zipped folder contains Matlab code files showing how to compute the ideal observer models used in this article.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We wish to thank Stefano Palminteri, Maxime Maheu, Peter Latham and Alexandre Pouget for useful comments on this work, and Bas Cornelissen for his help with figures.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006972.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yu</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>. <article-title>Uncertainty, neuromodulation, and attention</article-title>. <source>Neuron</source>. <year>2005</year>;<volume>46</volume>: <fpage>681</fpage>–<lpage>692</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2005.04.026" xlink:type="simple">10.1016/j.neuron.2005.04.026</ext-link></comment> <object-id pub-id-type="pmid">15944135</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Behrens</surname> <given-names>TEJ</given-names></name>, <name name-style="western"><surname>Woolrich</surname> <given-names>MW</given-names></name>, <name name-style="western"><surname>Walton</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Rushworth</surname> <given-names>MFS</given-names></name>. <article-title>Learning the value of information in an uncertain world</article-title>. <source>Nat Neurosci</source>. <year>2007</year>;<volume>10</volume>: <fpage>1214</fpage>–<lpage>1221</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1954" xlink:type="simple">10.1038/nn1954</ext-link></comment> <object-id pub-id-type="pmid">17676057</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yu</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>JD</given-names></name>. <article-title>Sequential effects: Superstition or rational behavior?</article-title> <source>Adv Neural Inf Process Syst</source>. <year>2008</year>;<volume>21</volume>: <fpage>1873</fpage>–<lpage>1880</lpage>. <object-id pub-id-type="pmid">26412953</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mathys</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Stephan</surname> <given-names>KE</given-names></name>. <article-title>A bayesian foundation for individual learning under uncertainty</article-title>. <source>Front Hum Neurosci</source>. <year>2011</year>;<volume>5</volume>: <fpage>39</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fnhum.2011.00039" xlink:type="simple">10.3389/fnhum.2011.00039</ext-link></comment> <object-id pub-id-type="pmid">21629826</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nassar</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Heasly</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gold</surname> <given-names>JI</given-names></name>. <article-title>An Approximately Bayesian Delta-Rule Model Explains the Dynamics of Belief Updating in a Changing Environment</article-title>. <source>J Neurosci</source>. <year>2010</year>;<volume>30</volume>: <fpage>12366</fpage>–<lpage>12378</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.0822-10.2010" xlink:type="simple">10.1523/JNEUROSCI.0822-10.2010</ext-link></comment> <object-id pub-id-type="pmid">20844132</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Iigaya</surname> <given-names>K</given-names></name>. <article-title>Adaptive learning and decision-making under uncertainty by metaplastic synapses guided by a surprise detection system</article-title>. <source>eLife</source>. <year>2016</year>;<volume>5</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.18073" xlink:type="simple">10.7554/eLife.18073</ext-link></comment> <object-id pub-id-type="pmid">27504806</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McGuire</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Nassar</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Gold</surname> <given-names>JI</given-names></name>, <name name-style="western"><surname>Kable</surname> <given-names>JW</given-names></name>. <article-title>Functionally Dissociable Influences on Learning Rate in a Dynamic Environment</article-title>. <source>Neuron</source>. <year>2014</year>;<volume>84</volume>: <fpage>870</fpage>–<lpage>881</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2014.10.013" xlink:type="simple">10.1016/j.neuron.2014.10.013</ext-link></comment> <object-id pub-id-type="pmid">25459409</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meyniel</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Schlunegger</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Dehaene</surname> <given-names>S</given-names></name>. <article-title>The Sense of Confidence during Probabilistic Learning: A Normative Account</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>: <fpage>e1004305</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004305" xlink:type="simple">10.1371/journal.pcbi.1004305</ext-link></comment> <object-id pub-id-type="pmid">26076466</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Payzan-LeNestour</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Bossaerts</surname> <given-names>P</given-names></name>. <article-title>Risk, Unexpected Uncertainty, and Estimation Uncertainty: Bayesian Learning in Unstable Settings</article-title>. <source>PLoS Comput Biol</source>. <year>2011</year>;<volume>7</volume>: <fpage>e1001048</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1001048" xlink:type="simple">10.1371/journal.pcbi.1001048</ext-link></comment> <object-id pub-id-type="pmid">21283774</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Iglesias</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mathys</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Brodersen</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Kasper</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Piccirelli</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>den Ouden</surname> <given-names>HEM</given-names></name>, <etal>et al</etal>. <article-title>Hierarchical prediction errors in midbrain and basal forebrain during sensory learning</article-title>. <source>Neuron</source>. <year>2013</year>;<volume>80</volume>: <fpage>519</fpage>–<lpage>530</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2013.09.009" xlink:type="simple">10.1016/j.neuron.2013.09.009</ext-link></comment> <object-id pub-id-type="pmid">24139048</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lawson</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Mathys</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rees</surname> <given-names>G</given-names></name>. <article-title>Adults with autism overestimate the volatility of the sensory environment</article-title>. <source>Nat Neurosci</source>. <year>2017</year>;<volume>20</volume>: <fpage>1293</fpage>–<lpage>1299</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.4615" xlink:type="simple">10.1038/nn.4615</ext-link></comment> <object-id pub-id-type="pmid">28758996</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Powers</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Mathys</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Corlett</surname> <given-names>PR</given-names></name>. <article-title>Pavlovian conditioning-induced hallucinations result from overweighting of perceptual priors</article-title>. <source>Science</source>. <year>2017</year>;<volume>357</volume>: <fpage>596</fpage>–<lpage>600</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.aan3458" xlink:type="simple">10.1126/science.aan3458</ext-link></comment> <object-id pub-id-type="pmid">28798131</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ritz</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Nassar</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Shenhav</surname> <given-names>A</given-names></name>. <article-title>A control theoretic model of adaptive behavior in dynamic environments</article-title>. <source>bioRxiv</source>. <year>2017</year>; <fpage>204271</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/204271" xlink:type="simple">10.1101/204271</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006972.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ryali</surname> <given-names>CK</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>AJ</given-names></name>. <article-title>Change-point detection without needing to detect change-points?</article-title> <source>bioRxiv</source>. <year>2016</year>; <fpage>077719</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/077719" xlink:type="simple">10.1101/077719</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006972.ref015"><label>15</label><mixed-citation publication-type="other" xlink:type="simple">Sutton R. Gain Adaptation Beats Least Squares? In Proceedings of the 7th Yale Workshop on Adaptive and Learning Systems. 1992. pp. 161–166.</mixed-citation></ref>
<ref id="pcbi.1006972.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wyart</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Koechlin</surname> <given-names>E</given-names></name>. <article-title>Choice variability and suboptimality in uncertain environments</article-title>. <source>Curr Opin Behav Sci</source>. <year>2016</year>;<volume>11</volume>: <fpage>109</fpage>–<lpage>115</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cobeha.2016.07.003" xlink:type="simple">10.1016/j.cobeha.2016.07.003</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006972.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bell</surname> <given-names>AH</given-names></name>, <name name-style="western"><surname>Summerfield</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Morin</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Malecek</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Ungerleider</surname> <given-names>LG</given-names></name>. <article-title>Encoding of Stimulus Probability in Macaque Inferior Temporal Cortex</article-title>. <source>Curr Biol</source>. <year>2016</year>;<volume>26</volume>: <fpage>2280</fpage>–<lpage>2290</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cub.2016.07.007" xlink:type="simple">10.1016/j.cub.2016.07.007</ext-link></comment> <object-id pub-id-type="pmid">27524483</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Farashahi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Donahue</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Khorsand</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Seo</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Soltani</surname> <given-names>A</given-names></name>. <article-title>Metaplasticity as a Neural Substrate for Adaptive Learning and Choice under Uncertainty</article-title>. <source>Neuron</source>. <year>2017</year>;<volume>94</volume>: <fpage>401</fpage>–<lpage>414</lpage>.e6. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2017.03.044" xlink:type="simple">10.1016/j.neuron.2017.03.044</ext-link></comment> <object-id pub-id-type="pmid">28426971</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref019"><label>19</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Rescorla Robert</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wagner Allan</surname> <given-names>R</given-names></name>. <chapter-title>A theory of Pavlovian conditioning: Variations in the effectiveness of reinforcement and nonreinforcement</chapter-title>. In: <name name-style="western"><surname>Black</surname> <given-names>AH.</given-names></name>, &amp;, <name name-style="western"><surname>Prokasy</surname> <given-names>W.F.</given-names></name> WF, <name name-style="western"><surname>Back</surname> <given-names>AH</given-names></name>, editors. <source>Classical conditioning II: Current research and theory</source>. <publisher-loc>New York</publisher-loc> <publisher-name>Appleton-Century Crofts</publisher-name>; <year>1972</year>. pp. <fpage>64</fpage>–<lpage>99</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006972.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tenenbaum</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Kemp</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Griffiths</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Goodman</surname> <given-names>ND</given-names></name>. <article-title>How to grow a mind: statistics, structure, and abstraction</article-title>. <source>Science</source>. <year>2011</year>;<volume>331</volume>: <fpage>1279</fpage>–<lpage>1285</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1192788" xlink:type="simple">10.1126/science.1192788</ext-link></comment> <object-id pub-id-type="pmid">21393536</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>. <article-title>Hierarchical models in the brain</article-title>. <source>PLoS Comput Biol</source>. <year>2008</year>;<volume>4</volume>: <fpage>e1000211</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1000211" xlink:type="simple">10.1371/journal.pcbi.1000211</ext-link></comment> <object-id pub-id-type="pmid">18989391</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname> <given-names>TS</given-names></name>, <name name-style="western"><surname>Mumford</surname> <given-names>D</given-names></name>. <article-title>Hierarchical Bayesian inference in the visual cortex</article-title>. <source>J Opt Soc Am A Opt Image Sci Vis</source>. <year>2003</year>;<volume>20</volume>: <fpage>1434</fpage>–<lpage>1448</lpage>. <object-id pub-id-type="pmid">12868647</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Khorsand</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Soltani</surname> <given-names>A</given-names></name>. <article-title>Optimal structure of metaplasticity for adaptive learning</article-title>. <source>PLoS Comput Biol</source>. <year>2017</year>;<volume>13</volume>: <fpage>e1005630</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005630" xlink:type="simple">10.1371/journal.pcbi.1005630</ext-link></comment> <object-id pub-id-type="pmid">28658247</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meyniel</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Dehaene</surname> <given-names>S</given-names></name>. <article-title>Brain networks for confidence weighting and hierarchical inference during probabilistic learning</article-title>. <source>Proc Natl Acad Sci</source>. <year>2017</year>; <fpage>201615773</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1615773114" xlink:type="simple">10.1073/pnas.1615773114</ext-link></comment> <object-id pub-id-type="pmid">28439014</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vinckier</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Gaillard</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Palminteri</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rigoux</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Salvador</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Fornito</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Confidence and psychosis: a neuro-computational account of contingency learning disruption by NMDA blockade</article-title>. <source>Mol Psychiatry</source>. <year>2016</year>;<volume>21</volume>: <fpage>946</fpage>–<lpage>955</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/mp.2015.73" xlink:type="simple">10.1038/mp.2015.73</ext-link></comment> <object-id pub-id-type="pmid">26055423</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Summerfield</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Behrens</surname> <given-names>TE</given-names></name>, <name name-style="western"><surname>Koechlin</surname> <given-names>E</given-names></name>. <article-title>Perceptual Classification in a Rapidly Changing Environment</article-title>. <source>Neuron</source>. <year>2011</year>;<volume>71</volume>: <fpage>725</fpage>–<lpage>736</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2011.06.022" xlink:type="simple">10.1016/j.neuron.2011.06.022</ext-link></comment> <object-id pub-id-type="pmid">21867887</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gallistel</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Krishan</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Latham</surname> <given-names>PE</given-names></name>. <article-title>The perception of probability</article-title>. <source>Psychol Rev</source>. <year>2014</year>;<volume>121</volume>: <fpage>96</fpage>–<lpage>123</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1037/a0035232" xlink:type="simple">10.1037/a0035232</ext-link></comment> <object-id pub-id-type="pmid">24490790</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jang</surname> <given-names>AI</given-names></name>, <name name-style="western"><surname>Costa</surname> <given-names>VD</given-names></name>, <name name-style="western"><surname>Rudebeck</surname> <given-names>PH</given-names></name>, <name name-style="western"><surname>Chudasama</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Averbeck</surname> <given-names>BB</given-names></name>. <article-title>The Role of Frontal Cortical and Medial-Temporal Lobe Brain Areas in Learning a Bayesian Prior Belief on Reversals</article-title>. <source>J Neurosci Off J Soc Neurosci</source>. <year>2015</year>;<volume>35</volume>: <fpage>11751</fpage>–<lpage>11760</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.1594-15.2015" xlink:type="simple">10.1523/JNEUROSCI.1594-15.2015</ext-link></comment> <object-id pub-id-type="pmid">26290251</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meyniel</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Sigman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mainen</surname> <given-names>ZF</given-names></name>. <article-title>Confidence as Bayesian Probability: From Neural Origins to Behavior</article-title>. <source>Neuron</source>. <year>2015</year>;<volume>88</volume>: <fpage>78</fpage>–<lpage>92</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2015.09.039" xlink:type="simple">10.1016/j.neuron.2015.09.039</ext-link></comment> <object-id pub-id-type="pmid">26447574</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref030"><label>30</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Zhang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>AJ</given-names></name>. <chapter-title>Forgetful Bayes and myopic planning: Human learning and decision-making in a bandit setting</chapter-title>. In: <name name-style="western"><surname>Burges</surname> <given-names>CJC</given-names></name>, <name name-style="western"><surname>Bottou</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Welling</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ghahramani</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Weinberger</surname> <given-names>KQ</given-names></name>, editors. <source>Advances in Neural Information Processing Systems 26</source>. <publisher-name>Curran Associates, Inc</publisher-name>.; <year>2013</year>. pp. <fpage>2607</fpage>–<lpage>2615</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://papers.nips.cc/paper/5180-forgetful-bayes-and-myopic-planning-human-learning-and-decision-making-in-a-bandit-setting.pdf" xlink:type="simple">http://papers.nips.cc/paper/5180-forgetful-bayes-and-myopic-planning-human-learning-and-decision-making-in-a-bandit-setting.pdf</ext-link></mixed-citation></ref>
<ref id="pcbi.1006972.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shadlen</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Kiani</surname> <given-names>R</given-names></name>. <article-title>Decision Making as a Window on Cognition</article-title>. <source>Neuron</source>. <year>2013</year>;<volume>80</volume>: <fpage>791</fpage>–<lpage>806</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2013.10.047" xlink:type="simple">10.1016/j.neuron.2013.10.047</ext-link></comment> <object-id pub-id-type="pmid">24183028</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meyniel</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Maheu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dehaene</surname> <given-names>S</given-names></name>. <article-title>Human Inferences about Sequences: A Minimal Transition Probability Model</article-title>. <source>PLoS Comput Biol</source>. <year>2016</year>;<volume>12</volume>: <fpage>e1005260</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005260" xlink:type="simple">10.1371/journal.pcbi.1005260</ext-link></comment> <object-id pub-id-type="pmid">28030543</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dotan</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Meyniel</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Dehaene</surname> <given-names>S</given-names></name>. <article-title>On-line confidence monitoring during decision making</article-title>. <source>Cognition</source>. <year>2017</year>;<volume>171</volume>: <fpage>112</fpage>–<lpage>121</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cognition.2017.11.001" xlink:type="simple">10.1016/j.cognition.2017.11.001</ext-link></comment> <object-id pub-id-type="pmid">29128659</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kepecs</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mainen</surname> <given-names>ZF</given-names></name>. <article-title>A computational framework for the study of confidence in humans and animals</article-title>. <source>Philos Trans R Soc B Biol Sci</source>. <year>2012</year>;<volume>367</volume>: <fpage>1322</fpage>–<lpage>1337</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.2012.0037" xlink:type="simple">10.1098/rstb.2012.0037</ext-link></comment> <object-id pub-id-type="pmid">22492750</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kepecs</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Uchida</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Zariwala</surname> <given-names>HA</given-names></name>, <name name-style="western"><surname>Mainen</surname> <given-names>ZF</given-names></name>. <article-title>Neural correlates, computation and behavioural impact of decision confidence</article-title>. <source>Nature</source>. <year>2008</year>;<volume>455</volume>: <fpage>227</fpage>–<lpage>231</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature07200" xlink:type="simple">10.1038/nature07200</ext-link></comment> <object-id pub-id-type="pmid">18690210</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kiani</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Corthell</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Shadlen</surname> <given-names>MN</given-names></name>. <article-title>Choice Certainty Is Informed by Both Evidence and Decision Time</article-title>. <source>Neuron</source>. <year>2014</year>;<volume>84</volume>: <fpage>1329</fpage>–<lpage>1342</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2014.12.015" xlink:type="simple">10.1016/j.neuron.2014.12.015</ext-link></comment> <object-id pub-id-type="pmid">25521381</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Glaze</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Kable</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Gold</surname> <given-names>JI</given-names></name>. <article-title>Normative evidence accumulation in unpredictable environments</article-title>. <source>eLife</source>. <year>2015</year>;<volume>4</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.08825" xlink:type="simple">10.7554/eLife.08825</ext-link></comment> <object-id pub-id-type="pmid">26322383</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Baranski</surname> <given-names>JV</given-names></name>, <name name-style="western"><surname>Petrusic</surname> <given-names>WM</given-names></name>. <article-title>The calibration and resolution of confidence in perceptual judgments</article-title>. <source>Percept Psychophys</source>. <year>1994</year>;<volume>55</volume>: <fpage>412</fpage>–<lpage>428</lpage>. <object-id pub-id-type="pmid">8036121</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maniscalco</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Lau</surname> <given-names>H</given-names></name>. <article-title>A signal detection theoretic approach for estimating metacognitive sensitivity from confidence ratings</article-title>. <source>Conscious Cogn</source>. <year>2012</year>;<volume>21</volume>: <fpage>422</fpage>–<lpage>430</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.concog.2011.09.021" xlink:type="simple">10.1016/j.concog.2011.09.021</ext-link></comment> <object-id pub-id-type="pmid">22071269</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zylberberg</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Barttfeld</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Sigman</surname> <given-names>M</given-names></name>. <article-title>The construction of confidence in a perceptual decision</article-title>. <source>Front Integr Neurosci</source>. <year>2012</year>;<volume>6</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fnint.2012.00079" xlink:type="simple">10.3389/fnint.2012.00079</ext-link></comment> <object-id pub-id-type="pmid">23049504</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref041"><label>41</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Carlin</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Stern</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Dunson</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Vehtari</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>. <source>Bayesian Data Analysis</source>, <edition>Third Edition</edition>. <publisher-name>CRC Press</publisher-name>; <year>2013</year>.</mixed-citation></ref>
<ref id="pcbi.1006972.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stephan</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Penny</surname> <given-names>WD</given-names></name>, <name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Moran</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>. <article-title>Bayesian model selection for group studies</article-title>. <source>NeuroImage</source>. <year>2009</year>;<volume>46</volume>: <fpage>1004</fpage>–<lpage>1017</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2009.03.025" xlink:type="simple">10.1016/j.neuroimage.2009.03.025</ext-link></comment> <object-id pub-id-type="pmid">19306932</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Palminteri</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wyart</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Koechlin</surname> <given-names>E</given-names></name>. <article-title>The Importance of Falsification in Computational Cognitive Modeling</article-title>. <source>Trends Cogn Sci</source>. <year>2017</year>;<volume>21</volume>: <fpage>425</fpage>–<lpage>433</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tics.2017.03.011" xlink:type="simple">10.1016/j.tics.2017.03.011</ext-link></comment> <object-id pub-id-type="pmid">28476348</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Findling</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Skvortsova</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Dromnelle</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Palminteri</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wyart</surname> <given-names>V</given-names></name>. <article-title>Computational noise in reward-guided learning drives behavioral variability in volatile environments</article-title>. <source>bioRxiv</source>. <year>2018</year>; <fpage>439885</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/439885" xlink:type="simple">10.1101/439885</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006972.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bouret</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sara</surname> <given-names>SJ</given-names></name>. <article-title>Network reset: a simplified overarching theory of locus coeruleus noradrenaline function</article-title>. <source>Trends Neurosci</source>. <year>2005</year>;<volume>28</volume>: <fpage>574</fpage>–<lpage>582</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tins.2005.09.002" xlink:type="simple">10.1016/j.tins.2005.09.002</ext-link></comment> <object-id pub-id-type="pmid">16165227</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nieuwenhuis</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Aston-Jones</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>JD</given-names></name>. <article-title>Decision making, the P3, and the locus coeruleus—norepinephrine system</article-title>. <source>Psychol Bull</source>. <year>2005</year>;<volume>131</volume>: <fpage>510</fpage>–<lpage>532</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1037/0033-2909.131.4.510" xlink:type="simple">10.1037/0033-2909.131.4.510</ext-link></comment> <object-id pub-id-type="pmid">16060800</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Salgado</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Treviño</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Atzori</surname> <given-names>M</given-names></name>. <article-title>Layer- and area-specific actions of norepinephrine on cortical synaptic transmission</article-title>. <source>Brain Res</source>. <year>2016</year>;<volume>1641</volume>: <fpage>163</fpage>–<lpage>176</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.brainres.2016.01.033" xlink:type="simple">10.1016/j.brainres.2016.01.033</ext-link></comment> <object-id pub-id-type="pmid">26820639</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schomaker</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Meeter</surname> <given-names>M</given-names></name>. <article-title>Short- and long-lasting consequences of novelty, deviance and surprise on brain and cognition</article-title>. <source>Neurosci Biobehav Rev</source>. <year>2015</year>;<volume>55</volume>: <fpage>268</fpage>–<lpage>279</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neubiorev.2015.05.002" xlink:type="simple">10.1016/j.neubiorev.2015.05.002</ext-link></comment> <object-id pub-id-type="pmid">25976634</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kheifets</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gallistel</surname> <given-names>CR</given-names></name>. <article-title>Mice take calculated risks</article-title>. <source>Proc Natl Acad Sci</source>. <year>2012</year>;<volume>109</volume>: <fpage>8776</fpage>–<lpage>8779</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1205131109" xlink:type="simple">10.1073/pnas.1205131109</ext-link></comment> <object-id pub-id-type="pmid">22592792</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schapiro</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Rogers</surname> <given-names>TT</given-names></name>, <name name-style="western"><surname>Cordova</surname> <given-names>NI</given-names></name>, <name name-style="western"><surname>Turk-Browne</surname> <given-names>NB</given-names></name>, <name name-style="western"><surname>Botvinick</surname> <given-names>MM</given-names></name>. <article-title>Neural representations of events arise from temporal community structure</article-title>. <source>Nat Neurosci</source>. <year>2013</year>;<volume>16</volume>: <fpage>486</fpage>–<lpage>492</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3331" xlink:type="simple">10.1038/nn.3331</ext-link></comment> <object-id pub-id-type="pmid">23416451</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pouget</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Beck</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>WJ</given-names></name>, <name name-style="western"><surname>Latham</surname> <given-names>PE</given-names></name>. <article-title>Probabilistic brains: knowns and unknowns</article-title>. <source>Nat Neurosci</source>. <year>2013</year>;<volume>16</volume>: <fpage>1170</fpage>–<lpage>1178</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3495" xlink:type="simple">10.1038/nn.3495</ext-link></comment> <object-id pub-id-type="pmid">23955561</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tervo</surname> <given-names>DGR</given-names></name>, <name name-style="western"><surname>Tenenbaum</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>. <article-title>Toward the neural implementation of structure learning</article-title>. <source>Curr Opin Neurobiol</source>. <year>2016</year>;<volume>37</volume>: <fpage>99</fpage>–<lpage>105</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.conb.2016.01.014" xlink:type="simple">10.1016/j.conb.2016.01.014</ext-link></comment> <object-id pub-id-type="pmid">26874471</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Balaguer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Spiers</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hassabis</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Summerfield</surname> <given-names>C</given-names></name>. <article-title>Neural Mechanisms of Hierarchical Planning in a Virtual Subway Network</article-title>. <source>Neuron</source>. <year>2016</year>;<volume>90</volume>: <fpage>893</fpage>–<lpage>903</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2016.03.037" xlink:type="simple">10.1016/j.neuron.2016.03.037</ext-link></comment> <object-id pub-id-type="pmid">27196978</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Seymour</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <article-title>Model-Based Influences on Humans’ Choices and Striatal Prediction Errors</article-title>. <source>Neuron</source>. <year>2011</year>;<volume>69</volume>: <fpage>1204</fpage>–<lpage>1215</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2011.02.027" xlink:type="simple">10.1016/j.neuron.2011.02.027</ext-link></comment> <object-id pub-id-type="pmid">21435563</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huys</surname> <given-names>QJM</given-names></name>, <name name-style="western"><surname>Eshel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>O’Nions</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sheridan</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Roiser</surname> <given-names>JP</given-names></name>. <article-title>Bonsai Trees in Your Head: How the Pavlovian System Sculpts Goal-Directed Choices by Pruning Decision Trees</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>: <fpage>e1002410</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002410" xlink:type="simple">10.1371/journal.pcbi.1002410</ext-link></comment> <object-id pub-id-type="pmid">22412360</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Keramati</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Smittenaar</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>. <article-title>Adaptive integration of habits into depth-limited planning defines a habitual-goal-directed spectrum</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2016</year>; <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1609094113" xlink:type="simple">10.1073/pnas.1609094113</ext-link></comment> <object-id pub-id-type="pmid">27791110</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref057"><label>57</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wunderlich</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <article-title>Mapping value based planning and extensively trained choice in the human brain</article-title>. <source>Nat Neurosci</source>. <year>2012</year>;<volume>15</volume>: <fpage>786</fpage>–<lpage>791</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3068" xlink:type="simple">10.1038/nn.3068</ext-link></comment> <object-id pub-id-type="pmid">22406551</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref058"><label>58</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koechlin</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Ody</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kouneiher</surname> <given-names>F</given-names></name>. <article-title>The Architecture of Cognitive Control in the Human Prefrontal Cortex</article-title>. <source>Science</source>. <year>2003</year>;<volume>302</volume>: <fpage>1181</fpage>–<lpage>1185</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1088545" xlink:type="simple">10.1126/science.1088545</ext-link></comment> <object-id pub-id-type="pmid">14615530</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref059"><label>59</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Purcell</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>Kiani</surname> <given-names>R</given-names></name>. <article-title>Hierarchical decision processes that operate over distinct timescales underlie choice and changes in strategy</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2016</year>;<volume>113</volume>: <fpage>E4531</fpage>–<lpage>4540</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1524685113" xlink:type="simple">10.1073/pnas.1524685113</ext-link></comment> <object-id pub-id-type="pmid">27432960</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref060"><label>60</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Collins</surname> <given-names>AGE</given-names></name>, <name name-style="western"><surname>Cavanagh</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>MJ</given-names></name>. <article-title>Human EEG Uncovers Latent Generalizable Rule Structure during Learning</article-title>. <source>J Neurosci</source>. <year>2014</year>;<volume>34</volume>: <fpage>4677</fpage>–<lpage>4685</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.3900-13.2014" xlink:type="simple">10.1523/JNEUROSCI.3900-13.2014</ext-link></comment> <object-id pub-id-type="pmid">24672013</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref061"><label>61</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Collins</surname> <given-names>AGE</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>MJ</given-names></name>. <article-title>Neural signature of hierarchically structured expectations predicts clustering and transfer of rule sets in reinforcement learning</article-title>. <source>Cognition</source>. <year>2016</year>;<volume>152</volume>: <fpage>160</fpage>–<lpage>169</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cognition.2016.04.002" xlink:type="simple">10.1016/j.cognition.2016.04.002</ext-link></comment> <object-id pub-id-type="pmid">27082659</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref062"><label>62</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Boldt</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Blundell</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Martino</surname> <given-names>BD</given-names></name>. <article-title>Confidence modulates exploration and exploitation in value-based learning</article-title>. <source>bioRxiv</source>. <year>2017</year>; <fpage>236026</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/236026" xlink:type="simple">10.1101/236026</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1006972.ref063"><label>63</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Navajas</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hindocha</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Foda</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Keramati</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Latham</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Bahrami</surname> <given-names>B</given-names></name>. <article-title>The idiosyncratic nature of confidence</article-title>. <source>Nat Hum Behav</source>. <year>2017</year>;<volume>1</volume>: <fpage>810</fpage>–<lpage>818</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41562-017-0215-1" xlink:type="simple">10.1038/s41562-017-0215-1</ext-link></comment> <object-id pub-id-type="pmid">29152591</object-id></mixed-citation></ref>
<ref id="pcbi.1006972.ref064"><label>64</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yeung</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Summerfield</surname> <given-names>C</given-names></name>. <article-title>Metacognition in human decision-making: confidence and error monitoring</article-title>. <source>Philos Trans R Soc B Biol Sci</source>. <year>2012</year>;<volume>367</volume>: <fpage>1310</fpage>–<lpage>1321</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.2011.0416" xlink:type="simple">10.1098/rstb.2011.0416</ext-link></comment> <object-id pub-id-type="pmid">22492749</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>