<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-01144</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003546</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Biotechnology</subject><subj-group><subject>Bioengineering</subject><subj-group><subject>Biomedical engineering</subject></subj-group></subj-group></subj-group><subj-group><subject>Computational biology</subject></subj-group><subj-group><subject>Systems biology</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Computer and information sciences</subject><subj-group><subject>Network analysis</subject><subj-group><subject>Signaling networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Engineering and technology</subject></subj-group></article-categories>
<title-group>
<article-title>Multiple Model-Informed Open-Loop Control of Uncertain Intracellular Signaling Dynamics</article-title>
<alt-title alt-title-type="running-head">Multiple-Model Control of Intracellular Signaling</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Perley</surname><given-names>Jeffrey P.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Mikolajczak</surname><given-names>Judith</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Harrison</surname><given-names>Marietta L.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Buzzard</surname><given-names>Gregery T.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Rundell</surname><given-names>Ann E.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Weldon School of Biomedical Engineering, Purdue University, West Lafayette, Indiana, United States of America</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Department of Medicinal Chemistry &amp; Molecular Pharmacology, Purdue University, West Lafayette, Indiana, United States of America</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Department of Mathematics, Purdue University, West Lafayette, Indiana, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Sarkar</surname><given-names>Casim A.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Minnesota, United States of America</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">rundell@purdue.edu</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: JPP JM MLH GTB AER. Performed the experiments: JPP JM. Analyzed the data: JPP JM MLH GTB AER. Contributed reagents/materials/analysis tools: JPP JM MLH GTB AER. Wrote the paper: JPP GTB AER. Designed the computational control strategy: JPP GTB AER.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>4</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>10</day><month>4</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>4</issue>
<elocation-id>e1003546</elocation-id>
<history>
<date date-type="received"><day>27</day><month>6</month><year>2013</year></date>
<date date-type="accepted"><day>7</day><month>2</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Perley et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Computational approaches to tune the activation of intracellular signal transduction pathways both predictably and selectively will enable researchers to explore and interrogate cell biology with unprecedented precision. Techniques to control complex nonlinear systems typically involve the application of control theory to a descriptive mathematical model. For cellular processes, however, measurement assays tend to be too time consuming for real-time feedback control and models offer rough approximations of the biological reality, thus limiting their utility when considered in isolation. We overcome these problems by combining nonlinear model predictive control with a novel adaptive weighting algorithm that blends predictions from multiple models to derive a compromise open-loop control sequence. The proposed strategy uses weight maps to inform the controller of the tendency for models to differ in their ability to accurately reproduce the system dynamics under different experimental perturbations (i.e. control inputs). These maps, which characterize the changing model likelihoods over the admissible control input space, are constructed using preexisting experimental data and used to produce a model-based open-loop control framework. In effect, the proposed method designs a sequence of control inputs that force the signaling dynamics along a predefined temporal response without measurement feedback while mitigating the effects of model uncertainty. We demonstrate this technique on the well-known Erk/MAPK signaling pathway in T cells. <italic>In silico</italic> assessment demonstrates that this approach successfully reduces target tracking error by 52% or better when compared with single model-based controllers and non-adaptive multiple model-based controllers. <italic>In vitro</italic> implementation of the proposed approach in Jurkat cells confirms a 63% reduction in tracking error when compared with the best of the single-model controllers. This study provides an experimentally-corroborated control methodology that utilizes the knowledge encoded within multiple mathematical models of intracellular signaling to design control inputs that effectively direct cell behavior in open-loop.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Most cell behavior arises as a response to external forces. Signals from the extracellular environment are passed to the cell's nucleus through a complex network of interacting proteins. Perturbing these pathways can change the strength or outcome of the signals, which could be used to treat or prevent a pathological response. While manipulating these networks can be achieved using a variety of methods, the ability to do so predictably over time would provide an unprecedented level of control over cell behavior and could lead to new therapeutic design and research tools in medicine and systems biology. Hence, we propose a practical computational framework to aid in the design of experimental perturbations to force cell signaling dynamics to follow a predefined response. Our approach represents a novel merger of model-based control and information theory to blend the predictions from multiple mathematical models into a meaningful compromise solution. We verify through simulation and experimentation that this solution produces excellent agreement between the cell readouts and several predefined trajectories, even in the presence of significant modeling uncertainty and without measurement feedback. By combining elements of information and control theory, our approach will help advance the best practices in model-based control applications for medicine.</p>
</abstract>
<funding-group><funding-statement>This research was funded by a grant awarded by the National Science Foundation, # DMS-09002677 (URL: <ext-link ext-link-type="uri" xlink:href="http://www.nsf.gov" xlink:type="simple">www.nsf.gov</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="15"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>The ability to predictably manipulate intracellular signaling pathways would provide an unprecedented level of control of cellular processes and could potentially generate new approaches for therapeutic design and research tools in medicine and systems biology. Intracellular signaling networks are complex assemblies of interconnected molecular components that relay information and coordinate responses to environmental cues. For example, T lymphocytes are critical regulators of the immune response against the threats of invading pathogens and cancerous host cells. Their response to external stimuli is coordinated through several mediators including extracellular signal-regulated kinases (Erk), which are particularly noteworthy as they have been implicated in a number of autoimmune diseases and cancers <xref ref-type="bibr" rid="pcbi.1003546-Mariathasan1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1003546-Ricciardi1">[4]</xref>. Phenotypic change due to extracellular perturbation is a robust property of normal cell behavior and involves considerable feedback and crosstalk and is highly nonlinear. To help resolve the uncertainty and understand the complexity inherent within these signaling pathways, many researchers have developed mathematical models of signaling processes <xref ref-type="bibr" rid="pcbi.1003546-Zheng1">[5]</xref>–<xref ref-type="bibr" rid="pcbi.1003546-Saadatpour1">[10]</xref>. These models can be used to inform control strategies that try to predictably manipulate the intracellular signaling response, but also give rise to a new set of challenges in systems biology and control engineering.</p>
<p>To date, the majority of model-based control of cellular processes and systems has focused on biomass production in bioreactors <xref ref-type="bibr" rid="pcbi.1003546-Simon1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003546-Frahm1">[12]</xref> or were largely theoretical. Within the past decade, research has started to evaluate engineered control strategies for single and multiple cell signaling processes within experiments. Noble and Rundell <xref ref-type="bibr" rid="pcbi.1003546-Noble1">[13]</xref> used closed-loop (i.e. <italic>in silico</italic> feedback) control to direct HL60 cell differentiation through periodic boluses of a differentiation-inducing agent determined by nonlinear model predictive control (MPC). In 2012, they revised the initial approach to improve the transient response of the differentiating cells over 20 days by using a multi-scenario adaptive model predictive control <xref ref-type="bibr" rid="pcbi.1003546-Noble2">[14]</xref>. Uhlendorf <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1003546-Uhlendorf1">[15]</xref> applied open-loop (i.e. non-feedback) and closed-loop control to provide long-term regulation of gene expression on the single-cell and population level by manipulating the osmotic stress on cells in a microfluidic environment. The open-loop approach failed to regulate mean fluorescence to the desired set points in the laboratory. On the other hand, attempts using measurement feedback proved to be more successful at coping with modeling inaccuracies and inherent intracellular fluctuations. Opto-genetics and synthetic biology provide effective methods for control theory to interface with cellular processes at the genetic and signal transduction level. Milias-Argeitis <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1003546-MiliasArgeitis1">[16]</xref> attempted to control the activation of a light-responsive Phy/PIF module that altered the expression of a yellow florescent protein (YFP) activated through the Gal1 promoter in <italic>Saccharomyces</italic>. As in <xref ref-type="bibr" rid="pcbi.1003546-Uhlendorf1">[15]</xref>, the closed-loop approach proved more successful in driving YFP intensity to the desired set points in the laboratory. Tettcher <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1003546-Toettcher1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1003546-Toettcher2">[18]</xref> also used light as the control input to modulate the localization of PIF-tagged proteins to the cell membrane. This has the ability to alter intracellular signaling through coordination of the localization. Both of these studies achieve long-term regulation of cell activities through transcriptional control. Another closed-loop control study was proposed in Menolascina <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1003546-Menolascina1">[19]</xref> using pulse width modulation to specify the duration of pulses of galactose administered via microfluidics. Their experimental results confirm the predictive capabilities of their model for the synthetic gene network in <italic>S. Cerevisiae</italic>.</p>
<p>All of the aforementioned studies rely upon computer-based feedback control: a computer in the loop uses system measurements to inform control decisions. While closed-loop control is widely understood to be more robust to disturbance and uncertainty, in many cases the rapid dynamics, scale and complexity of intracellular signaling events and absence of real-time measurement assays prohibit its use. In these cases, any control strategy must design the control inputs in advance without measurements to inform future steps and rely solely upon prior information gleaned from existing experimental data. However, this may introduce unwanted degradation in control performance due to discrepancies between the actual system and the prediction model (i.e. plant-model mismatch). Methods to systematically and optimally combine this prior information with the predictive capacity of multiple mathematical models are needed.</p>
<p>Because mathematical models are abstractions of biological reality, they may differ in dominant species, network structure, parameter values, and functional representation. For most signaling pathways, limited preexisting quantitative data and qualitative observations are insufficient to discriminate unambiguously between the mathematical models. When applying control theory techniques, the experimental perturbations (i.e. control inputs) predicted to elicit a desired behavior from a system may be different for each model. Selecting the “best” of these models is an important challenge to control theorists for systems biology applications <xref ref-type="bibr" rid="pcbi.1003546-Sontag1">[20]</xref>. Apgar <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1003546-Apgar1">[21]</xref> applied control theory to discriminate among mechanism-based chemical kinetic models of epidermal growth factor receptor signaling. The method designs dynamic stimuli to delineate the system's response to subtle differences in the network topology. The model associated with the best controller is deemed the best representative of the original system. However, in using this model alone, we would implicitly assume that the model is also the most accurate in alternate operating regions, which may or may not be the case. Without performing the experiments there is no way to know <italic>a priori</italic> which model is best; furthermore, the best model may change depending upon the experiment planned. How to optimally combine information from these network models to design control inputs that, when applied to the cell, force the signaling dynamics along a desired path is the subject of much debate.</p>
<p>Growing attention in systems biology has been given to control methodologies considering multiple prediction models. Multiple models, or scenarios, have been previously used to improve robustness to parametric uncertainty in closed-loop model-based control <xref ref-type="bibr" rid="pcbi.1003546-Noble2">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1003546-Huang1">[22]</xref>–<xref ref-type="bibr" rid="pcbi.1003546-KuureKinsey1">[25]</xref>. The approach proposed by Rao <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1003546-Rao1">[24]</xref> computed control inputs by weighting multiple step-response models using a Bayesian algorithm to control hemodynamic variables in hypertensive subjects. These concepts were extended for disturbance rejection in a van de Vusse reactor using Bayesian methods to produce a weighted-average linear prediction model <xref ref-type="bibr" rid="pcbi.1003546-KuureKinsey1">[25]</xref>. The recursive weighting system was effective at eliminating the “hard switch” between controllers. Noble <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1003546-Noble2">[14]</xref> employed adaptive nonlinear MPC based on multiple data-consistent parameter characterizations to manipulate cell differentiation experimentally. Control inputs were chosen such that the average tracking error and resource efficiency were optimized, which resulted in superior controller performance over single-model MPC. However, this approach assumes all parameter scenarios are equally likely and does not consider that their accuracy in predicting actual system dynamics often varies between distinct regions of the state and control input spaces. Furthermore, the aforementioned approaches consider essentially single model structures with little to no variation in the mathematical equation structures. While methods considering model uncertainty explicitly are numerous, it is generally in the form of disturbances and process noise with very little consideration given to qualitatively distinct biological hypotheses. This is a critical flaw as these hypotheses could translate into qualitatively distinct equation structures and input/output and state/output relationships. Finally, all of these approaches employ real-time feedback that is not available for most intracellular signaling pathways because the dynamics are often too rapid for standard measurement assays.</p>
<p>In this paper, we present a practical open-loop control framework with a novel method for employing existing experimental data to confidently combine multiple model predictions to form effective control inputs. That is, an automated control input selection process is developed for the open-loop case; this process is advised by information regarding model accuracy in regions of the input space where potential control inputs are likely to be present. Akaike weights, based on an information-theoretic metric penalizing model complexity and lack-of-fitness used for model discrimination <xref ref-type="bibr" rid="pcbi.1003546-Burnham1">[26]</xref>, <xref ref-type="bibr" rid="pcbi.1003546-Dunlop1">[27]</xref>, are employed for this purpose. In the results, we successfully demonstrate the algorithm with several simulated test cases and corroborate a subset of these with <italic>in vitro</italic> experiments in Jurkat T lymphocytes. Conclusions and future work are presented in the discussion and detailed and illustrated descriptions of the algorithm and experimental protocols are provided in the <xref ref-type="sec" rid="s4">materials and methods</xref>.</p>
</sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Controlled System: T Cell Activation</title>
<p>The signaling pathway considered herein is the T cell receptor (TCR)-activated extracellular signal-regulated kinase (Erk, or MAPK) pathway (generalized in <xref ref-type="fig" rid="pcbi-1003546-g001">Figure 1</xref>). Activated Erk is an important condition in lymphocyte development and activation processes because it is a highly conserved and ubiquitous mechanism for transferring extracellular signals from membrane-bound receptors to the nuclear domain for gene regulation. The stimulation of TCRs by antigenic peptides (e.g. αCD3, shown in green in <xref ref-type="fig" rid="pcbi-1003546-g001">Figure 1</xref>) initiates a number of molecular reactions involved in signal transduction through Erk. During ligand binding, the TCR recruits and is phosphorylated by the tyrosine kinase Lck. A second tyrosine kinase, ZAP70, binds the tyrosine phosphorylated TCR subunits and is phosphorylated and activated by Lck. The receptor-kinase complex recruits and phosphorylates the adapter proteins LAT and Grb2 and phosphorylates and activates PLCγ leading to the formation of GTP-bound Ras. Activated Ras initiates the canonical Raf/Mek/Erk signaling cascade which results in T cells in the activation of the gene for interleukin-2.</p>
<fig id="pcbi-1003546-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003546.g001</object-id><label>Figure 1</label><caption>
<title>Generalized illustration of the TCR-mediated signaling pathway through the Erk-MAPK cascade.</title>
<p>Arrow- and diamond-heads denote activation and inhibition of substrate molecules, respectively. TCR stimulation is achieved through αCD3 (green) binding. Subsequent Erk activation (black) controlled using small molecule inhibitors sanguinarine (blue) and U0126 (red).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003546.g001" position="float" xlink:type="simple"/></fig></sec><sec id="s2b">
<title>Prediction Model Bank</title>
<p>Three mathematical models of the TCR-mediated signaling cascade are used for the basis of the prediction model bank <xref ref-type="bibr" rid="pcbi.1003546-Zheng1">[5]</xref>–<xref ref-type="bibr" rid="pcbi.1003546-Klamt1">[7]</xref>. The model proposed by Zheng <xref ref-type="bibr" rid="pcbi.1003546-Zheng1">[5]</xref> (herein referred to as Model <italic>Z</italic>) contains primarily first- and second-order mass action kinetics with 24 ODEs and 53 reaction parameters. The second model (herein referred to as Model <italic>L</italic>) is the deterministic version of the model proposed by Lipniacki <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1003546-Lipniacki1">[6]</xref>, which explicitly incorporates SHP-mediated negative feedback and Erk-mediated positive feedback. Model <italic>L</italic> consists of 32 reaction parameters and 37 ODEs derived from mass action kinetics. The original version of the third model, presented by Klamt <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1003546-Klamt1">[7]</xref>, uses Boolean logic to describe the main steps involved in the activation of CD4<sup>+</sup> helper T cells. <italic>CellNetAnalyzer</italic>, a Matlab software package <xref ref-type="bibr" rid="pcbi.1003546-Klamt1">[7]</xref> for structural and functional analysis of signaling networks, and the <italic>Odefy</italic> toolbox <xref ref-type="bibr" rid="pcbi.1003546-Krumsiek1">[28]</xref> were used to convert the logical model to a continuous homologue (herein referred to as Model <italic>K</italic>) with 40 states and 147 reaction parameters. Values for these reaction parameters were taken from Table 1 in <xref ref-type="bibr" rid="pcbi.1003546-Wittmann1">[29]</xref>. All prediction models were modified to contain control inputs that simulate the actions of sanguinarine and U0126. In addition, model outputs (i.e. total concentration of phosphorylated Erk) are normalized so that the peak uncontrolled response scaled to unity in order to account for the differences in scale (see Section 1 in <xref ref-type="supplementary-material" rid="pcbi.1003546.s002">Text S1</xref> for further details). All programming and simulation was performed in Matlab R2011b (7.13.0) and code is available in <xref ref-type="supplementary-material" rid="pcbi.1003546.s001">Dataset S1</xref>.</p>
<p>Herein, the computational burden of repeatedly evaluating large nonlinear ODE models is mitigated by using sparse grid interpolation. Sparse grids have been used as computational cost-cutting tools for control applications in systems biology <xref ref-type="bibr" rid="pcbi.1003546-Noble2">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1003546-Noble3">[30]</xref> by serving as surrogates for slow-evaluating models and objective functions to allow rapid screening of the design space.</p>
</sec><sec id="s2c">
<title>Open-Loop Multiple-Model Control with Adaptive Akaike Weights</title>
<p>In traditional model predictive control (MPC), also referred to as receding horizon control, the controller surveys the possible trajectories stemming from the current state and selects the control input sequence so that the predicted model outputs track the desired trajectories over a finite prediction horizon. The first control input of the selected sequence is used to update the prediction model state and the procedure is repeated as the prediction horizon slides along for the remaining time intervals. When based on a single model, the controller is at risk of degraded performance because of mismatch between the predicted and actual system behaviors. The proposed control strategy, illustrated in <xref ref-type="fig" rid="pcbi-1003546-g002">Figure 2</xref>, employs multiple prediction models to mitigate the effects of model uncertainty.</p>
<fig id="pcbi-1003546-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003546.g002</object-id><label>Figure 2</label><caption>
<title>A framework for multiple-model open-loop control of uncertain intracellular signaling in the laboratory.</title>
<p>First, the model bank is populated with a set of relevant models that predict the system response to possible control inputs. During the initial stage, training data are used to generate weights maps. These maps inform the controller of the tendency for models to differ in their ability to accurately reproduce the system dynamics under different control inputs. During each time interval of the controller stage, the performance metrics for the models are optimized simultaneously using a multiobjective technique within a MPC framework to generate a candidate solution set. The tasks involved in the adaptive model weighting strategy are contained within the gray box: control inputs are selected from the solution set by prioritizing them according to the weight maps, then model weights are automatically recalibrated using the portion of training data that most closely corresponds to the proposed control input. Optimization and input selection cycles repeat for subsequent time intervals as the prediction horizon slides along until the entire open-loop control sequence is specified and ready to be applied to the <italic>in vitro</italic> system.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003546.g002" position="float" xlink:type="simple"/></fig>
<p>In our approach, first, the model bank is populated with a set of relevant models, each of which predicts the system response to possible control inputs (in control theory terms this is referred to as the plant response). During the initial stage, training data and the corrected-Akaike Information Criterion (AICc) are used to generate weight maps for the prediction models. These weight maps give the relative probability that a given model is consistent with training data at any given point in the feasible input space. In essence, these maps inform the controller of the tendency for models to differ in their ability to accurately reproduce the system dynamics under different control inputs. We then use a model predictive control framework in which the performance metrics for the models are optimized simultaneously using a multiobjective technique. Optimal control inputs are selected from the resulting Pareto solution set by prioritizing the solutions according to the pre-computed weight maps. Model weights are automatically recalibrated using the portion of training data that most closely corresponds to the proposed control input. Optimization and input selection cycles repeat for subsequent time intervals as the prediction horizon slides along until the entire open-loop control sequence is specified and ready to be applied (see <xref ref-type="sec" rid="s4"><italic>Materials and Methods</italic></xref> for further details).</p>
</sec><sec id="s2d">
<title>Description of <italic>In Silico</italic> and <italic>In Vitro</italic> Case Studies</title>
<p>As discussed previously, the purpose of this manuscript is to present a computational strategy to aid in the design of experimental input regimens to elicit predictable dynamical behaviors from biological processes. Herein, we demonstrate our approach using the well-known TCR signaling pathway both through simulation and laboratory experiments. First, we explored two <italic>in silico</italic> case studies, each considering a pair of control reagents acting on different regions of the T cell signaling pathway, to demonstrate the functionality of the proposed control strategy. In both case studies, we performed a series of experiments in which one model was selected from the aforementioned set of three models to serve as the simulated system. This model was also used to design the optimal control input regimen as a controller based on this model would match the actual system exactly and represent the best possible scenario. The remaining two models were then used to form the basis of the control strategies we wished to compare: single-model control (mismatched model), multiple-model control with fixed equal weights, and our proposed multiple-model control with adaptive Akaike weights. For the <italic>in vitro</italic> case study, a subset of the control input regimens derived from the simulated case studies were tested on populations of Jurkat T cells for experimental corroboration.</p>
<p>In each of our case studies of the TCR signaling pathway, we desired the system readout (i.e. total concentration of phosphorylated Erk) to follow a series of predefined time course trajectories. These target trajectories were characterized by the equation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e001" xlink:type="simple"/></inline-formula>, where <italic>t</italic> = 0 refers to the time at which the initial stimulation dose of αCD3 is administered. The term <italic>p<sub>ss</sub></italic> represents the desired steady-state fraction of maximal activation that is to be achieved by the end of the 30-minute experiment. The term <italic>t<sub>off</sub></italic> represents the time in minutes, following an initial interval of maximal activation, at which the controller should begin driving the output to the desired steady-state fraction. The ten parameter pairs chosen for this study are (<italic>t<sub>off</sub></italic>, <italic>p<sub>ss</sub></italic>) = {(8,0), (15,0), (22,0), (8,0.25), (15,0.25), (22,0.25), (8,0.5), (15,0.5), (22,0.5), (30,1)}. The five possible input dosing times began at 3 min post-αCD3-stimulation and were spaced 5 min apart to accommodate both the rapid dynamics of TCR signaling and the limitations of experimental input dosing and measurement rates.</p>
<p>The control inputs used to perturb the TCR signaling pathway were chosen based on both the need to demonstrate the efficacy of our methodology and for experimental corroboration. For our simulated and experimental case studies, we chose two commercially-available reagents known to control the dynamics of phosphorylated Erk: sanguinarine and U0126. Sanguinarine (<xref ref-type="fig" rid="pcbi-1003546-g001">Figure 1</xref>) is a small-molecule inhibitor of Erk dual-specificity phosphatase-1 (MKP-1) and leads to elevated Erk phosphorylation <xref ref-type="bibr" rid="pcbi.1003546-Vogt1">[31]</xref>. U0126 (<xref ref-type="fig" rid="pcbi-1003546-g001">Figure 1</xref>) on the other hand is a Mek inhibitor with high selectivity, which effectively inhibits activation of Erk <xref ref-type="bibr" rid="pcbi.1003546-Favata1">[32]</xref>. To further evaluate controller performance using a variety of objectives, our second simulated case study replaces these reagents with two hypothetical reagents that modulate the function of phosphorylated ZAP70. The two reagents, aZAP and iZAP (<xref ref-type="fig" rid="pcbi-1003546-g001">Figure 1</xref>), act to promote and inhibit the function of pZAP70, respectively. Sanguinarine and U0126 concentrations were constrained to the intervals [0, 50] µM and [0, 10] µM, respectively, the upper limits of which were estimated from experimental results that indicate saturation effects at levels above the specified concentrations (see <xref ref-type="fig" rid="pcbi-1003546-g008">Figure 8</xref> in <xref ref-type="sec" rid="s4"><italic>Materials and Methods</italic></xref>). aZAP and iZAP were normalized to the interval [0, 1] as they are hypothetical. For details on our <italic>in silico</italic> implementation of all control reagents, readers are referred to Section 1 in <xref ref-type="supplementary-material" rid="pcbi.1003546.s002">Text S1</xref> and to the Matlab code provided in <xref ref-type="supplementary-material" rid="pcbi.1003546.s001">Dataset S1</xref>.</p>
</sec><sec id="s2e">
<title><italic>In Silico</italic> Experiments</title>
<p>The control strategy was first tested by considering combinations of two models at a time to control an unknown system, which is simulated by the remaining third model. In the following discussion, we will use <italic>S</italic> to denote single-model control with a subscript to denote the model (<italic>Z</italic>, <italic>L</italic>, or <italic>K</italic>) and <italic>M</italic> to denote multiple-model control with the subscript indicating either equal weights (<italic>eq</italic>) or adaptive weights (<italic>aw</italic>). For illustrative purposes, the case in which Model <italic>K</italic> was the simulated system and the target profile corresponded to full termination at 22 min (i.e. (<italic>t<sub>off</sub></italic>, <italic>p<sub>ss</sub></italic>) = (22, 0)) is described and illustrated in detail (results for all experiments are provided in Sections 3 and 4 in <xref ref-type="supplementary-material" rid="pcbi.1003546.s002">Text S1</xref>). <xref ref-type="fig" rid="pcbi-1003546-g003">Figure 3</xref> shows the control input dosing regimens for (A) the matched single-model controller <italic>S<sub>K</sub></italic>, (B–C) the two mismatched single-model controllers <italic>S<sub>Z</sub></italic> and <italic>S<sub>L</sub></italic>, (D–E) the multiple-model controller with fixed equal weights (<italic>M<sub>eq</sub></italic>) and with adaptive Akaike weights (<italic>M<sub>aw</sub></italic>), (F) the Akaike weights for <italic>M<sub>aw</sub></italic>, (G) the simulated system responses, and (H) the squared error values for all five control strategies.</p>
<fig id="pcbi-1003546-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003546.g003</object-id><label>Figure 3</label><caption>
<title>Simulations indicate adaptive weighting strategy significantly improves overall target tracking performance.</title>
<p>(<bold>A</bold>–<bold>E</bold>) Control input dosing regimens for the matched (<italic>S<sub>K</sub></italic>) and mismatched (<italic>S<sub>Z</sub></italic> and <italic>S<sub>L</sub></italic>) single-model controllers and the multiple-model controllers with fixed equal weights (<italic>M<sub>eq</sub></italic>) and with adaptive Akaike weights (<italic>M<sub>aw</sub></italic>). (<bold>F</bold>) Akaike weights for <italic>M<sub>aw</sub></italic>. (<bold>G</bold>) Target trajectory (solid black) and simulated system (Model <italic>K</italic>) responses controlled by <italic>S<sub>K</sub></italic> (dashed red), <italic>S<sub>Z</sub></italic> (dotted blue), <italic>S<sub>L</sub></italic> (dotted green), <italic>M<sub>eq</sub></italic> (dashed cyan) and <italic>M<sub>aw</sub></italic> (solid magenta). (<bold>H</bold>) The squared error values for all five controllers.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003546.g003" position="float" xlink:type="simple"/></fig>
<p>The ideal scenario was defined to be one in which the model used to derive the control inputs is the same as the model used to simulate the actual system response, although it is generally not feasible in the laboratory and thus considered only for the purpose of theoretical comparison. For this ideal scenario, the control input regimen necessary to track the target profile included negligible input quantities to maintain initial Erk activation, quickly followed by a large bolus of U0126 at 23 min to promote Erk dephosphorylation near the end of the experiment (<xref ref-type="fig" rid="pcbi-1003546-g003">Figure 3A</xref>). As shown in <xref ref-type="fig" rid="pcbi-1003546-g003">Figure 3</xref>, the single-model controllers specified qualitatively different control inputs profiles, each causing qualitatively different simulated system responses. To achieve the sustained pErk activation phase of the target profile, <italic>S<sub>Z</sub></italic> required a ramp-up in the sanguinarine doses (<xref ref-type="fig" rid="pcbi-1003546-g003">Figure 3B</xref>), which consequently caused the simulated system to systematically overshoot the target (<xref ref-type="fig" rid="pcbi-1003546-g003">Figure 3G</xref>, blue). On the other hand, <italic>S<sub>L</sub></italic> predicted that negligible quantities of either reagent are necessary (<xref ref-type="fig" rid="pcbi-1003546-g003">Figure 3C</xref>), which caused the simulated system to track the target moderately well, undershooting the target only slightly (<xref ref-type="fig" rid="pcbi-1003546-g003">Figure 3G</xref>, green). For the rapid dephosphorylation phase, <italic>S<sub>Z</sub></italic> specified a large dose of U0126 at 23 min while <italic>S<sub>L</sub></italic> specified relatively small doses over the final two intervals. In contrast to the activation phase, the small doses specified by <italic>S<sub>L</sub></italic> were insufficient to track the desired rapid transient behavior; the large dose specified by <italic>S<sub>Z</sub></italic> produced significantly better tracking. Considering the experiment as a whole, however, neither controller adequately controlled the simulated system over the entire time interval.</p>
<p>The multiple-model controller with equal weights (<italic>M<sub>eq</sub></italic>) considered the predictions from both models equally in specifying the control inputs (<xref ref-type="fig" rid="pcbi-1003546-g003">Figure 3D</xref>), but tracked only marginally better than either of the mismatched controllers <italic>S<sub>Z</sub></italic> or <italic>S<sub>L</sub></italic> (<xref ref-type="fig" rid="pcbi-1003546-g003">Figure 3G</xref>, cyan). On the other hand, the adaptive weighting strategy allowed the multiple-model controller to inherit the best characteristics of both single-model controllers (<xref ref-type="fig" rid="pcbi-1003546-g003">Figure 3E</xref>). According to <xref ref-type="fig" rid="pcbi-1003546-g003">Figure 3F</xref>, the weights tended toward Model <italic>L</italic> as it was the better representative of the simulated system initially, then shifted toward Model <italic>Z</italic> as it more accurately described the rapid dephosphorylation dynamics possessed by the simulated system. As a result, <italic>M<sub>aw</sub></italic> tracked the target significantly better with at least a 74% reduction in the squared error (see <xref ref-type="fig" rid="pcbi-1003546-g003">Figure 3H</xref>) than any of the mismatched single-model and fixed equal weight controllers as indicated in dynamics shown in <xref ref-type="fig" rid="pcbi-1003546-g003">Figure 3G</xref>.</p>
<p>Controller performances for the simulated case studies involving the real commercially-available control reagents sanguinarine and U0126 and the hypothetical control reagents aZAP and iZAP are summarized in <xref ref-type="fig" rid="pcbi-1003546-g004">Figures 4A and 4B</xref>, respectively. Both plots show the target tracking error between the predicted system dynamics and the target trajectories for all target and system model combinations. Matched single-model scenarios (<italic>S<sub>m</sub></italic>) are cases when the model used to design the control inputs is identical to that which is used to simulate the system response while the mismatched single-model scenarios (<italic>S<sub>mis</sub></italic>) use different models in both roles, the latter case tending to be the better representation of biological reality. As shown in both plots of <xref ref-type="fig" rid="pcbi-1003546-g004">Figure 4</xref>, <italic>S<sub>mis</sub></italic> had relatively large error values and tracked quite poorly. <italic>M<sub>eq</sub></italic> were able to partially mitigate these effects by averaging out some of the inconsistencies, but still performed no better than <italic>S<sub>mis</sub></italic>. The proposed controller strategy (<italic>M<sub>aw</sub></italic>) performed significantly better than <italic>S<sub>mis</sub></italic> and <italic>M<sub>eq</sub></italic> by preferentially selecting predictions from the models that were known to match the desire behavior at any point in time. This effect was more pronounced in scenarios where the dynamics differ among the prediction models because the controller was better able to filter out the inadequate models, thus improving tracking performance relative to the other controllers. Notably, the only scenarios not outperformed by <italic>M<sub>aw</sub></italic> were those in which a matched prediction model was used; however, these cases would be unrealistic in practice.</p>
<fig id="pcbi-1003546-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003546.g004</object-id><label>Figure 4</label><caption>
<title>Summary of target tracking performances for the simulated case studies.</title>
<p>(A) Summary of experiments involving realistic control reagents sanguinarine and U0126. (B) Summary of experiments involving hypothetical reagents aZAP and iZAP. Target tracking performance is measured by the squared error between target profiles and controlled plants. Data shown are mean ± standard error between matched (<italic>S<sub>m</sub></italic>, n = 30) and mismatched (<italic>S<sub>mis</sub></italic>, n = 60) single-model controllers, <italic>M<sub>eq</sub></italic> (n = 30) and <italic>M<sub>aw</sub></italic> (n = 30). Group letters denote statistically significant differences between groups (p&lt;0.05) as calculated by one-way ANOVA with Tukey multiple comparisons test (SigmaStat v3.5, Systat Software, Inc).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003546.g004" position="float" xlink:type="simple"/></fig></sec><sec id="s2f">
<title><italic>In Vitro</italic> Experiments Using Jurkat T Lymphocytes</title>
<p>We conducted a set of experiments where control input regimens were computed considering all three prediction models and implemented <italic>in vitro</italic> in Jurkat T cells according to the experimental protocol described in <xref ref-type="sec" rid="s4"><italic>Materials and Methods</italic></xref>. Since the equal weighted multiple-model controller design did not improve performance when compared with the single-model controllers for the simulated experiments, we did not include those in the more expensive <italic>in vitro</italic> study. The model weight maps were trained using preexisting experimental data (see <xref ref-type="fig" rid="pcbi-1003546-g008">Figure 8</xref> in <xref ref-type="sec" rid="s4"><italic>Materials and Methods</italic></xref>). <xref ref-type="fig" rid="pcbi-1003546-g005">Figure 5</xref> shows for a representative experiment (A–D) the computed control input dosing regimens for <italic>S<sub>Z</sub></italic>, <italic>S<sub>L</sub></italic>, <italic>S<sub>K</sub></italic> and <italic>M<sub>aw</sub></italic>, and (E) the Akaike weights for <italic>M<sub>aw</sub></italic> and (F) quantitative Western blot data. The specified target in the illustrated case required that Erk undergo rapid and sustained phosphorylation for 22 min and then rapidly return to steady state at basal levels. The quantitative Western blot data for this exemplar experiment are shown in <xref ref-type="fig" rid="pcbi-1003546-g006">Figure 6C</xref>. Without any external manipulation, pErk returned to its basal level slower and sooner than desired (<xref ref-type="fig" rid="pcbi-1003546-g006">Figure 6C</xref>, cyan triangle). Of the three single-model controllers, only <italic>S<sub>Z</sub></italic> (<xref ref-type="fig" rid="pcbi-1003546-g005">Figure 5A</xref>) correctly predicted that an initial ramp-up in sanguinarine was required to sustain pErk levels as desired. Based on the <italic>a priori</italic> information contained in the model weight maps, <italic>M<sub>aw</sub></italic> was preferential towards the predictions made by Model <italic>Z</italic> because it most accurately reflects the cell behavior (<xref ref-type="fig" rid="pcbi-1003546-g005">Figures 5D and 5E</xref>). However, Model <italic>Z</italic> was unable to replicate the rapid transient behavior of pErk in Jurkat cells in response to U0126 as accurately as the other models. In this case, <italic>M<sub>aw</sub></italic> deferred to the predictions made by Model <italic>K</italic>. Because of this ability to adapt the weights based on the current conditions, <italic>M<sub>aw</sub></italic> was able to control pErk much more tightly over the entire experiment than any of the models considered in isolation (<xref ref-type="fig" rid="pcbi-1003546-g006">Figure 6C</xref>, magenta dot).</p>
<fig id="pcbi-1003546-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003546.g005</object-id><label>Figure 5</label><caption>
<title><italic>In vitro</italic> experiments demonstrate superior target tracking performance by <italic>M<sub>aw</sub></italic>; corroborates observed <italic>in silico</italic> trends.</title>
<p>(<bold>A</bold>–<bold>D</bold>) Control input dosing regimens for single-model controllers (<italic>S<sub>Z</sub></italic>, <italic>S<sub>L</sub></italic> and <italic>S<sub>K</sub></italic>) and the multiple-model controller with adaptive Akaike weights (<italic>M<sub>aw</sub></italic>). (<bold>E</bold>) Akaike weights for <italic>M<sub>aw</sub></italic>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003546.g005" position="float" xlink:type="simple"/></fig><fig id="pcbi-1003546-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003546.g006</object-id><label>Figure 6</label><caption>
<title>Overall <italic>in vitro</italic> target tracking performances between target profiles and measured Erk phosphorylation.</title>
<p>Experiments with target trajectories (solid black) defined by the (<italic>t<sub>off</sub></italic>, <italic>p<sub>ss</sub></italic>) pairs of (<bold>A</bold>) (8,0), (<bold>B</bold>) (15,0) and (<bold>C</bold>) (22,0). Data are measurements of plant dynamics that were uncontrolled (<italic>UC</italic>, cyan triangle, n = 12) and controlled by <italic>S<sub>Z</sub></italic> (blue square, n = 9), <italic>S<sub>L</sub></italic> (green x, n = 9), <italic>S<sub>K</sub></italic> (red circle, n = 9) and <italic>M<sub>aw</sub></italic> (magenta dot, n = 9). Data shown are mean ± standard error. (<bold>D</bold>) Controller performances as measured by squared error between target trajectories and controlled plant dynamics. Group letters denote statistically significant differences between groups (p&lt;0.05) as calculated by one-way ANOVA with Tukey multiple comparisons test (SigmaStat v3.5, Systat Software, Inc).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003546.g006" position="float" xlink:type="simple"/></fig>
<p>Overall controller performances, defined as the squared error between the target output profiles and the corresponding observed plant dynamics, for the aforementioned experiment as well as the two other performed corroborating experiments are summarized in <xref ref-type="fig" rid="pcbi-1003546-g006">Figure 6D</xref> (descriptions of all experiments are provided in Section 5 of <xref ref-type="supplementary-material" rid="pcbi.1003546.s002">Text S1</xref>). Unsurprisingly, the largest deviations from the target trajectory were the uncontrolled responses. The single-model controllers improved tracking performance, but varied quite widely due primarily to the degree of how accurately the mathematical model predicted the signaling response (extent of plant-model mismatch). On the other hand, the intracellular signaling dynamics were much more tightly controlled by our multiple-model controller with adaptive Akaike weights, corroborating our <italic>in silico</italic> findings. The adaptive weighting strategy reduced the squared error by at least 63% over the best performing single-model controller. This indicates that our proposed control strategy is able to successfully filter out the prediction models in situations where they are known to be inaccurate and include them otherwise.</p>
</sec></sec><sec id="s3">
<title>Discussion</title>
<p>Recent studies have advanced and evaluated engineered control strategies to direct cellular processes in a desired manner. A few notable works that used feedback control approaches paired <italic>in silico</italic> control with experimental corroboration include controlling cell differentiation via nonlinear MPC <xref ref-type="bibr" rid="pcbi.1003546-Noble1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1003546-Noble2">[14]</xref> and long-term feedback control of gene expression in yeast <xref ref-type="bibr" rid="pcbi.1003546-Uhlendorf1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1003546-MiliasArgeitis1">[16]</xref>. This study augments this literature base by providing a novel and experimentally-corroborated methodology to enable the successful design and implementation of open-loop control strategies. Feedback control has many advantages over open-loop control since it uses measurements during the event to adjust the control inputs based upon the system response. This closed-loop approach helps to overcome inaccuracies of the supporting mathematical model. However, feedback control is not always possible due to experimental limitations. Open-loop control pre-specifies the control inputs: like a recipe. The feasibility of our open-loop control approach to overcome the inaccuracies of a single mathematical model has been demonstrated by experimental signal tracking by an intracellular signaling pathway.</p>
<p>While the concept of multiple-model-based control is not new, it is employed nearly exclusively in the closed-loop framework <xref ref-type="bibr" rid="pcbi.1003546-Noble2">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1003546-Huang1">[22]</xref>–<xref ref-type="bibr" rid="pcbi.1003546-KuureKinsey1">[25]</xref>, where system data are collected to inform future controller inputs. For the TCR-mediated Erk activation pathway and similar systems, the biological reality and practical experimental constraints necessitated the use of multiple mathematical models in an open-loop framework to achieve sufficient control. Because of these constraints, we formulated a new technique for control input selection that did not require real-time feedback data. Our novel technique uses what limited quantitative data are already available to generate a series of weight maps that indicate the likelihood of each model for any feasible control input scenario. When selecting the appropriate control input, these maps serve as a sort of filter that emphasizes data most relevant to the given scenario and excludes data that would only confound the selection process. Thus our approach effectively utilized multiple models with an adaptive weighting scheme to plan the control inputs.</p>
<p>Selecting such control inputs from multiple models with competing predictions generally does not have a unique solution because the criterion by which a solution is chosen depends entirely upon the decision maker. In this multiobjective optimization framework, each objective can be defined as controller performance based on one model. Attempting to satisfy multiple conflicting objectives will lead to a family of solutions (i.e. Pareto solutions) for which any improvement in one objective comes at the cost of at least one other objective. While the Pareto front topography is method-independent, choosing a particular solution along the front depends entirely upon the preferences of the decision maker. Typically a scalarization technique is used to compact the multidimensional problem into a single objective. Zarei <italic>et al.</italic> formulated a fuzzy rule set comprised of linear membership functions to aggregate the objectives based on the authors' preferences to control HIV dynamics in a CD4+ T cell population <xref ref-type="bibr" rid="pcbi.1003546-Zarei1">[33]</xref>. Another group employed a trade-off method in which the chosen Pareto point is closest in some sense to the decision maker's aspiration level, or desired value of each objective <xref ref-type="bibr" rid="pcbi.1003546-Nakayama1">[34]</xref>. A trade-off operator changes the aspiration level based on which criterion the decision maker wants to improve if the suggested point is not satisfactory. Promethee uses a pair-wise outranking relation among all Pareto points so that a satisfactory solution is identified as soon as the points are found <xref ref-type="bibr" rid="pcbi.1003546-DeKeyser1">[35]</xref>. The relation is typically fixed once established and cannot update itself automatically. Bemporad <italic>et al.</italic> proposed choosing control inputs based on a time-varying, state-dependent decision criterion that is informed by real-time observational feedback <xref ref-type="bibr" rid="pcbi.1003546-Bemporad1">[36]</xref>. Unfortunately, most available methods share a common challenge in that they are not fully automated, require observational feedback or are application-specific. Because our goal is to control uncertain intracellular signaling dynamics, we define our preference between objectives to be the relative likelihoods of the models as quantified by the Akaike weights. This allows us to automatically determine an optimal “blend” of the various models based on existing data and predicted input conditions to maximize prediction confidence while controlling for target tracking error.</p>
<sec id="s3a">
<title>Remarks on General Use and Limitations</title>
<p>We have presented a method that was shown to improve target-tracking performance in a biochemical system with relatively high modeling uncertainty and measurement noise. Naturally, we employed our own knowledge of the system as well as that taken from literature to ease the implementation of the control method in the laboratory setting. Even so, the proposed framework is general enough to be employed in a wide variety of engineering applications. The method is suitable for any physical system with possible dynamics that can be characterized by a set of mathematical models. The models should include feasible control inputs that are capable of manipulating the output dynamics and can be structurally unique. Furthermore, the ensemble of models should adequately recapitulate the relevant behaviors of the system. The method does not require real-time observability in its current open-loop configuration, although observations should not be ignored when available. While we have tested and corroborated the method only with nonlinear ODE models, we believe the modeling format is an application-related issue and not restricted by the method.</p>
<p>Although our proposed framework is widely applicable, its efficacy for a given system depends on a variety of modeling and experimental constraints (i.e. problem-specific information used to inform the controller), and computational constraints (i.e. control problem dimensionality).</p>
<p>From a modeling and experimental perspective, efficacy depends on how well the system is characterized by the prediction model bank, the accuracy of the model weight maps and the availability of quantitative measurement tools or assays and control reagents or actuators. First, the prediction model bank should be formulated in such a manner that all desired system behaviors are within the reachable dynamics of the ensemble of models. Any characteristic behaviors or operating points not included in the model bank would not be able to be recapitulated, regardless of the adaptive model weighting scheme. However, these behaviors or operating points may be captured by including models with alternate parameter values or equation structures. In the case studied in this manuscript, each model had a different equation structure, but represented alternate plausible mechanisms that are at least partially supported by data.</p>
<p>Second, the accuracy of the model weight maps depends on the quantity and quality of preliminary data. Without any prior information, the models are considered equally when selecting control inputs. As experiments are performed, the gathered data can be used to train the weight maps to the actual model-system relationship. Models can then be selected according to its capacity to accurately predict the effects of the inputs on the system. An implicit assumption here is that if a model is good at predicting the effect of some input at some time, it will be good at predicting the effect of another input at another time. While this assumption may not always be true, the known dynamics, developed and refined based on considerable experimental work, provide extensive constraints on what the possible unknown dynamics could be.</p>
<p>Finally, while our method does not require data in real time because of the open-loop formulation, accurate quantitative assays and specific control reagents are highly beneficial in the development of accurate models and model weight maps help decrease the effects of plant-model mismatch, a common failure mode in open-loop control. Even so, with the proposed adaptive weighting procedure, each model need only be partially data-consistent. We were able to demonstrate control using quantitative Western blots to measure Erk phosphorylation dynamics in T cells, despite the fact that Western blots are notoriously difficult to use and chemical reagents generally have some off-target effects.</p>
<p>Computational tractability is another important area to consider. To get the most benefit from the adaptive model weighting strategy, our control strategy involves a multiobjective optimization problem (of dimension <italic>n<sub>M</sub></italic>×<italic>n<sub>y</sub></italic>) at every time interval. In practice, this is equivalent to solving a series of single-objective optimization problems (of dimension <italic>n<sub>u</sub></italic>×<italic>H<sub>u</sub></italic>), the number of which depends on the desired Pareto front resolution. In this manuscript, we greatly reduce the complexity of our control problem by considering only three models, a single controlled output, and two discretized control inputs and a control horizon of one interval (at a time). However, it would not be far-fetched to have a control problem with potentially dozens of models, multiple inputs and outputs, and an extended control horizon. In such a case, it would be critical to reduce the control problem down to a computationally tractable size. This can be achieved a number of ways. For instance, dimensions corresponding to different model outputs can be scalarized using weighted aggregation. Also, dimensions corresponding to models that are redundant or dominated (i.e. low Akaike weights throughout the input space) should be removed.</p>
</sec><sec id="s3b">
<title>Uncertainty in the Model Weight Maps</title>
<p>As previously mentioned, the purpose of the weight map strategy is to help estimate an optimal blend of the considered models to create the best possible compromise input solution given modeling uncertainty. The accuracy of these maps depends heavily on the quantity and quality of the preliminary data used to train the maps. Without any prior information, there would be no evidence supporting one model over another and the resulting weight map topology would be flat. Inversely, if the system dynamics are known with certainty, but requires more than one model to recapitulate them all, then the resulting weight map topology would appear digital. That is, only one model would dominate in any given experimental scenario and the transition between which model dominates would be immediate.</p>
<p>In our presented experimental study, we considered a case in which a substantial amount of time-course data (432 individual measurement points in total) was used to train the model weight maps. Due to the relatively large number of data, the AICc tends to show a strong sensitivity to any differences in model fitness values, causing the weight map topography to appear somewhat digital in nature (<xref ref-type="fig" rid="pcbi-1003546-g007">Figure 7A–C</xref>). However, let us consider a case in which we have fewer data (144 individual measurement points in total), or alternatively, more uncertainty in our models' ability to recapitulate the observed system behaviors. With fewer data, the AICc tends to show a weaker sensitivity to differences in model fitness values, causing the weight map topography to appear smoother (<xref ref-type="fig" rid="pcbi-1003546-g007">Figure 7D–F</xref>). Although the weight maps for these two scenarios are clearly different quantitatively, the order in which the models are prioritized (i.e. model rankings) are essentially identical (<xref ref-type="fig" rid="pcbi-1003546-g007">Figure 7G–L</xref>). To illustrate the effects of these characteristics, let us consider one exemplar experiment (<xref ref-type="fig" rid="pcbi-1003546-g007">Figure 7M</xref>). When utilizing the full dataset, the control strategy tends to heavily favor one model over the others at any given time. However, when the limited dataset is considered, the time course is covered by a non-trivial (i.e. non-digital) combination of the models, each representing a portion of actual system behavior. Even so, the orders in which the models are prioritized are very similar between the two cases. This means that for any given region of the input space, the choice of model providing the most reliable information is somewhat robust to the amount or quality of the training data. As a result, the predicted control regimens (<xref ref-type="fig" rid="pcbi-1003546-g007">Figure 7N</xref>) and their corresponding target tracking performance values (<xref ref-type="fig" rid="pcbi-1003546-g007">Figure 7O</xref>) also exhibit this same qualitative robustness.</p>
<fig id="pcbi-1003546-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003546.g007</object-id><label>Figure 7</label><caption>
<title>Analysis of uncertainty in the model weight maps and resulting predicted control strategies and performance.</title>
<p>Model weights over the input space for (<bold>A</bold>–<bold>C</bold>) the original case study (full dataset) and (<bold>D</bold>–<bold>F</bold>) the case study with the limited dataset. Model rankings over the input space for (<bold>G</bold>–<bold>I</bold>) the original case study (full dataset) and (<bold>J</bold>–<bold>L</bold>) the case study with the limited dataset. (<bold>M</bold>) Adaptive weights and (<bold>N</bold>) corresponding control input regimen for the exemplar experiment characterized by the target trajectory defined by the pair (<italic>t<sub>off</sub></italic> = 8, <italic>p<sub>ss</sub></italic> = 0). (<bold>O</bold>) Controller performances as measured by squared error between target trajectories and plant dynamics controlled by single-model controllers that are matched (<italic>S<sub>m</sub></italic>, n = 30) and mismatched (<italic>S<sub>mis</sub></italic>, n = 60), and adaptively-weighted multiple-model controllers with the original “digital” weight maps (<italic>M<sub>aw(o)</sub></italic>, n = 30) and smoother weight maps from the limited dataset (<italic>M<sub>aw(ld)</sub></italic>, n = 30). Data shown are mean ± standard error. Group letters denote statistically significant differences between groups (p&lt;0.05) as calculated by one-way ANOVA with Tukey multiple comparisons test (SigmaStat v3.5, Systat Software, Inc).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003546.g007" position="float" xlink:type="simple"/></fig></sec><sec id="s3c">
<title>Importance of Erk Signaling in T Lymphocytes</title>
<p>T lymphocytes are an integral part of the human body's natural defense against the threats of invading pathogens and cancerous host cells. The function of these specialized immune cells largely depends on their phenotypic response to external stimulating signals. Propagating extracellular signals to their target substrates takes the coordinated effort of very large networks of molecular species with complex interactions ranging across vastly different spatial domains and temporal scales. While there are numerous mediators of signal transduction in lymphocytes, Erk is particularly noteworthy as it is an evolutionarily-conserved and ubiquitous group of signaling proteins critical to T cell development, proliferation and differentiation. Studies have linked Erk-mediated regulation to the differentiation of helper T cells into certain subtypes, particularly Th1 and Th2, and to allergies, asthma and serious immune disorders if improperly subtyped <xref ref-type="bibr" rid="pcbi.1003546-Mariathasan1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003546-Singh1">[2]</xref>. Furthermore, it has been recognized that controlling the Ras/Raf/Mek/Erk pathway maybe beneficial towards advancing effective therapies for leukemia <xref ref-type="bibr" rid="pcbi.1003546-Steelman1">[37]</xref>. Constitutive activation of the Erk pathway is present in a high frequency (&gt;50%) in patients suffering from acute myeloid leukemia (AML) and is associated with a marked reduction in survival duration <xref ref-type="bibr" rid="pcbi.1003546-Kornblau1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1003546-Ricciardi1">[4]</xref>. Conversely, blocking Erk activation has been shown to cause cell death in leukemia cell lines <xref ref-type="bibr" rid="pcbi.1003546-Kornblau1">[3]</xref>. Treatments based on methods that work to balance these opposing forces to restore proper Erk-mediated regulation in T cells would be highly beneficial to patients suffering from such pathologies. Historically this has been the subject of experimental research <xref ref-type="bibr" rid="pcbi.1003546-Shelton1">[38]</xref>, <xref ref-type="bibr" rid="pcbi.1003546-Lyons1">[39]</xref>. This study has confirmed that when used in combination the existing mathematical models of the Erk/MAPK pathway in T cells can support the engineering of control inputs to manipulate the activation and deactivation time course in a desired manner.</p>
</sec><sec id="s3d">
<title>Conclusions</title>
<p>We have developed a practical framework for controlling uncertain nonlinear systems using multiple models to generate predictable open-loop dynamical responses. The embedded model weight maps enable the controller to estimate the likelihood of each model in any feasible control scenario based on prior training data. The adaptive weighting strategy allows the controller to purposefully select subsets of the training data so that control decisions are made considering only the most relevant information at each time interval. Our open-loop controller design pairs model predictive control with an adaptive model weighting system based in information theory to create a cohesive strategy for systematically utilizing the most relevant knowledge embedded within limited training data in a computationally tractable manner. In both simulated and laboratory experiments this multiple-model control strategy and adaptive weighting scheme successfully reduced the open-loop target tracking error by more than half relative to multiple-model control with fixed weights (simulation only) and single-model control.</p>
</sec></sec><sec id="s4" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="s4a">
<title>Experimental Protocol</title>
<p>Erk phosphorylation (pErk) data were collected from Jurkat T leukemia cell line (Jurkat clone E6.1; ATCC). Cells were grown in RPMI 1640 (Sigma) supplemented with 7.5% heat-inactivated fetal bovine serum (BioWest), 1 mM sodium pyruvate (Gibco), 12.5 mM HEPES pH 7.4 (Sigma), 12 µM sodium bicarbonate (Sigma) 50 µM 2-Mercaptoethanol (Sigma), 50 µg/ml streptomycin and 50 units/ml penicillin in an incubator at 37°C in humidified air containing 5% carbon dioxide. Cells were harvested in log-phase growth at a density of 2×10<sup>7</sup> cells per treatment. Cells were stimulated using anti-human CD3 (10 µg/ml, clone: UCHT-1, eBioscience) as the stimulatory signal at 37°C in a water bath. Cells were treated with the Mek1/2 inhibitor U0126 (Calbiochem) or the MKP inhibitor sanguinarine (Sigma), depending on the protocol, dissolved in DMSO at the indicated time points with the indicated concentrations. Experimental control samples were treated with the same amount of DMSO. Samples of 2×10<sup>6</sup> cells were taken at the indicated time points and lysed in 1% NP40 lysis buffer (1% NP40, 25 mM Tris, pH 7.4, 150 mM NaCl, 5 mM EDTA, 1 mM NaV, 10 mM NaF, 10 µg/ml each of aprotinin and leupeptin) for 15 min on ice. Lysates were centrifuged for 5 min at 18000 g at 4°C. The supernatant was added to the same volume of 2<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e002" xlink:type="simple"/></inline-formula> protein solubilizing mixture (PSM, 25% (w/v) sucrose, 2.5% (w/v) sodium dodecyl sulfate, 25 mM Tris, 2.5 mM EDTA, 0.05% bromophenol blue) and boiled for five minutes. Proteins were separated via SDS-PAGE, blotted for phospho-Erk1/2 (Cell Signaling), phospho-ZAP-70 (pY319, Cell Signaling) and GAPDH (Ambion). IRDye 800 and 680 secondary anti-mouse and anti-rabbit antibodies (Li-Cor) were used for signal detection using an Odyssey infrared scanner. Images of the blots were analyzed using ImageJ to produce quantitative data for model comparison. Model predictions were scaled to compensate for the fact that the data represent relative quantities only rather than absolute concentrations.</p>
</sec><sec id="s4b">
<title>Training Experiments</title>
<p>Training experiments were designed to rapidly screen the responses of T cell populations to potential control reagent combinations. Fourteen different experiments were conducted: an experimental control (i.e. no control inputs), five individual doses of sanguinarine (0.5, 2, 5, 20 and 50 µM) at the 15 minute mark, five individual doses of U0126 (0.5, 1, 2, 5 and 10 µM) at the 6 minute mark, and three combined doses of 0.5 and 1, 50 and 1, and 50 and 10 µM for sanguinarine and U0126, respectively, at the 6 minute mark. These data were collected according to <italic>Experimental Protocol</italic>. The addition of low doses of sanguinarine had negligible effects on pErk concentrations. Only the moderate to high doses tested caused elevated to sustained phosphorylation of Erk (<xref ref-type="fig" rid="pcbi-1003546-g008">Figure 8A</xref>). On the other hand, U0126 produced an immediate reduction in the Erk phosphorylation rate even at low doses (<xref ref-type="fig" rid="pcbi-1003546-g008">Figure 8B</xref>) and tended to overpower the effects of sanguinarine when added together (<xref ref-type="fig" rid="pcbi-1003546-g008">Figure 8C</xref>). The representation of the controller input functions in the prediction models were modified to exhibit these trends.</p>
<fig id="pcbi-1003546-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003546.g008</object-id><label>Figure 8</label><caption>
<title>Training data used to generate the model weight maps.</title>
<p>Rows correspond to doses of sanguinarine only, U0126 only, and combinations of the two reagents, respectively. Symbols and error bars denote means ± standard errors of the raw normalized data. Lines represent smoothed data. Arrows denote the time at which the reagents were administered.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003546.g008" position="float" xlink:type="simple"/></fig>
<p>Due to the prevalence of observation noise, experimental data <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e003" xlink:type="simple"/></inline-formula> were smoothed using cubic smoothing splines to filter spurious oscillations from the time courses while retaining primary trends. This was performed in Matlab using the <italic>csaps</italic> function with the smoothing parameter <italic>p</italic> set to 0.6. The smoothing splines were sampled at 31 evenly spaced time points to increase the density of the time course data.</p>
</sec><sec id="s4c">
<title>Model Bank Representation</title>
<p>The proposed control strategy is based on a set of two or more mathematical models, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e004" xlink:type="simple"/></inline-formula>, of a given system with the general form:<disp-formula id="pcbi.1003546.e005"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003546.e005" xlink:type="simple"/><label>(1)</label></disp-formula>where the superscript <italic>i</italic> denotes the model number. The state variables, control inputs, system parameters, measured outputs and controlled outputs are<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e006" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e007" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e008" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e009" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e010" xlink:type="simple"/></inline-formula>, respectively, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e011" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e012" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e013" xlink:type="simple"/></inline-formula> are twice continuously differentiable functions for the system dynamics, measured outputs and controlled outputs, respectively. Note that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e014" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e015" xlink:type="simple"/></inline-formula> are functions of <italic>u</italic>, <italic>t</italic> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e016" xlink:type="simple"/></inline-formula>. For our purposes we will use the notation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e017" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e018" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s4d">
<title>Approximating Model Dynamics with Sparse Grids</title>
<p>Sparse grids were implemented using the Sparse Grid Interpolation Toolbox for Matlab, version 5.1.1 <xref ref-type="bibr" rid="pcbi.1003546-Klimke1">[40]</xref>, which is available at <ext-link ext-link-type="uri" xlink:href="http://www.ians.uni-stuttgart.de/spinterp/" xlink:type="simple">http://www.ians.uni-stuttgart.de/spinterp/</ext-link>. Our approach for approximating model dynamics using interval-based sparse grid interpolation is similar to that of <xref ref-type="bibr" rid="pcbi.1003546-Noble2">[14]</xref>. The control inputs are assumed to lie within the bounded <italic>n<sub>u</sub></italic>-dimensional space containing all feasible control input vectors, defined by<disp-formula id="pcbi.1003546.e019"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003546.e019" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e020" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e021" xlink:type="simple"/></inline-formula> is the <italic>j</italic><sup>th</sup> value of the input vector. For each model, <italic>n<sub>z</sub></italic> output variables are selectively evaluated at points in the <italic>n<sub>u</sub></italic>-dimensional input space and <italic>n<sub>t</sub></italic>-dimensional time domain to form a series of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e022" xlink:type="simple"/></inline-formula> grids of dimension <italic>n<sub>u</sub></italic> (see <xref ref-type="bibr" rid="pcbi.1003546-Noble2">[14]</xref> for further details). On each grid, weighted Lagrange basis functions are combined at the support nodes to construct an input-domain interpolant with which the value of an output at a single time point can be estimated for any point in the input space. In this interval-based approach, interpolation between grids placed at various time points ensures a continuous trajectory over the prediction horizon for any point in the input space. To prevent excessive computational expense during grid construction, limits on absolute and relative error tolerances and allowable interpolation depth were specified (0.01, 1%, and 6, respectively).</p>
</sec><sec id="s4e">
<title>Model Weight Maps</title>
<p>For problem set-up, we estimate weight maps on Ω for the prediction models using Akaike weights, which are based on the Akaike Information Criterion (AIC). AIC provides a practical measure of the tradeoff between model fitness and complexity by estimating the theoretical Kullback-Leibler (KL) “distance”, or loss of information, between an approximating model and full reality <xref ref-type="bibr" rid="pcbi.1003546-Burnham1">[26]</xref>. Assuming normally distributed errors with constant variance and small sample sizes, the corrected-AIC (AICc) can be estimated as:<disp-formula id="pcbi.1003546.e023"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003546.e023" xlink:type="simple"/><label>(3)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e024" xlink:type="simple"/></inline-formula> is the total number of experimental data and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e025" xlink:type="simple"/></inline-formula> is the number of sampled time points for the <italic>j</italic><sup>th</sup> measured output. The second term, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e026" xlink:type="simple"/></inline-formula> denotes the number of uncertain parameters for the <italic>i</italic><sup>th</sup> model, is the bias-correction factor for the AIC (the factor 2 was introduced for historical reasons) and the third term is an additional correction factor for small sample sizes. Note that the first term includes the squared residuals between experimental data (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e027" xlink:type="simple"/></inline-formula>) and their <italic>i</italic><sup>th</sup> model counterpart (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e028" xlink:type="simple"/></inline-formula>). Under realistic conditions, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e029" xlink:type="simple"/></inline-formula> are sampled at discrete input quantities and time points and the number of data can vary between outputs. To generate a continuous approximation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e030" xlink:type="simple"/></inline-formula> over Ω, a piecewise linear interpolant is constructed using the Matlab function <italic>griddatan</italic>. That is,<disp-formula id="pcbi.1003546.e031"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003546.e031" xlink:type="simple"/><label>(4)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e032" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e033" xlink:type="simple"/></inline-formula> denote the discrete experimental input and observation time spaces, respectively, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e034" xlink:type="simple"/></inline-formula> is an operator denoting (<italic>n<sub>u</sub></italic>+1)-dimensional linear interpolation between existing points over <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e035" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e036" xlink:type="simple"/></inline-formula> by means of Delaunay triangulation. In regions not explicitly measured, interpolated data (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e037" xlink:type="simple"/></inline-formula>) are used in place of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e038" xlink:type="simple"/></inline-formula> when computing AICc values.</p>
<p>It is important to note that only relative AICc values are meaningful due to the metric being a relative rather than absolute estimate of KL distance. It follows that the relative likelihoods of the models are given by the Akaike weights,<disp-formula id="pcbi.1003546.e039"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003546.e039" xlink:type="simple"/><label>(5)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e040" xlink:type="simple"/></inline-formula>. The weight <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e041" xlink:type="simple"/></inline-formula> is interpreted as the strength of evidence in support, or relative probability, of the <italic>i</italic><sup>th</sup> model being the KL best model from the set of models given the supporting data <xref ref-type="bibr" rid="pcbi.1003546-Burnham1">[26]</xref>. The weight maps for Model <italic>Z</italic>, Model <italic>L</italic> and Model <italic>K</italic> based on the data described in <italic>Training Experiments</italic> are provided in <xref ref-type="fig" rid="pcbi-1003546-g003">Figure 3</xref> in <xref ref-type="supplementary-material" rid="pcbi.1003546.s002">Text S1</xref>.</p>
</sec><sec id="s4f">
<title>Open-Loop Model Predictive Control with Multiple Models</title>
<p>The multiple-model control strategy is built around the conventional MPC framework to reduce the computational complexity of the open-loop control problem. At each time interval, the controller surveys the possible trajectories stemming from the current state and selects the control input sequence over the control horizon (<italic>H<sub>u</sub></italic>) so that the predicted outputs track the desired trajectories over the finite prediction horizon (<italic>H<sub>p</sub></italic>). The first control input of the selected sequence is used to update the states of the prediction models and then stored as one entry in the final control sequence <italic>U</italic><sup>*</sup> so the procedure can repeat as the prediction horizon slides along for the remaining time intervals.</p>
<p>The objective functions used to quantify controller performance penalizes the error between the predicted outputs for the <italic>i</italic><sup>th</sup> model and the desired trajectories and a measure of the control effort over the prediction horizon starting at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e042" xlink:type="simple"/></inline-formula> as given by</p>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e043" xlink:type="simple"/></inline-formula>, where<disp-formula id="pcbi.1003546.e044"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003546.e044" xlink:type="simple"/><label>(6)</label></disp-formula>The vectors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e045" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e046" xlink:type="simple"/></inline-formula> are the predicted and target outputs over <italic>H<sub>p</sub></italic>, respectively, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e047" xlink:type="simple"/></inline-formula> are the discrete controller inputs over <italic>H<sub>u</sub></italic>. The proposed formulation assumes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e048" xlink:type="simple"/></inline-formula>, <italic>j</italic> = 1,…,<italic>n<sub>u</sub></italic>, and <italic>m</italic> = <italic>H<sub>u</sub></italic>,…,<italic>H<sub>p</sub></italic> to reflect that manipulated variables are often applied as boluses in the considered biological context. The horizons <italic>H<sub>u</sub></italic> and <italic>H<sub>p</sub></italic> where each chosen to be one to prevent controllers from being overly conservative. <italic>Q</italic> and <italic>R</italic> are diagonal weighting matrices associated with the error and control effort, respectively, which were each chosen to be identity. Objective values are converted to log-space to compress the cost surfaces to facilitate optimization.</p>
<p>Each objective <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e049" xlink:type="simple"/></inline-formula> is approximated using sparse grid interpolation (similar to section <italic>Approximating Model Dynamics with Sparse Grids</italic>) to form an input-domain interpolant with which the value of each objective can be estimated for any point in the input space. If the approximations are sufficiently accurate, no further evaluations of the objective function or underlying state space model are required since the interpolants are generated prior to optimization during each time interval.</p>
</sec><sec id="s4g">
<title>Pareto Front Identification</title>
<p>We define the multiobjective optimization problem at the <italic>k</italic><sup>th</sup> time interval as follows (with the standard Pareto interpretation of minimizers):<disp-formula id="pcbi.1003546.e050"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003546.e050" xlink:type="simple"/><label>(7)</label></disp-formula></p>
<p>The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e051" xlink:type="simple"/></inline-formula> variable denotes the objective function for the <italic>i</italic><sup>th</sup> model defined by (6) and the design variable <italic>U<sub>k</sub></italic> is constrained to Ω defining biologically relevant limits. Herein we employ the normalized normal constraint method (NNC) for generating the Pareto solutions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e052" xlink:type="simple"/></inline-formula> for its ability to generate a well-distributed set of global Pareto points (<xref ref-type="bibr" rid="pcbi.1003546-Messac1">[41]</xref>, refer to the original manuscript for further details).</p>
<p>NNC provides a geometrically intuitive approach to multiobjective optimization that is illustrated in <xref ref-type="fig" rid="pcbi-1003546-g004">Figure 4</xref> in <xref ref-type="supplementary-material" rid="pcbi.1003546.s002">Text S1</xref>. It first builds a plane in the normalized objective space (called the <italic>utopia hyperplane</italic>) through all individual (normalized) minima <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e053" xlink:type="simple"/></inline-formula>, and second, generates equally distributed points in this plane <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e054" xlink:type="simple"/></inline-formula> by systematically varying weights for each objective. Then for each point <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e055" xlink:type="simple"/></inline-formula>, the corresponding solution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e056" xlink:type="simple"/></inline-formula> on the Pareto front <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e057" xlink:type="simple"/></inline-formula> is found by minimizing the single (normalized) objective <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e058" xlink:type="simple"/></inline-formula> with added constraints. In addition to the original constraints, the feasible space is further restricted by adding <italic>n<sub>M</sub></italic> −1 hyperplanes through <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e059" xlink:type="simple"/></inline-formula> that are each normal to the <italic>n<sub>M</sub></italic> −1 utopia plane vectors. Successive optimization runs are performed for the remaining points in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e060" xlink:type="simple"/></inline-formula>. By translating the constraining normal hyperplanes between runs, we can see that the corresponding solution set along the leading edge of the objective space is generated. Since some of these points may represent non-Pareto optimal or dominated solutions, the NNC algorithm is coupled with a Pareto filter to remove such points.</p>
</sec><sec id="s4h">
<title>Input Selection and Model Weight Adaptation</title>
<p>The optimal control sequence for the <italic>k</italic><sup>th</sup> time interval is selected from the set of Pareto solutions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e061" xlink:type="simple"/></inline-formula> by ranking them using the objective<disp-formula id="pcbi.1003546.e062"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003546.e062" xlink:type="simple"/><label>(8)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e063" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e064" xlink:type="simple"/></inline-formula> are vectors of objective function values and Akaike weights, respectively, corresponding to the control input vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e065" xlink:type="simple"/></inline-formula>.</p>
<p>The models weights are adapted to accommodate the most relevant experimental data to ensure the best possible open-loop performance (<xref ref-type="fig" rid="pcbi-1003546-g009">Figure 9</xref>). At the first time interval, <italic>u</italic> is undetermined so the initial weights are computed considering the entire training data set. After the Pareto points <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e066" xlink:type="simple"/></inline-formula> are specified by solving (7), they are ranked using (8) with the initial weights (<xref ref-type="fig" rid="pcbi-1003546-g009">Figure 9A</xref>) and the input vector corresponding to the best ranked point is taken as a temporary solution <italic>u</italic><sub>1</sub> (<xref ref-type="fig" rid="pcbi-1003546-g009">Figure 9B</xref>). The weights are then recalibrated at the value <italic>u</italic><sub>1</sub> (<xref ref-type="fig" rid="pcbi-1003546-g009">Figure 9C</xref>) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003546.e067" xlink:type="simple"/></inline-formula> ranked again with the best ranked input vector taken as the new temporary solution <italic>u</italic><sub>2</sub> and so on. Updates continue until the model weights or control inputs no longer change above a prescribed threshold or the maximum allowable updates is reached. If a limit cycle is detected, (8) is recomputed by averaging the models weights in the cycle as a tie-breaker. The final input sequence is used to update the prediction models and appended to the growing open-loop control sequence <italic>U</italic><sup>*</sup> as the prediction horizon slides along.</p>
<fig id="pcbi-1003546-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003546.g009</object-id><label>Figure 9</label><caption>
<title>Illustration of control input selection with model weight adaptation.</title>
<p>For a given prediction time interval in the control process, Pareto-optimal control inputs are computed by the multi-model MPC strategy by solving (7), which then enter an iterative process of control input selection and weight adaptation. (<bold>A</bold>) First, Pareto points are ranked with an initial weight vector ω<sub>0</sub> and the optimal point (example: black square) is selected using (8). (<bold>B</bold>) Next, the input vector corresponding to the selected optimal point (<italic>u</italic><sub>1</sub>, black square) is identified. If the input vector continues to change above a pre-defined threshold, the process continues to the next iteration. (<bold>C</bold>) Given the current input vector (<italic>u</italic><sub>1</sub>), a new weight vector (<italic>ω</italic>(<italic>u</italic><sub>1</sub>), black square) is computed. The process continues and repeats (example: black circle, then magenta star) until the aforementioned stopping criterion is met. The final input vector (<italic>u<sub>n</sub></italic>, magenta star) is returned to the main control loop as the best compromise control strategy and used to update the prediction models in preparation for the next prediction time interval.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003546.g009" position="float" xlink:type="simple"/></fig></sec><sec id="s4i">
<title>Statistical Analysis</title>
<p>All statistical analysis was performed using SigmaStat v3.5 (Systat Software, Inc). Time-course data are shown as mean ± standard error at each time point. Statistical differences between groups (p≤0.05) are determined using one-way analysis of variance (ANOVA) followed by the Tukey multiple comparisons test. Target tracking performance values, as measured by squared error between target profiles and controlled plants, were log-transformed where appropriate to satisfy the normality and equal variance conditions for the ANOVA and Tukey tests.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003546.s001" mimetype="application/zip" xlink:href="info:doi/10.1371/journal.pcbi.1003546.s001" position="float" xlink:type="simple"><label>Dataset S1</label><caption>
<p><bold>Matlab code for proposed control algorithm and prediction models.</bold> Contains all Matlab code necessary to implement the proposed adaptive weighted multiple-model predictive control algorithm, as well as code for the prediction models.</p>
<p>(ZIP)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003546.s002" mimetype="application/msword" xlink:href="info:doi/10.1371/journal.pcbi.1003546.s002" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>Additional methods and results.</bold> Contains details on specific model modification and additional simulated and experimental results.</p>
<p>(DOC)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We are grateful to M. Donahue, S. Noble, M. Pargett and the rest of the Rundell research group for their insightful discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003546-Mariathasan1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mariathasan</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Zakarian</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Bouchard</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Michie</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Zuniga-Pflucker</surname><given-names>JC</given-names></name>, <etal>et al</etal>. (<year>2001</year>) <article-title>Duration and strength of extracellular signal-regulated kinase signals are altered during positive versus negative thymocyte selection</article-title>. <source>Journal of Immunology</source> <volume>167</volume>: <fpage>4966</fpage>–<lpage>4973</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Singh1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Singh</surname><given-names>RAK</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>JWZ</given-names></name> (<year>2004</year>) <article-title>Differential activation of ERK, p38, and JNK required for Th1 and Th2 deviation in myelin-reactive T cells induced by altered peptide ligand</article-title>. <source>Journal of Immunology</source> <volume>173</volume>: <fpage>7299</fpage>–<lpage>7307</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Kornblau1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kornblau</surname><given-names>SM</given-names></name>, <name name-style="western"><surname>Womble</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Qiu</surname><given-names>YH</given-names></name>, <name name-style="western"><surname>Jackson</surname><given-names>CE</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>WJ</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Simultaneous activation of multiple signal transduction pathways confers poor prognosis in acute myelogenous leukemia</article-title>. <source>Blood</source> <volume>108</volume>: <fpage>2358</fpage>–<lpage>2365</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Ricciardi1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ricciardi</surname><given-names>MR</given-names></name>, <name name-style="western"><surname>McQueen</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Chism</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Milella</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Estey</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Quantitative single cell determination of ERK phosphorylation and regulation in relapsed and refractory primary acute myeloid leukemia</article-title>. <source>Leukemia</source> <volume>19</volume>: <fpage>1543</fpage>–<lpage>1549</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Zheng1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zheng</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Rundell</surname><given-names>A</given-names></name> (<year>2006</year>) <article-title>Comparative study of parameter sensitivity analyses of the TCR-activated Erk-MAPK signalling pathway</article-title>. <source>IEEE Proceedings Systems Biology</source> <volume>153</volume>: <fpage>201</fpage>–<lpage>211</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Lipniacki1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lipniacki</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Hat</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Faeder</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Hlavacek</surname><given-names>WS</given-names></name> (<year>2008</year>) <article-title>Stochastic effects and bistability in T cell receptor signaling</article-title>. <source>Journal of Theoretical Biology</source> <volume>254</volume>: <fpage>110</fpage>–<lpage>122</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Klamt1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Klamt</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Saez-Rodriguez</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Lindquist</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Simeoni</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Gilles</surname><given-names>ED</given-names></name> (<year>2006</year>) <article-title>A methodology for the structural and functional analysis of signaling and regulatory networks</article-title>. <source>Bmc Bioinformatics</source> <volume>7</volume>: <fpage>26</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-SaezRodriguez1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Saez-Rodriguez</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Simeoni</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Lindquist</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Hemenway</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Bommhardt</surname><given-names>U</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>A logical model provides insights into T cell receptor signaling</article-title>. <source>Plos Computational Biology</source> <volume>3</volume>: <fpage>1580</fpage>–<lpage>1590</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Levchenko1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Levchenko</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Bruck</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Sternberg</surname><given-names>PW</given-names></name> (<year>2000</year>) <article-title>Scaffold proteins may biphasically affect the levels of mitogen-activated protein kinase signaling and reduce its threshold properties</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>97</volume>: <fpage>5818</fpage>–<lpage>5823</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Saadatpour1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Saadatpour</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>R-S</given-names></name>, <name name-style="western"><surname>Liao</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Loughran</surname><given-names>TP</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Dynamical and Structural Analysis of a T Cell Survival Network Identifies Novel Candidate Therapeutic Targets for Large Granular Lymphocyte Leukemia</article-title>. <source>PLoS Comput Biol</source> <volume>7</volume> (<issue>11</issue>) <fpage>e1002267</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Simon1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Simon</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Karim</surname><given-names>MN</given-names></name> (<year>2002</year>) <article-title>Control of starvation-induced apoptosis in Chinese hamster ovary cell cultures</article-title>. <source>Biotechnology and Bioengineering</source> <volume>78</volume> (<issue>6</issue>) <fpage>645</fpage>–<lpage>57</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Frahm1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Frahm</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Lane</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Markl</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Portner</surname><given-names>R</given-names></name> (<year>2003</year>) <article-title>Improvement of a mammalian cell culture process by adaptive, model-based dialysis fed-batch cultivation and suppression of apoptosis</article-title>. <source>Bioprocess and Biosystems Engineering</source> <volume>26</volume> (<issue>1</issue>) <fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Noble1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Noble</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Rundell</surname><given-names>AE</given-names></name> (<year>2009</year>) <article-title>Targeting a fixed percentage of granulocyte differentiation using experiments designed via nonlinear model predictive control</article-title>. <source>2009 American Control Conference</source> <volume>1–9</volume>: <fpage>313</fpage>–<lpage>318</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Noble2"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Noble</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Wendel</surname><given-names>LE</given-names></name>, <name name-style="western"><surname>Donahue</surname><given-names>MM</given-names></name>, <name name-style="western"><surname>Buzzard</surname><given-names>GT</given-names></name>, <name name-style="western"><surname>Rundell</surname><given-names>AE</given-names></name> (<year>2012</year>) <article-title>Sparse-Grid-Based Adaptive Model Predictive Control of HL60 Cellular Differentiation</article-title>. <source>Ieee Transactions on Biomedical Engineering</source> <volume>59</volume> (<issue>2</issue>) <fpage>456</fpage>–<lpage>63</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Uhlendorf1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Uhlendorf</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Miermont</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Delaveau</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Charvin</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Fages</surname><given-names>F</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Long-term model predictive control of gene expression at the population and single-cell levels</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>109</volume>: <fpage>14271</fpage>–<lpage>14276</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-MiliasArgeitis1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Milias-Argeitis</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Summers</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Stewart-Ornstein</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Zuleta</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Pincus</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>In silico feedback for in vivo regulation of a gene expression circuit</article-title>. <source>Nature Biotechnology</source> <volume>29</volume>: <fpage>1114</fpage>–<lpage>1116</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Toettcher1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Toettcher</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Gong</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Lim</surname><given-names>WA</given-names></name>, <name name-style="western"><surname>Weiner</surname><given-names>OD</given-names></name> (<year>2011</year>) <article-title>Light-based feedback for controlling intracellular signaling dynamics</article-title>. <source>Nature Methods</source> <volume>8</volume>: <fpage>837</fpage>–<lpage>U899</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Toettcher2"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Toettcher</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Gong</surname><given-names>DQ</given-names></name>, <name name-style="western"><surname>Lim</surname><given-names>WA</given-names></name>, <name name-style="western"><surname>Weiner</surname><given-names>OD</given-names></name> (<year>2011</year>) <article-title>Light Control of Plasma Membrane Recruitment Using the Phy-Pif System</article-title>. <source>Methods in Enzymology, Vol 497: Synthetic Biology, Methods for Part/Device Characterization and Chassis Engineering, Pt A</source> <volume>497</volume>: <fpage>409</fpage>–<lpage>423</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Menolascina1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Menolascina</surname><given-names>F</given-names></name>, <name name-style="western"><surname>di Bernardo</surname><given-names>M</given-names></name>, <name name-style="western"><surname>di Bernardo</surname><given-names>D</given-names></name> (<year>2011</year>) <article-title>Analysis, design and implementation of a novel scheme for in-vivo control of synthetic gene regulatory networks</article-title>. <source>Automatica</source> <volume>47</volume>: <fpage>1265</fpage>–<lpage>1270</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Sontag1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sontag</surname><given-names>ED</given-names></name> (<year>2005</year>) <article-title>Molecular systems biology and control</article-title>. <source>European Journal of Control</source> <volume>11</volume>: <fpage>396</fpage>–<lpage>435</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Apgar1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Apgar</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Toettcher</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Endy</surname><given-names>D</given-names></name>, <name name-style="western"><surname>White</surname><given-names>FM</given-names></name>, <name name-style="western"><surname>Tidor</surname><given-names>B</given-names></name> (<year>2008</year>) <article-title>Stimulus design for model selection and validation in cell signaling</article-title>. <source>Plos Computational Biology</source> <volume>4</volume>: <fpage>10</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Huang1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huang</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Biegler</surname><given-names>LT</given-names></name> (<year>2009</year>) <article-title>Robust nonlinear model predictive controller design based on multi-scenario formulation</article-title>. <source>2009 American Control Conference</source> <volume>1–9</volume> : <publisher-name>IEEE</publisher-name>. <fpage>2341</fpage>–<lpage>2342</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Falugi1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Falugi</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Olaru</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Dumur</surname><given-names>D</given-names></name> (<year>2010</year>) <article-title>Robust Multi-model Predictive Control Using LMIs</article-title>. <source>International Journal of Control Automation and Systems</source> <volume>8</volume>: <fpage>169</fpage>–<lpage>175</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Rao1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rao</surname><given-names>RR</given-names></name>, <name name-style="western"><surname>Aufderheide</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Bequette</surname><given-names>BW</given-names></name> (<year>2003</year>) <article-title>Experimental studies on multiple-model predictive control for automated regulation of hemodynamic variables</article-title>. <source>Ieee Transactions on Biomedical Engineering</source> <volume>50</volume>: <fpage>277</fpage>–<lpage>288</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-KuureKinsey1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kuure-Kinsey</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Bequette</surname><given-names>BW</given-names></name> (<year>2009</year>) <article-title>Multiple Model Predictive Control of Nonlinear Systems</article-title>. <source>Nonlinear Model Predictive Control: Towards New Challenging Applications</source> <volume>384</volume>: <fpage>153</fpage>–<lpage>165</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Burnham1"><label>26</label>
<mixed-citation publication-type="book" xlink:type="simple">Burnham KP, Anderson DR (2002) Model Selection and Multimodel Inference: A Practical Information-Theoretic Approach. New York: Springer-Verlag.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Dunlop1"><label>27</label>
<mixed-citation publication-type="book" xlink:type="simple">Dunlop MJ, Franco E, Murray RM. A multi-model approach to identification of Biosynthetic pathways; 2007 Jul 09–13; New York, NY. Ieee. pp. 3493–3498.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Krumsiek1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Krumsiek</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Polsterl</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Wittmann</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Theis</surname><given-names>FJ</given-names></name> (<year>2010</year>) <article-title>Odefy - From discrete to continuous models</article-title>. <source>Bmc Bioinformatics</source> <volume>11</volume>: <fpage>10</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Wittmann1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wittmann</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Krumsiek</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Saez-Rodriguez</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Lauffenburger</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Klamt</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Transforming Boolean models to continuous models: methodology and application to T-cell receptor signaling</article-title>. <source>Bmc Systems Biology</source> <volume>3</volume>: <fpage>21</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Noble3"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Noble</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Buzzard</surname><given-names>GT</given-names></name>, <name name-style="western"><surname>Rundell</surname><given-names>AE</given-names></name> (<year>2011</year>) <article-title>Feasible Parameter Space Characterization with Adaptive Sparse Grids for Nonlinear Systems Biology Models</article-title>. <source>2011 American Control Conference</source> <fpage>2909</fpage>–<lpage>2914</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Vogt1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vogt</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Tamewitz</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Skoko</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Sikorski</surname><given-names>RP</given-names></name>, <name name-style="western"><surname>Giuliano</surname><given-names>KA</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>The benzo c phenanthridine alkaloid, sanguinarine, is a selective, cell-active inhibitor of mitogen-activated protein kinase phosphatase-1</article-title>. <source>Journal of Biological Chemistry</source> <volume>280</volume>: <fpage>19078</fpage>–<lpage>19086</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Favata1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Favata</surname><given-names>MF</given-names></name>, <name name-style="western"><surname>Horiuchi</surname><given-names>KY</given-names></name>, <name name-style="western"><surname>Manos</surname><given-names>EJ</given-names></name>, <name name-style="western"><surname>Daulerio</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Stradley</surname><given-names>DA</given-names></name>, <etal>et al</etal>. (<year>1998</year>) <article-title>Identification of a novel inhibitor of mitogen-activated protein kinase kinase</article-title>. <source>Journal of Biological Chemistry</source> <volume>273</volume>: <fpage>18623</fpage>–<lpage>18632</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Zarei1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zarei</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Kamyad</surname><given-names>AV</given-names></name>, <name name-style="western"><surname>Effati</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>Multiobjective Optimal Control of HIV Dynamics</article-title>. <source>Mathematical Problems in Engineering</source> <fpage>29</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1155/2010/568315" xlink:type="simple">10.1155/2010/568315</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003546-Nakayama1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nakayama</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Yun</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Shirakawa</surname><given-names>M</given-names></name> (<year>2010</year>) <article-title>Multi-objective Model Predictive Control</article-title>. <source>Multiple Criteria Decision Making for Sustainable Energy and Transportation Systems: Proceedings of the 19th International Conference on Multiple Criteria Decision Making</source> <volume>634</volume>: <fpage>277</fpage>–<lpage>287</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-DeKeyser1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>DeKeyser</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Peeters</surname><given-names>P</given-names></name> (<year>1996</year>) <article-title>A note on the use of PROMETHEE multicriteria methods</article-title>. <source>European Journal of Operational Research</source> <volume>89</volume>: <fpage>457</fpage>–<lpage>461</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Bemporad1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bemporad</surname><given-names>A</given-names></name>, <name name-style="western"><surname>de la Pena</surname><given-names>DM</given-names></name> (<year>2009</year>) <article-title>Multiobjective model predictive control</article-title>. <source>Automatica</source> <volume>45</volume>: <fpage>2823</fpage>–<lpage>2830</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Steelman1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Steelman</surname><given-names>LS</given-names></name>, <name name-style="western"><surname>Franklin</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Abrams</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Chappell</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Kempf</surname><given-names>CR</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Roles of the Ras/Raf/MEK/ERK pathway in leukemia therapy</article-title>. <source>Leukemia</source> <volume>25</volume>: <fpage>1080</fpage>–<lpage>1094</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Shelton1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shelton</surname><given-names>JG</given-names></name>, <name name-style="western"><surname>Moye</surname><given-names>PW</given-names></name>, <name name-style="western"><surname>Steelman</surname><given-names>LS</given-names></name>, <name name-style="western"><surname>Blalock</surname><given-names>WL</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>JT</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>Differential effects of kinase cascade inhibitors on neoplastic and cytokine-mediated cell proliferation</article-title>. <source>Leukemia</source> <volume>17</volume>: <fpage>1765</fpage>–<lpage>1782</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Lyons1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lyons</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Wilhelm</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Hibner</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Bollag</surname><given-names>G</given-names></name> (<year>2001</year>) <article-title>Discovery of a novel Raf kinase inhibitor</article-title>. <source>Endocrine-Related Cancer</source> <volume>8</volume>: <fpage>219</fpage>–<lpage>225</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Klimke1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Klimke</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Wohlmuth</surname><given-names>B</given-names></name> (<year>2005</year>) <article-title>Algorithm 847: spinterp: Piecewise multilinear hierarchical sparse grid interpolation in MATLAB</article-title>. <source>Acm Transactions on Mathematical Software</source> <volume>31</volume>: <fpage>561</fpage>–<lpage>579</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003546-Messac1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Messac</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Ismail-Yahaya</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Mattson</surname><given-names>CA</given-names></name> (<year>2003</year>) <article-title>The normalized normal constraint method for generating the Pareto frontier</article-title>. <source>Structural and Multidisciplinary Optimization</source> <volume>25</volume>: <fpage>86</fpage>–<lpage>98</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>