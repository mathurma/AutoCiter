<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
  <front>
    <journal-meta>
      <journal-id journal-id-type="publisher-id">plos</journal-id>
      <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
      <journal-id journal-id-type="pmc">ploscomp</journal-id>
      <journal-title-group>
        <journal-title>PLoS Computational Biology</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1553-734X</issn>
      <issn pub-type="epub">1553-7358</issn>
      <publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-00619</article-id>
      <article-id pub-id-type="doi">10.1371/journal.pcbi.1002780</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Developmental biology</subject>
            <subj-group>
              <subject>Morphogenesis</subject>
              <subj-group>
                <subject>Segmentation</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Computer science</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
          <subj-group>
            <subject>Computerized simulations</subject>
          </subj-group>
          <subj-group>
            <subject>Software engineering</subject>
            <subj-group>
              <subject>Software tools</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Engineering</subject>
          <subj-group>
            <subject>Signal processing</subject>
            <subj-group>
              <subject>Image processing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Computer Science</subject>
          <subject>Developmental Biology</subject>
          <subject>Mathematics</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title><italic>ACME: Automated Cell Morphology Extractor</italic> for Comprehensive Reconstruction of Cell Membranes</article-title>
        <alt-title alt-title-type="running-head">Automated Segmentation of Cell Membranes</alt-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Mosaliganti</surname>
            <given-names>Kishore R.</given-names>
          </name>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Noche</surname>
            <given-names>Ramil R.</given-names>
          </name>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Xiong</surname>
            <given-names>Fengzhu</given-names>
          </name>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Swinburne</surname>
            <given-names>Ian A.</given-names>
          </name>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Megason</surname>
            <given-names>Sean G.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1"/>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group>
      <aff id="aff1">
        <addr-line>Department of Systems Biology, Harvard Medical School, Boston, Massachusetts, United States of America</addr-line>
      </aff>
      <contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Murphy</surname>
            <given-names>Robert F.</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group>
      <aff id="edit1">
        <addr-line>Carnegie Mellon University, United States of America</addr-line>
      </aff>
      <author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">megason@hms.harvard.edu</email></corresp>
        <fn fn-type="conflict">
          <p>The authors have declared that no competing interests exist.</p>
        </fn>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: KRM SGM. Performed the experiments: KRM RRN FX. Analyzed the data: KRM. Contributed reagents/materials/analysis tools: IAS. Wrote the paper: KRM SGM.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="collection">
        <month>12</month>
        <year>2012</year>
      </pub-date>
      <pub-date pub-type="epub">
        <day>6</day>
        <month>12</month>
        <year>2012</year>
      </pub-date>
      <volume>8</volume>
      <issue>12</issue>
      <elocation-id>e1002780</elocation-id>
      <history>
        <date date-type="received">
          <day>13</day>
          <month>4</month>
          <year>2012</year>
        </date>
        <date date-type="accepted">
          <day>13</day>
          <month>9</month>
          <year>2012</year>
        </date>
      </history>
      <permissions>
        <copyright-year>2012</copyright-year>
        <copyright-holder>Mosaliganti et al</copyright-holder>
        <license xlink:type="simple">
          <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
        </license>
      </permissions>
      <abstract>
        <p>The quantification of cell shape, cell migration, and cell rearrangements is important for addressing classical questions in developmental biology such as patterning and tissue morphogenesis. Time-lapse microscopic imaging of transgenic embryos expressing fluorescent reporters is the method of choice for tracking morphogenetic changes and establishing cell lineages and fate maps <italic>in vivo</italic>. However, the manual steps involved in curating thousands of putative cell segmentations have been a major bottleneck in the application of these technologies especially for cell membranes. Segmentation of cell membranes while more difficult than nuclear segmentation is necessary for quantifying the relations between changes in cell morphology and morphogenesis. We present a novel and fully automated method to first reconstruct membrane signals and then segment out cells from 3D membrane images even in dense tissues. The approach has three stages: 1) detection of local membrane planes, 2) voting to fill structural gaps, and 3) region segmentation. We demonstrate the superior performance of the algorithms quantitatively on time-lapse confocal and two-photon images of zebrafish neuroectoderm and paraxial mesoderm by comparing its results with those derived from human inspection. We also compared with synthetic microscopic images generated by simulating the process of imaging with fluorescent reporters under varying conditions of noise. Both the over-segmentation and under-segmentation percentages of our method are around 5%. The volume overlap of individual cells, compared to expert manual segmentation, is consistently over 84%. By using our software (ACME) to study somite formation, we were able to segment touching cells with high accuracy and reliably quantify changes in morphogenetic parameters such as cell shape and size, and the arrangement of epithelial and mesenchymal cells. Our software has been developed and tested on Windows, Mac, and Linux platforms and is available publicly under an open source BSD license (<ext-link ext-link-type="uri" xlink:href="https://github.com/krm15/ACME" xlink:type="simple">https://github.com/krm15/ACME</ext-link>).</p>
      </abstract>
      <funding-group>
        <funding-statement>This research was supported by NIH grants P50HG004071 and R01DC010791. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group>
      <counts>
        <page-count count="14"/>
      </counts>
    </article-meta>
  </front>
  <body>
    <sec id="s1">
      <title/>
      <disp-quote>
        <p>This is a <italic>PLoS Computational Biology</italic> Software Article.</p>
      </disp-quote>
    </sec>
    <sec id="s2">
      <title>Introduction</title>
      <p>Pattern formation and tissue morphogenesis are two classical and unsolved problems in developmental biology. Patterning refers to the process by which the embryo generates the right kind of cells at the right place and time. Morphogenesis refers to how tissues are bent and molded to achieve the right shape and form. Modern systems-based approaches to understand these processes <italic>in vivo</italic> involve using advanced imaging techniques to elucidate how mechanisms at multiple spatial scales i.e., molecular networks, single cell behaviors, cell-cell interactions, and tissue mechanics, are coordinated to turn an egg into an embryo <xref ref-type="bibr" rid="pcbi.1002780-Blanchard1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1002780-Megason1">[2]</xref>. By systematically imaging embryos expressing fluorescent proteins with confocal or two-photon microscopy (<italic>in toto</italic> imaging), one can watch events at cellular resolution and then quantitatively model these events inside a computer <xref ref-type="bibr" rid="pcbi.1002780-Megason2">[3]</xref>.</p>
      <p>In toto imaging generates large quantities of images depicting developmental dynamics in the embryo across space and time <xref ref-type="bibr" rid="pcbi.1002780-Megason3">[4]</xref>–<xref ref-type="bibr" rid="pcbi.1002780-Olivier1">[6]</xref>. For example, a confocal or two-photon imaging session can capture three-dimensional images covering a field-of-view of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e001" xlink:type="simple"/></inline-formula> with a spatial sampling of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e002" xlink:type="simple"/></inline-formula> and with a time-sampling rate of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e003" xlink:type="simple"/></inline-formula> minutes over a period of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e004" xlink:type="simple"/></inline-formula> days. The process of imaging consists of irradiating the specimen with laser light focused on successive optical planes in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e005" xlink:type="simple"/></inline-formula>. The useful sampling interval between successive optical planes is limited by the point-spread function (PSF) of the optics leading to worse resolution and thus larger sampling intervals along the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e006" xlink:type="simple"/></inline-formula>-axis in comparison to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e007" xlink:type="simple"/></inline-formula> plane. Such an imaging experiment typically generates 100,000 images per experiment, with about 5000 cells in a given <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e008" xlink:type="simple"/></inline-formula> image and over 100,000 cell tracks and division events in the whole dataset. As a result, automated image analysis techniques are essential for extracting cell kinematic and morphogenetic parameters such as cell shapes, cell trajectories, cell packing, and tissue rearrangement patterns <xref ref-type="bibr" rid="pcbi.1002780-Olivier1">[6]</xref>–<xref ref-type="bibr" rid="pcbi.1002780-Roeder1">[8]</xref>. Automatic extraction needs to be robust since manual curation of errors is laborious even at low error rates for a large field of cells.</p>
      <p>Over the past decade, a number of automated methods were developed for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e009" xlink:type="simple"/></inline-formula> nuclei-specific segmentation including watershed <xref ref-type="bibr" rid="pcbi.1002780-Malpica1">[9]</xref>–<xref ref-type="bibr" rid="pcbi.1002780-Lin1">[11]</xref>, active surface based methods <xref ref-type="bibr" rid="pcbi.1002780-Sarti1">[12]</xref>–<xref ref-type="bibr" rid="pcbi.1002780-Zanella1">[16]</xref> and gradient vector flow methods <xref ref-type="bibr" rid="pcbi.1002780-Li1">[17]</xref>. However, robust segmentation of membranes rather than just nuclei remains a difficult problem. Most techniques for membrane segmentation use nuclear segmentations as seeds for expanding into membranes <xref ref-type="bibr" rid="pcbi.1002780-Sarti1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1002780-Zanella1">[16]</xref>. The reason progress on segmentation algorithms for membrane has lagged behind nuclei is manifold: cell nuclei are better separated; have more consistent and simple shapes; maintain a condensed marker expression, and are more photostable for time-lapse experiments. However, in many situations, nuclear images require additional acquisition overhead and membrane information may be more vital in a study. For example, membranes are pertinent to the analysis of cell behavior and morphogenesis since cell shape and size, and intercellular contact areas can be directly quantified. Thus, there is a compelling need for algorithms that obtain membrane segmentations directly when there are no nuclear images available.</p>
      <p>To address this need, we present a fully automated method with corresponding open-source, cross-platform software (ACME) to reconstruct weak membrane signals for achieving high-quality cell segmentations. We validated our algorithm using synthetically generated images for which ground-truth is known as well as with real images that were manually segmented by an expert. For generating synthetic data, we developed novel simulations of the image acquisition process replete with suitable noise models. Using simulated data, the performance of the algorithm was comprehensively evaluated against different noise conditions. To further demonstrate the utility of our method, we quantified cell shape and size, and the development of epithelial and mesenchymal characteristics in images of the zebrafish presomitic mesoderm. Our algorithm enabled us to quantify differences in the dynamics of cell sub-populations that correlate with the mesenchymal to epithelial differentiation process. Our methods are computationally-efficient, powerful, and widely-applicable to the quantitative analysis of cell dynamics during morphogenesis.</p>
    </sec>
    <sec id="s3">
      <title>Design and Implementation</title>
      <sec id="s3a">
        <title>Membrane signal reconstruction for accurate image segmentation</title>
        <p>Two big challenges with membrane data are the presence of intensity inhomogeneities and punctuated gaps along the three-dimensional boundary. In <xref ref-type="fig" rid="pcbi-1002780-g001">Figure 1(A–C)</xref>, we show a single cell membrane across the three cross-sections of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e010" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e011" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e012" xlink:type="simple"/></inline-formula>. Intensity inhomogeneity (red and blue arrows) can be explained with help of an image formation model for membranes (<xref ref-type="fig" rid="pcbi-1002780-g001">Figure 1(D)</xref>). Here, optical planes (red lines) periodically section a dense cloud of fluorescent proteins tagged to membranes. The point spread function (PSF) of the optics accumulates emissions from a small neighborhood of fluorophores and creates intensity profiles shown in dark red. Mathematically, this is a convolution of the PSF with the fluorophore density function of the sample. The intensity at a voxel is therefore representative of the fluorophore density at the focused region of the tissue. Cell junctions are generally more intense as a result of high spatial concentration of fluorophores arising from the co-localization of multiple membranes. Additionally, membranes that are orthogonal to the imaging planes depict a crisp and bright intensity profile, whereas oblique membranes appear diffuse (observable in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e013" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e014" xlink:type="simple"/></inline-formula> views in <xref ref-type="fig" rid="pcbi-1002780-g001">Figure 1(B–C)</xref>). This is because the PSF, as mentioned before, is shaped similar to an anisotropic Gaussian kernel with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e015" xlink:type="simple"/></inline-formula>. The strength of the output signal is thus dependent on the relative alignment of he membrane and the PSF kernel. Thus, orthogonal membranes present a strong signal because the PSF samples fluorophores in the membrane “above” and “below” the focal plane. For oblique membranes, the space “above” and “below” is non-fluorescing so that output signal is weaker. In the limit, <italic>en-face</italic> membranes, especially those in between imaging planes are often very dim and difficult to detect even by the human eye.</p>
        <fig id="pcbi-1002780-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002780.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Reconstructing the membrane signal by eliminating intensity inhomogeneities.</title>
            <p>A single cell membrane is shown across (A) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e016" xlink:type="simple"/></inline-formula>, (B) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e017" xlink:type="simple"/></inline-formula>, and (C) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e018" xlink:type="simple"/></inline-formula> sections. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e019" xlink:type="simple"/></inline-formula> plane shows a consistently bold and uniform membrane signal while the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e020" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e021" xlink:type="simple"/></inline-formula> views show a non-uniform membrane signal. Membrane planes <italic>en-face</italic> to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e022" xlink:type="simple"/></inline-formula> optical planes (marked by red arrows) are very weak and markedly diffuse in intensity. Membranes orthogonal to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e023" xlink:type="simple"/></inline-formula> imaging plane are sharper (blue arrows). (D) A qualitative model describing the formation of a membrane image under a fluorescent microscope. Flourophores tagged to membranes are shown as a point cloud (input). The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e024" xlink:type="simple"/></inline-formula> focal planes are shown in red and the obtained intensity profiles on the plane are shown as plots. Cell membranes imaged oblique and <italic>en face</italic> such as the interface between cells <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e025" xlink:type="simple"/></inline-formula> are poorly visible in comparison to those orthogonal to the focal planes. (E) Three stages in the reconstruction process: (i) Detect membrane planes by mining for planar fluorophore distributions. This allows even weak membranes (<italic>en-face</italic> or oblique) to be extracted and accounts for intensity inhomogeneity. (ii) Voting to fill structural gaps or holes in the membrane signal that may not be contiguous. (iii) Region segmentation using the watershed algorithm to extract three-dimensional cell meshes for quantification.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002780.g001" position="float" xlink:type="simple"/>
        </fig>
        <p>In order to correct these two problems, we developed signal reconstruction techniques. Our algorithms are inspired by work on vessel-detection from MR and CT imagery in which Hessian-based filters were designed to detect vessels <xref ref-type="bibr" rid="pcbi.1002780-Frangi1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1002780-Manniesing1">[19]</xref>. They used the fact that eigenvectors of the image Hessian point in the directions of principle curvature. At vessel boundaries, the eigenvector with largest eigenvalue is almost normal to the boundary, and the one corresponding to the smallest eigenvalue points along the vessel axis. Here we extend these ideas to planar membrane structures and further improve these results using a voting strategy.</p>
        <p>Our method has three stages (<xref ref-type="fig" rid="pcbi-1002780-g001">Figure 1(E)</xref>): (i) We observe that membranes assume locally linear intensity patterns especially in dense cell regions. This is used to design image processing filters to identify planar intensity formations in images. Automated scale-selection is accomplished by identifying the relative orientation of the membrane planes with a putative Gaussian PSF. (ii) Near inter-cellular junctions and due to image noise, the planarity assumption breaks down causing structural gaps to appear. The identified planar components are then used in a voting framework to fill gaps and eliminate spurious structures. (iii) After reconstructing membrane planes, we use the popular watershed methodology for image segmentation to identify cells.</p>
      </sec>
      <sec id="s3b">
        <title>Planarity detection function for locating membrane planes</title>
        <p>Using our preliminary work in <xref ref-type="bibr" rid="pcbi.1002780-Mosaliganti1">[20]</xref>, we designed an image filter that responds to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e026" xlink:type="simple"/></inline-formula> locally planar intensity structures such as those found in cell membranes and suppresses all other types of intensity patterns. The derived filter is based on the the Hessian matrix (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e027" xlink:type="simple"/></inline-formula>) of the intensity function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e028" xlink:type="simple"/></inline-formula> combined with normalized Gaussian derivatives that provides an aspect of scale. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e029" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e030" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e031" xlink:type="simple"/></inline-formula> be the sorted (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e032" xlink:type="simple"/></inline-formula>) eigenvalues of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e033" xlink:type="simple"/></inline-formula> with corresponding eigenvectors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e034" xlink:type="simple"/></inline-formula>.</p>
        <p>In a local coordinate reference frame placed at a membrane voxel, we are interested in identifying the neighborhood intensity distribution. There are three types of distribution shapes that can be detected: rod, plane and ball (<xref ref-type="fig" rid="pcbi-1002780-g002">Figure 2</xref>). Based on our presentation, it is easy to see that a rod has a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e035" xlink:type="simple"/></inline-formula> change in second derivative of intensity along its axis and maximal change in the cross-sectional plane. Hence, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e036" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e037" xlink:type="simple"/></inline-formula> points along the axis. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e038" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e039" xlink:type="simple"/></inline-formula> lie in the cross-sectional plane with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e040" xlink:type="simple"/></inline-formula>. In the case of a plane, the maximal change in directional second derivative is along the normal and there is no change in the plane. Hence, we have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e041" xlink:type="simple"/></inline-formula> along the normal and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e042" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e043" xlink:type="simple"/></inline-formula> lying on the plane. Correspondingly, the eigenvalues follow the relation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e044" xlink:type="simple"/></inline-formula>. Finally, for a ball (uniform signal), there is no preferential orientation and all directions have the same change of directional second derivatives. Hence, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e045" xlink:type="simple"/></inline-formula>. <xref ref-type="table" rid="pcbi-1002780-t001">Table 1</xref> summarizes these different cases.</p>
        <fig id="pcbi-1002780-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002780.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Tensor decomposition.</title>
            <p>A symbolic illustration of a generic tensor represented in terms of basis tensors of type plane, rod and ball.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002780.g002" position="float" xlink:type="simple"/>
        </fig>
        <table-wrap id="pcbi-1002780-t001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002780.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>Geometric structure classification based on eigen-system.</title>
          </caption>
          <alternatives>
            <graphic id="pcbi-1002780-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002780.t001" xlink:type="simple"/>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Structure</td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e046" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                  <td align="left" rowspan="1" colspan="1">A</td>
                  <td align="left" rowspan="1" colspan="1">B</td>
                  <td align="left" rowspan="1" colspan="1">S</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Foreground</td>
                  <td align="left" rowspan="1" colspan="1">-</td>
                  <td align="left" rowspan="1" colspan="1">-</td>
                  <td align="left" rowspan="1" colspan="1">-</td>
                  <td align="left" rowspan="1" colspan="1">high</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Plane</td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e047" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                  <td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e048" xlink:type="simple"/></inline-formula>1</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">high</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">rod</td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e049" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">high</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Ball</td>
                  <td align="left" rowspan="1" colspan="1">
                    <inline-formula>
                      <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e050" xlink:type="simple"/>
                    </inline-formula>
                  </td>
                  <td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e051" xlink:type="simple"/></inline-formula>1</td>
                  <td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e052" xlink:type="simple"/></inline-formula>1</td>
                  <td align="left" rowspan="1" colspan="1">high</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Background</td>
                  <td align="left" rowspan="1" colspan="1">-</td>
                  <td align="left" rowspan="1" colspan="1">-</td>
                  <td align="left" rowspan="1" colspan="1">-</td>
                  <td align="left" rowspan="1" colspan="1">low</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>An overview of the local intensity structures determined by their eigen-system. Parameters <bold>A</bold>, <bold>B</bold>, and <bold>S</bold> refer to individual terms in the planarity filter (<xref ref-type="disp-formula" rid="pcbi.1002780.e055">Equation 1</xref> and <xref ref-type="disp-formula" rid="pcbi.1002780.e056">2</xref>). These terms are specified as ratios of individual eigenvalues to enhance the identification of planes relative to rods and ball structure classes.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>In order to detect membrane structures, we want to selectively identify pixels that belong to a plane distribution rather than a ball or a rod. Hence, we define the <italic>planarity</italic> of a voxel <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e053" xlink:type="simple"/></inline-formula> as the similarity of the local neighborhood <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e054" xlink:type="simple"/></inline-formula> to a plane-like structure, as:<disp-formula id="pcbi.1002780.e055"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002780.e055" xlink:type="simple"/><label>(1)</label></disp-formula><disp-formula id="pcbi.1002780.e056"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002780.e056" xlink:type="simple"/><label>(2)</label></disp-formula></p>
        <p>Here, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e057" xlink:type="simple"/></inline-formula> with larger values indicating more similarity to a plane at regularization scale <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e058" xlink:type="simple"/></inline-formula>. The free parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e059" xlink:type="simple"/></inline-formula> are set to 1 in our experiments and code but may be fine-tuned depending on the specifics of the imaging modality. For the case of bright membranes on a dark background, a positive <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e060" xlink:type="simple"/></inline-formula> denotes background and hence the planarity output is set directly to 0. We now explain how background voxels and voxels corresponding to the rod and ball forms are suppressed by design:</p>
        <list list-type="order">
          <list-item>
            <p><italic>Foreground vs. background:</italic> If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e061" xlink:type="simple"/></inline-formula>, it indicates image background with minor variations due to noise. This case is quantified by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e062" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e063" xlink:type="simple"/></inline-formula> controls the smallest acceptable scale. In membrane locations, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e064" xlink:type="simple"/></inline-formula> and hence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e065" xlink:type="simple"/></inline-formula>. In contrast, background regions have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e066" xlink:type="simple"/></inline-formula> and hence, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e067" xlink:type="simple"/></inline-formula>.</p>
          </list-item>
          <list-item>
            <p><italic>Plane vs rod:</italic> The parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e068" xlink:type="simple"/></inline-formula> measures the ratio of the largest pair of eigenvalues. It is close to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e069" xlink:type="simple"/></inline-formula> for a plane and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e070" xlink:type="simple"/></inline-formula> for a rod. Hence, the negative exponential function selectively prefers the plane to a rod.</p>
          </list-item>
          <list-item>
            <p><italic>Plane vs ball:</italic> The term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e071" xlink:type="simple"/></inline-formula> measures the ratio of the smaller pair of eigenvalues with the largest one. It is close to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e072" xlink:type="simple"/></inline-formula> for a plane and in turn, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e073" xlink:type="simple"/></inline-formula> has values closer to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e074" xlink:type="simple"/></inline-formula>. Note that for a ball, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e075" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e076" xlink:type="simple"/></inline-formula> as a result.</p>
          </list-item>
          <list-item>
            <p><italic>Smooth Plane:</italic> In order for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e077" xlink:type="simple"/></inline-formula> to be a smooth function around the origin (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e078" xlink:type="simple"/></inline-formula>) and robust to noise, we add a fourth term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e079" xlink:type="simple"/></inline-formula> that selectively picks up voxels that have a relatively large <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e080" xlink:type="simple"/></inline-formula> value compared to a small value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e081" xlink:type="simple"/></inline-formula>. When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e082" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e083" xlink:type="simple"/></inline-formula> evaluates to 0.</p>
          </list-item>
        </list>
        <p>A heat map of the sampled function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e084" xlink:type="simple"/></inline-formula> in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e085" xlink:type="simple"/></inline-formula> space with all free parameters set to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e086" xlink:type="simple"/></inline-formula> is shown (<xref ref-type="fig" rid="pcbi-1002780-g003">Figure 3</xref>). Since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e087" xlink:type="simple"/></inline-formula> is a three dimensional function defined on (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e088" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e089" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e090" xlink:type="simple"/></inline-formula>), we show a single <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e091" xlink:type="simple"/></inline-formula> cross-section at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e092" xlink:type="simple"/></inline-formula>. In the figure, high filter response corresponds to voxels having a plane form alone (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e093" xlink:type="simple"/></inline-formula>), while background voxels and voxels corresponding to the rod and ball forms are suppressed.</p>
        <fig id="pcbi-1002780-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002780.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Planarity response function.</title>
            <p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e094" xlink:type="simple"/></inline-formula> is computed for different values of (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e095" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e096" xlink:type="simple"/></inline-formula>) and for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e097" xlink:type="simple"/></inline-formula> and free parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e098" xlink:type="simple"/></inline-formula> set to 1. The function response shows high values for voxels having <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e099" xlink:type="simple"/></inline-formula> values characteristic of planar arrangements alone.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002780.g003" position="float" xlink:type="simple"/>
        </fig>
        <p>Earlier, we described how membranes have crisp or diffuse profiles depending on their orientation with respect to the optical planes (<xref ref-type="fig" rid="pcbi-1002780-g001">Figure 1</xref>). In an ideal situation, the PSF is an impulse-response and the membrane plane is infinitesimally thin and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e100" xlink:type="simple"/></inline-formula> is sufficient for its detection. However, this ideal is not achievable in optical microscopes. So, we model the PSF as an anisotropic Gaussian kernel (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e101" xlink:type="simple"/></inline-formula>). The signal for an orthogonal membrane is contained in a small band of pixels as opposed to an <italic>en-face</italic> membrane which is diffused farther out. Thus, the scale of Hessian computation (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e102" xlink:type="simple"/></inline-formula>) needs to adapt depending on membrane orientation. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e103" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e104" xlink:type="simple"/></inline-formula> represent the optimal scales for orthogonal and <italic>en-face</italic> membranes with respect to the optical plane with normal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e105" xlink:type="simple"/></inline-formula> (a unit vector along the optical axis). The normal orientation of membranes locally is given by the eigenvector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e106" xlink:type="simple"/></inline-formula>, as per our convention. Therefore, we automatically determine scale as:<disp-formula id="pcbi.1002780.e107"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002780.e107" xlink:type="simple"/><label>(3)</label></disp-formula></p>
        <p>The dot product of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e108" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e109" xlink:type="simple"/></inline-formula> returns the cosine of the angle between the optical axis and the largest principal components, so <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e110" xlink:type="simple"/></inline-formula> if they are orthogonal and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e111" xlink:type="simple"/></inline-formula> if they are parallel. In our case, for a orthogonal membrane we set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e112" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e113" xlink:type="simple"/></inline-formula>, which makes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e114" xlink:type="simple"/></inline-formula>. To first determine membrane orientations (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e115" xlink:type="simple"/></inline-formula> in the above formula), we use a blind scale determined by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e116" xlink:type="simple"/></inline-formula> to compute <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e117" xlink:type="simple"/></inline-formula>.</p>
        <p>In <xref ref-type="fig" rid="pcbi-1002780-g004">Figure 4</xref>, we show a three-dimensional result of applying the planarity function on raw data (a–d). The result (e–g) is displayed along orthogonal sections in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e118" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e119" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e120" xlink:type="simple"/></inline-formula> respectively. The last column is a detailed view of the first column of images. We identify membrane voxels inspite of severe intensity inhomogeneities and noise. The image center shows cells in the notochord region which have a very weak intensity profile but were uniformly identified by our method. Local variations of membrane intensities due to orientation differences with the optical planes are also compensated. This can be seen in the orthogonal planes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e121" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e122" xlink:type="simple"/></inline-formula>, where membrane structures are well-reconstructed. Upon zooming in at a high resolution in (h), we spot several gaps in the membrane structure especially near membrane junctions. At these locations, the intensity structure ceases to be of planar distribution. In some locations, planar noise patterns create false positives in detection. In order to eliminate these spurious structures and reconstruct membranes alone, we use the tensor voting framework to build on the output of the planarity filter.</p>
        <fig id="pcbi-1002780-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002780.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>High-fidelity reconstruction of zebrafish membrane images.</title>
            <p>Significant improvement in membrane signal quality is shown in XY, XZ and YZ planes. (A–D) Raw data showing dorsal view (anterior on top) of zebrafish neuroepithelium (ne) and notochord at 12 hpf, (E–H) Planarity function intermediate output and (I–L) Tensor voting final output. The last image in each panel shows a color-mapped zoomed view for easy comparison.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002780.g004" position="float" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s3c">
        <title>Tensor voting to fill structural gaps in membrane data</title>
        <p>The principle of tensor voting is that image voxels vote in their surrounding neighborhood to propagate information about the presence of a surface passing through them <xref ref-type="bibr" rid="pcbi.1002780-Guy1">[21]</xref>, <xref ref-type="bibr" rid="pcbi.1002780-Medioni1">[22]</xref>. At each voxel, votes are cast and accumulated in a local neighborhood. The basic idea behind this process is that if a set of unconnected voxels exists on a geometric surface oblivious of each other, then by voting each voxel develops a sense of direction and affiliation. Thereafter, the surface boundary can be automatically extracted by a region segmentation procedure such as the watershed. The geometric surface in our context refers to the membrane planes.</p>
        <p>The application of tensor voting to membrane images has previously been considered. Loss and colleagues developed an iterative extension of the tensor voting framework to demonstrate its application on low fidelity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e123" xlink:type="simple"/></inline-formula> membrane images <xref ref-type="bibr" rid="pcbi.1002780-Loss1">[23]</xref>. Although, tensor voting methods are parameter-free, they are computationally expensive and do not scale well with large image sizes. The iterative extension exacerbates the computational cost. In our case, the accurate detection via the planarity filter provided to the tensor framework eliminates the need for iterative methods. In another extension, Parvin <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1002780-Parvin1">[24]</xref> developed an iterative voting system that employs tunable kernels to refine paths of low curvature in images. Given the short nature of membrane segments, we do not consider the iterative extension here.</p>
        <p>There are three stages of the tensor voting process: (i) initialize a tensor image, (ii) cast and accumulate votes at each voxel, and (iii) extract membrane saliency image.</p>
        <sec id="s3c1">
          <title>Initialize a tensor image</title>
          <p>First, a tensor image <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e124" xlink:type="simple"/></inline-formula> is constructed to represent the affiliation to a geometric surface at each voxel and the corresponding direction of its surface-normal. Each voxel (position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e125" xlink:type="simple"/></inline-formula>) is mathematically represented as a second-order tensor encoding the magnitude as eigenvalues (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e126" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e127" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e128" xlink:type="simple"/></inline-formula>) and corresponding eigen directions (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e129" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e130" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e131" xlink:type="simple"/></inline-formula>). The tensor is a symmetric and non-negative (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e132" xlink:type="simple"/></inline-formula>) matrix and can be written as:<disp-formula id="pcbi.1002780.e133"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002780.e133" xlink:type="simple"/><label>(4)</label></disp-formula></p>
          <p>In a local coordinate system at each voxel, there are three possible geometric structures that can pass through a voxel namely, a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e134" xlink:type="simple"/></inline-formula> ball, a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e135" xlink:type="simple"/></inline-formula> rod, and a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e136" xlink:type="simple"/></inline-formula> plane. Thus, the tensors encode the contributions of the three forms in terms of their normals as follows:<disp-formula id="pcbi.1002780.e137"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002780.e137" xlink:type="simple"/><label>(5)</label></disp-formula><disp-formula id="pcbi.1002780.e138"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002780.e138" xlink:type="simple"/><label>(6)</label></disp-formula></p>
          <p>In the above equation, a plane is encoded as the inner-product of its normal (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e139" xlink:type="simple"/></inline-formula>), a rod by the inner-product of two normals spanning its cross-section (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e140" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e141" xlink:type="simple"/></inline-formula>), and a ball by the inner-products of all directions (<xref ref-type="fig" rid="pcbi-1002780-g002">Figure 2</xref>). The coefficients <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e142" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e143" xlink:type="simple"/></inline-formula>, and (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e144" xlink:type="simple"/></inline-formula>) represent the saliency of each geometric structure. At the end of the voting process, we expect membrane voxels to contain high plane saliency <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e145" xlink:type="simple"/></inline-formula> and low saliencies for the rod and ball structures.</p>
          <p>To construct a tensor image <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e146" xlink:type="simple"/></inline-formula>, we initialize all voxels as follows: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e147" xlink:type="simple"/></inline-formula> = <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e148" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e149" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e150" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e151" xlink:type="simple"/></inline-formula>. Here, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e152" xlink:type="simple"/></inline-formula> refers to the output of the planarity filter described in the previous section. Therefore, all identified voxels get encoded as plane tensors with high saliencies and directions same as the image Hessian. By substituting in <xref ref-type="disp-formula" rid="pcbi.1002780.e137">Equation 5</xref>, we get the input token image (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e153" xlink:type="simple"/></inline-formula>) as:<disp-formula id="pcbi.1002780.e154"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002780.e154" xlink:type="simple"/><label>(7)</label></disp-formula></p>
        </sec>
        <sec id="s3c2">
          <title>Cast and accumulate votes</title>
          <p>Once the initial token image <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e155" xlink:type="simple"/></inline-formula> is defined, the next step is the voting step wherein each voxel influences its neighbors in the output image <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e156" xlink:type="simple"/></inline-formula> based on a scale parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e157" xlink:type="simple"/></inline-formula>. The vote <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e158" xlink:type="simple"/></inline-formula> from a voxel <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e159" xlink:type="simple"/></inline-formula> to another voxel <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e160" xlink:type="simple"/></inline-formula> consists of a modified version of the encode tensor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e161" xlink:type="simple"/></inline-formula>. The modification consists of a distance-dependent attenuation of magnitude and transformed orientation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e162" xlink:type="simple"/></inline-formula>. The attenuation in magnitude is motivated by the fact that a voxel's influence should progressively decay in the neighborhood based on its distance from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e163" xlink:type="simple"/></inline-formula>. The rotation is motivated by the fact that voting should be cognizant of the curvilinear surface each voxel is affiliated to.</p>
          <p>The construction of a plane voting field describing the rotation is given in Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002780.s007">Text S1</xref> (Section 1 and Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002780.s003">Figure S1</xref>) and review articles <xref ref-type="bibr" rid="pcbi.1002780-Guy1">[21]</xref>, <xref ref-type="bibr" rid="pcbi.1002780-Medioni1">[22]</xref>. By using this voting field as a lookup table, the votes from each voxel <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e164" xlink:type="simple"/></inline-formula> in the input image <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e165" xlink:type="simple"/></inline-formula> to its neighborhood in the output image <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e166" xlink:type="simple"/></inline-formula> is efficiently computed. There is a single free parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e167" xlink:type="simple"/></inline-formula> that defines the size of the voting neighborhood window <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e168" xlink:type="simple"/></inline-formula>.<disp-formula id="pcbi.1002780.e169"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002780.e169" xlink:type="simple"/><label>(8)</label></disp-formula></p>
        </sec>
        <sec id="s3c3">
          <title>Extract membrane saliency image</title>
          <p>We earlier mentioned that the identified voxels in the planarity output belong to either spurious structures generated by noise or lie on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e170" xlink:type="simple"/></inline-formula> membrane planes. The output of the voting step increases the affiliation (or saliency) of the voxels on the membrane planes and reduces stand-alone or disconnected structures to low saliency values. The output image <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e171" xlink:type="simple"/></inline-formula> is once again decomposed to its geometric forms using <xref ref-type="disp-formula" rid="pcbi.1002780.e137">Equation 5</xref> and the plane coefficients <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e172" xlink:type="simple"/></inline-formula> are extracted. This represents the final membrane reconstruction to be used as a topographic map for the watershed algorithm.</p>
          <p><xref ref-type="fig" rid="pcbi-1002780-g004">Figure 4</xref> shows the reconstructed membrane profile (I–L) given the planarity function input in (E–H). As before, we show the profiles in all three cross-sections of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e173" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e174" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e175" xlink:type="simple"/></inline-formula> and a zoomed image respectively. It is easy to observe the high quality of reconstruction profiles especially in the zoomed image showing thin and narrow cells. Junctions were smoothly reconstructed and gaps in the structure were eliminated. Spurious formations were also eliminated by the voting process. There is no intensity inhomogeneities present which now make it straight-forward to perform image analysis tasks such as segmentation and shape analysis. We have chosen to focus here on the planar tensor component because our intent is cell membrane segmentation and analysis of morphology, but a similar approach could be used to reconstruct rod-like structures such as microtubules and microfilaments using our code.</p>
        </sec>
      </sec>
      <sec id="s3d">
        <title>Membrane segmentation using watershed algorithm on reconstructed images</title>
        <p>We use the watershed algorithm for obtaining high quality segmentations once the reconstruction procedure is completed <xref ref-type="bibr" rid="pcbi.1002780-Lin1">[11]</xref>. We use the saliency images generated from tensor voting as topographic maps in the watershed procedure. The saliency image results from the votes of tensors oriented along the membranes thereby causing a very rapid change in values normal to the membrane. <xref ref-type="fig" rid="pcbi-1002780-g005">Figure 5</xref> shows the resulting cell segmentations obtained from using our new approach on two timepoints of noisy membrane data. The output of the high-quality reconstructed membrane signal is shown in the orthogonal image planes. A step-wise graphical overview of the complete segmentation process is provided in Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002780.s004">Figure S2</xref>.</p>
        <fig id="pcbi-1002780-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002780.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Robust reconstruction and segmentation of cells in the presomitic mesoderm.</title>
            <p>(A–C) Raw image data showing presomitic mesoderm on 2D image planes (XY,YZ, and XZ) at 3ss. (D–F) Segmentation meshes overlaid on reconstructed membrane images demonstrate excellent localization. Each mesh was randomly colored for visually separating adjacent cells easily. (G,H) 3D rendering of membrane segmentations at 3ss and 5ss. Somites 3, 4 and 5 at 5ss are formed from the presomitic tissue at 3ss by cell sorting and rearrangement.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002780.g005" position="float" xlink:type="simple"/>
        </fig>
      </sec>
    </sec>
    <sec id="s4">
      <title>Results</title>
      <p>In order to validate our segmentation results, we quantified segmentation accuracy on synthetic images where ground truth is known and on real images manually segmented by experts using four metrics: average volume overlap (Dice), average L2 Hausdorff distance, over-segmentation and under-segmentation rates. The Dice coefficient for measuring volume overlap between the automated results and the ground truth for a single cell is defined as:<disp-formula id="pcbi.1002780.e176"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002780.e176" xlink:type="simple"/><label>(9)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e177" xlink:type="simple"/></inline-formula> is the automated extracted region and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e178" xlink:type="simple"/></inline-formula> is the ground truth region. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e179" xlink:type="simple"/></inline-formula> operator takes the intersection of two regions while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e180" xlink:type="simple"/></inline-formula> takes the union of regions. The L2 Hausdorff distance (in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e181" xlink:type="simple"/></inline-formula>m) refers to farthest separation of closest boundary points between the two segmentations <xref ref-type="bibr" rid="pcbi.1002780-Rockafellar1">[25]</xref>. In other words, it is the error in localizing the true border between two cells due to distortions in the object morphology. The over-segmentation measure indicates that a cell has been separated into more than one object, or an extracted object has not been labeled as cell. The under-segmentation measure indicates that clusters of cell have not been appropriately divided or a true cell was not at all extracted (<xref ref-type="fig" rid="pcbi-1002780-g006">Figure 6G</xref>).</p>
      <fig id="pcbi-1002780-g006" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002780.g006</object-id>
        <label>Figure 6</label>
        <caption>
          <title>Accurate and highly-sensitive algorithm performance on synthesized 3D membrane images.</title>
          <p>(A–C) Synthesized cell structures in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e182" xlink:type="simple"/></inline-formula> along <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e183" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e184" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e185" xlink:type="simple"/></inline-formula> sections with image noise added (<xref ref-type="table" rid="pcbi-1002780-t002">Table 2</xref>). As in the case of real-world images, the lateral resolution significantly differs from the axial resolution. (D–F) Segmentations overlaid on the raw image with a 50% opacity function. (G) An example of under-segmentation (brown cells, black arrows) and over-segmentation (interstitial fragments, white arrows) in the image. The errors could be filtered out by size criteria.</p>
        </caption>
        <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002780.g006" position="float" xlink:type="simple"/>
      </fig>
      <p>In <xref ref-type="table" rid="pcbi-1002780-t002">Tables 2</xref> and <xref ref-type="table" rid="pcbi-1002780-t003">3</xref>, a total of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e186" xlink:type="simple"/></inline-formula> pairs of manual (of total of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e187" xlink:type="simple"/></inline-formula> labels) and automated segmentation labels (of total of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e188" xlink:type="simple"/></inline-formula> labels) were first matched by checking for overlap larger than 0.75. The average volume overlap (Overlap) and L2 Hausdorff metric (Encroach) was computed across all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e189" xlink:type="simple"/></inline-formula> matched pairs. Manual segmentation labels that remained unmatched were classied as over-segmentation (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e190" xlink:type="simple"/></inline-formula>) or under-segmentation (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e191" xlink:type="simple"/></inline-formula>) labels. We define an over-segmentation instance when a manual label overlaps with multiple automated labels. Under-segmentation is when two manual labels are output as a single automated label. However, there is a scope for complex error types to be present. For example, an automated label may undersegment two manual labels but participate in the over-segmentation of a different manual label. To be consistent, over-segmentation is when a manual label has no more than 75% of its area overlapping with any automated label (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e192" xlink:type="simple"/></inline-formula>), else it is an under-segmentation label. Based on these classifications, we measured the precision and recall of the automated procedure. Precision measures the fraction of correctly identified cells from the automatically segmented set of cells (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e193" xlink:type="simple"/></inline-formula>), so measures false negatives. Recall measures the fraction of correctly identified cells from the number of manually segmented cells (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e194" xlink:type="simple"/></inline-formula>) so measures false positives.</p>
      <table-wrap id="pcbi-1002780-t002" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002780.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>High sensitivity in algorithm performance on synthetic data with varying noise parameters.</title>
        </caption>
        <alternatives>
          <graphic id="pcbi-1002780-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002780.t002" xlink:type="simple"/>
          <table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Data</td>
                <td align="left" rowspan="1" colspan="1">(<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e195" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e196" xlink:type="simple"/></inline-formula>)</td>
                <td align="left" rowspan="1" colspan="1">#Cells</td>
                <td align="left" rowspan="1" colspan="1">U</td>
                <td align="left" rowspan="1" colspan="1">O</td>
                <td align="left" rowspan="1" colspan="1">M</td>
                <td align="left" rowspan="1" colspan="1">Dice</td>
                <td align="left" rowspan="1" colspan="1">Encroach</td>
                <td align="left" rowspan="1" colspan="1">Prec.</td>
                <td align="left" rowspan="1" colspan="1">Recall</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">(0.01, 1.0)</td>
                <td align="left" rowspan="1" colspan="1">1000</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">1000</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
                <td align="left" rowspan="1" colspan="1">0.25</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">(0.02, 0.9)</td>
                <td align="left" rowspan="1" colspan="1">1000</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">1000</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">0.27</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">(0.03, 0.8)</td>
                <td align="left" rowspan="1" colspan="1">1000</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">1000</td>
                <td align="left" rowspan="1" colspan="1">0.94</td>
                <td align="left" rowspan="1" colspan="1">0.35</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">(0.04, 0.7)</td>
                <td align="left" rowspan="1" colspan="1">1005</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">1000</td>
                <td align="left" rowspan="1" colspan="1">0.92</td>
                <td align="left" rowspan="1" colspan="1">0.47</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
                <td align="left" rowspan="1" colspan="1">1.0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">(0.05, 0.6)</td>
                <td align="left" rowspan="1" colspan="1">1010</td>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">12</td>
                <td align="left" rowspan="1" colspan="1">998</td>
                <td align="left" rowspan="1" colspan="1">0.91</td>
                <td align="left" rowspan="1" colspan="1">0.52</td>
                <td align="left" rowspan="1" colspan="1">0.98</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">6</td>
                <td align="left" rowspan="1" colspan="1">(0.06, 0.5)</td>
                <td align="left" rowspan="1" colspan="1">1021</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">25</td>
                <td align="left" rowspan="1" colspan="1">996</td>
                <td align="left" rowspan="1" colspan="1">0.89</td>
                <td align="left" rowspan="1" colspan="1">0.70</td>
                <td align="left" rowspan="1" colspan="1">0.97</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">7</td>
                <td align="left" rowspan="1" colspan="1">(0.07, 0.4)</td>
                <td align="left" rowspan="1" colspan="1">1027</td>
                <td align="left" rowspan="1" colspan="1">6</td>
                <td align="left" rowspan="1" colspan="1">33</td>
                <td align="left" rowspan="1" colspan="1">994</td>
                <td align="left" rowspan="1" colspan="1">0.87</td>
                <td align="left" rowspan="1" colspan="1">0.85</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">8</td>
                <td align="left" rowspan="1" colspan="1">(0.08, 0.3)</td>
                <td align="left" rowspan="1" colspan="1">1032</td>
                <td align="left" rowspan="1" colspan="1">8</td>
                <td align="left" rowspan="1" colspan="1">40</td>
                <td align="left" rowspan="1" colspan="1">992</td>
                <td align="left" rowspan="1" colspan="1">0.87</td>
                <td align="left" rowspan="1" colspan="1">1.11</td>
                <td align="left" rowspan="1" colspan="1">0.96</td>
                <td align="left" rowspan="1" colspan="1">0.99</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">9</td>
                <td align="left" rowspan="1" colspan="1">(0.09, 0.2)</td>
                <td align="left" rowspan="1" colspan="1">1033</td>
                <td align="left" rowspan="1" colspan="1">11</td>
                <td align="left" rowspan="1" colspan="1">44</td>
                <td align="left" rowspan="1" colspan="1">989</td>
                <td align="left" rowspan="1" colspan="1">0.86</td>
                <td align="left" rowspan="1" colspan="1">1.31</td>
                <td align="left" rowspan="1" colspan="1">0.95</td>
                <td align="left" rowspan="1" colspan="1">0.98</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">10</td>
                <td align="left" rowspan="1" colspan="1">(0.1, 0.1)</td>
                <td align="left" rowspan="1" colspan="1">1038</td>
                <td align="left" rowspan="1" colspan="1">16</td>
                <td align="left" rowspan="1" colspan="1">54</td>
                <td align="left" rowspan="1" colspan="1">984</td>
                <td align="left" rowspan="1" colspan="1">0.84</td>
                <td align="left" rowspan="1" colspan="1">1.42</td>
                <td align="left" rowspan="1" colspan="1">0.94</td>
                <td align="left" rowspan="1" colspan="1">0.98</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt102">
            <label/>
            <p>Algorithm performance was measured against ten synthetic datasets with progressively higher noise parameters (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e197" xlink:type="simple"/></inline-formula>,<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e198" xlink:type="simple"/></inline-formula>) and increasing cell number. <bold>Dice</bold> refers to the area of overlap between ground-truth and automated segmentations. <bold>U</bold>, <bold>O</bold>, and <bold>M</bold> list the number of cells that were undersegmented, oversegmented, and matched respectively. <bold>Encroachment</bold> measures the average L2 Hausdorff displacement of the cell boundaries (a lower value is better). <bold>Precision</bold> measures the fraction of correctly identified cells from the automatically segmented set of cells. <bold>Recall</bold> measures the fraction of correctly identified cells from the manually segmented set of cells. The algorithm recorded a precision of at least 94%, recall of at least 98%, and an volume overlap of at least 84% even with high levels of noise, thereby indicating an accurate performance of the method.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap id="pcbi-1002780-t003" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002780.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Robust correspondence of automated segmentations with manually segmented zebrafish membrane images.</title>
        </caption>
        <alternatives>
          <graphic id="pcbi-1002780-t003-3" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002780.t003" xlink:type="simple"/>
          <table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Dataset</td>
                <td align="left" rowspan="1" colspan="1">#Cells</td>
                <td align="left" rowspan="1" colspan="1">Algorithm</td>
                <td align="left" rowspan="1" colspan="1">O</td>
                <td align="left" rowspan="1" colspan="1">U</td>
                <td align="left" rowspan="1" colspan="1">M</td>
                <td align="left" rowspan="1" colspan="1">Dice</td>
                <td align="left" rowspan="1" colspan="1">Encroach</td>
                <td align="left" rowspan="1" colspan="1">Precision</td>
                <td align="left" rowspan="1" colspan="1">Recall</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">6</td>
                <td align="left" rowspan="1" colspan="1">9</td>
                <td align="left" rowspan="1" colspan="1">37</td>
                <td align="left" rowspan="1" colspan="1">0.88</td>
                <td align="left" rowspan="1" colspan="1">0.45</td>
                <td align="left" rowspan="1" colspan="1">0.63</td>
                <td align="left" rowspan="1" colspan="1">0.71</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">52</td>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">45</td>
                <td align="left" rowspan="1" colspan="1">0.91</td>
                <td align="left" rowspan="1" colspan="1">0.39</td>
                <td align="left" rowspan="1" colspan="1">0.81</td>
                <td align="left" rowspan="1" colspan="1">0.86</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">48</td>
                <td align="left" rowspan="1" colspan="1">0.93</td>
                <td align="left" rowspan="1" colspan="1">0.21</td>
                <td align="left" rowspan="1" colspan="1">0.88</td>
                <td align="left" rowspan="1" colspan="1">0.92</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">8</td>
                <td align="left" rowspan="1" colspan="1">7</td>
                <td align="left" rowspan="1" colspan="1">43</td>
                <td align="left" rowspan="1" colspan="1">0.90</td>
                <td align="left" rowspan="1" colspan="1">0.37</td>
                <td align="left" rowspan="1" colspan="1">0.65</td>
                <td align="left" rowspan="1" colspan="1">0.74</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">58</td>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">51</td>
                <td align="left" rowspan="1" colspan="1">0.92</td>
                <td align="left" rowspan="1" colspan="1">0.41</td>
                <td align="left" rowspan="1" colspan="1">0.82</td>
                <td align="left" rowspan="1" colspan="1">0.87</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">53</td>
                <td align="left" rowspan="1" colspan="1">0.94</td>
                <td align="left" rowspan="1" colspan="1">0.28</td>
                <td align="left" rowspan="1" colspan="1">0.89</td>
                <td align="left" rowspan="1" colspan="1">0.91</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">7</td>
                <td align="left" rowspan="1" colspan="1">8</td>
                <td align="left" rowspan="1" colspan="1">47</td>
                <td align="left" rowspan="1" colspan="1">0.87</td>
                <td align="left" rowspan="1" colspan="1">0.52</td>
                <td align="left" rowspan="1" colspan="1">0.68</td>
                <td align="left" rowspan="1" colspan="1">0.75</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">62</td>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">55</td>
                <td align="left" rowspan="1" colspan="1">0.90</td>
                <td align="left" rowspan="1" colspan="1">0.47</td>
                <td align="left" rowspan="1" colspan="1">0.83</td>
                <td align="left" rowspan="1" colspan="1">0.88</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">58</td>
                <td align="left" rowspan="1" colspan="1">0.91</td>
                <td align="left" rowspan="1" colspan="1">0.31</td>
                <td align="left" rowspan="1" colspan="1">0.90</td>
                <td align="left" rowspan="1" colspan="1">0.93</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">10</td>
                <td align="left" rowspan="1" colspan="1">12</td>
                <td align="left" rowspan="1" colspan="1">42</td>
                <td align="left" rowspan="1" colspan="1">0.91</td>
                <td align="left" rowspan="1" colspan="1">0.42</td>
                <td align="left" rowspan="1" colspan="1">0.56</td>
                <td align="left" rowspan="1" colspan="1">0.65</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">64</td>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">7</td>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">52</td>
                <td align="left" rowspan="1" colspan="1">0.91</td>
                <td align="left" rowspan="1" colspan="1">0.41</td>
                <td align="left" rowspan="1" colspan="1">0.73</td>
                <td align="left" rowspan="1" colspan="1">0.81</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">59</td>
                <td align="left" rowspan="1" colspan="1">0.95</td>
                <td align="left" rowspan="1" colspan="1">0.29</td>
                <td align="left" rowspan="1" colspan="1">0.88</td>
                <td align="left" rowspan="1" colspan="1">0.92</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">13.06%</td>
                <td align="left" rowspan="1" colspan="1">13.48%</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">0.89</td>
                <td align="left" rowspan="1" colspan="1">0.44</td>
                <td align="left" rowspan="1" colspan="1">0.63</td>
                <td align="left" rowspan="1" colspan="1">0.71</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Average</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">7.51%</td>
                <td align="left" rowspan="1" colspan="1">5.92%</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">0.91</td>
                <td align="left" rowspan="1" colspan="1">0.42</td>
                <td align="left" rowspan="1" colspan="1">0.79</td>
                <td align="left" rowspan="1" colspan="1">0.85</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">4.66%</td>
                <td align="left" rowspan="1" colspan="1">3.3%</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">0.93</td>
                <td align="left" rowspan="1" colspan="1">0.27</td>
                <td align="left" rowspan="1" colspan="1">0.89</td>
                <td align="left" rowspan="1" colspan="1">0.92</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt103">
            <label/>
            <p>Automated algorithm performance was measured against manually-segmented membrane images of the zebrafish presomitic mesoderm from four different time-points. The proposed algorithm 3 recorded an average precision of 89%, average recall of 92%, average encroachment of 0.27 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e199" xlink:type="simple"/></inline-formula>m, and average volume overlap of 93%, thereby indicating an accurate performance of the method. Moreover, algorithm 3 consistently performed better than the basic watershed procedures (algorithms 1 and 2) across all the chosen metrics indicating the utility of the reconstruction procedure in improving algorithm performance.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <sec id="s4a">
        <title>High sensitivity as demonstrated by performance on synthesized <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e200" xlink:type="simple"/></inline-formula> membrane images</title>
        <p>Since there is no gold standard available for evaluating algorithm performance, we synthesized <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e201" xlink:type="simple"/></inline-formula> membrane images based on an image formation model that simulates confocal microscopy of membrane labeled embryos (Supplementary Section S3 and Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002780.s005">Figure S3</xref>). The advantage of using synthetic images is that ground-truth is exactly known and different imaging parameters can be rapidly tested. A spectrum of ten images with varying noise parameters was generated for comparison, and the performance of the algorithm is described in <xref ref-type="table" rid="pcbi-1002780-t002">Table 2</xref>. Despite the fact that cells are tightly-packed and large additive noise is present, the proposed method reconstructs membranes and segments the touching cells with high precision. <xref ref-type="fig" rid="pcbi-1002780-g006">Figure 6(A–C)</xref> shows an example of a synthesized <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e202" xlink:type="simple"/></inline-formula> membrane image containing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e203" xlink:type="simple"/></inline-formula> cells with the corresponding segmentation results shown in <xref ref-type="fig" rid="pcbi-1002780-g006">Figure 6(D–F)</xref>. The performance of the algorithm steadily degraded for higher levels of noise as expected. It was observed that in the worst case, we obtained a precision of 94% and recall of 98%. The enchroachment on neighboring cells was limited to 1.42 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e204" xlink:type="simple"/></inline-formula> and with an overlap of more than 84%. As it is clear from these results, our proposed segmentation method achieves significant volume overlap with the ground truth, indicating the accurate performance of the segmentation method.</p>
      </sec>
      <sec id="s4b">
        <title>High sensitivity and segmentation accuracy as demonstrated by performance on manually-segmented zebrafish membrane images</title>
        <p>We next applied the method to images of zebrafish mesoderm obtained at 12 hpf (<xref ref-type="fig" rid="pcbi-1002780-g004">Figure 4</xref>). Four <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e205" xlink:type="simple"/></inline-formula> membrane images were used to evaluate the proposed segmentation method. Using the publicly available GoFigure2 software, an expert manually marked all the somite cells in a small image region by drawing 2D contours on different image planes. For each cell, a 3D mesh was generated out of the sampled 2D contours by using an automatic surface reconstruction procedure. The 3D meshes were used to compare and assess the performance of the automated segmentation algorithm. To demonstrate the effectiveness of our reconstruction procedure for automated segmentation, we compare the performance of three versions of the automated algorithm, namely:</p>
        <list list-type="order">
          <list-item>
            <p>watershed on intensity data directly,</p>
          </list-item>
          <list-item>
            <p>watershed on planarity filtered data, and</p>
          </list-item>
          <list-item>
            <p>watershed on planarity filtering and tensor voting.</p>
          </list-item>
        </list>
        <p>In <xref ref-type="table" rid="pcbi-1002780-t003">Table 3</xref>, we evaluated the segmentation metrics and observed that the basic algorithms 1 and 2 suffer from a high over-segmentation (13.06%, 7.51%) and under-segmentation (13.48%, 5.92%) error rates. Over-segmentation occurs when spurious structures are present in cell interiors that split single cells into multiple labels. Under-segmentation rates are high due the lack of membrane pixel connectivity especially in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e206" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e207" xlink:type="simple"/></inline-formula> planes. When segmentations correctly matched, the algorithms localized the boundary accurately (0.44 and 0.42 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e208" xlink:type="simple"/></inline-formula>) and also had a significant volume overlap (89% and 91%). In contrast, algorithm 3 shows significantly improved performance. On average, the over-segmentation and under-segmentation rates are 4.66% and 3.3% respectively. For the matched set of cells, the average volume overlap and L2 Hausdorff distance are 93% and 0.27 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e209" xlink:type="simple"/></inline-formula>, respectively demonstrating the low distortion in object morphology. Our results indicate that the reconstruction procedure enhanced membrane connectivity and eliminates spurious structures, thereby reducing the over and under-segmentation error-rates.</p>
      </sec>
      <sec id="s4c">
        <title>Robust performance as demonstrated by an exploration of the scale space parameters</title>
        <p>The two scale parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e210" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e211" xlink:type="simple"/></inline-formula> constitute two important parameters in generating the automated output. Thus, we explored a range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e212" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e213" xlink:type="simple"/></inline-formula> values and assessed the variation in the performance of our method. While changing a given parameter, we ensured the other parameters were optimally set. <xref ref-type="fig" rid="pcbi-1002780-g007">Figure 7</xref> reports the average precision and recall values plotted against <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e214" xlink:type="simple"/></inline-formula>/<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e215" xlink:type="simple"/></inline-formula> values for the four manually segmented datasets. We observe robust performance for a broad range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e216" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e217" xlink:type="simple"/></inline-formula> parameters ([0.7, 1.5]) with a gradual degradation in performance. High values (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e218" xlink:type="simple"/></inline-formula>) tend to assign more importance to membrane smoothness over large scales. This negatively impacts membrane connectivity at cell junctions leading to under-segmentation and hence lowers the precision/recall metrics. Low values (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e219" xlink:type="simple"/></inline-formula>) tend to localize membranes more accurately but retain spurious structures that causes over-segmentation and also lowers the metrics. Hence, a judicious choice that balances over-segmentation and under-segmentation rates is recommended.</p>
        <fig id="pcbi-1002780-g007" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002780.g007</object-id>
          <label>Figure 7</label>
          <caption>
            <title>Scale exploration demonstrates robust algorithm performance.</title>
            <p>Precision and recall measures are plotted against different settings of (A) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e220" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e221" xlink:type="simple"/></inline-formula> and (B) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e222" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e223" xlink:type="simple"/></inline-formula>. Precision and recall values were maximized with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e224" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e225" xlink:type="simple"/></inline-formula> and and gradually decreased over broad range of parameter settings indicating robustness. Low scale settings generated noisy features leading to higher over-segmentation rates while large scale settings tended to smooth out sharp membrane corners and cause under-segmentation errors.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002780.g007" position="float" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s4d">
        <title>Robust correspondence between membrane and nuclear segmentations</title>
        <p>We also applied the method to three <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e226" xlink:type="simple"/></inline-formula> zebrafish images in which nuclei and membranes are imaged in separate channels and segmented separately. For nuclear segmentation, we use an improved version of the watershed algorithm using seeds <xref ref-type="bibr" rid="pcbi.1002780-Lin2">[26]</xref>. Although the nuclear and membrane segmentations are not perfect, in an ideal scenario there should exist a one-to-one correspondence between both segmentations (<xref ref-type="fig" rid="pcbi-1002780-g008">Figure 8</xref>). We extract the centroids of cells and nuclei and match them using a nearest neighbor method. <xref ref-type="table" rid="pcbi-1002780-t004">Table 4</xref> provides the details of the matching. On average, the number of nuclei extracted are less than the number of cells from membrane information. This discrepancy is because interstitial space in the tissue (or vacuoles) can be segmented as cells even when they do not exist. These empty spaces can be difficult even for a human to distinguish in the absence of any other information. Our experiments demonstrated an excellent match between the nuclear and membrane segmentation algorithm outcomes indicating a robust performance of our segmentation software.</p>
        <fig id="pcbi-1002780-g008" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002780.g008</object-id>
          <label>Figure 8</label>
          <caption>
            <title>Robust correspondence between membrane and nuclear segmentations.</title>
            <p>Algorithm performance was assessed by matching automated segmentations obtained from the nuclear and membrane channels. In the ideal case, each individual nucleus would match with a unique membrane and vice-versa. (A) A single 2D image plane is shown with contours of membrane and nuclear segmentations overlaid on raw data. Some cells have their corresponding nuclei located out-of-plane. The lack of a one-to-one correspondence indicates an error. For example, an over-segmentation of the membrane channel (white arrow) causes one of the membrane components to not contain a nucleus. (B) 3D renderings of cells from membrane and nuclear segmentations.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002780.g008" position="float" xlink:type="simple"/>
        </fig>
        <table-wrap id="pcbi-1002780-t004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002780.t004</object-id>
          <label>Table 4</label>
          <caption>
            <title>Robust correspondence of automated membrane segmentations with automated nuclear segmentations.</title>
          </caption>
          <alternatives>
            <graphic id="pcbi-1002780-t004-4" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002780.t004" xlink:type="simple"/>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Data</td>
                  <td align="left" rowspan="1" colspan="1">#Cells</td>
                  <td align="left" rowspan="1" colspan="1">#Nuclei</td>
                  <td align="left" rowspan="1" colspan="1">#Matched</td>
                  <td align="left" rowspan="1" colspan="1">#Unmatched Cells</td>
                  <td align="left" rowspan="1" colspan="1">#Unmatched Nuclei</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">1</td>
                  <td align="left" rowspan="1" colspan="1">312</td>
                  <td align="left" rowspan="1" colspan="1">291</td>
                  <td align="left" rowspan="1" colspan="1">279</td>
                  <td align="left" rowspan="1" colspan="1">33</td>
                  <td align="left" rowspan="1" colspan="1">12</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">2</td>
                  <td align="left" rowspan="1" colspan="1">217</td>
                  <td align="left" rowspan="1" colspan="1">194</td>
                  <td align="left" rowspan="1" colspan="1">186</td>
                  <td align="left" rowspan="1" colspan="1">31</td>
                  <td align="left" rowspan="1" colspan="1">8</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">3</td>
                  <td align="left" rowspan="1" colspan="1">241</td>
                  <td align="left" rowspan="1" colspan="1">228</td>
                  <td align="left" rowspan="1" colspan="1">219</td>
                  <td align="left" rowspan="1" colspan="1">22</td>
                  <td align="left" rowspan="1" colspan="1">9</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt104">
              <label/>
              <p>Detection and error rates of the automated algorithm was compared with standard nuclear segmentation algorithms. The assumption was that perfect segmentations of both algorithms should theoretically establish a one-to-one correspondence between nuclei and membranes detected. <bold>Matched</bold> refers to cells with membrane and nuclei in exact correspondence. <bold>Unmatched Cells</bold> refer to membranes that did not contain a unique nucleus. <bold>Unmatched Nuclei</bold> refer to nuclei that did not correspond to a cell membrane.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec id="s4e">
        <title>Quantitative analysis of cell shape and size during somite formation</title>
        <p>During zebrafish somitogenesis, a series of epithelial tissue blocks forms rhythmically by separating from the presomitic mesoderm tissue (PSM) <xref ref-type="bibr" rid="pcbi.1002780-Dequeant1">[27]</xref>. A total of 28 pairs of blocks known as somites sequentially form beginning at 10 hpf with a period of approximately 30 minutes <xref ref-type="bibr" rid="pcbi.1002780-Giudicelli1">[28]</xref>. Somites are formed by cell sorting from the PSM. Each somite is structurally composed of epithelial (E) cells on the boundary with an inner mesenchymal (M) core. Throughout somite formation, the PSM maintains a steady-state by coordinating the anterior process of somite formation with cell recruitment and proliferation at its posterior end. The PSM is gradually patterned along the anteroposterior axis by cellular rearrangements and tissue/cell-shape changes, deriving its input from an oscillating molecular circuit known as the <italic>segmentation clock</italic> (not to be confused with image segmentation) <xref ref-type="bibr" rid="pcbi.1002780-Cooke1">[29]</xref>, <xref ref-type="bibr" rid="pcbi.1002780-Gibb1">[30]</xref>. Segmentation clocks operating inside individual cells are synchronised along the PSM to create periodic waves of oscillating gene expression. While there has been substantial progress in understanding the molecular mechanisms of wave initiation, synchronization, and the readout circuitry, the cellular and mechanical mechanisms involved in physically sculpting a somite are not clear due to the lack of high-quality image data and subsequent robust analysis <xref ref-type="bibr" rid="pcbi.1002780-Kulesa1">[31]</xref>. For example, it is not exactly known how the sorting interface develops, what the cell movement patterns at the interface are, how many cells are involved, and what the corresponding changes in cell and tissue morphology are.</p>
        <p>Therefore, our goal was to obtain time-lapse membrane images during somite formation, apply our reconstruction techniques, and quantify cell dynamics. We chose to <italic>in toto</italic> image the formation of somites 3, 4, and 5 in a zebrafish embryo mounted dorsally, with a 40× objective, and with a time-sampling of 2 minutes over a period of 60 minutes using confocal microscopy <xref ref-type="bibr" rid="pcbi.1002780-Megason4">[32]</xref>. The beginning marked the formation of somite 3 with a discernable interface with the presomitic mesoderm. During the time-lapse, we observe the complete separation of somite 3 and 4. Somite 5 forms a discernable interface at the end of the time-lapse thus completing two full cycles of segmentation. In <xref ref-type="fig" rid="pcbi-1002780-g005">Figure 5</xref>, we present the results of our reconstruction (orthogonal sections) and automated segmentation (3D view) of the PSM cells at 3 and 5 somite stages (ss). Automated segmentations were overlaid on the reconstructions to show the excellent agreement in contours. We then proceeded to analyze the formation of somites by quantifying differences between 3 and 5 ss (<xref ref-type="fig" rid="pcbi-1002780-g009">Figure 9</xref>). As a consequence of somites physically separating and becoming spherical, interface surface area decreases across all the three somites. Given that somite 3 is farther along than somite 4 and somite 5 in the process of forming round somites, their surface areas (see blue and red bars) are monotonically higher. In particular, somites 4 and 5 show a large surface area in the PSM initially (see blue peaks). At ss 5, somite 3 and 4 show significantly smaller surface area due to the completion of somite rounding while somite 5 is still halfway through. Thus, the blue peak at somite 3 roughly corresponds to the red peak of somite 5 given the same relative progress into somite formation. The total number of cells is very consistent across the three somites (<xref ref-type="fig" rid="pcbi-1002780-g009">Figure 9D</xref>).</p>
        <fig id="pcbi-1002780-g009" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002780.g009</object-id>
          <label>Figure 9</label>
          <caption>
            <title>Algorithm-enabled quantification of cell dynamics during somite formation.</title>
            <p>Retrospective cell tracing of epithelial (yellow) and mesenchymal (red) cells from formed somites at (B) 5ss back to the presomitic mesoderm at (A) 3ss. (C) Corresponding decrease in somite tissue surface area during the formation of somites 3, 4, and 5. (D) Epithelial and mesenchymal cell numbers in respective somites at 5ss. (E,F) Three-dimensional cell shape quantified by the length of their principal axes at 3ss and 5ss. (G,H) Scatter plots of elongation (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e227" xlink:type="simple"/></inline-formula>) and cell volumes at 3ss and 5ss. The two cell populations show different behavior. Statistical analysis of the two distributions show that mesenchymal cells (red) tend to cluster, round-up, and shrink in size on average.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002780.g009" position="float" xlink:type="simple"/>
        </fig>
        <p>In order to understand the corresponding changes in cell parameters, we then identified the number of epithelial and mesenchymal cells in the formed somites. Mesenchymal cells which do not touch the surface of the somite were a small fraction (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e228" xlink:type="simple"/></inline-formula>5–20%) of the cells (<xref ref-type="fig" rid="pcbi-1002780-g009">Figure 9D</xref>). The epithelial layer formed a single layer of cells over the mesenchymal cells. We labeled these cells in different colors and retrospectively tracked their location into the PSM. For tracking, segmentations at individual time-points were linked based on optical flow-fields that were first reconstructed <xref ref-type="bibr" rid="pcbi.1002780-Vemuri1">[33]</xref>. Errors in the tracking were corrected manually using the publicly-available GoFigure2 software (<ext-link ext-link-type="uri" xlink:href="http://www.gofigure2.org" xlink:type="simple">www.gofigure2.org</ext-link>). We then computed the principal diameters of the cells along their principal axis. A typical workflow consists of first visualizing and interactively exploring the distributions of cell shapes, sizes, and locations after the segmentation process is completed. The process of interaction involves zooming in and out, changing the viewing angle, hiding a subset of data, and visualizing specific outliers or data points. Scatterplots in <xref ref-type="fig" rid="pcbi-1002780-g009">Figure 9(E–F)</xref> show the distributions of the epithelial (blue) and mesenchymal cells (red). In ss 3, we observe large and homogenous variation of cell morphology across E and M classes. At ss 5, M cells form a more narrow distribution while E cells spread out to form diverse cell shapes neccessary for constructing spherical somites with continuous epithelia. A few examples of such cells are shown in (F). After finding interesting correlations and trends, accurate 2D scatterplots or figures can be used for effective visualization. Hence, we also computed changes in cell volumes (size) in <xref ref-type="fig" rid="pcbi-1002780-g009">Figure 9(G–H)</xref>. Here, we observe that the distribution of mesenchymal cell volumes (red) narrows and interestingly we find that the mesenchymal cells shrink in volume as the somite forms. We are now analyzing somite formation rigorously across all intermediate time-points, combined with tracking results for individual cells and across multiple datasets. As part of our future work, we plan to integrate the process with the underlying molecular circuitry to obtain a multiscale view of somite formation.</p>
        <p>Our work successfully demonstrates the utility of our algorithms in enabling the quantification of cell shape and size, tissue interface areas and volumes, and reconstruction of cell lineages and fate maps by tracking segmented cells. By recovering individual cell dynamics and their collective behavior in tissue from time-lapse images, a deeper understanding of the mechanisms involved in morphogenesis can be obtained. Thus, our algorithms are computationally robust and can be deployed to facilitate the analysis of a wide-variety of morphogenesis systems.</p>
      </sec>
    </sec>
    <sec id="s5">
      <title>Availability and Future Directions</title>
      <p>Our method has several advantages over previous approaches. The first major advantage of the method is the ability to robustly segment tightly-packed cells without relying on their absolute fluorescence levels. Since we detect membranes based on local shape information computed from second derivatives of the image intensity function, the absolute values are not important. This is very relevant for time-lapse imaging data because membrane-tagged fluorophores can photobleach. With our method, it will be possible to segment cells and track them for a longer developmental time-window using only the membrane channel. The second major advantage is that our technique deals with intensity inhomogeneities that occur in membrane surfaces due to their orientation with respect to the imaging planes. Our method can easily be extended to using nuclear information when available as seed-points for the watershed that will further reduce the amount of over and under-segmentations. Conversely, the reconstructed and localized membranes can also be used to refine nuclear segmentations. Currently the method is implemented in C/C++ language and uses The Insight Toolkit (ITK) libraries (<ext-link ext-link-type="uri" xlink:href="http://www.itk.org/" xlink:type="simple">http://www.itk.org/</ext-link>) that are open-source and publicly available. We have used multi-threading optimization strategies and efficient data structures to take in account modern multicore computer architectures. Our software can be readily used in a cluster environment for large scale image processing. The documentation provided with the source code (see Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002780.s007">Text S1</xref>, Section 3) details the set of steps required to download, compile, link, and execute the code. Our software has been developed and tested on Windows, Mac, and Linux platforms and is available publicly under a BSD license (<ext-link ext-link-type="uri" xlink:href="https://github.com/krm15/ACME/" xlink:type="simple">https://github.com/krm15/ACME/</ext-link>). A copy of the source code and scripts used in the preparation of this manuscript is provided as a zipped file in <xref ref-type="supplementary-material" rid="pcbi.1002780.s006">Protocol S1</xref>. Precompiled binaries are also available at <ext-link ext-link-type="uri" xlink:href="https://wiki.med.harvard.edu/SysBio/Megason/ACME" xlink:type="simple">https://wiki.med.harvard.edu/SysBio/Megason/ACME</ext-link>. A single time-point of our somite image data (<xref ref-type="supplementary-material" rid="pcbi.1002780.s001">Dataset S1</xref>) used in the paper and all of our synthetic data (<xref ref-type="supplementary-material" rid="pcbi.1002780.s002">Dataset S2</xref>) are provided. Default parameter values are provided as well as instructions for modifying them, if needed. Code for generating new synthetic data with other parameter values has also been included in the repository.</p>
      <p>In conclusion, our software enables the efficient and accurate quantification of cell shape, size, and position from large time-lapse images in an automated manner. We believe that this work is immensely useful to research aimed at understanding individual and collective cell behavior using high-resolution microscopy, especially in the context of tissue morphogenesis and organ formation.</p>
    </sec>
    <sec id="s6">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002780.s001" mimetype="application/zip" xlink:href="info:doi/10.1371/journal.pcbi.1002780.s001" position="float" xlink:type="simple">
        <label>Dataset S1</label>
        <caption>
          <p>
            <bold>A single time-point of somite image data along with intermediate processing results from using ACME code.</bold>
          </p>
          <p>(ZIP)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002780.s002" mimetype="application/zip" xlink:href="info:doi/10.1371/journal.pcbi.1002780.s002" position="float" xlink:type="simple">
        <label>Dataset S2</label>
        <caption>
          <p>
            <bold>Ten synthetic image sets generated with progressively higher noise parameters (</bold>
            <inline-formula>
              <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e229" xlink:type="simple"/>
            </inline-formula>
            <bold>,</bold>
            <inline-formula>
              <inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e230" xlink:type="simple"/>
            </inline-formula>
            <bold>) and increasing cell number.</bold>
          </p>
          <p>(ZIP)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002780.s003" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002780.s003" position="float" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <p><bold>Tensor voting field determination.</bold> (A) 2D voting field parameters. (B) Heat map showing the stick voting field saliencies in 2D. The stick tensor is represented using line glyphs and overlaid on the figure. (C) A simple example showing two sampled intersecting circles and their reconstruction (D).</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002780.s004" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002780.s004" position="float" xlink:type="simple">
        <label>Figure S2</label>
        <caption>
          <p><bold>A flowchart of processing filters and parameters with intermediate outputs.</bold> There are four filters that take the input image to produce an output segmented image. For each step on the left, the corresponding input and output image is shown on the right.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002780.s005" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002780.s005" position="float" xlink:type="simple">
        <label>Figure S3</label>
        <caption>
          <p><bold>Synthetic membrane images along XY, XZ, and YZ sections.</bold> The (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e231" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002780.e232" xlink:type="simple"/></inline-formula>) values were sampled as (A–C) (0.01, 1.00), (D–F) (0.05, 0.6), and (G–I) (0.1, 0.1). Corresponding ground truth segmentation images (XY) are shown in (J–L).</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002780.s006" mimetype="application/zip" xlink:href="info:doi/10.1371/journal.pcbi.1002780.s006" position="float" xlink:type="simple">
        <label>Protocol S1</label>
        <caption>
          <p>
            <bold>A compressed zipped file containing ACME source code in C++, a README file, and python scripts for generating synthetic image data.</bold>
          </p>
          <p>(ZIP)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002780.s007" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1002780.s007" position="float" xlink:type="simple">
        <label>Text S1</label>
        <caption>
          <p>
            <bold>Step-by-step instructions for downloading, compiling, and executing ACME code on provided test datasets.</bold>
          </p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>We thank members of Megason lab for comments and support, Mr. Dante D'India for fish care, and Dr. Arnaud Gelas, Mr. Nicolas Rannou, and Ms. Lydie Souhait for technical advice and help with GoFigure2 software. We thank Ms. Suzanne Mosaliganti for proof-reading and editing the manuscript.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002780-Blanchard1">
        <label>1</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blanchard</surname><given-names>GB</given-names></name>, <name name-style="western"><surname>Kabla</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Schultz</surname><given-names>NL</given-names></name>, <name name-style="western"><surname>Butler</surname><given-names>LC</given-names></name>, <name name-style="western"><surname>Sanson</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Tissue tectonics: morphogenetic strain rates, cell shape change and intercalation</article-title>. <source>Nature Methods</source> <volume>6</volume>: <fpage>458</fpage>–<lpage>464</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Megason1">
        <label>2</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Megason</surname><given-names>SG</given-names></name>, <name name-style="western"><surname>Srinivas</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Dickinson</surname><given-names>ME</given-names></name>, <name name-style="western"><surname>Hadjantonakis</surname><given-names>AK</given-names></name> (<year>2011</year>) <article-title>Microscopy to mechanism across the scales of development</article-title>. <source>Current Opinion in Genetics &amp; Development</source> <volume>21</volume>: <fpage>519</fpage>–<lpage>522</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Megason2">
        <label>3</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Megason</surname><given-names>SG</given-names></name>, <name name-style="western"><surname>Fraser</surname><given-names>SE</given-names></name> (<year>2003</year>) <article-title>Digitizing life at the level of the cell: high-performance laserscanning microscopy and image analysis for in toto imaging of development</article-title>. <source>Mechanisms of Development</source> <volume>120</volume>: <fpage>1407</fpage>–<lpage>1420</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Megason3">
        <label>4</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Megason</surname><given-names>SG</given-names></name>, <name name-style="western"><surname>Fraser</surname><given-names>SE</given-names></name> (<year>2007</year>) <article-title>Imaging in systems biology</article-title>. <source>Cell</source> <volume>130</volume>: <fpage>784</fpage>–<lpage>795</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Keller1">
        <label>5</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Keller</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Schmidt</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Wittbrodt</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Stelzer</surname><given-names>E</given-names></name> (<year>2008</year>) <article-title>Reconstruction of zebrafish early embryonic development by scanned light sheet microscopy</article-title>. <source>Science</source> <volume>322</volume>: <fpage>1065</fpage>–<lpage>1069</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Olivier1">
        <label>6</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Olivier</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Luengo-Oroz</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Duloquin</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Faure</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Savy</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Cell lineage reconstruction of early zebrafish embryos using label-free nonlinear microscopy</article-title>. <source>Science</source> <volume>20 329</volume>: <fpage>967</fpage>–<lpage>971</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Fernandez1">
        <label>7</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fernandez</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Das</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Mirabet</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Moscardi</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Traas</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Imaging plant growth in 4D: robust tissue reconstruction and lineaging at cell resolution</article-title>. <source>Nature Methods</source> <volume>7</volume>: <fpage>547</fpage>–<lpage>553</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Roeder1">
        <label>8</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Roeder</surname><given-names>AHK</given-names></name>, <name name-style="western"><surname>Tarr</surname><given-names>PT</given-names></name>, <name name-style="western"><surname>Tobin</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Chickarmane</surname><given-names>V</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Computational morphodynamics of plants: integrating development over space and time</article-title>. <source>Nature Reviews Molecular Cell Biology</source> <volume>12</volume>: <fpage>265</fpage>–<lpage>273</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Malpica1">
        <label>9</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Malpica</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Solorzano</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Vaquero</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Santos</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Vallcorba</surname><given-names>I</given-names></name>, <etal>et al</etal>. (<year>1997</year>) <article-title>Applying watershed algorithms to the segmentation of clustered nuclei</article-title>. <source>Journal of Cytometry</source> <volume>28</volume>: <fpage>289</fpage>–<lpage>297</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Adiga1">
        <label>10</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Adiga</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Chaudhuri</surname><given-names>B</given-names></name> (<year>2001</year>) <article-title>An efficient method based on watershed and rule-based merging for segmentation of 3-d histo-pathological images</article-title>. <source>Pattern Recognition</source> <volume>34</volume>: <fpage>1449</fpage>–<lpage>1458</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Lin1">
        <label>11</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lin</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Chawla</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Olson</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Guzowski</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Barnes</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>A multi-model approach to simultaneous segmentation and classification of heterogeneous populations of cell nuclei in 3D confocal microscopy images</article-title>. <source>Cytometry</source> <volume>71A</volume>: <fpage>724</fpage>–<lpage>736</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Sarti1">
        <label>12</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sarti</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Malladi</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Sethian</surname><given-names>JA</given-names></name> (<year>2000</year>) <article-title>Subjective surfaces: a method for completing missing boundaries</article-title>. <source>Proceedings of the National Academy of Sciences (PNAS)</source> <volume>97</volume>: <fpage>6258</fpage>–<lpage>6263</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Sarti2">
        <label>13</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sarti</surname><given-names>A</given-names></name>, <name name-style="western"><surname>De Solorzano</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Lockett</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Malladi</surname><given-names>R</given-names></name> (<year>2000</year>) <article-title>A geometric model for 3D confocal image analysis</article-title>. <source>IEEE Transactions in Biomedical Engineering</source> <volume>47</volume>: <fpage>1600</fpage>–<lpage>1609</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Dufour1">
        <label>14</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dufour</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Shinin</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Tajbakhsh</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Guillon-Aghion</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Olivo-Marin</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Segmenting and tracking uorescent cells in dynamic 3D microscopy with coupled active surfaces</article-title>. <source>IEEE Transactions Image Processing</source> <volume>14</volume>: <fpage>1396</fpage>–<lpage>1410</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Mikula1">
        <label>15</label>
        <mixed-citation publication-type="other" xlink:type="simple">Mikula K, Peyrieras N, Remesikova M, Sarti A (2005) 3D embryogenesis image segmentation by the generalized subjective surface method using the finite volume technique. In: Finite Volumes for Complex Applications V: Problems and Perspectives. John Wiley &amp; Sons. pp. 585–592.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Zanella1">
        <label>16</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zanella</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Campana</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Rizzi</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Melani</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Sanguinetti</surname><given-names>G</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Cells segmentation from 3D confocal images of early zebrafish embryogenesis</article-title>. <source>IEEE Transactions on Image Processing</source> <volume>19</volume>: <fpage>770</fpage>–<lpage>781</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Li1">
        <label>17</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Tarokh</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Nie</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Guo</surname><given-names>L</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>3D cell segmentation based on gradient flow tracking</article-title>. <source>BMC Cell Biology</source> <volume>8</volume>: <fpage>40</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Frangi1">
        <label>18</label>
        <mixed-citation publication-type="other" xlink:type="simple">Frangi A, Niessen W, Vincken K, Viergever M (1998) Multiscale vessel enhancement filtering. In: Proceedings of the Conference on Medical Image Computing and Computer-Assisted Intervention (MICCAI). Cambridge, Massachusetts. pp. 130–137.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Manniesing1">
        <label>19</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Manniesing</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Niessen</surname><given-names>W</given-names></name> (<year>2005</year>) <article-title>Multiscale vessel enhancing diffusion in CT angiography noise filtering</article-title>. <source>Proceedings of the Conference on Information Processing in Medical Imaging</source> <volume>19</volume>: <fpage>138</fpage>–<lpage>149</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Mosaliganti1">
        <label>20</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mosaliganti</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Janoos</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Gelas</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Noche</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Obholzer</surname><given-names>N</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Anisotropic plate diffusion filtering for detection of cell membranes in 3d microscopy images</article-title>. <source>Proc IEEE Int Symp Biomed Imaging</source> <volume>2010</volume>: <fpage>588</fpage>–<lpage>591</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Guy1">
        <label>21</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Guy</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Medioni</surname><given-names>G</given-names></name> (<year>1996</year>) <article-title>Inferring global perceptual contours from local features</article-title>. <source>International Journal of Computer Vision</source> <volume>20</volume>: <fpage>113</fpage>–<lpage>133</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Medioni1">
        <label>22</label>
        <mixed-citation publication-type="other" xlink:type="simple">Medioni G, Kang SB (2004) Emerging Topics in Computer Vision. Upper Saddle River, NJ, USA: Prentice Hall PTR.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Loss1">
        <label>23</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Loss</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Bebis</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Nicolescu</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Skurikhin</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>An iterative multi-scale tensor voting scheme for perceptual grouping of natural shapes in cluttered backgrounds</article-title>. <source>Journal of Computer Vision and Image Understanding (CVIU)</source> <volume>113</volume>: <fpage>126</fpage>–<lpage>149</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Parvin1">
        <label>24</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Parvin</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>Q</given-names></name>, <name name-style="western"><surname>Han</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Chang</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Rydberg</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Iterative voting for inference of structural saliency and characteriztion of subcellular events</article-title>. <source>IEEE Transactions on Image Processing</source> <volume>16</volume>: <fpage>615</fpage>–<lpage>623</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Rockafellar1">
        <label>25</label>
        <mixed-citation publication-type="other" xlink:type="simple">Rockafellar RT, Wets RJB (1998) Variational Analysis, volume 317. Springer. 764 pp. Available: <ext-link ext-link-type="uri" xlink:href="http://books.google.com/books?id=w-NdOE5fD8AC" xlink:type="simple">http://books.google.com/books?id=w-NdOE5fD8AC</ext-link>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Lin2">
        <label>26</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lin</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Chawla</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Guzowski</surname><given-names>KOJ</given-names></name>, <name name-style="western"><surname>Barnes</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Roysam</surname><given-names>B</given-names></name> (<year>2005</year>) <article-title>Hierarchical, model-based merging of multiple fragments for improved three-dimensional segmentation of nuclei</article-title>. <source>Cytometry</source> <volume>63A</volume>: <fpage>20</fpage>–<lpage>33</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Dequeant1">
        <label>27</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dequeant</surname><given-names>ML</given-names></name>, <name name-style="western"><surname>Pourquie</surname><given-names>O</given-names></name> (<year>2008</year>) <article-title>Segmental patterning of the vertebrate embryonic axis</article-title>. <source>Nature Reviews Genetics</source> <volume>9</volume>: <fpage>370</fpage>–<lpage>382</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Giudicelli1">
        <label>28</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Giudicelli</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Özbudak</surname><given-names>EM</given-names></name>, <name name-style="western"><surname>Wright</surname><given-names>GJ</given-names></name>, <name name-style="western"><surname>Lewis</surname><given-names>J</given-names></name> (<year>2007</year>) <article-title>Setting the Tempo in Development: An Investigation of the Zebrafish Somite Clock Mechanism</article-title>. <source>PLoS Biology</source> <volume>5</volume>: <fpage>e150</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Cooke1">
        <label>29</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cooke</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Zeeman</surname><given-names>EC</given-names></name> (<year>1976</year>) <article-title>A clock and wavefront model for control of the number of repeated structures during animal morphogenesis</article-title>. <source>Journal of Theoretical Biology</source> <volume>58</volume>: <fpage>455</fpage>–<lpage>476</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Gibb1">
        <label>30</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gibb</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Maroto</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Dale</surname><given-names>JK</given-names></name> (<year>2010</year>) <article-title>The segmentation clock mechanism moves up a notch</article-title>. <source>Trends in Cell Biology</source> <volume>20</volume>: <fpage>593</fpage>–<lpage>600</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Kulesa1">
        <label>31</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kulesa</surname><given-names>PM</given-names></name>, <name name-style="western"><surname>Schnell</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Rudloff</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Baker</surname><given-names>RE</given-names></name>, <name name-style="western"><surname>Maini</surname><given-names>PK</given-names></name> (<year>2007</year>) <article-title>From segment to somite: Segmentation to epithelialization analyzed within quantitative frameworks</article-title>. <source>Developmental Dynamics</source> <volume>236</volume>: <fpage>1392</fpage>–<lpage>1402</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Megason4">
        <label>32</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Megason</surname><given-names>SG</given-names></name> (<year>2009</year>) <article-title>In toto imaging of embryogenesis with confocal time-lapse microscopy</article-title>. <source>Methods in Molecular Biology</source> <volume>546</volume>: <fpage>317</fpage>–<lpage>332</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002780-Vemuri1">
        <label>33</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vemuri</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Ye</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Leonard</surname><given-names>C</given-names></name> (<year>2003</year>) <article-title>Image registration via level-set motion: Applications to atlas-based segmentation</article-title>. <source>Medical Image Analysis</source> <volume>7</volume>: <fpage>1</fpage>–<lpage>20</lpage>.</mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>