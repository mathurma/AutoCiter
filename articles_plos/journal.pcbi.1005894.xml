<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00660</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005894</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Flight (biology)</subject><subj-group><subject>Insect flight</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Flight (biology)</subject><subj-group><subject>Insect flight</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Flight (biology)</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Flight (biology)</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical mechanics</subject><subj-group><subject>Acceleration</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Zoology</subject><subj-group><subject>Animal anatomy</subject><subj-group><subject>Wings</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Infectious diseases</subject><subj-group><subject>Disease vectors</subject><subj-group><subject>Insect vectors</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Species interactions</subject><subj-group><subject>Disease vectors</subject><subj-group><subject>Insect vectors</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Animals</subject><subj-group><subject>Invertebrates</subject><subj-group><subject>Arthropoda</subject><subj-group><subject>Insects</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Modeling visual-based pitch, lift and speed control strategies in hoverflies</article-title>
<alt-title alt-title-type="running-head">Modeling visual-based pitch, lift and speed control strategies in hoverflies</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9602-2786</contrib-id>
<name name-style="western">
<surname>Goulard</surname> <given-names>Roman</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Vercher</surname> <given-names>Jean-Louis</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1585-9822</contrib-id>
<name name-style="western">
<surname>Viollet</surname> <given-names>Stéphane</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<addr-line>Aix Marseille Univ, CNRS, ISM, Marseille, France</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ayers</surname> <given-names>Joseph</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Northeastern University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">stephane.viollet@univ-amu.fr</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>1</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>23</day>
<month>1</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>1</issue>
<elocation-id>e1005894</elocation-id>
<history>
<date date-type="received">
<day>28</day>
<month>4</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>12</day>
<month>11</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Goulard et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005894"/>
<abstract>
<p>To avoid crashing onto the floor, a free falling fly needs to trigger its wingbeats quickly and control the orientation of its thrust accurately and swiftly to stabilize its pitch and hence its speed. Behavioural data have suggested that the vertical optic flow produced by the fall and crossing the visual field plays a key role in this anti-crash response. Free fall behavior analyses have also suggested that flying insect may not rely on graviception to stabilize their flight. Based on these two assumptions, we have developed a model which accounts for hoverflies´ position and pitch orientation recorded in 3D with a fast stereo camera during experimental free falls. Our dynamic model shows that optic flow-based control combined with closed-loop control of the pitch suffice to stabilize the flight properly. In addition, our model sheds a new light on the visual-based feedback control of fly´s pitch, lift and thrust. Since graviceptive cues are possibly not used by flying insects, the use of a vertical reference to control the pitch is discussed, based on the results obtained on a complete dynamic model of a virtual fly falling in a textured corridor. This model would provide a useful tool for understanding more clearly how insects may or not estimate their absolute attitude.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>On the basis of vision-based feedback control of optic flow occurring during insects’ flight, we developed a dynamic model that accounts for the pitch orientation and speed in plummeting flies. We compared the hoverflies’ responses with our model and showed that an optic-flow based control strategy can be used to correct the initial pitch misorientation caused by the free fall situation. To complete the model, we combined the closed-loop control of the vertical optic flow with an additional feedback control loop based on the value of the absolute pitch orientation. The need for this measurement to stabilize the pitch orientation raises the question as whether this is also the case in dipterans. After ruling out the possibility that insects may use gravity acceleration cues to control their flight, for which no experimental evidence has been found so far, we discussed the three main sensory processes possibly involved in in their ability to control their attitude. Our model provides a useful tool for studying the various sensory processes possibly involved in dipterans’ flight stabilization abilities as well as the interactions between these processes.</p>
</abstract>
<funding-group>
<funding-statement>SV acknowledges support from the Centre National de la Recherche Scientifique (CNRS), Aix-Marseille Universite and the Agence Nationale de la Recherche (ANR) [IRIS project (Intelligent Retina for Innovative Sensing) ANR-12-INSE-0009]. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="0"/>
<page-count count="21"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are available at <ext-link ext-link-type="uri" xlink:href="https://osf.io/semkz/" xlink:type="simple">https://osf.io/semkz/</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Flying insects are subjected to a broad range of disturbances, for which fast, robust sensorimotor reflexes compensate. The flight stabilization performance of flies are even more impressive in view of the intrinsic aerodynamic instability of their flapping flight [<xref ref-type="bibr" rid="pcbi.1005894.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1005894.ref004">4</xref>]. Compensating for this passive instability requires an active inner control of the wing kinematic in addition to an outer-loop system which responds to specific sensory cues (looming objects, odours and navigational cues). Discovering insects’ abilities to sense movement via optic flow crossing the compound eye or inertially via the halteres (for dipteran) is still of great interest. However, very few studies have focused so far on how flying insect sense their absolute body orientation in the three-dimensional space (attitude) with respect to a vertical reference. Oppositely, several studies have suggested that flies may lack the ability to perceive the vertical (via graviceptive cues) in order to stabilize their flight [<xref ref-type="bibr" rid="pcbi.1005894.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1005894.ref007">7</xref>]. To address this point, we used an already designed free-fall procedure [<xref ref-type="bibr" rid="pcbi.1005894.ref007">7</xref>] with which insects can be briefly exposed to near-weightless conditions in a box lined with horizontal black and white stripes. The present study focused on the following questions:</p>
<list list-type="order">
<list-item>
<p>whether an optic flow-based strategy may be involved in hoverflies’ speed control in closed-loop and prevent them efficiently from crashing after a free fall, and</p>
</list-item>
<list-item>
<p>whether this simple strategy may durably ensure flight stability.</p>
</list-item>
</list>
<p>The control of flight speed based on optic flow cues have been confirmed by ethological studies [<xref ref-type="bibr" rid="pcbi.1005894.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1005894.ref010">10</xref>]. In the same time, in flying insects, as in helicopter, lift vector and body orientation are fixed in time and consequently flight speed and pitch orientation [<xref ref-type="bibr" rid="pcbi.1005894.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref011">11</xref>], and the idea that insects’ attitude may be stabilized on the basis of the optic flow has been tested successfully on a 2 degree-of-freedom flying robot [<xref ref-type="bibr" rid="pcbi.1005894.ref012">12</xref>]. A pitch rate control process has also been proposed previously to model the drosophila’s forward velocity during flight [<xref ref-type="bibr" rid="pcbi.1005894.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref014">14</xref>]. Based on the existence of coupling between pitch control and optic flow regulation, we challenged the suitability of such closed-loop control compared with hoverflies subjected to an unsteady free fall situation.</p>
<p>It has been previously established that the fly’s auto-stabilizer involves several sensory modalities, which interact during flight. First, insect vision is based on two physical structures, compound eyes and ocelli. The fly’s photoreceptors feature a high temporal resolution giving them a great ability to detect fast motion based on contrast changes [<xref ref-type="bibr" rid="pcbi.1005894.ref006">6</xref>]. Optic flow measurement have shown that motion vision is involved in many visually guided tasks such as flight speed and altitude control, wall following, odometry and optomotor response [<xref ref-type="bibr" rid="pcbi.1005894.ref009">9</xref>]. Most of the optic flow processing is performed by compound eyes, and local contrast motion measurements are fused by lobula plate tangential cells (LPTC) responsible for detecting large field motion [<xref ref-type="bibr" rid="pcbi.1005894.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref016">16</xref>]. In addition, it has been established that several groups of interneurons, including VSTCs (Vertical Sensitive Tangential Cells) [<xref ref-type="bibr" rid="pcbi.1005894.ref017">17</xref>] and HSTC (Horizontal Sensitive Tangential Cells) [<xref ref-type="bibr" rid="pcbi.1005894.ref018">18</xref>], process the various components of visual motion and in particular that they distinguish between the rotational and translational components of the optic flow with respect to the fly’s reference frame [<xref ref-type="bibr" rid="pcbi.1005894.ref019">19</xref>]. In addition, the ocelli, which are usually composed of three simple unfocused eyes forming a triangle at the top of the head [<xref ref-type="bibr" rid="pcbi.1005894.ref020">20</xref>], may be involved in the visuo-motor stabilization reflexes that maintain postural equilibrium by detecting the head’s rotational speed [<xref ref-type="bibr" rid="pcbi.1005894.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1005894.ref025">25</xref>].</p>
<p>Dipteran also possess two minute dumbbell-shaped organs called halteres, which have evolved from hind-wings and beat simultaneously in anti-phase with wings. This active beating along with the campaniform sensilla provide flies with sensitivity to Coriolis forces and consequently to their own body’s angular speed [<xref ref-type="bibr" rid="pcbi.1005894.ref026">26</xref>–<xref ref-type="bibr" rid="pcbi.1005894.ref028">28</xref>]. The halteres enable the fly’s autopilot to respond to extremely abrupt changes in attitude with a latency as short as 5ms [<xref ref-type="bibr" rid="pcbi.1005894.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref030">30</xref>]. In addition, insect’s hairs and antennae are sensitive to airflow during flight. Airflow sensing by the Johnston’s organs present in the antennae is known to be involved in flight speed regulation complementary to optic flow regulation [<xref ref-type="bibr" rid="pcbi.1005894.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref032">32</xref>].</p>
<p>All in all, these sensorimotor units are mainly characterized in flies by their high temporal resolution and their low latency response [<xref ref-type="bibr" rid="pcbi.1005894.ref029">29</xref>]. Flies’ sensors are indeed highly tuned to detecting and quickly counteracting any change in their environment [<xref ref-type="bibr" rid="pcbi.1005894.ref006">6</xref>]. The combination of various sensory modalities with different bandwidth allows them to cover a wide range of dynamic perturbations.</p>
<p>In this study, an insect flight control model was developed, based simply on the closed-loop control of the pitch rate and the regulation of the horizontal component of the optic flow. In a first step, our model was devoid of any kind of absolute reference. The results obtained with this model simulating the fly’s response in unsteady free fall situations are compared with experimental data obtained on plummeting hoverflies in a box lined with horizontal black &amp; white stripes. The model simulated data matched what occurred during the first few milliseconds of the insects flight, but the pitch and speed responses became highly unstable after around 0.4s. In the second step, the accuracy of the model’s predictions was greatly improved by including two additional feedback loops: one controlling the pitch rate on the basis of the absolute estimation of the pitch orientation and one controlling the lift and thrust forces on the basis of the vertical optic flow. The ability of the fly to measure its pitch orientation with respect to an absolute reference value is discussed in term of the existence of visually mediated responses such as the dorsal light response (DLR).</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec003">
<title>Dynamic model for the closed-loop control of the pitch, speed and force in the freely falling fly</title>
<p>In a previous study on flight stabilization in plummeting hoverflies [<xref ref-type="bibr" rid="pcbi.1005894.ref007">7</xref>], we established that the flies’ crash avoidance performance depended more on visuo-motor reflexes than on gravity perception. In order to understand those reflexes more deeply, we modeled a fly’s pitch rate control system based on optic flow cues (see Figs <xref ref-type="fig" rid="pcbi.1005894.g001">1</xref> and <xref ref-type="fig" rid="pcbi.1005894.g002">2</xref>) and compared the results obtained during model simulations with experimental free falling hoverflies. First, we focused on the pitch because we observed that during the period elapsing between the onset of the fall and wingbeat initiation, flies pitched down smoothly, probably because of the pin glued onto their thorax. Therefore, pitch was taken to be the main state to be controlled by the fly’s stabilizer to avoid crash. Secondly, since gravity cues do not seem to be involved in insect flight control [<xref ref-type="bibr" rid="pcbi.1005894.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref033">33</xref>], we assumed that fly’s flight control does not rely on any absolute vertical reference of the environment but that it is based rather on visual and inertial motion perception and compensation. We therefore based our model on previous studies on insects’ flight behaviour providing clear-cut evidence that optic flow-based control are involved during several tasks (for a review see [<xref ref-type="bibr" rid="pcbi.1005894.ref009">9</xref>]). We considered here that the forward speed was controlled by pitching-down from the nose the body and then orienting the force vector produced by flapping wings [<xref ref-type="bibr" rid="pcbi.1005894.ref034">34</xref>], as occurred in the case of the helicopter analogy [<xref ref-type="bibr" rid="pcbi.1005894.ref011">11</xref>]. The pitch rate is set so as to keep the forward optic flow constant, as found to occur in bees traveling in a textured corridor [<xref ref-type="bibr" rid="pcbi.1005894.ref010">10</xref>].</p>
<fig id="pcbi.1005894.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005894.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Main parameters of the model.</title>
<p>(A) We take the theoretical optic flow vector (<inline-formula id="pcbi.1005894.e001"><alternatives><graphic id="pcbi.1005894.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:msub><mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>) to be the opposite of the 3-D speed vector (<inline-formula id="pcbi.1005894.e002"><alternatives><graphic id="pcbi.1005894.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>) experienced by the hoverfly. We calculated a horizontal (<inline-formula id="pcbi.1005894.e003"><alternatives><graphic id="pcbi.1005894.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mi>ω</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>) and a vertical (<inline-formula id="pcbi.1005894.e004"><alternatives><graphic id="pcbi.1005894.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mi>ω</mml:mi> <mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>) component of this theoretical optic flow vector in the hoverfly’s reference frame (<italic>R</italic><sub><italic>fly</italic></sub>) depending on the estimated pitch orientation. (B) The force produced by the hoverflies’ flapping wings (<inline-formula id="pcbi.1005894.e005"><alternatives><graphic id="pcbi.1005894.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) is assumed to be orthogonally oriented with respect to the body pitch orientation [<xref ref-type="bibr" rid="pcbi.1005894.ref011">11</xref>]. Moving forward is then achieved by pitching down from the head and moving backward, or braking, by pitching up from the head. Lift force (<inline-formula id="pcbi.1005894.e006"><alternatives><graphic id="pcbi.1005894.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) corresponds to the vertical component of <inline-formula id="pcbi.1005894.e007"><alternatives><graphic id="pcbi.1005894.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> in the inertial reference frame and thrust force (<inline-formula id="pcbi.1005894.e008"><alternatives><graphic id="pcbi.1005894.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) to the horizontal component. As depicted in [<xref ref-type="bibr" rid="pcbi.1005894.ref035">35</xref>], we assumed a pure active control of the pitch torque which is seen to occur during a fraction of the wingstroke, about half of a wing beat period (i.e., about 2ms for an hoverfly, see [<xref ref-type="bibr" rid="pcbi.1005894.ref003">3</xref>]).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005894.g001" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005894.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005894.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Model block diagrams.</title>
<p>(A) Control of the pitch rate (<inline-formula id="pcbi.1005894.e009"><alternatives><graphic id="pcbi.1005894.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msub></mml:math></alternatives></inline-formula>) in response to horizontal optic flow component (<italic>ωx</italic><sub><italic>Rfly</italic></sub>). The measured <italic>ωx</italic><sub><italic>Rfly</italic></sub> is compared with an input reference set-point, <inline-formula id="pcbi.1005894.e010"><alternatives><graphic id="pcbi.1005894.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mi>ω</mml:mi> <mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, and the error (<italic>ϵ</italic><sub><italic>ω</italic></sub>) is then sent to a Proportional-Derivative controller, which delivers a reference pitch rate, <inline-formula id="pcbi.1005894.e011"><alternatives><graphic id="pcbi.1005894.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msubsup><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>p</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>. We then used a second loop mimicking the halteres, to measure and adjust the pitch rate, <inline-formula id="pcbi.1005894.e012"><alternatives><graphic id="pcbi.1005894.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, to this set-point. The pitch <italic>θ</italic><sub><italic>p</italic></sub> obtained by integration (by definition) is then used to calculate the orientation of the thrust and the speed vector in the inertial reference frame (see B). The norm of the force produced by flapping wings is assumed to correspond to a second order transfer function with a zero based on the data. The two components of the optic flow vector in the fly reference frame, <italic>ωx</italic><sub><italic>Rfly</italic></sub> and <italic>ωz</italic><sub><italic>Rfly</italic></sub>, are then calculated geometrically (see B). <italic>ωx</italic><sub><italic>Rfly</italic></sub> is used to close the pitch control loop. (B) Details of the pitch rate control based on horizontal optic flow component.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005894.g002" xlink:type="simple"/>
</fig>
<sec id="sec004">
<title>Closed-loop control of the body’s angular pitch rate via the halteres</title>
<p>The estimation of the pitch rate <inline-formula id="pcbi.1005894.e013"><alternatives><graphic id="pcbi.1005894.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mover accent="true"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msub> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> was assumed to be carried out by the halteres, in order to control in closed-loop the body’s rotational speed through a proportional-integral controller (<italic>PI</italic><sub><italic>H</italic></sub>), as previously proposed for fruitflies [<xref ref-type="bibr" rid="pcbi.1005894.ref035">35</xref>]:
<disp-formula id="pcbi.1005894.e014"><alternatives><graphic id="pcbi.1005894.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msub></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi> <mml:msub><mml:mi>I</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:mo>*</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>p</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msub> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>where</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>P</mml:mi> <mml:msub><mml:mi>I</mml:mi> <mml:mi>H</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>K</mml:mi> <mml:msub><mml:mi>i</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:mo>*</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>s</mml:mi></mml:mfrac> <mml:mo>+</mml:mo> <mml:mi>K</mml:mi> <mml:msub><mml:mi>p</mml:mi> <mml:mi>H</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
with <inline-formula id="pcbi.1005894.e015"><alternatives><graphic id="pcbi.1005894.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msubsup><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>p</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> the set point, <inline-formula id="pcbi.1005894.e016"><alternatives><graphic id="pcbi.1005894.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mover accent="true"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msub> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> the estimation of body’s rotational speed, <italic>Kp</italic> = 7 and <italic>Ki</italic> = 0.3 (see [<xref ref-type="bibr" rid="pcbi.1005894.ref035">35</xref>]) and <italic>s</italic> the Laplace variable (<inline-formula id="pcbi.1005894.e017"><alternatives><graphic id="pcbi.1005894.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>s</mml:mi></mml:mfrac></mml:math></alternatives></inline-formula> is a pure integrator).</p>
<p>In this study, we modelled the angular speed control of the body pitch with a closed-loop involving the halteres combined with a simplified dynamic of the wing pitch control (a first order transfer function with a 0.002<italic>s</italic> time constant) based on the observation that corrective manoeuvres in flies occur in a single wing stroke time order corresponding to approximately 2<italic>ms</italic> [<xref ref-type="bibr" rid="pcbi.1005894.ref003">3</xref>].</p>
</sec>
<sec id="sec005">
<title>Closed-loop control of the forward speed via the compound eyes</title>
<p>The pitch rate reference signal <inline-formula id="pcbi.1005894.e018"><alternatives><graphic id="pcbi.1005894.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msubsup><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>p</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> is provided by a proportional-derivative controller (<italic>C</italic><sub><italic>OF</italic></sub>(<italic>s</italic>)) based on the visual error between the measured forward optic flow (<inline-formula id="pcbi.1005894.e019"><alternatives><graphic id="pcbi.1005894.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:mi>ω</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>) and a constant setpoint (<inline-formula id="pcbi.1005894.e020"><alternatives><graphic id="pcbi.1005894.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:mi>ω</mml:mi> <mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>04</mml:mn> <mml:mi>c</mml:mi> <mml:mi>m</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>-</mml:mo></mml:msup> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>) arbitrary determined based on optic flow data (see <xref ref-type="sec" rid="sec013">Results</xref> section). A Proportional-Integral-Derivative (PID) controller was adopted in order to make the model as generic as possible and to keep in line with recent insect flight control studies [<xref ref-type="bibr" rid="pcbi.1005894.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref035">35</xref>]. <inline-formula id="pcbi.1005894.e021"><alternatives><graphic id="pcbi.1005894.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:mi>ω</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is considered in the fly’s reference frame as the longitudinal axis component of the overall optic flow vector, <inline-formula id="pcbi.1005894.e022"><alternatives><graphic id="pcbi.1005894.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mover accent="true"><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, experienced by the insects (see <xref ref-type="fig" rid="pcbi.1005894.g001">Fig 1</xref>). This measurement is based on the existence of the HS cells in the lobula plate, which are sensitive to horizontal optic flow in the flies’ visual field [<xref ref-type="bibr" rid="pcbi.1005894.ref019">19</xref>]:
<disp-formula id="pcbi.1005894.e023"><alternatives><graphic id="pcbi.1005894.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>p</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi> <mml:msub><mml:mi>D</mml:mi> <mml:mi>V</mml:mi></mml:msub> <mml:mo>*</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ω</mml:mi> <mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:msub><mml:mi>x</mml:mi> <mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:msub><mml:mi>D</mml:mi> <mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>K</mml:mi> <mml:msub><mml:mi>p</mml:mi> <mml:mi>V</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>K</mml:mi> <mml:msub><mml:mi>d</mml:mi> <mml:mi>V</mml:mi></mml:msub> <mml:mo>*</mml:mo> <mml:mfrac><mml:mi>s</mml:mi> <mml:mrow><mml:mi>τ</mml:mi> <mml:mi>s</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac> <mml:mtext>;</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>with</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>K</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mspace width="4.pt"/><mml:mtext>and</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>K</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mspace width="4.pt"/><mml:mtext>free</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>parameters</mml:mtext></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:msub><mml:mi>x</mml:mi> <mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:mover accent="true"><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>|</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>c</mml:mi> <mml:mi>o</mml:mi> <mml:mi>s</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:msub><mml:mi>V</mml:mi> <mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula></p>
</sec>
<sec id="sec006">
<title>Model of the flapping wing force dynamics</title>
<p>To model the force dynamics with the transfer function F(s), we first estimated the horizontal and vertical acceleration of the hoverfly during the experiment by applying a double derivation of the measured fly´s position using stereo reconstruction methods (see <xref ref-type="fig" rid="pcbi.1005894.g003">Fig 3</xref>). The accuracy of the position measurement is given by eqs <xref ref-type="disp-formula" rid="pcbi.1005894.e036">9</xref> and <xref ref-type="disp-formula" rid="pcbi.1005894.e037">10</xref>. The gravitational acceleration (<italic>g</italic> = −9.81) was subtracted from the vertical component and the overall acceleration produced by hoverflies was taken to be the vectorial summation of these two components <italic>Axy</italic> (the acceleration on the XY plane) and <italic>Az</italic> (the acceleration on the Z axis):
<disp-formula id="pcbi.1005894.e024"><alternatives><graphic id="pcbi.1005894.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi> <mml:mi>x</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:msqrt><mml:mrow><mml:mi>A</mml:mi> <mml:msup><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mi>A</mml:mi> <mml:msup><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:msqrt><mml:mrow><mml:mi>A</mml:mi> <mml:mi>x</mml:mi> <mml:msup><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mi>z</mml:mi> <mml:mo>-</mml:mo> <mml:mi>g</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
The data resulting from the double derivative procedure was filtered using a Savitzky-Golay filter of order 1 and with a frame length of 11. The force produced by the fly, <inline-formula id="pcbi.1005894.e025"><alternatives><graphic id="pcbi.1005894.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, due to the wingbeat corresponds to the response of a second order low-pass filter with time constants <italic>τ</italic><sub>1</sub> = 0.01<italic>ms</italic> and <italic>τ</italic><sub>2</sub> = 0.1<italic>ms</italic> and a zero, <italic>τ</italic><sub><italic>z</italic></sub> = 0.24, to a step (0 to −<italic>g</italic>, see <xref ref-type="fig" rid="pcbi.1005894.g002">Fig 2A</xref>) which determines the transfer function, noted <italic>C</italic><sub><italic>WB</italic></sub>(<italic>s</italic>) used to model the transient force production:
<disp-formula id="pcbi.1005894.e026"><alternatives><graphic id="pcbi.1005894.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>W</mml:mi> <mml:mi>B</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>F</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>U</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>24</mml:mn> <mml:mi>s</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>8955</mml:mn></mml:mrow> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>01</mml:mn> <mml:msup><mml:mi>s</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>1</mml:mn> <mml:mi>s</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac> <mml:mo>;</mml:mo> <mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mtext>with</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>U(s)</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>a</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>step</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>ranging</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>from</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>0</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>to</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>|g|.</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula></p>
<fig id="pcbi.1005894.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005894.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Setup and stereo reconstruction.</title>
<p>(A) The setup consists of a 40x40x40cm<sup>3</sup> box illuminated from above with a halogen light. Hoverflies were filmed in the box with a fast camera through a two-way mirror at a rate of 1600 frames per second in full resolution (1280 by 800 pixels). The mirror was tilted at an angle of 45° to make the hoverfly see a uniform white wall (i.e. the reflection of the white light-diffusing ceiling). A manual switch was used to trigger the camera and simultaneously turn off the power of the electromagnet, thus releasing the resting fly and causing it to fall. A set of mirrors was used to split the images, giving two different views of the experimental box. (B) Example of a split image obtained with the set of mirror with the two trajectories superimposed. The two trajectories were used to obtained a 3-D reconstruction with the MATLAB stereo vision toolbox.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005894.g003" xlink:type="simple"/>
</fig>
<p>The average lift vector was assumed to have a fixed position and orientation with respect to the body [<xref ref-type="bibr" rid="pcbi.1005894.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref011">11</xref>]. In addition, since hoverflies are known to hover keeping their body horizontal [<xref ref-type="bibr" rid="pcbi.1005894.ref004">4</xref>], an orthogonal relationship was assumed to exist between body and flapping wings’ force vector orientations. The orientation of the lift and thrust acceleration vectors are therefore calculated on the basis of both the simulated body pitch (<italic>θ</italic><sub><italic>p</italic></sub>) and the absolute force (<inline-formula id="pcbi.1005894.e027"><alternatives><graphic id="pcbi.1005894.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>) values as follows:
<disp-formula id="pcbi.1005894.e028"><alternatives><graphic id="pcbi.1005894.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi>L</mml:mi></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mi>π</mml:mi> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>*</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mi>T</mml:mi></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>c</mml:mi> <mml:mi>o</mml:mi> <mml:mi>s</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mi>π</mml:mi> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>*</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
The measured horizontal and vertical speed of the virtual insect are then calculated by integrating the forces L and T, and the x and z position by integrating the horizontal and vertical speeds as follows:
<disp-formula id="pcbi.1005894.e029"><alternatives><graphic id="pcbi.1005894.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>|</mml:mo></mml:mrow> <mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mi>F</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>|</mml:mo></mml:mrow> <mml:mi>c</mml:mi> <mml:mi>o</mml:mi> <mml:mi>s</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mi>F</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow> <mml:mspace width="1em"/><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mi>Z</mml:mi></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>z</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mi>X</mml:mi></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
The the optic flow used to control the pitch rate was then calculated on the basis of the horizontal and vertical speed components and the fly´s pitch orientation:
<disp-formula id="pcbi.1005894.e030"><alternatives><graphic id="pcbi.1005894.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo stretchy="true">→</mml:mo></mml:mover> <mml:mo>|</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mrow><mml:mo>|</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>a</mml:mi> <mml:mi>l</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>V</mml:mi> <mml:mi>R</mml:mi> <mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>V</mml:mi> <mml:mi>R</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow> <mml:mspace width="1em"/><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>ω</mml:mi> <mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo stretchy="true">→</mml:mo></mml:mover> <mml:mo>|</mml:mo> <mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>V</mml:mi> <mml:mi>R</mml:mi> <mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>ω</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo stretchy="true">→</mml:mo></mml:mover> <mml:mo>|</mml:mo> <mml:mi>c</mml:mi> <mml:mi>o</mml:mi> <mml:mi>s</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>V</mml:mi> <mml:mi>R</mml:mi> <mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math>
</alternatives> <label>(7)</label></disp-formula>
The body drag was neglected in our model as we observed in a previous study (supplementary material, [<xref ref-type="bibr" rid="pcbi.1005894.ref007">7</xref>]) that the range of flight speed experienced during free fall are always in a linear range.</p>
</sec>
<sec id="sec007">
<title>Model for passive body tilting during the free fall</title>
<p>In addition to the sensorimotor loops at work during flight stabilization after the free fall situation, we added a passive component standing for the physical dynamics of the insects’ body during the actual free fall phase. The inertia of the fly´s body was not measured explicitly but included in the closed-loop dynamics of the pitch dynamics denoted <italic>F</italic><sub><italic>H</italic></sub>(<italic>s</italic>) (see <xref ref-type="fig" rid="pcbi.1005894.g002">Fig 2B</xref>). This part of the model accounts for the passive torque that makes the fly pitching down before initiating the wingbeats. As shown in <xref ref-type="supplementary-material" rid="pcbi.1005894.s002">S2 Fig</xref> (supporting information), to estimate the passive pitch torque occurring before wingbeat initiation, we fitted a fifth-order transfer function, noted <italic>T</italic><sub><italic>passive</italic></sub>(<italic>s</italic>), directly to the averaged free fall pitch data of all the experimental essays (before wingbeat initiation):
<disp-formula id="pcbi.1005894.e031"><alternatives><graphic id="pcbi.1005894.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>T</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>a</mml:mi> <mml:mi>s</mml:mi> <mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mi>v</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>a</mml:mi> <mml:mi>s</mml:mi> <mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mi>v</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mi>U</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>001</mml:mn> <mml:msup><mml:mi>s</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mn>30</mml:mn> <mml:mi>s</mml:mi></mml:mrow> <mml:mrow><mml:msup><mml:mi>s</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>0011</mml:mn> <mml:msup><mml:mi>s</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>0005</mml:mn> <mml:msup><mml:mi>s</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>01</mml:mn> <mml:mi>s</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
with U(s) a step ranging from 0 to <inline-formula id="pcbi.1005894.e032"><alternatives><graphic id="pcbi.1005894.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> and <italic>θ</italic><sub><italic>passive</italic></sub> the passive component of the body pitch.</p>
<p>The wingbeats in the model, which was triggered at random time ranging from 75ms to 150ms after the start of the fall, defined the initial state values, <italic>Z</italic><sub><italic>i</italic></sub> (initial vertical position), <italic>Vz</italic><sub><italic>i</italic></sub> (initial vertical speed), <italic>θ</italic><sub><italic>pi</italic></sub> (initial pitch orientation) and <inline-formula id="pcbi.1005894.e033"><alternatives><graphic id="pcbi.1005894.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> (initial pitch rate). The two control loops based on the optic flow are then activated to compensate for the initial pitch disturbance.</p>
<p>A complete block diagram representation of the model is given in <xref ref-type="fig" rid="pcbi.1005894.g002">Fig 2</xref>. All the simulations were conducted with MATLAB-Simulink with a sampling period of 1/1600s (0.625ms), corresponding to the camera´ frame rate. In the simulations, hoverflies were assumed to move in a straight line equidistantly (20cm) from the two walls of an infinitely long corridor with a textured wall (see supporting information, <xref ref-type="supplementary-material" rid="pcbi.1005894.s001">S1 Fig</xref>), thus the optic flow vector was taken to be the opposite of the insect’s speed vector divided by the constant distance from the wall equal to 20cm (half of the box width).</p>
</sec>
</sec>
<sec id="sec008">
<title>Experiments on hoverflies</title>
<p>In order to parametrize the gains in the PD controller in charge of the visual optic flow process in the model (see <xref ref-type="fig" rid="pcbi.1005894.g002">Fig 2C</xref>), we conducted a series of experiments with hoverflies.</p>
<sec id="sec009">
<title>Animals</title>
<p>Hoverfly pupae (<italic>Episyrphus balteatus</italic>) were purchased (Katz Biotech AG, Baruth, Germany) and reared until hatching in a cage measuring 53x29x29cm<sup>3</sup>, which was subjected to a 12h light/12h dark cycle at a temperature of 25 ± 2.5°C. Newly hatched adults had <italic>ad libitum</italic> access to a pollen/sugar mixture and water, as well as to real flowers to stimulate flying behavior. A piece of entomological pin approximately 5 mm in length was glued to the dorsal part of the animals´ thorax, perpendicularly to their longitudinal axis (<xref ref-type="fig" rid="pcbi.1005894.g003">Fig 3A</xref>): the pin (≈ 5<italic>mg</italic>) weighed approximately 15% of the hoverfly’s mass (≈ 35<italic>mg</italic>). The animals´ flight and hovering abilities were then checked in the breeding cages. In the subsequent experiments, 14 hoverflies were tested (9 males and 5 females). Animals were aged from 3 to 21 days during the experiments.</p>
</sec>
<sec id="sec010">
<title>Experimental procedure</title>
<p>In the present study, hoverflies were subjected to free fall conditions in an upgraded version of the setup previously presented in [<xref ref-type="bibr" rid="pcbi.1005894.ref007">7</xref>]. An electromagnet (TEAC RL-1615) was used to suspend the insects with their legs dangling from the ceiling of a 40x40x40cm<sup>3</sup> box (see <xref ref-type="fig" rid="pcbi.1005894.g003">Fig 3A</xref>). The box was covered with a white diffuser (PMMA WH02, 3 mm thickness) and illuminated from above by a halogen light (Kaiser Studiolight H). Hoverflies were filmed through a two-way mirror with a fast camera (Phantom Miro M110) at a rate of 1600 frames per second at full resolution (1280 by 800 pixels). Four mirrors were used to split the camera’s field of view (FOV) into two sub FOVs with half resolution (640 by 800 pixels), giving us a stereo vision of the scene from which the flies’ 3-D trajectories could be reconstructed (see <xref ref-type="fig" rid="pcbi.1005894.g003">Fig 3B</xref>). Flies were then released to make them fall by switching off the magnetic field. The flies experienced near-weightlessness for a short period (less than 290ms maximally) before triggering their wingbeats.</p>
<p>A total number of 57 falls were conducted in the 40cm-high box, two sides of which were lined with horizontal black and white stripes 2.8cm wide, giving a spatial period of 0.06<italic>c</italic>/<italic>deg</italic> at a distance of 20cm. Three consecutive falls were conducted during each run; each individual can be subjected to several runs on different days. We always checked whether the hoverflies could fly with their glued pin in the breeding cages before and after each experiment to confirm that their flight abilities were not affected by the pin or if they crashed on the floor during previous experiment. Experimental data were taken into consideration from the initiation of the free fall to the instant when the hoverflies were able to either yield a positive vertical speed or fly for 300ms. After this maximal 300ms time window, we considered that the flight control might be based on other strategies rather than that consisting of maintaining a constant forward optic flow in a 40<sup>3</sup><italic>cm</italic><sup>3</sup> box.</p>
</sec>
<sec id="sec011">
<title>Image processing</title>
<p>The horizontal and vertical 2-D positions of the hoverflies image centroid moving over a uniform background were recorded in each split image using a MATLAB custom-made image processing program, and a 3-D trajectory was obtained using the MATLAB stereo vision toolbox. The stereo configuration produced by the set of mirrors was estimated with the MATLAB stereo vision toolbox to reduce construction errors.</p>
<p>To estimate the pitch orientation, head, thorax and abdomen positions were estimated in the two split images and the orientation of the longitudinal axis was reconstructed in 3-D. Pitch angles were assumed to range from <inline-formula id="pcbi.1005894.e034"><alternatives><graphic id="pcbi.1005894.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac></mml:math></alternatives></inline-formula> (head upward) to <inline-formula id="pcbi.1005894.e035"><alternatives><graphic id="pcbi.1005894.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> (head downward). We calculated a theoretical estimate of the optic flow vector experienced by hoverflies as the opposite of the instant speed vector divided by the distances to the lateral walls (ranging from 10 to 20cm approximately in the collected data), giving two vectors with the same orientation but two different norms. To simplify the estimation we only kept the vector with the maximal norm, produced by the nearest wall.</p>
<p>To measure the precision of our image processing, and especially that of our body pitch orientation estimation, the first method used consisted in assessing the resolving power of our stereo construction theoretically. The minimal measurable distance between two points (Δ<italic>d</italic>) in a standard dual camera could be calculated as follows [<xref ref-type="bibr" rid="pcbi.1005894.ref036">36</xref>]:
<disp-formula id="pcbi.1005894.e036"><alternatives><graphic id="pcbi.1005894.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>d</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="0.277778em"/><mml:mi>S</mml:mi> <mml:mi>W</mml:mi></mml:mrow> <mml:mrow><mml:mi>B</mml:mi> <mml:mi>L</mml:mi> <mml:mspace width="0.277778em"/><mml:mi>I</mml:mi> <mml:mi>W</mml:mi> <mml:mspace width="0.277778em"/><mml:mi>F</mml:mi> <mml:mi>L</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
where SW is the sensor width, BL is the distance between the two cameras, IW is the image width in pixels, FL is the focal length and d the distance to the object/point of interest. From the calibration of the stereo construction done with the MATLAB stereo toolbox we obtained <italic>BL</italic> = 333.5<italic>mm</italic>, <italic>FL</italic> = 30<italic>mm</italic> and <italic>d</italic><sub><italic>m</italic></sub> <italic>ax</italic> = 1531<italic>mm</italic> and <italic>d</italic><sub><italic>m</italic></sub> <italic>in</italic> = 1131<italic>mm</italic>, corresponding to the maximum and the minimum distances of the experimental box from the virtual cameras (front and back walls). The horizontal and vertical physical sensor sizes of the camera used during the experiments were 25.6<italic>mm</italic> and 16<italic>mm</italic>, respectively, and the horizontal and vertical image sizes were 1280 and 800 pixels, respectively. Δ<italic>d</italic> therefore ranged between 2.56<italic>mm</italic> and 4.68<italic>mm</italic>, which means that various points distants from each other by ≈ 0.5<italic>cm</italic> could be distinguished. This validate the estimation of orientation by the detection of the head and the tail of hoverflies with a body length ranging between approximately 1<italic>cm</italic> and 1.5<italic>cm</italic>. This resolution made it possible to calculate in 3d space the Quantization Positional Uncertainty (<italic>QPU</italic><sub><italic>rms</italic></sub>, see [<xref ref-type="bibr" rid="pcbi.1005894.ref036">36</xref>]) as follows:
<disp-formula id="pcbi.1005894.e037"><alternatives><graphic id="pcbi.1005894.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Q</mml:mi> <mml:mi>P</mml:mi> <mml:msub><mml:mi>U</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mi>m</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msqrt><mml:mn>12</mml:mn></mml:msqrt></mml:mfrac> <mml:mspace width="0.277778em"/><mml:msqrt><mml:mrow><mml:mo>Δ</mml:mo> <mml:msup><mml:mi>d</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>46</mml:mn> <mml:mo>;</mml:mo> <mml:mspace width="0.277778em"/><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>62</mml:mn> <mml:mo>]</mml:mo></mml:mrow> <mml:mi>m</mml:mi> <mml:mi>m</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
However, in addition to the uncertainty of our stereo reconstruction, our body pitch orientation estimates depend strongly on how precisely head and tail extremities of flies could be detected. In addition to the theoretical calculation of uncertainty, a calibration procedure was conducted to estimate the angular errors in the pitch orientation estimates (see <xref ref-type="supplementary-material" rid="pcbi.1005894.s005">S5 Fig</xref>). The errors associated with our procedure to estimate pitch orientation amount to approximately ±5° (0.08<italic>radians</italic>) but we note that the hoverflies´ yaw orientations may affect this estimation. The main problem with this detection method is that when flies are facing the camera, so they can be considered as a filled circle, it makes the recognition of head and tail almost impossible or at least unreliable. All the trials in which flies were facing camera during their fall were therefore eliminated from the analysis. However, for the present purposes, this error seems to have been sufficiently low since our data acquisition frequency (1600 Hz) allowed us to filter out any occasional erroneous data.</p>
</sec>
</sec>
<sec id="sec012">
<title>Estimating the parameters</title>
<p>The parameters of the visual Proportional-Derivative controller (<italic>PD</italic><sub><italic>V</italic></sub>), <italic>K</italic><sub><italic>p</italic></sub> and <italic>K</italic><sub><italic>d</italic></sub>, were estimated directly from experimental data. We first selected only the trials in which flies triggered their wingbeats in less than 150ms after the onset of the fall and were able to compensate for the fall by reaching a positive vertical speed (i.e., a lift force superior to their weight), amounting 44 experimental trials. A simulated falls was then achieved and compared with each of the selected falls as described above with several combinations of <italic>K</italic><sub><italic>p</italic></sub>, ranging from 0 to 20, and <italic>K</italic><sub><italic>d</italic></sub>, ranging from 0 to 2. A likelihood estimation (MLE) map was obtained for each fall, giving 44 maps in all, from which we extracted the average map shown in <xref ref-type="supplementary-material" rid="pcbi.1005894.s002">S2A Fig</xref>.</p>
</sec>
</sec>
<sec id="sec013" sec-type="results">
<title>Results</title>
<p>As shown in <xref ref-type="fig" rid="pcbi.1005894.g004">Fig 4A</xref> (top view), in the box lined up with stripes only on the lateral walls (<italic>X</italic> = −20/20), the hoverflies did not seem to express any kind of preference for a specific wall. As expected from our previous study, it can be seen from <xref ref-type="fig" rid="pcbi.1005894.g004">Fig 4B</xref> that no crash occured in presence of visual cues (horizontal periodic stripes) and that most of the trajectories ended with a rising flight, which confirm the ability of hoverflies to control their flight in the free fall tests. The initiation times of the wingbeats, around 100ms in average (see <xref ref-type="fig" rid="pcbi.1005894.g004">Fig 4C</xref>), are also coherent with our previous findings [<xref ref-type="bibr" rid="pcbi.1005894.ref007">7</xref>]. In this study, we selected only trials featuring a time to wingbeat triggering inferior to 150ms to keep a sufficient margin from the 200ms time limit, after which it is impossible for the fly to stop its fall and avoid crash onto the ground [<xref ref-type="bibr" rid="pcbi.1005894.ref007">7</xref>].</p>
<fig id="pcbi.1005894.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005894.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Measured 3D trajectories and wingbeat triggering times.</title>
<p>(A) Hoverflies’ XY trajectories in all the trials in which flight was initiated before 150ms. Trajectories were stopped at the moment were animals overpass 0<italic>cm</italic>.<italic>s</italic><sup>−1</sup> vertical speed. Green lines correspond to stabilized flights, blue one to non stabilized flights. Red arrows indicate the direction between the start and the end of stabilized flight. Red dotted lines give the outlines of the experimental box. The high-speed camera is positioned approximately in coordinate (0,-100). The values on the X-axis are width coordinates and those on the Y-axis are depth coordinate. (B) Height of the hoverflies’ flight during the trials in which flight was initiated before 150ms. Green lines correspond to stabilized flights, blue lines to non stabilized flights. (C) Histogram of the times to initiate wingbeat after the onset of the fall observed during the experiments. Distribution has been fitted with both normal (red) and lognormal (green) rules distribution giving mean Δ<sub><italic>WB</italic></sub> respectively equal to 103.121<italic>ms</italic> and 103.11<italic>ms</italic>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005894.g004" xlink:type="simple"/>
</fig>
<p><xref ref-type="fig" rid="pcbi.1005894.g005">Fig 5A</xref> (dark lines) shows the time course of the mean pitch orientation around the onset of the flies’ wingbeats. Hoverflies pitched down (i.e. head downward) when falling freely, but soon after initiating their wingbeats, they were able to compensate for the misalignment of their body tilt with respect to the horizontal within 150ms. Despite the existence of significant differences in pitch orientation at flight initiation, no difference were observed in terms of the final pitch orientation or correction times between late initiation (125–150<italic>ms</italic>), medium initiation (100–125<italic>ms</italic>) or early initiation (75–100<italic>ms</italic>), which shows the robustness of the reflex response involved.</p>
<fig id="pcbi.1005894.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005894.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Model’s responses to a free fall (1).</title>
<p>(A) Averaged simulated pitch orientation versus time in the 3 initiation time groups: 75 to 100ms (green line, top panel), 100 to 125ms (blue line, middle panel) and 125 to 150ms (red line, bottom panel). Gray lines are the experimental individual timelines. All the data were synchronized with the reference wingbeat triggering time: <italic>t</italic><sub><italic>WB</italic></sub> = 0. (B) Averaged simulated optic flows, <inline-formula id="pcbi.1005894.e038"><alternatives><graphic id="pcbi.1005894.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:mi>ω</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> (solid line) and <inline-formula id="pcbi.1005894.e039"><alternatives><graphic id="pcbi.1005894.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:mi>ω</mml:mi> <mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> (dashed line), versus time in the 3 initiation time group: 75 to 100ms (green line, top panel), 100 to 125ms (blue line, middle panel) and 125 to 150ms (red line, bottom panel). Gray lines show experimental data of <inline-formula id="pcbi.1005894.e040"><alternatives><graphic id="pcbi.1005894.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:mi>ω</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> (solid line, dark gray) and <inline-formula id="pcbi.1005894.e041"><alternatives><graphic id="pcbi.1005894.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:mi>ω</mml:mi> <mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> (dashed line, light gray).
<disp-formula id="pcbi.1005683.e048"><graphic id="pcbi.1005894.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e048" xlink:type="simple"/></disp-formula></p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005894.g005" xlink:type="simple"/>
</fig>
<p>In <xref ref-type="fig" rid="pcbi.1005894.g005">Fig 5B</xref> (dark lines), the mean theoretical optic flow was calculated versus time during free fall and flight recovery phases. The vertical component of <italic>ω</italic>, <italic>ωz</italic><sub><italic>Rfly</italic></sub>, increased to around 0.04<italic>rad</italic>.<italic>s</italic><sup>−1</sup> (for the latest initiation group) during the actual free fall and decreased quickly to zero after initiation of the wingbeats, whereas the horizontal component <italic>ωx</italic><sub><italic>RFly</italic></sub> decreased before the wingbeats was triggered and continue to decreased slightly after the initiation of the wingbeats and reached a mean steady state value of about −0.04<italic>rad</italic>.<italic>s</italic><sup>−1</sup> regardless of the initial conditions. This result supports the idea that hoverflies may control the optic flow in closed-loop so as to keep it constant during flight.</p>
<p>The results of the parameters identification, from which the parameters used during the simulations were selected, are presented in supporting information (<xref ref-type="supplementary-material" rid="pcbi.1005894.s002">S2 Fig</xref>). <xref ref-type="fig" rid="pcbi.1005894.g005">Fig 5</xref> shows the results of 150 simulated free falls into the virtual 40cm width corridor and the parameters used.</p>
<p>The initial values used in simulation were determined by randomly setting a wingbeat triggering time ranging between 75 and 150ms to fit the data range (<xref ref-type="fig" rid="pcbi.1005894.g004">Fig 4C</xref>). The initial state of the system (i.e. the wingbeat triggering state), <italic>θ</italic><sub><italic>P</italic></sub><italic>i</italic>, <inline-formula id="pcbi.1005894.e042"><alternatives><graphic id="pcbi.1005894.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>P</mml:mi></mml:msub> <mml:mi>i</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, <italic>Zi</italic> and <italic>V</italic><sub><italic>Z</italic></sub><italic>i</italic>, was obtained by simulating a free fall without any friction and adding a passive rotation of the body to the pitch dynamics before the onset of wingbeat triggering which was modeled by a third order transfer function (see supplementary materials, <xref ref-type="supplementary-material" rid="pcbi.1005894.s002">S2 Fig</xref>). The model accounted successfully for the dynamics of pitch orientation and optic flow observed experimentally during the 0.2s after the wingbeats initiation (see <xref ref-type="fig" rid="pcbi.1005894.g005">Fig 5</xref>).</p>
<p><xref ref-type="fig" rid="pcbi.1005894.g006">Fig 6A</xref> shows the time course of the mean acceleration produced by the hoverflies, estimated from experimental data after subtracting gravity acceleration. After wingbeat initiation, the acceleration increased immediately to a value around 10<italic>m</italic>.<italic>s</italic><sup>−2</sup>, which is equal to gravity acceleration absolute, during about 0.1<italic>s</italic>. After this initial phase, the acceleration increased within approximately 0.1<italic>s</italic> to a value of 25–30<italic>m</italic>.<italic>s</italic><sup>−2</sup>, representing 2.5-3 times the absolute value of gravity acceleration, followed by a slight descent phase to around 20<italic>m</italic>.<italic>s</italic><sup>−2</sup> at 0.4<italic>s</italic>. The force produced by flapping wings in the model was adjusted to these dynamics as shown in <xref ref-type="fig" rid="pcbi.1005894.g006">Fig 6A</xref> (green line). However, the acceleration estimated from 3-D trajectory data is really noisy and could result in some discrepancies between simulated and experimental data. As it can be seen from <xref ref-type="fig" rid="pcbi.1005894.g005">Fig 5B</xref>, the average Z position observed during the simulations shows that the model was able to counteract the fall but the values obtained did not completely match the experimental data on the hoverflies. Nor did the heave and surge speeds match experimental data: they rather showed the occurrence of instability after around 200ms (<xref ref-type="fig" rid="pcbi.1005894.g005">Fig 5C and 5D</xref>).</p>
<fig id="pcbi.1005894.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005894.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Model simulations in free fall (2).</title>
<p>(A) Simulated acceleration produced by the flapping wings with time (green line) and median from thrust data ± interquantile deviation (dark lines). Time zero corresponds to wingbeat initiation. (B) Averaged simulated flight height versus time corresponding to wingbeat initiation time ranging from 75 to 100ms (green lines), 100 to 125ms (blue lines) and 125 to 150ms (red lines). Vertical bars show the wingbeat triggering times with the same color code. Grey shadowed lines are the 44 experimental time courses of the flight height. (C) Averaged heave speeds observed experimentally (solid lines) and in the simulation (dotted lines) in the three wingbeat initiation group: 75 to 100ms (green lines), 100 to 125ms (blue lines) and 125 to 150ms (red lines). (D) Averaged surge speeds observed experimentally (solid lines) and in the simulation (dotted lines) in the three wingbeat initiation group: 75 to 100ms (green lines), 100 to 125ms (blue lines) and 125 to 150ms (red lines).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005894.g006" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec014" sec-type="conclusions">
<title>Discussion</title>
<p>In this study, control theory was used to model the pitch stabilization process at work in hoverflies placed in free fall situation, using simple rules based on optic flow measurements previously described in navigational tasks context [<xref ref-type="bibr" rid="pcbi.1005894.ref009">9</xref>]. We proposed a model (<xref ref-type="fig" rid="pcbi.1005894.g002">Fig 2</xref>) based on a virtual fly falling within a textured corridor accounting for the fly’s pitch and speed during about 200ms after the onset of the insect’s wingbeats. As in previous studies [<xref ref-type="bibr" rid="pcbi.1005894.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref014">14</xref>], we assumed that the pitch control and hence the lift and thrust force control processes rely on the closed-loop control of the pitch rate via the halteres combined with an OF-based feedback loop. In line with [<xref ref-type="bibr" rid="pcbi.1005894.ref035">35</xref>] and [<xref ref-type="bibr" rid="pcbi.1005894.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref014">14</xref>], we implemented in our model a pitch rate feedback-loop mimicking the halteres via a proportional-integrator (PI) controller. Recent results have suggested that sensory cues delivered by the eyes, halteres and antennae may interact via specific actions and coupling arrangements [<xref ref-type="bibr" rid="pcbi.1005894.ref037">37</xref>–<xref ref-type="bibr" rid="pcbi.1005894.ref039">39</xref>]. The present model involves then two nested feedback-loops, one featuring fast dynamics thanks to the halteres and one featuring much slower dynamics due to the presence of a double integrator between the pitch rate and the speed of the fly (see <xref ref-type="fig" rid="pcbi.1005894.g002">Fig 2</xref>). The OF was defined as the ratio between the fly’s speed and its distance to the wall which was constant during the fall and did not vary conspicuously during the 0.2s analyzed during insects’ flights. The simulated OF measurements are therefore very similar to the airspeeds apart from a different scaling due to <italic>d</italic><sub><italic>wall</italic></sub>. As shown in <xref ref-type="fig" rid="pcbi.1005894.g001">Fig 1</xref> and described by equation of <inline-formula id="pcbi.1005894.e043"><alternatives><graphic id="pcbi.1005894.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, the forward OF can be controlled directly by adjusting the fly’s speed <italic>V</italic><sub><italic>RI</italic></sub> and thus by controlling the pitch. As shown in <xref ref-type="fig" rid="pcbi.1005894.g005">Fig 5</xref>, a non-null forward OF component was observed during the fall due to a passive pitching of the fly.</p>
<p>We simplified the model of hoverflies´ flight dynamics by neglecting any coupling between the pitch control and the other two rotational axes (roll and yaw). There were two main reasons for focusing only on the hoverflies´ pitch attitude control:</p>
<list list-type="bullet">
<list-item><p>to minimize the complexity of the model´s control scheme. Our model does not account for the entire repertoire of the fly in terms of manoeuvrability such as bank turns. The main objective here was instead to assess the performances of a system limited to a translational optic flow-based strategy.</p></list-item>
<list-item><p>to take account for the fact that fly´ pitch responses was the only rotational axis affected during the free fall phase, probably due to the additional load of the entomological pin glued to the insect´ thorax. In view of the relatively straight trajectories observed in the XY plane (see <xref ref-type="fig" rid="pcbi.1005894.g004">Fig 4A</xref>), we then considered that the strategy used by hoverflies to stabilize their flight would mainly be an active pitch control.</p></list-item>
</list>
<p>The main characteristic of the model (see <xref ref-type="fig" rid="pcbi.1005894.g002">Fig 2</xref>) presented here is the total absence of any kind of vertical reference for controlling the pitch in the closed-loop system. This idea was based on previous data showing the absence of graviception in dipteran’s flight control [<xref ref-type="bibr" rid="pcbi.1005894.ref007">7</xref>]. This model accounts for the fly’s transient response during a period of up to approximately 0.2s from the onset of the flapping flight. However, as shown in <xref ref-type="fig" rid="pcbi.1005894.g004">Fig 4B</xref>, most of the stabilizing manoeuvres in response to the free fall situation occurred within 0.2s. The ability of the optic flow model to counteract the fall without requiring any information about the insect’s absolute orientation confirms that optic flow regulation, in addition to navigation processes, may play a stabilizing role [<xref ref-type="bibr" rid="pcbi.1005894.ref012">12</xref>]. Indeed, a slight tilting of the body and hence of the lift quickly led to a involuntary translation in the environment that results in generating optic flow. Thus, actuating the wingbeats motor system to cancel the generated OF would lead to correcting the attitude. In particular, during an instable flight, the gravity acceleration would induces a permanent increase in the speed toward the ground and a simple strategy such as maintaining a constant forward optic flow will therefore intrinsically induces the pitch to decrease with respect to the horizontal and therefore a restabilization. Indeed, as shown in, the drag force experienced during free fall can be neglected, at least in the range of our experimental paradigm, reinforcing the detection of any heave acceleration by the mean of optic flow variation. In addition, previous studies [<xref ref-type="bibr" rid="pcbi.1005894.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1005894.ref010">10</xref>] on speed regulation based on optic flow strategy validate the implementation of such feedback loops in flight control system. Future experiments would allow to better describe these sensorimotor regulation by using moving gratings on the walls of the box or a virtual reality setup [<xref ref-type="bibr" rid="pcbi.1005894.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref041">41</xref>] for example.</p>
<p>However, some instability in the model´s responses can be clearly seen to have occured after 300-400ms in <xref ref-type="fig" rid="pcbi.1005894.g006">Fig 6C</xref>. This means that a closed-loop pitch control system based only on the optic flow regulation does not suffice to maintain stable flight. Despite the presence of a fast closed-loop control of the pitch rate based on the halteres, a simple PD controller cannot be fast enough to stabilize a system featuring three integrators between the measured forward optic flow and the required pitch (see <xref ref-type="fig" rid="pcbi.1005894.g002">Fig 2</xref> and eqs <xref ref-type="disp-formula" rid="pcbi.1005894.e029">6</xref> and <xref ref-type="disp-formula" rid="pcbi.1005894.e030">7</xref>). Instead of increasing the complexity of the controller <italic>C</italic><sub><italic>OF</italic></sub>(<italic>s</italic>), we decided to improve the model shown in <xref ref-type="fig" rid="pcbi.1005894.g002">Fig 2</xref> by adding two biologically plausible feedback loops. First, we added a feedback loop controlling the lift based on the vertical flow <inline-formula id="pcbi.1005894.e044"><alternatives><graphic id="pcbi.1005894.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:msub><mml:mi>ω</mml:mi> <mml:mrow><mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:mi>R</mml:mi> <mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> through a proportional-integrator controller. The integrator cancels the vertical optic flow while keeping a non-null steady lift force, thus simulating the altitude control process observed in dipteran [<xref ref-type="bibr" rid="pcbi.1005894.ref042">42</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref043">43</xref>]. In addition, based on the existence of sensory mechanisms involved in the estimating pitch orientation such as the Dorsal Light Response and that based on an integration of the halteres’ and/or compound eyes’ signal, we added another pitch rate control loop including a Proportional-Derivative controller based on the absolute pitch orientation (<xref ref-type="fig" rid="pcbi.1005894.g007">Fig 7</xref>). Both additional PI and PD controllers has been set manually, gains are given in <xref ref-type="fig" rid="pcbi.1005894.g007">Fig 7</xref> and all model parameters are summarized in <xref ref-type="supplementary-material" rid="pcbi.1005894.s006">S1 Table</xref> (supporting information). These two optic flow and pitch feedback loops combined made it possible to stabilize the simulated pitch and height in steady state (<xref ref-type="fig" rid="pcbi.1005894.g008">Fig 8</xref>). The ability of the improved model to stabilize the hoverflies´ attitude thanks to the addition of a closed-loop control of the pitch orientation suggests therefore a complementary control strategy involving pitch rate, pitch and optic flow measurements. With the model parameters presented here, a single pitch feedback loop would be too slow to stabilize the fly within 200ms as required by the 40<italic>cm</italic>-high box. Although, the ability of flying insects to estimate their absolute orientation (on the pitch and roll axis) still gives rise to some controversy, the model developed here would certainly provide a basis for studying these sensorimotor reflexes and the coupling that may exists between the sensory modalities involved. It is worth noting that [<xref ref-type="bibr" rid="pcbi.1005894.ref012">12</xref>] have established that the pitch of an aerial robot can be stabilized without any need for absolute reference value by regulating the dorsal and ventral OF of a 2 degree-of-freedom flying robot. Still our simulation gives controversial results in an unsteady situation such as free-fall recovering. Probably because in their study the rotor forces are adjusted by another control based on ventral optic flow in regard to experimental observation in bees [<xref ref-type="bibr" rid="pcbi.1005894.ref044">44</xref>]. In addition to visual motion and attitude perception, we can also assume that the fly could probably relies on others sensorimotor reflexes such as those based, for example, on the expansion of the OF [<xref ref-type="bibr" rid="pcbi.1005894.ref045">45</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref046">46</xref>] that we did not challenge in this paper.</p>
<fig id="pcbi.1005894.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005894.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Block diagram of the improved model including a flapping wing force feedback control based on the vertical optic flow (green) and a pitch rate closed-loop control based on the absolute pitch measurement (purple).</title>
<p>(A) Diagram of the model including a feed-back control loop based on <italic>ω</italic><sub><italic>ZRfly</italic></sub> accounting for the force produced by flapping wings and a feed-back control loop based on <italic>θ</italic><sub><italic>p</italic></sub> accounting for the control of <inline-formula id="pcbi.1005894.e045"><alternatives><graphic id="pcbi.1005894.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:msubsup><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>p</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>. (B) Averaged (large solid line) and 10 samples (thin solid line) height measured during 150 simulations of free fall conducted with the new model. Model simulations results are presented in color (wingbeat triggering time of 75-100ms are shown in green, 100-125ms in blue and 125-150ms in red) and experimental data appears in grey. Inset shows the percentage of cumulated crash during 150 model simulations lasting 3 seconds. (C) Averaged heave (top panel) and surge speed (bottom panel) measured during the 150 simulations of free fall conducted with the new model. Model simulations are presented in dotted lines and experimental data in solid lines. Results are split in the three wingbeat initiation groups: 75-100ms are shown in green, 100-125ms in blue and 125-150ms in red.
<disp-formula id="pcbi.1005683.e049"><graphic id="pcbi.1005894.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e049" xlink:type="simple"/></disp-formula></p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005894.g007" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005894.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005894.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Experimental versus improved model responses in terms of pitch control dynamics.</title>
<p>(A) Left panels give experimental (grey: individuals; dark: mean) and the simulated (color shaded: 10 individual samples; color plain: mean) pitch orientation versus time corresponding to the 3 groups of initiation time: 75-100ms are shown in green, 100-125ms in blue and 125-150ms in red. (B) Right panels represent the experimental (grey: individuals; dark: mean) and the simulated (shadowed: individuals; dark: mean) optic flows (<inline-formula id="pcbi.1005894.e046"><alternatives><graphic id="pcbi.1005894.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:mi>ω</mml:mi> <mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>: dotted lines, <inline-formula id="pcbi.1005894.e047"><alternatives><graphic id="pcbi.1005894.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005894.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mrow><mml:mi>ω</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>f</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>: solid lines) versus time corresponding to the 3 groups of initiation time: 75-100ms are shown in green, 100-125ms in blue and 125-150ms in red.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005894.g008" xlink:type="simple"/>
</fig>
<p>The hoverflies rely probably on specific sensory channels to estimate its absolute attitude with respect to its environment (i.e. a vertical reference) and to control their attitude as shown by the comparison made here between the two versions of the present model. Although our setup did not include any salient cues such an artificial horizon, the light from above may stimulate the DLR [<xref ref-type="bibr" rid="pcbi.1005894.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref048">48</xref>] which could help insects to estimate their attitude. However, a significant improvement in the hoverflies’ ability to stop falling before crashing have been previously observed when the insects were placed in a striped box rather than uniform white environment [<xref ref-type="bibr" rid="pcbi.1005894.ref007">7</xref>]. The reflex controlling the lift force orientation may not therefore relies solely on a pitch feedback based on the position of the brightest part of the visual field. A combination between optic flow based and DLR-based control may possibly be involved. However, the exact role of the DLR and its contribution to the visual-driven stabilization of insects’ flight is still an open question.</p>
<p>It is proposed in the future to investigate more closely how a pitch orientation could be estimated by hoverflies’ sensory system. An argument supporting the idea that pitch estimation is involved in the hoverflies’ response to free fall situations is the relative independence of the responses in regard to the initial conditions. In contrary, our model was found to be over-shooting in short initiation times (75-100ms) and under-shooting in long initiation times (125-150ms). To study the processes that can underlie the insects’ pitch orientation estimation, we can start with some hypotheses:</p>
<list list-type="bullet">
<list-item>
<p>the integral of body’s angular speed measured by halteres. This hypothesis has been supported in particular in a study by [<xref ref-type="bibr" rid="pcbi.1005894.ref029">29</xref>] on <italic>drosophila</italic> showing the reliability of a PI control for halteres compensating manoeuvers. Nonetheless, it is questionable whether halteres can measure body’s angular speed before wingbeat initiation because halteres are strongly wingbeat dependent.</p>
</list-item>
<list-item>
<p>the rotational optic flow fields measured by the motion sensitive neurons may provide an estimation of the pitch rate and hence an estimation of the pitch also via its integral. Although, insects are known to be able to use the integral of translational optic flow for odometry purposes during navigation [<xref ref-type="bibr" rid="pcbi.1005894.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005894.ref049">49</xref>]. Despite, halteres influence optomotor responses and visual motion detection [<xref ref-type="bibr" rid="pcbi.1005894.ref038">38</xref>] and the same dependence on wingbeats may inhibit any measurement before wingbeats.</p>
</list-item>
<list-item>
<p>the ocelli response to a point light source (e.g. the sun) as a commonly accepted source for absolute (2-axis) body orientation reference [<xref ref-type="bibr" rid="pcbi.1005894.ref050">50</xref>].</p>
</list-item>
<list-item>
<p>the dorsal light response (DLR) may have been triggered by our overhead lighting. There exist no evidence so far, however, that the DLR is actually involved in dipteran flight control apart from head stabilization process [<xref ref-type="bibr" rid="pcbi.1005894.ref051">51</xref>]. Only in locusts, the DLR has been shown to be involved in steering manoeuvers [<xref ref-type="bibr" rid="pcbi.1005894.ref048">48</xref>].</p>
</list-item>
</list>
<p>The accuracy of these four hypotheses still remains to be determined, along with the question as to whether any vertical information is really carried by one or more of these processes combined. The comparison with the optic flow strategy made here should help to determine how these various channels combined may serve to maintain a stable attitude during flight.</p>
</sec>
<sec id="sec015">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005894.s001" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005894.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Schematic representation of the simulations.</title>
<p>In the simulations, the procedure was assumed to take place in an infinite corridor with textured walls. Numerically simulated hoverflies headed toward the corridor and their attitude varied only on the pitch degree-of-freedom. Since both yaw and roll are locked, they followed a straight line along the corridor. The optic flow therefore depended only on the insects’ surge speed.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005894.s002" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005894.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Estimation of the model’s parameters.</title>
<p>(A) Likelihood map averaged from the 44 parameters estimations. The histogram on the x- and y-axis give the distribution of the parameters selected with MLE procedure during individual estimations. (B) Pitch data before wingbeat initiation and step response of the transfer function <italic>T</italic><sub><italic>passive</italic></sub>(<italic>s</italic>) modeling the dynamics of the passive pitching down from the nose during the free-fall. Averaged data and standard deviation are represented in dark line and grey area. The simulation of a fall is represented by the blue line.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005894.s003" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005894.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title/>
<p><bold>1—At the beginning of the film the head of the flies is dotted on each image from the two point of views.</bold> 2—Three points are automatically tracked on each image of the flies: Head, thanks to the dot determined on the first image. Body, which is the centroid of the pixels’ mass. And tail, at the opposite extremity of the head. This step is repeated with 51 different binarization thresholds used for the body shape extraction (im2bw MATLAB function). 3—If head and tail are reversed during tracking, we can stop the tracking procedure, return to step 1 and start the automatic tracking again. 4—At the end of the tracking procedure, the 51x3x2D point clouds corresponding to each point of view are combined to construct 51x3x3D point clouds. From these clouds of points, pitch orientation of the body was determined at each time with 2 successive linear regression. First in the XY plane we estimate the yaw angle of the main body axis, the counter-rotation was applied to aligned this main axis with the X axis. Thus, in the ZX plane we can measure the main axis pitch orientation for each frame.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005894.s004" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005894.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Procedure used to quantify the errors in the pitch orientation estimates.</title>
<p>(A) Five 13mm long dummy hoverflies were printed in 3-D with a given orientation of their body in regard to their holding rod (ranging from 0° to 60°). They were suspended from a horizontal bar with two different yaw orientations, namely 0° and 90° and placed in 6 different positions on the horizontal plane of the experimental box (constant height: <italic>Z</italic> = 18<italic>cm</italic>). (B) A stereo system was used to track 3 body parts of the dummies, the head, the body center (the image centroid) and the tail from viewed from two different angles. (C) The 3-D reconstruction of the three parts of the dummy made it possible to reconstruct the 3-D body main axis and therefore to determine the dummy´ pitch orientation (see <xref ref-type="supplementary-material" rid="pcbi.1005894.s003">S3 Fig</xref>). A yaw orientation was estimated from the projection of the 3-D point cloud on the YX plane by performing a linear regression (<italic>x</italic> = <italic>f</italic>(<italic>y</italic>)) and the point cloud was corrected so as to align the main body axis with the Y axis. The pitch orientation was then estimated from the projection of the corrected 3-D point cloud in the ZY plane, again by performing a linear regression (<italic>z</italic> = <italic>f</italic>(<italic>y</italic>)).</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005894.s005" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005894.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Measurement of the pitch orientation estimation errors.</title>
<p>(A) Bar histogram of the whole angular error in the case of the 6 positions in the experimental box and the two imposed yaw orientation of the 5 dummies (<xref ref-type="supplementary-material" rid="pcbi.1005894.s004">S4A Fig</xref>) shown in blue bars. Probability density function estimated with a t-location scale distribution in the case of the whole data (red line), the 90° yaw oriented dummies (green line) and the 0° yaw oriented dummies (cyan line). (B) Boxplot of the angular error in the case of all the positions and dummies pitch orientation, depending on the dummies´ yaw orientation. (C) Angular error of estimation versus the pitch and yaw orientation of the avatars. (D) Angular error of estimation versus the position of the dummies on the horizontal plane of the experimental box.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005894.s006" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005894.s006" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Summary of the model parameters.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We are most thankful to Julien Diperi for his contribution to building the experimental set-up, to Marc Boyron for developing the electronics on which all the work presented in this paper was based, and to Jessica Blanc for correcting and improving the English in the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005894.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ellington</surname> <given-names>CP</given-names></name>. <article-title>The Aerodynamics of Hovering Insect Flight. II. Morphological Parameters</article-title>. <source>Philosophical Transactions of the Royal Society of London B: Biological Sciences</source>. <year>1984</year>;<volume>305</volume>(<issue>1122</issue>):<fpage>17</fpage>–<lpage>40</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.1984.0051" xlink:type="simple">10.1098/rstb.1984.0051</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sun</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Xiong</surname> <given-names>Y</given-names></name>. <article-title>Dynamic flight stability of hovering insects</article-title>. <source>Acta Mechanica Sinica</source>. <year>2007</year>;<volume>23</volume>(<issue>3</issue>):<fpage>231</fpage>–<lpage>246</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10409-007-0068-3" xlink:type="simple">10.1007/s10409-007-0068-3</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ristroph</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ristroph</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Morozova</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bergou</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Guckenheimer</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Active and passive stabilization of body pitch in insect flight</article-title>. <source>Journal of the Royal Society Interface</source>. <year>2013</year>;<volume>10</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2013.0237" xlink:type="simple">10.1098/rsif.2013.0237</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sun</surname> <given-names>M</given-names></name>. <article-title>Insect flight dynamics: Stability and control</article-title>. <source>Reviews of Modern Physics</source>. <year>2014</year>;<volume>86</volume>(<issue>2</issue>):<fpage>615</fpage>–<lpage>646</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/RevModPhys.86.615" xlink:type="simple">10.1103/RevModPhys.86.615</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref005">
<label>5</label>
<mixed-citation publication-type="other" xlink:type="simple">Hengstenberg R. Localization and Orientation in Biology and Engineering. Lectures Notes in Computer Science. Springer-Verlag Berlin Heidelberg; 1984. p. 121–133.</mixed-citation>
</ref>
<ref id="pcbi.1005894.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Taylor</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Krapp</surname> <given-names>HG</given-names></name>. <article-title>Sensory System and Flight Stability: What does Insects Measure and Why?</article-title> <source>Advances in Insect Physiology</source>. <year>2007</year>;<volume>34</volume>:<fpage>231</fpage>–<lpage>316</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0065-2806(07)34005-8" xlink:type="simple">10.1016/S0065-2806(07)34005-8</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Goulard</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Vercher</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Viollet</surname> <given-names>S</given-names></name>. <article-title>To crash or not to crash: how do hoverflies cope with free-fall situations and weightlessness?</article-title> <source>Journal of Experimental Biology</source>. <year>2016</year>;<volume>219</volume>(<issue>16</issue>):<fpage>2497</fpage>–<lpage>2503</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/jeb.141150" xlink:type="simple">10.1242/jeb.141150</ext-link></comment> <object-id pub-id-type="pmid">27535987</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fry</surname> <given-names>SN</given-names></name>, <name name-style="western"><surname>Rohrseitz</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Straw</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Dickinson</surname> <given-names>MH</given-names></name>. <article-title>Visual control of flight speed in Drosophila melanogaster</article-title>. <source>Journal of Experimental Biology</source>. <year>2009</year>;<volume>212</volume>(<issue>8</issue>):<fpage>1120</fpage>–<lpage>1130</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/jeb.020768" xlink:type="simple">10.1242/jeb.020768</ext-link></comment> <object-id pub-id-type="pmid">19329746</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Srinivasan</surname> <given-names>MV</given-names></name>. <article-title>Visual control of navigation in insects and its relevance for robotics</article-title>. <source>Current Opinion in Neurobiology</source>. <year>2011</year>;<volume>21</volume>:<fpage>535</fpage>–<lpage>543</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.conb.2011.05.020" xlink:type="simple">10.1016/j.conb.2011.05.020</ext-link></comment> <object-id pub-id-type="pmid">21689925</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Portelli</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Ruffier</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Roubieu</surname> <given-names>FL</given-names></name>, <name name-style="western"><surname>Franceschini</surname> <given-names>N</given-names></name>. <article-title>Honeybees’ Speed Depends on Dorsal as Well as Lateral, Ventral and Frontal Optic Flows</article-title>. <source>PLOS ONE</source>. <year>2011</year>;<volume>6</volume>(<issue>5</issue>):<fpage>e19486</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0019486" xlink:type="simple">10.1371/journal.pone.0019486</ext-link></comment> <object-id pub-id-type="pmid">21589861</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>David</surname> <given-names>CT</given-names></name>. <article-title>The relationship between body angle and flight speed in free-flying Drosophila</article-title>. <source>Physiological Entomology</source>. <year>1978</year>;<volume>3</volume>(<issue>3</issue>):<fpage>191</fpage>–<lpage>195</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1365-3032.1978.tb00148.x" xlink:type="simple">10.1111/j.1365-3032.1978.tb00148.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Expert</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Ruffier</surname> <given-names>F</given-names></name>. <article-title>Flying over uneven moving terrain based on optic-flow cues without any need for reference frames or accelerometers</article-title>. <source>Bioinspiration &amp; Biomimetics</source>. <year>2015</year>;<volume>10</volume>(<issue>2</issue>):<fpage>026003</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1088/1748-3182/10/2/026003" xlink:type="simple">10.1088/1748-3182/10/2/026003</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref013">
<label>13</label>
<mixed-citation publication-type="other" xlink:type="simple">Dickson WB, Straw AD, Poelma C, Dickinson MH. An integrative model of insect flight control. In: Proceedings of the 44th AIAA Aerospace Sciences Meeting and Exhibit; 2006. p. 31–38.</mixed-citation>
</ref>
<ref id="pcbi.1005894.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dickson</surname> <given-names>WB</given-names></name>, <name name-style="western"><surname>Straw</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Dickinson</surname> <given-names>MH</given-names></name>. <article-title>Integrative Model of Drosophila Flight</article-title>. <source>AIAA Journal</source>. <year>2008</year>;<volume>46</volume>(<issue>9</issue>):<fpage>2150</fpage>–<lpage>2164</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2514/1.29862" xlink:type="simple">10.2514/1.29862</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref015">
<label>15</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Egelhaaf</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Borst</surname> <given-names>A</given-names></name>. <chapter-title>Movement detection in arthropods</chapter-title>. In: <source>Visual Motion and its Role in the Stabilization of Gaze</source>. Eds. <name name-style="western"><surname>Miles</surname> <given-names>F.A.</given-names></name> and <name name-style="western"><surname>Wallman</surname> <given-names>J.</given-names></name>; <year>1993</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005894.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Borst</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Haag</surname> <given-names>J</given-names></name>. <article-title>Neural networks in the cockpit of the fly</article-title>. <source>Journal of Comparative Physiology A</source>. <year>2002</year>;<volume>188</volume>(<issue>6</issue>):<fpage>419</fpage>–<lpage>437</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00359-002-0316-8" xlink:type="simple">10.1007/s00359-002-0316-8</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hengstenberg</surname> <given-names>R</given-names></name>. <article-title>Common visual response properties of giant vertical cells in the lobula plate of the blowfly Calliphora</article-title>. <source>Journal of comparative physiology</source>. <year>1982</year>;<volume>149</volume>(<issue>2</issue>):<fpage>179</fpage>–<lpage>193</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00619212" xlink:type="simple">10.1007/BF00619212</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hausen</surname> <given-names>K</given-names></name>. <article-title>Motion sensitive interneurons in the optomotor system of the fly</article-title>. <source>Biological Cybernetics</source>. <year>1982</year>;<volume>45</volume>(<issue>2</issue>):<fpage>143</fpage>–<lpage>156</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00335241" xlink:type="simple">10.1007/BF00335241</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Krapp</surname> <given-names>HG</given-names></name>, <name name-style="western"><surname>Hengstenberg</surname> <given-names>B</given-names></name>. <article-title>Estimation of self-motion by optic flow processing in single visual interneurons</article-title>. <source>Nature</source>. <year>1996</year>;<volume>384</volume>:<fpage>463</fpage>–<lpage>466</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/384463a0" xlink:type="simple">10.1038/384463a0</ext-link></comment> <object-id pub-id-type="pmid">8945473</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stange</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Howard</surname> <given-names>J</given-names></name>. <article-title>An Ocellar Dorsal Light Response in a Dragonfly</article-title>. <source>Journal of Experimental Biology</source>. <year>1979</year>;<volume>83</volume>:<fpage>351</fpage>–<lpage>355</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005894.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stange</surname> <given-names>G</given-names></name>. <article-title>The Ocellar Component of Flight Equilibrium Control in Dragonflies</article-title>. <source>Journal of Comparative Physiology A</source>. <year>1981</year>;<volume>141</volume>:<fpage>335</fpage>–<lpage>347</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00609936" xlink:type="simple">10.1007/BF00609936</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stange</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Stowe</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Chahl</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Massaro</surname> <given-names>A</given-names></name>. <article-title>Anisotropic imaging in the dragonfly median ocellus: a matched filter for horizon detection</article-title>. <source>Journal of Comparative Physiology A</source>. <year>2002</year>;<volume>188</volume>:<fpage>455</fpage>–<lpage>467</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00359-002-0317-7" xlink:type="simple">10.1007/s00359-002-0317-7</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Taylor</surname> <given-names>CP</given-names></name>. <article-title>Contribution of Compound Eyes and Ocelli to Steering Of Locusts in Flight: I. Behavioural Analysis</article-title>. <source>Journal of Experimental Biology</source>. <year>1981</year>;<volume>93</volume>(<issue>1</issue>):<fpage>1</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005894.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Taylor</surname> <given-names>CP</given-names></name>. <article-title>Contribution Of Compound Eyes And Ocelli To Steering Of Locusts In Flight: II. Timing Changes in Flight Motor Units</article-title>. <source>Journal of Experimental Biology</source>. <year>1981</year>;<volume>93</volume>:<fpage>19</fpage>–<lpage>31</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005894.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Krapp</surname> <given-names>HG</given-names></name>. <article-title>Ocelli</article-title>. <source>Current Biology</source>. <year>2009</year>;<volume>19</volume>(<issue>11</issue>):<fpage>R435</fpage>–<lpage>R437</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cub.2009.03.034" xlink:type="simple">10.1016/j.cub.2009.03.034</ext-link></comment> <object-id pub-id-type="pmid">19515345</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nalbach</surname> <given-names>G</given-names></name>. <article-title>The halteres of the blowfly Calliphora</article-title>. <source>Journal of Comparative Physiology A</source>. <year>1993</year>;<volume>173</volume>:<fpage>293</fpage>–<lpage>300</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00212693" xlink:type="simple">10.1007/BF00212693</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hengstenberg</surname> <given-names>R</given-names></name>. <article-title>Mechanosensory control of compensatory head roll during flight in the blowfly Calliphora erythrocephala</article-title>. <source>Journal of Comparative Physiology A</source>. <year>1988</year>;<volume>163</volume>:<fpage>151</fpage>–<lpage>165</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00612425" xlink:type="simple">10.1007/BF00612425</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dickinson</surname> <given-names>M</given-names></name>. <article-title>Haltere-mediated equilibrium reflexes of th fruit fly, ıtDrosophila melanogaster</article-title>. <source>Philosophical Transactions of the Royal Society of London B</source>. <year>1999</year>;<volume>354</volume>:<fpage>903</fpage>–<lpage>916</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.1999.0442" xlink:type="simple">10.1098/rstb.1999.0442</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Beatus</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Guckenheimer</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>I</given-names></name>. <article-title>Controlling roll perturbations in fruit flies</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2015</year>;<volume>12</volume>(<issue>105</issue>):<fpage>20150075</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2015.0075" xlink:type="simple">10.1098/rsif.2015.0075</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ristroph</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Bergou</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Ristroph</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Coumes</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Berman</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Guckenheimer</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Discovering the flight autostabilizer of fruit flies by inducing aerial stumbles</article-title>. <source>PNAS</source>. <year>2010</year>;<volume>107</volume>(<issue>11</issue>):<fpage>4820</fpage>–<lpage>4824</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1000615107" xlink:type="simple">10.1073/pnas.1000615107</ext-link></comment> <object-id pub-id-type="pmid">20194789</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Taylor</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Luu</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ball</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Srinivasan</surname> <given-names>MV</given-names></name>. <article-title>Vision and air flow combine to streamline flying honeybees</article-title>. <source>Scientific Reports</source>. <year>2013</year>;<volume>3</volume> (<issue>2614</issue>).</mixed-citation>
</ref>
<ref id="pcbi.1005894.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fuller</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Straw</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Peek</surname> <given-names>MY</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Dickinson</surname> <given-names>MH</given-names></name>. <article-title>Flying <italic>Drosophila</italic> stabilize their vision-based velocity control by sensing wind with their antennae</article-title>. <source>PNAS</source>. <year>2014</year>; p. <fpage>E1182</fpage>–<lpage>E1191</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1323529111" xlink:type="simple">10.1073/pnas.1323529111</ext-link></comment> <object-id pub-id-type="pmid">24639532</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hengstenberg</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Sandeman</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Hengstenberg</surname> <given-names>B</given-names></name>. <article-title>Compensatory head roll in the blowfly Calliphora during flight</article-title>. <source>Proceedings of the Royal Society of London</source>. <year>1986</year>;<volume>227</volume>:<fpage>455</fpage>–<lpage>482</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rspb.1986.0034" xlink:type="simple">10.1098/rspb.1986.0034</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref034">
<label>34</label>
<mixed-citation publication-type="other" xlink:type="simple">Epstein M, Waydo S, Fuller SB, Dickson W, Straw A, Dickinson MH, et al. Biologically inspired feedback design for Drosophila flight. In: American Control Conference, 2007. ACC’07. IEEE; 2007. p. 3395–3401.</mixed-citation>
</ref>
<ref id="pcbi.1005894.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Whitehead</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Beatus</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Canale</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>I</given-names></name>. <article-title>Pitch perfect: how fruit flies control their body pitch angle</article-title>. <source>Journal of Experimental Biology</source>. <year>2015</year>;<volume>218</volume>:<fpage>3508</fpage>–<lpage>3519</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/jeb.122622" xlink:type="simple">10.1242/jeb.122622</ext-link></comment> <object-id pub-id-type="pmid">26385332</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>De Margerie</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Simonneau</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Caudal</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Houdelier</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lumineau</surname> <given-names>S</given-names></name>. <article-title>3D tracking of animals in the field using rotational stereo videography</article-title>. <source>Journal of Experimental Biology</source>. <year>2015</year>;<volume>218</volume>(<issue>16</issue>):<fpage>2496</fpage>–<lpage>2504</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/jeb.118422" xlink:type="simple">10.1242/jeb.118422</ext-link></comment> <object-id pub-id-type="pmid">26056245</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chan</surname> <given-names>WP</given-names></name>, <name name-style="western"><surname>Prete</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Dickinson</surname> <given-names>MH</given-names></name>. <article-title>Visual Input to the Efferent Control System of a Fly’s “Gyroscope”</article-title>. <source>Science</source>. <year>1998</year>;<volume>280</volume>(<issue>5361</issue>):<fpage>289</fpage>–<lpage>292</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.280.5361.289" xlink:type="simple">10.1126/science.280.5361.289</ext-link></comment> <object-id pub-id-type="pmid">9535659</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huston</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Krapp</surname> <given-names>HG</given-names></name>. <article-title>Nonlinear Integration of Visual and Haltere Inputs in Fly Neck Motor Neurons</article-title>. <source>The Journal of Neuroscience</source>. <year>2009</year>;<volume>29</volume>:<fpage>13097</fpage>–<lpage>13105</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.2915-09.2009" xlink:type="simple">10.1523/JNEUROSCI.2915-09.2009</ext-link></comment> <object-id pub-id-type="pmid">19846697</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kim</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Fitzgerald</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Maimon</surname> <given-names>G</given-names></name>. <article-title>Cellular evidence for efference copy in Drosophila visuomotor processing</article-title>. <source>Nat Neurosci</source>. <year>2015</year>;<volume>18</volume>(<issue>9</issue>):<fpage>1247</fpage>–<lpage>1255</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.4083" xlink:type="simple">10.1038/nn.4083</ext-link></comment> <object-id pub-id-type="pmid">26237362</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fry</surname> <given-names>SN</given-names></name>, <name name-style="western"><surname>Rohrseitz</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Straw</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Dickinson</surname> <given-names>MH</given-names></name>. <article-title>TrackFly: virtual reality for a behavioral system analysis in free-flying fruit flies</article-title>. <source>Journal of neuroscience methods</source>. <year>2008</year>;<volume>171</volume>(<issue>1</issue>):<fpage>110</fpage>–<lpage>117</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jneumeth.2008.02.016" xlink:type="simple">10.1016/j.jneumeth.2008.02.016</ext-link></comment> <object-id pub-id-type="pmid">18405978</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Straw</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Branson</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Neumann</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Dickinson</surname> <given-names>MH</given-names></name>. <article-title>Multi-camera real-time three-dimensional tracking of multiple flying animals</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2010</year>; p. rsif20100230.</mixed-citation>
</ref>
<ref id="pcbi.1005894.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Srinivasan</surname> <given-names>MV</given-names></name>. <article-title>A Visual-evoked Roll Response in the Housefly</article-title>. <source>Journal of Comparative Physiology A</source>. <year>1977</year>;<volume>119</volume>:<fpage>1</fpage>–<lpage>14</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00655868" xlink:type="simple">10.1007/BF00655868</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Straw</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Dickinson</surname> <given-names>MH</given-names></name>. <article-title>Visual Control of Altitude in Flying Drosophila</article-title>. <source>Current Biology</source>. <year>2010</year>;<volume>20</volume>:<fpage>1550</fpage>–<lpage>1556</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cub.2010.07.025" xlink:type="simple">10.1016/j.cub.2010.07.025</ext-link></comment> <object-id pub-id-type="pmid">20727759</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Portelli</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Ruffier</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Franceschini</surname> <given-names>N</given-names></name>. <article-title>Honeybees change their height to restore their optic flow</article-title>. <source>Journal of Comparative Physiology A</source>. <year>2010</year>;<volume>196</volume>(<issue>4</issue>):<fpage>307</fpage>–<lpage>313</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00359-010-0510-z" xlink:type="simple">10.1007/s00359-010-0510-z</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Reiser</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Dickinson</surname> <given-names>MH</given-names></name>. <article-title>Drosophila fly straight by fixating objects in the face of expanding optic flow</article-title>. <source>Journal of Experimental Biology</source>. <year>2010</year>;<volume>213</volume>(<issue>10</issue>):<fpage>1771</fpage>–<lpage>1781</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/jeb.035147" xlink:type="simple">10.1242/jeb.035147</ext-link></comment> <object-id pub-id-type="pmid">20435828</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Muijres</surname> <given-names>FT</given-names></name>, <name name-style="western"><surname>Elzinga</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Melis</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Dickinson</surname> <given-names>MH</given-names></name>. <article-title>Flies Evade Looming Targets by Executing Rapid Visually Directed Banked Turns</article-title>. <source>Science</source>. <year>2014</year>;<volume>344</volume>(<issue>6180</issue>):<fpage>172</fpage>–<lpage>177</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1248955" xlink:type="simple">10.1126/science.1248955</ext-link></comment> <object-id pub-id-type="pmid">24723606</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref047">
<label>47</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Fraenkel</surname> <given-names>GS</given-names></name>, <name name-style="western"><surname>Gunn</surname> <given-names>DL</given-names></name>. <source>The orientation of animals: Kineses, taxes and compass reactions</source>. <volume>vol. x</volume>. <publisher-loc>Oxford, England</publisher-loc>: <publisher-name>Dover</publisher-name>; <year>1961</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005894.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Goodman</surname> <given-names>LJ</given-names></name>. <article-title>The Role Of Certain Optomotor Reactions In Regulating Stability In The Rolling Plane During Flight In The Desert Locust, Schistocerca Gregaria</article-title>. <source>Journal of Experimental Biology</source>. <year>1965</year>;<volume>42</volume>:<fpage>385</fpage>–<lpage>407</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005894.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cope</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Sabo</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gurney</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Vasilaki</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Marshall</surname> <given-names>JAR</given-names></name>. <article-title>A Model for an Angular Velocity-Tuned Motion Detector Accounting for Deviations in the Corridor-Centering Response of the Bee</article-title>. <source>PLOS Computational Biology</source>. <year>2016</year>;<volume>12</volume>(<issue>5</issue>):<fpage>e1004887</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004887" xlink:type="simple">10.1371/journal.pcbi.1004887</ext-link></comment> <object-id pub-id-type="pmid">27148968</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005894.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schuppe</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hengstenberg</surname> <given-names>R</given-names></name>. <article-title>Optical properties of the ocelli of Calliphora erythrocephala and their role in the dorsal light response</article-title>. <source>Journal of Comparative Physiology A</source>. <year>1993</year>; p. <fpage>143</fpage>–<lpage>149</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005894.ref051">
<label>51</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hengstenberg</surname> <given-names>R</given-names></name>. <source>Visual Motion and its Role in the Stabilization of Gaze</source>. <publisher-name>Elsevier Science</publisher-name>; <year>1993</year>. p. <fpage>285</fpage>–<lpage>298</lpage>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>