<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01971</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005430</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data acquisition</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Linguistics</subject><subj-group><subject>Phonology</subject><subj-group><subject>Syllables</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Computer architecture</subject><subj-group><subject>Computer hardware</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Acoustics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Human factors engineering</subject><subj-group><subject>Man-computer interface</subject><subj-group><subject>Graphical user interface</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Computer architecture</subject><subj-group><subject>User interfaces</subject><subj-group><subject>Graphical user interface</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Bioassays and physiological analysis</subject><subj-group><subject>Electrophysiological techniques</subject><subj-group><subject>Brain electrophysiology</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Brain electrophysiology</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Brain electrophysiology</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Brain electrophysiology</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Brain mapping</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Clinical medicine</subject><subj-group><subject>Clinical neurophysiology</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Electroencephalography</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Hard real-time closed-loop electrophysiology with the Real-Time eXperiment Interface (RTXI)</article-title>
<alt-title alt-title-type="running-head">The Real-Time eXperiment Interface (RTXI)</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3069-0634</contrib-id>
<name name-style="western">
<surname>Patel</surname> <given-names>Yogi A.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>George</surname> <given-names>Ansel</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Dorval</surname> <given-names>Alan D.</given-names></name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1073-2638</contrib-id>
<name name-style="western">
<surname>White</surname> <given-names>John A.</given-names></name>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Christini</surname> <given-names>David J.</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="fn" rid="econtrib001"><sup>‡</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1806-0621</contrib-id>
<name name-style="western">
<surname>Butera</surname> <given-names>Robert J.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
<xref ref-type="fn" rid="econtrib001"><sup>‡</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Bioengineering Graduate Program, Georgia Institute of Technology, Atlanta, Georgia, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Biomedical Engineering, Georgia Institute of Technology and Emory University, Atlanta, Georgia, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Physiology and Biophysics, Weill Cornell Medical College, New York, New York, United States of America</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Department of Bioengineering, University of Utah, Salt Lake City, Utah, United States of America</addr-line>
</aff>
<aff id="aff005">
<label>5</label>
<addr-line>Department of Biomedical Engineering, Boston University, Boston, Massachusetts, United States of America</addr-line>
</aff>
<aff id="aff006">
<label>6</label>
<addr-line>School of Electrical and Computer Engineering, Georgia Institute of Technology, Atlanta, Georgia, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Poisot</surname> <given-names>Timothée</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Universite de Montreal, CANADA</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item>
<p><bold>Conceptualization:</bold> RJB DJC JAW ADD YAP AG.</p>
</list-item>
<list-item>
<p><bold>Data curation:</bold> YAP AG RJB.</p>
</list-item>
<list-item>
<p><bold>Formal analysis:</bold> YAP RJB.</p>
</list-item>
<list-item>
<p><bold>Funding acquisition:</bold> RJB DJC JAW ADD.</p>
</list-item>
<list-item>
<p><bold>Investigation:</bold> RJB DJC JAW ADD YAP AG.</p>
</list-item>
<list-item>
<p><bold>Methodology:</bold> RJB DJC JAW ADD YAP AG.</p>
</list-item>
<list-item>
<p><bold>Project administration:</bold> RJB DJC JAW ADD.</p>
</list-item>
<list-item>
<p><bold>Resources:</bold> RJB DJC JAW ADD.</p>
</list-item>
<list-item>
<p><bold>Software:</bold> YAP AG.</p>
</list-item>
<list-item>
<p><bold>Supervision:</bold> RJB DJC JAW ADD.</p>
</list-item>
<list-item>
<p><bold>Validation:</bold> RJB DJC JAW ADD YAP AG.</p>
</list-item>
<list-item>
<p><bold>Visualization:</bold> YAP AG.</p>
</list-item>
<list-item>
<p><bold>Writing – original draft:</bold> YAP.</p>
</list-item>
<list-item>
<p><bold>Writing – review &amp; editing:</bold> RJB DJC JAW ADD YAP AG.</p>
</list-item>
</list>
</p>
</fn>
<fn fn-type="other" id="econtrib001">
<p>‡ These authors are joint senior authors on this work.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">dchristi@med.cornell.edu</email> (DJC); <email xlink:type="simple">rbutera@gatech.edu</email> (RJB)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>5</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>30</day>
<month>5</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>5</issue>
<elocation-id>e1005430</elocation-id>
<history>
<date date-type="received">
<day>2</day>
<month>12</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>10</day>
<month>2</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Patel et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005430"/>
<abstract>
<p>The ability to experimentally perturb biological systems has traditionally been limited to static pre-programmed or operator-controlled protocols. In contrast, real-time control allows dynamic probing of biological systems with perturbations that are computed on-the-fly during experimentation. Real-time control applications for biological research are available; however, these systems are costly and often restrict the flexibility and customization of experimental protocols. The Real-Time eXperiment Interface (RTXI) is an open source software platform for achieving hard real-time data acquisition and closed-loop control in biological experiments while retaining the flexibility needed for experimental settings. RTXI has enabled users to implement complex custom closed-loop protocols in single cell, cell network, animal, and human electrophysiology studies. RTXI is also used as a free and open source, customizable electrophysiology platform in open-loop studies requiring online data acquisition, processing, and visualization. RTXI is easy to install, can be used with an extensive range of external experimentation and data acquisition hardware, and includes standard modules for implementing common electrophysiology protocols.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000070</institution-id>
<institution>National Institute of Biomedical Imaging and Bioengineering</institution>
</institution-wrap>
</funding-source>
<award-id>R01RR020115 and R01EB016407</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Christini</surname> <given-names>David J.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was funded by NIH grants R01RR020115 and R01EB016407 to DJC. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="0"/>
<page-count count="22"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-06-13</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Performance data included within this manuscript can be found on the RTXI website (rtxi.org). Data depicted in the use cases section of the manuscript can only be obtained by contacting authors of the respective studies.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Software paper.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Advances in stimulation (electrical, optical, biochemical) and measurement (electrical, biochemical, optical) techniques have increased the spatial and temporal resolution with which researchers can monitor or perturb biological activity. Using such tools and techniques in a closed-loop paradigm, where an acquired signal is used to compute the system output, can enable observation of physiological function, development and validation of computational models, as well as investigation of causal relationships in biological systems. This requires closed-loop control that operates on timescales that are physiologically relevant, which span tens of microseconds at the ion channel level to minutes at the behavioral level. Furthermore, the closed-loop control needs to be hard real-time (RT)—operating on a strict schedule for acquisition, processing, and yielding a computationally determined output with guaranteed performance bounds appropriate for the timescales of interest. Such hard RT, closed-loop control is implemented in industrial applications (e.g, aerospace, robotics, stock markets); however its use in biological research is stymied due to the relative high cost of commercial systems, and lack of flexibility in customizing closed-loop protocols, performance, and features.</p>
<p>The Real-Time Experiment Interface (RTXI, <ext-link ext-link-type="uri" xlink:href="http://www.rtxi.org" xlink:type="simple">http://www.rtxi.org</ext-link>, <xref ref-type="fig" rid="pcbi.1005430.g001">Fig 1</xref>) is an open source software platform for hard RT, closed-loop data acquisition (DAQ) and experimental control in biological experiments used by over 70 labs worldwide. This manuscript provides a technical and practical overview of RTXI’s architecture and features, as well as highlights select novel applications. Functionality of RTXI’s architecture and features has been validated both computationally through load testing and performance characterization, and experimentally in multiple setups of different biological systems and varying time scales.</p>
<fig id="pcbi.1005430.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005430.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Screenshot of arbitrary RTXI workspace with core and custom modules.</title>
<p>The workspace is intended to demonstrate the level of user-configurability provided by RTXI, such as channel configurations, combinations of data I/O connections, and saving virtually every programmed element of each module. Additional custom modules are shown (e.g., Spike Detector, FIR Filter, Signal Generator, Neuron Model, etc) to demonstrate the versatility of RTXI’s API system for creation of any utility or model to be used in hard RT, closed-loop experiments. We refer the reader to the up-to-date user manual (<xref ref-type="supplementary-material" rid="pcbi.1005430.s003">S3 File</xref>) and tutorials (<xref ref-type="supplementary-material" rid="pcbi.1005430.s003">S3 File</xref>) available online for more information on how to navigate the RTXI workspace.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005430.g001" xlink:type="simple"/>
</fig>
<p>RTXI is based on Xenomai, a Real-Time Linux framework [<xref ref-type="bibr" rid="pcbi.1005430.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1005430.ref002">2</xref>] and can be run or installed on any desktop PC by using the Live CD or by manually compiling the source code. RTXI can interface with an extensive range of external experimentation and data acquisition hardware, and includes standard modules for implementing commonly used electrophysiology protocols. Modules contain function-specific code that can be used in combinations to build custom workflows, experimental protocols, and interfaces, thereby eliminating the need to code all aspects of each experiment protocol from scratch. The power, flexibility, and stability of RTXI has made it possible for users to implement complex custom closed-loop protocols in a variety of cardiac [<xref ref-type="bibr" rid="pcbi.1005430.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1005430.ref007">7</xref>] and neuronal systems at the single cell [<xref ref-type="bibr" rid="pcbi.1005430.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005430.ref009">9</xref>], cell network [<xref ref-type="bibr" rid="pcbi.1005430.ref010">10</xref>], animal, and human electrophysiology [<xref ref-type="bibr" rid="pcbi.1005430.ref011">11</xref>] levels. Dozens of publications (<xref ref-type="supplementary-material" rid="pcbi.1005430.s003">S3 File</xref>) have used RTXI. Examples include investigation of the contribution of specific ion channels or synaptic receptors to spiking and bursting activity in a variety of neuronal cell types, oscillatory behavior of pacemaker neurons [<xref ref-type="bibr" rid="pcbi.1005430.ref012">12</xref>], the effect of network topology and intrinsic neuronal properties on population activity in a hybrid network [<xref ref-type="bibr" rid="pcbi.1005430.ref013">13</xref>], and effects of transcranial alternating current stimulation (tACS) on cortical activity [<xref ref-type="bibr" rid="pcbi.1005430.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1005430.ref014">14</xref>]. Each example utilized RTXI to create a custom, hard RT closed-loop protocol with the goal of dynamically probing the target system.</p>
</sec>
<sec id="sec002">
<title>Design and implementation of the Real-Time eXperiment Interface</title>
<sec id="sec003">
<title>System architecture</title>
<p>An RT control system for closed-loop control typically runs in an iterative computational loop with the smallest possible nominal cycle period, a minimum amount of cycle-to-cycle variation (jitter) in the actual period, and the shortest possible system latency (delay from input to computed output) determined by the specific application [<xref ref-type="bibr" rid="pcbi.1005430.ref015">15</xref>]. Standard desktop computer operating systems, including Linux, are built upon a monolithic kernel whose scheduler is engineered to balance distribution of resources amongst the various active threads and respond to hardware and software triggered interrupts in a resource-efficient manner. This results in standard desktop operating systems providing only “soft” RT performance. In soft RT systems, occurrence and timing of data acquisition, processing, and output generation events is neither guaranteed nor bounded. A lack of such guarantees can lead to substantial, yet often unnoticed, effects in experimental control [<xref ref-type="bibr" rid="pcbi.1005430.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1005430.ref018">18</xref>]. For example, in the case of dynamic clamp [<xref ref-type="bibr" rid="pcbi.1005430.ref019">19</xref>–<xref ref-type="bibr" rid="pcbi.1005430.ref022">22</xref>], a soft RT system may occasionally wait so long to compute the injected current that the actual value of the membrane potential has changed significantly in the meantime. The resulting experimental dynamics may look acceptable but still be wrong, since they are based on incorrect assumptions about the state of the cell. In practice, this means that phase-dependent stimulation may be delayed or occur at the incorrect physiologically-relevant time.</p>
<p>To achieve hard real-time performance, RTXI uses a Real-Time Operating System (RTOS). An RTOS enables hard RT performance by modifying the operating system’s native kernel architecture to enable priority-based pre-emption of processes, allocation of memory, and communication with on-board hardware for data and file I/O. To enable hard RT control, RTXI uses Xenomai, a real-time framework, which installs a micro-kernel alongside the standard Linux kernel. The micro-kernel consists of its own scheduler and interrupt handler and places the standard Linux kernel in a low-priority state, allowing dedicated processes to be prioritized. For example, Xenomai’s prioritization of RTXI enables hard RT control of periodic tasks such as sampling from experimental equipment, performing computations, and generating output signals. The use of an RTOS also minimizes system and hardware latencies, resulting in faster sampling rates, computation times, and file I/O. For some experimental designs with closed-loop feedback, a higher sampling rate also improves the stability of the protocol [<xref ref-type="bibr" rid="pcbi.1005430.ref023">23</xref>].</p>
</sec>
<sec id="sec004">
<title>Application architecture</title>
<p>RTXI is written in C/C++ and utilizes three threads to process: 1) hard RT data acquisition and experimental control, 2) user interactions, and 3) data storage. <xref ref-type="fig" rid="pcbi.1005430.g002">Fig 2</xref> provides an overview of the complete system architecture. The RT thread is instantiated with the highest system priority and controlled by the micro-kernel. The second user interface and experience (UI/UX) thread, powered by the Qt [<xref ref-type="bibr" rid="pcbi.1005430.ref024">24</xref>] and Qwt [<xref ref-type="bibr" rid="pcbi.1005430.ref025">25</xref>] graphical user interface (GUI) frameworks, processes user inputs to RTXI and online data visualization in soft RT. The final soft RT thread continuously reads and writes data to disk. With the advent of multi-core desktop computers, users are also able to instantiate additional soft RT threads for online data processing. All threads run in the same process address space, making it easy to share data for processing, updating visualizations, and data storage. RTXI’s architecture allows it to be used as an open-loop experimental control and data acquisition system [<xref ref-type="bibr" rid="pcbi.1005430.ref026">26</xref>–<xref ref-type="bibr" rid="pcbi.1005430.ref029">29</xref>], or even as a simulation environment.</p>
<fig id="pcbi.1005430.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005430.g002</object-id>
<label>Fig 2</label>
<caption>
<title>System architecture.</title>
<p>The bottom block depicts the hardware layer with which RTXI interfaces. RTXI is capable of interfacing with DAQs using either PCI/PCIe, USB, or Ethernet interfaces (see Compatible hardware for more information). Hard RT communication with hardware devices is achieved through Analogy, a set of drivers within the Xenomai framework. The top block of the diagram illustrates the core architecture of RTXI. On each cycle of the RT period, the RT Thread wakes up, acquires new data, executes instructions defined within the hard RT function of both core and user modules (see Custom modules and Application Programming Interface (API)), outputs data to the DAQ, and returns to sleep (idle). Transmission of data to/from different modules is handled by the <monospace>IO</monospace> class. When the RT Thread is idle, resources are made available to other system applications and functions. The GUI and Data Storage Threads continuously run with a static period to provide a stable balance between hard RT performance and handling of user input, updating of visualizations, and data storage.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005430.g002" xlink:type="simple"/>
</fig>
<p>The RT thread wakes on each clock cycle and executes all DAQ operations, module functions, and RT system functions. Module functions refer to both base system operations, such as transmitting data across modules and writing data to system buffers, and all RT operations implemented within custom modules. During this step, modules can post RT events—which notify other modules about state changes and user-initiated events, e.g., unloading or loading of new modules—to queue. These events are then executed by the RT thread once all module computations are complete.</p>
<p>An important advantage of this modular application architecture is the ability to load and unload both core system and user-created modules, change parameters, and modify any system variable online without halting closed-loop execution or affecting hard RT performance. Commercial systems, such as Simulink (MathWorks, Natick, MA), Signal (Cambridge Electronic Design, Cambridge, England), LabVIEW (National Instruments, Austin, TX), and Tucker David Technologies (Alachua, FL) typically require halting execution and recompiling the modified loop prior to being able to continue execution. Open-source platforms, such as NeuroRighter [<xref ref-type="bibr" rid="pcbi.1005430.ref029">29</xref>], MANTA [<xref ref-type="bibr" rid="pcbi.1005430.ref030">30</xref>], PLDAPS [<xref ref-type="bibr" rid="pcbi.1005430.ref031">31</xref>], and the Open Ephys GUI [<xref ref-type="bibr" rid="pcbi.1005430.ref032">32</xref>], provide closed-loop control with varying degrees of flexibility, but none enable hard RT closed-loop control. Such limitations are not ideal for investigation of causal relationships in biological systems.</p>
<p>RTXI enables users to create custom real-time algorithms and protocols for closed-loop processing and visualization. Debugging custom algorithms and protocols can be difficult in a hard real-time environment, especially without expertise or knowledge on how to probe the Linux kernel during execution. To ease the process of developing hard real-time algorithms and protocols, RTXI can be easily configured to run in non-real-time (non-RT) mode with debugging support. This configuration option is provided by the RTXI installation scripts and is outlined on the RTXI website (<xref ref-type="supplementary-material" rid="pcbi.1005430.s003">S3 File</xref>). When run in non-RT mode, users can obtain a tracelog of events to identify where and why the system crashed, occurrence of race conditions, and system resource usage.</p>
</sec>
<sec id="sec005">
<title>Compatible hardware</title>
<p>RTXI interfaces with experiments through a variety of hardware interfaces, including PCI/PCIe based DAQs from National Instruments and Sensoray, Ethernet based devices such as cameras and commercial amplifiers, as well as USB-based acquisition devices (<xref ref-type="supplementary-material" rid="pcbi.1005430.s003">S3 File</xref>). The hardware used with RTXI should be chosen based upon the hard RT needs of the custom protocol. Devices interfacing through the PCI/PCIe and Ethernet interfaces are capable of providing hard RT closed-loop performance with the appropriate drivers. PCI/PCIe hardware can achieve sub-millisecond latencies, while Ethernet devices can provide millisecond latencies. USB devices can provide closed-loop functionality with the appropriate driver, but the non-deterministic bounds of the USB protocol prevent hard RT control.</p>
</sec>
<sec id="sec006">
<title>Portability and sharing</title>
<p>RTXI allows users to move developed and tested modules, algorithms, and entire closed-loop protocols from one computer to another without significant overhead. Once the workflow and protocol have been set up, the entire workspace can be saved to an XML-based workspace settings file. This file saves all core system specifications set by the user, loaded modules along with their parameter and state values, and connections between modules. The settings file can then be used on any other computer with RTXI and the appropriate modules installed to restore the workspace. Furthermore, existing workspace settings files can be used as a starting point for creating new experimental protocols. This reduces the chances of errors when setting up a complex protocol with many modules and provides an easy mechanism for sharing custom protocols. Users can share all elements of their custom protocols—modules, settings files, screenshots, data, etc—on RTXI’s GitHub page (<xref ref-type="supplementary-material" rid="pcbi.1005430.s003">S3 File</xref>).</p>
</sec>
<sec id="sec007">
<title>Core modules</title>
<p>RTXI’s base functionality (data acquisition, processing, and visualization) is achieved through core modules designed to provide hard RT closed-loop performance. A set of core modules with minimal computational overhead are compiled as shared object libraries during the RTXI installation process and linked to RTXI at run-time. This approach leads to lower system overhead and thus greater flexibility for users to define custom protocols that may require greater computational resources.</p>
<sec id="sec008">
<title>System control panel</title>
<p>The System Control Panel shown in <xref ref-type="fig" rid="pcbi.1005430.g001">Fig 1</xref> is the primary interface for configuring RT system settings and DAQ I/O channels. The detected on-board DAQs are listed in the Devices drop-down menu (e.g., analogy0). Users can set the Frequency or Period of the RT system, which is used as the data acquisition (I/O) rate and determines the computation time available per cycle. All available AI, AO, and DIO channels are automatically detected from the installed DAQ and listed for the user to enable and configure. For example, users can configure the measurement mode (Ground-referenced, Differential, etc), scale the input measurements to account for hardware gains, change the measurement range, and add or remove offsets to each channel individually. Users can also configure available Digital I/O channels through this panel. When the channel configurations are “applied”, an event is registered on the system stack, notifying all open modules of the changes. Users can respond to these changes through the update function of their custom modules (see <xref ref-type="fig" rid="pcbi.1005430.g003">Fig 3D</xref>).</p>
<fig id="pcbi.1005430.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005430.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Example template code available (<xref ref-type="supplementary-material" rid="pcbi.1005430.s003">S3 File</xref>) to users for writing custom modules, and corresponding module loaded within RTXI.</title>
<p>(A) Basic C++ header (<monospace>plugin_template.h</monospace>) for an RTXI module. (B) Users can declare inputs, outputs, states, parameters, and events for custom modules through the DefaultGUIModel struct and (C) implement hard RT code within the execute function. (D) The <monospace>update</monospace> function allows execution of state-specific code for the module. (E) The module after it is compiled with the provided Makefile and loaded into RTXI. Each element of the module GUI is tied to a specific line of code. For example, when “Button A” is clicked, the <monospace>aBttn_event()</monospace> (line 35, A) code is executed. Similarly, the “GUI label” (lines 5–6, B) and “A State” (lines 11–13, B) components of the GUI are created by the <monospace>vars</monospace> struct and their values are initialized from the <monospace>INIT</monospace> block of the <monospace>update()</monospace> function (lines 8–9, C). Visit the GitHub repository (<xref ref-type="supplementary-material" rid="pcbi.1005430.s003">S3 File</xref>) for complete corresponding C++ implementation (<monospace>plugin_template.cpp</monospace>) file.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005430.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>Data recorder and HDF5 files</title>
<p>The Data Recorder module shown in <xref ref-type="fig" rid="pcbi.1005430.g001">Fig 1</xref> allows saving of virtually anything within RTXI. Users first select the module of interest, and then have the option of saving any module element specified within the <monospace>DefaultGUIModel::vars</monospace> struct (see <xref ref-type="fig" rid="pcbi.1005430.g003">Fig 3B</xref>). Parameters for all modules are automatically registered at the beginning of a recording session. If modified during execution, the updated value is registered to the data file with a timestamp. Users can also “tag” various time points throughout their experiment to note relevant events. Events are timestamped and registered as a list of tags within the specified data file. A global downsampling option is available to reduce output file sizes. In between active recording sessions, the size and number of trials present in the specified data file, and length of the previous trial are displayed in the metadata section. If a user chooses an existing file to write data to, the option is presented to either overwrite or append the data file.</p>
<p>Experiment data and metadata saved by the Data Recorder are stored in the Hierarchical Data Format (HDF5). HDF5 [<xref ref-type="bibr" rid="pcbi.1005430.ref033">33</xref>] is an open data model that is increasingly popular for representing large and complex data, data relationships, and their associated metadata. HDF5 file read and write operations are supported by many common analysis frameworks and languages (e.g., MATLAB, Python, Julia, R, etc). Acquired raw and processed data, module states and parameters, system configurations, and almost any other value can be synchronously saved to a single HDF5 file by simply selecting the appropriate signal and adding it to the list of active recording channels. In addition, any computed value or intermediate signal can easily be captured for offline debugging or validation of RT algorithms and processing. When a parameter value is modified on-the-fly during data acquisition, the new value is automatically time stamped and stored into the data file. The Data Recorder also includes the ability to timestamp data with tags to experimental events or making notes and includes DAQ channel configuration details for all active channels. For precise control of data recorder start and stop times, the Data Recorder can easily be coupled with the Sync module, shown in <xref ref-type="fig" rid="pcbi.1005430.g001">Fig 1</xref>, which can be used to control the state of numerous modules and the data recorder all at once.</p>
<p>
<xref ref-type="fig" rid="pcbi.1005430.g004">Fig 4</xref> depicts the structure of an RTXI-generated HDF5 file. Scripts and analysis tools are provided online for importing RTXI-generated HDF5 files into a single MATLAB structure for post-hoc analysis. RTXI-generated HDF5 files are compatible with many commercial and free software applications for a variety of platforms. There is no required proprietary software for viewing or analyzing data stored in RTXI-generated HDF5 files. Much of the available software also supports editing data in place within the HDF5 file or appending new data to an existing file. This allows users to add associated data such as images, post-processed data, or additional notes.</p>
<fig id="pcbi.1005430.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005430.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Hierarchical data format data file generated by RTXI.</title>
<p>Each trial is represented as an ordered group of data and metadata objects. By default, RTXI saves parameter values from all modules when recording is started into the “Parameters” group. All enabled DAQ AI channel configuration settings are also saved into the “System Settings” group. HDF5 files can be opened, modified, and appended to from a variety of post-hoc analysis frameworks (e.g., HDFView, MATLAB, R, Python).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005430.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec010">
<title>Connector</title>
<p>Passing of data between core and custom modules within the RTXI workspace takes place through the Connector module shown in <xref ref-type="fig" rid="pcbi.1005430.g001">Fig 1</xref>. The module’s simple interface allows mapping of outputs from a module or DAQ AI channel to the input of another module in various configurations (one-to-one, one-to-many, many-to-one, etc). The specific input and output signals available to a module are defined in the module’s code (see <xref ref-type="fig" rid="pcbi.1005430.g003">Fig 3</xref>). In cases where a many-to-one connection is formed, the inputs are summed prior to passing the data to the specified input. For example, <xref ref-type="fig" rid="pcbi.1005430.g001">Fig 1</xref> shows the data from DAQ AI channel 0 and the output of the Signal Generator module connected to the input of the Neuron module. Simultaneously, the output of the Neuron module is sent to the Spike Detector module as well as out to hardware via DAQ AO channel 0.</p>
</sec>
<sec id="sec011">
<title>Oscilloscope</title>
<p>RTXI’s built-in real-time, high-speed, fully configurable Oscilloscope shown in <xref ref-type="fig" rid="pcbi.1005430.g001">Fig 1</xref> module allows visualization of signals, parameters, states, and events from any loaded core or custom module. Similar to the Data Recorder and other system modules, the Oscilloscope can access data of any kind from any loaded module within the workspace. To visualize the signal, the user selects the block of interest on the “Channel” tab, which provides a list of available streams along with options to customize the color, style, and vertical scale (per division) of the selected signal. Once the modifications are “applied”, the enabled signal is visualized with the configured settings and a legend entry is created listing the enabled channels by name along with their respective vertical scale. A second tab, titled “Display” allows configuration of the time scale (per division), the Oscilloscope’s refresh rate, and specify trigger settings. Screenshots can be saved online during experiments for quick figure generation.</p>
</sec>
<sec id="sec012">
<title>Real-time benchmarks</title>
<p>Online evaluation of system performance is useful when designing RT algorithms, debugging experimental setups, and even during experiments. The RT Benchmarks module shown in <xref ref-type="fig" rid="pcbi.1005430.g001">Fig 1</xref> (pane with blue top bar) provides key statistics about the RT performance of the system—including the computational time, RT period, and the RT period’s jitter—by using timestamps directly from the real-time system’s clock. These benchmarks have been shown to be critical in evaluating hard real-time performance [<xref ref-type="bibr" rid="pcbi.1005430.ref018">18</xref>]. The computational time is inclusive of all system and custom modules loaded into the workspace, enabling evaluation of the full hard RT closed-loop execution time of each custom protocol. The RT period and RT period’s jitter provide a means for viewing the actual period of the closed-loop system. The RT period should never exceed twice the desired RT period, otherwise hard RT behavior is compromised. Furthermore, each statistic reported by the RT Benchmarks module can be saved to an HDF5 file through the Data Recorder for post-hoc validation and verification of hard RT performance during the experiment. As described in the RTXI documentation (<xref ref-type="supplementary-material" rid="pcbi.1005430.s003">S3 File</xref>), end users are strongly advised to benchmark their hardware and modules to ensure that the performance they require is actually being delivered.</p>
</sec>
<sec id="sec013">
<title>Module wizard</title>
<p>There are over 50 modules available to RTXI users through the RTXI GitHub repositories (<xref ref-type="supplementary-material" rid="pcbi.1005430.s003">S3 File</xref>). The Module Wizard shown in <xref ref-type="fig" rid="pcbi.1005430.g001">Fig 1</xref> was created to ease the process of downloading, installing, and updating new and existing modules. Users can quickly synchronize with the GitHub repositories and view details about each module, including the specific functions, how it works, and its development status. If a specific module is of interest, the user can download and install the module directly from within the Module Wizard and within seconds load the new module into their workspace.</p>
</sec>
<sec id="sec014">
<title>User preferences</title>
<p>The User Preferences module shown in <xref ref-type="fig" rid="pcbi.1005430.g001">Fig 1</xref> enables customization of default file locations for various file I/O operations. Users can specify folder locations for workspace setfiles and HDF5 data files. In addition, users can specify buffer sizes for the Data Recorder, which can be beneficial when acquiring large amounts of data at high sampling rates. All settings specified within the User Preferences module are set as the default values and saved to the global RTXI configuration file.</p>
</sec>
</sec>
<sec id="sec015">
<title>Custom modules and Application Programming Interface (API)</title>
<p>One core strength of RTXI is the ability to create custom RT modules without being restricted to hardware and software-defined boundaries, which is a common obstacle with commercial systems. RTXI users implement custom experimental protocols by writing all aspects of their RT protocol in C++-based modules. The use of C++ as the language of choice allows users to incorporate a variety of established libraries, such as LAPACK, Boost, and GNU Scientific Library for processing and data visualization, while capitalizing upon the strengths of C++ such as recursion, object-oriented programming, and abstraction. This system for creating custom closed-loop protocols enables complete freedom with respect to customization of closed-loop RT protocols without any virtual limit on what can be implemented.</p>
<p>To get started, users are encouraged to reference the Plugin Template, which provides the critical elements required for creating a custom RTXI module. <xref ref-type="fig" rid="pcbi.1005430.g003">Fig 3</xref> provides an overview of the Plugin Template files and code. The Plugin Template files include a Makefile, which is used to define compilation rules on how files should be compiled, which external libraries are to be included, and how to package the individual pieces together to form a shared library object that is RTXI-compatible. In addition, one header (<monospace>plugin_template.h</monospace>, <xref ref-type="fig" rid="pcbi.1005430.g003">Fig 3A</xref>) and implementation (<monospace>plugin_template.cpp</monospace>) file are included as examples that can be built upon.</p>
<p>All custom modules are abstracted from the <monospace>DefaultGUIModel</monospace> class, which includes all elements necessary for interfacing with both the RT and GUI threads. When creating a new module, users create the various I/O elements for that module through the <monospace>vars</monospace> structure (<xref ref-type="fig" rid="pcbi.1005430.g003">Fig 3B</xref>). To run specific code in RT, the code is placed in the <monospace>execute()</monospace> function (<xref ref-type="fig" rid="pcbi.1005430.g003">Fig 3C</xref>), which is common to all system and custom modules and processed at each time step. Functions called from within the <monospace>execute</monospace> function are also run in RT, while all code that is not in or called by the <monospace>DefaultGUIModel::execute</monospace> function is run on the soft RT GUI thread. This enables a simple mechanism for separating hard RT and soft RT tasks without significant programming overhead for the end user.</p>
<p>Users are able to customize the GUI of the module by including a variety of labels for model parameter and state variables, buttons and other elements for module control, as well as plotting elements for online analysis and visualization through the <monospace>customizeGUI()</monospace> function. By default, each module consists of three automatically generated buttons for starting or pausing execution, updating user-set parameters, and unloading itself from the workspace. Customization of the GUI is achieved by using the Qt framework, which provides a variety of GUI elements such as buttons, lists, text boxes, etc. Users can include signals and slots, which is a mechanism for calling specific functions based upon the occurrence of an event (e.g., button press → meet threshold criteria → specific animal behavior). For example, users can include a radio button in their module that has a signal-slot connection to a plot. When a user clicks the radio button, a signal is emitted and tells the module to display a scatter plot of data, which is otherwise hidden. The same signal-slot mechanism can be used to create buttons that drive outputs via the DAQ, call specific protocol functions, or generate notifications when an event occurs. Users are also encouraged to check the listing of available modules on the RTXI GitHub page for examples or potentially suitable modules that can easily be adapted to meet individual needs.</p>
<p>Updates to module variables, responding to changes in RT system settings applied through the system control panel, and controlling the state of each module takes place through the <monospace>update()</monospace> function (<xref ref-type="fig" rid="pcbi.1005430.g003">Fig 3D</xref>). Each module can be in one of five states—which are responsible for initializing all module elements (<monospace>INIT</monospace>), registering UI/UX commands to the module (<monospace>MODIFY</monospace>), responding to changes in the RT system frequency (<monospace>PERIOD</monospace>), and controlling whether or not the module is running (<monospace>UNPAUSED</monospace>) or not (<monospace>PAUSED</monospace>). Users can customize any state for experiment-specific needs.</p>
</sec>
</sec>
<sec id="sec016" sec-type="conclusions">
<title>Results and discussion</title>
<sec id="sec017">
<title>System characterization and load testing</title>
<p>We evaluated RTXI’s performance in different I/O configurations and computational loads (<xref ref-type="fig" rid="pcbi.1005430.g005">Fig 5</xref>). Tests were performed by providing a randomly triggered input signal (square wave, 50% duty cycle, 5 Vpp) to one of the DAQ AI channels. Each test case was run for 30 minutes (1800 total input events). In Case 1 (top), 1 AI channel was used to measure the input signal, and 1 AO channel was used to output the same signal, with no processing in the loop to evaluate system performance in a single-input, single-output (SISO) configuration. Case 2 (middle) used the same configuration as Case 1, but included 2 AI and 2 AO channels. Only one AI channel received the input signal. The other AI channel was left floating and directly connected to the second AO channel, allowing characterization of system performance in a multi-input, multi-output (MIMO) configuration. Case 3 used the same configuration as Case 2, but with added processing within the loop. The Hodgkin-Huxley Neuron model was configured to receive the test input signal and the output of the Neuron model (membrane potential, V<sub><italic>m</italic></sub>) was connected to the Spike Detector module. The Spike Detector module determines if an action potential has occurred by checking for a threshold-crossing event. When an action potential is detected, the Spike Detector outputs a TTL pulse that is then sent out via the AO channel.</p>
<fig id="pcbi.1005430.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005430.g005</object-id>
<label>Fig 5</label>
<caption>
<title>System performance under different computational loads and closed-loop configurations.</title>
<p>(A) System configurations tested. (B) System I/O latency does not exceed twice the system period (50 <italic>μ</italic>s) nor are I/O events missed in all test cases, demonstrating hard RT performance and a delay of no more than one sample. (C) Distribution of measured RT periods in each tests case by the Real-Time Benchmarks module. The RT period should never exceed twice the desired RT period, otherwise hard RT behavior is compromised. The increase in RT period variability with increasing computational loads is predominantly from the initial time frame after which a protocol starts execution. This is represented by the RT period jitter data (D), which demonstrates the RT period stabilizing within the first few minutes of execution. (E) Time spent processing the <monospace>execute()</monospace> function of all loaded module on each RT loop cycle.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005430.g005" xlink:type="simple"/>
</fig>
<p>A separate data acquisition system (MATLAB, NI USB-6341) was used to sample (250 kHz) the AI and AO signals from each case to quantify the I/O latency with each configuration. The RT period, RT period jitter, and computation time are measured with the Real-Time Benchmarks module and recorded with the Data Recorder. All tests were performed with an RTXI (v2.1) system frequency of 20 kHz on a desktop computer with an Intel Core i5 Quad Core Processor (3.40 GHz), 32GB of physical RAM, 10,000 RPM hard drive, Radeon HD 8570 graphics card, and an NI PCIe-6259 DAQ. All system and application daemons were killed prior to performance evaluation (recommended) because such background processes can prevent resource allocation or occupy significant amounts of CPU time. All analysis was performed using MATLAB 2016 (MathWorks, Natick, MA, USA). Data shown in <xref ref-type="fig" rid="pcbi.1005430.g005">Fig 5</xref> is from one RTXI installation, however additional performance characterization results are available online from different installations (<xref ref-type="supplementary-material" rid="pcbi.1005430.s003">S3 File</xref>). Each test case demonstrates I/O processing of 1800 events with the desired RT period, demonstrating hard RT performance and a delay of no more than one sample.</p>
<p>
<xref ref-type="fig" rid="pcbi.1005430.g005">Fig 5A</xref> summarizes each case scenario used to characterize system performance. With a system frequency of 20 kHz, the system has 50 μs to complete input, processing, and output events. Histograms of latencies measured by an external data acquisition system are shown in <xref ref-type="fig" rid="pcbi.1005430.g005">Fig 5B</xref>. For all test cases, the system latencies are distributed around 50<italic>μ</italic>s. If a latency greater than 100<italic>μ</italic>s had been measured (twice the system period), the hard aspect of the real-time system would be lost due to the system missing deadlines for events (e.g., input not acquired, output not generated).</p>
<p>
<xref ref-type="fig" rid="pcbi.1005430.g005">Fig 5C–5E</xref> of show system performance metrics measured and reported by the core RT Benchmarks module. <xref ref-type="fig" rid="pcbi.1005430.g005">Fig 5C</xref> demonstrates that the measured RT period is unimodal and tightly distributed around 50<italic>μ</italic>s in all I/O configurations and system loads. As the system load increases, the variance of the RT period increases, but the mean stays closely centered at 50<italic>μ</italic>s. The RT period’s jitter is shown in <xref ref-type="fig" rid="pcbi.1005430.g005">Fig 5D</xref> and is consistent throughout RT execution, demonstrating that RTXI has access to sufficient resources, is prioritized by the real-time scheduler, and can provide the requested performance. If RTXI was unable to meet the performance demands of the configuration, the RT period, and thus the jitter, would vary significantly over the course of an experiment. The final column of <xref ref-type="fig" rid="pcbi.1005430.g005">Fig 5</xref> represents the time taken to complete the input, processing, and output events. As the system configuration and load increase, the computation time also increases but without losing hard real-time performance (as shown by <xref ref-type="fig" rid="pcbi.1005430.g005">Fig 5C–5D</xref>).</p>
</sec>
<sec id="sec018">
<title>Use cases</title>
<sec id="sec019">
<title>Use case 1: Replication and suppression of learning-induced membrane and synaptic plasticity</title>
<p>RTXI’s most common application is for the dynamic-clamp technique (of the many examples, some include: [<xref ref-type="bibr" rid="pcbi.1005430.ref020">20</xref>–<xref ref-type="bibr" rid="pcbi.1005430.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1005430.ref034">34</xref>]). This has led to significant advances in fundamental concepts in neuroscience and related fields.</p>
<p>Feeding behavior in the mollusk Aplysia is modified by various forms of associative learning, including classical and operant conditioning, and alter the central decision-making processes related to feeding actions. Experimental modification of intrinsic excitability and electrical synapses of neurons in the Aplysia feeding central pattern-generating network have been shown to correlate with compulsive-like motor output expressions induced by <italic>in vivo</italic> operant conditioning. Despite this correlation between plasticity and operant conditioning-induced changes, a causal relationship was not shown.</p>
<p>Using RTXI, Sieling et al [<xref ref-type="bibr" rid="pcbi.1005430.ref035">35</xref>] used the dynamic-clamp technique, in which simulated membrane and synaptic currents are artificially added or subtracted from neurons, to examine whether selective changes in single conductances governing cell excitability and electrical coupling are responsible for the associative modification of feeding circuit output and behavior (<xref ref-type="fig" rid="pcbi.1005430.g006">Fig 6</xref>). Using <italic>in vitro</italic> preparations of buccal ganglia isolated from naive and operantly trained animals, Sieling et al either enhanced or diminished neuronal excitability and coupling strengths in RT to test for causation and determine respective contributions of synaptic and non-synaptic processes by which associative learning leads to expression of compulsive behavior.</p>
<fig id="pcbi.1005430.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005430.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Artificially modulating neuronal excitability mimics learning-induced increase in frequency, but not the regularity, of buccal motor pattern (BMP) genesis.</title>
<p>(A) Experimental protocol and equivalent electrical circuit for the addition of a dynamic-clamp-defined leak conductance (G<sub><italic>leak</italic></sub>) to the natural input conductance (G<sub><italic>in</italic></sub>) of an individual neuron using RTXI. (B) Introduction of an artificial G<sub><italic>leak</italic></sub> of −60 nS (shaded panel) increased the excitability of a target B63 neuron (indicated by a decrease in spike threshold) compared with that arising from the natural leak conductance alone (i.e., G<sub><italic>leak</italic></sub>: 0 nS). Horizontal and vertical scale bars represent 2 s and 20 mV, respectively. In (C), G<sub><italic>leak</italic></sub> was introduced into one of B63, B30, or B65. In (D), G<sub><italic>leak</italic></sub> was introduced into a B63 and current pulses for measuring coupling coefficients were injected into either postjunctional B30 or B65. (For details, see [<xref ref-type="bibr" rid="pcbi.1005430.ref035">35</xref>] Fig. S1.) (E) In a control preparation, the frequency, but not the regularity, of spontaneous BMP genesis and associated spike bursts in B63/B30/B65 increased in response to a dynamic-clamp-defined G<sub><italic>leak</italic></sub> of −60 nS (shaded panel) introduced simultaneously into the three neurons. Horizontal and vertical scale bars represent 30 s and 25 mV, respectively. (F and G) Quantification of changes in frequency (F), but not irregularity (G), of BMP generation for different values of artificial G<sub><italic>leak</italic></sub> added simultaneously to the three neurons. Group data show means ± SEM and individual sample sizes. All figures obtained and modified with permission from [<xref ref-type="bibr" rid="pcbi.1005430.ref035">35</xref>].</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005430.g006" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec020">
<title>Use case 2: Real-time distorted auditory feedback for control of song bird timing</title>
<p>In addition to the widely used dynamic clamp, RTXI’s flexibility and robustness are useful for a variety of investigations testing causal relationships. One such area is Distorted Auditory Feedback (DAF), which is routinely used to assess the effects of auditory input on vocal production and underlying neural activity in songbirds. Some bird species’ songs have been shown to be highly sensitive to acoustic input, showing immediate effects on the timing and acoustic structure of the produced song. Investigation of immediate changes taking place after DAF presentation often requires having a system capable of providing RT acoustic processing and feedback. Commercial systems for RT acoustic processing are available but are expensive and contain a significant number of constraints that must be considered during experimental design. Furthermore, typical experiments using acoustic feedback use detection of a certain template signal, either a certain frequency or more complex combination or sweeps of frequencies, and feedback is delivered upon template detection. Template detection tasks are computationally intensive, requiring spectrogram-based or feature-based techniques [<xref ref-type="bibr" rid="pcbi.1005430.ref036">36</xref>, <xref ref-type="bibr" rid="pcbi.1005430.ref037">37</xref>], comparison across detected elements and templates, and if successful, generate the appropriate feedback signal. These computations have to be done fast enough to enable RT performance while not interfering with other processes such as data acquisition, storage, and visualization.</p>
<p>Skocik and Kozhevinokov [<xref ref-type="bibr" rid="pcbi.1005430.ref038">38</xref>] capitalized on the strengths of RTXI and modified it for experimental use in RT acoustic signal processing and feedback. Acoustic measurements were made by interfacing a microphone and amplifier to the analog inputs present on a National Instruments PCIe-6251 DAQ with a system frequency of 30 kHz. Acoustic feedback was generated by custom RTXI modules and delivered via the analog outputs on the DAQ. To minimize processing latency, the Data Recorder module was customized to provide two high-speed modes of operations—triggered (active) and non-triggered (idle). The complete process flow for the customized Data Recorder is shown in <xref ref-type="fig" rid="pcbi.1005430.g007">Fig 7</xref>. A circular buffer is inserted into the Data Recorder’s processing loop to enable buffering of acquired acoustic signals. The root mean square (RMS) is continuously quantified for the last 10ms of acquire data at a rate of 1 kHz. When the RMS exceeds the user-specified threshold, the system automatically switches to triggered mode operation.</p>
<fig id="pcbi.1005430.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005430.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Hard RT distorted auditory feedback system.</title>
<p>(A) Simplified diagram of the acoustic feedback system. When not triggered (top), the system computes the root mean square (RMS) of the input signal. When the RMS exceeds the threshold, the system is triggered. When triggered (bottom), the system computes the spectrogram of the most recent 20ms of signal and computes the correlation coefficient of this spectrogram with the spectrogram of the template sound (e.g., song syllable). The template sound is detected when the correlation coefficient exceeds a threshold value; in this case, acoustic feedback can be generated. Both the input and the acoustic output are saved to the computer hard drive. (B) Spectrogram of the song of a Bengalese finch and the times of occurrence of one of the song syllables. The system was programmed to only detect the occurrences of the target syllable in real time, no acoustic feedback was generated. The detection times are shown as vertical red lines. Bottom: the system is detecting the target syllables (vertical red lines) and is generating acoustic feedback after detection. The acoustic feedback waveform is shown below. The feedback signal is one of the birdsong syllables; the acoustic feedback pickup by the microphone is visible on the spectrogram. The zoomed-in spectrogram of the template is shown on the right. (C) DAF increases the duration of the time interval between Bengalese finch song syllables. Histogram depicts the time intervals between two subsequent syllables in the song in the presence of DAF (blue) and without DAF (red). The means are: Δ<italic>t</italic><sub><italic>mean</italic></sub> = 74.8ms (control, <italic>N</italic> = 637 syllables) and Δ<italic>t</italic><sub><italic>mean</italic></sub> = 75.7ms (feedback, <italic>N</italic> = 97 syllables), the difference is statistically significant (<italic>p</italic> = 0.001, two-way Kolmogorov—Smirnov test). All figures obtained and modified with permission from [<xref ref-type="bibr" rid="pcbi.1005430.ref038">38</xref>].</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005430.g007" xlink:type="simple"/>
</fig>
<p>Performance was also evaluated in experiments to detect specific syllables in the song of Bengalese finches. The finch song consists of a sequence of syllables separated by silences (inter-syllable gaps) (<xref ref-type="fig" rid="pcbi.1005430.g007">Fig 7</xref>), with variability introduced by the specific sequence of syllables in each song. Experiments were conducted to detect specific target syllables, with successful crossing of the correlation coefficient resulting in generation of acoustic feedback (either white noise or the song syllable). <xref ref-type="fig" rid="pcbi.1005430.g007">Fig 7B</xref> provides sample data demonstrating RTXI’s performance in both open-loop (detection only) and closed-loop modes (detection and feedback). System performance was characterized by comparing online syllable detection to off-line detection using spectrogram-based techniques. Over 92% of the target syllables (n = 659) were correctly identified by RTXI, with zero false positives. The undetected 8% are believed to be due to natural variability in acoustic structure that are not accounted for by the detection algorithm. Additional tests in Zebra finches resulted in a detection rate up to 96% (n = 756), with less than 1% false positives. In a final round of experiments, detection of target syllables was followed by DAF for modulation of timing between song syllables. Without DAF, the mean interval is 74.8 ms (n = 637), while with DAF the mean interval increases to 75.7 ms (n = 97).</p>
<p>These observations are consistent with previously published observations on the effects of RT feedback on song structure [<xref ref-type="bibr" rid="pcbi.1005430.ref039">39</xref>]. Moreover, they demonstrate the robust hard-RT capabilities of RTXI and the advantages of open-source software. Using RTXI enabled the authors to set up interfaces with different I/O hardware and modify the RTXI source code to run custom RT protocols.</p>
</sec>
<sec id="sec021">
<title>Use case 3: EEG feedback-controlled transcranial alternating current stimulation</title>
<p>In addition to <italic>in vitro</italic> and <italic>in vivo</italic> closed-loop hard RT electrophysiology, RTXI’s flexibility, customizability, and hard RT performance has been utilized to investigate the effects of feedback-driven tACS. Brain stimulation using transcranial Alternating Current Stimulation (tACS) has gained significant momentum as an alternative to pharmacological methods for treatment of neurological and psychiatric disorders. By electrically stimulating the brain, aberrant network dynamics can be targeted with potentially higher efficacy, increasing therapeutic efficacy while minimizing undesired off-target effects [<xref ref-type="bibr" rid="pcbi.1005430.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1005430.ref041">41</xref>]. Unfortunately, most clinical investigations using tACS are conducted in a feedforward, open-loop manner. Given the success of feedback (closed-loop) control in a variety of engineering and neuroscience applications, Boyle et al [<xref ref-type="bibr" rid="pcbi.1005430.ref014">14</xref>] investigated the ability of electroencephalography (EEG)-measurement driven delivery of tACS to provide better control of cerebral cortex dynamics, which is implicated in several psychiatric illnesses.</p>
<p>tACS applies a weak sinusoidal electrical current to the scalp, resulting in a change in polarization of a large number of neurons, thus effectively altering neuronal network activity. Evidence from previous studies suggests that sinusoidal stimulation waveforms can be used to selectively modulate cortical oscillations at different frequencies commonly associated with different cognitive states. In their study, Boyle et al combined 40 Hz tACS with EEG measurements to control visual cortex state dynamics and modulate high- and low-alpha states induced by opening and closing the eyes.</p>
<p>RTXI was used in this investigation to measure and process incoming EEG activity, compute the appropriate output stimulation waveform in RT, and control timing of the experimental protocol. EEG measurements were made by interfacing with a Biopac EEG amplifier connected to a National Instruments PCI-6221 DAQ with a system frequency of 2 kHz. Measured EEG activity was processed online with custom C++ modules. Stimulation timing and waveforms were generated by RTXI and delivered to an isolation unit through the DAQ’s analog output channel. <xref ref-type="fig" rid="pcbi.1005430.g008">Fig 8A</xref> depicts the custom closed-loop, RT protocol engineered for this investigation.</p>
<fig id="pcbi.1005430.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005430.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Optimization of therapeutic benefit of tACS via closed-loop EEG feedback-controlled tACS.</title>
<p>(A) Hard real-time closed-loop protocol used for feedback-controlled delivery of tACS. EEG are measured and amplified prior to sampling with RTXI while the subject opens and closes their eyes every 30 seconds. EEG data from international 10–20 system sites O2, A1, and A2 are processed in hard RT using a custom module written to measure the alpha band power within a one second window. The computed power is validated against a threshold criteria, which determines the tACS amplitude to be delivered. The output from RTXI is connected to an external current-controlled stimulation and isolation unit. Sample alpha-filtered EEG traces with and without feedback-controlled tACS are shown in (B). Feedback-controlled tACS (C) almost completely suppressed alpha band power in a targeted way (Ratio EC<sub><italic>α</italic></sub> to EO<sub><italic>α</italic></sub> = 1.03, <italic>p</italic> = 0.041). Dose-matched random tACS (D) also suppressed alpha band power (normalized random-No Stim = −0.31, <italic>p</italic> = 0.0183), but was less effective than feedback-controlled tACS (normalized feedback<sub><italic>α</italic></sub>—random<sub><italic>α</italic></sub> = −0.10, <italic>p</italic> = 0.0145). All figures obtained and modified with permission from [<xref ref-type="bibr" rid="pcbi.1005430.ref014">14</xref>].</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005430.g008" xlink:type="simple"/>
</fig>
<p>All data processing and analysis was conducted in RT with custom modules written in C++. The incoming EEG data was filtered with a 6<sup>th</sup> order Butterworth band-pass filter with a bandwidth of 8–12 Hz to isolate the alpha band. Power was then computed for the alpha band as the mean oscillation power with a 1 second window width. During the calibration period in each experiment, the module built a distribution with the computed alpha power values to determine the mean alpha power for both eyes-open and eyes-closed conditions. Stimulation thresholds were set to 1.05 of the average of the two mean alpha power values. The protocol then continued to assess mean alpha power at a rate of 0.25 Hz and modulated the stimulation depending on the measured alpha power. If alpha power was higher than the stimulation threshold, tACS was delivered to the subject for the first 2 seconds of the next epoch, otherwise stimulation was turned off. Each subject completed a total of four 12 minute recording sessions. Each recording started with a 2 minute calibration period. For the first 60 seconds, the subjects were asked to relax and be still with their eyes open. For the next 60 seconds, the subjects were asked to relax, be still, and close their eyes. After calibration, two recordings were conducted in each subject. First, subjects were asked to keep their eyes open (EO) and received EEG feedback-controlled tACS. For the second recording, subjects were asked to open and close their eyes when told by the experimenter every 30 seconds (EOEC) while receiving EEG-feedback driven tACS. These two recordings were repeated, however subjects received dose-matched randomly administered tACS.</p>
<p>The results of this investigation found that EEG feedback-controlled tACS can successfully suppress alpha power as well as state transitions caused by opening and closing of eyes. Subsequent investigations by the same group using RTXI have also demonstrated the ability of closed-loop tACS to boost sleep spindle activity and sleep-dependent motor memory consolidation [<xref ref-type="bibr" rid="pcbi.1005430.ref011">11</xref>]. These results demonstrate the customizability, modularity, and robust closed-loop RT performance of RTXI.</p>
</sec>
</sec>
</sec>
<sec id="sec022">
<title>Availability</title>
<p>RTXI is available under the GNU GPLv3 license and is publicly accessible online via GitHub (<xref ref-type="supplementary-material" rid="pcbi.1005430.s003">S3 File</xref>) along with over 50 custom modules contributed by the RTXI community. This repository enables tracking of user-submitted bugs and requests, and makes the continued development of RTXI publicly viewable. GitHub also allows users to watch the progress and development of RTXI, receive notifications as new updates or patches are submitted, and easily share custom modules built by any RTXI user. Users are encouraged to use this platform to communicate with the RTXI team with questions, comments, feature requests, and troubleshooting advice.</p>
<p>In addition to GitHub, a website (<xref ref-type="supplementary-material" rid="pcbi.1005430.s003">S3 File</xref>) is maintained and routinely updated with new troubleshooting tips and FAQs (<xref ref-type="supplementary-material" rid="pcbi.1005430.s003">S3 File</xref>) as well as a user manual and documentation (<xref ref-type="supplementary-material" rid="pcbi.1005430.s003">S3 File</xref>). Publications utilizing RTXI are indexed and listed for users to access key details associated with experimental setups, module use, and system parameters—enabling greater reproducibility of shared data. The RTXI team is dedicated to helping users with any aspect of RTXI—whether it is installation, creating custom modules, or integration of addition experimental hardware.</p>
</sec>
<sec id="sec023">
<title>Future directions</title>
<p>Advances in measurement and stimulation technologies over the last decade have increased both the spatial and temporal resolution at which scientists can investigate biological systems. Enhancements in micro-fabrication technologies have enabled development of high density silicon probes [<xref ref-type="bibr" rid="pcbi.1005430.ref042">42</xref>, <xref ref-type="bibr" rid="pcbi.1005430.ref043">43</xref>], allowing large-scale spatial and temporal over-sampling of biological activity [<xref ref-type="bibr" rid="pcbi.1005430.ref044">44</xref>]. Development of ASICs has led to wide adoption of systems such as the low-cost and easy-to-use Intan headstages [<xref ref-type="bibr" rid="pcbi.1005430.ref045">45</xref>, <xref ref-type="bibr" rid="pcbi.1005430.ref046">46</xref>]. Furthermore, recent developments in imaging technologies have made it possible to consider closed-loop applications in which the measured signal is an image representative of underlying electrical activity, rather than direct measurement of electrical potentials.</p>
<p>On-going development efforts within RTXI are focused on incorporating new measurement modalities (e.g., imaging) and acquiring from high channel count interfaces—all with hard RT closed-loop performance. For example, a image acquisition and processing module (GenICam) and a Ethernet-based data acquisition module (EthernetAcq) are now available for use within RTXI (<xref ref-type="supplementary-material" rid="pcbi.1005430.s003">S3 File</xref>). In many cases, hard RT closed-loop control with image or high channel count data processing can require more computation time than is available per cycle. On-going RTXI development efforts are also focused on providing API calls for distributing computational loads across dedicated processor cores and GPUs, with the goal of requiring little to no technical know-how on the user’s end.</p>
<p>The advent of optogenetics has enabled tight spatial and temporal control of stimulation of biological tissues [<xref ref-type="bibr" rid="pcbi.1005430.ref047">47</xref>–<xref ref-type="bibr" rid="pcbi.1005430.ref049">49</xref>]. These developments have spawned a significant interest in closed-loop control of biological systems [<xref ref-type="bibr" rid="pcbi.1005430.ref050">50</xref>], such as optical clamping of network activity [<xref ref-type="bibr" rid="pcbi.1005430.ref051">51</xref>] and optical shortening of cardiac action potential durations [<xref ref-type="bibr" rid="pcbi.1005430.ref052">52</xref>]. In most cases, delivery of optogenetic stimuli via a laser or diode is controlled and modulated by a voltage signal. For example, users can generate a standard stimulus waveform using the Signal Generator module or a custom stimulus waveform by providing an ASCII file to the Waveform Maker module and use it to control a laser or diode to achieve hard RT optogenetic stimulation. Such re-utilization of existing code and custom modules simplifies the transition to hard RT closed-loop control.</p>
</sec>
<sec id="sec024">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005430.s001" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005430.s001" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>Relevant terms and definitions used throughout the manuscript.</title>
<p>(TEX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005430.s002" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005430.s002" xlink:type="simple">
<label>S2 File</label>
<caption>
<title>Index of abbreviations used throughout the manuscript.</title>
<p>(TEX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005430.s003" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005430.s003" xlink:type="simple">
<label>S3 File</label>
<caption>
<title>Links for finding source code, tutorials, data, and user manuals for RTXI.</title>
<p>(TEX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>All the work presented in this manuscript is a result of the effort put in by many individuals. First, we would like to thank Calin Culianu, Jonathan Bettencourt, Risa Lin, and Francis Ortega for their significant and valuable contributions to the development of RTXI that continue to be a part of its core. Next, we would like to thank authors of the highlighted use cases, Michale Skocik, Romuald Nargeot, Michael Boyle, Caroline Lustenberger, Sankar Alagapan, and Flavio Frohlich for openly providing data, figures, and feedback on this manuscript. In addition, the authors also thank Laura O’Farrell, Brian Kim, and Will Rountree for comments on the manuscript and how to communicate highly technical concepts in a simpler and effective manner. Most importantly, the authors would like to thank the RTXI user-community and greater open-source hardware/software communities for continued feedback, interest, and use of RTXI. Their contributions have helped develop a long-term, stable product that enables new paradigms of scientific investigations.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005430.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barabanov</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Yodaiken</surname> <given-names>V</given-names></name>. <article-title>Real-time linux</article-title>. <source>Linux Journal</source>. <year>1996</year>;<volume>23</volume>(<issue>4.2</issue>):<fpage>1</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005430.ref002">
<label>2</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gerum</surname> <given-names>P</given-names></name>. <source>Xenomai—Implementing a RTOS emulation framework on GNU/Linux</source>. <publisher-name>White Paper, Xenomai</publisher-name>. <year>2004</year>;p. <fpage>1</fpage>–<lpage>12</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005430.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Groenendaal</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Ortega</surname> <given-names>FA</given-names></name>, <name name-style="western"><surname>Krogh-Madsen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Christini</surname> <given-names>DJ</given-names></name>. <article-title>Voltage and calcium dynamics both underlie cellular alternans in cardiac myocytes</article-title>. <source>Biophysical Journal</source>. <year>2014</year>;<volume>106</volume>(<issue>10</issue>):<fpage>2222</fpage>–<lpage>2232</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2014.03.048" xlink:type="simple">10.1016/j.bpj.2014.03.048</ext-link></comment> <object-id pub-id-type="pmid">24853751</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Groenendaal</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Ortega</surname> <given-names>FA</given-names></name>, <name name-style="western"><surname>Kherlopian</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Zygmunt</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Krogh-Madsen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Christini</surname> <given-names>DJ</given-names></name>. <article-title>Cell-specific cardiac electrophysiology models</article-title>. <source>PLoS Computational Biology</source>. <year>2015</year>;<volume>11</volume>(<issue>4</issue>):<fpage>e1004242</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004242" xlink:type="simple">10.1371/journal.pcbi.1004242</ext-link></comment> <object-id pub-id-type="pmid">25928268</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brown</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Krogh-Madsen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Christini</surname> <given-names>DJ</given-names></name>. <article-title>Illuminating Myocyte-Fibroblast Homotypic and Heterotypic Gap Junction Dynamics Using Dynamic Clamp</article-title>. <source>Biophysical Journal</source>. <year>2016</year>;<volume>111</volume>(<issue>4</issue>):<fpage>785</fpage>–<lpage>797</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2016.06.042" xlink:type="simple">10.1016/j.bpj.2016.06.042</ext-link></comment> <object-id pub-id-type="pmid">27558722</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Devenyi</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Ortega</surname> <given-names>FA</given-names></name>, <name name-style="western"><surname>Groenendaal</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Krogh-Madsen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Christini</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Sobie</surname> <given-names>EA</given-names></name>. <article-title>Differential roles of two delayed rectifier potassium currents in regulation of ventricular action potential duration and arrhythmia susceptibility</article-title>. <source>The Journal of Physiology</source>. <year>2016</year>;p. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1113/JP273191" xlink:type="simple">10.1113/JP273191</ext-link></comment> <object-id pub-id-type="pmid">27779762</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bartolucci</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Altomare</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bennati</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Furini</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zaza</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Severi</surname> <given-names>S</given-names></name>. <article-title>Combined action potential- and dynamic-clamp for accurate computational modelling of the cardiac IKr current</article-title>. <source>Journal of Molecular and Cellular Cardiology</source>. <year>2015</year>;<volume>79</volume>(<issue>2014</issue>):<fpage>187</fpage>–<lpage>194</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.yjmcc.2014.11.011" xlink:type="simple">10.1016/j.yjmcc.2014.11.011</ext-link></comment> <object-id pub-id-type="pmid">25446181</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Idoux</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Mertz</surname> <given-names>J</given-names></name>. <article-title>Control of local intracellular calcium concentration with dynamic-clamp controlled 2-photon uncaging</article-title>. <source>PLoS ONE</source>. <year>2011</year>;<volume>6</volume>(<issue>12</issue>):<fpage>e28685</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0028685" xlink:type="simple">10.1371/journal.pone.0028685</ext-link></comment> <object-id pub-id-type="pmid">22216105</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nabi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Stigen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Moehlis</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Netoff</surname> <given-names>T</given-names></name>. <article-title>Corrigendum: Minimum energy control for in vitro neurons</article-title>. <source>Journal of Neural Engineering</source>. <year>2013</year>;<volume>10</volume>(<issue>4</issue>):<fpage>049501</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1741-2560/10/4/049501" xlink:type="simple">10.1088/1741-2560/10/4/049501</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilson</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Barraza</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Troyer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Farries</surname> <given-names>MA</given-names></name>. <article-title>Predicting the Responses of Repetitively Firing Neurons to Current Noise</article-title>. <source>PLoS Computational Biology</source>. <year>2014</year>;<volume>10</volume>(<issue>5</issue>):<fpage>1</fpage>–<lpage>17</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003612" xlink:type="simple">10.1371/journal.pcbi.1003612</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lustenberger</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Boyle</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Alagapan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mellin</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Vaughn</surname> <given-names>BV</given-names></name>, <name name-style="western"><surname>Frohlich</surname> <given-names>F</given-names></name>. <article-title>Feedback-Controlled Transcranial Alternating Current Stimulation Reveals a Functional Role of Sleep Spindles in Motor Memory Consolidation</article-title>. <source>Current Biology</source>. <year>2016</year>;<volume>26</volume>:<fpage>1</fpage>–<lpage>10</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cub.2016.06.044" xlink:type="simple">10.1016/j.cub.2016.06.044</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Norman</surname> <given-names>SE</given-names></name>, <name name-style="western"><surname>Butera</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Canavier</surname> <given-names>CC</given-names></name>. <article-title>Stochastic Slowly Adapting Ionic Currents May Provide a Decorrelation Mechanism For Neural Oscillators by Causing Wander in the Intrinsic Period</article-title>. <source>Journal of Neurophysiology</source>. <year>2016</year>;p. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00193.2016" xlink:type="simple">10.1152/jn.00193.2016</ext-link></comment> <object-id pub-id-type="pmid">27281746</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kispersky</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Economo</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Randeria</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>Ja</given-names></name>. <article-title>GenNet: A Platform for Hybrid Network Experiments</article-title>. <source>Frontiers in Neuroinformatics</source>. <year>2011</year>;<volume>5</volume>(<issue>July</issue>):<fpage>11</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fninf.2011.00011" xlink:type="simple">10.3389/fninf.2011.00011</ext-link></comment> <object-id pub-id-type="pmid">21845179</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref014">
<label>14</label>
<mixed-citation publication-type="other" xlink:type="simple">Boyle MR, Frohlich F. EEG feedback-controlled transcranial alternating current stimulation. In: International IEEE/EMBS Conference on Neural Engineering, NER; 2013. p. 140–143.</mixed-citation>
</ref>
<ref id="pcbi.1005430.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bettencourt</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Lillis</surname> <given-names>KP</given-names></name>, <name name-style="western"><surname>Stupin</surname> <given-names>LR</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>JA</given-names></name>. <article-title>Effects of imperfect dynamic clamp: computational and experimental results</article-title>. <source>Journal of Neuroscience Methods</source>. <year>2008</year>;<volume>169</volume>(<issue>2</issue>):<fpage>282</fpage>–<lpage>289</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jneumeth.2007.10.009" xlink:type="simple">10.1016/j.jneumeth.2007.10.009</ext-link></comment> <object-id pub-id-type="pmid">18076999</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Economo</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Fernandez</surname> <given-names>FR</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>JA</given-names></name>. <article-title>Dynamic clamp: alteration of response properties and creation of virtual realities in neurophysiology</article-title>. <source>The Journal of Neuroscience</source>. <year>2010</year>;<volume>30</volume>(<issue>7</issue>):<fpage>2407</fpage>–<lpage>2413</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.5954-09.2010" xlink:type="simple">10.1523/JNEUROSCI.5954-09.2010</ext-link></comment> <object-id pub-id-type="pmid">20164323</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Butera</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>CG</given-names></name>, <name name-style="western"><surname>DelNegro</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>JC</given-names></name>. <article-title>A methodology for achieving high-speed rates for artificial conductance injection in electrically excitable biological cells</article-title>. <source>IEEE Transactions on Biomedical Engineering</source>. <year>2001</year>;<volume>48</volume>(<issue>12</issue>):<fpage>1460</fpage>–<lpage>1470</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/10.966605" xlink:type="simple">10.1109/10.966605</ext-link></comment> <object-id pub-id-type="pmid">11759927</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Raikov</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Preyer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Butera</surname> <given-names>RJ</given-names></name>. <article-title>MRCI: a flexible real-time dynamic clamp system for electrophysiology experiments</article-title>. <source>Journal of Neuroscience Methods</source>. <year>2004</year>;<volume>132</volume>(<issue>2</issue>):<fpage>109</fpage>–<lpage>123</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jneumeth.2003.08.002" xlink:type="simple">10.1016/j.jneumeth.2003.08.002</ext-link></comment> <object-id pub-id-type="pmid">14706709</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bettencourt</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Lillis</surname> <given-names>KP</given-names></name>, <name name-style="western"><surname>Stupin</surname> <given-names>LR</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>JA</given-names></name>. <article-title>Effects of imperfect dynamic clamp: computational and experimental results</article-title>. <source>Journal of neuroscience methods</source>. <year>2008</year>;<volume>169</volume>(<issue>2</issue>):<fpage>282</fpage>–<lpage>289</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jneumeth.2007.10.009" xlink:type="simple">10.1016/j.jneumeth.2007.10.009</ext-link></comment> <object-id pub-id-type="pmid">18076999</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dorval</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Christini</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>JA</given-names></name>. <article-title>Real-time linux dynamic clamp: A fast and flexible way to construct virtual ion channels in living cells</article-title>. <source>Annals of Biomedical Engineering</source>. <year>2001</year>;<volume>29</volume>(<issue>10</issue>):<fpage>897</fpage>–<lpage>907</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1114/1.1408929" xlink:type="simple">10.1114/1.1408929</ext-link></comment> <object-id pub-id-type="pmid">11764320</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Prinz</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Abbott</surname> <given-names>LF</given-names></name>, <name name-style="western"><surname>Marder</surname> <given-names>E</given-names></name>. <article-title>The dynamic clamp comes of age</article-title>. <source>Trends in Neurosciences</source>. <year>2004</year>;<volume>27</volume>(<issue>4</issue>):<fpage>218</fpage>–<lpage>224</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tins.2004.02.004" xlink:type="simple">10.1016/j.tins.2004.02.004</ext-link></comment> <object-id pub-id-type="pmid">15046881</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sharp</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>O’Neil</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Abbott</surname> <given-names>LF</given-names></name>, <name name-style="western"><surname>Marder</surname> <given-names>E</given-names></name>. <article-title>The dynamic clamp: artificial conductances in biological neurons</article-title>. <source>Trends in Neurosciences</source>. <year>1993</year>;<volume>16</volume>(<issue>10</issue>):<fpage>389</fpage>–<lpage>394</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0166-2236(93)90004-6" xlink:type="simple">10.1016/0166-2236(93)90004-6</ext-link></comment> <object-id pub-id-type="pmid">7504352</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Preyer</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Butera</surname> <given-names>RJ</given-names></name>. <article-title>Causes of transient instabilities in the dynamic clamp</article-title>. <source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source>. <year>2009</year>;<volume>17</volume>(<issue>2</issue>):<fpage>190</fpage>–<lpage>198</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TNSRE.2009.2015205" xlink:type="simple">10.1109/TNSRE.2009.2015205</ext-link></comment> <object-id pub-id-type="pmid">19228559</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref024">
<label>24</label>
<mixed-citation publication-type="other" xlink:type="simple">Qt;. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.qt.io/" xlink:type="simple">https://www.qt.io/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005430.ref025">
<label>25</label>
<mixed-citation publication-type="other" xlink:type="simple">Qwt—Qt Widgets for Technical Applications;. Available from: <ext-link ext-link-type="uri" xlink:href="http://qwt.sourceforge.net/" xlink:type="simple">http://qwt.sourceforge.net/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005430.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Patel</surname> <given-names>YA</given-names></name>, <name name-style="western"><surname>Butera</surname> <given-names>RJ</given-names></name>. <article-title>Differential fiber-specific block of nerve conduction in mammalian peripheral nerves using kilohertz electrical stimulation</article-title>. <source>Journal of Neurophysiology</source>. <year>2015</year>;<volume>113</volume>(<issue>10</issue>):<fpage>3923</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00529.2014" xlink:type="simple">10.1152/jn.00529.2014</ext-link></comment> <object-id pub-id-type="pmid">25878155</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Patel</surname> <given-names>YA</given-names></name>, <name name-style="western"><surname>Saxena</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Bellamkonda</surname> <given-names>RV</given-names></name>, <name name-style="western"><surname>Butera</surname> <given-names>RJ</given-names></name>. <article-title>Kilohertz frequency nerve block enhances anti-inflammatory effects of vagus nerve stimulation</article-title>. <source>Scientific Reports</source>. <year>2017</year>;<volume>7</volume>:<fpage>39810</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/srep39810" xlink:type="simple">10.1038/srep39810</ext-link></comment> <object-id pub-id-type="pmid">28054557</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref028">
<label>28</label>
<mixed-citation publication-type="other" xlink:type="simple">Patel YA, Willsie A, Clements IP, Aguilar R, Rajaraman S, Butera RJ. Microneedle cuff electrodes for extrafascicular peripheral nerve interfacing. In: 38th Annual International Conference of the IEEE Engineering in Medicine and Biology Society; 2016. p. 1741–1744.</mixed-citation>
</ref>
<ref id="pcbi.1005430.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Newman</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Zeller-Townson</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Fong</surname> <given-names>MF</given-names></name>, <name name-style="western"><surname>Arcot Desai</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gross</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Potter</surname> <given-names>SM</given-names></name>. <article-title>Closed-Loop, Multichannel Experimentation Using the Open-Source NeuroRighter Electrophysiology Platform</article-title>. <source>Frontiers in Neural Circuits</source>. <year>2013</year>;<volume>6</volume>:<fpage>98</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncir.2012.00098" xlink:type="simple">10.3389/fncir.2012.00098</ext-link></comment> <object-id pub-id-type="pmid">23346047</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Englitz</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>David</surname> <given-names>SV</given-names></name>, <name name-style="western"><surname>Sorenson</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Shamma</surname> <given-names>SA</given-names></name>. <article-title>MANTA—an open-source, high density electrophysiology recording suite for MATLAB</article-title>. <source>Frontiers in Neural Circuits</source>. <year>2013</year>;<volume>7</volume>:<fpage>69</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncir.2013.00069" xlink:type="simple">10.3389/fncir.2013.00069</ext-link></comment> <object-id pub-id-type="pmid">23653593</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Eastman</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Huk</surname> <given-names>AC</given-names></name>. <article-title>PLDAPS: a hardware architecture and software toolbox for neurophysiology requiring complex visual stimuli and online behavioral control</article-title>. <source>Frontiers in Neuroinformatics</source>. <year>2012</year>;<volume>6</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fninf.2012.00001" xlink:type="simple">10.3389/fninf.2012.00001</ext-link></comment> <object-id pub-id-type="pmid">22319490</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Siegle</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>López</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Patel</surname> <given-names>YA</given-names></name>, <name name-style="western"><surname>Abramov</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ohayon</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Voigts</surname> <given-names>J</given-names></name>. <article-title>Open Ephys: An open-source, plugin-based platform for multichannel electrophysiology</article-title>. <source>Journal of Neural Engineering</source>. <year>2017</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1741-2552/aa5eea" xlink:type="simple">10.1088/1741-2552/aa5eea</ext-link></comment> <object-id pub-id-type="pmid">28169219</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref033">
<label>33</label>
<mixed-citation publication-type="other" xlink:type="simple">HDF5;. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.hdfgroup.org/hdf5/" xlink:type="simple">https://www.hdfgroup.org/hdf5/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005430.ref034">
<label>34</label>
<mixed-citation publication-type="other" xlink:type="simple">Lin RJ, Bettencourt J, White JA, Christini DJ, Butera RJ. Real-time Experiment Interface for biological control applications. In: 2010 Annual International Conference of the IEEE Engineering in Medicine and Biology Society, EMBC’10; 2010. p. 4160–4163.</mixed-citation>
</ref>
<ref id="pcbi.1005430.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sieling</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Bédécarrats</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Simmers</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Prinz</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Nargeot</surname> <given-names>R</given-names></name>. <article-title>Differential roles of nonsynaptic and synaptic plasticity in operant reward learning-induced compulsive behavior</article-title>. <source>Current Biology</source>. <year>2014</year>;<volume>24</volume>(<issue>9</issue>):<fpage>941</fpage>–<lpage>950</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cub.2014.03.004" xlink:type="simple">10.1016/j.cub.2014.03.004</ext-link></comment> <object-id pub-id-type="pmid">24704077</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tchernichovski</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Nottebohm</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Ho</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Pesaran</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Mitra</surname> <given-names>PP</given-names></name>. <article-title>A procedure for an automated measurement of song similarity</article-title>. <source>Animal Behaviour</source>. <year>2000</year>;<volume>59</volume>(<issue>6</issue>):<fpage>1167</fpage>–<lpage>1176</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/anbe.1999.1416" xlink:type="simple">10.1006/anbe.1999.1416</ext-link></comment> <object-id pub-id-type="pmid">10877896</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Leonardo</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Fee</surname> <given-names>MS</given-names></name>. <article-title>Ensemble coding of vocal control in birdsong</article-title>. <source>The Journal of Neuroscience</source>. <year>2005</year>;<volume>25</volume>(<issue>3</issue>):<fpage>652</fpage>–<lpage>661</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3036-04.2005" xlink:type="simple">10.1523/JNEUROSCI.3036-04.2005</ext-link></comment> <object-id pub-id-type="pmid">15659602</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Skocik</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kozhevnikov</surname> <given-names>A</given-names></name>. <article-title>Real-time system for studies of the effects of acoustic feedback on animal vocalizations</article-title>. <source>Frontiers in Neural Circuits</source>. <year>2012</year>;<volume>6</volume>:<fpage>111</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncir.2012.00111" xlink:type="simple">10.3389/fncir.2012.00111</ext-link></comment> <object-id pub-id-type="pmid">23316137</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sakata</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>S</surname> <given-names>BM</given-names></name>. <article-title>Real-time contributions of auditory feedback to avian vocal motor control</article-title>. <source>The Journal of Neuroscience</source>. <year>2006</year>;<volume>26</volume>:<fpage>9619</fpage>–<lpage>9628</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.2027-06.2006" xlink:type="simple">10.1523/JNEUROSCI.2027-06.2006</ext-link></comment> <object-id pub-id-type="pmid">16988032</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fröhlich</surname> <given-names>F</given-names></name>. <article-title>Endogenous and exogenous electric fields as modifiers of brain activity: rational design of noninvasive brain stimulation with transcranial alternating current stimulation</article-title>. <source>Dialogues in Clinical Neuroscience</source>. <year>2014</year>;<volume>16</volume>(<issue>1</issue>):<fpage>93</fpage>–<lpage>102</lpage>. <object-id pub-id-type="pmid">24733974</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fröhlich</surname> <given-names>F</given-names></name>. <article-title>Experiments and models of cortical oscillations as a target for noninvasive brain stimulation</article-title>. <source>Progress in Brain Research</source>. <year>2015</year>;<volume>222</volume>:<fpage>41</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/bs.pbr.2015.07.025" xlink:type="simple">10.1016/bs.pbr.2015.07.025</ext-link></comment> <object-id pub-id-type="pmid">26541376</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Scholvin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kinney</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Bernstein</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Moore-Kochlacs</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kopell</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Fonstad</surname> <given-names>CG</given-names></name>, <etal>et al</etal>. <article-title>Close-packed silicon microelectrodes for scalable spatially oversampled neural recording</article-title>. <source>IEEE Transactions on Biomedical Engineering</source>. <year>2016</year>;<volume>63</volume>(<issue>1</issue>):<fpage>120</fpage>–<lpage>130</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TBME.2015.2406113" xlink:type="simple">10.1109/TBME.2015.2406113</ext-link></comment> <object-id pub-id-type="pmid">26699649</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Frey</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Sedivy</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Heer</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Pedron</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ballini</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mueller</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Switch-matrix-based high-density microelectrode array in CMOS technology</article-title>. <source>IEEE Journal of Solid-State Circuits</source>. <year>2010</year>;<volume>45</volume>(<issue>2</issue>):<fpage>467</fpage>–<lpage>482</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/JSSC.2009.2035196" xlink:type="simple">10.1109/JSSC.2009.2035196</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buzsáki</surname> <given-names>G</given-names></name>. <article-title>Large-scale recording of neuronal ensembles</article-title>. <source>Nature Neuroscience</source>. <year>2004</year>;<volume>7</volume>(<issue>5</issue>):<fpage>446</fpage>–<lpage>451</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1233" xlink:type="simple">10.1038/nn1233</ext-link></comment> <object-id pub-id-type="pmid">15114356</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref045">
<label>45</label>
<mixed-citation publication-type="other" xlink:type="simple">Harrison RR. A versatile integrated circuit for the acquisition of biopotentials. In: 2007 IEEE Custom Integrated Circuits Conference. IEEE; 2007. p. 115–122.</mixed-citation>
</ref>
<ref id="pcbi.1005430.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Harrison</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Kolb</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Kodandaramaiah</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Chubykin</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bear</surname> <given-names>MF</given-names></name>, <etal>et al</etal>. <article-title>Microchip amplifier for in vitro, in vivo, and automated whole cell patch-clamp recording</article-title>. <source>Journal of Neurophysiology</source>. <year>2015</year>;<volume>113</volume>(<issue>4</issue>):<fpage>1275</fpage>–<lpage>1282</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00629.2014" xlink:type="simple">10.1152/jn.00629.2014</ext-link></comment> <object-id pub-id-type="pmid">25429119</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>LP</given-names></name>, <name name-style="western"><surname>Boyden</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Deisseroth</surname> <given-names>K</given-names></name>. <article-title>Channelrhodopsin-2 and optical control of excitable cells</article-title>. <source>Nature Methods</source>. <year>2006</year>;<volume>3</volume>(<issue>10</issue>):<fpage>785</fpage>–<lpage>792</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth936" xlink:type="simple">10.1038/nmeth936</ext-link></comment> <object-id pub-id-type="pmid">16990810</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yizhar</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Fenno</surname> <given-names>LE</given-names></name>, <name name-style="western"><surname>Davidson</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Mogri</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Deisseroth</surname> <given-names>K</given-names></name>. <article-title>Optogenetics in neural systems</article-title>. <source>Neuron</source>. <year>2011</year>;<volume>71</volume>(<issue>1</issue>):<fpage>9</fpage>–<lpage>34</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2011.06.004" xlink:type="simple">10.1016/j.neuron.2011.06.004</ext-link></comment> <object-id pub-id-type="pmid">21745635</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Arrenberg</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Stainier</surname> <given-names>DY</given-names></name>, <name name-style="western"><surname>Baier</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Huisken</surname> <given-names>J</given-names></name>. <article-title>Optogenetic control of cardiac function</article-title>. <source>Science</source>. <year>2010</year>;<volume>330</volume>(<issue>6006</issue>):<fpage>971</fpage>–<lpage>974</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1195929" xlink:type="simple">10.1126/science.1195929</ext-link></comment> <object-id pub-id-type="pmid">21071670</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Grosenick</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Marshel</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Deisseroth</surname> <given-names>K</given-names></name>. <article-title>Closed-loop and activity-guided optogenetic control</article-title>. <source>Neuron</source>. <year>2015</year>;<volume>86</volume>(<issue>1</issue>):<fpage>106</fpage>–<lpage>139</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2015.03.034" xlink:type="simple">10.1016/j.neuron.2015.03.034</ext-link></comment> <object-id pub-id-type="pmid">25856490</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Newman</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Fong</surname> <given-names>Mf</given-names></name>, <name name-style="western"><surname>Millard</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Whitmire</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Stanley</surname> <given-names>GB</given-names></name>, <name name-style="western"><surname>Potter</surname> <given-names>SM</given-names></name>. <article-title>Optogenetic feedback control of neural activity</article-title>. <source>eLife</source>. <year>2015</year>;<volume>4</volume>:<fpage>e07192</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.7554/eLife.07192" xlink:type="simple">10.7554/eLife.07192</ext-link></comment> <object-id pub-id-type="pmid">26140329</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005430.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Govorunova</surname> <given-names>EG</given-names></name>, <name name-style="western"><surname>Cunha</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Sineshchekov</surname> <given-names>OA</given-names></name>, <name name-style="western"><surname>Spudich</surname> <given-names>JL</given-names></name>. <article-title>Anion channelrhodopsins for inhibitory cardiac optogenetics</article-title>. <source>Scientific Reports</source>. <year>2016</year>;<volume>6</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/srep33530" xlink:type="simple">10.1038/srep33530</ext-link></comment> <object-id pub-id-type="pmid">27628215</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>