<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-00777</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005257</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Epidemiology</subject><subj-group><subject>Epidemiological methods and statistics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Epidemiology</subject><subj-group><subject>Infectious disease epidemiology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Infectious diseases</subject><subj-group><subject>Infectious disease epidemiology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Aquatic environments</subject><subj-group><subject>Freshwater environments</subject><subj-group><subject>Wetlands</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Earth sciences</subject><subj-group><subject>Marine and aquatic sciences</subject><subj-group><subject>Aquatic environments</subject><subj-group><subject>Freshwater environments</subject><subj-group><subject>Wetlands</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Earth sciences</subject><subj-group><subject>Geomorphology</subject><subj-group><subject>Topography</subject><subj-group><subject>Landforms</subject><subj-group><subject>Wetlands</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Kalman filter</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Kalman filter</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pathology and laboratory medicine</subject><subj-group><subject>Pathogens</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Random variables</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>A Likelihood Approach for Real-Time Calibration of Stochastic Compartmental Epidemic Models</article-title>
<alt-title alt-title-type="running-head">Real-Time Calibration of Stochastic Compartmental Epidemic Models</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Zimmer</surname> <given-names>Christoph</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9276-5750</contrib-id>
<name name-style="western">
<surname>Yaesoubi</surname> <given-names>Reza</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="fn" rid="econtrib001"><sup>‡</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Cohen</surname> <given-names>Ted</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="fn" rid="econtrib001"><sup>‡</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Epidemiology of Microbial Diseases, Yale School of Public Health, New Haven, Connecticut, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Health Policy and Management, Yale School of Public Health, New Haven, Connecticut, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Lessler</surname> <given-names>Justin</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Johns Hopkins Bloomberg School of Public Health, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item>
<p><bold>Conceptualization:</bold> CZ RY TC.</p>
</list-item>
<list-item>
<p><bold>Data curation:</bold> CZ.</p>
</list-item>
<list-item>
<p><bold>Formal analysis:</bold> CZ RY TC.</p>
</list-item>
<list-item>
<p><bold>Funding acquisition:</bold> RY TC.</p>
</list-item>
<list-item>
<p><bold>Investigation:</bold> CZ RY TC.</p>
</list-item>
<list-item>
<p><bold>Methodology:</bold> CZ RY TC.</p>
</list-item>
<list-item>
<p><bold>Resources:</bold> CZ TC.</p>
</list-item>
<list-item>
<p><bold>Software:</bold> CZ.</p>
</list-item>
<list-item>
<p><bold>Supervision:</bold> RY TC.</p>
</list-item>
<list-item>
<p><bold>Validation:</bold> CZ RY TC.</p>
</list-item>
<list-item>
<p><bold>Visualization:</bold> CZ RY TC.</p>
</list-item>
<list-item>
<p><bold>Writing – original draft:</bold> CZ RY TC.</p>
</list-item>
<list-item>
<p><bold>Writing – review &amp; editing:</bold> CZ RY TC.</p>
</list-item>
</list>
</p>
</fn>
<fn fn-type="other" id="econtrib001">
<p>‡ These authors are joint senior authors on this work.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">christoph.zimmer@yale.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>1</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>17</day>
<month>1</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>1</issue>
<elocation-id>e1005257</elocation-id>
<history>
<date date-type="received">
<day>16</day>
<month>5</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>21</day>
<month>11</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Zimmer et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005257"/>
<abstract>
<p>Stochastic transmission dynamic models are especially useful for studying the early emergence of novel pathogens given the importance of chance events when the number of infectious individuals is small. However, methods for parameter estimation and prediction for these types of stochastic models remain limited. In this manuscript, we describe a calibration and prediction framework for stochastic compartmental transmission models of epidemics. The proposed method, Multiple Shooting for Stochastic systems (MSS), applies a linear noise approximation to describe the size of the fluctuations, and uses each new surveillance observation to update the belief about the true epidemic state. Using simulated outbreaks of a novel viral pathogen, we evaluate the accuracy of MSS for real-time parameter estimation and prediction during epidemics. We assume that weekly counts for the number of new diagnosed cases are available and serve as an imperfect proxy of incidence. We show that MSS produces accurate estimates of key epidemic parameters (i.e. mean duration of infectiousness, <italic>R</italic><sub>0</sub>, and <italic>R</italic><sub>eff</sub>) and can provide an accurate estimate of the unobserved number of infectious individuals during the course of an epidemic. MSS also allows for accurate prediction of the number and timing of future hospitalizations and the overall attack rate. We compare the performance of MSS to three state-of-the-art benchmark methods: 1) a likelihood approximation with an assumption of independent Poisson observations; 2) a particle filtering method; and 3) an ensemble Kalman filter method. We find that MSS significantly outperforms each of these three benchmark methods in the majority of epidemic scenarios tested. In summary, MSS is a promising method that may improve on current approaches for calibration and prediction using stochastic models of epidemics.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>The sporadic emergence and spread of novel human pathogens poses a continuing threat to global public health. Early and accurate prediction of epidemic behavior is needed to inform effective public health policy decisions which much balance the risk of major outbreaks with the substantial costs of interventions. Key parameters governing the behavior of epidemics, however, cannot be directly observed and hence computational techniques are required for parameter estimation and prediction on the basis of imperfect surveillance data. In this paper, we develop a method (Multiple Shooting for Stochastic Systems, MSS) that utilizes accumulating epidemic data to estimate in real-time (1) key epidemic parameters including the average number of secondary cases and the mean duration of infectiousness, (2) the future number of cases, and (3) the unobserved number of infected individuals in the population. Employing comprehensive simulation experiments, we demonstrate that MSS outperforms the existing state-of-the-art calibration and prediction techniques in the majority of simulated scenarios. MSS may thus allow policy makers to respond more effectively and use resources more efficiently in the face of emerging epidemic threats.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>R01AI112438</award-id>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>U54GM088558</award-id>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>1K01AI119603</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Zimmer</surname> <given-names>Christoph</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>The project described was supported by NIH Award Numbers R01AI112438, U54GM088558 and K01AI119603. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Allergy and Infectious Diseases or the National Institute of General Medical Sciences. This research work was partially conducted while the first author, CZ, was a visiting scholar at the Department of Global Health Equity at Brigham and Women’s Hospital, Harvard Medical School. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="0"/>
<page-count count="21"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The sporadic emergence of novel human pathogens (e.g. SARS, MERS, new strains of influenza) serves as a reminder of the importance of monitoring the spillover into and spread of pathogens in human populations. Accurate estimates of the fundamental epidemic parameters during the earliest phase of disease emergence can facilitate rational public health policy decisions [<xref ref-type="bibr" rid="pcbi.1005257.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1005257.ref002">2</xref>] and are thus of high priority [<xref ref-type="bibr" rid="pcbi.1005257.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005257.ref004">4</xref>].</p>
<p>Estimating epidemic parameters is challenging during this initial period of disease emergence because the dynamics are stochastic and the processes governing disease spread are complex and usually only partially observable. Public health decision makers, therefore, require tools to make inference about the true state of the epidemic and the values of fundamental epidemic parameters using observations that can only imperfectly represent the true epidemic state (e.g. reported disease-related illnesses serve as an imperfect measure of incident cases).</p>
<p>There has been substantial recent progress in the development of methods to infer epidemic parameters from partial epidemic observations [<xref ref-type="bibr" rid="pcbi.1005257.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1005257.ref011">11</xref>]. For example, infection network models are commonly used when symptom onset date for each reported case is available [<xref ref-type="bibr" rid="pcbi.1005257.ref012">12</xref>–<xref ref-type="bibr" rid="pcbi.1005257.ref017">17</xref>]. In these models, disease spread is described as a directed network in which the nodes represent cases and the directed edges between nodes represent transmission links. In the absence of the type of detailed individual-level data required by infection network methods, compartmental transmission dynamic models have been used for parameter estimation and for projecting epidemic trajectory. These models divide the population into disjoint subgroups (e.g. susceptible, infectious, and recovered) and transitions between the epidemic states are described using ordinary differential equations (for deterministic models) [<xref ref-type="bibr" rid="pcbi.1005257.ref018">18</xref>] or Markov chains (for stochastic models) [<xref ref-type="bibr" rid="pcbi.1005257.ref019">19</xref>].</p>
<p>A wide variety of methods have been described to calibrate these compartmental models which differ based how they estimate the likelihood of observations. These methods make use of deterministic [<xref ref-type="bibr" rid="pcbi.1005257.ref020">20</xref>–<xref ref-type="bibr" rid="pcbi.1005257.ref022">22</xref>] or stochastic [<xref ref-type="bibr" rid="pcbi.1005257.ref023">23</xref>] models to describe the underlying epidemic process, and may involve Markov Chain Monte Carlo [<xref ref-type="bibr" rid="pcbi.1005257.ref024">24</xref>] or filtering techniques [<xref ref-type="bibr" rid="pcbi.1005257.ref025">25</xref>–<xref ref-type="bibr" rid="pcbi.1005257.ref032">32</xref>] to sample parameter space and the unobserved states.</p>
<p>In this paper, we describe an alternative method for calibrating a general class of stochastic compartmental models using the types of data that would be available during the early period of epidemic spread. Unlike deterministic models, stochastic models capture chance events, a feature that proves essential for the accuracy of model-based parameter estimation and prediction during pathogen emergence.</p>
<p>Our calibration method, Multiple Shooting for Stochastic systems (MSS), utilizes a linear noise approximation (LNA) approach and a state-updating procedure to approximate the likelihood of observations while explicitly accounting for the interdependency between subsequent epidemic observations. Using simulation experiments, we compare the performance of MSS with several competing approaches in terms of accuracy in estimating parameters, predicting future behaviors, and inferring the current epidemic state. We test the sensitivity of the performance of these approaches to observational noise and model misspecification.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>Problem formulation</title>
<p>During an epidemic, surveillance systems may be able to capture a variety of measures, such as the number of disease-related diagnoses, hospitalizations or deaths. We use <italic>y</italic><sub><italic>i</italic></sub> to denote the vector of epidemic measures that can be observed during the period [<italic>t</italic><sub><italic>i</italic>−1</sub>, <italic>t</italic><sub><italic>i</italic></sub>] (see <xref ref-type="fig" rid="pcbi.1005257.g001">Fig 1</xref>). Let <italic>Y</italic><sub><italic>i</italic></sub> = (<italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>, …, <italic>y</italic><sub><italic>i</italic></sub>) be the epidemic history up to time <italic>t</italic><sub><italic>i</italic></sub>. To measure the fit of an epidemic model to the observations accumulated up to time <italic>t</italic><sub><italic>i</italic></sub>, we use the following likelihood function:
<disp-formula id="pcbi.1005257.e001"><alternatives><graphic id="pcbi.1005257.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4pt"/><mml:mo>=</mml:mo> <mml:mtext>Pr</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mspace width="4pt"/><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:mspace width="4pt"/><mml:mi mathvariant="script">P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <inline-formula id="pcbi.1005257.e002"><alternatives><graphic id="pcbi.1005257.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mi mathvariant="script">P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the probability of observing <italic>y</italic><sub><italic>i</italic></sub> given the previous observations (<italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>, …, <italic>y</italic><sub><italic>i</italic>−1</sub>) and the model parameters <italic>θ</italic>.</p>
<fig id="pcbi.1005257.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005257.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Sequence of observations during an epidemic.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.g001" xlink:type="simple"/>
</fig>
<p>For many epidemics, the probability function <inline-formula id="pcbi.1005257.e003"><alternatives><graphic id="pcbi.1005257.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mi mathvariant="script">P</mml:mi> <mml:mo>(</mml:mo> <mml:mo>·</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> may not be readily available and can be computationally expensive to evaluate. Therefore, the likelihood function <xref ref-type="disp-formula" rid="pcbi.1005257.e001">(1)</xref> is often approximated by assuming that the epidemic observations in each period follow a discrete probability distribution (e.g. Poisson distribution) and are independently distributed across observation periods [<xref ref-type="bibr" rid="pcbi.1005257.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005257.ref033">33</xref>]. For example, to approximate the likelihood function <xref ref-type="disp-formula" rid="pcbi.1005257.e001">(1)</xref>, Riley and colleagues assume that epidemic observations follow independent Poisson distributions where means are chosen to match the means generated from 250 model replications [<xref ref-type="bibr" rid="pcbi.1005257.ref023">23</xref>]. The method we develop here to approximate the likelihood function <xref ref-type="disp-formula" rid="pcbi.1005257.e001">(1)</xref> does not retain the unrealistic assumption that these observations are independent.</p>
<p>Below, we first describe an algorithm to efficiently approximate the probability function <inline-formula id="pcbi.1005257.e004"><alternatives><graphic id="pcbi.1005257.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mi mathvariant="script">P</mml:mi> <mml:mo>(</mml:mo> <mml:mo>·</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> which can then be used to evaluate the likelihood function <xref ref-type="disp-formula" rid="pcbi.1005257.e001">(1)</xref> for observations accumulated up to any point in the epidemic.</p>
</sec>
<sec id="sec004">
<title>Approximating the likelihood function</title>
<p>In a compartmental model, the state of the epidemic at a given time <italic>t</italic><sub><italic>i</italic></sub> is defined as the number of individuals in each compartment at time <italic>t</italic><sub><italic>i</italic></sub> [<xref ref-type="bibr" rid="pcbi.1005257.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1005257.ref034">34</xref>], which we will refer to as <italic>ν</italic><sub><italic>i</italic></sub>. In most settings, particularly if the disease has a complicated natural history, the true distribution of individuals in each state over the course of epidemic progression, <italic>ν</italic><sub><italic>i</italic></sub>, <italic>i</italic> ∈ {0, 1, 2, …}, is not fully observable. Hence, to form statistical inference about the true epidemic state, we utilize belief states which define a probability distribution over all possible epidemic states given past observations.</p>
<p>Let Π(⋅|<italic>Y</italic><sub><italic>i</italic></sub>) denote the belief state at time <italic>t</italic><sub><italic>i</italic></sub> given the accumulated observations <italic>Y</italic><sub><italic>i</italic></sub>. Now by conditioning on the epidemic state at time <italic>t</italic><sub><italic>i</italic>−1</sub>, i.e. <italic>ν</italic><sub><italic>i</italic>−1</sub>, the probability function <inline-formula id="pcbi.1005257.e005"><alternatives><graphic id="pcbi.1005257.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mi mathvariant="script">P</mml:mi> <mml:mo>(</mml:mo> <mml:mo>·</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1005257.e001">Eq (1)</xref> can be calculated as:
<disp-formula id="pcbi.1005257.e006"><alternatives><graphic id="pcbi.1005257.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mrow><mml:mi mathvariant="script">P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>∈</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4pt"/><mml:mo>Π</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
where <italic>Ω</italic><sub><italic>i</italic>−1</sub> is the set of feasible epidemic states (i.e. the support of the belief state Π) at time <italic>t</italic><sub><italic>i</italic>−1</sub>. By conditioning on the state of the epidemic at time <italic>t</italic><sub><italic>i</italic></sub>, the probability function <inline-formula id="pcbi.1005257.e007"><alternatives><graphic id="pcbi.1005257.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:mi mathvariant="script">P</mml:mi> <mml:mo>(</mml:mo> <mml:mo>·</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1005257.e006">Eq (2)</xref> can be calculated as:
<disp-formula id="pcbi.1005257.e008"><alternatives><graphic id="pcbi.1005257.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="script">P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="28.45274pt"/><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mspace width="4pt"/><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>∈</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4pt"/><mml:mo>Π</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
Calculating the probability function <xref ref-type="disp-formula" rid="pcbi.1005257.e008">(3)</xref> can be computationally difficult. First, it requires calculating or approximating the transition probability <italic>p</italic>(<italic>ν</italic><sub><italic>i</italic></sub>|<italic>ν</italic><sub><italic>i</italic>−1</sub>; <italic>θ</italic>) for each pair (<italic>ν</italic><sub><italic>i</italic></sub>, <italic>ν</italic><sub><italic>i</italic>−1</sub>) ∈ <italic>Ω</italic><sub><italic>i</italic></sub> × <italic>Ω</italic><sub><italic>i</italic>−1</sub>, and second, it involves enumeration over the set <italic>Ω</italic><sub><italic>i</italic></sub> × <italic>Ω</italic><sub><italic>i</italic>−1</sub>, which can be prohibitively large even for simple epidemic models. One way to simplify the computational complexity of <xref ref-type="disp-formula" rid="pcbi.1005257.e008">Eq (3)</xref> is to represent the belief state Π(⋅|<italic>Y</italic><sub><italic>i</italic></sub>) as a step function that takes 1 for the most probable state (denoted by <inline-formula id="pcbi.1005257.e009"><alternatives><graphic id="pcbi.1005257.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) and 0 elsewhere. This allows us to approximate the function <inline-formula id="pcbi.1005257.e010"><alternatives><graphic id="pcbi.1005257.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mi mathvariant="script">P</mml:mi> <mml:mo>(</mml:mo> <mml:mo>·</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1005257.e008">Eq (3)</xref> with:
<disp-formula id="pcbi.1005257.e011"><alternatives><graphic id="pcbi.1005257.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="script">P</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mspace width="4pt"/><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
where <inline-formula id="pcbi.1005257.e012"><alternatives><graphic id="pcbi.1005257.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> represents the most likely epidemic state given observations <italic>Y</italic><sub><italic>i</italic>−1</sub> = (<italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>, …, <italic>y</italic><sub><italic>i</italic>−1</sub>). By the definition of epidemic states, the transition from state <italic>ν</italic><sub><italic>i</italic>−1</sub> to <italic>ν</italic><sub><italic>i</italic></sub> generates a unique set of observations, and it is trivial to find whether the state transition <inline-formula id="pcbi.1005257.e013"><alternatives><graphic id="pcbi.1005257.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> to <italic>ν</italic><sub><italic>i</italic></sub> can generate the observation <italic>y</italic><sub><italic>i</italic></sub> (see design of performance analysis for an illustrative example). Therefore, for a given observation <italic>y</italic><sub><italic>i</italic></sub>, the probability <inline-formula id="pcbi.1005257.e014"><alternatives><graphic id="pcbi.1005257.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1005257.e011">Eq (4)</xref> is equal to 1 if the transition from state <inline-formula id="pcbi.1005257.e015"><alternatives><graphic id="pcbi.1005257.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> to <italic>ν</italic><sub><italic>i</italic></sub> results in observing <italic>y</italic><sub><italic>i</italic></sub>, and is zero otherwise. To calculate <inline-formula id="pcbi.1005257.e016"><alternatives><graphic id="pcbi.1005257.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="script">P</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1005257.e011">Eq (4)</xref>, it only remains to identify the state transition probability function <inline-formula id="pcbi.1005257.e017"><alternatives><graphic id="pcbi.1005257.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and a state estimation scheme. In the next subsections, we propose an algorithm to achieve this.</p>
<sec id="sec005">
<title>Approximating state transition probabilities</title>
<p>Finding the exact state transition probability function <italic>p</italic>(⋅) can be difficult, and in many cases impossible, as state spaces in epidemic models can be quite large or unbounded. To overcome this problem, we employ a linear noise approximation (LNA) method to approximate the probability distribution of the new epidemic state <italic>ν</italic><sub><italic>i</italic></sub> given the previous state <italic>ν</italic><sub><italic>i</italic>−1</sub>, i.e. <italic>p</italic>(<italic>ν</italic><sub><italic>i</italic></sub>|<italic>ν</italic><sub><italic>i</italic>−1</sub>; <italic>θ</italic>). The LNA has been previously used to estimate parameters of stochastic biochemical reaction models [<xref ref-type="bibr" rid="pcbi.1005257.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1005257.ref036">36</xref>]. Here we extend Zimmer and Sahle’s method [<xref ref-type="bibr" rid="pcbi.1005257.ref036">36</xref>] to calibrate stochastic epidemic models where the true epidemic state is only partially observable.</p>
<p>To approximate the probability distribution of <italic>ν</italic><sub><italic>i</italic></sub> given the state <italic>ν</italic><sub><italic>i</italic>−1</sub>, the LNA method uses an ordinary differential equations (ODE) model to approximate the <italic>expected</italic> behavior of the epidemic over the period [<italic>t</italic><sub><italic>i</italic>−1</sub>, <italic>t</italic><sub><italic>i</italic></sub>] and to identify a co-variance matrix to characterize the uncertainty around the epidemic behavior over this interval. We use the following notation to denote the ODE epidemic model used by the LNA method:
<disp-formula id="pcbi.1005257.e018"><alternatives><graphic id="pcbi.1005257.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>Γ</mml:mo> <mml:mo>Λ</mml:mo> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
In the ODE system <xref ref-type="disp-formula" rid="pcbi.1005257.e018">(5)</xref>, the vector <italic>x</italic>(<italic>t</italic>, <italic>x</italic><sub>0</sub>; <italic>θ</italic>) is the epidemic state of the ODE model at time <italic>t</italic> given the initial state <italic>x</italic><sub>0</sub>, the vector Λ(<italic>x</italic>(<italic>t</italic>, <italic>x</italic><sub>0</sub>; <italic>θ</italic>), <italic>θ</italic>) denotes the instantaneous changes in the epidemic when at state <italic>x</italic>(<italic>t</italic>, <italic>x</italic><sub>0</sub>; <italic>θ</italic>), and the matrix Γ describes how the instantaneous changes at time <italic>t</italic> impact the epidemic state at time <italic>t</italic> + Δ<italic>t</italic> (see subsequent sections for an example).</p>
<p>The LNA assumes that the probability distribution of <italic>ν</italic><sub><italic>i</italic></sub>|<italic>ν</italic><sub><italic>i</italic>−1</sub> can be properly approximated by a normal distribution <inline-formula id="pcbi.1005257.e019"><alternatives><graphic id="pcbi.1005257.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mo form="prefix">cov</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The mean vector <italic>μ</italic><sub><italic>i</italic></sub> is the solution of ODE system <xref ref-type="disp-formula" rid="pcbi.1005257.e018">(5)</xref> with <italic>ν</italic><sub><italic>i</italic>−1</sub> as the initial condition (i.e. <italic>μ</italic><sub><italic>i</italic></sub> = <italic>x</italic>(<italic>t</italic><sub><italic>i</italic></sub> − <italic>t</italic><sub><italic>i</italic>−1</sub>, <italic>ν</italic><sub><italic>i</italic>−1</sub>; <italic>θ</italic>)) and the variance matrix cov<sub><italic>i</italic></sub> = Σ(<italic>t</italic><sub><italic>i</italic></sub> − <italic>t</italic><sub><italic>i</italic>−1</sub>, <italic>ν</italic><sub><italic>i</italic>−1</sub>; <italic>θ</italic>) is the solution of the following ODE systems [<xref ref-type="bibr" rid="pcbi.1005257.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1005257.ref038">38</xref>]:
<disp-formula id="pcbi.1005257.e020"><alternatives><graphic id="pcbi.1005257.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mi>J</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>J</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:mi>D</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Σ</mml:mo> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mn>0</mml:mn> <mml:mrow><mml:mi>K</mml:mi> <mml:mo>×</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
In the ODE system <xref ref-type="disp-formula" rid="pcbi.1005257.e020">(6)</xref>, <inline-formula id="pcbi.1005257.e021"><alternatives><graphic id="pcbi.1005257.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:mi>J</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>Γ</mml:mo> <mml:mstyle displaystyle="false" scriptlevel="0"><mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mstyle> <mml:mo>Λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <italic>D</italic> is a <italic>K</italic> × <italic>K</italic> matrix with the (<italic>i</italic>, <italic>j</italic>) entity equal to <inline-formula id="pcbi.1005257.e022"><alternatives><graphic id="pcbi.1005257.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:msubsup> <mml:mrow><mml:msub><mml:mo>Γ</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mo>Γ</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mo>Λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>K</italic> is the number of compartments in the epidemic model.</p>
<p>An important question remains about how well this proposed LNA method approximates the probability distribution of epidemic states. Relying on an extensive numerical analysis, we will demonstrate in the Results section that for the epidemic scenarios considered, our method yields accurate parameter estimations and reliable predictions. We also note that our method does not rely on a single LNA model to approximate the entire epidemic trajectory. For each observation period [<italic>t</italic><sub><italic>i</italic>−1</sub>, <italic>t</italic><sub><italic>i</italic></sub>], it generates a new LNA model to approximate the epidemic behavior only over this particular period.</p>
</sec>
<sec id="sec006">
<title>Updating belief states</title>
<p>We now describe how to update our belief about the true state of the epidemic, denoted by Π(⋅), once new observations <italic>y</italic><sub><italic>i</italic></sub> are obtained. We first note that Π(⋅) is defined to return 1 for the most likely state <inline-formula id="pcbi.1005257.e023"><alternatives><graphic id="pcbi.1005257.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, and zero elsewhere. Therefore, given the state <inline-formula id="pcbi.1005257.e024"><alternatives><graphic id="pcbi.1005257.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> at time <italic>t</italic><sub><italic>i</italic>−1</sub>, the probability of observing <italic>y</italic><sub><italic>i</italic></sub> during the interval [<italic>t</italic><sub><italic>i</italic>−1</sub>, <italic>t</italic><sub><italic>i</italic></sub>] is equal to <inline-formula id="pcbi.1005257.e025"><alternatives><graphic id="pcbi.1005257.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (see the discussion prior to <xref ref-type="disp-formula" rid="pcbi.1005257.e008">Eq (3)</xref>).</p>
<p>Now, the most probable state at time <italic>t</italic><sub><italic>i</italic></sub>, <inline-formula id="pcbi.1005257.e026"><alternatives><graphic id="pcbi.1005257.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, is the one that leads to the highest probability of observing <italic>y</italic><sub><italic>i</italic></sub>:
<disp-formula id="pcbi.1005257.e027"><alternatives><graphic id="pcbi.1005257.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mrow><mml:mo form="prefix">arg</mml:mo> <mml:mo form="prefix" movablelimits="true">max</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mspace width="0.166667em"/><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
As discussed above, <inline-formula id="pcbi.1005257.e028"><alternatives><graphic id="pcbi.1005257.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is either 0 or 1, and the probability function <inline-formula id="pcbi.1005257.e029"><alternatives><graphic id="pcbi.1005257.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mo>·</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is approximated with a Normal distribution. Therefore, it is straightforward to solve the optimization problem <xref ref-type="disp-formula" rid="pcbi.1005257.e027">(7)</xref>. Note that in compartmental models, the support <italic>Ω</italic><sub><italic>i</italic></sub> can be recursively updated as new observations become available (see [<xref ref-type="bibr" rid="pcbi.1005257.ref039">39</xref>] for details and the <xref ref-type="supplementary-material" rid="pcbi.1005257.s001">S1 Text</xref> subsection 8 “Detailed pseudo code for our MSS” for an illustration).</p>
</sec>
</sec>
<sec id="sec007">
<title>Estimating model parameters</title>
<p>One of the main goals of model calibration is to leverage information from accumulating observations to characterize the uncertainty around model parameters. To this end, we employ a Bayesian approach that updates the probabilistic information on model parameters as new observations become available. This updating is performed according to the following Bayes rule:
<disp-formula id="pcbi.1005257.e030"><alternatives><graphic id="pcbi.1005257.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mrow><mml:msub><mml:mi>π</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:msup><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>MSS</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>π</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula>
where <italic>π</italic><sub><italic>i</italic>−1</sub>(⋅, <italic>Y</italic><sub><italic>i</italic>−1</sub>) is the prior distribution before obtaining the <italic>i</italic><sup><italic>th</italic></sup> observation and <italic>π</italic><sub><italic>i</italic></sub>(⋅|<italic>Y</italic><sub><italic>i</italic></sub>) is the posterior distribution after obtaining the <italic>i</italic><sup><italic>th</italic></sup> observation. In <xref ref-type="disp-formula" rid="pcbi.1005257.e030">Eq (8)</xref>, the likelihood function <italic>L</italic><sup>(MSS)</sup>(⋅|<italic>θ</italic>) is estimated using the approach described in the preceding sections. Note that <italic>π</italic> is used for both prior and posterior as the posterior is recursively calculated from the prior upon obtaining subsequent observations.</p>
<p><xref ref-type="fig" rid="pcbi.1005257.g002">Fig 2</xref> summarizes the steps of our proposed method for calibrating stochastic epidemic models. The set Θ in Step 1.b includes parameter values for which the likelihood function <xref ref-type="disp-formula" rid="pcbi.1005257.e001">(1)</xref> should be calculated. This set can be built by sampling from the prior distribution <italic>π</italic><sub>0</sub>(<italic>θ</italic>) or via other sampling methods including random, Latin hypercube, or orthogonal sampling. Obviously, the sample set Θ can be modified as new observations become available and the prior distribution <italic>π</italic><sub>0</sub>(<italic>θ</italic>) is being updated. However, the main advantage of fixing the sample set Θ at the beginning of the algorithm is to allow the algorithm to update the likelihood function <xref ref-type="disp-formula" rid="pcbi.1005257.e001">(1)</xref> in a recursive manner as new observations are accumulating over time. That is, to find the likelihood value <italic>L</italic><sup>(MSS)</sup>(<italic>Y</italic><sub><italic>i</italic></sub>; <italic>θ</italic>) at time <italic>t</italic><sub><italic>i</italic></sub>, we only need to know the value of the likelihood function from the previous time step (i.e. <italic>L</italic><sup>(MSS)</sup>(<italic>Y</italic><sub><italic>i</italic>−1</sub>; <italic>θ</italic>)) and the probability P(<italic>y</italic><sub><italic>i</italic></sub>|<italic>Y</italic><sub><italic>i</italic>−1</sub>; <italic>θ</italic>) (see Step 2.c). The parameter posterior distribution obtained by using observations <italic>Y</italic><sub><italic>i</italic>−1</sub> can be used as a prior distribution once a new observation <italic>y</italic><sub><italic>i</italic></sub> becomes available.</p>
<fig id="pcbi.1005257.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005257.g002</object-id>
<label>Fig 2</label>
<caption>
<title>An algorithm for real-time calibration of stochastic compartmental epidemic models.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008">
<title>Predicting epidemic behavior</title>
<p>A central motivation for developing better methods for calibration of stochastic epidemic models is to improve predictions about the future course of epidemics.</p>
<p>To demonstrate how our method can be used for prediction, let <italic>Z</italic> denote the quantity that we wish to predict (e.g. the number of diagnoses during the subsequent week) and <inline-formula id="pcbi.1005257.e031"><alternatives><graphic id="pcbi.1005257.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:mi mathvariant="script">P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>Z</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> denote the probability density function of the random variable <italic>Z</italic> if the epidemic is at state <italic>ν</italic><sub><italic>i</italic></sub> ∈ <italic>Ω</italic><sub><italic>i</italic></sub> at time <italic>t</italic><sub><italic>i</italic></sub> and the epidemic parameters have value <italic>θ</italic> ∈ Θ. Now, the probability distribution of the random variable <italic>Z</italic> given the accumulated observations at time <italic>t</italic><sub><italic>i</italic></sub>, <italic>Y</italic><sub><italic>i</italic></sub> = (<italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>, …, <italic>y</italic><sub><italic>i</italic></sub>), can be calculated as:
<disp-formula id="pcbi.1005257.e032"><alternatives><graphic id="pcbi.1005257.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>Z</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>∈</mml:mo> <mml:mo>Θ</mml:mo></mml:mrow></mml:msub> <mml:msub><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>Z</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4pt"/><mml:mo>Π</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4pt"/><mml:msub><mml:mi>π</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4pt"/><mml:mi>d</mml:mi> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mspace width="4pt"/><mml:mi>d</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
In <xref ref-type="disp-formula" rid="pcbi.1005257.e032">Eq (9)</xref>, the belief state Π(⋅|<italic>Y</italic><sub><italic>i</italic></sub>; <italic>θ</italic>) and the parameter posterior distribution <italic>π</italic><sub><italic>i</italic></sub>(⋅|<italic>Y</italic><sub><italic>i</italic></sub>) are both obtained from the algorithm described in <xref ref-type="fig" rid="pcbi.1005257.g002">Fig 2</xref>. To calculate the distribution of the random variable <italic>Z</italic>|<italic>Y</italic><sub><italic>i</italic></sub>, we assume that we have access to a stochastic simulation model to sample from the random variable <italic>Z</italic>|<italic>ν</italic><sub><italic>i</italic></sub> for a given set of parameter values <italic>θ</italic>. For the numerical results presented here, we use the Gillespie algorithm [<xref ref-type="bibr" rid="pcbi.1005257.ref040">40</xref>] (see SI document) to generate realizations for <italic>Z</italic>|<italic>Y</italic><sub><italic>i</italic></sub> that can be used to estimate the probability function <italic>P</italic>(<italic>Z</italic>|<italic>Y</italic><sub><italic>i</italic></sub>) in <xref ref-type="disp-formula" rid="pcbi.1005257.e032">Eq (9)</xref>, or to calculate mean or other moments of the random variable <italic>Z</italic>|<italic>Y</italic><sub><italic>i</italic></sub>.</p>
</sec>
<sec id="sec009">
<title>Benchmark methods</title>
<p>We compare the performance of our method with three competing state-of-the-art approaches. The first benchmark method, which is based on an assumption of independent Poisson observations, is straightforward to understand and to implement and has been used to infer basic fundamental parameters during the early appearance of novel pathogens [<xref ref-type="bibr" rid="pcbi.1005257.ref023">23</xref>]. For the second and third approaches, we consider Particle Filter and Ensemble Kalman Filter [<xref ref-type="bibr" rid="pcbi.1005257.ref027">27</xref>] as these methods won the 2014 “Predict the Influenza Season Challenge” sponsored by the U.S. Center for Disease Control and Prevention [<xref ref-type="bibr" rid="pcbi.1005257.ref041">41</xref>] and also demonstrate competitive performance against four other methods in a recent comparison study [<xref ref-type="bibr" rid="pcbi.1005257.ref027">27</xref>].</p>
<sec id="sec010">
<title>Benchmark method A: Likelihood approximation with the assumption of independent Poisson observations (I.Poi)</title>
<p>We use the method from Riley and colleagues [<xref ref-type="bibr" rid="pcbi.1005257.ref023">23</xref>] as the first benchmark. This method assumes that the observations <italic>y</italic><sub><italic>i</italic></sub> are independent and factorizes the likelihood function <italic>L</italic>(<italic>Y</italic><sub><italic>i</italic></sub>; <italic>θ</italic>) (<xref ref-type="disp-formula" rid="pcbi.1005257.e001">Eq (1)</xref>) to
<disp-formula id="pcbi.1005257.e033"><alternatives><graphic id="pcbi.1005257.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>I</mml:mtext><mml:mo>.</mml:mo><mml:mtext>Poi</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:msup><mml:mi mathvariant="script">P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>I</mml:mtext><mml:mo>.</mml:mo><mml:mtext>Poi</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where <inline-formula id="pcbi.1005257.e034"><alternatives><graphic id="pcbi.1005257.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:msup><mml:mi mathvariant="script">P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>I</mml:mtext><mml:mo>.</mml:mo><mml:mtext>Poi</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>·</mml:mo> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:mi>P</mml:mi> <mml:mi>o</mml:mi> <mml:mi>i</mml:mi> <mml:mi>s</mml:mi> <mml:mi>s</mml:mi> <mml:mi>o</mml:mi> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. To calculate the mean <italic>μ</italic><sub><italic>i</italic></sub>, we obtain 1000 stochastic trajectories using parameter values <italic>θ</italic> and shift them so that the first observation for each trajectory lies within the first observation period [<italic>t</italic><sub>0</sub>, <italic>t</italic><sub>1</sub>]. We then calculate the mean of observations over period [<italic>t</italic><sub><italic>i</italic>−1</sub>, <italic>t</italic><sub><italic>i</italic></sub>] (i.e. <italic>μ</italic><sub><italic>i</italic></sub>) using these simulated trajectories. This approach ignores the inter-dependencies between observations <italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>, …, <italic>y</italic><sub><italic>i</italic></sub> and approximates <inline-formula id="pcbi.1005257.e035"><alternatives><graphic id="pcbi.1005257.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:mi mathvariant="script">P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> by <inline-formula id="pcbi.1005257.e036"><alternatives><graphic id="pcbi.1005257.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:msup><mml:mi mathvariant="script">P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>I</mml:mtext><mml:mo>.</mml:mo><mml:mtext>Poi</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Without the knowledge of an updated belief state Π(⋅|<italic>ν</italic><sub><italic>i</italic></sub>; <italic>θ</italic>), <xref ref-type="disp-formula" rid="pcbi.1005257.e032">Eq (9)</xref> for prediction reduces to
<disp-formula id="pcbi.1005257.e037"><alternatives><graphic id="pcbi.1005257.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mrow><mml:msup><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>I</mml:mtext><mml:mo>.</mml:mo><mml:mtext>Poi</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>Z</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>θ</mml:mi> <mml:mo>∈</mml:mo> <mml:mo>Θ</mml:mo></mml:mrow></mml:munder> <mml:mrow><mml:msup><mml:mi mathvariant="script">P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>I</mml:mtext><mml:mo>.</mml:mo><mml:mtext>Poi</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>Z</mml:mi> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>π</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula>
The mean and variance of random variable <italic>Z</italic> can be estimated using simulated trajectories with parameter values selected according to the probability function <italic>π</italic><sub><italic>i</italic></sub>(<italic>θ</italic>|<italic>Y</italic><sub><italic>i</italic></sub>). These simulated trajectories can also be used to make inference about the epidemic state at time <italic>t</italic><sub><italic>i</italic></sub>. To make predictions at time <italic>t</italic><sub><italic>i</italic></sub>, our implementation of the benchmark approach uses only simulated trajectories that have not been extinguished before <italic>t</italic><sub><italic>i</italic></sub>.</p>
</sec>
<sec id="sec011">
<title>Benchmark method B: Particle Filter</title>
<p>The Particle Filter (PF) approach described by [<xref ref-type="bibr" rid="pcbi.1005257.ref027">27</xref>] also seeks to approximate the likelihood function <xref ref-type="disp-formula" rid="pcbi.1005257.e001">(1)</xref> to calculate an a-posteriori distribution <italic>π</italic><sub><italic>i</italic></sub>(<italic>θ</italic>|<italic>Y</italic><sub><italic>i</italic></sub>) using the epidemic history <italic>Y</italic><sub><italic>i</italic></sub>. This method, however, uses a different approximation to calculate the probability <inline-formula id="pcbi.1005257.e038"><alternatives><graphic id="pcbi.1005257.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:mi mathvariant="script">P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1005257.e039"><alternatives><graphic id="pcbi.1005257.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e039" xlink:type="simple"/><mml:math display="block" id="M39"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi mathvariant="script">P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>PF</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mspace width="4pt"/><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>∈</mml:mo> <mml:msub><mml:mo>Ω</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:msup><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>PF</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>PF</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4pt"/><mml:msup><mml:mo>Π</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>PF</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula></p>
<p>While the belief state is also a point distribution, the state update is performed based on the solution of ODE system <xref ref-type="disp-formula" rid="pcbi.1005257.e018">(5)</xref>:
<disp-formula id="pcbi.1005257.e040"><alternatives><graphic id="pcbi.1005257.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>In <xref ref-type="disp-formula" rid="pcbi.1005257.e039">Eq (12)</xref>, the forward propagation <italic>p</italic><sup>(PF)</sup>(<italic>ν</italic><sub><italic>i</italic></sub>|<italic>ν</italic><sub><italic>i</italic>−1</sub>; <italic>θ</italic>) is a point distribution with mass 1 at <inline-formula id="pcbi.1005257.e041"><alternatives><graphic id="pcbi.1005257.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, and <italic>P</italic><sup>(PF)</sup>(<italic>y</italic><sub><italic>i</italic></sub>|<italic>ν</italic><sub><italic>i</italic></sub>, <italic>ν</italic><sub><italic>i</italic>−1</sub>; <italic>θ</italic>) is assumed to follow a normal distribution <inline-formula id="pcbi.1005257.e042"><alternatives><graphic id="pcbi.1005257.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>b</mml:mi> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> where the function <italic>h</italic> maps state to observations and the observational variance <inline-formula id="pcbi.1005257.e043"><alternatives><graphic id="pcbi.1005257.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>b</mml:mi> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> is assumed to be:
<disp-formula id="pcbi.1005257.e044"><alternatives><graphic id="pcbi.1005257.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e044" xlink:type="simple"/><mml:math display="block" id="M44"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>b</mml:mi> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>10000</mml:mn> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>50</mml:mn></mml:mfrac> <mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>3</mml:mn></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>3</mml:mn></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:msub><mml:mi>y</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mfenced> <mml:mn>2</mml:mn></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
This observational variance is identical to the one used in [<xref ref-type="bibr" rid="pcbi.1005257.ref027">27</xref>]. Our sensitivity analysis reveals that the choice of observational variance, <xref ref-type="disp-formula" rid="pcbi.1005257.e044">Eq (13)</xref>, does not have a significant effect on the comparative performance of PF compared to the methods studied here (see <xref ref-type="sec" rid="sec017">Discussion</xref>).</p>
<p>Since this approach calculates belief states and posterior distribution for <italic>θ</italic>, the prediction is performed in an identical fashion as for the MSS approach as described in <xref ref-type="disp-formula" rid="pcbi.1005257.e032">Eq (9)</xref>. The pseudo code and the full implementation of this approach for an epidemic model is described in the SI (<xref ref-type="supplementary-material" rid="pcbi.1005257.s001">S1 Text</xref> subsection 6 “Pseudo code for the PF” and <xref ref-type="supplementary-material" rid="pcbi.1005257.s001">S1 Text</xref> subsection 10 “Detailed pseudo code for PF”).</p>
</sec>
<sec id="sec012">
<title>Benchmark method C: Ensemble Kalman Filter (EnKF)</title>
<p>We selected the ensemble Kalman Filter (EnKF) [<xref ref-type="bibr" rid="pcbi.1005257.ref027">27</xref>] for the third benchmark method. EnKF does not use a likelihood function <italic>L</italic>(<italic>Y</italic><sub><italic>i</italic></sub>; <italic>θ</italic>) and instead it propagates an initial ensemble that contains both epidemic states and epidemic parameters. Each new observation is then used to update this ensemble. After such updating, the ensemble is considered as a sample from the posterior distribution for both the parameters and the states.</p>
<p>Similar to PF and MSS, this approach calculates belief states and posterior distribution for <italic>θ</italic>, and hence predictions can be performed using <xref ref-type="disp-formula" rid="pcbi.1005257.e032">Eq (9)</xref>. The pseudo code and the full implementation of this approach for an epidemic model is described in the SI (<xref ref-type="supplementary-material" rid="pcbi.1005257.s001">S1 Text</xref> subsection 7 “Pseudo code for the EnKF” and <xref ref-type="supplementary-material" rid="pcbi.1005257.s001">S1 Text</xref> subsection 11 “Detailed pseudo code for the EnKF”).</p>
</sec>
</sec>
<sec id="sec013">
<title>Design of the performance analysis</title>
<p>To compare the performance of our approach with that of the three competing benchmark methods (described above), we use several different simulated scenarios after the introduction of a novel viral pathogen epidemic. We develop a simple stochastic compartmental model where population members are grouped into four mutually exclusive compartments (see <xref ref-type="fig" rid="pcbi.1005257.g003">Fig 3</xref>). In this model, Infective individuals may infect Susceptibles with whom they come into contact. We assume that Infective individuals will eventually seek treatment due to worsening symptoms (and move to the Treatment compartment). Here, cases under treatment do not transmit infection and those who recover from the disease have full immunity against reinfection with the pathogen (and moved to the Recovered compartment).</p>
<fig id="pcbi.1005257.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005257.g003</object-id>
<label>Fig 3</label>
<caption>
<title>A model for the outbreak of a novel viral pathogen.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.g003" xlink:type="simple"/>
</fig>
<p>Let <italic>x</italic><sub><italic>S</italic></sub>(<italic>t</italic>), <italic>x</italic><sub><italic>I</italic></sub>(<italic>t</italic>), <italic>x</italic><sub><italic>T</italic></sub>(<italic>t</italic>) and <italic>x</italic><sub><italic>R</italic></sub>(<italic>t</italic>), respectively, denote the number of individuals in compartments Susceptible, Infective, Treatment, and Recovered, and <italic>N</italic>(<italic>t</italic>) = <italic>x</italic><sub><italic>S</italic></sub>(<italic>t</italic>) + <italic>x</italic><sub><italic>I</italic></sub>(<italic>t</italic>) + <italic>x</italic><sub><italic>T</italic></sub>(<italic>t</italic>) + <italic>x</italic><sub><italic>R</italic></sub>(<italic>t</italic>) denote the population size at time <italic>t</italic>. Disease transmission can be modeled using the following ODE model:
<disp-formula id="pcbi.1005257.e045"><alternatives><graphic id="pcbi.1005257.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e045" xlink:type="simple"/><mml:math display="block" id="M45"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:msub><mml:mi>x</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi>I</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:msub><mml:mi>x</mml:mi> <mml:mi>I</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi>I</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>-</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>I</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:msub><mml:mi>x</mml:mi> <mml:mi>T</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>I</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:msub><mml:mi>x</mml:mi> <mml:mi>R</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>T</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
where <italic>θ</italic><sub>1</sub> is the disease transmission rate, <italic>θ</italic><sub>2</sub> is the rate of seeking treatment while infectious, and <italic>θ</italic><sub>3</sub> is the rate of recovering. This model can be presented in the format of the ODE system <xref ref-type="disp-formula" rid="pcbi.1005257.e018">(5)</xref> by choosing
<disp-formula id="pcbi.1005257.e046"><alternatives><graphic id="pcbi.1005257.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e046" xlink:type="simple"/><mml:math display="block" id="M46"><mml:mrow><mml:mo>Λ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>;</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mstyle displaystyle="false" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi>I</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>I</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>T</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:mspace width="4.pt"/><mml:mtext>and</mml:mtext> <mml:mspace width="4.pt"/><mml:mo>Γ</mml:mo> <mml:mo>=</mml:mo> <mml:mfenced close="]" open="[" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(15)</label></disp-formula>
In our analysis, we assume that at time <italic>t</italic> = 0 one population member becomes infected. The model initial condition can therefore be defined as <italic>x</italic><sub>0</sub> = (<italic>x</italic><sub><italic>S</italic></sub>(0), <italic>x</italic><sub><italic>I</italic></sub>(0), <italic>x</italic><sub><italic>T</italic></sub>(0), <italic>x</italic><sub><italic>R</italic></sub>(0)) = (<italic>N</italic> − 1, 1, 0, 0).</p>
<p>To evaluate the performance of the calibration methods considered here, we used nine epidemic scenarios that differ by population size <italic>N</italic> ∈ {1000, 10,000, 10,0000} and the epidemic attack rate (moderate: [30% − 50%], severe: [50% − 70%] and extreme [70% − 100%]). To produce epidemic trajectories for each scenario, we first drew <italic>R</italic><sub>0</sub> from <italic>U</italic>([1, 3]) and mean duration of infectiousness from <italic>U</italic>([1, 20]), and then used the Gillespie algorithm [<xref ref-type="bibr" rid="pcbi.1005257.ref040">40</xref>] (see <xref ref-type="supplementary-material" rid="pcbi.1005257.s001">S1 Text</xref> subsection 1 “The Gillespie Algorithm” implemented in the software COPASI [<xref ref-type="bibr" rid="pcbi.1005257.ref042">42</xref>]) to simulate the SITR model of <xref ref-type="fig" rid="pcbi.1005257.g003">Fig 3</xref> with <inline-formula id="pcbi.1005257.e047"><alternatives><graphic id="pcbi.1005257.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>R</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mtext>mean</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>duration</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>of</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>infectiousness</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005257.e048"><alternatives><graphic id="pcbi.1005257.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mtext>mean</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>duration</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>of</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>infectiousness</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1005257.e045">Eq 14</xref>). We assumed that the delay until recovery after the onset of treatment is 4 days and that this is a known quantity (that is, <italic>θ</italic><sub>3</sub> = 0.25). To ensure that our selected simulated trajectories reflect expected shapes of outbreaks (rather than slow, simmering transmission), we only included trajectories with an epidemic peak that occurs between weeks 10 and 20 after take-off. <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4A</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005257.s002">S1</xref> to <xref ref-type="supplementary-material" rid="pcbi.1005257.s009">S8</xref> Figs show the 50 simulated trajectories chosen for each scenario. In our evaluation, we assumed that the weekly number of disease-associated diagnoses was observed throughout the outbreak; this was calculated for each week as the number of people that transitioned from <italic>I</italic> to <italic>T</italic>. For our model, the number of diagnoses in week <italic>i</italic> is calculated as <italic>x</italic><sub><italic>T</italic></sub>(<italic>t</italic><sub><italic>i</italic></sub>)+<italic>x</italic><sub><italic>R</italic></sub>(<italic>t</italic><sub><italic>i</italic></sub>) − <italic>x</italic><sub><italic>T</italic></sub>(<italic>t</italic><sub><italic>i</italic>−1</sub>) − <italic>x</italic><sub><italic>R</italic></sub>(<italic>t</italic><sub><italic>i</italic>−1</sub>), where <italic>t</italic><sub><italic>i</italic></sub> − <italic>t</italic><sub><italic>i</italic>−1</sub> = 7 days to obtain weekly data.</p>
<fig id="pcbi.1005257.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005257.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Median integrated relative errors (mIRE) in estimating model parameters and infection prevalence as well as prediction for simulated epidemics in a population of 10 000 with 50% − 70% attack rate.</title>
<p>A) Epidemic scenarios used to evaluate the performance of calibration methods. Each scenario consists of 50 stochastic trajectories obtained by simulating the model in <xref ref-type="fig" rid="pcbi.1005257.g003">Fig 3</xref> using the Gillespie algorithm. B) results for estimating <italic>R</italic><sub>0</sub>, C) results for estimating <italic>R</italic><sub>eff</sub>, D) results for estimating the mean duration of infectiousness, E) results for estimating the infection prevalence, F) results for predicting the next week diagnoses, G) results for predicting the diagnoses 3 weeks from now, H) results for predicting the diagnoses over the next 3 weeks, I) results for predicting the attack rate. In each panel: MSS: Multiple Shooting for Stochastic systems (the method proposed here); I.Poi: Independent Poisson (Benchmark Method A); PF: Particle Filter (Benchmark Method B); EnKF: Ensemble Kalman Filter (Benchmark Method C). P-values are from Wilcoxon Signed-Rank test evaluating the hypothesis that the median of relative errors for the MSS approach is smaller than that of I.Poi (first row), PF (second row), and EnKF (third row); p-values smaller than 0.001 are displayed as ***, p-values in between 0.001 and 0.01 as ** and between 0.01 and 0.05 as *. The values of mIRE for some scenarios fall above the vertical axis range and are not displayed.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.g004" xlink:type="simple"/>
</fig>
<p>We implemented each of the calibration methods in Mathematica [<xref ref-type="bibr" rid="pcbi.1005257.ref043">43</xref>] and evaluated their performance based on their ability to accurately (1) estimate <italic>R</italic><sub>0</sub>, effective <italic>R</italic> (<italic>R</italic><sub>eff</sub>), the duration of infectiousness, and the current number of infectious individuals, and (2) predict the incident number of diagnoses (for the subsequent week and 3 weeks in the future) and the total cumulative cases (over the subsequent 3 weeks and over the whole epidemic). We note that in our analysis, we calibrate <italic>R</italic><sub>0</sub> and mean duration of infectiousness, and <italic>θ</italic><sub>1</sub> and <italic>θ</italic><sub>2</sub> are calculated based on the samples of <italic>R</italic><sub>0</sub> and mean duration of infectiousness for likelihood evaluations.</p>
<p>For each simulated trajectory shown in <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4A</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005257.s002">S1A</xref> to <xref ref-type="supplementary-material" rid="pcbi.1005257.s002">S8A</xref> Figs, we evaluated the performance of our method at several different times during the epidemic: 8 weeks to peak incidence, 4 weeks to peak, at peak, 4 weeks after the peak, and 8 weeks after the peak. To quantify the performance of these methods based on each target metric <italic>M</italic><sub><italic>i</italic></sub> (e.g. estimating <italic>R</italic><sub>0</sub> or prediction of the number of incident cases in the subsequent period after observing <italic>Y</italic><sub><italic>i</italic></sub>), we used the integrated relative error (IRE):
<disp-formula id="pcbi.1005257.e049"><alternatives><graphic id="pcbi.1005257.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e049" xlink:type="simple"/><mml:math display="block" id="M49"><mml:mrow><mml:mi>I</mml:mi> <mml:mi>R</mml:mi> <mml:mi>E</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>M</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mfenced> <mml:mspace width="4pt"/><mml:mo>=</mml:mo> <mml:mspace width="4pt"/><mml:mn>100</mml:mn> <mml:msub><mml:mo>∫</mml:mo> <mml:mover accent="true"><mml:mo>Θ</mml:mo> <mml:mo>¯</mml:mo></mml:mover></mml:msub> <mml:msub><mml:mo>∫</mml:mo> <mml:msub><mml:mo>Ψ</mml:mo> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>M</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>m</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>M</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:mfrac> <mml:mspace width="4pt"/><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:msub><mml:mi>M</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>θ</mml:mi></mml:mrow></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>π</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4pt"/><mml:mi>d</mml:mi> <mml:mi>m</mml:mi> <mml:mspace width="4pt"/><mml:mi>d</mml:mi> <mml:mi>θ</mml:mi></mml:mrow></mml:math></alternatives> <label>(16)</label></disp-formula>
where <italic>f</italic><sub><italic>M</italic><sub><italic>i</italic></sub>|<italic>θ</italic></sub>(<italic>m</italic>|<italic>θ</italic>) is the probability density function of target <italic>M</italic><sub><italic>i</italic></sub> given the estimated parameter values <italic>θ</italic>, <inline-formula id="pcbi.1005257.e050"><alternatives><graphic id="pcbi.1005257.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mover accent="true"><mml:msub><mml:mi>M</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the true value of target <italic>M</italic><sub><italic>i</italic></sub>. Ψ<sub><italic>i</italic></sub> is the set of possible values that the target <italic>M</italic><sub><italic>i</italic></sub> can take (i.e. the support of the probability density function <italic>f</italic>), and <inline-formula id="pcbi.1005257.e051"><alternatives><graphic id="pcbi.1005257.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005257.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mover accent="true"><mml:mo>Θ</mml:mo> <mml:mo>¯</mml:mo></mml:mover></mml:math></alternatives></inline-formula> represents the set of all parameter values (see SI for further details). We chose IRE as the performance metric since it provides a precise measure for how well the mass of the posterior distribution covers the true value of the targets to estimate. Alternative performance metrics such as relative error or mean square error do not account for the variance of predictions and hence are not suitable for this purpose.</p>
<p>When fitting the model in <xref ref-type="fig" rid="pcbi.1005257.g003">Fig 3</xref> to the simulated trajectories, we did not assume that the length of the period between the onset of the outbreak and the first observation is known. We therefore considered this delay as an additional model parameter that must be estimated through the calibration procedures in MSS.</p>
</sec>
</sec>
<sec id="sec014" sec-type="results">
<title>Results</title>
<sec id="sec015">
<title>Performance evaluation: Parameter estimation</title>
<p>
<xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4B–4E</xref> displays the median of IRE (defined in <xref ref-type="disp-formula" rid="pcbi.1005257.e049">Eq (16)</xref>) in estimating <italic>R</italic><sub>0</sub>, effective <italic>R</italic>, duration of infectiousness, and infection prevalence from applying calibration methods described above on 50 simulated trajectories shown in <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4A</xref> for a severe scenario with attack rate between 50% and 70% for a population of 10000. See <xref ref-type="supplementary-material" rid="pcbi.1005257.s002">S1</xref> to <xref ref-type="supplementary-material" rid="pcbi.1005257.s009">S8</xref> Figs for the performance of these methods under other epidemic and population size scenarios.</p>
<p>In all 9 scenarios (defined by epidemic severity and population size) and 5 estimation times (8 and 4 weeks to peak, at the peak, and 4 and 8 weeks after the peak), the MSS method either outperforms the competing benchmark methods or demonstrates similar performance. In particular, we note that in contrast to other approaches, the MSS method offers continuous improvement in the accuracy of parameter estimation as epidemics progress and more observations become available. At the peak and thereafter, MSS displays dominating performance, which is attributable to the more accurate likelihood approximation offered by this approach (see <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4B–4E</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005257.s002">S1B–S1E</xref> to <xref ref-type="supplementary-material" rid="pcbi.1005257.s002">S8B–S8E</xref> Figs.</p>
<p>Furthermore, the MSS method performs significantly better than the other competing methods in estimating the true (and unobserved) prevalence of infection. This suggests that the state updating procedure utilized by MSS method is more effective than the state updating methods employed by PF and EnKF. It is worth noting that the high IRE for infection prevalence at the beginning and the end of epidemics is the result of the small number of infectious individuals during these phases. While this impacts the performance of all methods (including MSS), the effect is small for MSS as the state updating procedure leads to more reliable state estimates. Also, since the estimation of the effective <italic>R</italic> requires an estimate of the current number of susceptibles, the MSS method again shows a superior behavior.</p>
<p>
<xref ref-type="fig" rid="pcbi.1005257.g005">Fig 5A–5C</xref> shows the results of testing the hypothesis that the MSS method outperforms all benchmark methods at 0.05 significance level at different epidemic times. This figure suggests that, in the majority of cases, the MSS method demonstrates either statistically superior or similar performance to the benchmark methods (represented by Green, Blue and Black colors). We note that even for the small number of situations in which MSS is statistically dominated by another benchmark method, the absolute difference in mIRE (as shown in <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4B–4E</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005257.s002">S1B–S1E</xref> to <xref ref-type="supplementary-material" rid="pcbi.1005257.s002">S8B–S8E</xref> Figs is small.</p>
<fig id="pcbi.1005257.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005257.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Identifying the calibration method with statistically dominant performance at 0.05 significance level for estimating model parameters and infection prevalence.</title>
<p>Red, if MSS is statistically better than all benchmark methods. White, if all methods fail to demonstrate statistically dominant performance. Blue if I.Poi (Benchmark A), Green if Particle Filter (Benchmark B) and Black if the Ensemble Kalman filter (Benchmark C) statistically outperform the MSS method. Multiple colors are displayed if more than one method is significantly better than MSS.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.g005" xlink:type="simple"/>
</fig>
<p>The performance of each method tested does not change markedly between scenarios which differ by host population size (<xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4B–4E</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005257.s002">S1B–S1E</xref> to <xref ref-type="supplementary-material" rid="pcbi.1005257.s002">S8B–S8E</xref> Figs). Even though the trajectories appear less stochastic when larger host populations are considered, because all scenarios assume a small number of infective persons in the early phase, there remains substantial stochasticity during the period of initial take-off which influences the timing of the epidemic peak.</p>
<p>We note that the performance of I.Poi (in terms of estimating <italic>R</italic><sub>0</sub> and <italic>R</italic><sub><italic>eff</italic></sub>) deteriorates as more observations accumulate (<xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4B and 4C</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005257.s002">S1B–S1C</xref> to <xref ref-type="supplementary-material" rid="pcbi.1005257.s002">S8B –S8C</xref> Figs. A potential explanation of this observation is that I.Poi uses the mean of 1000 stochastic simulations which is likely to be close to the deterministic solution. If the observed stochastic trajectory peaks early or late, each additional observation will deviate from the expected behavior (for the true parameter) and, therefore, the precision worsens.</p>
<p>In the analyses presented so far, we assumed that the model structure is correct and that the calibration target (i.e. weekly number of diagnoses) can be accurately measured. To test the robustness of the results to imperfect calibration targets, we allowed for accumulating observations to be disturbed by an error term that follows a Gaussian distribution with mean zero and standard deviation 100. In this sensitivity analysis, the MSS method demonstrated the ability to cope with noisy data and sustain its performance (<xref ref-type="supplementary-material" rid="pcbi.1005257.s010">S9 Fig</xref>). We next considered a scenario for which the epidemic trajectories are provided by an SEITR model (see <xref ref-type="supplementary-material" rid="pcbi.1005257.s001">S1 Text</xref> subsection 2 “Equations of the SEITR model”) but an SITR model is chosen for parameter estimation and prediction. This allowed us to test to what extent model misspecification could erode the performance of these approaches, which is important because the true epidemic process may not be known. This sensitivity analysis revealed that each of the calibration methods considered here maintained their performance under this particular model misspecification scenario with respect to most performance criteria, but had problems with estimates for <italic>R</italic><sub>eff</sub> (<xref ref-type="supplementary-material" rid="pcbi.1005257.s011">S10</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005257.s012">S11</xref> Figs). Each method failed to accurately estimate <italic>R</italic><sub>eff</sub> after the peak, which may be explained by the fact that in extreme epidemic scenarios used in this experiment, only a few number of individuals remain in the Susceptible compartment. Since the misspecified model used for calibration does not include the additional Exposed compartment, the size of Susceptible compartment is overestimated by all calibration methods, which leads to inaccurate <italic>R</italic><sub>eff</sub> estimates after the peak.</p>
</sec>
<sec id="sec016">
<title>Performance evaluation: Prediction</title>
<p>The F–I panels of <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005257.s002">S1</xref> to <xref ref-type="supplementary-material" rid="pcbi.1005257.s009">S8</xref> Figs display the median of integrated relative errors (defined in <xref ref-type="disp-formula" rid="pcbi.1005257.e049">Eq (16)</xref>) in predicting the number of diagnoses during the subsequent week, three weeks from now, accumulated over the next three weeks, and accumulated until the end of the epidemic from applying calibration methods described above on 50 simulated trajectories shown their A panels.</p>
<p>In all 9 scenarios (defined by epidemic severity and population size) and 5 epidemic times (8 and 4 weeks to peak, at the peak, and 4 and 8 weeks after the peak), the MSS method demonstrates superior or similar performance against the competing benchmark methods. As for the estimation targets, benchmark methods show higher integrated relative errors during both early and late phases of epidemics. This behavior occurs due to the small number of infectious individuals (which results in a low number of diagnoses) during these epidemic phases. The state updating procedure employed by the MSS method plays a central role in sustaining the performance of MSS method under these conditions.</p>
<p>
<xref ref-type="fig" rid="pcbi.1005257.g006">Fig 6A–6C</xref> displays the results of testing the hypothesis that the MSS method outperforms all benchmark methods at 0.05 significance level at different epidemic times. This figure suggest that in the majority of cases the MSS method demonstrates statistically superior than or similar performance to the benchmark methods (represented by Green, Blue and Black colors). We note that even for case where MSS is statistically dominated by another benchmark method, the absolute difference in mIRE (as shown in <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005257.s002">S1</xref> to <xref ref-type="supplementary-material" rid="pcbi.1005257.s009">S8</xref> Figs) is not substantial.</p>
<fig id="pcbi.1005257.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005257.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Identifying the calibration method with statistically dominant performance for predictions at 0.05 significance level.</title>
<p>Red, if MSS is statistically better than all benchmark methods. White, if all methods fail to demonstrate statistically dominant performance. Blue if I.Poi (benchmark A), Green if Particle Filter (benchmark B) and Black if the Ensemble Kalman filter (benchmark C) statistically outperform the MSS method. Multiple colors can occur if more than one method is significantly better than MSS.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.g006" xlink:type="simple"/>
</fig>
<p>The prediction ability of all methods is not strongly influenced by a slight model mis-specification as shwon in <xref ref-type="supplementary-material" rid="pcbi.1005257.s011">S10 Fig</xref>, but, importantly, the superiority holds as well despite lack of knowledge of the exact model.</p>
</sec>
</sec>
<sec id="sec017" sec-type="conclusions">
<title>Discussion</title>
<p>Our results suggest that the MSS calibration method can address several major challenges inherent in parameter estimation and model-based prediction during outbreaks, when the true epidemic state can be only partially observed and the behavior of disease spread is most stochastic. Using a comprehensive set of simulation studies, we compare the performance of our method to several existing state-of-the-art calibration methods including a particle filter (PF) [<xref ref-type="bibr" rid="pcbi.1005257.ref027">27</xref>], an ensemble Kalman filter (EnKF) [<xref ref-type="bibr" rid="pcbi.1005257.ref027">27</xref>], and a likelihood approximation with the assumption of independent Poisson observations (I.Poi) [<xref ref-type="bibr" rid="pcbi.1005257.ref023">23</xref>]. For the majority of epidemic scenarios we evaluated, we find that MSS either outperforms or does as well as existing methods in terms of the ability to provide accurate estimates for the basic reproductive number (<italic>R</italic><sub>0</sub>), effective <italic>R</italic>, mean duration of infectiousness, unobserved number of infected individuals, the epidemic final attack rate and the number of cases during future weeks.</p>
<p>The superior performance of MSS can be attributed to the use of LNA to capture the correlations between epidemic compartments throughout the simulated outbreak, and to the state updating procedure employed by MSS. While it would be in principal possible to incorporate an LNA approximation into a PF framework, we used the version of PF that is commonly used [<xref ref-type="bibr" rid="pcbi.1005257.ref027">27</xref>] for the purpose of this comparison study. The main difference between EnKF and MSS is that EnKF does not use an approximation for the likelihood for an observation but rather updates states and parameters based on correlation between compartments and data using multiple parameter vectors. The MSS state updating procedure allows the calculation of these correlations using a single parameter vector. This results in a more accurate description of correlations between compartments as epidemic data are accumulating.</p>
<p>The LNA has been successfully applied to describe intrinsic stochastic fluctuations in various contexts [<xref ref-type="bibr" rid="pcbi.1005257.ref044">44</xref>–<xref ref-type="bibr" rid="pcbi.1005257.ref046">46</xref>] and has a solid theoretical basis [<xref ref-type="bibr" rid="pcbi.1005257.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1005257.ref048">48</xref>]. The LNA provides accurate approximation for large populations or when the fluctuations are small compared to the steady state of the system. As also suggested by the results presented here, LNA can perform well even when the system is not in steady state as long as the intervals over which the LNA projections are made are sufficiently small (here, observations occurred at weekly time steps for epidemics that lasted up to 100 weeks).</p>
<p>A main advantage of the MSS technique is that the LNA needs only to be employed on the relatively short time intervals between recordings and not over the whole course of the epidemics. This is possible by employing the state estimation procedure to initialize the LNA on the succeeding interval. Additionally, the simulation studies presented here and previous work in a Systems Biology context [<xref ref-type="bibr" rid="pcbi.1005257.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1005257.ref036">36</xref>] show that LNA can yield accurate estimates for parameters for stochastic systems. Nevertheless, if required, LNA accuracy can be improved by using higher order terms for correction [<xref ref-type="bibr" rid="pcbi.1005257.ref049">49</xref>]. For additional discussion on the LNA in a calibration setting (LNA on a whole system) see [<xref ref-type="bibr" rid="pcbi.1005257.ref050">50</xref>], for additional theoretical remarks [<xref ref-type="bibr" rid="pcbi.1005257.ref048">48</xref>] or the original work [<xref ref-type="bibr" rid="pcbi.1005257.ref047">47</xref>].</p>
<p>The computationally challenging part of the MSS is the interval-wise evaluation of the LNA which consists of <italic>n</italic><sub><italic>c</italic></sub> + <italic>n</italic><sub><italic>c</italic></sub> (<italic>n</italic><sub><italic>c</italic></sub> + 1)/2 ODEs where <italic>n</italic><sub><italic>c</italic></sub> stands for the number of compartments. PF and EnKF, on the other hand, only require the solution of the ODE system that consists of <italic>n</italic><sub><italic>c</italic></sub> equations. The I.Poi. requires the execution of stochastic simulations for each parameter and is the most cost intensive of all four alternatives tested. MSS can be easily carried out without the use of a computing cluster: calibration and prediction for one time-series at the peak of the epidemic takes roughly 5 minutes on an Intel Xeon CPU E5-2630 v3 with 16GM RAM, see the <xref ref-type="supplementary-material" rid="pcbi.1005257.s001">S1 Text</xref> subsection 4 “Computational Effort” for a comparison of runtimes.</p>
<p>We note that the performance of filtering methods can be impaired by filter degeneracy, a phenomenon where particles or members of an ensemble or filter have a very small likelihood value that varies over orders of magnitude even for the best members/particles. Our implementation of PF and EnKF is consistent with the original implementation by [<xref ref-type="bibr" rid="pcbi.1005257.ref027">27</xref>] and both methods are equipped with suitable mechanisms to handle filter degeneracy. Despite the fact that the MSS approach proposed here does not include such a mechanism to address filter degeneracy, MSS demonstrated very competitive performance in these simulated epidemic scenarios. We believe that speaks to the promise of MSS and potential extensions of this methodology.</p>
<p>The I.Poi method assumes that epidemic observations gathered over time are independent, an assumption that may be violated in many epidemic scenarios. For example, <xref ref-type="supplementary-material" rid="pcbi.1005257.s013">S12 Fig</xref> shows a clear correlation pattern among observations of epidemics trajectories produced by the SITR model of <xref ref-type="fig" rid="pcbi.1005257.g003">Fig 3</xref>. Despite lacking a mechanism to account for correlations between epidemic observations, I.Poi remained competative under several of the epidemic scenarios studied here.</p>
<p>Our numerical analysis suggests that the combination of noisy observations and model mis-specification will erode the performance of all calibration methods considered here <xref ref-type="supplementary-material" rid="pcbi.1005257.s012">S11 Fig</xref>. However, our results indicate that mis-specification of model structure far outweighs the impact of observational noise in these simulations (compare <xref ref-type="supplementary-material" rid="pcbi.1005257.s009">S8</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005257.s010">S9</xref> Figs which show similar results fort he noise-free and noisy scenarios). This finding highlights the importance of selecting a model structure that adequately reflects the complexity of the disease.</p>
<p>The performance of PF and EnKF can be affected by the choice of observational variance (<xref ref-type="disp-formula" rid="pcbi.1005257.e044">Eq 13</xref>). The observation variance we selected for our analyses is adapted from [<xref ref-type="bibr" rid="pcbi.1005257.ref027">27</xref>], which is a heuristic choice but has proved reliable in previous studies [<xref ref-type="bibr" rid="pcbi.1005257.ref026">26</xref>]. We ran a sensitivity analysis on this parameter by dropping the absolute variance term from 10,000 to 1, and observed no major change in the performance of PF and EnKF methods in populations of various size. This suggests that the absolute term in the observational variance is not the determining factor in the relative performance of EnKF, PF and MSS.</p>
<p>We note four main limitations of our study. First, while including the necessary complexity to offer a suitable platform for our analyses, the epidemic model used to evaluate the comparative performance of calibration methods is highly simplified. Investigating the impact of model complexity level on the performance of calibration methods would be of immediate interest for future research. Second, our evaluation are based on “simulated” epidemic trajectories. While only simulated scenarios can allow us to calculate the relative errors in estimating the unknown parameters (e.g. <italic>R</italic><sub>0</sub>, mean duration of infectiousness), further investigation using real-world data is required to comprehensively evaluate the performance of MSS along with other existing calibration methods.</p>
<p>Third, in our analyses, we used an SITR model of influenza epidemics that allows for a delay between the time of infection and time of diagnosis. Our model, however, does not account for the fact that in reality only a portion of influenza cases will be reported as not all infected individuals will have severe enough symptoms to seek care. If the fraction of cases that remains undetected is known and fixed, this is easily handled in the model with the addition of compartments and parameters to reflect the observation process, However, the degree of underreporting is often unknown and may change over the course of an epidemic. Such underreporting impacts the performance of all available calibration methods, and the development of novel approaches that can better account for this phenomenon is an important direction for future research.</p>
<p>And finally, our simulation study assumed that epidemic parameters, such as contact rate, remain constant through the outbreak. In reality, however, some epidemic parameters may vary over time due to changes in population behavior and interactions. We also note that for simplicity, our analysis used only one type of real-time observations (i.e. weekly diagnoses), but the methods presented here can be extended for scenarios where multiple sources of real-time data (e.g. disease-related hospitalizations and deaths) are available.</p>
<p>In summary, precise and timely estimation of key epidemic parameters (e.g. expected number of secondary cases, or mean duration of infectiousness) remains a critical component of accurate model-based prediction and effective response to infectious disease outbreaks. The increase in accuracy offered by the MSS method could enable public health officials to response more effectively to epidemic threats.</p>
</sec>
<sec id="sec018">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005257.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title/>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005257.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.s002" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Median integrated relative errors (mIRE) in estimating model parameters and infection prevalence as well as prediction for simulated epidemics in a population of 1 000 with 30% − 50% attack rate.</title>
<p>Same setting as in <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005257.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.s003" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Median integrated relative errors (mIRE) in estimating model parameters and infection prevalence as well as prediction for simulated epidemics in a population of 10 000 with 30% − 50% attack rate.</title>
<p>Same setting as in <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005257.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.s004" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Median integrated relative errors (mIRE) in estimating model parameters and infection prevalence as well as prediction for simulated epidemics in a population of 100 000 with 30% − 50% attack rate.</title>
<p>Same setting as in <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005257.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.s005" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Median integrated relative errors (mIRE) in estimating model parameters and infection prevalence as well as prediction for simulated epidemics in a population of 1 000 with 50% − 70% attack rate.</title>
<p>Same setting as in <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005257.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.s006" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Median integrated relative errors (mIRE) in estimating model parameters and infection prevalence as well as prediction for simulated epidemics in a population of 100 000 with 50% − 70% attack rate.</title>
<p>Same setting as in <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005257.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.s007" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Median integrated relative errors (mIRE) in estimating model parameters and infection prevalence as well as prediction for simulated epidemics in a population of 1 000 with 70% − 100% attack rate.</title>
<p>Same setting as in <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005257.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.s008" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Median integrated relative errors (mIRE) in estimating model parameters and infection prevalence as well as prediction for simulated epidemics in a population of 10 000 with 70% − 100% attack rate.</title>
<p>Same setting as in <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005257.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.s009" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Median integrated relative errors (mIRE) in estimating model parameters and infection prevalence as well as prediction for simulated epidemics in a population of 100 000 with 70% − 100% attack rate.</title>
<p>Same setting as in <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005257.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.s010" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Median integrated relative errors (mIRE) in estimating model parameters and infection prevalence as well as prediction for simulated epidemics in a population of 100 000 with 70% − 100% attack rate and additive observation noise.</title>
<p>Same setting as in <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005257.s011" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.s011" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Median integrated relative errors (mIRE) in estimating model parameters and infection prevalence as well as prediction for simulated epidemics in a population of 100 000 with 70% − 100% attack rate with a mis-specified model.</title>
<p>Same setting as in <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005257.s012" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.s012" xlink:type="simple">
<label>S11 Fig</label>
<caption>
<title>Median integrated relative errors (mIRE) in estimating model parameters and infection prevalence as well as prediction for simulated epidemics in a population of 100 000 with 70% − 100% attack rate with a mis-specified model and additive observation noise.</title>
<p>Same setting as in <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005257.s013" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.s013" xlink:type="simple">
<label>S12 Fig</label>
<caption>
<title>Correlation structure of the SITR model: Inter-temporal correlation for new cases in SITR model, calculated from the 50 stochastic simulations shown in <xref ref-type="fig" rid="pcbi.1005257.g004">Fig 4A</xref>.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005257.s014" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005257.s014.tar" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>Mathematica Code of the method and all simulation studies.</title>
<p>(TAR.GZ)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005257.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lipsitch</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Finelli</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Heffernan</surname> <given-names>RT</given-names></name>, <name name-style="western"><surname>Leung</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Redd</surname></name>; <collab>for the 2009 H1N1 Surveillance Group SC</collab>. <article-title>Improving the evidence base for decision making during a pandemic: The example of 2009 influenza A/H1 N1</article-title>. <source>Biosecurity and bioterrorism: biodefense strategy, practice, and science</source>. <year>2011</year>;<volume>9</volume>(<issue>2</issue>):<fpage>89</fpage>–<lpage>115</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005257.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mills</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Robins</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Lipsitch</surname> <given-names>M</given-names></name>. <article-title>Transmissibility of 1918 pandemic influenza</article-title>. <source>Nature</source>. <year>2004</year>;<volume>432</volume>(<issue>7019</issue>):<fpage>904</fpage>–<lpage>906</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature03063" xlink:type="simple">10.1038/nature03063</ext-link></comment> <object-id pub-id-type="pmid">15602562</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cauchemez</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Donnelly</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Reed</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ghani</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kent</surname> <given-names>CK</given-names></name>, <etal>et al</etal>. <article-title>Household transmission of 2009 pandemic influenza A (H1N1) virus in the United States</article-title>. <source>New England Journal of Medicine</source>. <year>2009</year>;<volume>361</volume>(<issue>27</issue>):<fpage>2619</fpage>–<lpage>2627</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1056/NEJMoa0905498" xlink:type="simple">10.1056/NEJMoa0905498</ext-link></comment> <object-id pub-id-type="pmid">20042753</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cowling</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Lau</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Ho</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Chuang</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Tsang</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>SH</given-names></name>, <etal>et al</etal>. <article-title>The effective reproduction number of pandemic influenza: prospective estimation</article-title>. <source>Epidemiology</source>. <year>2010</year>;<volume>21</volume>(<issue>6</issue>):<fpage>842</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1097/EDE.0b013e3181f20977" xlink:type="simple">10.1097/EDE.0b013e3181f20977</ext-link></comment> <object-id pub-id-type="pmid">20805752</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cori</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ferguson</surname> <given-names>NM</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Cauchemez</surname> <given-names>S</given-names></name>. <article-title>A new framework and software to estimate time-varying reproduction numbers during epidemics</article-title>. <source>American journal of epidemiology</source>. <year>2013</year>;<volume>178</volume>(<issue>9</issue>):<fpage>1505</fpage>–<lpage>1512</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/aje/kwt133" xlink:type="simple">10.1093/aje/kwt133</ext-link></comment> <object-id pub-id-type="pmid">24043437</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cauchemez</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Epperson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Biggerstaff</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Swerdlow</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Finelli</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ferguson</surname> <given-names>NM</given-names></name>. <article-title>Using routine surveillance data to estimate the epidemic potential of emerging zoonoses: application to the emergence of US swine origin influenza A H3N2v virus</article-title>. <source>PLoS Med</source>. <year>2013</year>;<volume>10</volume>(<issue>3</issue>):<fpage>e1001399</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pmed.1001399" xlink:type="simple">10.1371/journal.pmed.1001399</ext-link></comment> <object-id pub-id-type="pmid">23472057</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cauchemez</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Carrat</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Viboud</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Valleron</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Boelle</surname> <given-names>P</given-names></name>. <article-title>A Bayesian MCMC approach to study transmission of influenza: application to household longitudinal data</article-title>. <source>Statistics in medicine</source>. <year>2004</year>;<volume>23</volume>(<issue>22</issue>):<fpage>3469</fpage>–<lpage>3487</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/sim.1912" xlink:type="simple">10.1002/sim.1912</ext-link></comment> <object-id pub-id-type="pmid">15505892</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Höhle</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Jørgensen</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>O’Neill</surname> <given-names>PD</given-names></name>. <article-title>Inference in disease transmission experiments by using stochastic epidemic models</article-title>. <source>Journal of the Royal Statistical Society: Series C (Applied Statistics)</source>. <year>2005</year>;<volume>54</volume>(<issue>2</issue>):<fpage>349</fpage>–<lpage>366</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1467-9876.2005.00488.x" xlink:type="simple">10.1111/j.1467-9876.2005.00488.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>White</surname> <given-names>LF</given-names></name>, <name name-style="western"><surname>Pagano</surname> <given-names>M</given-names></name>. <article-title>A likelihood-based method for real-time estimation of the serial interval and reproductive number of an epidemic</article-title>. <source>Stat Med</source>. <year>2008</year> <month>Jul</month>;<volume>27</volume>(<issue>16</issue>):<fpage>2999</fpage>–<lpage>3016</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/sim.3136" xlink:type="simple">10.1002/sim.3136</ext-link></comment> <object-id pub-id-type="pmid">18058829</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Neill</surname> <given-names>PD</given-names></name>. <article-title>A tutorial introduction to Bayesian inference for stochastic epidemic models using Markov chain Monte Carlo methods</article-title>. <source>Mathematical biosciences</source>. <year>2002</year>;<volume>180</volume>(<issue>1</issue>):<fpage>103</fpage>–<lpage>114</lpage>. <object-id pub-id-type="pmid">12387918</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Obadia</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Haneef</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Boelle</surname> <given-names>PY</given-names></name>. <article-title>The R0 package: a toolbox to estimate reproduction numbers for epidemic outbreaks</article-title>. <source>BMC Med Inform Decis Mak</source>. <year>2012</year>;<volume>12</volume>:<fpage>147</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1472-6947-12-147" xlink:type="simple">10.1186/1472-6947-12-147</ext-link></comment> <object-id pub-id-type="pmid">23249562</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cauchemez</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Boelle</surname> <given-names>PY</given-names></name>, <name name-style="western"><surname>Donnelly</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Ferguson</surname> <given-names>NM</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Leung</surname> <given-names>GM</given-names></name>, <etal>et al</etal>. <article-title>Real-time estimates in early detection of SARS</article-title>. <source>Emerging Infect Dis</source>. <year>2006</year> <month>Jan</month>;<volume>12</volume>(<issue>1</issue>):<fpage>110</fpage>–<lpage>113</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3201/eid1201.050593" xlink:type="simple">10.3201/eid1201.050593</ext-link></comment> <object-id pub-id-type="pmid">16494726</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cauchemez</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Boëlle</surname> <given-names>PY</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Valleron</surname> <given-names>AJ</given-names></name>. <article-title>Estimating in real time the efficacy of measures to control emerging communicable diseases</article-title>. <source>American Journal of Epidemiology</source>. <year>2006</year>;<volume>164</volume>(<issue>6</issue>):<fpage>591</fpage>–<lpage>597</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/aje/kwj274" xlink:type="simple">10.1093/aje/kwj274</ext-link></comment> <object-id pub-id-type="pmid">16887892</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wallinga</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Teunis</surname> <given-names>P</given-names></name>. <article-title>Different epidemic curves for severe acute respiratory syndrome reveal similar impacts of control measures</article-title>. <source>American Journal of Epidemiology</source>. <year>2004</year>;<volume>160</volume>(<issue>6</issue>):<fpage>509</fpage>–<lpage>516</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/aje/kwh255" xlink:type="simple">10.1093/aje/kwh255</ext-link></comment> <object-id pub-id-type="pmid">15353409</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Davoudi</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Meza</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Meyers</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Earn</surname> <given-names>DJD</given-names></name>, <name name-style="western"><surname>Pourbohloul</surname> <given-names>B</given-names></name>. <article-title>Early real-time estimation of the basic reproduction number of emerging infectious diseases</article-title>. <source>Physical Review X</source>. <year>2012</year>;<volume>2</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevX.2.031005" xlink:type="simple">10.1103/PhysRevX.2.031005</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cauchemez</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ferguson</surname> <given-names>NM</given-names></name>. <article-title>Methods to infer transmission risk factors in complex outbreak data</article-title>. <source>J R Soc Interface</source>. <year>2012</year> <month>Mar</month>;<volume>9</volume>(<issue>68</issue>):<fpage>456</fpage>–<lpage>469</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2011.0379" xlink:type="simple">10.1098/rsif.2011.0379</ext-link></comment> <object-id pub-id-type="pmid">21831890</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Saramaki</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kaski</surname> <given-names>K</given-names></name>. <article-title>Modelling development of epidemics with dynamic small-world networks</article-title>. <source>J Theor Biol</source>. <year>2005</year> <month>Jun</month>;<volume>234</volume>(<issue>3</issue>):<fpage>413</fpage>–<lpage>421</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2004.12.003" xlink:type="simple">10.1016/j.jtbi.2004.12.003</ext-link></comment> <object-id pub-id-type="pmid">15784275</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref018">
<label>18</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Anderson</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>May</surname> <given-names>RM</given-names></name>. <source>Infectious Diseases of Humans: Dynamics and Control</source>. <publisher-name>Oxford University Press</publisher-name>; <year>1992</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005257.ref019">
<label>19</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Daley</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Gani</surname> <given-names>JM</given-names></name>. <source>Epidemic Modelling: An Introduction</source>. <publisher-loc>Cambridge; New York</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>; <year>1999</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005257.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Alkema</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Raftery</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>SJ</given-names></name>. <article-title>Probabilistic projections of HIV prevalence using Bayesian melding</article-title>. <source>The Annals of Applied Statistics</source>. <year>2007</year>;p. <fpage>229</fpage>–<lpage>248</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/07-AOAS111" xlink:type="simple">10.1214/07-AOAS111</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Elderd</surname> <given-names>BD</given-names></name>, <name name-style="western"><surname>Dukic</surname> <given-names>VM</given-names></name>, <name name-style="western"><surname>Dwyer</surname> <given-names>G</given-names></name>. <article-title>Uncertainty in predictions of disease spread and public health responses to bioterrorism and emerging diseases</article-title>. <source>Proceedings of the National Academy of Sciences</source>.<year>2006</year>;<volume>103</volume>(<issue>42</issue>):<fpage>15693</fpage>–<lpage>15697</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0600816103" xlink:type="simple">10.1073/pnas.0600816103</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Birrell</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Ketsetzis</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gay</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Cooper</surname> <given-names>BS</given-names></name>, <name name-style="western"><surname>Presanis</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Harris</surname> <given-names>RJ</given-names></name>, <etal>et al</etal>. <article-title>Bayesian modeling to unmask and predict influenza A/H1N1pdm dynamics in London</article-title>. <source>Proceedings of the National Academy of Sciences</source>.<year>2011</year>;<volume>108</volume>(<issue>45</issue>):<fpage>18238</fpage>–<lpage>18243</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1103002108" xlink:type="simple">10.1073/pnas.1103002108</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Riley</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Donnelly</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Ghani</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Abu-Raddad</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Hedley</surname> <given-names>AJ</given-names></name>, <etal>et al</etal>. <article-title>Transmission dynamics of the etiological agent of SARS in Hong Kong: impact of public health interventions</article-title>. <source>Science</source>. <year>2003</year>;<volume>300</volume>(<issue>5627</issue>):<fpage>1961</fpage>–<lpage>1966</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1086478" xlink:type="simple">10.1126/science.1086478</ext-link></comment> <object-id pub-id-type="pmid">12766206</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Choi</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Rempala</surname> <given-names>GA</given-names></name>. <article-title>Inference for discretely observed stochastic kinetic networks with applications to epidemic modeling</article-title>. <source>Biostatistics</source>. <year>2012</year> <month>Jan</month>;<volume>13</volume>(<issue>1</issue>):<fpage>153</fpage>–<lpage>165</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biostatistics/kxr019" xlink:type="simple">10.1093/biostatistics/kxr019</ext-link></comment> <object-id pub-id-type="pmid">21835814</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ionides</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Breto</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>King</surname> <given-names>AA</given-names></name>. <article-title>Inference for nonlinear dynamical systems</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2006</year> <month>Dec</month>;<volume>103</volume>(<issue>49</issue>):<fpage>18438</fpage>–<lpage>18443</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0603181103" xlink:type="simple">10.1073/pnas.0603181103</ext-link></comment> <object-id pub-id-type="pmid">17121996</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Karspeck</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Tamerius</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lipsitch</surname> <given-names>M</given-names></name>. <article-title>Real-time influenza forecasts during the 2012–2013 season</article-title>. <source>Nat Commun</source>. <year>2013</year>;<volume>4</volume>:<fpage>2837</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ncomms3837" xlink:type="simple">10.1038/ncomms3837</ext-link></comment> <object-id pub-id-type="pmid">24302074</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Karspeck</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>. <article-title>Comparison of Filtering Methods for the Modeling and Retrospective Forecasting of Influenza Epidemics</article-title>. <source>PLOS Computational Biology</source>. <year>2014</year>;<volume>10</volume>:<fpage>e1003583</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003583" xlink:type="simple">10.1371/journal.pcbi.1003583</ext-link></comment> <object-id pub-id-type="pmid">24762780</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Cowling</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Lau</surname> <given-names>EH</given-names></name>, <name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>. <article-title>Forecasting Influenza Epidemics in Hong Kong</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year> <month>Jul</month>;<volume>11</volume>(<issue>7</issue>):<fpage>e1004383</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004383" xlink:type="simple">10.1371/journal.pcbi.1004383</ext-link></comment> <object-id pub-id-type="pmid">26226185</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Karspeck</surname> <given-names>A</given-names></name>. <article-title>Forecasting seasonal outbreaks of influenza</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>2012</year> <month>Dec</month>;<volume>109</volume>(<issue>50</issue>):<fpage>20425</fpage>–<lpage>20430</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1208772109" xlink:type="simple">10.1073/pnas.1208772109</ext-link></comment> <object-id pub-id-type="pmid">23184969</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ong</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Cook</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>HC</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>VJ</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>RT</given-names></name>, <etal>et al</etal>. <article-title>Real-time epidemic monitoring and forecasting of H1N1-2009 using influenza-like illness from general practice and family doctor clinics in Singapore</article-title>. <source>PLoS ONE</source>. <year>2010</year>;<volume>5</volume>(<issue>4</issue>):<fpage>e10036</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0010036" xlink:type="simple">10.1371/journal.pone.0010036</ext-link></comment> <object-id pub-id-type="pmid">20418945</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dukic</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Lopes</surname> <given-names>HF</given-names></name>, <name name-style="western"><surname>Polson</surname> <given-names>NG</given-names></name>. <article-title>Tracking Epidemics With Google Flu Trends Data and a State-Space SEIR Model</article-title>. <source>Journal of the American Statistical Association</source>. <year>2012</year>;<volume>107</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/01621459.2012.713876" xlink:type="simple">10.1080/01621459.2012.713876</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chretien</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>George</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chitale</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>McKenzie</surname> <given-names>FE</given-names></name>. <article-title>Influenza forecasting in human populations: a scoping review</article-title>. <source>PLoS ONE</source>. <year>2014</year>;<volume>9</volume>(<issue>4</issue>):<fpage>e94130</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0094130" xlink:type="simple">10.1371/journal.pone.0094130</ext-link></comment> <object-id pub-id-type="pmid">24714027</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bettencourt</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Ribeiro</surname> <given-names>RM</given-names></name>. <article-title>Real time Bayesian estimation of the epidemic potential of emerging infectious diseases</article-title>. <source>PLoS One</source>. <year>2008</year>;<volume>3</volume>(<issue>5</issue>):<fpage>e2185</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0002185" xlink:type="simple">10.1371/journal.pone.0002185</ext-link></comment> <object-id pub-id-type="pmid">18478118</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Abbey</surname> <given-names>H</given-names></name>. <article-title>An examination of the Reed-Frost theory of epidemics</article-title>. <source>Human biology</source>. <year>1952</year>;<volume>24</volume>(<issue>3</issue>):<fpage>201</fpage>–<lpage>233</lpage>. <object-id pub-id-type="pmid">12990130</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zimmer</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sahle</surname> <given-names>S</given-names></name>. <article-title>Deterministic inference for stochastic systems using multiple shooting and a linear noise approximation for the transition probabilities</article-title>. <source>IET Systems Biology</source>. <year>2015</year>;<volume>9</volume>:<fpage>181</fpage>–<lpage>192</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1049/iet-syb.2014.0020" xlink:type="simple">10.1049/iet-syb.2014.0020</ext-link></comment> <object-id pub-id-type="pmid">26405142</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zimmer</surname> <given-names>C</given-names></name>. <article-title>Reconstructing the hidden states in time course data of stochastic models</article-title>. <source>Mathematical BioSciences</source>. <year>2015</year>;<volume>269</volume>:<fpage>117</fpage>–<lpage>129</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.mbs.2015.08.015" xlink:type="simple">10.1016/j.mbs.2015.08.015</ext-link></comment> <object-id pub-id-type="pmid">26363082</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thomas</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Matuschek</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Grima</surname> <given-names>R</given-names></name>. <article-title>Intrinsic noise analyzer: a software package for the exploration of stochastic biochemical kinetics using the system size expansion</article-title>. <source>PloS one</source>. <year>2012</year>;<volume>7</volume>(<issue>6</issue>):<fpage>e38518</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0038518" xlink:type="simple">10.1371/journal.pone.0038518</ext-link></comment> <object-id pub-id-type="pmid">22723865</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref038">
<label>38</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Van Kampen</surname> <given-names>NG</given-names></name>. <source>Stochastic processes in physics and chemistry</source>. <volume>vol. 1</volume>.<publisher-name>Elsevier</publisher-name>; <year>1992</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005257.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yaesoubi</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>T</given-names></name>. <article-title>Generalized Markov models of infectious disease spread: A novel framework for developing dynamic health policies</article-title>. <source>European Journal of Operational Research</source>. <year>2011</year>;<volume>215</volume>:<fpage>679</fpage>–<lpage>687</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.ejor.2011.07.016" xlink:type="simple">10.1016/j.ejor.2011.07.016</ext-link></comment> <object-id pub-id-type="pmid">21966083</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gillespie</surname> <given-names>DT</given-names></name>. <article-title>A General Method for Numerically Simulating the Stochastic Time Evolution of coupled Chemical Reactions</article-title>. <source>Journal of Computational Physics</source>. <year>1976</year>;<volume>22</volume> (<issue>4</issue>):<fpage>403</fpage>–<lpage>434</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0021-9991(76)90041-3" xlink:type="simple">10.1016/0021-9991(76)90041-3</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref041">
<label>41</label>
<mixed-citation publication-type="other" xlink:type="simple">Influenza prediction challenge. Center for disease control and prevention.2016; <ext-link ext-link-type="uri" xlink:href="http://www.cdc.gov/flu/news/flu-forecast-website-launched.htm" xlink:type="simple">http://www.cdc.gov/flu/news/flu-forecast-website-launched.htm</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005257.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hoops</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sahle</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gauges</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pahle</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Simus</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>COPASI—a COmplex PAthway SImulator</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume> (<issue>24</issue>):<fpage>3067</fpage>–<lpage>3074</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btl485" xlink:type="simple">10.1093/bioinformatics/btl485</ext-link></comment> <object-id pub-id-type="pmid">17032683</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref043">
<label>43</label>
<mixed-citation publication-type="book" xlink:type="simple">
<source>Mathematica</source>, <edition>Version 10.4</edition>. <publisher-name>Wolfram Research, Inc</publisher-name>. <year>2015</year>;<publisher-loc>Champaign, IL</publisher-loc>.</mixed-citation>
</ref>
<ref id="pcbi.1005257.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pahle</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Challenger</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Mendes</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>McKane</surname> <given-names>AJ</given-names></name>. <article-title>Biochemical fluctuations, optimisation and the linear noise approximation</article-title>. <source>BMC Systems Biology</source>. <year>2012</year>;<volume>6</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1752-0509-6-86" xlink:type="simple">10.1186/1752-0509-6-86</ext-link></comment> <object-id pub-id-type="pmid">22805626</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Challenger</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>McKane</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Pahle</surname> <given-names>J</given-names></name>. <article-title>Multi-compartment linear noise approximation</article-title>. <source>Journal of Statistical Mechanics: Theory and Experiment</source>. <year>2012</year>;<volume>P11010</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1742-5468/2012/11/P11010" xlink:type="simple">10.1088/1742-5468/2012/11/P11010</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref046">
<label>46</label>
<mixed-citation publication-type="other" xlink:type="simple">Straube R, von Kamp A. LiNA—A Graphical Matlab Tool for Analyzing Intrinsic Noise in Biochemical Reaction Networks. online tutorial. 2013; <ext-link ext-link-type="uri" xlink:href="http://www2.mpi-magdeburg.mpg.de/projects/LiNA/Tutorial_LiNA_v1.pdf" xlink:type="simple">http://www2.mpi-magdeburg.mpg.de/projects/LiNA/Tutorial_LiNA_v1.pdf</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005257.ref047">
<label>47</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>van Kampen</surname> <given-names>NG</given-names></name>. <source>Stochastic processes in physics and chemistry</source>. <publisher-name>Elsevier</publisher-name>; <year>2007</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005257.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Grima</surname> <given-names>R</given-names></name>. <article-title>An effective rate equation approach to reaction kinetics in small volumes: Theory and application to biochemical reactions in nonequilibrium steady-state conditions</article-title>. <source>The Journal of Chemical Physics</source>. <year>2010</year>;<volume>133</volume>:<fpage>035101</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.3454685" xlink:type="simple">10.1063/1.3454685</ext-link></comment> <object-id pub-id-type="pmid">20649359</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thomas</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Matuschek</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Grima</surname> <given-names>R</given-names></name>. <article-title>Intrinsic Noise Analyzer: A Software Package for the Exploration of Stochastic Biochemical Kinetics Using the System Size Expansion</article-title>. <source>Plos ONE</source>. <year>2012</year>;<volume>7</volume>:<fpage>e38518</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0038518" xlink:type="simple">10.1371/journal.pone.0038518</ext-link></comment> <object-id pub-id-type="pmid">22723865</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005257.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Komorowski</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Finkenstädt</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Harper</surname> <given-names>CV</given-names></name>, <name name-style="western"><surname>Rand</surname> <given-names>DA</given-names></name>. <article-title>Bayesian inference of biochemical kinetic parameters using the linear noise approximation</article-title>. <source>BMC Bioinformatics</source>. <year>2009</year>;<volume>10</volume>:<fpage>343</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-10-343" xlink:type="simple">10.1186/1471-2105-10-343</ext-link></comment> <object-id pub-id-type="pmid">19840370</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>