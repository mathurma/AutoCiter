<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-01868</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004165</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Experimentally Verified Parameter Sets for Modelling Heterogeneous Neocortical Pyramidal-Cell Populations</article-title>
<alt-title alt-title-type="running-head">Heterogeneity of Neocortical Pyramidal Cells</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Harrison</surname> <given-names>Paul M.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Badel</surname> <given-names>Laurent</given-names></name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Wall</surname> <given-names>Mark J.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Richardson</surname> <given-names>Magnus J. E.</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>MOAC Doctoral Training Centre, University of Warwick, Coventry, United Kingdom</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>School of Life Sciences, University of Warwick, Coventry, United Kingdom</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Warwick Systems Biology Centre, University of Warwick, Coventry, United Kingdom</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Laboratory for Circuit Mechanisms of Sensory Perception, RIKEN Brain Science Institute, Wako, Saitama, Japan</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Sporns</surname> <given-names>Olaf</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Indiana University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: PMH LB MJW MJER. Performed the experiments: PMH. Analyzed the data: PMH MJER. Wrote the paper: PMH LB MJW MJER.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">magnus.richardson@warwick.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>8</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>20</day>
<month>8</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>8</issue>
<elocation-id>e1004165</elocation-id>
<history>
<date date-type="received">
<day>13</day>
<month>10</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>30</day>
<month>1</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Harrison et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004165" xlink:type="simple"/>
<abstract>
<p>Models of neocortical networks are increasingly including the diversity of excitatory and inhibitory neuronal classes. Significant variability in cellular properties are also seen within a nominal neuronal class and this heterogeneity can be expected to influence the population response and information processing in networks. Recent studies have examined the population and network effects of variability in a particular neuronal parameter with some plausibly chosen distribution. However, the empirical variability and covariance seen across multiple parameters are rarely included, partly due to the lack of data on parameter correlations in forms convenient for model construction. To addess this we quantify the heterogeneity within and between the neocortical pyramidal-cell classes in layers 2/3, 4, and the slender-tufted and thick-tufted pyramidal cells of layer 5 using a combination of intracellular recordings, single-neuron modelling and statistical analyses. From the response to both square-pulse and naturalistic fluctuating stimuli, we examined the class-dependent variance and covariance of electrophysiological parameters and identify the role of the h current in generating parameter correlations. A byproduct of the dynamic <italic>I-V</italic> method we employed is the straightforward extraction of reduced neuron models from experiment. Empirically these models took the refractory exponential integrate-and-fire form and provide an accurate fit to the perisomatic voltage responses of the diverse pyramidal-cell populations when the class-dependent statistics of the model parameters were respected. By quantifying the parameter statistics we obtained an algorithm which generates populations of model neurons, for each of the four pyramidal-cell classes, that adhere to experimentally observed marginal distributions and parameter correlations. As well as providing this tool, which we hope will be of use for exploring the effects of heterogeneity in neocortical networks, we also provide the code for the dynamic <italic>I-V</italic> method and make the full electrophysiological data set available.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Neurons are the fundamental components of the nervous system and a quantitative description of their properties is a prerequisite to understanding the complex structures they comprise, from microcircuits to networks. Mathematical modelling provides an essential tool to this end and there has been intense effort directed at analysing networks constructed from different classes of neurons. However, even neurons from the same class show a broad variability in parameter values and the distributions and correlations between these parameters are likely to significantly affect network properties. To quantify this variability, we used a combination of intracellular recording, single-neuron modelling, and statistical analysis to measure the physiological variability in pyramidal-cell populations of the neocortex. We employ protocols that measure parameters from both square-pulse and naturalistic stimuli, characterising the perisomatic integration properties of these cells and allowing for the straightforward extraction of mathematically tractable reduced neuron models. We provide algorithms to generate populations of these neuron models that respect the parameter variability and co-variability observed in our experiments. These represent novel tools for exploring heterogeneity in neocortical networks that will be useful for subsequent theoretical and numerical studies. Finally, we make our full electrophysiological dataset available for other research groups to extend and improve on our analysis.</p>
</abstract>
<funding-group>
<funding-statement>PMH was funded through an Engineering and Physical Sciences Research Council studentship held at the MOAC Doctoral Training Centre at the University of Warwick under grant EP/F500378/1. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="3"/>
<page-count count="23"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files. Additional data are deposited at DRYAD at DOI: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.d30k7" xlink:type="simple">10.5061/dryad.d30k7</ext-link>.
</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The neocortex is a laminar structure comprising a diversity of neuronal types, of which the principal neurons are pyramidal cells (for a review see reference [<xref ref-type="bibr" rid="pcbi.1004165.ref001">1</xref>]). Understanding how the properties of the distinct neuronal classes interact to support and govern neocortical computational processes is a key challenge in neuroscience. Combined with acquisition of massive data sets, computational modelling and simulation are now central tools in the study of how the components of neural tissue interact across the genetic, cellular and functional levels [<xref ref-type="bibr" rid="pcbi.1004165.ref002">2</xref>–<xref ref-type="bibr" rid="pcbi.1004165.ref005">5</xref>].</p>
<p>In parallel with computer simulations, the mathematical framework required for a more general understanding of how cellular properties such as synaptic filtering [<xref ref-type="bibr" rid="pcbi.1004165.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004165.ref007">7</xref>], synaptic dynamics [<xref ref-type="bibr" rid="pcbi.1004165.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1004165.ref009">9</xref>], voltage-gated or calcium-gated currents [<xref ref-type="bibr" rid="pcbi.1004165.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1004165.ref012">12</xref>] and spike-frequency adaptation [<xref ref-type="bibr" rid="pcbi.1004165.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1004165.ref014">14</xref>] can affect network dynamics has also been extensively developed. Though these methods account for a diversity of biophysical detail, the focus has often been on networks featuring one or a few homogeneous populations comprised of neurons with the same level of expression of a particular biophysical characteristic.</p>
<p>Nominally uniform populations, like those of neocortical pyramidal cells, feature a significant variability in their electrophysiology [<xref ref-type="bibr" rid="pcbi.1004165.ref015">15</xref>–<xref ref-type="bibr" rid="pcbi.1004165.ref020">20</xref>] and there is increasing theoretical interest in the effects of heterogeneity on populations and networks of both excitatory and inhibitory neurons [<xref ref-type="bibr" rid="pcbi.1004165.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1004165.ref027">27</xref>]. The typical responses of heterogeneous networks are not necessarily the same as those of homogeneous networks comprised of typical neurons and studies have shown significant differences in synchronization properties [<xref ref-type="bibr" rid="pcbi.1004165.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1004165.ref029">29</xref>], coding efficiencies [<xref ref-type="bibr" rid="pcbi.1004165.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1004165.ref031">31</xref>] and gain [<xref ref-type="bibr" rid="pcbi.1004165.ref027">27</xref>] in the presence of heterogeneity.</p>
<p>Though there exist many experimental studies on heterogeneity, the data are not always in a form that allows for the construction of neuron models with the correct parameter distributions and correlations. As a result theoretical studies have tended to focus on a particular parameter (e.g. input resistance) and give it some plausible distribution across the neuronal population. However, such heuristics might not always reflect the empirical distributions well for a particular variable and are rarely combined with heterogeneity in other potentially covarying variables. To address the availability of experimental data that are in suitable form for modelling heterogeneities of pyramidal-cell integration, we measured a range of perisomatic electrophysiological properties of somatosensory cortex layer-2/3, layer-4, and slender-tufted and thick-tufted layer-5 pyramidal cells using standard and dynamic <italic>I-V</italic> [<xref ref-type="bibr" rid="pcbi.1004165.ref032">32</xref>] stimulation protocols delivered during whole-cell somatic patch-clamp recording. A useful byproduct of this approach is the direct generation of reduced neuron models that accurately reproduce empirical voltage timecourses and can be employed in the mathematical analysis of networks.</p>
<p>For all classes of pyramidal cell examined the current integration at the soma, as encoded by the dynamic <italic>I-V</italic> curve, was found to take the exponential integrate-and-fire (EIF) form, but with class-dependent parameter statistics. We present a systematic analysis of the measured parameter variance and covariance for the different classes of pyramidal cell studied and investigate the major sources of variability in the dataset using principal component analysis. We then provide algorithms for generating the distinct EIF-model parameter sets that respect the correct marginal distributions and correlation structure of our dataset. Networks comprised of these model neurons may be numerically simulated and are also amenable to theoretical study. Our algorithms therefore represent a novel tool for the analysis of heterogeneous networks with experimentally verified parameter distributions.</p>
<p>As part of the Supporting Information we also provide computer code for the experimental dynamic <italic>I-V</italic> curve method together with example data sets. To facilitate other research groups improving on our modelling approach we also published the full experimental data set at <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.datadryad.org">www.datadryad.org</ext-link> (doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.d30k7" xlink:type="simple">10.5061/dryad.d30k7</ext-link>).</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec003">
<title>Ethics statement</title>
<p>All experiments were performed in accordance with the UK Animals (Scientific Procedures) Act (1986).</p>
</sec>
<sec id="sec004">
<title>Preparation of neocortical slices</title>
<p>Parasagittal slices of somatosensory neocortex (300 <italic>μ</italic>m) were prepared from male Wistar rats, at postnatal day 16–18. Rats were kept on a 12 hour light-dark cycle with slices made 90 minutes after entering the light cycle. In accordance with the UK Animals (Scientific Procedures) Act (1986), rats were killed by cervical dislocation and then decapitated. The brain was rapidly removed, cut down the midline and the two sides of the brain stuck down. The brain was angled at 15° so that planar slices could be obtained with the dendritic structure of the excitatory neurons intact. Slices were cut with a Microm HM 650 V micro-slicer (Carl Zeiss) in cold (2–4°C) high Mg<sup>2+</sup> low Ca<sup>2+</sup> artificial cerebrospinal fluid (aCSF) consisting of 127 mM NaCl, 1.18 mM KH<sub>2</sub>PO<sub>4</sub>, 2.14 mM KCl, 26 mM NaHCO<sub>3</sub>, 8 mM MgCl<sub>2</sub>, 0.5 mM CaCl<sub>2</sub> and 10 mM glucose. Slices were stored at 34°C for 1 hour in standard aCSF (1 mM Mg<sup>2+</sup>and 2 mM CaCl<sub>2</sub>) and then at room temperature for 1–6 hours.</p>
</sec>
<sec id="sec005">
<title>Patch-clamp recordings from excitatory cells</title>
<p>A slice was transferred to the recording chamber and perfused at 2 ml/min with aCSF at 32°C. Slices were visualised using an Olympus BX51W1 microscope with IR-DIC optics and a Hitachi CCD camera (Scientifica, Bedford, UK). Whole-cell recordings were made with patch pipettes (5–8 mΩ) manufactured from thick walled glass (Harvard Apparatus Edenbridge UK) containing 135 mM K-gluconate, 7 mM NaCl, 10 mM HEPES, 0.5 mM EGTA, 2 mM ATP, 0.3 mM GTP, and 10 mM phosphocreatine (290 mOSM, pH 7.2). Voltage recordings were obtained using an Axon Multiclamp 700B amplifier and digitised at 20 kHz with a Digidata 1440A (Molecular Devices, Sunnyvale, CA). Pyramidal neurons were identified based on their location in the layered neocortex, somata size and dendritic extent (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1A</xref>). The liquid-junction potential was not compensated for. During recording, neurons were labelled either with the fluorescent dye Alexa Fluor® 488 hydrazide (12.5 mM, Life Technologies, Paisley, UK) or with biocytin (1 mg/mL, Sigma-Aldrich, Dorset, UK) to allow confirmation of the cell type and to ensure an intact apical dendrite.</p>
<fig id="pcbi.1004165.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004165.g001</object-id>
<label>Fig 1</label>
<caption>
<p>The four cell classes studied were <bold>A</bold> layer-2/3 (red), layer-4 (orange), slender-tufted layer-5 (green) and thick-tufted layer-5 (blue) pyramidal neurons. <bold>B</bold> Representitive intracellular-voltage response to 1 s step currents. <bold>C</bold> Sag ratio <italic>V</italic><sub>sag</sub>/<italic>V</italic><sub>st</sub> (expressed as a percentage). <bold>D-I</bold> Parameters measured from the response to fluctuating-current stimulation using the dynamic <italic>I</italic> − <italic>V</italic> curve protocol. <bold>D</bold> A layer-4 pyramidal cell stimulated by fluctuating current <italic>I</italic><sub>in</sub>(<italic>t</italic>) with the voltage <italic>V</italic>(<italic>t</italic>) recorded. The ionic current <italic>I</italic><sub>ion</sub>(<italic>t</italic>) estimated from the difference between stimulation and capacitance currents. <bold>E</bold> Scatter plot of <italic>I</italic><sub>ion</sub> versus voltage (grey) and dynamic-<italic>I-V</italic> curve <italic>I</italic><sub>dyn</sub> (orange) with data 200 ms following each spike excluded. <bold>F</bold> Steady-state forcing function <italic>F</italic>(<italic>V</italic>) = −<italic>I</italic><sub>dyn</sub>/<italic>C</italic> (black points) with fit (orange) to the exponential integrate-and-fire (EIF) model <xref ref-type="disp-formula" rid="pcbi.1004165.e004">Eq (2)</xref>. The roles of the various parameters are illustrated. <bold>G</bold> Empirical forcing terms (black points) measured in post-spike time slices (spike-triggered voltage traces are shown below) with fits to the EIF model (orange). The steady-state <italic>F</italic>(<italic>V</italic>) from panel F is also plotted (dashed lines) for comparison. <bold>H</bold> Parameter dynamics from the post-spike <italic>F</italic>(<italic>V</italic>) fits for conductance <italic>g</italic> (mono-exponential fit, orange), resting potential <italic>E</italic> (bi-exponential fit due to weak sag,) and spike-onset threshold <italic>V</italic><sub>T</sub> (mono-exponential fit, orange). Errorbars from bootstrap resampling. <bold>I</bold> Mean action-potential shape parameters extracted from isolated spikes.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004165.g001"/>
</fig>
</sec>
<sec id="sec006">
<title>Stimulation protocols</title>
<p>Cells were stimulated with square-pulse currents (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1B-1C</xref>) and naturalistic <italic>in vivo</italic>-like currents (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1D</xref>), during which the typical access resistance was 9–13 MΩ. The form of the naturalistic currents injected consisted of two summed Ornstein-Uhlenbeck processes with time constants <italic>τ</italic><sub>fast</sub> = 3 ms and <italic>τ</italic><sub>slow</sub> = 10 ms representing AMPA and GABA<sub>A</sub> time-courses respectively [<xref ref-type="bibr" rid="pcbi.1004165.ref032">32</xref>]. Two sets of variances, a low (<italic>σ</italic><sub>slow</sub> = 0.18 = <italic>σ</italic><sub>fast</sub>) and a high (<italic>σ</italic><sub>slow</sub> = 0.25, <italic>σ</italic><sub>fast</sub> = 0.36), along with two DC biases (0.5 and 1) were used giving four distinct current traces for each recording. Finally, a multiplicative gain factor (in the range 200 pA–2000 pA) was applied to the whole of each current so that the firing rate was between 5–15 Hz. Due to high-frequency components in the stimuli, standard techniques compensating for electrode filtering were insufficient and therefore the resulting artefacts were removed using post-recording defiltering techniques [<xref ref-type="bibr" rid="pcbi.1004165.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1004165.ref033">33</xref>].</p>
</sec>
<sec id="sec007">
<title>Histology and confocal microscopy</title>
<p>On removal from the bath the slice was immediately transferred to a 4% paraformaldehyde solution (PBS, pH 7.3) and incubated overnight at ∼ 4°C. Images of fluorescently labelled neurons were obtained using a Leica SP5 confocal microscope. Standard processing was used for biocytin labelled neurons and cells were visualised with the DAB reaction mixture. The reaction was quenched when the dendritic structure of the cells became visible under visual inspection using tris buffer solution (TBS, pH 7.3).</p>
</sec>
<sec id="sec008">
<title><italic>I</italic><sub>h</sub>-channel blocking experiments</title>
<p>To investigate the effect of <italic>I</italic><sub>h</sub> channels we made recordings from eight cells (four from Wistar rats, four from Sprague-Dawley; the data were indistinguishable and were pooled). We applied the same combination of square-pulse and naturalistic stimuli as outlined above in control and then after applying ZD7288 to block <italic>I</italic><sub>h</sub> channels (25 <italic>μ</italic>M; [<xref ref-type="bibr" rid="pcbi.1004165.ref034">34</xref>]). The effects of ZD7288 reached steady state after ∼ 10 min.</p>
</sec>
<sec id="sec009">
<title>Model extraction from experiment</title>
<p>The experimental dynamic <italic>I-V</italic> method (for a full description see reference [<xref ref-type="bibr" rid="pcbi.1004165.ref032">32</xref>]) generates neuron models of the non-linear integrate-and-fire kind with voltage <italic>V</italic> dynamics obeying
<disp-formula id="pcbi.1004165.e001"><alternatives><graphic id="pcbi.1004165.e001g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004165.e001"/><mml:math id="M1" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mi>V</mml:mi></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>V</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mtext>in</mml:mtext></mml:msub> <mml:mo>/</mml:mo> <mml:mi>C</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>F</italic>(<italic>V</italic>) is the forcing term proportional to minus the voltage-averaged <italic>I-V</italic> curve (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1E</xref>) divided by the cellular capacitance <italic>C</italic> and <italic>I</italic><sub>in</sub> is the injected fluctuating current. The method assumes that the voltage dynamics are of the form <inline-formula id="pcbi.1004165.e002"><alternatives><graphic id="pcbi.1004165.e002g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004165.e002"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi> <mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>.</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mtext mathvariant="normal">ion</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mtext mathvariant="normal">in</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> so that the ionic current as a function of time can be found by subtracting the derivative of the measured voltage from the known injected current <inline-formula id="pcbi.1004165.e003"><alternatives><graphic id="pcbi.1004165.e003g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004165.e003"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>I</mml:mi> <mml:mtext mathvariant="normal">ion</mml:mtext></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mtext mathvariant="normal">in</mml:mtext></mml:msub> <mml:mo>−</mml:mo> <mml:mi>C</mml:mi> <mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>.</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> where the capacitance itself is extracted by a variance minimisation technique [<xref ref-type="bibr" rid="pcbi.1004165.ref032">32</xref>]. The average value of <italic>I</italic><sub>ion</sub> when the neuron is at a particular voltage <italic>V</italic>(<italic>t</italic>) defines the dynamic <italic>I-V</italic> curve <italic>I</italic><sub>dyn</sub>(<italic>V</italic>). This is itself related to the forcing term via <italic>F</italic>(<italic>V</italic>) = −<italic>I</italic><sub>dyn</sub>(<italic>V</italic>)/<italic>C</italic> (see <xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1</xref>). Empirically we found that <italic>F</italic>(<italic>V</italic>) was accurately fit by the exponential integrate-and-fire [<xref ref-type="bibr" rid="pcbi.1004165.ref035">35</xref>] form
<disp-formula id="pcbi.1004165.e004"><alternatives><graphic id="pcbi.1004165.e004g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004165.e004"/><mml:math id="M4" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>V</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>τ</mml:mi></mml:mfrac> <mml:mo>(</mml:mo> <mml:mi>E</mml:mi> <mml:mo>-</mml:mo> <mml:mi>V</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mo>Δ</mml:mo> <mml:mi mathvariant="normal">T</mml:mi></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>V</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi mathvariant="normal">T</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mo>Δ</mml:mo> <mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
for all classes of pyramidal cell, where <italic>τ</italic> = <italic>C</italic>/<italic>g</italic> is the membrane time constant and <italic>g</italic> is the input conductance of the cell. The other parameters are the resting potential <italic>E</italic>, the spike sharpness Δ<sub>T</sub> and the spike-onset threshold <italic>V</italic><sub>T</sub>. Certain parameters were seen to have transient modifications to their values following an action potential. These transients were well-captured by the refractory exponential integrate-and-fire (rEIF) model [<xref ref-type="bibr" rid="pcbi.1004165.ref032">32</xref>]. The rEIF model features additional post-spike dynamics for the EIF parameters <italic>g</italic>, <italic>E</italic>, and <italic>V</italic><sub>T</sub> (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1H</xref>) so that, following a spike, these parameters evolve as
<disp-formula id="pcbi.1004165.e005"><alternatives><graphic id="pcbi.1004165.e005g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004165.e005"/><mml:math id="M5" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mi>g</mml:mi></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula> <disp-formula id="pcbi.1004165.e006"><alternatives><graphic id="pcbi.1004165.e006g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004165.e006"/><mml:math id="M6" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mi>E</mml:mi></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>E</mml:mi> <mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula> <disp-formula id="pcbi.1004165.e007"><alternatives><graphic id="pcbi.1004165.e007g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004165.e007"/><mml:math id="M7" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>V</mml:mi> <mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi mathvariant="normal">T</mml:mi> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi mathvariant="normal">T</mml:mi> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where <italic>t</italic> is the time since the peak of the previous spike and (in this context) <italic>g</italic><sub>0</sub>, <italic>E</italic><sub>0</sub> and <italic>V</italic><sub>T0</sub> are the late-time (or equivalently, steady-state) values. The jumps in the parameter values <italic>g</italic><sub>1</sub>, <italic>E</italic><sub>1</sub>, <italic>E</italic><sub>2</sub> and <italic>V</italic><sub>T1</sub> are measured from the end of the refractory time, which is <italic>t</italic><sub>ref</sub> = 4ms after the spike peak.</p>
</sec>
<sec id="sec010">
<title>Parameter extraction</title>
<p>A total of 21 parameters were extracted from traditional square-pulse currents and the dynamic <italic>I-V</italic> method. Three parameters were measured from step-current stimuli: the input resistance <italic>R</italic><sub>in</sub>, calculated from the gradient of the current-voltage relationship around rest (using the mean voltage over the last 200 ms of each 1 s current step); its reciprocal the input conductance <italic>G</italic><sub>in</sub>; and the sag percentage, defined by the difference between the minimum voltage during a hyperpolarising current injection and the steady voltage (the last 200 ms of a 1 s current step) expressed as a percentage of the steady voltage response compared to rest (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1C</xref>). From the dynamic <italic>I-V</italic> protocol the parameters extracted were: the capacitance <italic>C</italic>, resting membrane potential <italic>E</italic>, the membrane time constant <italic>τ</italic>, the spike sharpness Δ<sub>T</sub> and the spike-onset threshold <italic>V</italic><sub>T</sub> (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1F</xref>) as well as their refractory properties (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1G, 1H</xref>) where relevant. Three further parameters were extracted from the response to fluctuating currents: the average action-potential amplitude, duration, and maximal rate of rise (from isolated spikes with a preceding inter-spike interval greater than 200 ms and averaged to give a value for that cell; <xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1I</xref>). Amplitude was defined as the distance between the spike initiation threshold for that spike, calculated using the peak second-derivative method [<xref ref-type="bibr" rid="pcbi.1004165.ref036">36</xref>], and the maximum voltage reached. Duration was calculated as the width at half-maximum. Maximal rate of rise was the maximum voltage first derivative between action-potential initiation-threshold and peak. Additional compound parameters considered were the potential difference to threshold <italic>V</italic><sub>T</sub> − <italic>E</italic> and the steady current required for spike initiation <italic>I</italic><sub>spike</sub> = (<italic>V</italic><sub>T</sub> − <italic>E</italic>)/<italic>R</italic><sub>in</sub>, both of which are measures of neuronal excitability.</p>
</sec>
<sec id="sec011">
<title>Model simulation</title>
<p>The rEIF model was simulated using a forward Euler scheme with a 50 <italic>μ</italic>s time step, corresponding to the 20 kHz acquisition rate of the experimental recordings. Action potentials were registered following a rapid rise in membrane potential with the integration stopped when <italic>V</italic> ≥ 30 mV (this is typically less than 0.7ms before the experimental spike peak, for cases where model and experiment have a closely agreeing subthreshold voltage 2ms prior to spike). Since the action-potential downswing is not explicitly modelled, the voltage integration was stopped for a refractory period of 4 ms, before restarting at a reset that was equal to the average experimental value at 4ms after the spike peak (typically above the pre-spike threshold <italic>V</italic><sub><italic>T</italic>0</sub>). The variables demonstrating a strong post-spike dynamics (<italic>g</italic>, <italic>E</italic>, and <italic>V</italic><sub>T</sub>) were increased to their post-spike jump values and subsequently followed fixed post-spike dynamics given by Eqs <xref ref-type="disp-formula" rid="pcbi.1004165.e005">(3)</xref>–<xref ref-type="disp-formula" rid="pcbi.1004165.e007">(5)</xref> from <italic>t</italic> = <italic>t</italic><sub>ref</sub> = 4ms post-spike and onwards.</p>
</sec>
<sec id="sec012">
<title>Performance measures</title>
<p>We used a number of performance metrics to asses the quality of the fit. To compare spike trains we used a previously used coincidence measure [<xref ref-type="bibr" rid="pcbi.1004165.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1004165.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1004165.ref038">38</xref>] given by
<disp-formula id="pcbi.1004165.e008"><alternatives><graphic id="pcbi.1004165.e008g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004165.e008"/><mml:math id="M8" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Γ</mml:mo> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mtext>coinc</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>⟨</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mtext>coinc</mml:mtext></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mo>(</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mfrac><mml:mn>1</mml:mn> <mml:mo>𝓝</mml:mo></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
where <italic>N</italic><sub>1</sub> is the number of spikes in the reference spike train, <italic>N</italic><sub>2</sub> is the number of spikes in the spike train for comparison, <italic>N</italic><sub>coinc</sub> is the number of coincidence spike occurrences between the two spike trains with a precision Δ (in this case Δ = 5 ms), ⟨<italic>N</italic><sub>coinc</sub>⟩ = 2<italic>f</italic>Δ<italic>N</italic><sub>1</sub> is the number of expected coincidences generated by a homogeneous Poisson process with firing rate <italic>f</italic>, the rate of the reference spike train, and 𝓝 = 1 − 2<italic>f</italic>Δ is a normalising factor so the Γ = 1 corresponds to an exactly coincident spike train. Since neurons have some intrinsic unreliability two identical current inputs will not produce identical spike trains. As such we computed two Γ values: Γ<sub>rep</sub>, comparing the target experimental spike train to a repeat recording obtained 10 minutes later with same driving current, and Γ<sub>sim</sub>, comparing the result of simulating the rEIF model with the same driving current to the target experimental recording. The ratio Γ<sub>sim</sub>/Γ<sub>rep</sub> compares the simulated spike train to the intrinsic reliability of the cell. Cells were discarded as intrinsically unreliable if Γ<sub>rep</sub> &lt; 0.75, a criterion failed by 13% of all cells analysed.</p>
</sec>
<sec id="sec013">
<title>Statistical analysis</title>
<p>The dataset used for final analysis consisted of 136 cells and 18 parameters (<xref ref-type="table" rid="pcbi.1004165.t001">Table 1</xref>, excluding <italic>G</italic><sub>in</sub>, <italic>t</italic><sub>sag</sub>, and <italic>t</italic><sub>0</sub>). Unless otherwise stated, pairwise comparisons were made with a Mann-Whitney’s U test at the 5% significance level, and means are quoted ± the standard error of the mean. To control for the familywise error rate we applied the Bonferroni correction for multiple comparisons. Prior to principal component analysis (to remove any bias towards high numerical values of a given parameter) log-normally distributed parameters were transformed to log-space, so that they were normally distributed, after which the dataset was normalised using the z-score <italic>Z</italic> = (<italic>μ</italic><sub><italic>i</italic></sub> − <italic>X</italic>)/<italic>σ</italic><sub><italic>i</italic></sub>, where <italic>μ</italic><sub><italic>i</italic></sub> and <italic>σ</italic><sub><italic>i</italic></sub> are the mean and standard deviation, respectively, of parameter <italic>i</italic> over the entire dataset. To examine correlations both Spearman’s rank correlation test and standard covariance tests were used. All data and statistical analyses was performed with custom-written MATLAB scripts utilising the Statistics and Global Optimisation toolboxes.</p>
<table-wrap id="pcbi.1004165.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004165.t001</object-id>
<label>Table 1</label>
<caption>
<title>Table of parameters measured in this study, separated into (from top to bottom) subthreshold, firing, action potential shape, and post-spike groups.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004165.t001g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004165.t001"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1"><bold>Parameter</bold></th>
<th align="left" rowspan="1" colspan="1"><bold>Description</bold></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>C</italic></td>
<td align="left" rowspan="1" colspan="1">Membrane capacitance (pF)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>R</italic><sub>in</sub></td>
<td align="left" rowspan="1" colspan="1">Input Resistance (MΩ)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>G</italic><sub>in</sub></td>
<td align="left" rowspan="1" colspan="1">Input conductance (nS)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>τ</italic></td>
<td align="left" rowspan="1" colspan="1">Membrane time constant (ms)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>E</italic></td>
<td align="left" rowspan="1" colspan="1">Membrane equilibrium potential (mV)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>S</italic></td>
<td align="left" rowspan="1" colspan="1">Sag percentage from hyperpolarising current</td>
</tr>
<tr>
<td colspan="2" rowspan="1"><hr/></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>V</italic><sub>T</sub> − <italic>E</italic></td>
<td align="left" rowspan="1" colspan="1">Potential between threshold and rest (mV)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>V</italic><sub>T</sub></td>
<td align="left" rowspan="1" colspan="1">Spike-onset threshold (mV)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>I</italic><sub>spike</sub></td>
<td align="left" rowspan="1" colspan="1">Spike initiation current (pA)</td>
</tr>
<tr>
<td colspan="2" rowspan="1"><hr/></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Δ<sub>T</sub></td>
<td align="left" rowspan="1" colspan="1">Spike sharpness (mV)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>A</italic><sub>amp</sub></td>
<td align="left" rowspan="1" colspan="1">Action potential amplitude (mV)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>A</italic><sub>dur</sub></td>
<td align="left" rowspan="1" colspan="1">Action potential duration (ms)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>A</italic><sub>rise</sub></td>
<td align="left" rowspan="1" colspan="1">Action potential rate of rise (mV/ms)</td>
</tr>
<tr>
<td colspan="2" rowspan="1"><hr/></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>g</italic><sub>1</sub></td>
<td align="left" rowspan="1" colspan="1">Post-spike jump in conductance (nS)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>τ</italic><sub><italic>g</italic></sub></td>
<td align="left" rowspan="1" colspan="1">Conductance decay time constant (ms)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>V</italic><sub>T1</sub></td>
<td align="left" rowspan="1" colspan="1">Post-spike jump in spike threshold (mV)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>τ</italic><sub>T</sub></td>
<td align="left" rowspan="1" colspan="1">Spike threshold decay time constant (ms)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>E</italic><sub>jump</sub></td>
<td align="left" rowspan="1" colspan="1">Post-Spike jump in <italic>E</italic> (mV)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>E</italic><sub>sag</sub></td>
<td align="left" rowspan="1" colspan="1">Post-spike sag in <italic>E</italic> (mV)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>t</italic><sub>sag</sub></td>
<td align="left" rowspan="1" colspan="1">Post-spike time of <italic>E</italic><sub>sag</sub> (ms)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>t</italic><sub>0</sub></td>
<td align="left" rowspan="1" colspan="1">Post-spike time at which <italic>E</italic> crosses baseline (ms)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec014">
<title>Supporting Information and full data archive</title>
<p>Together with this paper we provide algorithms in the form of MATLAB scripts for generating parameter sets (for each of the pyramidal-cell populations considered) with the experimentally measured marginal distributions and crosscorrelations. The first script Generate_EIF.m provides parameter sets for the standard EIF model [<xref ref-type="bibr" rid="pcbi.1004165.ref035">35</xref>] for <italic>C</italic>, <italic>τ</italic>, <italic>E</italic>, <italic>V</italic><sub>T</sub> and Δ<sub>T</sub> (<xref ref-type="supplementary-material" rid="pcbi.1004165.s001">S1 Computer Code</xref>). The second script Generate_rEIF.m also generates the additional quantities required for the full refractory EIF model [<xref ref-type="bibr" rid="pcbi.1004165.ref032">32</xref>] including the parameterization of the post-spike dynamics of <italic>E</italic>, <italic>g</italic> and <italic>V</italic><sub>T</sub> (<xref ref-type="supplementary-material" rid="pcbi.1004165.s002">S2 Computer Code</xref>). We also provide the MATLAB code <monospace>DynamicIVAnalysis.m</monospace> used for the dynamic IV method together with two pairs of data sets—one for extracting the parameters and one for testing the resulting model (<xref ref-type="supplementary-material" rid="pcbi.1004165.s003">S3 Computer Code and Data Files</xref>). All three scripts are published under the GNU General Public Licence, Version 3 (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</ext-link>). Finally, the full data set comprising whole-cell patch-clamp recordings from 136 pyramidal cells stimulated by square-wave and fluctuating current protocols has been published at <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.datadryad.com">www.datadryad.com</ext-link> (doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.d30k7" xlink:type="simple">10.5061/dryad.d30k7</ext-link>).</p>
</sec>
</sec>
<sec id="sec015" sec-type="results">
<title>Results</title>
<p>Whole-cell patch-clamp recordings from 136 somatosensory-cortex pyramidal cells were made across layer 2/3 to layer 5 (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1A</xref>). We initially classified the cells based on laminar location and somatic size under DIC infrared microscopy, and also examined the spiking pattern in response to an initial step-current protocol (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1B-1C</xref>). Four distinct classes of pyramidal cell were identified and recorded from: layer 2/3 (L2/3, <italic>n</italic> = 31), layer 4 (L4, <italic>n</italic> = 29), slender-tufted layer 5 (SL5, <italic>n</italic> = 29) and thick-tufted layer 5 (TL5, <italic>n</italic> = 47) corresponding to previous classifications [<xref ref-type="bibr" rid="pcbi.1004165.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004165.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1004165.ref017">17</xref>]. We then proceeded to extract electrophysiological parameters, analyse their distribution and examine the quality of the associated neuron models that were generated. The post-recording morphology of the cell, seen under confocal microscopy using fluorescent-dye filling or biocytin staining, was used as an additional criterion for identifying pyramidal-neuron class.</p>
<sec id="sec016">
<title>Parameter measurement</title>
<p>Parameters were extracted from responses to square-pulse currents and fluctuating <italic>in-vivo</italic>-like stimuli (see <xref ref-type="sec" rid="sec002">Methods</xref>). A total of 21 parameters were used (<xref ref-type="table" rid="pcbi.1004165.t001">Table 1</xref>) and divided into four groupings: subthreshold, firing, action-potential shape and post-spike parameters.</p>
<p>From step-current injections were measured input resistance (with its reciprocal the input conductance) and sag depth in response to a hyperpolarising current step (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1C</xref>). Additional parameters, together with their post-spike dynamics, were extracted from the response to fluctuating stimuli using the dynamic <italic>I-V</italic> protocol (see <xref ref-type="sec" rid="sec002">Methods</xref> and reference [<xref ref-type="bibr" rid="pcbi.1004165.ref032">32</xref>]). During fluctuating current injection, the timecourse of the ionic current was found from the difference between the injected stimulation current and the capacitive current <inline-formula id="pcbi.1004165.e009"><alternatives><graphic id="pcbi.1004165.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004165.e009"/><mml:math id="M9" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>I</mml:mi> <mml:mtext mathvariant="normal">ion</mml:mtext></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mtext mathvariant="normal">in</mml:mtext></mml:msub> <mml:mo>−</mml:mo> <mml:mi>C</mml:mi> <mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>.</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1D</xref>) where the membrane capacitance <italic>C</italic> is found using a variance-minimisation technique [<xref ref-type="bibr" rid="pcbi.1004165.ref032">32</xref>]. The instantaneous current-voltage relationship, or dynamic <italic>I-V</italic> curve is then found from the average value of <italic>I</italic><sub>ion</sub> at a particular voltage <italic>I</italic><sub>dyn</sub>(<italic>V</italic>) = ⟨<italic>I</italic><sub>ion</sub>(<italic>V</italic>, <italic>t</italic>)⟩<sub><italic>V</italic></sub> (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1E</xref>). This projection of the time-dependent ionic current onto a quantity that varies only with the (time-dependent) voltage allows for direct generation of neuron models of the non-linear integrate-and-fire type <inline-formula id="pcbi.1004165.e010"><alternatives><graphic id="pcbi.1004165.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004165.e010"/><mml:math id="M10" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>.</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi>F</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>V</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>+</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mtext mathvariant="normal">in</mml:mtext></mml:msub> <mml:mo>/</mml:mo> <mml:mi>C</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, with the forcing function <italic>F</italic>(<italic>V</italic>) related to the best estimate of the instantaneous ionic current through <italic>F</italic>(<italic>V</italic>) = −<italic>I</italic><sub>dyn</sub>(<italic>V</italic>)/<italic>C</italic> (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1F</xref>). Empirically we found that the forcing function <italic>F</italic>(<italic>V</italic>) was very well fit by the exponential integrate-and-fire form [<xref ref-type="bibr" rid="pcbi.1004165.ref035">35</xref>] given by <xref ref-type="disp-formula" rid="pcbi.1004165.e004">Eq (2)</xref> for all classes of pyramidal cell in layers 2/3, 4 and 5. This form is parameterised by the membrane time constant <italic>τ</italic>, the resting potential <italic>E</italic>, the spike sharpness Δ<sub>T</sub> and the spike-onset threshold <italic>V</italic><sub>T</sub>. These four constants, together with the capacitance (providing a second estimate of the conductance, via <italic>g</italic> = <italic>C</italic>/<italic>τ</italic>, in close agreement with that derived from square-pulse protocols) characterise the response of the neuron for times that were greater than 200 ms after an action potential, i.e. after any spike-triggered transients have dissipated.</p>
<p>During a spike the transient activation and inactivation of transmembrane currents cause a rapid change and then relaxation back to baseline of the average ionic current. The timecourse can be measured using the dynamic <italic>I-V</italic> method in spike-triggered mode (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1G</xref>) with the parameters of the changing forcing function <italic>F</italic>(<italic>V</italic>, <italic>t</italic>) typically exhibiting a jump followed by exponential or bi-exponential relaxation back to their steady-state values over tens of milliseconds (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1H</xref>). The only parameters exhibiting significant transients were: the membrane conductance <italic>g</italic> (calculated from <italic>C</italic>/<italic>τ</italic>) which decayed mono-exponentially; the equilibrium potential <italic>E</italic>, which typically decayed bi-exponentially; and the spike-onset threshold <italic>V</italic><sub>T</sub>, which decayed mono-exponentially (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1H</xref>). There was little variability, with no consistent trend, seen in the spike sharpness parameter Δ<sub>T</sub>. It should also be noted that this quantity is an effective parameter that is larger than the true value of the spike sharpness for individual spikes. This is due to the dynamic <italic>I-V</italic> curve method averaging over many spikes with variations in the threshold that arise from membrane voltage fluctuations in the run up to the spike [<xref ref-type="bibr" rid="pcbi.1004165.ref039">39</xref>–<xref ref-type="bibr" rid="pcbi.1004165.ref041">41</xref>]. The post-spike dynamics of <italic>g</italic>, <italic>E</italic> and <italic>V</italic><sub>T</sub> were modelled by exponential functions yielding a number of additional parameters (see <xref ref-type="sec" rid="sec002">Methods</xref> Eqs <xref ref-type="disp-formula" rid="pcbi.1004165.e005">(3)</xref>–<xref ref-type="disp-formula" rid="pcbi.1004165.e007">(5)</xref>). The action-potential shapes, characterised by amplitude, duration and rise, were also extracted from the voltage-response to fluctuating current stimulation (<xref ref-type="fig" rid="pcbi.1004165.g001">Fig 1I</xref>).</p>
<p>As well as the directly measured parameters just described, hybrid parameters characterising excitability were also defined and comprised the potential difference between spike-onset threshold and rest <italic>V</italic><sub>T</sub> − <italic>E</italic> and the spike-initiation current <italic>I</italic><sub>spike</sub> = (<italic>V</italic><sub>T</sub> − <italic>E</italic>)/<italic>R</italic><sub>in</sub>.</p>
</sec>
<sec id="sec017">
<title>Quality of model fits</title>
<p>We found that the empirical dynamic <italic>I-V</italic> curve could be accurately fitted by the exponential integrate-fire (EIF) form <xref ref-type="disp-formula" rid="pcbi.1004165.e004">Eq (2)</xref> for each of the four pyramidal-cell classes from layers 2/3, 4 and 5 (<xref ref-type="fig" rid="pcbi.1004165.g002">Fig 2Ai-2Aiv</xref>). To quantify the quality of the extracted model we compared (<xref ref-type="fig" rid="pcbi.1004165.g002">Fig 2Bi-2Biv</xref>) the neuronal response to novel stimuli with the prediction from a simulation of the refractory EIF (rEIF) model, an extension [<xref ref-type="bibr" rid="pcbi.1004165.ref032">32</xref>] of the standard EIF model [<xref ref-type="bibr" rid="pcbi.1004165.ref035">35</xref>] to include post-spike parameter dynamics (Eqs <xref ref-type="disp-formula" rid="pcbi.1004165.e005">(3)</xref>–<xref ref-type="disp-formula" rid="pcbi.1004165.e007">(5)</xref>). The rEIF model gave a good account of the spike times with mean(std) coincidence ratios, which compare the similarity of the model and experimental spike trains to the intrinsic cell reliability (see <xref ref-type="sec" rid="sec002">Methods</xref>), of L2/3 0.88(0.16), L4 0.86(0.20), SL5 0.74(0.21) and TL5 0.76(0.22), with an overal value of 0.81(0.21) for all cells (<xref ref-type="fig" rid="pcbi.1004165.g002">Fig 2Ci-2Civ</xref>). We also compared the subthreshold response of the model and experiment (<xref ref-type="fig" rid="pcbi.1004165.g002">Fig 2Di-2Div</xref>) with the root mean squared-deviation (RMSD) of the set of data points excluding 2 ms before and 4 ms after a spike peak. The RMSDs between model and experiment were L2/3 4.6(2.8)mV, L4 3.4(1.1)mV, SL5 3.4(1.0)mV and TL5 3.8(1.2)mV with an overal value of 3.8(1.7)mV. These values can be compared to the RMSD for experiments where the stimulus was repeated: L2/3 2.5(1.1)mV, L4 2.9(1.6)mV, SL5 2.7(1.6)mV and TL5 3.0(2.0)mV, with an overall value of 2.8(1.7)mV (an effective accuracy of ∼ 1 mV between the rEIF model and experiment).</p>
<fig id="pcbi.1004165.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004165.g002</object-id>
<label>Fig 2</label>
<caption>
<p>The dynamic <italic>I</italic> − <italic>V</italic> curve and associated refractory Exponential Integrate-and-Fire (rEIF) model fits to (i) layer-2/3, (ii) layer-4, (iii) slender-tufted layer-5 and (iv) thick-tufted layer-5 pyramidal-cell voltage timecourses. For each population the first panel <bold>A</bold> shows representitive empirical steady-state forcing terms (black; proportional to minus the dynamic <italic>I-V</italic> curve divided by capacitance) with the EIF form (colour; <xref ref-type="disp-formula" rid="pcbi.1004165.e004">Eq (2)</xref>) providing a good fit for all populations. <bold>B</bold> compares the accuracy of the resulting rEIF model (coloured) to an experimental voltage trace (black). The histograms show performance measures for the voltage-timecourse fits: the spike-coincidence ratio <bold>C</bold> and the root-mean-squared difference in voltage <bold>D</bold> between repeated experimental traces (upper histogram), and experiment and model traces (lower histogram).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004165.g002"/>
</fig>
</sec>
<sec id="sec018">
<title>Post-spike parameter response</title>
<p>Before going on to analyse the parameter distributions across the pyramidal-cell populations, we examined the post-spike parameter dynamics in more detail. <xref ref-type="fig" rid="pcbi.1004165.g003">Fig 3</xref> shows the mean timecourses of conductance <italic>g</italic>, resting potential <italic>E</italic> and spike-onset threshold <italic>V</italic><sub>T</sub> for each of the four cell classes. Considering first the post-spike conductance dynamics, thick-tufted layer-5 (TL5) pyramidals had a greater conductance increase (<xref ref-type="fig" rid="pcbi.1004165.g003">Fig 3A</xref>) immediatelty following a spike. However, on normalization by the capacitance (<xref ref-type="fig" rid="pcbi.1004165.g003">Fig 3B</xref>) the disparity is weaker indicating that the higher jump in conductance in TL5 pyramidal cells is due to size rather than to differences in channel properties or density. The post-spike dynamics of the spike-onset threshold <italic>V</italic><sub>T</sub> showed little difference between the four classes (<xref ref-type="fig" rid="pcbi.1004165.g003">Fig 3C</xref>): all showed a significant jump, between 10–20 mV, in the threshold for action-potential generation. The post-spike dynamics of the instantaneous resting potential <italic>E</italic> were markedly different between pyramidal-cell populations: L2/3 cells displayed a mono-exponential response whereas TL5 pyramidals featured a significant sag, with the other two classes intermediate (<xref ref-type="fig" rid="pcbi.1004165.g003">Fig 3D</xref>). To conveniently characterise the dynamics of <italic>E</italic> we introduce four new parameters: the post-spike jump in the equilibrium potential <italic>E</italic><sub>jump</sub>, the depth of the subsequent sag <italic>E</italic><sub>sag</sub>, the time to sag <italic>t</italic><sub>sag</sub> and the interception time <italic>t</italic><sub>0</sub> (<xref ref-type="fig" rid="pcbi.1004165.g003">Fig 3E</xref>). It was previously proposed that the sag in the equilibrium potential <italic>E</italic>(<italic>t</italic>) post-spike dynamics [<xref ref-type="bibr" rid="pcbi.1004165.ref032">32</xref>] is the result of a transient inactivation of the h-current during the spike followed by its subsequent re-activation at more hyperpolarized voltages [<xref ref-type="bibr" rid="pcbi.1004165.ref042">42</xref>]. To test this hypothesis we measured the post-spike dynamics of <italic>E</italic> in TL5 cells in control conditions and following the application of 25 <italic>μ</italic>M of the <italic>I</italic><sub><italic>h</italic></sub>-channel blocker ZD7288 [<xref ref-type="bibr" rid="pcbi.1004165.ref034">34</xref>]. On blocking <italic>I</italic><sub><italic>h</italic></sub> channels the bi-exponetial sag dynamics changed to a mono-exponential response (<xref ref-type="fig" rid="pcbi.1004165.g003">Fig 3F</xref>). The drug application also resulted in significant membrane hyperpolarisation, an increase in the relative post-spike resting-potential jump and a reduction or complete abolition of the post-spike sag (<xref ref-type="fig" rid="pcbi.1004165.g003">Fig 3G</xref>) supporting the hypothesis that <italic>I</italic><sub><italic>h</italic></sub> channels underlie the non-monotonic post-spike timecourse seen in TL5 pyramidal cells.</p>
<fig id="pcbi.1004165.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004165.g003</object-id>
<label>Fig 3</label>
<caption>
<p>Class-dependent post-spike dynamics of <bold>A</bold> conductance <italic>g</italic>, <bold>B</bold> <italic>g</italic>/<italic>C</italic> = 1/<italic>τ</italic>, <bold>C</bold> spike threshold <italic>V</italic><sub>T</sub> and <bold>D</bold> equilibrium potential <italic>E</italic>. Note the sag in the <italic>E</italic> dynamics of TL5 cells. <bold>E</bold> Quantifying <italic>E</italic> dynamics by jump and sag depth. <bold>F</bold> TL5 <italic>E</italic> dynamics in control conditions and after application of <italic>I</italic><sub><italic>h</italic></sub>-blocker ZD7288, which abolished the sag. <bold>G</bold> The blocker also resulted in a hyperpolarization of the steady-state rest, with a post-spike jump increase and sag-depth reduction.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004165.g003"/>
</fig>
</sec>
<sec id="sec019">
<title>Differences between cell classes</title>
<p>All data for the four pyramidal-cell classes studied for each of the 21 parameters (<xref ref-type="table" rid="pcbi.1004165.t001">Table 1</xref>) are shown in <xref ref-type="fig" rid="pcbi.1004165.g004">Fig 4</xref> together with the fitted distributions (see also <xref ref-type="table" rid="pcbi.1004165.t002">Table 2</xref>). Pairwise significance tests were performed between cell classes for each parameter to identify significant differences and are shown when above the 5% level. We now consider the major features of the data set by parameter groupings.</p>
<fig id="pcbi.1004165.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004165.g004</object-id>
<label>Fig 4</label>
<caption>
<p>Quantifying heterogeneity in neocortical pyramidal-cell populations. The parameter groupings are: <bold>A</bold> subthreshold, <bold>B</bold> firing, <bold>C</bold> action-potential shape and <bold>D</bold> post-spike parameters for each pyramidal-cell class. Left panels show mean value (darker point) and all data (pale points) with error bars (95% bootstrap confidence interval). Horizontal lines denote significant statistical difference (5% confidence, Bonferroni-corrected). Right panels show fitted distributions for each pyramidal-cell class. The <italic>n</italic> numbers are shown on the first panel and are common to all other panels except the four concerning the resting-potential sag dynamics <italic>E</italic> for which only those cells with sags were included (<italic>n</italic> numbers are given in the <italic>E</italic><sub>jump</sub> panel). Note that many parameters correlate with cortical depth.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004165.g004"/>
</fig>
<table-wrap id="pcbi.1004165.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004165.t002</object-id>
<label>Table 2</label>
<caption>
<title>The mean <italic>μ</italic> and standard deviation <italic>σ</italic> for the parameter distributions (log-normal unless otherwise marked).</title>
</caption>
<alternatives>
<graphic id="pcbi.1004165.t002g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004165.t002"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1"><bold>Parameter</bold></th>
<th align="center" colspan="2" rowspan="1"><bold>Layer 2/3</bold></th>
<th align="center" colspan="2" rowspan="1"><bold>Layer 4</bold></th>
<th align="center" colspan="2" rowspan="1"><bold>Slender Layer 5</bold></th>
<th align="center" colspan="2" rowspan="1"><bold>Thick Layer 5</bold></th>
</tr>
<tr>
<th align="left" rowspan="1" colspan="1"/>
<th align="left" rowspan="1" colspan="1"><italic>μ</italic></th>
<th align="left" rowspan="1" colspan="1"><italic>σ</italic></th>
<th align="left" rowspan="1" colspan="1"><italic>μ</italic></th>
<th align="left" rowspan="1" colspan="1"><italic>σ</italic></th>
<th align="left" rowspan="1" colspan="1"><italic>μ</italic></th>
<th align="left" rowspan="1" colspan="1"><italic>σ</italic></th>
<th align="left" rowspan="1" colspan="1"><italic>μ</italic></th>
<th align="left" rowspan="1" colspan="1"><italic>σ</italic></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>C</italic> (pF)</td>
<td align="left" rowspan="1" colspan="1">134</td>
<td align="char" char="." rowspan="1" colspan="1">32.8</td>
<td align="left" rowspan="1" colspan="1">135</td>
<td align="char" char="." rowspan="1" colspan="1">36.7</td>
<td align="left" rowspan="1" colspan="1">133</td>
<td align="char" char="." rowspan="1" colspan="1">31.9</td>
<td align="left" rowspan="1" colspan="1">284</td>
<td align="char" char="." rowspan="1" colspan="1">78.5</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>R</italic><sub>in</sub> (MΩ)</td>
<td align="left" rowspan="1" colspan="1">121</td>
<td align="char" char="." rowspan="1" colspan="1">45.2</td>
<td align="left" rowspan="1" colspan="1">149</td>
<td align="char" char="." rowspan="1" colspan="1">50.5</td>
<td align="left" rowspan="1" colspan="1">154</td>
<td align="char" char="." rowspan="1" colspan="1">73.3</td>
<td align="left" rowspan="1" colspan="1">52.4</td>
<td align="char" char="." rowspan="1" colspan="1">19.4</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>G</italic><sub>in</sub> (nS)</td>
<td align="left" rowspan="1" colspan="1">9.31</td>
<td align="char" char="." rowspan="1" colspan="1">3.24</td>
<td align="left" rowspan="1" colspan="1">7.52</td>
<td align="char" char="." rowspan="1" colspan="1">2.69</td>
<td align="left" rowspan="1" colspan="1">7.94</td>
<td align="char" char="." rowspan="1" colspan="1">3.38</td>
<td align="left" rowspan="1" colspan="1">21.5</td>
<td align="char" char="." rowspan="1" colspan="1">7.40</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>τ</italic> (ms)</td>
<td align="left" rowspan="1" colspan="1">14.6</td>
<td align="char" char="." rowspan="1" colspan="1">2.53</td>
<td align="left" rowspan="1" colspan="1">17.2</td>
<td align="char" char="." rowspan="1" colspan="1">4.18</td>
<td align="left" rowspan="1" colspan="1">18.3</td>
<td align="char" char="." rowspan="1" colspan="1">4.74</td>
<td align="left" rowspan="1" colspan="1">18.7</td>
<td align="char" char="." rowspan="1" colspan="1">4.23</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>E</italic> (mV)</td>
<td align="left" rowspan="1" colspan="1">−79.3<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="char" char="." rowspan="1" colspan="1">4.27<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="left" rowspan="1" colspan="1">−71.8<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="char" char="." rowspan="1" colspan="1">4.20<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="left" rowspan="1" colspan="1">−69.9<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="char" char="." rowspan="1" colspan="1">4.18<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="left" rowspan="1" colspan="1">−68.5<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="char" char="." rowspan="1" colspan="1">3.98<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>S</italic>(%)</td>
<td align="left" rowspan="1" colspan="1">11.0</td>
<td align="char" char="." rowspan="1" colspan="1">5.70</td>
<td align="left" rowspan="1" colspan="1">21.0</td>
<td align="char" char="." rowspan="1" colspan="1">7.65</td>
<td align="left" rowspan="1" colspan="1">26.8<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="char" char="." rowspan="1" colspan="1">7.58<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="left" rowspan="1" colspan="1">30.6<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="char" char="." rowspan="1" colspan="1">9.20<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
</tr>
<tr>
<td colspan="9" rowspan="1"><hr/></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>V</italic><sub>T</sub> − <italic>E</italic> (mV)</td>
<td align="left" rowspan="1" colspan="1">29.8</td>
<td align="char" char="." rowspan="1" colspan="1">4.16</td>
<td align="left" rowspan="1" colspan="1">23.2</td>
<td align="char" char="." rowspan="1" colspan="1">4.46</td>
<td align="left" rowspan="1" colspan="1">20.1</td>
<td align="char" char="." rowspan="1" colspan="1">4.28</td>
<td align="left" rowspan="1" colspan="1">15.7</td>
<td align="char" char="." rowspan="1" colspan="1">4.25</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>V</italic><sub>T</sub> (mV)</td>
<td align="left" rowspan="1" colspan="1">−49.5<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="char" char="." rowspan="1" colspan="1">3.81<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="left" rowspan="1" colspan="1">−48.7<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="char" char="." rowspan="1" colspan="1">3.53<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="left" rowspan="1" colspan="1">−49.7<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="char" char="." rowspan="1" colspan="1">3.56<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="left" rowspan="1" colspan="1">−52.7<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="char" char="." rowspan="1" colspan="1">3.59<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>I</italic><sub>spike</sub> (pA)</td>
<td align="left" rowspan="1" colspan="1">270</td>
<td align="char" char="." rowspan="1" colspan="1">77.4</td>
<td align="left" rowspan="1" colspan="1">173</td>
<td align="char" char="." rowspan="1" colspan="1">66.5</td>
<td align="left" rowspan="1" colspan="1">150</td>
<td align="char" char="." rowspan="1" colspan="1">48.6</td>
<td align="left" rowspan="1" colspan="1">324</td>
<td align="char" char="." rowspan="1" colspan="1">105</td>
</tr>
<tr>
<td colspan="9" rowspan="1"><hr/></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Δ<sub>T</sub> (mV)</td>
<td align="left" rowspan="1" colspan="1">1.34</td>
<td align="char" char="." rowspan="1" colspan="1">0.550</td>
<td align="left" rowspan="1" colspan="1">1.28</td>
<td align="char" char="." rowspan="1" colspan="1">0.394</td>
<td align="left" rowspan="1" colspan="1">1.35</td>
<td align="char" char="." rowspan="1" colspan="1">0.523</td>
<td align="left" rowspan="1" colspan="1">1.16</td>
<td align="char" char="." rowspan="1" colspan="1">0.479</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>A</italic><sub>amp</sub> (mV)</td>
<td align="left" rowspan="1" colspan="1">75.5<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="char" char="." rowspan="1" colspan="1">7.76<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="left" rowspan="1" colspan="1">74.5<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="char" char="." rowspan="1" colspan="1">6.47<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="left" rowspan="1" colspan="1">77.2<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="char" char="." rowspan="1" colspan="1">7.07<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="left" rowspan="1" colspan="1">84.1<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
<td align="char" char="." rowspan="1" colspan="1">5.15<xref ref-type="table-fn" rid="t002fn001">*</xref></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>A</italic><sub>dur</sub> (ms)</td>
<td align="left" rowspan="1" colspan="1">1.41</td>
<td align="char" char="." rowspan="1" colspan="1">0.245</td>
<td align="left" rowspan="1" colspan="1">1.33</td>
<td align="char" char="." rowspan="1" colspan="1">0.215</td>
<td align="left" rowspan="1" colspan="1">1.16</td>
<td align="char" char="." rowspan="1" colspan="1">0.271</td>
<td align="left" rowspan="1" colspan="1">0.981</td>
<td align="char" char="." rowspan="1" colspan="1">0.149</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>A</italic><sub>rise</sub> (mV/ms)</td>
<td align="left" rowspan="1" colspan="1">234</td>
<td align="char" char="." rowspan="1" colspan="1">50.3</td>
<td align="left" rowspan="1" colspan="1">258</td>
<td align="char" char="." rowspan="1" colspan="1">46.2</td>
<td align="left" rowspan="1" colspan="1">275</td>
<td align="char" char="." rowspan="1" colspan="1">76.8</td>
<td align="left" rowspan="1" colspan="1">319</td>
<td align="char" char="." rowspan="1" colspan="1">46.9</td>
</tr>
<tr>
<td colspan="9" rowspan="1"><hr/></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>g</italic><sub>1</sub> (nS)</td>
<td align="left" rowspan="1" colspan="1">14.3</td>
<td align="char" char="." rowspan="1" colspan="1">7.5</td>
<td align="left" rowspan="1" colspan="1">20.0</td>
<td align="char" char="." rowspan="1" colspan="1">9.6</td>
<td align="left" rowspan="1" colspan="1">15.7</td>
<td align="char" char="." rowspan="1" colspan="1">7.7</td>
<td align="left" rowspan="1" colspan="1">26.1</td>
<td align="char" char="." rowspan="1" colspan="1">12.5</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>τ</italic><sub><italic>g</italic></sub> (ms)</td>
<td align="left" rowspan="1" colspan="1">17.0</td>
<td align="char" char="." rowspan="1" colspan="1">17.4</td>
<td align="left" rowspan="1" colspan="1">17.3</td>
<td align="char" char="." rowspan="1" colspan="1">15.8</td>
<td align="left" rowspan="1" colspan="1">23.3</td>
<td align="char" char="." rowspan="1" colspan="1">23.9</td>
<td align="left" rowspan="1" colspan="1">24.5</td>
<td align="char" char="." rowspan="1" colspan="1">21.8</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>V</italic><sub>T1</sub> (mV)</td>
<td align="left" rowspan="1" colspan="1">16.2</td>
<td align="char" char="." rowspan="1" colspan="1">4.4</td>
<td align="left" rowspan="1" colspan="1">15.9</td>
<td align="char" char="." rowspan="1" colspan="1">5.1</td>
<td align="left" rowspan="1" colspan="1">13.1</td>
<td align="char" char="." rowspan="1" colspan="1">4.0</td>
<td align="left" rowspan="1" colspan="1">14.8</td>
<td align="char" char="." rowspan="1" colspan="1">4.4</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>τ</italic><sub>T</sub> (ms)</td>
<td align="left" rowspan="1" colspan="1">13.6</td>
<td align="char" char="." rowspan="1" colspan="1">8.9</td>
<td align="left" rowspan="1" colspan="1">14.1</td>
<td align="char" char="." rowspan="1" colspan="1">4.9</td>
<td align="left" rowspan="1" colspan="1">16.4</td>
<td align="char" char="." rowspan="1" colspan="1">9.7</td>
<td align="left" rowspan="1" colspan="1">12.7</td>
<td align="char" char="." rowspan="1" colspan="1">5.3</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>E</italic><sub>jump</sub> (mV)</td>
<td align="left" rowspan="1" colspan="1">15.8</td>
<td align="char" char="." rowspan="1" colspan="1">5.7</td>
<td align="left" rowspan="1" colspan="1">10.1</td>
<td align="char" char="." rowspan="1" colspan="1">3.7</td>
<td align="left" rowspan="1" colspan="1">9.6</td>
<td align="char" char="." rowspan="1" colspan="1">4.3</td>
<td align="left" rowspan="1" colspan="1">7.9</td>
<td align="char" char="." rowspan="1" colspan="1">4.6</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>E</italic><sub>sag</sub> (mV)</td>
<td align="left" rowspan="1" colspan="1">1.3</td>
<td align="char" char="." rowspan="1" colspan="1">0.9</td>
<td align="left" rowspan="1" colspan="1">1.8</td>
<td align="char" char="." rowspan="1" colspan="1">1.1</td>
<td align="left" rowspan="1" colspan="1">2.7</td>
<td align="char" char="." rowspan="1" colspan="1">1.7</td>
<td align="left" rowspan="1" colspan="1">4.4</td>
<td align="char" char="." rowspan="1" colspan="1">2.0</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>t</italic><sub>sag</sub> (ms)</td>
<td align="left" rowspan="1" colspan="1">87.5</td>
<td align="char" char="." rowspan="1" colspan="1">23.2</td>
<td align="left" rowspan="1" colspan="1">66.2</td>
<td align="char" char="." rowspan="1" colspan="1">18.9</td>
<td align="left" rowspan="1" colspan="1">53.0</td>
<td align="char" char="." rowspan="1" colspan="1">19.9</td>
<td align="left" rowspan="1" colspan="1">40.4</td>
<td align="char" char="." rowspan="1" colspan="1">11.5</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>t</italic><sub>0</sub>(ms)</td>
<td align="left" rowspan="1" colspan="1">45.9</td>
<td align="char" char="." rowspan="1" colspan="1">15.7</td>
<td align="left" rowspan="1" colspan="1">30.6</td>
<td align="char" char="." rowspan="1" colspan="1">12.2</td>
<td align="left" rowspan="1" colspan="1">21.6</td>
<td align="char" char="." rowspan="1" colspan="1">12.0</td>
<td align="left" rowspan="1" colspan="1">11.5</td>
<td align="char" char="." rowspan="1" colspan="1">6.8</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001">
<p>* Normal distribution.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>The main observations for the subthreshold parameters (<xref ref-type="fig" rid="pcbi.1004165.g004">Fig 4A</xref>) were: L2/3 cells are well distinguished by their short time constant, hyperpolarised equilibrium potential and lack of sag response to a hyperpolarising step current; TL5 pyramidal cells are distinguished by large capacitance and conductance, as expected, and further separated from the layers 2/3 and 4 populations by their depolarised resting potential and strong sag response; the only significant difference between L4 and SL5 cells is their sag percentage, with SL5 cells displaying a statistically significant larger response (one of only two parameters to distinguish between these cell classes).</p>
<p>For the firing parameters (<xref ref-type="fig" rid="pcbi.1004165.g004">Fig 4B</xref>) it was seen that: the potential difference between rest <italic>E</italic> and spike-onset threshold <italic>V</italic><sub><italic>T</italic></sub> decreases monotonically from 30mV to 16mV from L2/3 to L5 with the majority of the change due to an increasingly depolarised rest rather than significant change in spike-onset threshold <italic>V</italic><sub>T</sub>; TL5 spike-onset threshold is significantly lower than in other layers; on normalising the potential difference to threshold by the membrane resistance, L2/3 and TL5 cells are both well distinguished from L4 and SL5 cells by their requirement of a higher current for spike initiation.</p>
<p>For the action-potential shape parameters (<xref ref-type="fig" rid="pcbi.1004165.g004">Fig 4C</xref>): no difference was seen across pyramidal-cell populations in the spike sharpness parameter Δ<sub>T</sub>; however, TL5 cells separate well in their higher amplitude (consistent with lower <italic>V</italic><sub><italic>T</italic></sub>), shorter duration, and greater maximal rate of rise; spike duration also discriminates between L4 and SL5 cells (the second of the two parameters in our dataset to do so).</p>
<p>For the post-spike parameters (<xref ref-type="fig" rid="pcbi.1004165.g004">Fig 4D</xref>): TL5 pyramidals have a greater spike-triggered jump in conductance than L2/3 and SL5 cells (due to their greater size: see <xref ref-type="fig" rid="pcbi.1004165.g003">Fig 3B</xref> and related discussion in the main text) and a significantly longer <italic>τ</italic><sub><italic>g</italic></sub> than L2/3 cells; the only significant difference in spike-onset threshold was the greater jump of L2/3 compared to SL5 cells; however, the resting-potential dynamics displayed a more marked difference between classes as already discussed (<xref ref-type="fig" rid="pcbi.1004165.g003">Fig 3D</xref>). Considering first only the cells from each class that display a sag in the post-spike response (defined as <italic>E</italic><sub>sag</sub> &gt; 0.5mV; <italic>n</italic>-numbers given in the <xref ref-type="fig" rid="pcbi.1004165.g004">Fig 4C</xref> panel for <italic>E</italic><sub>jump</sub>), L2/3 cells are well separated by their smaller sag depth whereas TL5 cells have a significantly greater sag depth than all other classes. These observations are consistent with the sag percentages during hyperpolarising square-pulse current stimuli for the different pyramidal-cell classes (Figs <xref ref-type="fig" rid="pcbi.1004165.g001">1C</xref> and <xref ref-type="fig" rid="pcbi.1004165.g004">4A</xref>) given that <italic>I</italic><sub><italic>h</italic></sub> underlies this response (<xref ref-type="fig" rid="pcbi.1004165.g003">Fig 3F</xref>). Each of the four cell classes had a different proportion that displayed a post-spike sag in resting potential (L2/3 0.32; L4 0.76; SL5 0.69; TL5 0.94). Cells (<italic>n</italic> = 40) that did not exhibit the sag response could all be described by a mono-exponential drawn from a single class-independent distribution with a post-spike jump <italic>E</italic><sub>mono</sub> and decay-time constant <italic>τ</italic><sub>mono</sub> (see next paragraph).</p>
<p>We fitted distributions to each parameter for the four pyramidal-cell classes to enable the generation of reduced neuron-models with the correct marginal distributions (parameter covariance is considered later). All parameters were well fitted by log-normal distributions except: the resting potential <italic>E</italic>, spike-onset threshold <italic>V</italic><sub>T</sub>, action-potential amplitude <italic>A</italic><sub>amp</sub> and sag percentage <italic>S</italic> for both classes of layer-5 cell, which were instead fitted to normal distributions. Parameters of the fitted distributions are summarised in <xref ref-type="table" rid="pcbi.1004165.t002">Table 2</xref> with the exception of the log-normal distributions for <italic>E</italic><sub>mono</sub> and <italic>τ</italic><sub>mono</sub> that have mean and standard deviations (<italic>μ</italic>, <italic>σ</italic>) of (16.1, 4.8) mV and (15.1, 4.5) ms, respectively.</p>
</sec>
<sec id="sec020">
<title>Variability between and within cell classes</title>
<p>To determine the major sources of variability in the full dataset we used principal component analysis (PCA). As seen in <xref ref-type="fig" rid="pcbi.1004165.g005">Fig 5A</xref>, the first principal component (PC) explained 40% of the variance; however, no small additional number of PCs explained the remainder, with 9 components required to explain 90% of the variance.</p>
<fig id="pcbi.1004165.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004165.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Principal component analysis (PCA) of variation across the entire data set.</title>
<p><bold>A</bold> Pareto plot of the percentage of the variance explained by each principal component (black bars), and the cumulative sum of the explained variance (dark grey line). <bold>B</bold> Empirical cumulative distribution function in PC space for each class and for principal components one to four. <bold>C</bold> Contribution of each cellular parameter to the variation of the first four principal components. See main text for an interpretation of these results.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004165.g005"/>
</fig>
<p>
<xref ref-type="fig" rid="pcbi.1004165.g005">Fig 5B</xref> shows the empirical cumulative distribution functions of the first four PCs with the percentage of variance explained by each variable within each of the first four PCs provided in <xref ref-type="fig" rid="pcbi.1004165.g005">Fig 5C</xref>. From the cumulative distributions (<xref ref-type="fig" rid="pcbi.1004165.g005">Fig 5B</xref>) it can be seen that the first PC strongly discriminates between TL5 pyramidal cells and the remaining classes, with some discriminatory power for L2/3 cells. <xref ref-type="fig" rid="pcbi.1004165.g005">Fig 5C</xref> shows that PC1 is primarily determined by the steady-state properties of the cell: the subthreshold properties, distance to threshold and action-potential shape, though there is also a contribution from the the jump and depth of the post-spike sag in the resting potential arising from the h-current. The second PC weakly discriminates between pyramidal-cell classes (<xref ref-type="fig" rid="pcbi.1004165.g005">Fig 5B</xref>) and is mainly determined by an excitability measure: the spike-initiation current, which accounts for more than 20% of the variance within this PC. The third PC is determined by the spike sharpness parameter Δ<sub>T</sub> and, as for the fourth PC, the post-spike dynamics of conductance <italic>g</italic> and spike-onset threshold <italic>V</italic><sub>T</sub>. Neither PC3 or PC4 discriminates well between cell classes and so the statistics of the spike-sharpness parameter Δ<sub>T</sub>, and post-spike dynamics of <italic>g</italic> and <italic>V</italic><sub>T</sub> are common to all classes of pyramidal cell.</p>
<p>To investigate the sources of variability within a cell class we performed PCA on each class separately. The percentage of variance explained by each PC for each cell class is shown in <xref ref-type="fig" rid="pcbi.1004165.g006">Fig 6A</xref>, and the within-PC variation explained by each parameter is shown in <xref ref-type="fig" rid="pcbi.1004165.g006">Fig 6B</xref>. The PCs were significantly different for the four classes of cells with the principal sources of variability being: for L2/3 cells the action-potential amplitude and rise, and post-spike conductance parameters; for L4 cells <italic>A</italic><sub>rise</sub> and <italic>V</italic><sub>T1</sub>; for SL5 cells the action-potential shape parameters; and for TL5 cells the post-spike dynamics of the resting potential and potential difference to threshold.</p>
<fig id="pcbi.1004165.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004165.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Principal-component analysis (PCA) for the data from each pyramidal-cell population.</title>
<p><bold>A</bold> Pareto plot of the percentage of variance explained by each principal component when PCA was performed on each class individually. <bold>B</bold> Contribution of each parameter to the variation of the first four principal components for each pyramidal-cell population.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004165.g006"/>
</fig>
</sec>
<sec id="sec021">
<title>Correlations between neuronal parameters</title>
<p>To search for correlations or anti-correlations in our data we performed Spearman’s rank correlation tests on all parameter pairs. Four parameter pairs with high Spearman’s rank correlation scores are shown in <xref ref-type="fig" rid="pcbi.1004165.g007">Fig 7A</xref>. The positive correlation between conductance and capacitance (<xref ref-type="fig" rid="pcbi.1004165.g007">Fig 7B</xref>) is due to the size of the cell’s surface area and more-or-less proportional expression of conductances. The positive correlation between the spike-threshold current <italic>I</italic><sub>spike</sub> = <italic>G</italic><sub>in</sub>(<italic>V</italic><sub>T</sub> − <italic>E</italic>) and conductance (<xref ref-type="fig" rid="pcbi.1004165.g007">Fig 7C</xref>) demonstrates little compensation for cell size by decreased potential difference from rest to threshold (<italic>V</italic><sub>T</sub> − <italic>E</italic>), except for the thick-tufted layer-5 pyramidal cells that show a relatively lower required <italic>I</italic><sub>spike</sub> at higher conductances. The negative correlation between the potential difference to threshold <italic>V</italic><sub>T</sub> − <italic>E</italic> (<xref ref-type="fig" rid="pcbi.1004165.g007">Fig 7D</xref>) and resting potential <italic>E</italic> is a consequence of the weak variability in the absolute spike threshold <italic>V</italic><sub>T</sub> (<xref ref-type="fig" rid="pcbi.1004165.g004">Fig 4E</xref>), and the correlation between <italic>E</italic> and the sag percentage (<xref ref-type="fig" rid="pcbi.1004165.g007">Fig 7E</xref>) is consistent with the dual role of <italic>I</italic><sub><italic>h</italic></sub> in generating a more depolarised resting potential and the strong sag dynamics from delayed negative feedback.</p>
<fig id="pcbi.1004165.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004165.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Correlations between pairs of electrophysiological parameters.</title>
<p><bold>A</bold> Highly correlated variable pairs for each pyramidal-cell population (see colour key) and across all pyramidal cells (black). Correlations were calculated using Spearman’s rank test. As well as the correlations directly linked to size such as <bold>B</bold> conductance versus capacitance or, less directly, <bold>C</bold> the spike-threshold current versus conductance, there are <bold>D</bold> anti-correlations between the potential difference to threshold and the resting potential and <bold>E</bold> positive correlations between the sag percentage and resting potential, the latter of which is likely due to a common underlying cause such as <italic>h</italic>-current expression.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004165.g007"/>
</fig>
<p>Given the log-normality or normality of the parameters we tested whether the empirical parameter distributions (with logarithms taken of the log-normally distributed variables) were consistent with having been drawn from a multivariate Gaussian distribution using two tests (Henze-Zirkler’s and Royston’s tests). The EIF parameter sets for all layers all passed at least one test at the 5% significance level with the only parameter sets to fail both tests at 5% being the full rEIF parameter set for layer-2/3 pyramidal cells and the mono-exponential parameter sets for the post-spike response of the equilibrium potential <italic>E</italic>(<italic>t</italic>). For reference the covariance matricies for the EIF parameters are provided in <xref ref-type="table" rid="pcbi.1004165.t003">Table 3</xref> together with the Spearman’s rank correlation values. The normalised covariance matricies for the full parameter sets can be found in the script <monospace>Generate_rEIF.m</monospace> provided in the Supporting Information.</p>
<table-wrap id="pcbi.1004165.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004165.t003</object-id>
<label>Table 3</label>
<caption>
<title>Covariance (upper triangle and diagonal) and Spearman’s rank correlation (lower triangle only as diagonals would be unity) of the appropriately transformed Exponential Integrate-and-Fire model parameters log(<italic>C</italic>/pF), log(<italic>τ</italic>/ms), <italic>E</italic> (mV), <italic>V</italic><sub>T</sub> (mV) and log(Δ<sub>T</sub>/mV) for each of the four cell classes.</title>
<p>The transformed parameters have normal marginal distributions and the combined sets satisfy at least one test for multivariate normality at the 5% level (see main text). All values are given to two significant figures.</p>
</caption>
<alternatives>
<graphic id="pcbi.1004165.t003g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004165.t003"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1"/>
<th align="center" colspan="5" rowspan="1"><bold>Layer 2/3</bold></th>
<th align="center" colspan="5" rowspan="1"><bold>Layer 4</bold></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">log(<italic>C</italic>)</td>
<td align="left" rowspan="1" colspan="1">log(<italic>τ</italic>)</td>
<td align="left" rowspan="1" colspan="1"><italic>E</italic></td>
<td align="left" rowspan="1" colspan="1"><italic>V</italic><sub>T</sub></td>
<td align="left" rowspan="1" colspan="1">log(Δ<sub>T</sub>)</td>
<td align="left" rowspan="1" colspan="1">log(<italic>C</italic>)</td>
<td align="left" rowspan="1" colspan="1">log(<italic>τ</italic>)</td>
<td align="left" rowspan="1" colspan="1"><italic>E</italic></td>
<td align="left" rowspan="1" colspan="1"><italic>V</italic><sub>T</sub></td>
<td align="left" rowspan="1" colspan="1">log(Δ<sub>T</sub>)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">log(<italic>C</italic>)</td>
<td align="char" char="." rowspan="1" colspan="1">0.066</td>
<td align="char" char="." rowspan="1" colspan="1">−0.012</td>
<td align="left" rowspan="1" colspan="1">0.0047</td>
<td align="left" rowspan="1" colspan="1">−0.55</td>
<td align="char" char="." rowspan="1" colspan="1">−0.012</td>
<td align="char" char="." rowspan="1" colspan="1">0.083</td>
<td align="char" char="." rowspan="1" colspan="1">0.0078</td>
<td align="left" rowspan="1" colspan="1">0.25</td>
<td align="left" rowspan="1" colspan="1">−0.25</td>
<td align="char" char="." rowspan="1" colspan="1">−0.010</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">log(<italic>τ</italic>)</td>
<td align="char" char="." rowspan="1" colspan="1">−0.41</td>
<td align="char" char="." rowspan="1" colspan="1">0.029</td>
<td align="left" rowspan="1" colspan="1">−0.099</td>
<td align="left" rowspan="1" colspan="1">0.28</td>
<td align="char" char="." rowspan="1" colspan="1">−0.028</td>
<td align="char" char="." rowspan="1" colspan="1">0.19</td>
<td align="char" char="." rowspan="1" colspan="1">0.058</td>
<td align="left" rowspan="1" colspan="1">0.28</td>
<td align="left" rowspan="1" colspan="1">−0.0045</td>
<td align="char" char="." rowspan="1" colspan="1">−0.0066</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>E</italic></td>
<td align="char" char="." rowspan="1" colspan="1">0.11</td>
<td align="char" char="." rowspan="1" colspan="1">−0.22</td>
<td align="left" rowspan="1" colspan="1">18</td>
<td align="left" rowspan="1" colspan="1">7.8</td>
<td align="char" char="." rowspan="1" colspan="1">−0.071</td>
<td align="char" char="." rowspan="1" colspan="1">0.20</td>
<td align="char" char="." rowspan="1" colspan="1">0.067</td>
<td align="left" rowspan="1" colspan="1">18</td>
<td align="left" rowspan="1" colspan="1">5.1</td>
<td align="char" char="." rowspan="1" colspan="1">−0.38</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>V</italic><sub>T</sub></td>
<td align="char" char="." rowspan="1" colspan="1">−0.48</td>
<td align="char" char="." rowspan="1" colspan="1">0.35</td>
<td align="left" rowspan="1" colspan="1">0.38</td>
<td align="left" rowspan="1" colspan="1">15</td>
<td align="char" char="." rowspan="1" colspan="1">−0.42</td>
<td align="char" char="." rowspan="1" colspan="1">−0.14</td>
<td align="char" char="." rowspan="1" colspan="1">−0.025</td>
<td align="left" rowspan="1" colspan="1">0.29</td>
<td align="left" rowspan="1" colspan="1">12</td>
<td align="char" char="." rowspan="1" colspan="1">−0.38</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">log(Δ<sub>T</sub>)</td>
<td align="char" char="." rowspan="1" colspan="1">0.13</td>
<td align="char" char="." rowspan="1" colspan="1">−0.43</td>
<td align="left" rowspan="1" colspan="1">−0.0016</td>
<td align="left" rowspan="1" colspan="1">−0.39</td>
<td align="char" char="." rowspan="1" colspan="1">0.13</td>
<td align="char" char="." rowspan="1" colspan="1">−0.13</td>
<td align="char" char="." rowspan="1" colspan="1">−0.014</td>
<td align="left" rowspan="1" colspan="1">−0.30</td>
<td align="left" rowspan="1" colspan="1">−0.47</td>
<td align="char" char="." rowspan="1" colspan="1">0.071</td>
</tr>
<tr>
<td align="center" colspan="6" rowspan="1"><bold>Slender-tufted layer 5</bold></td>
<td align="center" colspan="5" rowspan="1"><bold>Thick-tufted layer 5</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">log(<italic>C</italic>)</td>
<td align="char" char="." rowspan="1" colspan="1">0.063</td>
<td align="char" char="." rowspan="1" colspan="1">0.022</td>
<td align="left" rowspan="1" colspan="1">0.49</td>
<td align="left" rowspan="1" colspan="1">−0.15</td>
<td align="char" char="." rowspan="1" colspan="1">−0.02</td>
<td align="char" char="." rowspan="1" colspan="1">0.075</td>
<td align="char" char="." rowspan="1" colspan="1">0.004</td>
<td align="left" rowspan="1" colspan="1">0.16</td>
<td align="left" rowspan="1" colspan="1">−0.28</td>
<td align="char" char="." rowspan="1" colspan="1">−0.021</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">log(<italic>τ</italic>)</td>
<td align="char" char="." rowspan="1" colspan="1">0.34</td>
<td align="char" char="." rowspan="1" colspan="1">0.065</td>
<td align="left" rowspan="1" colspan="1">0.28</td>
<td align="left" rowspan="1" colspan="1">−0.031</td>
<td align="char" char="." rowspan="1" colspan="1">−0.019</td>
<td align="char" char="." rowspan="1" colspan="1">0.031</td>
<td align="char" char="." rowspan="1" colspan="1">0.052</td>
<td align="left" rowspan="1" colspan="1">0.070</td>
<td align="left" rowspan="1" colspan="1">−0.0054</td>
<td align="char" char="." rowspan="1" colspan="1">−0.017</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>E</italic></td>
<td align="char" char="." rowspan="1" colspan="1">0.49</td>
<td align="char" char="." rowspan="1" colspan="1">0.14</td>
<td align="left" rowspan="1" colspan="1">17</td>
<td align="left" rowspan="1" colspan="1">5.9</td>
<td align="char" char="." rowspan="1" colspan="1">−0.65</td>
<td align="char" char="." rowspan="1" colspan="1">0.16</td>
<td align="char" char="." rowspan="1" colspan="1">0.066</td>
<td align="left" rowspan="1" colspan="1">16</td>
<td align="left" rowspan="1" colspan="1">5.3</td>
<td align="char" char="." rowspan="1" colspan="1">0.22</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>V</italic><sub>T</sub></td>
<td align="char" char="." rowspan="1" colspan="1">−0.22</td>
<td align="char" char="." rowspan="1" colspan="1">−0.086</td>
<td align="left" rowspan="1" colspan="1">0.35</td>
<td align="left" rowspan="1" colspan="1">13</td>
<td align="char" char="." rowspan="1" colspan="1">−0.18</td>
<td align="char" char="." rowspan="1" colspan="1">−0.33</td>
<td align="char" char="." rowspan="1" colspan="1">0.088</td>
<td align="left" rowspan="1" colspan="1">0.29</td>
<td align="left" rowspan="1" colspan="1">13</td>
<td align="char" char="." rowspan="1" colspan="1">0.25</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">log(Δ<sub>T</sub>)</td>
<td align="char" char="." rowspan="1" colspan="1">−0.20</td>
<td align="char" char="." rowspan="1" colspan="1">−0.21</td>
<td align="left" rowspan="1" colspan="1">−0.23</td>
<td align="left" rowspan="1" colspan="1">−0.039</td>
<td align="char" char="." rowspan="1" colspan="1">0.13</td>
<td align="char" char="." rowspan="1" colspan="1">−0.20</td>
<td align="char" char="." rowspan="1" colspan="1">−0.070</td>
<td align="left" rowspan="1" colspan="1">0.18</td>
<td align="left" rowspan="1" colspan="1">0.27</td>
<td align="char" char="." rowspan="1" colspan="1">0.13</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec022">
<title>Heterogeneous populations of model neurons</title>
<p>A central aim of this study was to provide algorithms to generate sets of neuron models with experimentally verified marginal distributions and covariance structure in their parameters. Together with this publication we provide two algorithms. The first generates parameter sets for the standard EIF model [<xref ref-type="bibr" rid="pcbi.1004165.ref035">35</xref>] comprising parameters <italic>C</italic>, <italic>E</italic>, <italic>τ</italic>, <italic>V</italic><sub>T</sub> and Δ<sub>T</sub>. The method uses a multivariate Gaussian sampler (implemented using a Gaussian copula) for the combination of logarithmed log-normally-distributed variables and normally distributed variables: the normalised covariance matricies for these quantities can be found in the MATLAB script <monospace>Generate_EIF.m</monospace> provided in the Supporting Information (<xref ref-type="supplementary-material" rid="pcbi.1004165.s001">S1 Computer Code</xref>: the covariance between the non-logarithmed variables can be found in <xref ref-type="table" rid="pcbi.1004165.t003">Table 3</xref>). A second MATLAB script <monospace>Generate_rEIF.m</monospace> also provided in the Supporting Information (<xref ref-type="supplementary-material" rid="pcbi.1004165.s002">S2 Computer Code</xref>) generates parameter sets for refractory EIF models that additionally feature the empirical post-spike dynamics seen in parameters <italic>g</italic>, <italic>V</italic><sub><italic>T</italic></sub> and <italic>E</italic>. In <xref ref-type="fig" rid="pcbi.1004165.g008">Fig 8</xref> we demonstrate our algorithms by generating 1000 parameter sets for each class of pyramidal cell. The correlation structure in the simulated data set and the marginal distributions are adhered to, for example in <italic>E</italic> vs. <italic>V</italic><sub>T</sub> − <italic>E</italic> space (<xref ref-type="fig" rid="pcbi.1004165.g008">Fig 8A</xref> top) and <italic>C</italic> vs. <italic>V</italic><sub>T</sub> − <italic>E</italic> space (<xref ref-type="fig" rid="pcbi.1004165.g008">Fig 8A</xref> bottom). Furthermore, on implementation of the associated rEIF model Eqs <xref ref-type="disp-formula" rid="pcbi.1004165.e005">(3)</xref>–<xref ref-type="disp-formula" rid="pcbi.1004165.e007">(5)</xref> the mean refractory response of <italic>g</italic>, <italic>V</italic><sub>T</sub>, and <italic>E</italic> are indistinguishable from the mean responses of the cells in our data set (<xref ref-type="fig" rid="pcbi.1004165.g008">Fig 8B</xref>).</p>
<fig id="pcbi.1004165.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004165.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Experimental data compared to the algorithm that generates parameter sets for heterogeneous populations of L2/3-L5 model neurons with correct marginal distributions and correlation structure.</title>
<p><bold>A</bold> Relationship between steady-state resting potential <italic>E</italic> and potential difference to threshold <italic>V</italic><sub>T</sub> − <italic>E</italic> (top), and capacitance <italic>C</italic> and potential difference to threshold <italic>V</italic><sub>T</sub> − <italic>E</italic> (bottom) for experimental (left) and algorithmically generated (right) datasets. <bold>B</bold> Corresponding mean response for the post-spike dynamics of <italic>g</italic>, <italic>V</italic><sub>T</sub>, and <italic>E</italic> in the experimental and algorithmically generated datasets. The artificial dataset used here comprised 1000 cells for each of the four classes.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004165.g008"/>
</fig>
</sec>
</sec>
<sec id="sec023" sec-type="conclusions">
<title>Discussion</title>
<p>From the response to square-pulse and fluctuating current stimuli, we quantified the distributions and correlations in the passive, active and spike-triggered perisomatic electrophysiological parameters in populations of pyramidal cells in layer 2/3, 4 and the slender-tufted and thick-tufted cells of layer-5 of the juvenile rat somatosensory cortex. By measuring the dynamic <italic>I-V</italic> curve we found that a forcing term <italic>F</italic>(<italic>V</italic>) of the exponential integrate-and-fire kind [<xref ref-type="bibr" rid="pcbi.1004165.ref035">35</xref>] provided an accurate fit to the somatic current-voltage relation for all classes of pyramidal cell from layers 2/3-5, extending the applicability of the EIF model from earlier studies on thick-tufted layer-5 pyramidal cells [<xref ref-type="bibr" rid="pcbi.1004165.ref032">32</xref>], fast-spiking GABAergic interneurons [<xref ref-type="bibr" rid="pcbi.1004165.ref043">43</xref>] and striatal medium spiny neurons [<xref ref-type="bibr" rid="pcbi.1004165.ref044">44</xref>].</p>
<p>Significant differences were seen in the average parameter values between pyramidal-cell populations as well as significant spreads of parameter values within each population. On average L2/3 cells had a shorter membrane time constant and more hyperpolarised membrane potential (by 10mV) than TL5 neurons, with the sag response to step-current input or an action potential (mediated by <italic>I</italic><sub><italic>h</italic></sub>) increasing from layers 2/3 to 5. As regards the excitability measures, the typical potential difference to threshold from rest <italic>V</italic><sub>T</sub> − <italic>E</italic> decreased by ∼ 15mV from L2/3 cells to TL5 cells; however, on normalization by the input resistance to give the steady current <italic>I</italic><sub><italic>spike</italic></sub> required to bring the neuron to threshold, L2/3 and TL5 cells were seen to be similarly (despite their very different size) less excitable than L4 and SL5 cells.</p>
<p>Principal component (PC) analyses demonstrated that, apart from the first component (determined by subthreshold properties, distance to threshold, action-potential shape and the h-current mediated post-spike sag response) the subsequent components did not show a clear cut-off in their contribution. The first PC provided a good discrimination for L2/3 and TL5 from the other two populations (pairwise significance testing also showed clear differences between L2/3 and TL5 cells); however, L4 and SL5 pyramidal cells were almost indistinguishable in their electrophysiology, despite being located at different cortical depths, forming distinct morphological sub-groups [<xref ref-type="bibr" rid="pcbi.1004165.ref045">45</xref>, <xref ref-type="bibr" rid="pcbi.1004165.ref046">46</xref>], and receiving input from different regions [<xref ref-type="bibr" rid="pcbi.1004165.ref047">47</xref>]. Only two of the 21 parameters, sag percentage and action potential duration (<xref ref-type="fig" rid="pcbi.1004165.g004">Fig 4</xref>), showed a significant difference for L4 and SL5 above the 5% threshold. We also provided an analysis for parameter covariability with the main non-trivial correlations arising from effects common to the <italic>h</italic> current such as depolarised threshold potential and the existence of a sag/rebound response.</p>
<sec id="sec024">
<title>Extensions</title>
<p>The majority of parameters were measured using the dynamic-<italic>I-V</italic> method [<xref ref-type="bibr" rid="pcbi.1004165.ref032">32</xref>] that extracts a clearly defined biophysical quantity (the voltage-averaged instantaneous current-voltage relationship) and uses it to construct a non-linear integrate-and-fire model that accurately captures the integration of current flowing into the soma. An attractive feature of this class of reduced neuron model is that they are amenable to mathematical network analysis [<xref ref-type="bibr" rid="pcbi.1004165.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1004165.ref048">48</xref>], which is a powerful tool for studying the general properties of neuronal networks. Empirically, the forcing term of the exponential integrate-and-fire model [<xref ref-type="bibr" rid="pcbi.1004165.ref035">35</xref>] was found to provide a good fit to the steady-state <italic>I-V</italic> curves with the post-spike <italic>I-V</italic> dynamics captured by an extension to the EIF of the refractory EIF form [<xref ref-type="bibr" rid="pcbi.1004165.ref032">32</xref>]. Given the mathematical simplicity of the rEIF (it is a renewal process in the sense that post-spike parameter changes are non-cumulative) it is surprising that it provides such an accurate fit to experimental data (see <xref ref-type="fig" rid="pcbi.1004165.g002">Fig 2</xref>). A great variety of simplified neuron models have been proposed that could also have been used as generators of voltage timecourses in this study. Our preference for the dynamic-<italic>I-V</italic> approach to model construction is that few assumptions for the structure of the model need be made, because the components are directly extracted from experiment. This approach is distinct from those where a neuronal model (whether biophysically grounded or heuristic) is chosen <italic>a-priori</italic> and then the parameters are optimised by comparing model and experimental voltage timecourses. Alternative frameworks or extensions of the rEIF model that include additional state variables to better capture the effects of voltage-gated or calcium-gated currents, cumulative spike-frequency adaptation or cumulative spike-triggered parameter changes, spike-threshold variability or morphology (using multiple sites of dendritic stimulation), should lead to models with more predictive power. However, any model that aims to accurately capture the spiking dynamics of pyramidal cells does need to account for the high post-spike threshold and reset: this is not a feature of models that have the standard integrate-and-fire spiking mechanism nor is it a feature of more detailed models that use the standard Hodgkin-Huxley spike-generating currents. To facilitate further investigation along these lines by other research groups we have provided our full data set with this publication (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.datadryad.com">www.datadryad.com</ext-link>; doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.d30k7" xlink:type="simple">10.5061/dryad.d30k7</ext-link>). Finally, in this study we restricted the measurements and analysis to pyramidal populations from layers 2/3, 4 and 5. An obvious extension of the current study would be to examine the heterogeneity in the diverse populations of layer 6 of the neocortex. The layer comprises three major pyramidal-cell classes [<xref ref-type="bibr" rid="pcbi.1004165.ref049">49</xref>] that can be divided into further morphological subgroups. Quantifying the electrophysiological properties of the different populations, using a broad-band stimulus that mimics aspects of <italic>in-vivo</italic> synaptic drive like the dynamic <italic>I-V</italic> method, would allow for the development of a useful tool for rapid on-line classification of layer-6 pyramidal cells during intracellular recording.</p>
</sec>
<sec id="sec025">
<title>Network models with heterogeneity</title>
<p>The primary outcome of this work was to provide a tool to aid the analyses of the significant levels of heterogeneity seen in neocortical pyramidal-cell populations. Our algorithms for generating artificial datasets adhere to the experimentally determined marginal distributions and correlation structure of parameter space (<xref ref-type="fig" rid="pcbi.1004165.g008">Fig 8</xref>). Coupling this work to other studies that quantify diversity in the synaptic dynamics, connectivity and topology will allow network models to be constructed in which the heterogeneities of neocortical cell populations are respected. Network analyses are beyond the scope of this paper, but it has already been demonstrated that various forms of heterogeneity can significantly affect synchrony [<xref ref-type="bibr" rid="pcbi.1004165.ref028">28</xref>], coding [<xref ref-type="bibr" rid="pcbi.1004165.ref030">30</xref>] and the neuronal gain [<xref ref-type="bibr" rid="pcbi.1004165.ref027">27</xref>] in a network context. Using the empirical statistics for parameter variability and correlation presented here will allow for a quantitative analyses of the effects of heterogeneity using reduced-models of neocortical pyramidal cells. It is hoped that such modeling will contribute to our understanding of how heterogeneity in network architecture affects processing of information in neocortical microcircuits and neuronal tissue more generally.</p>
</sec>
</sec>
<sec id="sec026">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004165.s001" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004165.s001" mimetype="text/x-m" xlink:type="simple">
<label>S1 Computer Code</label>
<caption>
<title>The MATLAB script <monospace>Generate_EIF.m</monospace> generates parameter sets for the basic exponential integrate and fire model [<xref ref-type="bibr" rid="pcbi.1004165.ref035">35</xref>] that respect the empirical marginal distributions and covariance.</title>
<p>(M)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004165.s002" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004165.s002" mimetype="text/x-m" xlink:type="simple">
<label>S2 Computer Code</label>
<caption>
<title>The MATLAB script <monospace>Generate_rEIF.m</monospace> generates parameter sets for the refractory exponential integrate and fire model [<xref ref-type="bibr" rid="pcbi.1004165.ref032">32</xref>] that respect the empirical marginal distributions and covariance.</title>
<p>(M)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004165.s003" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004165.s003" mimetype="application/zip" xlink:type="simple">
<label>S3 Computer Code and Data Files</label>
<caption>
<title>The MATLAB script <monospace>DynamicIVAnalysis.m</monospace> uses the dynamic <italic>I-V</italic> curve method [<xref ref-type="bibr" rid="pcbi.1004165.ref032">32</xref>] to extract electrophysiological parameters from four example data files (current stimulations and voltage measurements) with the file prefix <monospace>ExDynamicIVdata</monospace>.</title>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1004165.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Thomson</surname> <given-names>AM</given-names></name> and <name name-style="western"><surname>Lamy</surname> <given-names>C</given-names></name>. (<year>2007</year>) <article-title>Functional maps of neocortical local circuitry</article-title>. <source><italic>Frontiers in Neuroscience</italic></source> <volume>1</volume>: <fpage>19</fpage>–<lpage>42</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/neuro.01.1.1.002.2007" xlink:type="simple">10.3389/neuro.01.1.1.002.2007</ext-link></comment> <object-id pub-id-type="pmid">18982117</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">Markram H. (<year>2006</year>) <article-title>The Blue Brain Project</article-title>. <source><italic>Nature Reviews Neuroscience</italic></source> <volume>7</volume>: <fpage>153</fpage>–<lpage>160</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn1848" xlink:type="simple">10.1038/nrn1848</ext-link></comment> <object-id pub-id-type="pmid">16429124</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lein</surname> <given-names>ES</given-names></name>
<etal>et al</etal>. (<year>2007</year>) <article-title>Genome-wide atlas of gene expression in the adult mouse brain</article-title>.<source><italic>Nature</italic></source> <volume>445</volume>: <fpage>168</fpage>–<lpage>176</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature05453" xlink:type="simple">10.1038/nature05453</ext-link></comment> <object-id pub-id-type="pmid">17151600</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Izhikevich</surname> <given-names>EM</given-names></name> and <name name-style="western"><surname>Edelman</surname> <given-names>GM</given-names></name>. (<year>2008</year>) <article-title>Large-scale model of mammalian thalamocortical systems</article-title>. <source><italic>PNAS</italic></source> <volume>105</volume>: <fpage>3593</fpage>–<lpage>3598</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0712231105" xlink:type="simple">10.1073/pnas.0712231105</ext-link></comment> <object-id pub-id-type="pmid">18292226</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Oh</surname> <given-names>SW</given-names></name>
<etal>et al</etal>. (<year>2014</year>) <article-title>A mesoscale connectome of the mouse brain</article-title>. <source><italic>Nature</italic></source> <volume>508</volume>: <fpage>207</fpage>–<lpage>214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature13186" xlink:type="simple">10.1038/nature13186</ext-link></comment> <object-id pub-id-type="pmid">24695228</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name> and <name name-style="western"><surname>Hakim</surname> <given-names>V</given-names></name>. (<year>1999</year>) <article-title>Fast global oscillations in networks of integrate-and-fire neurons with low firing rates</article-title>. <source><italic>Neural Computation</italic></source> <volume>11</volume>: <fpage>1621</fpage>–<lpage>1671</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/089976699300016179" xlink:type="simple">10.1162/089976699300016179</ext-link></comment> <object-id pub-id-type="pmid">10490941</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Moreno-Bote</surname> <given-names>R</given-names></name> and <name name-style="western"><surname>Parga</surname> <given-names>N</given-names></name>. (<year>2004</year>) <article-title>Role of synaptic filtering on the firing response of simple model neurons</article-title>. <source><italic>Phys. Rev. Lett</italic></source>. <volume>92</volume>: art-no 028102, 2004. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.92.028102" xlink:type="simple">10.1103/PhysRevLett.92.028102</ext-link></comment> <object-id pub-id-type="pmid">14753971</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>M, Pawelzik</surname> <given-names>K</given-names></name> and <name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name>. (<year>1998</year>) <article-title>Neural networks with dynamic synapses</article-title>. <source><italic>Neural Computation</italic></source> <volume>10</volume>:<fpage>821</fpage>–<lpage>835</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/089976698300017502" xlink:type="simple">10.1162/089976698300017502</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lindner</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gangloff</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Longtin</surname> <given-names>A</given-names></name> and <name name-style="western"><surname>Lewis</surname> <given-names>JE</given-names></name>. (<year>2009</year>) <article-title>Broadband coding with dynamic synapses</article-title>. <source><italic>J. Neurosci</italic></source> <volume>29</volume>: <fpage>2076</fpage>–<lpage>2088</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3702-08.2009" xlink:type="simple">10.1523/JNEUROSCI.3702-08.2009</ext-link></comment> <object-id pub-id-type="pmid">19228961</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Richardson</surname> <given-names>MJE</given-names></name>, <name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name> and <name name-style="western"><surname>Hakim</surname> <given-names>V</given-names></name>. (<year>2003</year>) <article-title>From Subthreshold to Firing-Rate Resonance</article-title>. <source><italic>J. Neurophysiol</italic></source>. <volume>89</volume>: <fpage>2538</fpage>–<lpage>2554</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00955.2002" xlink:type="simple">10.1152/jn.00955.2002</ext-link></comment> <object-id pub-id-type="pmid">12611957</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Izhikevich</surname> <given-names>EM</given-names></name>. (<year>2003</year>) <article-title>Simple Model of Spiking Neurons</article-title>. <source><italic>IEEE Trans. Neural. Networks</italic></source> <volume>14</volume>: <fpage>1569</fpage>–<lpage>1572</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TNN.2003.820440" xlink:type="simple">10.1109/TNN.2003.820440</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Richardson</surname> <given-names>MJE</given-names></name>. (<year>2009</year>) <article-title>Dynamics of populations and networks of neurons with voltage-activated and calcium-activated currents</article-title>. <source><italic>Phys. Rev. E</italic></source> <volume>80</volume>: article-no 021928. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.80.021928" xlink:type="simple">10.1103/PhysRevE.80.021928</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gigante</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Mattia</surname> <given-names>M</given-names></name> and <name name-style="western"><surname>Del Giudice</surname> <given-names>P</given-names></name>. (<year>2007</year>) <article-title>Diverse Population-Bursting Models of Adapting Spiking Neurons</article-title> <source><italic>Phys. Rev Lett</italic></source>. <volume>98</volume>: art-no 148101. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.98.148101" xlink:type="simple">10.1103/PhysRevLett.98.148101</ext-link></comment> <object-id pub-id-type="pmid">17501315</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Schwalger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Fisch</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Benda</surname> <given-names>J</given-names></name> and <name name-style="western"><surname>Lindner</surname> <given-names>B</given-names></name>. (<year>2010</year>) <article-title>How noisy adaptation of neurons shapes interspike interval histograms and correlations</article-title>. <source><italic>PLoS Comp. Biol</italic></source>. <volume>6</volume>: <fpage>e1001026</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1001026" xlink:type="simple">10.1371/journal.pcbi.1001026</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Connors</surname> <given-names>BW</given-names></name> and <name name-style="western"><surname>Gutnick</surname> <given-names>MJ</given-names></name>. (<year>1990</year>) <article-title>Intrinsic firing patterns of diverse neocortical neurons</article-title>. <source><italic>Trends in Neurosciences</italic></source> <volume>13</volume>: <fpage>99</fpage>–<lpage>104</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0166-2236(90)90185-D" xlink:type="simple">10.1016/0166-2236(90)90185-D</ext-link></comment> <object-id pub-id-type="pmid">1691879</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Nowak</surname> <given-names>LG</given-names></name>, <name name-style="western"><surname>Azouz</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Sanchez-Vives</surname> <given-names>MV</given-names></name>, <name name-style="western"><surname>Gray</surname> <given-names>CM</given-names></name> and <name name-style="western"><surname>McCormick</surname> <given-names>DA</given-names></name>. (<year>2003</year>) <article-title>Electrophysiological Classes of Cat Primary Visual Cortical Neurons In Vivo as Revealed by Quantitative Analyses</article-title>. <source><italic>J. Neurophysiol</italic></source>. <volume>89</volume>: <fpage>1541</fpage>–<lpage>1566</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00580.2002" xlink:type="simple">10.1152/jn.00580.2002</ext-link></comment> <object-id pub-id-type="pmid">12626627</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Douglas</surname> <given-names>RJ</given-names></name> and <name name-style="western"><surname>Martin</surname> <given-names>KAC</given-names></name>. (<year>2004</year>) <article-title>Neuronal Circuits of the Neocortex</article-title>. <source><italic>Annual Review of Neuroscience</italic></source> <volume>27</volume>: <fpage>419</fpage>–<lpage>451</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev.neuro.27.070203.144152" xlink:type="simple">10.1146/annurev.neuro.27.070203.144152</ext-link></comment> <object-id pub-id-type="pmid">15217339</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Le Bé</surname> <given-names>JV</given-names></name>, <name name-style="western"><surname>Silberberg</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name> and <name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name>. (<year>2007</year>) <article-title>Morphological, electrophysiological, and synaptic properties of corticocallosal pyramidal cells in the neonatal rat neocortex</article-title>. <source><italic>Cereb. Cortex</italic></source>. <volume>17</volume>: <fpage>2204</fpage>–<lpage>2213</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/cercor/bhl127" xlink:type="simple">10.1093/cercor/bhl127</ext-link></comment> <object-id pub-id-type="pmid">17124287</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Oswald</surname> <given-names>A-MM</given-names></name> and <name name-style="western"><surname>Reyes</surname> <given-names>AD</given-names></name>. (<year>2008</year>) <article-title>Maturation of Intrinsic and Syanptic Properties of Layer 2/3 Pyramidal Neurons in Mouse Auditory Cortex</article-title>. <source><italic>J. Neurophysiol</italic></source>. <volume>99</volume>: <fpage>2998</fpage>–<lpage>3008</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.01160.2007" xlink:type="simple">10.1152/jn.01160.2007</ext-link></comment> <object-id pub-id-type="pmid">18417631</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>van Aerde IK and Feldmeyer</surname> <given-names>D</given-names></name> (<year>2013</year>) <article-title>Morphological and Physiological Characterization of Pyramidal Neuron Subtypes in Rat Medial Prefrontal Cortex</article-title>. <source><italic>Cerebral Cortex</italic></source> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/cercor/bht278" xlink:type="simple">10.1093/cercor/bht278</ext-link></comment>, 2013.</mixed-citation>
</ref>
<ref id="pcbi.1004165.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>White</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chow</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rit</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Soto-Trevio</surname> <given-names>C</given-names></name> and <name name-style="western"><surname>Kopell</surname> <given-names>N</given-names></name>. (<year>1998</year>) <article-title>Synchronization and oscillatory dynamics in heterogeneous, mutually inhibited neurons</article-title>. <source><italic>J. Comput. Neurosci</italic></source>. <volume>5</volume>:<fpage>5</fpage>–<lpage>16</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1023/A:1008841325921" xlink:type="simple">10.1023/A:1008841325921</ext-link></comment> <object-id pub-id-type="pmid">9580271</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Shamir</surname> <given-names>M</given-names></name> and <name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>. (<year>2006</year>) <article-title>Implications of Neuronal Diversity on Population Coding</article-title>. <source><italic>Neural Comput</italic></source>. <volume>18</volume>: <fpage>1951</fpage>–<lpage>1986</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.2006.18.8.1951" xlink:type="simple">10.1162/neco.2006.18.8.1951</ext-link></comment> <object-id pub-id-type="pmid">16771659</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Luccioli</surname> <given-names>S</given-names></name> and <name name-style="western"><surname>Politi</surname> <given-names>A</given-names></name>. (<year>2010</year>) <article-title>Irregular Collective Behavior of Heterogeneous Neural Networks</article-title>. <source><italic>Phys. Rev. Lett</italic></source>. <volume>105</volume>: art-no 158104. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.105.158104" xlink:type="simple">10.1103/PhysRevLett.105.158104</ext-link></comment> <object-id pub-id-type="pmid">21230943</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Alijani</surname> <given-names>AK</given-names></name> and <name name-style="western"><surname>Richardson</surname> <given-names>MJE</given-names></name>. (<year>2011</year>) <article-title>Rate-response of neurons subject to fast or frozen noise: from stochastic and homogeneous to deterministic and heterogeneous populations</article-title>. <source><italic>Phys. Rev. E</italic></source> <volume>84</volume>: article-no 011919. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.84.011919" xlink:type="simple">10.1103/PhysRevE.84.011919</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Nicola</surname> <given-names>W</given-names></name> and <name name-style="western"><surname>Campbell</surname> <given-names>SA</given-names></name>. (<year>2013</year>) <article-title>Mean-field models for heterogeneous networks of two-dimensional integrate and fire neurons</article-title>. <source><italic>Front. Comput. Neuro</italic></source>. <volume>7</volume>: article-no 184.</mixed-citation>
</ref>
<ref id="pcbi.1004165.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Yim</surname> <given-names>MY</given-names></name>, <name name-style="western"><surname>Aertsen</surname> <given-names>A</given-names></name> and <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>. (<year>2013</year>) <article-title>Impact of intrinsic biophysical diversity on the activity of spiking neurons</article-title>. <source><italic>Phys. Rev. E</italic></source> <volume>87</volume>: art-no 032710. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.87.032710" xlink:type="simple">10.1103/PhysRevE.87.032710</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mejias JF and Longtin</surname> <given-names>A</given-names></name> (<year>2014</year>) <article-title>Differential effects of excitatory and inhibitory heterogeneity on the gain and asynchronous state of sparse cortical networks</article-title>. <source><italic>Front. Comput. Neurosci</italic></source>. <volume>8</volume>: art-no 107.</mixed-citation>
</ref>
<ref id="pcbi.1004165.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Maex</surname> <given-names>R</given-names></name> and <name name-style="western"><surname>De Schutter</surname> <given-names>E</given-names></name>. (<year>2003</year>) <article-title>Resonant Synchronization in Heterogeneous Networks of Inhibitory Neurons</article-title>. <source><italic>J. Neurosci</italic></source>. <volume>23</volume>: <fpage>10503</fpage>–<lpage>10514</lpage>. <object-id pub-id-type="pmid">14627634</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref029">
<label>29</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hunsberger</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Scott</surname> <given-names>M</given-names></name> and <name name-style="western"><surname>Eliasmith</surname> <given-names>C</given-names></name>. (<year>2014</year>) <article-title>The Competing Benefits of Noise and Heterogeneity in Neural Coding</article-title>. <source><italic>Neural. Comput</italic></source> <volume>26</volume>: <fpage>1600</fpage>–<lpage>1623</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00621" xlink:type="simple">10.1162/NECO_a_00621</ext-link></comment> <object-id pub-id-type="pmid">24877735</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref030">
<label>30</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Chelaru MI and Dragoi</surname> <given-names>V</given-names></name> (<year>2008</year>) <article-title>Efficient coding in heterogeneous neuronal populations</article-title>. <source><italic>Proc. Natl. Acad. Sci. USA</italic></source> <volume>105</volume>: <fpage>16344</fpage>–<lpage>16349</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0807744105" xlink:type="simple">10.1073/pnas.0807744105</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref031">
<label>31</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Padmanabhan</surname> <given-names>K</given-names></name> and <name name-style="western"><surname>Urban</surname> <given-names>NN</given-names></name>. (<year>2010</year>) <article-title>Intrinsic biophysical diversity decorrelates neuronal firing while increasing information content</article-title>. <source><italic>Nat Neurosci</italic></source> <volume>13</volume>: <fpage>1276</fpage>–<lpage>1282</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2630" xlink:type="simple">10.1038/nn.2630</ext-link></comment> <object-id pub-id-type="pmid">20802489</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref032">
<label>32</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Badel</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Lefort</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Brette</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Petersen</surname> <given-names>CCH</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name> and <name name-style="western"><surname>Richardson</surname> <given-names>MJE</given-names></name>. (<year>2008</year>) <article-title>Dynamic I-V curves are reliable predictors of naturalistic pyramidal-neuron voltage traces</article-title>. <source><italic>J. Neurophysiol</italic></source>. <volume>99</volume>: <fpage>656</fpage>–<lpage>666</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.01107.2007" xlink:type="simple">10.1152/jn.01107.2007</ext-link></comment> <object-id pub-id-type="pmid">18057107</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref033">
<label>33</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Brette</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Piwkowksa</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Monier</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rudolph-Lilith</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fournier</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Levy</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Frégnac</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bal</surname> <given-names>T</given-names></name> and <name name-style="western"><surname>Destexhe</surname> <given-names>A</given-names></name>. (<year>2008</year>) <article-title>High-Resolution Intracellular Recordings Using a Real-Time Computational Model of the Electrode</article-title>. <source><italic>Neuron</italic></source> <volume>59</volume>: <fpage>379</fpage>–<lpage>391</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2008.06.021" xlink:type="simple">10.1016/j.neuron.2008.06.021</ext-link></comment> <object-id pub-id-type="pmid">18701064</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref034">
<label>34</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Harris</surname> <given-names>NC</given-names></name> and <name name-style="western"><surname>Constanti</surname> <given-names>A</given-names></name>. (<year>1995</year>) <article-title>Mechanism of block ZD 7288 of the hyperpolarization-activated inward rectifying currents in guinea pig substantia nigra neurons in vitro</article-title>. <source><italic>J. Neurophysiol</italic></source>. <volume>74</volume>: <fpage>2366</fpage>–<lpage>2378</lpage>. <object-id pub-id-type="pmid">8747199</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref035">
<label>35</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Fourcaud-Trocmé</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Hansel</surname> <given-names>D</given-names></name>, van Vreeswijk C and Brunel N. (<year>2003</year>) <article-title>How spike generation mechanisms determine the neuronal response to fluctuating inputs</article-title>. <source><italic>J. Neurosci</italic></source>. <volume>23</volume>: <fpage>11628</fpage>–<lpage>11640</lpage>. <object-id pub-id-type="pmid">14684865</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref036">
<label>36</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Sekerli</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Del Negro</surname> <given-names>CA</given-names></name>, Lee RH and Bultera RJ. (<year>2004</year>) <article-title>Estimating action potential thresholds from neuronal time-series: new metrics and evaluation of methodologies</article-title>. <source><italic>IEEE transactions on bio-medical engineering</italic></source> <volume>51</volume>: <fpage>1665</fpage>–<lpage>1672</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TBME.2004.827531" xlink:type="simple">10.1109/TBME.2004.827531</ext-link></comment> <object-id pub-id-type="pmid">15376515</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref037">
<label>37</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kistler</surname> <given-names>WM</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name> and <name name-style="western"><surname>van Hemmen</surname> <given-names>JL</given-names></name>. (<year>1997</year>) <article-title>Reduction of the Hodgkin-Huxley equations to a single-variable threshold model</article-title>. <source><italic>Neural Computation</italic></source> <volume>9</volume>: <fpage>1015</fpage>–<lpage>1045</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.1997.9.5.1015" xlink:type="simple">10.1162/neco.1997.9.5.1015</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref038">
<label>38</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jolivet</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Lewis</surname> <given-names>TJ</given-names></name> and <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. (<year>2004</year>) <article-title>Generalized integrate-and-fire models of neuronal activity approximate spike trains of a detailed model to a high degree of accuracy</article-title>. <source><italic>Journal of Neurophysiology</italic></source> <volume>92</volume>: <fpage>959</fpage>–<lpage>976</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00190.2004" xlink:type="simple">10.1152/jn.00190.2004</ext-link></comment> <object-id pub-id-type="pmid">15277599</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref039">
<label>39</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Naundorf</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Wolf</surname> <given-names>F</given-names></name> and <name name-style="western"><surname>Volgushev</surname> <given-names>M</given-names></name>. (<year>2006</year>) <article-title>Unique features of action potential initiation in cortical neurons</article-title>. <source><italic>Nature</italic></source> <volume>440</volume>: <fpage>1060</fpage>–<lpage>1063</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature04610" xlink:type="simple">10.1038/nature04610</ext-link></comment> <object-id pub-id-type="pmid">16625198</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref040">
<label>40</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Platkiewicz</surname> <given-names>J</given-names></name> and <lpage>Brette R</lpage>. (<year>2011</year>) <article-title>Impact of Fast Sodium Channel Inactivation on Spike Threshold Dynamics and Synaptic Integration</article-title>. <source><italic>PLoS Comput. Biol</italic></source>. <volume>7</volume>: <fpage>e1001129</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1001129" xlink:type="simple">10.1371/journal.pcbi.1001129</ext-link></comment> <object-id pub-id-type="pmid">21573200</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref041">
<label>41</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Fontaine</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Peña</surname> <given-names>JL</given-names></name> and <name name-style="western"><surname>Brette</surname> <given-names>R</given-names></name>. (<year>2014</year>) <article-title>Spike-Threshold Adaptation Predicted by Membrane Potential Dynamics In Vivo</article-title>. <source><italic>PLoS Comput. Biol</italic></source>. <volume>10</volume>: <fpage>e1003560</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003560" xlink:type="simple">10.1371/journal.pcbi.1003560</ext-link></comment> <object-id pub-id-type="pmid">24722397</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref042">
<label>42</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Biel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wahl-Schott</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Michalakis S and Zong</surname> <given-names>X</given-names></name> (<year>2009</year>) <article-title>Hyperpolarization-Activated Cation Channels: From Genes to Function</article-title>. <source><italic>Physiological Reviews</italic></source>. <volume>89</volume>: <fpage>847</fpage>–<lpage>885</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/physrev.00029.2008" xlink:type="simple">10.1152/physrev.00029.2008</ext-link></comment> <object-id pub-id-type="pmid">19584315</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref043">
<label>43</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Badel</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Lefort</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Berger</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Petersen</surname> <given-names>CCH</given-names></name>, <name name-style="western"><surname>Gerstner W and Richardson</surname> <given-names>MJE</given-names></name> (<year>2008</year>) <article-title>Extracting nonlinear integrate-and-fire models from experimental data using dynamic I-V curves</article-title>. <source><italic>Biological Cybernetics</italic></source>. <volume>99</volume>: <fpage>361</fpage>–<lpage>370</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00422-008-0259-4" xlink:type="simple">10.1007/s00422-008-0259-4</ext-link></comment> <object-id pub-id-type="pmid">19011924</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref044">
<label>44</label>
<mixed-citation xlink:type="simple" publication-type="other">Dorst, M. (2014) Electrophysiological characterization of striatal neurons through dynamic I-V curves. <italic>Masters Thesis</italic> Royal Institute of Technology and the Karolinska Institute, Sweden.</mixed-citation>
</ref>
<ref id="pcbi.1004165.ref045">
<label>45</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Oberlaender</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>de Kock</surname> <given-names>CPJ</given-names></name>, <name name-style="western"><surname>Bruno</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Ramirez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Meyer</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Dercksen</surname> <given-names>VJ</given-names></name>, <name name-style="western"><surname>Helmstaedter</surname> <given-names>M</given-names></name> and <name name-style="western"><surname>Sakmann</surname> <given-names>B</given-names></name>. (<year>2012</year>) <article-title>Cell Type-Specific Three-Dimensional Structure of Thalamocortical Circuits in a Column of Rat Vibrissal Cortex</article-title>. <source><italic>Cerebral Cortex</italic></source>. <volume>22</volume>: <fpage>2375</fpage>–<lpage>2391</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/cercor/bhr317" xlink:type="simple">10.1093/cercor/bhr317</ext-link></comment> <object-id pub-id-type="pmid">22089425</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref046">
<label>46</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Staiger</surname> <given-names>JF</given-names></name>. (<year>2004</year>) <article-title>Functional Diversity of Layer IV Spiny Neurons in Rat Somatosensory Cortex: Quantitative Morphology of Electrophysiologically Characterized and Biocytin Labeled Cells</article-title>. <source><italic>Cerebral Cortex</italic></source> <volume>14</volume>: <fpage>690</fpage>–<lpage>701</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/cercor/bhh029" xlink:type="simple">10.1093/cercor/bhh029</ext-link></comment> <object-id pub-id-type="pmid">15054049</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref047">
<label>47</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>de Kock</surname> <given-names>CPJ</given-names></name>, <name name-style="western"><surname>Bruno</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Spors</surname> <given-names>H</given-names></name> and <name name-style="western"><surname>Sakmann</surname> <given-names>B</given-names></name>. (<year>2007</year>) <article-title>Layer- and cell-type-specific suprathreshold stimulus representation in rat primary somatosensory cortex</article-title>. <source><italic>Journal of Physiology</italic></source> <volume>581</volume>: <fpage>139</fpage>–<lpage>154</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1113/jphysiol.2006.124321" xlink:type="simple">10.1113/jphysiol.2006.124321</ext-link></comment> <object-id pub-id-type="pmid">17317752</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref048">
<label>48</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Richardson</surname> <given-names>MJE</given-names></name>. (<year>2007</year>) <article-title>Firing-rate response of linear and non-linear integrate-and-fire neurons to modulated current-based and conductance-based synaptic drive</article-title>. <source><italic>Phys. Rev. E</italic></source> <volume>76</volume>: article-no 021919. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.76.021919" xlink:type="simple">10.1103/PhysRevE.76.021919</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004165.ref049">
<label>49</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Thomson</surname> <given-names>AM</given-names></name>. (<year>2010</year>) <article-title>Neocortical layer 6, a review</article-title>. <source><italic>Frontiers in Neuroanatomy</italic></source> <volume>4</volume>: article-13. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fnana.2010.00013" xlink:type="simple">10.3389/fnana.2010.00013</ext-link></comment> <object-id pub-id-type="pmid">20556241</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>