<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1007127</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01538</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Network analysis</subject><subj-group><subject>Metabolic networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Metabolism</subject><subj-group><subject>Oxygen metabolism</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical compounds</subject><subj-group><subject>Organic compounds</subject><subj-group><subject>Carbohydrates</subject><subj-group><subject>Monosaccharides</subject><subj-group><subject>Glucose</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Organic chemistry</subject><subj-group><subject>Organic compounds</subject><subj-group><subject>Carbohydrates</subject><subj-group><subject>Monosaccharides</subject><subj-group><subject>Glucose</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical elements</subject><subj-group><subject>Oxygen</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Bacteria</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pathology and laboratory medicine</subject><subj-group><subject>Pathogens</subject><subj-group><subject>Virulence factors</subject><subj-group><subject>Pathogen motility</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Metabolism</subject><subj-group><subject>Carbohydrate metabolism</subject><subj-group><subject>Glucose metabolism</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Modeling metabolic networks of individual bacterial agents in heterogeneous and dynamic soil habitats (IndiMeSH)</article-title>
<alt-title alt-title-type="running-head">Modeling metabolic networks of individual bacterial agents in soil habitats</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1801-1088</contrib-id>
<name name-style="western">
<surname>Borer</surname>
<given-names>Benedict</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7942-9226</contrib-id>
<name name-style="western">
<surname>Ataman</surname>
<given-names>Meriç</given-names>
</name>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Hatzimanikatis</surname>
<given-names>Vassily</given-names>
</name>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Or</surname>
<given-names>Dani</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Environmental Systems Science, ETH Zurich, Zurich, Switzerland</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Laboratory of Computational Systems Biotechnology, EPFL, Lausanne, Switzerland</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Reed</surname>
<given-names>Jennifer L.</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Wisconsin-Madison, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">benedict.borer@usys.ethz.ch</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>19</day>
<month>6</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="collection">
<month>6</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>6</issue>
<elocation-id>e1007127</elocation-id>
<history>
<date date-type="received">
<day>5</day>
<month>9</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>23</day>
<month>5</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Borer et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1007127"/>
<abstract>
<p>Natural soil is characterized as a complex habitat with patchy hydrated islands and spatially variable nutrients that is in a constant state of change due to wetting-drying dynamics. Soil microbial activity is often concentrated in sparsely distributed hotspots that contribute disproportionally to macroscopic biogeochemical nutrient cycling and greenhouse gas emissions. The mechanistic representation of such dynamic hotspots requires new modeling approaches capable of representing the interplay between dynamic local conditions and the versatile microbial metabolic adaptations. We have developed IndiMeSH (Individual-based Metabolic network model for Soil Habitats) as a spatially explicit model for the physical and chemical microenvironments of soil, combined with an individual-based representation of bacterial motility and growth using adaptive metabolic networks. The model uses angular pore networks and a physically based description of the aqueous phase as a backbone for nutrient diffusion and bacterial dispersal combined with dynamic flux balance analysis to calculate growth rates depending on local nutrient conditions. To maximize computational efficiency, reduced scale metabolic networks are used for the simulation scenarios and evaluated strategically to the genome scale model. IndiMeSH was compared to a well-established population-based spatiotemporal metabolic network model (COMETS) and to experimental data of bacterial spatial organization in pore networks mimicking soil aggregates. IndiMeSH was then used to strategically study dynamic response of a bacterial community to abrupt environmental perturbations and the influence of habitat geometry and hydration conditions. Results illustrate that IndiMeSH is capable of representing trophic interactions among bacterial species, predicting the spatial organization and segregation of bacterial populations due to oxygen and carbon gradients, and provides insights into dynamic community responses as a consequence of environmental changes. The modular design of IndiMeSH and its implementation are adaptable, allowing it to represent a wide variety of experimental and <italic>in silico</italic> microbial systems.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Soil bacterial communities are key players in global biogeochemical cycles and drive other soil regulatory and provisional ecosystem functions. Despite the relatively high bacterial abundance found in fertile soil, bacteria occupy only a small fraction of the soil surfaces and often form hotspots with disproportionate contributions to observed biogenic fluxes. As soil opacity and complexity limit detailed observations of such hotspots <italic>in situ</italic>, we have developed a modeling platform, IndiMeSH (Individual-based Metabolic network model for Soil Habitats), to enable systematic study of dense multispecies bacterial communities within a structured habitat resembling (but not limited) to soil. The model is capable of representing multispecies trophic interactions and spatial self-organization in response to nutrient gradients, as confirmed in comparison with published results. IndiMeSH offers new opportunities for quantifying bacterial hotspot formation and dynamics and observe their resilience and response to perturbations in hydration and nutrient conditions.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100010663</institution-id>
<institution>H2020 European Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>ERC-3200499-SoilLife</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Or</surname>
<given-names>Dani</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>SystemsX</institution>
</funding-source>
<award-id>RTD SystemsX.ch project MicroscapesX</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Or</surname>
<given-names>Dani</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution>SystemsX</institution>
</funding-source>
<award-id>RTD SystemsX.ch project MicroscapesX</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Hatzimanikatis</surname>
<given-names>Vassily</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>Financial support for this work came from an Advanced Grant to DO by the European Research Council (ERC-3200499-‘SoilLife’) (<ext-link ext-link-type="uri" xlink:href="https://erc.europa.eu/" xlink:type="simple">https://erc.europa.eu/</ext-link>) and from the RTD SystemsX.ch project ‘MicroscapesX’ to DO and VH (<ext-link ext-link-type="uri" xlink:href="http://www.systemsx.ch" xlink:type="simple">http://www.systemsx.ch</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="2"/>
<page-count count="21"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the manuscript and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Soil hosts the greatest diversity and abundance of microbial life in all of the biosphere, with over 10<sup>9</sup> cells per gram of soil [<xref ref-type="bibr" rid="pcbi.1007127.ref001">1</xref>] expressing thousands to millions of different operational taxonomic units in small volumes [<xref ref-type="bibr" rid="pcbi.1007127.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1007127.ref003">3</xref>]. Nonetheless, considering the vast surface area per volume of a typical soil, bacterial cells are sparsely distributed within the soil matrix, covering less than 1% of the total available soil surface [<xref ref-type="bibr" rid="pcbi.1007127.ref004">4</xref>,<xref ref-type="bibr" rid="pcbi.1007127.ref005">5</xref>]. This highly non-uniform distribution is further reinforced by localized resource distribution giving rise to microbial hotspots, such as in soil aggregates, the rhizosphere, biopores or the detritusphere [<xref ref-type="bibr" rid="pcbi.1007127.ref006">6</xref>]. These hotspots are important for large-scale biogeochemical cycles of carbon and nitrogen and for the emission of greenhouse gases [<xref ref-type="bibr" rid="pcbi.1007127.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1007127.ref009">9</xref>]. Improved prediction of soil ecological functioning mediated by bacterial processes requires better understanding of how these bacterial hotspots function and their response to dynamic conditions and integrated influence on large-scale processes.</p>
<p>In addition to its inherent complexity, soil opacity limits direct visualization of bacterial distribution within soil [<xref ref-type="bibr" rid="pcbi.1007127.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1007127.ref011">11</xref>]. Although the use of soil thin sections and artificial micrometric pore networks offers insights into spatial quantification of bacterial distributions and self-organization [<xref ref-type="bibr" rid="pcbi.1007127.ref012">12</xref>,<xref ref-type="bibr" rid="pcbi.1007127.ref013">13</xref>], the simultaneous acquisition of the dynamic chemical landscape is not yet resolvable. Mechanistic models are capable of bridging some of the experimental gaps and facilitate systematic studies of the interplay of physical, chemical and biological factors and their spatiotemporal interactions. Individual-based models (IBM) have gained in popularity owing to their local scale and cell-level representation of interactions, which offer a useful platform for prediction of emergent spatial patterns and population abundances arising from microscale interactions. IBMs have been used to investigate a range of questions in microbial ecology such as altruism in biofilms [<xref ref-type="bibr" rid="pcbi.1007127.ref014">14</xref>], the influence of metabolic switching on biofilm structure [<xref ref-type="bibr" rid="pcbi.1007127.ref015">15</xref>], bacterial coexistence due to hydration dynamics [<xref ref-type="bibr" rid="pcbi.1007127.ref016">16</xref>], bacterial spatial organization in soil aggregates [<xref ref-type="bibr" rid="pcbi.1007127.ref017">17</xref>], and the dynamics of bacterial community diversity in desert soils [<xref ref-type="bibr" rid="pcbi.1007127.ref018">18</xref>]. A common feature of IBM models is the estimation of individual bacterial growth rates and nutrient consumption based on simple growth kinetics (e.g. Monod kinetics) with empirically prescribed stoichiometric parameters. A flexible approach to calculating bacterial cell response to local conditions and potential switching of metabolic strategies became available with the solution of metabolic networks that make no prior assumptions about growth rates [<xref ref-type="bibr" rid="pcbi.1007127.ref019">19</xref>].</p>
<p>New approaches using spatiotemporal metabolic modeling with genome-scale metabolic networks enable quantification of cell growth rates, and the associated uptake of nutrients and excretion of intermediate (by-product) metabolites. Such approaches have been used to create biofilm models through an extension of Matlab with NetLogo named MatNet [<xref ref-type="bibr" rid="pcbi.1007127.ref020">20</xref>], a population-based model of trophically interacting bacterial communities [<xref ref-type="bibr" rid="pcbi.1007127.ref021">21</xref>], an extension of the MatNet approach to include multispecies communities [<xref ref-type="bibr" rid="pcbi.1007127.ref022">22</xref>], as well as to investigate bacterial intra-colony nutrient heterogeneities [<xref ref-type="bibr" rid="pcbi.1007127.ref023">23</xref>]. Common to these modeling approaches is their ability to describe trophic dependencies of microbial species that automatically adapt to spatially and temporally varying nutrient conditions. However, all of the above-mentioned spatiotemporal metabolic models employ basic and unresolved representations of the physical microbial habitats that are considerably simpler than conditions in soil. To realistically simulate bacterial life in complex and partially saturated habitats, such as those found in soil, a description of the physical (pore spaces and surfaces) and characteristics of the aqueous habitats with the resulting diffusion fields is essential [<xref ref-type="bibr" rid="pcbi.1007127.ref005">5</xref>].</p>
<p>In this study, we developed and tested a new type of spatiotemporal metabolic model that assigns metabolic networks to individual agents capable of chemotactic motion within spatially resolved soil habitats. The physical domain is comprised of angular pore networks representing soil pores. The hydration conditions are imposed by a prescribed matric potential that interacts with the physical domain and results in aqueous phase configurations similar to those expected in soil (with dual occupancy of the liquid and gas phases in angular pores). The matric potential is a component of the total soil water potential attributed to capillary and adsorptive forces between water and the soil solid matrix, with values ranging from 0 for saturated soil to large negative as the soil dries (often expressed as negative pressure). The physical domain including the water phase serve as a backbone for numerical diffusion of nutrients and intermediate metabolites, with explicit account of diffusive bottlenecks for oxygen when pores are saturated or for nutrient diffusion in unsaturated soil, whilst maintaining connectivity of the aqueous phase throughout the simulated domain. Finally, bacterial cells are represented as individual agents with the ability to autonomously move and disperse, intercept nutrients and grow at rates determined by local (often spatially variable) nutrient conditions owing to the integration of metabolic networks. The model is compared to predictions obtained from a previously published population-based spatiotemporal metabolic network [<xref ref-type="bibr" rid="pcbi.1007127.ref021">21</xref>] and to bacterial spatial segregation observations from experimental data and simulation results from a previous IBM [<xref ref-type="bibr" rid="pcbi.1007127.ref013">13</xref>]. Additionally, the model was used to mimic experiments of glucose perfusion in soil aggregates [<xref ref-type="bibr" rid="pcbi.1007127.ref024">24</xref>] and strategically to highlight the influence of pore size distributions under wet and dry conditions with contrasting results–a primary distinction between IndiMeSH and other spatiotemporal metabolic network models.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<p>The purpose of IndiMeSH is to quantify interactions among individual bacterial agents and their immediate environment within a realistic depiction of soil domains and unsaturated conditions. Specifically, we selected bacterial life in pseudo two-dimensional pore networks to mimic processes in cross-sections of soil aggregates and on other soil hydrated rough surfaces. We employ flux balance analysis (FBA) [<xref ref-type="bibr" rid="pcbi.1007127.ref025">25</xref>] to calculate local nutrient consumption and growth rates along with by-product formation of the motile bacterial agents within the pore network. The heterogeneous nutrient diffusion field and local trophic strategies (consumption and excretion) activate the multifaceted metabolic capabilities of the soil bacterial species under consideration; a conceptual representation of the model is depicted in <xref ref-type="fig" rid="pcbi.1007127.g001">Fig 1</xref>. The model contains four domains: a physical domain containing the actual pore structure and network topology, a (micro)hydrological domain to represent pore water state and properties, a chemical domain simulating nutrient concentrations and diffusion, and a biological domain containing bacterial species traits and properties of individual bacterial agents. These components are described in more detail below. The model is written in the Matlab programming language, computationally optimized to run on laptops and has been developed for users with limited to no programming background.</p>
<fig id="pcbi.1007127.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007127.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Conceptual image of IndiMeSH model components and methods.</title>
<p><bold>a)</bold> IndiMeSH uses two-dimensional angular pore networks representing soil cross-sections (here a soil aggregate) as a backbone for the aqueous phase configuration, chemical diffusion and as a habitat for bacteria represented as individual agents. Angular pores enable dual occupancy of both the water and gas phase within individual pores. Growth and nutrient consumption is calculated using metabolic networks, which enables the triggering of fundamentally different growth strategies depending on local nutrient and redox conditions. b) For the same pore network, aqueous phase configuration governed by the matric potential (wet and dry conditions) determines the connectivity and thus bacterial dispersal opportunities as well as nutrient diffusion characteristics by limiting water films held within the angular pores.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007127.g001" xlink:type="simple"/>
</fig>
<sec id="sec003">
<title>The physical domain: Pore network topology and individual pore architecture</title>
<p>A pseudo two-dimensional pore network composed of interlinked pores connected by nodes forming a lattice defines the spatial component of the model. The coordination number expresses the number of pores connected to each node within the lattice (e.g. 4 for a chessboard, 6 for a honeycomb). Each pore has an angular cross-sectional area represented by either isosceles triangles [<xref ref-type="bibr" rid="pcbi.1007127.ref017">17</xref>] or rectangles (when used to represent microfluidic networks [<xref ref-type="bibr" rid="pcbi.1007127.ref013">13</xref>]). Angular pores were selected due to their ability to simultaneously have liquid and gas phases under unsaturated conditions, an attribute not possible within cylindrical pores [<xref ref-type="bibr" rid="pcbi.1007127.ref026">26</xref>]. Different pore sizes are included by varying the inscribed circle radius of each individual pore (for example taken from a lognormal distribution to represent soil pores [<xref ref-type="bibr" rid="pcbi.1007127.ref017">17</xref>]). The geometry of the triangle was determined by varying the central angle of the isosceles triangle. For rectangular pores, the width and height can be defined for each individual pore (more detail is provided in [<xref ref-type="bibr" rid="pcbi.1007127.ref017">17</xref>] and [<xref ref-type="bibr" rid="pcbi.1007127.ref013">13</xref>]). A visual representation of parameters determining pore geometry is provided in <xref ref-type="supplementary-material" rid="pcbi.1007127.s001">S1 Fig</xref>.</p>
</sec>
<sec id="sec004">
<title>The hydrological domain: Water saturation and film thickness</title>
<p>An important aspect of the model is its ability to represent different hydration conditions using the energy state of water or the matric potential. The matric potential determines the aqueous phase configuration (amount retained in the pores and connectivity), hence it also shapes the nutrient diffusional landscape and constrains bacterial dispersal ranges. The water-filled cross-sectional area in each pore is calculated from the matric potential and geometrical considerations [<xref ref-type="bibr" rid="pcbi.1007127.ref027">27</xref>] as shown in <xref ref-type="disp-formula" rid="pcbi.1007127.e001">Eq 1</xref>. Here A<sub>w</sub> is the water filled cross-sectional area (m<sup>2</sup>), A<sub>t</sub> the total cross-section area of the pore (m<sup>2</sup>), Ψ the matric potential (Pa), σ the water surface tension (Nm<sup>-1</sup>) and γ<sub>i</sub> the angle i within the corner of the angular pore.</p>
<disp-formula id="pcbi.1007127.e001">
<alternatives>
<graphic id="pcbi.1007127.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007127.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>*</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">tan</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>π</mml:mi><mml:mo>(</mml:mo><mml:mn>180</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>360</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="12em"/><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
<p>Pores are considered unsaturated whenever an air phase is present, specifically, when a continuous connection of unsaturated pores is available from a liquid-air interface at the boundary to the pore under consideration. We note that the water-filled cross-sectional area of a pore defines available pathways for nutrient diffusion and for the calculation of total nutrient storage in each pore (depending on pore size, length, and local nutrient concentration). An important parameter of the aqueous phase in each pore is the effective water film thickness defined as the diameter of the largest sphere fully inscribed between the liquid-air interface and the pore wall [<xref ref-type="bibr" rid="pcbi.1007127.ref028">28</xref>] and calculated using <xref ref-type="disp-formula" rid="pcbi.1007127.e002">Eq 2</xref>. Here, WFT is the water film thickness defined as the smallest radius of an inscribed circle between the liquid-air interface and the pore wall (m), Ψ the matric potential (Pa), σ the water surface tension (Nm<sup>-1</sup>) and γ<sup>i</sup> the angle within the corner under consideration of the angular pore.</p>
<disp-formula id="pcbi.1007127.e002">
<alternatives>
<graphic id="pcbi.1007127.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007127.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mi>W</mml:mi><mml:mi>F</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>*</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>*</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
<p>The water film thickness affects the speed and range of bacterial motility, as further described below. Of particular importance is the fact that different angular pore geometries (e.g., pores with obtuse angles) may retain water films that are too thin to support bacterial flagellated motion, hence, disconnect this bond from other parts of the network in terms of cell dispersion [<xref ref-type="bibr" rid="pcbi.1007127.ref029">29</xref>]. Despite considerable simplifications compared to natural pore networks, this formulation of physical pore network architecture and associated water configurations retains the salient features of the soil aqueous phase, such as continuity of liquid pathways for nutrient diffusion and cell dispersion and dual occupancy of the liquid and gas phases within angular pores.</p>
</sec>
<sec id="sec005">
<title>The chemical domain: Nutrient diffusion and boundary conditions</title>
<p>Diffusive fluxes of dissolved substrates within the aqueous phase are described by Fick’s law and are evaluated between nodes subject to mass balance at the nodes, as given by:
<disp-formula id="pcbi.1007127.e003">
<alternatives>
<graphic id="pcbi.1007127.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007127.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mi>D</mml:mi><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>∂</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mi>R</mml:mi>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
where C is the substrate concentration (M), D the diffusion coefficient in water (m<sup>2</sup>s<sup>-1</sup>), A<sub>w</sub> the liquid cross-sectional area (m<sup>2</sup>), V<sub>w</sub> the volume of water attributed to the node (m<sup>3</sup>), x the spatial coordinate along pores (m), and R a sink term (mols<sup>-1</sup>) attributed to the combined consumption of individual bacterial cells. The volume at each node is calculated using <xref ref-type="disp-formula" rid="pcbi.1007127.e004">Eq 4</xref> where V<sub>w</sub> the volume of water attributed to the node (m<sup>3</sup>), A<sub>w</sub> the liquid cross-sectional area of connected pore j (m<sup>2</sup>), L<sub>j</sub> the length of the connected pore j (m) and d the degree of the node.</p>
<disp-formula id="pcbi.1007127.e004">
<alternatives>
<graphic id="pcbi.1007127.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007127.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
<p>Liquid films of pores sharing the same node are assumed to be continuous. Neglecting bacterial consumption, which is calculated separately using FBA, <xref ref-type="disp-formula" rid="pcbi.1007127.e001">Eq 1</xref> is solved numerically using an implicit scheme. Nutrient sources are represented by fixed concentration boundaries (e.g. calculated maximum saturation for oxygen using Henry’s law). Consumption and production of nutrients is calculated as the sum of contributions from individual bacterial cells and subtracted from the local nutrient content before calculation of diffusion.</p>
</sec>
<sec id="sec006">
<title>The biological domain: Bacterial dispersal, local growth and nutrient consumption</title>
<p>Bacteria are represented as individual agents capable of dispersing (by motility when the aqueous film thickness permits) within the pore network, intercepting nutrients and growing according to locally available nutrient conditions. Bacterial cells respond locally and independently with no knowledge of global system properties such as concentration fields or bacterial density even at the nearest pore. Thus, global phenomena such as exponential population growth, spatial organization of bacterial species or diffusion fields due to bacterial consumption are emergent properties based on the local interactions of individual agents with their immediate chemical and physical surroundings. Bacterial cells divide when they reach a prescribed mass at division; they may be removed from the simulation if they deplete internal energy and reach a critical biomass [<xref ref-type="bibr" rid="pcbi.1007127.ref030">30</xref>].</p>
<sec id="sec007">
<title>Bacterial growth and nutrient consumption</title>
<p>We employ dynamic Flux Balance Analysis (dFBA) to quantify growth of bacterial species depending on their physiological traits and local nutrient concentrations [<xref ref-type="bibr" rid="pcbi.1007127.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1007127.ref023">23</xref>,<xref ref-type="bibr" rid="pcbi.1007127.ref031">31</xref>]. In this study, we have not included intra-species variations, a simplification that enables bacterial biomass to be integrated at each pore. Therefore, we solve the dFBA for each node instead of for each individual bacterial cell, resulting in a significant improvement in computational efficiency. Nutrient uptake rates at each node are calculated based on local concentrations, the volume of water and bacterial biomass. Uptake rates are constrained to the maximum rate specified for each species and specific substrate based on literature values (details stated in <xref ref-type="supplementary-material" rid="pcbi.1007127.s005">S1 Table</xref>). Growth rates predicted by FBA are used to calculate the biomass gain for each individual cell using <xref ref-type="disp-formula" rid="pcbi.1007127.e002">Eq 2</xref>, where m<sub>t</sub> and m<sub>t+1</sub> are the cell masses (kg) at time step t and t+dt, respectively, μ the growth rate (s<sup>-1</sup>) calculated using FBA, and dt the numerical time step (s). Finally, bacterial nutrient consumption is calculated from the substrate uptake rate per dry weight of cell predicted by dFBA and the local biomass.</p>
<disp-formula id="pcbi.1007127.e005">
<alternatives>
<graphic id="pcbi.1007127.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007127.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>μ</mml:mi><mml:mo>*</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
</sec>
<sec id="sec008">
<title>Bacterial motility and chemotactic sensitivity</title>
<p>Bacterial motility is an important aspect of local interactions and self-organization. Chemotactic motility is implemented as a series of a run-and-tumble steps [<xref ref-type="bibr" rid="pcbi.1007127.ref032">32</xref>] where cells run in a straight direction (along the pore) at a constant velocity, followed by a tumble that changes their current direction at random. Within the mathematical model, runs and tumbles occur within the same time step since tumbling time is far shorter than the average run time (approximately an order of magnitude [<xref ref-type="bibr" rid="pcbi.1007127.ref032">32</xref>]) and are calculated for each individual cell. Bacterial cells run along one-dimensional pores at a constant velocity determined by the local water film thickness [<xref ref-type="bibr" rid="pcbi.1007127.ref033">33</xref>,<xref ref-type="bibr" rid="pcbi.1007127.ref034">34</xref>] calculated using <xref ref-type="disp-formula" rid="pcbi.1007127.e006">Eq 6</xref> where V is restricted bacterial swimming velocity (ms<sup>-1</sup>), V<sub>0</sub> unrestricted bacterial swimming velocity, F<sub>m</sub> the flagellar propulsion force (N), F<sub>λ</sub> the cell-surface hydrodynamic interactions (N) and Fc the capillary pinning force (N). The derivation of this Equation has been previously published [<xref ref-type="bibr" rid="pcbi.1007127.ref034">34</xref>] and relies primarily on simple geometrical considerations.</p>
<disp-formula id="pcbi.1007127.e006">
<alternatives>
<graphic id="pcbi.1007127.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007127.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="5.25em"/><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
<p>Chemotaxis enables to bias the resulting swimming direction towards favorable conditions (e.g. aerotaxis towards oxic conditions). This process is included in the mathematical model by calculating the tumbling probability based on the growth rate gradient of individual cells by comparing individual growth rates in time step t and t-1 [<xref ref-type="bibr" rid="pcbi.1007127.ref018">18</xref>] and is calculated using <xref ref-type="disp-formula" rid="pcbi.1007127.e007">Eq 7</xref>. Here, p<sub>t</sub> is the tumbling probability with chemotaxis, p<sub>0</sub> the tumbling probability in absence of any chemotactic behavior, X the chemotactic sensitivity (m<sup>2</sup>s<sup>-1</sup>), v the swimming velocity depending on hydrodynamic interactions (ms<sup>-1</sup>), u<sub>max</sub> the maximum growth rate (s<sup>-1</sup>) and Δμ the experienced growth rate gradient (m<sup>-1</sup>s<sup>-1</sup>).</p>
<disp-formula id="pcbi.1007127.e007">
<alternatives>
<graphic id="pcbi.1007127.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007127.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>v</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>Δ</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula>
<p>A binomial distribution based on the individual tumbling probabilities is used to determine whether a cell tumbles in the current time step. For tumbling within a pore, a cell has a 50% probability to change direction. When reaching a node, a new direction is selected at random from all connected pores. When entering a pore where the cell would be immobile due to thin water films, the cell has a 10% chance at each time step to detach back into the previous node. Mounting evidence suggests that motile cells can extract themselves from tight spots [<xref ref-type="bibr" rid="pcbi.1007127.ref035">35</xref>] but information is insufficient to quantify the efficiency of such processes. We thus have assigned a small probability to account for the occurrence of such relatively rare events.</p>
</sec>
</sec>
<sec id="sec009">
<title>Simulation details: Metabolic networks and boundary conditions</title>
<p>We evaluated the proposed IndiMeSH framework by comparing it to a population-based metabolic model (COMETS) [<xref ref-type="bibr" rid="pcbi.1007127.ref021">21</xref>] and to experimental data [<xref ref-type="bibr" rid="pcbi.1007127.ref013">13</xref>], and used it to mimic experiments of glucose perfusion in soil aggregates [<xref ref-type="bibr" rid="pcbi.1007127.ref024">24</xref>] to evaluate the potential of IndiMeSH to predict dynamic shifts in the total abundance of a bacterial community due to boundary condition perturbations. In addition, simulations with contrasting hydration conditions and varying pore size distributions were created to highlight the capability of IndiMeSH to simulate bacterial life in soil. A list of all user defined parameters can be found in <xref ref-type="supplementary-material" rid="pcbi.1007127.s006">S2 Table</xref> in the supplementary material.</p>
<sec id="sec010">
<title>Metabolic network reduction</title>
<p>To reduce the computational burden of the simulations and to focus on related parts of the metabolism, genome-scale metabolic networks (GEM) were systematically reduced using two previously published algorithms, redGEM [<xref ref-type="bibr" rid="pcbi.1007127.ref036">36</xref>] and lumpGEM [<xref ref-type="bibr" rid="pcbi.1007127.ref037">37</xref>]. These semi-automatic algorithms make use of graph-based search algorithms and user defined information (subsystem of interest, possible carbon sources and potential excreted metabolites) to identify core reactions and metabolites of interest and then create lumped reactions using mixed-integer linear programming that are balanced concerning all intermediate precursors and cofactors along the synthesis pathways. On average, this reduced the number of reactions within the metabolic networks by an order of magnitude, as shown in <xref ref-type="table" rid="pcbi.1007127.t001">Table 1</xref>. The consistency of the reduced scale metabolic network (rGEM) with its GEM were evaluated by a scheme based on flux variability analysis (FVA) [<xref ref-type="bibr" rid="pcbi.1007127.ref038">38</xref>]. A similar approach has been used previously to compare an ad hoc reduced network to a genome-scale network, albeit considering only one physiological state of the population [<xref ref-type="bibr" rid="pcbi.1007127.ref039">39</xref>]. Since we are interested in a wide range of environmental conditions, we compared FVA predictions with varying percentages (100%, 60% and 20%) of the maximum uptakes rates for each substrate. For example in the case of glucose, uptake rates were constrained to 8 mmol/gDW/h, 4.8 mmol/gDW/h and 1.6 mmol/gDW/h. These values were combined with percentages of all other substrates (e.g. with maximum uptake rates of 30 mmol/gDW/h, 18 mmol/gDW/h and 6 mmol/gDW/h in the case of oxygen), resulting in multiple conditions such as glucose limitation in oxygenated environments or glucose abundance in oxygen-limited environments. For each condition, FVA was calculated for both the genome-scale and reduced-scale model, and the predicted flux envelopes for each of the common reactions was compared to observe the percentage of reactions carrying similar fluxes. This enabled a more precise comparison of genome-scale to reduced-scale metabolic models depending on nutrient conditions, and resulted in a total of 81 and 27 conditions for the case of four and three substrates, respectively. Acetate, methionine and oxygen were used for comparing the reduced- and genome-scale metabolic models of Escherichia coli and Salmonella enterica (with additional lactose in the case of E. coli). For Pseudomonas putida and P. stutzeri, the carbon sources citrate and acetate as well as oxygen were included (with additional nitrate in the case of P. stutzeri). These nutrients were chosen due to their availability in the simulation scenarios.</p>
<table-wrap id="pcbi.1007127.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007127.t001</object-id>
<label>Table 1</label> <caption><title>Summary of genome-scale and reduced-scale metabolic network dimensions for all species.</title> <p>For all species, the number of reactions and metabolites were reduced by an order of magnitude using the redGEM algorithm [<xref ref-type="bibr" rid="pcbi.1007127.ref036">36</xref>]. This reduced the computational burden significantly.</p></caption>
<alternatives>
<graphic id="pcbi.1007127.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007127.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="justify"/>
<th align="center" colspan="2">Genome-scale model</th>
<th align="center" colspan="2">Reduced-scale model</th>
</tr>
<tr>
<th align="justify"/>
<th align="center"><italic>Metabolites</italic></th>
<th align="center"><italic>Reactions</italic></th>
<th align="center"><italic>Metabolites</italic></th>
<th align="center"><italic>Reactions</italic></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold><italic>E</italic>. <italic>coli</italic> K-12 (iJO1366)</bold></td>
<td align="center">1807</td>
<td align="center">2585</td>
<td align="center">313</td>
<td align="center">432</td>
</tr>
<tr>
<td align="left"><bold><italic>S</italic>. <italic>enterica</italic> LT2 (iRR1083)</bold></td>
<td align="center">1803</td>
<td align="center">2547</td>
<td align="center">224</td>
<td align="center">346</td>
</tr>
<tr>
<td align="left"><bold><italic>P</italic>. <italic>putida</italic> KT2440 (iJN746)</bold></td>
<td align="center">917</td>
<td align="center">1053</td>
<td align="center">206</td>
<td align="center">259</td>
</tr>
<tr>
<td align="left"><bold><italic>P</italic>. <italic>stutzeri</italic> A1501 (iPB890)</bold></td>
<td align="center">1056</td>
<td align="center">1135</td>
<td align="center">113</td>
<td align="center">173</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec011">
<title>Comparison of IndiMeSH with a population-based spatiotemporal metabolic network model</title>
<p>We compared IndiMeSH with COMETS (Computation of Microbial Ecosystems in Time and Space), a model designed primarily to investigate the growth and interrelation of bacterial communities in space using FBA and population-based approaches. In comparing IndiMeSH with COMETS predictions, we sought to verify the potential of IndiMeSH in simulating trophic dependencies of multispecies bacterial communities without making prior assumptions. For this reason, simulations were generated mimicking the two-member consortium investigated in the original publication [<xref ref-type="bibr" rid="pcbi.1007127.ref021">21</xref>]. This consortium consisted of two mutant strains, <italic>E</italic>. <italic>coli</italic> K-12 deficient in methionine production and <italic>S</italic>. <italic>enterica</italic> LT2. <italic>E</italic>. <italic>coli</italic> relies on the production of methionine by <italic>S</italic>. <italic>enterica</italic>, whereas <italic>S</italic>. <italic>enterica</italic> is dependent on the release of acetate by <italic>E</italic>. <italic>coli</italic> in microaerobic conditions due to its inability to directly metabolize lactose, thus engaging in a mutualistic relationship where neither species can grow in the absence of the other [<xref ref-type="bibr" rid="pcbi.1007127.ref040">40</xref>]. S. enterica has been genetically engineered to produce methionine which is incorporated in the metabolic network by linking the excretion of methionine to the biomass function. A summary of boundary conditions for all metabolic networks can be found in <xref ref-type="supplementary-material" rid="pcbi.1007127.s005">S1 Table</xref> in the supplementary material.</p>
<p>To simulate microbial life on a two-dimensional surface in IndiMeSH, a rectangular, saturated pore network (coordination number: 4) was created with the same topology as in the COMETS simulations (for details see <xref ref-type="supplementary-material" rid="pcbi.1007127.s001">S1A Fig</xref> in the supplementary material). Each pore has dimensions of 500x250x70 microns (LxWxH). The width of the pores was reduced (i.e. not a square patch as in COMETS) to conserve the total surface area (taking into account overlapping corners of the pores). Pore depth was calculated based on the characteristic diffusion length within one time step. Lactose and oxygen were supplemented at concentrations of 2.92 mM and 0.1 mM, respectively. Acetate and methionine are solely produced through bacterial metabolism and do not have any external sources. A fixed nutrient diffusion coefficient in water of 5*10<sup>−10</sup> m<sup>2</sup>s<sup>-1</sup> is used for all simulations [<xref ref-type="bibr" rid="pcbi.1007127.ref021">21</xref>]. Since the simulation represents bacterial colonies growing on agar, the population was represented using “super agents” in IndiMeSH, each representing 100 identical bacterial cells with synchronized mobility. An inoculum of 3*10<sup>−7</sup> g bacterial biomass thus contains 3000 super agents (assuming a cell mass of 10<sup>−15</sup> kg [<xref ref-type="bibr" rid="pcbi.1007127.ref041">41</xref>]). 100 randomly chosen nodes were inoculated with 3000 super agents with prescribed <italic>E</italic>. <italic>coli</italic> to <italic>S</italic>. <italic>enterica</italic> ratios of 99:1 or 1:99, resulting in an initial community of 300,000 super agents. The total simulated time was 48 hours using 10 second time step. This time step is much shorter than reported in the COMETS simulation (6 minutes) and was selected to maintain the functionality of bacterial motility as a pseudo run-and-tumble mechanism. To simulate colony growth and expansion on agar surfaces, bacterial cell velocity was reduced to 2.2*10<sup>−9</sup> ms<sup>-1</sup> to obtain good agreement between COMETS biomass diffusion and IndiMeSH run-and-tumble biomass dispersal (<xref ref-type="supplementary-material" rid="pcbi.1007127.s003">S3 Fig</xref> in the supplementary material).</p>
</sec>
<sec id="sec012">
<title>Comparison to previously published experimental data of bacterial spatial organization</title>
<p>A similar core IBM (without the FBA component) has been used in previous studies to investigate an experimental system designed to visualize and quantify bacterial spatial organization in pore networks [<xref ref-type="bibr" rid="pcbi.1007127.ref013">13</xref>]. The experimental system consisted of micrometric pore networks where boundary conditions could be controlled mimicking conditions found in soil aggregates. Two bacterial species, an obligate aerobe and facultative anaerobes, were used to elucidate the spatial organization and coexistence in response to carbon and oxygen counter gradients. The primary disadvantage of the previous mathematical model has been the representation of <italic>P</italic>. <italic>veronii</italic> 1YdBTEX2 as an obligate anaerobic species using simple Monod-type growth kinetics. In reality, <italic>P</italic>. <italic>veronii</italic> is capable of growing in both aerobic and anaerobic environments by adapting its metabolism. The lack of metabolic flexibility in the Monod-based application resulted in a certain discrepancy between experimental and simulation results, especially for the cases where facultative anaerobes were growing closer to the oxygen source [<xref ref-type="bibr" rid="pcbi.1007127.ref013">13</xref>]. In this study, we repeat these simulations using the reduced-scale metabolic networks in the IndiMeSH model with the same physical, hydrological and chemical domain setup. The physical domain comprised a fully connected hexagonal lattice (coordination number: 6) with each pore having a cuboid shape of 200x40x15 microns (LxWxH) and a total domain size of 1 cm by 1 cm. Four nutrients were included in the simulation: citrate (central source, 10 mM), nitrate (central source, 10 mM), oxygen (peripheral source, 0.27 mM) and acetate (produced anaerobically by bacterial cells, no physical source). For <italic>P</italic>. <italic>putida</italic> KT2440, a reduced core model of the genome-scale metabolic network iJN746 [<xref ref-type="bibr" rid="pcbi.1007127.ref042">42</xref>] was implemented. In the absence of a curated metabolic network for the <italic>P</italic>. <italic>veronii</italic> 1YdBTEX2, we have used a reduced-scale model of <italic>P</italic>. <italic>stutzeri</italic> A1501 (iPB890) [<xref ref-type="bibr" rid="pcbi.1007127.ref043">43</xref>] due to the similarity especially in facultative anaerobic capabilities of using denitrification under anoxic conditions. Eight realizations with varying inoculation numbers and ratios were used congruent to the original publication. A summary of the simulation setup is shown in <xref ref-type="supplementary-material" rid="pcbi.1007127.s002">S2B Fig</xref> in the supplementary material.</p>
</sec>
<sec id="sec013">
<title>Glucose perfusion in soil aggregates</title>
<p>A main advantage of the IndiMeSH model is its capability to capture the aqueous phase configuration and related limitations to bacterial dispersal and nutrient diffusion landscape. Previously conducted experiments performed in 2mm soil aggregates investigated the effect of carbon perfusion by adding glucose after a 7 day incubation period as reported in [<xref ref-type="bibr" rid="pcbi.1007127.ref024">24</xref>]. These experiments were replicated within the IndiMeSH framework to describe and quantify the observed shift in bacterial total abundance due to the carbon perturbation. Boundary conditions of the simulations attempted to mimic the experimental conditions, although unknowns concerning the initial bacterial cell distribution and numbers remain, and the distribution and amount of carbon during the pre-incubation as well as the matric potential during glucose addition were not reported. Congruent to the experimental system, simulations were performed in 2mm diameter pore networks representing soil aggregate cross-sections. The approximate pore size distribution was taken from the experimental data (lognormal distribution with mean pore diameter of 10 microns and variance 5 microns). An initially homogeneously inoculated bacterial community was grown into stationary phase for 7 days after which a pulse of glucose (333 mM) was added to the simulations. The matric potential was kept at -10 kPa. During the 7 day incubation period, a central glucose and nitrate source was present (constant concentration of 0.5 mM and 0.4 mM, respectively). Oxygen was provided from the periphery which penetrated the aggregate completely due to the unsaturated conditions. No analysis concerning the species was performed in the experiment. For the simulations, a reduced scale metabolic network of P. stutzeri A1501 was chosen (iPB890) where 1000 cells were inoculated homogeneously across the pore network. Total simulation time was 9 days at a 10 s time step with glucose added after 7 days.</p>
</sec>
<sec id="sec014">
<title>Contrasting hydration conditions with varying pore size distributions</title>
<p>The previous case studies included scenarios with saturated (spatial self-organization) and unsaturated (glucose perfusion) conditions. However, a strategic comparison of simulations under wet and dry conditions in the same pore network is missing. For this reason, a final case study containing three pore networks (large, medium and small pores) and two hydration levels (-1 kPa for wet and -10 kPa for dry conditions) was created. The simulation domain comprised of a 4 mm diameter carbon hotspot representing a soil aggregate or rhizosphere cross-section. The pore lengths was adapted for each network to conserve porosity. Pore size distributions were taken from a lognormal distribution with mean radius of 5, 50 and 200 microns for the small, medium and large pore networks, respectively, with corresponding standard deviations of 5, 10 and 50 microns. Simulations included central glucose and nitrate sources with a peripheral oxygen source (0.27 mM). Glucose and nitrate concentrations were adapted for each network to represent constant flux boundary conditions. Acetate was included in the simulations as an intermediate metabolite without any physical sources. Pseudomonas stutzeri A1501 was used as a model organism (reduced metabolic network iPB890) due to its facultative anaerobic growth capability. The total simulated time was five days with a 10 s time step.</p>
</sec>
</sec>
</sec>
<sec id="sec015" sec-type="results">
<title>Results</title>
<sec id="sec016">
<title>Evaluation of the GEM and rGEM</title>
<p>The performances of genome-scale metabolic networks (GEM) and their reduced-scale networks (rGEM) were compared using flux variability analysis in varying environmental conditions. <xref ref-type="table" rid="pcbi.1007127.t002">Table 2</xref> summarizes the median percentage and standard deviation of common reactions that differ to varying degrees in their maximum or minimum flux between the GEM and rGEM models for all environmental conditions. Overall, the performance of the reduced-scale model was very similar to the genome-scale models, with approximately 85% of all reactions within the models having minimal flux and maximal flux differences of less than 1 mmol/gDW/h. In addition, the standard deviations were small for most metabolic network comparisons, with the exception of the <italic>E</italic>. <italic>coli</italic> metabolic networks. <xref ref-type="supplementary-material" rid="pcbi.1007127.s004">S4 Fig</xref> in the supplementary material relates the comparison of the metabolic networks to environmental conditions to elucidate potential biases due to specific combinations of nutrient uptake rates. The metabolic networks of <italic>E</italic>. <italic>coli</italic> perform differently at the combination of high lactose, low methionine and medium to high oxygen uptakes.</p>
<table-wrap id="pcbi.1007127.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007127.t002</object-id>
<label>Table 2</label> <caption><title>Evaluation of metabolic network reduction and comparability to genome-scale metabolic networks.</title> <p>Genome-scale and reduced-scale metabolic networks were compared using flux variability analysis whilst exposed to different environmental conditions. A percentage of the maximum uptake rate (20%, 60% and 100%) for each nutrient was cross-combined with all other nutrient levels in order to generate 81 conditions in the case of four nutrients and 27 conditions in the case of three nutrients. Presented is the median percentage of all reactions having a minimal flux or maximum flux difference falling within the respective category (with standard deviation in brackets).</p></caption>
<alternatives>
<graphic id="pcbi.1007127.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007127.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="justify"/>
<th align="justify">&lt;0.1 mol/gDW/h</th>
<th align="justify">&gt; 0.1 mmol/gDW/h<break/>&lt; 1 mmol/gDW/h</th>
<th align="justify">&gt; 1 mmol/gDW/h<break/>&lt; 10 mmol/gDW/h</th>
<th align="justify">&gt; 10 mmol/gDW/h</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold><italic>E</italic>. <italic>coli</italic> K-12 (iJO1366)</bold></td>
<td align="center">0.75 (0.16)</td>
<td align="center">0.07 (0.02)</td>
<td align="center">0.08 (0.13)</td>
<td align="center">0.08 (0.08)</td>
</tr>
<tr>
<td align="left"><bold><italic>S</italic>. <italic>enterica</italic> LT2 (iRR1083)</bold></td>
<td align="center">0.92 (0.03)</td>
<td align="center">0.05 (0.03)</td>
<td align="center">0.00 (0.01)</td>
<td align="center">0.04 (0.01)</td>
</tr>
<tr>
<td align="left"><bold><italic>P</italic>. <italic>putida</italic> KT2440 (iJN746)</bold></td>
<td align="center">0.77 (0.02)</td>
<td align="center">0.11 (0.05)</td>
<td align="center">0.10 (0.06)</td>
<td align="center">0.02 (0.01)</td>
</tr>
<tr>
<td align="left"><bold><italic>P</italic>. <italic>stutzeri</italic> A1501 (iPB890)</bold></td>
<td align="center">0.82 (0.07)</td>
<td align="center">0.06 (0.07)</td>
<td align="center">0.05 (0.02)</td>
<td align="center">0.04 (0.03)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec017">
<title>IndiMeSH vs. COMETS predictions</title>
<p>- The aim of comparing COMETS with IndiMeSH was to verify IndiMeSH ability to predict bacterial community trophic interactions in the absence of prior assumptions regarding nutrient uptake (in contrast with Monod kinetic models). <xref ref-type="fig" rid="pcbi.1007127.g002">Fig 2</xref> shows the final ratio of <italic>E</italic>. <italic>coli</italic> and <italic>S</italic>. <italic>enterica</italic> after 48 h of simulated growth, including the experimental results and model simulations from the original COMETS publication [<xref ref-type="bibr" rid="pcbi.1007127.ref021">21</xref>]. Both inoculation ratios (99:1 and 1:99 as <italic>E</italic>.<italic>coli</italic>:<italic>S</italic>.<italic>enterica</italic> inoculated at 100 randomly chosen nodes) were included, demonstrating the metabolic interdependence of the two species and the convergence of the system to the same stable community composition. No significant difference was found between IndiMeSH simulations and both COMETS experimental and simulation results (p value of 0.66 and 0.33, respectively, two-tailed t-test). Additional simulations were performed to ensure that the motility algorithm of IndiMeSH and changing to super agents resulted in similar biomass dispersion characteristics as in the diffusion algorithm used in COMETS. <xref ref-type="supplementary-material" rid="pcbi.1007127.s003">S3 Fig</xref> in the supplementary material shows the biomass dispersion for the COMETS algorithm and IndiMeSH run-and-tumble algorithm, both with and without super agents.</p>
<fig id="pcbi.1007127.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007127.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Relative abundance of <italic>E</italic>. <italic>coli</italic> and <italic>S</italic>. <italic>enterica</italic> in the IndiMeSH simulations and original COMETS simulations and experimental results.</title>
<p>Combined relative abundance of initial inoculation ratios (99:1 and 1:99 of <italic>E</italic>. <italic>coli S</italic>. <italic>enterica</italic>, three replicates each, inoculated at 100 random nodes) for experimental results, COMETS simulations and IndiMeSH simulations after 48h of growth. Error bars represent one standard deviation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007127.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec018">
<title>Spatial organization using IndiMeSH</title>
<p>To evaluate the ability of IndiMeSH predict the spatial organization of a bacterial community in pore networks due to nutrient cross-gradients (where different metabolism is required), we compared IndiMeSH predictions with previously published experimental data [<xref ref-type="bibr" rid="pcbi.1007127.ref013">13</xref>]. <xref ref-type="fig" rid="pcbi.1007127.g003">Fig 3</xref> depicts the resulting spatial distribution of <italic>P</italic>. <italic>putida</italic> (further termed aerobes) and <italic>P</italic>. <italic>veronii/P</italic>. <italic>stutzeri</italic> (further termed facultative anaerobes) along the shortest path from the central to the peripheral ports of the physical and simulated pore networks (details of the physical domain and chemical boundary conditions are described in the methods and shown in <xref ref-type="supplementary-material" rid="pcbi.1007127.s002">S2 Fig</xref> of the supplementary material). The aerobes proliferate closer to the periphery than the facultative anaerobes, with a small subpopulation of facultative anaerobes residing at the oxygen-rich peripheral ports. The magnitude of the populations of both species is captured well both at the central and peripheral ports, although the location of aerobes is predicted to be in closer proximity to the peripheral port than observed experimentally. For the facultative anaerobes, the simulations capture both the central population utilizing anaerobic metabolism (fermentation) as well as the peripheral sub-population using aerobic respiration.</p>
<fig id="pcbi.1007127.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007127.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Distribution of obligate aerobic <italic>P</italic>. <italic>putida</italic> (cyan) and facultative anaerobic <italic>P</italic>. <italic>veronii</italic> (magenta) along the carbon-oxygen counter gradient from the central port to the peripheral ports.</title>
<p>Combined experimental results (boxplots, whiskers indicate minimum and maximum of data) and simulation results (shaded area with 95% of all cells, thick line represents mean) in a well connected, artificial pore network using IndiMeSH (left) and Monod parametrization (right). Segregation of facultative anaerobes into an anaerobically growing (central port, anoxic) and peripheral, aerobically growing subpopulation can be observed in the results using IndiMeSH which is absent in the results using Monod parametrization. The observed shift of obligate aerobes towards the periphery is due to the chosen canonical half saturation coefficient in IndiMeSH (0.05 mM) compared to the Monod half saturation coefficient in the original model (0.0063 mM).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007127.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec019">
<title>Metabolic adaptation to rapid changes</title>
<p>We evaluated the capability of IndiMeSH to predict the shift in total bacterial population size due to perturbations in boundary conditions in the form of glucose perfusion into soil aggregates previously under certain steady ecological state. Simulations were set up to mimic experiments performed on 2 mm soil aggregates where the bacterial community was first grown into steady state for 7 days after which glucose was added at high concentrations to observe the short-term impact on the function and the spatial distribution of soil bacteria and fungi [<xref ref-type="bibr" rid="pcbi.1007127.ref024">24</xref>]. <xref ref-type="fig" rid="pcbi.1007127.g004">Fig 4</xref> depicts the pore network employed for the simulation congruent to the reported pore size distribution in the experiment (<xref ref-type="fig" rid="pcbi.1007127.g004">Fig 4A</xref>), the resulting diffusional scheme of the pore network calculated using Millington-Quirk equation (<xref ref-type="fig" rid="pcbi.1007127.g004">Fig 4B</xref>) as well as the total temporal response of the community during the pre-incubation and dynamic response to the addition of a glucose pulse (<xref ref-type="fig" rid="pcbi.1007127.g004">Fig 4C</xref>). Due to the unsaturated conditions (expressed by a matric potential of -10 kPa), the diffusion of nutrients confined to the aqueous phase was severely limited whereas oxygen in the gas phase was able to penetrate the pore network rapidly. The primary mode of growth was thus aerobic respiration within all regions of the pore network. During the pre-incubation period, the bacterial population grew into steady state dictated by the carrying capacity of the supplied carbon. Glucose addition after 7 days triggered a secondary rapid growth phase until a maximum is reached after approximately 8 days into the simulation. The population then starts to decline due to the lack of carbon availability, tending towards the previously established population size due to the system carrying capacity. Glucose perfusion does not have a homogeneous effect on the population concerning space. The relative increase in population size of the outer aggregate faction (peeling off 1 mm of the aggregate conceptually) compared to the inner faction is 2.5 to 1.1, respectively. This is similar to the observation made within the experiments where they reported a total increase in cell number of 1.6 and 1.3 for the outer and inner faction, respectively. Within the simulation this is mostly due to the availability of carbon at the periphery which otherwise is intercepted by the population closer to the center of the aggregate. Thus, the initial spatial distribution of the community was disrupted by the change in carbon availability, creating a more heterogeneous distribution of the population.</p>
<fig id="pcbi.1007127.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007127.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Response of bacterial population to a shift in boundary conditions represented as glucose perfusion into a soil aggregate cross-section.</title>
<p>(a) The pore network used for the simulation congruent to the soil aggregates used in the experiment. The distribution of glucose within the pore network is visualized prior to glucose perfusion. (b) Relative diffusion compared to a saturated pore network is calculated using the Millington-Quirk equation. The dashed orange line indicates the state of the pore network at the matric potential set experimentally and within the simulations, limiting nutrient diffusion in the aqueous phase whilst facilitating gaseous diffusion due to unsaturated pores. (c) Growth curve of the bacterial population showing a secondary growth phase after glucose addition with a decline in population size approaching the previously established stable population size due to the system carrying capacity.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007127.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec020">
<title>Contrasting hydration conditions with varying pore size distributions</title>
<p>Finally, we created simulations with two contrasting hydration conditions in three different pore networks to highlight the capability of IndiMeSH to capture and predict the shift in metabolic activity due to the interplay of soil physics, aqueous configuration and bacterial metabolism. Pore size distributions resembling different soils are shown in <xref ref-type="fig" rid="pcbi.1007127.g005">Fig 5A</xref> with the related soil water characteristic curves shown in <xref ref-type="fig" rid="pcbi.1007127.g005">Fig 5B</xref>. A matric potential of -1 kPa and -10 kPa, was applied to simulate wet and dry conditions, respectively, with profound consequences for the hydration conditions for each network as indicated by the green lines in <xref ref-type="fig" rid="pcbi.1007127.g005">Fig 5B</xref>. The degree of saturation in turn dictates the relative diffusion of gaseous and aqueous nutrients as shown in <xref ref-type="fig" rid="pcbi.1007127.g005">Fig 5C</xref>. In dry conditions, aqueous nutrients are restricted in their diffusive capability due to thin water films whilst gaseous nutrient diffusion (e.g. oxygen) is facilitated. Due to the constant flux boundary conditions, bacterial populations reach similar magnitudes in wet conditions as shown in <xref ref-type="fig" rid="pcbi.1007127.g005">Fig 5D</xref>. Under dry conditions, diffusion of substrate in the large pore network is restricted more profoundly compared to the small pore networks, which results in a lower total carrying capacity. A main difference between the saturated and unsaturated simulation also lies in the metabolic activity of the population. Due to the penetration of oxygen deep into the aggregate for all pore sizes under dry conditions, the sole mode of growth is via aerobic respiration as shown in the consumption pattern for the small sized pore domain in <xref ref-type="fig" rid="pcbi.1007127.g005">Fig 5E</xref>. Under wet conditions, the additional consumption of nitrate indicates the use of denitrification pathways. Under these conditions, overflow metabolism occurs at the center due to an imbalance in electron donor and acceptor ratio resulting in the production of acetate, which is consumed at the periphery using aerobic respiration as shown in <xref ref-type="fig" rid="pcbi.1007127.g005">Fig 5F</xref>.</p>
<fig id="pcbi.1007127.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007127.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Strategic analysis of pore size distribution and hydration conditions.</title>
<p>Visualization of the degree of connectivity for all three pore networks with varying mean pore size at two hydration conditions. (a) Histogram of pore sizes taken from lognormal distributions with varying mean and standard deviations. (b) Resulting soil water characteristic curve including indications of matric potential taken as wet (-1 kPa) and dry (-10 kPa) conditions. (c) Calculated relative diffusion for all pore networks using the Milling-Quirk equation. (d) Bacterial growth dynamics depending on pore network and hydration condition for the whole simulation time of 120 h. (e) Bacterial consumption for the small pore size network and varying hydration conditions. (f) Spatial distribution of acetate production and consumption. Acetate is produced at the carbon rich center due to overflow metabolism (electron acceptor limited) and consumed at the periphery via aerobic respiration.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007127.g005" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec021" sec-type="conclusions">
<title>Discussion</title>
<p>The IndiMeSH model has been developed to capture the multifaceted bacterial metabolism of individual-based agents inhabiting a complex habitat such as soil. The use of adaptive metabolic networks enables a life-like transition between aerobic and anaerobic conditions compared to empirical and arbitrary kinetic models. Additionally, FBA predicts uptake and secretion rates depending on locally variable nutrient conditions and thus enables simulations of trophically interacting bacterial species within a complex medium such as, but not limited to, soil. The heavy computational burden related to the motility of individual bacterial cells and the numerous iterations of the FBA requires the reduction of genome-scale metabolic networks using the previously published redGEM [<xref ref-type="bibr" rid="pcbi.1007127.ref036">36</xref>] and lumpGEM [<xref ref-type="bibr" rid="pcbi.1007127.ref037">37</xref>] algorithms. The implementation of reduced-scale metabolic models (rGEM) significantly reduced the computational time whilst retaining the salient features and predictability offered by the genome-scale models (GEM) (<xref ref-type="table" rid="pcbi.1007127.t001">Table 1</xref>). Although such a reduction (GEM to rGEM) may not be crucial for very small physical domains, simulations of ecologically relevant systems where gradients of environmental variables persist would require spatial domains with a few thousand nodes. For example, in the micromodel comparison (<xref ref-type="fig" rid="pcbi.1007127.g003">Fig 3</xref>) we considered approximately 3000 nodes and two species, thus solving 6000 FBA problems per time step; hence, the use of rGEM greatly improved computational efficiency. Compared to other individual based metabolic models the primary benefit of reduced models is not due to the physical domain size (e.g. BacArena simulates domains containing 100 by 100 grid nodes [<xref ref-type="bibr" rid="pcbi.1007127.ref022">22</xref>]), but the small time step dictated by the motility algorithm and related large number of iterations in total. Except for <italic>E</italic>. <italic>coli</italic>, all reduced-scale models perform very similarly to their genome-scale counterparts. Reactions which have a net flux difference greater than 10 mmol/gDw/h are predominantly attributed to internal cycles within the genome-scale models or cycling of nutrients between compartments of the genome-scale model that are absent in the reduced-scale model, as has been previously reported [<xref ref-type="bibr" rid="pcbi.1007127.ref039">39</xref>]. There is a discrepancy in acetate metabolism between the reduced-scale and genome-scale models of <italic>E</italic>. <italic>coli</italic>. This is due to overoptimistic predictions of the genome-scale model where the predicted high fluxes can only be achieved through net CO<sub>2</sub> fixation, which is unlikely [<xref ref-type="bibr" rid="pcbi.1007127.ref039">39</xref>].</p>
<p>The main difference between a group of spatiotemporal metabolic models and the newly developed IndiMeSH lies in the ability of the latter to represent complex habitats such as soil, including pore spaces, aqueous phase configurations and related constraints to chemical diffusion and bacterial dispersion. The IndiMeSH model is designed for a different range of applications than the COMETS model; however, we obtained comparable simulation scenarios through simple adjustments to the physical and biological domain of the model. These include the representation of bacterial cells as super agents as well as a reduction in velocity to account for growth on agar. The use of super agents has been implemented in the past [<xref ref-type="bibr" rid="pcbi.1007127.ref044">44</xref>,<xref ref-type="bibr" rid="pcbi.1007127.ref045">45</xref>] and in other studies have been shown to have limited effects on simulation results as long as the scaling ratio is sufficiently small [<xref ref-type="bibr" rid="pcbi.1007127.ref046">46</xref>]. Using these modifications, IndiMeSH accurately reproduced the COMETS results. These simulations rely on an appropriate reduction of the genome-scale models preserving the stoichiometric relations between consumed and excreted nutrients and demonstrate the ability of IndiMeSh to replicate and predict bacterial growth based on trophic interactions, a process ubiquitous in dense bacterial hotspots. Since both COMETS and IndiMeSH are essentially two-dimensional simulations, the oxygen concentration was kept artificially low to imitate conditions experienced by the layer of cells close to the agar itself. In reality, a bacterial colony growing on agar is a dynamic system where oxygen is consumed at the periphery, resulting in multiple micro niches and redox conditions within the colony itself [<xref ref-type="bibr" rid="pcbi.1007127.ref047">47</xref>]. Individual-based models coupled with metabolic networks focusing on colony growth are able to capture this phenomenon well [<xref ref-type="bibr" rid="pcbi.1007127.ref023">23</xref>], however the scale of those models restricts simulations of a large domain with hundreds of colonies.</p>
<p>The importance of emergent spatial patterns and bacterial spatial organization prompted us to examine how IndiMeSH reproduces previously published experimental data of bacterial distributions in micrometric pore networks dominated by carbon-oxygen counter gradients [<xref ref-type="bibr" rid="pcbi.1007127.ref013">13</xref>]. The original IBM represented facultative anaerobes as obligate anaerobes, which resulted in consistent discrepancies between model and experimental results especially for facultative anaerobes proliferating close to the oxygenated peripheral ports. Integration of metabolic networks as a means of growth calculation enabled us to capture the segregation of facultative anaerobes into a denitrifying population close to the carbon source and a subpopulation using aerobic respiration (<xref ref-type="fig" rid="pcbi.1007127.g003">Fig 3</xref>). Despite possibilities to represent facultative anaerobes using Monod kinetics and an arbitrary oxygen-threshold-switching strategy (e.g. [<xref ref-type="bibr" rid="pcbi.1007127.ref015">15</xref>]), IndiMeSH managed to capture the facultative behavior more naturally without an artificial construct of bimodal metabolism. Originally, the interaction between the two species suggested an indirect commensalism where the anaerobes were required to release sufficient carbon to the periphery for complete oxygen consumption by the aerobes and provision of an anoxic niche. Through the integration of metabolic networks and additional intermediate metabolites in the form of acetate (to ensure mass balance of carbon within the simulation), the cooperation between the species was shown to be a passive interaction where acetate was produced due to a lack of electron acceptor (not sufficient nitrate available) at the central port. Diffusion of acetate to the periphery enabled the aerobic community (both facultative anaerobes and obligate aerobes) to grow closer to the oxygen-rich peripheral port. This mechanism is less susceptible to perturbations and provides a more plausible explanation for cooperation compared to the scenario where one species “farms” the other.</p>
<p>Abrupt perturbations are ubiquitous in all natural systems such as soil, either due to rapid changes in hydration conditions following rainfall or irrigation, or chemical alteration by the application of fertilizer or contaminants to the soil, or physical alterations such as tillage or rapid soil compaction. To test the capability of IndiMeSH to simulate such dynamic changes in environmental conditions, a simulation scenario was created where a change in electron donor availability alters the macroscopic conditions within a soil aggregate cross-section based on experimental results of glucose perfusion in soil aggregates [<xref ref-type="bibr" rid="pcbi.1007127.ref024">24</xref>]. These experimental results describe a non-uniform effect in space as evidenced from peeling off 1 mm of the aggregate with 1.6 fold increase in bacterial total abundance in the periphery relative to 1.3 in the core (in the numerical experiment we observed 2.5 fold outer to 1.1 inner). The interpretation we provide to these interesting experimental results is that the perfusion with glucose alleviates the carbon flux limitations in natural aggregates, which is controlled by the inner (largely anaerobic) population. The perfusion creates a situation where carbon and oxygen become available at the periphery and promote the rapid growth during the availability window (until the carbon pulse is consumed). In the simulation, the total population size starts to decline after peaking around 8 days into the simulation. This is not easily verified in the experimental data, but acknowledging that only a fraction of the total population was reported to be dividing (approximately 4.5% to 8.2% of the total population [<xref ref-type="bibr" rid="pcbi.1007127.ref024">24</xref>]), assuming that the population has reached steady state or is declining does not seem farfetched. These simulations represent a scenario where the physical representation of soil in the form of angular pore networks plays a crucial in shaping the diffusional landscape of the microbial habitat and overall population growth–a unique feature of the presented model framework.</p>
<p>An important aspect differentiating IndiMeSH from other current spatiotemporal metabolic network models is the accuracy with which the physical habitat of the bacterial cells is represented. Angular pore networks enable to link the aqueous phase configuration dictated by the pore geometry to the underlying chemical conditions and ultimately to the spatial landscape of bacterial metabolism. For the same matric potential, pore networks of different mean diameter expose bacteria to fundamentally different growth conditions as shown for instance in <xref ref-type="fig" rid="pcbi.1007127.g005">Fig 5B</xref> at -1 kPa. Both the medium and small pore networks are saturated (nearly 100%) at this matric potential whereas the pore network containing large pores is desaturated with profound consequences for oxygen diffusion dynamics and bacterial motility. Potentially more important is the ability of IndiMeSH to capture the change in aqueous phase configuration for the same pore network at varying matric potentials. As shown in <xref ref-type="fig" rid="pcbi.1007127.g005">Fig 5E</xref>, the change in matric potential not only alters the magnitude of nutrient consumption but also the relative ratio of for instance glucose to nitrate consumption. In wet conditions, the community is split into two distinct sub populations with one growing anaerobically via denitrification and producing acetate at the center and a second which grows via aerobic respiration of acetate at the periphery of the domain (<xref ref-type="fig" rid="pcbi.1007127.g005">Fig 5F</xref>). In dry conditions, aerobic respiration is favored due to the increased gaseous diffusion at -10 kPa (<xref ref-type="fig" rid="pcbi.1007127.g005">Fig 5C</xref>). The difference in population size depending on hydration conditions is due to the reduction in carbon diffusion under dry conditions. It is important to note that these contrasting conditions emerge due to a single change in model input files–the matric potential–which induces substantial changes to both the physicochemical aspects of the model as well as bacterial growth strategy. Hence, the physical description of the pore habitat, related diffusional constraints and bacterial self-organization in complex pore systems are features that distinguish IndiMeSH from other current spatiotemporal metabolic models such as COMETS[<xref ref-type="bibr" rid="pcbi.1007127.ref021">21</xref>] or BacArena[<xref ref-type="bibr" rid="pcbi.1007127.ref022">22</xref>].</p>
<p>IndiMeSH offers a representation of metabolic versatility with an individual-based model of bacterial life in soil habitats. Metabolic networks enabled a natural transition between aerobic and anaerobic pathways and associated nutrient consumption patterns, inducing trophic interactions without prior assumptions, as required by mathematical models using simple growth kinetics. The detailed description of the physical habitat and aqueous phase and emergent nutrient diffusion fields give rise to complex metabolic landscapes with changes in metabolic activity at the millimeter scale. Due to the modular design of the IndiMeSH model, individual components can be modified to represent, for instance, a different physical habitat, method of motility or metabolic network optimization (thermodynamic FBA, FBA with molecular crowding). Thus, the applicability of the model is endless, ranging from the quantification of bacterial metabolism in soil, or the growth of bacteria during food spoilage, to the proliferation of Pseudomonas aeruginosa in the lungs of cystic fibrosis patients.</p>
</sec>
<sec id="sec022">
<title>Supporting information</title>
<supplementary-material id="pcbi.1007127.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007127.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Geometry definition for angular pore cross-sections.</title>
<p>The geometry of each triangular pore in the pore network is defined by the inscribed circle radius r and central angle γ. Rectangular pore geometry is determined by the width W and height H for each pore. Interfacial curvature R (depending on matric potential Ψ) determines the total water filled cross-sectional area A<sub>w</sub>. If Aw is smaller than the total pore cross-sectional area and has a continuous unsaturated connection to an air interface, the pore is considered to be unsaturated. Finally, the water film thickness WFT, which dictates bacterial swimming velocity, is defined as the radius of an inscribed circle between the pore walls and the liquid-air interface.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007127.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007127.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Habitat geometry, boundary conditions and inoculation location for all simulation scenarios.</title>
<p>(a) The COMETS habitat geometry contains a rectangular grid consisting of individual rectangular pores with homogeneous size (L x W x H being 500, 250 and 70 microns, respectively). Constant concentration boundaries of 2.92 mM lactose and 0.10 mM oxygen are supplied homogeneously throughout the domain. Acetate and methionine are solely produced by bacterial metabolism. 100 randomly chosen nodes are inoculated with 3000 super agents each. (b) For the micromodel comparison, a hexagonal lattice of individual cuboid pores (L x W x H being 200, 40 and 15 microns, respectively) is used with peripheral oxygen sources (0.27 mM) and central citrate and nitrate sources (each 10 mM). All bacterial cells are inoculated at the center. (c) For the glucose perfusion scenario, a hexagonal lattice with individual triangular pores (100 micron length, varying widths and heights as described in the Methods) is used with peripheral oxygen source (0.27 mM) and central glucose and nitrate sources (0.5 and 0.4 mM, respectively). After 7 days, an additional pulse of glucose was added, homogeneously distributing 333 mM of glucose in all pores. 1000 cells were inoculated randomly across the domain.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007127.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007127.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Comparison of COMETS and IndiMeSH motility predictions.</title>
<p>Algorithms were compared in a one-dimensional pore (2000 microns length with 100 nodes) and inoculation of 3*10<sup>-7</sup>g bacterial biomass at the center node. IndiMeSH predictions were produced both for individual bacterial cells and super agents with a scaling ratio of 100 (i.e. one supercell contains 100 individual bacterial cells). Predictions of the two models are congruent with a velocity of 8 microns per hour for bacterial swimming motility in the IndiMeSH model.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007127.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007127.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Comparison of <italic>E. coli</italic> GEM and rGEM in varying environmental conditions.</title>
<p>81 environmental conditions were created by cross-combination of 20%, 60% and 100% of the maximum uptake rate for all four nutrients contained in the COMETS simulation. Color indicates the percentage of common reactions in the two models that differ in carrying flux less than 1 mmol/gDW/h. A discrepancy in metabolism is visible in high lactose and oxygen conditions depending on acetate availability. This is due to an overoptimistic prediction of the <italic>E</italic>. <italic>coli</italic> genome-scale network (see <xref ref-type="sec" rid="sec021">discussion</xref> for details).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007127.s005" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007127.s005" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Summary of maximum uptake rates imposed for all metabolic networks and simulation scenarios.</title>
<p>If sufficient nutrient is available, cells consume nutrients at the maximum rate. At low nutrient concentrations, the amount is divided equally between all cells residing within a node, resulting in uptake rates lower than the maximum uptake rate.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007127.s006" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007127.s006" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>List of parameters that can be set by the model user.</title>
<p>This table contains a list of all parameters that can be set by the user for simulations containing multiple substrates and species. The list is exhaustive excluding the actual topology of the pore network (i.e. node coordinates, adjacency matrix and boundary location).</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007127.s007" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007127.s007" xlink:type="simple">
<label>S1 Data</label>
<caption>
<title>Mathematical model written in Matlab, metabolic networks and files containing simulation setup and boundary conditions for all case studies.</title>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1007127.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Raynaud</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Nunan</surname> <given-names>N</given-names></name>. <article-title>Spatial ecology of bacteria at the microscale in soil</article-title>. <source>PLoS One</source>. <year>2014</year>;<volume>9</volume>(<issue>1</issue>).</mixed-citation></ref>
<ref id="pcbi.1007127.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Torsvik</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Goksoyr</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Daae</surname> <given-names>FL</given-names></name>. <article-title>High diversity in DNA of soil bacteria</article-title>. <source>Appl Environ Microbiol</source>. <year>1990</year>;<volume>56</volume>(<issue>3</issue>):<fpage>782</fpage>–<lpage>7</lpage>. <object-id pub-id-type="pmid">2317046</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schloss</surname> <given-names>PD</given-names></name>, <name name-style="western"><surname>Handelsman</surname> <given-names>J</given-names></name>. <article-title>Toward a census of bacteria in soil</article-title>. <source>PLoS Comput Biol</source>. <year>2006</year>;<volume>2</volume>(<issue>7</issue>):<fpage>0786</fpage>–<lpage>93</lpage>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Young</surname> <given-names>IM</given-names></name>, <name name-style="western"><surname>Crawford</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Nunan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Otten</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Spiers</surname> <given-names>A</given-names></name>. <article-title>Chapter 4 Microbial Distribution in Soils. Physics and Scaling</article-title>. <source>Advances in Agronomy</source>. <year>2009</year>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tecon</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Or</surname> <given-names>D</given-names></name>. <article-title>Biophysical processes supporting the diversity of microbial life in soil</article-title>. <source>FEMS Microbiol Rev</source>. <year>2017</year>;<volume>41</volume>(<issue>5</issue>):<fpage>599</fpage>–<lpage>623</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/femsre/fux039" xlink:type="simple">10.1093/femsre/fux039</ext-link></comment> <object-id pub-id-type="pmid">28961933</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kuzyakov</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Blagodatskaya</surname> <given-names>E</given-names></name>. <article-title>Microbial hotspots and hot moments in soil: Concept &amp; review</article-title>. <source>Soil Biol Biochem</source>. <year>2015</year>;<volume>83</volume>:<fpage>184</fpage>–<lpage>99</lpage>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Parkin</surname> <given-names>TB</given-names></name>. <article-title>Soil microsites as a source of denitrification variability</article-title>. <source>Soil Sci Soc Am J</source>. <year>1987</year>;<volume>51</volume>:<fpage>1194</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Davidson</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Savage</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Finzi</surname> <given-names>AC</given-names></name>. <article-title>A big-microsite framework for soil carbon modeling</article-title>. <source>Glob Chang Biol</source>. <year>2014</year>;</mixed-citation></ref>
<ref id="pcbi.1007127.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ebrahimi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Or</surname> <given-names>D</given-names></name>. <article-title>Microbial community dynamics in soil aggregates shape biogeochemical gas fluxes from soil profiles—upscaling an aggregate biophysical model</article-title>. <source>Glob Chang Biol</source>. <year>2016</year>;<volume>22</volume>(<issue>9</issue>):<fpage>3141</fpage>–<lpage>56</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/gcb.13345" xlink:type="simple">10.1111/gcb.13345</ext-link></comment> <object-id pub-id-type="pmid">27152862</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Or</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Smets</surname> <given-names>BF</given-names></name>, <name name-style="western"><surname>Wraith</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Dechesne</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Friedman</surname> <given-names>SP</given-names></name>. <article-title>Physical constraints affecting bacterial habitats and activity in unsaturated porous media—a review</article-title>. <source>Adv Water Resour</source>. <year>2007</year>;<volume>30</volume>(<issue>6–7</issue>):<fpage>1505</fpage>–<lpage>27</lpage>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>O’Donnell</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Young</surname> <given-names>IM</given-names></name>, <name name-style="western"><surname>Rushton</surname> <given-names>SP</given-names></name>, <name name-style="western"><surname>Shirley</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Crawford</surname> <given-names>JW</given-names></name>. <article-title>Visualization, modelling and prediction in soil microbiology</article-title>. <source>Nat Rev Microbiol</source>. <year>2007</year>;<volume>5</volume>(<issue>9</issue>):<fpage>689</fpage>–<lpage>99</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrmicro1714" xlink:type="simple">10.1038/nrmicro1714</ext-link></comment> <object-id pub-id-type="pmid">17676055</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ranjard</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Richaume</surname> <given-names>A</given-names></name>. <article-title>Quantitative and qualitative microscale distribution of bacteria in soil</article-title>. <source>Res Microbiol</source>. <year>2001</year>;<volume>152</volume>(<issue>8</issue>):<fpage>707</fpage>–<lpage>16</lpage>. <object-id pub-id-type="pmid">11686384</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Borer</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Tecon</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Or</surname> <given-names>D</given-names></name>. <article-title>Spatial organization of bacterial populations in response to oxygen and carbon counter-gradients in pore networks</article-title>. <source>Nat Commun</source>. <year>2018</year>;<volume>9</volume>(<issue>1</issue>).</mixed-citation></ref>
<ref id="pcbi.1007127.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kreft</surname> <given-names>JU</given-names></name>. <article-title>Biofilms promote altruism</article-title>. <source>Microbiology</source>. <year>2004</year>;<volume>150</volume>:<fpage>2751</fpage>–<lpage>60</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1099/mic.0.26829-0" xlink:type="simple">10.1099/mic.0.26829-0</ext-link></comment> <object-id pub-id-type="pmid">15289571</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lardon</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Merkey B</surname> <given-names>V</given-names></name>., <name name-style="western"><surname>Martins</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Dötsch</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Picioreanu</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kreft</surname> <given-names>JU</given-names></name>, <etal>et al</etal>. <article-title>iDynoMiCS: Next-generation individual-based modelling of biofilms</article-title>. <source>Environ Microbiol</source>. <year>2011</year>;<volume>13</volume>:<fpage>2416</fpage>–<lpage>34</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1462-2920.2011.02414.x" xlink:type="simple">10.1111/j.1462-2920.2011.02414.x</ext-link></comment> <object-id pub-id-type="pmid">21410622</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Or</surname> <given-names>D</given-names></name>. <article-title>Hydration dynamics promote bacterial coexistence on rough surfaces</article-title>. <source>ISME J</source>. <year>2013</year> <month>Feb</month>;<volume>7</volume>(<issue>2</issue>):<fpage>395</fpage>–<lpage>404</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ismej.2012.115" xlink:type="simple">10.1038/ismej.2012.115</ext-link></comment> <object-id pub-id-type="pmid">23051694</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ebrahimi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Or</surname> <given-names>D</given-names></name>. <article-title>Hydration and diffusion processes shape microbial community organization and function in model soil aggregates</article-title>. <source>Water Resour Res</source>. <year>2015</year>;<volume>51</volume>(<issue>12</issue>):<fpage>9804</fpage>–<lpage>27</lpage>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kim</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Or</surname> <given-names>D</given-names></name>. <article-title>Individual-Based Model of Microbial Life on Hydrated Rough Soil Surfaces</article-title>. <source>PLoS One</source>. <year>2016</year>;<volume>11</volume>(<issue>1</issue>).</mixed-citation></ref>
<ref id="pcbi.1007127.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oberhardt</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Palsson</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Papin</surname> <given-names>JA</given-names></name>. <article-title>Applications of genome-scale metabolic reconstructions</article-title>. <source>Molecular Systems Biology</source>. <year>2009</year>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Biggs</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Papin</surname> <given-names>JA</given-names></name>. <article-title>Novel Multiscale Modeling Tool Applied to Pseudomonas aeruginosa Biofilm Formation</article-title>. <source>PLoS One</source>. <year>2013</year>;<volume>8</volume>(<issue>10</issue>).</mixed-citation></ref>
<ref id="pcbi.1007127.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Harcombe</surname> <given-names>WR</given-names></name>, <name name-style="western"><surname>Riehl</surname> <given-names>WJ</given-names></name>, <name name-style="western"><surname>Dukovski</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Granger</surname> <given-names>BR</given-names></name>, <name name-style="western"><surname>Betts</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lang</surname> <given-names>AH</given-names></name>, <etal>et al</etal>. <article-title>Metabolic resource allocation in individual microbes determines ecosystem interactions and spatial dynamics</article-title>. <source>Cell Rep</source>. <year>2014</year>;<volume>7</volume>(<issue>4</issue>):<fpage>1104</fpage>–<lpage>15</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.celrep.2014.03.070" xlink:type="simple">10.1016/j.celrep.2014.03.070</ext-link></comment> <object-id pub-id-type="pmid">24794435</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bauer</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Zimmermann</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Baldini</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Thiele</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Kaleta</surname> <given-names>C</given-names></name>. <article-title>BacArena: Individual-based metabolic modeling of heterogeneous microbes in complex communities</article-title>. <source>PLoS Comput Biol</source>. <year>2017</year>;<volume>13</volume>(<issue>5</issue>).</mixed-citation></ref>
<ref id="pcbi.1007127.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cole</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Kohler</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Hedhli</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Luthey-Schulten</surname> <given-names>Z</given-names></name>. <article-title>Spatially-resolved metabolic cooperativity within dense bacterial colonies</article-title>. <source>BMC Syst Biol</source>. <year>2015</year>;<volume>9</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>17</lpage>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chenu</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hassink</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bloem</surname> <given-names>J</given-names></name>. <article-title>Short-term changes in the spatial distribution of microorganisms in soil aggregates as affected by glucose addition</article-title>. <source>Biol Fertil Soils</source>. <year>2001</year>;<volume>34</volume>(<issue>5</issue>):<fpage>349</fpage>–<lpage>56</lpage>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Orth</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Thiele</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Palsson</surname> <given-names>BØ</given-names></name>. <article-title>What is flux balance analysis?</article-title> <source>Nat Biotechnol</source>. <year>2010</year>;<volume>28</volume>(<issue>3</issue>):<fpage>245</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.1614" xlink:type="simple">10.1038/nbt.1614</ext-link></comment> <object-id pub-id-type="pmid">20212490</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tuller</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Or</surname> <given-names>D</given-names></name>. <article-title>Hydraulic conductivity of variably saturated porous media: Film and corner flow in angular pore space</article-title>. <source>Water Resour Res</source>. <year>2001</year>;<volume>37</volume>(<issue>5</issue>):<fpage>1257</fpage>–<lpage>76</lpage>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tuller</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dani</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Dudley</surname> <given-names>LM</given-names></name>. <article-title>Adsorption and capillary condensation in porous media: Liquid retention and interfacial configurations in angular pores</article-title>. <source>Water Resour Res</source>. <year>1999</year>;<volume>35</volume>(<issue>7</issue>):<fpage>1949</fpage>–<lpage>64</lpage>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ebrahimi</surname> <given-names>AN</given-names></name>, <name name-style="western"><surname>Or</surname> <given-names>D</given-names></name>. <article-title>Microbial dispersal in unsaturated porous media: Characteristics of motile bacterial cell motions in unsaturated angular pore networks</article-title>. <source>Water Resour Res</source>. <year>2014</year>;<volume>50</volume>(<issue>9</issue>):<fpage>7406</fpage>–<lpage>29</lpage>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tecon</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Or</surname> <given-names>D</given-names></name>. <article-title>Bacterial flagellar motility on hydrated rough surfaces controlled by aqueous film thickness and connectedness</article-title>. <source>Sci Rep</source>. <year>2016</year>;<volume>6</volume>:<fpage>19409</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/srep19409" xlink:type="simple">10.1038/srep19409</ext-link></comment> <object-id pub-id-type="pmid">26757676</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kreft</surname> <given-names>JU</given-names></name>, <name name-style="western"><surname>Booth</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wimpenny</surname> <given-names>JWT</given-names></name>. <article-title>BacSim, a simulator for individual-based modelling of bacterial colony growth</article-title>. <source>Microbiology</source>. <year>1998</year>;<volume>144</volume>:<fpage>3275</fpage>–<lpage>87</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1099/00221287-144-12-3275" xlink:type="simple">10.1099/00221287-144-12-3275</ext-link></comment> <object-id pub-id-type="pmid">9884219</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mahadevan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Edwards</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Doyle</surname> <given-names>FJ</given-names></name>. <article-title>Dynamic Flux Balance Analysis of diauxic growth in Escherichia coli</article-title>. <source>Biophys J</source>. <year>2002</year>;<volume>83</volume>(<issue>3</issue>):<fpage>1331</fpage>–<lpage>40</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0006-3495(02)73903-9" xlink:type="simple">10.1016/S0006-3495(02)73903-9</ext-link></comment> <object-id pub-id-type="pmid">12202358</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berg</surname> <given-names>HC</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>DA</given-names></name>. <article-title>Chemotaxis in <italic>Escherichia coli</italic> analysed by three-dimensional tracking</article-title>. <source>Nature</source>. <year>1972</year>;<volume>239</volume>:<fpage>500</fpage>–<lpage>4</lpage>. <object-id pub-id-type="pmid">4563019</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dechesne</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gulez</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Or</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Smets</surname> <given-names>BF</given-names></name>. <article-title>Hydration-controlled bacterial motility and dispersal on surfaces</article-title>. <source>Proc Natl Acad Sci</source>. <year>2010</year>;<volume>107</volume>(<issue>32</issue>):<fpage>14369</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1008392107" xlink:type="simple">10.1073/pnas.1008392107</ext-link></comment> <object-id pub-id-type="pmid">20660312</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Or</surname> <given-names>D</given-names></name>. <article-title>Aqueous films limit bacterial cell motility and colony expansion on partially saturated rough surfaces</article-title>. <source>Environ Microbiol</source>. <year>2010</year>;<volume>12</volume>(<issue>5</issue>):<fpage>1363</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1462-2920.2010.02180.x" xlink:type="simple">10.1111/j.1462-2920.2010.02180.x</ext-link></comment> <object-id pub-id-type="pmid">20192969</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Phan T</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Morris</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Lam</surname> <given-names>HT</given-names></name>, <name name-style="western"><surname>Hulamm</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Black</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Bos</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Emergence of Escherichia coli critically buckled motile helices under stress</article-title>. <source>Proc Natl Acad Sci</source>. <year>2018</year>;<volume>115</volume>(<issue>51</issue>):<fpage>12979</fpage>–<lpage>84</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1809374115" xlink:type="simple">10.1073/pnas.1809374115</ext-link></comment> <object-id pub-id-type="pmid">30498027</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ataman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hernandez Gardiol</surname> <given-names>DF</given-names></name>, <name name-style="western"><surname>Fengos</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Hatzimanikatis</surname> <given-names>V</given-names></name>. <article-title>redGEM: Systematic reduction and analysis of genome-scale metabolic reconstructions for development of consistent core metabolic models</article-title>. <source>PLoS Comput Biol</source>. <year>2017</year>;<volume>13</volume>(<issue>7</issue>):<fpage>e1005444</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005444" xlink:type="simple">10.1371/journal.pcbi.1005444</ext-link></comment> <object-id pub-id-type="pmid">28727725</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ataman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hatzimanikatis</surname> <given-names>V</given-names></name>. <article-title>lumpGEM: Systematic generation of subnetworks and elementally balanced lumped reactions for the biosynthesis of target metabolites</article-title>. <source>PLoS Comput Biol</source>. <year>2017</year>;<volume>13</volume>(<issue>7</issue>):<fpage>e1005513</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005513" xlink:type="simple">10.1371/journal.pcbi.1005513</ext-link></comment> <object-id pub-id-type="pmid">28727789</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gudmundsson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Thiele</surname> <given-names>I</given-names></name>. <article-title>Computationally efficient flux variability analysis</article-title>. <source>BMC Bioinformatics</source>. <year>2010</year>;<volume>11</volume>(<issue>1</issue>):<fpage>489</fpage>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hädicke</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Klamt</surname> <given-names>S</given-names></name>. <article-title>EColiCore2: A reference network model of the central metabolism of Escherichia coli and relationships to its genome-scale parent model</article-title>. <source>Sci Rep</source>. <year>2017</year>;<volume>7</volume>:<fpage>39647</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/srep39647" xlink:type="simple">10.1038/srep39647</ext-link></comment> <object-id pub-id-type="pmid">28045126</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Großkopf</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Soyer</surname> <given-names>OS</given-names></name>. <article-title>Synthetic microbial communities</article-title>. <source>Curr Opin Microbiol</source>. <year>2014</year>;<volume>18</volume>(<issue>1</issue>):<fpage>72</fpage>–<lpage>7</lpage>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Phillips</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kondev</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Theriot</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Garcia</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Chasan</surname> <given-names>B</given-names></name>. <article-title>Physical Biology of the Cell</article-title>. <source>Am J Phys</source>. <year>2010</year>;<volume>78</volume>(<issue>11</issue>):<fpage>1230</fpage>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nogales</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Palsson</surname> <given-names>BØ</given-names></name>, <name name-style="western"><surname>Thiele</surname> <given-names>I</given-names></name>. <article-title>A genome-scale metabolic reconstruction of Pseudomonas putida KT2440: iJN746 as a cell factory</article-title>. <source>BMC Syst Biol</source>. <year>2008</year>;<volume>2</volume>(<issue>1</issue>):<fpage>79</fpage>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Babaei</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Marashi</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Asad</surname> <given-names>S</given-names></name>. <article-title>Genome-scale reconstruction of the metabolic network in Pseudomonas stutzeri A1501</article-title>. <source>Mol Biosyst</source>. <year>2015</year>;<volume>11</volume>(<issue>11</issue>):<fpage>3022</fpage>–<lpage>32</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1039/c5mb00086f" xlink:type="simple">10.1039/c5mb00086f</ext-link></comment> <object-id pub-id-type="pmid">26302703</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Scheffer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Baveco</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Deangelis</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Rose</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Vannes</surname> <given-names>EH</given-names></name>. <article-title>Super-individuals a simple solution for modeling large populations on an individual basis</article-title>. <source>Ecol Modell</source>. <year>1995</year>;<volume>80</volume>(<issue>2–3</issue>):<fpage>161</fpage>–<lpage>70</lpage>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Long</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Or</surname> <given-names>D</given-names></name>. <article-title>Dynamics of microbial growth and coexistence on variably saturated rough surfaces</article-title>. <source>Microb Ecol</source>. <year>2009</year>;<volume>58</volume>(<issue>2</issue>):<fpage>262</fpage>–<lpage>75</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00248-009-9510-3" xlink:type="simple">10.1007/s00248-009-9510-3</ext-link></comment> <object-id pub-id-type="pmid">19352771</object-id></mixed-citation></ref>
<ref id="pcbi.1007127.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Parry</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Bithell</surname> <given-names>M</given-names></name>. <article-title>Large scale agent-based modelling: A review and guidelines for model scaling</article-title>. <source>In: Agent-Based Models of Geographical Systems</source>. <year>2012</year>. p. <fpage>271</fpage>–<lpage>308</lpage>.</mixed-citation></ref>
<ref id="pcbi.1007127.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wimpenny</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Coombs</surname> <given-names>JP</given-names></name>. <article-title>Penetration of oxygen into bacterial colonies</article-title>. <source>J Gen Microbiol</source>. <year>1983</year>;<volume>129</volume>(<issue>4</issue>):<fpage>1239</fpage>–<lpage>42</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1099/00221287-129-4-1239" xlink:type="simple">10.1099/00221287-129-4-1239</ext-link></comment> <object-id pub-id-type="pmid">6411858</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>