<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01314</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005459</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Metabolism</subject><subj-group><subject>Metabolites</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Enzymology</subject><subj-group><subject>Enzyme chemistry</subject><subj-group><subject>Enzyme metabolism</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Microbial evolution</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Organismal evolution</subject><subj-group><subject>Microbial evolution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Organismal evolution</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Network analysis</subject><subj-group><subject>Metabolic networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>DNA</subject><subj-group><subject>DNA metabolism</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Nucleic acids</subject><subj-group><subject>DNA</subject><subj-group><subject>DNA metabolism</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecological niches</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecological niches</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Beware batch culture: Seasonality and niche construction predicted to favor bacterial adaptive diversification</article-title>
<alt-title alt-title-type="running-head">Seasonality favors bacterial adaptive diversification</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9224-5819</contrib-id>
<name name-style="western">
<surname>Rocabert</surname> <given-names>Charles</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Knibbe</surname> <given-names>Carole</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3185-803X</contrib-id>
<name name-style="western">
<surname>Consuegra</surname> <given-names>Jessika</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Schneider</surname> <given-names>Dominique</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Beslon</surname> <given-names>Guillaume</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Univ. de Lyon, CNRS, INRIA, INSA-Lyon, UCB Lyon 1, LIRIS UMR5205, Lyon, France</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Univ. Grenoble Alpes, Laboratoire Techniques de l’Ingénierie Médicale et de la Complexité - Informatique, Mathématiques et Applications, Grenoble (TIMC-IMAG), Grenoble, France</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Centre National de la Recherche Scientifique (CNRS), TIMC-IMAG, Grenoble, France</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Tanaka</surname> <given-names>Mark M.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of New South Wales, AUSTRALIA</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item>
<p><bold>Formal analysis:</bold> CR CK JC DS GB.</p>
</list-item>
<list-item>
<p><bold>Methodology:</bold> CR CK DS GB.</p>
</list-item>
<list-item>
<p><bold>Software:</bold> CR CK GB.</p>
</list-item>
<list-item>
<p><bold>Writing – original draft:</bold> CR CK GB.</p>
</list-item>
<list-item>
<p><bold>Writing – review &amp; editing:</bold> CR CK JC DS GB.</p>
</list-item>
</list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">guillaume.beslon@inria.fr</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>3</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>30</day>
<month>3</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>3</issue>
<elocation-id>e1005459</elocation-id>
<history>
<date date-type="received">
<day>12</day>
<month>8</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>16</day>
<month>3</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Rocabert et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005459"/>
<abstract>
<p>Metabolic cross-feeding interactions between microbial strains are common in nature, and emerge during evolution experiments in the laboratory, even in homogeneous environments providing a single carbon source. In sympatry, when the environment is well-mixed, the reasons why emerging cross-feeding interactions may sometimes become stable and lead to monophyletic genotypic clusters occupying specific niches, named ecotypes, remain unclear. As an alternative to evolution experiments in the laboratory, we developed Evo<sup>2</sup>Sim, a multi-scale model of <italic>in silico</italic> experimental evolution, equipped with the whole tool case of experimental setups, competition assays, phylogenetic analysis, and, most importantly, allowing for evolvable ecological interactions. Digital organisms with an evolvable genome structure encoding an evolvable metabolic network evolved for tens of thousands of generations in environments mimicking the dynamics of real controlled environments, including chemostat or batch culture providing a single limiting resource. We show here that the evolution of stable cross-feeding interactions requires seasonal batch conditions. In this case, adaptive diversification events result in two stably co-existing ecotypes, with one feeding on the primary resource and the other on by-products. We show that the regularity of serial transfers is essential for the maintenance of the polymorphism, as it allows for at least two stable seasons and thus two temporal niches. A first season is externally generated by the transfer into fresh medium, while a second one is internally generated by niche construction as the provided nutrient is replaced by secreted by-products derived from bacterial growth. In chemostat conditions, even if cross-feeding interactions emerge, they are not stable on the long-term because fitter mutants eventually invade the whole population. We also show that the long-term evolution of the two stable ecotypes leads to character displacement, at the level of the metabolic network but also of the genome structure. This difference of genome structure between both ecotypes impacts the stability of the cross-feeding interaction, when the population is propagated in chemostat conditions. This study shows the crucial role played by seasonality in temporal niche partitioning and in promoting cross-feeding subgroups into stable ecotypes, a premise to sympatric speciation.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Stable bacterial cross-feeding interactions, where one strain feeds on the waste of the other, are important to understand, as they can be a first step toward bacterial speciation. Their emergence is commonly observed in laboratory experiments using <italic>Escherichia coli</italic> as a model organism. Yet it is not clear how cross-feeding interactions can resist the invasion of a fitter mutant when the environment contains a single resource since there seems to be a single ecological niche. Here, we used another kind of “model organism”, a digital one, allowing for detailed and fast investigations, and providing a way to disentangle generic evolutionary mechanisms from specificities associated with <italic>E. coli</italic>. Digital organisms with evolvable genomes and metabolic networks compete for resources in conditions mimicking laboratory evolution experiments. In chemostat simulations, although cross-feeding interactions regularly emerged, selective sweeps regularly purged the population of its diversity. By contrast, batch culture allowed for much more stable cross-feeding interactions, because it includes seasons and thus distinct temporal niches, thereby favoring the adaptive diversification of proto-species.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004963</institution-id>
<institution>Seventh Framework Programme</institution>
</institution-wrap>
</funding-source>
<award-id>610427</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Beslon</surname> <given-names>Guillaume</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004792</institution-id>
<institution>Ministère de l’Enseignement Supérieur et de la Recherche</institution>
</institution-wrap>
</funding-source>
<award-id>PhD fellowship</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3185-803X</contrib-id>
<name name-style="western">
<surname>Consuegra</surname> <given-names>Jessika</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by the European Commission 7th Framework Programme 659 (FP7-ICT-2013.9.6 FET Proactive: Evolving Living Technologies, <ext-link ext-link-type="uri" xlink:href="https://ec.europa.eu/research/fp7/" xlink:type="simple">https://ec.europa.eu/research/fp7/</ext-link>) EvoEvo project 660 (ICT-610427, <ext-link ext-link-type="uri" xlink:href="http://www.evoevo.eu/" xlink:type="simple">http://www.evoevo.eu/</ext-link>). JC thanks the French Ministry of Research for a PhD fellowship. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="12"/>
<table-count count="5"/>
<page-count count="32"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-04-13</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All the material necessary to replay experiments (software, parameter files, strain backups, …) is freely available at <ext-link ext-link-type="uri" xlink:href="http://www.evoevo.eu/adaptive-diversification-simulations/" xlink:type="simple">http://www.evoevo.eu/adaptive-diversification-simulations/</ext-link>. The latest version of Evo2Sim is available at <ext-link ext-link-type="uri" xlink:href="http://www.evoevo.eu/evo2sim-software/" xlink:type="simple">http://www.evoevo.eu/evo2sim-software/</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Stable metabolic cross-feeding interactions between microbial strains are commonly observed in nature [<xref ref-type="bibr" rid="pcbi.1005459.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1005459.ref004">4</xref>]. For example, nitrification, an important step of the nitrogen cycle, is carried out in consecutive steps by several bacterial species maintaining cross-feeding interactions [<xref ref-type="bibr" rid="pcbi.1005459.ref003">3</xref>]. In laboratory experiments, microbial populations also demonstrated their ability to quickly establish metabolic cross-feeding interactions between morphotypes [<xref ref-type="bibr" rid="pcbi.1005459.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1005459.ref013">13</xref>].</p>
<p>An important question, at the crossroads between ecology and evolution, is the evolutionary stability of such cross-feeding polymorphisms, because they are often considered to be the first steps toward speciation. According to Cohan [<xref ref-type="bibr" rid="pcbi.1005459.ref014">14</xref>], the species concept in bacteria should not rely on the named species of systematics but on the notion of <italic>ecotype</italic>, which itself relies on the ecological and evolutionary dynamics of the subpopulations. Two bacterial subpopulations may be considered as different ecotypes if they form monophyletic clusters, occupy different ecological niches and if periodic selection purges diversity in one subpopulation independently from the other [<xref ref-type="bibr" rid="pcbi.1005459.ref014">14</xref>]. A cross-feeding polymorphism therefore leads to adaptive diversification and ultimately to speciation when it is stable enough to resist the invasion of a mutant that would otherwise take over the whole population.</p>
<p>If the environment is spatially structured, the stabilization of new ecotypes that emerged after an adaptive diversification event is facilitated by the locality of environmental conditions and frequency-dependent interactions. This mechanism of allopatric (or micro-allopatric) divergence is well-known, since ecotypes can escape competitive exclusion in their local niches [<xref ref-type="bibr" rid="pcbi.1005459.ref014">14</xref>]. For example, <italic>Pseudomonas fluorescens</italic> populations have been shown to produce adaptive diversification events in spatially heterogeneous environments, but not in homogenized conditions [<xref ref-type="bibr" rid="pcbi.1005459.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref006">6</xref>].</p>
<p>Microbial populations can also exhibit adaptive diversification in sympatry, when the environment is homogeneous with a single carbon source. In this case, the stability of ecotypes is maintained by frequency-dependent interactions, often due to cross-feeding interactions, as observed in the Long-Term Evolution Experiment with <italic>Escherichia coli</italic> (LTEE [<xref ref-type="bibr" rid="pcbi.1005459.ref015">15</xref>]). In this ongoing experiment, 12 populations are being independently propagated in a constant glucose-limited environment in batch culture since 1988. The experiment reached 66,000 generations at the time of this writing. Every day, 1% of the population is transferred into fresh medium such that each population experiences a daily cycle of feast and famine phases. In one of the 12 populations, a long-term polymorphism has been observed [<xref ref-type="bibr" rid="pcbi.1005459.ref011">11</xref>]. Two ecotypes, named S and L (for Small and Large, related to their respective colony sizes on plate), evolved from a common ancestor before generation 6,500. The L ecotype grows efficiently on glucose, while the S ecotype mainly grows on acetate, a by-product secreted by L [<xref ref-type="bibr" rid="pcbi.1005459.ref016">16</xref>]. Experiments showed that the interaction between S and L ecotypes relies on negative frequency-dependent selection, each ecotype having a selective advantage when rare. This balanced polymorphism is now stable for more than 55,000 generations [<xref ref-type="bibr" rid="pcbi.1005459.ref011">11</xref>]. It was also shown that S and L ecotypes specialized in their own niches, the L ecotype increasing its ability to grow on glucose but not on acetate, and conversely for the S ecotype [<xref ref-type="bibr" rid="pcbi.1005459.ref016">16</xref>].</p>
<p>The evolutionary stability of this polymorphism may be explained by the temporal niche partitioning that arises from the periodic transfers into fresh medium [<xref ref-type="bibr" rid="pcbi.1005459.ref017">17</xref>]. A first season starts immediately after a transfer, when the environment contains mostly glucose. The L ecotype grows during this season, consumes glucose and secretes acetate, thereby generating a second season where the environment contains mostly acetate and supports the growth of the S ecotype.</p>
<p>Yet several experiments have shown that microbial populations can also evolve cross-feeding interactions in a chemostat in a few tens of generations [<xref ref-type="bibr" rid="pcbi.1005459.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref010">10</xref>]. Those interactions appear to be stable over a few hundreds of generations [<xref ref-type="bibr" rid="pcbi.1005459.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref010">10</xref>]. In chemostat, there is no obvious spatial or temporal niche partitioning and it is thus intriguing that the dynamics predicted by the competitive exclusion principle has not been observed so far. Indeed, one would expect a mutant to eventually appear, which would either completely degrade glucose or feed on both glucose and acetate, thereby outcompeting the specialized ecotypes. It has been proposed that energy constraints and flux optimization principles prevent competitive exclusion, thereby stabilizing the polymorphism [<xref ref-type="bibr" rid="pcbi.1005459.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref019">19</xref>]. However, experimental evolution in chemostat has generally been performed for only a few hundreds of generations (up to 1,900 generations in [<xref ref-type="bibr" rid="pcbi.1005459.ref007">7</xref>]), precluding the possibility to confirm this statement on a longer term.</p>
<p>Thus, as a step to better understand how cross-feeding, niche construction and seasonality contribute to microbial diversification, we addressed here the following question: What makes emerging cross-feeding interactions stable in the long-term, in single carbon source batch culture or chemostat experiments?</p>
<p>While experimental evolution provides a very precise picture of evolution, it remains a long and costly process. An alternative approach consists in simulating evolution in a computer. <italic>In Silico</italic> Experimental Evolution (ISEE), where digital organisms are evolved for tens of thousands of generations, reproduces the environmental conditions of experimental evolution [<xref ref-type="bibr" rid="pcbi.1005459.ref020">20</xref>]. Like in the wet approach, it is possible to simulate several independent populations to understand the respective importance of general laws and historical contingencies. In addition, ISEE provides an exhaustive fossil record and, more importantly, allows for “impossible experiments” [<xref ref-type="bibr" rid="pcbi.1005459.ref021">21</xref>], like saving the fitness at full resolution for tens of thousands of generations, or changing any parameter (mutation rates, environment fluxes) at will.</p>
<p>We developed Evo<sup>2</sup>Sim, a multi-scale computational model of <italic>in silico</italic> experimental evolution. Evo<sup>2</sup>Sim allows us to address many questions raised by experimental evolution [<xref ref-type="bibr" rid="pcbi.1005459.ref020">20</xref>]. Typically, we can use it to investigate how evolution shapes the different organization levels of an organism (<italic>e.g.</italic>, genome size, complexity of the regulation network and metabolic network) and of an ecosystem (polymorphism, speciation) depending on global parameters such as environmental conditions or mutation rates. Here, we tested which environmental conditions can lead to stable adaptive diversification events, by reproducing the resource dynamics of experimental evolution setups like chemostat and batch culture.</p>
<p>Previous mathematical works have already studied the conditions of interspecific coexistence via resource partitioning [<xref ref-type="bibr" rid="pcbi.1005459.ref022">22</xref>], and of cross-feeding interactions [<xref ref-type="bibr" rid="pcbi.1005459.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref024">24</xref>], during one or more competition episodes. Stewart and Levin [<xref ref-type="bibr" rid="pcbi.1005459.ref022">22</xref>] studied the conditions of coexistence of several ecotypes in batch culture and chemostat. However, they focused on a single episode of competition between preexisting strains without modeling a random mutational process. Moreover, the strains were not allowed to cross-feed on by-products of other strains. Rozen et al. [<xref ref-type="bibr" rid="pcbi.1005459.ref013">13</xref>] and Ribeck and Lenski [<xref ref-type="bibr" rid="pcbi.1005459.ref025">25</xref>] modeled analytically the cross-feeding interaction between S and L ecotypes in the LTEE, showing the existence of negative frequency-dependence in batch conditions. These models also did not include a mutational process. Gudelj and colleagues [<xref ref-type="bibr" rid="pcbi.1005459.ref024">24</xref>] studied the short-term dynamics of two competitors in various environmental conditions including batch and chemostat, and showed that stable cross-feeding was possible, depending on initial competitors frequency and resource abundance. Again, this model did not include the mutational process. Other mathematical studies introduced a simplified evolutionary dynamics, by computing successions of competition episodes and introduction of fit mutants. For example, Pfeiffer and Bonhoeffer [<xref ref-type="bibr" rid="pcbi.1005459.ref018">18</xref>] studied the conditions of emergence of stable cross-feeding in chemostat conditions, when a trade-off on ATP production is introduced on abstract metabolic pathways. Doebeli [<xref ref-type="bibr" rid="pcbi.1005459.ref023">23</xref>] compared the conditions of emergence of cross-feeding polymorphism in chemostat and batch culture. The authors concluded that the evolution of cross-feeding is more likely in chemostat than in batch culture. However, this model forced a trade-off between consumption rates of glucose and acetate, forbidding the emergence of a generalist mutant. Two rates are evolvable but only the glucose consumption rate is mutable, as the acetate rate is deduced from the glucose rate. The rate at which acetate is secreted is constant (<italic>i.e.</italic>, it does not depend on glucose consumption, which could affect the generality of the conclusions). Thus, none of the previous models take into account a realistic random mutational process, and none of them explicitly models the genomic level. Indeed, it is difficult to include a competition process as well as realistic mutational dynamics in a single mathematical model. Another approach consists in simulating evolution with individual-based models.</p>
<p>Computational models of <italic>in silico</italic> experimental evolution have already been used to explore the evolution of cross-feeding interactions. Johnson and Wilke [<xref ref-type="bibr" rid="pcbi.1005459.ref026">26</xref>] used the Avida software [<xref ref-type="bibr" rid="pcbi.1005459.ref027">27</xref>] to study the evolution of resource competition between two digital species coexisting via mutualistic cross-feeding in a closed environment, with only two possible metabolites. However, they did not test the influence of the environmental dynamics. Williams and Lenton [<xref ref-type="bibr" rid="pcbi.1005459.ref028">28</xref>] used an individual-based evolutionary model to explore the stability of connected ecosystems undergoing cross-feeding and “evolutionary regime shifts”. Yet, the genotype-to-phenotype mapping of their organisms was rather simple (fixed size arrays defining the affinity of the organism for each resource), thus not allowing to study the effects of ecological dynamics on genome and metabolic network structures. Crombach and Hogeweg [<xref ref-type="bibr" rid="pcbi.1005459.ref029">29</xref>] and Boyle et al. [<xref ref-type="bibr" rid="pcbi.1005459.ref030">30</xref>] studied the evolution of resource cycling and its stability. In the first model [<xref ref-type="bibr" rid="pcbi.1005459.ref029">29</xref>], the resource cycling was imposed by the system. In the second model [<xref ref-type="bibr" rid="pcbi.1005459.ref030">30</xref>], the environment was strongly structured (patches of individuals with random migration events), such that it was not possible to study sympatric diversification. Chow and colleagues [<xref ref-type="bibr" rid="pcbi.1005459.ref031">31</xref>] used Avida [<xref ref-type="bibr" rid="pcbi.1005459.ref027">27</xref>] to explore the relation between productivity and diversity in a digital ecosystem under mixed influx of nine pre-defined resources, while Gerlee and Lundh [<xref ref-type="bibr" rid="pcbi.1005459.ref019">19</xref>] explained the maintenance of cross-feeding interactions in a microbial population by energy and efficiency constraints on metabolic fluxes. To do so, they developed an individual-based model evolving simple binary strings, thereby precluding evolvable interactions between the different organization levels of an organism, and their possible effects on the ecological dynamics. Gerlee and Lundh [<xref ref-type="bibr" rid="pcbi.1005459.ref032">32</xref>] also related ecosystem productivity to energy-uptake efficiency, with the same type of individual-based model as in [<xref ref-type="bibr" rid="pcbi.1005459.ref019">19</xref>]. Recently, Liu and Sumpter [<xref ref-type="bibr" rid="pcbi.1005459.ref033">33</xref>] used an individual-based model evolving artificial ecosystems relying on a “number soup”: In this model, each species perform one modular addition transforming specific numbers into others, immediately available for other species. With their model, authors showed that artificial ecosystems always self-organize to consume all the available resources. While stable cross-feeding, and reciprocal cross-feeding, are common evolutionary outcomes in their model, authors also show that whole population extinctions sometimes occur, even without external perturbations. Yet, the absence of complex and evolvable genotype-to-phenotype map in their model precludes the possibility to get insights into the influence of ecosystem evolution on the structure of the organisms. Finally, Großkopf et al. [<xref ref-type="bibr" rid="pcbi.1005459.ref016">16</xref>] predicted the adaptive diversification event leading to S and L ecotypes in the LTEE, by mixing flux balance analysis (FBA) and <italic>in silico</italic> evolution in a single model. By modeling the evolution of reaction rates in the metabolic network of <italic>Escherichia coli</italic>, they demonstrated that the emergence of a stable cross-feeding similar to S and L interaction is highly probable in the LTEE conditions. However, in their model, digital organisms are highly constrained (there is no innovation, <italic>e.g.</italic> new by-products cannot appear in the evolutionary process). To the best of our knowledge, none of these individual-based models compared the evolution of stable cross-feeding in different experimental setups, such as batch culture or chemostat.</p>
<p>To sum up, we were not able to find in the literature models that combine: <bold>(i)</bold> an explicit mutational process along with the modeling of natural selection and drift, <bold>(ii)</bold> evolvability at all organization levels (genome structure, metabolic network, number of reactions, number of metabolites, reaction rates, …), and <bold>(iii)</bold> a comparison between batch culture and chemostat.</p>
<p>Our results show that <italic>stable</italic> cross-feeding interactions are favored in batch culture, owing to the seasonality of the environment. In continuous culture, the absence of seasonality precludes niche construction and leads to competitive exclusion, even if the population is initially composed of two ecotypes maintaining frequency-dependent interactions. We also demonstrate that the long-term evolution of a stable cross-feeding interaction in batch culture leads to character displacement [<xref ref-type="bibr" rid="pcbi.1005459.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref034">34</xref>], at the level of the metabolic network but also of the genome structure. This difference of genome structure between the two ecotypes has an impact on the further stability of the cross-feeding interaction when the population is propagated into continuous culture.</p>
<sec id="sec002">
<title>Model</title>
<p>Evo<sup>2</sup>Sim is a multi-scale and individual-based computational model. Digital bacterial-like organisms own a coarse-grained genome that contains genomic units encoding a simplified metabolic network. The organisms evolve on a two-dimensional toroidal grid (the environment), uptaking, transforming and releasing metabolites, and dividing in the presence of empty spots or dying. Extracellular metabolites diffuse across the grid spots. In this model, metabolites are implicit molecules identified by a tag <inline-formula id="pcbi.1005459.e001"><alternatives><graphic id="pcbi.1005459.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005459.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">N</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. The model is described in more details below, and summarized in <xref ref-type="fig" rid="pcbi.1005459.g001">Fig 1</xref>. The source code is written in C++. All the material necessary to replay experiments (software, parameter files, strain backups, …) is freely available at <ext-link ext-link-type="uri" xlink:href="http://www.evoevo.eu/adaptive-diversification-simulations/" xlink:type="simple">http://www.evoevo.eu/adaptive-diversification-simulations/</ext-link>. The latest version of Evo<sup>2</sup>Sim is available at <ext-link ext-link-type="uri" xlink:href="http://www.evoevo.eu/evo2sim-software/" xlink:type="simple">http://www.evoevo.eu/evo2sim-software/</ext-link>.</p>
<fig id="pcbi.1005459.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005459.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Presentation of the model.</title>
<p>The genotype-to-phenotype mapping, as well as the population and environment, are schematized here. <bold>(A)</bold> Description of the genotype-to-phenotype mapping. Organisms own a coarse-grained genome that contains genomic units. <bold>(A.1)</bold> Non-coding units (NC, grey circles) are not functional. The arrangement of the genomic units on the circular single strand defines functional regions, where a promoter (P, blue cross, <bold>A.2</bold>) controls the expression of all contiguous enzyme units (E, red circles), thereby allowing for operons. <bold>(A.3)</bold> When enzyme units are expressed, they contribute to the metabolic network. <bold>(A.4)</bold> Enzymes perform metabolic reactions in the cytoplasm, or pump metabolites in or out (see the description of the metabolic network below). The score of an organism is computed from its “essential metabolites” (see the description of the score function below). Lethal toxicity thresholds are applied to each metabolic concentration and preclude organisms to accumulate resources. <bold>(B)</bold> Description of the population and environment levels. Organisms are placed on a 2D toroidal grid, and compete for resources and space. <bold>(B.1)</bold> When an organism dies, it leaves its grid spot empty and organisms in the Moore neighborhood (if any) compete to divide in the available spot. The competition is based on scores, a minimal threshold being applied on scores to preclude worst organisms to divide. At division, daughters share cytoplasm content (enzymes and metabolites). At death, metabolites from the cytoplasm are released in the local environment and diffuse on the grid. <bold>(B.2)</bold> At the largest scale, the population evolves in the environment by uptaking, transforming and releasing metabolites. Metabolites then diffuse and are optionally degraded. This interaction between the population and its environment allows for the evolution of complex ecological situations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.g001" xlink:type="simple"/>
</fig>
<sec id="sec003">
<title>Genome structure</title>
<p>The genome is a circular single-stranded sequence of genomic units, inspired from [<xref ref-type="bibr" rid="pcbi.1005459.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref036">36</xref>]. Genomic units belong to three different types: non-coding units (NC), promoter units (P), and enzyme coding units (E). The order of the units in the genome determines the existence of functional regions, meaning that not all sequences of units are functional. The functional regions of a genome are those that have the following pattern: a promoter (P) followed by one or more enzyme coding units (E). A promoter can thus control several coding units, as bacterial operons. The first genomic unit that is not enzyme coding interrupts transcription and marks the end of the functional region.</p>
<p>Non-coding units (NC) have no particular function. They constitute the non-coding part of the genome. Promoter units (P) contain a floating-point number <italic>β</italic> ∈ [0.0, 1.0] representing the production rate of the protein(s) depending on the promoter. All the parameters and their units are listed in <xref ref-type="supplementary-material" rid="pcbi.1005459.s001">S1 Table</xref>. Enzyme coding units (E) contain two integers <italic>s</italic> and <inline-formula id="pcbi.1005459.e002"><alternatives><graphic id="pcbi.1005459.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005459.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">N</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, indicating the tag of the substrate and product respectively, two floating-point numbers <italic>k</italic><sub><italic>cat</italic></sub> ∈ ±[10<sup>−3</sup>, 10<sup>−1</sup>], and the ratio <italic>k</italic><sub><italic>cat</italic></sub>/<italic>K</italic><sub><italic>M</italic></sub> ∈ [10<sup>−5</sup>, 10<sup>−3</sup>] describing the enzymatic kinetics (see the description of the metabolic network below). In the special case where <italic>s</italic> = <italic>p</italic>, the enzyme is considered as a pump, actively pumping in (or out) the metabolite <italic>s</italic> if <italic>k</italic><sub><italic>cat</italic></sub> is positive (or negative, respectively). Initial genomes of 50 genomic units are generated. These genomes contain ten P and ten E, all with random positions and attribute values.</p>
<p>Upon cell division, the parental genome is replicated with mutations in the two daughter cells. Each genomic unit can undergo point mutations, meaning here changes in the numbers it contains, like the values of <italic>s</italic>, <italic>p</italic>, <italic>k</italic><sub><italic>cat</italic></sub> and <italic>k</italic><sub><italic>cat</italic></sub>/<italic>K</italic><sub><italic>M</italic></sub> for an E. Each unit attribute mutates at a rate of 10<sup>−3</sup> per attribute per replication. For the substrate/product tags, a mutation consists in randomly incrementing/decrementing <italic>s</italic> or <italic>p</italic> respectively. For <italic>k</italic><sub><italic>cat</italic></sub> or <italic>k</italic><sub><italic>cat</italic></sub>/<italic>K</italic><sub><italic>M</italic></sub>, a random number drawn from <inline-formula id="pcbi.1005459.e003"><alternatives><graphic id="pcbi.1005459.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005459.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is added to the decimal logarithm of the parameter. <italic>β</italic> mutates by adding a random number drawn from <inline-formula id="pcbi.1005459.e004"><alternatives><graphic id="pcbi.1005459.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005459.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. A genomic unit can also undergo a type transition from any unit type to any other at a predefined rate, set here to 10<sup>−3</sup> per genomic unit per replication. All types of genomic units are actually implemented as a tuple containing all possible attributes, like (unit_type, <italic>β</italic>, <italic>s</italic>, <italic>p</italic>, <italic>k</italic><sub><italic>cat</italic></sub>, <italic>k</italic><sub><italic>cat</italic></sub>/<italic>K</italic><sub><italic>M</italic></sub>). The unit type tells us which parameters are functionally relevant and the others are free to mutate neutrally.</p>
<p>The genome can also undergo rearrangements affecting segments of any number of genomic units. There are four types of rearrangements: duplications, deletions, translocations and inversions. All rearrangement rates are set to 10<sup>−3</sup> per genomic unit per replication, hence the number of rearrangements is related to the genome size thereby limiting genome expansion [<xref ref-type="bibr" rid="pcbi.1005459.ref037">37</xref>]. The breakpoints for each rearrangement are randomly drawn in the whole genome. In real genomes, spontaneous rearrangement breakpoints have no reason to lie exactly between two of our genomic units and could thus break our genomic units. To model that with our coarse-grained genome representation, we alter the content of the two genomic units that are adjacent to a rearrangement breakpoint. Suppose for example that a deletion joins two genomic units, one containing the attributes (unit_type<sub>1</sub>, <italic>β</italic><sub>1</sub>, <italic>s</italic><sub>1</sub>, <italic>p</italic><sub>1</sub>, <italic>k</italic><sub><italic>cat</italic>1</sub>, (<italic>k</italic><sub><italic>cat</italic></sub>/<italic>K</italic><sub><italic>M</italic></sub>)<sub>1</sub>) and the other the attributes (unit_type<sub>2</sub>, <italic>β</italic><sub>2</sub>, <italic>s</italic><sub>2</sub>, <italic>p</italic><sub>2</sub>, <italic>k</italic><sub><italic>cat</italic>2</sub>, (<italic>k</italic><sub><italic>cat</italic></sub>/<italic>K</italic><sub><italic>M</italic></sub>)<sub>2</sub>). Then for each attribute, there is a probability of 10<sup>−3</sup> for the value in unit 1 to be exchanged with the value in unit 2. Both units could for example exchange their values of <italic>s</italic>, thereby leading to (unit_type<sub>1</sub>, <italic>β</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>, <italic>p</italic><sub>1</sub>, <italic>k</italic><sub><italic>cat</italic>1</sub>, (<italic>k</italic><sub><italic>cat</italic></sub>/<italic>K</italic><sub><italic>M</italic></sub>)<sub>1</sub>) and (unit_type<sub>2</sub>, <italic>β</italic><sub>2</sub>, <italic>s</italic><sub>1</sub>, <italic>p</italic><sub>2</sub>, <italic>k</italic><sub><italic>cat</italic>2</sub>, (<italic>k</italic><sub><italic>cat</italic></sub>/<italic>K</italic><sub><italic>M</italic></sub>)<sub>2</sub>).</p>
</sec>
<sec id="sec004">
<title>Metabolic network</title>
<p>Gene products can either be pumps, pumping metabolites from or to the growth medium, or enzymes performing catalytic transformations in the metabolic space.</p>
<p>Let us consider an enzyme in the cytoplasm, that catalyzes one specific reaction <italic>s</italic> → <italic>p</italic>, with <inline-formula id="pcbi.1005459.e005"><alternatives><graphic id="pcbi.1005459.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005459.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mi>s</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">N</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005459.e006"><alternatives><graphic id="pcbi.1005459.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005459.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">N</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> being the substrate and the product of a Michaelis-Menten-like reaction, respectively. The variation in concentrations [<italic>E</italic>], [<italic>s</italic>] and [<italic>p</italic>] over time are then driven by <xref ref-type="disp-formula" rid="pcbi.1005459.e007">Eq 1</xref>:
<disp-formula id="pcbi.1005459.e007"><alternatives><graphic id="pcbi.1005459.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005459.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mo>[</mml:mo> <mml:mi>E</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle> <mml:mo>=</mml:mo> <mml:mi>β</mml:mi> <mml:mo>-</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>E</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mo>[</mml:mo> <mml:mi>s</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>E</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>s</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>K</mml:mi> <mml:mi>M</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>s</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:mo>[</mml:mo> <mml:mi>p</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle> <mml:mo>=</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>E</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>s</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>K</mml:mi> <mml:mi>M</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>s</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>β</italic> is the basal production rate specified in the promoter unit, <italic>ϕ</italic> is the enzyme degradation rate (set to 0.1 per centi-time-step for all enzymes here, with 1 centi-time-step = 0.01 time-steps), <italic>K</italic><sub><italic>M</italic></sub> and <italic>k</italic><sub><italic>cat</italic></sub> are the kinetic attributes of the enzyme (<italic>K</italic><sub><italic>M</italic></sub> being deduced from <italic>k</italic><sub><italic>cat</italic></sub> and <italic>k</italic><sub><italic>cat</italic></sub>/<italic>K</italic><sub><italic>M</italic></sub> attributes).</p>
<p>Pumps are treated here as special enzymes for which [<italic>s</italic>] and [<italic>p</italic>] describe the internal and external concentrations of the same metabolite. If <italic>k</italic><sub><italic>cat</italic></sub> is positive (resp. negative), [<italic>s</italic>] is the external (resp. internal) concentration of the metabolite and [<italic>p</italic>] the internal (resp. external) concentration. The dynamics of metabolic concentrations [<italic>s</italic>] and [<italic>p</italic>] are thus also driven by <xref ref-type="disp-formula" rid="pcbi.1005459.e007">Eq 1</xref> when the gene product is a pump.</p>
<p>Each organism has an ODE (Ordinary Differential Equation) system that keeps track of: <bold>(i)</bold> the concentrations of all metabolites inside the organism, <italic>i.e.</italic>, internal concentrations, <bold>(ii)</bold> the concentrations of all metabolites at the organism’s location on the grid, <italic>i.e.</italic>, external concentrations, and <bold>(iii)</bold> the concentrations of all proteins (pumps and enzymes) in the cytoplasm. For a very simple organism whose genome merely encodes one pump importing metabolite #10 into the cell, and one enzyme converting #10 to #7, the ODE system would read:
<disp-formula id="pcbi.1005459.e008">
<alternatives>
<graphic id="pcbi.1005459.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005459.e008" xlink:type="simple"/>
<mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>[</mml:mo><mml:mtext>Pump</mml:mtext><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mtext>Pump</mml:mtext></mml:msup><mml:mo>-</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mtext>Pump</mml:mtext><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>[</mml:mo><mml:mtext>Enzyme</mml:mtext><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mtext>Enzyme</mml:mtext></mml:msup><mml:mo>-</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mtext>Enzyme</mml:mtext><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>[</mml:mo><mml:mo>#</mml:mo><mml:msub><mml:mn>10</mml:mn><mml:mtext>external</mml:mtext></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mtext>Pump</mml:mtext></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mtext>Pump</mml:mtext><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mo>#</mml:mo><mml:msub><mml:mn>10</mml:mn><mml:mtext>external</mml:mtext></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mi>M</mml:mi><mml:mtext>Pump</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mo>#</mml:mo><mml:msub><mml:mn>10</mml:mn><mml:mtext>external</mml:mtext></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>[</mml:mo><mml:mo>#</mml:mo><mml:msub><mml:mn>10</mml:mn><mml:mtext>internal</mml:mtext></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mtext>Pump</mml:mtext></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mtext>Pump</mml:mtext><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mo>#</mml:mo><mml:msub><mml:mn>10</mml:mn><mml:mtext>external</mml:mtext></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mi>M</mml:mi><mml:mtext>Pump</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mo>#</mml:mo><mml:msub><mml:mn>10</mml:mn><mml:mtext>external</mml:mtext></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>-</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mtext>Enzyme</mml:mtext></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mtext>Enzyme</mml:mtext><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mo>#</mml:mo><mml:msub><mml:mn>10</mml:mn><mml:mtext>internal</mml:mtext></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mi>M</mml:mi><mml:mtext>Enzyme</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mo>#</mml:mo><mml:msub><mml:mn>10</mml:mn><mml:mtext>internal</mml:mtext></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>[</mml:mo><mml:mo>#</mml:mo><mml:msub><mml:mn>7</mml:mn><mml:mtext>internal</mml:mtext></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mtext>Enzyme</mml:mtext></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mtext>Enzyme</mml:mtext><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mo>#</mml:mo><mml:msub><mml:mn>10</mml:mn><mml:mtext>internal</mml:mtext></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mi>M</mml:mi><mml:mtext>Enzyme</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mo>#</mml:mo><mml:msub><mml:mn>10</mml:mn><mml:mtext>internal</mml:mtext></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives>
<label>(2)</label>
</disp-formula></p>
<p>The number of equations in the ODE system generally differs across individuals within a population because it depends on the number of functional genes, and chromosomal rearrangements like duplications and deletions can alter gene number. In practice, the size of the ODE system goes from tens to thousands of equations depending on the individual. Similarly, the parameter values of the ODE system also vary across individuals, as they are encoded in the organism’s genes and thus result from the mutation process.</p>
<p>Initially, in the individuals used to seed a run at time-step 0, each protein starts at its equilibrium concentration <italic>β</italic>/<italic>ϕ</italic>, and each metabolite starts with an internal concentration of 0.0 ACU (Arbitrary Concentration Unit). At time-step 0, for all grid spots, external concentrations are initialized to 0.0 ACU for all nutrients except for metabolite #10 (the exogenous carbon source). Between time-steps 0 and 1, the ODE system computes the dynamics of the metabolite and protein concentrations, using the adaptive Runge-Kutta-Cash-Karp method (RKCK), during 100 centi-time-steps. In organisms that possess a pump for metabolite #10, this metabolite will enter the cell. If the genome of this organism also encodes an enzyme to transform #10 into #7 for example, then the internal concentrations will show an accumulation of #7. At time-step 1, each organism will either die, divide or just survive (see paragraph “Population and environment” below for details). If the organism merely survives without dividing, its current internal concentrations are used as initial conditions for the computation of the next 100 centi-time-steps (<italic>i.e.</italic>, for the transition from time-step 1 to 2). If the organism divides, each of the two daughter cells inherits half of each metabolite and each protein amounts. These will constitute the initial conditions for each cell’s ODE system for the next 100 centi-time-steps. If the organism dies, its internal content is released into the environment, thereby increasing the local external concentrations. As the metabolites can diffuse across the grid, the metabolites produced by the dead cell, like metabolite #7, will become available to the neighboring cells, which will thus be able to feed on both #10 and #7, if they own the corresponding pumps. This process is repeated for each transition from time-step <italic>t</italic> to time-step <italic>t</italic> + 1.</p>
<p>Thus, when <italic>e.g.</italic>, a 32 × 32 grid is full of organisms (see the description of the experimental protocol below), a time-step involves the computation of about a thousand different ODE systems, each of them containing from tens to thousands of equations depending on gene number.</p>
</sec>
<sec id="sec005">
<title>Score function</title>
<p>Some metabolites are essential for an organism’s replication. Here, we arbitrarily define as essential the metabolites whose tag is a prime number. The score of an organism is then simply defined as the sum of its internal concentrations of essential metabolites. However, to prevent organisms from producing a single specific prime number in huge quantities, we also define lethal toxicity thresholds for both essential and non essential metabolites. Here these toxicity thresholds are set to 1.0 ACU for all metabolites.</p>
</sec>
<sec id="sec006">
<title>Population and environment</title>
<p>Organisms evolve on a two-dimensional toroidal grid, each spot containing at most one organism. The physical environment is described at the grid level: each grid spot contains external metabolites, each with its concentration. These external metabolites diffuse with a diffusion parameter <italic>D</italic> = 0.1 gridstep<sup>2</sup>.time-step<sup>-1</sup>, meaning that a fraction <italic>D</italic> of each metabolite present at one location will diffuse to each of the eight neighboring grid spots at each time-step. The discrete diffusion equation we are using is inspired from [<xref ref-type="bibr" rid="pcbi.1005459.ref038">38</xref>]. External metabolites are also degraded with a degradation rate <italic>D</italic><sub><italic>g</italic></sub>, meaning that a fraction <italic>D</italic><sub><italic>g</italic></sub> of each metabolite at each location will disappear at each time-step. We make the simplifying assumption that there are no enzymatic reaction in the environment, and thus that metabolite transformation only occurs inside the organisms. Organisms compete for the external metabolites to produce offspring in empty spots. They interact with their local environment by pumping metabolites in and out and releasing their metabolic content at death. At each time-step, organisms are evaluated and either killed, updated or replicated depending on their current state:</p>
<list list-type="order">
<list-item>
<p>If the organism does not die and cannot divide (<italic>e.g.</italic>, because there is no free space in its neighborhood), its metabolic network is updated, and its score is computed. If lethal toxicity thresholds are reached, the organism dies (see point 2);</p>
</list-item>
<list-item>
<p>Organisms can also die randomly with a probability following a Poisson law of parameter <italic>p</italic><sub><italic>death</italic></sub> = 0.02 per organism per time-step. At death, the metabolic content is released into the local environment;</p>
</list-item>
<list-item>
<p>For each empty grid spot, all living organisms in the Moore neighborhood whose score is higher than a minimum score of 10<sup>−3</sup> ACU compete. The organism having the best score in the neighborhood is allowed to divide if it did not replicate previously at the same time-step (such that any dividing cell generates at most two daughters per time-step).</p>
</list-item>
</list>
</sec>
</sec>
<sec id="sec007">
<title>Experimental protocol</title>
<p>In all our simulations, the environment provided one primary resource with tag <italic>m</italic><sub><italic>exo</italic></sub> = #10. To initialize an evolutionary run, the entire grid was populated with individuals having random genomes (different for each individual). This initial population was allowed to evolve for 500 time-steps, at which point its viability is assessed. We repeated this procedure until a viable population was found, <italic>i.e.</italic>, with at least 500 viable individuals after the 500 time-steps. In this case, some organisms possess at least one pump to internalize <italic>m</italic><sub><italic>exo</italic></sub>, and (because <italic>m</italic><sub><italic>exo</italic></sub> is not a prime number, see the description of the score function above) one enzyme to transform <italic>m</italic><sub><italic>exo</italic></sub> into a prime number, thereby producing an “essential metabolite”. Up to a few hundred trials were usually needed to find a viable population, which was then used to seed the evolutionary run. Each evolutionary run was seeded with a different viable population. These organisms grow on the primary resource and start to release by-products (mostly at death), hence modifying their environment. Populations evolved in two different environments:</p>
<list list-type="order">
<list-item>
<p>The <bold>periodic environment</bold>, in which the resource dynamics of the LTEE [<xref ref-type="bibr" rid="pcbi.1005459.ref015">15</xref>] was mimicked. The environment was periodically refreshed by removing all the external metabolites and introducing <italic>m</italic><sub><italic>exo</italic></sub> at concentration <italic>f</italic><sub><italic>in</italic></sub> = 10.0 ACU per grid spot. Internal metabolites were not affected by the refresh event. The refresh period was Δ<italic>t</italic> = 333 time-steps. We call a “cycle” this time interval between two environmental resets. The value of Δ<italic>t</italic> was calibrated to let the organisms live for approximately 7 generations per cycle, as in the LTEE. Within each cycle, the metabolites in the environment were conserved (<italic>D</italic><sub><italic>g</italic></sub> = 0 per time-step). Note that we mimicked the resource dynamics of the LTEE but not the 1% population subsampling occurring during serial transfers, because it would have implied transferring populations of 10 individuals or fewer. Such a low population size would have implied dramatic genetic drift and impeded adaptive evolution (in the LTEE, where the population size before sampling is very large, the 1% subsampling still leaves the population large enough to keep genetic drift reasonably low). To simulate subsampling, a significantly larger grid would have been needed, making the whole campaign impossible to compute in a reasonable time.</p>
</list-item>
<list-item>
<p>The <bold>continuous environment</bold>, in which the resource dynamics of a chemostat environment was mimicked. The medium was constantly provided with a small influx of the primary resource. All the external metabolites were slowly degraded. Specifically, at each time-step, a concentration Δ<italic>f</italic><sub><italic>in</italic></sub> = 0.03 ACU of <italic>m</italic><sub><italic>exo</italic></sub> was added in every grid spot, and external metabolites were degraded at rate <italic>D</italic><sub><italic>g</italic></sub> = 0.003 per time-step.</p>
</list-item>
</list>
<p>For each environment, 12 independent populations were propagated for 500,000 time-steps (approximately 50,000 generations). On the long-term, the quantity of resources available in the system was equivalent in both environments. The grid size is 32 × 32. Complementary experiments were also run in a randomized batch environment similar to the periodic environment except that the environment reset intervals followed a Poisson law of parameter Δ<italic>t</italic> = 333 time-steps instead of the exact regular period of 333 time-steps. The simulation parameters common to all the simulations are described in <xref ref-type="supplementary-material" rid="pcbi.1005459.s001">S1 Table</xref>.</p>
<sec id="sec008">
<title>Cross-feeding interactions</title>
<p>In order to detect the potential cross-feeding interactions in the population, the metabolic activity of each individual was evaluated at each time-step. For each organism, a “trophic profile” was computed from its metabolic network activity. The trophic profile is a binary sequence summarizing the uptake, production and release activity of an organism. The length of the binary string was defined by the largest metabolite tag present in the system at time <italic>t</italic>. For example, if an organism uptakes metabolite #4, produces #3 from #4 and releases #3, knowing that the largest metabolite tag in the whole grid is #5, then its profile is |00010|00100|00100|. We classified organisms in two trophic groups depending on their trophic profiles:</p>
<list list-type="order">
<list-item>
<p>“Group A” pumps in <italic>m</italic><sub><italic>exo</italic></sub>, and possibly other metabolites,</p>
</list-item>
<list-item>
<p>“Group B” pumps in group A by-products, and possibly other metabolites, but not the primary resource <italic>m</italic><sub><italic>exo</italic></sub>.</p>
</list-item>
</list>
<p>A trophic group is considered an ecotype if the organisms of the group form a monophyletic cluster (see below).</p>
</sec>
<sec id="sec009">
<title>Phylogenetic relationships</title>
<p>Phylogenetic relationships were exhaustively recorded during each simulation. Since organisms can only divide once per time-step, phylogenetic trees are binary trees. It was possible to recover the line of descent of any organism, and to compare the phylogenetic tree structure with the distribution of the trophic groups in the population. In particular, we can determine if groups A and B are monophyletic, and thus can be considered as ecotypes. To this aim, we computed a phylogenetic structure score (<italic>PS</italic> score) to identify the degree of monophyly of both groups. This phylogenetic structure score was defined as <italic>PS</italic> = |<italic>f</italic><sub>1</sub> − <italic>f</italic><sub>2</sub>|, where <italic>f</italic><sub>1</sub> and <italic>f</italic><sub>2</sub> are the relative frequencies of group B in both subtrees rooted to the last common ancestor of the whole final population. A high <italic>PS</italic> value indicates a strong clustering of groups A and B in the phylogenetic tree, <italic>i.e.</italic>, that groups A and B are two different ecotypes. A low <italic>PS</italic> value indicates a random distribution or the absence of polymorphism.</p>
</sec>
</sec>
<sec id="sec010">
<title>Sensitivity analysis</title>
<p>We tested variations of our parameters set (see <xref ref-type="supplementary-material" rid="pcbi.1005459.s001">S1 Table</xref>), by changing the death probability <italic>p</italic><sub><italic>death</italic></sub>, the external metabolites diffusion rate, the mutation rates, the toxicity thresholds, the “migration rate” (a parameter controlling the fraction of exchanged pairs among all possible pairs of individuals), and the grid size. Details and results are described in <xref ref-type="supplementary-material" rid="pcbi.1005459.s005">S1 Appendix</xref>.</p>
</sec>
</sec>
<sec id="sec011" sec-type="results">
<title>Results</title>
<p>First, the global evolutionary dynamics of the system can be analyzed by looking at main simulation statistics. The evolution of the mean score, the environmental richness (the number of different metabolites available in the environment), the number of trophic profiles, and the proportion of organisms of group A or B are represented in <xref ref-type="fig" rid="pcbi.1005459.g002">Fig 2</xref>. The score and the environmental richness were of the same order of magnitude in the continuous and the periodic environments, but they were more stable in the continuous environment. The number of trophic profiles showed no striking difference between the periodic and the continuous environment (<xref ref-type="fig" rid="pcbi.1005459.g002">Fig 2A.3 and 2B.3</xref>), indicating that polymorphism was common in both situations. However, the dynamics of groups A and B were completely different. In the periodic environment, groups coexisted, even if they showed long-term frequency variations (<xref ref-type="fig" rid="pcbi.1005459.g002">Fig 2A.4</xref>). In the continuous environment, group B quickly emerged too but also quickly disappeared in all cases (<xref ref-type="fig" rid="pcbi.1005459.g002">Fig 2B.4</xref>). Thus, even if the diversity of trophic profiles was similar in both environments, all profiles belonged to group A in the continuous environment. Hence, there was no group exclusively specialized on by-products in the continuous environment, while they were common in the periodic one.</p>
<fig id="pcbi.1005459.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005459.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Evolution of typical variables.</title>
<p>Evolution of the mean score (<bold>A.1</bold> and <bold>B.1</bold>), the environmental richness (the number of different metabolites present in the environment, <bold>A.2</bold> and <bold>B.2</bold>), the number of trophic profiles (<bold>A.3</bold> and <bold>B.3</bold>), and the proportion of organisms of group A or B are represented (<bold>A.4</bold> and <bold>B.4</bold>). <bold>(A)</bold> Evolution in the periodic environment. <bold>(B)</bold> Evolution in the continuous environment. In <bold>A.4</bold> and <bold>B.4</bold>, group A is represented in solid lines and group B in dashed lines.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.g002" xlink:type="simple"/>
</fig>
<sec id="sec012">
<title>Impact of environmental dynamics on evolved genome and network organization</title>
<p>We compared the structure of both the genome and the metabolic network of final A organisms (after 500,000 time-steps) from the continuous and periodic environments of the main campaign (see above). We evaluated five variables: <bold>(i)</bold> the mean genome size, <bold>(ii)</bold> the mean amount of non-coding DNA, <bold>(iii)</bold> the mean number of enzyme coding units encoding the same metabolic reaction (the “metabolic redundancy”), <bold>(iv)</bold> the mean number of different essential metabolites pumped in (the “uptake diversity”), and <bold>(v)</bold> the mean number of different essential metabolites produced (the “production diversity”). For each measure, we performed a two-sample Wilcoxon test with a Bonferroni correction (<italic>n</italic> = 5).</p>
<p>As shown in <xref ref-type="table" rid="pcbi.1005459.t001">Table 1</xref>, there was no significant variation in the amount of non-coding DNA and the uptake diversity. By contrast, genome size (resp. 227.47 and 346.24 units, p-value &lt; 0.001/5) and metabolic redundancy (resp. 15.80 and 7.98 units, p-value &lt; 0.001/5) were significantly lower in the periodic environment compared to the continuous environment. Moreover, the number of essential metabolites produced was significantly higher in the periodic environment than in the continuous environment (resp. 5.04 and 6.58 essential metabolites, p-value &lt; 0.001/5). These differences are explained by selective pressures on the metabolic network. Indeed, organisms experienced a trade-off between maximizing their score (<italic>i.e.</italic>, maximizing the concentration of essential metabolites in their cytoplasm) and avoiding lethal toxicity thresholds. In the periodic environment, the external resource <italic>m</italic><sub><italic>exo</italic></sub> was introduced by bursts of 10.0 ACU at each serial transfer. Thus, to maximize the score without reaching toxicity thresholds, organisms must avoid specializing on a single essential metabolite and instead spread the toxicity by distributing metabolic fluxes in the production of several essential metabolites. In the continuous environment, the external resource was continuously provided at a lower concentration (0.03 ACU at each time-step). In this case, the selective pressure on toxicity was relaxed and the number of essential metabolites produced was significantly lower. Interestingly, metabolic fluxes were also adjusted by amplifying or deleting genes. Indeed, in the continuous environment, there were more copies of E (enzyme coding units) than in the periodic environment, while the production diversity was lower, meaning that those units were amplified in the continuous environment to maximize metabolic fluxes, thus increasing the genome size.</p>
<table-wrap id="pcbi.1005459.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005459.t001</object-id>
<label>Table 1</label>
<caption>
<title>Comparison of the structure of the genome and metabolic network structure of final A organisms evolved in the continuous and periodic environments.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005459.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Variable</th>
<th align="center">Continuous env.</th>
<th align="center">Periodic env.</th>
<th align="center">Wilcoxon test</th>
<th align="left">Units</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Genome size</td>
<td align="center">346.24 ± 12.98</td>
<td align="center">227.47 ± 53.21</td>
<td align="center">***</td>
<td align="left">Genomic units</td>
</tr>
<tr>
<td align="left">Non-coding DNA</td>
<td align="center">5.69 ± 1.21</td>
<td align="center">4.69 ± 1.54</td>
<td align="center">-</td>
<td align="left">Genomic units</td>
</tr>
<tr>
<td align="left">Metabolic redundancy</td>
<td align="center">15.80 ± 1.84</td>
<td align="center">7.98 ± 2.08</td>
<td align="center">***</td>
<td align="left">Genomic units</td>
</tr>
<tr>
<td align="left">Uptake diversity</td>
<td align="center">3.48 ± 0.37</td>
<td align="center">3.87 ± 1.41</td>
<td align="center">-</td>
<td align="left">Metabolites</td>
</tr>
<tr>
<td align="left">Production diversity</td>
<td align="center">5.04 ± 0.31</td>
<td align="center">6.58 ± 0.93</td>
<td align="center">***</td>
<td align="left">Metabolites</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001">
<p>Five variables were evaluated: <bold>(i)</bold> the mean genome size, <bold>(ii)</bold> the mean amount of non-coding DNA, <bold>(iii)</bold> the mean number of E encoding the same metabolic reaction (the “metabolic redundancy”), <bold>(iv)</bold> the mean number of different essential metabolites pumped in (the “uptake diversity”), and <bold>(v)</bold> the mean number of different essential metabolites produced (the “production diversity”). The standard deviation is also shown (mean ± sd.). For each measure, we performed a two-samples Wilcoxon test, with Bonferroni correction (<italic>n</italic> = 5).</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>
<xref ref-type="fig" rid="pcbi.1005459.g003">Fig 3</xref> shows an example of organisms A and B evolved in the periodic environment after 500,000 time-steps (repetition 10). The final best individual of groups A (<xref ref-type="fig" rid="pcbi.1005459.g003">Fig 3A</xref>) and B (<xref ref-type="fig" rid="pcbi.1005459.g003">Fig 3B</xref>) are represented including their genome (<xref ref-type="fig" rid="pcbi.1005459.g003">Fig 3A.1 and 3B.1</xref>), metabolic network (<xref ref-type="fig" rid="pcbi.1005459.g003">Fig 3A.2 and 3B.2</xref>) and internal metabolic concentrations (<xref ref-type="fig" rid="pcbi.1005459.g003">Fig 3A.3 and 3B.3</xref>). The metabolic network of organism A was structured around <italic>m</italic><sub><italic>exo</italic></sub> (this metabolite being a hub in the network), even if the organism also fed on some by-products. Organism B’s metabolic network was less complex, and indicates that the organism mostly grew on A-secreted products. Most parts of both genomes were coding enzymes, revealing large operons all along the genomes.</p>
<fig id="pcbi.1005459.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005459.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Final best individuals of groups A and B, from repetition 10 of the periodic environment.</title>
<p><bold>(A)</bold> Final best organism A. <bold>(B)</bold> Final best organism B. <bold>(A.1, B.1)</bold> The circular single-stranded genome. Non-functional regions are white, promoters black, E red, revealing numerous operons all along the genomes. <bold>(A.2, B.2)</bold> The metabolic network. Non essential and essential metabolites are colored in black and blue, respectively. Non-functional parts of the metabolic network (where fluxes are null) are shown in grey. <bold>(A.3, B.3)</bold> The internal metabolic concentrations (non essential metabolite concentrations: black. Essential metabolite concentrations: blue).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec013">
<title>Relationship between ecology and phylogeny</title>
<p>For each simulation, we analyzed the final phylogenetic tree and compared it to the distribution of groups A and B. All the phylogenetic trees are represented in <xref ref-type="supplementary-material" rid="pcbi.1005459.s002">S1 Fig</xref>. Leaves are colored depending on their trophic group (group A in blue, group B in green). The structure of the trees was strongly related to the type of environment. In the periodic environment (<xref ref-type="supplementary-material" rid="pcbi.1005459.s002">S1 Fig</xref>), 5 phylogenetic trees among 12 (repetitions 1, 3, 7, 9 and 10) showed two well-separated clusters, each belonging to one ecological group. In these repetitions, two ecotypes evolved separately and remained stable on the long-term, showing that a stable cross-feeding interaction evolved. In the seven other cases, trees were less deep, had no well separated clusters, and no clear correlation between ecological groups and phylogenetic structure was observed. In the continuous environment (<xref ref-type="supplementary-material" rid="pcbi.1005459.s002">S1 Fig</xref>), trees were much shorter than in the periodic environment. Group A went to fixation in all repetitions. Then, while polymorphism and cross-feeding existed at a similar level in both periodic and continuous environments (<xref ref-type="fig" rid="pcbi.1005459.g002">Fig 2A.3 and 2B.3</xref>), this polymorphism was not stable in the continuous environment.</p>
</sec>
<sec id="sec014">
<title>Evolution of phylogenetic structure and trophic groups</title>
<p>To get more insight into the evolutionary dynamics, we computed the distribution of the Most Recent Common Ancestor (MRCA) age at each time-step for all the simulations. The MRCA age reflects the stability of the polymorphism in a population. As shown in <xref ref-type="fig" rid="pcbi.1005459.g004">Fig 4</xref>, distributions confirmed that the deepest trees evolved in the periodic environment, with a mean MRCA age of 71,004 time-steps, and a large distribution tail (some trees having almost the same depth as the total simulation time—500,000 time-steps). By contrast, the mean MRCA age is only 13,524 time-steps in the continuous environment and 11,684 time-steps in the complementary experiment with randomized refresh. This result indicates that environmental variations must be regular to favor stable cross-feeding interactions. The evolution of MRCA age during simulations is also represented in <xref ref-type="supplementary-material" rid="pcbi.1005459.s003">S2 Fig</xref>, for the three types of environment. This figure gives a better idea of the evolutionary dynamics of the phylogenetic trees. It shows that the MRCA age regularly collapsed in the random and continuous environments, but was still increasing for some simulations in the periodic environment.</p>
<fig id="pcbi.1005459.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005459.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Distribution of the Most Recent Common Ancestor age in all the simulations.</title>
<p>For each environment, we computed the distribution across repetitions of the Most Recent Common Ancestor (MRCA) age, for each simulation time-step. All pairwise Student tests are significant, with Bonferroni correction (p-value &lt; 0.001/3).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.g004" xlink:type="simple"/>
</fig>
<p>We then compared the phylogenetic structure with the distribution of groups A and B on tree leaves by computing the phylogenetic structure score <italic>PS</italic> (<xref ref-type="fig" rid="pcbi.1005459.g005">Fig 5A</xref>). In <xref ref-type="fig" rid="pcbi.1005459.g005">Fig 5B</xref>, this <italic>PS</italic> score is plotted against the MRCA age every 1,000 time-steps for all the repetitions (grey points). Points corresponding to the end of each simulation are colored in black. On each plot, three areas are identified: the purple area indicates long-diverged clades (MRCA age higher than 200,000 time-steps), the orange area indicates when clades correspond to ecotypes (PS score &gt; 0.9), and the intersection of the previous two areas (inside dashed borders) indicates long-diverged monophyletic ecotypes. In the periodic environment (<xref ref-type="fig" rid="pcbi.1005459.g005">Fig 5B.1</xref>), the deepest trees were also the most structured, with two well separated monophyletic ecotypes A and B. In the random environment (<xref ref-type="fig" rid="pcbi.1005459.g005">Fig 5B.2</xref>), the situation was contrasted, with a large distribution of the <italic>PS</italic> score, ranging from monomorphic trees (A or B groups being fixed), to polymorphic trees. However, the MRCA age was very short compared to the periodic environment, revealing the instability of the phylogenetic structure. Note that the random environment is the only one where we observed a population extinction (1 out of 12). In the continuous environment (<xref ref-type="fig" rid="pcbi.1005459.g005">Fig 5B.3</xref>), the population was mostly monomorphic (group A being fixed), with short MRCA ages.</p>
<fig id="pcbi.1005459.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005459.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Phylogenetic structure score against the MRCA age.</title>
<p><bold>(A)</bold> The PS score. The PS score is a measure indicating the degree of clustering of A and B trophic groups, on the two clades linked to the MRCA. A high PS value (&gt; 0.9) indicates well separated A and B clusters. <bold>(B)</bold> For each environment, the PS score is plotted against the MRCA age every 1,000 time-steps, for all repetitions, with the points corresponding to the final trees (at 500,000 time-steps) colored in black. Purple area: long-diverged clades (MRCA age higher than 200,000 time-steps). Orange area: clades corresponding to ecotypes (PS score &gt; 0.9). Intersection (inside dashed borders): long-diverged monophyletic ecotypes. <bold>(B.1)</bold> Periodic environment. <bold>(B.2)</bold> Random environment. <bold>(B.3)</bold> Continuous environment.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.g005" xlink:type="simple"/>
</fig>
<p>To evaluate the robustness of these results to the variation of main simulation parameters, we performed a sensitivity analysis. The results are presented in details in <xref ref-type="supplementary-material" rid="pcbi.1005459.s005">S1 Appendix</xref>. Even if some parameters were more sensitive than others (<italic>e.g.</italic>, the death probability and the toxicity thresholds, discussed in <xref ref-type="supplementary-material" rid="pcbi.1005459.s005">S1 Appendix</xref>), this analysis revealed that our results are robust. In the continuous environment, no single simulation evolved a stable A/B cross-feeding in the whole analysis. Moreover, when the diffusion rate was infinite, or when the population was perfectly mixed (all locations being randomized at each time-step), almost all repetitions (80% in infinite diffusion conditions, 100% in well-mixed conditions) evolved a stable A/B cross-feeding in the periodic environment (see <xref ref-type="supplementary-material" rid="pcbi.1005459.s005">S1 Appendix</xref>). This result is in agreement with previous studies showing that the spatial structure may affect polymorphism [<xref ref-type="bibr" rid="pcbi.1005459.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref040">40</xref>].</p>
<p>These results confirmed that the periodic environment strongly favored the evolution of stable cross-feeding interactions, in contrast to the random and continuous environments, in apparent contradiction with the results of wet experiments in chemostat, and we will discuss this point below.</p>
</sec>
<sec id="sec015">
<title>Evolution of trophic profiles</title>
<p>We then recovered the proportion of trophic profiles over time (at every 1,000 time-steps) in all the simulations of the periodic and continuous environments (<xref ref-type="fig" rid="pcbi.1005459.g006">Fig 6A and 6B</xref>, respectively). Trophic profiles belonging to groups A and B are colored in shades of blue and green, respectively. Those figures show that evolution in the model was ruled by periodic selection in a highly polymorphic population. This polymorphism was mainly due to competition for resources, with the organisms constantly competing for the primary resource but also the by-products available in the environment.</p>
<fig id="pcbi.1005459.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005459.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Evolution of trophic profiles in the population for the continuous and periodic environments.</title>
<p>Trophic profiles gather organisms that own the exact same metabolic activity (see Methods). Blue and green profiles belong to trophic groups A and B, respectively. <bold>(A)</bold> Continuous environment simulations. <bold>(B)</bold> Periodic environment simulations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.g006" xlink:type="simple"/>
</fig>
<p>However, in the periodic environment (<xref ref-type="fig" rid="pcbi.1005459.g006">Fig 6A</xref>), trophic profiles from groups A and B coexisted over time, with periodic selection events occurring independently in both groups. This dynamics is typical from multiple niche selection, where beneficial mutations do not spread in all the population owing to competitive exclusion, but are confined in one specific niche. In the continuous environment (<xref ref-type="fig" rid="pcbi.1005459.g006">Fig 6B</xref>), group A was predominant in all simulations, periodic selection affecting the whole population. In these conditions, the level of cross-feeding was maintained but the interactions were not stable (as shown by <xref ref-type="fig" rid="pcbi.1005459.g002">Fig 2A.3 and 2B.3</xref>).</p>
<p>These results reinforce the fact that stable cross-feeding interactions were only possible in the periodic environment. Specifically, in the periodic environment, evolution was driven by multiple niche selection, with periodic selection events independently occurring in ecotypes A and B. On the opposite, in the continuous environment, evolution was driven by periodic selection and competitive exclusion, indicating that there was less opportunity for niche construction.</p>
</sec>
<sec id="sec016">
<title>Ecological dynamics in the periodic environment</title>
<p>Comparative analysis of phylogenetic structure in the different environments revealed that the periodic environment especially favored the evolution of stable cross-feeding interactions, leading to two monophyletic ecotypes A and B in 5 of 12 repetitions, with the ecotype A feeding on the primary resource and possibly on some by-products, while ecotype B consumed by-products. In the LTEE, it has been shown that the coexistence of S and L ecotypes is driven by negative frequency-dependent interactions [<xref ref-type="bibr" rid="pcbi.1005459.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref013">13</xref>]. We analyzed in details the 5 populations to see whether the stable cross-feeding interactions were comparable to the S/L interaction.</p>
<sec id="sec017">
<title>Mutational history of ecotypes A and B</title>
<p>In the 5 populations that evolved a stable cross-feeding, we recovered the mutational history of the lineages of ecotypes A and B. Final phylogenetic trees of the 5 populations are represented in <xref ref-type="fig" rid="pcbi.1005459.g007">Fig 7</xref>. For each tree, the trophic group of the MRCA, as well as the generation at which one of the monophyletic ecotypes switched from the ancestor group to the other one (<italic>i.e.</italic>, when one ecotype lost or gained inflowing pumps for the primary resource), are shown. In all 5 populations, the same pattern emerged: the population was primarily of group A, but niche construction on by-products resulted in adaptive diversification, with one ecotype strongly specializing on by-products, such that it lost the ability to uptake the primary resource.</p>
<fig id="pcbi.1005459.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005459.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Analysis of the adaptive diversification event leading to the monophyletic ecotypes A and B.</title>
<p>In the phylogenetic trees of final evolved populations, the colored circles indicate the trophic group and the generation of the common ancestor. The colored triangles indicate the generation when one monophyletic ecotype moved from one trophic group to the other (<italic>i.e.</italic>, losing or gaining pumps to feed on external nutrient). Group A (blue) grows on the primary resource and possibly on by-products. Group B (green) exclusively grows on by-products.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.g007" xlink:type="simple"/>
</fig>
<p>Interestingly, in all simulations, the loss of this ability was not the source of the adaptive diversification. The diversification event occurred a few hundreds of generations <italic>before</italic> the loss of the pump provoking the change of trophic group. In the LTEE, the S ecotype specialized on acetate, but was still able to grow on glucose. However, recent work has shown that while the S ecotype improved its ability to grow on acetate since the diversification event, it was not the case on glucose, presaging a possible complete loss of its ability to grow on glucose in the longer term [<xref ref-type="bibr" rid="pcbi.1005459.ref016">16</xref>]. Conversely, the L ecotype improved its ability to grow on glucose, but not on acetate, also presaging a loss of ability to grow on acetate at a longer term.</p>
</sec>
<sec id="sec018">
<title>Ecotype B frequency-dependent fitness in short term competition experiments</title>
<p>To test whether ecotypes A and B coexistence is maintained by negative frequency-dependent interactions, we performed short term competition experiments with the 5 populations that evolved a stable cross-feeding interaction at the end of the simulations in the periodic environment (repetitions 1, 3, 7, 9 and 10). Initial populations were seeded at 9 different initial frequencies of B (0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8 and 0.9—each with 10 repetitions) and were propagated in the same periodic environment during 1 cycle (<italic>i.e.</italic>, 333 time-steps). Then, we computed the log-fitness [<xref ref-type="bibr" rid="pcbi.1005459.ref041">41</xref>] of ecotype B, taking into account its initial frequency and its frequency at the end of the first cycle. <xref ref-type="fig" rid="pcbi.1005459.g008">Fig 8</xref> demonstrates that the ecotypes A and B interaction was frequency-dependent, the ecotype B being favored when initially rare, and penalized when initially abundant. Since the external conditions varied during the seasons, the B organisms were not favored during the whole cycle. <xref ref-type="supplementary-material" rid="pcbi.1005459.s006">S1 Video</xref> shows the variation of B relative fitness over the 333 time-steps of the first cycle, at a full temporal resolution. This video shows the establishment of the negative frequency-dependent interaction along the cycle, and reveals that the relative fitness of B was initially negative at all initial frequencies. Indeed, at each cycle, B ecotype growth was delayed compared to A ecotype, the former growing on by-products during the second season, while the latter grew on fresh primary resource during the first season. At low initial frequencies of B, their small number can randomly lead to their extinction, thus artificially reducing its mean relative fitness. Those results are in full agreement with the LTEE [<xref ref-type="bibr" rid="pcbi.1005459.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref025">25</xref>].</p>
<fig id="pcbi.1005459.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005459.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Frequency-dependent relative fitness in short-term competition experiments.</title>
<p>The frequency-dependent fitness was computed using log-fitness [<xref ref-type="bibr" rid="pcbi.1005459.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref041">41</xref>] in short term competition experiments, starting with different initial frequencies of B ecotype. For each of the 5 populations that evolved monophyletic ecotypes at the end of the simulations, 10 repetitions were run per initial frequency of B (0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8 and 0.9). The global mean frequency-dependent fitness is represented in black. Mean fitness per population is shown in shaded colors. Each individual experiment is plotted in shaded color dots, related to their mean color.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.g008" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec019">
<title>Convergence to an oscillatory dynamics</title>
<p>Owing to their negative frequency-dependent interaction, the relative frequencies of ecotypes A and B should stabilize over time, as in the LTEE [<xref ref-type="bibr" rid="pcbi.1005459.ref011">11</xref>]. We extended the previous competition experiments to 10 cycles and recorded the A and B proportions at each time-step (<xref ref-type="fig" rid="pcbi.1005459.g009">Fig 9</xref>). Trajectories show that at all initial frequencies of B, a stable oscillatory dynamics was reached for each repetition (<xref ref-type="fig" rid="pcbi.1005459.g009">Fig 9A</xref> for repetition 1, <xref ref-type="fig" rid="pcbi.1005459.g009">Fig 9B</xref> for rep. 3, <xref ref-type="fig" rid="pcbi.1005459.g009">Fig 9C</xref> for rep. 7, <xref ref-type="fig" rid="pcbi.1005459.g009">Fig 9D</xref> for rep. 9 and <xref ref-type="fig" rid="pcbi.1005459.g009">Fig 9E</xref> for rep. 10). The observed variability was due to contingent evolutionary differences between the 5 populations, and to a sampling effect when the initial frequency of B was low. Here again we observed exactly the dynamics observed in the LTEE [<xref ref-type="bibr" rid="pcbi.1005459.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref025">25</xref>], even if the small population size artificially increased the oscillatory dynamics.</p>
<fig id="pcbi.1005459.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005459.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Convergence to an oscillatory dynamics over 10 serial transfer cycles.</title>
<p>Ecotype B is advantaged when rare, but is penalized when initially common, leading to a balanced polymorphism. Nine different initial frequencies of B have been tested (0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8 and 0.9). Each trajectory is the mean of the B frequency among the 10 repetitions of each of the 5 populations. <bold>(A)</bold> Population 1. <bold>(B)</bold> Population 3. <bold>(C)</bold> Population 7. <bold>(D)</bold> Population 9. <bold>(E)</bold> Population 10.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.g009" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec020">
<title>Stability of the A/B cross-feeding interactions when transferred in the continuous environment</title>
<p>In the continuous environment, no stable cross-feeding interaction evolved. This result is in apparent contradiction with wet experiments during which <italic>E. coli</italic> populations evolved in a continuous culture with glucose as a single limiting carbon source [<xref ref-type="bibr" rid="pcbi.1005459.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref010">10</xref>]. In those experiments, cross-feeding interactions emerged after a few hundreds of generations. Nonetheless, our results showed that cross-feeding interactions quickly emerged in the continuous environment, but these interactions were not stable (<xref ref-type="fig" rid="pcbi.1005459.g002">Fig 2</xref>).</p>
<p>To test whether a population with two stable A and B ecotypes (evolved in the periodic environment) could persist when placed in the continuous one, we let populations from the periodic environment evolve in chemostat-like environments for 500,000 time-steps. The 5 populations that evolved a stable cross-feeding in the periodic environment were propagated in a continuous environment at two different stages of their evolution: <bold>(i)</bold> just after adaptive diversification (early populations, see <xref ref-type="fig" rid="pcbi.1005459.g007">Fig 7</xref>), <bold>(ii)</bold> and at the end of the simulations (late populations, after 500,000 time-steps). As a control, these populations were also propagated in the periodic environment. For each population, 10 repetitions were run in each environment. Then, we evaluated the stability of the A/B cross-feeding interaction by counting the number of simulations where the interaction persisted, the number of simulations where the interaction failed, and the time before interaction failure.</p>
<p>The proportion of simulations where the interaction persisted are displayed in <xref ref-type="table" rid="pcbi.1005459.t002">Table 2</xref> for the continuous environment, and in <xref ref-type="table" rid="pcbi.1005459.t003">Table 3</xref> for the periodic environment. The evolution of the proportions of groups A and B is also shown in <xref ref-type="fig" rid="pcbi.1005459.g010">Fig 10A and 10C</xref> for the continuous environment (early and late populations, respectively), and in <xref ref-type="fig" rid="pcbi.1005459.g010">Fig 10B and 10D</xref> for the periodic environment (early and late populations, respectively). First, <xref ref-type="table" rid="pcbi.1005459.t002">Table 2</xref> shows that, for early populations in the continuous environment, the interaction was not robust and persisted in only 6% of the assays. For late populations in the continuous environment, the interaction was more robust, as the polymorphism persisted in 50% of the assays. For early populations in the periodic environment, the interaction was also not robust (the interaction persisted in only 18% of the assays), even if more populations maintained the interaction than in the continuous environment. This low percentage is probably due to the experimental protocol: populations were transferred in a periodic environment at the beginning of a new cycle, whatever the previous seasonal context of the population. The interaction was then destabilized while the diversification event was still recent, leading to a high probability to loose the interaction (a situation similar to what occurred in the random environments). However, for late populations in the periodic environment, most assays kept the polymorphism stable (the interaction persisted in 78% of the assays), indicating that seasonality is of primary importance to stabilize the interaction.</p>
<table-wrap id="pcbi.1005459.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005459.t002</object-id>
<label>Table 2</label>
<caption>
<title>Proportion of assays where polymorphism persisted in chemostat conditions.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005459.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"/>
<th align="center">Pop 1</th>
<th align="center">Pop 3</th>
<th align="center">Pop 7</th>
<th align="center">Pop 9</th>
<th align="center">Pop 10</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Early populations</td>
<td align="center">0%</td>
<td align="center">0%</td>
<td align="center">0%</td>
<td align="center">30%</td>
<td align="center">0%</td>
</tr>
<tr>
<td align="center">Late populations</td>
<td align="center">90%</td>
<td align="center">70%</td>
<td align="center">30%</td>
<td align="center">40%</td>
<td align="center">20%</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001">
<p>For each population, 10 assays were simulated. The stable polymorphism was considered to be lost if the MRCA age changed, indicating that one of the two monophyletic groups was outcompeted.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<table-wrap id="pcbi.1005459.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005459.t003</object-id>
<label>Table 3</label>
<caption>
<title>Proportion of assays where polymorphism persisted in batch conditions.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005459.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"/>
<th align="center">Pop 1</th>
<th align="center">Pop 3</th>
<th align="center">Pop 7</th>
<th align="center">Pop 9</th>
<th align="center">Pop 10</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Early populations</td>
<td align="center">30%</td>
<td align="center">20%</td>
<td align="center">0%</td>
<td align="center">40%</td>
<td align="center">0%</td>
</tr>
<tr>
<td align="center">Late populations</td>
<td align="center">100%</td>
<td align="center">100%</td>
<td align="center">90%</td>
<td align="center">60%</td>
<td align="center">40%</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t003fn001">
<p>For each population, 10 assays were simulated. The stable polymorphism was considered to be lost if the MRCA age changed, indicating that one of the two monophyletic groups was outcompeted.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<fig id="pcbi.1005459.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005459.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Stability of the A/B interaction evolved in the periodic environment, when placed in the continuous one.</title>
<p>Early populations were transferred just after adaptive diversification. Late populations were transferred at the end of the simulations (500,000 time-steps). For each repetition that evolved two ecotypes A and B (rep. 1, 3, 7, 9 and 10), 10 repetitions of 500,000 time-steps were run. The stable polymorphism was considered to be lost if the MRCA age changed, indicating that one of the two monophyletic groups was outcompeted. In this case, the simulation is colored in green, and red before and after this event, respectively (simulations where the A/B interaction was maintained during the whole experiment are fully green). <bold>(A)</bold> Early populations transferred in the continuous environment. <bold>(B)</bold> Early populations transferred in the periodic environment. <bold>(C)</bold> Late populations transferred in the continuous environment. <bold>(D)</bold> Late populations transferred in the periodic environment.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.g010" xlink:type="simple"/>
</fig>
<p>
<xref ref-type="fig" rid="pcbi.1005459.g011">Fig 11</xref> shows the distribution of the time before A/B interaction failure for early and late populations in the continuous environment. Late populations were much more robust, since extinctions happened significantly later (with a mean of 142,291.2 time-steps) than for early populations (with a mean of 37,173.68 time-steps). Student test gives a p-value &lt; 0.001.</p>
<fig id="pcbi.1005459.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005459.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Time before A/B interaction failure in the continuous environment.</title>
<p>The time (in time-steps) is measured for all competition experiments in the continuous environment (50 simulations) where the interaction failed. Persistent interactions are not considered here. Early populations loose the interaction significantly earlier than the late ones (Student test is significant with a p-value &lt; 0.001).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.g011" xlink:type="simple"/>
</fig>
<sec id="sec021">
<title>Vulnerability of ecotype B to A fast-growing mutants when transferred in the continuous environment</title>
<p>In order to understand why the A/B interaction failed in half of the continuous environment experiments (50% of the assays in the late populations), and why the A/B interaction failures implied the extinction of ecotype B in most cases (80% of the failures in the late populations), we studied in details the evolution of digital organisms in this environment.</p>
<p>For each late population propagated in the continuous environment (<xref ref-type="fig" rid="pcbi.1005459.g010">Fig 10C</xref>), we compared the initial A ecotype to the final A ecotype (after 500,000 time-steps of evolution in the continuous environment). We performed the same genomic and metabolic analyse as in section “Impact of environmental resource dynamics on evolved genome and network organization”. <xref ref-type="table" rid="pcbi.1005459.t004">Table 4</xref> shows that A organisms <bold>(i)</bold> significantly increased their genome size (from 189.99 to 269.73 units, p-value &lt; 0.001/5), their mean metabolic redundancy (from 6.69 to 10.86 units, p-value &lt; 0.001/5) and mean uptake diversity (from 1.17 to 1.69 metabolites, p-value &lt; 0.001/5), and <bold>(ii)</bold> significantly decreased their mean production diversity (from 7.14 to 5.66 metabolites, p-value &lt; 0.001/5), when they evolved in the continuous environment for 500,000 time-steps. Indeed, the relaxation of selective pressures to maintain concentrations under the lethal toxicity thresholds led to a restructuring of A organisms towards a genome and metabolic network well-adapted to continuous conditions (see <xref ref-type="table" rid="pcbi.1005459.t001">Table 1</xref>). This modification of ecotype A phenotypes impaired the negative frequency-dependent interaction between the A and B ecotypes: since B organisms consumed A-secreted by-products, the reduction of the production diversity of A organisms led to the extinction of ecotype B in half of the assays.</p>
<table-wrap id="pcbi.1005459.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005459.t004</object-id>
<label>Table 4</label>
<caption>
<title>Comparison of the genome and metabolic network structure of initial and final ecotype A, when transferred in the continuous environment.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005459.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.t004" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Variable</th>
<th align="center">Initial pop.</th>
<th align="center">Final pop. (500,000t)</th>
<th align="center">Wilcoxon test</th>
<th align="left">Units</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Genome size</td>
<td align="center">189.99 ± 49.85</td>
<td align="center">269.73 ± 96.69</td>
<td align="center">***</td>
<td align="left">Genome units</td>
</tr>
<tr>
<td align="left">Non-coding DNA</td>
<td align="center">4.69 ± 2.10</td>
<td align="center">5.18 ± 2.01</td>
<td align="center">-</td>
<td align="left">Genome units</td>
</tr>
<tr>
<td align="left">Metabolic redundancy</td>
<td align="center">6.69 ± 1.46</td>
<td align="center">10.86 ± 4.81</td>
<td align="center">***</td>
<td align="left">Genome units</td>
</tr>
<tr>
<td align="left">Uptake diversity</td>
<td align="center">1.17 ± 0.54</td>
<td align="center">1.69 ± 1.13</td>
<td align="center">***</td>
<td align="left">Metabolites</td>
</tr>
<tr>
<td align="left">Production diversity</td>
<td align="center">7.14 ± 0.73</td>
<td align="center">5.66 ± 1.78</td>
<td align="center">***</td>
<td align="left">Metabolites</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t004fn001">
<p>Five variables were evaluated: <bold>(i)</bold> the mean genome size, <bold>(ii)</bold> the mean amount of non-coding DNA, <bold>(iii)</bold> the mean number of E encoding the same metabolic reaction (the “metabolic redundancy”), <bold>(iv)</bold> the mean number of different essential metabolites pumped in (the “uptake diversity”), and <bold>(v)</bold> the mean number of different essential metabolites produced (the “production diversity”). The standard deviation is also shown (mean ± sd.). For each measure, we performed a two-samples Wilcoxon test, with Bonferroni correction (<italic>n</italic> = 5).</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>To exemplify these statistical results, we studied in details the evolution of ecotypes A and B in the 10 repetitions of the late population 3, when propagated in the continuous environment (<xref ref-type="fig" rid="pcbi.1005459.g010">Fig 10C.3</xref>). At the beginning of the assays, ecotypes A and B interacted through a negative frequency-dependent cross-feeding: ecotype A organisms produced essential metabolites 2, 3, 5, 7, 11, 13, 17 and 23; ecotype B organisms consumed metabolites 2, 3, 5 and 7 (all secreted by ecotype A organisms). We evaluated the evolution of the 8 essential metabolites that were produced by ecotype A organisms at the beginning of the assays (<xref ref-type="fig" rid="pcbi.1005459.g012">Fig 12</xref>). Ecotype A organisms reduced their production of essential metabolites in all assays. However, when ecotype A organisms stopped producing metabolites 2, 3, 5 and/or 7, ecotype B organisms systematically went to extinction. On the opposite, when ecotype A organisms stopped producing metabolites 17 and/or 23 (but maintained the production of 2, 3, 5 and 7), ecotype B was not affected. These results confirm the mechanism of B extinction: when placed in continuous conditions, ecotype A organisms reorganized their metabolism and produced fewer essential metabolites. Now, while doing so they may stop producing metabolites that were necessary for the survival of ecotype B organisms, leading to their extinction.</p>
<fig id="pcbi.1005459.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005459.g012</object-id>
<label>Fig 12</label>
<caption>
<title>Loss of essential metabolites production of ecotype A organisms in the 10 repetitions of the late population 3 in the continuous environment assays.</title>
<p>The 10 repetitions of the population 3 are displayed. The 8 essential metabolites (2, 3, 5, 7, 11, 13, 17, and 23) that were produced by ecotype A organisms at the beginning of the assays are represented vertically for each repetition. Colored metabolites indicate a production loss. Essential metabolites that are consumed by ecotype B organisms are colored in red, the others in green. At the top, the evolution of groups A and B proportions is represented in green when the A/B interaction persisted and in red when the interaction failed. In all simulations where A ceased to produce a metabolite pumped-in by B, B went to extinction.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.g012" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec022">
<title>The robustness of the A/B interaction in late populations is explained by character displacement and niche specialization</title>
<p>In order to understand why the interaction between A and B ecotypes was more robust in late than early populations, we compared the genomic and metabolic structures of early and late populations, independently for A and B ecotypes. We performed the same statistical tests as in Tables <xref ref-type="table" rid="pcbi.1005459.t001">1</xref> and <xref ref-type="table" rid="pcbi.1005459.t004">4</xref> (two-samples Wilcoxon test with Bonferroni correction of <italic>n</italic> = 5). The results are presented in <xref ref-type="table" rid="pcbi.1005459.t005">Table 5</xref>. In both ecotypes, the genome size, amount of non-coding DNA and metabolic redundancy were significantly reduced. However, if ecotype A significantly reduced its uptake diversity and increased its production diversity, ecotype B evolved in an opposite way (<italic>i.e.</italic>, ecotype B significantly increased its uptake diversity and reduced its production diversity). The traits of ecotypes A and B diverged: <bold>(i)</bold> ecotype A strongly specialized on <italic>m</italic><sub><italic>exo</italic></sub> (with a mean uptake diversity of 1.17 metabolites), and optimized metabolic fluxes according to the trade-off between avoiding lethal toxicity thresholds and maximizing the score (as explained above, this selective pressure resulted in reduced genome size and metabolic redundancy, and increased production diversity). <bold>(ii)</bold> Ecotype B specialized on by-products by increasing the uptake diversity and reducing the production diversity. This demonstrates that ecotypes A and B specialized to their own niches, and that ecotypes A and B traits diverged by character displacement, in complete agreement with the LTEE [<xref ref-type="bibr" rid="pcbi.1005459.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref034">34</xref>].</p>
<table-wrap id="pcbi.1005459.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005459.t005</object-id>
<label>Table 5</label>
<caption>
<title>Comparison of the genome and metabolic network structure of initial ecotypes A and B in the early and late populations.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005459.t005g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.t005" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Variable</th>
<th align="center">Early pop.</th>
<th align="center">Late pop.</th>
<th align="center">Wilcoxon test</th>
<th align="left">Units</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">A genome size</td>
<td align="center">257.09 ± 42.31</td>
<td align="center">189.99 ± 49.85</td>
<td align="center">***</td>
<td align="left">Genome units</td>
</tr>
<tr>
<td align="left">A non-coding DNA</td>
<td align="center">6.37 ± 1.14</td>
<td align="center">4.69 ± 2.10</td>
<td align="center">**</td>
<td align="left">Genome units</td>
</tr>
<tr>
<td align="left">A metabolic redundancy</td>
<td align="center">8.20 ± 0.83</td>
<td align="center">6.69 ± 1.46</td>
<td align="center">***</td>
<td align="left">Genome units</td>
</tr>
<tr>
<td align="left">A uptake diversity</td>
<td align="center">3.12 ± 0.51</td>
<td align="center">1.17 ± 0.54</td>
<td align="center">***</td>
<td align="left">Metabolites</td>
</tr>
<tr>
<td align="left">A production diversity</td>
<td align="center">6.82 ± 0.12</td>
<td align="center">7.14 ± 0.73</td>
<td align="center">*</td>
<td align="left">Metabolites</td>
</tr>
<tr>
<td align="left">B genome size</td>
<td align="center">274.93 ± 31.98</td>
<td align="center">203.14 ± 59.59</td>
<td align="center">***</td>
<td align="left">Genome units</td>
</tr>
<tr>
<td align="left">B non-coding DNA</td>
<td align="center">9.70 ± 8.21</td>
<td align="center">4.20 ± 2.05</td>
<td align="center">***</td>
<td align="left">Genome units</td>
</tr>
<tr>
<td align="left">B metabolic redundancy</td>
<td align="center">9.86 ± 2.48</td>
<td align="center">8.04 ± 2.54</td>
<td align="center">**</td>
<td align="left">Genome units</td>
</tr>
<tr>
<td align="left">B uptake diversity</td>
<td align="center">3.74 ± 0.76</td>
<td align="center">4.59 ± 0.84</td>
<td align="center">***</td>
<td align="left">Metabolites</td>
</tr>
<tr>
<td align="left">B production diversity</td>
<td align="center">6.26 ± 0.70</td>
<td align="center">5.85 ± 0.57</td>
<td align="center">**</td>
<td align="left">Metabolites</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t005fn001">
<p>For each ecotype, five variables were evaluated: <bold>(i)</bold> the mean genome size, <bold>(ii)</bold> the mean amount of non-coding DNA, <bold>(iii)</bold> the mean number of E encoding the same metabolic reaction (the “metabolic redundancy”), <bold>(iv)</bold> the mean number of different essential metabolites pumped in (the “uptake diversity”), and <bold>(v)</bold> the mean number of different essential metabolites produced (the “production diversity”). The standard deviation is also shown (mean ± sd.). For each measure, we performed a two-sample Wilcoxon test with Bonferroni correction (<italic>n</italic> = 5).</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>Character displacement explained the apparent robustness of the A/B interaction in late populations. Indeed, niche specialization led A organisms to specialize on <italic>m</italic><sub><italic>exo</italic></sub> and increase their production diversity. On the other hand, B organisms specialized on a large number of by-products. However, character displacement and niche specialization was stronger in late than early populations. For this reason, late A organisms needed more mutations (and then more evolution time) to adapt to continuous conditions (<italic>i.e.</italic>, reducing the production diversity and increasing metabolic redundancy, see <xref ref-type="table" rid="pcbi.1005459.t001">Table 1</xref>) than early A organisms. Thus, B organisms were slower out-competed in late than early populations.</p>
<p>To assess those conclusions, we studied in details the evolution of ecotypes A and B in the 10 repetitions of the early population 3 (<xref ref-type="fig" rid="pcbi.1005459.g010">Fig 10A.3</xref>), in the exact same way than in <xref ref-type="fig" rid="pcbi.1005459.g012">Fig 12</xref>. The result is available on <xref ref-type="supplementary-material" rid="pcbi.1005459.s004">S3 Fig</xref>, and shows that A organisms from early populations reduced their production diversity (mean of 3.4 metabolites) more than A organisms in late populations (mean of 2.0 metabolites). Indeed, A organisms were less specialized and thus needed less time to adapt to the continuous conditions, thereby favoring the extinction of ecotype B.</p>
<p>The fact that beneficial mutations from ecotype A spread all over the population in the continuous environment (<xref ref-type="fig" rid="pcbi.1005459.g004">Fig 4</xref>) indicates that competitive exclusion occurred. In this case, according to [<xref ref-type="bibr" rid="pcbi.1005459.ref014">14</xref>], A and B groups cannot be considered as separate ecotypes in the continuous environment, although the same organisms were separate ecotypes in the periodic environment. Note that in 5 assays over all experiments, ecotype B fixed in the population (1 assay for early populations in the continuous environment, 3 assays for late populations in the continuous environment, and 1 assay for late populations in the periodic environment). When ecotype B invaded the population, by-products were not produced anymore by ecotype A, therefore dooming the whole population to extinction (as exemplified in repetition 3 of late population 1).</p>
<p>Hence, the stability of the A/B cross-feeding interaction in the continuous environment relied on the evolutionary time elapsed in the periodic environment since adaptive diversification. This shows that the co-evolution of ecotypes A and B in the periodic environment strengthened their interaction, meaning that niche specialization stabilized the cross-feeding and fostered a robust negative frequency-dependence. However, even if the cross-feeding interaction seemed stable over few thousands of generations, in the continuous environment a beneficial mutation in ecotype A lineage can lead to the extinction of ecotype B lineage. Therefore, the stability of the A/B polymorphism in the periodic environment did not rely only on their cross-feeding interaction, but also on the seasonality of the environment.</p>
</sec>
</sec>
</sec>
<sec id="sec023" sec-type="conclusions">
<title>Discussion</title>
<p>Using <italic>in silico</italic> experimental evolution, we have shown that the long-term maintenance of cross-feeding interactions is favored in a seasonal environment, where the environment is reset and primary resource is supplied at regular intervals. In this environment, 5 simulations over 12 evolved a stable cross-feeding interaction at the end of the simulations, with two monophyletic ecotypes coexisting via a negative frequency-dependent interaction. At each cycle, ecotype A grows during the first season, feeding on the primary resource and releasing by-products, while ecotype B exclusively feeds on by-products during the second season. The stable coexistence of ecotypes A and B is then based on niche construction, followed by a negative frequency-dependent interaction, as the S and L ecotypes in the LTEE. According to our model, batch culture experiments seem to especially favor the evolution of stable cross-feeding polymorphisms owing to the cyclic nature of the environment that generates the conditions for the existence of at least two stable seasons: a first season is externally generated by the cyclic mechanism (thus being intrinsically stable) while the second one is generated by the replacement of the exogeneously-provided nutrient by the secreted by-products through a mechanism of niche construction.</p>
<p>In the continuous environment, where the primary resource is constantly provided (like in a chemostat), cross-feeding interactions emerged, but were not stable because of competitive exclusion. In this case, organisms enriched their environment via their metabolic activity, such that mutants were temporarily able to feed on by-products. But the absence of seasonality precludes any possibility for the stabilization of cross-feeding interactions.</p>
<p>Our multi-scale model allowed us to investigate the impact of resource dynamics on the organization of genome (<italic>e.g.</italic>, gene amplification) and of the metabolic network. It also allowed us to dissect the precise mechanism behind the evolved robustness of the cross-feeding interaction. We demonstrated that those results are robust to model parameter variation. Indeed, stable cross-feeding interactions emerged in the periodic environment for a wide range of parameter values, including well-mixed populations and infinite diffusion rate, while they never appeared in the continuous environment, thus reinforcing our conclusions (<xref ref-type="supplementary-material" rid="pcbi.1005459.s005">S1 Appendix</xref>).</p>
<p>Previous wet experiments in chemostat demonstrated the emergence of cross-feeding interactions [<xref ref-type="bibr" rid="pcbi.1005459.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005459.ref010">10</xref>]. In those experiments, <italic>E. coli</italic> populations have been propagated in a chemostat with glucose as a single limiting carbon source for at most 1,900 generations. When isolated and evolved together in competition experiments, the different mutants identified to contribute to the cross-feeding interactions reached a stable equilibrium owing to frequency-dependent interactions [<xref ref-type="bibr" rid="pcbi.1005459.ref008">8</xref>]. Several reasons were invoked to explain why cross-feeding interactions could be stable in chemostat, despite the competitive exclusion principle. According to Pfeiffer and Bonhoeffer [<xref ref-type="bibr" rid="pcbi.1005459.ref018">18</xref>], cross-feeding may evolve in microbial populations as a consequence of the maximization of ATP production, and the minimization of enzyme concentrations and intermediate products. Those constraints may hinder the emergence of mutants completely degrading glucose (or uptaking glucose and acetate), and outcompeting other cells by competitive exclusion. In our model, organisms do not need to explicitly produce energy carriers. However, competition for resources, toxicity thresholds and division impose metabolic flux optimization. Based on the same conclusions, Doebeli [<xref ref-type="bibr" rid="pcbi.1005459.ref023">23</xref>] also suggested that this trade-off between uptake efficiency on the primary and the secondary resources should favor the emergence of cross-feeding polymorphism in chemostat but not in batch culture, because in a chemostat, by-products are more abundant and constantly provided. However, the limit of this model is that the rate of by-product production did not rely on the rate of primary resource consumption. Besides, a more recent theoretical work concluded that, in a continuous and well-mixed environment, the diversity of cross-feeding polymorphism was negatively correlated with primary resource abundance [<xref ref-type="bibr" rid="pcbi.1005459.ref032">32</xref>].</p>
<p>Our results shed a new light on this question. First, in our model, cross-feeding polymorphisms emerged both in the periodic and continuous environments. However the stabilization of the cross-feeding interactions was favored in the periodic environment, leading to the evolution of specialized ecotypes. Cohan [<xref ref-type="bibr" rid="pcbi.1005459.ref014">14</xref>] defined an ecotype as an independent monophyletic cluster occupying a specific ecological niche. Ecotypes are at the heart of the bacterial species concept: what makes the genetic cohesion of an asexual bacterial species is periodic selection that regularly purges the genetic diversity in the same ecological niche [<xref ref-type="bibr" rid="pcbi.1005459.ref014">14</xref>]. As a consequence, ecotypes occupying different niches independently experience selective sweeps, the mutants from one niche not invading the ones from the other niche. Thus, the stability of a cross-feeding polymorphism should only be analyzed in the light of the robustness of each ecotype against selective sweeps by other ecotypes [<xref ref-type="bibr" rid="pcbi.1005459.ref014">14</xref>]. This mechanism is observed in the LTEE, as well as in our model. In the periodic environment, ecotypes A and B independently experience periodic selection events. In the continuous environment, competitive exclusion implied that only one ecotype evolved in this environment.</p>
<p>Secondly, when ecotypes A and B evolved in the periodic environment were transferred in the continuous environment, they retained their negative frequency-dependent interaction for hundreds of generations, until a selective sweep purged the whole population diversity, and destroyed the cross-feeding interaction. Moreover, ecotypes A and B that evolved for a long time in the periodic environment had a more robust interaction in continuous conditions, because of niche specialization and character displacement on the long-term. In the light of those results, we suggest to distinguish between ecological stability and evolutionary stability. Even if different monophyletic clusters, related by cross-feeding interactions, have frequency-dependent interactions, they are not necessarily robust to competitive exclusion on the long-term. In this sense, ecotypes A and B are no longer ecotypes in the continuous environment. By contrast, in the periodic environment, A and B ecotypes can be considered as proto-species.</p>
<p>Those remarks lead us to hypothesize that the S and L interaction observed in the LTEE, which is still at an early stage, should not be stable in a chemostat on the long-term, even if it could become more and more stable. We also hypothesize that the S/L polymorphism is an ongoing speciation event. On the long run, the S ecotype could even loose the ability to consume glucose.</p>
<p>In a more general view, what we observed is strongly related to known results about temporal niche partitioning in ecology [<xref ref-type="bibr" rid="pcbi.1005459.ref017">17</xref>]. Bacterial communities commonly undergo adaptive diversification or niche specialization in sympatry, when the environment is seasonal. For example, this mechanism has been observed in marine microbial communities [<xref ref-type="bibr" rid="pcbi.1005459.ref042">42</xref>], and in lake phytoplankton [<xref ref-type="bibr" rid="pcbi.1005459.ref043">43</xref>]. In the LTEE [<xref ref-type="bibr" rid="pcbi.1005459.ref013">13</xref>] and in our model, seasonality of glucose originates from the serial transfer, but the seasonality of acetate is due to cross-feeding and niche construction. Moreover, we demonstrated in our model than negative frequency-dependent cross-feeding is not enough to stabilize the interaction between multiple ecotypes. External factors are necessary, such a regular serial transfer. While the environment is intentionally simplified in those experiments, we can expect much more complex environmental conditions in nature.</p>
<p>Such complex interactions between external factors, emergent cross-feeding interactions and niche construction are therefore of primary importance to understand the evolution of microbial communities in well-mixed environments. Using a computational model of ISEE to decipher those interactions seems to be a rich complementary approach to wet experiments and mathematical modeling.</p>
</sec>
<sec id="sec024" sec-type="conclusions">
<title>Conclusion</title>
<p>Using a multi-scale computational model of ISEE, we studied the evolution and stability of cross-feeding interactions in well-mixed environments, providing a single limiting resource periodically or continuously, as in batch cultures or chemostat devices. Our results led us to consider a stable cross-feeding polymorphism as the stable coexistence of different ecotypes, defined as different monophyletic clusters undergoing independent periodic selection events in their own ecological niche [<xref ref-type="bibr" rid="pcbi.1005459.ref014">14</xref>]. We observed that, even if cross-feeding polymorphism systematically appears in all the simulations, the evolution of stable ecotypes coexisting via cross-feeding is favored in the periodic environment, similarly to the S/L polymorphism observed in the LTEE [<xref ref-type="bibr" rid="pcbi.1005459.ref011">11</xref>]. In the continuous environment, competitive exclusion precludes the stabilization of cross-feeding interactions, in apparent contradiction with wet experiments. Indeed, while ecotypes interacting via cross-feeding can temporarily coexist, a mutant always eventually outcompetes them. Then, we suggest to study the evolution of cross-feeding polymorphism by fully integrating the notion of ecotype, and distinguishing between ecological stability and evolutionary stability, the latter including long-term evolutionary dynamics such as periodic selection. Our results contributed to understand temporal niche partitioning, by modeling various mechanisms such as cross-feeding, niche construction and seasonality. At a more general scale, our results may contribute to the study of the evolution of bacterial communities, by deciphering the conditions of sympatric speciation in asexual populations.</p>
</sec>
<sec id="sec025">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005459.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.s001" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Common simulation parameters for the entire experimental protocol.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005459.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.s002" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Final phylogenetic trees of each simulation.</title>
<p><bold>(A)</bold> Phylogenetic trees of the 12 repetitions in the periodic environment. <bold>(B)</bold> Phylogenetic trees of the 12 repetitions in the continuous environment. Tree leaves are colored depending on their trophic group: group A in blue, group B in green. Phylogenetic trees are numbered by repetition. For each tree, the scale is represented in simulation time-steps.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005459.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.s003" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Evolution of the MRCA age during simulations, for the three types of environments.</title>
<p>For each environment, all the repetitions are represented in different colors. <bold>(A)</bold> Periodic environment. <bold>(B)</bold> Random environment. <bold>(C)</bold> Continuous environment.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005459.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.s004" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Loss of essential metabolites production of ecotype A organisms, in the 10 repetitions of the early population 3 in the continuous environment assays.</title>
<p>The 10 repetitions of population 3 are displayed. The 7 essential metabolites (2, 3, 5, 11, 13, 17, and 23) that were produced by ecotype A organisms at the beginning of the assays are represented vertically for each repetition. Background colors indicate a production loss. Essential metabolites that are consumed by ecotype B organisms are colored in red, the other in green. At the top, the evolution of groups A and B proportions is represented, and is colored in green when the A/B interaction persisted, or in red when the interaction failed. In all simulations where A have ceased to produce a metabolite pumped-in by B, B has gone to extinction.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005459.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.s005" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Sensitivity analysis on six key parameters.</title>
<p>Six key parameters have been explored to evaluate the probability of emergence of a stable cross-feeding in the periodic and continuous environments. Each parameter has been modified independently around default parameter values. The emergence of a stable cross-feeding is evaluated in the same way as in <xref ref-type="fig" rid="pcbi.1005459.g005">Fig 5</xref> (PS score against MRCA age).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005459.s006" mimetype="video/mpeg" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005459.s006" xlink:type="simple">
<label>S1 Video</label>
<caption>
<title>Variation of the relative fitness of ecotype B during an entire cycle.</title>
<p>This video shows the evolution of the ecotype B relative fitness during the first cycle of the short-term competition experiment. Each of the 333 frames corresponds to one time-step, the whole video presenting the entire cycle.</p>
<p>(MPG)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors want to thank Noah Ribeck (Michigan State University), Richard Lenski (Michigan State University), and all the partners of the EvoEvo project for fruitful discussions. The authors also want to thank David P. Parsons who assisted in the proof-reading of the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005459.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stams</surname> <given-names>AJ</given-names></name>. <article-title>Metabolic interactions between anaerobic bacteria in methanogenic environments</article-title>. <source>Antonie van Leeuwenhoek</source>. <year>1994</year>;<volume>66</volume>(<issue>1-3</issue>):<fpage>271</fpage>–<lpage>294</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF00871644" xlink:type="simple">10.1007/BF00871644</ext-link></comment> <object-id pub-id-type="pmid">7747937</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dejonghe</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Berteloot</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Goris</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Boon</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Crul</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Maertens</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Synergistic degradation of linuron by a bacterial consortium and isolation of a single linuron-degrading Variovorax strain</article-title>. <source>Applied and Environmental Microbiology</source>. <year>2003</year>;<volume>69</volume>(<issue>3</issue>):<fpage>1532</fpage>–<lpage>1541</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/AEM.69.3.1532-1541.2003" xlink:type="simple">10.1128/AEM.69.3.1532-1541.2003</ext-link></comment> <object-id pub-id-type="pmid">12620840</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Costa</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Pérez</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kreft</surname> <given-names>JU</given-names></name>. <article-title>Why is metabolic labour divided in nitrification?</article-title> <source>Trends in microbiology</source>. <year>2006</year>;<volume>14</volume>(<issue>5</issue>):<fpage>213</fpage>–<lpage>219</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tim.2006.03.006" xlink:type="simple">10.1016/j.tim.2006.03.006</ext-link></comment> <object-id pub-id-type="pmid">16621570</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Katsuyama</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Nakaoka</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Takeuchi</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Tago</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hayatsu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kato</surname> <given-names>K</given-names></name>. <article-title>Complementary cooperation between two syntrophic bacteria in pesticide degradation</article-title>. <source>Journal of Theoretical Biology</source>. <year>2009</year>;<volume>256</volume>(<issue>4</issue>):<fpage>644</fpage>–<lpage>654</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2008.10.024" xlink:type="simple">10.1016/j.jtbi.2008.10.024</ext-link></comment> <object-id pub-id-type="pmid">19038271</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rainey</surname> <given-names>PB</given-names></name>, <name name-style="western"><surname>Travisano</surname> <given-names>M</given-names></name>. <article-title>Adaptive radiation in a heterogeneous environment</article-title>. <source>Nature</source>. <year>1998</year>;<volume>394</volume>(<issue>6688</issue>):<fpage>69</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/27900" xlink:type="simple">10.1038/27900</ext-link></comment> <object-id pub-id-type="pmid">9665128</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rainey</surname> <given-names>PB</given-names></name>, <name name-style="western"><surname>Rainey</surname> <given-names>K</given-names></name>. <article-title>Evolution of cooperation and conflict in experimental bacterial populations</article-title>. <source>Nature</source>. <year>2003</year>;<volume>425</volume>(<issue>6953</issue>):<fpage>72</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature01906" xlink:type="simple">10.1038/nature01906</ext-link></comment> <object-id pub-id-type="pmid">12955142</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Helling</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Vargas</surname> <given-names>CN</given-names></name>, <name name-style="western"><surname>Adams</surname> <given-names>J</given-names></name>. <article-title>Evolution of Escherichia coli during growth in a constant environment</article-title>. <source>Genetics</source>. <year>1987</year>;<volume>116</volume>(<issue>3</issue>):<fpage>349</fpage>–<lpage>358</lpage>. <object-id pub-id-type="pmid">3301527</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rosenzweig</surname> <given-names>RF</given-names></name>, <name name-style="western"><surname>Sharp</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Treves</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Adams</surname> <given-names>J</given-names></name>. <article-title>Microbial evolution in a simple unstructured environment: genetic differentiation in Escherichia coli</article-title>. <source>Genetics</source>. <year>1994</year>;<volume>137</volume>(<issue>4</issue>):<fpage>903</fpage>–<lpage>917</lpage>. <object-id pub-id-type="pmid">7982572</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Turner</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Souza</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Lenski</surname> <given-names>RE</given-names></name>. <article-title>Tests of ecological mechanisms promoting the stable coexistence of two bacterial genotypes</article-title>. <source>Ecology</source>. <year>1996</year>;<volume>77</volume>(<issue>7</issue>):<fpage>2119</fpage>–<lpage>2129</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/2265706" xlink:type="simple">10.2307/2265706</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Treves</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Manning</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Adams</surname> <given-names>J</given-names></name>. <article-title>Repeated evolution of an acetate-crossfeeding polymorphism in long-term populations of Escherichia coli</article-title>. <source>Molecular biology and evolution</source>. <year>1998</year>;<volume>15</volume>(<issue>7</issue>):<fpage>789</fpage>–<lpage>797</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/oxfordjournals.molbev.a025984" xlink:type="simple">10.1093/oxfordjournals.molbev.a025984</ext-link></comment> <object-id pub-id-type="pmid">9656481</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rozen</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Lenski</surname> <given-names>RE</given-names></name>. <article-title>Long-term experimental evolution in Escherichia coli. VIII. Dynamics of a balanced polymorphism</article-title>. <source>The American Naturalist</source>. <year>2000</year>;<volume>155</volume>(<issue>1</issue>):<fpage>24</fpage>–<lpage>35</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1086/303299" xlink:type="simple">10.1086/303299</ext-link></comment> <object-id pub-id-type="pmid">10657174</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rozen</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Schneider</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lenski</surname> <given-names>RE</given-names></name>. <article-title>Long-term experimental evolution in Escherichia coli. XIII. Phylogenetic history of a balanced polymorphism</article-title>. <source>Journal of Molecular Evolution</source>. <year>2005</year>;<volume>61</volume>(<issue>2</issue>):<fpage>171</fpage>–<lpage>180</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00239-004-0322-2" xlink:type="simple">10.1007/s00239-004-0322-2</ext-link></comment> <object-id pub-id-type="pmid">15999245</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rozen</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Philippe</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Arjan de Visser</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lenski</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Schneider</surname> <given-names>D</given-names></name>. <article-title>Death and cannibalism in a seasonal environment facilitate bacterial coexistence</article-title>. <source>Ecology letters</source>. <year>2009</year>;<volume>12</volume>(<issue>1</issue>):<fpage>34</fpage>–<lpage>44</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1461-0248.2008.01257.x" xlink:type="simple">10.1111/j.1461-0248.2008.01257.x</ext-link></comment> <object-id pub-id-type="pmid">19019196</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cohan</surname> <given-names>FM</given-names></name>. <article-title>What are bacterial species?</article-title> <source>Annual Reviews in Microbiology</source>. <year>2002</year>;<volume>56</volume>(<issue>1</issue>):<fpage>457</fpage>–<lpage>487</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev.micro.56.012302.160634" xlink:type="simple">10.1146/annurev.micro.56.012302.160634</ext-link></comment> <object-id pub-id-type="pmid">12142474</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Elena</surname> <given-names>SF</given-names></name>, <name name-style="western"><surname>Lenski</surname> <given-names>RE</given-names></name>. <article-title>Evolution experiments with microorganisms: the dynamics and genetic bases of adaptation</article-title>. <source>Nature Reviews Genetics</source>. <year>2003</year>;<volume>4</volume>(<issue>6</issue>):<fpage>457</fpage>–<lpage>469</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg1088" xlink:type="simple">10.1038/nrg1088</ext-link></comment> <object-id pub-id-type="pmid">12776215</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Großkopf</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Consuegra</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gaffé</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Willison</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Lenski</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Soyer</surname> <given-names>OS</given-names></name>, <etal>et al</etal>. <article-title>Metabolic modelling in a dynamic evolutionary framework predicts adaptive diversification of bacteria in a long-term evolution experiment</article-title>. <source>BMC Evolutionary Biology</source>. <year>2016</year>;<volume>16</volume>(<issue>1</issue>):<fpage>163</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s12862-016-0733-x" xlink:type="simple">10.1186/s12862-016-0733-x</ext-link></comment> <object-id pub-id-type="pmid">27544664</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Spencer</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Saxer</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Travisano</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Doebeli</surname> <given-names>M</given-names></name>. <article-title>Seasonal resource oscillations maintain diversity in bacterial microcosms</article-title>. <source>Evolutionary Ecology Research</source>. <year>2007</year>;<volume>9</volume>(<issue>5</issue>):<fpage>775</fpage>–<lpage>787</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005459.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pfeiffer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Bonhoeffer</surname> <given-names>S</given-names></name>. <article-title>Evolution of cross-feeding in microbial populations</article-title>. <source>The American naturalist</source>. <year>2004</year>;<volume>163</volume>(<issue>6</issue>):<fpage>E126</fpage>–<lpage>E135</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1086/383593" xlink:type="simple">10.1086/383593</ext-link></comment> <object-id pub-id-type="pmid">15266392</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref019">
<label>19</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gerlee</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lundh</surname> <given-names>T</given-names></name>. <chapter-title>Rock-Paper-Scissors Dynamics in a Digital Ecology</chapter-title>. In: <source>ALIFE</source>; <year>2010</year>. p. <fpage>285</fpage>–<lpage>294</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005459.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hindré</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Knibbe</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Beslon</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Schneider</surname> <given-names>D</given-names></name>. <article-title>New insights into bacterial adaptation through in vivo and in silico experimental evolution</article-title>. <source>Nature Reviews Microbiology</source>. <year>2012</year>;<volume>10</volume>(<issue>5</issue>):<fpage>352</fpage>–<lpage>365</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrmicro2750" xlink:type="simple">10.1038/nrmicro2750</ext-link></comment> <object-id pub-id-type="pmid">22450379</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Neill</surname> <given-names>B</given-names></name>. <article-title>Digital evolution</article-title>. <source>PLoS Biol</source>. <year>2003</year>;<volume>1</volume>(<issue>1</issue>):<fpage>e18</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.0000018" xlink:type="simple">10.1371/journal.pbio.0000018</ext-link></comment> <object-id pub-id-type="pmid">14551915</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stewart</surname> <given-names>FM</given-names></name>, <name name-style="western"><surname>Levin</surname> <given-names>BR</given-names></name>. <article-title>Partitioning of resources and the outcome of interspecific competition: a model and some general considerations</article-title>. <source>The American Naturalist</source>. <year>1973</year>;<volume>107</volume>(<issue>954</issue>):<fpage>171</fpage>–<lpage>198</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1086/282825" xlink:type="simple">10.1086/282825</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Doebeli</surname> <given-names>M</given-names></name>. <article-title>A model for the evolutionary dynamics of cross-feeding polymorphisms in microorganisms</article-title>. <source>Population Ecology</source>. <year>2002</year>;<volume>44</volume>(<issue>2</issue>):<fpage>59</fpage>–<lpage>70</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s101440200008" xlink:type="simple">10.1007/s101440200008</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gudelj</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Kinnersley</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rashkov</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Schmidt</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Rosenzweig</surname> <given-names>F</given-names></name>. <article-title>Stability of Cross-Feeding Polymorphisms in Microbial Communities</article-title>. <source>PLOS Computational Biology</source>. <year>2016</year>;<volume>12</volume>(<issue>12</issue>):<fpage>e1005269</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1005269" xlink:type="simple">10.1371/journal.pcbi.1005269</ext-link></comment> <object-id pub-id-type="pmid">28036324</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ribeck</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Lenski</surname> <given-names>RE</given-names></name>. <article-title>Modeling and quantifying frequency-dependent fitness in microbial populations with cross-feeding interactions</article-title>. <source>Evolution</source>. <year>2015</year>;<volume>69</volume>(<issue>5</issue>):<fpage>1313</fpage>–<lpage>1320</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/evo.12645" xlink:type="simple">10.1111/evo.12645</ext-link></comment> <object-id pub-id-type="pmid">25787308</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Johnson</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Wilke</surname> <given-names>CO</given-names></name>. <article-title>Evolution of resource competition between mutually dependent digital organisms</article-title>. <source>Artificial Life</source>. <year>2004</year>;<volume>10</volume>(<issue>2</issue>):<fpage>145</fpage>–<lpage>156</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/106454604773563577" xlink:type="simple">10.1162/106454604773563577</ext-link></comment> <object-id pub-id-type="pmid">15107227</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ofria</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wilke</surname> <given-names>CO</given-names></name>. <article-title>Avida: A software platform for research in computational evolutionary biology</article-title>. <source>Artificial life</source>. <year>2004</year>;<volume>10</volume>(<issue>2</issue>):<fpage>191</fpage>–<lpage>229</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/106454604773563612" xlink:type="simple">10.1162/106454604773563612</ext-link></comment> <object-id pub-id-type="pmid">15107231</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Williams</surname> <given-names>HT</given-names></name>, <name name-style="western"><surname>Lenton</surname> <given-names>TM</given-names></name>. <article-title>Evolutionary regime shifts in simulated ecosystems</article-title>. <source>Oikos</source>. <year>2010</year>;<volume>119</volume>(<issue>12</issue>):<fpage>1887</fpage>–<lpage>1899</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1600-0706.2010.18127.x" xlink:type="simple">10.1111/j.1600-0706.2010.18127.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Crombach</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hogeweg</surname> <given-names>P</given-names></name>. <article-title>Evolution of resource cycling in ecosystems and individuals</article-title>. <source>BMC evolutionary biology</source>. <year>2009</year>;<volume>9</volume>(<issue>1</issue>):<fpage>1</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2148-9-122" xlink:type="simple">10.1186/1471-2148-9-122</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Boyle</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>HT</given-names></name>, <name name-style="western"><surname>Lenton</surname> <given-names>TM</given-names></name>. <article-title>Natural selection for costly nutrient recycling in simulated microbial metacommunities</article-title>. <source>Journal of theoretical biology</source>. <year>2012</year>;<volume>312</volume>:<fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2012.07.018" xlink:type="simple">10.1016/j.jtbi.2012.07.018</ext-link></comment> <object-id pub-id-type="pmid">22842011</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chow</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Wilke</surname> <given-names>CO</given-names></name>, <name name-style="western"><surname>Ofria</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lenski</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Adami</surname> <given-names>C</given-names></name>. <article-title>Adaptive radiation from resource competition in digital organisms</article-title>. <source>Science</source>. <year>2004</year>;<volume>305</volume>(<issue>5680</issue>):<fpage>84</fpage>–<lpage>86</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1096307" xlink:type="simple">10.1126/science.1096307</ext-link></comment> <object-id pub-id-type="pmid">15232105</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerlee</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lundh</surname> <given-names>T</given-names></name>. <article-title>Productivity and diversity in a cross-feeding population of artificial organisms</article-title>. <source>Evolution</source>. <year>2010</year>;<volume>64</volume>(<issue>9</issue>):<fpage>2716</fpage>–<lpage>2730</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1558-5646.2010.01020.x" xlink:type="simple">10.1111/j.1558-5646.2010.01020.x</ext-link></comment> <object-id pub-id-type="pmid">20412297</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Sumpter</surname> <given-names>D</given-names></name>. <article-title>Insights into resource consumption, cross-feeding, system collapse, stability and biodiversity from an artificial ecosystem</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2017</year>;<volume>14</volume>(<issue>126</issue>):<fpage>20160816</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2016.0816" xlink:type="simple">10.1098/rsif.2016.0816</ext-link></comment> <object-id pub-id-type="pmid">28100827</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Le Gac</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Plucain</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hindré</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Lenski</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Schneider</surname> <given-names>D</given-names></name>. <article-title>Ecological and evolutionary dynamics of coexisting lineages during a long-term experiment with Escherichia coli</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2012</year>;<volume>109</volume>(<issue>24</issue>):<fpage>9487</fpage>–<lpage>9492</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1207091109" xlink:type="simple">10.1073/pnas.1207091109</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Crombach</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hogeweg</surname> <given-names>P</given-names></name>. <article-title>Evolution of evolvability in gene regulatory networks</article-title>. <source>PLoS Comput Biol</source>. <year>2008</year>;<volume>4</volume>(<issue>7</issue>):<fpage>e1000112</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000112" xlink:type="simple">10.1371/journal.pcbi.1000112</ext-link></comment> <object-id pub-id-type="pmid">18617989</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Beslon</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Parsons</surname> <given-names>DP</given-names></name>, <name name-style="western"><surname>Sanchez-Dehesa</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Pena</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Knibbe</surname> <given-names>C</given-names></name>. <article-title>Scaling laws in bacterial genomes: A side-effect of selection of mutational robustness?</article-title> <source>Biosystems</source>. <year>2010</year>;<volume>102</volume>(<issue>1</issue>):<fpage>32</fpage>–<lpage>40</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.biosystems.2010.07.009" xlink:type="simple">10.1016/j.biosystems.2010.07.009</ext-link></comment> <object-id pub-id-type="pmid">20655979</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fischer</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bernard</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Beslon</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Knibbe</surname> <given-names>C</given-names></name>. <article-title>A model for genome size evolution</article-title>. <source>Bulletin of mathematical biology</source>. <year>2014</year>;<volume>76</volume>(<issue>9</issue>):<fpage>2249</fpage>–<lpage>2291</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s11538-014-9997-8" xlink:type="simple">10.1007/s11538-014-9997-8</ext-link></comment> <object-id pub-id-type="pmid">25142746</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Frenoy</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Taddei</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Misevic</surname> <given-names>D</given-names></name>. <article-title>Genetic Architecture Promotes the Evolution and Maintenance of Cooperation</article-title>. <source>PLoS Computational Biology</source>. <year>2013</year>;<volume>9</volume>(<issue>11</issue>):<fpage>e1003339</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003339" xlink:type="simple">10.1371/journal.pcbi.1003339</ext-link></comment> <object-id pub-id-type="pmid">24278000</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hauert</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Doebeli</surname> <given-names>M</given-names></name>. <article-title>Spatial structure often inhibits the evolution of cooperation in the snowdrift game</article-title>. <source>Nature</source>. <year>2004</year>;<volume>428</volume>(<issue>6983</issue>):<fpage>643</fpage>–<lpage>646</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature02360" xlink:type="simple">10.1038/nature02360</ext-link></comment> <object-id pub-id-type="pmid">15074318</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerlee</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lundh</surname> <given-names>T</given-names></name>. <article-title>Effect of space in the game? war of attrition?</article-title>. <source>Physical Review E</source>. <year>2012</year>;<volume>85</volume>(<issue>4</issue>):<fpage>041115</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.85.041115" xlink:type="simple">10.1103/PhysRevE.85.041115</ext-link></comment> <object-id pub-id-type="pmid">22680427</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chevin</surname> <given-names>LM</given-names></name>. <article-title>On measuring selection in experimental evolution</article-title>. <source>Biology letters</source>. <year>2011</year>;<volume>7</volume>(<issue>2</issue>):<fpage>210</fpage>–<lpage>213</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsbl.2010.0580" xlink:type="simple">10.1098/rsbl.2010.0580</ext-link></comment> <object-id pub-id-type="pmid">20810425</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gilbert</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Steele</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Caporaso</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Steinbrück</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Reeder</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Temperton</surname> <given-names>B</given-names></name>, <etal>et al</etal>. <article-title>Defining seasonal marine microbial community dynamics</article-title>. <source>The ISME journal</source>. <year>2012</year>;<volume>6</volume>(<issue>2</issue>):<fpage>298</fpage>–<lpage>308</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ismej.2011.107" xlink:type="simple">10.1038/ismej.2011.107</ext-link></comment> <object-id pub-id-type="pmid">21850055</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005459.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Grover</surname> <given-names>JP</given-names></name>. <article-title>Dynamics of competition in a variable environment: experiments with two diatom species</article-title>. <source>Ecology</source>. <year>1988</year>;<volume>69</volume>(<issue>2</issue>):<fpage>408</fpage>–<lpage>417</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/1940439" xlink:type="simple">10.2307/1940439</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>