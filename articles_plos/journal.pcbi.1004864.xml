<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article article-type="research-article" dtd-version="3.0" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-01278</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004864</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Problem solving</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Problem solving</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Problem solving</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognition</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Sensory perception</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Sensory perception</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Sensory perception</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Behavior</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognition</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Problem Solving as Probabilistic Inference with Subgoaling: Explaining Human Successes and Pitfalls in the Tower of Hanoi</article-title>
<alt-title alt-title-type="running-head">Problem Solving as Probabilistic Inference with Subgoaling</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Donnarumma</surname> <given-names>Francesco</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Maisto</surname> <given-names>Domenico</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Pezzulo</surname> <given-names>Giovanni</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Institute of Cognitive Sciences and Technologies, National Research Council, Rome, Italy</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Institute for High Performance Computing and Networking, National Research Council, Naples, Italy</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Sporns</surname> <given-names>Olaf</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Indiana University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: FD DM GP. Performed the experiments: FD DM GP. Analyzed the data: FD DM GP. Contributed reagents/materials/analysis tools: FD DM GP. Wrote the paper: FD DM GP.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">giovanni.pezzulo@istc.cnr.it</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>4</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>13</day>
<month>4</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>4</issue>
<elocation-id>e1004864</elocation-id>
<history>
<date date-type="received">
<day>30</day>
<month>7</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>13</day>
<month>3</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Donnarumma et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004864"/>
<abstract>
<p>How do humans and other animals face novel problems for which predefined solutions are not available? Human problem solving links to flexible reasoning and inference rather than to slow trial-and-error learning. It has received considerable attention since the early days of cognitive science, giving rise to well known cognitive architectures such as SOAR and ACT-R, but its computational and brain mechanisms remain incompletely known. Furthermore, it is still unclear whether problem solving is a “specialized” domain or module of cognition, in the sense that it requires computations that are fundamentally different from those supporting perception and action systems. Here we advance a novel view of human problem solving as <italic>probabilistic inference with subgoaling</italic>. In this perspective, key insights from cognitive architectures are retained such as the importance of using subgoals to split problems into subproblems. However, here the underlying computations use probabilistic inference methods analogous to those that are increasingly popular in the study of perception and action systems. To test our model we focus on the widely used Tower of Hanoi (ToH) task, and show that our proposed method can reproduce characteristic idiosyncrasies of human problem solvers: their sensitivity to the “community structure” of the ToH and their difficulties in executing so-called “counterintuitive” movements. Our analysis reveals that subgoals have two key roles in probabilistic inference and problem solving. First, prior beliefs on (likely) useful subgoals carve the problem space and define an implicit metric for the problem at hand—a metric to which humans are sensitive. Second, subgoals are used as <italic>waypoints</italic> in the probabilistic problem solving inference and permit to find effective solutions that, when unavailable, lead to problem solving deficits. Our study thus suggests that a probabilistic inference scheme enhanced with subgoals provides a comprehensive framework to study problem solving and its deficits.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>How humans solve challenging problems such as the Tower of Hanoi (ToH) or related puzzles is still largely unknown. Here we advance a computational model that uses the same probabilistic inference methods as those that are increasingly popular in the study of perception and action systems, thus making the point that problem solving does not need to be a specialized module or domain of cognition, but it can use the same computations underlying sensorimotor behavior. Crucially, we augment the probabilistic inference methods with <italic>subgoaling</italic> mechanisms that essentially permit to split the problem space into more manageable subparts, which are easier to solve. We show that our computational model can correctly reproduce important characteristics (and pitfalls) of human problem solving, including the sensitivity to the “community structure” of the ToH and the difficulty of executing so-called “counterintuitive” movements that require to (temporarily) move away from the final goal to successively achieve it.</p>
</abstract>
<funding-group>
<funding-statement>GP has received research funding from the European Community’s Seventh Framework Programme, grant FP7-270108 (Goal-Leaders) and by the Human Frontier Science Program, grant RGY0088/2014. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="1"/>
<page-count count="30"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The simulation source code can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://sites.google.com/site/francescodonnarumma/hanoi_subgoals.tar?attredirects=0" xlink:type="simple">https://sites.google.com/site/francescodonnarumma/hanoi_subgoals.tar?attredirects=0</ext-link></meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Problem solving consists in finding efficient solutions to novel tasks for which predefined solutions are not available [<xref ref-type="bibr" rid="pcbi.1004864.ref001">1</xref>]. Humans and other animals can efficiently solve complex problems [<xref ref-type="bibr" rid="pcbi.1004864.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref003">3</xref>] but the underlying neuronal and computational principles are incompletely known. Research on the neuronal underpinnings of problem solving has often proceeded in two different ways. First, researchers have focused on how individual brain areas or circuits solve problems in specific domains; for example, the hippocampus is considered to be implied in solving navigation problems [<xref ref-type="bibr" rid="pcbi.1004864.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref006">6</xref>] and parieto-frontal regions are considered to be implied in mathematical problem solving [<xref ref-type="bibr" rid="pcbi.1004864.ref007">7</xref>]. This approach is compatible with the idea that the brain has dedicated neuronal machinery to solve domain-specific problems, with little hope to find common principles across them.</p>
<p>A second line of research has focused on <italic>domain-general</italic> problem solving strategies, as exemplified in the realization of <italic>general problem solvers</italic> and other influential cognitive architectures in cognitive science [<xref ref-type="bibr" rid="pcbi.1004864.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref013">13</xref>], planners and problem solvers in AI [<xref ref-type="bibr" rid="pcbi.1004864.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref016">16</xref>], and the recent view of the brain as a statistical engine [<xref ref-type="bibr" rid="pcbi.1004864.ref017">17</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref019">19</xref>]. A challenge in this second research line is to identify core computational principles of planning and problem solving that are, on the one hand, valid across multiple cognitive domains (e.g., sensorimotor tasks, navigation, and mathematical problem solving) and, on the other hand, can be implemented in neuronal hardware and work well in ecologically valid contexts [<xref ref-type="bibr" rid="pcbi.1004864.ref020">20</xref>].</p>
<p>In this article we show that problem solving can be characterized within a <italic>probabilistic inference</italic> framework. This framework is increasingly used across multiple domains (sensorimotor [<xref ref-type="bibr" rid="pcbi.1004864.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref022">22</xref>], decision-making and planning [<xref ref-type="bibr" rid="pcbi.1004864.ref023">23</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref025">25</xref>], human-level reasoning [<xref ref-type="bibr" rid="pcbi.1004864.ref026">26</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref028">28</xref>] and learning [<xref ref-type="bibr" rid="pcbi.1004864.ref029">29</xref>]) and levels of description (higher / computational and lower / neuronal [<xref ref-type="bibr" rid="pcbi.1004864.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref030">30</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref033">33</xref>]), supporting the idea that problem solving does not necessarily require specialized mechanisms that are distinct from those used by perception and action systems.</p>
<p>Our problem solving approach is framed within the <italic>planning-as-inference (PAI)</italic> framework, which casts planning as a probabilistic inference problem [<xref ref-type="bibr" rid="pcbi.1004864.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref034">34</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref038">38</xref>]. In this perspective, goals are “clamped” (i.e., they are treated as “future observations” that the system strives to achieve) and probabilistic inference permits to select the sequence of actions that fills the gap between current and goal states. Despite its usefulness to explain goal-directed behavior [<xref ref-type="bibr" rid="pcbi.1004864.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref039">39</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref041">41</xref>] and to design robot architectures [<xref ref-type="bibr" rid="pcbi.1004864.ref042">42</xref>], the standard PAI framework fails to capture some important aspects of (human) problem solving, such as the ability to exploit the “junctions” of problems and to subdivide them into more manageable subproblems.</p>
<p>Here, in keeping with a long tradition in human problem solving and cognitive architectures, we augment the PAI approach with a <italic>subgoaling</italic> mechanism that permits splitting the original problem into more manageable, smaller tasks whose achievement corresponds to milestones or subgoals of the original problem [<xref ref-type="bibr" rid="pcbi.1004864.ref001">1</xref>]. For example, navigation problems can be decomposed by using subgoals (e.g., landmarks) such as “reach the Colosseum, then reach the Imperial Forum” (if one lives in Rome) and puzzles like the Tower of Hanoi can be decomposed by using subgoals such as “free up third rod”.</p>
<p>The importance of subgoaling has been widely recognized by the most popular architectures for symbolic problem solving [<xref ref-type="bibr" rid="pcbi.1004864.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref013">13</xref>] and in other domains such as connectionist networks, hierarchical reinforcement learning, AI, planning, and robotics [<xref ref-type="bibr" rid="pcbi.1004864.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref043">43</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref048">48</xref>]. However, opinions differ about the mechanisms underlying subgoaling. Most systems, especially within the human problem solving and AI traditions [<xref ref-type="bibr" rid="pcbi.1004864.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref013">13</xref>], assume that subgoaling proceeds <italic>backward</italic> from the final goal states and serves to resolve “impasses”: if a goal-achieving action cannot be executed because of a missing precondition, achieving the precondition becomes the next system subgoal; and so on.</p>
<p>Instead, converging evidence from empirical studies highlights the importance of <italic>feedforward</italic> mechanisms for subgoaling and “search” (i.e., mechanisms that proceed from the current to the goal state) in living organisms. The importance of feedforward mechanisms emerges from psychological experiments [<xref ref-type="bibr" rid="pcbi.1004864.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref050">50</xref>] as well as neurophysiological studies on rodents [<xref ref-type="bibr" rid="pcbi.1004864.ref051">51</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref053">53</xref>], monkeys, [<xref ref-type="bibr" rid="pcbi.1004864.ref054">54</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref055">55</xref>] and humans [<xref ref-type="bibr" rid="pcbi.1004864.ref056">56</xref>].</p>
<p>In keeping, we implement subgoaling within a feedforward probabilistic inference (PAI) scheme, showing that the proposed method reproduces characteristic signatures of human problem solving. To this aim, we present four simulation experiments in the widely-used Tower of Hanoi (ToH) task [<xref ref-type="bibr" rid="pcbi.1004864.ref057">57</xref>]. We show that in our simulations successes and failures of solving the ToH (e.g., the failure of dealing with <italic>counterintuitive movements</italic>) correspond to the successful identification or a misidentification of subgoals during the inference, respectively.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>Formal approach to the Tower of Hanoi (ToH) task</title>
<p>The Tower of Hanoi (ToH) task has been widely used in neuropsychology to study executive function and deficits in planning [<xref ref-type="bibr" rid="pcbi.1004864.ref057">57</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref058">58</xref>]. A standard ToH consists of three disks having different sizes that can slide into three rods to form goal configurations. The aim of the game is starting from any initial configuration of disks and reach a goal configuration using the smallest number of actions. <xref ref-type="fig" rid="pcbi.1004864.g001">Fig 1</xref> shows sample initial (a) and goal (b) configurations of a ToH. The rules of the game prescribe that only one disk can be moved at a time and no disk may be placed on top of a smaller disk. The quality of the solutions found by subjects performing a ToH puzzle is usually described using the number of movements required to achieve the goal configuration and the reaction time [<xref ref-type="bibr" rid="pcbi.1004864.ref057">57</xref>].</p>
<fig id="pcbi.1004864.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004864.g001</object-id>
<label>Fig 1</label>
<caption>
<title>The Tower of Hanoi (ToH) setup.</title>
<p>Sample initial (a) and goal (b) position of a Tower of Hanoi problem. (c) Mapping of the Tower of Hanoi problem into an equivalent path-planning problem with 27 states. The levels of grey correspond to the priors on the <italic>SG</italic> distribution; note that the way the priors are calculated is explained in the section on “Subgoal a priori distribution”. In this example, the states have the following values: 0.026 for <italic>S</italic>1, <italic>S</italic>20, <italic>S</italic>27; 0.0355 for <italic>S</italic>6, <italic>S</italic>9, <italic>S</italic>10, <italic>S</italic>11, <italic>S</italic>23, <italic>S</italic>24; 0.0358 for <italic>S</italic>7, <italic>S</italic>8, <italic>S</italic>13, <italic>S</italic>14, <italic>S</italic>17, <italic>S</italic>18; 0.0359 for <italic>S</italic>4, <italic>S</italic>5, <italic>S</italic>12, <italic>S</italic>15, <italic>S</italic>22, <italic>S</italic>25; 0.0465 for <italic>S</italic>2, <italic>S</italic>3, <italic>S</italic>16, <italic>S</italic>19, <italic>S</italic>21, <italic>S</italic>26. For the sake of clarity, the insets (of the states) illustrate the equivalent position in the Tower of Hanoi. The problem consisting in going from the starting position shown in panel (a) to the goal position shown in panel (b) is equivalent to the problem of finding a path from state <italic>S</italic>27 to state <italic>S</italic>20 in panel (c).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004864.g001" xlink:type="simple"/>
</fig>
<p>To model the Tower of Hanoi task, here we use a standard approach in AI [<xref ref-type="bibr" rid="pcbi.1004864.ref059">59</xref>] that consists in mapping the original task into a path-planning problem, whose states and transitions are shown in <xref ref-type="fig" rid="pcbi.1004864.g001">Fig 1C</xref>. The resulting problem has 27 states (squares) and 39 transitions (edges).</p>
<p>To solve ToH problems (e.g., go from S27 to S20), we use a feedforward probabilistic inference method that iteratively samples candidate subgoals from a prior distribution and uses them as waypoints until a complete solution is found. Specifically, our methods use and extend the <italic>planning as probabilistic inference (PAI)</italic> framework, in which planning is cast as a probabilistic inference problem [<xref ref-type="bibr" rid="pcbi.1004864.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref060">60</xref>]. In this perspective, a planning strategy can be attained by imposing (“clamping”) goal or rewarding states as (future) observations, so as to bias the probability of future events towards such desirable states.</p>
<p>In problems like the ToH having moderately large state spaces, exploring all the possible paths is very demanding (in some cases, computationally intractable). For example, despite the limited number of states and transitions of the Tower of Hanoi task shown in <xref ref-type="fig" rid="pcbi.1004864.g001">Fig 1C</xref>, this problem allows for about ∼10<sup>12</sup> possible policies, i.e., mappings from states to actions [<xref ref-type="bibr" rid="pcbi.1004864.ref061">61</xref>]. In this case, a mechanism for splitting the problem into more manageable subproblems—like subgoaling—is helpful.</p>
<p>In keeping, our method differs from the standard PAI approach because we augment the probabilistic scheme with a <italic>subgoaling</italic> mechanism that permits to split the original problem into smaller (and less complex) subproblems. A second difference with the standard PAI approach is that (akin to Active Inference theory [<xref ref-type="bibr" rid="pcbi.1004864.ref030">30</xref>]) we do not treat goals as future observations but as states having high (Bayesian) priors.</p>
<p>The rest of this Section introduces the key components of our approach. It is divided into four subsections. The first subsection introduces the probabilistic model (Dynamic Bayesian Network [<xref ref-type="bibr" rid="pcbi.1004864.ref062">62</xref>]) we used for the inference, which describes the conditional dependencies between the relevant stochastic variables (e.g., states, actions, and subgoals). Importantly, at difference with most planning-as-inference architectures, our model includes (a probability distribution over) subgoals. The second subsection thus illustrates two methods that we used to define the “priors” of such subgoal states. The former (“algorithmic”) method, which is based on calculability theory, constitutes a novelty of our approach. In the experimental section of this article, we use it to explain human performance in the ToH. The latter (“perceptual”) method incorporates a simpler, distance-based metric of the ToH problem space. In the experimental section of this article, we use it to explain failures in human problem solving (e.g., problems in executing counterintuitive movements).</p>
<p>The last two subsections explain in detail the two nested procedures that compose the probabilistic inference: an “inner” procedure that produces candidate plans (see Algorithm 1) and an “outer” procedure that implements a decision rule to select among them (see Algorithm 2). Essentially, in the “inner” procedure, several candidate plans are stochastically produced by our subgoaling-based probabilistic method and scored according to informational measures. In the “outer” procedure, a Bayesian voting procedure selects the best-posterior-valued candidate plan [<xref ref-type="bibr" rid="pcbi.1004864.ref063">63</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref064">64</xref>].</p>
</sec>
<sec id="sec004">
<title>Probabilistic model</title>
<p>The probabilistic model used in the simulations is a Dynamic Bayesian Network (DBN) of <xref ref-type="fig" rid="pcbi.1004864.g002">Fig 2</xref>. The nodes of the DBN are arranged on two layers corresponding to two consecutive slices of time indicated with subscripts, e.g. <italic>S</italic><sub><italic>t</italic></sub> and <italic>S</italic><sub><italic>t</italic>+1</sub>. First-order and stationary Markov properties hold: every variable depends exclusively on other variables expressed at the same or in the immediately preceding time step.</p>
<fig id="pcbi.1004864.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004864.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Graphical model used for the simulations.</title>
<p>The graphical model is a Dynamic Bayesian Network [<xref ref-type="bibr" rid="pcbi.1004864.ref062">62</xref>] and expresses the probabilistic relations between variables. See the main text for explanation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004864.g002" xlink:type="simple"/>
</fig>
<p>The DBN model permits to formulate a problem solving task as a <italic>Markov Decision Process</italic> (MDP), in which states and actions are described by the stochastic variables <italic>S</italic> and <italic>A</italic>, respectively.</p>
<p>We assume that <italic>S</italic> varies in a discrete set consisting of integer values in the range {0, …, <italic>n</italic>}, with <italic>n</italic> being the total number of states. The node <italic>A</italic> corresponds to seven different actions {<italic>act</italic>1 − <italic>act</italic>6, <italic>ε</italic>}: move a disk from the first rod to the second rod (<italic>act</italic>1); move a disk from the first rod to the third rod (<italic>act</italic>2); move a disk from the second rod to the first rod (<italic>act</italic>3); move a disk from the second rod to the third rod (<italic>act</italic>4); move a disk from the third rod to the first rod (<italic>act</italic>5); move a disk from the third rod to the second rod (<italic>act</italic>6); and an auxiliary “rest” action (<italic>ε</italic>), i.e, a transition from a state to the same state. Note that not all actions are defined in every state (e.g., in some states it is impossible to move a disk from the first rod to the second rod).</p>
<p>The node Π in <xref ref-type="fig" rid="pcbi.1004864.g002">Fig 2</xref> represents <italic>policies</italic>, or deterministic mappings from states to actions to be taken in these states. As a policy deterministically specifies an action for every state (<italic>a</italic> = <italic>π</italic>(<italic>s</italic>)), executing the same policy for a number of steps determines a sequence of transitions amongst states [<xref ref-type="bibr" rid="pcbi.1004864.ref061">61</xref>]. The total number <italic>m</italic> of policies available depends on the number of states <italic>S</italic> and actions <italic>A</italic> in the environment. We include also a <italic>rest policy</italic> <italic>π</italic><sub><italic>ε</italic></sub> that associates the action <italic>ε</italic> to every state (i.e., <italic>ε</italic> = <italic>π</italic>(<italic>s</italic>)).</p>
<p>Policy selection is modeled by a transition probability distribution <italic>p</italic>(Π|<italic>s</italic>, <italic>sg</italic>), where <italic>s</italic> is one arbitrary state and <italic>sg</italic> represents one arbitrary <italic>subgoal</italic>. Potentially, every state <italic>s</italic> could be a subgoal and used for planning a strategy in order to achieve the final goal. For this reason, in our simulations the set of subgoals has the same cardinality as the set of states: {0, …, <italic>n</italic>}. The final goal state is considered as a particular subgoal having the highest a priori probability.</p>
<p>At each time step, a new state is determined based on the current state and the action given by the selected policy, according to <italic>p</italic>(<italic>S</italic><sub><italic>t</italic>+1</sub>|<italic>s</italic><sub><italic>t</italic></sub>, <italic>a</italic><sub><italic>t</italic></sub>). The subgoal transition follows instead the distribution <italic>p</italic>(<italic>SG</italic><sub><italic>t</italic>+1</sub>|<italic>f</italic><sub><italic>t</italic></sub>, <italic>sg</italic><sub><italic>t</italic></sub>). The variable <italic>F</italic> monitors the agent’s <italic>progress</italic> in the task by reporting whether or not a goal or subgoal has been achieved, and determines when the inferential process terminates or a new subgoal needs to be sampled. <italic>F</italic> can only assume three discrete values: 0, 1, 2, see [<xref ref-type="bibr" rid="pcbi.1004864.ref038">38</xref>] for a related method. It has value 2 if the agent has reached the final goal state (in which case, the inferential process terminates). It has value 1 if the agent has just reached a subgoal state (in which case, a new subgoal is sampled). Otherwise, <italic>F</italic> has value 0 (in which case, the same subgoal is used for the next inferential step).</p>
</sec>
<sec id="sec005">
<title>Subgoal <italic>a priori</italic> distribution</title>
<p>Subgoals are states that are inferred during the <italic>planning-as-inference (PAI)</italic> process, and which enable the selection of optimal sequences of transitions from the initial state to the final goal.</p>
<p>A key feature of our probabilistic model is the use of a <italic>subgoal a-priori probability distribution (SG)</italic> that is used to guide the inferential process and in particular to select candidate subgoals (see later). For each state, this distribution essentially encodes a (prior) probability that the state is a potentially useful subgoal, or in other words a good way to carve the search problem.</p>
<p>In the following, we show two ways to calculate the a-priori probability (<italic>prior</italic>) of subgoal states. The former method (Algorithmic priors), crucial in our approach, is deduced from Algorithmic Probability theory, introduced by Solomonoff [<xref ref-type="bibr" rid="pcbi.1004864.ref065">65</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref066">66</xref>]; as we will discuss, it reveals structural aspects of the problem space and affords efficient path planning. The latter method (Perceptual priors), carves the problem space in a different (and suboptimal) way, essentially encoding the mere perceptual distance to the goal state. We will use this latter method to simulate human failures in the execution of counterintuitive movements (see the “<xref ref-type="sec" rid="sec010">Results</xref>” section).</p>
<sec id="sec006">
<title>Algorithmic priors</title>
<p>The “algorithmic priors” of a state encode the idea that a state is a potentially useful subgoal if it affords several and efficient paths to goals—which, using algorithmic probability theory, can be defined in terms of the notion of <italic>programs</italic>, which we formally introduce next.</p>
<p>If we set a starting state <italic>s</italic><sub><italic>i</italic></sub>, an arrival state <italic>s</italic><sub><italic>k</italic></sub> and a policy <italic>π</italic><sub><italic>j</italic></sub> (i.e., a function <italic>π</italic>(<italic>s</italic>) = <italic>a</italic> with <italic>s</italic> ∈ <italic>S</italic> and <italic>a</italic> ∈ <italic>A</italic>), the assumption of a discrete state space let us compute a list of actions that starting from <italic>s</italic><sub><italic>i</italic></sub> bring to <italic>s</italic><sub><italic>k</italic></sub> through a path <italic>w</italic> = 〈<italic>s</italic><sub><italic>i</italic></sub>, …, <italic>s</italic><sub><italic>k</italic></sub>〉. In other words, the object individuated by means of the triple (<italic>s</italic><sub><italic>i</italic></sub>, <italic>π</italic><sub><italic>j</italic></sub>, <italic>s</italic><sub><italic>k</italic></sub>) is a <italic>program</italic> (i.e., a code that with <italic>s</italic><sub><italic>i</italic></sub> as input stops in <italic>s</italic><sub><italic>k</italic></sub>). Notice that this is not a biunique correspondence because, if one fixes a path <italic>w</italic>, the program generating <italic>w</italic> can be determined by different policies (say, for instance, two policies <italic>π</italic> and <italic>π</italic>′ such that <italic>π</italic>(<italic>s</italic>) = <italic>π</italic>′(<italic>s</italic>) for every <italic>s</italic> ∈ <italic>w</italic> and <inline-formula id="pcbi.1004864.e001"><alternatives><graphic id="pcbi.1004864.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mo>∃</mml:mo> <mml:mspace width="0.277778em"/><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>¯</mml:mo></mml:mover><mml:mtext> </mml:mtext><mml:mo>∉</mml:mo><mml:mtext> </mml:mtext><mml:mi>w</mml:mi> <mml:mo>:</mml:mo> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≠</mml:mo> <mml:msup><mml:mi>π</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>).</p>
<p>To understand the relation between programs and policies, let’s consider that, given a domain with transitions determined by a function <italic>f</italic> such that <italic>f</italic>(<italic>s</italic>, <italic>a</italic>) = <italic>s</italic>′, and once two states <italic>s</italic><sub><italic>i</italic></sub> and <italic>s</italic><sub><italic>k</italic></sub> are fixed, it is possible to generate a sequence of instructions to move from <italic>s</italic><sub><italic>i</italic></sub> to <italic>s</italic><sub><italic>k</italic></sub> via <italic>π</italic> by means of the following recursive definition:
<disp-formula id="pcbi.1004864.e002"><alternatives><graphic id="pcbi.1004864.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>s</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>s</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>The resulting instruction sequence can be represented as an <italic>imperative program</italic> for a register machine with <italic>s</italic><sub><italic>i</italic></sub> and <italic>s</italic><sub><italic>k</italic></sub>, as input and output registers, respectively, and the other states <italic>s</italic><sup>(<italic>t</italic>)</sup> as destination/operand registers. As we discuss next, the length of a program can be converted into a probability and used within our probabilistic inference scheme.</p>
<p>Following principles of Algorithmic Probability theory, each program (<italic>s</italic><sub><italic>i</italic></sub>, <italic>π</italic><sub><italic>j</italic></sub>, <italic>s</italic><sub><italic>k</italic></sub>) can be formally transformed into a <italic>code</italic> (i.e., a binary string <monospace>p</monospace><sub><italic>s</italic><sub><italic>k</italic></sub></sub>(<italic>s</italic><sub><italic>i</italic></sub>, <italic>π</italic><sub><italic>j</italic></sub>) of length |<monospace>p</monospace><sub><italic>s</italic><sub><italic>k</italic></sub></sub>(<italic>s</italic><sub><italic>i</italic></sub>, <italic>π</italic><sub><italic>j</italic></sub>)|) and processed by a computing machine. To each code <monospace>p</monospace><sub><italic>s</italic><sub><italic>k</italic></sub></sub>(<italic>s</italic><sub><italic>i</italic></sub>, <italic>π</italic><sub><italic>j</italic></sub>), and consequently to each program, it is possible to assign a probability 2<sup>−|<monospace>p</monospace><sub><italic>s</italic><sub><italic>k</italic></sub></sub>(<italic>s</italic><sub><italic>i</italic></sub>, <italic>π</italic><sub><italic>j</italic></sub>)|</sup> depending on its length. In other words, the probability 2<sup>−|<monospace>p</monospace><sub><italic>s</italic><sub><italic>k</italic></sub></sub>(<italic>s</italic><sub><italic>i</italic></sub>, <italic>π</italic><sub><italic>j</italic></sub>)|</sup> is the probability of a program code that starts from <italic>s</italic><sub><italic>i</italic></sub> and ends up in <italic>s</italic><sub><italic>k</italic></sub>, after executing the sequence of actions <italic>a</italic><sub>1</sub>, …, <italic>a</italic><sub><italic>m</italic></sub> that is dictated by the policy <italic>π</italic><sub><italic>j</italic></sub>.</p>
<p>This probability goes to 0 in the limit of |<monospace>p</monospace><sub><italic>s</italic><sub><italic>k</italic></sub></sub>(<italic>s</italic><sub><italic>i</italic></sub>, <italic>π</italic><sub><italic>j</italic></sub>)| → ∞, when a program does not halt in <italic>s</italic><sub><italic>k</italic></sub> (or it does not halt at all). Furthermore, this probability is equal to 1 when |<monospace>p</monospace><sub><italic>s</italic><sub><italic>k</italic></sub></sub>(<italic>s</italic><sub><italic>i</italic></sub>, <italic>π</italic><sub><italic>j</italic></sub>)| = 0 (this happens when initial and arrival states coincide). This last condition is satisfied in our representation if and only if there exists a policy working as an “identity policy” corresponding to our definition of the policy <italic>π</italic><sub><italic>ε</italic></sub>, see the Section on “Probabilistic Model” for details.</p>
<p>The algorithmic probability for a generic state <italic>s</italic><sub><italic>k</italic></sub> can be computed, up to a normalization factor, by the following Equation:
<disp-formula id="pcbi.1004864.e003"><alternatives><graphic id="pcbi.1004864.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mi>G</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:mrow><mml:mo>-</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="monospace">p</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula> <xref ref-type="disp-formula" rid="pcbi.1004864.e003">Eq (1)</xref> applied on every state generates an a priori “algorithmic probability” distribution (<italic>algorithmic priors</italic>) in which the more informative states (i.e., subgoals important for decomposing any multi-step planning task) have the highest probability values. This method is related to the approach presented in [<xref ref-type="bibr" rid="pcbi.1004864.ref043">43</xref>], which considers for each state “the amount of Shannon information that the agent needs to maintain about the current goal at a given state to select the appropriate action”.</p>
<p>The computed algorithmic priors for subgoal states are specific for a given environment and their computation is very costly. In [<xref ref-type="bibr" rid="pcbi.1004864.ref035">35</xref>] we have empirically verified that sampling on a much smaller set of policies (100.000 in [<xref ref-type="bibr" rid="pcbi.1004864.ref035">35</xref>]) is sufficient to have a consistent approximation of the prior values and to reveal the shape of the distribution (i.e., which states have higher prior values). Sampling increasingly more policies allows to straightly improve this approximation thanks to the “cumulative” nature of <xref ref-type="disp-formula" rid="pcbi.1004864.e003">Eq (1)</xref>. Either way, we designed an efficient strategy for their non-approximated evaluation. First, algorithmic priors can be computed in an off-line (batch) mode, before inference, and reused for every inference in the same environment. Second, we use joint probabilities and an adequate state space representation to make the computation of algorithmic priors more effective. In fact, <xref ref-type="disp-formula" rid="pcbi.1004864.e003">Eq (1)</xref> can be formulated in terms of algorithmic joint probabilities as
<disp-formula id="pcbi.1004864.e004"><alternatives><graphic id="pcbi.1004864.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mi>G</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
with
<disp-formula id="pcbi.1004864.e005"><alternatives><graphic id="pcbi.1004864.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>l</mml:mi></mml:munder> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:mo>-</mml:mo> <mml:mo>(</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="monospace">p</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mo>+</mml:mo> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="monospace">p</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:mrow><mml:mo>-</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="monospace">p</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
where the equality on the right side follows by two properties of the model: 1) two states co-occur if and only if the programs that have <italic>s</italic><sub><italic>k</italic></sub> (<italic>s</italic><sub><italic>i</italic></sub>) as output are prefixes of the programs returning <italic>s</italic><sub><italic>i</italic></sub> (<italic>s</italic><sub><italic>k</italic></sub>); and 2) if a program from <italic>s</italic><sub><italic>k</italic></sub> to <italic>s</italic><sub><italic>i</italic></sub> exists then, by assuming that transitions are symmetric, there is also the opposite one from <italic>s</italic><sub><italic>i</italic></sub> to <italic>s</italic><sub><italic>k</italic></sub>.</p>
<p>Additionally, the space of states can be rearranged as a graph with the states <italic>s</italic><sub><italic>i</italic></sub> as vertices and the transitions between states as edges. Encoding the graph as an <italic>adjacency list</italic>, i.e., a collection of unordered lists related to each state and composed of the neighbors of the related vertex, it is possible, given two states <italic>s</italic><sub><italic>i</italic></sub> and <italic>s</italic><sub><italic>k</italic></sub>, to run a standard depth-first search algorithm for finding all the paths <italic>c</italic> ∈ <italic>C</italic>(<italic>s</italic><sub><italic>i</italic></sub>, <italic>s</italic><sub><italic>k</italic></sub>) between them. Every path <italic>c</italic> corresponds to a distinct program code <monospace>p</monospace><sub><italic>c</italic></sub>, but, as we stressed previously, each program can be attained by a certain set of different policies indicated as <italic>μ</italic>(<monospace>p</monospace><sub><italic>c</italic></sub>). The number <italic>μ</italic>(<monospace>p</monospace><sub><italic>c</italic></sub>) can be computed by considering each combination of the neighbors of the states not involved in the specific path <italic>c</italic>.</p>
<p>Consequently, the joint probability <italic>p</italic>(<italic>s</italic><sub><italic>k</italic></sub>, <italic>s</italic><sub><italic>i</italic></sub>) expressed in <xref ref-type="disp-formula" rid="pcbi.1004864.e005">Eq (3)</xref> can be written in the following form:
<disp-formula id="pcbi.1004864.e006"><alternatives><graphic id="pcbi.1004864.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>C</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:munder> <mml:mi>μ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="monospace">p</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:mrow><mml:mo>-</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="monospace">p</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula></p>
<p>In our case the number of states is finite, thus, given any pair of states, it is possible to compute their joint probability using <xref ref-type="disp-formula" rid="pcbi.1004864.e006">Eq (4)</xref>. By substituting <xref ref-type="disp-formula" rid="pcbi.1004864.e006">Eq (4)</xref> in <xref ref-type="disp-formula" rid="pcbi.1004864.e004">Eq (2)</xref> we obtain:
<disp-formula id="pcbi.1004864.e007"><alternatives><graphic id="pcbi.1004864.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mi>G</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>C</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:munder> <mml:mi>μ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="monospace">p</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:mrow><mml:mo>-</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="monospace">p</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mfenced></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
This <xref ref-type="disp-formula" rid="pcbi.1004864.e007">Eq (5)</xref> allows computing for each state <italic>s</italic><sub><italic>k</italic></sub> the value <italic>p</italic>(<italic>SG</italic> = <italic>s</italic><sub><italic>k</italic></sub>) corresponding to the algorithmic prior assigned to the state <italic>s</italic><sub><italic>k</italic></sub> and expressed in <xref ref-type="disp-formula" rid="pcbi.1004864.e003">Eq (1)</xref>. Note that <xref ref-type="disp-formula" rid="pcbi.1004864.e007">Eq (5)</xref> dramatically reduces the computational complexity of <xref ref-type="disp-formula" rid="pcbi.1004864.e003">Eq (1)</xref> to <italic>O</italic>(<italic>n</italic> + <italic>e</italic>), equal to the depth-first search complexity.</p>
<p>The same procedure based as an adjacency list is employed in the inferential process described below (see the Section on “Inferential procedure”) to calculate <italic>p</italic>(<italic>sg</italic><sub><italic>t</italic>+1</sub> | <italic>sg</italic><sub><italic>t</italic></sub>) and <italic>p</italic>(<italic>s</italic><sub><italic>goal</italic></sub> | <italic>sg</italic><sub><italic>t</italic>+1</sub>) through the usual chain rule for probabilities.</p>
</sec>
<sec id="sec007">
<title>Perceptual priors</title>
<p>In human problem solving, a perceptual strategy is one in which subjects privilege the moves whose effect more closely (perceptually) resembles the goal state: the larger is the number of disks on the correct rod, the higher is the probability assigned to the corresponding state. In keeping, and similar to previous modeling work [<xref ref-type="bibr" rid="pcbi.1004864.ref067">67</xref>], we formalized a “perceptual metric” that favors disks put on the target rod. To this aim, we encoded states of the problem as vector <bold>v</bold>(<italic>s</italic>) = (<italic>rod</italic><sub>1</sub>, …, <italic>rod</italic><sub><italic>d</italic></sub>, …, <italic>rod</italic><sub><italic>D</italic></sub>), where <italic>rod</italic><sub><italic>d</italic></sub> denotes the number of the rod on which the disk is, and <italic>d</italic> denotes the index of the disk type (e.g., in our tests <italic>D</italic> = 3 and S27 and S20 are mapped into (3, 3, 3) and (2, 2, 2), respectively). The perceptual prior of the state <italic>s</italic><sub><italic>i</italic></sub> can thus be given as:
<disp-formula id="pcbi.1004864.e008"><alternatives><graphic id="pcbi.1004864.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mtext>perc</mml:mtext></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mtext>goal</mml:mtext></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold">v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mi>o</mml:mi> <mml:mi>a</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:msub><mml:mo>|</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>l</mml:mi></mml:msub> <mml:mrow><mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">v</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold">v</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mi>o</mml:mi> <mml:mi>a</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
where we use the <inline-formula id="pcbi.1004864.e009"><alternatives><graphic id="pcbi.1004864.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msub><mml:mi mathvariant="script">L</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> norm between vectors to calculate the distance between <italic>s</italic><sub><italic>i</italic></sub> and <italic>s</italic><sub><italic>goal</italic></sub>.</p>
</sec>
</sec>
<sec id="sec008">
<title>Inferential procedure</title>
<p>In the standard <italic>planning-as-inference (PAI)</italic> approach, the inference tries to find a suitable policy from a start (<italic>s</italic><sub>0</sub>) to a goal location (<italic>s</italic><sub><italic>goal</italic></sub>). Rather, in keeping with the recognized importance of subgoaling in problem solving, our method infers a series of simpler sub-plans that pass through a sequence of subgoals <italic>s</italic><sub>0</sub>, <italic>sg</italic><sub>1</sub>, …, <italic>sg</italic><sub><italic>k</italic></sub>, …, <italic>s</italic><sub><italic>goal</italic></sub>, until the goal state is reached. In other words, here the inferential process aims at finding a sequence of subgoals (and associated policies that govern the transitions from one subgoal to the next) that best permits to solve a specific problem, rather than finding a solution from start to end. The way the sequence of subgoals and associated policies are selected is described next.</p>
<p>The procedure iteratively <italic>samples</italic> (i.e., extracts probabilistically), first, candidate subgoals from the previously described a priori subgoal distribution <italic>p</italic>(<italic>SG</italic>), and second, policies (from <italic>π</italic>) that can govern the transition to the sampled subgoal. The sampling procedure is cycled until the final goal <italic>s</italic><sub><italic>goal</italic></sub> is eventually reached (or for a maximum number of steps <italic>T</italic><sub>max</sub>). During this procedure, both <italic>s</italic> and <italic>p</italic>(<italic>SG</italic>) are iteratively updated to reflect the current planned path toward the goal and the most useful subgoals given the final goal, respectively.</p>
<p>In the course of this iterative process, the candidate subgoals are retained or discarded by considering the computational complexity of the sub-problems they generate. More formally, a candidate subgoal sequence is selected on the basis of the code length of the corresponding <italic>programs</italic>, which go from one subgoal (or the start location) to the next. We remind that a <italic>program</italic> is defined as the sequence of actions necessary for the transition from an initial state <italic>s</italic> to a subgoal state <italic>sg</italic> (and is equivalent to a path following a policy <italic>π</italic> [<xref ref-type="bibr" rid="pcbi.1004864.ref061">61</xref>] from <italic>s</italic> to <italic>sg</italic>). The length of the program (i.e., the number of actions necessary to reach <italic>sg</italic> from <italic>s</italic>) is converted into a probability using <italic>algorithmic probability theory</italic> [<xref ref-type="bibr" rid="pcbi.1004864.ref065">65</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref066">66</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref068">68</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref069">69</xref>] and this probability is used in the iterative procedure to decide whether the solution (including the subgoal plus the program) should be retained or discarded.</p>
<p>The inference is formalized by the pseudocode of Algorithm 1. Following the model of <xref ref-type="fig" rid="pcbi.1004864.g002">Fig 2</xref>, the inference starts at time <italic>t</italic> = 0 from the initial state <italic>s</italic><sub>0</sub> of the node <italic>S</italic>. The distribution of the algorithmic priors <italic>p</italic>(<italic>SG</italic>) is modified to set the goal state <italic>s</italic><sub>goal</sub> as the state with highest prior.</p>
<p specific-use="line"><monospace><bold>Algorithm 1</bold> P<sc>lanning</sc> I<sc>nference</sc>(<italic>s</italic><sub>0</sub>, <italic>s</italic><sub>goal</sub>, <italic>q</italic>, <italic>p</italic>(<italic>SG</italic>), <italic>T</italic><sub>max</sub>)</monospace></p>
<p specific-use="line"><monospace><bold>Require:</bold> Starting state <italic>s</italic><sub>0</sub>, goal state <italic>s</italic><sub>goal</sub>, sampled model instances <italic>q</italic>, subgoal algorithmic priors <italic>p</italic>(<italic>SG</italic>), maximum number of forward inferences <italic>T</italic><sub>max</sub>.</monospace></p>
<p specific-use="line"><monospace><bold>Ensure:</bold> State sequence [<italic>s</italic><sub>0</sub>, …, <italic>s</italic><sub>goal</sub>], subgoal sequence <italic>Seq</italic>.</monospace></p>
<p specific-use="line"><monospace>1: <italic>t</italic> = 0</monospace></p>
<p specific-use="line"><monospace>2: <bold>set</bold> <italic>S</italic><sub>0</sub> to the starting state <italic>s</italic><sub>0</sub></monospace></p>
<p specific-use="line"><monospace>3: <bold>sample</bold> a subgoal <italic>sg</italic><sub>0</sub> from the prior distribution <italic>p</italic>(<italic>SG</italic>) attained by using <xref ref-type="disp-formula" rid="pcbi.1004864.e003">Eq (1)</xref> on each state</monospace></p>
<p specific-use="line"><monospace>4: <bold>select</bold> a policy <italic>π</italic><sub>0</sub> maximizing <xref ref-type="disp-formula" rid="pcbi.1004864.e011">Eq (8)</xref> sampled through a Monte Carlo method</monospace></p>
<p specific-use="line"><monospace>5: <bold>determine</bold> the action <italic>a</italic><sub>0</sub> depending on <italic>π</italic><sub>0</sub> and <italic>s</italic><sub>0</sub></monospace></p>
<p specific-use="line"><monospace>6: <bold>evaluate</bold> the termination condition state <italic>F</italic><sub>0</sub> according to <italic>p</italic>(<italic>F</italic><sub>0</sub>|<italic>sg</italic><sub>0</sub>, <italic>s</italic><sub>0</sub>)</monospace></p>
<p specific-use="line"><monospace>7: <bold>while</bold> (<italic>F</italic><sub><italic>t</italic></sub> &lt; 2 and <italic>t</italic> ≤ <italic>T</italic><sub>max</sub>) <bold>do</bold></monospace></p>
<p specific-use="line"><monospace>8:  <italic>t</italic> = <italic>t</italic>+1</monospace></p>
<p specific-use="line"><monospace>9:  <bold>determine</bold> the state <italic>s</italic><sub><italic>t</italic></sub> by means of <italic>p</italic>(<italic>S</italic><sub><italic>t</italic></sub>|<italic>a</italic><sub>(<italic>t</italic> − 1)</sub>, <italic>s</italic><sub>(<italic>t</italic> − 1)</sub>)</monospace></p>
<p specific-use="line"><monospace>10:  <bold>select</bold> the subgoal <italic>sg</italic><sub><italic>t</italic></sub> maximizing <xref ref-type="disp-formula" rid="pcbi.1004864.e015">Eq (12)</xref> sampled through a Monte Carlo method</monospace></p>
<p specific-use="line"><monospace>11:  <bold>select</bold> a policy <italic>π</italic><sub><italic>t</italic></sub> maximizing <xref ref-type="disp-formula" rid="pcbi.1004864.e011">Eq (8)</xref> sampled through a Monte Carlo method</monospace></p>
<p specific-use="line"><monospace>12:  <bold>determine</bold> the action <italic>a</italic><sub><italic>t</italic></sub> depending on <italic>π</italic><sub><italic>t</italic></sub> and <italic>s</italic><sub><italic>t</italic></sub></monospace></p>
<p specific-use="line"><monospace>13:  <bold>evaluate</bold> the termination condition variable <italic>F</italic><sub><italic>t</italic></sub> according to <italic>p</italic>(<italic>F</italic><sub><italic>t</italic></sub>|<italic>sg</italic><sub><italic>t</italic></sub>, <italic>s</italic><sub><italic>t</italic></sub>)</monospace></p>
<p specific-use="line"><monospace>14:  <bold>update</bold> subgoal prior distribution by posing <italic>p</italic>(<italic>SG</italic><sub><italic>t</italic></sub> = <italic>s</italic><sub><italic>t</italic></sub>) = 0</monospace></p>
<p specific-use="line"><monospace>15: <bold>end while</bold></monospace></p>
<p>The distribution <italic>p</italic>(<italic>SG</italic>) is initially determined by using <xref ref-type="disp-formula" rid="pcbi.1004864.e003">Eq (1)</xref> to assign an algorithmic prior value to each state of the environment. Therefore, we sort in descending order the values of <italic>p</italic>(<italic>SG</italic>) and impose that
<disp-formula id="pcbi.1004864.e010"><alternatives><graphic id="pcbi.1004864.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mi>G</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mi>o</mml:mi> <mml:mi>a</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mi>G</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula>
where Δ &gt; 0 is the maximum difference, in absolute value, between two consecutive priors arranged by the ordering.</p>
<p>Note that the maximization of <xref ref-type="disp-formula" rid="pcbi.1004864.e010">Eq (7)</xref> operates over the values of <italic>p</italic>(<italic>SG</italic>) calculated using <xref ref-type="disp-formula" rid="pcbi.1004864.e003">Eq (1)</xref>, which are predefined during the inference. Afterwards, the whole prior distribution is normalized taking into account the modified value for <italic>P</italic>(<italic>SG</italic> = <italic>s</italic><sub><italic>goal</italic></sub>).</p>
<p>At time <italic>t</italic> = 0, a subgoal <italic>sg</italic><sub>0</sub> is drawn from the a priori algorithmic probability distribution (line 3) presented in the Section on “Algorithmic priors” and modified as in <xref ref-type="disp-formula" rid="pcbi.1004864.e010">Eq (7)</xref>. Then, the instruction in line 4 searches for a policy <italic>π</italic><sub><italic>t</italic></sub> such that it is possible to build a program representing a transition from <italic>s</italic><sub><italic>t</italic></sub> to <italic>sg</italic><sub><italic>t</italic></sub>. This is achieved by drawing a policy from the following probability distribution:
<disp-formula id="pcbi.1004864.e011"><alternatives><graphic id="pcbi.1004864.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo>Π</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>|</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>|</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mo>Π</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.277778em"/><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula> <xref ref-type="disp-formula" rid="pcbi.1004864.e011">Eq (8)</xref> expresses the probability of selecting a specific policy <italic>π</italic><sub><italic>j</italic></sub> in function of the length of the <italic>program code</italic> that from the current state <italic>s</italic><sub><italic>t</italic></sub>, by means of <italic>π</italic><sub><italic>j</italic></sub>, brings to the subgoal <italic>sg</italic><sub><italic>t</italic></sub>, weighted with the prior of the policy <italic>π</italic><sub><italic>j</italic></sub></p>
<p>It is possible to rewrite <xref ref-type="disp-formula" rid="pcbi.1004864.e011">Eq (8)</xref> in an algorithmic form as:
<disp-formula id="pcbi.1004864.e012"><alternatives><graphic id="pcbi.1004864.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mo>Π</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>∝</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>|</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mo>Π</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.277778em"/><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mo>∝</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:mrow><mml:mo>-</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="monospace">p</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mfenced> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
where the first factor of the right side product derives from the algorithmic joint probability shown in <xref ref-type="disp-formula" rid="pcbi.1004864.e005">Eq (3)</xref> by considering the policy <italic>π</italic><sub><italic>j</italic></sub> as fixed. Hence, in the resulting <xref ref-type="disp-formula" rid="pcbi.1004864.e012">Eq (9)</xref>, the probability of a specific policy <italic>π</italic><sub><italic>j</italic></sub> is proportional to its capability to generate a program that starts from the current state <italic>s</italic><sub><italic>t</italic></sub> and reaches the currently selected subgoal <italic>sg</italic><sub><italic>t</italic></sub>.</p>
<p>Note that <xref ref-type="disp-formula" rid="pcbi.1004864.e012">Eq (9)</xref> is symmetric in the route as the transitions are symmetric—but the fact that we assign the final goal a high prior gives inference a directionality.</p>
<p>According to <xref ref-type="disp-formula" rid="pcbi.1004864.e012">Eq (9)</xref>, the probability of a policy <italic>π</italic> conditioned by a state <italic>s</italic> and a subgoal <italic>sg</italic> is the product between the likelihood that <italic>π</italic> generates a path from <italic>s</italic> to <italic>sg</italic> and the a priori probability <italic>p</italic>(<italic>π</italic>). By assuming that <italic>p</italic>(<italic>π</italic>) is uniform, for any given pair of <italic>s</italic> and <italic>sg</italic>, there exists a subset of policies that have the same probability.</p>
<p>In our simulations, drawing from the distribution defined in <xref ref-type="disp-formula" rid="pcbi.1004864.e012">Eq (9)</xref> takes place by means of a Monte Carlo sampling method [<xref ref-type="bibr" rid="pcbi.1004864.ref070">70</xref>]. The candidate policies are sampled from the uniform distribution <italic>p</italic>(Π<sub><italic>t</italic></sub>) and then the policy corresponding to <italic>π</italic>* = arg max<sub><italic>j</italic></sub> <italic>p</italic>(<italic>π</italic><sub><italic>j</italic></sub>|<italic>s</italic><sub><italic>t</italic></sub>, <italic>sg</italic><sub><italic>t</italic></sub>) is selected. This is the best policy (i.e., the one resulting in shortest paths) amongst those that were sampled. Of note, various alternatives to sampling methods (e.g., heuristic techniques or tree search [<xref ref-type="bibr" rid="pcbi.1004864.ref071">71</xref>]) can be adopted.</p>
<p>The inference described so far starts from an initial (clamped) state <italic>s</italic><sub><italic>t</italic></sub> and returns a subgoal <italic>sg</italic><sub><italic>t</italic></sub> and a policy <italic>π</italic><sub><italic>t</italic></sub> able to reach it. (This can be viewed as an Option-like plan built on-the-fly with the minimum number of actions involved into the transition from the initial to the subgoal state.) Given the policy <italic>π</italic><sub><italic>t</italic></sub>, and knowing the state <italic>s</italic><sub><italic>t</italic></sub>, the action <italic>a</italic><sub><italic>t</italic></sub> is determined in a straightforward manner (line 5).</p>
<p>At this point—line 6—the node <italic>F</italic><sub><italic>t</italic></sub> checks the reaching of a goal state <italic>s</italic><sub><italic>goal</italic></sub>. If <italic>s</italic><sub><italic>t</italic></sub> = <italic>s</italic><sub><italic>goal</italic></sub> then <italic>f</italic><sub><italic>t</italic></sub> = 2 and inference process stops, otherwise it proceeds until at least one among the termination criteria is fulfilled (line 7): either the node <italic>F</italic><sub><italic>t</italic></sub> evaluates to 2 or a maximum number <italic>T</italic><sub><italic>max</italic></sub> of inferential cycles has been effected.</p>
<p>During these (from line 7 to line 15) and after that the next state <italic>s</italic><sub><italic>t</italic>+1</sub> is determined via <italic>p</italic>(<italic>s</italic><sub><italic>t</italic>+1</sub>|<italic>s</italic><sub><italic>t</italic></sub>, <italic>a</italic><sub><italic>t</italic></sub>) <xref ref-type="table" rid="pcbi.1004864.t001">Table 1</xref> (line 9), the subgoal transition <italic>SG</italic><sub><italic>t</italic></sub> → <italic>SG</italic><sub><italic>t</italic>+1</sub>[<xref ref-type="bibr" rid="pcbi.1004864.ref038">38</xref>] is established (line 10). In case that <italic>s</italic><sub><italic>t</italic></sub> ≠ <italic>sg</italic><sub><italic>t</italic></sub>, the node <italic>F</italic><sub><italic>t</italic></sub> assumes a zero value and the subgoal <italic>sg</italic><sub><italic>t</italic>+1</sub> is forced to be the same as time <italic>t</italic>. Contrarily, when <italic>f</italic><sub><italic>t</italic></sub> = 1, the current state <italic>s</italic><sub><italic>t</italic></sub> is equal to the current subgoal and a new one must be found.</p>
<table-wrap id="pcbi.1004864.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004864.t001</object-id>
<label>Table 1</label>
<caption>
<title>Algorithmic parameters set in the experiment shown in <xref ref-type="fig" rid="pcbi.1004864.g004">Fig 4</xref>.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004864.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004864.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Experiment</th>
<th align="center">Tower of Hanoi Task</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">States</td>
<td align="center">27</td>
</tr>
<tr>
<td align="center">Actions</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">Policies</td>
<td align="center">∼2.3 ⋅ 10<sup>12</sup></td>
</tr>
<tr>
<td align="center">Particles</td>
<td align="center">100</td>
</tr>
<tr>
<td align="center"><italic>R</italic></td>
<td align="center">10</td>
</tr>
<tr>
<td align="center"><italic>Θ</italic></td>
<td align="center">0.8</td>
</tr>
<tr>
<td align="center"><italic>T</italic><sub><italic>max</italic></sub></td>
<td align="center">12</td>
</tr>
<tr>
<td align="center"><italic>G</italic><sub><italic>res</italic></sub></td>
<td align="center">30%</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>In order to guide subgoal determination towards the goal state <italic>s</italic><sub><italic>goal</italic></sub>, the inference “clamps” the current subgoal <italic>sg</italic><sub><italic>t</italic></sub>, and assumes that <italic>f</italic><sub><italic>t</italic>+1</sub> = 2, namely it fictively considers the goal state as observed. Therefore, by the aforementioned considerations, the distribution <italic>p</italic>(<italic>SG</italic><sub><italic>t</italic>+1</sub> | <italic>f</italic><sub><italic>t</italic>+1</sub> = 2, <italic>sg</italic><sub><italic>t</italic></sub>) can be stated as:
<disp-formula id="pcbi.1004864.e013"><alternatives><graphic id="pcbi.1004864.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>|</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>∝</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mspace width="0.277778em"/><mml:mo>|</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.277778em"/><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>|</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mo>≡</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mi>o</mml:mi> <mml:mi>a</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>|</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.277778em"/><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>|</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
The term <italic>p</italic>(<italic>sg</italic><sub><italic>t</italic>+1</sub> | <italic>sg</italic><sub><italic>t</italic></sub>) estimates the probability that the subgoal <italic>sg</italic><sub><italic>t</italic>+1</sub> is chosen after <italic>sg</italic><sub><italic>t</italic></sub> and the likelihood <italic>p</italic>(<italic>f</italic><sub><italic>t</italic>+1</sub> = 2 | <italic>sg</italic><sub><italic>t</italic>+1</sub>) corresponds to the conditional probability <italic>p</italic>(<italic>s</italic><sub><italic>goal</italic></sub> | <italic>sg</italic><sub><italic>t</italic>+1</sub>) of the goal state <italic>s</italic><sub><italic>goal</italic></sub> with respect to the subgoal <italic>sg</italic><sub><italic>t</italic>+1</sub>.</p>
<p>The algorithmic expression of <xref ref-type="disp-formula" rid="pcbi.1004864.e013">Eq (10)</xref> stems from conditioning all the programs returning the goal to produce <italic>sg</italic><sub><italic>t</italic>+1</sub> as intermediate outcome; thus, it becomes:
<disp-formula id="pcbi.1004864.e014"><alternatives><graphic id="pcbi.1004864.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>|</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>∝</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mi>o</mml:mi> <mml:mi>a</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>|</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.277778em"/><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>|</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>∝</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mfenced close=")" open="(" separators=""><mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:mrow><mml:mo>-</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="monospace">p</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mi>o</mml:mi> <mml:mi>a</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mfenced> <mml:mfenced close=")" open="(" separators=""><mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:mrow><mml:mo>-</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="monospace">p</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula></p>
<p>Candidate subgoals <italic>sg</italic><sub><italic>t</italic>+1</sub> are sampled by a Monte Carlo process [<xref ref-type="bibr" rid="pcbi.1004864.ref070">70</xref>] from the subgoal prior distribution <italic>p</italic>(<italic>SG</italic><sub><italic>t</italic></sub>). The subgoal at time <italic>t</italic> + 1 is calculated as <italic>sg</italic>* = arg max<sub><italic>k</italic></sub> <italic>p</italic>(<italic>sg</italic><sub><italic>k</italic></sub> | <italic>f</italic> <sub><italic>t</italic>+1</sub> = 2, <italic>sg</italic><sub><italic>t</italic></sub>).</p>
<p>Summing up, the <italic>SG</italic><sub><italic>t</italic>+1</sub> subgoal state is determined by means of a posterior estimation in dependence on the values of <italic>s</italic><sub><italic>t</italic></sub> and <italic>sg</italic><sub><italic>t</italic></sub>, according to the equation:
<disp-formula id="pcbi.1004864.e015"><alternatives><graphic id="pcbi.1004864.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:msub><mml:mi>G</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:msub><mml:mi>f</mml:mi> <mml:mi mathvariant="normal">t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd/></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:msub><mml:mi>G</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>|</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:msub><mml:mi>f</mml:mi> <mml:mi mathvariant="normal">t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd/></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mi>o</mml:mi> <mml:mi>a</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:msub><mml:mi>f</mml:mi> <mml:mi mathvariant="normal">t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:math></alternatives> <label>(12)</label></disp-formula>
where <italic>δ</italic><sub><italic>a</italic>, <italic>b</italic></sub> is 1 when <italic>a</italic> = <italic>b</italic> while is 0 otherwise.</p>
<p>Once the state for <italic>SG</italic><sub><italic>t</italic>+1</sub> has been set, the inference proceeds from line 11 to line 13 by, according to this sequence and following the methods previously discussed, selecting a policy <italic>π</italic><sub><italic>t</italic>+1</sub>, an action <italic>a</italic><sub><italic>t</italic>+1</sub>, and assessing <italic>f</italic><sub><italic>t</italic>+1</sub>.</p>
<p>Finally, in the instruction at line 14, subgoal prior distribution is updated by ‘switching off’ the prior of the current state, i.e., setting the probability <italic>p</italic>(<italic>SG</italic><sub><italic>t</italic></sub> = <italic>s</italic><sub><italic>t</italic></sub>) to zero and normalizing the whole distribution. This update has the effect of an ‘on-line memory’ preventing the inference from selecting at the line 10 previously visited states as subgoals.</p>
<p>In sum, the output of the iterative sampling procedure described in Algorithm 1 is a planning sequence <italic>Seq</italic>. Importantly, this procedure is conducted in parallel by multiple <italic>particles</italic> of a particle-filtering algorithm (with resampling) [<xref ref-type="bibr" rid="pcbi.1004864.ref070">70</xref>]. Each particle runs through all the problem space (for a maximum number of steps <italic>T</italic><sub>max</sub>) and returns a sequence of subgoals and associated programs that solve the problem (for the sake of simplicity, this ensemble of particles continues inferring paths until a percent <italic>G</italic><sub>res</sub> of them achieves the goal). Note that although the subgoaling procedure usually splits the problem into smaller sub-problems, it is also possible that a given particle finds a solution that does not require subgoals.</p>
<p>In the next subsection we describe how the to-be-executed plan is selected based on a mechanism that accumulates the “votes” of all the particles that solve the problem.</p>
</sec>
<sec id="sec009">
<title>Decision making through posterior accumulation scoring</title>
<p>The inferential procedure illustrated in Algorithm 1 permits to probabilistically solve planning problems. Nevertheless, its nature is essentially stochastic because a sampling technique is used to draw both policies and subgoals. Consequently, given the same pair of goal and start states, the model will infer more than one possible path as a response. This creates a problem of <italic>plan selection</italic>, because ultimately the agent can only select and execute one single plan.</p>
<p>We model this selection problem in terms of an accumulation-to-bound process, in which at every iteration each particle reaching the goal brings a “vote” for its candidate plan. Specifically, we use a variant of the widely adopted drift-diffusion model [<xref ref-type="bibr" rid="pcbi.1004864.ref072">72</xref>] that casts choice as a Bayesian sequential analysis over multiple alternatives [<xref ref-type="bibr" rid="pcbi.1004864.ref063">63</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref064">64</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref073">73</xref>]. In this approach, a set of different planning hypotheses is sequentially analyzed by gathering evidence for each of them during their execution. The sequential analysis is stopped when the results become significant according to a pre-defined termination criterion. The posteriors for the planning hypotheses are updated by using Bayes’ rule until reaching a threshold value.</p>
<p>This method is implemented via a <italic>particle filtering</italic> algorithm with <italic>resampling</italic> reported in Algorithm 2 (see [<xref ref-type="bibr" rid="pcbi.1004864.ref070">70</xref>]). At each resampling step <italic>r</italic>, for a maximum number of <italic>R</italic>, a set <italic>Q</italic><sub><italic>r</italic></sub> = {<italic>q</italic><sup>(1)</sup>, …, <italic>q</italic><sup>(<italic>K</italic>)</sup>} of particles representing <italic>K</italic> distinct planning hypotheses of the internal model activation is generated (line 7) and tracked forward until a time <italic>T</italic><sub><italic>R</italic></sub>. By applying Algorithm 1 at the line 10, a subset of <italic>H</italic> ≤ <italic>K</italic> particles, able to successfully infer a plan directed to the goal, is carried out and the related subgoal sequences <italic>Seq</italic><sub><italic>h</italic></sub> = [<italic>sg</italic><sub><italic>t</italic> = 0</sub>, …, <italic>sg</italic><sub><italic>t</italic> = <italic>T</italic><sub><italic>r</italic></sub></sub>]<sub><italic>h</italic></sub>, for <italic>h</italic> = 1, …, <italic>H</italic>, are evaluated by means of a score <italic>θ</italic><sub><italic>h</italic></sub>.</p>
<p specific-use="line"><monospace><bold>Algorithm 2</bold> S<sc>equential</sc> D<sc>ecision</sc> M<sc>aking</sc>(<italic>s</italic><sub>0</sub>, <italic>s</italic><sub>goal</sub>, <italic>K</italic>, <italic>T</italic><sub>max</sub>, Θ, <italic>R</italic>, <italic>G</italic><sub>res</sub>)</monospace></p>
<p specific-use="line"><monospace><bold>Require:</bold> Starting state <italic>s</italic><sub>0</sub>, goal state <italic>s</italic><sub>goal</sub>, particle number <italic>K</italic>, maximum number of forward inferences <italic>T</italic><sub>max</sub>, decision threshold Θ, number of resamplings <italic>R</italic>, particles-gone-to-goal threshold <italic>G</italic><sub>res</sub>.</monospace></p>
<p specific-use="line"><monospace><bold>Ensure:</bold> Subgoal sequence probability distribution.</monospace></p>
<p specific-use="line"><monospace>1: <italic>r</italic> = 0</monospace></p>
<p specific-use="line"><monospace>2: <bold>initialize</bold> the set of subgoal sequences Σ ≡ {<italic>Seq</italic><sub><italic>h</italic></sub>}<sub><italic>h</italic> = 1, …, <italic>H</italic> ≤ <italic>K</italic></sub> = ∅</monospace></p>
<p specific-use="line"><monospace>3: <bold>initialize</bold> <italic>θ</italic><sub><italic>h</italic></sub>(0)</monospace></p>
<p specific-use="line"><monospace>4: <bold>compute</bold> <italic>p</italic><sub>0</sub>(<italic>SG</italic>) by means of <xref ref-type="disp-formula" rid="pcbi.1004864.e003">Eq (1)</xref> and <xref ref-type="disp-formula" rid="pcbi.1004864.e010">Eq (7)</xref></monospace></p>
<p specific-use="line"><monospace>5: <bold>while</bold> (<italic>θ</italic><sub><italic>h</italic></sub>(<italic>r</italic>) ≤ Θ, ∀<italic>h</italic> and <italic>r</italic> &lt; <italic>R</italic>) <bold>do</bold></monospace></p>
<p specific-use="line"><monospace>6:  <italic>k</italic> = 0</monospace></p>
<p specific-use="line"><monospace>7:  <bold>create</bold> the sample set <italic>Q</italic><sub><italic>r</italic></sub> = {<italic>q</italic><sup>(1)</sup>, …, <italic>q</italic><sup>(<italic>K</italic>)</sup>}</monospace></p>
<p specific-use="line"><monospace>8:  <bold>while</bold> (<italic>k</italic> ≤ <italic>K</italic> and <italic>G</italic>(<italic>Q<sub>r</sub></italic>)&lt;<italic>G</italic><sub>res</sub>) <bold>do</bold></monospace></p>
<p specific-use="line"><monospace>9:   <italic>k</italic> = <italic>k</italic>+1</monospace></p>
<p specific-use="line"><monospace>10:   <italic>Seq</italic><sub><italic>h</italic></sub> = P<sc>lanning</sc> I<sc>nference</sc>(<italic>s</italic><sub>0</sub>, <italic>s</italic><sub>goal</sub>, <italic>q</italic><sup>(<italic>k</italic>)</sup>, <italic>p</italic><sub>r</sub>(<italic>SG</italic>), <italic>T</italic><sub>max</sub>)</monospace></p>
<p specific-use="line"><monospace>11:   Σ = Σ ∪ <italic>Seq</italic><sub><italic>h</italic></sub></monospace></p>
<p specific-use="line"><monospace>12:  <bold>end while</bold></monospace></p>
<p specific-use="line"><monospace>13:  <italic>r</italic> = <italic>r</italic> + 1</monospace></p>
<p specific-use="line"><monospace>14:  <bold>update</bold> votes <italic>θ</italic><sub><italic>h</italic></sub>(<italic>r</italic>) for the sequences in Σ set by <xref ref-type="disp-formula" rid="pcbi.1004864.e016">Eq (13)</xref></monospace></p>
<p specific-use="line"><monospace>15:  <bold>update</bold> subgoal prior distribution <italic>p</italic><sub><italic>r</italic></sub>(<italic>SG</italic>) by <xref ref-type="disp-formula" rid="pcbi.1004864.e018">Eq (14)</xref></monospace></p>
<p specific-use="line"><monospace>16: <bold>end while</bold></monospace></p>
<p>Initially, when <italic>r</italic> = 0, we assume that <italic>p</italic><sub><italic>r</italic></sub>(<italic>SG</italic>) is computed through <xref ref-type="disp-formula" rid="pcbi.1004864.e003">Eq (1)</xref> and <xref ref-type="disp-formula" rid="pcbi.1004864.e010">Eq (7)</xref> and that, additionally, <italic>θ</italic><sub><italic>h</italic></sub>(0) = <italic>p</italic>(<italic>Seq</italic><sub><italic>h</italic></sub>) where <italic>p</italic>(<italic>Seq</italic><sub><italic>h</italic></sub>) is the prior distribution on the potential subgoal sequences. It is possible to assign a prior distribution for the sequences on the basis of the information extracted from the specific state space; on the other hand, this prior can be flattened when no additional information is present.</p>
<p>This inferential process is executed until at least one of the <italic>inference terminating conditions</italic> is reached (from line 8 to line 12): either <italic>G</italic>(<italic>Q</italic><sub><italic>r</italic></sub>) (the percent of particles in <italic>Q</italic><sub><italic>r</italic></sub> reaching the goal) is greater than or equal to a given threshold <italic>G</italic><sub>res</sub>, or the inference reaches a (fixed) maximum number <italic>T</italic><sub>max</sub> of iterations.</p>
<p>Subsequently, the scores of the subgoal sequences <italic>Seq</italic><sub><italic>h</italic></sub> are updated at the line 14 using the recursive formula:
<disp-formula id="pcbi.1004864.e016"><alternatives><graphic id="pcbi.1004864.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mi>h</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>h</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:mi>p</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>Q</mml:mi> <mml:mi>r</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>S</mml:mi> <mml:mi>e</mml:mi></mml:mrow> <mml:msub><mml:mi>q</mml:mi> <mml:mi>h</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math></alternatives> <label>(13)</label></disp-formula>
where
<disp-formula id="pcbi.1004864.e017"><alternatives><graphic id="pcbi.1004864.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mrow><mml:mi>p</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>Q</mml:mi> <mml:mi>r</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>S</mml:mi> <mml:mi>e</mml:mi></mml:mrow> <mml:msub><mml:mi>q</mml:mi> <mml:mi>h</mml:mi></mml:msub></mml:mfenced> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>K</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mi>p</mml:mi> <mml:mfenced close=")" open="(" separators=""><mml:msup><mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>S</mml:mi> <mml:mi>e</mml:mi></mml:mrow> <mml:msub><mml:mi>q</mml:mi> <mml:mi>h</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math></alternatives></disp-formula>
is the <italic>evidence</italic> of the current particle set <italic>Q</italic><sub><italic>r</italic></sub> given the sequence <italic>Seq</italic><sub><italic>h</italic></sub>, computed as the proportion of particles <italic>q</italic><sup><italic>k</italic></sup> tracing the specific subgoal sequence <italic>Seq</italic><sub><italic>h</italic></sub>. Therefore, the scores <italic>θ</italic><sub><italic>h</italic></sub> have the meaning of posteriors on <italic>Seq</italic><sub><italic>h</italic></sub> accumulated in <italic>r</italic> steps.</p>
<p>Each step <italic>r</italic> concludes by updating, in line 15, the subgoal priors <italic>p</italic><sub><italic>r</italic></sub>(<italic>SG</italic>) on the basis of the sampled sequences:
<disp-formula id="pcbi.1004864.e018"><alternatives><graphic id="pcbi.1004864.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004864.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mfenced close=")" open="(" separators=""><mml:mi>S</mml:mi> <mml:mi>G</mml:mi> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mfenced> <mml:mo>∝</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>r</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>r</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mi>G</mml:mi> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula>
where <italic>p</italic>(<italic>Q</italic><sub><italic>r</italic></sub>|<italic>sg</italic><sub><italic>k</italic></sub>) is the rate of the particles numbering <italic>sg</italic><sub><italic>k</italic></sub> among the subgoals exploited.</p>
<p>At the successive step <italic>r</italic> + 1, a new set of hypotheses <italic>Q</italic><sub><italic>r</italic>+1</sub> is resampled by adopting <italic>p</italic><sub><italic>r</italic>+1</sub>(<italic>SG</italic>) as subgoal prior distribution, which increases the probability of selecting the more effective subgoal sequences at the next step. This procedure is iterated until one of the convergence criteria is met (line 5): (a) a subgoal sequence receives a total score greater than or equal to a predefined <italic>decision threshold</italic> Θ, or (b) the maximum number of iterations <italic>R</italic> is performed. In both cases, the sequence with the highest score is selected for execution.</p>
<p>To verify if the proposed computational model can successfully reproduce human problem solving strategies, we tested it in three representative ToH tasks that are widely used to study how humans solve (or fail to solve) structured problems.</p>
</sec>
</sec>
<sec id="sec010" sec-type="results">
<title>Results</title>
<sec id="sec011">
<title>Humans are sensitive to the community structure of the ToH</title>
<p>A first important finding that we address here is the fact that subjects that solve a ToH have been found to be very sensitive to the <italic>community structure</italic> of the problem [<xref ref-type="bibr" rid="pcbi.1004864.ref074">74</xref>]. As shown in <xref ref-type="fig" rid="pcbi.1004864.g001">Fig 1C</xref>, a ToH has a community structure composed of three clusters of nodes separated by so-called “bottlenecks”, viz. states <italic>S</italic>9 − <italic>S</italic>11, <italic>S</italic>6 − <italic>S</italic>10, and <italic>S</italic>23 − <italic>S</italic>24. The bottlenecks are here defined topologically as narrow segments bridging between densely interconnected clusters of vertices; in other words, bottlenecks are the only way to pass from one cluster to another. For example, the bottleneck <italic>S</italic>9 − <italic>S</italic>11 is the only way to pass from the top cluster to the bottom-left cluster or vice versa.</p>
<p>Previous research has identified the importance of community structures in carving problem spaces [<xref ref-type="bibr" rid="pcbi.1004864.ref075">75</xref>] and the ToH is no exception. In a series of empirical studies on human problem solving [<xref ref-type="bibr" rid="pcbi.1004864.ref074">74</xref>], participants were asked to solve a ToH problem equivalent to navigating from <italic>S</italic>11 (starting state) to <italic>S</italic>13 (goal state), see <xref ref-type="fig" rid="pcbi.1004864.g001">Fig 1C</xref>. It is possible to note that there are two shortest-path solutions to the problem that require the same (minimal) number of steps: the former is <italic>w</italic><sub>1</sub> = 〈<italic>S</italic>11, <italic>S</italic>14, <italic>S</italic>18, <italic>S</italic>24, <italic>S</italic>23, <italic>S</italic>17, <italic>S</italic>13〉 and the latter is <italic>w</italic><sub>2</sub> = 〈<italic>S</italic>11, <italic>S</italic>9, <italic>S</italic>8, <italic>S</italic>7, <italic>S</italic>6, <italic>S</italic>10, <italic>S</italic>13〉. If the number of steps were the only determinant of behavior, participants should select the two paths with the same probability. However, there is an important difference between the two paths: the former requires traversing one bottleneck (i.e., one boundary between two communities, <italic>S</italic>23 − <italic>S</italic>24) while the latter requires traversing two bottlenecks (<italic>S</italic>9 − <italic>S</italic>11 and <italic>S</italic>6 − <italic>S</italic>10). Thus, if participants take the community structure into consideration when they plan and prefer remaining in the same cluster of nodes (i.e., not traversing bottlenecks) when possible, they should prefer the former solution (<italic>w</italic><sub>1</sub>) with higher probability. Participants selected <italic>w</italic><sub>1</sub> in 72% of the cases, suggesting that they are sensitive to the community structure of the ToH and prefer remaining in the same community.</p>
<p>The fact that there are two shortest-path solutions but one is consistently preferred indicates that the probability to select a path does not simply depend on its “physical” length (i.e., the number of steps). Instead, it might be also sensitive to the informational / community structure of the environment (e.g., the transition probabilities or the presence of community boundaries). To put it in another way, in problem solving, a path between two points (start and end of the problem) is not necessarily represented (or calculated) in a metrical space that only encodes their physical distance. Instead, it might be represented in a subtler “problem space” in which—say—the length of a path or the probability to select it depends on additional factors such as informational constraints, the cost of the inferential process required to solve the problem (e.g., find the path) or the amount of information required to encode or recall it [<xref ref-type="bibr" rid="pcbi.1004864.ref043">43</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref045">45</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref074">74</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref075">75</xref>].</p>
<p>Our proposed model incorporates a new hypothesis on how structural / informational constraints are incorporated in the inferential process. In our probabilistic approach, the prior subgoal probability shown in <xref ref-type="fig" rid="pcbi.1004864.g001">Fig 1C</xref> permits to identify bottlenecks or boundaries between communities in terms of paths that have low probability to be traversed. As the subgoal (prior) probability of the bottleneck nodes is smaller than the other nodes, any path traversing bottleneck nodes will have lower probability in our inferential system, discouraging subjects from crossing boundaries or traversing clusters of nodes. This stems from a key aspect of the algorithm: states having lower prior probability are more rarely sampled as subgoals during the subgoal selection phase (line 3 of Algorithm 1). Accordingly, the inferential system tends to select paths that have higher probability (or equivalently, correspond to shorter programs), which in turn are preferentially composed of high-probability states. Indeed, the probability of states enters into the evaluation of the policies that generate paths, see <xref ref-type="disp-formula" rid="pcbi.1004864.e012">Eq 9</xref>. Note also that the prior probability distribution is graded, and the probability of nodes decreases in proximity to bottlenecks. This implies that not only traversing bottlenecks, but also going towards bottlenecks is less probable in our inferential system.</p>
<p>To illustrate the effects of this subgoal-induced community structure in quantitative terms, we compared our model with subjects’ performance as reported in [<xref ref-type="bibr" rid="pcbi.1004864.ref074">74</xref>]. Let’s consider again the problem of starting from <italic>S</italic>11 to reach the goal state <italic>S</italic>13 (see <xref ref-type="fig" rid="pcbi.1004864.g001">Fig 1C</xref>). Considering the two possible shortest-path solutions, (<italic>w</italic><sub>1</sub> = 〈<italic>S</italic>11, <italic>S</italic>14, <italic>S</italic>18, <italic>S</italic>24, <italic>S</italic>23, <italic>S</italic>17, <italic>S</italic>13〉 with only one community-traverse, and <italic>w</italic><sub>2</sub> = 〈<italic>S</italic>11, <italic>S</italic>9, <italic>S</italic>8, <italic>S</italic>7, <italic>S</italic>6, <italic>S</italic>10, <italic>S</italic>13〉 with two community-traverses), the first path is made up of states with higher subgoal prior probability.</p>
<p>Our simulations show that even in the presence of these two shortest-path solutions to this problem, each involving the same number of steps, the winning (i.e., most voted) strategy is <italic>w</italic><sub>1</sub>: the one that selects the path traversing less bottlenecks or clusters. <xref ref-type="fig" rid="pcbi.1004864.g003">Fig 3</xref> shows a dynamical competition between the two solutions in which particles “vote” for one of them (see Section on ‘<xref ref-type="sec" rid="sec002">Methods</xref>’). At each iteration (resampling) of the voting procedure the probability for <italic>w</italic><sub>1</sub> increases; note that it reaches the same proportion (72%) as reported empirically in [<xref ref-type="bibr" rid="pcbi.1004864.ref074">74</xref>] after four iteration steps. Of course, the exact fit of the data is not extremely important here, nor is the specific combination of start and goal states, as our findings generalize to any other problem in the ToH. What our results show is that the proposed method reproduces the subjects’ sensitivity to the community structure of the ToH by only appealing to probabilistic computations and a principled approach to establish which subgoals are potentially useful.</p>
<fig id="pcbi.1004864.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004864.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Decision making procedure.</title>
<p>Choice between two paths (<italic>w</italic><sub>1</sub> vs. <italic>w</italic><sub>2</sub>) from <italic>S</italic>11 to <italic>S</italic>13 that require the same number of steps but traverse a different number of bottlenecks (1 for <italic>w</italic><sub>1</sub> and 2 for <italic>w</italic><sub>2</sub>. Choice is performed using a probabilistic version of the drift diffusion model [<xref ref-type="bibr" rid="pcbi.1004864.ref072">72</xref>] introduced in the Section on ‘Methods’, in which particles (of the particle filtering algorithm) that reach the goal “vote” for the specific strategy they followed.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004864.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec012">
<title>Humans are sensitive to the <italic>nested</italic> structure of the ToH</title>
<p>The three-cluster structure described above is not the only community structure of the ToH. Rather, the ToH has a 3-level <italic>nested</italic> community structure with (triangular) sub-clusters, see <xref ref-type="fig" rid="pcbi.1004864.g001">Fig 1C</xref>. Nested within the aforementioned (level-3) clusters one can find three (level-2) clusters (e.g., in the top level-3 cluster, these correspond to {<italic>S</italic>1, <italic>S</italic>2, <italic>S</italic>3}, {<italic>S</italic>5, <italic>S</italic>8, <italic>S</italic>9}, and {<italic>S</italic>4, <italic>S</italic>6, <italic>S</italic>7}). Furthermore, nested within each level-2 cluster one can find three level-1 clusters that correspond to individual nodes (e.g., in the top level-2 cluster, the nodes <italic>S</italic>1, <italic>S</italic>2, and <italic>S</italic>3). Bottlenecks at different levels of depth correspond to these nested clusters: <italic>S</italic>2 − <italic>S</italic>3 is a level-1 bottleneck, <italic>S</italic>7 − <italic>S</italic>8 is a level-2 bottleneck, and <italic>S</italic>23 − <italic>S</italic>24 is a level-3 bottleneck.</p>
<p>It has been reported that this nested structure affects human behavior [<xref ref-type="bibr" rid="pcbi.1004864.ref074">74</xref>]. Specifically, the costs for traversing a level-3 bottleneck (<italic>S</italic>23 − <italic>S</italic>24) are higher than those for traversing a level-2 bottleneck (<italic>S</italic>7 − <italic>S</italic>8), which in turn are higher than those for traversing a level-1 bottleneck (<italic>S</italic>2 − <italic>S</italic>3)—where the costs are implicitly measured as longer reaction times required to make a decision in the ToH. Once again, this difference only exists in a “problem space” and not in the standard “metric space” that only measures the number of steps to reach a goal location, because traversing a bottleneck (independent of its level) only requires one step.</p>
<p>The sensitivity for the nested ToH structure can be explained within our framework if one considers that the prior probability of traversing <italic>S</italic>2 − <italic>S</italic>3 (<italic>P</italic>(<italic>S</italic>3|<italic>S</italic>2) ⋅ <italic>P</italic>(<italic>S</italic>2) = 0.0464) is higher than traversing <italic>S</italic>7 − <italic>S</italic>8 (<italic>P</italic>(<italic>S</italic>8|<italic>S</italic>7) ⋅ <italic>P</italic>(<italic>S</italic>7) = 0.0358), which in turn is higher than traversing <italic>S</italic>23 − <italic>S</italic>24 (<italic>P</italic>(<italic>S</italic>24|<italic>S</italic>23) ⋅ <italic>P</italic>(<italic>S</italic>23) = 0.0355), see <xref ref-type="fig" rid="pcbi.1004864.g001">Fig 1C</xref>. These results thus extend those reported in the former Section and illustrate how the structure of the prior subgoal distribution nicely captures key characteristics of the “problem space” that humans use to solve problems.</p>
</sec>
<sec id="sec013">
<title>Humans have difficulties to execute counterintuitive movements</title>
<p>Empirical studies of how humans solve the Tower of Hanoi have identified a specific deficit in the failure of executing <italic>counterintuitive movements</italic>: moves that are apparently in opposition to the end goal-state (e.g., remove a disk from the target rod) but that are necessary to achieve the goal efficiently. In these cases, two strategies have been identified that have opposite results: a “look-ahead” strategy that considers the long-run effects of the counterintuitive movements and their benefits for the overall problem solving, versus a “perceptual” strategy that only tries to decrease myopically the perceived (apparent) distance to the goal state (e.g., only increases the number of disks in the target rod) [<xref ref-type="bibr" rid="pcbi.1004864.ref057">57</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref076">76</xref>]. This latter strategy disregards counterintuitive moves—which, by definition, require removing a disk from the target rod, thus apparently increasing the perceived distance from the goal state) and can lead to suboptimal behavior. Here we characterize both strategies from a common probabilistic inference viewpoint, and analyze why the former (look-ahead) permits efficient problem solving while the latter (perceptual) determines a failure of executing counterintuitive movements.</p>
<p>Let’s consider a sample problem consisting in going from a start (<italic>S</italic>27) to a goal (<italic>S</italic>20) configuration, see <xref ref-type="fig" rid="pcbi.1004864.g001">Fig 1</xref>. In our implementation, the two aforementioned (“look-ahead” vs. “perceptual”) strategies only differ for the choice of prior distributions of subgoals <italic>p</italic>(<italic>SG</italic>). The priors for the “look-ahead” strategy are shown in <xref ref-type="fig" rid="pcbi.1004864.g004">Fig 4A</xref>); they are calculated using the same approach as used in the former two studies. The priors for the “perceptual” strategy are shown in <xref ref-type="fig" rid="pcbi.1004864.g004">Fig 4B</xref>. Here, in keeping with the problem solving literature, the probability of a movement is computed using a perceptual-based proximity criterion: the more disks the agent sees on the correct rod (in the example of <xref ref-type="fig" rid="pcbi.1004864.g001">Fig 1</xref>, the central rod) as a consequence of the movement, the more probability it assigns to the movement (see <xref ref-type="sec" rid="sec002">Methods</xref> for details).</p>
<fig id="pcbi.1004864.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004864.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Simulation of look-ahead vs. perceptual strategies.</title>
<p>(a) Probability distribution on <italic>SG</italic> given the goal <italic>S</italic>20 using the “look-ahead” strategy. The priors are calculated by starting from the priors shown in <xref ref-type="fig" rid="pcbi.1004864.g001">Fig 1C</xref>, assigning the goal state (<italic>S</italic>20) the highest probability (see <xref ref-type="disp-formula" rid="pcbi.1004864.e010">Eq 7</xref>), and then normalizing. (b) Probability distribution <italic>SG</italic> given the goal <italic>S</italic>20 using the “perceptual” strategy. Different from the “look-ahead” strategy, here the priors reflect the “perceptual similarity” between each state and the goal state <italic>S</italic>20; for example, it is high for states in which there are disks in the second rod (e.g., <italic>S</italic>9, <italic>S</italic>11, <italic>S</italic>13, <italic>S</italic>17, <italic>S</italic>16, <italic>S</italic>21). As for the “look-ahead” strategy, it is highest in the goal state <italic>S</italic>20. The full procedure for calculating the priors is explained in the Section on Methods. (c) Probability of finding the best policy in function of the number of particles assigned to “perceptual” vs “look-ahead” strategy. The left part of the figure shows a “pure perceptual” strategy (100% of the particles use the priors of the “perceptual” strategy); the right part of the figure shows a “pure look-ahead” strategy (100% of the particles use the priors of the “look-ahead” strategy); and the central part of the figure shows intermediate cases (e.g., 50% of the particles use the priors of the “perceptual” strategy and 50% of the particles use the priors of the “look-ahead” strategy). Results are the mean of 25 runs. (d) Number of subgoals used by the particles (of the particle filtering algorithm) to solve the ToH problem starting from <italic>S</italic>27 and ending in <italic>S</italic>20. As this number also includes the last (goal) state, the figure shows that the majority of particles solve the problem using 2 or 3 intermediate subgoals. In principle, every state of the ToH can be a subgoal; however, our further analysis shown in <xref ref-type="fig" rid="pcbi.1004864.g007">Fig 7</xref> highlights that the most selected path is one that uses <italic>S</italic>22 and <italic>S</italic>21 as subgoal states.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004864.g004" xlink:type="simple"/>
</fig>
<p>Once these priors are set, the two strategies use the same probabilistic inference methods introduced before—thus, they only differ for their choice or priors, not the inference. Because they use the same inference methods, the performance of the two strategies, which are based on considerations of plan optimality (“look-ahead”) or perceptual proximity to the goal (“perceptual”) can be directly compared. Furthermore, it is possible to run experiments that consider various (weighted) combinations of look-ahead and perceptual strategies. Combined strategies are created by allocating a percentage of the particles to each of the two strategies during the inference (e.g., 50% of the particles use the priors of the “look-ahead” strategy, and the remaining 50% use the priors of the “perceptual” strategy) while also preventing any resampling during the inference.</p>
<p>
<xref ref-type="fig" rid="pcbi.1004864.g004">Fig 4C</xref> illustrates the simulation results for various strategies, which range from a “pure” perceptual strategy (left), where 100% of the particles use the priors of the “perceptual” strategy, to a “pure” look-ahead strategy (right), where 100% of the particles use the priors of the “perceptual” strategy, and all the intermediate cases (e.g., 50% of the particles use the priors of the “perceptual” strategy, and 50% of the particles use the priors of the “look-ahead” strategy). Parameters are reported in <xref ref-type="table" rid="pcbi.1004864.t001">Table 1</xref>. Our simulations show that the percent of particles able to find the shortest plan from state <italic>S</italic>27 to state <italic>S</italic>20 (i.e., a plan that only includes 7 moves) varies as a function of how many particles of the particle filtering algorithm use the “look-ahead” or “perceptual” strategies. A pure “look-ahead” strategy is the most successful while the performance degrades quickly when increasingly more particles are allocated to the “perceptual” strategy. These results thus speak to an advantage of the “look-ahead” over the “perceptual” strategy, where their differences here are explained in terms of different prior distributions, not of different inferential mechanisms.</p>
<p>The dynamics of the subgoal probability distributions <italic>p</italic>(<italic>SG</italic>) of the “look-ahead” strategy are shown in <xref ref-type="fig" rid="pcbi.1004864.g005">Fig 5</xref>. The first panel shows the prior <italic>SG</italic> distribution once the start and goal states are set. The successive panels show how this distribution is updated during the inference, reflecting the fact that the particles are approaching the goal location. Effectively, already from the second panel all the high-probability subgoals lie in the best path from the start to the goal. Furthermore, it is evident that during the inference, the “target” candidate subgoals are increasingly closer to the goal location—and the goal location is the highest probability location (only) in the last panel. In other words, this algorithm implicitly creates a “moving target” or “gradient” of intermediate subgoals that permit splitting the problem into more manageable subproblems, carving the huge search space (∼ 10<sup>12</sup> possible policies).</p>
<fig id="pcbi.1004864.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004864.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Behavior of a representative simulation using the “look-ahead” strategy.</title>
<p>Panels (a-h) show how the <italic>SG</italic> probability distribution varies at each time step (respectively 1–8), during the most frequent solution of a ToH problem starting from state <italic>S</italic>27 and reaching the goal state <italic>S</italic>20, using the “look-ahead” strategy. Note that the solution requires 7 inferential steps, and all the states having high probability lie along the best path from <italic>S</italic>27 to <italic>S</italic>20.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004864.g005" xlink:type="simple"/>
</fig>
<p>This situation can be contrasted with the dynamics of the subgoal probability distributions <italic>p</italic>(<italic>SG</italic>) of the “perceptual” strategy, shown in <xref ref-type="fig" rid="pcbi.1004864.g006">Fig 6</xref>, which lacks an equivalent gradient. Different from the “look-ahead” strategy, the “perceptual strategy” appears to be impaired by strong priors close to the final goal. It is this bias that produces a myopic strategy and prevents subjects from performing counterintuitive moves that would apparently move farther from the goal state.</p>
<fig id="pcbi.1004864.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004864.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Behavior of a representative simulation using the “perceptual” strategy.</title>
<p>Panels (a-j) show how the <italic>SG</italic> probability distribution varies at each time step (respectively 1–10) during the most frequent solution of a ToH problem starting from state <italic>S</italic>27 and reaching the goal state <italic>S</italic>20, using the “perceptual” strategy. Note that, at difference with <xref ref-type="fig" rid="pcbi.1004864.g005">Fig 5</xref>, here the solution requires 9 inferential steps. Furthermore, several of the high probability states (e.g., <italic>S</italic>13, whose activation remains quite high up to the 6th step) lie far away from the optimal path from <italic>S</italic>27 to <italic>S</italic>20. The reason is that these states are perceptually similar to the goal state.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004864.g006" xlink:type="simple"/>
</fig>
<p>These differences between the two strategies have significant effects on their relative performance. The most frequent solution found by the particles using the look-ahead strategy requires 7 inferential steps while the most frequent solution of the perceptual strategy requires 9 inferential steps (to understand how the most frequent or “most voted” solution is computed, see the <xref ref-type="sec" rid="sec002">Method</xref> section). The 7-steps solution found with higher probability by the look-ahead strategy is a unique, optimal plan passing through the states: <italic>S</italic>27, <italic>S</italic>26, <italic>S</italic>25, <italic>S</italic>24, <italic>S</italic>23, <italic>S</italic>22, <italic>S</italic>21, <italic>S</italic>20 (which, for illustrative purposes, we also show in the usual Tower of Hanoi format in <xref ref-type="fig" rid="pcbi.1004864.g007">Fig 7</xref>). Note that as shown in <xref ref-type="fig" rid="pcbi.1004864.g004">Fig 4D</xref> most of the particles that find the aforementioned 7-step optimal plan use 2 or 3 subgoals, which highlight an advantage of subgoal-based strategies over strategies that try to solve a problem from start to end without splitting the problem space.</p>
<fig id="pcbi.1004864.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004864.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Solution found with higher probability by the look-ahead strategy.</title>
<p>(a-h) The <italic>S</italic> states of the <italic>most voted solution</italic> at each time step for the Tower of Hanoi problem starting from state <italic>S</italic>27 and reaching the goal state <italic>S</italic>20. (i) How the winning solution shown in (a-h) is selected based on a competition between different subgoal sequences. At each step of resampling new particles are produced on the specific goal and by the voting mechanism the most successful subgoal-sequence strategy is selected. Notice that several different sequences get votes: in this plot, for the sake of clarity, we only show those sequences that surpass a threshold of 0.4.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004864.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec014">
<title>Empirical support for the analysis of counterintuitive movements</title>
<p>To validate our approach, we used our model to reproduce the results of an empirical study that investigated how adult patients with lesions of the prefrontal lobe and a control group solve Tower of Hanoi puzzles of increasing difficulty [<xref ref-type="bibr" rid="pcbi.1004864.ref077">77</xref>], see also [<xref ref-type="bibr" rid="pcbi.1004864.ref067">67</xref>]. The study revealed specific deficits in lesioned patients in resolving a goal-subgoal conflict, in particular in the case of counterintuitive movements requiring to move away (in a perceptual sense) from the goal state.</p>
<p>Here we simulated three ToH problems analogous to those reported in [<xref ref-type="bibr" rid="pcbi.1004864.ref077">77</xref>], which exemplify an easy, an intermediate, and a challenging situation. All the three problems (P1–P3) had the same goal state <italic>S</italic>20. In the easiest problem P1, the initial state was <italic>S</italic>13. This problem has a simple solution requiring only 3 moves. In the intermediate problem P2, the starting state is <italic>S</italic>27. The shortest solution of this problem requires 7 moves (the maximum number in our Hanoi Tower) and crosses a bottleneck between two community structures. In the hardest problem P3, the starting state is <italic>S</italic>9. Like the intermediate problem, the shortest solution to this problem requires 7 moves and crosses one bottleneck (<italic>S</italic>6 − <italic>S</italic>10). However, this path is harder to find for the presence of more counterintuitive moves, which hinder particularly the perceptual strategy. For example, an agent following the perceptual strategy will tend to do a transition from <italic>S</italic>9 to <italic>S</italic>11, not <italic>S</italic>8, because <italic>S</italic>11 is perceptually closer to the goal state <italic>S</italic>20. This tendency can prevent the agent from finding the optimal path, which passes through <italic>S</italic>8.</p>
<p>In keeping with our previous arguments, we associated the behavior of lesioned patients vs. control group to a different choice of strategies, the former more “perceptual” and the latter more “look-ahead”. Importantly, we do not consider these two strategies to be computationally different (as commonly assumed in the ToH literature); rather, we model both using our inferential method, but using two different prior distributions for subgoals (perceptual priors vs. algorithmic priors).</p>
<p>Accordingly, we associate the behavior of lesioned patients vs. control group to two models. In the former model, corresponding to lesioned patients, 85% of the particles are initialized according to the perceptual prior and 15% are initialized according to the algorithmic prior. in the latter model, corresponding to the control group, 85% of the particles are initialized according to the algorithmic prior and 15% are initialized according to the perceptual prior.</p>
<p>
<xref ref-type="fig" rid="pcbi.1004864.g008">Fig 8A</xref> shows the results of the experiment (25 executions of each model). As in the human experiment, we measure success rate as the percentage of participants (or executions of the model) that found the shortest path solution to the ToH problem. (Note that in the human experiments, participants solve the experiment only once.)</p>
<fig id="pcbi.1004864.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004864.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Comparison of real and simulated data on the ToH.</title>
<p>(a) Success rate mean and variance, “lesioned patients” and “control subjects” (as reported in [<xref ref-type="bibr" rid="pcbi.1004864.ref067">67</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref077">77</xref>]) and their simulated equivalents. Results are for 25 simulations. (b-c) Matrices of solutions of 25 simulations of lesioned patients (particle percent: <italic>perceptual</italic> = 85 and <italic>look-ahead</italic> = 15) and control group (particle percent: <italic>perceptual</italic> = 15 and <italic>look-ahead</italic> = 85), respectively. The greyscale indicates the number of votes received by the solutions, i.e., the sum of <italic>θ</italic> values of <xref ref-type="disp-formula" rid="pcbi.1004864.e016">Eq 13</xref>; the lighter the grey, the higher the number of votes, the better the result. The <italic>x</italic>-axis shows that the number of solutions found to the problem P3 by the control group (c) is greater than the number of solutions found by the lesioned patients (b). The possibility to find more solutions suggests a greater flexibility of the look-ahead strategy, which in turn might explain its better performance. Furthermore, it is possible to appreciate that the most voted solutions of the control group receive more votes than the most voted solutions of the lesioned patients (compare their greyscale), indicating a faster decision making process.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004864.g008" xlink:type="simple"/>
</fig>
<p>In P1, the success rate is high for both groups, but the variability of the solutions is higher for lesioned patients. In P2 and P3, the success rate of both groups decreases, but—crucially—it does so more steeply for the simulated lesioned patients, reflecting their difficulties in facing challenging problems that include counterintuitive moves.</p>
<p>Our simulations replicate the pattern of results reported in the empirical study [<xref ref-type="bibr" rid="pcbi.1004864.ref077">77</xref>], and in particular the steeper decrease in the performance of lesioned patients when the problems require executing counterintuitive movements. This pattern of results cannot be explained by an algorithm that simply introduces noise in the best strategy, but results from different qualitative strategies, with the perceptual strategy that performs quite well in simple cases but not in the more complex ones that include counterintuitive movements. The slightly lower (overall) performance of real participants compared to our simulations might result from minor differences in the set up. Indeed, the three problems P1–P3 reported here correspond to the three problems P5, P1 and P8 in [<xref ref-type="bibr" rid="pcbi.1004864.ref067">67</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref077">77</xref>], after a mapping between the ToH problem space used in our simulations (with three disks and three pegs) and the slightly more challenging one used in the empirical report (with five disks and three pegs). It is important to note that despite the minor differences in the set up, the structure of the problem is the same (e.g. the number of bottlenecks and counterintuitive moves) and the overall pattern of results of the simulations coherent with the real data.</p>
<p>Besides replicating the pattern of results in [<xref ref-type="bibr" rid="pcbi.1004864.ref077">77</xref>], our simulations can provide a more fine-grained analysis of the behavior of the two groups. The two matrices of <xref ref-type="fig" rid="pcbi.1004864.g008">Fig 8B and 8C</xref> show the number of solutions to problem P3 (<italic>x</italic>-axis) and relative number of “votes” (grey scale) found by the simulated lesioned patients and control group, respectively. It is possible to appreciate that the simulated control group is able to find many more solutions than the simulated lesioned patients. This result confirms that the look-ahead strategy is more flexible and permits agents to find a broad spectrum of solutions, rather than narrowing the problem space. This increased flexibility is especially advantageous in challenging problems like P3 and might explain the large gap in the performance between the two models, see <xref ref-type="fig" rid="pcbi.1004864.g008">Fig 8A</xref>. Furthermore, it is worth noting that the most voted solutions of the control group receive more votes than the most voted solutions of the lesioned patients (compare the grayscale of <xref ref-type="fig" rid="pcbi.1004864.g008">Fig 8B and 8C</xref>), which in turn implies a faster convergence of the algorithm in the former case.</p>
</sec>
</sec>
<sec id="sec015" sec-type="conclusions">
<title>Discussion</title>
<p>We have presented a formal approach to human-level problem solving, here exemplified in the Tower of Hanoi (ToH) task. We use probabilistic inference methods that are increasingly adopted to study multiple cognitive domains, such as perception, action and learning [<xref ref-type="bibr" rid="pcbi.1004864.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref018">18</xref>], supporting the idea that the computations underlying problem solving might share common principles with them. Specifically, we leverage on the <italic>planning-as-inference</italic> framework (PAI) and extend it to address problem solving by introducing a crucial additional mechanism: subgoaling. Our emphasis on subgoaling is in keeping with their recognized importance of subgoaling in human problem solving and cognitive architectures [<xref ref-type="bibr" rid="pcbi.1004864.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref057">57</xref>] and with a vast computational literature showing that subgoals can carve the problem space and reduce the computational complexity of problems [<xref ref-type="bibr" rid="pcbi.1004864.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref066">66</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref078">78</xref>].</p>
<p>Our results illustrate that a subgoaling-based probabilistic inference approach can explain key aspects of human problem solving. Our first two studies focused on what structure or <italic>problem space</italic> humans use. Convergent findings indicate that the time to execute a ToH puzzle is proportional to the complexity of the problem, not to the number of steps in a graph. The complexity of the problem can be characterized as a distance in <italic>problem space</italic> between the start and goal configurations, which does not only consider the number of (physical) steps required to solve a problem, but also computational requirements (e.g., the complexity of solutions and associated computational costs), which in turn are influenced by “community structure” of the problem [<xref ref-type="bibr" rid="pcbi.1004864.ref074">74</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref075">75</xref>]. In the proposed computational approach, an important constituent of the problem space is prior subgoal distribution <italic>p</italic>(<italic>SG</italic>)—or an a-priori probabilistic estimate of the likelihood of traversing a given set of states. The first two studies thus show that the prior subgoal distribution measure can explain two typical (but otherwise puzzling) idiosyncrasies of human problem solving strategies, and their sensitivity to the (community) structure of the problem at hand.</p>
<p>Our third and fourth studies show that a specific and well-documented deficit in human problem solving—the failure to execute counterintuitive movements—can be explained in terms of a mis-identification and mis-use of (good) subgoals within our probabilistic inference scheme. One interesting aspect of our proposal is that it permits to describe two competing strategies for solving the ToH, look-ahead vs. perceptual [<xref ref-type="bibr" rid="pcbi.1004864.ref057">57</xref>], within a homogeneous probabilistic inference method, without appealing to two segregated mechanisms. In this perspective, when the perceptual strategy is used, the subgoal distribution quickly collapses into a narrowly-focused problem representation, in which the final goal dominates the inference, preventing subjects to carve the problem in useful ways. In this perspective, the strategy a person uses during problem solving (and her errors) might be predicted by looking at her subgoal distribution prior and during the inference. This is a novel empirical prediction that can be potentially tested in the ToH or related puzzles.</p>
<p>It is worth noting that the disadvantages of the perceptual strategy might be partially compensated by the fact that calculating subgoal distributions using a simple “perceptual distance” between states could be less cognitively demanding than updating them according to the look-ahead strategy. In this perspective, the choice of a more accurate but also more cognitive demanding vs. a simpler but inflexible strategy might obey to computational trade-offs [<xref ref-type="bibr" rid="pcbi.1004864.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref079">79</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref081">81</xref>]. If this hypothesis is correct, introducing a cognitive load would shift the balance towards the latter (perceptual) strategy [<xref ref-type="bibr" rid="pcbi.1004864.ref082">82</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref083">83</xref>]. This prediction remains to be tested in future research.</p>
<p>To summarize, we have shown that problem solving requires the ability to carve the problem space in useful ways, which do not only (or not necessarily) reflect a simple physical distance, but a distance in a subtler “problem space”. In this perspective, we have shown the advantage of representing possible subgoals in terms of algorithmic priors rather than in terms of a mere perceptual distance from the goal state.</p>
<p>The way we calculate algorithmic priors <italic>P</italic>(<italic>SG</italic>) shares some similarities, but also differences, with alternative ways that have been proposed in the literature that are based on graph theory [<xref ref-type="bibr" rid="pcbi.1004864.ref074">74</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref075">75</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref084">84</xref>] and information theory [<xref ref-type="bibr" rid="pcbi.1004864.ref043">43</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref045">45</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref085">85</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref086">86</xref>]. In our approach, the algorithmic prior of a state considers, first, the number of policies that generate programs terminating in the state (the more the policies, the higher the probability) and second, the length of these programs (the shortest the programs, the higher the probability)—thus reflecting a prior preference for traversing every state by using the best (shorter) program. In the ToH maze, this second aspect of the algorithm tends to assign higher probability to states that are close to (but are not) vertexes, because the programs that start from vertexes are shorter in these states compared to all the other states, including bottlenecks (mazes with different topologies will have different <italic>p</italic>(<italic>SG</italic>) distributions, of course). This implies that bottlenecks do not have the highest prior probability. This might seem in contrast with a graph-theoretic perspective, where bottlenecks are usually identified as salient structural aspects of the problem [<xref ref-type="bibr" rid="pcbi.1004864.ref074">74</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref075">75</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref084">84</xref>]. However, two points are in order. First, graph-theoretic algorithms do not assign a probability distribution over all states, but only identify bottlenecks, thus it is hard to directly compare the two methods. Second, in our approach <italic>p</italic>(<italic>SG</italic>) reflects algorithmic probability measures and the prior propensity to visit or traverse a state rather than its perceptual salience or connectedness; and we have shown that this choice of priors permits to model accurately human behavior, especially the preference for paths that include lesser (or lower-rank) bottlenecks. It is possible that graph-theoretic measures and our approach based on algorithmic probability reflect distinct (not necessarily divergent) structural aspects of the problem, the former more revelatory of topological aspects of the maze and oriented towards (optimal) task decomposition [<xref ref-type="bibr" rid="pcbi.1004864.ref074">74</xref>], and the latter more related to informational constraints of the problem to be solved—to which humans seem to be particularly sensitive. Supporting this idea is the fact that our approach is largely convergent with other methods that identify subgoals using info-theoretic measures such as the <italic>information bottleneck method</italic> [<xref ref-type="bibr" rid="pcbi.1004864.ref085">85</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref086">86</xref>] and <italic>relevant goal information (RGI)</italic> [<xref ref-type="bibr" rid="pcbi.1004864.ref043">43</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref045">45</xref>]. The RGI method uses the mutual information between goal and action to assign states an information value; like our approach, this method identifies transition points, and assigns bottlenecks low (not high) information value, and high information value to bottleneck neighbors. While using different information measures, the RGI method is largely convergent with our approach as it reflects informational constraints of the problem (e.g., the amount of information an agent needs to maintain about its goal and the points where she needs to change subgoals) that—we argue—are important determinants of human problem solving in challenging tasks such as the ToH.</p>
<p>The methods we use are also related to Hierarchical Reinforcement Learning (HRL) [<xref ref-type="bibr" rid="pcbi.1004864.ref048">48</xref>]. In particular, the transition <italic>p</italic>(<italic>π</italic>|<italic>s</italic>, <italic>sg</italic>) is related to the concept of an “Option” in HRL [<xref ref-type="bibr" rid="pcbi.1004864.ref048">48</xref>] but it is expressed probabilistically. In HRL, learned Options influence policy selection and guide the agent transitions for an extended period of time, usually up to a predefined subgoal (e.g., an Option might correspond to “move until the next door”). Rather, here there are no predefined or “cached” subgoal-and-policy pairs. Policies are sampled at each step of the inference, while subgoals are sampled whenever the previously selected subgoal has been reached. Thus, in a sense, this system forms an Option-like structure on-the-fly that guides the agent’s transitions up to the next predefined subgoal. In principle, the (best) Option-like structures (e.g., <italic>p</italic>(<italic>π</italic>|<italic>s</italic>, <italic>sg</italic>)) formed during the inference might be “cached” to facilitate future inferences; this is something we plan to explore in future studies.</p>
</sec>
<sec id="sec016" sec-type="conclusions">
<title>Conclusions</title>
<p>We presented a novel computational theory of human problem solving that is based on probabilistic inference augmented with a subgoaling mechanism. Probabilistic inference methods are increasingly used to explain a variety of cognitive, perceptual and motor tasks, including goal-directed decisions and planning [<xref ref-type="bibr" rid="pcbi.1004864.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref038">38</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref087">87</xref>]. Here we show that probabilistic inference, when enhanced with a subgoaling mechanism, can explain various aspects of human problem solving, too, including its idiosyncrasies and deficits, such as the human sensitivity to the structure of the problem space, and patient deficits in handling counterintuitive moves and goal-subgoal conflicts. We focused on the well-studied Tower of Hanoi (ToH) task, which has been modeled using several computational frameworks such as the cognitive architecture ACT-R [<xref ref-type="bibr" rid="pcbi.1004864.ref088">88</xref>] and various symbolic [<xref ref-type="bibr" rid="pcbi.1004864.ref081">81</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref089">89</xref>] and subsymbolic systems [<xref ref-type="bibr" rid="pcbi.1004864.ref090">90</xref>], none of which however use the principles of probabilistic inference proposed here.</p>
<p>This computational analysis suggests that human problem solving does not necessarily need to be considered a special(ized) domain or module of cognition, but could use the same probabilistic computations that are widely studied in other fields of cognitive science. Along similar lines, it is not necessary to assume that suboptimal strategies such as the perceptual strategy are mechanistically different from the optimal solution or heuristics. Our study shows that they can be explained within the probabilistic framework introduced here under the assumption of a different problem (prior) representation.</p>
<p>This computational analysis underlies the importance of subgoaling in problem solving, too, showing that subgoals—as expressed for example in the prior subgoal distribution <italic>p</italic>(<italic>SG</italic>)—permit to carve the problem space in useful ways. Importantly, subgoals define a metric for the problem that is sensitive to the probability of transitions between states rather than to the mere count of the number of states from start to goal. Humans are sensitive to key aspects of this metric, such as its community structure [<xref ref-type="bibr" rid="pcbi.1004864.ref074">74</xref>]. Furthermore, subgoals can be used as “waypoints” that permit finding parsimonious solutions: the algorithm splits the problem into smaller subproblems, each requiring less information to be encoded compared to a solution from start to end (this adds on to the fact that the inferential method tends to select programs having higher algorithmic probability and thus having a shorter code-length [<xref ref-type="bibr" rid="pcbi.1004864.ref065">65</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref066">66</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref068">68</xref>, <xref ref-type="bibr" rid="pcbi.1004864.ref069">69</xref>]). From a cognitive perspective, the overall <italic>divide et impera</italic> strategy can be less taxing for an agent, because she only needs to “remember” a part of the solution (e.g., the path to the next subgoal) at every moment in time. Reaching a subgoal (as signaled by the node <italic>F</italic> in our model) marks a transition to a next subgoal, and implies that the agent can “forget” past information [<xref ref-type="bibr" rid="pcbi.1004864.ref043">43</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref045">45</xref>]. Furthermore, finding waypoints permits to learn and store subroutines (e.g. Options in HRL) that—in principle—can be reused in future planning problems, thus saving resources [<xref ref-type="bibr" rid="pcbi.1004864.ref091">91</xref>–<xref ref-type="bibr" rid="pcbi.1004864.ref093">93</xref>]. Finally, the failure to use subgoal information in appropriate ways can explain specific problem solving deficits such as the inability to execute <italic>counterintuitive movements</italic> of prefrontal patients [<xref ref-type="bibr" rid="pcbi.1004864.ref057">57</xref>], without appealing to separate cognitive mechanisms for look-ahead vs. perceptual strategies.</p>
</sec>
</body>
<back>
<ack>
<p>The GEFORCE Titan used for this research was donated by the NVIDIA Corporation.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004864.ref001">
<label>1</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Newell</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Simon</surname> <given-names>HA</given-names></name>. <source>Human problem solving</source>. <publisher-loc>Englewood Cliffs, NJ</publisher-loc>: <publisher-name>Prentice-Hall</publisher-name>; <year>1972</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref002">
<label>2</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Kohler</surname> <given-names>W</given-names></name>. <source>The mentality of apes</source>. <publisher-name>Harcourt</publisher-name>, <publisher-loc>Brace</publisher-loc>; <year>1925</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Weir</surname> <given-names>AAS</given-names></name>, <name name-style="western"><surname>Chappell</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kacelnik</surname> <given-names>A</given-names></name>. <article-title>Shaping of Hooks in New Caledonian Crows</article-title>. <source>Science</source>. <year>2002</year>;<volume>297</volume>:<fpage>981</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1073433" xlink:type="simple">10.1126/science.1073433</ext-link></comment> <object-id pub-id-type="pmid">12169726</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buzsáki</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>. <article-title>Memory, navigation and theta rhythm in the hippocampal-entorhinal system</article-title>. <source>Nature Neuroscience</source>. <year>2013</year>;<volume>16</volume>:<fpage>130</fpage>–<lpage>138</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3304" xlink:type="simple">10.1038/nn.3304</ext-link></comment> <object-id pub-id-type="pmid">23354386</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pezzulo</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>van der Meer</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Lansink</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Pennartz</surname> <given-names>CMA</given-names></name>. <article-title>Internally generated sequences in learning and executing goal-directed behavior</article-title>. <source>Trends in Cognitive Sciences</source>. <year>2014</year>;<volume>18</volume>(<issue>12</issue>):<fpage>647</fpage>–<lpage>657</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tics.2014.06.011" xlink:type="simple">10.1016/j.tics.2014.06.011</ext-link></comment> <object-id pub-id-type="pmid">25156191</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Spiers</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Maguire</surname> <given-names>EA</given-names></name>. <article-title>Thoughts, behaviour, and brain dynamics during navigation in the real world</article-title>. <source>Neuroimage</source>. <year>2006</year>;<volume>31</volume>(<issue>4</issue>):<fpage>1826</fpage>–<lpage>1840</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2006.01.037" xlink:type="simple">10.1016/j.neuroimage.2006.01.037</ext-link></comment> <object-id pub-id-type="pmid">16584892</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dehaene</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Molko</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>AJ</given-names></name>. <article-title>Arithmetic and the brain</article-title>. <source>Curr Opin Neurobiol</source>. <year>2004</year>;<volume>14</volume>(<issue>2</issue>):<fpage>218</fpage>–<lpage>224</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.conb.2004.03.008" xlink:type="simple">10.1016/j.conb.2004.03.008</ext-link></comment> <object-id pub-id-type="pmid">15082328</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref008">
<label>8</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Anderson</surname> <given-names>JR</given-names></name>. <source>The Architecture of Cognition</source>. <publisher-loc>Cambridge, MA</publisher-loc>: <publisher-name>Harvard University Press</publisher-name>; <year>1983</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Anderson</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Fincham</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Qin</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Stocco</surname> <given-names>A</given-names></name>. <article-title>A central circuit of the mind</article-title>. <source>Trends Cogn Sci</source>. <year>2008</year>;<volume>12</volume>(<issue>4</issue>):<fpage>136</fpage>–<lpage>143</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tics.2008.01.006" xlink:type="simple">10.1016/j.tics.2008.01.006</ext-link></comment> <object-id pub-id-type="pmid">18329948</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cooper</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Shallice</surname> <given-names>T</given-names></name>. <article-title>Hierarchical schemas and goals in the control of sequential behaviour</article-title>. <source>Psychological Review</source>. <year>2006</year>;<volume>113</volume>:<fpage>887</fpage>–<lpage>916</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1037/0033-295X.113.4.887" xlink:type="simple">10.1037/0033-295X.113.4.887</ext-link></comment> <object-id pub-id-type="pmid">17014307</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Eliasmith</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Stewart</surname> <given-names>TC</given-names></name>, <name name-style="western"><surname>Choo</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Bekolay</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>DeWolf</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>A large-scale model of the functioning brain</article-title>. <source>Science</source>. <year>2012</year>;<volume>338</volume>(<issue>6111</issue>):<fpage>1202</fpage>–<lpage>1205</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1225266" xlink:type="simple">10.1126/science.1225266</ext-link></comment> <object-id pub-id-type="pmid">23197532</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref012">
<label>12</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Minsky</surname> <given-names>M</given-names></name>. <source>The Society of Mind</source>. <publisher-name>Simon &amp; Schuster</publisher-name>; <year>1988</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref013">
<label>13</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Rosenbloom</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Laird</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Newell</surname> <given-names>A</given-names></name>. <source>The Soar Papers: Research on Integrated Intelligence</source>. <volume>vol. 1 and 2</volume>. <publisher-loc>Cambridge, MA</publisher-loc>: <publisher-name>MIT Press</publisher-name>; <year>1992</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref014">
<label>14</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hauskrecht</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Meuleau</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Kaelbling</surname> <given-names>LP</given-names></name>, <name name-style="western"><surname>Dean</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Boutilier</surname> <given-names>C</given-names></name>. <chapter-title>Hierarchical solution of Markov decision processes using macro-actions</chapter-title>. In: <source>Proceedings of the Fourteenth conference on Uncertainty in artificial intelligence</source>. <publisher-name>Morgan Kaufmann Publishers Inc.</publisher-name>; <year>1998</year>. p. <fpage>220</fpage>–<lpage>229</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref015">
<label>15</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Lipovetzky</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Geffner</surname> <given-names>H</given-names></name>. <source>Width and Serialization of Classical Planning Problems</source>. In: <publisher-name>ECAI</publisher-name>; <year>2012</year>. p. <fpage>540</fpage>–<lpage>545</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref016">
<label>16</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Parr</surname> <given-names>RE</given-names></name>. <source>Hierarchical Control and Learning for Markov Decision Processes</source>. <publisher-name>University of California</publisher-name> at <publisher-loc>Berkeley</publisher-loc>; <year>1998</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref017">
<label>17</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Doya</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ishii</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Pouget</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rao</surname> <given-names>RPN</given-names></name>, editors. <source>Bayesian Brain: Probabilistic Approaches to Neural Coding</source>. <edition>1st ed</edition>. <publisher-name>The MIT Press</publisher-name>; <year>2007</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>. <article-title>The free-energy principle: a unified brain theory?</article-title> <source>Nat Rev Neurosci</source>. <year>2010</year>;<volume>11</volume>(<issue>2</issue>):<fpage>127</fpage>–<lpage>138</lpage>. <object-id pub-id-type="pmid">20068583</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Horvitz</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>Tenenbaum</surname> <given-names>JB</given-names></name>. <article-title>Computational rationality: A converging paradigm for intelligence in brains, minds, and machines</article-title>. <source>Science</source>. <year>2015</year>;<volume>349</volume>(<issue>6245</issue>):<fpage>273</fpage>–<lpage>278</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.aac6076" xlink:type="simple">10.1126/science.aac6076</ext-link></comment> <object-id pub-id-type="pmid">26185246</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Verschure</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Pennartz</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pezzulo</surname> <given-names>G</given-names></name>. <article-title>The Why, What, Where, When and How of Goal Directed Choice: neuronal and computational principles</article-title>. <source>Philosophical Transaction of the Royal Society of London: Series B, Biological Sciences</source>. <year>2014</year>;<volume>369</volume>:<fpage>20130483</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.2013.0483" xlink:type="simple">10.1098/rstb.2013.0483</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kording</surname> <given-names>KP</given-names></name>, <name name-style="western"><surname>Wolpert</surname> <given-names>DM</given-names></name>. <article-title>Bayesian decision theory in sensorimotor control</article-title>. <source>Trends Cogn Sci</source>. <year>2006</year>;<volume>10</volume>:<fpage>319</fpage>–<lpage>326</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tics.2006.05.003" xlink:type="simple">10.1016/j.tics.2006.05.003</ext-link></comment> <object-id pub-id-type="pmid">16807063</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yuille</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kersten</surname> <given-names>D</given-names></name>. <article-title>Vision as Bayesian inference: analysis by synthesis?</article-title> <source>Trends in Cognitive Sciences</source>. <year>2006</year>;<volume>10</volume>(<issue>7</issue>):<fpage>301</fpage>–<lpage>308</lpage>. <object-id pub-id-type="pmid">16784882</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Botvinick</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Toussaint</surname> <given-names>M</given-names></name>. <article-title>Planning as inference</article-title>. <source>Trends Cogn Sci</source>. <year>2012</year>;<volume>16</volume>(<issue>10</issue>):<fpage>485</fpage>–<lpage>488</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tics.2012.08.006" xlink:type="simple">10.1016/j.tics.2012.08.006</ext-link></comment> <object-id pub-id-type="pmid">22940577</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huys</surname> <given-names>QJ</given-names></name>, <name name-style="western"><surname>Lally</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Faulkner</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Eshel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Seifritz</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <etal>et al</etal>. <article-title>Interplay of approximate planning strategies</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2015</year>;<volume>112</volume>(<issue>10</issue>):<fpage>3098</fpage>–<lpage>3103</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1414219112" xlink:type="simple">10.1073/pnas.1414219112</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Solway</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Botvinick</surname> <given-names>MM</given-names></name>. <article-title>Goal-directed decision making as probabilistic inference: A computational framework and potential neural correlates</article-title>. <source>Psychol Rev</source>. <year>2012</year>;<volume>119</volume>(<issue>1</issue>):<fpage>120</fpage>–<lpage>154</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1037/a0026435" xlink:type="simple">10.1037/a0026435</ext-link></comment> <object-id pub-id-type="pmid">22229491</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Battaglia</surname> <given-names>PW</given-names></name>, <name name-style="western"><surname>Hamrick</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Tenenbaum</surname> <given-names>JB</given-names></name>. <article-title>Simulation as an engine of physical scene understanding</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2013</year>;<volume>110</volume>(<issue>45</issue>):<fpage>18327</fpage>–<lpage>18332</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1306572110" xlink:type="simple">10.1073/pnas.1306572110</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chater</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Tenenbaum</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Yuille</surname> <given-names>A</given-names></name>. <article-title>Probabilistic models of cognition: conceptual foundations</article-title>. <source>Trends Cogn Sci</source>. <year>2006</year>;<volume>10</volume>(<issue>7</issue>):<fpage>287</fpage>–<lpage>291</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tics.2006.05.007" xlink:type="simple">10.1016/j.tics.2006.05.007</ext-link></comment> <object-id pub-id-type="pmid">16807064</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tenenbaum</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Kemp</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Griffiths</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Goodman</surname> <given-names>ND</given-names></name>. <article-title>How to grow a mind: statistics, structure, and abstraction</article-title>. <source>Science</source>. <year>2011</year>;<volume>331</volume>(<issue>6022</issue>):<fpage>1279</fpage>–<lpage>1285</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1192788" xlink:type="simple">10.1126/science.1192788</ext-link></comment> <object-id pub-id-type="pmid">21393536</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tenenbaum</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Griffiths</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Kemp</surname> <given-names>C</given-names></name>. <article-title>Theory-based Bayesian models of inductive learning and reasoning</article-title>. <source>Trends in Cognitive Sciences</source>. <year>2006</year>;<volume>10</volume>:<fpage>309</fpage>–<lpage>318</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tics.2006.05.009" xlink:type="simple">10.1016/j.tics.2006.05.009</ext-link></comment> <object-id pub-id-type="pmid">16797219</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kiebel</surname> <given-names>SJ</given-names></name>. <article-title>Reinforcement learning or active inference?</article-title> <source>PLoS One</source>. <year>2009</year>;<volume>4</volume>(<issue>7</issue>):<fpage>e6421</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0006421" xlink:type="simple">10.1371/journal.pone.0006421</ext-link></comment> <object-id pub-id-type="pmid">19641614</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ma</surname> <given-names>WJ</given-names></name>, <name name-style="western"><surname>Beck</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Latham</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Pouget</surname> <given-names>A</given-names></name>. <article-title>Bayesian inference with probabilistic population codes</article-title>. <source>Nat Neurosci</source>. <year>2006</year>;<volume>9</volume>(<issue>11</issue>):<fpage>1432</fpage>–<lpage>1438</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1790" xlink:type="simple">10.1038/nn1790</ext-link></comment> <object-id pub-id-type="pmid">17057707</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Donnarumma</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Prevete</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>de Giorgio</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Montone</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Pezzulo</surname> <given-names>G</given-names></name>. <article-title>Learning programs is better than learning dynamics: A programmable neural network hierarchical architecture in a multi-task scenario</article-title>. <source>Adaptive Behavior</source>. <year>2016</year>;<volume>24</volume>(<issue>1</issue>):<fpage>27</fpage>–<lpage>51</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1177/1059712315609412" xlink:type="simple">10.1177/1059712315609412</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Maisto</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Donnarumma</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Pezzulo</surname> <given-names>G</given-names></name>. <article-title>Nonparametric Problem-Space Clustering: Learning Efficient Codes for Cognitive Control Tasks</article-title>. <source>Entropy</source>. <year>2016</year>;<volume>18</volume>(<issue>2</issue>):<fpage>61</fpage>:<fpage>1</fpage>–<lpage>25</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3390/e18020061" xlink:type="simple">10.3390/e18020061</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref034">
<label>34</label>
<mixed-citation publication-type="other" xlink:type="simple">Attias H. Planning by Probabilistic Inference. In: Proceedings of the Ninth International Workshop on Artificial Intelligence and Statistics; 2003. p. –.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Maisto</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Donnarumma</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Pezzulo</surname> <given-names>G</given-names></name>. <article-title>Divide et impera: subgoaling reduces the complexity of probabilistic inference and problem solving</article-title>. <source>J R Soc Interface</source>. <year>2015</year>;<volume>12</volume>(<issue>104</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2014.1335" xlink:type="simple">10.1098/rsif.2014.1335</ext-link></comment> <object-id pub-id-type="pmid">25652466</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref036">
<label>36</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Penny</surname> <given-names>W</given-names></name>. <chapter-title>Simultaneous Localisation and Planning</chapter-title>. In: <source>Cognitive Information Processing (CIP), 2014 4th International Workshop on</source>. <publisher-name>IEEE</publisher-name>; <year>2014</year>. p. <fpage>1</fpage>–<lpage>6</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref037">
<label>37</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Toussaint</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Storkey</surname> <given-names>A</given-names></name>. <chapter-title>Probabilistic inference for solving discrete and continuous state Markov Decision Processes</chapter-title>. In: <source>Proceedings of the 23rd international conference on Machine learning</source>. <publisher-name>ACM</publisher-name>; <year>2006</year>. p. <fpage>945</fpage>–<lpage>952</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref038">
<label>38</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Verma</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Rao</surname> <given-names>RPN</given-names></name>. <chapter-title>Planning and Acting in Uncertain Environments using Probabilistic Inference</chapter-title>. In: <source>IROS</source>. <publisher-name>IEEE</publisher-name>; <year>2006</year>. p. <fpage>2382</fpage>–<lpage>2387</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Penny</surname> <given-names>WD</given-names></name>, <name name-style="western"><surname>Zeidman</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Burgess</surname> <given-names>NF</given-names></name>. <article-title>Forward and Backward Inference in Spatial Cognition</article-title>. <source>PLoS Computational Biology</source>. <year>2013</year>;<volume>9</volume>:<fpage>e1003383</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003383" xlink:type="simple">10.1371/journal.pcbi.1003383</ext-link></comment> <object-id pub-id-type="pmid">24348230</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pezzulo</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Rigoli</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Chersi</surname> <given-names>F</given-names></name>. <article-title>The mixed instrumental controller: using value of information to combine habitual choice and mental simulation</article-title>. <source>Front Psychol</source>. <year>2013</year>;<volume>4</volume>:<fpage>92</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fpsyg.2013.00092" xlink:type="simple">10.3389/fpsyg.2013.00092</ext-link></comment> <object-id pub-id-type="pmid">23459512</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Toussaint</surname> <given-names>M</given-names></name>. <article-title>Probabilistic inference as a model of planned behavior</article-title>. <source>Künstliche Intelligenz</source>. <year>2009</year>;<volume>3/09</volume>:<fpage>23</fpage>–<lpage>29</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref042">
<label>42</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Toussaint</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Plath</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Lang</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Jetchev</surname> <given-names>N</given-names></name>. <chapter-title>Integrated motor control, planning, grasping and high-level reasoning in a blocks world using probabilistic inference</chapter-title>. In: <source>Robotics and Automation (ICRA), 2010 IEEE International Conference on</source>. <publisher-name>IEEE</publisher-name>; <year>2010</year>. p. <fpage>385</fpage>–<lpage>391</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref043">
<label>43</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>van Dijk</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Polani</surname> <given-names>D</given-names></name>. <chapter-title>Grounding subgoals in information transitions</chapter-title>. In: <source>Adaptive Dynamic Programming And Reinforcement Learning (ADPRL), 2011 IEEE Symposium on</source>. <publisher-name>IEEE</publisher-name>; <year>2011</year>. p. <fpage>105</fpage>–<lpage>111</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref044">
<label>44</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>van Dijk</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Polani</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Nehaniv</surname> <given-names>CL</given-names></name>. <chapter-title>Hierarchical behaviours: getting the most bang for your bit</chapter-title>. In: <source>Advances in Artificial Life. Darwin Meets von Neumann</source>. <publisher-name>Springer</publisher-name>; <year>2011</year>. p. <fpage>342</fpage>–<lpage>349</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Van Dijk</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Polani</surname> <given-names>D</given-names></name>. <article-title>Informational constraints-driven organization in goal-directed behavior</article-title>. <source>Advances in Complex Systems</source>. <year>2013</year>;<volume>16</volume>(<issue>02n03</issue>):<fpage>1350016</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1142/S0219525913500161" xlink:type="simple">10.1142/S0219525913500161</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Krogh</surname> <given-names>BH</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>D</given-names></name>. <article-title>Dynamic generation of subgoals for autonomous mobile robots using local feedback information</article-title>. <source>Automatic Control, IEEE Transactions on</source>. <year>1989</year>;<volume>34</volume>(<issue>5</issue>):<fpage>483</fpage>–<lpage>493</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/9.24200" xlink:type="simple">10.1109/9.24200</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schmidhuber</surname> <given-names>J</given-names></name>. <article-title>Discovering Neural Nets With Low Kolmogorov Complexity And High Generalization Capability</article-title>. <source>Neural Networks</source>. <year>1997</year>;<volume>10</volume>:<fpage>10</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0893-6080(96)00127-X" xlink:type="simple">10.1016/S0893-6080(96)00127-X</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sutton</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Precup</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Singh</surname> <given-names>S</given-names></name>. <article-title>Between MDPs and semi-MDPs: A Framework for Temporal Abstraction in Reinforcement Learning</article-title>. <source>Artificial Intelligence</source>. <year>1999</year>;<volume>112</volume>:<fpage>181</fpage>–<lpage>211</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0004-3702(99)00052-1" xlink:type="simple">10.1016/S0004-3702(99)00052-1</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mumford</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Schultz</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Van Doorn</surname> <given-names>JR</given-names></name>. <article-title>Performance in planning: Processes, requirements, and errors</article-title>. <source>Review of General Psychology</source>. <year>2001</year>;<volume>5</volume>(<issue>3</issue>):<fpage>213</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1037/1089-2680.5.3.213" xlink:type="simple">10.1037/1089-2680.5.3.213</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Spitz</surname> <given-names>HH</given-names></name>, <name name-style="western"><surname>Minsky</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Bessellieu</surname> <given-names>CL</given-names></name>. <article-title>Subgoal length versus full solution length in predicting Tower of Hanoi problem-solving performance</article-title>. <source>Bulletin of the Psychonomic Society</source>. <year>1984</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3758/BF03333826" xlink:type="simple">10.3758/BF03333826</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Johnson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Redish</surname> <given-names>AD</given-names></name>. <article-title>Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point</article-title>. <source>J Neurosci</source>. <year>2007</year>;<volume>27</volume>(<issue>45</issue>):<fpage>12176</fpage>–<lpage>12189</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3761-07.2007" xlink:type="simple">10.1523/JNEUROSCI.3761-07.2007</ext-link></comment> <object-id pub-id-type="pmid">17989284</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van der Meer</surname> <given-names>MAA</given-names></name>, <name name-style="western"><surname>Redish</surname> <given-names>AD</given-names></name>. <article-title>Expectancies in decision making, reinforcement learning, and ventral striatum</article-title>. <source>Frontiers in Neuroscience</source>. <year>2010</year>;<volume>4</volume>:<fpage>6</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/neuro.01.006.2010" xlink:type="simple">10.3389/neuro.01.006.2010</ext-link></comment> <object-id pub-id-type="pmid">21221409</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pfeiffer</surname> <given-names>BE</given-names></name>, <name name-style="western"><surname>Foster</surname> <given-names>DJ</given-names></name>. <article-title>Hippocampal place-cell sequences depict future paths to remembered goals</article-title>. <source>Nature</source>. <year>2013</year>;<volume>497</volume>:<fpage>74</fpage>–<lpage>79</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12112" xlink:type="simple">10.1038/nature12112</ext-link></comment> <object-id pub-id-type="pmid">23594744</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mushiake</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Saito</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Sakamoto</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Itoyama</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Tanji</surname> <given-names>J</given-names></name>. <article-title>Activity in the lateral prefrontal cortex reflects multiple steps of future events in action plans</article-title>. <source>Neuron</source>. <year>2006</year>;<volume>50</volume>(<issue>4</issue>):<fpage>631</fpage>–<lpage>641</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2006.03.045" xlink:type="simple">10.1016/j.neuron.2006.03.045</ext-link></comment> <object-id pub-id-type="pmid">16701212</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Saito</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Mushiake</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Sakamoto</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Itoyama</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Tanji</surname> <given-names>J</given-names></name>. <article-title>Representation of immediate and final behavioral goals in the monkey prefrontal cortex during an instructed delay period</article-title>. <source>Cereb Cortex</source>. <year>2005</year>;<volume>15</volume>(<issue>10</issue>):<fpage>1535</fpage>–<lpage>1546</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/cercor/bhi032" xlink:type="simple">10.1093/cercor/bhi032</ext-link></comment> <object-id pub-id-type="pmid">15703260</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Simon</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>. <article-title>Neural correlates of forward planning in a spatial decision task in humans</article-title>. <source>J Neurosci</source>. <year>2011</year>;<volume>31</volume>(<issue>14</issue>):<fpage>5526</fpage>–<lpage>5539</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4647-10.2011" xlink:type="simple">10.1523/JNEUROSCI.4647-10.2011</ext-link></comment> <object-id pub-id-type="pmid">21471389</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shallice</surname> <given-names>T</given-names></name>. <article-title>Specific Impairments of Planning</article-title>. <source>Royal Society of London Philosophical Transactions Series B</source>. <year>1982</year>;<volume>298</volume>:<fpage>199</fpage>–<lpage>209</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.1982.0082" xlink:type="simple">10.1098/rstb.1982.0082</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Phillips</surname> <given-names>LH</given-names></name>. <article-title>The role of memory in the Tower of London task</article-title>. <source>Memory</source>. <year>1999</year>;<volume>7</volume>(<issue>2</issue>):<fpage>209</fpage>–<lpage>231</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/741944066" xlink:type="simple">10.1080/741944066</ext-link></comment> <object-id pub-id-type="pmid">10645380</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref059">
<label>59</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Nilsson</surname> <given-names>NJ</given-names></name>. <source>Problem-Solving Methods in Artificial Intelligence</source>; <year>1971</year>. <publisher-name>McGraw-Hill</publisher-name>, <publisher-loc>New York</publisher-loc>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref060">
<label>60</label>
<mixed-citation publication-type="other" xlink:type="simple">Botvinick MM, An J. Goal-directed decision making in prefrontal cortex: a computational framework. In: Advances in Neural Information Processing Systems (NIPS); 2008.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref061">
<label>61</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Sutton</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Barto</surname> <given-names>AG</given-names></name>. <source>Reinforcement Learning: An Introduction</source>. <publisher-loc>Cambridge MA</publisher-loc>: <publisher-name>MIT Press</publisher-name>; <year>1998</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref062">
<label>62</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Murphy</surname> <given-names>KP</given-names></name>. <source>Dynamic Bayesian Networks: representation, inference and learning</source>. <publisher-name>UC Berkeley, Computer Science Division</publisher-name>; <year>2002</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bogacz</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Moehlis</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>JD</given-names></name>. <article-title>The physics of optimal decision making: a formal analysis of models of performance in two-alternative forced-choice tasks</article-title>. <source>Psychol Rev</source>. <year>2006</year>;<volume>113</volume>(<issue>4</issue>):<fpage>700</fpage>–<lpage>765</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1037/0033-295X.113.4.700" xlink:type="simple">10.1037/0033-295X.113.4.700</ext-link></comment> <object-id pub-id-type="pmid">17014301</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lepora</surname> <given-names>NF</given-names></name>, <name name-style="western"><surname>Gurney</surname> <given-names>KN</given-names></name>. <article-title>The basal ganglia optimize decision making over general perceptual hypotheses</article-title>. <source>Neural Comput</source>. <year>2012</year>;<volume>24</volume>(<issue>11</issue>):<fpage>2924</fpage>–<lpage>2945</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00360" xlink:type="simple">10.1162/NECO_a_00360</ext-link></comment> <object-id pub-id-type="pmid">22920846</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Solomonoff</surname> <given-names>RJ</given-names></name>. <article-title>The discovery of algorithmic probability</article-title>. <source>Journal of Computer and System Sciences</source>. <year>1997</year>;<volume>55</volume>(<issue>1</issue>):<fpage>73</fpage>–<lpage>88</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jcss.1997.1500" xlink:type="simple">10.1006/jcss.1997.1500</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref066">
<label>66</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Vitányi</surname> <given-names>P</given-names></name>. <source>An introduction to Kolmogorov complexity and its applications</source>. <publisher-name>Springer Science &amp; Business Media</publisher-name>; <year>2013</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref067">
<label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Goel</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Pullara</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Grafman</surname> <given-names>J</given-names></name>. <article-title>A computational model of frontal lobe dysfunction: Working memory and the Tower of Hanoi task</article-title>. <source>Cognitive Science</source>. <year>2001</year>;<volume>25</volume>(<issue>2</issue>):<fpage>287</fpage>–<lpage>313</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1207/s15516709cog2502_4" xlink:type="simple">10.1207/s15516709cog2502_4</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref068">
<label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Solomonoff</surname> <given-names>RJ</given-names></name>. <article-title>A formal theory of inductive inference. Part I</article-title>. <source>Information and control</source>. <year>1964</year>;<volume>7</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>22</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0019-9958(64)90223-2" xlink:type="simple">10.1016/S0019-9958(64)90223-2</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref069">
<label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Solomonoff</surname> <given-names>RJ</given-names></name>. <article-title>A formal theory of inductive inference. Part II</article-title>. <source>Information and control</source>. <year>1964</year>;<volume>7</volume>(<issue>2</issue>):<fpage>224</fpage>–<lpage>254</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0019-9958(64)90131-7" xlink:type="simple">10.1016/S0019-9958(64)90131-7</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref070">
<label>70</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Doucet</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Godsill</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Andrieu</surname> <given-names>C</given-names></name>. <article-title>On sequential Monte Carlo sampling methods for Bayesian filtering</article-title>. <source>Statistics and computing</source>. <year>2000</year>;<volume>10</volume>(<issue>3</issue>):<fpage>197</fpage>–<lpage>208</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1023/A:1008935410038" xlink:type="simple">10.1023/A:1008935410038</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref071">
<label>71</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Geffner</surname> <given-names>H</given-names></name>. <chapter-title>Computational Models of Planning</chapter-title>. <source>Wiley Interdisciplinary Reviews: Cognitive Science</source>. <year>2013</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref072">
<label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ratcliff</surname> <given-names>R</given-names></name>. <article-title>A theory of memory retrieval</article-title>. <source>Psychological Review</source>. <year>1978</year>;<volume>85</volume>:<fpage>59</fpage>–<lpage>108</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1037/0033-295X.85.2.59" xlink:type="simple">10.1037/0033-295X.85.2.59</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref073">
<label>73</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lepora</surname> <given-names>NF</given-names></name>, <name name-style="western"><surname>Pezzulo</surname> <given-names>G</given-names></name>. <article-title>Embodied choice: how action influences perceptual decision making</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>4</issue>):<fpage>e1004110</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004110" xlink:type="simple">10.1371/journal.pcbi.1004110</ext-link></comment> <object-id pub-id-type="pmid">25849349</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref074">
<label>74</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Solway</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Diuk</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Cordova</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Yee</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Barto</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Niv</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Optimal behavioral hierarchy</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>(<issue>8</issue>):<fpage>e1003779</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003779" xlink:type="simple">10.1371/journal.pcbi.1003779</ext-link></comment> <object-id pub-id-type="pmid">25122479</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref075">
<label>75</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schapiro</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Rogers</surname> <given-names>TT</given-names></name>, <name name-style="western"><surname>Cordova</surname> <given-names>NI</given-names></name>, <name name-style="western"><surname>Turk-Browne</surname> <given-names>NB</given-names></name>, <name name-style="western"><surname>Botvinick</surname> <given-names>MM</given-names></name>. <article-title>Neural representations of events arise from temporal community structure</article-title>. <source>Nat Neurosci</source>. <year>2013</year>;<volume>16</volume>(<issue>4</issue>):<fpage>486</fpage>–<lpage>492</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3331" xlink:type="simple">10.1038/nn.3331</ext-link></comment> <object-id pub-id-type="pmid">23416451</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref076">
<label>76</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bull</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Espy</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Senn</surname> <given-names>TE</given-names></name>. <article-title>A comparison of performance on the Towers of London and Hanoi in young children</article-title>. <source>J Child Psychol Psychiatry</source>. <year>2004</year>;<volume>45</volume>(<issue>4</issue>):<fpage>743</fpage>–<lpage>754</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1469-7610.2004.00268.x" xlink:type="simple">10.1111/j.1469-7610.2004.00268.x</ext-link></comment> <object-id pub-id-type="pmid">15056306</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref077">
<label>77</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Goel</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Grafman</surname> <given-names>J</given-names></name>. <article-title>Are the frontal lobes implicated in planning functions? Interpreting data from the Tower of Hanoi</article-title>. <source>Neuropsychologia</source>. <year>1995</year>;<volume>33</volume>(<issue>5</issue>):<fpage>623</fpage>–<lpage>642</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0028-3932(95)90866-P" xlink:type="simple">10.1016/0028-3932(95)90866-P</ext-link></comment> <object-id pub-id-type="pmid">7637857</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref078">
<label>78</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Mackay</surname> <given-names>DJC</given-names></name>. <source>Information Theory, Inference &amp; Learning Algorithms</source>. <edition>1st ed</edition>. <publisher-name>Cambridge University Press</publisher-name>; <year>2002</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref079">
<label>79</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Keramati</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dezfouli</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Piray</surname> <given-names>P</given-names></name>. <article-title>Speed/accuracy trade-off between the habitual and the goal-directed processes</article-title>. <source>PLoS Comput Biol</source>. <year>2011</year>;<volume>7</volume>(<issue>5</issue>):<fpage>e1002055</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002055" xlink:type="simple">10.1371/journal.pcbi.1002055</ext-link></comment> <object-id pub-id-type="pmid">21637741</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref080">
<label>80</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pezzulo</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Rigoli</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>. <article-title>Active Inference, homeostatic regulation and adaptive behavioural control</article-title>. <source>Prog Neurobiol</source>. <year>2015</year>;<volume>134</volume>:<fpage>17</fpage>–<lpage>35</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.pneurobio.2015.09.001" xlink:type="simple">10.1016/j.pneurobio.2015.09.001</ext-link></comment> <object-id pub-id-type="pmid">26365173</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref081">
<label>81</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Simon</surname> <given-names>HA</given-names></name>. <article-title>The functional equivalence of problem solving skills</article-title>. <source>Cognitive Psychology</source>. <year>1975</year>;<volume>7</volume>(<issue>2</issue>):<fpage>268</fpage>?–<lpage>288</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0010-0285(75)90012-2" xlink:type="simple">10.1016/0010-0285(75)90012-2</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref082">
<label>82</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kool</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>McGuire</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Rosen</surname> <given-names>ZB</given-names></name>, <name name-style="western"><surname>Botvinick</surname> <given-names>MM</given-names></name>. <article-title>Decision making and the avoidance of cognitive demand</article-title>. <source>J Exp Psychol Gen</source>. <year>2010</year>;<volume>139</volume>(<issue>4</issue>):<fpage>665</fpage>–<lpage>682</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1037/a0020198" xlink:type="simple">10.1037/a0020198</ext-link></comment> <object-id pub-id-type="pmid">20853993</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref083">
<label>83</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Otto</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Markman</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>. <article-title>The Curse of Planning: Dissecting multiple reinforcement learning systems by taxing the central executive</article-title>. <source>Psychological Science</source>. <year>2012</year>;in press.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref084">
<label>84</label>
<mixed-citation publication-type="other" xlink:type="simple">Şimşek Ö, Barreto, AS. Skill characterization based on betweenness. In: Advances in neural information processing systems; 2009. p. 1497–1504.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref085">
<label>85</label>
<mixed-citation publication-type="other" xlink:type="simple">Tishby N, Pereira FC, Bialek W. The Information Bottleneck Method. In: Proc. of the 37-th Annual Allerton Conference on Communication, Control and Computing; 1999. p. 368–377.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref086">
<label>86</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Tishby</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Polani</surname> <given-names>D</given-names></name>. <chapter-title>Information theory of decisions and actions</chapter-title>. In: <source>Perception-action cycle</source>. <publisher-name>Springer</publisher-name>; <year>2011</year>. p. <fpage>601</fpage>–<lpage>636</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref087">
<label>87</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stoianov</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Genovesio</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Pezzulo</surname> <given-names>G</given-names></name>. <article-title>Prefrontal goal-codes emerge as latent states in probabilistic value learning</article-title>. <source>Journal of Cognitive Neuroscience</source>. <year>2016</year>;<volume>28</volume>(<issue>1</issue>):<fpage>140</fpage>–<lpage>157</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/jocn_a_00886" xlink:type="simple">10.1162/jocn_a_00886</ext-link></comment> <object-id pub-id-type="pmid">26439267</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref088">
<label>88</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Anderson</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Albert</surname> <given-names>MV</given-names></name>, <name name-style="western"><surname>Fincham</surname> <given-names>JM</given-names></name>. <article-title>Tracing problem solving in real time: fMRI analysis of the subject-paced Tower of Hanoi</article-title>. <source>Journal of cognitive neuroscience</source>. <year>2005</year>;<volume>17</volume>(<issue>8</issue>):<fpage>1261</fpage>–<lpage>1274</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/0898929055002427" xlink:type="simple">10.1162/0898929055002427</ext-link></comment> <object-id pub-id-type="pmid">16197682</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref089">
<label>89</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Altmann</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Trafton</surname> <given-names>JG</given-names></name>. <article-title>Memory for goals: An activation-based model</article-title>. <source>Cognitive science</source>. <year>2002</year>;<volume>26</volume>(<issue>1</issue>):<fpage>39</fpage>–<lpage>83</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1207/s15516709cog2601_2" xlink:type="simple">10.1207/s15516709cog2601_2</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref090">
<label>90</label>
<mixed-citation publication-type="other" xlink:type="simple">Stewart TC, Eliasmith C. Neural cognitive modelling: A biologically constrained spiking neuron model of the Tower of Hanoi task. In: Proceedings of the 33rd Annual Conference of the Cognitive Science Society; 2011. p. 656–661.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref091">
<label>91</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Bakker</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Schmidhuber</surname> <given-names>J</given-names></name>. <chapter-title>Hierarchical Reinforcement Learning Based on Subgoal Discovery and Subpolicy Specialization</chapter-title>. In: <name name-style="western"><surname>Groen</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Amato</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Bonarini</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Yoshida</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Krose</surname> <given-names>B</given-names></name>, editors. <source>Proceedings of the 8-th Conference on Intelligent Autonomous Systems, IAS-8</source>. <publisher-loc>Amsterdam, The Netherlands</publisher-loc>; <year>2004</year>. p. <fpage>438</fpage>–<lpage>445</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004864.ref092">
<label>92</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Botvinick</surname> <given-names>MM</given-names></name>. <article-title>Hierarchical models of behavior and prefrontal function</article-title>. <source>Trends in Cognitive Sciences</source>. <year>2008</year>;<volume>12</volume>(<issue>5</issue>):<fpage>201</fpage>–<lpage>208</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tics.2008.02.009" xlink:type="simple">10.1016/j.tics.2008.02.009</ext-link></comment> <object-id pub-id-type="pmid">18420448</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004864.ref093">
<label>93</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wiering</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Schmidhuber</surname> <given-names>J</given-names></name>. <article-title>HQ-learning</article-title>. <source>Adaptive Behavior</source>. <year>1997</year>;<volume>6</volume>(<issue>2</issue>):<fpage>219</fpage>–<lpage>246</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1177/105971239700600202" xlink:type="simple">10.1177/105971239700600202</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>