<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-00749</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1007282</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Thermodynamics</subject><subj-group><subject>Entropy</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Computational techniques</subject><subj-group><subject>Split-decomposition method</subject><subj-group><subject>Multiple alignment calculation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Thermodynamics</subject><subj-group><subject>Free energy</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Mutation</subject><subj-group><subject>Point mutation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein interactions</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>Protein structure</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein structure</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Size and structure of the sequence space of repeat proteins</article-title>
<alt-title alt-title-type="running-head">Size and structure of the sequence space of repeat proteins</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Marchi</surname> <given-names>Jacopo</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9516-3985</contrib-id>
<name name-style="western">
<surname>Galpern</surname> <given-names>Ezequiel A.</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Espada</surname> <given-names>Rocio</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Ferreiro</surname> <given-names>Diego U.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Walczak</surname> <given-names>Aleksandra M.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" equal-contrib="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5456-9361</contrib-id>
<name name-style="western">
<surname>Mora</surname> <given-names>Thierry</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Laboratoire de physique de l’École normale supérieure (PSL University), CNRS, Sorbonne Université, and Université de Paris, 75005 Paris, France</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Protein Physiology Lab, Universidad de Buenos Aires, Facultad de Ciencias Exactas y Naturales, Departamento de Química Biológica, Buenos Aires, Argentina</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>CONICET - Universidad de Buenos Aires, Instituto de Química Biológica de la Facultad de Ciencias Exactas y Naturales (IQUIBICEN), Buenos Aires, Argentina</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Laboratoire Gulliver, Ecole supérieure de physique et chimie industrielles (PSL University) and CNRS, 75005, Paris, France</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Schlessinger</surname> <given-names>Avner</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Icahn School of Medicine at Mount Sinai, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">awalczak@lpt.ens.fr</email> (AMW); <email xlink:type="simple">tmora@lps.ens.fr</email> (TM)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>8</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>15</day>
<month>8</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>8</issue>
<elocation-id>e1007282</elocation-id>
<history>
<date date-type="received">
<day>11</day>
<month>5</month>
<year>2019</year>
</date>
<date date-type="accepted">
<day>24</day>
<month>7</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Marchi et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1007282"/>
<abstract>
<p>The coding space of protein sequences is shaped by evolutionary constraints set by requirements of function and stability. We show that the coding space of a given protein family—the total number of sequences in that family—can be estimated using models of maximum entropy trained on multiple sequence alignments of naturally occuring amino acid sequences. We analyzed and calculated the size of three abundant repeat proteins families, whose members are large proteins made of many repetitions of conserved portions of ∼30 amino acids. While amino acid conservation at each position of the alignment explains most of the reduction of diversity relative to completely random sequences, we found that correlations between amino acid usage at different positions significantly impact that diversity. We quantified the impact of different types of correlations, functional and evolutionary, on sequence diversity. Analysis of the detailed structure of the coding space of the families revealed a rugged landscape, with many local energy minima of varying sizes with a hierarchical structure, reminiscent of fustrated energy landscapes of spin glass in physics. This clustered structure indicates a multiplicity of subtypes within each family, and suggests new strategies for protein design.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Natural protein molecules are only a small subset of the possible strings of amino acids. This naturally calls the question of how many protein sequences theoretically exist that are functional, and how many have already been explored by nature. To help answer this question, we developed a statistical method to calculate the total potential number of protein sequences of a given family, focusing on three families of repeat proteins, which play important roles in a variety of cellular processes. The number of sequences that we compute is limited by functional interactions between the residues of the protein, as well as its evolutionary history. Applying techniques from the physics of disordered systems, we show that the space of sequences has a rugged structure, which could hinder their evolution. Individual proteins can be organised into distinct clusters corresponding to basins of attraction of the landscape, suggesting the existence of subfamilies within each family.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>European Research Council</institution>
</funding-source>
<award-id>COG 724208</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Walczak</surname> <given-names>Aleksandra M.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>ECOS Sud - MINCyT</institution>
</funding-source>
<award-id>A14E04</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Walczak</surname> <given-names>Aleksandra M.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was partly supported by European Research Council (erc.europa.eu) Consolidator Grant no 724208 to AMW and ECOS Sud – CONICYT (<ext-link ext-link-type="uri" xlink:href="http://www.univ-paris13.fr/cofecub-ecos/ecos-sud" xlink:type="simple">www.univ-paris13.fr/cofecub-ecos/ecos-sud</ext-link>) grant no. A14E04 to DUF and AMW. NASA Astrobiology Institute, Grant no. 80NSSC18M0093. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="1"/>
<page-count count="23"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-09-09</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the manuscript and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Natural proteins contain a record of their evolutionary history, as selective pressure constrains their amino-acid sequences to perform certain functions. However, if we take all proteins found in nature, their sequence appears to be random, without any apparent rules that distinguish their sequences from arbitrary polypeptides. Nonetheless, the volume of sequence space taken up by existing proteins is very small compared to all possible polypeptide strings of a given length [<xref ref-type="bibr" rid="pcbi.1007282.ref001">1</xref>], even more so when specializing to a given structure [<xref ref-type="bibr" rid="pcbi.1007282.ref002">2</xref>]. Clearly, not all variants are equally likely to survive [<xref ref-type="bibr" rid="pcbi.1007282.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1007282.ref005">5</xref>]. To better understand the structure of the space of natural proteins, it is useful to group them into families of proteins with similar fold, function, and sequence, believed to be under a common selective pressure. Assuming that the ensemble of protein families is equilibrated, there should exist a relationship between the conserved features of their amino acid sequences and their function. This relation can be extracted by examining statistics of amino-acid composition, starting with single sites in multiple alignments (as provided by e.g. PFAM [<xref ref-type="bibr" rid="pcbi.1007282.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1007282.ref007">7</xref>]). More interesting information can be extracted from covariation of amino acid usages at pairs of positions [<xref ref-type="bibr" rid="pcbi.1007282.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1007282.ref010">10</xref>] or using machine-learning techniques [<xref ref-type="bibr" rid="pcbi.1007282.ref011">11</xref>]. Models of protein sequences based of pairwise covariations have been shown to successfully predict pair-wise amino-acid contacts in three dimensional structures [<xref ref-type="bibr" rid="pcbi.1007282.ref012">12</xref>–<xref ref-type="bibr" rid="pcbi.1007282.ref017">17</xref>], aid protein folding algorithms [<xref ref-type="bibr" rid="pcbi.1007282.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1007282.ref019">19</xref>], and predict the effect of point mutations [<xref ref-type="bibr" rid="pcbi.1007282.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1007282.ref020">20</xref>–<xref ref-type="bibr" rid="pcbi.1007282.ref022">22</xref>]. However, little is known on how these identified amino-acid constraints affect the global size, shape and structure of the sequence space. Accounting for these questions is a first step towards drawing out the possible and the realized evolutionary trajectories of protein sequences [<xref ref-type="bibr" rid="pcbi.1007282.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1007282.ref024">24</xref>].</p>
<p>We use tools and concepts from the statistical mechanics of disordered systems to study collective, protein-wide effects and to understand how evolutionary constraints shape the landscape of protein families. We go beyond previous work which focused on local effects—pairwise contacts between residues, effect of single amino-acid mutations—to ask how amino-acid conservation and covariation restrict and shape the landscape of sequences in a family. Specifically, we characterize the size of the ensemble, defined as the effective number of sequences of a familiy, as well as its detailed structure: is it made of one block or divided into clusters of “basins”? These are intrinsically collective properties that can not be assessed locally.</p>
<p>Repeat proteins are excellent systems in which to quantify these collective effects, as they combine both local and global interactions. Repeat proteins are found as domains or subdomains in a very large number of functionally important proteins, in particular signaling proteins (e.g. NF-<italic>κ</italic>B, p16, Notch [<xref ref-type="bibr" rid="pcbi.1007282.ref025">25</xref>]). Usually they are composed of tandem repetitions of ∼30 amino-acids that fold into elongated architectures. Repeat proteins have been divided into different families based on their structural similarity. Here we consider three abundant repeat protein families: ankyrin repeats (ANK), tetratricopeptide repeats (TPR), leucine-rich repeat (LRR) that fold into repetitive structures (see <xref ref-type="fig" rid="pcbi.1007282.g001">Fig 1</xref>). In addition to interactions between residues within one repeat, repeat protein evolution is constrained by inter-repeat interactions, which lead to the characteristic accordeon-like folds. Through these separable types of constraints, as well as the possibility of intra- and inter-familly comparisons, repeat proteins are perfect candidates to ask questions about the origins and the effects of the constraints that globally shape the sequences.</p>
<fig id="pcbi.1007282.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007282.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Repeat proteins fold into characteristic accordeon-like folds.</title>
<p>Example structures of three protein families are shown, ankyrin repeats (ANK), tetratricopeptide repeats (TPR), leucine-rich repeat (LRR), with the repeating unit highlighted in magenta. All show regular folding patterns with defined contacts in and between repeats.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007282.g001" xlink:type="simple"/>
</fig>
<p>A recent study [<xref ref-type="bibr" rid="pcbi.1007282.ref026">26</xref>] addressed the question of the total number of sequences within a given protein family, focusing on ten single-domain families. They took a similar thermodynamic approach to the one followed here, but had to estimate experimentally the free energy threshold Δ<italic>G</italic> below which the sequences would fold properly. Here we overcome this limitation by forgoing this threshold entirely. Instead we determine the sequence entropy directly, which is argued to be equivalent to using a threshold free energy by virtue of the equivalence of ensembles. We precisely quantify the sequence entropy of three repeat-protein families for which detailed evolutionary energetic fields are known [<xref ref-type="bibr" rid="pcbi.1007282.ref027">27</xref>]. We explore the properties of the evolutionary landscape shaped by the amino-acid frequency constraints and correlations. We ask whether the energy landscape, defined in sequence space of repeat proteins, is made of a single basin, or rather of a multitude of basins connected by ridges and passes, called “metastable states”, as would be expected from spin-glass theory. Using the specific example of repeat proteins makes it possible to analyze the source of the potential landscape ruggedness, and use it to identify which repeat-protein families can be well separated into subfamilies. The rich metastable state structure that we find demonstrates the importance of interactions in shaping the protein family ensemble.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Statistical models of repeat-protein families</title>
<p>We start by building statistical models for the three repeat protein families presented in <xref ref-type="fig" rid="pcbi.1007282.g001">Fig 1</xref> (ANK, TPR, LRR). These models give the probability <italic>P</italic>(<bold><italic>σ</italic></bold>) to find in the family of interest a particular sequence <bold><italic>σ</italic></bold> = (<italic>σ</italic><sub>1</sub>, …, <italic>σ</italic><sub>2<italic>L</italic></sub>) for two consecutive repeats of size <italic>L</italic>. The model is designed to be as random as possible, while agreeing with key statistics of variation and co-variation in a multiple sequence alignment of the protein family. Specifically, <italic>P</italic>(<bold><italic>σ</italic></bold>) is obtained as the distribution of maximum entropy [<xref ref-type="bibr" rid="pcbi.1007282.ref028">28</xref>] which has the same amino-acid frequencies at each position as in the alignment, as well as the same joint frequencies of amino acid usage in each pair of positions. Additionally, repeat proteins share many amino acids between consecutive repeats, both due to sharing a common ancestor and to evolutionary selection acting on the protein. To account for this special property of repeat proteins, we require that the model reproduces the distribution of overlaps <inline-formula id="pcbi.1007282.e001"><alternatives><graphic id="pcbi.1007282.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mtext>ID</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:msubsup> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> between consecutive repeats. Using the technique of Lagrange multipliers, the distribution can be shown to take the form [<xref ref-type="bibr" rid="pcbi.1007282.ref017">17</xref>]:
<disp-formula id="pcbi.1007282.e002"><alternatives><graphic id="pcbi.1007282.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>Z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
with
<disp-formula id="pcbi.1007282.e003"><alternatives><graphic id="pcbi.1007282.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>L</mml:mi></mml:mrow></mml:munderover> <mml:msub><mml:mi>h</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>L</mml:mi></mml:mrow></mml:munderover> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mtext>ID</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where <italic>h</italic><sub><italic>i</italic></sub>(<italic>σ</italic>), <italic>J</italic><sub><italic>ij</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>, <italic>σ</italic><sub><italic>j</italic></sub>), and {λ<sub>ID</sub>}, ID = 0, 1, …, <italic>L</italic>, are adjustable Lagrange multipliers that are fit to the data to reproduce the experimentally observed site-dependent amino-acid frequencies <italic>f</italic><sub><italic>i</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>), joint probabilities between two positions, <italic>f</italic><sub><italic>ij</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>, <italic>σ</italic><sub><italic>j</italic></sub>), and the distribution of Hamming distances between consecutive repeats <italic>P</italic>(ID(<bold><italic>σ</italic></bold>)), which is equivalent to maximize the likelihood of the data under the model. We fit these parameters using a gradient ascent algorithm: we start from an initial guess of the parameters, then generate sequences via Monte-Carlo simulations and update the parameters proportionally to the difference between the empirical and model generated observables <inline-formula id="pcbi.1007282.e004"><alternatives><graphic id="pcbi.1007282.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>model</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1007282.e005"><alternatives><graphic id="pcbi.1007282.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mtext>model</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <italic>P</italic>(ID(<bold><italic>σ</italic></bold>)) − <italic>P</italic>(ID(<bold><italic>σ</italic></bold>))<sup>model</sup>. We repeat the previous steps until the model reproduces the empirical observables defined above, with a target precision motivated according to the finite size of our original dataset, as in Ref. [<xref ref-type="bibr" rid="pcbi.1007282.ref017">17</xref>]. See <xref ref-type="sec" rid="sec011">Methods</xref> for more details. We tested the convergence of the model learning by synthetically generating datasets and relearning the model (see <xref ref-type="sec" rid="sec011">Methods</xref>).</p>
<p>By analogy with Boltmzan’s law, we call <italic>E</italic>(<bold><italic>σ</italic></bold>) a statistical energy, which is in general distinct from any physical energy. The particular form of the energy <xref ref-type="disp-formula" rid="pcbi.1007282.e003">(2)</xref> resembles that of a disordered Potts model. This mathematical equivalence allows for the possibility to study effects that are characteristic of disordered systems, such as frustration or the existence of an energy landscape with multiple valleys, as we will discuss in the next sections.</p>
<p><xref ref-type="disp-formula" rid="pcbi.1007282.e003">Eq 2</xref> is the most constrained form of the model, which we will denote by <italic>E</italic><sub>full</sub>(<bold><italic>σ</italic></bold>). One can explore the impact of each constraint on the energy landscape by removing them from the model. For instance, to study the role of inter-repeat sequence similarity due to a common evolutionary origin, one can fit the model without the constraint on repeat overlap ID, <italic>i.e</italic>. without the λ<sub>ID</sub> term in <xref ref-type="disp-formula" rid="pcbi.1007282.e003">Eq 2</xref>. We call the corresponding energy function <italic>E</italic><sub>2</sub>. One can further remove constraints on pairwise positions that are not part of the same repeat, making the two consecutive repeats statistically independent and imposing <italic>h</italic><sub><italic>i</italic></sub> = <italic>h</italic><sub><italic>i</italic>+<italic>L</italic></sub> (<italic>E</italic><sub>ir</sub>), or only linked through phylogenic conservation through λ<sub>ID</sub> (<italic>E</italic><sub>ir,λ</sub>). Finally one can remove all interaction constraints to make all positions independent of each other (<italic>E</italic><sub>1</sub>), or even remove all constraints (<italic>E</italic><sub>rand</sub> ≡ 0).</p>
</sec>
<sec id="sec004">
<title>Statistical energy <italic>vs</italic> unfolding energy</title>
<p>The evolutionary information contained in multiple sequence alignments of protein families is summarized in our model by the energy function <italic>E</italic>(<bold><italic>σ</italic></bold>). Since this information is often much easier to access than structural or functional information, there is great interest in extracting functional or structural properties from multiple sequence alignments, provided that there exists a clear quantitative relationship between statistical energy and physical energy.</p>
<p>Such a relationship was determined experimentally for repeat proteins by using <italic>E</italic>(<bold><italic>σ</italic></bold>) to predict the effect of point mutations on the folding stability measured by the free energy difference between the folded and unfolded states, Δ<italic>G</italic>, called the unfolding energy [<xref ref-type="bibr" rid="pcbi.1007282.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1007282.ref020">20</xref>]. Synthetic sequences with low <italic>E</italic>(<bold><italic>σ</italic></bold>) have also been shown to reproduce the fold and function of natural sequences [<xref ref-type="bibr" rid="pcbi.1007282.ref029">29</xref>]. Here, extending an argument already developed in previous work [<xref ref-type="bibr" rid="pcbi.1007282.ref030">30</xref>–<xref ref-type="bibr" rid="pcbi.1007282.ref033">33</xref>], we show how this correspondance between statistical likelihood and folding stability arises in a simple model of evolution.</p>
<p>Evolutionary theory predicts that the prevalence of a particular genotype <bold><italic>σ</italic></bold>, i.e. the probability of finding it in a population, is related to its fitness <italic>F</italic>(<bold><italic>σ</italic></bold>). In the limit where mutations affecting the protein are rare compared to the time it takes for mutations to spread through the population, Kimura [<xref ref-type="bibr" rid="pcbi.1007282.ref034">34</xref>] showed that the probability of a mutation giving a fitness advantage (or disadvantage depending on the sign) Δ<italic>F</italic> over its ancestor will fix in the population with probability 2Δ<italic>F</italic>/(1 − <italic>e</italic><sup>−2<italic>N</italic>Δ<italic>F</italic></sup>), where <italic>N</italic> is the effective population size. The dynamics of successful substitution satisfies detailed balance [<xref ref-type="bibr" rid="pcbi.1007282.ref035">35</xref>], with the steady state probability
<disp-formula id="pcbi.1007282.e006"><alternatives><graphic id="pcbi.1007282.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>Z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>N</mml:mi> <mml:mi>F</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula></p>
<p>Again, one may recognize a formal analogy with Boltzmann’s distribution, where <italic>F</italic> plays the role of a negative energy, and <italic>N</italic> an inverse temperature. If we now assume that fitness is determined by the unfolding free energy Δ<italic>G</italic>, <italic>F</italic>(<bold><italic>σ</italic></bold>) = <italic>f</italic>(Δ<italic>G</italic>(<bold><italic>σ</italic></bold>)), then the distribution of genotypes we expect to observe in a population is
<disp-formula id="pcbi.1007282.e007"><alternatives><graphic id="pcbi.1007282.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>Z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>N</mml:mi> <mml:mi>f</mml:mi> <mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>G</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula></p>
<p>Note that a similar relation should hold even if we relax the hypotheses of the evolutionary model. While in more general contexts (e.g. high mutation rate, recombination), the relation between ln <italic>P</italic>(<bold><italic>σ</italic></bold>) and <italic>F</italic>(<bold><italic>σ</italic></bold>) may not be linear, such nonlinearities could be subsumed into the function <italic>f</italic>.</p>
<p>Identifying terms in the two expressions <xref ref-type="disp-formula" rid="pcbi.1007282.e002">(1)</xref> and <xref ref-type="disp-formula" rid="pcbi.1007282.e006">(3)</xref>, we obtain a relation between the statistical energy <italic>E</italic>, and the unfolding free energy Δ<italic>G</italic>:
<disp-formula id="pcbi.1007282.e008"><alternatives><graphic id="pcbi.1007282.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mi>N</mml:mi> <mml:mi>f</mml:mi> <mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>G</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula></p>
<p>For instance, if we assume a linear relation between fitness and Δ<italic>G</italic>, <italic>f</italic>(Δ<italic>G</italic>) = <italic>A</italic> + <italic>B</italic>Δ<italic>G</italic>, then we get a linear relationship between the statistical energy and Δ<italic>G</italic>, as was found empirically for repeat proteins [<xref ref-type="bibr" rid="pcbi.1007282.ref017">17</xref>].</p>
<p>Strikingly, the relationship <italic>f</italic> does not have to be linear or even smooth for this correspondance to work. Imagine a more stringent selection model, where <italic>f</italic>(Δ<italic>G</italic>) is a threshold function, <italic>f</italic>(Δ<italic>G</italic>) = 0 for Δ<italic>G</italic> &gt; Δ<italic>G</italic><sub>sel</sub> and −∞ otherwise (lethal). In that case the probability distribution is <italic>P</italic>(<bold><italic>σ</italic></bold>) = (1/<italic>Z</italic>)Θ(Δ<italic>G</italic> − Δ<italic>G</italic><sub>sel</sub>), where Θ(<italic>x</italic>) is Heaviside’s function. Using a saddle-point approximation, one can show that in the thermodynamic limit (long proteins, or large <italic>L</italic>) the distribution concentrates at the border Δ<italic>G</italic><sub>sel</sub>, and is equivalent to a “canonical” description [<xref ref-type="bibr" rid="pcbi.1007282.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1007282.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1007282.ref033">33</xref>]:
<disp-formula id="pcbi.1007282.e009"><alternatives><graphic id="pcbi.1007282.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mtext>sel</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>Z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>sel</mml:mtext></mml:msub></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
where the “temperature” <italic>T</italic><sub>sel</sub> is set to match the mean Δ<italic>G</italic> between the two descriptions:
<disp-formula id="pcbi.1007282.e010"><alternatives><graphic id="pcbi.1007282.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>G</mml:mi> <mml:mo>⟩</mml:mo></mml:mrow> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>sel</mml:mtext></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mtext>sel</mml:mtext></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula></p>
<p>This correspondance is mathematically similar to the equivalence between the micro-canonical and canonical ensembles in statistical mechanics.</p>
<p>Statistical energy and unfolding free energy are linearly related by equating (<xref ref-type="disp-formula" rid="pcbi.1007282.e002">Eq 1</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1007282.e009">Eq 6</xref>):
<disp-formula id="pcbi.1007282.e011"><alternatives><graphic id="pcbi.1007282.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>sel</mml:mtext></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
despite <italic>f</italic> being nonlinear. <xref ref-type="disp-formula" rid="pcbi.1007282.e011">Eq 8</xref> is in fact very general and should hold for any <italic>f</italic> in the thermodynamic limit in the vicinity of 〈<italic>E</italic>〉.</p>
</sec>
<sec id="sec005">
<title>Equivalence between two definitions of entropies</title>
<p>There are several ways to define the diversity of a protein family. The most intuitive one, followed by [<xref ref-type="bibr" rid="pcbi.1007282.ref026">26</xref>], is to count the total number of amino acid sequences that have an unfolding free energy Δ<italic>G</italic><sub>sel</sub> above a threshold Δ<italic>G</italic><sub>sel</sub> [<xref ref-type="bibr" rid="pcbi.1007282.ref002">2</xref>]. This number naturally defines a Boltzmann entropy,
<disp-formula id="pcbi.1007282.e012"><alternatives><graphic id="pcbi.1007282.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>=</mml:mo> <mml:mo form="prefix">ln</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>:</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&gt;</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>G</mml:mi> <mml:mtext>sel</mml:mtext></mml:msub> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula></p>
<p>Alternatively, starting from a statistical model <italic>P</italic>(<bold><italic>σ</italic></bold>), one can calculate its Shannon entropy, defined as
<disp-formula id="pcbi.1007282.e013"><alternatives><graphic id="pcbi.1007282.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>σ</mml:mi></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo form="prefix">ln</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
as was done in Ref. [<xref ref-type="bibr" rid="pcbi.1007282.ref027">27</xref>]. What is the relation between these two definitions?</p>
<p>By the same saddle-point approximation as in the previous section, the two are identical in the thermodyamic limit (large <italic>L</italic>), provided that the condition (<xref ref-type="disp-formula" rid="pcbi.1007282.e010">Eq 7</xref>) is satisfied. We can thus reconcile the two definitions of the entropy in that limit.</p>
<p>To calculate the Boltzmann entropy (<xref ref-type="disp-formula" rid="pcbi.1007282.e012">Eq 9</xref>), one needs to first evaluate the threshold <italic>E</italic><sub>sel</sub> in terms of statistical energy. This threshold is given by <italic>E</italic><sub>sel</sub> = <italic>E</italic><sub>0</sub> − Δ<italic>G</italic><sub>sel</sub>/<italic>T</italic><sub>sel</sub>, where <italic>E</italic><sub>0</sub> and <italic>T</italic><sub>sel</sub> can be obtained directly by fitting (<xref ref-type="disp-formula" rid="pcbi.1007282.e011">Eq 8</xref>) to single-mutant experiments. <italic>E</italic><sub>sel</sub> can also be obtained as a discrimination threshold separating sequences that are known to fold properly versus sequences that do not [<xref ref-type="bibr" rid="pcbi.1007282.ref026">26</xref>]. In that case, assuming that the linear relationship (<xref ref-type="disp-formula" rid="pcbi.1007282.e011">Eq 8</xref>) was evaluated empirically using single mutants, this relationship can be inverted to get Δ<italic>G</italic><sub>sel</sub> in physical units.</p>
<p>Calculating the Shannon entropy <xref ref-type="disp-formula" rid="pcbi.1007282.e013">Eq (10)</xref>, on the other hand, does not require to define any threshold. However, the threshold in the equivalent Boltzmann entropy can be obtained using Eqs <xref ref-type="disp-formula" rid="pcbi.1007282.e010">7</xref> and <xref ref-type="disp-formula" rid="pcbi.1007282.e011">8</xref>, i.e. <italic>E</italic><sub>sel</sub> = 〈<italic>E</italic>〉, where the average is performed using the distribution defined in Eqs <xref ref-type="disp-formula" rid="pcbi.1007282.e002">1</xref> and <xref ref-type="disp-formula" rid="pcbi.1007282.e003">2</xref>.</p>
</sec>
<sec id="sec006">
<title>Entropy of repeat protein families</title>
<p>To compare how the different elements of the energy function affect diversity, we calculate the entropy of ensembles built of two consecutive repeats from a given protein family for the different kinds of models described earlier, from the least constrained to the most constrained: <italic>E</italic><sub>rand</sub>, <italic>E</italic><sub>1</sub>, <italic>E</italic><sub>ir</sub>, <italic>E</italic><sub>ir,λ</sub>, <italic>E</italic><sub>2</sub>, <italic>E</italic><sub>full</sub>. In the case of models with interactions, calculating the entropy directly from the definition <xref ref-type="disp-formula" rid="pcbi.1007282.e013">Eq (10)</xref> is impossible due to the large sums. A previous study of entropies of protein families used an approximate mean-field algorithm, called the Adaptive Cluster Expansion [<xref ref-type="bibr" rid="pcbi.1007282.ref027">27</xref>], for both parameter fitting and entropy estimation. Here we estimated the entropies using thermodynamic integration of Monte-Carlo simulations, as detailed in Methods. This method is expected to be asymptotically unbiased and accurate in the limit of large Monte-Carlo samples.</p>
<p>The resulting entropies and their differences are reported in <xref ref-type="table" rid="pcbi.1007282.t001">Table 1</xref> and <xref ref-type="fig" rid="pcbi.1007282.g002">Fig 2</xref>. All three considered families (ankyrins (ANK), leucine-rich repeats (LRR), and tetratricopeptides (TPR)) show a large reduction in entropy (∼40 − 50%) compared to random polypeptide string models of the same length 2<italic>L</italic> (of entropy <italic>S</italic><sub>rand</sub> = 2<italic>L</italic> ln(21)). Interactions and phylogenic similarity between repeats generally have a noticeable effect on family diversity, although the magnitude of this effect depends on the family: (<italic>S</italic><sub>1</sub> − <italic>S</italic><sub>full</sub>)/<italic>S</italic><sub>full</sub> = 7% for ANK, versus, 13% for LRR, and 16% for TPR. Thus, although interactions are essential in correctly predicting the folding properties, they seem to only have a modest effect on constraining the space of accessible proteins compared to that of single amino-acid frequencies. However, when converted to numbers of sequences, this reduction is substantial, from <inline-formula id="pcbi.1007282.e014"><alternatives><graphic id="pcbi.1007282.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi mathvariant="normal">S</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:msup> <mml:mo>∼</mml:mo> <mml:mn>3</mml:mn> <mml:mo>·</mml:mo> <mml:msup><mml:mn>10</mml:mn> <mml:mn>54</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> to <inline-formula id="pcbi.1007282.e015"><alternatives><graphic id="pcbi.1007282.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>S</mml:mi> <mml:mtext>full</mml:mtext></mml:msub></mml:msup> <mml:mo>∼</mml:mo> <mml:mn>2</mml:mn> <mml:mo>·</mml:mo> <mml:msup><mml:mn>10</mml:mn> <mml:mn>50</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> for ANK, from 10<sup>39</sup> to 10<sup>34</sup> for LRR, and from 7 ⋅ 10<sup>50</sup> to 4 ⋅ 10<sup>42</sup> for TPR.</p>
<table-wrap id="pcbi.1007282.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007282.t001</object-id>
<label>Table 1</label>
<caption>
<title>Entropies (in bits, i.e. units of ln(2)) of sequences made of two consecutive repeats, for the three protein families shown in <xref ref-type="fig" rid="pcbi.1007282.g001">Fig 1</xref>.</title>
<p>Entropies are calculated for models of different complexity: model of random amino acids (<italic>S</italic><sub>rand</sub> = 2<italic>L</italic> ln(21), divided by ln(2) when expressed in bits); independent-site model (<italic>S</italic><sub>1</sub>), pairwise interaction model (<italic>S</italic><sub>2</sub>); pairwise interaction model with constraints due to repeat similarity λ<sub>ID</sub> (<italic>S</italic><sub>full</sub>); pairwise interaction model of two non-interacting repeats learned without (<italic>S</italic><sub>ir</sub>) and with (<italic>S</italic><sub>ir,λ</sub>) constraints on repeat similarity. <xref ref-type="fig" rid="pcbi.1007282.g002">Fig 2</xref> shows graphically some of the information contained in this table.</p>
</caption>
<alternatives>
<graphic id="pcbi.1007282.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007282.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">family</th>
<th align="center">2<italic>L</italic></th>
<th align="center"><italic>S</italic><sub>rand</sub></th>
<th align="center"><italic>S</italic><sub>1</sub></th>
<th align="center"><italic>S</italic><sub>2</sub></th>
<th align="center"><italic>S</italic><sub>full</sub></th>
<th align="center"><italic>S</italic><sub>ir</sub></th>
<th align="center"><italic>S</italic><sub>ir,λ</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">ANK</td>
<td align="center">66</td>
<td align="center">290</td>
<td align="center">181 ± 0.05</td>
<td align="center">169.7 ± 0.6</td>
<td align="center">167.2 ± 0.3</td>
<td align="center">176.7 ± 0.1</td>
<td align="center">172 ± 0.4</td>
</tr>
<tr>
<td align="left">LRR</td>
<td align="center">48</td>
<td align="center">211</td>
<td align="center">130 ± 0.05</td>
<td align="center">114 ± 0.4</td>
<td align="center">113.2 ± 0.3</td>
<td align="center">123.1 ± 0.1</td>
<td align="center">118.8 ± 0.1</td>
</tr>
<tr>
<td align="left">TPR</td>
<td align="center">68</td>
<td align="center">299</td>
<td align="center">169 ± 0.1</td>
<td align="center">145.4 ± 0.7</td>
<td align="center">141.4 ± 0.3</td>
<td align="center">157.6 ± 0.1</td>
<td align="center">146.9 ± 0.4</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<fig id="pcbi.1007282.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007282.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Contributions of within-repeat interactions (<italic>S</italic><sub>1</sub> − <italic>S</italic><sub>ir</sub> green), repeat-repeat interactions (<italic>S</italic><sub>ir,λ</sub> − <italic>S</italic><sub>full</sub>, purple), and phylogenic bias between consecutive repeats (<italic>S</italic><sub>ir</sub> − <italic>S</italic><sub>ir,λ</sub>, blue), to the entropy reduction from an independent-site model.</title>
<p>All three contributions are comparable, but with a larger effect of within-repeat interactions and phylogenic bias in TPR. The fourth bar (orange) quantifies the redundancy between two constraints with overlapping scopes: the constraint on consecutive-repeat similary, and the constraint on repeat-repeat correlations. This redundancy is naturally measured within information theory by the difference of impact (i.e. entropy reduction) of a constraint depending on whether or not the other constraint is already enforced.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007282.g002" xlink:type="simple"/>
</fig>
<p>By considering models with more and more constraints, and thus with lower and lower entropy, we can examine more finely the contribution of each type of correlation to the entropy reduction, going from <italic>E</italic><sub>1</sub> to <italic>E</italic><sub>ir</sub> to <italic>E</italic><sub>ir,λ</sub> to <italic>E</italic><sub>full</sub>. This division allows us to quantify the relative importance of phylogenic similarity between consecutive repeats (λ<sub>ID</sub>) relative to the impact of functional interactions (<italic>J</italic><sub><italic>ij</italic></sub>), as well as the relative weights of repeat-repeat versus within-repeat interactions (<xref ref-type="fig" rid="pcbi.1007282.g002">Fig 2</xref>). We find that phylogenic similarity contributes substantially to the entropy reduction, as measured by <italic>S</italic><sub>ir</sub> − <italic>S</italic><sub>ir,λ</sub> = 4.5 bits for ANK, 4.3 bits for LRR, and 10.7 bits for TPR. The contribution of repeat-repeat interactions (<italic>S</italic><sub>ir,λ</sub> − <italic>S</italic><sub>full</sub> ∼ 5 bits for all three families) is comparable or of the same order of magnitude as that of within-repeat interactions (<italic>S</italic><sub>1</sub> − <italic>S</italic><sub>ir</sub> = 4.3 bits for ANK, 6.9 bits for LRR, and 11.4 bits for TPR). This result emphasizes the importance of physical interactions between neighboring repeats in the whole protein.</p>
<p>On a technical note, we also find that pairwise interactions encode constraints that are largely redundant with the constraint of phylogenic similarity between consecutive repeats, as can be measured by the double difference <italic>S</italic><sub>ir</sub> − <italic>S</italic><sub>ir,λ</sub> − <italic>S</italic><sub>2</sub> + <italic>S</italic><sub>full</sub> &gt; 0 (<xref ref-type="fig" rid="pcbi.1007282.g002">Fig 2</xref>, orange bars). This redundancy comes from the fact that, in absence of an explicit constaint on <italic>P</italic>(ID) in <italic>E</italic><sub>2</sub>, the interaction couplings <italic>J</italic><sub><italic>i</italic>,<italic>i</italic>+<italic>L</italic></sub>(<italic>σ</italic>, <italic>σ</italic>) between homologous positions in the two repeats is expected to favor pairs of identical residues to mimic the effect of λ<sub>ID</sub>. This redundancy motivates the need to correct for this phylogenic bias before estimating repeat-repeat interactions.</p>
<p>Comparing the three families, ANK has little phylogenic bias between consecutive repeats, and relatively weak interactions. By contrast, TPR has a strong phylogenic bias and strong within-repeat interactions.</p>
</sec>
<sec id="sec007">
<title>Effect of interaction range</title>
<p>We wondered whether interactions constraining the space of accessible proteins had a characteristic lengthscale. To answer this question, for each protein family in <xref ref-type="fig" rid="pcbi.1007282.g001">Fig 1</xref>, we learn a sequence of models of the form <xref ref-type="disp-formula" rid="pcbi.1007282.e003">Eq 2</xref>, in which <italic>J</italic><sub><italic>ij</italic></sub> was allowed to be non-zero only within a certain interaction range <italic>d</italic>(<italic>i</italic>, <italic>j</italic>) ≤ <italic>W</italic>, where the distance <italic>d</italic>(<italic>i</italic>, <italic>j</italic>) between sites <italic>i</italic> and <italic>j</italic> can be defined in two different ways: either the linear distance |<italic>i</italic> − <italic>j</italic>| expressed in number of amino-acid sites, or the three-dimensional distance between the closest heavy atoms in the reference structure of the residues. Details about the learning procedure and error estimation are given in the Methods; see also <xref ref-type="supplementary-material" rid="pcbi.1007282.s001">S1 Fig</xref> for an alternative error estimate.</p>
<p>The entropy of all families decreases with interaction range <italic>W</italic>, both in linear and three-dimensional distance, as more constraints are added to reduce diversity (<xref ref-type="fig" rid="pcbi.1007282.g003">Fig 3</xref> for ANK, and <xref ref-type="supplementary-material" rid="pcbi.1007282.s002">S2 Fig</xref> for LRR and TPR). The initial drop as a function of linear distance (<xref ref-type="fig" rid="pcbi.1007282.g003">Fig 3A</xref>) is explained by the many local interactions between nearby residues in the sequence. The entropy then plateaus until interactions between same-position residues in consecutive repeats are included in the <italic>W</italic> range, which leads to a sharp entropy drop at <italic>W</italic> = <italic>L</italic>. This suggests that long range interactions along the sequence generally do not constrain the protein ensemble diversity, except for interactions at exactly the scale of the repeat. This result suggests that the repeat structure is an important constraint limiting protein sequence exploration. These observations hold for all three repeat protein families. The importance of 3D structure in reducing the entropy can also be appreciated in the entropy decay as a function of physical distance (<xref ref-type="fig" rid="pcbi.1007282.g003">Fig 3B</xref> for ANK) where most of the entropy drop happens within the first 10 angstroms, indicating that above this characteristic distance interactions are not crucial in constraining the space of accessible sequences.</p>
<fig id="pcbi.1007282.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007282.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Entropy reduction as a function of the range of interactions between residue sites.</title>
<p>A) Entropy of two consecutive ANK repeats, as a function of the maximum allowed interaction distance <italic>W</italic> along the linear sequence. The entropy of the model decreases as more interactions are added and they constrain the space of possible sequences. After a sharp initial decrease at short ranges, the entropy plateaus until interactions between complementary sites in neighbouring repeats lead to a secondary sharp decrease at <italic>W</italic> = <italic>L</italic> − 1 = 32 (dashed line), due to structural interactions between consecutive repeats. B) Entropy of two consecutive ANK repeats as a function of the maximum allowed three-dimensional interaction range. The entropy decreases rapidly until ∼10 Angstrom, after which decay becomes slower. In both panels entropies are averaged over 10 realizations of fitting the model; See <xref ref-type="sec" rid="sec011">Methods</xref> for details of the learning and entropy estimation procedure. Error bars are estimated from fitting errors between the data and the model; see <xref ref-type="sec" rid="sec011">Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007282.s001">S1 Fig</xref> for error bars calculated as standard deviations over 10 realizations of model fitting.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007282.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008">
<title>Multi-basin structure of the energy landscape</title>
<p>The energy function of <xref ref-type="disp-formula" rid="pcbi.1007282.e003">Eq (2)</xref> takes the same mathematical form as a disordered Potts model. These models, in particular in cases where <italic>σ</italic><sub><italic>i</italic></sub> can only take two values, have been extensively studied in the context of spin glasses [<xref ref-type="bibr" rid="pcbi.1007282.ref036">36</xref>]. In these systems, the interaction terms −<italic>J</italic><sub><italic>ij</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>, <italic>σ</italic><sub><italic>j</italic></sub>) imply contradictory energy requirements, meaning that not all of these terms can be minimized at the same time—a phenomenon called frustration. Because of frustration, natural dynamics aimed at minimizing the energy are expected to get stuck into local, non-global energy minima (<xref ref-type="fig" rid="pcbi.1007282.g004">Fig 4</xref>), significantly slowing down thermalization. This phenomenon is similar to what happens in structural glasses in physics, where the energy landscape is “rugged” with many local minima that hinder the dynamics. Incidentally, concepts from glasses and spin glasses have been very important for understanding protein folding dynamics [<xref ref-type="bibr" rid="pcbi.1007282.ref037">37</xref>].</p>
<fig id="pcbi.1007282.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007282.g004</object-id>
<label>Fig 4</label>
<caption>
<title>A rugged energy landscape is characterized by the presence of local minima, where proteins sequences can get stuck during the evolutionary process.</title>
<p>The set of sequences that evolve to a given local minimum defines the <italic>basin of attraction</italic> of that mimimum.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007282.g004" xlink:type="simple"/>
</fig>
<p>We asked whether the energy landscape of <xref ref-type="disp-formula" rid="pcbi.1007282.e003">Eq (2)</xref> was rugged with multiple minima, and investigated its structure. To find local minima, we performed a local energy minimization of <italic>E</italic><sub>full</sub> (learned with all constraints including on <italic>P</italic>(ID), but taken with λ<sub>ID</sub> = 0 to focus on functional energy terms). By analogy with glasses, such a minimization is sometimes called a zero-temperature Monte-Carlo simulation or a “quench”. The minimization procedure was started from many initial conditions corresponding to naturally occuring sequences of consecutive repeat pairs. At each step of the minimization, a random beneficial (energy decreasing) single mutation is picked; double mutations are allowed if they correspond to twice the same single mutation on each of the two repeats. Minimization stops when there are no more beneficial mutations. This stopping condition defines a local energy minimum, for which any mutation increases the energy. The set of sequences which, when chosen as initial conditions, lead to a given local minimum defines the <italic>basin of attraction</italic> of that energy mimimum (<xref ref-type="fig" rid="pcbi.1007282.g004">Fig 4</xref>). The size of a basin corresponds to the number of natural proteins belonging to that basin.</p>
<p>Performing this procedure on natural sequences of consecutive repeat pairs from all three families yielded a large number of local minima (<xref ref-type="fig" rid="pcbi.1007282.g005">Fig 5</xref>). To control for the phylogenetic bias that links natural sequences, we repeated this analysis on sequences synthetically generated from the model (<italic>E</italic><sub>full</sub>), and obtained very similar results (see <xref ref-type="supplementary-material" rid="pcbi.1007282.s006">S6 Fig</xref> for ANK). When ranked from largest to smallest, the distribution of basin sizes follows a power law (<xref ref-type="fig" rid="pcbi.1007282.g005">Fig 5A</xref> for ANK and <xref ref-type="supplementary-material" rid="pcbi.1007282.s003">S3A</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007282.s004">S4A</xref> Figs for LRR and TPR). The energy of the minimum of each basin generally increases with the rank, meaning that largest basins are also often the lowest. Despite this multiplicity of local minima, the Monte-Carlo dynamics that we used in previous sections for learning the model parameters and for estimating the entropy did not get stuck in these minima, suggesting relatively low energy barriers between them.</p>
<fig id="pcbi.1007282.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007282.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Interactions within and between repeats sculpt a rugged energy landscape with many local minima.</title>
<p>Local minima were obtained by performing a zero-temperature Monte-Carlo simulation with the energy function in <xref ref-type="disp-formula" rid="pcbi.1007282.e003">Eq (2)</xref>, starting from initial conditions corresponding to naturally occurring sequences of pairs of consecutive ANK repeats. A, bottom) Rank-frequency plot of basin sizes, where basins are defined by the set of sequences falling into a particular minimum. A, top) energy of local minima <italic>vs</italic> the size-rank of their basin, showing that larger basins often also have lowest energy. Gray line indicates the energy of the consensus sequence, for comparison. B) Pairwise distance between the minima with the largest basins (comprising 90% of natural sequences), organised by hierarchical clustering. The panel right above the matrix shows the size of the basins relative to the minima corresponding to the entries of the distance matrix. A clear block structure emerges, separating different groups of basins with distinct sequences. C-D) Same as A) and B) but for single repeats. Since single repeats are shorter than pairs (length <italic>L</italic> instead of 2<italic>L</italic>), they have fewer local energy minima, yet still show a rich multi-basin structure. Equivalent analyses for LRR and TPR are shown in <xref ref-type="supplementary-material" rid="pcbi.1007282.s003">S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007282.s004">S4</xref> Figs.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007282.g005" xlink:type="simple"/>
</fig>
<p>The partition of sequences into basins allows for the definition of a new kind of entropy <italic>S</italic><sub>conf</sub> = −∑<sub><italic>b</italic></sub> <italic>P</italic>(<italic>b</italic>) ln <italic>P</italic>(<italic>b</italic>) called configurational entropy, based on the distribution of basin sizes, <italic>P</italic>(<italic>b</italic>) = ∑<sub><bold><italic>σ</italic></bold>∈<italic>b</italic></sub> <italic>P</italic>(<bold><italic>σ</italic></bold>), where <bold><italic>σ</italic></bold> ∈ <italic>b</italic> means that energy minimization starting with sequence <bold><italic>σ</italic></bold> leads to basin <italic>b</italic>. This configurational entropy measures the effective diversity of basins, and is thus much lower than the sequence entropy <italic>S</italic><sub>full</sub>, while the difference <italic>S</italic><sub>full</sub> − <italic>S</italic><sub>conf</sub> measures the average diversity of sequences within each basin. We find <italic>S</italic><sub>conf</sub> = 5.1 bits for ANK, 6.0 bits for LRR, and 10.4 bits for TPR. As each basin corresponds to a distinct sub-family within each family [<xref ref-type="bibr" rid="pcbi.1007282.ref032">32</xref>], this entropy quantifies the effective number of these subgroups.</p>
<p>While basins are very numerous, they are also not independent of each other. An analysis of pairwise distances (measured as the Hamming distance between the local minima) between the largest basins reveals that they can be organised into clusters (panels B of <xref ref-type="fig" rid="pcbi.1007282.g005">Fig 5</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007282.s003">S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007282.s004">S4</xref> Figs), suggesting a hierarchical structure of basins, as is common in spin glasses [<xref ref-type="bibr" rid="pcbi.1007282.ref036">36</xref>].</p>
<p>The impact of repeat-repeat interactions on the multi-basin structure can be assessed by repeating the analysis on the model of non-interacting repeats, <italic>E</italic><sub>ir</sub>. In that model the two repeats are independent, so it suffices to study local energy minima of single repeats—local minima of pairs of repeats follow simply from the combinatorial pairing of local minima in each repeat. The analyses of basin size distributions, energy minima, and pairwise distances in single repeats are shown in panels C and D of <xref ref-type="fig" rid="pcbi.1007282.g005">Fig 5</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007282.s003">S3</xref>, and <xref ref-type="supplementary-material" rid="pcbi.1007282.s004">S4</xref> Figs. We still find a substantial number of unrelated energy minima, suggesting again several distinct subfamilies even at the single-repeat level. For comparison, the configurational entropy of pairs of independent repeats is 6.9 bits for ANK, 6.7 for LRR, and 7.6 for TPR. While for ANK and LRR repeat-repeat interactions decrease the configurational entropy, as they do for the conventional entropy, they in fact increase entropy for TPR, making the energy landscape even more frustrated and rugged.</p>
<p>Note that the independent sites model <italic>E</italic><sub>1</sub> defines a convex energy landscape with a single local minimum—the consensus sequence—as all constraints <italic>h</italic><sub><italic>i</italic></sub> can be optimized independently. To address how the interactions contribute in shaping the sequence space, going from a convex to a rugged landscape, we repeated the analysis with a limited linear interaction range <italic>W</italic> of 3 and 10 (models of <xref ref-type="fig" rid="pcbi.1007282.g003">Fig 3A</xref>). We find that the more interactions we add, the more local minima we find (<xref ref-type="supplementary-material" rid="pcbi.1007282.s005">S5A and S5B Fig</xref> for ANK with <italic>W</italic> = 3, and C and D for <italic>W</italic> = 10). The minima cluster into clearer sub-blocks structure as the interaction range is increased, consistent with the entropy reduction observed in <xref ref-type="fig" rid="pcbi.1007282.g003">Fig 3A</xref>.</p>
<p>In summary, the analysis of the energy landscape reveals a rich structure, with many local minima ranging many different scales, and with a hierarchical structure between them.</p>
</sec>
<sec id="sec009">
<title>Distance between repeat families</title>
<p>Lastly, we compared the statistical energy landscapes of different repeat families. Specifically, we calculated the Kullback-Leibler divergence between the probability distributions <italic>P</italic>(<bold><italic>σ</italic></bold>) (given by Eqs <xref ref-type="disp-formula" rid="pcbi.1007282.e002">1</xref> and <xref ref-type="disp-formula" rid="pcbi.1007282.e003">2</xref>) of two different families, after aligning them together in a single multiple sequence alignment (see <xref ref-type="sec" rid="sec011">Methods</xref>).</p>
<p>We find essentially no similarity between ANK and TPR, despite them having similar lengths: <italic>D</italic><sub>KL</sub>(ANK||TPR) = 227.6 bits, and <italic>D</italic><sub>KL</sub>(TPR||ANK) = 214.1 bits. These values are larger than the Kullback-Leibler divergence between the full models for these families and a random polypetide, <italic>D</italic><sub>KL</sub>(ANK||rand) = 122.8 bits, and <italic>D</italic><sub>KL</sub>(TPR||rand) = 157.6 bits. LRR is not comparable to ANK or TPR as it is much shorter, and a common alignment is impractical. These large divergences between families of repeat proteins show that different families impose quantifiably different constraints, which have forced them to diverge into different troughs of non-overlapping energy landscapes. This lack of overlap makes it impossible to find intermediates between the two families that could evolve into proteins belonging to both families.</p>
</sec>
</sec>
<sec id="sec010" sec-type="conclusions">
<title>Discussion</title>
<p>Our analysis of repeat protein families shows that the constraints between amino acids in the sequences allows for an estimation of the size of the accessible sequence space. The obtained numbers (ranging from 141 bits to 167 bits, corresponding to 10<sup>36</sup> to 10<sup>50</sup> sequences) are of course huge compared to the number of sequences in our initial samples (∼20, 500 for ANK, ∼18, 800 for LRR, and ∼10, 000 for TPR), but comparable to the total number of proteins having been explored over the whole span of evolution, estimated to be 10<sup>43</sup> in Ref. [<xref ref-type="bibr" rid="pcbi.1007282.ref001">1</xref>].</p>
<p>In particular, we have quantified the reduction of the accessible sequence space with respect to random polypeptides. While most of this reduction is attributable to conservation of residues at each site, interactions between amino acids, both within and between consecutive repeats, significantly constrain the diversity of all repeat families. The break-up of entropy reduction between the three different sources of constraints—within-repeat interactions, between-repeat interactions, and evolutionary conservation between consecutive repeats—is fairly balanced, although TPR stands out as having more within-repeat interactions and more conservation between neighbours, suggesting that it may have had less time to equilibrate.</p>
<p>All studied repeat families have rugged energy landscapes with multiple local energy minima. Note that the emergence of this multi-valley landscape is a consequence of the interactions between amino acids: models of independent positions (<italic>E</italic><sub>1</sub>) only admit a single energy minimum corresponding to the consensus sequence. This multiplicity of minima allow us to collapse multiple sequences to a small number of coarse-grained attractor basins. These basins suggest that mutations between sequences within one coarse-grained basin are much more likely than mutating into sequences in other basins. In general, our results paint a picture of further subdivisions within a family, and define sub-families due to the fine grained interaction structure. Going beyond single families, this analysis suggest a view in which natural proteins all live in a global evolutionary landscape, of which families would be basins, or clusters of basins, with a hierarchical structure [<xref ref-type="bibr" rid="pcbi.1007282.ref032">32</xref>].</p>
<p>This overall picture of the sequence energy landscape is reminiscent of the hierarchical picture of the structural energy landscape of globular proteins, an overall funneled shape with tiers within tiers [<xref ref-type="bibr" rid="pcbi.1007282.ref038">38</xref>]. The form of the energy landscape forcibly shapes the accessible evolutionary paths between sequences. The rugged and further subdivided structure shows that the uncovered constraints are global, and not just pairwise between specific residues. Therefore even changing two residues together, as is often done in laboratory experiments, is not enough to recover the evolutionary trajectories. While other approaches have explored local accessible directions of evolution [<xref ref-type="bibr" rid="pcbi.1007282.ref039">39</xref>], our results suggest more global, non local modes of evolution between clusters.</p>
<p>Interestingly, the sequences that correspond to the energy minima of the landscapes are not found in the natural dataset. This observation can be either due to sampling bias (we have not yet observed the sequence with the minimal energy, although it exists), or this sequence may not have been sampled by nature. Alternatively, there may be additional functional constraint that are not included in our model to avoid these low energy sequences (e.g. a too stable protein may be difficult to degrade).</p>
<p>Even more intriguingly, sequences with minimal energy do not correspond to the consensus sequence of the alignment (whose energy is marked by a gray line in panel A of <xref ref-type="fig" rid="pcbi.1007282.g005">Fig 5</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007282.s003">S3</xref>, and <xref ref-type="supplementary-material" rid="pcbi.1007282.s004">S4</xref> Figs), suggesting that the consensus sequence can be improved upon. All three repeat protein families studied here have been shown to be amenable to simple consensus-guided design of synthetic proteins. Synthetic proteins based on the consensus sequences of multiple alignments [<xref ref-type="bibr" rid="pcbi.1007282.ref040">40</xref>] were found to be foldable and very stable against chemical and thermal denaturation. Mutations towards consensus amino acids in the ANK family members have been experimentally shown to both stabilize the whole repeat-array and they may tune the folding paths towards nucleating folding in the consensus sites [<xref ref-type="bibr" rid="pcbi.1007282.ref041">41</xref>, <xref ref-type="bibr" rid="pcbi.1007282.ref042">42</xref>]. Our results suggest that interactions may play an additional role in stabilizing the sequences, and propose alternative solutions to the consensus sequences in the design of synthetic proteins.</p>
</sec>
<sec id="sec011" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec012">
<title>Data curation</title>
<p>We use a previously curated alignment of pairs of repeats for each family [<xref ref-type="bibr" rid="pcbi.1007282.ref017">17</xref>]: ANK (PFAM id PF00023 with a final alignment of 20513 sequences of <italic>L</italic> = 66 residues each), LRR (PFAM id PF13516 with a final alignment of 18839 sequences of <italic>L</italic> = 48 residues each) and TPR (PFAM id PF00515 with a final alignment of 10020 sequences of <italic>L</italic> = 68 residues each). Those multiple sequence alignments of repeats were obtained from PFAM 27.0 [<xref ref-type="bibr" rid="pcbi.1007282.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1007282.ref007">7</xref>]. In order to improve the data obtained from the PFAM database, we used original full protein sequences available in UniProt database [<xref ref-type="bibr" rid="pcbi.1007282.ref043">43</xref>] to add available information using the headers of the original alignement. Firstly, to decrease the number of gaps positions, misdetected initial and final amino acids in repeats were completed with residues from full sequences. Secondly, individual repeats which appeared consecutively in natural proteins were joined into pairs. Finally, positions with more than 80% of gaps along the alignment were removed, eliminating in this way insertions.</p>
<p>From the multiple sequence alignement of each family, they were calculated the observables that we use to constrain our statistical model. Particularly, we calculated the marginal frequency <italic>f</italic><sub><italic>i</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>) of an amino acid <italic>σ</italic><sub><italic>i</italic></sub> at position <italic>i</italic> and the joint frequency <italic>f</italic><sub><italic>ij</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>, <italic>σ</italic><sub><italic>j</italic></sub>) of two amino acids <italic>σ</italic><sub><italic>i</italic></sub> and <italic>σ</italic><sub><italic>j</italic></sub> at two different positions <italic>i</italic> and <italic>j</italic>. These quantities were calculated using only sequences selected by clustering at 90% of identity computed with CD-HIT [<xref ref-type="bibr" rid="pcbi.1007282.ref044">44</xref>] and then normalizing by the amount of sequences. In this way, the occurrences of residues in every position are not biased by overrepresentation of proteins in the database. Furthermore, to take into account the repeated nature of the protein families that we are considering, an additional observable was calculated, the distribution of sequence overlap between two consecutive repeats, <italic>P</italic>(ID(<bold><italic>σ</italic></bold>)), with <inline-formula id="pcbi.1007282.e016"><alternatives><graphic id="pcbi.1007282.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:mtext>ID</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:msubsup> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec013">
<title>Model fitting</title>
<p>In order to obtain a model that reproduces the experimentally observed site-dependent amino-acid frequencies, <italic>f</italic><sub><italic>i</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>), correlations between two positions, <italic>f</italic><sub><italic>ij</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>, <italic>σ</italic><sub><italic>j</italic></sub>), and the distribution of Hamming distances between consecutive repeats, <italic>P</italic>(ID(<bold><italic>σ</italic></bold>)), we apply a likelihood gradient ascent procedure, starting from an initial guess of the <italic>h</italic><sub><italic>i</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>), <italic>J</italic><sub><italic>ij</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>, <italic>σ</italic><sub><italic>j</italic></sub>) and λ<sub>ID</sub>(<bold><italic>σ</italic></bold>) parameters.</p>
<p>At each step, we generate 80000 sequences of length 2<italic>L</italic> through a Metropolis-Hastings Monte-Carlo sampling procedure. We start from a random amino-acid sequence and we produce many point mutations in any position, one at a time. If a mutation decreases the energy <xref ref-type="disp-formula" rid="pcbi.1007282.e003">(2)</xref> we accept it. If not, we accept the mutation with probability <italic>e</italic><sup>−Δ<italic>E</italic></sup>, where Δ<italic>E</italic> is the difference of energy between the original and the mutated sequence. We add one sequence to our final ensemble every 1000 steps. Once we generated the sequence ensemble, we measure its marginals <inline-formula id="pcbi.1007282.e017"><alternatives><graphic id="pcbi.1007282.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>model</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007282.e018"><alternatives><graphic id="pcbi.1007282.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mtext>model</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, as well as <italic>P</italic><sup>model</sup>(ID(<bold><italic>σ</italic></bold>)), and update the parameters of <xref ref-type="disp-formula" rid="pcbi.1007282.e003">Eq 2</xref> following the gradient of the likelihood. The local field and λ<sub>ID</sub>(<bold><italic>σ</italic></bold>) are updated along the gradient of the per-sequence log-likelihood, equal to the difference between model and data averages:
<disp-formula id="pcbi.1007282.e019"><alternatives><graphic id="pcbi.1007282.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>h</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>←</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>t</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>model</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula> <disp-formula id="pcbi.1007282.e020"><alternatives><graphic id="pcbi.1007282.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mtext>ID</mml:mtext></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>←</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mtext>ID</mml:mtext></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>t</mml:mi></mml:msup> <mml:mo>-</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mtext>ID</mml:mtext></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>ID</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi mathvariant="normal">P</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mtext>ID</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>model</mml:mtext></mml:msup> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula></p>
<p>As the number of parameters for the interaction terms <italic>J</italic><sub><italic>ij</italic></sub> is large (= 21<sup>2</sup> <italic>L</italic><sup>2</sup>), we force to 0 those that are not contributing significantly to the model frequencies through a <italic>L</italic><sub>1</sub> regularisation <italic>γ</italic>∑<sub><italic>ij</italic>, <italic>σ</italic>, <italic>τ</italic></sub>|<italic>J</italic><sub><italic>ij</italic></sub>(<italic>σ</italic>, <italic>τ</italic>)| added to the likelihood. This leads to the following rules of maximization: If <italic>J</italic><sub><italic>ij</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>, <italic>σ</italic><sub><italic>j</italic></sub>)<sup><italic>t</italic></sup> = 0 and <inline-formula id="pcbi.1007282.e021"><alternatives><graphic id="pcbi.1007282.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mtext>model</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>&lt;</mml:mo> <mml:mi>γ</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> <disp-formula id="pcbi.1007282.e022"><alternatives><graphic id="pcbi.1007282.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>←</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula></p>
<p>If <italic>J</italic><sub><italic>ij</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>, <italic>σ</italic><sub><italic>j</italic></sub>)<sup><italic>t</italic></sup> = 0 and <inline-formula id="pcbi.1007282.e023"><alternatives><graphic id="pcbi.1007282.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mtext>model</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>&gt;</mml:mo> <mml:mi>γ</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
<disp-formula id="pcbi.1007282.e024"><alternatives><graphic id="pcbi.1007282.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mrow><mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>←</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo></mml:mrow> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mtext>model</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>γ</mml:mi> <mml:mtext>sign</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mtext>model</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula></p>
<p>If <inline-formula id="pcbi.1007282.e025"><alternatives><graphic id="pcbi.1007282.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>t</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mtext>model</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>γ</mml:mi> <mml:mtext>sign</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>t</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>t</mml:mi></mml:msup> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
<disp-formula id="pcbi.1007282.e026"><alternatives><graphic id="pcbi.1007282.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mrow><mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>←</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>t</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo></mml:mrow> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mtext>model</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>γ</mml:mi> <mml:mtext>sign</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>t</mml:mi></mml:msup> <mml:mo>)</mml:mo> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(15)</label></disp-formula></p>
<p>If <inline-formula id="pcbi.1007282.e027"><alternatives><graphic id="pcbi.1007282.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>t</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mtext>model</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>γ</mml:mi> <mml:mtext>sign</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>t</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>t</mml:mi></mml:msup> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> <disp-formula id="pcbi.1007282.e028"><alternatives><graphic id="pcbi.1007282.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>←</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula></p>
<p>The optimization parameters were set to: <italic>ϵ</italic><sub><italic>m</italic></sub> = 0.1, <italic>ϵ</italic><sub><italic>j</italic></sub> = 0.05, <italic>ϵ</italic><sub>ID</sub> = 10, and <italic>γ</italic> = 0.001.</p>
<p>To estimate the model error, we compute <inline-formula id="pcbi.1007282.e029"><alternatives><graphic id="pcbi.1007282.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>model</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007282.e030"><alternatives><graphic id="pcbi.1007282.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mtext>model</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. We also calculate the difference of generated and natural repeat similarity distribution for all the possible repeats Hamming distances, penalized by a factor 5 to better learn the parameter λ<sub>ID</sub>: 5(<italic>P</italic>(ID(<bold><italic>σ</italic></bold>)) − <italic>P</italic>(ID(<bold><italic>σ</italic></bold>))<sup>model</sup>). We repeat the procedure above until the maximum of all errors, <inline-formula id="pcbi.1007282.e031"><alternatives><graphic id="pcbi.1007282.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>f</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>model</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1007282.e032"><alternatives><graphic id="pcbi.1007282.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mtext>model</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and 5|<italic>P</italic>(ID(<bold><italic>σ</italic></bold>)) − <italic>P</italic>(ID(<bold><italic>σ</italic></bold>))<sup>model</sup>|, goes below 0.02, as in Ref. [<xref ref-type="bibr" rid="pcbi.1007282.ref017">17</xref>].</p>
</sec>
<sec id="sec014">
<title>Models with different sets of constraints</title>
<p>Using this procedure we can calculate the model defined in <xref ref-type="disp-formula" rid="pcbi.1007282.e003">Eq 2</xref> with different interaction ranges used in the entropy estimation in <xref ref-type="fig" rid="pcbi.1007282.g003">Fig 3A</xref>. We start from the independent model <italic>h</italic><sub><italic>i</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>) = log <italic>f</italic><sub><italic>i</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>). We first learn the model in <xref ref-type="disp-formula" rid="pcbi.1007282.e003">Eq 2</xref> with <italic>J</italic> = 0. We then re-learn models with interactions between sites <italic>i</italic>, <italic>j</italic> along the linear sequence such that |<italic>i</italic> − <italic>j</italic>| ≤ <italic>W</italic>, in a seeded way starting from the previous model. The first and last point of <xref ref-type="fig" rid="pcbi.1007282.g003">Fig 3</xref> correspond to the independent site model with λ<sub>ID</sub> and the full model in <xref ref-type="disp-formula" rid="pcbi.1007282.e003">Eq 2</xref></p>
<p>The entropy in <xref ref-type="fig" rid="pcbi.1007282.g003">Fig 3B</xref> is calculated in the same way as in <xref ref-type="fig" rid="pcbi.1007282.g003">Fig 3</xref>, but now interactions are turned on progressively according to physical distance in the 3D structure rather than the linear sequence distance. In order to obtain the physical distance between residues we use as a reference structure the first two repeats of a consensus designed ankyrin protein 1n0r [<xref ref-type="bibr" rid="pcbi.1007282.ref045">45</xref>, <xref ref-type="bibr" rid="pcbi.1007282.ref046">46</xref>], which have exactly 66 amino-acids. We define the 3D separation between two residues as the minimum distance between their heavy atoms in the reference structure.</p>
<p>To learn the Potts model without λ<sub>ID</sub> (<italic>E</italic><sub>2</sub>) we remove λ<sub>ID</sub> from <xref ref-type="disp-formula" rid="pcbi.1007282.e003">Eq 2</xref> and re-learn the Potts field using the full model parameters as initial contition.</p>
<p>To learn the single repeat models with and without λ (<italic>E</italic><sub>ir</sub> and <italic>E</italic><sub>ir,λ</sub>, we take as initial condition the model with interactions below the length of a repeat (<italic>W</italic> = <italic>L</italic> − 1, dashed vertical line in <xref ref-type="fig" rid="pcbi.1007282.g003">Fig 3</xref>), and then learn a model removing all the <italic>J</italic><sub><italic>ij</italic></sub> terms between different repeats. We also impose that the <italic>h</italic><sub><italic>i</italic></sub> fields and intra-repeats <italic>J</italic><sub><italic>ij</italic></sub> terms are the same in each repeat, and the experimental amino-acid frequencies to be reproduced by the model are the average over the two repeats of the 1- and 2-points intra-repeats frequencies <italic>f</italic><sub><italic>i</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>) and <italic>f</italic><sub><italic>ij</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>, <italic>σ</italic><sub><italic>j</italic></sub>), such that
<disp-formula id="pcbi.1007282.e033"><alternatives><graphic id="pcbi.1007282.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi> <mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>(</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
and
<disp-formula id="pcbi.1007282.e034"><alternatives><graphic id="pcbi.1007282.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
if <italic>i</italic> and <italic>j</italic> represent sites within the same repeat. In this way we obtain a model for a single repeat that can be extended to both the repeats in the original set of sequences of our dataset.</p>
</sec>
<sec id="sec015">
<title>Entropy estimation</title>
<p>In practice to calculate the entropy <italic>S</italic> of the protein families we relate it to the internal energy <italic>E</italic> = −log <italic>p</italic>(<bold><italic>σ</italic></bold>) and the free energy <italic>F</italic> = −log <italic>Z</italic>:
<disp-formula id="pcbi.1007282.e035"><alternatives><graphic id="pcbi.1007282.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mi>S</mml:mi></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>⟨</mml:mo> <mml:mi>E</mml:mi> <mml:mo>⟩</mml:mo> <mml:mo>-</mml:mo> <mml:mi>F</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi></mml:munder> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>E</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>Z</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi></mml:munder> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula></p>
<p>We generate sequences according to the energy function in <xref ref-type="disp-formula" rid="pcbi.1007282.e003">Eq 2</xref> and use them to numerically compute 〈<italic>E</italic>〉. To calculate the free energy we use the auxilliary energy function:
<disp-formula id="pcbi.1007282.e036"><alternatives><graphic id="pcbi.1007282.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>E</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msub><mml:mi>h</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>α</mml:mi> <mml:mo>[</mml:mo> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mtext>ID</mml:mtext></mml:msub> <mml:mo>]</mml:mo> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula>
where the interaction strength across different sites can be tuned through a parameter <italic>α</italic> that is changed from 0 to 1. We generate protein sequence ensembles with different values of <italic>α</italic> and use them to calculate <italic>F</italic> as a function of <italic>α</italic>, <inline-formula id="pcbi.1007282.e037"><alternatives><graphic id="pcbi.1007282.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mn>1</mml:mn></mml:msubsup> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>α</mml:mi> <mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>F</mml:mi></mml:mrow> <mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>α</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1007282.e038"><alternatives><graphic id="pcbi.1007282.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mn>1</mml:mn></mml:msubsup> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>α</mml:mi> <mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mtext>ID</mml:mtext></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>α</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula>
where the average over <italic>α</italic> is taken over the sequences generated with a certain value of <italic>α</italic>, characterized by the ensemble with probability <inline-formula id="pcbi.1007282.e039"><alternatives><graphic id="pcbi.1007282.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. <italic>F</italic>(0) is the free energy for an independent sites model:
<disp-formula id="pcbi.1007282.e040"><alternatives><graphic id="pcbi.1007282.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:munder> <mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow> <mml:mrow><mml:msub><mml:mi>h</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
where the first sum is taken over protein sites and the second over all possible amino-acids at a given site. Eqs <xref ref-type="disp-formula" rid="pcbi.1007282.e040">22</xref> and <xref ref-type="disp-formula" rid="pcbi.1007282.e035">19</xref> result in the thermodynamic sampling approximation for calculating the entropy [<xref ref-type="bibr" rid="pcbi.1007282.ref047">47</xref>]:
<disp-formula id="pcbi.1007282.e041"><alternatives><graphic id="pcbi.1007282.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>⟨</mml:mo> <mml:mi>E</mml:mi> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:munder> <mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow> <mml:mrow><mml:msub><mml:mi>h</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mn>1</mml:mn></mml:msubsup> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>α</mml:mi> <mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mtext>ID</mml:mtext></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>α</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula></p>
<p>We generate 80000 sequences using Monte Carlo sampling for the energy in <xref ref-type="disp-formula" rid="pcbi.1007282.e036">Eq 20</xref> with 50 different <italic>α</italic> values, equally spaced between 0 and 1 at a distance of 0.02, and then numerically compute the integral in <xref ref-type="disp-formula" rid="pcbi.1007282.e041">Eq 23</xref> using the Simpson rule.</p>
</sec>
<sec id="sec016">
<title>Entropy error</title>
<p>The entropy estimate is subject to three sources of uncertainty: the finite-size of the dataset, convergence of parameter learning, and the noise in the thermodynamic integration. We estimate the contribution of each of these errors using the independent sites model. In the independent sites model each site <italic>i</italic> is simply described by a multinomial distribution with weights given by the observed amino-acid frequencies in the datasets. The variance in the estimation of the frequencies from a finite size sample is Var(<italic>f</italic><sub><italic>i</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>)) = (<italic>p</italic><sub><italic>i</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>)(1 − <italic>p</italic><sub><italic>i</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>)))/<italic>N</italic><sub><italic>s</italic></sub> and the covariance between the frequencies of different amino-acids <italic>σ</italic> and <italic>σ</italic>′ at the same site <italic>i</italic> is <inline-formula id="pcbi.1007282.e042"><alternatives><graphic id="pcbi.1007282.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:mtext>Cov</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>/</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> where <italic>N</italic><sub><italic>s</italic></sub> is the sample size and <italic>p</italic><sub><italic>i</italic></sub>(<italic>σ</italic><sub><italic>i</italic></sub>) are the weights of the true multinomial distribution sampled. Through error propagation from these quantities we calculate the variance in the entropy of the independent sites model, to first order in 1/<italic>N</italic><sub><italic>s</italic></sub>:
<disp-formula id="pcbi.1007282.e043"><alternatives><graphic id="pcbi.1007282.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Var</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>d</mml:mi> <mml:mi>e</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>N</mml:mi> <mml:mi>s</mml:mi></mml:msub></mml:mfrac> <mml:mo>[</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:munder><mml:mo>∑</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo form="prefix">log</mml:mo> <mml:msup><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>S</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>d</mml:mi> <mml:mi>e</mml:mi> <mml:mi>p</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo> <mml:mi>O</mml:mi> <mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msubsup><mml:mi>N</mml:mi> <mml:mi>s</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mo>)</mml:mo> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula></p>
<p>Evaluating this equation using the empirical frequencies <italic>p</italic> = <italic>f</italic> assuming they are sampled from an underlying multinomial distribution, gives an estimate of the standard deviation of 0.05. We assume that the interaction terms do not change the order of magnitude of this estimation. Also the standard deviation in the averages in <xref ref-type="disp-formula" rid="pcbi.1007282.e041">Eq (23)</xref> scales as <inline-formula id="pcbi.1007282.e044"><alternatives><graphic id="pcbi.1007282.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msqrt><mml:msub><mml:mi>N</mml:mi> <mml:mi>s</mml:mi></mml:msub></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> with <italic>N</italic><sub><italic>s</italic></sub> = 80000.</p>
<p>The parameter inference is affected not only by noise, but also by a systematic bias depending on the parameters of the gradient ascent described above and the initial condition that we chose to start learning from. <xref ref-type="supplementary-material" rid="pcbi.1007282.s001">S1 Fig</xref> shows the average entropy of 10 realizations of the learning and thermodynamic integration procedure for the ANK family and its standard deviation as error bars. If we learn the models with an increasing <italic>W</italic> window progressively we get a different profile than learning each point starting from the independent model, and above <italic>L</italic> these two profiles are more distant than the magnitude of the standard deviation, signalling a systematic bias. <xref ref-type="supplementary-material" rid="pcbi.1007282.s001">S1 Fig</xref> also shows that progressively learning the model results in a better parameters convergence to values that give lower entropy values.</p>
<p>In order to estimate how this bias is reflected in the entropy estimation we take the single-site amino-acid frequencies produced by the inferred energy function in the last Monte-Carlo phase of the learning procedure and calculate the corresponding entropy for this independent-sites model. We compute the absolute value of the difference between this estimate of the entropy and the independent-sites entropy calculated from the dataset. Again in doing this we assume that neglecting the interaction terms does not change the order of magnitude of this error. These procedure results in the errorbars shown in Figs <xref ref-type="fig" rid="pcbi.1007282.g003">3</xref> and <xref ref-type="fig" rid="pcbi.1007282.g002">2</xref>, <xref ref-type="table" rid="pcbi.1007282.t001">Table 1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007282.s002">S2 Fig</xref>.</p>
<p>We repeat 10 realizations of both the parameter inference procedure and the entropy estimation, and in <xref ref-type="fig" rid="pcbi.1007282.g003">Fig 3</xref> we show the average entropy of these 10 numerical experiments for the ANK family where error bars are estimated as explained above to sketch the order of magnitude of the error coming from systematic bias in the parameters learning. <xref ref-type="supplementary-material" rid="pcbi.1007282.s001">S1 Fig</xref> shows the mean entropy of ANK as in <xref ref-type="fig" rid="pcbi.1007282.g003">Fig 3A</xref> with the standard deviations of the realizations entropy as error bars, to give an idea of the combined noise in the thermodynamic integration and in the gradient descent, starting from the same initial conditions and with the same update parameters (see Section). The combined noise is smaller than the entropy decrease at 33 residues, showing the decrease is real.</p>
<p>To further check the robustness of the entropy estimation procedure, we generate two synthetic ANK datasets, one with an independent sites model, the other with a model of two non-interacting repeats obtained as explained above, and relearn the model from the synthetic datasets. Repeating the learning and entropy estimation procedure on each on the synthetic protein families gives results that are consistent with the model used for the dataset generation. The entropy of the model learned taking an independent sites dataset does not decrease with the interaction range <italic>W</italic> and the entropy of the model learned taking a non-interacting repeats dataset does not show any drop around the repeat length.</p>
<p>We repeat the procedure described for the LRR and TPR repeat-proteins families reaching similar conclusions (<xref ref-type="supplementary-material" rid="pcbi.1007282.s002">S2 Fig</xref>).</p>
</sec>
<sec id="sec017">
<title>Calculating the basins of attraction of the energy landscape</title>
<p>In order to characterize the ruggedness of the inferred energy landscapes and the sequence identity of the local minima, we start from all the sequences in the natural dataset as initial conditions and for each of them we perform a <italic>T</italic> = 0 quenched Monte-Carlo procedure. Repeating this analysis on sequences synthetically generated from <italic>E</italic><sub>full</sub> yields very similar results (see <xref ref-type="supplementary-material" rid="pcbi.1007282.s006">S6 Fig</xref> for ANK)</p>
<p>We perform this energy landscape exploration learning the parameters of the Hamiltonian in <xref ref-type="disp-formula" rid="pcbi.1007282.e003">Eq 2</xref> (refer to Section for the learning procedure), and then set λ<sub>ID</sub> = 0 in the energy function because we want to investigate the shape of the energy landscape due to selection rather than the phylogenic dependence.</p>
<p>We scan all the possible mutations that decrease the sequence energy and then draw one of them from a uniform random distribution. The possible mutations are all single point mutations. If the same amino-acid is present in the same relative position in the two repeats we allow for double mutations that mutate those two positions to a new amino-acid, that is identical in both repeats, at the same time. We do this so that the phylogenetic biases that are still partially present in the parameters of the model do not result in spurious local minima biasing the quenching results. The Monte-Carlo procedure ends when every proposed move results in a sequence with an increased energy, and the identified sequence is a local minimum of the energy landscape.</p>
<p>To explore how turning on interactions makes the energy landscape more rugged, we perform the same procedure with the Hamiltonian corresponding to two intermediate interaction ranges in <xref ref-type="fig" rid="pcbi.1007282.g003">Fig 3A</xref>. That is <xref ref-type="disp-formula" rid="pcbi.1007282.e003">Eq 2</xref>, in which <italic>J</italic><sub><italic>ij</italic></sub> was allowed to be non-zero only within a certain interaction range <italic>W</italic>. We picked <italic>W</italic> = 3 and <italic>W</italic> = 10.</p>
<p>In order to assess what is the role of the inter-repeat interactions we repeat this <italic>T</italic> = 0 quenched Monte-Carlo procedure on single repeats, with all the unique repeats in the natural dataset as initial condition. The learning procedure of the Hamiltonian for a single repeat is explained in Section. In this single repeat case the possible mutations are just the single point mutations.</p>
<p>Once we have the local minima of the energy landscape, we obtain the coarse-grained minima using the Python Scipy hierarchical clustering algorithm. In this hierarchical clustering the distance between two clusters is calculated as the average Hamming distance between all the possible pairs of sequences belonging each to one cluster. As a result we plot the clustered distance matrix, the clustering dendogram and the basin size corresponding to the distance matrix entries.</p>
<p>In the end we can repeat the quenching procedure described above for LRR and TPR families. The result are sketched in <xref ref-type="supplementary-material" rid="pcbi.1007282.s003">S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007282.s004">S4</xref> Figs and lead to similar conclusions as for the ANK family.</p>
</sec>
<sec id="sec018">
<title>Kullback-Leibler divergence</title>
<p>The Kullback-Leibler divergence between two families A and B is defined as <italic>D</italic><sub>KL</sub>(A||B) = ∑<sub><bold><italic>σ</italic></bold></sub> <italic>p</italic><sub>A</sub>(<bold><italic>σ</italic></bold>) log<sub>2</sub> <italic>p</italic><sub>B</sub>(<bold><italic>σ</italic></bold>)/<italic>p</italic><sub>A</sub>(<bold><italic>σ</italic></bold>). We can substitute the sequence ensembles for ANK and TPR in the definition of the probabilities obtaining:
<disp-formula id="pcbi.1007282.e045"><alternatives><graphic id="pcbi.1007282.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e045" xlink:type="simple"/><mml:math display="block" id="M45"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mtext>KL</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>K</mml:mi> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mi>T</mml:mi> <mml:mi>P</mml:mi> <mml:mi>R</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mtext>TPR</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mtext>ANK</mml:mtext></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mtext>ANK</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>F</mml:mi> <mml:mtext>ANK</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>F</mml:mi> <mml:mtext>TPR</mml:mtext></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula> <disp-formula id="pcbi.1007282.e046"><alternatives><graphic id="pcbi.1007282.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e046" xlink:type="simple"/><mml:math display="block" id="M46"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mtext>KL</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mi>P</mml:mi> <mml:mi>R</mml:mi> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mi>A</mml:mi> <mml:mi>N</mml:mi> <mml:mi>K</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mtext>ANK</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mtext>TPR</mml:mtext></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mtext>TPR</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>F</mml:mi> <mml:mtext>TPR</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>F</mml:mi> <mml:mtext>ANK</mml:mtext></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula>
where the notation 〈〉<sub>ANK</sub> means that the average is calculated over sequences drawn from the ANK ensemble: <inline-formula id="pcbi.1007282.e047"><alternatives><graphic id="pcbi.1007282.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007282.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mrow><mml:mi>P</mml:mi> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>ANK</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mtext>ANK</mml:mtext></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>E</mml:mi> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>ANK</mml:mtext></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Therefore 〈<italic>E</italic><sub>TPR</sub>〉<sub>ANK</sub> is the average TPR energy function evaluated, via the structural alignment between the two families, on 80000 sequences generated through a Monte Carlo sampling of the ANK model <xref ref-type="disp-formula" rid="pcbi.1007282.e003">2</xref> (and analogously for 〈<italic>E</italic><sub>ANK</sub>〉<sub>TPR</sub>). The terms <italic>F</italic><sub>ANK</sub> and <italic>F</italic><sub>TPR</sub> are calculated in the same way as when estimating the entropy through Eqs <xref ref-type="disp-formula" rid="pcbi.1007282.e038">21</xref> and <xref ref-type="disp-formula" rid="pcbi.1007282.e040">22</xref>, as explained in Section.</p>
<p>For the control against a random polypeptide of length <italic>L</italic> we use <italic>D</italic><sub>KL</sub>(FAM||rand) = log Λ − <italic>S</italic>(FAM), where Λ = 21<sup><italic>L</italic></sup> is the total number of possible sequences of length <italic>L</italic>.</p>
</sec>
</sec>
<sec id="sec019">
<title>Supporting information</title>
<supplementary-material id="pcbi.1007282.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007282.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Reproducibility of entropy estimation.</title>
<p>Entropy as a function of the maximum linear interaction range <italic>W</italic> along the sequence. Green curve: entropy of the ANK family with error bars calculated as standard deviations over 10 model learning realizations, where models are learned by incrementally adding more interaction terms as <italic>W</italic> is increased, taking the model learned at <italic>W</italic> − 1 as initial condition. This plot is the same as in <xref ref-type="fig" rid="pcbi.1007282.g003">Fig 3A</xref> but with the different error bar estimates, showing that our results are robust to the details of error estimation. Red curve: entropy obtained after <italic>de novo</italic> learning for each <italic>W</italic>, starting from a non-interacting model as initial condition. With those initial conditions the learning gets stuck, leading to systematically overestimating the entropy and missing the second entropy drop at <italic>W</italic> = <italic>L</italic> − 1. See Section for details of the learning and entropy estimation procedure.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007282.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007282.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Range dependence of entropy in LRR and TPR families.</title>
<p>Entropy of the LRR (A) and TPR (B) family as a function of the maximum interaction distance <italic>W</italic> along the sequence. The entropy of the model decreases as a more interactions are added and they constrain the space of possible sequences. As with ANK, the entropy first drops, plateaus, then drops again at the distance corresponding to homologous positions along the two repeats (<italic>W</italic> = <italic>L</italic> − 1 = 23 for LRR, and 33 for TPR, dashed line). This second drop indicates that there is a typical distance along the sequence, corresponding to the repeat length, where interactions due to structural properties constrain the sequence ensemble. The error bars are estimated approximately from errors in learning (see Section). Entropies are averaged over 5 realizations of the learning and entropy estimation procedure.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007282.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007282.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Analysis of local energy minima for pairs of consecutive repeats of LRR.</title>
<p>Energy minima were obtained by zero-temperature dynamics. Sequences falling into a given minimum with these dynamics define its basin of attraction. A, bottom) rank-frequency plot of the sizes of the basins of attraction. A, top) energy minimum of each basin. Gray line shows the energy of the consensus sequence B) Pairwise Hamming distances between energy minima, organised by hierarchical clustering. The panel right above the matrix shows the the size of the basins relative to the minima corresponding to the entries of the distance matrix. C and D) Same analysis as A) and B), but for single LRR repeats.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007282.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007282.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Analysis of local energy minima for pairs of consecutive repeats of TPR.</title>
<p>Energy minima were obtained by zero-temperature dynamics. Sequences falling into a given minimum with these dynamics define its basin of attraction. A, bottom) rank-frequency plot of the sizes of the basins of attraction. A, top) energy minimum of each basin. Gray line shows the energy of the consensus sequence B) Pairwise Hamming distances between energy minima, organised by hierarchical clustering. The panel right above the matrix shows the the size of the basins relative to the minima corresponding to the entries of the distance matrix. C and D) Same analysis as A) and B), but for single TPR repeats.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007282.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007282.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Interactions within repeats increase the ruggedness of the energy landscape.</title>
<p>Local minima were obtained by performing a zero-temperature Monte-Carlo simulation with the energy function in <xref ref-type="disp-formula" rid="pcbi.1007282.e003">Eq (2)</xref> with non-zero <italic>J</italic><sub><italic>ij</italic></sub> within linear interaction range <italic>W</italic>, starting from initial conditions corresponding to naturally occurring sequences of pairs of consecutive ANK repeats, for <italic>W</italic> = 3 (A and B) and <italic>W</italic> = 10 (C and D). See <xref ref-type="fig" rid="pcbi.1007282.g005">Fig 5</xref> for the full model (<italic>W</italic> = 2<italic>L</italic>). A and C, bottom: Rank-frequency plot of basin sizes, where basins are defined by the set of sequences falling into a particular minimum. A and C, top: energy of local minima <italic>vs</italic> the size-rank of their basin. Gray line indicates the energy of the consensus sequence, for comparison. B and D: Pairwise distance between the minima with the largest basins (comprising 90% of natural sequences), organised by hierarchical clustering. The panel right above the matrix shows the size of the basins relative to the minima corresponding to the entries of the distance matrix. The block structure starts emerging as interactions are turned on (D versus B).</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007282.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007282.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Analysis of local energy minima from generated pairs of consecutive repeats of ANK.</title>
<p>Energy minima were obtained by zero-temperature dynamics starting from sequences generated <italic>in silico</italic> from <italic>E</italic><sub>full</sub>. Sequences falling into a given minimum with these dynamics define its basin of attraction. A, bottom) rank-frequency plot of the sizes of the basins of attraction. A, top) energy minimum of each basin. Gray line shows the energy of the consensus sequence B) Pairwise Hamming distances between energy minima, organised by hierarchical clustering. The panel right above the matrix shows the size of the basins relative to the minima corresponding to the entries of the distance matrix. C and D) Same analysis as A) and B), but for single ANK repeats.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1007282.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dryden</surname> <given-names>DTF</given-names></name>, <name name-style="western"><surname>Thomson</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>JH</given-names></name>. <article-title>How much of protein sequence space has been explored by life on Earth?</article-title> <source>Journal of the Royal Society InterfaceRoyal Society Interface</source>. <year>2008</year>;<volume>5</volume>(<issue>April</issue>):<fpage>953</fpage>–<lpage>956</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2008.0085" xlink:type="simple">10.1098/rsif.2008.0085</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shakhnovich</surname> <given-names>EI</given-names></name>. <article-title>Protein design: a perspective from simple tractable models</article-title>. <source>Current Biology</source>. <year>1998</year>;<volume>3</volume>:<fpage>45</fpage>–<lpage>58</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007282.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Salisbury</surname> <given-names>FB</given-names></name>. <article-title>Natural Selection and the Complexity of the Gene</article-title>. <source>Nature</source>. <year>1969</year>;<volume>244</volume>:<fpage>342</fpage>–<lpage>343</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/224342a0" xlink:type="simple">10.1038/224342a0</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mandecki</surname> <given-names>W</given-names></name>. <article-title>The game of chess and searches in protein sequence space</article-title>. <source>Biotopic</source>. <year>1998</year>;<volume>16</volume>(<issue>May</issue>):<fpage>200</fpage>–<lpage>202</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007282.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dokholyan</surname> <given-names>NV</given-names></name>, <name name-style="western"><surname>Shakhnovich</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Shakhnovich</surname> <given-names>EI</given-names></name>. <article-title>Expanding protein universe and its origin from the biological Big Bang</article-title>. <source>PNAS</source>. <year>2002</year>;<volume>99</volume>:<fpage>14132</fpage>–<lpage>14136</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.202497999" xlink:type="simple">10.1073/pnas.202497999</ext-link></comment> <object-id pub-id-type="pmid">12384571</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bateman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Coin</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Durbin</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Finn</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Hollich</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Griffiths-Jones</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>The Pfam protein families database</article-title>. <source>Nucleic acids research</source>. <year>2004</year>;<volume>32</volume>(<issue>suppl 1</issue>):<fpage>D138</fpage>–<lpage>D141</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkh121" xlink:type="simple">10.1093/nar/gkh121</ext-link></comment> <object-id pub-id-type="pmid">14681378</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Finn</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Bateman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Clements</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Coggill</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Eberhardt</surname> <given-names>RY</given-names></name>, <name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name>, <etal>et al</etal>. <article-title>Pfam: the protein families database</article-title>. <source>Nucleic acids research</source>. <year>2013</year>; p. gkt1223.</mixed-citation>
</ref>
<ref id="pcbi.1007282.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Neher</surname> <given-names>E</given-names></name>. <article-title>How frequent are correlated changes in families of protein sequences?</article-title> <source>Proceedings of the National Academy of Sciences</source>. <year>1994</year>;<volume>91</volume>(<issue>1</issue>):<fpage>98</fpage>–<lpage>102</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.91.1.98" xlink:type="simple">10.1073/pnas.91.1.98</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Morcos</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Hwa</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Onuchic</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Weigt</surname> <given-names>M</given-names></name>. <article-title>Direct coupling analysis for protein contact prediction</article-title>. <source>Methods Mol Biol</source>. <year>2014</year>;<volume>1137</volume>:<fpage>55</fpage>–<lpage>70</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/978-1-4939-0366-5_5" xlink:type="simple">10.1007/978-1-4939-0366-5_5</ext-link></comment> <object-id pub-id-type="pmid">24573474</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Szurmant</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Weigt</surname> <given-names>M</given-names></name>. <article-title>Inter-residue, inter-protein and inter-family coevolution: bridging bridging the scales</article-title>. <source>Current Opinion in Structural Biology</source>. <year>2018</year>;<volume>50</volume>:<fpage>26</fpage>–<lpage>32</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.sbi.2017.10.014" xlink:type="simple">10.1016/j.sbi.2017.10.014</ext-link></comment> <object-id pub-id-type="pmid">29101847</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tubiana</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cocco</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Monasson</surname> <given-names>R</given-names></name>. <article-title>Learning protein constitutive motifs from sequence data</article-title>. <source>eLife</source>. <year>2019</year>;<volume>8</volume>:<fpage>e39397</fpage>:<fpage>1</fpage>–<lpage>61</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.39397" xlink:type="simple">10.7554/eLife.39397</ext-link></comment> <object-id pub-id-type="pmid">30857591</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Weigt</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Szurmant</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hoch</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Hwa</surname> <given-names>T</given-names></name>. <article-title>Identification of direct residue contacts in protein–protein interaction by message passing</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2009</year>;<volume>106</volume>(<issue>1</issue>):<fpage>67</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0805923106" xlink:type="simple">10.1073/pnas.0805923106</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Morcos</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Pagnani</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lunt</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Bertolino</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Marks</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2011</year>;<volume>108</volume>(<issue>49</issue>):<fpage>E1293</fpage>–<lpage>E1301</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1111471108" xlink:type="simple">10.1073/pnas.1111471108</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ekeberg</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lövkvist</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lan</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Weigt</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Aurell</surname> <given-names>E</given-names></name>. <article-title>Improved contact prediction in proteins: using pseudolikelihoods to infer Potts models</article-title>. <source>Physical Review E</source>. <year>2013</year>;<volume>87</volume>(<issue>1</issue>):<fpage>012707</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.87.012707" xlink:type="simple">10.1103/PhysRevE.87.012707</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hopf</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Colwell</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Sheridan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rost</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Marks</surname> <given-names>DS</given-names></name>. <article-title>Three-dimensional structures of membrane proteins from genomic sequencing</article-title>. <source>Cell</source>. <year>2012</year>;<volume>149</volume>(<issue>7</issue>):<fpage>1607</fpage>–<lpage>1621</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2012.04.012" xlink:type="simple">10.1016/j.cell.2012.04.012</ext-link></comment> <object-id pub-id-type="pmid">22579045</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Espada</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Parra</surname> <given-names>RG</given-names></name>, <name name-style="western"><surname>Mora</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Walczak</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Ferreiro</surname> <given-names>DU</given-names></name>. <article-title>Capturing coevolutionary signals inrepeat proteins</article-title>. <source>BMC bioinformatics</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>207</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12859-015-0648-3" xlink:type="simple">10.1186/s12859-015-0648-3</ext-link></comment> <object-id pub-id-type="pmid">26134293</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Espada</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Parra</surname> <given-names>RG</given-names></name>, <name name-style="western"><surname>Mora</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Walczak</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Ferreiro</surname> <given-names>DU</given-names></name>. <article-title>Inferring repeat-protein energetics from evolutionary information</article-title>. <source>PLoS computational biology</source>. <year>2017</year>; p. <fpage>1</fpage>–<lpage>16</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007282.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schug</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Weigt</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Onuchic</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Hwa</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Szurmant</surname> <given-names>H</given-names></name>. <article-title>High-resolution protein complexes from integrating genomic information with molecular simulation</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2009</year>;<volume>106</volume>(<issue>52</issue>):<fpage>22124</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0912100106" xlink:type="simple">10.1073/pnas.0912100106</ext-link></comment> <object-id pub-id-type="pmid">20018738</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marks</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Colwell</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Sheridan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Hopf</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Pagnani</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zecchina</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Protein 3D structure computed from evolutionary sequence variation</article-title>. <source>PloS one</source>. <year>2011</year>;<volume>6</volume>(<issue>12</issue>):<fpage>e28766</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0028766" xlink:type="simple">10.1371/journal.pone.0028766</ext-link></comment> <object-id pub-id-type="pmid">22163331</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Contini</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tiana</surname> <given-names>G</given-names></name>. <article-title>A many-body term improves the accuracy of effective potentials based on protein coevolutionary data</article-title>. <source>The Journal of Chemical Physics</source>. <year>2015</year>;<volume>143</volume>(<issue>2</issue>):<fpage>025103</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.4926665" xlink:type="simple">10.1063/1.4926665</ext-link></comment> <object-id pub-id-type="pmid">26178131</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Haldane</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Flynn</surname> <given-names>WF</given-names></name>, <name name-style="western"><surname>He</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Vijayan</surname> <given-names>RSK</given-names></name>, <name name-style="western"><surname>Levy</surname> <given-names>RM</given-names></name>. <article-title>Structural propensities of kinase family proteins from a Potts model of residue co-variation</article-title>. <source>Protein Science</source>;<volume>25</volume>(<issue>8</issue>):<fpage>1378</fpage>–<lpage>1384</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/pro.2954" xlink:type="simple">10.1002/pro.2954</ext-link></comment> <object-id pub-id-type="pmid">27241634</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Figliuzzi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Jacquier</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Schug</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tenaillon</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Weigt</surname> <given-names>M</given-names></name>. <article-title>Coevolutionary landscape inference and the context-dependence of mutations in beta-lactamase TEM-1</article-title>. <source>Molecular biology and evolution</source>. <year>2015</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/molbev/msv211" xlink:type="simple">10.1093/molbev/msv211</ext-link></comment> <object-id pub-id-type="pmid">26446903</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Maynard Smith</surname> <given-names>J</given-names></name>. <article-title>Natural Selection and the Concept of a Protein Space</article-title>. <source>Nature</source>. <year>1970</year>;<volume>225</volume>:<fpage>563</fpage>–<lpage>564</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/225563a0" xlink:type="simple">10.1038/225563a0</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Weinreich</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Delaney</surname> <given-names>NF</given-names></name>, <name name-style="western"><surname>Depristo</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Hartl</surname> <given-names>DL</given-names></name>. <article-title>Darwinian evolution can follow only very few mutational paths to fitter proteins</article-title>. <source>Science (New York, NY)</source>. <year>2006</year>;<volume>312</volume>(<issue>5770</issue>):<fpage>111</fpage>–<lpage>114</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1123539" xlink:type="simple">10.1126/science.1123539</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mahajan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tsai</surname> <given-names>Md</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mahajan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tsai</surname> <given-names>Md</given-names></name>. <article-title>Current Topics / Perspectives Ankyrin Repeat: A Unique Motif Mediating Protein − Protein Interactions Ankyrin Repeat: A Unique Motif Mediating Protein—Protein Interactions †</article-title>. <source>Biochemistry</source>. <year>2006</year>;<volume>45</volume>(<issue>November</issue>):<fpage>15168</fpage>–<lpage>15178</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007282.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tian</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Best</surname> <given-names>RB</given-names></name>. <article-title>How Many Protein Sequences Fold to a Given Structure? A Coevolutionary Analysis</article-title>. <source>Biophysj</source>. <year>2017</year>;<volume>113</volume>(<issue>8</issue>):<fpage>1719</fpage>–<lpage>1730</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.bpj.2017.08.039" xlink:type="simple">10.1016/j.bpj.2017.08.039</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barton</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Chakraborty</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Cocco</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Jacquin</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Monasson</surname> <given-names>R</given-names></name>. <article-title>On the Entropy of Protein Families</article-title>. <source>Journal of Statistical Physics</source>. <year>2016</year>;<volume>162</volume>(<issue>5</issue>):<fpage>1267</fpage>–<lpage>1293</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10955-015-1441-4" xlink:type="simple">10.1007/s10955-015-1441-4</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jaynes</surname> <given-names>ET</given-names></name>. <article-title>Information Theory and Statistical Mechanics</article-title>. <source>Phys Rev</source>. <year>1957</year>;<volume>106</volume>:<fpage>620</fpage>–<lpage>630</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRev.106.620" xlink:type="simple">10.1103/PhysRev.106.620</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tian</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Louis</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Baber</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Aniana</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Best</surname> <given-names>RB</given-names></name>. <article-title>Co-Evolutionary Fitness Landscapes for Sequence Design</article-title>. <source>Angew Chemie—Int Ed</source>. <year>2018</year>;<volume>57</volume>(<issue>20</issue>):<fpage>5674</fpage>–<lpage>5678</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/anie.201713220" xlink:type="simple">10.1002/anie.201713220</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shakhnovich</surname> <given-names>EI</given-names></name>, <name name-style="western"><surname>Gutin</surname> <given-names>AM</given-names></name>. <article-title>A new approach to the design of stable proteins</article-title>. <source>Protein Eng</source>. <year>1993</year>;<volume>6</volume>(<issue>8</issue>):<fpage>793</fpage>–<lpage>800</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/protein/6.8.793" xlink:type="simple">10.1093/protein/6.8.793</ext-link></comment> <object-id pub-id-type="pmid">8309926</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shakhnovich</surname> <given-names>EI</given-names></name>, <name name-style="western"><surname>Gutin</surname> <given-names>AM</given-names></name>. <article-title>Engineering of stable and fast-folding sequences of model proteins</article-title>. <source>Proc Natl Acad Sci</source>. <year>1993</year>;<volume>90</volume>(<issue>15</issue>):<fpage>7195</fpage>–<lpage>7199</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.90.15.7195" xlink:type="simple">10.1073/pnas.90.15.7195</ext-link></comment> <object-id pub-id-type="pmid">8346235</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dokholyan</surname> <given-names>NV</given-names></name>, <name name-style="western"><surname>Shakhnovich</surname> <given-names>EI</given-names></name>. <article-title>Understanding Hierarchical Protein Evolution from First Principles</article-title>. <source>Journal of Molecular Biology</source>. <year>2001</year>;<volume>312</volume>:<fpage>289</fpage>–<lpage>307</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1006/jmbi.2001.4949" xlink:type="simple">10.1006/jmbi.2001.4949</ext-link></comment> <object-id pub-id-type="pmid">11545603</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Morcos</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Schafer</surname> <given-names>NP</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Onuchic</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Wolynes</surname> <given-names>PG</given-names></name>. <source>Coevolutionary information, protein folding landscapes, and the thermodynamics of natural selection</source>. <year>2014</year>;<volume>111</volume>(<issue>34</issue>):<fpage>12408</fpage>–<lpage>12413</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007282.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kimura</surname> <given-names>M</given-names></name>. <article-title>On the Probability of Fixation of Mutant Genes in a Population</article-title>. <source>Genetics</source>. <year>1962</year>;<volume>47</volume>:<fpage>713</fpage>–<lpage>719</lpage>. <object-id pub-id-type="pmid">14456043</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Berg</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Willmann</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lässig</surname> <given-names>M</given-names></name>. <article-title>Adaptive evolution of transcription factor binding sites</article-title>. <source>BMC evolutionary biology</source>. <year>2004</year>;<volume>4</volume>:<fpage>42</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2148-4-42" xlink:type="simple">10.1186/1471-2148-4-42</ext-link></comment> <object-id pub-id-type="pmid">15511291</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref036">
<label>36</label>
<mixed-citation publication-type="other" xlink:type="simple">Mezard M, Parisi G, Virasoro M. Spin Glass Theory and Beyond. WORLD SCIENTIFIC; 1986. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.worldscientific.com/doi/abs/10.1142/0271" xlink:type="simple">https://www.worldscientific.com/doi/abs/10.1142/0271</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1007282.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bryngelson</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Wolynes</surname> <given-names>PG</given-names></name>. <article-title>Spin glasses and the statistical mechanics of protein folding</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1987</year>;<volume>84</volume>(<issue>21</issue>):<fpage>7524</fpage>–<lpage>7528</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.84.21.7524" xlink:type="simple">10.1073/pnas.84.21.7524</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Frauenfelder</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Sligar</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Wolynes</surname> <given-names>PG</given-names></name>. <article-title>Proteins</article-title>. <source>Science</source>. <year>1991</year>;<volume>254</volume>:<fpage>1598</fpage>–<lpage>1603</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007282.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Facco</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Pagnani</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Russo</surname> <given-names>ET</given-names></name>, <name name-style="western"><surname>Laio</surname> <given-names>A</given-names></name>. <article-title>The intrinsic dimension of protein sequence evolution</article-title>. <source>PLoS Comput Biol</source>. <year>2019</year>;<volume>15</volume>(<issue>4</issue>):<fpage>e1006767</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1006767" xlink:type="simple">10.1371/journal.pcbi.1006767</ext-link></comment> <object-id pub-id-type="pmid">30958823</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Boersma</surname> <given-names>YL</given-names></name>, <name name-style="western"><surname>Plu</surname> <given-names>A</given-names></name>. <article-title>DARPins and other repeat protein scaffolds: advances in engineering and applications</article-title>. <source>Current opinion in biotechnology</source>. <year>2011</year>;<volume>22</volume>:<fpage>849</fpage>–<lpage>857</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.copbio.2011.06.004" xlink:type="simple">10.1016/j.copbio.2011.06.004</ext-link></comment> <object-id pub-id-type="pmid">21715155</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tripp</surname> <given-names>KW</given-names></name>, <name name-style="western"><surname>Barrick</surname> <given-names>D</given-names></name>. <article-title>Rerouting the Folding Pathway of the Notch Ankyrin Domain by Reshaping the Energy Landscape</article-title>. <source>Journal of the American Chemical Society</source>. <year>2008</year>;(<issue>19</issue>):<fpage>5681</fpage>–<lpage>5688</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ja0763201" xlink:type="simple">10.1021/ja0763201</ext-link></comment> <object-id pub-id-type="pmid">18396879</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barrick</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ferreiro</surname> <given-names>DU</given-names></name>, <name name-style="western"><surname>Komives</surname> <given-names>EA</given-names></name>. <article-title>Folding landscapes of ankyrin repeat proteins: experiments meet theory</article-title>. <source>Current Opinion in structural biology</source>. <year>2008</year>;<volume>18</volume>:<fpage>27</fpage>–<lpage>43</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.sbi.2007.12.004" xlink:type="simple">10.1016/j.sbi.2007.12.004</ext-link></comment> <object-id pub-id-type="pmid">18243686</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Consortium</surname> <given-names>U</given-names></name>, <etal>et al</etal>. <article-title>UniProt: the universal protein knowledgebase</article-title>. <source>Nucleic acids research</source>. <year>2017</year>;<volume>45</volume>(<issue>D1</issue>):<fpage>D158</fpage>–<lpage>D169</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkw1099" xlink:type="simple">10.1093/nar/gkw1099</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Jaroszewski</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Godzik</surname> <given-names>A</given-names></name>. <article-title>Tolerating some redundancy significantly speeds up clustering of large protein databases</article-title>. <source>Bioinformatics</source>. <year>2002</year>;<volume>18</volume>(<issue>1</issue>):<fpage>77</fpage>–<lpage>82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/18.1.77" xlink:type="simple">10.1093/bioinformatics/18.1.77</ext-link></comment> <object-id pub-id-type="pmid">11836214</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mosavi</surname> <given-names>LK</given-names></name>, <name name-style="western"><surname>Minor</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Peng</surname> <given-names>Zy</given-names></name>. <article-title>Consensus-derived structural determinants of the ankyrin repeat motif</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2002</year>;<volume>99</volume>(<issue>25</issue>):<fpage>16029</fpage>–<lpage>16034</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.252537899" xlink:type="simple">10.1073/pnas.252537899</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Binz</surname> <given-names>HK</given-names></name>, <name name-style="western"><surname>Stumpp</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Forrer</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Amstutz</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Plückthun</surname> <given-names>A</given-names></name>. <article-title>Designing repeat proteins: well-expressed, soluble and stable proteins from combinatorial libraries of consensus ankyrin repeat proteins</article-title>. <source>Journal of molecular biology</source>. <year>2003</year>;<volume>332</volume>(<issue>2</issue>):<fpage>489</fpage>–<lpage>503</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/s0022-2836(03)00896-9" xlink:type="simple">10.1016/s0022-2836(03)00896-9</ext-link></comment> <object-id pub-id-type="pmid">12948497</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007282.ref047">
<label>47</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Frankel</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Smit</surname> <given-names>B</given-names></name>. <source>Understanding Molecular Simulation: From Algorithms to Applications</source>. <publisher-name>Academic Press</publisher-name>; <year>2007</year>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>