<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
   <journal-meta>
      <journal-id journal-id-type="publisher-id">plos</journal-id>
      <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
      <journal-id journal-id-type="pmc">ploscomp</journal-id>
      <journal-title-group>
         <journal-title>PLoS Computational Biology</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1553-734X</issn>
      <issn pub-type="epub">1553-7358</issn>
      <publisher>
         <publisher-name>Public Library of Science</publisher-name>
         <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher>
   </journal-meta>
   <article-meta>
      <article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-01762</article-id>
      <article-id pub-id-type="doi">10.1371/journal.pcbi.1003031</article-id>
      <article-categories>
         <subj-group subj-group-type="heading">
            <subject>Research Article</subject>
         </subj-group>
<subj-group subj-group-type="Discipline-v2"><subject>Biology</subject>
<subj-group>
<subject>Computational biology</subject>
</subj-group>
<subj-group>
<subject>Genomics</subject>
</subj-group>
</subj-group>
      </article-categories>
      <title-group>
         <article-title>Shining a Light on Dark Sequencing: Characterising Errors in Ion Torrent PGM Data</article-title>
         <alt-title alt-title-type="running-head">Characterising Errors in Ion Torrent PGM Data</alt-title>
      </title-group>
      <contrib-group>
         <contrib contrib-type="author" xlink:type="simple">
            <name name-style="western"><surname>Bragg</surname><given-names>Lauren M.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff2"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref>
         </contrib>
         <contrib contrib-type="author" xlink:type="simple">
            <name name-style="western"><surname>Stone</surname>
<given-names>Glenn</given-names>
            </name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref>
         </contrib>
         <contrib contrib-type="author" xlink:type="simple">
            <name name-style="western"><surname>Butler</surname>
<given-names>Margaret K.</given-names>
            </name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref>
         </contrib>
         <contrib contrib-type="author" xlink:type="simple">
            <name name-style="western"><surname>Hugenholtz</surname>
<given-names>Philip</given-names>
            </name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff2"><sup>2</sup></xref>
         </contrib>
         <contrib contrib-type="author" xlink:type="simple">
            <name name-style="western"><surname>Tyson</surname>
<given-names>Gene W.</given-names>
            </name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff2"><sup>2</sup></xref>
         </contrib>
      </contrib-group>
      <aff id="aff1"><label>1</label><addr-line>Australian Centre for Ecogenomics, School of Chemistry and Molecular Biosciences, The University of Queensland, St Lucia, Queensland, Australia</addr-line></aff>
      <aff id="aff2"><label>2</label><addr-line>Advanced Water Management Centre, The University of Queensland, St Lucia, Queensland, Australia</addr-line></aff>
      <aff id="aff3"><label>3</label><addr-line>CSIRO Mathematics, Informatics and Statistics, Queensland, St Lucia, Australia</addr-line></aff>
      <aff id="aff4"><label>4</label><addr-line>School of Computing and Mathematics, University of Western Sydney, Parramatta, New South Wales, Australia</addr-line></aff>
      <contrib-group>
         <contrib contrib-type="editor" xlink:type="simple">
            <name name-style="western"><surname>Beerenwinkel</surname>
<given-names>Niko</given-names>
            </name><role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
         </contrib>
      </contrib-group>
      <aff id="edit1"><addr-line>ETH Zurich, Switzerland</addr-line></aff>
      <author-notes>
         <corresp id="cor1">* E-mail: <email xlink:type="simple">lauren.bragg@csiro.au</email></corresp>
         <fn fn-type="conflict">
            <p>The authors have declared that no competing interests exist.</p>
         </fn>
         <fn fn-type="con">
            <p>Conceived and designed the experiments: LMB GWT. Performed the experiments: MKB. Analyzed the data: LMB GS. Wrote the paper: LMB PH GWT.</p>
         </fn>
      </author-notes>
      <pub-date pub-type="collection">
         <month>4</month>
         <year>2013</year>
      </pub-date>
      <pub-date pub-type="epub">
         <day>11</day>
         <month>4</month>
         <year>2013</year>
      </pub-date>
      <volume>9</volume>
      <issue>4</issue>
      <elocation-id>e1003031</elocation-id>
      <history>
         <date date-type="received">
            <day>2</day>
            <month>11</month>
            <year>2012</year>
         </date>
         <date date-type="accepted">
            <day>26</day>
            <month>2</month>
            <year>2013</year>
         </date>
      </history>
      <permissions>
         <copyright-year>2013</copyright-year>
         <copyright-holder>Bragg et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
      <abstract>
         <p>The Ion Torrent Personal Genome Machine (PGM) is a new sequencing platform that substantially differs from other sequencing technologies by measuring pH rather than light to detect polymerisation events. Using re-sequencing datasets, we comprehensively characterise the biases and errors introduced by the PGM at both the base and flow level, across a combination of factors, including chip density, sequencing kit, template species and machine. We found two distinct insertion/deletion (indel) error types that accounted for the majority of errors introduced by the PGM. The main error source was inaccurate flow-calls, which introduced indels at a raw rate of 2.84% (1.38% after quality clipping) using the OneTouch 200 bp kit. Inaccurate flow-calls typically resulted in over-called short-homopolymers and under-called long-homopolymers. Flow-call accuracy decreased with consecutive flow cycles, but we also found significant periodic fluctuations in the flow error-rate, corresponding to specific positions within the flow-cycle pattern. Another less common PGM error, high frequency indel (HFI) errors, are indels that occur at very high frequency in the reads relative to a given base position in the reference genome, but in the majority of instances were not replicated consistently across separate runs. HFI errors occur approximately once every thousand bases in the reference, and correspond to 0.06% of bases in reads. Currently, the PGM does not achieve the accuracy of competing light-based technologies. However, flow-call inaccuracy is systematic and the statistical models of flow-values developed here will enable PGM-specific bioinformatics approaches to be developed, which will account for these errors. HFI errors may prove more challenging to address, especially for polymorphism and amplicon applications, but may be overcome by sequencing the same DNA template across multiple chips.</p>
      </abstract>
      <abstract abstract-type="summary">
         <title>Author Summary</title>
         <p>DNA sequencing is used routinely within biology to reveal the genetic information of living organisms. In recent years, technological advances have led to the availability of high-throughput, low-cost DNA sequencing machines (‘sequencers’). In 2011, Life Sciences released a new sequencer, the Ion Torrent Personal Genome Machine (PGM). This is the first sequencer to measure changes in pH rather that emitted light to register sequencing reactions. Consequently, this unique technology is both cost-effective and advertised to have high accuracy, making it attractive for many laboratories. However, every sequencing technology introduces unique errors and biases into the resulting DNA sequences, and understanding PGM-specific characteristics is crucial to determining suitable applications for this new technology. We comprehensively examine the types of errors and biases in PGM-sequenced data across several experimental variables, including chip density, template kit, template DNA and across two machines. Using statistical approaches, we quantify the influence of experimental variables, as well as DNA sequence-specific effects, and find that the PGM has two types of technology-specific errors. We also find that the accuracy of the PGM is poorer than that of light-based technologies, and we make recommendations for this technology as well as provide statistical models for overcoming PGM sequencing errors.</p>
      </abstract>
      <funding-group>
         <funding-statement>LMB was funded by the Commonwealth Scientific and Industrial Research Organisation (CSIRO) Transformational Biology Capability Platform. PH is supported by an ARC DORA fellowship. GWT is supported by an ARC Queen Elizabeth II fellowship (ARC-DP1093175). Work was also supported by strategic University of Queensland funding of the Australian Centre for Ecogenomics. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group>
<counts>
<page-count count="18"/>
</counts>
</article-meta>
</front>
<body>
   <sec id="s1">
      <title>Introduction</title>
      <p>The last decade has seen dramatic advances in sequencing technology that have relied on highly-parallel optical sensing of polymerisation reactions. These advances have substantially reduced sequencing costs, however further reduction in cost is limited by the dependence of these platforms on photo-receptive sensors and their associated reagents. In 2011, Life technologies began distribution of the Ion Torrent Personal Genome Machine (PGM). The PGM leverages advances in semi-conductor technology and ion-sensitive transistors to sequence DNA using only DNA polymerase and natural nucleotides, with each polymerisation event recognised by pH changes alone <xref ref-type="bibr" rid="pcbi.1003031-Rothberg1">[1]</xref>.</p>
      <p>The PGM requires similar library preparation steps to Roche 454 shotgun libraries, where an adapter and key () is ligated to the DNA templates, and under optimal conditions, a single DNA template is affixed to a bead and clonally amplified using emulsion PCR. The beads are then loaded onto the chip, where, on average, each well contains less than a single bead.</p>
      <p>Deoxynucleotide triphosphates (dNTPs) are flowed over the surface of the bead in a predetermined sequence, with zero or more dNTPs ligating during each flow. While the first generation of the PGM cycled through the four nucleotides in a step-wise fashion (as does the Roche 454 pyrosequencer), this cycle was modified to have a period of 32, with a pattern that repeats some nucleotides in a period shorter than four. This more complex flow cycle, referred to as the <italic>Samba</italic>, was implemented to improve synchronicity of clonal templates on the bead at the cost of a flow-sequence not optimised for read length. A single proton is released for every nucleotide incorporated during the flow, resulting in a net decrease of the pH in the surrounding solution. This pH change is measured by an ionic sensor and then converted to a flow value using a physical model of the cell and its contents. The PGM base-caller takes these flow-values and corrects for phase and signal loss, and also normalizes the raw flow-values to the key sequence (the key is a known four-base DNA molecule appended to the 5′ region of every read sequence). Finally, quality assurance procedures are applied to the data, filtering polyclonal and noisy reads, and clipping adapters and low quality regions from the 3′ end of the remaining reads.</p>
      <p>An assessment of the PGM sequencing technology was provided with the publication of the sequencing platform <xref ref-type="bibr" rid="pcbi.1003031-Rothberg1">[1]</xref>. However, this analysis was conducted using quality-trimmed data (rather than raw reads) and reported accuracy based on a consensus rather than individual read accuracy. In addition, substantial changes have been made to the platform since the initial publication, including the change of flow order (<italic>Samba</italic>), quality control and base calling, which are likely to influence the error rates and biases in PGM data. Two studies comparing benchtop sequencers, including the PGM, were recently published <xref ref-type="bibr" rid="pcbi.1003031-Loman1">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1003031-Quail1">[3]</xref>, both focusing on the assembly prospects of benchtop platforms on single isolate genomes. Consistent with the scope of these studies, they used the quality-trimming recommended by each distributor and did not generate sufficient replicate data to understand variability in accuracy. No study of PGM data to date has attempted to robustly evaluate error rates or explored the possible causal factors of errors at the flow-level. Here, we characterise the nature of errors produced by the PGM, including sequencing kit, chip type, machine variability, template G+C%, and chip, read and flow positional effects. Our findings contribute to a more comprehensive understanding of the errors and biases inherent in PGM data, and will enable the bioinformatics community to develop appropriate algorithms for this new platform.</p>
   </sec>
   <sec id="s2">
      <title>Results</title>
      <sec id="s2a">
         <title>Datasets</title>
         <p>In this study, we considered the influence of both technological (template preparation kit, chip, machine) and DNA template factors on sequencing output using a full factor statistical design (<bold>see </bold><xref ref-type="sec" rid="s4"><bold>Methods</bold></xref>). We evaluated three template preparation kits, listed in chronological release order, Ion OneTouch Template Kit (100 bp OneTouch kit), Ion Xpress Template 200 Kit (200 bp manual kit), Ion OneTouch 200 Template Kit (200 bp OneTouch kit), two chip densities, 314 (1.2M sensors, density 200,000 reads) and 316 (6.1M sensors, density 1 million reads) and two PGM machines (named here <italic>a</italic> and <italic>b</italic>). Two species, <italic>Sulfolobus tokodaii</italic> (33 G+C%) and <italic>Bacillus amyloliquefaciens</italic> (46% G+C%), both with relatively small, sequenced genomes and no extra-chromosomal DNA, were selected to represent different G+C% templates. A third organism, <italic>Deinococcus maricopensis</italic> (69% G+C), was selected for its high G+C content, however library preparation consistently failed using the 200 bp kits, and read throughput was extremely low for the 100 bp OneTouch kit, consequently it was excluded from subsequent analyses. Fifteen datasets were generated (<xref ref-type="table" rid="pcbi-1003031-t001"><bold>Table 1</bold></xref>) and used to evaluate the effects and interactions between template preparation kit, chip and machine on the measured error rate (<bold>see </bold><xref ref-type="sec" rid="s4"><bold>Methods</bold></xref>).</p>
         <table-wrap id="pcbi-1003031-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003031.t001</object-id><label>Table 1</label>
            <caption>
               <title>Sequencing runs generated for this study.</title>
            </caption><alternatives><graphic id="pcbi-1003031-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003031.t001" xlink:type="simple"/><table>
               <colgroup span="1">
                  <col align="left" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
               </colgroup>
               <thead>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">Treatment</td>
                     <td align="left" rowspan="1" colspan="1"># Reads</td>
                     <td align="left" rowspan="1" colspan="1">% Wells with ISPs</td>
                     <td align="left" rowspan="1" colspan="1">% With adaptors</td>
                     <td align="left" rowspan="1" colspan="1">#Reads Used</td>
                     <td align="left" rowspan="1" colspan="1">% Reads mapping</td>
                     <td align="left" rowspan="1" colspan="1">Mean length</td>
                     <td align="left" rowspan="1" colspan="1">Mean Length (AT)</td>
                     <td align="left" rowspan="1" colspan="1">Mean quality</td>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">314-B-a-100</td>
                     <td align="left" rowspan="1" colspan="1">275,058</td>
                     <td align="left" rowspan="1" colspan="1">54%</td>
                     <td align="left" rowspan="1" colspan="1">96%</td>
                     <td align="left" rowspan="1" colspan="1">275,058</td>
                     <td align="left" rowspan="1" colspan="1">96%</td>
                     <td align="left" rowspan="1" colspan="1">146.8</td>
                     <td align="left" rowspan="1" colspan="1">116.1</td>
                     <td align="left" rowspan="1" colspan="1">32.9</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">314-S-a-100</td>
                     <td align="left" rowspan="1" colspan="1">188,925</td>
                     <td align="left" rowspan="1" colspan="1">63%</td>
                     <td align="left" rowspan="1" colspan="1">94%</td>
                     <td align="left" rowspan="1" colspan="1">188,925</td>
                     <td align="left" rowspan="1" colspan="1">94%</td>
                     <td align="left" rowspan="1" colspan="1">153.6</td>
                     <td align="left" rowspan="1" colspan="1">125.2</td>
                     <td align="left" rowspan="1" colspan="1">32.5</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">316-S-a-100</td>
                     <td align="left" rowspan="1" colspan="1">2,135,728</td>
                     <td align="left" rowspan="1" colspan="1">55%</td>
                     <td align="left" rowspan="1" colspan="1">97%</td>
                     <td align="left" rowspan="1" colspan="1">300,000</td>
                     <td align="left" rowspan="1" colspan="1">97%</td>
                     <td align="left" rowspan="1" colspan="1">149.9</td>
                     <td align="left" rowspan="1" colspan="1">121.4</td>
                     <td align="left" rowspan="1" colspan="1">33.5</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">316-B-a-100</td>
                     <td align="left" rowspan="1" colspan="1">2,364,054</td>
                     <td align="left" rowspan="1" colspan="1">67%</td>
                     <td align="left" rowspan="1" colspan="1">98%</td>
                     <td align="left" rowspan="1" colspan="1">300,000</td>
                     <td align="left" rowspan="1" colspan="1">98%</td>
                     <td align="left" rowspan="1" colspan="1">145.2</td>
                     <td align="left" rowspan="1" colspan="1">114.2</td>
                     <td align="left" rowspan="1" colspan="1">33.1</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">314-B-a-200M</td>
                     <td align="left" rowspan="1" colspan="1">453,539</td>
                     <td align="left" rowspan="1" colspan="1">66%</td>
                     <td align="left" rowspan="1" colspan="1">100%</td>
                     <td align="left" rowspan="1" colspan="1">300,000</td>
                     <td align="left" rowspan="1" colspan="1">95%</td>
                     <td align="left" rowspan="1" colspan="1">267.7</td>
                     <td align="left" rowspan="1" colspan="1">248</td>
                     <td align="left" rowspan="1" colspan="1">33.6</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">314-S-a-200M</td>
                     <td align="left" rowspan="1" colspan="1">286,106</td>
                     <td align="left" rowspan="1" colspan="1">45%</td>
                     <td align="left" rowspan="1" colspan="1">100%</td>
                     <td align="left" rowspan="1" colspan="1">286,106</td>
                     <td align="left" rowspan="1" colspan="1">94%</td>
                     <td align="left" rowspan="1" colspan="1">269.40</td>
                     <td align="left" rowspan="1" colspan="1">254.5</td>
                     <td align="left" rowspan="1" colspan="1">33.9</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">316-S-a-200M</td>
                     <td align="left" rowspan="1" colspan="1">1,321,709</td>
                     <td align="left" rowspan="1" colspan="1">51%</td>
                     <td align="left" rowspan="1" colspan="1">100%</td>
                     <td align="left" rowspan="1" colspan="1">300,000</td>
                     <td align="left" rowspan="1" colspan="1">91%</td>
                     <td align="left" rowspan="1" colspan="1">268.40</td>
                     <td align="left" rowspan="1" colspan="1">254.2</td>
                     <td align="left" rowspan="1" colspan="1">30.9</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">316-S-b-100</td>
                     <td align="left" rowspan="1" colspan="1">1,442,952</td>
                     <td align="left" rowspan="1" colspan="1">51%</td>
                     <td align="left" rowspan="1" colspan="1">98%</td>
                     <td align="left" rowspan="1" colspan="1">300,000</td>
                     <td align="left" rowspan="1" colspan="1">98%</td>
                     <td align="left" rowspan="1" colspan="1">151.3</td>
                     <td align="left" rowspan="1" colspan="1">121.4</td>
                     <td align="left" rowspan="1" colspan="1">32.7</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">314-B-b-100</td>
                     <td align="left" rowspan="1" colspan="1">441,037</td>
                     <td align="left" rowspan="1" colspan="1">68%</td>
                     <td align="left" rowspan="1" colspan="1">92%</td>
                     <td align="left" rowspan="1" colspan="1">300,000</td>
                     <td align="left" rowspan="1" colspan="1">91%</td>
                     <td align="left" rowspan="1" colspan="1">152.9</td>
                     <td align="left" rowspan="1" colspan="1">123.3</td>
                     <td align="left" rowspan="1" colspan="1">33.7</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">316-B-a-200M</td>
                     <td align="left" rowspan="1" colspan="1">1,124,128</td>
                     <td align="left" rowspan="1" colspan="1">95%</td>
                     <td align="left" rowspan="1" colspan="1">100%</td>
                     <td align="left" rowspan="1" colspan="1">300,000</td>
                     <td align="left" rowspan="1" colspan="1">92%</td>
                     <td align="left" rowspan="1" colspan="1">267.4</td>
                     <td align="left" rowspan="1" colspan="1">248.2</td>
                     <td align="left" rowspan="1" colspan="1">29.5</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">314-S-b-200M</td>
                     <td align="left" rowspan="1" colspan="1">197,811</td>
                     <td align="left" rowspan="1" colspan="1">36%</td>
                     <td align="left" rowspan="1" colspan="1">100%</td>
                     <td align="left" rowspan="1" colspan="1">197,811</td>
                     <td align="left" rowspan="1" colspan="1">93%</td>
                     <td align="left" rowspan="1" colspan="1">271.7</td>
                     <td align="left" rowspan="1" colspan="1">256.7</td>
                     <td align="left" rowspan="1" colspan="1">33.4</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">316-B-b-200</td>
                     <td align="left" rowspan="1" colspan="1">2,345,739</td>
                     <td align="left" rowspan="1" colspan="1">95%</td>
                     <td align="left" rowspan="1" colspan="1">5.7%</td>
                     <td align="left" rowspan="1" colspan="1">300,000</td>
                     <td align="left" rowspan="1" colspan="1">94%</td>
                     <td align="left" rowspan="1" colspan="1">298.9</td>
                     <td align="left" rowspan="1" colspan="1">250.5</td>
                     <td align="left" rowspan="1" colspan="1">33.2</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">314-S-b-200</td>
                     <td align="left" rowspan="1" colspan="1">426,411</td>
                     <td align="left" rowspan="1" colspan="1">94%</td>
                     <td align="left" rowspan="1" colspan="1">15%</td>
                     <td align="left" rowspan="1" colspan="1">300,000</td>
                     <td align="left" rowspan="1" colspan="1">85%</td>
                     <td align="left" rowspan="1" colspan="1">318.2</td>
                     <td align="left" rowspan="1" colspan="1">278.4</td>
                     <td align="left" rowspan="1" colspan="1">34.0</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">316-S-a-200</td>
                     <td align="left" rowspan="1" colspan="1">2,586,746</td>
                     <td align="left" rowspan="1" colspan="1">82%</td>
                     <td align="left" rowspan="1" colspan="1">6.7%</td>
                     <td align="left" rowspan="1" colspan="1">300,000</td>
                     <td align="left" rowspan="1" colspan="1">93%</td>
                     <td align="left" rowspan="1" colspan="1">305.0</td>
                     <td align="left" rowspan="1" colspan="1">258.5</td>
                     <td align="left" rowspan="1" colspan="1">32.1</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">314-B-a-200</td>
                     <td align="left" rowspan="1" colspan="1">373,256</td>
                     <td align="left" rowspan="1" colspan="1">50%</td>
                     <td align="left" rowspan="1" colspan="1">12%</td>
                     <td align="left" rowspan="1" colspan="1">300,000</td>
                     <td align="left" rowspan="1" colspan="1">87%</td>
                     <td align="left" rowspan="1" colspan="1">307.9</td>
                     <td align="left" rowspan="1" colspan="1">263.9</td>
                     <td align="left" rowspan="1" colspan="1">34</td>
                  </tr>
               </tbody>
            </table></alternatives>
            <table-wrap-foot>
               <fn id="nt101">
                  <label/>
                  <p>The name for each run is comprised of the chip (314, 316), species (B – <italic>Bacillus amyloliquefaciens</italic>, S – <italic>Sulfolobus tokodaii</italic>), machine (a, b), and kit (100 - Ion OneTouch Template Kit, 200M - Ion Xpress Template 200 kit, 200 - Ion OneTouch 200 Template kit). Runs are listed in chronological order. ‘% Wells with ISPs’ describes the percentage of wells on the chip which contained a bead. Mean Length AT denotes length after 3′ adapter trimming.</p>
               </fn>
            </table-wrap-foot>
         </table-wrap>
         <p>For the 100 bp OneTouch kit and 200 bp manual kit, the great majority of reads (94–100%) had adapter sequences detected by the PGM software. The newest kit considered here, the 200 bp OneTouch Kit, had a very low percentage of reads with detected adapters (7–12%), which may be due to library construction differences (longer inserts used). We applied the 3′ clipping of adapter sequences as specified in the Standard Flowgram File (SFF), however we did not apply the recommended 3′ quality clipping – allowing more realistic calculation of raw error rates. Datasets larger than 300,000 reads were randomly subsampled down to 300,000 reads as this provided sufficient information for downstream analyses (<xref ref-type="table" rid="pcbi-1003031-t001"><bold>Table 1</bold></xref>).</p>
         <p>On average, 93±3.5% of all analysed reads mapped to their respective reference genomes, with the poorest performance obtained with the 200 bp OneTouch kits on 314 chips. Mean read quality across all the datasets was 32.88±1.20 s.d.</p>
         <p>The distribution of read lengths (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s001">Figure S1</xref></bold>) shows that both the 100 bp and 200 bp One Touch kits were bi-modal with a smaller secondary peak ∼100 bp greater than the expected length, which was more prominent in runs using the 314 chip. These longer reads did not exhibit any deviation in mean G+C content or homopolymer composition from the dominant read length peak for their respective runs. However the majority of these longer reads did not map to the reference genome, but those that could be mapped had an error rate double that of the mean base-error rate across all datasets. Considering these reads have a substantially higher error rate, we recommend the removal of unexpectedly long reads prior to analysis.</p>
      </sec>
      <sec id="s2b">
         <title>High frequency polymorphisms between sequenced reads and reference genomes</title>
         <p>Prior to assessing PGM error profiles, we determined if there were any genuine polymorphisms between the PGM determined and reference genomes, which may be the result of accumulated mutations in the genome <xref ref-type="bibr" rid="pcbi.1003031-Barrick1">[4]</xref> or sequencing errors in the original genome project. We tested each base difference between the reads and their respective reference genome to identify whether the number of observed differences was significantly higher than the expected error rate (<bold>see </bold><xref ref-type="sec" rid="s4"><bold>Methods</bold></xref>). Across all datasets, there were a large number of significant differences, predominantly high-frequency insertion and deletion (indel) polymorphisms (<xref ref-type="table" rid="pcbi-1003031-t002"><bold>Table 2</bold></xref>). While the number of polymorphisms appear to be lower for 100 bp OneTouch kits, this is likely due to lower coverage reducing the sensitivity of our ‘polymorphism’ detection. It has been previously reported that the majority of indel polymorphisms detected in PGM reads are false-positives, even when the ‘putative’ indel was present across a large number of reads <xref ref-type="bibr" rid="pcbi.1003031-Quail1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1003031-Elliott1">[5]</xref>. We would expect that if the indels in our datasets were <italic>bona fide</italic> polymorphisms they would be observed across all datasets for the same species. Analysis of the 200 bp kits revealed that 87% of high-frequency indels across the <italic>B. amyloliquefaciens</italic> datasets, and 82% across <italic>S. tokodaii</italic> were unique to a single run (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s002">Figure S2a and S2b</xref></bold>). As the data were derived from the same DNA template, this strongly indicates that these indels are due to PGM-based error as opposed to genuine polymorphisms. While few high frequency indel (HFI) sites were shared amongst all 200 bp runs for the same species, the size of the intersection between pairs of runs suggests that the HFI (or a subset of them) are not random (i.e. they may be more prevalent in or around a particular sequence motif) (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s002">Figure S2a and S2b</xref></bold>). HFIs have been observed previously in PGM data, with some evidence to suggest the HFI were asymmetrically distributed across reads in the forward versus reverse orientation (or vice versa) <xref ref-type="bibr" rid="pcbi.1003031-Quail1">[3]</xref>. We investigated whether any of the HFIs in our data were asymmetrically distributed across the forward and reverse oriented reads aligning across that site (<bold>see </bold><xref ref-type="sec" rid="s4"><bold>Methods</bold></xref>). This test was only performed on the 200 bp kits as the 100 bp kits had insufficient coverage for evaluation. Significant indel-strand asymmetry was detected in 7.4% (897/12,107) of the testable putative indel sites across the 200 bp datasets (<xref ref-type="table" rid="pcbi-1003031-t002"><bold>Table 2</bold></xref>), with some datasets having a substantially higher percentage of asymmetric indels than others (i.e. 314-S-b-200, 314-S-a-200M). As with the HFI superset, these strand-asymmetric HFIs have more sites in common between runs than expected for a random event (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s002">Figure S2c and S2d</xref></bold>).</p>
         <table-wrap id="pcbi-1003031-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003031.t002</object-id><label>Table 2</label>
            <caption>
               <title>Number of genomic locations where a significant proportion of reads disagreed with the reference.</title>
            </caption><alternatives><graphic id="pcbi-1003031-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003031.t002" xlink:type="simple"/><table>
               <colgroup span="1">
                  <col align="left" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
               </colgroup>
               <thead>
                  <tr>
                     <td align="left" rowspan="1" colspan="1"><italic>Treatment</italic></td>
                     <td align="left" rowspan="1" colspan="1"><italic>Substitutions</italic></td>
                     <td align="left" rowspan="1" colspan="1"><italic>Deletion</italic></td>
                     <td align="left" rowspan="1" colspan="1"><italic>Insertion</italic></td>
                     <td align="left" rowspan="1" colspan="1"><italic>Asymmetric Deletion (# significant/# tested)</italic></td>
                     <td align="left" rowspan="1" colspan="1"><italic>Asymmetric Insertion (#significant/#tested)</italic></td>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">314-B-a-100</td>
                     <td align="left" rowspan="1" colspan="1">24</td>
                     <td align="left" rowspan="1" colspan="1">107</td>
                     <td align="left" rowspan="1" colspan="1">40</td>
                     <td align="left" rowspan="1" colspan="1">N/A</td>
                     <td align="left" rowspan="1" colspan="1">N/A</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">314-S-a-100</td>
                     <td align="left" rowspan="1" colspan="1">18</td>
                     <td align="left" rowspan="1" colspan="1">45</td>
                     <td align="left" rowspan="1" colspan="1">38</td>
                     <td align="left" rowspan="1" colspan="1">N/A</td>
                     <td align="left" rowspan="1" colspan="1">N/A</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">316-S-a-100</td>
                     <td align="left" rowspan="1" colspan="1">21</td>
                     <td align="left" rowspan="1" colspan="1">162</td>
                     <td align="left" rowspan="1" colspan="1">98</td>
                     <td align="left" rowspan="1" colspan="1">N/A</td>
                     <td align="left" rowspan="1" colspan="1">N/A</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">316-B-a-100</td>
                     <td align="left" rowspan="1" colspan="1">9</td>
                     <td align="left" rowspan="1" colspan="1">110</td>
                     <td align="left" rowspan="1" colspan="1">79</td>
                     <td align="left" rowspan="1" colspan="1">N/A</td>
                     <td align="left" rowspan="1" colspan="1">N/A</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">314-B-a-200M</td>
                     <td align="left" rowspan="1" colspan="1">553</td>
                     <td align="left" rowspan="1" colspan="1">761</td>
                     <td align="left" rowspan="1" colspan="1">1303</td>
                     <td align="left" rowspan="1" colspan="1">12/618</td>
                     <td align="left" rowspan="1" colspan="1">5/644</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">314-S-a-200M</td>
                     <td align="left" rowspan="1" colspan="1">483</td>
                     <td align="left" rowspan="1" colspan="1">1105</td>
                     <td align="left" rowspan="1" colspan="1">2446</td>
                     <td align="left" rowspan="1" colspan="1">165/365</td>
                     <td align="left" rowspan="1" colspan="1">33/529</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">316-S-a-200M</td>
                     <td align="left" rowspan="1" colspan="1">568</td>
                     <td align="left" rowspan="1" colspan="1">337</td>
                     <td align="left" rowspan="1" colspan="1">911</td>
                     <td align="left" rowspan="1" colspan="1">35/247</td>
                     <td align="left" rowspan="1" colspan="1">30/561</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">316-S-b-100</td>
                     <td align="left" rowspan="1" colspan="1">13</td>
                     <td align="left" rowspan="1" colspan="1">131</td>
                     <td align="left" rowspan="1" colspan="1">161</td>
                     <td align="left" rowspan="1" colspan="1">N/A</td>
                     <td align="left" rowspan="1" colspan="1">N/A</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">314-B-b-100</td>
                     <td align="left" rowspan="1" colspan="1">11</td>
                     <td align="left" rowspan="1" colspan="1">92</td>
                     <td align="left" rowspan="1" colspan="1">83</td>
                     <td align="left" rowspan="1" colspan="1">N/A</td>
                     <td align="left" rowspan="1" colspan="1">N/A</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">316-B-a-200M</td>
                     <td align="left" rowspan="1" colspan="1">534</td>
                     <td align="left" rowspan="1" colspan="1">246</td>
                     <td align="left" rowspan="1" colspan="1">546</td>
                     <td align="left" rowspan="1" colspan="1">1/159</td>
                     <td align="left" rowspan="1" colspan="1">0/294</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">314-S-b-200M</td>
                     <td align="left" rowspan="1" colspan="1">309</td>
                     <td align="left" rowspan="1" colspan="1">409</td>
                     <td align="left" rowspan="1" colspan="1">1014</td>
                     <td align="left" rowspan="1" colspan="1">24/365</td>
                     <td align="left" rowspan="1" colspan="1">13/529</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">316-B-b-200</td>
                     <td align="left" rowspan="1" colspan="1">164</td>
                     <td align="left" rowspan="1" colspan="1">979</td>
                     <td align="left" rowspan="1" colspan="1">717</td>
                     <td align="left" rowspan="1" colspan="1">32/905</td>
                     <td align="left" rowspan="1" colspan="1">0/315</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">314-S-b-200</td>
                     <td align="left" rowspan="1" colspan="1">292</td>
                     <td align="left" rowspan="1" colspan="1">1579</td>
                     <td align="left" rowspan="1" colspan="1">2189</td>
                     <td align="left" rowspan="1" colspan="1">398/1533</td>
                     <td align="left" rowspan="1" colspan="1">21/1041</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">316-S-a-200</td>
                     <td align="left" rowspan="1" colspan="1">198</td>
                     <td align="left" rowspan="1" colspan="1">398</td>
                     <td align="left" rowspan="1" colspan="1">1100</td>
                     <td align="left" rowspan="1" colspan="1">64/350</td>
                     <td align="left" rowspan="1" colspan="1">7/623</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">314-B-a-200</td>
                     <td align="left" rowspan="1" colspan="1">170</td>
                     <td align="left" rowspan="1" colspan="1">1127</td>
                     <td align="left" rowspan="1" colspan="1">1214</td>
                     <td align="left" rowspan="1" colspan="1">53/1049</td>
                     <td align="left" rowspan="1" colspan="1">4/554</td>
                  </tr>
               </tbody>
            </table></alternatives>
            <table-wrap-foot>
               <fn id="nt102">
                  <label/>
                  <p>The last two columns show the number of significant strand-specific error instances out of the total testable instances (testable defined here as having reads aligning in both orientations over the site).</p>
               </fn>
            </table-wrap-foot>
         </table-wrap>
         <p>The majority of HFI errors were single-base insertions or deletions and only 29% of these occurred in homopolymeric regions, in contrast, 82% of strand-asymmetric HFIs occurred in a homopolymer of length two to three. In general, HFI errors manifested most commonly as insertions of A/T or deletions of C/G (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s003">Figure S3</xref></bold>a). Strand-asymmetric HFIs were dominated by deletions of C and G (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s003">Figure S3b</xref></bold>). There was no relationship between the base or flow positions of these errors across the reads with the same HFI. It will require further experimentation to identify whether HFIs are introduced by the library preparation, template preparation or the sequencer itself. The HFI error rate relative to the reference genome was approximately 1 in 1000 to 1 in 2000 bp, and HFIs accounted for 0.03%–0.09% of all bases in each dataset. Given that it is difficult to distinguish HFIs from <italic>bona fide</italic> polymorphisms without sequencing the same template over multiple chips, PGM sequencing may be compromised in polymorphism detection and amplicon sequencing projects. Here, we mask the HFIs from downstream analyses, as they are unlikely to be the consequence of individual flow-call inaccuracy, and will introduce bias into modeling of base and flow-call accuracy.</p>
      </sec>
      <sec id="s2c">
         <title>Coverage and G+C bias</title>
         <p>Initial studies characterising the PGM reported that there was little correlation between genomic coverage and G+C% content. More recently it was claimed that, based on visual comparisons of the theoretical versus empirical genomic coverage, there was substantially less read coverage in A+T rich regions <xref ref-type="bibr" rid="pcbi.1003031-Quail1">[3]</xref>. Here, we attempt to quantify the magnitude and significance of the relationship between coverage and G+C content. Inspection of the data suggested that the relationship between G+C% and coverage differs for the two species used in this study (<xref ref-type="fig" rid="pcbi-1003031-g001"><bold>Figure 1a</bold></xref>). While <italic>B. amyloliquefaciens</italic> has a higher mean G+C (46.1%) compared to S. <italic>tokodaii</italic> (32.8%), both have a large number of 100 bp windows within the range of 20–50% G+C content, allowing direct comparison (<xref ref-type="fig" rid="pcbi-1003031-g001"><bold>Figure 1b</bold></xref>). The positive correlation between G+C and coverage in <italic>S. tokodaii</italic> versus the negative correlation with <italic>B. amyloliquefaciens</italic> is clear even when restricting to this 20–50% G+C range. This suggests that the relationship between G+C% and coverage is influenced by the DNA template from which the sequences are derived. We fitted a linear model to the normalised coverage to evaluate the significance and magnitude of the relationship between G+C% and coverage, as well as the influence of species (DNA template) on this relationship (<bold>see </bold><xref ref-type="sec" rid="s4"><bold>Methods</bold></xref>). All terms in the regression were significant (p&lt;0.0001), and inspection of the linear model diagnostic plots revealed no dramatic deviations from normal model assumptions (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s005">Figure S5</xref></bold>). This model can be split into two linear regressions, one for <italic>B. amyloliquefaciens</italic>,<disp-formula id="pcbi.1003031.e001"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003031.e001" xlink:type="simple"/></disp-formula>and the second for <italic>S. tokodaii</italic>,<disp-formula id="pcbi.1003031.e002"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003031.e002" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003031.e003" xlink:type="simple"/></inline-formula> is the <italic>normalised</italic> coverage and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003031.e004" xlink:type="simple"/></inline-formula>, the proportion G+C% in a 100 bp window. The <italic>B. amyloliquefaciens</italic> model describes a small negative effect for increasing G+C% on coverage, whereas <italic>S. tokodaii</italic> has a larger, positive effect. This relationship requires further investigation with a wider range of species, but it is replicated across the various kits, chips and machines used in this study. While we had originally intended to include the high G+C% organism, <italic>Deinococcus maricopensis</italic> (<xref ref-type="sec" rid="s4"><bold>Methods</bold></xref>), the inconsistency in read throughput across chips for this species necessitated its exclusion. However, we analysed the highest throughput run for <italic>D. maricopensis</italic> (kit - 200 bp Manual Kit, chip - 316) and observed an extreme bias against high G+C% regions, with lower G+C content regions (45%) having 2.5× the mean genomic coverage, but higher G+C regions (80%) receiving only 0.2× the mean coverage (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s006">Figure S6</xref></bold>).</p>
         <fig id="pcbi-1003031-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003031.g001</object-id><label>Figure 1</label>
            <caption>
               <title>Relationship between G+C% and the observed mean coverage for 100 bp bins in the reference genome.</title>
               <p>Panel (a) is a boxplot of the distribution of the square-root normalized mean read depth across the 100 bp windows for each reference genome, broken down further by sequencing kit and G+C% bin. The coverage for each run was normalised by the mean coverage –the boxplots show the square-root fold-change from the mean genomic coverage for each combination of species, kit and G+C% bin. Thus a value of 2 means the coverage was four times that of the mean for that sequencing run. The boxes display the central 50% of the values in each treatment, with the median represented by the solid black horizontal bar. The whiskers each extend for 1.5× the inter-quartile range, and the black dots represent extreme individual observations which fall outside this range. The variability observed in the high G+C bins are likely due to the small sample size for these G+C regions, shown in panel (b). The outliers are potentially due to repetitive content in the genome that failed to be masked by our perfect match repeat approach.</p>
            </caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003031.g001" position="float" xlink:type="simple"/></fig>
         <p>Both PCR and gel extraction processes have been implicated in G+C% coverage biases in Illumina sequencing <xref ref-type="bibr" rid="pcbi.1003031-Quail2">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1003031-Aird1">[7]</xref>. PCR has been shown to preferentially amplify mid-G+C% fragments, and size selection using gel extraction approaches, which heat the DNA, often leading to underrepresentation of low G+C% sequences. In this study, size selection was performed using the Pippin Prep (<bold>see </bold><xref ref-type="sec" rid="s4"><bold>Methods</bold></xref>) circumventing gel extraction, leaving the PCR steps as the likely cause of the coverage biases observed in low and high G+C% regions. As PCR biases are exerted only on sequences processed together, it is expected that the observed relationship between G+C% and coverage will depend on the mean and range of G+C% in the DNA template. As demonstrated here, organisms with 100 bp G+C% windows within the 20%–80% G+C range will experience little bias in coverage, whereas organisms with G+C% regions outside this ‘safe’ range will suffer substantial G+C biases. The G+C% bias appears asymmetric, with the bias against high G+C% regions (i.e. <italic>D. maricopensis</italic>) more pronounced than low G+C% regions (i.e. <italic>S. tokodaii</italic>). In fact this bias against extremely high G+C% templates may explain why sequencing <italic>D. maricopensis</italic> libraries, as well as <italic>Streptomyces sp.</italic> and <italic>Burkholderia</italic> sp. libraries, either failed during library preparation or produced insufficient sequence data. PGM sequencing of organisms with low or high G+C% will experience substantial read-depth biases, however, more concerning is this failure to produce libraries from high G+C% templates. This bias will likely result in inaccurate representation of organisms in metagenomic and metatranscriptomic data generated on the PGM.</p>
      </sec>
      <sec id="s2d">
         <title>Replicate bias</title>
         <p>The artificial introduction of large groups of exact or near exact duplicate reads which share the same start site was first observed in Roche 454 pyrosequencing data <xref ref-type="bibr" rid="pcbi.1003031-Mariette1">[8]</xref>. This ‘replicate bias’ is generally attributed to issues within the emulsion PCR (emPCR) step <xref ref-type="bibr" rid="pcbi.1003031-GomezAlvarez1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1003031-Niu1">[10]</xref>. Ion Torrent library preparation also uses emPCR, making it potentially susceptible to this bias. For each run, we evaluated the distribution of read start positions, and found no obvious deviations from the uniform distribution. Consistent with Rothberg et al. <xref ref-type="bibr" rid="pcbi.1003031-Rothberg1">[1]</xref>, we find that despite the use of emulsion PCR, PGM sequences do not exhibit replicate bias.</p>
      </sec>
      <sec id="s2e">
         <title>Overview of PGM sequencing error</title>
         <p>Across the three kits, insertion/deletion (indel) errors were the dominant form of error in the reads (<xref ref-type="fig" rid="pcbi-1003031-g002"><bold>Figure 2</bold></xref>). Insertions were more common (0.84%, 2.69%, 1.76% of untrimmed bases in the 100 bp One Touch, 200 bp Manual, and 200 bp One Touch) than deletions (0.80%, 1.98%, 1.07% of untrimmed bases in the 100 bp One Touch, 200 bp Manual, and 200 bp One Touch). Substitutions errors were an order of magnitude less frequent than insertion/deletion errors, with a mean rate of 0.04%, 0.17% and 0.07% in the 100 bp OneTouch, 200 bp Manual and 200 bp OneTouch kits. In total, the mean error rate for each kit based on the sum of these error types is 1.68%, 4.84% and 2.90% for the 100 bp OneTouch, 200 bp manual and 200 bp OneTouch kits, with homopolymer errors responsible for between 96–97% of the total error. Substitution errors had the highest variation in frequency, with a standard deviation ranging from 26%–56% of the mean substitution rate. The standard deviation of indel errors was between 19%–34% of the mean indel rates. The raw indel error rates observed in our study (1.62%, 4.66% and 2.83% for each of the 100 bp One Touch, 200 bp Manual and 200 bp OneTouch kits) are substantially higher than reported for quality trimmed data (100 bp OneTouch – 1.1% <xref ref-type="bibr" rid="pcbi.1003031-Rothberg1">[1]</xref> using simple flow-cycle, 1.5% <xref ref-type="bibr" rid="pcbi.1003031-Loman1">[2]</xref> using Samba, 1.78% <xref ref-type="bibr" rid="pcbi.1003031-Quail1">[3]</xref> for the 200 bp manual using Samba flow-cycle). We attribute these differences to two factors, (1) our indel tolerance in read mapping which allows more of the data to map to the reference, and (2) the effect of quality trimming (discussed below).</p>
         <fig id="pcbi-1003031-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003031.g002</object-id><label>Figure 2</label>
            <caption>
               <title>Mean rates of insertion, deletion and substitution errors across the three sequencing kits.</title>
               <p>Each box-plot shows the distribution of error rates for the specified type across the runs for the specified kit (species are aggregated).</p>
            </caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003031.g002" position="float" xlink:type="simple"/></fig>
         <p>Similar to Roche 454 pyrosequencing <xref ref-type="bibr" rid="pcbi.1003031-Huse1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003031-Gilles1">[12]</xref>, indel-error rates increase with distance from the read start (<xref ref-type="fig" rid="pcbi-1003031-g003"><bold>Figure 3a</bold></xref>). We also find that the substitution error rate increases towards the 3′ end of the read (<xref ref-type="fig" rid="pcbi-1003031-g003"><bold>Figure 3b</bold></xref>). Error rates were higher on the 316 chips, and the low G+C% organism (<italic>S. tokodaii</italic>) had a higher error rate than the mid G+C% organism (<italic>B. amyloliquefaciens</italic>) across all datasets. The high mean indel error rate in the 200 bp manual kit appears to be due to a more rapid deterioration in base calling accuracy along the length of the read relative to the 200 bp OneTouch kit (<xref ref-type="fig" rid="pcbi-1003031-g003"><bold>Figure 3a</bold></xref>).</p>
         <fig id="pcbi-1003031-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003031.g003</object-id><label>Figure 3</label>
            <caption>
               <title>Relationship between base position and error rate for homopolymer (over-call/under-call) versus substitution errors.</title>
               <p>Panel (a) shows the homopolymer error rate (insertion+deletion) by read base position, and panel (b) shows the substitution error rate by base position. Each line is the raw mean error rate for a single data-set with the kit and species as specified by the colour key.</p>
            </caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003031.g003" position="float" xlink:type="simple"/></fig>
      </sec>
      <sec id="s2f">
         <title>Homopolymer errors</title>
         <p>It has been previously reported that ‘homopolymer errors’ (a term originating from Roche 454 pyrosequencing) are the dominant error type in PGM data <xref ref-type="bibr" rid="pcbi.1003031-Loman1">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1003031-Quail1">[3]</xref>. Homopolymer errors are a consequence of inaccurate flow-values resulting in over (insertion/s) or under-calling (deletion/s) the length of homopolymeric regions. For consistency with the literature, we refer to these as homopolymer errors, but emphasise that over and under-called flows are not always associated with homopolymers of length two or more <xref ref-type="bibr" rid="pcbi.1003031-Balzer1">[13]</xref>, illustrated in <xref ref-type="fig" rid="pcbi-1003031-g004"><bold>Figure 4</bold></xref>. This distinction is particularly pertinent for PGM data, where over-calling any flow-position can lead to the insertion of additional bases, even in flows where a ‘negative flow-value’ (&lt;0.50) should have been called.</p>
         <fig id="pcbi-1003031-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003031.g004</object-id><label>Figure 4</label>
            <caption>
               <title>Examples of over-call/under-call errors in homopolymers of length less than 2.</title>
               <p>By aligning the read (derived from the rounded flow-values), and its corresponding reference sequence (considered the ‘true’ sequence) at the flow level, we can identify examples of over-calling a zero-length homopolymer (Flow Cycle #2), and under-calling a one-length homopolymer (Flow Cycle # 6). Flow Cycle #5 demonstrates a zero-length homopolymer being correctly called as zero.</p>
            </caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003031.g004" position="float" xlink:type="simple"/></fig>
         <p>On average, 52.5% of reads generated with the OneTouch 100 bp kit had no observed homopolymer errors. Using the 200 bp manual kit, the average percentage of error-free reads drops to 8.3%, but this is markedly improved by using the 200 bp OneTouch kit, with ∼22.2% of reads, on average, free of homopolymer errors (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s007">Figure S7</xref></bold>). Both 200 bp kits had a lower mean percentage of error-free reads when run on the 316 chip (4.4%–200 bp manual, 17.9%–200 bp OneTouch) versus the 314 (11.1%–200 bp manual, 26.7%–200 bp OneTouch). This difference suggests that even though only the size of the chip was varied, global well accuracy appears to be compromised by higher well densities. The 99<sup>th</sup> percentile for the number of errors per read was between 11–14 for the 100 bp kit, 33–38 for the 200 bp manual kit and 32–38 for the 200 bp OneTouch kit.</p>
         <p>As with Roche 454 <xref ref-type="bibr" rid="pcbi.1003031-Huse1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003031-Balzer2">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1003031-Quince1">[15]</xref>, base-calling accuracy decreases with the length of the homopolymer, with 6-mer calling accuracy approaching 68%±6.9% s.d using the OneTouch 200 bp kit (<xref ref-type="fig" rid="pcbi-1003031-g005"><bold>Figure 5</bold></xref>). However, unlike Roche 454, insertions are more likely than deletions when the ‘homopolymer’ length is less than two (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s008">Figure S8</xref></bold>). In fact, the accuracy of calling a zero length homopolymer was between 98.75% and 99.72% across the kits (a substantial contributor to the overall high insertion-rate). While insertions are the dominant error-type, they are more common for homopolymer lengths less than two, but are rapidly overtaken by deletions for homopolymers of length two or more (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s008">Figure S8</xref></bold>). The accuracy in calling a homopolymer is highly variable, even for short homopolymers (s.d of 0.5%–1.7% for 2-mer accuracy) suggesting that base-calling accuracy is not dependent on homopolymer length alone.</p>
         <fig id="pcbi-1003031-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003031.g005</object-id><label>Figure 5</label>
            <caption>
               <title>Calling accuracy decreases with homopolymer length.</title>
               <p>Lines show mean accuracy for each kit by reference homopolymer length, across bases 10–100 and bases 10–200, the latter range only relevant for the two 200 bp kits.</p>
            </caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003031.g005" position="float" xlink:type="simple"/></fig>
         <p>While initially measured at the base level, over-call/under-call errors are the consequence of inaccuracy at the flow-value level. Thus, relationships between error occurrence and features of the read and sequencing parameters are best examined directly at the flow-value level <xref ref-type="bibr" rid="pcbi.1003031-Quince1">[15]</xref>. Inspection of the error rate by flow position also shows a positive correlation between the homopolymer error rate and the flow position (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s009">Figure S9</xref></bold>). However, the error rates per flow are substantially higher than those observed per base, with homopolymer error rates approaching 20–30% at flow position 350 onwards for the 200 bp One Touch kit. Surprisingly, there is also an observed periodicity in the error rate, with the period remaining approximately constant, however the amplitude increases with distance from the first flow. Intuitively, this periodicity suggests that the error rate may be influenced by the position-within-a-flow cycle (PIC) in a non-linear way. Inspection of the relationship between PIC and error rate suggested no obvious parameterised function, so each PIC (0–31) is considered a different ‘factor’.</p>
         <p>Rather than directly modelling the errors, a double-generalised linear model (DGLM) was fitted to the flow-values. For a given homopolymer length and other factors, flow-values were approximately Gaussian distributed, however with a non-homogenous dispersion; that is, the mean and variance showed dependence on the explanatory variables, particularly homopolymer length (<xref ref-type="table" rid="pcbi-1003031-t003"><bold>Table 3</bold></xref><bold>, <xref ref-type="supplementary-material" rid="pcbi.1003031.s011">Table S1</xref></bold>). The mean effects for species, chip, homopolymer length, flow cycle and PIC were found to be important, however the machine used, and the read X and Y coordinates were not, and subsequently were removed from the model (<xref ref-type="sec" rid="s4"><bold>Methods</bold></xref>). The same set of factors were also found to significantly contribute to the dispersion. The model can be expressed as<disp-formula id="pcbi.1003031.e005"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003031.e005" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003031.e006" xlink:type="simple"/></inline-formula> is the flow-value, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003031.e007" xlink:type="simple"/></inline-formula> is the mean and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003031.e008" xlink:type="simple"/></inline-formula> is the log-variance. Both the mean and log variance are linear-predictors, that is,<disp-formula id="pcbi.1003031.e009"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003031.e009" xlink:type="simple"/></disp-formula>where here <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003031.e010" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003031.e011" xlink:type="simple"/></inline-formula> are coefficients taking a different value for each species, chip and PIC respectively; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003031.e012" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003031.e013" xlink:type="simple"/></inline-formula> are multipliers of the homopolymer length and flow cycle respectively; and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003031.e014" xlink:type="simple"/></inline-formula> is a constant. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003031.e015" xlink:type="simple"/></inline-formula> is similarly defined, with different values of the coefficients and the exponentiation to ensure a positive variance. Unlike Roche 454 pyrosequencing, where the prevalence of errors are a consequence of increasing variance in flow-calls (with insertions and deletions approximately equally likely <xref ref-type="bibr" rid="pcbi.1003031-Balzer2">[14]</xref>), it would seem that both the mean and variance are contributing to the over-call/under-call rate in Ion Torrent PGM sequences.</p>
         <table-wrap id="pcbi-1003031-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003031.t003</object-id><label>Table 3</label>
            <caption>
               <title>Estimated main and deviance effects for each explanatory variable in the double-generalised linear model.</title>
            </caption><alternatives><graphic id="pcbi-1003031-t003-3" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003031.t003" xlink:type="simple"/><table>
               <colgroup span="1">
                  <col align="left" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
               </colgroup>
               <thead>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">Variable</td>
                     <td align="left" rowspan="1" colspan="1">Coefficient (Mean effect)</td>
                     <td align="left" rowspan="1" colspan="1">P-value (Mean effect)</td>
                     <td align="left" rowspan="1" colspan="1">Coefficient (Dispersion)</td>
                     <td align="left" rowspan="1" colspan="1">P-Value (Dispersion)</td>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">Intercept</td>
                     <td align="left" rowspan="1" colspan="1">4.405×10<sup>−02</sup></td>
                     <td align="left" rowspan="1" colspan="1">p&lt;0.0001</td>
                     <td align="left" rowspan="1" colspan="1">−4.7120481</td>
                     <td align="left" rowspan="1" colspan="1">p&lt;0.0001</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">Species (<italic>S.tokodaii</italic>)</td>
                     <td align="left" rowspan="1" colspan="1">−2.606×10<sup>−03</sup></td>
                     <td align="left" rowspan="1" colspan="1">p&lt;0.0001</td>
                     <td align="left" rowspan="1" colspan="1">0.0309340</td>
                     <td align="left" rowspan="1" colspan="1">p&lt;0.0001</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">Chip 316</td>
                     <td align="left" rowspan="1" colspan="1">−2.527×10<sup>−03</sup></td>
                     <td align="left" rowspan="1" colspan="1">p&lt;0.0001</td>
                     <td align="left" rowspan="1" colspan="1">0.2013263</td>
                     <td align="left" rowspan="1" colspan="1">p&lt;0.0001</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">200 bp Manual Kit</td>
                     <td align="left" rowspan="1" colspan="1">−3.864×10<sup>−03</sup></td>
                     <td align="left" rowspan="1" colspan="1">p&lt;0.0001</td>
                     <td align="left" rowspan="1" colspan="1">0.0815632</td>
                     <td align="left" rowspan="1" colspan="1">p&lt;0.0001</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">200 bp OneTouch Kit</td>
                     <td align="left" rowspan="1" colspan="1">6.304×10<sup>−03</sup></td>
                     <td align="left" rowspan="1" colspan="1">p&lt;0.0001</td>
                     <td align="left" rowspan="1" colspan="1">−0.2425064</td>
                     <td align="left" rowspan="1" colspan="1">p&lt;0.0001</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">Homopolymer Length</td>
                     <td align="left" rowspan="1" colspan="1">9.754×10<sup>−01</sup></td>
                     <td align="left" rowspan="1" colspan="1">p&lt;0.0001</td>
                     <td align="left" rowspan="1" colspan="1">0.4862209</td>
                     <td align="left" rowspan="1" colspan="1">p&lt;0.0001</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">Cycle Number</td>
                     <td align="left" rowspan="1" colspan="1">−7.071×10<sup>−04</sup></td>
                     <td align="left" rowspan="1" colspan="1">p&lt;0.0001</td>
                     <td align="left" rowspan="1" colspan="1">0.1471443</td>
                     <td align="left" rowspan="1" colspan="1">p&lt;0.0001</td>
                  </tr>
               </tbody>
            </table></alternatives>
            <table-wrap-foot>
               <fn id="nt103">
                  <label/>
                  <p>Position-in-cycle (PIC) effects are in <bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s011">Table S1</xref></bold>. The intercept represents the mean effect (or dispersion effect) for an observation with all settings at baseline (baseline factors in this model taken to be <italic>B. amyloliquefaciens</italic>, 100 bp OneTouch Kit and Chip 314). The other coefficients are the differences from when their respective factor is changed from baseline.</p>
               </fn>
            </table-wrap-foot>
         </table-wrap>
         <p>As expected, the homopolymer length was the main contributor to the mean of the flow-value distribution (<xref ref-type="table" rid="pcbi-1003031-t003"><bold>Table 3</bold></xref>). Contrary to expectation, the coefficient for homopolymer length was not 1, but 0.975. Thus, with each additional base in a homopolymer, we see a decrease in the mean flow value of 0.025 (i.e. 0.975 main effect for a homopolymer of length 1, 1.95 for length 2 and so on). This shift downwards drives the increasing ‘gap’ between the deletion-rate versus the insertion-rate with increasing hompolymer length, consistent with our observation that deletions are the dominant error-type on longer homopolymers (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s008">Figure S8</xref></bold>).</p>
         <p>The cycle number imposed little influence on the mean of the flow-value distribution, but given its large dispersion coefficient and that it is a numeric variable as opposed to a factor, its contribution to the overall variance is the second largest from the third flow-cycle on. Interestingly, the chip, and kit made only small contributions to the mean of the flow-value distribution, but had large and substantial influences on the dispersion (<xref ref-type="table" rid="pcbi-1003031-t003"><bold>Table 3</bold></xref>). The newest template kit considered here, the 200 bp One Touch, exhibited significantly less dispersion (variance) in flow-value in contrast to the older kits.</p>
         <p>All PIC terms were found to significantly contribute to the mean, with some positions shifting the mean by −0.10 to +0.05, however the fitted effects were not consistent across PIC corresponding to the same nucleotide (<xref ref-type="fig" rid="pcbi-1003031-g006"><bold>Figure 6a</bold></xref><bold>, <xref ref-type="supplementary-material" rid="pcbi.1003031.s011">Table S1</xref></bold>). This may explain why obvious groupings of nucleotides (GC versus AT, pyrmidines versus purines) as a factor in the DGLM were not significant. However, the three largest effects for a PIC are attributed to T or A flows, and the magnitude of these effects result in indel error rates up to double that of other PIC (<xref ref-type="fig" rid="pcbi-1003031-g006"><bold>Figure 6b</bold></xref>). This suggests that sequencing of low G+C% species will result in a higher error rate than high G+C% species, consistent with the observation that <italic>S. tokodaii</italic> had a higher error rate than <italic>B. amyloliquefaciens</italic> (<xref ref-type="fig" rid="pcbi-1003031-g003"><bold>Figure 3</bold></xref>). While PIC 10 and 12 had substantial mean-effects, the contribution of these factors to the dispersion was less than fitted for other PICS that had substantially smaller mean-effects. Thus, these PICs consistently introduce a shift to the mean flow-value by −0.10 and +0.05 for PICS 10 and 12 respectively.</p>
         <fig id="pcbi-1003031-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003031.g006</object-id><label>Figure 6</label>
            <caption>
               <title>The influence of position in cycle (PIC, labelled 0–31) on flow-value distributions and consequently error rate and type.</title>
               <p>Panel (a) shows the coefficient (main-effect) of each flow cycle position as predictors of mean of the flow-value distribution. Panel (b) shows the error rate broken down by insertions and deletions for each PIC. These do not include flow-values for homopolymers where the reference homopolymer length is zero.</p>
            </caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003031.g006" position="float" xlink:type="simple"/></fig>
         <p>A caveat of our modelling approach (using the Gaussian model) is that we could not include homopolymers of length zero due to the difficulty of modelling a normal which can only take on positive values. Based on the empirical error rates for over-called zero flows, we found this error rate (similar to longer homopolymers) increases by cycle, and in particular, is higher for PICS with a large positive coefficient in the model (i.e. PIC 12, followed by PICs 16, 23, 0 etc.), and very low for PICS with a negative coefficient (PIC 10, 13, 26 etc.) (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s009">Figure S9</xref></bold>).</p>
         <p>We evaluated the fitted model visually, comparing predicted density from the model versus the empirical distribution (<xref ref-type="fig" rid="pcbi-1003031-g007"><bold>Figure 7</bold></xref>). Overall, we find the model fit is adequate, although we do note that there are some deviations from normality (less variance in earlier cycles, overpopular flow-values, assymetry). The empirical models are available from <ext-link ext-link-type="uri" xlink:href="http://ecogenomic.org/acacia" xlink:type="simple">http://ecogenomic.org/acacia</ext-link>. As we have identified clear chip and kit effects, we recommend using the aforementioned models generated from the same combination of chip and kit as to be analysed.</p>
         <fig id="pcbi-1003031-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003031.g007</object-id><label>Figure 7</label>
            <caption>
               <title>Comparison of predicted versus empirical distributions of flow-values for homopolymers of length 1–5.</title>
               <p>Predicted (solid line) and empirical distributions (dotted line) of flow-values for homopolymers of length 1–5 (colours - black, red, green, blue and teal), for flow cycles 2,5,9 (rows) and PIC 1,10 and 12 (columns) for species <italic>B. amyloliquefaciens</italic>. The low number of observations of homopolymers of length 5 is the likely cause for abnormal distributions for this homopolymer length. The ‘shoulders’ observed in the data are often due to unexpectedly high popularity of boundary flow-values (eg. 0.51, 1.49, 1.51…).</p>
            </caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003031.g007" position="float" xlink:type="simple"/></fig>
      </sec>
      <sec id="s2g">
         <title>Substitution errors</title>
         <p>The occurrence of substitution errors in Roche 454 pyrosequencing has previously been attributed to PCR processes <xref ref-type="bibr" rid="pcbi.1003031-Quince2">[16]</xref>, with an expected substitution error every 10<sup>5</sup>–10<sup>6</sup> bases <xref ref-type="bibr" rid="pcbi.1003031-Cline1">[17]</xref>. While PCR does contribute to the substitution rate, the substitution rates observed in this study (see above), can not be explained by this alone. We found that a disproportionately large number of substitution errors (between 16%–33% across the datasets) had a low-confidence flow-value call of 0.51. This is in contrast to the percentage of ‘correct’ 1-mer calls with a 0.51 flow-value call (0.4%). All substitutions with the flow-value 0.51 had a quality score lower than 20, 99% of them had a quality of 12 or less, thus quality scores can be a reasonable indicator of PGM introduced substitution errors.</p>
         <p>While transitions (C &lt;-&gt; T, G &lt;-&gt; A) are the most prevalent form of substitution reported in bacteria <xref ref-type="bibr" rid="pcbi.1003031-Ochman1">[18]</xref>, transitions from C to T and G to A were found to be equally likely with transversions from C to A and G to C for both species (<xref ref-type="fig" rid="pcbi-1003031-g008"><bold>Figure 8</bold></xref>). As these rates have not been corrected for the G+C% of the parent organisms (both with &lt;50% G+C), the proportion of substitutions which transition/transverse in higher G+C% organisms is likely larger than observed here. The novelty of this observation, in light of accepted substitution mechanisms, suggests that these substitutions are a consequence of the PGM sequencer, which is further reinforced by the prevalence of low confidence flow-calls for these substitutions. emPCR is an unlikely source of these errors, as transitions are the dominant substitution type for 454 GS FLX Titanium sequencing <xref ref-type="bibr" rid="pcbi.1003031-Quince2">[16]</xref>. Considering that the PGM introduces substitution errors at a rate of between 0.04%–0.1%, rare variants (single nucleotide polymorphisms) which occur at a frequency greater than 0.1% may be detected using the PGM platform.</p>
         <fig id="pcbi-1003031-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003031.g008</object-id><label>Figure 8</label>
            <caption>
               <title>Breakdown of substitution type as a proportion of all substitutions for each sequencing kit.</title>
            </caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003031.g008" position="float" xlink:type="simple"/></fig>
      </sec>
      <sec id="s2h">
         <title>A closer look at PGM quality scores</title>
         <p>Each quality score, <italic>q</italic>, generated by the PGM base-caller is Phred-based, where <italic>q</italic> = −10×log<sub>10</sub>(<italic>p</italic><sub>error</sub>). A quality score is assigned to each base using a pre-computed quality lookup-table distributed with each version of the PGM software. The lookup table uses six predictors of local quality, described elsewhere (Life Sciences Technical Note Version 2.0.1–2.20).</p>
         <p>For each Ion Torrent quality score, we evaluated the empirical rate of error for bases assigned to that quality score. Consistent with previous reports <xref ref-type="bibr" rid="pcbi.1003031-Rothberg1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003031-Loman1">[2]</xref>, we observe that the PGM quality scores underestimate the base accuracy, but observe that they have become more accurate with sequential sequencing kit releases (<xref ref-type="fig" rid="pcbi-1003031-g009"><bold>Figure 9</bold></xref>). The relationship between the empirical quality and the estimated quality is not strictly linear, potentially a consequence of the quality score look-up table method. As with Roche 454 quality scores, the qualities can be only used to detect inserted and substituted bases <xref ref-type="bibr" rid="pcbi.1003031-Huse1">[11]</xref>. We evaluated whether there was any relationship between position within the homopolymer and the assigned confidence. We found that even in correctly called bases within a homopolymer, there is a decrease in assigned quality along the homopolymer length (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s010">Figure S10</xref></bold>), as was found in Roche 454 pyrosequencing <xref ref-type="bibr" rid="pcbi.1003031-Huse1">[11]</xref>, although, overall the quality scores decrease more rapidly for inserted (error) bases. Counter intuitively, it is possible for the first base in a homopolymer run to have <italic>lower</italic> quality score than later bases, irrespective of whether the homopolymer is the correct length or not (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s010">Figure S10</xref></bold>). This could originate from penalties for local or environmental noise (P1 and P6 in the documentation), which allow individual base qualities to be adjusted if immediately upstream or downstream calls are noisy.</p>
         <fig id="pcbi-1003031-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003031.g009</object-id><label>Figure 9</label>
            <caption>
               <title>Ion Torrent quality scores versus empirically estimated quality score for base.</title>
               <p>The grey cloud surrounding the LOESS smoother function indicates the 95% confidence interval for the conditional mean. Individual observations for each quality are plotted as black points.</p>
            </caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003031.g009" position="float" xlink:type="simple"/></fig>
      </sec>
      <sec id="s2i">
         <title>How effective is Ion Torrent quality assurance?</title>
         <p>The base-calling software in the Torrent Suite (version 2.0.1) performs two quality assurance steps prior to outputting sequences. The first step evaluates the residual between observed flow values and predicted flow values, based on a model of the flow cell. Reads with residuals that produce a median absolute value greater than a given threshold are filtered from both the SFF and the FASTQ, as they are assumed polyclonal. The second step scans non-polyclonal reads to identify undesirable 3′ regions of the read, which are subsequently trimmed. Undesirable regions are defined as regions containing the adapter sequence (and beyond) as well as low-quality regions. Should both adapter and quality trims be specified, the more stringent trimming is used. The newly released Torrent Suite (2.20) introduced a third trimming approach which clips the read based on high-residual ionogram (HRI) 1-mer and 2-mer flow values, which may indicate ‘noisy’ flows. A high-residual 1-mer is in the range [0.50, 0.59] or [1.40, 1.49], a high residual 2-mer in the range [1.50, 1.59] or [2.41, 2.49] (Torrent User Documentation Version 2.2.0).</p>
         <p>We consider the influence of PGM quality and HRI trimming methods on error rates and other metrics for each of the sequencing kits (<xref ref-type="sec" rid="s4"><bold>Methods</bold></xref>, <xref ref-type="table" rid="pcbi-1003031-t004"><bold>Table 4</bold></xref>). For consistency, we initially apply our trimming, where we only consider the first 100 bp for the 100 bp OneTouch kit, and the first 200 bp for the 200 bp Manual and 200 bp OneTouch kits. We used the quality clip as specified in the SFF file, and calculated the clip points for HRI trimming. Very little improvement was gained by applying the quality clip after our analysis trimming. This suggests that only unmappable reads are removed by PGM quality clipping, and/or quality trimming is occurring after base 100 for the 100 bp OneTouch kit, and 200 for the 200 bp kits. This is to be expected, considering that only a long, consistently noisy region of the read could violate the quality threshold (mean of Q9 or less across 30 bp, i.e. 87.5% mean base accuracy). The addition of HRI trimming results in a substantial improvement over our ‘analysis’ treatment, with an absolute decrease in insertion and deletion rates by 0.23% to 1%, with generally greater improvements in the insertion rate over the deletion rate (<xref ref-type="table" rid="pcbi-1003031-t004"><bold>Table 4</bold></xref>). While there is asymmetry in the insertion versus deletion rate, we did not expect a disproportionate decrease in the insertion rate compared to the deletion rate after trimming. In an attempt to improve the deletion rate, we considered whether the addition of HRI 3-mers to this metric would account for our previous observation that deletions are more common in longer homopolymers, however this did not yield substantial improvements (<xref ref-type="table" rid="pcbi-1003031-t004"><bold>Table 4</bold></xref>).</p>
         <table-wrap id="pcbi-1003031-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003031.t004</object-id><label>Table 4</label>
            <caption>
               <title>Effect of quality and flow trimming on dataset metrics, aggregated by kit used.</title>
            </caption><alternatives><graphic id="pcbi-1003031-t004-4" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003031.t004" xlink:type="simple"/><table>
               <colgroup span="1">
                  <col align="left" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
               </colgroup>
               <thead>
                  <tr>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1">Treatment</td>
                     <td colspan="3" align="left" rowspan="1">AT</td>
                     <td colspan="3" align="left" rowspan="1">AT+QT</td>
                     <td colspan="3" align="left" rowspan="1">AT+QT+HRI</td>
                     <td colspan="3" align="left" rowspan="1">AT+QT+HRI3</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1">Kit</td>
                     <td align="left" rowspan="1" colspan="1">100</td>
                     <td align="left" rowspan="1" colspan="1">200M</td>
                     <td align="left" rowspan="1" colspan="1">200</td>
                     <td align="left" rowspan="1" colspan="1">100</td>
                     <td align="left" rowspan="1" colspan="1">200M</td>
                     <td align="left" rowspan="1" colspan="1">200</td>
                     <td align="left" rowspan="1" colspan="1">100</td>
                     <td align="left" rowspan="1" colspan="1">200M</td>
                     <td align="left" rowspan="1" colspan="1">200</td>
                     <td align="left" rowspan="1" colspan="1">100</td>
                     <td align="left" rowspan="1" colspan="1">200</td>
                     <td align="left" rowspan="1" colspan="1">200M</td>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td align="left" rowspan="1" colspan="1"><bold>Metric</bold></td>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">Insertion Rate (%)</td>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1">0.83</td>
                     <td align="left" rowspan="1" colspan="1">2.68</td>
                     <td align="left" rowspan="1" colspan="1">1.76</td>
                     <td align="left" rowspan="1" colspan="1">0.80</td>
                     <td align="left" rowspan="1" colspan="1">2.64</td>
                     <td align="left" rowspan="1" colspan="1">1.74</td>
                     <td align="left" rowspan="1" colspan="1">0.42</td>
                     <td align="left" rowspan="1" colspan="1">0.97</td>
                     <td align="left" rowspan="1" colspan="1">0.79</td>
                     <td align="left" rowspan="1" colspan="1">0.39</td>
                     <td align="left" rowspan="1" colspan="1">0.89</td>
                     <td align="left" rowspan="1" colspan="1">0.73</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">Deletion Rate</td>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1">0.80</td>
                     <td align="left" rowspan="1" colspan="1">2.00</td>
                     <td align="left" rowspan="1" colspan="1">1.08</td>
                     <td align="left" rowspan="1" colspan="1">0.77</td>
                     <td align="left" rowspan="1" colspan="1">1.97</td>
                     <td align="left" rowspan="1" colspan="1">1.07</td>
                     <td align="left" rowspan="1" colspan="1">0.45</td>
                     <td align="left" rowspan="1" colspan="1">0.87</td>
                     <td align="left" rowspan="1" colspan="1">0.59</td>
                     <td align="left" rowspan="1" colspan="1">0.43</td>
                     <td align="left" rowspan="1" colspan="1">0.81</td>
                     <td align="left" rowspan="1" colspan="1">0.56</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">Comparison homopolymer rate</td>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1">1.5% <xref ref-type="bibr" rid="pcbi.1003031-Loman1">[2]</xref></td>
                     <td align="left" rowspan="1" colspan="1">1.78 <xref ref-type="bibr" rid="pcbi.1003031-Quail1">[3]</xref></td>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1"/>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">Read length: 25th percentile</td>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1">99</td>
                     <td align="left" rowspan="1" colspan="1">199</td>
                     <td align="left" rowspan="1" colspan="1">199</td>
                     <td align="left" rowspan="1" colspan="1">99</td>
                     <td align="left" rowspan="1" colspan="1">199</td>
                     <td align="left" rowspan="1" colspan="1">199</td>
                     <td align="left" rowspan="1" colspan="1">90.0</td>
                     <td align="left" rowspan="1" colspan="1">105.0</td>
                     <td align="left" rowspan="1" colspan="1">167.0</td>
                     <td align="left" rowspan="1" colspan="1">85.0</td>
                     <td align="left" rowspan="1" colspan="1">99.0</td>
                     <td align="left" rowspan="1" colspan="1">160.0</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">Read length: 50th percentile</td>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1">990</td>
                     <td align="left" rowspan="1" colspan="1">199</td>
                     <td align="left" rowspan="1" colspan="1">199</td>
                     <td align="left" rowspan="1" colspan="1">99</td>
                     <td align="left" rowspan="1" colspan="1">199</td>
                     <td align="left" rowspan="1" colspan="1">199</td>
                     <td align="left" rowspan="1" colspan="1">98.0</td>
                     <td align="left" rowspan="1" colspan="1">170.0</td>
                     <td align="left" rowspan="1" colspan="1">198.0</td>
                     <td align="left" rowspan="1" colspan="1">98.0</td>
                     <td align="left" rowspan="1" colspan="1">164.0</td>
                     <td align="left" rowspan="1" colspan="1">198.0</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">Read length: 75th percentile</td>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1">100</td>
                     <td align="left" rowspan="1" colspan="1">200.0</td>
                     <td align="left" rowspan="1" colspan="1">200</td>
                     <td align="left" rowspan="1" colspan="1">100.0</td>
                     <td align="left" rowspan="1" colspan="1">200</td>
                     <td align="left" rowspan="1" colspan="1">200</td>
                     <td align="left" rowspan="1" colspan="1">99</td>
                     <td align="left" rowspan="1" colspan="1">199</td>
                     <td align="left" rowspan="1" colspan="1">199</td>
                     <td align="left" rowspan="1" colspan="1">99</td>
                     <td align="left" rowspan="1" colspan="1">198.0</td>
                     <td align="left" rowspan="1" colspan="1">199.00</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">% of data retained</td>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1">100.0</td>
                     <td align="left" rowspan="1" colspan="1">100.0</td>
                     <td align="left" rowspan="1" colspan="1">100.0</td>
                     <td align="left" rowspan="1" colspan="1">99.8</td>
                     <td align="left" rowspan="1" colspan="1">100.0</td>
                     <td align="left" rowspan="1" colspan="1">100.0</td>
                     <td align="left" rowspan="1" colspan="1">99.4</td>
                     <td align="left" rowspan="1" colspan="1">99.3</td>
                     <td align="left" rowspan="1" colspan="1">99.6</td>
                     <td align="left" rowspan="1" colspan="1">99.3</td>
                     <td align="left" rowspan="1" colspan="1">99.1</td>
                     <td align="left" rowspan="1" colspan="1">99.5</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">% error-free reads</td>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1">52.5</td>
                     <td align="left" rowspan="1" colspan="1">8.3</td>
                     <td align="left" rowspan="1" colspan="1">22.2</td>
                     <td align="left" rowspan="1" colspan="1">53.3</td>
                     <td align="left" rowspan="1" colspan="1">8.4</td>
                     <td align="left" rowspan="1" colspan="1">22.2</td>
                     <td align="left" rowspan="1" colspan="1">63.4</td>
                     <td align="left" rowspan="1" colspan="1">24.1</td>
                     <td align="left" rowspan="1" colspan="1">29.6</td>
                     <td align="left" rowspan="1" colspan="1">65.0</td>
                     <td align="left" rowspan="1" colspan="1">27.0</td>
                     <td align="left" rowspan="1" colspan="1">31.0</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">Errors per read: 50th percentile</td>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1">0</td>
                     <td align="left" rowspan="1" colspan="1">6</td>
                     <td align="left" rowspan="1" colspan="1">2</td>
                     <td align="left" rowspan="1" colspan="1">0</td>
                     <td align="left" rowspan="1" colspan="1">6</td>
                     <td align="left" rowspan="1" colspan="1">2</td>
                     <td align="left" rowspan="1" colspan="1">0</td>
                     <td align="left" rowspan="1" colspan="1">2</td>
                     <td align="left" rowspan="1" colspan="1">1</td>
                     <td align="left" rowspan="1" colspan="1">0</td>
                     <td align="left" rowspan="1" colspan="1">2</td>
                     <td align="left" rowspan="1" colspan="1">1</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">Errors per read: 75th percentile</td>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1">2</td>
                     <td align="left" rowspan="1" colspan="1">13</td>
                     <td align="left" rowspan="1" colspan="1">7</td>
                     <td align="left" rowspan="1" colspan="1">2</td>
                     <td align="left" rowspan="1" colspan="1">13</td>
                     <td align="left" rowspan="1" colspan="1">7</td>
                     <td align="left" rowspan="1" colspan="1">1</td>
                     <td align="left" rowspan="1" colspan="1">4</td>
                     <td align="left" rowspan="1" colspan="1">3</td>
                     <td align="left" rowspan="1" colspan="1">1</td>
                     <td align="left" rowspan="1" colspan="1">3</td>
                     <td align="left" rowspan="1" colspan="1">3</td>
                  </tr>
                  <tr>
                     <td align="left" rowspan="1" colspan="1">Errors per read: 99th percentile</td>
                     <td align="left" rowspan="1" colspan="1"/>
                     <td align="left" rowspan="1" colspan="1">13</td>
                     <td align="left" rowspan="1" colspan="1">35</td>
                     <td align="left" rowspan="1" colspan="1">36</td>
                     <td align="left" rowspan="1" colspan="1">12</td>
                     <td align="left" rowspan="1" colspan="1">35</td>
                     <td align="left" rowspan="1" colspan="1">35</td>
                     <td align="left" rowspan="1" colspan="1">6</td>
                     <td align="left" rowspan="1" colspan="1">12</td>
                     <td align="left" rowspan="1" colspan="1">13</td>
                     <td align="left" rowspan="1" colspan="1">5</td>
                     <td align="left" rowspan="1" colspan="1">11</td>
                     <td align="left" rowspan="1" colspan="1">12</td>
                  </tr>
               </tbody>
            </table></alternatives>
            <table-wrap-foot>
               <fn id="nt104">
                  <label/>
                  <p>AT = Analysis trim, QT = Quality trim, HRI = High-residual ionogram trim (1-mers and 2-mers), HRI3 = High-residual ionogram trim (1-mer, 2-mer, 3-mers). The ‘comparison homopolymer rates’ are taken from other literature using the same kit and level of quality assurance (both cases used Torrent Server version 1.5.0).</p>
               </fn>
            </table-wrap-foot>
         </table-wrap>
         <p>After default HRI clipping, the vast majority of reads in the 200 bp kits contained at least one error (<xref ref-type="table" rid="pcbi-1003031-t004"><bold>Table 4</bold></xref>), with the top 99<sup>th</sup> percentile as high as 6 for the 100 bp OneTouch kit, and 12–13 for both 200 bp kits (an error-rate of ∼6%). No obvious global metrics could be identified to filter these error-prone reads.</p>
      </sec>
   </sec>
   <sec id="s3">
      <title>Discussion</title>
      <p>As with any new sequencing technology, exploring the nuances of the data lays an essential foundation for developing platform-specific bioinformatics methods. The goal of this study was to provide a comprehensive evaluation of the types of errors and biases introduced during PGM library preparation and sequencing. Previous studies which used the manufacturers aligner, ‘tmap’, on default settings implicitly removed reads with two or more indels prior to data analysis <xref ref-type="bibr" rid="pcbi.1003031-Loman1">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1003031-Quail1">[3]</xref>. As these filtered reads can only be distinguished with the benefit of a reference genome, such studies are more relevant for re-mapping applications. By using an indel-tolerant mapping approach, we were able to map almost 100% of the reads, which largely explains why the global base error-rates calculated in this study are higher than previously reported.</p>
      <p>Even after applying the quality trimming used for the initial Ion Torrent studies, we found that our estimate of quality-clipped accuracy for the 100 bp OneTouch kit was substantially lower than first reported. The first Ion Torrent study was conducted prior to the changes in the flow-cycle pattern, a change implemented to improve synchronicity between reads on the same bead. By analysing the flow-values, we are able to show that this change in the flow-pattern results in specific positions within the flow cycle being more susceptible to over-call/under-call error than others. Error-prone cycles tend to be ‘A’ or ‘T’ flows, and unlike Roche 454, over-calls of zero length homopolymers and under-calling homopolymers of length one are not improbable. We find that insertions are more common than deletions overall, however, under-calling (deletions) rapidly becomes the dominant error type with increasing homopolymer length. The variance of flow-values with respect to homopolymer length, cycle number, and position-within a cycle (PIC) will present challenges to studies, such as indel variant detection, which often assume a global base error rate. Consequently, higher read coverage and use of PGM flow-specific error rates will be required for applications to confidently distinguish PGM indel errors from genuine variants. However, the substitution error rate, which occurs at an order of magnitude lower than the indel error rate (0.04%–0.1%), suggests that Ion Torrent could be used to detect SNP variants that occur at frequencies greater than 0.1%.</p>
      <p>Through the use of replicates and modelling of flow-values, we are able to identify high frequency indel (HFI) errors that could easily be mistaken for polymorphisms in the absence of replicates. Flow-level analyses suggest that these errors do not correlate with factors implicated in over-call/under-call errors. The frequency of HFIs with respect to the reference genome will yield undesirable results for a number of applications. For example, in polymorphism detection, HFI regions will yield false positives <xref ref-type="bibr" rid="pcbi.1003031-Elliott1">[5]</xref>. In assembly, these regions yield unresolvable differences <xref ref-type="bibr" rid="pcbi.1003031-Loman1">[2]</xref> or frame-shifts. Amplicon sequencing will suffer both from run-specific HFI errors and synchronised over-call/under-call errors; it is expected that amplicons from closely related species will be synchronised in their called flows, thus exposing them to much higher error rates as a result of noisy PICs. Given the difficulty of detecting HFIs in isolation, we recommend generating two or more datasets from the same starting DNA to resolve the majority of HFI errors (i.e. run-specific HFIs).</p>
      <p>Consistent with previous results, we find the PGM introduces coverage bias against low and high G+C% sequences, with evidence suggesting that attempts to sequence high G+C% organisms (greater than 65% G+C%) may even fail during the PGM library preparation. Although the mechanisms behind these failed libraries are not evaluated here, we anticipate they will bias representation of high G+C% organisms in metagenomes and metatranscriptomes.</p>
      <p>As expected for a new technology, there have been marked improvements in the PGM since its limited release in January, 2011. The newest kit considered in this study, the 200 bp OneTouch, has substantially reduced the error rates observed in the 200 bp Manual kit.</p>
      <p>Furthermore, the accuracy of PGM quality scores has improved markedly with each kit release. The addition of HRI-based clipping (as of Torrent Server 2.2.0) to complement the relatively lax quality trim has proven extremely effective at removing the error-prone 3′ end of the reads, albeit at a cost of 20–30 bp of read length. For datasets processed with older versions of Torrent Server, we highly recommend re-running the PGM analysis to improve run quality. However, trimming cannot remove all errors. Thus, we recommend that researchers who intend to use or develop methods for analysing PGM data take into account that the PGM has a higher error-rate than both Illumina and 454, and that PGM global base error rates are poor substitutes for flow error rates. Armed with the models developed in this study, bioinformaticians can develop platform-specific approaches for the PGM that adequately account for the majority of errors introduced by this platform.</p>
   </sec>
   <sec id="s4" sec-type="methods">
      <title>Methods</title>
      <sec id="s4a">
         <title>DNA</title>
         <p>DNA for <italic>Bacillus amyloliquefaciens</italic> subsp. <italic>amyloliquefaciens</italic> DSM7, <italic>Deinococcus maricopensis</italic> DSM 21211 and <italic>Sulfolobus tokodaii</italic> DSM 16993, was acquired from the Leibniz-Institut DSMZ – German Collection of Microorganisms and Cell Cultures. These organisms were selected as they had small genomes consisting of a single chromosome, no plasmids, and complete reference genomes. They were also selected to span a range of mean genomic G+C% (<italic>B. amyloliquefaciens</italic> 46.1%, <italic>D. maricopensis</italic> 69.8%, <italic>S. tokodaii</italic> 32.8%). The SFF files for all <italic>B. amyloliquefaciens</italic> and <italic>S. tokodaii</italic> datasets are available from <ext-link ext-link-type="uri" xlink:href="http://ecogenomic.org/acacia" xlink:type="simple">http://ecogenomic.org/acacia</ext-link>.</p>
      </sec>
      <sec id="s4b">
         <title>Library preparation and sequencing</title>
         <p>For the 100 bp libraries, 100 ng of genomic DNA was sheared by adaptive focused acoustics using a Covaris S2 (Covaris Inc.) and Covaris Micro-tubes and using the method and shearing conditions described in the Ion Fragment Library Kit (publication 4467320 Rev. B) protocol. For 200 bp libraries, 200 ng of genomic DNA was also sheared using a Covaris S2, with modification of the shearing conditions (intensity, 4; time, 27 sec). The remaining steps in the library preparation were performed using the Ion Plus Fragment Library Kit, using the corresponding User Guide (Publication 4471989 Rev. B), with modification. Due to the shearing volume required for the Covaris S2 micro-tubes, the sheared DNA samples were treated as if they were 1 µg samples, in the end repair steps, as this catered for a larger starting volume. From that point forward the library was treated as if the input was 100 ng. Following adapter ligation and nick repair, the library was size selected using a Pippin Prep (Sage Science) instrument, followed by 6 cycles of amplification.</p>
         <p>Using the Agilent 2100 Bioanalyzer (Agilent Technologies) with the High Sensitivity DNA Kit (Agilent Technologies), the quality, size and concentration of the libraries was determined and the library was diluted, prior to template preparation, so as to keep polyclonal values in the sequencing results to a minimum. For 100 bp libraries, the Ion OneTouch system (composed of the Ion OneTouch Instrument and Ion OneTouch ES) was used to prepare the template, using the methods outlined in the Ion OneTouch Template Kit and associated User Guide (Publication 4468007 Rev. E). 200 bp libraries were prepared either manually, using the Ion Xpress Template 200 Kit and associated User Guide (Publication 4471974 Rev. C), or using the Ion OneTouch system, using the Ion OneTouch 200 Template Kit and associated User Guide (Publication 4472430 Rev C.).</p>
         <p>100 bp templates were sequenced using the Ion Sequencing Kit and user guide (Publication 4469714 Rev. C). Manually prepared 200 bp templates were sequenced using the Ion Sequencing 200 Kit, using methods outlined in the corresponding User Guide (Publication 4471999 Rev. B), while 200 bp templates prepared using the OneTouch system were sequenced using the Ion PGM 200 Sequencing Kit and the associated User Guide (Publication 4474246 Rev. B). The Ion Torrent Suite 2.0.1 was used for all analyses and the SFF was subsequently downloaded for analysis. Test runs for <italic>D. maricopensis</italic> either failed to produce viable libraries, or produced very few reads of low quality, so sequencing this species was no longer pursued.</p>
         <p>A factorial design was used for estimating variability due to Chip, Species and Kit, consisting initially of 8 sequencing runs (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s012">Table S2</xref></bold>). A second experiment using a randomised Plackatt-Burman design consisting of 4 runs was conducted to help estimate inter-machine variability (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s013">Table S3</xref></bold>). However, the Ion Xpress Template 200 kit was phased out during the experiment, preventing the completion of the final experiment. The release of a new kit part-way through the data-generation necessitated the addition of four new datasets, also conducted using a Plackatt-Burman design (<bold><xref ref-type="supplementary-material" rid="pcbi.1003031.s014">Table S4</xref></bold>). In total, 15 datasets were generated.</p>
      </sec>
      <sec id="s4c">
         <title>Read preparation and alignment</title>
         <p>The unclipped reads, flows and qualities were extracted from the SFF. The location of the predicted adapter sites for each read was also extracted. Only reads with an adapter site were clipped to the recommended length. All reads retained their flow key (the first four called bases in every read, TACG) to maintain ease of moving between a base and flow-value coordinate system. Flow and cycle coordinate systems reported start from zero, and base positions start from one.</p>
         <p>The reference sequence for each genome was downloaded from NCBI, and converted to run-length encoded <xref ref-type="bibr" rid="pcbi.1003031-Reeder1">[19]</xref> (RLE) form (<italic>S. tokodaii</italic> - NC_003106.2, <italic>B. amyloliquefaciens</italic> NC_014551.1, and <italic>D. maricopensis</italic> NC_014958.1). Each read was also collapsed to its RLE form (i.e. homopolymers collapsed into a single base). This reduces the influence of numerous homopolymer errors on the alignment thresholds, as well as making it easier to transition between flow and base coordinates.</p>
         <p>Each read was aligned to its respective reference genome using Segemehl version 0.1.2 <xref ref-type="bibr" rid="pcbi.1003031-Hoffmann1">[20]</xref>, an InDel tolerant short-read aligner. The alignment output was parsed and the aligned regions extracted from both the read and reference RLEs. This was necessary as both substitutions and identical bases are reported as matches (‘M’) in the SAM format generated by this version of Segemehl. Using the SeqOp string and the aligned sequence segments, each position in the alignment was recorded as a match, substitution, insertion or deletion. Using a set of in-house Perl scripts and SQL databases, the alignment positions were mapped to their relevant flow-value, base position/s and quality scores. Read level attributes such as average quality, average G+C% in 100 bp windows and read length were also calculated. To avoid over-inflation of the error rate due to (1) 5′ misalignments and (2) homopolymers which overlapped the last base of the key and the first base/s of the read, we only consider base positions 10 and greater for analysis. Furthermore, analysis was restricted to the first 100 bp for the Ion OneTouch Template Kit (100 bp reads), and 200 bp for the Ion Xpress Template 200 and Ion OneTouch 200 Template kits, as the number of reads longer than this decreased rapidly leading to exaggerated error rates at these base positions.</p>
      </sec>
      <sec id="s4d">
         <title>Statistical filtering and analysis</title>
         <sec id="s4d1">
            <title>Repeats</title>
            <p>MUMmer 3.22 <xref ref-type="bibr" rid="pcbi.1003031-Kurtz1">[21]</xref> (program ‘repeat-match’ with parameter –n 30) was used to identify regions of perfect match repeats within the reference genomes. These regions were masked from all downstream analysis.</p>
         </sec>
         <sec id="s4d2">
            <title>Polymorphisms</title>
            <p>While the sequenced type strains for each species were used, there is still potential for polymorphic differences between the cultured strains and the reference genome. Classification and consequent masking of these genomic locations in the reference allows more accurate modeling of error rates in downstream analyses.</p>
            <p>Beginning with substitution differences between the read and reference, we simply modeled the observed number of differences, <italic>X</italic>, at each reference position as a binomial, with the probability of substitution estimated from the data (mean substitution rate). Due to the large number of comparisons, the p-values were corrected using Holm's method <xref ref-type="bibr" rid="pcbi.1003031-Holm1">[22]</xref>. The significance threshold was taken to be 0.05. A similar approach was adopted for detecting insertion and deletion polymorphisms, however, in the case of single-base insertions (over-calls of zero) the coverage of the site was taken to be the maximum coverage of the bases immediately adjacent to the insert. The probability of an insertion or deletion was also estimated from the data, but parameterised on the homopolymer length, as previous reports have shown that the error rate increases dramatically with homopolymer length <xref ref-type="bibr" rid="pcbi.1003031-Loman1">[2]</xref>.</p>
            <p>Strand-asymmetry of high frequency indels was only evaluated on the indel polymorphisms found in the 200 bp kits (both Manual and OneTouch), and only for sites that had reads mapping in both orientations. For each site, the data form a 2×2 table, namely strand by presence/absence of indel. We therefore used Fisher's exact test to generate a p-value for every site, testing the null hypothesis that indel frequency at that site was not orientation specific. The p-values were then adjusted to control the family-wise error rate using Holm's method <xref ref-type="bibr" rid="pcbi.1003031-Holm1">[22]</xref>. Only sites with corrected p-values smaller than 5% were considered to demonstrate significant evidence of orientation specific indel frequencies at that site. Using this approach, the orientation specificity may differ by site. (The analysis was repeated using a chi-squared test in place of Fisher's exact test with similar results).</p>
         </sec>
         <sec id="s4d3">
            <title>Replicate bias</title>
            <p>To prevent reference end-effects and repeat-effects, we used repeat-masked data and ignored the first and last 120 bp of the reference genome. We visually identified whether the distribution of read starting position (5′ aligned position) on the reference genome was uniformly distributed for each individual run.</p>
         </sec>
         <sec id="s4d4">
            <title>G+C% bias in read coverage</title>
            <p>To evaluate whether there was a relationship between G+C content and read depth, we calculated the average coverage of bases within disjoint 100 bp windows across the genome, as well as G+C% also calculated for these windows. Areas expected to have high or low coverage for processing reasons were masked from the analysis, these included the first and last 120b of the reference genome, as well as genomic 100 bp bins that contained repetitive sequences. The coverage was normalised for each run by dividing the coverage in each window by the mean coverage across all windows for that run. A square-root transformation was applied to the run-normalised coverage. After initial inspection, we identified that a number of very large coverage values were the result of an un-masked LSU rRNA in the <italic>B. amyloliquefaciens</italic> genome. This small region was masked prior to G+C modeling. The relationship between the square-root normalised coverage and G+C% content was evaluated by fitting linear models using the <italic>lm</italic> function in the R statistical package.</p>
         </sec>
         <sec id="s4d5">
            <title>Error rates</title>
            <p>Base-error rates were calculated as the number of errors in the alignment, divided by the length of the alignment. This was to ensure that deletion errors, which are quite common on this platform, would be reflected by the error rate. Flow-error rates were calculated as the number of incorrect flow-calls divided by the total number of flow-calls. For specific break-downs (such as error rate for homopolymer of length X), it was the number of miscalled X-mer flows, divided by the total number of flows which were, or should have been, an X-mer, according to the reference genome.</p>
         </sec>
         <sec id="s4d6">
            <title>Modeling flow values</title>
            <p>Given RAM restrictions, a random subset of 18 million observations (flows) were sampled from all datasets as input to model fitting. Note that true zero calls and over-calls of a zero were not included in the model, as zero-flows were unlikely to be well-approximated by a Gaussian. The flow-values were then modeled as normally distributed, using a variety of read attributes (including chip, kit, machine, flow position, well x-coordinate, well y-coordinate, nucleotide, position in cycle (PIC), nucleotide, pyrimidine versus purine). As the flow-values for each homopolymer length did not share a constant variance, these needed to be modeled using a double generalised linear model (DGLM), which simultaneously models the mean and dispersion. In the DGLM used here, the mean was a Gaussian linear model and the dispersion was linear on a log-scale. Only terms with an effect size greater than 0.001 were retained in the model. While the PIC showed the strongest relationship with the flow error-rate, we considered the replacement of PIC with simpler terms, such as the nucleotide flowed or pyrimidine versus purine, however this was detrimental to the model. Based on these choices, a simpler model was created and assessed against the full-model for significance using ANOVA. Some terms removed were statistically significant (x-pos, y-pos, machine), however were practically unimportant contributing only a very small amount to the modeled flow value. We emphasise that the purpose of this statistical model is not to test for significant factors, but to produce usable predictions.</p>
         </sec>
         <sec id="s4d7">
            <title>Quality score analysis</title>
            <p>Each run was analysed individually to identify the accuracy of empirical quality scores. For each Ion Torrent quality score, we examined the error rate of bases assigned that score, and calculated the associated Phred score based on the error rate. To analyse the relationship between quality score and position within homopolymer, we sampled 20,000 reads from each run, and calculated the relative change in quality score from the first base to later bases within each homopolymer. We also recorded whether each of these consecutive bases was a correct call or an over-call.</p>
         </sec>
         <sec id="s4d8">
            <title>Quality trimming</title>
            <p>The PGM quality clip was extracted from the SFF file produced from Torrent Server 2.0.1. To emulate the PGM HRI trim approach, we calculated the percentage of HRI 1-mers and 2-mers out of the total 1-mer and 2-mer calls in the read, and continued clipping from the 3′ end until this percentage reached 3% or less (Torrent User Documentation 2.20). Our third HRI trim approach included HRI 3-mers (defined as flow-values in [2.50, 2.59] or [3.40, 3.49] in this calculation. As with the Torrent Server software, reads shorter than 4 bp after clipping were ignored.</p>
         </sec>
         <sec id="s4d9">
            <title>Graphs</title>
            <p>Graphics used throughout this manuscript were produced either using the R base package or ggplot2 package <xref ref-type="bibr" rid="pcbi.1003031-Wickham1">[23]</xref>.</p>
         </sec>
      </sec>
   </sec>
   <sec id="s5">
      <title>Supporting Information</title>
<supplementary-material id="pcbi.1003031.s001" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003031.s001" position="float" xlink:type="simple">
<label>Figure S1</label>
<caption><p><bold>Read length density functions for kit and species.</bold> Note that both One Touch kits produce a small peak around 100 bp longer than the mode length.</p>
      <p>(EPS)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003031.s002" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003031.s002" position="float" xlink:type="simple">
<label>Figure S2</label>
<caption><p><bold>Intersection of HFI sites across 200 bp runs for each species.</bold> Panel <bold>a</bold>) shows the overlap between HFI sites detected in <italic>B. amyloliquefaciens</italic> 200 bp runs, and panel <bold>b</bold>) shows the HFI site overlaps for <italic>S. tokodaii</italic> 200 bp runs, panel, <bold>c</bold>) shows the overlap between strand-asymmetric HFI sites detected in <italic>B. amyloliquefaciens</italic> 200 bp runs, and <bold>d</bold>) shows the overlap between strand-asymmetric HFI sites detected in <italic>S. tokodaii</italic> 200 bp runs. Red font highlights the HFI instances unique to a given run.</p>
      <p>(EPS)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003031.s003" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003031.s003" position="float" xlink:type="simple">
<label>Figure S3</label>
<caption><p><bold>Type and frequency of HFI by indel type.</bold> Panel <bold>a</bold>) shows the HFI instances across all 200 bp runs (both species), broken down by error type and nucleotide, and <bold>b</bold>) shows the strand-asymmetric HFI instances broken down by error type and nucleotide.</p>
      <p>(EPS)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003031.s004" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003031.s004" position="float" xlink:type="simple">
<label>Figure S4</label>
<caption><p><bold>Linear model fit diagnostics plots for G+C% versus coverage.</bold> Using a subset of data-points, these plots show the standard linear model diagnostics for the G+C versus coverage linear model. The data is not strictly normal as the response variable (coverage) is based on count data. The small number of zero coverage regions are the outliers in the ‘Residual versus Fitted’ plot, and the deviation from the normal quantiles in the ‘Normal Q-Q’ plot. Unmasked repetitive regions are the likely cause for outliers with high leverage ‘Residuals versus Leverage’ plot.</p>
      <p>(TIFF)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003031.s005" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003031.s005" position="float" xlink:type="simple">
<label>Figure S5</label>
<caption><p><bold>Smoothed normalised coverage versus proportion G+C content in 100 bp windows for three species.</bold></p>
      <p>(EPS)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003031.s006" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003031.s006" position="float" xlink:type="simple">
<label>Figure S6</label>
<caption><p><bold>Number of errors found within reads.</bold> These plots exclude reads with more than 30 errors.</p>
      <p>(EPS)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003031.s007" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003031.s007" position="float" xlink:type="simple">
<label>Figure S7</label>
<caption><p><bold>Error-rate for insertions versus deletions by homopolymer length.</bold> Rows correspond to restriction on base position considered for error-rate (maximum base 100 versus maximum base 200) Columns correspond to the kit analysed. Observations are the error-rate by flow position for the respective homopolymer length.</p>
      <p>(EPS)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003031.s008" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003031.s008" position="float" xlink:type="simple">
<label>Figure S8</label>
<caption><p><bold>Relationship between flow-call error-rate and flow position.</bold> It is clear from these figures that the main effect is increasing with the number of flow cycles. The 316 chip has a higher error rate than the 314, and <italic>S. tokodaii</italic> is more error-prone than <italic>B. amyloliquefaciens</italic>. Periodicity is observed in the error rate with a peak and trough occurring regularly in each plot.</p>
      <p>(EPS)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003031.s009" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003031.s009" position="float" xlink:type="simple">
<label>Figure S9</label>
<caption><p><bold>Over-call rates for zero length homopolymer by position-in-cycle (PIC).</bold> Consistent with our DGLM based on calls for 1-mers or longer, we find that over-calls of zero occur in the PICs with a positive coefficient in the model. Most notable is position-in-cycle 12.</p>
      <p>(EPS)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003031.s010" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003031.s010" position="float" xlink:type="simple">
<label>Figure S10</label>
<caption><p><bold>Relationship between quality scores and position in homopolymer.</bold> The x-axis shows the base number in the homopolymer, the y-axis shows the relative change (qual(base 1) – qual(base x)/qual(base 1)) from the quality of the first base.</p>
      <p>(EPS)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003031.s011" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1003031.s011" position="float" xlink:type="simple">
<label>Table S1</label>
<caption><p><bold>Coefficients for main and dispersion for position-in-cycle (PIC) effects in generalised linear model for flow-values.</bold></p>
      <p>(DOCX)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003031.s012" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1003031.s012" position="float" xlink:type="simple">
<label>Table S2</label>
<caption><p><bold>Sequencing runs in the full-factor design.</bold></p>
      <p>(DOCX)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003031.s013" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1003031.s013" position="float" xlink:type="simple">
<label>Table S3</label>
<caption><p><bold>Randomised Plackatt-Burman design for sequencing runs using OneTouch 100 kit and Ion Express Template kit.</bold></p>
      <p>(DOCX)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1003031.s014" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1003031.s014" position="float" xlink:type="simple">
<label>Table S4</label>
<caption><p><bold>Randomised Plackatt-Burman design for sequencing runs using OneTouch 200 bp kit.</bold></p>
      <p>(DOCX)</p>
</caption></supplementary-material>
   </sec>
</body>
<back>
   <ack>
      <p>We thank Serene Low for assistance with the Ion Torrent PGM sequencing.</p>
   </ack>
   <ref-list>
      <title>References</title>
      <ref id="pcbi.1003031-Rothberg1"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rothberg</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Hinz</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Rearick</surname><given-names>TM</given-names></name>, <name name-style="western"><surname>Schultz</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Mileski</surname><given-names>W</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>An integrated semiconductor device enabling non-optical genome sequencing</article-title>. <source>Nature</source> <volume>475</volume>: <fpage>348</fpage>–<lpage>352</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature10242" xlink:type="simple">10.1038/nature10242</ext-link></comment>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Loman1"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Loman</surname><given-names>NJ</given-names></name>, <name name-style="western"><surname>Misra</surname><given-names>RV</given-names></name>, <name name-style="western"><surname>Dallman</surname><given-names>TJ</given-names></name>, <name name-style="western"><surname>Constantinidou</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Gharbia</surname><given-names>SE</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Performance comparison of benchtop high-throughput sequencing platforms</article-title>. <source>Nat Biotech</source> <volume>30</volume>: <fpage>434</fpage>–<lpage>439</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2198" xlink:type="simple">10.1038/nbt.2198</ext-link></comment>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Quail1"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Quail</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Coupland</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Otto</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Harris</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>A tale of three next generation sequencing platforms: comparison of Ion torrent, pacific biosciences and illumina MiSeq sequencers</article-title>. <source>BMC Genomics</source> <volume>13</volume>: <fpage>341</fpage>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Barrick1"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Barrick</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>DS</given-names></name>, <name name-style="western"><surname>Yoon</surname><given-names>SH</given-names></name>, <name name-style="western"><surname>Jeong</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Oh</surname><given-names>TK</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Genome evolution and adaptation in a long-term experiment with Escherichia coli</article-title>. <source>Nature</source> <volume>461</volume>: <fpage>1243</fpage>–<lpage>1247</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature08480" xlink:type="simple">10.1038/nature08480</ext-link></comment>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Elliott1"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Elliott</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Radecki</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Moghis</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Kammesheidt</surname><given-names>A</given-names></name> (<year>2012</year>) <article-title>Rapid detection of the ACMG/ACOG-recommended 23 CFTR disease-causing mutations using ion torrent semiconductor sequencing</article-title>. <source>Journal of biomolecular techniques (JBT)</source> <volume>23</volume>: <fpage>24</fpage>–<lpage>30</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Quail2"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Quail</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Kozarewa</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Scally</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Stephens</surname><given-names>PJ</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>A large genome center's improvements to the Illumina sequencing system</article-title>. <source>Nat Meth</source> <volume>5</volume>: <fpage>1005</fpage>–<lpage>1010</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1270" xlink:type="simple">10.1038/nmeth.1270</ext-link></comment>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Aird1"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aird</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Ross</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>W-S</given-names></name>, <name name-style="western"><surname>Danielsson</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Fennell</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Analyzing and minimizing PCR amplification bias in Illumina sequencing libraries</article-title>. <source>Genome Biology</source> <volume>12</volume>: <fpage>R18</fpage>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Mariette1"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mariette</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Noirot</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Klopp</surname><given-names>C</given-names></name> (<year>2011</year>) <article-title>Assessment of replicate bias in 454 pyrosequencing and a multi-purpose read-filtering tool</article-title>. <source>BMC Research Notes</source> <volume>4</volume>: <fpage>149</fpage>.</mixed-citation></ref>
      <ref id="pcbi.1003031-GomezAlvarez1"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gomez-Alvarez</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Teal</surname><given-names>TK</given-names></name>, <name name-style="western"><surname>Schmidt</surname><given-names>TM</given-names></name> (<year>2009</year>) <article-title>Systematic artifacts in metagenomes from complex microbial communities</article-title>. <source>ISME J</source> <volume>3</volume>: <fpage>1314</fpage>–<lpage>1317</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Niu1"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Niu</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Fu</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Sun</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>W</given-names></name> (<year>2010</year>) <article-title>Artificial and natural duplicates in pyrosequencing reads of metagenomic data</article-title>. <source>BMC Bioinformatics</source> <volume>11</volume>: <fpage>187</fpage>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Huse1"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huse</surname><given-names>SM</given-names></name>, <name name-style="western"><surname>Huber</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Morrison</surname><given-names>HG</given-names></name>, <name name-style="western"><surname>Sogin</surname><given-names>ML</given-names></name>, <name name-style="western"><surname>Mark Welch</surname><given-names>D</given-names></name> (<year>2007</year>) <article-title>Accuracy and quality of massively parallel DNA pyrosequencing</article-title>. <source>Genome Biol</source> <volume>8</volume>: <fpage>R143</fpage>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Gilles1"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gilles</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Meglecz</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Pech</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Ferreira</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Malausa</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Accuracy and quality assessment of 454 GS-FLX Titanium pyrosequencing</article-title>. <source>BMC Genomics</source> <volume>12</volume>: <fpage>245</fpage>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Balzer1"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Balzer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Malde</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Lanzen</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sharma</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Jonassen</surname><given-names>I</given-names></name> (<year>2010</year>) <article-title>Characteristics of 454 pyrosequencing data-enabling realistic simulation with flowsim</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>i420</fpage>–<lpage>i425</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Balzer2"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Balzer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Malde</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Jonassen</surname><given-names>I</given-names></name> (<year>2011</year>) <article-title>Systematic exploration of error sources in pyrosequencing flowgram data</article-title>. <source>Bioinformatics</source> <volume>27</volume>: <fpage>i304</fpage>–<lpage>i309</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr251" xlink:type="simple">10.1093/bioinformatics/btr251</ext-link></comment>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Quince1"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Quince</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Lanzen</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Curtis</surname><given-names>TP</given-names></name>, <name name-style="western"><surname>Davenport</surname><given-names>RJ</given-names></name>, <name name-style="western"><surname>Hall</surname><given-names>N</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Accurate determination of microbial diversity from 454 pyrosequencing data</article-title>. <source>Nat Methods</source> <volume>6</volume>: <fpage>639</fpage>–<lpage>641</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Quince2"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Quince</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Lanzen</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Davenport</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Turnbaugh</surname><given-names>P</given-names></name> (<year>2011</year>) <article-title>Removing Noise From Pyrosequenced Amplicons</article-title>. <source>BMC Bioinformatics</source> <volume>12</volume>: <fpage>38</fpage>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Cline1"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cline</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Braman</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Hogrefe</surname><given-names>HH</given-names></name> (<year>1996</year>) <article-title>PCR Fidelity of Pfu DNA Polymerase and Other Thermostable DNA Polymerases</article-title>. <source>Nucleic Acids Research</source> <volume>24</volume>: <fpage>3546</fpage>–<lpage>3551</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/24.18.3546" xlink:type="simple">10.1093/nar/24.18.3546</ext-link></comment>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Ochman1"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ochman</surname><given-names>H</given-names></name> (<year>2003</year>) <article-title>Neutral Mutations and Neutral Substitutions in Bacterial Genomes</article-title>. <source>Molecular Biology and Evolution</source> <volume>20</volume>: <fpage>2091</fpage>–<lpage>2096</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msg229" xlink:type="simple">10.1093/molbev/msg229</ext-link></comment>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Reeder1"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reeder</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Knight</surname><given-names>R</given-names></name> (<year>2010</year>) <article-title>Rapidly denoising pyrosequencing amplicon reads by exploiting rank-abundance distributions</article-title>. <source>Nat Methods</source> <volume>7</volume>: <fpage>668</fpage>–<lpage>669</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Hoffmann1"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hoffmann</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Otto</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Kurtz</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Sharma</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Khaitovich</surname><given-names>P</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Fast Mapping of Short Sequences with Mismatches, Insertions and Deletions Using Index Structures</article-title>. <source>PLoS Comput Biol</source> <volume>5</volume>: <fpage>e1000502</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000502" xlink:type="simple">10.1371/journal.pcbi.1000502</ext-link></comment>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Kurtz1"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kurtz</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Phillippy</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Delcher</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Smoot</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Shumway</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Versatile and open software for comparing large genomes</article-title>. <source>Genome Biology</source> <volume>5</volume>: <fpage>R12</fpage>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Holm1"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Holm</surname><given-names>S</given-names></name> (<year>1979</year>) <article-title>A Simple Sequentially Rejective Multiple Test Procedure</article-title>. <source>Scand J Stat</source> <volume>6</volume>: <fpage>65</fpage>–<lpage>70</lpage>.</mixed-citation></ref>
      <ref id="pcbi.1003031-Wickham1"><label>23</label><mixed-citation publication-type="other" xlink:type="simple">Wickham H (2009) Introduction. Ggplot2: Elegant Graphics for Data Analysis. Springer. 1–7 p.p. doi:10.1007/978-0-387-98141-3_1.</mixed-citation></ref>
   </ref-list>
</back>
</article>