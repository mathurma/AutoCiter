<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-02080</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005687</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Particle physics</subject><subj-group><subject>Elementary particles</subject><subj-group><subject>Photons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Electromagnetic radiation</subject><subj-group><subject>Light</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject><subj-group><subject>Phototransduction</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject><subj-group><subject>Phototransduction</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject><subj-group><subject>Phototransduction</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov models</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Animals</subject><subj-group><subject>Invertebrates</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular structures and organelles</subject><subj-group><subject>Microvilli</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Point process analysis of noise in early invertebrate vision</article-title>
<alt-title alt-title-type="running-head">Point process analysis of noise in early invertebrate vision</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7806-3605</contrib-id>
<name name-style="western">
<surname>Parag</surname> <given-names>Kris V.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Vinnicombe</surname> <given-names>Glenn</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001">
<addr-line>Control Group, Department of Engineering, University of Cambridge, United Kingdom</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Meir</surname> <given-names>Ron</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Technion, ISRAEL</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">kvp23@cam.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>10</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>27</day>
<month>10</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>10</issue>
<elocation-id>e1005687</elocation-id>
<history>
<date date-type="received">
<day>12</day>
<month>12</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>17</day>
<month>7</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Parag, Vinnicombe</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005687"/>
<abstract>
<p>Noise is a prevalent and sometimes even dominant aspect of many biological processes. While many natural systems have adapted to attenuate or even usefully integrate noise, the variability it introduces often still delimits the achievable precision across biological functions. This is particularly so for visual phototransduction, the process responsible for converting photons of light into usable electrical signals (quantum bumps). Here, randomness of both the photon inputs (regarded as extrinsic noise) and the conversion process (intrinsic noise) are seen as two distinct, independent and significant limitations on visual reliability. Past research has attempted to quantify the relative effects of these noise sources by using approximate methods that do not fully account for the discrete, point process and time ordered nature of the problem. As a result the conclusions drawn from these different approaches have led to inconsistent expositions of phototransduction noise performance.</p>
<p>This paper provides a fresh and complete analysis of the relative impact of intrinsic and extrinsic noise in invertebrate phototransduction using minimum mean squared error reconstruction techniques based on Bayesian point process (Snyder) filters. An integrate-fire based algorithm is developed to reliably estimate photon times from quantum bumps and Snyder filters are then used to causally estimate random light intensities both at the front and back end of the phototransduction cascade. Comparison of these estimates reveals that the dominant noise source transitions from extrinsic to intrinsic as light intensity increases. By extending the filtering techniques to account for delays, it is further found that among the intrinsic noise components, which include bump latency (mean delay and jitter) and shape (amplitude and width) variance, it is the mean delay that is critical to noise performance. As the timeliness of visual information is important for real-time action, this delay could potentially limit the speed at which invertebrates can respond to stimuli. Consequently, if one wants to increase visual fidelity, reducing the photoconversion lag is much more important than improving the regularity of the electrical signal.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>The invertebrate phototransduction system captures and converts environmental light inputs into electrical signals for use in later visual processing. Consequently, one would expect it to be optimised in some way to ensure that only a minimal amount of environmental information is lost during conversion. Confirming this requires an understanding and quantification of the performance limiting noise sources. Photons, which are inherently random and discrete, introduce extrinsic noise. The phototransduction cascade, which converts photons into electrical bumps possessing non-deterministic shapes and latencies, contributes intrinsic noise. Previous work on characterising the relative impact of all these sources did not account for the discrete, causal, point process nature of the problem and thus results were often inconclusive. Here we use non-linear Poisson process filtering to show that photon noise is dominant at low light intensity and cascade noise limiting at high intensity. Further, our analysis reveals that mean bump delay is the most deleterious aspect of the intrinsic noise. Our work emphasises a new approach to assessing sensory noise and provides the first complete description and evaluation of the relative impact of noise in phototransduction that does not rely on continuity, linearity or Gaussian approximations.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100005370</institution-id>
<institution>Gates Cambridge Trust</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7806-3605</contrib-id>
<name name-style="western">
<surname>Parag</surname> <given-names>Kris Varun</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by the Gates Cambridge Trust (PhD studentship for research) <ext-link ext-link-type="uri" xlink:href="https://www.gatescambridge.org/" xlink:type="simple">https://www.gatescambridge.org/</ext-link>. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="0"/>
<page-count count="25"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-11-08</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data (theory and figures) are within the paper and its Supporting Information files. All code and models used are freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/kpzoo/snyder-integrate-fire-code" xlink:type="simple">https://github.com/kpzoo/snyder-integrate-fire-code</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<sec id="sec002">
<title>The intrinsic-extrinsic relative noise problem in phototransduction</title>
<p>The phototransduction cascade consists of a series of chemical reactions which convert light inputs into usable current signals at the retina. As it serves as the front end to the visual system, it should be capable of extracting information from environmental inputs with high accuracy [<xref ref-type="bibr" rid="pcbi.1005687.ref001">1</xref>]. However, the cascade mechanism involves small numbers of molecules and therefore randomly executing reactions. Consequently, the electrical representation of each photon is non-identical and subject to inevitable variability. The signal is therefore degraded during photoconversion and the cascade said to be intrinsically noisy [<xref ref-type="bibr" rid="pcbi.1005687.ref002">2</xref>]. However, the cascade is not responsible for all the signal variability measurable at the retina. The light input itself introduces randomness through the variable timing of photons. Since the cascade has single photon sensitivity [<xref ref-type="bibr" rid="pcbi.1005687.ref003">3</xref>] this extrinsically introduced noise is also transferred across the cascade. This paper focuses on disentangling the relative contributions of these various noise sources.</p>
<p>The noise fidelity of phototransduction is critical. According to the data processing inequality [<xref ref-type="bibr" rid="pcbi.1005687.ref004">4</xref>], the information obtainable from the output of this process cannot be improved upon by later neuronal computations. As a result, whatever limits cascade performance may also delimit overall visual performance. An important and as yet unresolved question has been the determination of the relative influence of extrinsic photon noise as opposed to the intrinsic degradation caused by cascade reactions in representing the light stimuli. Since photon noise falls with intensity the relative noise quantification is necessarily a function of light intensity [<xref ref-type="bibr" rid="pcbi.1005687.ref005">5</xref>]. If in certain intensity regimes photon noise dominates, then the cascade can be considered sufficiently reliable for purpose at these luminance settings. If at other intensities the cascade noise is found limiting then one can query what characteristic of the phototransduction machinery is fundamentally stopping further intrinsic noise reduction.</p>
<p>This relative noise problem remains unsolved not only in invertebrate vision but also in vertebrate rods [<xref ref-type="bibr" rid="pcbi.1005687.ref006">6</xref>], and has parallels in other sensory systems like olfaction. While there are important structural and dynamical differences between invertebrate vision and rods (fundamentally different types of electrical signalling despite similar cascades [<xref ref-type="bibr" rid="pcbi.1005687.ref007">7</xref>]) and olfaction (photons are replaced by odour molecules [<xref ref-type="bibr" rid="pcbi.1005687.ref008">8</xref>]) they are all characterised by an overall motif known as G protein signalling. Hence, clarifying the invertebrate intrinsic-extrinsic noise relation can have useful and far reaching consequences for sensory analysis.</p>
<p>Previous researchers have focussed on quantifying noise limits by estimating the comparative contributions of photon and cascade noise on the electrical signal variance [<xref ref-type="bibr" rid="pcbi.1005687.ref009">9</xref>] or by applying linearised filter approximations to the cascade to calculate relevant noise spectra [<xref ref-type="bibr" rid="pcbi.1005687.ref010">10</xref>]. However, such approaches generally do not account for the point process or time ordered nature of this problem. These unmodelled problem dynamics may be especially important in phototransduction given that it is sensitive to individual photons and that its output is used in real time higher visual processing.</p>
<p>This paper will address these issues by applying and adapting Snyder filtering techniques [<xref ref-type="bibr" rid="pcbi.1005687.ref011">11</xref>] to data generated from the archetypal phototransduction system model of Drosophila melongaster. The Snyder filter is the point process analogue of the well known Kalman filter [<xref ref-type="bibr" rid="pcbi.1005687.ref012">12</xref>]. It provides a mathematically natural way of obtaining causal minimum mean squared error estimates of hidden Markov variables signalled via discrete observation events. Algorithms for extracting data from transduced photons will be developed and used in conjunction with Snyder based stimuli reconstruction techniques to show that photon noise dominates in low light while mean cascade delay limits system performance under bright conditions. This work will clarify and decompose the noise sources which dominate phototransduction while highlighting the importance of keeping the analysis discrete and causal.</p>
</sec>
<sec id="sec003">
<title>Discrete cascade dynamics define the intrinsic noise sources</title>
<p>The invertebrate phototransduction cascade consists of a series of stochastic molecular reactions. The Drosophila cascade is particularly important as an analysable and testable archetype, not only for invertebrate phototransduction, but also for more general G protein signalling motifs [<xref ref-type="bibr" rid="pcbi.1005687.ref013">13</xref>]. G proteins are important signal transducing proteins that are ubiquitous across many biological processes. It is therefore critical to understand the properties and performance of the Drosophila cascade. Such an understanding would not only provide general insight into major biological signalling strategies but could also contribute useful theory, applicable to artificial visual systems aiming at high performance with minimal processing.</p>
<p>Early vision in Drosophila involves light impinging on the rhabdomere of a photoreceptor, which is composed of about 30,000 microvilli [<xref ref-type="bibr" rid="pcbi.1005687.ref013">13</xref>]. Microvilli are essentially semi-autonomous processing units which absorb photons locally and produce quantum bumps (QBs) in response. The reaction set occurring in each microvilli involves photon absorption by Rhodopsin which leads to activation of the G protein via a guanosine diphosphate to guanosine triphosphate exchange. This results in activation of phospholipase C which liberates secondary messengers. There are only a few G protein and phospholipase C molecules per microvillus [<xref ref-type="bibr" rid="pcbi.1005687.ref014">14</xref>]. The secondary messengers activate the first light sensitive channel after a variable delay (15-100ms) [<xref ref-type="bibr" rid="pcbi.1005687.ref013">13</xref>]. This delay corresponds to the time required for the messengers to cooperatively overcome an effective channel activation threshold.</p>
<p>Activation of a single transient receptor potential (TRP) or TRP-like ion channel results in an influx of Ca<sup>2+</sup> which rapidly activates the remaining channels in the microvilli (15-20 total) via a positive feedback mechanism. This generates a current which is quickly deactivated via a negative feedback Ca<sup>2+</sup> based loop [<xref ref-type="bibr" rid="pcbi.1005687.ref013">13</xref>]. The effect of these regulated loops is the production of an essentially discrete, unitary photon signal or QB. A single QB codes for a single absorbed photon at a microvillus. The QBs generated by each stimulated microvillus sum linearly to produce the macroscopic photoreceptor response at the receptor cell membrane. As light intensity increases the QBs become faster and smaller (adaptation) which ensures that the cell dynamic range is properly utilised. Despite these changes it appears that photoreceptors are linear event counters even at daylight luminance values [<xref ref-type="bibr" rid="pcbi.1005687.ref014">14</xref>].</p>
<p>The entire cascade, from input photon to output QB is therefore described by transformations involving small numbers of discrete molecules or channels. This results in randomly timed reactions and probabilistic interactions that lead to process variability that is visible in the resulting QB signal [<xref ref-type="bibr" rid="pcbi.1005687.ref014">14</xref>]. The QB is a non-linear and stochastic electrical depolarisation that codes for an absorbed photon. Each QB has non-identical and randomly distributed latency, amplitude and duration. These stochastic QBs lead to variable representations of identical light stimuli which reduces the reliability of event representation. The variable latency between photon absorption and bump signalling is controlled by the time required for the second messenger to accumulate beyond a dynamic threshold [<xref ref-type="bibr" rid="pcbi.1005687.ref015">15</xref>]. The variable amplitude and width of the QB are determined by the sequential Ca<sup>2+</sup> feedback loops. Evidence suggests that the QB latency is uncorrelated with the QB waveform and highly supports the conclusion that different and independent cascade reaction sets are responsible for these characteristics [<xref ref-type="bibr" rid="pcbi.1005687.ref016">16</xref>]. Consequently, one can think of QB shape distortion and latency as two independent and important manifestations of mechanistic cascade noise.</p>
<p>However, these sources of randomness, which are collectively termed cascade noise, are not the only forms of intrinsic noise [<xref ref-type="bibr" rid="pcbi.1005687.ref017">17</xref>]. Spontaneous (in the absence of light) activation of G proteins, Rhodopsin or single TRP channels can lead to spurious (false positive) QBs which are indistinguishable from photon stimulated QBs. While a possible issue at high temperature-low intensity settings, this dark noise source is negligible under the conditions investigated here and often the cascade suppresses these events via inbuilt molecular threshold signalling techniques [<xref ref-type="bibr" rid="pcbi.1005687.ref015">15</xref>]. Additionally a conceptual equivalent to false negative QBs also exists. When a light stimuli is presented to the cascade, microvilli respond independently to incident photons and produce respective QBs. Due to cascade stochasticity (random reaction timings), not every photon becomes a QB but instead there is a quantum capture efficiency, <inline-formula id="pcbi.1005687.e001"><alternatives><graphic id="pcbi.1005687.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mtext>QE</mml:mtext><mml:mspace width="1pt"/><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mtext>no</mml:mtext> <mml:mo>.</mml:mo> <mml:mspace width="1pt"/><mml:mtext>effective</mml:mtext> <mml:mspace width="1pt"/><mml:mtext>photons</mml:mtext></mml:mrow> <mml:mrow><mml:mtext>no</mml:mtext> <mml:mo>.</mml:mo> <mml:mspace width="1pt"/><mml:mtext>incident</mml:mtext> <mml:mspace width="1pt"/><mml:mtext>photons</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. Experiments, however, indicate that often QE is very high especially at low intensities where it can be close to 1 [<xref ref-type="bibr" rid="pcbi.1005687.ref018">18</xref>]. Hence the terms intrinsic and cascade noise will be used synonymously, and QE = 1 assumed. Supplements <xref ref-type="supplementary-material" rid="pcbi.1005687.s003">S3 Text</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005687.s008">S4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005687.s009">S5</xref> Figs show that QEs of at least 0.66 have negligible noise impact.</p>
<p>Since there is a clear and intimate link between intrinsic noise and the cascade machinery, any noise analysis will require the incorporation of a physiological model that describes the full reaction set from Rhodopsin absorption to TRP channel opening. This work makes use of the Drosophila phototransduction model developed by Nikolic <italic>et al</italic> [<xref ref-type="bibr" rid="pcbi.1005687.ref019">19</xref>]. This model simulates all known reactions and mechanisms of fly phototransduction within a discrete, Poisson framework, uses known biochemical parameter estimates, and allows for multi-photon inputs. It was particularly chosen for this analysis since it provides a complete stochastic simulation of the cascade reactions, does not use common mass action (continuity) approximations and attempts to maintain a rich and unsimplified dynamical description of the process. Most importantly, it places emphasis on getting the noise distributions correct and in keeping with experimental data. Further, the model can be modified to account for other G protein based cascades, thus providing flexibility for future work [<xref ref-type="bibr" rid="pcbi.1005687.ref020">20</xref>]. Further information on the Nikolic model, including a mathematical description and a visualisation of the intrinsic noise component distributions, are provided in Supplements <xref ref-type="supplementary-material" rid="pcbi.1005687.s004">S4 Text</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005687.s011">S7</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005687.s012">S8</xref> Figs.</p>
</sec>
<sec id="sec004">
<title>Previous approaches neglect causality and system discreteness</title>
<p>This paper will investigate the relative noise source problem and quantify the main limitations on the reliability of early vision. Previous work on this problem has taken two main viewpoints. The first uses deviations from Poisson statistics as a measure of noise contributions. For a constant light intensity, photon absorption follows a Poisson distribution so that photon noise results in a photon catch variance to mean ratio of 1. If the measured ratio is above 1 then any excess variance must be due to intrinsic noise [<xref ref-type="bibr" rid="pcbi.1005687.ref009">9</xref>]. The results of this analysis suggest that at low intensities cascade noise contributed 50% and at high intensities 90% of all noise. This method provides a clear scheme for assessing relative noise sources that is easily interpretable. Unfortunately, it is not easily generalised to non-constant or pseudorandom light sources and depends on the intensity being low enough so that QBs are easily distinguishable (countable). Moreover, this scheme neglects causality which asserts that the phototransduced output at any time cannot depend on inputs after that time. Failing to factor in this information constraint can lead to spurious performance evaluations [<xref ref-type="bibr" rid="pcbi.1005687.ref021">21</xref>].</p>
<p>The second posits that the cascade aims to maximise (mutual) information transfer and calculates signal to noise ratios and channel capacities under a noisy, dynamically range-limited Gaussian channel assumption [<xref ref-type="bibr" rid="pcbi.1005687.ref022">22</xref>]. Relative noise sources are then described by how much they alter these ratios and are treated additively through their spectral densities [<xref ref-type="bibr" rid="pcbi.1005687.ref023">23</xref>]. This approach, by keeping analysis within the frequency-domain is analytically tractable and affords a convenient dissection of optimal sensory noise filtering. However, neither is the noise additive [<xref ref-type="bibr" rid="pcbi.1005687.ref024">24</xref>] nor neuronal dynamics Gaussian [<xref ref-type="bibr" rid="pcbi.1005687.ref025">25</xref>], making these methods at best approximate. Additionally, photons are point events and their resulting QB streams are countable sums of impulse responses. As a result the phototransduction system is necessarily discrete and the transfer of information from the environment to the retina is actually via a Poisson channel. This insight is a key motivator for the approach taken in this work. The stark coding differences between Poisson and Gaussian channels were noted by Ghanem <italic>et al</italic> in [<xref ref-type="bibr" rid="pcbi.1005687.ref026">26</xref>] and suggest that conducting the phototransduction analysis under a Gaussian (or continuity) assumption can be misleading. Additionally, these mutual information based studies neglect time order and use random variable based definitions of capacity [<xref ref-type="bibr" rid="pcbi.1005687.ref004">4</xref>]. In reality, the noisy phototransduction input is a stochastic process and the causal capacity should be expressed as in Lestas <italic>et al</italic> [<xref ref-type="bibr" rid="pcbi.1005687.ref021">21</xref>] instead. Consequently, these signal to noise ratio based schemes are probably only reliable at very high intensities where Poisson-Gaussian approximations are valid, and likely break down at lower luminance values, where the discrete nature of the system dominates.</p>
<p>In contrast to the above methods, this work directly and explicitly treats the time ordered, discrete and stochastic nature of the relative noise problem with point processes, integrate-fire algorithms and causal filters. No continuity or linearity approximations are made and a causal mean squared error distortion is used as the noise performance measure; in place of the usual signal to noise or variance to mean ratios. Getting the performance metric right is important, because application of different measures, even on the same data set, as noted in the work of Grewe <italic>et al</italic> [<xref ref-type="bibr" rid="pcbi.1005687.ref027">27</xref>], can lead to different and often misleading results. Since phototransduction should maximally preserve environmental information, using causal capacity based metrics would seem natural. However, embedding causality in this way is difficult. It is known from information theory that distortion functions (which directly calculate estimation error) provide a useful dual to capacity [<xref ref-type="bibr" rid="pcbi.1005687.ref004">4</xref>]. In this interpretation the concept of maximising information transfer is replaced with that of minimising distortion between a true and estimated stimuli. The distortion quantifies the difference between the true stimuli, denoted <italic>x</italic>(<italic>t</italic>) and some estimator of <italic>x</italic>(<italic>t</italic>). Note that <italic>x</italic>(<italic>t</italic>) is also referred to as the hidden state. Discreteness and causality are then directly accounted for by choosing an estimate that incorporates the naturally ordered and point-based structure that information takes when transmitted across a Poisson channel.</p>
<p>This work chooses the causal conditional mean as a suitable estimator. If the causal information available until time <italic>t</italic> are the observations <inline-formula id="pcbi.1005687.e002"><alternatives><graphic id="pcbi.1005687.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msubsup><mml:mi mathvariant="script">D</mml:mi> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> then this estimator is <inline-formula id="pcbi.1005687.e003"><alternatives><graphic id="pcbi.1005687.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi mathvariant="double-struck">E</mml:mi> <mml:mo>[</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>|</mml:mo> <mml:mspace width="0.166667em"/></mml:mrow> <mml:msubsup><mml:mi mathvariant="script">D</mml:mi> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. This expectation integrates <italic>x</italic>(<italic>t</italic>) with respect to its conditional distribution given the causal data. The conditional mean estimator has a fundamental link to the ordered mutual information across a Poisson channel [<xref ref-type="bibr" rid="pcbi.1005687.ref028">28</xref>] and minimises a broad class of distortion functions. Among these is the function: <inline-formula id="pcbi.1005687.e004"><alternatives><graphic id="pcbi.1005687.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (the expectation is now over state trajectories). This distortion is termed the minimum mean squared error (MMSE) and is chosen as the performance metric for this work. If some other estimator is used instead then this distortion is simply called the mean squared error (MSE). Any estimate which is a function of <inline-formula id="pcbi.1005687.e005"><alternatives><graphic id="pcbi.1005687.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:msubsup><mml:mi mathvariant="script">D</mml:mi> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> alone will incorporate causality and discreteness. However, it is only when it takes the form of <inline-formula id="pcbi.1005687.e006"><alternatives><graphic id="pcbi.1005687.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, the conditional mean, that it will minimise the MSE. Note that these square error distortions provide the additional advantage of not being sensitive to the removal of constant signals, which is a characteristic of the adaptation response in phototransduction [<xref ref-type="bibr" rid="pcbi.1005687.ref029">29</xref>]. Consequently the cleanest approach, involving the least approximations is to optimally and causally reconstruct the input intensity stimuli and directly calculate the MMSE. While mathematically more difficult than the Gaussian and variance approaches, comparing MMSEs between light intensity reconstructions subject to various noise sources is the most appropriate and quantifiable way of measuring relative noise contribution.</p>
<p>The importance of the approach presented here may extend beyond the phototransduction noise problem. Any real-time system which receives information sequentially and in packets is subject to the constraints of causality and discreteness. Developing and adapting techniques that can incorporate these often unmodelled dynamics can therefore have wide ranging importance. Accounting for these constraints has appeared as a concern, explicitly in molecular biochemistry [<xref ref-type="bibr" rid="pcbi.1005687.ref021">21</xref>] [<xref ref-type="bibr" rid="pcbi.1005687.ref030">30</xref>], and implicitly in general neuroscience [<xref ref-type="bibr" rid="pcbi.1005687.ref031">31</xref>]. In both cases information can be interpreted as being transferred over timing (Poisson) channels, with packets representing either molecular events or spikes and the real time estimation problem involving either molecular population inference or neuronal stimuli reconstruction. This work sits precisely within this framework.</p>
<p>Bobrowski <italic>et al</italic> [<xref ref-type="bibr" rid="pcbi.1005687.ref032">32</xref>] is the only other work (to the authors’ knowledge) to have (implicitly) dealt with causality and dicreteness. They showed that causal Snyder filtering could be used to obtain real time MMSE reconstructions of neuronal stimuli without the need for common approximations such as time discretisation. Using these techniques they estimated noisy, dynamic stimuli from discrete spiking streams. This paper extends their work by i) developing algorithms for the causal estimation of dynamic stimuli that are now no longer observable through the Poisson events they modulate, but must instead be inferred from noisy and potentially continuous waveforms based on those events, and ii) explicitly showing why factoring discreteness, non-linearity and causality is important for relative noise analysis. In this setting photons are interpreted as analogues to information bearing spikes and it is shown that is is possible to estimate complex light inputs from noisy outputs without the need for common linearity, continuity or Gaussian approximations.</p>
</sec>
<sec id="sec005">
<title>Markov-Poisson light models and physiological simulators are combined to solve a fundamental estimation problem</title>
<p>Since the relative noise problem quantifies the contributions of both extrinsic and intrinsic noise, it requires both an environmental light model and a phototransduction simulator. Visual neuroscience literature has often taken two approaches to light inputs (both in experiments and theoretical analyses) when investigating sensory performance [<xref ref-type="bibr" rid="pcbi.1005687.ref033">33</xref>]. The first is to repeatedly present simple inputs, which are easy to generate and control (for example short, constant intensity flashes), in the hope that they elicit simple responses that allow more transparent analysis of the sensory system. Averaging over the repetitions should then lead to meaningful results. The second involves using more complex, non-repeated stimuli that represent input forms that the sensory system is likely to encounter in normal operation. These naturalistic stimuli should reveal more intricate properties of the system as it is supposedly evolutionarily designed for such inputs. The downside of these is the loss of analytical tractability [<xref ref-type="bibr" rid="pcbi.1005687.ref033">33</xref>].</p>
<p>This works attempts to meld the advantages of both approaches by using simple but non-trivial, non-repeated light models that share some of the characteristics of naturalistic stimuli yet are still amenable to analysis. Specifically, a flickering, continuous time, discrete space Markov process description for environmental light intensity, λ(<italic>t</italic>) is used. This intensity modulates a Poisson process that produces a discrete photon stream, denoted as <inline-formula id="pcbi.1005687.e007"><alternatives><graphic id="pcbi.1005687.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:msubsup><mml:mi>P</mml:mi> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> over the domain [0 <italic>t</italic>]. Time, <italic>t</italic>, is measured in ms with λ(<italic>t</italic>) having units of ms<sup>−1</sup>. These models are analytically treatable with Markov modulated Poisson theory. Naturalistic stimuli are known to have i) stochastic fluctuations which can be large, ii) relatively slow dynamics compared to the visual response time and iii) long correlation times [<xref ref-type="bibr" rid="pcbi.1005687.ref034">34</xref>]. The Markov modulated stimuli used here intrinsically possess these first two properties. The third property is approximated and simplified within the Markov assumption of the model.</p>
<p>There are two key differences, however, between the light models used here and the general naturalistic light stimuli often found in the literature. The first is that most stimuli are in terms of velocities and contrast and applied to motion detection (optic flow). The models in this paper are solely in terms of light intensity. Velocities and contrasts are not appropriate for this work as the paper treats light at a single photoreceptor so that no motion signal is present [<xref ref-type="bibr" rid="pcbi.1005687.ref035">35</xref>]. This property is therefore not relevant to this work. Secondly, naturalistic stimuli would likely encompass a broad range of intensity distributions depending on ambient conditions. As a result some of these would be dissimilar to those used here. However, given the rich range of intensity functions obtainable by appropriate choices of Markov parameters, this is not a true limitation. This work focuses on switching, bimodal stimuli. The fundamental formulation of this stimuli (called the interrupted model) is given in the models section of this paper. More complex and general bimodal light models are described in Supplement <xref ref-type="supplementary-material" rid="pcbi.1005687.s002">S2 Text</xref>.</p>
<p>This photon stream produced by the light model is the input to the phototransduction model. The Nikolic model described previously is used as the cascade simulator. It produces a QB output stream <inline-formula id="pcbi.1005687.e008"><alternatives><graphic id="pcbi.1005687.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> which, at best, can only contain the information present in <inline-formula id="pcbi.1005687.e009"><alternatives><graphic id="pcbi.1005687.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msubsup><mml:mi>P</mml:mi> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> (by the data processing inequality [<xref ref-type="bibr" rid="pcbi.1005687.ref004">4</xref>]). By comparing estimates of the light intensity given <inline-formula id="pcbi.1005687.e010"><alternatives><graphic id="pcbi.1005687.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msubsup><mml:mi>P</mml:mi> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> or <inline-formula id="pcbi.1005687.e011"><alternatives><graphic id="pcbi.1005687.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> one obtains an understanding of the noise deterioration at both the front and back end of the cascade respectively. To make the problem non-dimensional the normalised intensity, <inline-formula id="pcbi.1005687.e012"><alternatives><graphic id="pcbi.1005687.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>λ</mml:mo> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>α</mml:mi></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, <italic>α</italic> &gt; 0 ms<sup>−1</sup> is used (it is explicitly described by the Markov states of the light model). The causal conditional mean estimates of <italic>x</italic>(<italic>t</italic>) given <inline-formula id="pcbi.1005687.e013"><alternatives><graphic id="pcbi.1005687.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msubsup><mml:mi>P</mml:mi> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, the raw photon stream, and <inline-formula id="pcbi.1005687.e014"><alternatives><graphic id="pcbi.1005687.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, the quantum bump stream, are denoted <inline-formula id="pcbi.1005687.e015"><alternatives><graphic id="pcbi.1005687.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005687.e016"><alternatives><graphic id="pcbi.1005687.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>qb</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> respectively. The comparison across the cascade is made with the MMSE indices: <inline-formula id="pcbi.1005687.e017"><alternatives><graphic id="pcbi.1005687.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msub><mml:mrow><mml:mtext>mse</mml:mtext></mml:mrow><mml:mrow><mml:mtext>ph</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mtext>ph</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> which only measures photon noise (the noise floor) and <inline-formula id="pcbi.1005687.e018"><alternatives><graphic id="pcbi.1005687.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:msub><mml:mrow><mml:mtext>mse</mml:mtext></mml:mrow><mml:mrow><mml:mtext>qb</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mtext>qb</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> which characterises the combined impact of photon and cascade noise. These estimates of <italic>x</italic>(<italic>t</italic>) assume a spatial integration of the output from all stimulated photoreceptors. It is well know that QBs linearly sum over the low and medium intensity range up to hundreds of photons per second [<xref ref-type="bibr" rid="pcbi.1005687.ref036">36</xref>]. Consequently for the range of intensities investigated this assumption is valid.</p>
<p>Values of <inline-formula id="pcbi.1005687.e019"><alternatives><graphic id="pcbi.1005687.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> and mse<sub>ph</sub> within this Poisson-Markov framework can be directly obtained from an optimal (MMSE) non-linear filter, known as the Snyder filter [<xref ref-type="bibr" rid="pcbi.1005687.ref011">11</xref>]. The Snyder filter is a Bayesian technique for inferring the posterior distribution of a hidden Markov state given modulated Poisson observations and a prior on the hidden states. Integrating this posterior gives the conditional mean estimator that is used in the MMSE distortion function. The Snyder filter is exact in that it makes no approximations or simplifications on either the state or observation dynamics. It solves a differential-difference equation on the state posterior leading to a deterministic continuous solution trajectory between observation (event) times with discontinuous updates at the observed random event points. The continuous component of the solution restarts after every event update and the overall posterior evolution falls within the framework of piecewise deterministic Markov processes. The equations behind the filter and their adaptation for this work are given in Supplement <xref ref-type="supplementary-material" rid="pcbi.1005687.s001">S1 Text</xref>. In general the Snyder filter does not require a Markov chain description of the state process. The inference procedure developed here may therefore be a useful blueprint for analyses involving other types of light models. For details of its general formulation and its application to other types of state estimation problems in biology see [<xref ref-type="bibr" rid="pcbi.1005687.ref011">11</xref>] and [<xref ref-type="bibr" rid="pcbi.1005687.ref032">32</xref>] [<xref ref-type="bibr" rid="pcbi.1005687.ref037">37</xref>] respectively.</p>
<p>In contrast, there is no known method for calculating <inline-formula id="pcbi.1005687.e020"><alternatives><graphic id="pcbi.1005687.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>qb</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> and mse<sub>qb</sub> since it is difficult to describe the cascade noise within a tractable analytical framework. This paper develops algorithms for estimating and bounding <inline-formula id="pcbi.1005687.e021"><alternatives><graphic id="pcbi.1005687.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>qb</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> and mse<sub>qb</sub>. By comparing these estimates to <inline-formula id="pcbi.1005687.e022"><alternatives><graphic id="pcbi.1005687.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> and mse<sub>ph</sub> meaningful conclusions will be drawn about the relative impact of intrinsic and extrinsic noise on the normalised intensity input.</p>
</sec>
</sec>
<sec id="sec006" sec-type="materials|methods">
<title>Models</title>
<sec id="sec007">
<title>Fundamental Markov on-off light model</title>
<p>Two main Markov light models are used in this work. The first is a fundamental, symmetric, stochastic on-off light switch which emits photons according to an interrupted Poisson process. It is also known as the random telegraph signal. The second is a multi-state Markov model which has a bimodal Gaussian type state distribution and represents a complex light source that flickers between two extreme intensities while also possessing small light changes about the extreme modes. The bimodal model can be thought of as a generalisation of the interrupted model to higher state spaces with additional switch frequencies. The mathematical details of the former follow. The bimodal model and its qualitative similarities and differences to the interrupted source are described in Supplements <xref ref-type="supplementary-material" rid="pcbi.1005687.s002">S2 Text</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005687.s005">S1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005687.s006">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005687.s007">S3</xref> Figs. The interrupted light source with state transition rates set at <italic>k</italic> &gt; 0 ms<sup>−1</sup> is shown in <xref ref-type="fig" rid="pcbi.1005687.g001">Fig 1</xref>. This model has the maximum entropy rate of any 2 state stationary Markov source and is therefore the most complex model (from an information theory perspective) for its state size [<xref ref-type="bibr" rid="pcbi.1005687.ref004">4</xref>].</p>
<fig id="pcbi.1005687.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005687.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Markov on-off interrupted light model and intensity function.</title>
<p>State 1 indicates the light is on and switching occurs with mean exponential waiting time of <inline-formula id="pcbi.1005687.e023"><alternatives><graphic id="pcbi.1005687.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>k</mml:mi></mml:mfrac></mml:math></alternatives></inline-formula>. Photons are emitted with mean rate <italic>αx</italic>(<italic>t</italic>) with the model state <italic>x</italic>(<italic>t</italic>) ∈ {0, 1} and un-normalised intensity λ(<italic>t</italic>) ∈ {0, <italic>α</italic>}.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.g001" xlink:type="simple"/>
</fig>
<p>To better compare and quantify the behaviour of light models, two dimensionless parameters are introduced. The first, <inline-formula id="pcbi.1005687.e024"><alternatives><graphic id="pcbi.1005687.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:mi>β</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>α</mml:mi> <mml:mi>k</mml:mi></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, characterises the number of photons produced on average per on state and can be understood as a relative (normalised) light intensity descriptor. Higher <italic>β</italic> indicates more photons per state and hence more usable information. The second, <inline-formula id="pcbi.1005687.e025"><alternatives><graphic id="pcbi.1005687.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:mi>γ</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:msup><mml:mi>k</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mn>100</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, measures the number of QBs (with a reference maximum width of 100ms) that can fit into the on time of the underlying Markov chain. This parameter basically describes the relative flicker of the light stimuli. Higher <italic>γ</italic> implies a relatively slower flickering light model, which should be easier to estimate. Thus, all light models will be compared in terms of their (<italic>β</italic>, <italic>γ</italic>) setting with increases in either likely to lead to better MSE. For more complex stimuli, such as the bimodal model, <italic>k</italic> is defined as the smallest death rate on the chain.</p>
<p>Given the stream of photons produced by the interrupted model, an appropriate Snyder filter can be formulated to obtain the posterior state distribution and then the conditional mean estimator. The Snyder filter description usually involves a coupled differential-difference equation for each Markov state posterior component. These dynamical equations are given in Supplement <xref ref-type="supplementary-material" rid="pcbi.1005687.s001">S1 Text</xref>. Since the interrupted model has only 2 states and probabilities must sum to 1, the complete Snyder equation set can be reduced to a single expression in terms of the conditional mean estimate <inline-formula id="pcbi.1005687.e026"><alternatives><graphic id="pcbi.1005687.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>. When solved with the dummy variables <italic>A</italic> = <italic>β</italic><sup>−1</sup> + 2<sup>−1</sup>, <inline-formula id="pcbi.1005687.e027"><alternatives><graphic id="pcbi.1005687.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:mi>B</mml:mi> <mml:mo>=</mml:mo> <mml:msqrt><mml:mrow><mml:msup><mml:mi>β</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mn>2</mml:mn> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005687.e028"><alternatives><graphic id="pcbi.1005687.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:mi>C</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo form="prefix">tanh</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:mi>A</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>B</mml:mi></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and initial condition <inline-formula id="pcbi.1005687.e029"><alternatives><graphic id="pcbi.1005687.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> (assumes a photon at <italic>t</italic> = 0) the following conditional state estimator results:
<disp-formula id="pcbi.1005687.e030"><alternatives><graphic id="pcbi.1005687.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>A</mml:mi> <mml:mo>−</mml:mo> <mml:mi>B</mml:mi> <mml:mo form="prefix">tanh</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>B</mml:mi> <mml:mi>α</mml:mi> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>C</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4pt"/> <mml:mtext>for</mml:mtext> <mml:mspace width="4pt"/><mml:mn>0</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>t</mml:mi> <mml:mo>≤</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>−</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula> <disp-formula id="pcbi.1005687.e031"><alternatives><graphic id="pcbi.1005687.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>+</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
The equations above are given until some time <italic>s</italic>, when a new photon arrives, with <italic>s</italic><sup>−</sup> and <italic>s</italic><sup>+</sup> indicating time infinitesimally before and after the photon. This hybrid solution provides useful insight into the behaviour of the optimal MMSE estimator. On every photon <inline-formula id="pcbi.1005687.e032"><alternatives><graphic id="pcbi.1005687.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> discontinuously jumps to a value of 1 (<xref ref-type="disp-formula" rid="pcbi.1005687.e031">eq 2</xref>) and then continuously decays until the next photon arrives (<xref ref-type="disp-formula" rid="pcbi.1005687.e030">eq 1</xref>) with a minimum possible value of <inline-formula id="pcbi.1005687.e033"><alternatives><graphic id="pcbi.1005687.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:msub><mml:mo form="prefix" movablelimits="true">lim</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>→</mml:mo> <mml:mi>∞</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>A</mml:mi> <mml:mo>-</mml:mo> <mml:mi>B</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> where 0 ≤ <italic>A</italic> − <italic>B</italic> ≤ 0.5. The estimator trajectory is reset on every event (local time becomes 0 again).</p>
<p>The inter-event solution at different <italic>β</italic> is given in <xref ref-type="fig" rid="pcbi.1005687.g002">Fig 2</xref>. For the interrupted model, the mean time between photons is <inline-formula id="pcbi.1005687.e034"><alternatives><graphic id="pcbi.1005687.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mfrac><mml:mn>2</mml:mn> <mml:mi>α</mml:mi></mml:mfrac></mml:math></alternatives></inline-formula> ms [<xref ref-type="bibr" rid="pcbi.1005687.ref038">38</xref>], while the mean time between on-off switches is <inline-formula id="pcbi.1005687.e035"><alternatives><graphic id="pcbi.1005687.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>k</mml:mi></mml:mfrac></mml:math></alternatives></inline-formula> ms. Higher <italic>β</italic> implies more available information and lower mse<sub>ph</sub> values. This effect is observable in the decay curves of <inline-formula id="pcbi.1005687.e036"><alternatives><graphic id="pcbi.1005687.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. At low <italic>β</italic>, due to less certainty about the state, the scheme relatively quickly decays to a steady value approaching 0.5. As <italic>β</italic> → 0, <inline-formula id="pcbi.1005687.e037"><alternatives><graphic id="pcbi.1005687.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>→</mml:mo> <mml:mi>A</mml:mi> <mml:mo>-</mml:mo> <mml:mi>B</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, and mse<sub>ph</sub> → 0.25. This is no better than simply choosing the best constant estimate of <inline-formula id="pcbi.1005687.e038"><alternatives><graphic id="pcbi.1005687.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi mathvariant="double-struck">E</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. At high <italic>β</italic> the decay is slower (relative to the normalisation time <inline-formula id="pcbi.1005687.e039"><alternatives><graphic id="pcbi.1005687.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mfrac><mml:mn>2</mml:mn> <mml:mi>α</mml:mi></mml:mfrac></mml:math></alternatives></inline-formula>) and the estimate stays close to 1 sufficiently long such that if another photon would occur their would be little decay between them. However, the decay is sufficiently fast relative to the switching time so that if no photons occur for an adequate amount of time then the quick fall to <italic>A</italic> − <italic>B</italic> ≈ 0 accurately reflects the state switch. This is especially true for very high <italic>β</italic> where photons essentially delineate the boundaries of the of the <italic>x</italic>(<italic>t</italic>) trajectory such that staying close to 1 between photons and decaying to 0 in the absence of photons will, as <italic>β</italic> → ∞, result in mse<sub>ph</sub> = 0. The more generalised filter solution for any Markov model and an illustration of the resulting trajectory for the bimodal model can be found in Supplements <xref ref-type="supplementary-material" rid="pcbi.1005687.s002">S2 Text</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005687.s006">S2 Fig</xref> respectively.</p>
<fig id="pcbi.1005687.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005687.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Snyder inter-event intensity estimate for the interrupted model when all photon times are known.</title>
<p>The solution <inline-formula id="pcbi.1005687.e040"><alternatives><graphic id="pcbi.1005687.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> decays more rapidly relative to the switch time <inline-formula id="pcbi.1005687.e041"><alternatives><graphic id="pcbi.1005687.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>k</mml:mi></mml:mfrac></mml:math></alternatives></inline-formula> as the mean number of photons per on state of the light model, <italic>β</italic> increases. The solution stays close to state 1 with increasing <italic>β</italic>, relative to the time to the next photon <inline-formula id="pcbi.1005687.e042"><alternatives><graphic id="pcbi.1005687.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mfrac><mml:mn>2</mml:mn> <mml:mi>α</mml:mi></mml:mfrac></mml:math></alternatives></inline-formula>. This indicates increased certainty as there is more information available.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.g002" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec008" sec-type="results">
<title>Results</title>
<sec id="sec009">
<title>The integrate-fire-Snyder algorithm converts bumps into estimated photon times for Snyder filtering</title>
<p>While the Snyder filter computes the optimal estimate <inline-formula id="pcbi.1005687.e043"><alternatives><graphic id="pcbi.1005687.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> exactly, there is no known equivalent method for obtaining <inline-formula id="pcbi.1005687.e044"><alternatives><graphic id="pcbi.1005687.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>qb</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>, the MMSE estimator given the bumps. One contribution of this paper is an algorithm that allows calculation of a good substitute for <inline-formula id="pcbi.1005687.e045"><alternatives><graphic id="pcbi.1005687.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>qb</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>, denoted <inline-formula id="pcbi.1005687.e046"><alternatives><graphic id="pcbi.1005687.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:msubsup><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, using the QB data stream. This non-MMSE estimator would then provide a useful upper bound on the combined distortion resulting from both intrinsic and extrinsic noise. The known relationship of the estimators can then be summarised as <inline-formula id="pcbi.1005687.e047"><alternatives><graphic id="pcbi.1005687.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mrow><mml:msub><mml:mtext>mse</mml:mtext> <mml:mtext>ph</mml:mtext></mml:msub> <mml:mo>≤</mml:mo> <mml:msub><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext></mml:msub> <mml:mo>≤</mml:mo> <mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. The quantity <inline-formula id="pcbi.1005687.e048"><alternatives><graphic id="pcbi.1005687.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>-</mml:mo> <mml:msub><mml:mtext>mse</mml:mtext> <mml:mtext>ph</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> upper bounds the noise introduced by the cascade since mse<sub>ph</sub> is precisely the distortion due only to the photon input variability.</p>
<p>The scheme developed here for deriving <inline-formula id="pcbi.1005687.e049"><alternatives><graphic id="pcbi.1005687.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is called the integrate-fire-Snyder algorithm. The integrate-fire part of the name reflects its similarity to a standard neuronal model [<xref ref-type="bibr" rid="pcbi.1005687.ref039">39</xref>]. Consider a summed QB stream <inline-formula id="pcbi.1005687.e050"><alternatives><graphic id="pcbi.1005687.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn> <mml:mi>T</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> for some maximum observation time, <italic>T</italic>, obtained by applying the photon stream <inline-formula id="pcbi.1005687.e051"><alternatives><graphic id="pcbi.1005687.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:msubsup><mml:mi>P</mml:mi> <mml:mn>0</mml:mn> <mml:mi>T</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> to the Nikolic phototransduction simulator [<xref ref-type="bibr" rid="pcbi.1005687.ref019">19</xref>]. The algorithm uses <inline-formula id="pcbi.1005687.e052"><alternatives><graphic id="pcbi.1005687.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn> <mml:mi>T</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> to first derive an estimated photon stream <inline-formula id="pcbi.1005687.e053"><alternatives><graphic id="pcbi.1005687.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:msubsup><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mi>T</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. This is then applied to the Snyder filter to obtain <inline-formula id="pcbi.1005687.e054"><alternatives><graphic id="pcbi.1005687.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. While the standard Snyder filter cannot achieve MMSE estimates given a distorted photon stream, as long as <inline-formula id="pcbi.1005687.e055"><alternatives><graphic id="pcbi.1005687.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:msubsup><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mi>T</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is sufficiently close to <inline-formula id="pcbi.1005687.e056"><alternatives><graphic id="pcbi.1005687.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:msubsup><mml:mi>P</mml:mi> <mml:mn>0</mml:mn> <mml:mi>T</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> in some sense then <inline-formula id="pcbi.1005687.e057"><alternatives><graphic id="pcbi.1005687.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> should not be too much larger than mse<sub>qb</sub>. The integrate-fire part of the algorithm generates a good <inline-formula id="pcbi.1005687.e058"><alternatives><graphic id="pcbi.1005687.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:msubsup><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mi>T</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> from the QB signal by minimising the dissimilarity between the real and estimated photon streams. This is done by treating photons as spikes and optimising a spike distance metric across a training data set. The Victor-Purpura D<sup>spike</sup> [<xref ref-type="bibr" rid="pcbi.1005687.ref040">40</xref>] measure, which calculates the optimal transformation from one train to the other via shifts, deletions or insertions of spikes (all of which have an associated transformation cost), was used. D<sup>spike</sup> performed well and possessed clear minima. In contrast, optimising directly using the calculated <inline-formula id="pcbi.1005687.e059"><alternatives><graphic id="pcbi.1005687.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> was found to be computationally problematic.</p>
<p>Let <inline-formula id="pcbi.1005687.e060"><alternatives><graphic id="pcbi.1005687.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:msubsup><mml:mi>P</mml:mi> <mml:mn>0</mml:mn> <mml:mi>T</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005687.e061"><alternatives><graphic id="pcbi.1005687.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn> <mml:mi>T</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> be partitioned into training sets <italic>P</italic><sub><italic>a</italic></sub> and <italic>Q</italic><sub><italic>a</italic></sub> and test sets <italic>P</italic><sub><italic>b</italic></sub> and <italic>Q</italic><sub><italic>b</italic></sub>. The training set is used to optimise the mapping from the real photon stream to the estimated one. The test set ensures the designed mapping properly captures the overall relationship and is neither over-trained nor under-trained. The training stage optimises a constant <inline-formula id="pcbi.1005687.e062"><alternatives><graphic id="pcbi.1005687.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mrow><mml:mi>ζ</mml:mi> <mml:mo>=</mml:mo> <mml:mi>m</mml:mi> <mml:mfrac><mml:mrow><mml:mo>∫</mml:mo> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow> <mml:mrow><mml:mo>∫</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> where the integral is over the time frame of the training set and <italic>m</italic> is the varying parameter of interest. Here <italic>ζ</italic> is interpreted as a multiple of the average charge integral of a single photon QB response. The estimated time of the <italic>n</italic><sup>th</sup> photon in the testing stage occurs at the first time <italic>t</italic>: ∫<italic>Q</italic><sub><italic>b</italic></sub> <italic>dt</italic> &gt; <italic>nζ</italic>, with the integral over the test data set. The method fires photons every time the integrated QB signal crosses an optimised threshold, <italic>ζ</italic>.</p>
<p><xref ref-type="fig" rid="pcbi.1005687.g003">Fig 3</xref> shows the spike metric optimisation curves, which have a clear minimum at <italic>m</italic> ≈ 1. The best <inline-formula id="pcbi.1005687.e063"><alternatives><graphic id="pcbi.1005687.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> values were obtained when the shift cost of D<sup>spike</sup> goes to 0. At this setting the metric gives the difference in the photon count between the real and estimated stream. This can be confirmed by defining a photon count cost on the training set as <inline-formula id="pcbi.1005687.e064"><alternatives><graphic id="pcbi.1005687.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mrow><mml:mrow><mml:mi>μ</mml:mi> <mml:mo>=</mml:mo> <mml:mo>|</mml:mo> <mml:mo>∫</mml:mo></mml:mrow> <mml:msub><mml:mi>P</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mo>∫</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mspace width="0.166667em"/><mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Here ∫<italic>P</italic><sub><italic>a</italic></sub> <italic>dt</italic> = 〈<italic>Q</italic><sub><italic>a</italic></sub>〉<sup>−1</sup>∫<italic>Q</italic><sub><italic>a</italic></sub> <italic>dt</italic> is the integral of the true photon stream from the training set and <inline-formula id="pcbi.1005687.e065"><alternatives><graphic id="pcbi.1005687.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mrow><mml:mo>∫</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo> <mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>∫</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is the integral of the estimated photon stream using the integrate-fire method with parameter <italic>m</italic>. The quantity 〈<italic>Q</italic><sub><italic>a</italic></sub>〉 = <italic>ζm</italic><sup>−1</sup> is the average QB charge per photon, from the training set. Substituting these expressions: <italic>μ</italic> = (1 − <italic>m</italic>)<italic>mζ</italic><sup>−1</sup>∫<italic>Q</italic><sub><italic>a</italic></sub> <italic>dt</italic>. This is minimised when <italic>m</italic> = 1 for any QB set. This optimisation will therefore produce good results as long as the QB charge per photon is similar in the training and test sets. This condition is guaranteed for sufficiently large test and training sets. Thus, using the optimal <italic>m</italic> = 1, the integrate-fire converts some input photon stream into an estimated one every time ∫<italic>Q</italic><sub><italic>b</italic></sub> <italic>dt</italic> crosses an integer multiple of 〈<italic>Q</italic><sub><italic>a</italic></sub>〉. The resulting stream is then fed into the Snyder filter to produce <inline-formula id="pcbi.1005687.e066"><alternatives><graphic id="pcbi.1005687.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<fig id="pcbi.1005687.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005687.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Spike metric optimisation shows a clear minimum when only photon counts are used.</title>
<p>Parameter <italic>q</italic> indicates the relative cost of shifting versus inserting/deleting photons. For small values of <italic>q</italic> (shifts are unimportant) a clear minimum appears at <italic>m</italic> = 1 indicating integrate-fire works best with a threshold set at the mean bump area.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.g003" xlink:type="simple"/>
</fig>
<p>The use of a perfect integrator (with <italic>m</italic> = 1) may suggest that errors from previously processed QBs (due to their area deviating from average) would persist with observation time and influence the signalling of upcoming QBs. Often in neuronal modelling this error memory problem is solved by adding a term that continuously drains some of the accumulated charge. This makes the integrator ‘leaky’ [<xref ref-type="bibr" rid="pcbi.1005687.ref039">39</xref>]. However, given the variation of QB area around its mean size it appeared that these memory errors negated each other and lead to the inference of the correct number of photons. Since training with D<sup>spike</sup> indicated that it was more important to get the number than the position of the inferred photons correct; perfect integration worked for this problem. It is not clear that making the scheme leaky would improve performance. If used naively, for example, then losing charge would lead to less effective photons being signalled (false negatives) which could deteriorate performance. However, it could improve performance if <italic>m</italic> and the leaky time constant, <italic>ϵ</italic>, are jointly optimised during training so that the number of photons signalled remains the same as in the perfect integrator case. The value of <italic>ϵ</italic> might then help get the positions of estimated photons closer to those of the real stream. This could only strengthen the following results by tightening the MSE upper bound on the true mse<sub>qb</sub>.</p>
<p>The integrate-fire-Snyder scheme was compared to standard supervised machine learning techniques (Gaussian Processes [<xref ref-type="bibr" rid="pcbi.1005687.ref041">41</xref>]) and optimal linear filtering methods (least squares Finite impulse response [<xref ref-type="bibr" rid="pcbi.1005687.ref042">42</xref>]) which directly estimated a <inline-formula id="pcbi.1005687.e067"><alternatives><graphic id="pcbi.1005687.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:msubsup><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> from the same <inline-formula id="pcbi.1005687.e068"><alternatives><graphic id="pcbi.1005687.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:msubsup><mml:mi>Q</mml:mi> <mml:mn>0</mml:mn> <mml:mi>T</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. The former attempted to fit a covariance function while the latter minimised the square error on a series of filter coefficients. Both methods used variable window sizes (also known as fading memory, this describes how much of the input history affects the output) to get the best performance. These methods worked directly on the QB data without estimating photons. The optimal window size for both schemes was found to be about <inline-formula id="pcbi.1005687.e069"><alternatives><graphic id="pcbi.1005687.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:mrow><mml:mn>5</mml:mn> <mml:mo>(</mml:mo> <mml:mfrac><mml:mn>2</mml:mn> <mml:mi>α</mml:mi></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. A representative simulation of the resulting MSE upper bounds from these techniques is given in <xref ref-type="fig" rid="pcbi.1005687.g004">Fig 4</xref>. The integrate-fire achieved a lower <inline-formula id="pcbi.1005687.e070"><alternatives><graphic id="pcbi.1005687.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> than all of these machine learning schemes. Thus, it appears that estimating a photon stream and applying the Snyder filter leads to appreciably better results than methods which directly estimate <italic>x</italic>(<italic>t</italic>) from the QB waveform. This figure also shows the relationship between the integrate-fire estimator and other techniques which also estimated photons for use with a Snyder filter. The ‘Pure threshold’ scheme produces estimated photons whenever a simple electrical signal threshold is exceeded and the ‘Gradient’ one does so when a forward and backward gradient shift is observed on the QB waveform. The integrate-fire outperformed the threshold scheme but had comparable MSE to the gradient one. However, the gradient scheme is not a robust technique, making integrate-fire the best overall choice. An overview of the general integrate-fire-Snyder estimation process is given in <xref ref-type="fig" rid="pcbi.1005687.g005">Fig 5</xref>.</p>
<fig id="pcbi.1005687.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005687.g004</object-id>
<label>Fig 4</label>
<caption>
<title>The integrate-fire-Snyder outperforms other machine learning and photon estimating schemes across intensity.</title>
<p>The integrate-fire was tested against Gaussian processes and optimised finite impulse response filters which used the bump data directly. It was also compared to other schemes that also estimated photons for processing with Snyder filters. These fired photons based on pure current thresholds or bump gradients. Data is shown for the interrupted model at <italic>γ</italic> = 20 for a given representative light model trajectory of 7000-8000 photons. The integrate-fire showed superior overall performance. Consistent results have also been obtained for <italic>γ</italic> = 5. This motivated the use of the integrate-fire-Snyder as a cascade estimator.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.g004" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005687.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005687.g005</object-id>
<label>Fig 5</label>
<caption>
<title>General integrate-fire-Snyder scheme.</title>
<p>The standard Snyder filter gives the optimal (MMSE) intensity estimate given known photons. The random square wave intensity producing these photons delineates the on-off times in the interrupted light model. The MMSE estimate exactly characterises achievable performance at the front end of the cascade. The photons are converted into bumps by the cascade. The integrate-fire uses an optimised threshold to convert these bumps into estimated photons. These estimated photons are then Snyder filtered to obtain a non-MMSE estimator that upper bounds the deterioration introduced by the cascade.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec010">
<title>Optimal linear and optimal Snyder filtering on delayed photons and their performance relative to integrate-fire-Snyder filtering</title>
<p>To illustrate the importance of using non-linear filtering techniques for this analysis, consider the optimal (MMSE) linear estimate given <inline-formula id="pcbi.1005687.e071"><alternatives><graphic id="pcbi.1005687.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:msubsup><mml:mi>P</mml:mi> <mml:mn>0</mml:mn> <mml:mi>T</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, denoted <inline-formula id="pcbi.1005687.e072"><alternatives><graphic id="pcbi.1005687.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:msubsup><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext> <mml:mi>l</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, with distortion <inline-formula id="pcbi.1005687.e073"><alternatives><graphic id="pcbi.1005687.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>ph</mml:mtext> <mml:mi>l</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. For the interrupted model, this linear MMSE is obtained by applying a continuity approximation to the system state dynamics [<xref ref-type="bibr" rid="pcbi.1005687.ref043">43</xref>] [<xref ref-type="bibr" rid="pcbi.1005687.ref044">44</xref>]. This leads to a differential equation with steady state solution (see Supplement <xref ref-type="supplementary-material" rid="pcbi.1005687.s001">S1 Text</xref>):
<disp-formula id="pcbi.1005687.e074"><alternatives><graphic id="pcbi.1005687.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e074" xlink:type="simple"/><mml:math display="block" id="M74"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>ph</mml:mtext> <mml:mi>l</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>β</mml:mi></mml:mfrac> <mml:mo>(</mml:mo> <mml:msqrt><mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mfrac><mml:mi>β</mml:mi> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msqrt> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
The central importance of the non-dimensional parameter <italic>β</italic> is now obvious. Comparison of the optimal linear estimate given true photons, <inline-formula id="pcbi.1005687.e075"><alternatives><graphic id="pcbi.1005687.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>ph</mml:mtext> <mml:mi>l</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, the optimal non-linear estimate given the true photons, mse<sub>ph</sub>, and the integrate-fire-Snyder estimate (at several <italic>γ</italic>) from the resulting bumps, <inline-formula id="pcbi.1005687.e076"><alternatives><graphic id="pcbi.1005687.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, are given in <xref ref-type="fig" rid="pcbi.1005687.g006">Fig 6</xref>. The significant difference between <inline-formula id="pcbi.1005687.e077"><alternatives><graphic id="pcbi.1005687.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>ph</mml:mtext> <mml:mi>l</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and mse<sub>ph</sub> indicates that some of the MSE is being contributed by the inefficiency of the linear filter as an estimator (since it does not fully model the system dynamics). This additional error can likely cloud or misrepresent the true relative impact of different noise sources. The fact that <inline-formula id="pcbi.1005687.e078"><alternatives><graphic id="pcbi.1005687.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>ph</mml:mtext> <mml:mi>l</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is above <inline-formula id="pcbi.1005687.e079"><alternatives><graphic id="pcbi.1005687.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> at several <italic>γ</italic> suggests that these approximations reduce the ability to resolve the more subtle contributions of cascade variability. Consequently, linearity or continuity approximations can seriously distort one’s view of phototransduction noise performance.</p>
<fig id="pcbi.1005687.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005687.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Suboptimal integrate-fire-Snyder on bumps outperforms MMSE linear filtering on known photons.</title>
<p>The integrate-fire-Snyder was run for <italic>γ</italic> = [5, 10, 20, 30] and results across 10 independent 8000 photon long light model trajectories given. The error-bars delineate the minimum to maximum of the MSE curves for each <italic>γ</italic>. Clearly there exist several <italic>γ</italic> over which the integrate-fire on all cascade noise does better than the linear MMSE on just photon noise, across a wide <italic>β</italic> range. Given the disparity, applying linear or continuity approximations can be a strongly misleading measure of the noise performance of discrete stochastic systems.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.g006" xlink:type="simple"/>
</fig>
<p>As concluded above, keeping analysis exact and non-linear is necessary to properly resolve the contributions of various cascade noise sources. Comparing the integrate-fire-Snyder results with filtering solutions that only feature specific components of the cascade noise should achieve this resolution. Such analysis allows one to identify the major (independent) intrinsic noise sources clearly. These mainly include QB shape (width and height) variation and latency noise (see <xref ref-type="sec" rid="sec001">Introduction</xref>). The impact of shape noise was assessed by elimination and the application of the integrate-fire-Snyder to a deterministic version of the Nikolic model that featured QBs of fixed size and shape. More detail on the differences between stochastic and deterministic Nikolic models is given in Supplement <xref ref-type="supplementary-material" rid="pcbi.1005687.s004">S4 Text</xref>.</p>
<p>QB response latency can be decomposed into a (deterministic) mean delay and a jitter term describing variation around the mean. The effect of the total QB latency was isolated by applying the Snyder filter to photons that have been empirically delayed according to the physiological latency distribution embedded within the Nikolic model. The empirically delayed MSE upper bounds are given in Supplements <xref ref-type="supplementary-material" rid="pcbi.1005687.s008">S4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005687.s009">S5</xref> Figs. To quantify the relative impact of jitter and mean delay a Snyder filter that optimally reconstructs light intensity given a deterministically delayed photon stream was developed.</p>
<p>If the original photon stream up to time <italic>t</italic> is <inline-formula id="pcbi.1005687.e080"><alternatives><graphic id="pcbi.1005687.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, then denote the delayed stream <inline-formula id="pcbi.1005687.e081"><alternatives><graphic id="pcbi.1005687.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:msubsup><mml:mi>P</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> as <inline-formula id="pcbi.1005687.e082"><alternatives><graphic id="pcbi.1005687.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> with delay <italic>τ</italic> ms. The optimal filtering problem focuses on finding the posterior probability vector <inline-formula id="pcbi.1005687.e083"><alternatives><graphic id="pcbi.1005687.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:mrow><mml:mtext>P</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Let the conditional estimate <inline-formula id="pcbi.1005687.e084"><alternatives><graphic id="pcbi.1005687.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi mathvariant="double-struck">E</mml:mi> <mml:mo>[</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Since introduction of the delay does not alter the inter-event spacing of the observed events then the usual Snyder filter can be applied to obtain the estimate <inline-formula id="pcbi.1005687.e085"><alternatives><graphic id="pcbi.1005687.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> using <inline-formula id="pcbi.1005687.e086"><alternatives><graphic id="pcbi.1005687.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> as the observed process. Transforming <inline-formula id="pcbi.1005687.e087"><alternatives><graphic id="pcbi.1005687.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e087" xlink:type="simple"/><mml:math display="inline" id="M87"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> into the desired optimal estimate <inline-formula id="pcbi.1005687.e088"><alternatives><graphic id="pcbi.1005687.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is possible using <inline-formula id="pcbi.1005687.e089"><alternatives><graphic id="pcbi.1005687.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:mrow><mml:mtext>P</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, which is produced by the original Snyder filter. Since there is no data (no observed events) the evolution from the delayed to the desired posterior is achieved using the Chapman-Kolmogorov equations, with initial condition <italic>t</italic> − <italic>τ</italic>. <italic>R</italic> describes the transition rates of the <italic>x</italic>(<italic>t</italic>) Markov chain (see Supplement <xref ref-type="supplementary-material" rid="pcbi.1005687.s001">S1 Text</xref> for more details). This gives <inline-formula id="pcbi.1005687.e090"><alternatives><graphic id="pcbi.1005687.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:mrow><mml:mtext>P</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mtext>P</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>τ</mml:mi> <mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> which is used to calculate the expectation <inline-formula id="pcbi.1005687.e091"><alternatives><graphic id="pcbi.1005687.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e091" xlink:type="simple"/><mml:math display="inline" id="M91"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The solution for the interrupted model between and at event times is provided in eqs <xref ref-type="disp-formula" rid="pcbi.1005687.e092">4</xref> and <xref ref-type="disp-formula" rid="pcbi.1005687.e093">5</xref> respectively.
<disp-formula id="pcbi.1005687.e092"><alternatives><graphic id="pcbi.1005687.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e092" xlink:type="simple"/><mml:math display="block" id="M92"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mi>τ</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msup> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mi>τ</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msup> <mml:mspace width="1pt"/> <mml:mtext>for</mml:mtext> <mml:mspace width="1pt"/><mml:mn>0</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>t</mml:mi> <mml:mo>≤</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula> <disp-formula id="pcbi.1005687.e093"><alternatives><graphic id="pcbi.1005687.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e093" xlink:type="simple"/><mml:math display="block" id="M93"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>+</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mi>τ</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mn>1</mml:mn> <mml:mspace width="4pt"/> <mml:mtext>if</mml:mtext> <mml:mspace width="4pt"/><mml:mi>τ</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
This solution is optimal and not an upper bound like the integrate-fire-Snyder <inline-formula id="pcbi.1005687.e094"><alternatives><graphic id="pcbi.1005687.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e094" xlink:type="simple"/><mml:math display="inline" id="M94"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> curves. When compared to the standard Snyder solution of eqs <xref ref-type="disp-formula" rid="pcbi.1005687.e030">(1)</xref> and <xref ref-type="disp-formula" rid="pcbi.1005687.e031">(2)</xref>, the delayed solution features a higher minima and a lower maxima. This shows the increased uncertainty in this problem as the solution lies closer to the uninformed estimator <inline-formula id="pcbi.1005687.e095"><alternatives><graphic id="pcbi.1005687.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e095" xlink:type="simple"/><mml:math display="inline" id="M95"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi> <mml:mo>[</mml:mo> <mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Observe that <inline-formula id="pcbi.1005687.e096"><alternatives><graphic id="pcbi.1005687.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e096" xlink:type="simple"/><mml:math display="inline" id="M96"><mml:mrow><mml:msub><mml:mo form="prefix" movablelimits="true">lim</mml:mo> <mml:mrow><mml:mi>β</mml:mi> <mml:mo>→</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mspace width="4pt"/> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo form="prefix" movablelimits="true">lim</mml:mo> <mml:mrow><mml:mi>β</mml:mi> <mml:mo>→</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mspace width="4pt"/> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec011">
<title>Comparison of various reconstruction estimates</title>
<p>The main results from preceding sections are combined into <xref ref-type="fig" rid="pcbi.1005687.g007">Fig 7</xref>. Results are averaged over 10 independent photon-QB streams of 8000 photons long with error bars showing the maximum and minimum MSE across the runs. Flickering models at <italic>γ</italic> = [5, 10, 20, 30] are investigated. At <italic>γ</italic> &gt; 30 the relative curve behaviour is unchanged and at <italic>γ</italic> &lt; 5 the model switches too fast for sensible inference (it is beyond the bandwidth of the phototransduction process). The <italic>β</italic> range (1-200) was chosen similarly. Lower <italic>β</italic> means photons are produced too slowly relative to light switches making inference pointless (hence why MSE settles near 0.25) while higher <italic>β</italic> is not any further informative.</p>
<fig id="pcbi.1005687.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005687.g007</object-id>
<label>Fig 7</label>
<caption>
<title>The dominant noise transition from extrinsic to mean delay, with intensity <italic>β</italic>, is consistent for light models with differing relative flicker speed, <italic>γ</italic>.</title>
<p>Parameter <italic>γ</italic> indicates the number of bumps which can be received per Markov switch time of the light model. Higher <italic>γ</italic> therefore means a relatively slower flicker. At lower <italic>γ</italic> less information is available and hence the MSE higher. The ‘Snyder, delay’ curves are MMSE values obtained with the Snyder filter optimised for a deterministic delay set to the mean QB latency. These lower bound the noise introduced by the cascade. The ‘Integrate-fire, all noise’ ones are upper bounds as they involve processing the QBs from the fully stochastic Nikolic model. The closeness of both of these curve sets reflects the dominance of mean delay among cascade noise components. This hypothesis is further confirmed by the closeness of ‘Integrate-fire, all noise’ with the MSE generated by applying the integrate-fire-Snyder on the deterministic Nikolic model, which only featured the mean delay (‘Integrate-fire, delay’) and fixed QB shapes. The ‘Snyder, photon noise’ gives the noise floor since it is the MMSE achievable at the front of the cascade. Convergence with this at low <italic>β</italic> shows cascade noise is unimportant in that regime. All curves are averages over 10 independent 8000 photon-QB streams with error bars indicating the maximum and minimum MSE swings around this value.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.g007" xlink:type="simple"/>
</fig>
<p>The ‘Snyder, photon noise’ curves give mse<sub>ph</sub>, or the noise floor of the model while ‘Snyder, delay’ refers to mse<sub>d</sub> (photon noise and a deterministic delay). The remaining curves are integrate-fire-Snyder upper bounds. The ‘all noise’ ones correspond to <inline-formula id="pcbi.1005687.e097"><alternatives><graphic id="pcbi.1005687.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e097" xlink:type="simple"/><mml:math display="inline" id="M97"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> (fully stochastic Nikolic model) while the ‘delay’ ones refer to the integrate-fire-Snyder applied to QBs from the deterministic Nikolic model. This last curve set is used to confirm the subsequent conclusions and involves applying the integrate-fire-Snyder algorithm to the Nikolic model with all its variability switched off. Consequently, the QB stream has deterministic bump shapes and sizes and there is no latency jitter. As a result, only the mean of the stochastic delay acts in this model. These 4 sets of curves provide an overall perspective of noise performance with relative light intensity and illustrate the main conclusions that will follow.</p>
<p>At low <italic>β</italic> all curves converge, while at higher <italic>β</italic> the cascade noise separates the ‘Snyder, photon noise’ ones from the rest. The ‘Snyder, photon noise’ curves are exactly the MMSEs achievable at the front of the cascade, and cannot be bettered. The ‘Snyder, delay’ curves are hard lower bounds, in the sense that they provide a lower limit on the remaining error when all sources of cascade variability are removed. Since this setting also applies to the deterministic Nikolic model then the ‘Integrate-fire, delay’ is an upper bound on the impact of the mean QB delay. The precise MMSE curve under this setting would lie between these bounds. The ‘Integrate-fire, all noise’ curves are an upper bound on all photon and cascade based distortion. All 3 of these sets of bounds remain close at higher <italic>β</italic> suggesting mean delay is the key intrinsic noise component. The relative behaviour of the MSE curves with <italic>β</italic>, remains unchanged as <italic>γ</italic> changes. Higher MSE values are observed at lower <italic>γ</italic> as a relatively faster flickering model (less QBs are available per state) is more difficult to estimate. In all simulations <italic>τ</italic> = 43.3 ms is used to match the mean delay from the Nikolic QB latency distribution.</p>
<p>This analysis was also repeated using more complex and realistic 16 state bimodal light models. Similar results were obtained and the relative behaviour of the MSE curves found to be consistent with the above descriptions (see Supplements <xref ref-type="supplementary-material" rid="pcbi.1005687.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005687.s003">S3</xref> Text, <xref ref-type="supplementary-material" rid="pcbi.1005687.s008">S4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005687.s009">S5</xref> Figs). In the bimodal model higher frequency small amplitude fluctuations are superimposed on a lower frequency flickering (modal switching) between high and low light levels (the modes). This gives a characteristic <inline-formula id="pcbi.1005687.e098"><alternatives><graphic id="pcbi.1005687.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e098" xlink:type="simple"/><mml:math display="inline" id="M98"><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>f</mml:mi></mml:mfrac></mml:math></alternatives></inline-formula> like power spectrum behaviour over a frequency, <italic>f</italic>, range of almost two decades. The precise exponent was <italic>f</italic><sup>−1.23</sup>.</p>
</sec>
<sec id="sec012">
<title>The integrate-fire-Snyder algorithm uses simple computations that are potentially biologically realisable</title>
<p>The integrate-fire-Snyder algorithm is a surprisingly simple yet effective way of reconstructing light intensity from the bumps. Given these attributes, one wonders if it could potentially be implemented within a biologically sensible neuronal network framework. The algorithm is composed of two main parts; i) an integrate-fire estimator that gives <inline-formula id="pcbi.1005687.e099"><alternatives><graphic id="pcbi.1005687.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e099" xlink:type="simple"/><mml:math display="inline" id="M99"><mml:msubsup><mml:mover accent="true"><mml:mi>P</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and ii) the Snyder filter that leads to the state estimate <inline-formula id="pcbi.1005687.e100"><alternatives><graphic id="pcbi.1005687.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e100" xlink:type="simple"/><mml:math display="inline" id="M100"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The integrate-fire part involves the accumulation of QB charge until some spike optimised threshold, <italic>ζ</italic> is crossed. Once <italic>ζ</italic> is exceeded a point event is emitted to indicate a suspected photon. This description is standard in neuronal modelling with the build up of charge usually leading to the release of an action potential or spike [<xref ref-type="bibr" rid="pcbi.1005687.ref039">39</xref>].</p>
<p>While the integrate-fire mechanism is biologically implementable, the optimisation of its threshold (which depends on the parameter <italic>m</italic>) requires a supervisory learning technique that uses true photon times. In reality, the invertebrate visual system does not have access to this data. Unsupervised learning procedures may therefore be necessary. If light intensity is low, unsupervised integrate-fire training should be easily realisable. In this regime QBs are distinct and far apart so the integration threshold is obvious. In the high intensity regime where QBs merge together, a more sophisticated way of reducing the data into effective photons is needed. This would likely involve finding clusters (which code for sets of QBs) within the data. Standard algorithms exist for extracting clusters and structure from input data. These can be implemented in modular, Hebbian learning networks [<xref ref-type="bibr" rid="pcbi.1005687.ref045">45</xref>] which are meant to resemble actual spiking neuronal computational behaviours. Hence, it should be possible to train the integrate-fire scheme in a biologically sensible manner, especially as only a single parameter must be learnt. However, given that threshold optimisation found that the integrate-fire should only signal photons every time the average bump charge is crossed, training may not be necessary. The average QB area could likely be a parameter that is naturally encoded in the cascade biology.</p>
<p>The second part of the algorithm uses standard Snyder filtering. The filter solution involves an instantaneous update at the event time which serves as the initial condition for a decaying inter-event trajectory. For all Markov chain state models it can be shown that the inter-event Snyder solution can be expressed as a linear equation set in un-normalised probabilities that must then be normalised [<xref ref-type="bibr" rid="pcbi.1005687.ref046">46</xref>] (see Supplement <xref ref-type="supplementary-material" rid="pcbi.1005687.s002">S2 Text</xref>). Using this formulation the inter-event trajectory can be seen as only involving weighted combinations of exponentially decaying functions. Bobrowski <italic>et al</italic> [<xref ref-type="bibr" rid="pcbi.1005687.ref032">32</xref>] provided strong evidence that these linear Snyder computations can be achieved with a recurrent neural network that is physiologically realisable and which uses simple operations such as weighted sums. This involves a graphical structure that treats incoming spikes as inputs from a sensory layer and encodes the causal posterior components, with another layer that has weights derived from the Markov state transition rates. Having a neuronal population code for posterior probabilities has already been shown to be biologically plausible [<xref ref-type="bibr" rid="pcbi.1005687.ref047">47</xref>]. Further, it is known that recurrent networks of integrate-fire neurons are able to represent distributions given noisy inputs [<xref ref-type="bibr" rid="pcbi.1005687.ref048">48</xref>]. As a result, all parts of the complete integrate-fire-Snyder estimation algorithm possess the potential for possible biological implementation.</p>
</sec>
</sec>
<sec id="sec013" sec-type="conclusions">
<title>Discussion</title>
<sec id="sec014">
<title>Bump shape is relatively unimportant, mean latency is critical, integrate-fire-Snyder is a powerful estimation scheme</title>
<p>The above analyses show that as light intensity increases, the dominant noise source transitions from being extrinsic to intrinsic. Furthermore, among intrinsic noise sources, it seems that the performance deterioration caused by QB shape variability is small compared to that introduced by the mean cascade delay. As a result, the relative magnitude of the mean QB arrival time, given a photon, to the mean photon inter-arrival time is a key indicator of noise performance. Such an event timing based description of noise fits well into the Poisson channel framework in which this estimation problem lies.</p>
<p>The relatively small impact of QB shape noise is particularly significant. Previous research using signal to noise ratios found QB amplitude variation responsible for limiting cascade reliability at all frequencies [<xref ref-type="bibr" rid="pcbi.1005687.ref010">10</xref>]. This diametrically opposite conclusion is likely evidence of why it is important to get the performance metric right [<xref ref-type="bibr" rid="pcbi.1005687.ref049">49</xref>]. Furthermore, work based on the Poisson-variance approach [<xref ref-type="bibr" rid="pcbi.1005687.ref009">9</xref>] predicted that at least half of the total noise (extrinsic and intrinsic) was always due to the cascade. This directly belies the extrinsic-intrinsic noise transition described here and elucidates the importance of maintaining a point process approach which properly accounts for signal causality.</p>
<p>The mse<sub>d</sub> curve exactly describes the optimal distortion given photon noise and only a fixed cascade delay. It therefore provides a distortion lower bound by describing a hypothetical scenario in which all (independent) sources of variability have been removed from the cascade. The <inline-formula id="pcbi.1005687.e101"><alternatives><graphic id="pcbi.1005687.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e101" xlink:type="simple"/><mml:math display="inline" id="M101"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> curve is derived from the integrate-fire-Snyder algorithm and upper bounds the unknown MMSE given the QB stream. Simulations found that these two bounds were generally in close agreement. This suggests that the integrate-fire-Snyder is likely a good means of converting QBs into estimated photons, over a wide range of intensities. In fact, as shown in <xref ref-type="fig" rid="pcbi.1005687.g004">Fig 4</xref>, the algorithm outperformed several standard machine learning techniques, achieving lower <inline-formula id="pcbi.1005687.e102"><alternatives><graphic id="pcbi.1005687.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e102" xlink:type="simple"/><mml:math display="inline" id="M102"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> values on the same data. This not only reinforces the integrate-fire-Snyder as a good estimation method but also suggests that, generally, it may be beneficial to reduce a QB stream to an estimated photon stream before performing inference. This seems reasonable as QBs, being responses to individual photons, must have a discrete information structure embedded within their noisy waveforms. Note that, since the integrate-fire-Snyder makes few assumptions on its input and output signals, it may also have applications in more general systems with discrete-sum informational structures.</p>
<p>Work by van Steveninck and Laughlin [<xref ref-type="bibr" rid="pcbi.1005687.ref050">50</xref>] treated the transduction process as a filtering operation and postulated that one could recover the exact photon times by inverting the filter, subject to fundamental performance limitations. The integrate-fire-Snyder algorithm fits exactly into this framework, albeit in a non-linear point process setting, and thus provides a good answer to this postulation. The algorithm performance suggests that generating a good photon event estimation is sufficient to achieve good <inline-formula id="pcbi.1005687.e103"><alternatives><graphic id="pcbi.1005687.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e103" xlink:type="simple"/><mml:math display="inline" id="M103"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> and that more complex techniques are unnecessary. However, the use of simplifying techniques that do not fully model process dynamics can also be misleading. There exists a set of (<italic>α</italic>, <italic>k</italic>) for which the noisy integrate-fire-Snyder estimate, <inline-formula id="pcbi.1005687.e104"><alternatives><graphic id="pcbi.1005687.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e104" xlink:type="simple"/><mml:math display="inline" id="M104"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, outperforms the linear MMSE estimate given the true photon data, <inline-formula id="pcbi.1005687.e105"><alternatives><graphic id="pcbi.1005687.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e105" xlink:type="simple"/><mml:math display="inline" id="M105"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>ph</mml:mtext> <mml:mi>l</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> (see <xref ref-type="fig" rid="pcbi.1005687.g006">Fig 6</xref>). Any linear estimator using the QB data must do even worse. Performing the analysis under a linear or continuity approximation therefore gives a wrong impression of the noise floor for the system (since the MSE with only photon noise is so high) and will not resolve the more subtle noise source contributions. This results in a spurious picture of phototransduction noise performance. For a more detailed analysis of the dangers of such approximations, when applied to systems which are naturally discrete and causal see Parag and Vinnicombe [<xref ref-type="bibr" rid="pcbi.1005687.ref051">51</xref>] [<xref ref-type="bibr" rid="pcbi.1005687.ref030">30</xref>].</p>
<p>For all the stimuli investigated, photon noise was found to be limiting at low light intensities. This is likely due to the photon inter-arrival time being much larger than the delays and widths of QBs. Given this dominance, one can easily convert QBs into estimated photons using naive threshold based methods (see the ‘pure threshold’ curve of <xref ref-type="fig" rid="pcbi.1005687.g004">Fig 4</xref>), as the cascade deterioration has negligible impact on inference. Further, as <inline-formula id="pcbi.1005687.e106"><alternatives><graphic id="pcbi.1005687.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e106" xlink:type="simple"/><mml:math display="inline" id="M106"><mml:mrow><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>≈</mml:mo> <mml:msub><mml:mtext>mse</mml:mtext> <mml:mtext>ph</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> in this region, the true MMSE given QBs can be well approximated with the exact, standard Snyder solution. As intensity increases all MSE curves fall due to the availability of more information. However, cascade based noise becomes visible as the <inline-formula id="pcbi.1005687.e107"><alternatives><graphic id="pcbi.1005687.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e107" xlink:type="simple"/><mml:math display="inline" id="M107"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> curve significantly separates from the mse<sub>ph</sub> one. This divergence increases with normalised intensity, <italic>β</italic>. At very high intensities photon noise contributes almost nothing and mse<sub>ph</sub> → 0 as <italic>β</italic> → ∞.</p>
<p>A major part of this work involved trying to infer the relative contributions of the various intrinsic noise sources. As noted previously, intrinsic noise is composed of dark noise (false positive QBs), QB shape noise (amplitude and width variability), QB latency (mean delay and jitter) and a quantum capture efficiency, QE &lt; 1 (an analogue to false negative QBs). These components are independent of each other and can therefore be treated in isolation. Dark noise is negligible under the conditions of this work and was excluded from analysis. QE is usually high in real invertebrate visual systems and it can be treated as an additional noise component on top of the cascade noise (which involves QB shape and latency). Moreover, simulations found results to be robust to the loss of up to <inline-formula id="pcbi.1005687.e108"><alternatives><graphic id="pcbi.1005687.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e108" xlink:type="simple"/><mml:math display="inline" id="M108"><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>3</mml:mn></mml:mfrac></mml:math></alternatives></inline-formula> of all input photons (QE = 0.66) (see Supplements <xref ref-type="supplementary-material" rid="pcbi.1005687.s003">S3 Text</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005687.s008">S4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005687.s009">S5</xref> Figs). The integrate-fire-Snyder adapted to lower QEs by simply reducing its trained firing threshold <italic>ζ</italic>, which encodes how much QB charge is believed to represent a photon. As a result, QE can be largely ignored.</p>
<p>The relative noise problem in the medium-high intensity regime was therefore reduced to one of disentangling the relative impact of QB shape and latency. This was initially investigated by comparing the <inline-formula id="pcbi.1005687.e109"><alternatives><graphic id="pcbi.1005687.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e109" xlink:type="simple"/><mml:math display="inline" id="M109"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> bounds achievable with different noise components excluded from the Nikolic model. If shape noise is removed then the observed QB stream is equivalent to the input photon stream distorted according to the physiological QB latency distribution. This stream was described as empirically delayed. The optimal filter for empirically delayed photons is computationally intractable. However, it was found that applying the standard Snyder filter to the empirically delayed photons gave an MSE upper bound that was in close agreement with the fully noisy <inline-formula id="pcbi.1005687.e110"><alternatives><graphic id="pcbi.1005687.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e110" xlink:type="simple"/><mml:math display="inline" id="M110"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> (see Supplements <xref ref-type="supplementary-material" rid="pcbi.1005687.s003">S3 Text</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005687.s008">S4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005687.s009">S5</xref> Figs). This hinted that shape noise could be less important than latency. To test this hypothesis it was necessary to construct complementary lower bounds on achievable noise performance.</p>
<p>The QB latency profile can be well described by a normal distribution that matched its mean [<xref ref-type="bibr" rid="pcbi.1005687.ref052">52</xref>]. Since normal distributions are parameterised solely in terms of their mean and variance, QB latency may then be considered as essentially and independently composed of a mean delay and jitter. Separating the impact of each component therefore makes sense. The mean delay was analysed, because i) unlike jitter it can be examined within an exact inference framework, and ii) fixed delays or dead times have a clear and important impact on causally constrained real time systems such as vision. Additionally, there is some evidence in the literature for dead times and fixed delays being both irreducible and critical to high intensity phototransduction noise performance [<xref ref-type="bibr" rid="pcbi.1005687.ref052">52</xref>]. This motivated the development of the optimal deterministically delayed Snyder filter, which yielded the mse<sub>d</sub> curve. This curve provided a lower bound on the remaining error when all cascade variability, including jitter, was removed.</p>
<p>A close correspondence between mse<sub>d</sub> and <inline-formula id="pcbi.1005687.e111"><alternatives><graphic id="pcbi.1005687.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e111" xlink:type="simple"/><mml:math display="inline" id="M111"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> was observed across all the light models investigated. This confirmed QB latency as the dominant cascade noise source and suggested that the mean delay in generating a QB from a photon input is critical to cascade noise performance. In fact, when plotted, the most visible difference between <inline-formula id="pcbi.1005687.e112"><alternatives><graphic id="pcbi.1005687.e112g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e112" xlink:type="simple"/><mml:math display="inline" id="M112"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005687.e113"><alternatives><graphic id="pcbi.1005687.e113g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e113" xlink:type="simple"/><mml:math display="inline" id="M113"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is a time shift which is of the order of the mean delay. For an illustration of this difference on a more complex light model see Supplement <xref ref-type="supplementary-material" rid="pcbi.1005687.s010">S6 Fig</xref>. The cascade therefore essentially encodes discrete events as delayed electrical depolarisations. As a result, by elimination, the actual shape of the latency distribution is not very important and the variable shape of the QB largely insignificant. This conclusion was further investigated by applying the integrate-fire-Snyder to the Nikolic model with all forms of variability turned off. At this setting QBs are of deterministic shape and size, and only the mean delay is acting on the cascade. The resulting MSE curves lay close to and between mse<sub>d</sub> and <inline-formula id="pcbi.1005687.e114"><alternatives><graphic id="pcbi.1005687.e114g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e114" xlink:type="simple"/><mml:math display="inline" id="M114"><mml:msubsup><mml:mtext>mse</mml:mtext> <mml:mtext>qb</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>. This correspondence validated the performance deteriorating dominance of mean delay.</p>
<p>Thus to a first approximation, the complex set of cascade reactions can be replaced with a pure delay on the photon inputs. This conclusion contradicts the work in [<xref ref-type="bibr" rid="pcbi.1005687.ref009">9</xref>] and reiterates the importance of maintaining a causal, discrete approach. This is especially the case here since pure delays do not affect the common (acausal) mutual information and would largely be neglected in such analyses. However, this work asserts that such delays are important, especially as they may limit the ability of an invertebrate to respond rapidly to stimuli. The dominance of QB delay on cascade noise means that QB shape can be optimised for other performance goals, such as achieving a dynamic range that maximises the input amplitude representation, without affecting cascade accuracy. This shape-latency decoupling allows for more flexible cascade functionality and may underly why experiments have found the QB waveform and latency to be uncorrelated [<xref ref-type="bibr" rid="pcbi.1005687.ref016">16</xref>].</p>
</sec>
<sec id="sec015">
<title>Reducing mean delay may not be physiologically possible</title>
<p>Cascade delay appears to be the single largest intrinsic noise component. One may therefore wonder why nature has not further optimised phototransduction to reduce its impact. Reducing delay would not only improve accuracy but also increase visual bandwidth. According to Eckert and Zeil [<xref ref-type="bibr" rid="pcbi.1005687.ref053">53</xref>] faster phototransduction requires more mitochondria and hence is much more energy intensive. Consequently, improving latency will only be feasible if the organism is willing to devote more energy to visual processes. This explains why flies that must perform more demanding visual tasks, such as Coenosia, have faster cascades than Drosophila [<xref ref-type="bibr" rid="pcbi.1005687.ref054">54</xref>] [<xref ref-type="bibr" rid="pcbi.1005687.ref001">1</xref>]. The dominant effect of cascade delay also clarifies why visual light adaptation, which involves the production of faster QBs, is helpful at high intensities. In this regime the latency becomes much more critically limiting and its impact must therefore be, at least partly, countered [<xref ref-type="bibr" rid="pcbi.1005687.ref014">14</xref>]. A key feature of the adaptation response is a reduced mean delay but a mostly fixed jitter [<xref ref-type="bibr" rid="pcbi.1005687.ref052">52</xref>]. This seems to support the idea that mean delay is the major source of cascade noise.</p>
<p>Moreover, even if energy constraints were not limiting, significantly improving QB latency and mean delay would still be unlikely. The latency relates to the time taken for a sufficient amount of G proteins and phospholipase C molecules to become activated such that the threshold for opening the TRP channels and generating a normal QB is achieved [<xref ref-type="bibr" rid="pcbi.1005687.ref015">15</xref>]. A noteworthy reduction in cascade latency would require a reduction in the threshold for opening the TRP channels. However, this would increase the sensitivity of the cascade to spontaneous phospoholipase C and G protein activations which would lead to an increase in dark noise [<xref ref-type="bibr" rid="pcbi.1005687.ref055">55</xref>]. Thus, mechanistically reducing latency to improve cascade accuracy may simply result in a trade between the limiting noise source and possibly lead to no overall improvement.</p>
</sec>
<sec id="sec016">
<title>Concluding remarks</title>
<p>This paper has outlined a useful scheme for extracting data from QBs and used this to characterise the main sources of noise in invertebrate phototransduction. By making use of the photon counting nature of the visual system, and point process theory, a consistent and accurate measure of relative noise was achieved that extends the stimuli reconstruction methodology of Bobrowski <italic>et al</italic> [<xref ref-type="bibr" rid="pcbi.1005687.ref032">32</xref>] and clarifies the until now contradictory results between the work of van-Steveninck and Bialek [<xref ref-type="bibr" rid="pcbi.1005687.ref010">10</xref>] and those of Lillywhite [<xref ref-type="bibr" rid="pcbi.1005687.ref003">3</xref>] and Laughlin [<xref ref-type="bibr" rid="pcbi.1005687.ref009">9</xref>]. Furthermore, this work pinpointed mean delay as the key cascade noise source and emphasised the dangers of using continuity approximations for inherently discrete random systems. Lastly this research fulfils the request of Grewe <italic>et al</italic> [<xref ref-type="bibr" rid="pcbi.1005687.ref027">27</xref>] for a sensible metric (causal MMSE) which can give a ‘complete description of the system [photoreceptor] performance’.</p>
</sec>
</sec>
<sec id="sec017">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005687.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Snyder point process optimal filtering and optimal linear filtering for the interrupted model.</title>
<p>The general non-linear Snyder filter is presented and then solved for the interrupted model. The optimal linear filter for this model is also derived.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005687.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.s002" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Multi-state bimodal light models simulate a main light switch with gradual transitions between non-modal states.</title>
<p>The bimodal light model is derived and examined in terms of both its similarity to the interrupted model and the extra dynamical complexity it allows.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005687.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.s003" xlink:type="simple">
<label>S3 Text</label>
<caption>
<title>Representative MSE curves for extrinsic and intrinsic noise components on bimodal light models.</title>
<p>A 16 state bimodal model is analysed with the integrate-fire-Snyder approach.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005687.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.s004" xlink:type="simple">
<label>S4 Text</label>
<caption>
<title>The Nikolic phototransduction model.</title>
<p>Further information (including a mathematical description) about the phototransduction model used in this work is provided.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005687.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.s005" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Markov bimodal light model with 8 states coding for different light intensities.</title>
<p>The <italic>a</italic><sub><italic>i</italic></sub> and <italic>b</italic><sub><italic>i</italic></sub> are birth and death reaction rates respectively, indicating incremental (nearest neighbour) increases and decreases in light intensity. The <italic>ϵ</italic><sub><italic>ij</italic></sub> are the modal switches. The rates are chosen to achieve a bimodal state distribution centred on the modal states. The 16 state version of this model was simulated in this work.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005687.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.s006" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Optimal intensity estimate given known photons at t = [0 300] ms for 8 state bimodal model.</title>
<p>The more complex Snyder equations for the bimodal model can be decomposed into an exponential solution that is qualitatively similar to that of the interrupted model (and exactly the same when the Markov chain has only 2 states, which are both trivially modal). Observe the discontinuous update at the photon time of 300ms. This model features <italic>ϵ</italic><sub>36</sub> = <italic>ϵ</italic><sub>63</sub> = <italic>k</italic>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005687.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.s007" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Power spectral density for the 16 state bimodal light intensity.</title>
<p>Fast Fourier transforms were used to calculate the frequency response of the 16 state bimodal light model at [<italic>γ</italic>, <italic>ϵ</italic>] = [10, 3<italic>k</italic>]. The extra small amplitude fluctuations (nearest neighbour reactions) about the high amplitude modal switches leads to ‘<inline-formula id="pcbi.1005687.e115"><alternatives><graphic id="pcbi.1005687.e115g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e115" xlink:type="simple"/><mml:math display="inline" id="M115"><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>f</mml:mi></mml:mfrac></mml:math></alternatives></inline-formula> type’ (precisely <italic>f</italic><sup>−1.23</sup>) behaviour with <italic>f</italic> indicating frequency. This holds over a reasonably large frequency range. This shows that more naturalistic dynamics that can be achieved using higher state Markov modulated Poisson light models.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005687.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.s008" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Photon noise or cascade delay dominates for a bimodal multi-state model.</title>
<p>The conclusions of the interrupted model are shown to hold for the more complex bimodal case. All curves converge at low intensity and all curves with additional intrinsic noise converge at higher intensities. Data is for a 16 state model at [<italic>γ</italic>, <italic>ϵ</italic>] = [20, <italic>k</italic>].</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005687.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.s009" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Results on dominant noise remain unchanged with <italic>γ</italic> for the multi-state bimodal models.</title>
<p>The key conclusions from the filtering analysis across <italic>β</italic> and <italic>γ</italic> remain true for more complex models such as this one. Data is for a 16 state bimodal model at [<italic>γ</italic>, <italic>ϵ</italic>] = [10, 3<italic>k</italic>].</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005687.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.s010" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Estimated intensities before and after the cascade show it mostly acts as a deterministic delay.</title>
<p>The integrate-fire-Snyder conditional estimate <inline-formula id="pcbi.1005687.e116"><alternatives><graphic id="pcbi.1005687.e116g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e116" xlink:type="simple"/><mml:math display="inline" id="M116"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mtext>qb</mml:mtext></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (QE = 0.66, all noise) appears as a delayed version of the Snyder MMSE estimate (only photon noise) <inline-formula id="pcbi.1005687.e117"><alternatives><graphic id="pcbi.1005687.e117g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005687.e117" xlink:type="simple"/><mml:math display="inline" id="M117"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>ph</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The data is for a bimodal 16 state model with [<italic>γ</italic>, <italic>ϵ</italic>] = [20, <italic>k</italic>] and <italic>β</italic> = 100. The normalised relative intensity <italic>β</italic> is set to fall within the parameter regime where intrinsic noise dominates.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005687.s011" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.s011" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>The Nikolic noise distributions for QBs.</title>
<p>The Nikolic model was run over across 9006 QBs and the resulting QB latency, height and area histograms obtained. Observe the mean delay is around 43ms. These distributions are known to match experimental results. In the deterministic Nikolic implementation, all these histograms collapse to their fixed mean values.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005687.s012" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005687.s012" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>The average QB shape from the Nikolic model.</title>
<p>The stochastic Nikolic model was run over 9006 QBs and the photocurrent responses averaged. The resulting QB was compared directly with experimental data from Hardie <italic>et al</italic> [<xref ref-type="bibr" rid="pcbi.1005687.ref013">13</xref>].</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors would like to thank Simon Laughlin and Ioannis Lestas for their helpful discussions on fly vision and Snyder filtering respectively.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005687.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Laughlin</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Weckstrom</surname> <given-names>M</given-names></name> (<year>1993</year>) <article-title>Fast and Slow Photoreceptors—a Comparative Study of the Functional Diversity of Coding and Conductances in the Diptera</article-title>. <source>J Comp Physiol A</source> <volume>172</volume>: <fpage>593</fpage>–<lpage>609</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00213682" xlink:type="simple">10.1007/BF00213682</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lamb</surname> <given-names>T</given-names></name> (<year>1987</year>) <article-title>Sources of Noise in Photoreceptor Transduction</article-title>. <source>Optical Society of America</source> <volume>4</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1364/JOSAA.4.002295" xlink:type="simple">10.1364/JOSAA.4.002295</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lillywhite</surname> <given-names>P</given-names></name> (<year>1977</year>) <article-title>Single Photon Signals and Transduction in an Insect Eye</article-title>. <source>Journal of Comparative Physiology</source> <volume>122</volume>: <fpage>189</fpage>–<lpage>200</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00611889" xlink:type="simple">10.1007/BF00611889</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref004">
<label>4</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Cover</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>J</given-names></name> (<year>2006</year>) <source>Elements of Information Theory</source> <edition>Second Edition</edition>. <publisher-name>John Wiley and Sons</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1005687.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hecht</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Shlaer</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Pirenne</surname> <given-names>M</given-names></name> (<year>1942</year>) <article-title>Energy, Quanta and Vision</article-title>. <source>J Gen Physiol</source> <volume>25</volume>: <fpage>819</fpage>–<lpage>840</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1085/jgp.25.6.819" xlink:type="simple">10.1085/jgp.25.6.819</ext-link></comment> <object-id pub-id-type="pmid">19873316</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Field</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Sampath</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rieke</surname> <given-names>F</given-names></name> (<year>2005</year>) <article-title>Retinal Processing Near Absolute Threshold: from Behavior to Mechanism</article-title>. <source>Annual Review of Physiology</source> <volume>67</volume>: <fpage>491</fpage>–<lpage>514</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev.physiol.67.031103.151256" xlink:type="simple">10.1146/annurev.physiol.67.031103.151256</ext-link></comment> <object-id pub-id-type="pmid">15709967</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hardie</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Raghu</surname> <given-names>P</given-names></name> (<year>2001</year>) <article-title>Visual Transduction in Drosophila</article-title>. <source>Nature</source> <volume>413</volume>: <fpage>186</fpage>–<lpage>93</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/35093002" xlink:type="simple">10.1038/35093002</ext-link></comment> <object-id pub-id-type="pmid">11557987</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sampath</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rieke</surname> <given-names>F</given-names></name> (<year>2004</year>) <article-title>Selective Transmission of Single Photon Responses by Saturation at the Rod-to-Rod Bipolar Synapse</article-title>. <source>Neuron</source> <volume>41</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0896-6273(04)00005-4" xlink:type="simple">10.1016/S0896-6273(04)00005-4</ext-link></comment> <object-id pub-id-type="pmid">14766181</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Laughlin</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lillwhite</surname> <given-names>P</given-names></name> (<year>1982</year>) <article-title>Intrinsic Noise in Locust Photoreceptors</article-title>. <source>J Gen Physiol</source> <volume>332</volume>: <fpage>25</fpage>–<lpage>45</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1113/jphysiol.1982.sp014398" xlink:type="simple">10.1113/jphysiol.1982.sp014398</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref010">
<label>10</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>van Steveninck</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name> (<year>2001</year>) <chapter-title>Timing and Counting Precision in the Blowfly Visual System</chapter-title>. <source>Methods in Neural Networks IV</source>: <fpage>313</fpage>–<lpage>371</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005687.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Snyder</surname> <given-names>D</given-names></name> (<year>1972</year>) <article-title>Filtering and Detection for Doubly Stochastic Poisson Processes</article-title>. <source>IEEE Transactions on Information Theory</source> <volume>18</volume>: <fpage>91</fpage>–<lpage>102</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005687.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kalman</surname> <given-names>R</given-names></name> (<year>1960</year>) <article-title>A New Approach to Linear Filtering and Prediction Problems</article-title>. <source>Journal of Basic Engineering</source> <volume>82</volume>: <fpage>35</fpage>–<lpage>45</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1115/1.3662552" xlink:type="simple">10.1115/1.3662552</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hardie</surname> <given-names>R</given-names></name> (<year>2012</year>) <article-title>Phototransduction Mechanisms in Drosophila Microvillar Photoreceptors</article-title>. <source>WIREs Membr Transp Signal</source> <volume>1</volume>: <fpage>162</fpage>–<lpage>187</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/wmts.20" xlink:type="simple">10.1002/wmts.20</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hardie</surname> <given-names>R</given-names></name> (<year>2001</year>) <article-title>Phototransduction in Drosophila melanogaster</article-title>. <source>Journal of Experimental Biology</source> <volume>204</volume>. <object-id pub-id-type="pmid">11707492</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pumir</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Greaves</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ranganathan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Shraiman</surname> <given-names>B</given-names></name> (<year>2008</year>) <article-title>Systems Analysis of the Single Photon Response in Invertebrate Photoreceptors</article-title>. <source>Proceedings of the National Academy of Science of the USA</source> <volume>105</volume>: <fpage>10354</fpage>–<lpage>10359</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0711884105" xlink:type="simple">10.1073/pnas.0711884105</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Katz</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Baruch</surname> <given-names>M</given-names></name> (<year>2009</year>) <article-title>Drosophila Photoreceptors and Signalling Mechanisms</article-title>. <source>Frontiers in Cellular Neuroscience</source> <volume>3</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/neuro.03.002.2009" xlink:type="simple">10.3389/neuro.03.002.2009</ext-link></comment> <object-id pub-id-type="pmid">19623243</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Warrant</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Dacke</surname> <given-names>M</given-names></name> (<year>2011</year>) <article-title>Vision and Visual Navigation in Nocturnal Insects</article-title>. <source>Annual Review of Entomology</source> <volume>56</volume>: <fpage>239</fpage>–<lpage>254</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev-ento-120709-144852" xlink:type="simple">10.1146/annurev-ento-120709-144852</ext-link></comment> <object-id pub-id-type="pmid">20822443</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Song</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Postma</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Billings</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Coca</surname> <given-names>D</given-names></name> (<year>2012</year>) <article-title>Stochastic Adaptive Sampling of Information by Microvilli in Fly Photoreceptors</article-title>. <source>Current Biology</source> <volume>22</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cub.2012.05.047" xlink:type="simple">10.1016/j.cub.2012.05.047</ext-link></comment> <object-id pub-id-type="pmid">22704990</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nikolic</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Loizu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Degenaar</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Toumazou</surname> <given-names>C</given-names></name> (<year>2010</year>) <article-title>A Stochastic Model of the Single Photon Response in Drosophila Photoreceptors</article-title>. <source>Integrative Biology</source> <volume>2</volume>: <fpage>354</fpage>–<lpage>370</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1039/c0ib00031k" xlink:type="simple">10.1039/c0ib00031k</ext-link></comment> <object-id pub-id-type="pmid">20648395</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nikolic</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Loizu</surname> <given-names>J</given-names></name> (<year>2013</year>) <article-title>Drosophila Photo-transduction Simulator</article-title>. <source>Journal of Open Research Software</source> <volume>1</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5334/503b9b1a69665" xlink:type="simple">10.5334/503b9b1a69665</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lestas</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Vinnicombe</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Paulsson</surname> <given-names>J</given-names></name> (<year>2010</year>) <article-title>Fundamental Limits on the Supression of Molecular Fluctuations</article-title>. <source>Nature</source> <volume>467</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature09333" xlink:type="simple">10.1038/nature09333</ext-link></comment> <object-id pub-id-type="pmid">20829788</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Hateren</surname> <given-names>J</given-names></name> (<year>1992</year>) <article-title>A Theory of Maximizing Sensory Information</article-title>. <source>Biological Cybernetics</source> <volume>68</volume>: <fpage>23</fpage>–<lpage>29</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/BF00203134" xlink:type="simple">10.1007/BF00203134</ext-link></comment> <object-id pub-id-type="pmid">1486129</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Abshire</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Andreou</surname> <given-names>A</given-names></name> (<year>2001</year>) <article-title>Capacity and Energy Cost of Information in Biological and Silicon Photoreceptors</article-title>. <source>Proceedings of the IEEE</source> <volume>89</volume>: <fpage>1052</fpage>–<lpage>1064</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/5.939817" xlink:type="simple">10.1109/5.939817</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lillywhite</surname> <given-names>P</given-names></name> (<year>1981</year>) <article-title>Multiplicative Intrinsic Noise and the Limits to Visual Performance</article-title>. <source>Vision Research</source> <volume>21</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0042-6989(81)90123-1" xlink:type="simple">10.1016/0042-6989(81)90123-1</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zheng</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Polavieja</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wolfram</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Asyali</surname> <given-names>M</given-names></name> (<year>2006</year>) <article-title>Feedback Network Controls Photoreceptor Output at the Layer of First Visual Synapses in Drosophila</article-title>. <source>J Gen Physiol</source> <volume>127</volume>: <fpage>495</fpage>–<lpage>510</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1085/jgp.200509470" xlink:type="simple">10.1085/jgp.200509470</ext-link></comment> <object-id pub-id-type="pmid">16636201</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ghanem</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mannujahan</surname> <given-names>A</given-names></name> (<year>2012</year>) <article-title>The Poisson Optical Communication Channels: Capacity and Power Allocation</article-title>. <source>IAENG International Journal of Computer Science</source> <volume>39</volume>.</mixed-citation>
</ref>
<ref id="pcbi.1005687.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Grewe</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Weckstrom</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Egelhaaf</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Warzecha</surname> <given-names>A</given-names></name> (<year>2007</year>) <article-title>Information and Discriminability as Measures of Reliability of Sensory Coding</article-title>. <source>PLoS ONE</source> <volume>12</volume>.</mixed-citation>
</ref>
<ref id="pcbi.1005687.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Guo</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Verdu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Shamai</surname> <given-names>S</given-names></name> (<year>2008</year>) <article-title>Mutual Information and Conditional Mean Estimation in Poisson Channels</article-title>. <source>IEEE Transactions on Information Theory</source> <volume>54</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TIT.2008.920206" xlink:type="simple">10.1109/TIT.2008.920206</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lee</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hong</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Kang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Amzel</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Montell</surname> <given-names>C</given-names></name> (<year>2003</year>) <article-title>Light Adaptation through Phosphoinositide-Regulated Translocation of Drosophila Visual Arrestin</article-title>. <source>Neuron</source> <volume>39</volume>: <fpage>121</fpage>–<lpage>132</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0896-6273(03)00390-8" xlink:type="simple">10.1016/S0896-6273(03)00390-8</ext-link></comment> <object-id pub-id-type="pmid">12848937</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref030">
<label>30</label>
<mixed-citation publication-type="other" xlink:type="simple">Parag K, Vinnicombe G (2013) Event Triggered Signalling Codecs for Molecular Estimation. 52nd Conference on Decision and Control: 256–61.</mixed-citation>
</ref>
<ref id="pcbi.1005687.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kim</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Putrino</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ghosh</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>E</given-names></name> (<year>2011</year>) <article-title>A Granger Causality Measure for Point Process Models of Ensemble Neural Spiking Activity</article-title>. <source>PLoS Comput Biol</source> <volume>7</volume>: <fpage>e1001110</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1001110" xlink:type="simple">10.1371/journal.pcbi.1001110</ext-link></comment> <object-id pub-id-type="pmid">21455283</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bobrowski</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Meir</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Eldar</surname> <given-names>Y</given-names></name> (<year>2008</year>) <article-title>Bayesian Filtering in Spiking Neural Networks; Noise, Adaptation and Multisensory Integration</article-title>. <source>Neural Computation</source> <volume>21</volume>: <fpage>1277</fpage>–<lpage>1320</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/neco.2008.01-08-692" xlink:type="simple">10.1162/neco.2008.01-08-692</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lewen</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>van Steveninck</surname> <given-names>R</given-names></name> (<year>2001</year>) <article-title>Neural Coding of Naturalistic Motion Stimuli</article-title>. <source>Network: Comput Neural Syst</source> <volume>12</volume>: <fpage>317</fpage>–<lpage>329</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/net.12.3.317.329" xlink:type="simple">10.1080/net.12.3.317.329</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nemenman</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Lewen</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>de Ruyter van Steveninck</surname> <given-names>R</given-names></name> (<year>2008</year>) <article-title>Neural Coding of Natural Stimuli: Information at Sub-Millisecond Resolution</article-title>. <source>PLoS Comput Biol</source> <volume>4</volume>: <fpage>e1000025</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1000025" xlink:type="simple">10.1371/journal.pcbi.1000025</ext-link></comment> <object-id pub-id-type="pmid">18369423</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Eichner</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Joesch</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Schnell</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Reiff</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Borst</surname> <given-names>A</given-names></name> (<year>2011</year>) <article-title>Internal Structure of the fly Elementary Motion Detector</article-title>. <source>Neuron</source> <volume>70</volume>: <fpage>1155</fpage>–<lpage>1164</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2011.03.028" xlink:type="simple">10.1016/j.neuron.2011.03.028</ext-link></comment> <object-id pub-id-type="pmid">21689601</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Henderson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Reuss</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>R</surname> <given-names>H</given-names></name> (<year>2000</year>) <article-title>Single Photon Responses in Drosophila Photoreceptors and their Regulation by Ca2+</article-title>. <source>Journal of Physiology</source> <volume>524</volume>: <fpage>179</fpage>–<lpage>194</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1469-7793.2000.00179.x" xlink:type="simple">10.1111/j.1469-7793.2000.00179.x</ext-link></comment> <object-id pub-id-type="pmid">10747191</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Parag</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Pybus</surname> <given-names>O</given-names></name> (<year>2017</year>) <article-title>Optimal Point Process Filtering and Estimation of the Coalescent Process</article-title>. <source>Journal of Theoretical Biology</source> <volume>421</volume>: <fpage>153</fpage>–<lpage>67</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2017.04.001" xlink:type="simple">10.1016/j.jtbi.2017.04.001</ext-link></comment> <object-id pub-id-type="pmid">28385666</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fischer</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>K</surname> <given-names>MH</given-names></name> (<year>1992</year>) <article-title>The Markov-modulated Poisson Process Cookbook</article-title>. <source>Performance Evaluation</source> <volume>18</volume>.</mixed-citation>
</ref>
<ref id="pcbi.1005687.ref039">
<label>39</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Kistler</surname> <given-names>W</given-names></name> (<year>2008</year>) <source>Spiking Neuron Models</source>. <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1005687.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Victor</surname> <given-names>J</given-names></name> (<year>2005</year>) <article-title>Spike train metrics</article-title>. <source>Current Opinion in Neurobiology</source> <volume>15</volume>: <fpage>585</fpage>–<lpage>592</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.conb.2005.08.002" xlink:type="simple">10.1016/j.conb.2005.08.002</ext-link></comment> <object-id pub-id-type="pmid">16140522</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref041">
<label>41</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Rasmussen</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>C</given-names></name> (<year>2006</year>) <source>Gaussian Processes for Machine Learning</source>. <publisher-loc>Massachusetts, USA</publisher-loc>: <publisher-name>MIT Press</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1005687.ref042">
<label>42</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Rabiner</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Gold</surname> <given-names>B</given-names></name> (<year>1975</year>) <source>Theory and Application of Digital Signal Processing</source>. <publisher-loc>Englewood Cliffs, NJ</publisher-loc>: <publisher-name>Prentice Hall Inc</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1005687.ref043">
<label>43</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Snyder</surname> <given-names>D</given-names></name> (<year>1975</year>) <source>Random Point Processes</source>. <publisher-name>John Wiley and Sons Inc</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1005687.ref044">
<label>44</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Snyder</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>M</given-names></name> (<year>1991</year>) <source>Random Point Processes in Time and Space</source>. <publisher-name>Springer-Verlag</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1005687.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Landis</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Ott</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Stoop</surname> <given-names>R</given-names></name> (<year>2011</year>) <article-title>Hebbian Self-organizing Integrate-and-fire Networks for Data Clustering</article-title>. <source>Neural Comput</source> <volume>22</volume>: <fpage>273</fpage>–<lpage>88</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/neco.2009.12-08-926" xlink:type="simple">10.1162/neco.2009.12-08-926</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rudemo</surname> <given-names>M</given-names></name> (<year>1972</year>) <article-title>Doubly-Stochastic Poisson Processes and Process Control</article-title>. <source>Advances in Applied Probability</source> <volume>2</volume>: <fpage>318</fpage>–<lpage>338</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1017/S0001867800038386" xlink:type="simple">10.1017/S0001867800038386</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref047">
<label>47</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Ma</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Beck</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Latham</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Pouget</surname> <given-names>A</given-names></name> (<year>2006</year>) <chapter-title>Bayesian Inference with Probailistic Population Codes</chapter-title>. <source>Nature Neuroscience</source>: <fpage>1432</fpage>–<lpage>1438</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005687.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Boerlin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Deneve</surname> <given-names>S</given-names></name> (<year>2011</year>) <article-title>Spike-based Population Coding and Working Memory</article-title>. <source>PLoS Computational Biology</source> <volume>7</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1001080" xlink:type="simple">10.1371/journal.pcbi.1001080</ext-link></comment> <object-id pub-id-type="pmid">21379319</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Grewe</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kretzburg</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Warzecha</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Egelhaaf</surname> <given-names>M</given-names></name> (<year>2003</year>) <article-title>Impact of Photon Noise on the Reliability of a Motion-Sensitive Neuron in the Fly’s Visual System</article-title>. <source>Journal of Neuroscience</source> <volume>23</volume>: <fpage>10776</fpage>–<lpage>10783</lpage>. <object-id pub-id-type="pmid">14645469</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Steveninck</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Laughlin</surname> <given-names>S</given-names></name> (<year>1996</year>) <article-title>Light Adaptation and Reliability in Blowfly Photoreceptors</article-title>. <source>International Journal of Neural Systems</source> <volume>7</volume>: <fpage>437</fpage>–<lpage>444</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1142/S0129065796000415" xlink:type="simple">10.1142/S0129065796000415</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref051">
<label>51</label>
<mixed-citation publication-type="other" xlink:type="simple">Parag K, Vinnicombe G (2013) Single Event Molecular Signalling for Estimation and Control. European Control Conference: 4166–4171.</mixed-citation>
</ref>
<ref id="pcbi.1005687.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Juusola</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hardie</surname> <given-names>R</given-names></name> (<year>2001</year>) <article-title>Light Adaptation in Drosophila Photoreceptors: I. Response Dynamics and Signaling Efficiency at 25C</article-title>. <source>J Gen Physiol</source> <volume>117</volume>: <fpage>3</fpage>–<lpage>25</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005687.ref053">
<label>53</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Eckert</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Zeil</surname> <given-names>J</given-names></name> (<year>2001</year>) <chapter-title>Towards an Ecology of Motion Vision</chapter-title>. <source>Motion Vision: Computational, Neural, and Ecological Constraints</source>. <publisher-name>Springer Verlag</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1005687.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gonzalez-Bellido</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wardill</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Juusola</surname> <given-names>M</given-names></name> (<year>2011</year>) <article-title>Compound Eyes and Retinal Information Processing in Miniature Dipteran Species Match their Specific Ecological Demands</article-title>. <source>Proceedings of the National Academy of Science of the USA</source> <volume>108</volume>: <fpage>4224</fpage>–<lpage>4229</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1014438108" xlink:type="simple">10.1073/pnas.1014438108</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005687.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chu</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sengupta</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gupta</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Raghu</surname> <given-names>P</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Common Mechanisms Regulating Dark Noise and Quantum Bump Amplification in Drosophila Photoreceptors</article-title>. <source>Journal of Neurophysiology</source> <volume>109</volume>: <fpage>2044</fpage>–<lpage>2055</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.00001.2013" xlink:type="simple">10.1152/jn.00001.2013</ext-link></comment> <object-id pub-id-type="pmid">23365183</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>