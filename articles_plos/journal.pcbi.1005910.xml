<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00517</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005910</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Infectious diseases</subject><subj-group><subject>Viral diseases</subject><subj-group><subject>Influenza</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Earth sciences</subject><subj-group><subject>Seasons</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Infectious diseases</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Public and occupational health</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Discrete mathematics</subject><subj-group><subject>Combinatorics</subject><subj-group><subject>Permutation</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Epidemiology</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Prediction of infectious disease epidemics via weighted density ensembles</article-title>
<alt-title alt-title-type="running-head">Prediction of infectious disease via weighted ensembles</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4035-0243</contrib-id>
<name name-style="western">
<surname>Ray</surname> <given-names>Evan L.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3503-9899</contrib-id>
<name name-style="western">
<surname>Reich</surname> <given-names>Nicholas G.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Mathematics and Statistics, Mount Holyoke College, South Hadley, Massachusetts, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Biostatistics and Epidemiology, University of Massachusetts, Amherst, Massachusetts, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Viboud</surname> <given-names>Cecile</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>National Institutes of Health, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">eray@mtholyoke.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>2</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>20</day>
<month>2</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>2</issue>
<elocation-id>e1005910</elocation-id>
<history>
<date date-type="received">
<day>31</day>
<month>3</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>29</day>
<month>11</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Ray, Reich</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005910"/>
<abstract>
<p>Accurate and reliable predictions of infectious disease dynamics can be valuable to public health organizations that plan interventions to decrease or prevent disease transmission. A great variety of models have been developed for this task, using different model structures, covariates, and targets for prediction. Experience has shown that the performance of these models varies; some tend to do better or worse in different seasons or at different points within a season. Ensemble methods combine multiple models to obtain a single prediction that leverages the strengths of each model. We considered a range of ensemble methods that each form a predictive density for a target of interest as a weighted sum of the predictive densities from component models. In the simplest case, equal weight is assigned to each component model; in the most complex case, the weights vary with the region, prediction target, week of the season when the predictions are made, a measure of component model uncertainty, and recent observations of disease incidence. We applied these methods to predict measures of influenza season timing and severity in the United States, both at the national and regional levels, using three component models. We trained the models on retrospective predictions from 14 seasons (1997/1998–2010/2011) and evaluated each model’s prospective, out-of-sample performance in the five subsequent influenza seasons. In this test phase, the ensemble methods showed average performance that was similar to the best of the component models, but offered more consistent performance across seasons than the component models. Ensemble methods offer the potential to deliver more reliable predictions to public health decision makers.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Public health agencies such as the US Centers for Disease Control and Prevention would like to have as much information as possible when planning interventions intended to reduce and prevent the spread of infectious disease. For instance, accurate and reliable predictions of the timing and severity of the influenza season could help with planning how many influenza vaccine doses to produce and by what date they will be needed. Many different mathematical and statistical models have been proposed to model influenza and other infectious diseases, and these models have different strengths and weaknesses. In particular, one or another of these model specifications is often better than the others in different seasons, at different times within the season, and for different prediction targets (such as different measures of the timing or severity of the influenza season). In this article, we explore ensemble methods that combine predictions from multiple “component” models. We find that these ensemble methods do about as well as the best of the component models in terms of aggregate performance across multiple seasons, but that the ensemble methods have more consistent performance across different seasons. This improved consistency is valuable for planners who need predictions that can be trusted under all circumstances.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>National Institute of General Medical Sciences (US)</institution>
</funding-source>
<award-id>R35GM119582</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3503-9899</contrib-id>
<name name-style="western">
<surname>Reich</surname> <given-names>Nicholas G.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>Defense Advanced Research Projects Agency (US)</institution>
</funding-source>
<award-id>Dl6AP00144</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3503-9899</contrib-id>
<name name-style="western">
<surname>Reich</surname> <given-names>Nicholas G.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by National Institute Of General Medical Sciences Award Number R35GM119582, NGR, <ext-link ext-link-type="uri" xlink:href="https://www.nigms.nih.gov/Pages/default.aspx" xlink:type="simple">https://www.nigms.nih.gov/Pages/default.aspx</ext-link>, and Defense Advanced Projects Research Agency Young Faculty Award Number Dl6AP00144, NGR, <ext-link ext-link-type="uri" xlink:href="http://www.darpa.mil/" xlink:type="simple">http://www.darpa.mil/</ext-link>. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institute Of General Medical Sciences, the National Institutes of Health, or the Defense Advanced Projects Research Agency. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="1"/>
<page-count count="23"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-03-02</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Data are available from the CDC FluView repository (<ext-link ext-link-type="uri" xlink:href="https://www.cdc.gov/flu/weekly/overview.htm" xlink:type="simple">https://www.cdc.gov/flu/weekly/overview.htm</ext-link>); the data used in this study have also been archived in a GitHub repository at <ext-link ext-link-type="uri" xlink:href="https://github.com/reichlab/adaptively-weighted-ensemble" xlink:type="simple">https://github.com/reichlab/adaptively-weighted-ensemble</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The practice of combining predictions from different models has been used for decades by climatologists and geophysical scientists. These methods have subsequently been adapted and extended by statisticians and computer scientists in diverse areas of scientific inquiry. In recent years, these “ensemble” forecasting approaches frequently have been among the top methods used in prediction challenges across a wide range of applications.</p>
<p>Ensembles are a natural choice for noisy, complex, and interdependent systems that evolve over time. In these settings, no one model is likely to be able to capture and predict the full set of complex relationships that drive future observations from a particular system of interest. Instead “specialist” or “component” models can be relied on to capture distinct features or signals from a system and, when combined, represent a nearly complete range of possible outcomes. In this work, we develop and compare a collection of ensemble methods for combining predictive densities. This enables us to quantify the improvement in predictions achieved by using ensemble methods with varying levels of complexity.</p>
<p>To illustrate these ensemble methods, we present time-series forecasts for infectious disease, specifically for influenza in the United States. The international significance of emerging epidemic threats in recent decades has highlighted the importance of understanding and being able to predict infectious disease dynamics. With the revolution in science driven by the promise of “big” and real-time data, there is an increased focus on and hope for using statistics to inform public health policy and decision-making in ways that could mitigate the impact of future outbreaks. Some of the largest public health agencies in the world, including the US Centers for Disease Control and Prevention (CDC) have openly endorsed using models to inform decision making, saying “with models, decision-makers can look to the future with confidence in their ability to respond to outbreaks and public health emergencies” [<xref ref-type="bibr" rid="pcbi.1005910.ref001">1</xref>].</p>
<p>There is a large literature on prediction methods for influenza. We will give a brief overview of this literature here, and refer the reader to Chretien <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005910.ref002">2</xref>] and Nsoesie <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005910.ref003">3</xref>] for more comprehensive reviews; additionally, [<xref ref-type="bibr" rid="pcbi.1005910.ref004">4</xref>] present the results of a recent influenza prediction challenge run by the CDC where many of these models were employed. Infectious disease prediction methods can be broadly grouped into three categories: agent-based models, compartmental models [<xref ref-type="bibr" rid="pcbi.1005910.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1005910.ref010">10</xref>], and regression-based time series models that may include auto-regressive and seasonal terms [<xref ref-type="bibr" rid="pcbi.1005910.ref011">11</xref>]. Additionally, these models may use a variety of different data sources and covariates to inform their predictions, including historical values of the disease incidence time series [<xref ref-type="bibr" rid="pcbi.1005910.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1005910.ref011">11</xref>]; data derived from internet sources such as web searches, wikipedia page views, and twitter [<xref ref-type="bibr" rid="pcbi.1005910.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005910.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005910.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005910.ref011">11</xref>–<xref ref-type="bibr" rid="pcbi.1005910.ref014">14</xref>]; and climatological variables [<xref ref-type="bibr" rid="pcbi.1005910.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005910.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005910.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005910.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1005910.ref011">11</xref>], among others. These models may generate either point predictions, possibly along with associated predictive intervals, or full predictive distributions.</p>
<p>The ensemble methods that we explore in the present work are designed to combine predictions from multiple models, which could use a variety of different model structures and covariates to generate predictions. Development of the methods presented in this manuscript was motivated by the observation that certain prediction models for infectious disease consistently performed better than other models at certain times of year. We observed in previous research that early in the influenza season, simple models of historical incidence often outperformed more standard time-series prediction models such as a seasonal auto-regressive integrated moving average (SARIMA) model [<xref ref-type="bibr" rid="pcbi.1005910.ref015">15</xref>]. However, in the middle of the season, the time-series models showed improved accuracy. We set out to determine whether ensemble methods could use this information about past model performance to improve predictions.</p>
<p>A large number of ensemble methods have been developed for a diverse array of tasks including regression, classification, and density estimation. These methods are broadly similar in that they combine results from multiple component models. However, details differ between ensemble methods. We suggest Polikar [<xref ref-type="bibr" rid="pcbi.1005910.ref016">16</xref>] for a review of ensemble methods; many of these are also discussed in detail in Hastie <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005910.ref017">17</xref>].</p>
<p>While there are many different methods for combining models, all ensemble models discussed in this paper use an approach called stacking [<xref ref-type="bibr" rid="pcbi.1005910.ref018">18</xref>]. In this approach, each of the component models is trained separately in a first stage, and cross-validated measures of performance of those component models are obtained. Then, in a second stage, a stacking model is trained using the cross-validated performance measures to learn how to optimally combine predictive densities from the component models. The specific implementations of stacking that we use obtain the final predictive density as a weighted sum of the component predictive densities, where the weights may depend on covariates. We refer to this approach generally as a “weighted density ensemble” approach to prediction. Several variations on this strategy have been explored in the literature previously [<xref ref-type="bibr" rid="pcbi.1005910.ref019">19</xref>–<xref ref-type="bibr" rid="pcbi.1005910.ref021">21</xref>]. However, other ensemble methods for density estimation have also been developed. For example, Rosset and Segal [<xref ref-type="bibr" rid="pcbi.1005910.ref022">22</xref>] develop a boosting method in which the component models are estimated sequentially, with results from earlier models affecting estimation of later models.</p>
<p>In structured prediction settings such as time series forecasting, ensemble methods may benefit from taking advantage of the data structure. For example, it may be the case that different models offer a better representation of the data at different points in time. A common idea in these settings is to use model weights that change over time. For instance, model weights may vary as a function of how well each model did in recent predictions [<xref ref-type="bibr" rid="pcbi.1005910.ref023">23</xref>] or by using a more formal graphical structure such as a hidden Markov model to track which component model is most likely to have generated new observations as they arise over time [<xref ref-type="bibr" rid="pcbi.1005910.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1005910.ref025">25</xref>]. It is also possible to combine the component models with weights that depend on observed covariates or features [<xref ref-type="bibr" rid="pcbi.1005910.ref026">26</xref>]. For example, in an ensemble for a user recommendation system, Jahrer <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005910.ref027">27</xref>] allowed model weights to depend on a variety of features including the time that a user submitted a rating.</p>
<p>Using component models that generate predictive densities for outcomes of interest, we have implemented a series of ensembles using different methods for choosing the weights for each model. Specifically, we compare three different approaches. The first approach simply takes an equally weighted average of all models. The second approach estimates constant but not necessarily equal weights for each model. The third approach is a novel method for determining model weights based on features of the system at the time predictions are made. The overarching goal of this study is to create a systematic comparison between ensemble methods to study the benefits of increasing complexity in ensemble weighting schemes.</p>
<p>We are aware of two previous articles that developed ensemble methods for infectious disease prediction. Yamana <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005910.ref028">28</xref>] and Chakraborty <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005910.ref011">11</xref>] both developed model stacking frameworks that are similar to the second approach outlined above using a constant weight for each component model. The present article is differentiated from this previous work in that we explore and compare a range of more flexible ensemble methods where the weights depend on observed features.</p>
<p>This paper presents a novel ensemble method that determines optimal model combinations based on (a) observed data at the time predictions are made and (b) aspects of the predictive distributions obtained from the component models. We refer to models built using this approach as “feature-weighted” ensembles. This approach fuses aspects of different ensemble methods: it uses model stacking [<xref ref-type="bibr" rid="pcbi.1005910.ref018">18</xref>] and estimates model weights based on features of the system [<xref ref-type="bibr" rid="pcbi.1005910.ref026">26</xref>] using gradient tree boosting [<xref ref-type="bibr" rid="pcbi.1005910.ref029">29</xref>].</p>
<p>Using seasonal influenza outbreaks in the US health regions as a case-study, we developed and applied our ensemble models to predict several attributes of the influenza season at each week during the season. By illustrating the utility of these approaches to ensemble forecasting in a setting with complex population dynamics, this work highlights the importance of continued innovation in ensemble methodology.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<p>This paper presents a comparison of methods for determining weights for weighted density ensembles, applied to forecasting specific features of influenza seasons in the US. First, we present a description of the influenza data we use in our application and the prediction targets. Next, we discuss the three component models utilized by the ensemble framework. We then turn to the ensemble framework itself, describing the different ensemble model specifications used.</p>
<sec id="sec003">
<title>Data and prediction targets</title>
<p>We obtained publicly available data on seasonal influenza activity in the United States between 1997 and 2016 from the US Centers for Disease Control and Prevention (CDC) (<xref ref-type="fig" rid="pcbi.1005910.g001">Fig 1</xref>). For each of the 10 Health and Human Services regions in the country in addition to the nation as a whole, the CDC calculates and publishes each week a measure called the weighted influenza-like illness (wILI) index. The wILI for a particular region is calculated as the average proportion of doctor visits with influenza-like illness for each state in the region, weighted by state population. During the CDC-defined influenza season (between Morbidity and Mortality Weekly Report week 40 of one year and 20 of the next year), the CDC publishes updated influenza data on a weekly basis. This includes “current” wILI data from two weeks prior to the reporting date, as well as updates to previously reported numbers as new data becomes available. For this analysis, we use only the final reported wILI measures to train and predict from our models. In the early seasons, data were not recorded during the off-season. Additionally, there were 52 observations in which the reported wILI was zero; these generally occurred near the off-season in early years, and occurred in weeks when only small numbers of health care providers submitted reports to the CDC. We treated these reported zeros as missing data throughout the analysis.</p>
<fig id="pcbi.1005910.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005910.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Plot of influenza data.</title>
<p>The full data include observations aggregated to the national level and for ten smaller regions. Here we plot only the data at the national level and in two of the smaller regions; data for the other regions are qualitatively similar. Missing data are indicated with vertical blue bars. The vertical red dashed lines indicate the cutoff time between the training and testing phases; five seasons of data were held out for testing.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.g001" xlink:type="simple"/>
</fig>
<p>The CDC defines the influenza season onset as the first of three consecutive weeks of the season for which wILI is greater than or equal to a threshold that is specific to the region and season. This threshold is the mean percent of patient visits where the patient had ILI during low incidence weeks for that region in the past three seasons, plus two standard deviations [<xref ref-type="bibr" rid="pcbi.1005910.ref030">30</xref>]. The CDC provides historical threshold values for each region going back to the 2007/2008 season [<xref ref-type="bibr" rid="pcbi.1005910.ref031">31</xref>]. Additionally, we define two other metrics specific to a region-season. The peak incidence is the maximum observed wILI measured in a season. The peak week is the week at which the maximum wILI for the season is observed.</p>
<p>Each predictive distribution was represented by probabilities assigned to bins associated with different possible outcomes. For onset week, the bins are represented by integer values for each possible season week plus a bin for “no onset”. For peak week, the bins are represented by integer values for each possible season week. For peak incidence, the bins capture incidence rounded to a single decimal place, with a single bin to capture all incidence over 12.95. Formally, the incidence bins are as follows: [0, 0.05), [0.05, 0.15), …, [12.85, 12.95), [12.95, 100]. These bins were used in the 2016-2017 influenza prediction contest run by the CDC [<xref ref-type="bibr" rid="pcbi.1005910.ref032">32</xref>].</p>
<p>We measure the accuracy of predictive distributions using the log score. The log score is a proper scoring rule [<xref ref-type="bibr" rid="pcbi.1005910.ref033">33</xref>], calculated in our setting as the natural log of the probability assigned to the bin containing the true observation. Proper scoring rules are preferred for measuring the quality of predictive distributions because the expected score is optimized by the true probabilty distribution. We note that for peak week, in some region-seasons the same peak incidence was achieved in multiple weeks (after rounding to one decimal place). In those cases, we calculated the log score as the log of the sum of the probabilities assigned to those weeks; this is consistent with scoring procedures used in the 2016-2017 flu prediction contest run by the CDC [<xref ref-type="bibr" rid="pcbi.1005910.ref032">32</xref>]. However, the log score is not directly comparable with the score used by the CDC in the prediction contest. The CDC calculates the score of a prediction as the log of the combined probability assigned to several bins surrounding the realized outcome; this has some benefits, but has the disadvantage that it is not a proper score. We have opted to use the log score in this work because it is a proper score.</p>
</sec>
<sec id="sec004">
<title>Component models</title>
<p>We used three component models to generate probabilistic predictions of the three prediction targets. The first model was a seasonal average model that utilized kernel density estimation (KDE) to estimate a predictive distribution for each target. The second model utilized kernel conditional density estimation (KCDE) and copulas to create a joint predictive distribution for incidence in all remaining weeks of the season, conditional on recent observations of incidence [<xref ref-type="bibr" rid="pcbi.1005910.ref015">15</xref>]. By calculating appropriate integrals of this joint distribution, we constructed predictive distributions for each of the seasonal targets. The third model used a standard seasonal auto-regressive integrated moving average (SARIMA) implementation. All models were fit independently on data within each region.</p>
<sec id="sec005">
<title>Kernel density estimation (KDE)</title>
<p>The simplest of the component models uses kernel density estimation [<xref ref-type="bibr" rid="pcbi.1005910.ref034">34</xref>] to estimate a distribution for each target based on observed values of that target in previous seasons within the region of interest. We used Gaussian kernels and the default settings from the <monospace>density</monospace> function in the <monospace>stats</monospace> package for R [<xref ref-type="bibr" rid="pcbi.1005910.ref035">35</xref>] to estimate the bandwidth parameter. For the peak incidence target, we fit to log-transformed observations of historical peak incidence. For the onset week prediction target, we estimated the probability of no onset as the proportion of region-seasons in all regions in the training phase where no week in the season met the criteria for being a season onset.</p>
<p>To create an empirical predictive distribution of size <italic>N</italic> from a KDE fit based on a data vector <bold>y</bold><sub>1:<italic>K</italic></sub> (for example, this might be the vector of peak week values from the <italic>K</italic> training seasons), we first drew <italic>N</italic> samples with replacement from <bold>y</bold><sub>1:<italic>K</italic></sub>, yielding a new vector <inline-formula id="pcbi.1005910.e001"><alternatives><graphic id="pcbi.1005910.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005910.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:msub><mml:mover><mml:mstyle mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>:</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. We then drew a single psuedo-random deviate from each of <italic>N</italic> truncated Gaussian distributions centered at <inline-formula id="pcbi.1005910.e002"><alternatives><graphic id="pcbi.1005910.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005910.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msub><mml:mover><mml:mstyle mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>:</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> with the bandwidth estimated by the KDE algorithm. The Gaussians we sampled from were truncated at the lower and upper bounds of possible values for the given prediction target. Finally, we discretized the sampled values to the target-specific bins. These sampled points then make up the empirical predictive distribution from a KDE model. We set the sample size to <italic>N</italic> = 10<sup>5</sup>. In theory, this model assigns non-zero probability to every possible outcome; however, in a few cases the empirical predictive distribution resulting from this Monte Carlo sampling approach assigned probability zero to some of the bins.</p>
<p>It is important to note that the predictions from this model do not change as new data are observed over the course of the season.</p>
</sec>
<sec id="sec006">
<title>Kernel conditional density estimation (KCDE)</title>
<p>We used kernel conditional density estimation and copulas to estimate a joint predictive distribution for flu incidence in each future week of the season, and then calculated predictive distributions for each target from that joint distribution [<xref ref-type="bibr" rid="pcbi.1005910.ref015">15</xref>]. In our implementation, we first used KCDE to obtain separate predictive densities for flu incidence in each future week of the season. Each of these predictive densities gives a conditional distribution for incidence at one future time point given recent observations of incidence and the current week of the season. KCDE can be viewed as a distribution-based analogue of nearest-neighbors regression. We then used a copula to model dependence among those individual predicitive densities, thereby obtaining a joint predicitive density, or a distribution of incidence trajectories in all future weeks.</p>
<p>To predict seasonal quantities (onset, peak timing, and peak incidence), we simulate <italic>N</italic> = 10<sup>5</sup> trajectories of disease incidence from this joint predictive distribution. For each simulated incidence trajectory, we compute the onset week, peak week, and peak incidence. We then aggregate these values to create predictive distributions for each target. This procedure for obtaining predictive distributions for the targets of interest can be formally justified as an appropriate Monte Carlo integral of the joint predictive distribution for disease incidence in future weeks (see [<xref ref-type="bibr" rid="pcbi.1005910.ref015">15</xref>] for details).</p>
</sec>
<sec id="sec007">
<title>Seasonal auto-regressive integrated moving average (SARIMA)</title>
<p>We fit seasonal ARIMA models [<xref ref-type="bibr" rid="pcbi.1005910.ref036">36</xref>] to wILI observations transformed to be on the natural log scale. We manually performed first-order seasonal differencing and used the stepwise procedure from the <monospace>auto.arima</monospace> function in the <monospace>forecast</monospace> package [<xref ref-type="bibr" rid="pcbi.1005910.ref037">37</xref>] for R to select the specification of the auto-regressive and moving average terms.</p>
<p>Similar to KCDE, forecasts were obtained by sampling <italic>N</italic> = 10<sup>5</sup> trajectories of wILI values over the rest of the season (using the <monospace>simulate.Arima</monospace> function from the <monospace>forecast</monospace> package), and predictive distributions of the targets were computed from these sampled trajectories as described above.</p>
</sec>
<sec id="sec008">
<title>Component model training</title>
<p>We used data from 14 seasons (1997/1998 through 2010/2011) to train the models. Data from five seasons (2011/2012 through 2015/2016) were held out when fitting the models and used exclusively in the testing phase. To avoid overfitting our models, we made predictions for the test phase only once [<xref ref-type="bibr" rid="pcbi.1005910.ref017">17</xref>].</p>
<p>Estimation of the ensemble models (discussed in the next subsection) requires cross-validated measures of performance of each of the component models in order to accurately gauge their relative performance. For each region, we estimated the parameters of each component model 15 times: 14 fits were obtained excluding one training season at a time, and another fit used all of the training data. For each fit obtained leaving one season out, we generated a set of three predictive distributions (one for each of the prediction targets) at each week in the held-out season. We were not able to generate predictions from the SARIMA and KCDE models for some seasons in the training phase because those models used lagged observations from previous seasons that were missing in our data set. The component model fits based on all of the training data were used to generate predictions for the test phase.</p>
</sec>
</sec>
<sec id="sec009">
<title>Ensemble models</title>
<p>All of the ensemble models we consider in this article work by averaging predictions from the component models to obtain the ensemble prediction. Additionally, these methods are stacked model ensembles because they use leave-one-season-out predictions from the independently estimated component models as inputs to estimate the model weights [<xref ref-type="bibr" rid="pcbi.1005910.ref018">18</xref>]. We begin our discussion of ensemble methods with a general overview, introducing a common set of notation and giving a broad outline of the ensemble models we will use in this article. We then describe our proposed weighted density ensemble model specifications in more detail.</p>
<sec id="sec010">
<title>Overview of ensemble models</title>
<p>A single set of notation can be used to describe all of the ensemble frameworks implemented here. Let <inline-formula id="pcbi.1005910.e003"><alternatives><graphic id="pcbi.1005910.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005910.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo form="prefix" stretchy="false">|</mml:mo> <mml:msubsup><mml:mstyle mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle> <mml:mi>t</mml:mi> <mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:mi>m</mml:mi> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> denote the predictive density from component model <italic>m</italic> for the value of the scalar random variable <italic>Y</italic><sub><italic>t</italic></sub> conditional on observed variables <inline-formula id="pcbi.1005910.e004"><alternatives><graphic id="pcbi.1005910.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005910.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msubsup><mml:mstyle mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle> <mml:mi>t</mml:mi> <mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:mi>m</mml:mi> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. Observations of disease incidence are reported weekly in our data set, so <italic>t</italic> indexes the week of the season. The variable <italic>Y</italic><sub><italic>t</italic></sub> could for example represent the peak incidence for a given season and region; in our application to predicting seasonal quantities, the same outcome <italic>y</italic><sub><italic>t</italic></sub> will be realized for all weeks within a given season. In the context of time series predictions, the covariate vector <inline-formula id="pcbi.1005910.e005"><alternatives><graphic id="pcbi.1005910.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005910.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:msubsup><mml:mstyle mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle> <mml:mi>t</mml:mi> <mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:mi>m</mml:mi> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> may include time-varying covariates such as the week at which the prediction is made or lagged incidence. The superscript <sup>(<italic>m</italic>)</sup> reflects the fact that each component model may use a different set of covariates.</p>
<p>The combined predictive density <italic>f</italic>(<italic>y</italic><sub><italic>t</italic></sub>|<bold>x</bold><sub><italic>t</italic></sub>) for a particular target can be written as
<disp-formula id="pcbi.1005910.e006"><alternatives><graphic id="pcbi.1005910.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005910.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msub><mml:mi>π</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>f</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula></p>
<p>In <xref ref-type="disp-formula" rid="pcbi.1005910.e006">Eq (1)</xref> the <italic>π</italic><sub><italic>m</italic></sub> are the model weights, which are allowed to vary as a function of observed features in <bold>x</bold><sub><italic>t</italic></sub>. We define <bold>x</bold><sub><italic>t</italic></sub> to be a vector of all observed quantities that are used by any of the component models or in calculating the model weights. In order to guarantee that <italic>f</italic>(<italic>y</italic><sub><italic>t</italic></sub>|<bold>x</bold><sub><italic>t</italic></sub>) is a probability distribution we require that <inline-formula id="pcbi.1005910.e007"><alternatives><graphic id="pcbi.1005910.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005910.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:msub><mml:mi>π</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:msub><mml:mstyle mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle> <mml:mi>t</mml:mi></mml:msub> <mml:mo form="postfix" stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> for all <bold>x</bold><sub><italic>t</italic></sub>. <xref ref-type="fig" rid="pcbi.1005910.g002">Fig 2</xref> illustrates the concept of stacking the predictive densities for each component model.</p>
<fig id="pcbi.1005910.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005910.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Conceptual diagram of how the stacking models operate on probabilistic predictive distributions.</title>
<p>The distributions illustrated here have density bins of 1 wILI unit, which differs from those used in the manuscript for illustrative purposes only. Panel A shows the predictive distributions from three component models. Panel B shows scaled versions of the distributions from A, after being multiplied by model weights. In Panel C, the scaled distributions are literally stacked to create the final ensemble predictive distribution.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.g002" xlink:type="simple"/>
</fig>
<p>In the following subsection, we propose a framework for estimating <italic>feature-dependent weights</italic> for a stacked ensemble model. By <italic>feature-dependent</italic> we mean that the weights associated with different component models are driven by observed features or covariates. Although we illustrate the method in the context of time-series predictions, the method could be used in any setting where we wish to combine distribution estimates from multiple models. Features could include observed data from the system being predicted (such as recent wILI measurements or the time of year at which predictions are being made), observed data from outside the system (for example, recent weather observations), or features of the predictions themselves (e.g. summaries of the predictive distributions from the component models, such as a measure of spread in the distribution, or the time until a predicted peak). Based on exploration of training phase data and <italic>a priori</italic> knowledge of the disease system, we chose three features of the system to illustrate the proposed “feature-weighting” methodology: week of season, component model uncertainty (defined as the minimum number of predictive distribution bins required to cover 90% probability), and wILI measurement at the time of prediction. These features were chosen prior to and not changed after implementing test-phase predictions.</p>
<p>We used four distinct methodologies to define weights to use for the stacking models:</p>
<list list-type="order">
<list-item>
<p>Equal Weights (<bold>EW</bold>): <italic>π</italic><sub><italic>m</italic></sub>(<bold>x</bold><sub><italic>t</italic></sub>) = 1/<italic>M</italic>. In this scenario, each model contributes the same weight for each target and for all values of <bold>x</bold><sub><italic>t</italic></sub>.</p>
</list-item>
<list-item>
<p>Constant model weights via degenerate EM (<bold>CW</bold>): <italic>π</italic><sub><italic>m</italic></sub>(<bold>x</bold><sub><italic>t</italic></sub>) = <italic>c</italic><sub><italic>m</italic></sub>, a constant where <inline-formula id="pcbi.1005910.e008"><alternatives><graphic id="pcbi.1005910.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005910.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:msub><mml:mi>c</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> but the constants are not necessarily the same for each model. These weights are estimated using the degenerate estimation-maximization algorithm [<xref ref-type="bibr" rid="pcbi.1005910.ref038">38</xref>]. A separate set of weights is estimated for each region and prediction target.</p>
</list-item>
<list-item>
<p>Feature-weighted (<bold>FW-wu</bold>): <italic>π</italic><sub><italic>m</italic></sub>(<bold>x</bold><sub><italic>t</italic></sub>) depends on features including week of the season and model uncertainty for the KCDE and SARIMA models. A separate set of weighting functions is estimated for each region and prediction target.</p>
</list-item>
<list-item>
<p>Feature-weighted with regularization: <italic>π</italic><sub><italic>m</italic></sub>(<bold>x</bold><sub><italic>t</italic></sub>) depends on features, but with regularization discouraging the weights from taking extreme values or from varying too quickly as a function of <bold>x</bold><sub><italic>t</italic></sub>. A separate set of weighting functions is estimated for each region and prediction target. We fit three variations on this ensemble model, using different sets of features:</p>
<list list-type="alpha-lower">
<list-item>
<p>(<bold>FW-reg-w</bold>) week of the season;</p>
</list-item>
<list-item>
<p>(<bold>FW-reg-wu</bold>) week of the season and model uncertainty for the KCDE and SARIMA models;</p>
</list-item>
<list-item>
<p>(<bold>FW-reg-wui</bold>) week of the season, model uncertainty for the KCDE and SARIMA models, and incidence (wILI) in the most recent week.</p>
</list-item>
</list>
</list-item>
</list>
<p>All in all, this leads to 6 ensemble models, summarized in <xref ref-type="table" rid="pcbi.1005910.t001">Table 1</xref>. The first three of these models (<bold>EW</bold>, <bold>CW</bold>, and <bold>FW-wu</bold>) can be viewed as variations on <bold>FW-reg-wu</bold> if we vary the amount and type of regularization imposed on the <bold>FW-reg-wu</bold> model. Thus, comparisons among these four models will enable us to explore the benefits of allowing the model weights to depend on covariates while imposing an appropriate amount of rigidity on the model weight functions <italic>π</italic><sub><italic>m</italic></sub>(<bold>x</bold><sub><italic>t</italic></sub>). We will discuss the regularization strategies used in <bold>FW-reg-wu</bold> further in the next subsection. Meanwhile, comparisons among the <bold>FW-reg-w</bold>, <bold>FW-reg-wu</bold>, and <bold>FW-reg-wui</bold> models will allow us to explore the relative contributions to predictive performance that can be achieved by allowing the model weights to depend on different features.</p>
<table-wrap id="pcbi.1005910.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005910.t001</object-id>
<label>Table 1</label>
<caption>
<title>Summary of ensemble methods and what the model weights depend on.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005910.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="right" rowspan="2">Model</th>
<th align="center" colspan="6">Component Model Weights Vary with…</th>
</tr>
<tr>
<th align="center">Region</th>
<th align="center">Prediction Target</th>
<th align="center">Week of Season</th>
<th align="center">SARIMA Uncertainty</th>
<th align="center">KCDE Uncertainty</th>
<th align="center">Current wILI</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">EW</td>
<td align="center"/>
<td align="center"/>
<td align="center"/>
<td align="center"/>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="right">CW</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"/>
<td align="center"/>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="right">FW</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"/>
</tr>
<tr>
<td align="right">FW-reg-w</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"/>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="right">FW-reg-wu</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"/>
</tr>
<tr>
<td align="right">FW-reg-wui</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>As discussed above, leave-one-season-out prediction results from the three component models are inputs to the ensemble estimation routines. During ensemble estimation, we dropped any training set time points for which cross-validated predictions from all three component models were not available. After the training phase, each of the six ensemble models, along with the three component models, are used to generate predictions in every season-week of each of the five testing seasons, assuming perfect reporting. These predictions are then used to evaluate the prospective predictive performance of each of the ensemble methods. In total, we evaluate 9 models in 11 regions over 5 years and 3 targets of interest.</p>
</sec>
</sec>
<sec id="sec011">
<title>Feature-weighted stacking framework</title>
<p>In this section we introduce the particular specification of the parameter weight functions <italic>π</italic><sub><italic>m</italic></sub>(<bold>x</bold><sub><italic>t</italic></sub>) that we use for the <bold>FW-wu</bold>, <bold>FW-reg-w</bold>, <bold>FW-reg-wu</bold>, and <bold>FW-reg-wui</bold> models and discuss estimation.</p>
<p>In order to ensure that the the <italic>π</italic><sub><italic>m</italic></sub> are non-negative and sum to 1 for all values of <bold>x</bold><sub><italic>t</italic></sub>, we parameterize them in terms of the softmax transformation of real-valued latent functions <italic>ρ</italic><sub><italic>m</italic></sub>:
<disp-formula id="pcbi.1005910.e009"><alternatives><graphic id="pcbi.1005910.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005910.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>π</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo form="prefix">exp</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mi>ρ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>m</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>ρ</mml:mi> <mml:msup><mml:mi>m</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula></p>
<p>For a pair of models <italic>l</italic>, <italic>m</italic> ∈ {1, …, <italic>M</italic>}, <italic>ρ</italic><sub><italic>l</italic></sub>(<bold>x</bold><sub><italic>t</italic></sub>) &gt; <italic>ρ</italic><sub><italic>m</italic></sub>(<bold>x</bold><sub><italic>t</italic></sub>) indicates that model <italic>l</italic> has more weight than model <italic>m</italic> for predictions at the given value of <bold>x</bold><sub><italic>t</italic></sub>. The functions <italic>ρ</italic><sub><italic>m</italic></sub>(<bold>x</bold><sub><italic>t</italic></sub>) could be parameterized and estimated using many different techniques, such as a linear specification in the features, splines, or so on. We chose to estimate the functions <italic>ρ</italic><sub><italic>m</italic></sub>(<bold>x</bold>) using gradient tree boosting.</p>
<p>Gradient tree boosting uses a forward stagewise additive modeling algorithm to iteratively and incrementally construct a series of regression trees that, when added together, create a function designed to minimize a given loss function. In our application, the algorithm builds up the <italic>ρ</italic><sub><italic>m</italic></sub>(<bold>x</bold><sub><italic>t</italic></sub>) that minimize the negative log-score of the stacked predictions <italic>f</italic>(<italic>y</italic><sub><italic>t</italic></sub>|<bold>x</bold><sub><italic>t</italic></sub>) across all times <italic>t</italic>:
<disp-formula id="pcbi.1005910.e010"><alternatives><graphic id="pcbi.1005910.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005910.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>{</mml:mo><mml:mi mathvariant="bold-italic">ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>t</mml:mi></mml:munder> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>t</mml:mi></mml:munder> <mml:mo form="prefix">log</mml:mo> <mml:mo>[</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:mfrac><mml:mrow><mml:mo form="prefix">exp</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mi>ρ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>m</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:msubsup> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>ρ</mml:mi> <mml:msup><mml:mi>m</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:msub><mml:mi>f</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where <inline-formula id="pcbi.1005910.e011"><alternatives><graphic id="pcbi.1005910.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005910.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo form="prefix" stretchy="false">|</mml:mo> <mml:msubsup><mml:mstyle mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle> <mml:mi>t</mml:mi> <mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo> <mml:mi>m</mml:mi> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the cross-validated predictive density from the <italic>m</italic>th model evaluated at the realized outcome <italic>y</italic><sub><italic>t</italic></sub>.</p>
<p>Specifically, we define a single tree as
<disp-formula id="pcbi.1005910.e012"><alternatives><graphic id="pcbi.1005910.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005910.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>T</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>J</mml:mi></mml:munderover> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mi>j</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">ψ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
where the <italic>R<sub>j</sub></italic>(<bold><italic>ψ</italic></bold>) are a set of disjoint regions that comprise a partition of the space <inline-formula id="pcbi.1005910.e013"><alternatives><graphic id="pcbi.1005910.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005910.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mi mathvariant="script">X</mml:mi></mml:math></alternatives></inline-formula> of feature values <bold>x</bold><sub><italic>t</italic></sub>, and <italic>I</italic> is the indicator function taking the value 1 if <bold>x</bold><sub><italic>t</italic></sub> ∈ <italic>R<sub>j</sub></italic>(<bold><italic>ψ</italic></bold>) and 0 otherwise. The parameters <bold><italic>θ</italic></bold> = (<bold><italic>ψ</italic></bold>, <bold><italic>γ</italic></bold>) for the tree are the split points <bold><italic>ψ</italic></bold> partitioning <inline-formula id="pcbi.1005910.e014"><alternatives><graphic id="pcbi.1005910.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005910.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mi mathvariant="script">X</mml:mi></mml:math></alternatives></inline-formula> into the regions <italic>R<sub>j</sub></italic>(<bold><italic>ψ</italic></bold>) and the regression constants <bold><italic>γ</italic></bold> associated with each region. The function <italic>ρ</italic><sub><italic>m</italic></sub>(<bold>x</bold><sub><italic>t</italic></sub>) is obtained as the sum of <italic>B</italic> trees:
<disp-formula id="pcbi.1005910.e015"><alternatives><graphic id="pcbi.1005910.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005910.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:msub><mml:mo>Θ</mml:mo> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>B</mml:mi></mml:munderover> <mml:mi>T</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>;</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula></p>
<p>In each iteration <italic>b</italic> of the boosting process, we estimate <italic>M</italic> new regression trees, one for each component model. These trees are estimated so as to minimize a local approximation to the loss function around the weight functions that were obtained after the previous boosting iteration. Our approach builds on the <monospace>xgb.train</monospace> function in the <monospace>xgboost</monospace> package for <monospace>R</monospace> to perform this estimation [<xref ref-type="bibr" rid="pcbi.1005910.ref039">39</xref>]. The functionality in that package assumes that the loss function is convex, and optimizes a quadratic approximation to the loss in each boosting iteration. The loss function in <xref ref-type="disp-formula" rid="pcbi.1005910.e010">Eq (3)</xref> is not guaranteed to be convex, so a direct application of this optimization method fails in our setting. We have modified the implementation in the <monospace>xgboost</monospace> package to use a gradient descent step in cases where the loss is locally nonconvex (concave or indeterminate).</p>
<p>Gradient tree boosting is appealing as a method for estimating the functions <italic>ρ</italic><sub><italic>m</italic></sub> because it offers a great deal of flexibility in how the weights can vary as a function of the features <bold>x</bold><sub><italic>t</italic></sub>. On the other hand, this flexibility can lead to overfitting the training data. In order to limit the chances of overfitting, we have explored the use of three regularization parameters:</p>
<list list-type="order">
<list-item>
<p>The number of boosting iterations <italic>B</italic>. As <italic>B</italic> increases, more extreme weights (close to 0 or 1) and more rapid changes in the weights as <bold>x</bold> varies are possible.</p>
</list-item>
<list-item>
<p>An <italic>L</italic><sub>1</sub> penalty on the number of tree leaves, <italic>J</italic>. A large penalty encourages the regression trees to have fewer leaves, so that there is less flexibility for the model weights to vary as a function of <bold>x</bold><sub><italic>t</italic></sub>.</p>
</list-item>
<list-item>
<p>An <italic>L</italic><sub>1</sub> penalty on the regression constants <italic>γ</italic><sub><italic>j</italic></sub>. A large penalty encourages these constants to be small, so that the overall model weights change less in each boosting iteration.</p>
</list-item>
</list>
<p>We selected values for these regularization parameters using a grid search optimizing leave-one-season-out cross-validated model performance.</p>
</sec>
<sec id="sec012">
<title>Software and code</title>
<p>We used R version 3.2.2 (2015-08-14) for all analyses [<xref ref-type="bibr" rid="pcbi.1005910.ref035">35</xref>]. All data and code used for this analysis is freely available in an R package online at <ext-link ext-link-type="uri" xlink:href="https://github.com/reichlab/adaptively-weighted-ensemble" xlink:type="simple">https://github.com/reichlab/adaptively-weighted-ensemble</ext-link> and may be installed in R directly. Predictions generated in real-time with early development versions of this model during the 2016/2017 influenza season may be viewed at <ext-link ext-link-type="uri" xlink:href="https://reichlab.io/flusight/" xlink:type="simple">https://reichlab.io/flusight/</ext-link>. To maximize reproducibility of our work, we have set seeds prior to running code that relies on stochastic simulations using the <monospace>rstream</monospace> package [<xref ref-type="bibr" rid="pcbi.1005910.ref040">40</xref>]. Additionally, the manuscript itself was dynamically generated using RMarkdown.</p>
</sec>
</sec>
<sec id="sec013" sec-type="results">
<title>Results</title>
<p>To evaluate overall model performance, we computed log scores for all predictions made by each model across all regions and test phase seasons. Predictions made before the season peak (for predictions of peak incidence or peak timing) or before the season onset (for predictions of season onset timing) are the most relevant to decision makers using the predictions as inputs to set public policy. We therefore focus our comparison of model performance on results for predictions made before the target event occurred within each of the test phase seasons. Plots of the full predictive distributions at the national level from the <bold>FW-reg-w</bold> ensemble are presented in <xref ref-type="supplementary-material" rid="pcbi.1005910.s002">S1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005910.s003">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005910.s004">S3</xref> Figs.</p>
<p>As discussed in the methods section, our test set contained predictions from each model for 3 targets over 5 seasons in 11 spatial units. To ensure that seasons with later onsets or later peaks would not count more heavily than seasons with earlier onsets and peaks, and to simplify the analysis in the presence of serial autocorrelation in model performance over consecutive weeks, we summarized model performance within each season by the mean log score for all predictions made before the peak or onset week (as appropriate for the prediction target). This led to 165 observations of model performance for each model, corresponding to the unique combinations of prediction target, season, and spatial unit.</p>
<sec id="sec014">
<title>Feature-weighted ensemble model weights reflect trends in component model log scores</title>
<p>
<xref ref-type="fig" rid="pcbi.1005910.g003">Fig 3</xref> displays variation in leave-one-season-out log scores from the three component models over the course of the training phase seasons, along with the corresponding model weight estimates from the <bold>CW</bold> and <bold>FW-reg-w</bold> models. Performance of the <bold>SARIMA</bold> and <bold>KCDE</bold> models is similar, with mean log scores from those models starting out near or slightly below the mean performance of <bold>KDE</bold>, but with performance improving as more data become available. Near the beginning of some seasons, predictions from the <bold>SARIMA</bold> model are quite a bit worse than predictions from the other two component models. <xref ref-type="supplementary-material" rid="pcbi.1005910.s005">S4 Fig</xref> illustrates that these patterns are consistent across the other regions. <xref ref-type="supplementary-material" rid="pcbi.1005910.s006">S5 Fig</xref> shows that performance of the component models also varies with the model’s uncertainty as measured by the number of bins required to cover 90% in the predictive distribution, and <xref ref-type="supplementary-material" rid="pcbi.1005910.s007">S6 Fig</xref> shows that performance varies with the observed wILI in the week when predictions are made.</p>
<fig id="pcbi.1005910.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005910.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Example of component model weights from the CW and FW-reg-w models.</title>
<p>Model weights are shown for predictions of onset timing (panel A), peak timing (panel B), and peak incidence (panel C) at the national level. The upper plot within each panel shows mean, minimum, and maximum log scores achieved by each component model for predictions of the given prediction target at the national level in each week of the season, summarizing across all seasons in the training phase when all three component models produced predictions. The lower plot within each panel shows model weights from the textbfCW and textbfFW-reg-w ensemble methods at each week in the season.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.g003" xlink:type="simple"/>
</fig>
<p>The model weights assigned by the feature weighted ensemble models generally track these trends in relative model performance (<xref ref-type="fig" rid="pcbi.1005910.g003">Fig 3</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005910.s008">S7 Fig</xref>). For all three targets, at the national level the weight assigned to the <bold>SARIMA</bold> model increases and the weight assigned to <bold>KDE</bold> decreases as the season progresses. However, the magnitude of shifts in model weights as the weighting features vary is different for the three prediction targets.</p>
</sec>
<sec id="sec015">
<title>Best models have similar aggregate performance</title>
<p>Aggregating across all combinations of prediction target, region, and season in the test phase, the best component models and the best ensemble models had similar performance (<xref ref-type="fig" rid="pcbi.1005910.g004">Fig 4</xref>). The <bold>CW</bold> ensemble had the highest average log scores across all three prediction targets, but a permutation test (described in <xref ref-type="supplementary-material" rid="pcbi.1005910.s001">S1 Text</xref>) was unable to distinguish its performance from the <bold>KCDE</bold>, <bold>SARIMA</bold>, or <bold>FW-reg-w</bold> models. However, these four methods all outperformed the <bold>KDE</bold> model in terms of mean log scores by a wide margin, as well as the <bold>EW</bold> and <bold>FW-wu</bold>, <bold>FW-reg-wu</bold>, and <bold>FW-reg-wui</bold> ensembles by narrower margins. These general trends in model performance were similar for each of the three prediction targets individually; for example, <xref ref-type="supplementary-material" rid="pcbi.1005910.s009">S8 Fig</xref> demonstrates that average performance of the <bold>FW-reg-w</bold> and <bold>SARIMA</bold> models is similar for all three prediction targets.</p>
<fig id="pcbi.1005910.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005910.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Permutation test results for pairwise comparisons of the mean log scores for each method.</title>
<p>For each combination of 3 prediction targets, 11 regions, and 5 test phase seasons, we calculated the mean log score for all predictions made by each method in weeks before the event being predicted occurred. Panel A presents the overall mean of these values for each method; higher mean log scores indicate better performance. Panel B displays the difference in mean log scores for each pair of models. Positive values indicate that the model on the vertical axis outperformed the model on the horizontal axis on average. A permutation test was used to obtain approximate p-values for these differences (see <xref ref-type="supplementary-material" rid="pcbi.1005910.s001">S1 Text</xref> for details). For reference, a Bonferroni correction at a familywise significance level of 0.05 for all pairwise comparisons leads to a significance cutoff of approximately 0.0014.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.g004" xlink:type="simple"/>
</fig>
<p>As noted above, our test set included only 5 seasons, and the effective sample size for model comparison is smaller than the 165 combinations of prediction target, region, and test phase season due to correlations in predictive performance across regions and seasons. This may have contributed to our inability to detect statistically significant differences between the best models, and may limit the generalizability of these results; we will return to this point in the discussion.</p>
</sec>
<sec id="sec016">
<title>Ensembles show stable performance for early-season predictions</title>
<p>Although the aggregate performance of these models is quite similar, some differences between the methods begin to emerge when we examine performance in more detail. Predictions that are used in setting public policy must be of consistent quality across all regions and seasons. We observed that the component models showed more variability and lower worst-case performance than the ensemble methods. The discussion in this subsection presents results of an exploratory analysis of the results, and all p-values are from post-hoc hypothesis tests.</p>
<p>To examine consistency of predictive performance, for each combination of prediction target, region, and test phase season we calculated the difference in mean log scores between each method and the method with median performance for that target, region, and season. This measure of model performance relative to the median can be compared across prediction targets, regions, and seasons that may be predicted with varying levels of difficulty. <xref ref-type="fig" rid="pcbi.1005910.g005">Fig 5</xref> displays these differences in performance relative to the median for just the <bold>KCDE</bold>, <bold>SARIMA</bold>, <bold>CW</bold>, and <bold>FW-reg-w</bold> methods. This comparison demonstrates that while these methods all had similar average performance, the <bold>CW</bold> and <bold>FW-reg-w</bold> ensemble methods had more consistent performance than the component models did, as is observed by the heavier distributional tails below zero on the horizontal axis.</p>
<fig id="pcbi.1005910.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005910.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Density plots summarizing differences in mean log scores for each method relative to the median model.</title>
<p>We calculate the difference in log scores for a given method and the method with median performance for each combination of prediction target, region, and test phase season; each density curve summarizes results across all 165 combinations of 3 prediction targets, 11 regions, and 5 test phase seasons. Positive values indicate better performance than the median model. For legibility, we only show results for the two component models with best mean performance (KCDE and SARIMA) and for the two ensemble models with best mean performance (CW and FW-reg-w).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.g005" xlink:type="simple"/>
</fig>
<p>We can quantify this observation by comparing the minimum performance relative to the median across all prediction targets, regions, and seasons for each method (<xref ref-type="fig" rid="pcbi.1005910.g006">Fig 6</xref>). This comparison reveals that the <bold>FW-reg-w</bold> ensemble had better worst-case performance than all of the component models, and the <bold>CW</bold> ensemble had better worst-case performance than the <bold>KDE</bold> and <bold>KCDE</bold> component models. These differences were both statistically and practically significant. The differences between the ensemble and component models become more marked if we use the 10th percentile of performance differences relative to the median as a more stable measure of the lower tail of this distribution than the minimum (<xref ref-type="supplementary-material" rid="pcbi.1005910.s010">S9 Fig</xref>). Additionally, the <bold>FW-reg-w</bold> model had a higher 10th percentile difference in performance from the median model than all other methods. Across all three prediction targets and all test phase seasons, the <bold>FW-reg-w</bold> ensemble had the most consistent performance of all methods we considered (<xref ref-type="supplementary-material" rid="pcbi.1005910.s011">S10 Fig</xref>).</p>
<fig id="pcbi.1005910.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005910.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Permutation test results for comparisons of the minimum difference in mean log scores relative to the median for each pair of methods.</title>
<p>For each combination of 3 prediction targets, 11 regions, and 5 test phase seasons, we calculated the difference in mean log scores between each method and the method with median performance for that target, region, and season. Panel A presents the minimum difference from the median model for each method across all combinations of target, region, and season. Larger values of this quantity indicate that the given model has better worst-case performance. Panel B displays the difference in this measure of worst-case performance for each pair of models. Positive values indicate that the model on the vertical axis had better worst-case performance than the model on the horizontal axis. A permutation test was used to obtain approximate p-values for these differences (see <xref ref-type="supplementary-material" rid="pcbi.1005910.s001">S1 Text</xref> for details). For reference, a Bonferroni correction at a familywise significance level of 0.05 for all pairwise comparisons leads to a significance cutoff of approximately 0.0014.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.g006" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec017">
<title>Regularization improves feature-weighted ensemble models</title>
<p>The regularization of feature-weighted ensembles improved early-season prediction accuracy. A comparison of the <bold>FW-wu</bold> and <bold>FW-reg-wu</bold> models shows improvements in both mean performance and worst-case performance when regularization was used to create smoother functions of model weights as a function of season week and model uncertainty (Figs <xref ref-type="fig" rid="pcbi.1005910.g004">4</xref> and <xref ref-type="fig" rid="pcbi.1005910.g006">6</xref>).</p>
</sec>
</sec>
<sec id="sec018" sec-type="conclusions">
<title>Discussion</title>
<p>In this work we have examined the potential for ensemble methods to improve infectious disease predictions. We explored a nested series of ensemble methods, focusing on methods that computed weighted averages of predictive distributions for seasonal targets of public health interest, such as the peak intensity of the outbreak and the timing of both season onset and peak. The methods we examined ranged from using equal model weights to more complex schemes with weights that varied as functions of multiple covariates. The best of these ensemble methods achieved overall performance that was about as good as the best of the individual component models, with increased stability in model performance across different regions and seasons.</p>
<p>Increased stability in predictive accuracy can provide decision makers with more confidence when using predictions as inputs to set policy. For example, if a single model does well in most seasons but occasionally fails badly, planning decisions may be negatively impacted in those failing years. This may be particularly important in a public health setting where the events that are most important to get right are those relatively rare cases when incidence is much larger than usual or the season timing is earlier or later than usual. This reduction in variability of model performance achieved by ensemble methods is therefore important for ensuring that our predictions are reliable under a variety of conditions.</p>
<p>Among the different ensemble specifications we considered, the <bold>CW</bold> and <bold>FW-reg-w</bold> models had slightly better average performance during the test phase than the three other ensemble methods that included some form of regularization on the model weighting functions, and much better performance than an ensemble with unregularized weighting function. The <bold>FW-reg-wui</bold> and <bold>FW-reg-wu</bold> ensembles did not outperform the simpler <bold>FW-reg-w</bold> ensemble, indicating that including model uncertainty and recent observations of disease incidence did not add much more information about relative model performance than was available from the week of the season in which predictions were generated. Analysis of worst-case performance suggests that the <bold>FW-reg-w</bold> ensemble had more stable performance across different regions and seasons than the other ensemble specifications. However, whether or not this difference was statistically significant depended on the measure of worst-case performance used. Overall, the <bold>FW-reg-w</bold> method had good average and worst-case performance across all test phase seasons and prediction targets; the <bold>CW</bold> ensemble had similar average performance, but its worst-case performance was not as good as that of the <bold>FW-reg-w</bold> method.</p>
<p>All hypothesis tests we conducted related to worst-case performance were post-hoc tests conducted after an exploratory analysis of relative model performance, and these results should be confirmed in future studies. Additionally, the permutation test we used accounts for serial autocorrelation in model performance within a region-season, but does not account for correlation across region or seasons; thus the p-values discussed throughout this work should be regarded as only approximate indicators of statistical significance.</p>
<p>The feature-weighted ensemble models presented in this article use a novel scheme to estimate feature-dependent model weights that sum to 1 and are therefore suitable for use in combining predictive distributions. This general method could be applied to combine distribution estimates in any context, and is not limited to time-series or infectious disease applications. Furthermore, comparing an implementation of the feature-weighting that smoothed the model weights to one that did not showed consistent improvements in model performance. This result suggests that future work on feature-weighted ensemble implementations should consider regularized estimation.</p>
<p>Infectious disease predictions are only useful to public health officials if they are communicated effectively in real time. Predictions from an early version of the <bold>FW-reg-w</bold> model were updated weekly during the 2016/2017 influenza season and disseminated through an interactive website at <ext-link ext-link-type="uri" xlink:href="https://reichlab.io/flusight/" xlink:type="simple">https://reichlab.io/flusight/</ext-link>. While we have successfully deployed the methods discussed here in a real-time setting, in this article we have ignored the important issue of reporting delays that occur with real-time data. All models were trained using the finalized value of the incidence measure, and these finalized values were used to make the cross-validated predictions that were inputs to the ensemble estimation as well as the predictions for the test set evaluation. Some component models may be more or less sensitive to reporting delays than other models, and this could lead to inappropriate estimates for the ensemble weighting functions if finalized data were used for the cross-validated predictions but the methods were then used in real time. Ideally, the cross-validated model log scores used to estimate the ensemble weighting functions should be obtained using the same sort of “non-finalized” data that the models will encounter when making real-time predictions.</p>
<p>A central challenge of working with infectious disease data sets is the limited number of years of data available for model estimation and evaluation. We have used approximately one fourth of our data set for model evaluation, which left us with only 14 seasons of training data and 5 seasons of testing data. Additionally, we had fewer than 14 seasons of leave-one-season-out predictions to use in estimating the model weighting functions for the <bold>FW-wu</bold> ensemble methods because the <bold>SARIMA</bold> model required unobserved seasonally lagged incidence to make predictions for the first few seasons in the training phase. This small sample size may have negatively impacted our ability to estimate the weighting functions. Altogether the test phase included 55 combinations of region and season, with a total of 2469 predictions from each method made across all three prediction targets before the test phase season onset or peak occurred. Nevertheless, because of the high degree of correlation in model log scores for the same prediction target in different weeks and regions within the same season we have a smaller effective sample size for detecting differences in average model performance in the test phase. The findings in this work should be confirmed with additional data sets. Another possible avenue would be to obtain pseudo out-of-sample results by performing cross validation within the training phase.</p>
<p>Another limitation of this work is the small selection of component models used. Theoretical results and applications have demonstrated that ensemble methods are most effective when using a diverse set of component models [<xref ref-type="bibr" rid="pcbi.1005910.ref016">16</xref>]. In our study, the <bold>KCDE</bold> and <bold>SARIMA</bold> component models are similar in that they both use seasonal terms and observations of recent incidence to inform their predictions (though we note that these two models tended to perform well in different seasons, as illustrated in <xref ref-type="supplementary-material" rid="pcbi.1005910.s011">S10 Fig</xref>). Increased component model diversity could yield improved ensemble performance; this could be achieved either through inclusion of different model structures (for example, agent-based or mechanistic models such as those explored in [<xref ref-type="bibr" rid="pcbi.1005910.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1005910.ref010">10</xref>]) or different covariates (such as information about the circulating strains of a disease, spatial effects, weather, or social media data, as used by [<xref ref-type="bibr" rid="pcbi.1005910.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005910.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005910.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005910.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1005910.ref014">14</xref>]). Thus, the current work should not be viewed as a competitor to the models developed in previous work, but rather as a method for integrating and unifying the diverse array of methods that have been developed in the literature. The methods presented here are suitable for combining predictions from any collection of component models that each output a full predictive distribution, regardless of model structure.</p>
<p>Our exploration of feature-weighted ensembles is also limited by the relatively restricted feature sets we used for the weighting functions. We selected a few features based on exploratory analysis of the training phase results, and set all ensemble model formulations before obtaining any predictions for the test phase. It is possible that other weighting features not considered in this work may be more informative than those we have used. Some ideas for weighting covariates to use in future work include the largest incidence so far this season; the onset threshold; alternative summaries of the predictive distributions from the component models such as the probability at the mode or the modal value; the predominant flu strain; or the distribution of incidence in age groups.</p>
<p>The performance of the ensemble methods might be improved by subsetting the training data for the ensembles to the most important observations. The discrepancy in this work between the times used to train the ensembles (all leave-one-season-out predictions) and the times used for model comparison (only predictions made before the season onset or peak) may have led to an artificial decline in performance for the ensembles; this may be especially so for the relatively inflexible <bold>CW</bold> method.</p>
<p>This work provides a rigorous and comprehensive evaluation of ensemble methods for averaging probabilistic predictions for features of infectious disease outbreaks. A range of models, both single component models and ensemble models that combined component model predictions, demonstrated the ability to make more accurate predictions than a seasonal average baseline model. Additionally, systematic comparisons of simple and complex prediction models highlight a crucial added value of ensemble modeling, namely increased stability and consistency of model performance relative to the component models. Continued investigation, application, and innovation is necessary to strengthen our understanding of how to best leverage combinations of models to assist decision makers in fields, such as public health and infectious disease surveillance, that require data-driven rapid response.</p>
</sec>
<sec id="sec019">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005910.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Permutation test procedure.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005910.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.s002" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Predictive distributions for onset timing.</title>
<p>Predictions are shown for just the FW-reg-w method at the national level, facetted by test phase season.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005910.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.s003" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Predictive distributions for peak timing.</title>
<p>Predictions are shown for just the FW-reg-w method at the national level, facetted by test phase season.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005910.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.s004" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Predictive distributions for peak incidence.</title>
<p>Predictions are shown for just the FW-reg-w method at the national level, facetted by test phase season.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005910.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.s005" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Log scores achieved by each component model in each week of the season.</title>
<p>For each week of the season, log scores are summarized across all seasons in the training phase when all three component models produced predictions. The thick line is a smoothed estimate of mean log score at each week in the season; the shaded region indicates the convex hull of log scores achieved by each model; and the actual log scores achieved in each week are indicated with points.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005910.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.s006" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Log scores achieved by each component model vs. model uncertainty.</title>
<p>Model uncertainty is measured by the number of bins required to cover 90% of the predictive distribution. The plot summarizes results across all seasons in the training phase when all three component models produced predictions. The thick line is a smoothed estimate of mean log score at each value of model uncertainty; the shaded region indicates the convex hull of log scores achieved by each model; and the actual log scores achieved in each week are indicated with points. The KCDE and SARIMA models condition on all previously observed data within the current season, and generally have high certainly when the target event (season onset or season peak) has almost occurred or has already occurred.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005910.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.s007" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Log scores achieved by each component model vs. wILI in the week of the season when predictions were made.</title>
<p>The plot summarizes results across all seasons in the training phase when all three component models produced predictions. The thick line is a smoothed estimate of mean log score at each week in the season; the shaded region indicates the convex hull of log scores achieved by each model; and the actual log scores achieved in each week are indicated with points.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005910.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.s008" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Weights assigned to each component model by the FW-reg-wu ensemble model.</title>
<p>Weights are shown for the prediction of season peak incidence at the national level. There are three weighting functions (one for each component model) represented in each row of the figure. The value of the weight is depicted by the color. Each function depends on three features: the week of the season at the time when the predictions are made, KCDE model uncertainty, and SARIMA model uncertainty. Model uncertainty represents the minimum number of predictive distribution bins required to cover 90% probability of the predictive distribution, so the higher this number is the more uncertain the model is.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005910.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.s009" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Density plots representing the distribution of log score differences from predictions made by the FW-reg-w and SARIMA models.</title>
<p>Predictions are aggregated across all regions and test phase seasons. The horizontal axis represents the difference in log scores achieved by the FW-reg-w and SARIMA models for predictions made in a particular week; positive values indicate that FW-reg-w outperformed SARIMA for that prediction. The vertical line indicates the mean log score difference for all predictions made before the onset or season peak occurred.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005910.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.s010" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Permutation test results for pairwise comparisons of the 10th percentile of log score differences for each method relative to the median model.</title>
<p>For each combination of 3 prediction targets, 11 regions, and 5 test phase seasons, we calculated the difference in mean log scores between each method and the method with median performance for that target, region, and season. Panel A presents the 10th percentile of these differences from the median model for each method across all combinations of target, region, and season. Larger values of this quantity indicate that the given model has better worst-case performance. Panel B displays the difference in this measure of worst-case performance for each pair of models. Positive values indicate that the model on the vertical axis had better worst-case performance than the model on the horizontal axis. A permutation test was used to obtain approximate p-values for these differences (see <xref ref-type="supplementary-material" rid="pcbi.1005910.s001">S1 Text</xref> for details). For reference, a Bonferroni correction at a familywise significance level of 0.05 for all pairwise comparisons leads to a significance cutoff of approximately 0.0014.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005910.s011" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005910.s011" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Model performance ranked by mean log score within each of the five test seasons.</title>
<p>Only predictions made before the target (season onset or peak) occurred are included. Averages are taken across all regions.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005910.ref001">
<label>1</label>
<mixed-citation publication-type="book" xlink:type="simple">
<collab>Centers for Disease Control and Prevention</collab>. <source>Staying Ahead of the Curve: Modeling and Public Health Decision-Making</source>; <year>2016</year>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.cdc.gov/cdcgrandrounds/archives/2016/january2016.htm" xlink:type="simple">http://www.cdc.gov/cdcgrandrounds/archives/2016/january2016.htm</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005910.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chretien</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>George</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chitale</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>McKenzie</surname> <given-names>FE</given-names></name>. <article-title>Influenza forecasting in human populations: a scoping review</article-title>. <source>PloS one</source>. <year>2014</year>;<volume>9</volume>(<issue>4</issue>):<fpage>e94130</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0094130" xlink:type="simple">10.1371/journal.pone.0094130</ext-link></comment> <object-id pub-id-type="pmid">24714027</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nsoesie</surname> <given-names>EO</given-names></name>, <name name-style="western"><surname>Brownstein</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Ramakrishnan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Marathe</surname> <given-names>MV</given-names></name>. <article-title>A systematic review of studies on forecasting the dynamics of influenza outbreaks</article-title>. <source>Influenza and other respiratory viruses</source>. <year>2014</year>;<volume>8</volume>(<issue>3</issue>):<fpage>309</fpage>–<lpage>316</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/irv.12226" xlink:type="simple">10.1111/irv.12226</ext-link></comment> <object-id pub-id-type="pmid">24373466</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Biggerstaff</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Alper</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Dredze</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fox</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fung</surname> <given-names>ICH</given-names></name>, <name name-style="western"><surname>Hickmann</surname> <given-names>KS</given-names></name>, <etal>et al</etal>. <article-title>Results from the centers for disease control and prevention’s predict the 2013–2014 Influenza Season Challenge</article-title>. <source>BMC Infectious Diseases</source>. <year>2016</year>;<volume>16</volume>(<issue>1</issue>):<fpage>357</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12879-016-1669-x" xlink:type="simple">10.1186/s12879-016-1669-x</ext-link></comment> <object-id pub-id-type="pmid">27449080</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Karspeck</surname> <given-names>A</given-names></name>. <article-title>Forecasting seasonal outbreaks of influenza</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2012</year>;<volume>109</volume>(<issue>50</issue>):<fpage>20425</fpage>–<lpage>20430</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1208772109" xlink:type="simple">10.1073/pnas.1208772109</ext-link></comment> <object-id pub-id-type="pmid">23184969</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Karspeck</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Tamerius</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lipsitch</surname> <given-names>M</given-names></name>. <article-title>Real-time influenza forecasts during the 2012–2013 season</article-title>. <source>Nature communications</source>. <year>2013</year>;<volume>4</volume>:<fpage>2837</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms3837" xlink:type="simple">10.1038/ncomms3837</ext-link></comment> <object-id pub-id-type="pmid">24302074</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kandula</surname> <given-names>S</given-names></name>. <article-title>Improved Discrimination of Influenza Forecast Accuracy Using Consecutive Predictions</article-title>. <source>PLoS currents</source>. <year>2015</year>;<volume>7</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/currents.outbreaks.8a6a3df285af7ca973fab4b22e10911e" xlink:type="simple">10.1371/currents.outbreaks.8a6a3df285af7ca973fab4b22e10911e</ext-link></comment> <object-id pub-id-type="pmid">26512336</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Karspeck</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>. <article-title>Comparison of filtering methods for the modeling and retrospective forecasting of influenza epidemics</article-title>. <source>PLoS computational biology</source>. <year>2014</year>;<volume>10</volume>(<issue>4</issue>):<fpage>e1003583</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003583" xlink:type="simple">10.1371/journal.pcbi.1003583</ext-link></comment> <object-id pub-id-type="pmid">24762780</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Cowling</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Lau</surname> <given-names>EH</given-names></name>, <name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>. <article-title>Forecasting influenza epidemics in Hong Kong</article-title>. <source>PLoS computational biology</source>. <year>2015</year>;<volume>11</volume>(<issue>7</issue>):<fpage>e1004383</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004383" xlink:type="simple">10.1371/journal.pcbi.1004383</ext-link></comment> <object-id pub-id-type="pmid">26226185</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Olson</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>. <article-title>Forecasting Influenza Outbreaks in Boroughs and Neighborhoods of New York City</article-title>. <source>PLoS computational biology</source>. <year>2016</year>;<volume>12</volume>(<issue>11</issue>):<fpage>e1005201</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005201" xlink:type="simple">10.1371/journal.pcbi.1005201</ext-link></comment> <object-id pub-id-type="pmid">27855155</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref011">
<label>11</label>
<mixed-citation publication-type="other" xlink:type="simple">Chakraborty P, Khadivi P, Lewis B, Mahendiran A, Chen J, Butler P, et al. Forecasting a moving target: Ensemble models for ILI case count predictions. In: Proceedings of the 2014 SIAM international conference on data mining. SIAM; 2014. p. 262–270.</mixed-citation>
</ref>
<ref id="pcbi.1005910.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hickmann</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Fairchild</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Priedhorsky</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Generous</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Hyman</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Deshpande</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Forecasting the 2013–2014 influenza season using Wikipedia</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>5</issue>):<fpage>e1004239</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004239" xlink:type="simple">10.1371/journal.pcbi.1004239</ext-link></comment> <object-id pub-id-type="pmid">25974758</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Paul</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Dredze</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Broniatowski</surname> <given-names>D</given-names></name>. <article-title>Twitter improves influenza forecasting</article-title>. <source>PLOS Currents Outbreaks</source>. <year>2014</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/currents.outbreaks.90b9ed0f59bae4ccaa683a39865d9117" xlink:type="simple">10.1371/currents.outbreaks.90b9ed0f59bae4ccaa683a39865d9117</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Santillana</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nguyen</surname> <given-names>AT</given-names></name>, <name name-style="western"><surname>Dredze</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Paul</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Nsoesie</surname> <given-names>EO</given-names></name>, <name name-style="western"><surname>Brownstein</surname> <given-names>JS</given-names></name>. <article-title>Combining search, social media, and traditional data sources to improve influenza surveillance</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>10</issue>):<fpage>e1004513</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004513" xlink:type="simple">10.1371/journal.pcbi.1004513</ext-link></comment> <object-id pub-id-type="pmid">26513245</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ray</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Sakrejda</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Lauer</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Johansson</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Reich</surname> <given-names>NG</given-names></name>. <article-title>Infectious disease prediction with kernel conditional density estimation</article-title>. <source>Statistics in Medicine</source>. <year>2017</year>;<volume>36</volume>(<issue>30</issue>):<fpage>4908</fpage>–<lpage>4929</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/sim.7488" xlink:type="simple">10.1002/sim.7488</ext-link></comment> <object-id pub-id-type="pmid">28905403</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Polikar</surname> <given-names>R</given-names></name>. <article-title>Ensemble based systems in decision making</article-title>. <source>IEEE Circuits and systems magazine</source>. <year>2006</year>;<volume>6</volume>(<issue>3</issue>):<fpage>21</fpage>–<lpage>45</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/MCAS.2006.1688199" xlink:type="simple">10.1109/MCAS.2006.1688199</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref017">
<label>17</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hastie</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Friedman</surname> <given-names>J</given-names></name>. <source>The Elements of Statistical Learning: Data Mining, Inference, and Prediction</source>. <edition>2nd ed</edition>. <publisher-name>Springer</publisher-name>; <year>2011</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005910.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wolpert</surname> <given-names>DH</given-names></name>. <article-title>Stacked generalization</article-title>. <source>Neural Networks</source>. <year>1992</year>;<volume>5</volume>(<issue>2</issue>):<fpage>241</fpage>–<lpage>259</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0893-6080(05)80023-1" xlink:type="simple">10.1016/S0893-6080(05)80023-1</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Smyth</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wolpert</surname> <given-names>D</given-names></name>. <article-title>Linearly combining density estimators via stacking</article-title>. <source>Machine Learning</source>. <year>1999</year>;<volume>36</volume>(<issue>1-2</issue>):<fpage>59</fpage>–<lpage>83</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1023/A:1007511322260" xlink:type="simple">10.1023/A:1007511322260</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rigollet</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Tsybakov</surname> <given-names>AB</given-names></name>. <article-title>Linear and convex aggregation of density estimators</article-title>. <source>Mathematical Methods of Statistics</source>. <year>2007</year>;<volume>16</volume>(<issue>3</issue>):<fpage>260</fpage>–<lpage>280</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3103/S1066530707030052" xlink:type="simple">10.3103/S1066530707030052</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref021">
<label>21</label>
<mixed-citation publication-type="other" xlink:type="simple">Ganti R, Gray A. Cake: Convex adaptive kernel density estimation. In: International Conference on Artificial Intelligence and Statistics; 2011. p. 498–506.</mixed-citation>
</ref>
<ref id="pcbi.1005910.ref022">
<label>22</label>
<mixed-citation publication-type="other" xlink:type="simple">Rosset S, Segal E. Boosting density estimation. In: NIPS; 2002. p. 641–648.</mixed-citation>
</ref>
<ref id="pcbi.1005910.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Herbster</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Warmuth</surname> <given-names>MK</given-names></name>. <article-title>Tracking the best expert</article-title>. <source>Machine Learning</source>. <year>1998</year>;<volume>32</volume>(<issue>2</issue>):<fpage>151</fpage>–<lpage>178</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1023/A:1007424614876" xlink:type="simple">10.1023/A:1007424614876</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yamanishi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Maruyama</surname> <given-names>Y</given-names></name>. <article-title>Dynamic model selection with its applications to novelty detection</article-title>. <source>IEEE Transactions on Information Theory</source>. <year>2007</year>;<volume>53</volume>(<issue>6</issue>):<fpage>2180</fpage>–<lpage>2189</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TIT.2007.896890" xlink:type="simple">10.1109/TIT.2007.896890</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref025">
<label>25</label>
<mixed-citation publication-type="other" xlink:type="simple">Cortes C, Kuznetsov V, Mohri M. Ensemble Methods for Structured Prediction. In: Proceedings of The 31st International Conference on Machine Learning; 2014. p. 1134–1142.</mixed-citation>
</ref>
<ref id="pcbi.1005910.ref026">
<label>26</label>
<mixed-citation publication-type="other" xlink:type="simple">Sill J, Takacs G, Mackey L, Lin D. Feature-Weighted Linear Stacking. arXiv. 2009;.</mixed-citation>
</ref>
<ref id="pcbi.1005910.ref027">
<label>27</label>
<mixed-citation publication-type="other" xlink:type="simple">Jahrer M, Töscher A, Legenstein R. Combining predictions for accurate recommender systems. In: Proceedings of the 16th ACM SIGKDD international conference on Knowledge discovery and data mining. ACM; 2010. p. 693–702.</mixed-citation>
</ref>
<ref id="pcbi.1005910.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yamana</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Kandula</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>. <article-title>Superensemble forecasts of dengue outbreaks</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2016</year>;<volume>13</volume>(<issue>123</issue>):<fpage>20160410</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2016.0410" xlink:type="simple">10.1098/rsif.2016.0410</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friedman</surname> <given-names>JH</given-names></name>. <article-title>Greedy function approximation: a gradient boosting machine</article-title>. <source>Annals of statistics</source>. <year>2001</year>; p. <fpage>1189</fpage>–<lpage>1232</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/aos/1013203451" xlink:type="simple">10.1214/aos/1013203451</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref030">
<label>30</label>
<mixed-citation publication-type="other" xlink:type="simple">Centers for Disease Control and Prevention. Overview of Influenza Surveillance in the United States; 2016. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.cdc.gov/flu/weekly/overview.htm" xlink:type="simple">https://www.cdc.gov/flu/weekly/overview.htm</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005910.ref031">
<label>31</label>
<mixed-citation publication-type="other" xlink:type="simple">Centers for Disease Control and Prevention. Regional baseline values for influenza-like illness; 2016. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/cdcepi/FluSight-forecasts/blob/master/wILI_Baseline.csv" xlink:type="simple">https://github.com/cdcepi/FluSight-forecasts/blob/master/wILI_Baseline.csv</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005910.ref032">
<label>32</label>
<mixed-citation publication-type="other" xlink:type="simple">Centers for Disease Control and Prevention. Epidemic Prediction Initiative; 2016. Available from: <ext-link ext-link-type="uri" xlink:href="https://predict.phiresearchlab.org/post/57f3f440123b0f563ece2576" xlink:type="simple">https://predict.phiresearchlab.org/post/57f3f440123b0f563ece2576</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005910.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gneiting</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Raftery</surname> <given-names>AE</given-names></name>. <article-title>Strictly proper scoring rules, prediction, and estimation</article-title>. <source>Journal of the American Statistical Association</source>. <year>2007</year>;<volume>102</volume>(<issue>477</issue>):<fpage>359</fpage>–<lpage>378</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1198/016214506000001437" xlink:type="simple">10.1198/016214506000001437</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref034">
<label>34</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Silverman</surname> <given-names>BW</given-names></name>. <source>Density estimation for statistics and data analysis</source>. <volume>vol. 26</volume>. <publisher-name>CRC press</publisher-name>; <year>1986</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005910.ref035">
<label>35</label>
<mixed-citation publication-type="book" xlink:type="simple">
<collab>R Core Team</collab>. <source>R: A Language and Environment for Statistical Computing</source>; <year>2015</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/" xlink:type="simple">https://www.R-project.org/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005910.ref036">
<label>36</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Box</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Jenkins</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Reinsel</surname> <given-names>GC</given-names></name>, <name name-style="western"><surname>Ljung</surname> <given-names>GM</given-names></name>. <source>Time series analysis: forecasting and control</source>. <publisher-name>John Wiley &amp; Sons</publisher-name>; <year>2015</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005910.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hyndman</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Khandakar</surname> <given-names>Y</given-names></name>. <article-title>Automatic time series forecasting: The forecast package for R</article-title>. <source>Journal Of Statistical Software</source>. <year>2008</year>;<volume>27</volume>(<issue>3</issue>):<fpage>C3</fpage>–<lpage>C3</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18637/jss.v027.i03" xlink:type="simple">10.18637/jss.v027.i03</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005910.ref038">
<label>38</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Lin</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>Y</given-names></name>. <chapter-title>Degenerate Expectation-Maximization Algorithm for Local Dimension Reduction</chapter-title>. In: <source>Classification, Clustering, and Data Mining Applications</source>. <publisher-loc>Berlin, Heidelberg</publisher-loc>: <publisher-name>Springer</publisher-name> <publisher-loc>Berlin Heidelberg</publisher-loc>; <year>2004</year>. p. <fpage>259</fpage>–<lpage>268</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://link.springer.com/10.1007/978-3-642-17103-1_25" xlink:type="simple">http://link.springer.com/10.1007/978-3-642-17103-1_25</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005910.ref039">
<label>39</label>
<mixed-citation publication-type="other" xlink:type="simple">Chen T, He T, Benesty M. xgboost: Extreme Gradient Boosting; 2016. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=xgboost" xlink:type="simple">https://CRAN.R-project.org/package=xgboost</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005910.ref040">
<label>40</label>
<mixed-citation publication-type="other" xlink:type="simple">Leydold J. rstream: Streams of Random Numbers; 2015. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=rstream" xlink:type="simple">https://CRAN.R-project.org/package=rstream</ext-link>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>