<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-02122</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1007133</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Biological databases</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Immune physiology</subject><subj-group><subject>Antibodies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Immune physiology</subject><subj-group><subject>Antibodies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune system proteins</subject><subj-group><subject>Antibodies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune system proteins</subject><subj-group><subject>Antibodies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Immune system proteins</subject><subj-group><subject>Antibodies</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Mutation</subject><subj-group><subject>Point mutation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence motif analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genetic loci</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Mutation</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Per-sample immunoglobulin germline inference from B cell receptor deep sequencing data</article-title>
<alt-title alt-title-type="running-head">Per-sample immunoglobulin germline inference from B cell receptor deep sequencing data</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2527-8610</contrib-id>
<name name-style="western">
<surname>Ralph</surname>
<given-names>Duncan K.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Matsen</surname>
<given-names>Frederick A.</given-names>
<suffix>IV</suffix>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001">
<addr-line>Fred Hutchinson Cancer Research Center, Seattle, Washington, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Buhler</surname> <given-names>Jeremy</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Washington University in St Louis, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">dkralph@gmail.com</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>7</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>22</day>
<month>7</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>7</issue>
<elocation-id>e1007133</elocation-id>
<history>
<date date-type="received">
<day>20</day>
<month>12</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>28</day>
<month>5</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Ralph, Matsen</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1007133"/>
<abstract>
<p>The collection of immunoglobulin genes in an individual’s germline, which gives rise to B cell receptors via recombination, is known to vary significantly across individuals. In humans, for example, each individual has only a fraction of the several hundred known V alleles. Furthermore, the currently-accepted set of known V alleles is both incomplete (particularly for non-European samples), and contains a significant number of spurious alleles. The resulting uncertainty as to which immunoglobulin alleles are present in any given sample results in inaccurate B cell receptor sequence annotations, and in particular inaccurate inferred naive ancestors. In this paper we first show that the currently widespread practice of aligning each sequence to its closest match in the full set of IMGT alleles results in a very large number of spurious alleles that are not in the sample’s true set of germline V alleles. We then describe a new method for inferring each individual’s germline gene set from deep sequencing data, and show that it improves upon existing methods by making a detailed comparison on a variety of simulated and real data samples. This new method has been integrated into the partis annotation and clonal family inference package, available at <ext-link ext-link-type="uri" xlink:href="https://github.com/psathyrella/partis" xlink:type="simple">https://github.com/psathyrella/partis</ext-link>, and is run by default without affecting overall run time.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Antibodies are an important component of the adaptive immune system, which itself determines our response to both pathogens and vaccines. They are produced by B cells through somatic recombination of germline DNA, which results in a vast diversity of antigen binding affinities across the B cell repertoire. We typically learn about the development of this repertoire, and its history of interaction with antigens, by sequencing large numbers of the DNA sequences from which antibodies are derived. In order to understand such data, it is necessary to determine the combination of germline V, D, and J genes that was rearranged to form each such B cell receptor sequence. This is difficult, however, because the immunoglobulin locus exhibits an extraordinary level of diversity across individuals—encompassing both allelic variation and gene duplication, deletion, and conversion—and because the locus’s large size and repetitive structure make germline sequencing very difficult. In this paper we describe a new computational method that avoids this difficulty by inferring each individual’s set of immunoglobulin germline genes directly from expressed B cell receptor sequence data.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>U19-AI117891</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Matsen</surname>
<given-names>Frederick A.</given-names>
<suffix>IV</suffix>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>R01-GM113246</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Matsen</surname>
<given-names>Frederick A.</given-names>
<suffix>IV</suffix>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>R01-AI120961</award-id>
</award-group>
<award-group id="award004">
<funding-source>
<institution>Howard Hughes Medical Institute (US)</institution>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Matsen</surname>
<given-names>Frederick A.</given-names>
<suffix>IV</suffix>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000893</institution-id>
<institution>Simons Foundation</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Matsen</surname>
<given-names>Frederick A.</given-names>
<suffix>IV</suffix>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award006">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>R01-AI138709</award-id>
</award-group>
<funding-statement>This research was supported by National Institutes of Health (<ext-link ext-link-type="uri" xlink:href="https://www.nih.gov/" xlink:type="simple">https://www.nih.gov/</ext-link>) grants U19-AI117891 (FAM), R01-GM113246 (FAM), and R01-AI120961 and R01-AI138709 (Julie Overbaugh). FAM is also supported in part by a Faculty Scholar grant from the Howard Hughes Medical Institute (<ext-link ext-link-type="uri" xlink:href="http://www.hhmi.org/" xlink:type="simple">http://www.hhmi.org/</ext-link>) and the Simons Foundation (<ext-link ext-link-type="uri" xlink:href="https://www.simonsfoundation.org/" xlink:type="simple">https://www.simonsfoundation.org/</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="14"/>
<table-count count="1"/>
<page-count count="30"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-08-01</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All simulation samples and all results are available at: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.1037463" xlink:type="simple">https://doi.org/10.5281/zenodo.1037463</ext-link>. All real data samples used are publicly-available samples from previous publications (see text for citations).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The heavy and light chain B cell receptor (BCR) loci arise from a random recombination of germline V, D, and J genes. Repeated across many B cells, this generates the vast diversity of naive BCRs that is integral to the adaptive immune system. As an additional source of population-wide variation, there is significant variation of germline genes between individuals. Databases such as IMGT [<xref ref-type="bibr" rid="pcbi.1007133.ref001">1</xref>] aim to collect and organize this ensemble of germline genes.</p>
<p>The analysis of BCR sequence data begins with the alignment of each sequence against a set of germline V, D, and J genes. A variety of methods (e.g. [<xref ref-type="bibr" rid="pcbi.1007133.ref002">2</xref>–<xref ref-type="bibr" rid="pcbi.1007133.ref005">5</xref>]) have been developed to accomplish the basic task of deciding which V, D, and J genes gave rise to each observed sequence. There has been less work, however, toward measuring the extent to which the set of germline genes used for this analysis resembles the germline gene set actually present in the individual from which the sequence data was derived. Most methods simply use the full set of germline genes from a database such as IMGT [<xref ref-type="bibr" rid="pcbi.1007133.ref001">1</xref>] for all samples.</p>
<p>One problem with this approach is that the IMGT set includes genes from all individuals of a species, while any single individual’s germline contains only a fraction of these (roughly 50 out of 250 V genes, 25 of 35 D, and 6 of 12 J). This is problematic for sequencing studies that use antigen-experienced B cells that have been through several rounds of somatic hypermutation (SHM), which obscures the identity of the original germline gene. As we show below, this leads to large numbers of spurious gene assignments, and an inferred germline gene set with many more alleles than are in the individual’s true set.</p>
<p>Another problem with this approach is that no database contains a perfect catalog of the complete immunoglobulin germline diversity of each species. Sequencing continues to uncover novel human V genes that are not in any previous database [<xref ref-type="bibr" rid="pcbi.1007133.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1007133.ref013">13</xref>]. Additionally, a significant fraction of the sequences in existing databases are likely the result of sequencing error rather than real biological variation [<xref ref-type="bibr" rid="pcbi.1007133.ref014">14</xref>–<xref ref-type="bibr" rid="pcbi.1007133.ref016">16</xref>]. Our knowledge of the immunoglobulin locus is even less complete for other species [<xref ref-type="bibr" rid="pcbi.1007133.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1007133.ref017">17</xref>].</p>
<p>Improving our understanding of the immunoglobulin locus, however, is not simply a matter of applying standard genome sequencing protocols more broadly. Most genome sequencing is performed on lymphoblastoid cell lines [<xref ref-type="bibr" rid="pcbi.1007133.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1007133.ref020">20</xref>], whose prior rearrangement has destroyed much of the information about the original immunoglobulin locus. The obvious solution would be to sequence other cell types; however assembly challenges due to the complexity and repetitiveness of the locus [<xref ref-type="bibr" rid="pcbi.1007133.ref021">21</xref>] mean that even sequencing an intact immunoglobulin locus is not straightforward. The IGHV locus, for instance, consists of about 120 V genes, roughly two-thirds of which are non-functional pseudogenes, spread over a megabase of chromosome 14 [<xref ref-type="bibr" rid="pcbi.1007133.ref009">9</xref>]. The immunoglobulin locus is also subject to widespread gene duplication, deletion, and conversion [<xref ref-type="bibr" rid="pcbi.1007133.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1007133.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1007133.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1007133.ref023">23</xref>]. Thus although databases such as the 1000 Genomes project and the Simons Genome Diversity Project can be used to investigate immunoglobulin diversity [<xref ref-type="bibr" rid="pcbi.1007133.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1007133.ref024">24</xref>], this approach is not without pitfalls [<xref ref-type="bibr" rid="pcbi.1007133.ref025">25</xref>].</p>
<p>Discrepancies between a BCR-sequenced individual’s true set of germline genes and the set used to analyze their BCR sequences cause a number of practical problems. First, finding associations between particular germline genes and an immunological response is difficult if the gene assignment itself is suspect. This would impact, for example, recent work on the effects of the presence or absence of individual alleles on broadly neutralizing anti-influenza antibody development [<xref ref-type="bibr" rid="pcbi.1007133.ref026">26</xref>]. Second, such misassignment leads to inaccurate inferred naive ancestor sequences. Efforts to synthesize these inaccurate ancestral sequences in the lab and study their binding properties may then result in erroneous conclusions, since even single amino acid changes can have large effects on affinity [<xref ref-type="bibr" rid="pcbi.1007133.ref027">27</xref>]. And finally, studies of mutation [<xref ref-type="bibr" rid="pcbi.1007133.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1007133.ref029">29</xref>] and selection [<xref ref-type="bibr" rid="pcbi.1007133.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1007133.ref031">31</xref>] during affinity maturation depend upon accurate inferred naive sequences in order to correctly identify somatic mutations.</p>
<p>Our current understanding of the immunoglobulin locus comes largely from a small number of low-throughput genome and BAC library sequencing studies. The first complete sequence of the locus [<xref ref-type="bibr" rid="pcbi.1007133.ref032">32</xref>], which has been included in the first few drafts of the human genome, was assembled from several different cell lines and is therefore not a haplotype. More recently, a single complete haplotype of the heavy [<xref ref-type="bibr" rid="pcbi.1007133.ref009">9</xref>] and light [<xref ref-type="bibr" rid="pcbi.1007133.ref010">10</xref>] chain loci has been published. In addition to these larger efforts, many less-comprehensive studies of the locus have been cataloged at <ext-link ext-link-type="uri" xlink:href="http://www.imgt.org" xlink:type="simple">www.imgt.org</ext-link>.</p>
<p>Advances in sequencing technology, however, have allowed progress to come also from inference on expressed BCR repertoires. Several initial studies inferred germline sets by combining computational analysis with expert scrutiny, with one paper reporting a high level of diversity with many novel (non-IMGT) alleles across 12 individuals [<xref ref-type="bibr" rid="pcbi.1007133.ref007">7</xref>], and a second extending those results to 18 complete haplotypes [<xref ref-type="bibr" rid="pcbi.1007133.ref008">8</xref>]. Similar work by a different team used naive sequences to infer germline sets and haplotype linkage information for two individuals [<xref ref-type="bibr" rid="pcbi.1007133.ref033">33</xref>]. None of these studies, however, resulted in a generally-applicable software package or included a broad-scale validation of their methods.</p>
<p>More recently, software packages have been developed that enable fully-automated germline inference, including novel allele discovery. TIgGER [<xref ref-type="bibr" rid="pcbi.1007133.ref011">11</xref>] uses a detailed per-position fitting procedure to find new alleles separated by a small number of point mutations from genes in a known database, and a heuristic prevalence threshold-based procedure to infer germline sets. The IgDiscover package [<xref ref-type="bibr" rid="pcbi.1007133.ref012">12</xref>] infers germline sets using Levenshtein distance-based hierarchical UPGMA clustering on low-SHM IgM samples. This approach allows IgDiscover to find new alleles separated by an arbitrary number of point mutations and insertion/deletion events, and frees it from the need for an initial species-specific starting database.</p>
<p>In this paper we present a new method for automated inference of per-sample germline V gene sets from expressed BCR sequence data. We first compare our method’s accuracy on a variety of simulated samples both to the common practice of aligning against the full IMGT set, and to the two existing germline inference methods, TIgGER and IgDiscover. We find that use of the full IMGT set results in a very large number of spuriously-inferred alleles on typical samples, as well as inaccurately inferred naive sequences. We further find that while our method infers a similar fraction of correct and incorrect genes as TIgGER and IgDiscover on these simulated samples, its inferred genes are more similar to the true genes, and thus our method’s inferred naive sequences are significantly more accurate. We then use a variety of real data samples from the literature to compare the germline gene sets inferred by our method to those from TIgGER and IgDiscover, and find no reason to believe that our simulation does not accurately mimic real data. Because our method performs well on samples with elevated levels of SHM, it is more generally applicable than IgDiscover, which is restricted to low-SHM IgM samples. In addition, our method is run by default in the general-purpose partis package, which also provides annotation, clonal family inference, and simulation, while TIgGER and IgDiscover must be run as separate steps. Because the D and J loci vary much less between individuals than does V (and because D inference would be very challenging) in this paper we follow these other software packages in limiting ourselves to studies of V diversity.</p>
<p>Because of the high prevalence of both single nucleotide polymorphisms (SNPs) and structural variants in the immunoglobulin locus, there is no single reference genome to which all variants can be mapped, and thus standard SNP nomenclature appears insufficient. In this paper the usage of “gene” and “allele” is thus largely interchangeable. In addition, we define the “germline haplotype” as the set of germline genes on a single chromosome, while “germline gene set” refers to the full set on both the maternal and paternal chromosomes. In cases where confusion is unlikely, the latter will be shortened to “germline set”.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Simulation methods summary</title>
<p>In order to establish an expectation for how germline inference methods will perform on real data, we first investigate performance on a number of simulation samples. BCR repertoires differ significantly in many different variables such as SHM levels, germline set complexity, and clonal family structure. Although we would in principle like to explore germline inference accuracy by varying all of these variables simultaneously, this is combinatorially infeasible, and we thus adopt a two-stage approach to validation. We first vary one variable at a time, while holding all others constant, using simplified “sparse” repertoires consisting of sequences stemming from only a few genes. We then choose several representative values for each variable, and simulate full, realistic repertoires at these values. Geometrically, this can be imagined as investigating performance first along many slices through the parameter space, and then at several fixed points. This approach is motivated by the fact that, in sequence-similarity space, realistic repertoires are composed of widely-spaced groups of genes, where each group consists of a few genes that are much closer to each other than the typical between-group spacing. The genes within each group are thus easily confused with each other due to SHM, but not with genes in other groups. The sparse repertoires effectively recreate the dynamics within such a group, while allowing exploration of a much larger portion of parameter space than if we were to use full repertoires for all simulations.</p>
<p>In these simulations, the germline set for each sparse repertoire consists of one known germline gene, and either one or two novel alleles. Each full-repertoire sample, meanwhile, is generated by choosing a number of V, D, and J genes, and some number of alleles for each of these genes, based on results from germline sequencing studies (see <xref ref-type="sec" rid="sec008">Methods</xref>), which results in roughly 55 V, 25 D, and 6 J alleles per sample.</p>
</sec>
<sec id="sec004">
<title>Validation results</title>
<p>Variation of individual variables on sparse repertoires. Using partis’s germline set inference algorithm, we quantified the impact of six repertoire characteristics on sensitivity and specificity. We did so by plotting the fraction of alleles in the true repertoire that are missing from the inferred repertoire, and the fraction of spuriously-inferred alleles (that are not in the true repertoire), as a function of sample size for each variable (Figs <xref ref-type="fig" rid="pcbi.1007133.g001">1</xref> and <xref ref-type="fig" rid="pcbi.1007133.g002">2</xref>).</p>
<fig id="pcbi.1007133.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007133.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Fraction of true alleles missing (left) and alleles spuriously inferred (right) by partis on simplified “sparse” repertoires as a function of the number of sequences in the sample.</title>
<p>Each point represents the mean performance (± standard error) on 50 independent simulation samples of the indicated sample size varying the following variables. <bold>Top</bold>: SHM levels (the SHM distributions corresponding to “low”, “typical”, and “high” are shown in <xref ref-type="supplementary-material" rid="pcbi.1007133.s001">S1 Fig</xref>). <bold>Middle</bold>: new-allele prevalence (as a fraction of the existing allele’s prevalence). <bold>Bottom</bold>: number of SNPs (<italic>N</italic><sub>snp</sub>) separating new and existing alleles.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.g001" xlink:type="simple"/>
</fig>
<fig id="pcbi.1007133.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007133.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Fraction of true alleles missing (left) and alleles spuriously inferred (right) by partis on simplified “sparse” repertoires as a function of the number of sequences in the sample.</title>
<p>Each point represents the mean performance (± standard error) on 50 independent simulation samples of the indicated sample size varying the following variables. <bold>Top</bold>: <italic>N</italic><sub>snp</sub> with multiple new alleles, where, e.g. “1 + 3” indicates two new alleles, separated by 1 and 3 SNPs from the same existing allele. <bold>Middle</bold>: mean number of leaves per clonal family. <bold>Bottom</bold>: tree balance.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.g002" xlink:type="simple"/>
</fig>
<p>Increasing the rate of SHM makes inference more challenging (Figs <xref ref-type="fig" rid="pcbi.1007133.g001">1</xref> and <xref ref-type="fig" rid="pcbi.1007133.g002">2</xref>, top left, with the corresponding SHM distributions in <xref ref-type="supplementary-material" rid="pcbi.1007133.s001">S1 Fig</xref>). Because allele inference sensitivity is determined mainly by sequences with a small number of SHMs (specifically, a number comparable to the number of SNPs separating the new and existing alleles), raising SHM rates effectively reduces sample size.</p>
<p>Alleles that occur at low prevalence are more difficult to infer: as the fraction of sequences stemming from the new allele decreases, so does sensitivity (Figs <xref ref-type="fig" rid="pcbi.1007133.g001">1</xref> and <xref ref-type="fig" rid="pcbi.1007133.g002">2</xref>, top right).</p>
<p>The number of SNPs (<italic>N</italic><sub>snp</sub>) separating a new allele from its most similar known counterpart also affects the details of germline inference. We show performance for different <italic>N</italic><sub>snp</sub> for both a single new allele (Figs <xref ref-type="fig" rid="pcbi.1007133.g001">1</xref> and <xref ref-type="fig" rid="pcbi.1007133.g002">2</xref>, middle left) and for several combinations of multiple new alleles (Figs <xref ref-type="fig" rid="pcbi.1007133.g001">1</xref> and <xref ref-type="fig" rid="pcbi.1007133.g002">2</xref>, middle right). Sensitivity is independent of <italic>N</italic><sub>snp</sub> for smaller <italic>N</italic><sub>snp</sub> (three or less), and then decreases slightly with increasing <italic>N</italic><sub>snp</sub>. The presence of multiple new alleles, on the other hand, does not appreciably affect sensitivity as long as their SNPs do not occur at the same positions. Because the occurrence of multiple new alleles with the same SNP positions is rare in real data, we do not show results for this case. In many cases it is in fact possible to disentangle such alleles, but this depends on the details of each new allele’s prevalence and <italic>N</italic><sub>snp</sub>.</p>
<p>The shared mutations within a clonal family complicate allele inference because independent mutations are required for accurate fitting (see <xref ref-type="sec" rid="sec008">Methods</xref>). We find that increasing clonality effectively decreases sample size (Figs <xref ref-type="fig" rid="pcbi.1007133.g001">1</xref> and <xref ref-type="fig" rid="pcbi.1007133.g002">2</xref>, bottom left), rather than introducing the spurious alleles that would result from fitting with non-independent mutations. This indicates that our method of selecting a small number of sequences to represent each clonal family (see <xref ref-type="sec" rid="sec008">Methods</xref>) provides a sufficiently accurate method of choosing sequences with independent mutations.</p>
<p>We find that variations in phylogenetic tree shape do not greatly affect our method (Figs <xref ref-type="fig" rid="pcbi.1007133.g001">1</xref> and <xref ref-type="fig" rid="pcbi.1007133.g002">2</xref>, bottom right). We change tree shape by using the TreeSimGM package [<xref ref-type="bibr" rid="pcbi.1007133.ref037">37</xref>] to vary the shape parameter of a Weibull distribution controlling an age-dependent speciation process.</p>
<p>These single-variable results show that our method’s sensitivity is high enough to give useful results with the sample sizes and SHM rates characteristic of typical full-repertoire samples, and that it models repertoire details well enough that spurious alleles are rare. Note that TIgGER and IgDiscover are not shown on these sparse samples because both methods use hard-coded assumptions tailored to typical full repertoires that cause crashes on these sparse repertoires.</p>
<sec id="sec005">
<title>Full-repertoire samples</title>
<p>In the second validation stage, we show performance on a smaller number of large, realistic repertoires using partis (v0.14.0), TIgGER (v0.2.11), IgDiscover (v0.10), and annotation with the full IMGT set. All software was run with default parameters.</p>
<p>We split these full-repertoire samples among two difficulty levels: ten samples with more-uniform allele prevalence and low SHM, and ten samples with less-uniform allele prevalence and higher, typical SHM (details in <xref ref-type="sec" rid="sec008">Methods</xref>). All of these samples contain 50,000 sequences. Results with IgDiscover are shown only for the low-SHM samples, since IgDiscover is designed to work only on low-SHM IgM-specific data. We note that the IgDiscover manual recommends sample sizes of at least 750,000 sequences; it is unclear how this recommendation is derived, as IgDiscover shows good sensitivity on the smaller samples used here. We have also run tests on many other sample sizes, including much larger ones (results not shown), and the IgDiscover sensitivity behaves similarly to that of the other methods, in that it does not improve substantially. Indeed this is why we chose 50,000 for the full repertoire samples on which we report results—it is large enough that sample size does not hugely limit sensitivity, while still being typical of most real-world samples after error correction. While having more sequences certainly makes the germline inference problem easier, in this paper we attempt to quantify behavior on samples that are of a size more typical for most users.</p>
<p>We measure the influence of germline set accuracy on practical results in two ways: in terms of the actual genes and alleles inferred, and in terms of the resulting annotation accuracy. The former is more relevant to germline databases and studies of gene association, while the latter is of more concern when inferring and studying the function of ancestral sequences.</p>
<p>We find that the practice of aligning against the full IMGT set results in a very large number of spurious gene inferences, even on low-SHM samples (<xref ref-type="table" rid="pcbi.1007133.t001">Table 1</xref> and <xref ref-type="fig" rid="pcbi.1007133.g003">Fig 3</xref>). The three explicit germline inference methods, while all giving much smaller numbers of spurious genes, harbor significant differences. The partis-inferred missing and spurious alleles are found on relatively short branches compared to those of the other programs (Figs <xref ref-type="fig" rid="pcbi.1007133.g004">4</xref>, <xref ref-type="fig" rid="pcbi.1007133.g005">5</xref> and <xref ref-type="fig" rid="pcbi.1007133.g006">6</xref>). This results in partis’s significantly more accurate V naive inference (<xref ref-type="fig" rid="pcbi.1007133.g007">Fig 7</xref>). By considering the distribution of Hamming distances between true and inferred naive V sequences (<xref ref-type="fig" rid="pcbi.1007133.g007">Fig 7</xref>), we see that the relative inaccuracy of TIgGER and IgDiscover is driven by rare sequences that are assigned to genes that are very dissimilar to their true gene. We also note that TIgGER shows reduced sensitivity at typical SHM rates (<xref ref-type="fig" rid="pcbi.1007133.g005">Fig 5</xref> right), compared to low SHM rates (<xref ref-type="fig" rid="pcbi.1007133.g005">Fig 5</xref> left), in fact failing to infer any of the novel (non-IMGT) alleles at typical SHM rates. Additionally, both TIgGER and IgDiscover infer fewer spurious alleles, while also missing more true alleles, than partis. Finally, we note that the full IMGT method does surprisingly well in terms of naive sequence accuracy. This is because it aligns against a germline set that so densely populates the space of V genes that while it rarely gets the correct gene, it almost never has a gene that is very far from the correct one.</p>
<table-wrap id="pcbi.1007133.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007133.t001</object-id>
<label>Table 1</label>
<caption>
<title>Missing and spurious alleles on full-repertoire simulation for the three germline inference methods plus “full IMGT” annotation.</title>
</caption>
<alternatives>
<graphic id="pcbi.1007133.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="center" colspan="3">low SHM</th>
<th align="center" colspan="3">high SHM</th>
</tr>
<tr>
<th align="left"/>
<th align="center"># missing</th>
<th align="center"># spurious</th>
<th align="center"># correct</th>
<th align="center"># missing</th>
<th align="center"># spurious</th>
<th align="center"># correct</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">full IMGT</td>
<td align="center">5.0 ± 0.0</td>
<td align="center">53.2 ± 2.6</td>
<td align="center">50.3 ± 0.7</td>
<td align="center">5.0 ± 0.0</td>
<td align="center">86.2 ± 3.1</td>
<td align="center">51.5 ± 1.0</td>
</tr>
<tr>
<td align="left">IgDiscover</td>
<td align="center">3.2 ± 0.5</td>
<td align="center">0.2 ± 0.1</td>
<td align="center">52.1 ± 0.8</td>
<td align="center"/>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="left">TIgGER</td>
<td align="center">2.7 ± 0.3</td>
<td align="center">0.8 ± 0.2</td>
<td align="center">52.6 ± 0.6</td>
<td align="center">7.7 ± 0.3</td>
<td align="center">0.1 ± 0.1</td>
<td align="center">48.8 ± 1.0</td>
</tr>
<tr>
<td align="left">partis</td>
<td align="center">1.9 ± 0.3</td>
<td align="center">1.9 ± 0.4</td>
<td align="center">53.4 ± 0.9</td>
<td align="center">8.8 ± 0.5</td>
<td align="center">3.3 ± 0.4</td>
<td align="center">47.7 ± 0.7</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001">
<p>Results are the mean (± standard error) of ten independent 50,000-sequence samples for both low-SHM (left) and high-SHM (right). The columns are # <bold>missing</bold>: mean number of true alleles missing from the inferred germline set, # <bold>spurious</bold>: the number inferred that are not in the true germline set, and # <bold>correct</bold>: the number in common between the inferred and true germline sets. IgDiscover is shown for only the low-SHM samples, since it is designed only for IgM.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<fig id="pcbi.1007133.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007133.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Full-repertoire germline set accuracy for the currently widespread method of aligning every sequence to its closest match in the full IMGT V gene set.</title>
<p>The phylogenetic tree is constructed with a leaf for each germline gene in either the true or inferred germline sets (see <xref ref-type="sec" rid="sec008">Methods</xref>). Branch lengths connecting different V gene families are set to zero. Leaves are colored according to the similarity of the true and inferred germline sets, with shared genes in green and unshared in red, the latter broken into missing (light red) and spurious (dark red). Novel alleles (not in the IMGT database, whether from the true simulated set or spuriously inferred) are highlighted in gold. Shown on the first three replicates (0-2) of both the low-SHM (left), and high-SHM (right) full-repertoire simulation samples (see text).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.g003" xlink:type="simple"/>
</fig>
<fig id="pcbi.1007133.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007133.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Full-repertoire germline set accuracy for IgDiscover(explanation in <xref ref-type="fig" rid="pcbi.1007133.g003">Fig 3</xref>).</title>
<p>Shown on the first three replicates (0-2) of the low-SHM full-repertoire simulation samples. The high-SHM samples are not shown, since IgDiscover is designed only for low-SHM IgM samples (see text).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.g004" xlink:type="simple"/>
</fig>
<fig id="pcbi.1007133.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007133.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Full-repertoire germline set accuracy for TIgGER (explanation in <xref ref-type="fig" rid="pcbi.1007133.g003">Fig 3</xref>).</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.g005" xlink:type="simple"/>
</fig>
<fig id="pcbi.1007133.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007133.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Full-repertoire germline set accuracy for partis (explanation in <xref ref-type="fig" rid="pcbi.1007133.g003">Fig 3</xref>).</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.g006" xlink:type="simple"/>
</fig>
<fig id="pcbi.1007133.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007133.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Full-repertoire V naive accuracy (Hamming distance between true and inferred V naive sequences) for the three germline inference methods plus “full IMGT” annotation.</title>
<p>Results are the sum (figures, top) or mean (table, ± standard error) of ten independent 50,000-sequence samples for both low-SHM (left) and high-SHM (right). IgDiscover is shown for only the low-SHM samples, since it is designed only for IgM.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.g007" xlink:type="simple"/>
</fig>
<p>These simulation samples, together with true and inferred germline sets, are available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.1037463" xlink:type="simple">https://doi.org/10.5281/zenodo.1037463</ext-link>.</p>
</sec>
</sec>
<sec id="sec006">
<title>Results on real data</title>
<p>In order to evaluate performance on real data, it would be natural to deep sequence individuals for whom we also have accurate results from germline sequencing. Unfortunately, as described above, the difficulty of germline sequencing means that such samples are not readily available. We instead use two types of comparison that, while not definitive, provide some insight.</p>
<p>We first compare results from the different inference methods when run on the same sample, and find agreement on 70-90% of the total genes (Figs <xref ref-type="fig" rid="pcbi.1007133.g008">8</xref>, <xref ref-type="fig" rid="pcbi.1007133.g009">9</xref> and <xref ref-type="fig" rid="pcbi.1007133.g010">10</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007133.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007133.s003">S3</xref> Figs). While this is reassuring, some caution is advised, as the methods are far from uncorrelated (see Supplement). IgDiscover is shown only for IgM samples (<xref ref-type="fig" rid="pcbi.1007133.g010">Fig 10</xref>, and non-IgM samples with very low SHM rates (<xref ref-type="fig" rid="pcbi.1007133.g008">Fig 8</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007133.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007133.s003">S3</xref> Figs). Also of note is the large cluster of closely-related novel alleles inferred only by TIgGER in the IgM data from subject lp23810 [<xref ref-type="bibr" rid="pcbi.1007133.ref036">36</xref>] (Figs <xref ref-type="fig" rid="pcbi.1007133.g010">10</xref> and <xref ref-type="fig" rid="pcbi.1007133.g012">12</xref>). Careful examination of these results shows instances in which the different methods disagree, for instance as to the heterozygosity of the IGHV1-46 gene in <xref ref-type="supplementary-material" rid="pcbi.1007133.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007133.s009">S9</xref> Figs, where TIgGER and IgDiscover infer both alleles but partis infers just one. It is possible that some of these differences stem from the different ways in which the methods treat allelic variation at different positions within the gene.</p>
<fig id="pcbi.1007133.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007133.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Comparison of all three inference methods on the healthy donor samples from [<xref ref-type="bibr" rid="pcbi.1007133.ref034">34</xref>] (other subjects shown in <xref ref-type="supplementary-material" rid="pcbi.1007133.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007133.s003">S3</xref> Figs).</title>
<p>The phylogenetic tree is constructed with a leaf for each germline gene that was inferred by any of the methods. Branch lengths connecting different V gene families are set to zero. Leaves are colored according to how many methods inferred the corresponding gene: one (green, red, blue), two (grey), or all three (white). The same trees, but with leaves labeled with gene names, are shown in <xref ref-type="supplementary-material" rid="pcbi.1007133.s004">S4 Fig</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.g008" xlink:type="simple"/>
</fig>
<fig id="pcbi.1007133.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007133.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Comparison of germline sets inferred by partis and TIgGER for subjects FV, GMC, and IB from [<xref ref-type="bibr" rid="pcbi.1007133.ref035">35</xref>], with all ten time points merged for each subject.</title>
<p>The phylogenetic tree is constructed with a leaf for each germline gene that was inferred by either of the two methods. Branch lengths connecting different V gene families are set to zero. Leaves are colored according to how many methods inferred the corresponding gene: either one (red, blue) or both (white). Since this data is not IgM specific, IgDiscover is not shown. Includes the three time points in <xref ref-type="fig" rid="pcbi.1007133.g011">Fig 11</xref>, plus seven more, for each subject. The same trees, but with leaves labeled with gene names, are shown in <xref ref-type="supplementary-material" rid="pcbi.1007133.s005">S5 Fig</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.g009" xlink:type="simple"/>
</fig>
<fig id="pcbi.1007133.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007133.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Comparison of the three methods on IgM data from subjects lp08248 (left) and lp23810 (right) from [<xref ref-type="bibr" rid="pcbi.1007133.ref036">36</xref>].</title>
<p>The phylogenetic tree is constructed with a leaf for each germline gene that was inferred by any of the methods. Branch lengths connecting different V gene families are set to zero. Leaves are colored according to how many methods inferred the corresponding gene: one (green, red, blue), two (grey), or all three (white). See <xref ref-type="fig" rid="pcbi.1007133.g012">Fig 12</xref> for other results for these subjects. The same trees, but with leaves labeled with gene names, are shown in <xref ref-type="supplementary-material" rid="pcbi.1007133.s006">S6 Fig</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.g010" xlink:type="simple"/>
</fig>
<p>We next compare the results of each inference method on several different samples from the same individual. We find a similar overall level of agreement both when comparing samples from different time points (<xref ref-type="fig" rid="pcbi.1007133.g011">Fig 11</xref>), and of different isotypes (<xref ref-type="fig" rid="pcbi.1007133.g012">Fig 12</xref>). These comparisons give some idea of each method’s uncertainty because, while the physical germline genes are in each case identical, the SHM rates, gene expression levels, and clonal family structure vary significantly with both time and isotype.</p>
<fig id="pcbi.1007133.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007133.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Comparison of inferred germline sets for samples taken at different time points for subjects FV, GMC, and IB from [<xref ref-type="bibr" rid="pcbi.1007133.ref035">35</xref>].</title>
<p>Shown for three (of ten total) time points surrounding influenza vaccination: two days before, three days after, and seven days after; for partis (top) and TIgGER (bottom). The phylogenetic tree is constructed with a leaf for each germline gene that was inferred at any of the three time points. Branch lengths connecting different V gene families are set to zero. Leaves are colored according to the number of time points at which the corresponding gene was inferred: one (dark grey), two (light grey), or all three (white). Since this data is not IgM specific, IgDiscover is not shown. See <xref ref-type="fig" rid="pcbi.1007133.g009">Fig 9</xref> for other results for these subjects. The same trees, but with leaves labeled with gene names, are shown in <xref ref-type="supplementary-material" rid="pcbi.1007133.s007">S7 Fig</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.g011" xlink:type="simple"/>
</fig>
<fig id="pcbi.1007133.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007133.g012</object-id>
<label>Fig 12</label>
<caption>
<title>Comparison of inferred germline sets for IgM vs IgG data from subjects lp08248 and lp23810 from [<xref ref-type="bibr" rid="pcbi.1007133.ref036">36</xref>] for partis (left) and TIgGER (right).</title>
<p>The phylogenetic tree is constructed with a leaf for each germline gene that was inferred for either of the two isotypes. Branch lengths connecting different V gene families are set to zero. Leaves are colored according to the number of isotype-specific samples for which the corresponding gene was inferred: either one (grey) or both (white). See <xref ref-type="fig" rid="pcbi.1007133.g010">Fig 10</xref> for other results for these subjects. The same trees, but with leaves labeled with gene names, are shown in <xref ref-type="supplementary-material" rid="pcbi.1007133.s008">S8 Fig</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.g012" xlink:type="simple"/>
</fig>
<p>We also use the partis-inferred germline sets to make an estimate of the number of genes that are expressed at levels too low for us to detect. Previous work has reported a range of values for the total number of functional V genes per individual. One study [<xref ref-type="bibr" rid="pcbi.1007133.ref009">9</xref>] reported 43 full-length functional V genes (plus 1 truncated) for a single haplotype, while another [<xref ref-type="bibr" rid="pcbi.1007133.ref038">38</xref>] reported a range of 38-46 per haplotype. In order to convert these per-haplotype totals to per-diplotype totals, we calculate the mean fraction of alleles shared between the inferred germline sets from two unrelated individuals. For the sequencing data in this paper, this mean overlap is 67% (range 50-85%). This suggests that to go from per-haplotype to per-diplotype totals we multiply by 1 + (1 − 0.67), which yields per-diplotype estimates of 57 for [<xref ref-type="bibr" rid="pcbi.1007133.ref009">9</xref>] and 51-61 for [<xref ref-type="bibr" rid="pcbi.1007133.ref038">38</xref>]. These values, both for total genes and for the fraction of genes shared between unrelated parental haplotypes, roughly agree with two other studies that found 35-46 per haplotype and 39-55 per diplotype [<xref ref-type="bibr" rid="pcbi.1007133.ref008">8</xref>], and 45-60 per diplotype with a mean alleles per gene of 1.2 [<xref ref-type="bibr" rid="pcbi.1007133.ref007">7</xref>]. The mean total number of partis-inferred V genes observed in individuals in this paper, meanwhile, is 47 (range 38-62). This suggests that the sample sizes, clonal family structures, mutation rates, and expression levels, together with our method’s sensitivity, result in a failure to detect about 0 to 10 genes per individual. We have not accounted for spuriously-inferred alleles in this calculation because our validation results suggest that when partis does infer spurious alleles, each simply replaces a very similar true allele, and thus does not have an appreciable net effect.</p>
<p>A summary of the data samples used is shown in <xref ref-type="supplementary-material" rid="pcbi.1007133.s011">S1 Table</xref>, and of the number of sequences in each sample in <xref ref-type="supplementary-material" rid="pcbi.1007133.s012">S2 Table</xref>. We obtained all of these samples in a preprocessed state, i.e. error correction, pair merging, etc. had been performed by the authors of the original studies, as described in the source papers. The FASTA files for each inferred germline set, together with the various output files for each method, are available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.1037463" xlink:type="simple">https://doi.org/10.5281/zenodo.1037463</ext-link>. For partis, these files include numbers of sequences assigned to each gene and fit quality plots. We have made the command-line script used to make phylogenetic comparison plots available for general application at <ext-link ext-link-type="uri" xlink:href="https://git.io/vFo2B" xlink:type="simple">https://git.io/vFo2B</ext-link>.</p>
</sec>
</sec>
<sec id="sec007" sec-type="conclusions">
<title>Discussion</title>
<p>We have developed a practical new tool for inferring per-sample immunoglobulin germline gene sets, and performed extensive validation and comparison against existing tools. Our tool is implemented in the existing partis annotation and clonal family inference package. We have shown that in simulation the currently widespread practice of aligning expressed BCR samples against the full IMGT germline set results in both large numbers of spurious alleles and inaccurately inferred naive ancestors. We next showed that on simulation our method infers significantly more accurate germline sets than the existing TIgGER and IgDiscover methods in terms of both inferred gene similarity and naive ancestor inference, but of similar accuracy in terms of raw number of genes. We then compared germline sets inferred by the three methods on a variety of real data samples, which showed generally similar features (e.g. germline set structure and level of disagreement between methods) to those in simulation. Together, these results comprise the first comparison of any germline inference methods, and thus provide users with a valuable baseline for expected accuracy, while also demonstrating the inaccuracy of the widespread method of aligning against the entire IMGT set.</p>
<p>Combining the results presented here into a rough rule of thumb, our method can be expected to infer germline sets to roughly 80-90% accuracy (including both missing and spurious alleles) on samples with typical repertoire properties (such as SHM levels and clonal family structure) of at least tens of thousands of reads.</p>
<p>All results shown in this paper are for heavy chain sequences; however we can also recommend partis for light chain use by considering the following differences inherent to light chain sequences. Light chain germline sets differ primarily in having a significantly different total number of genes, and a much longer section of V gene to 3’ of the conserved cysteine. Our method’s studiously agnostic approach to prior information on germline set structure is well suited to the former, and our algorithm for excluding frequently-deleted bases deals gracefully with the latter. Additionally, light chain repertoires have much lower diversity. This means that for a given total sample size, the number of independent rearrangements, and thus the effective sample size for the purposes of germline inference, will be smaller. Light chain samples also typically have lower SHM rates, which increases the effective sample size, somewhat ameliorating the previous effect. In a number of simulation studies, and in running on many real light chain samples (neither result shown here), these relatively minor differences appear to be well modeled such that the method behaves very similarly on heavy and light chain repertoires.</p>
<p>While our method has reached a level of maturity such that it is now run by default in the partis annotation and clonal family inference procedures, it has a number of weaknesses. First, as with the rest of partis, it assumes that all corrections for sequencing error have been performed before input. Second, our piecewise-linear model for the mutation accumulation plots (see <xref ref-type="sec" rid="sec008">Methods</xref>) is only an approximation of the real behavior. Thus, while we have designed our method with the aim of maximizing robustness against atypical repertoires, a more complex model that more closely modeled the repertoire’s nonlinearities would provide better performance.</p>
<p>We also do not currently apply a prior or constraints on the structure of each sample’s germline set. This is because only a small number of individuals have currently been the subject of germline sequencing, so any such priors would be only marginally informative compared to the per-subject inference. One result of this is that our method underestimates the number of germline V genes on smaller samples (less than roughly a few thousand sequences). Another consequence is that our method can infer very unlikely numbers of alleles per gene. In general one would expect one or two alleles per gene in real germlines, however current data is insufficient to accurately quantify how much this distribution is broadened by the deletion and duplication common in the Ig locus. This means that the missing and spurious alleles that our method infers occur without regard to the number of alleles per gene, such that in rare cases the method infers unrealistically small or large numbers. With more information on the variation of germline sets across populations, we will be able to more intelligently restrict these numbers.</p>
<p>Another source for improved performance would be the incorporation of per-base mutation information, i.e. splitting apart the mutation accumulation plots by A, C, G, and T. Also, we have thus far only applied our method to V region genes, although the extension to D and J should be conceptually straightforward. We also at this point only report the most likely germline set, with no probabilistic guidance as to the likelihood of other possible germline sets (although some idea of uncertainty can be gleaned from the fits and goodness of fit metrics). This is an unfortunate consequence of the intricacies of the optimizations necessary to make the method usefully fast, together with the lack of good information about the variation of the Ig locus between individuals. Finally, taking advantage of the fact that rearrangement occurs only between genes on the same chromosome, as in [<xref ref-type="bibr" rid="pcbi.1007133.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1007133.ref033">33</xref>], would likely provide additional improvement.</p>
<p>A further limitation of our method is that it looks only for new alleles separated by SNPs from existing alleles, and not for those separated by insertion/deletion events. While this is not a significant limitation on human samples, the IMGT germline sets for other species are incomplete enough that, in those species, this could cause novel alleles to be misinterpreted as SHM indels. This is one respect in which the clustering-based approach taken by IgDiscover offers a significant advantage (see Supplement). For this reason we have also implemented a non-default clustering-based method which can be run in addition to the purely mutation accumulation plot-based method described here (see Manual). While we thus recommend this clustering-based method for non-human samples, its robustness, like IgDiscover’s, can suffer on some highly-mutated samples, so we have left it as a non-default option pending future improvements.</p>
</sec>
<sec id="sec008" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec009">
<title>Overview</title>
<p>The task of inferring germline genes consists largely of learning to distinguish between positions that are highly mutated as a result of SHM, and those whose highly-mutated appearance stems from the occurrence of previously unknown alleles. A few key observations allow us to extract enough information to make this distinction. First, in the absence of unknown alleles, the probability of a mutation at each position in an observed sequence is roughly proportional to the total number of mutations in that sequence (at least at the low SHM levels relevant for new-allele inference). In other words, while mutation rates differ dramatically from position to position according to, for instance, hot and cold spot motifs, each position is more likely to be mutated in sequences that have been subject to higher levels of SHM. Almost all of the power to infer new germline sequences comes from the low-SHM sequences in the sample, and for those sequences the hotness or coldness of most positions will not change upon introduction of the first few mutations. In the presence of unknown alleles, on the other hand, sequences stemming from these unknown alleles will be mistakenly assigned to the most similar known allele, causing this approximate proportionality to be violated. If there are, say, <italic>N</italic><sub>snp</sub> SNPs separating a known and unknown allele, then there will be very few sequences from this unknown allele that appear to have fewer than <italic>N</italic><sub>snp</sub> mutations. The <italic>N</italic><sub>snp</sub> positions at which they differ, on the other hand, will almost always appear to be mutated in sequences that appear to contain <italic>N</italic><sub>snp</sub> or more total mutations. This differing apparent mutational behavior between sequences with fewer than, as compared to more than, <italic>N</italic><sub>snp</sub> mutations provides the basis for our method.</p>
<p>A convenient way to visualize these observations is with a type of plot introduced in [<xref ref-type="bibr" rid="pcbi.1007133.ref011">11</xref>], which we call a “mutation accumulation” plot. To make a set of these plots for one germline gene, we first collect every sequence in the sample that aligns most closely to this single known gene. We then use these sequences to make one plot for each nucleotide position as follows. The sequences are binned along the x-axis according to their total number of apparent V mutations. The y-coordinate of each bin, meanwhile, is the frequency with which that plot’s nucleotide position appears to mutate among the sequences in the bin. For the full repertoire, we first group sequences based on their closest known germline gene, and then follow the procedure above for each such group. We first show example plots for three simple, hypothetical repertoires (<xref ref-type="fig" rid="pcbi.1007133.g013">Fig 13</xref>). While these simple repertoires, by themselves, are gross simplifications of the biological complexity in a real BCR repertoire, they contain the essential elements from which we can construct a method that performs well on real data sets.</p>
<fig id="pcbi.1007133.g013" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007133.g013</object-id>
<label>Fig 13</label>
<caption>
<title>Mutation accumulation plots showing the relationship between the mutation probability at position 55 across all sequences aligning closest to IGHV4-39*06 (y-axis), and the number of mutations in the entire observed V sequence (x-axis) for three simple, hypothetical BCR repertoires.</title>
<p>In the top row are two repertoires that consist of a single allele: where this allele is known (left), and where it is unknown, but separated by seven SNPs from a known allele (right). In a more typical case, given the relative completeness of the standard germline sets, we would observe a mixture of sequences from the known and unknown alleles (bottom). This is equivalent to the (shifted) superposition of the two plots in the top row.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.g013" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec010">
<title>Models and fitting</title>
<p>In the context of mutation accumulation plots (<xref ref-type="fig" rid="pcbi.1007133.g013">Fig 13</xref>), the presence of new alleles is signaled by a departure from what would be expected if all sequences had been assigned to the correct true gene. Namely, to the extent that mutations at each site accumulate in proportion to the total number of mutations in the sequence, correct assignment would result in simple linearity. For incorrect assignment, this linearity is replaced with differing behavior between the regions below and above <italic>N</italic><sub>snp</sub>. Our task, then, amounts to distinguishing between plots that can be adequately described by a one-piece linear model, and those that require a model consisting of two pieces separated by a discontinuity.</p>
<p>In order to distinguish these two hypotheses, we construct a model for each. The one-piece model is simply a linear fit constrained to pass through the origin. The two-piece model, meanwhile, consists of two separate linear fits, which we call the “lower” (below <italic>N</italic><sub>snp</sub>) and “upper” (above <italic>N</italic><sub>snp</sub>) fits. The lower fit is constrained to pass through the origin, while the upper fit’s y-intercept must be near the average of the upper-region mutation frequencies (within 1.5 standard deviations of their mean). The junction between the two pieces must harbor a significant discontinuity in either bin value (mutation frequency) or bin total (number of sequences per bin), where significance is defined as a difference of more than 2.5 times the larger uncertainty. This two-piece model describes the presence of a new allele separated by <italic>N</italic><sub>snp</sub> SNPs from the original known gene. To give a general idea of the implementation, several examples are shown in <xref ref-type="fig" rid="pcbi.1007133.g014">Fig 14</xref>.</p>
<fig id="pcbi.1007133.g014" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007133.g014</object-id>
<label>Fig 14</label>
<caption>
<title>Example one-piece (green) and two-piece (red) fits for positions without (top row) and with (bottom row) evidence for new alleles.</title>
<p>The left and right plots in the top row show the difference between positions with low and high mutability (cold and hot spots). The bottom row shows a position with evidence for a new allele with <italic>N</italic><sub>snp</sub> equal to two (left) and a similar plot for <italic>N</italic><sub>snp</sub> equals five (right). Note that both one-piece and two-piece models fit well in the top row, whereas in the bottom row only the two-piece model provides an adequate fit.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.g014" xlink:type="simple"/>
</fig>
<p>We use a ratio of error descriptors to determine whether a plot is adequately described by the one-piece fit. Define <italic>ϵ</italic> to be the sum of squared residuals divided by degrees of freedom, which in regression analysis is sometimes called the mean squared error. Good fits are characterized by values of <italic>ϵ</italic> around one, while values much greater than one indicate poor fits. Values significantly less than one generally indicate poorly-estimated uncertainties. For our purposes, then, we are interested in positions (which we call “candidate positions”) for which <italic>ϵ</italic> is large for the one-piece fit (greater than 4.5) but around one (less than 1.95) for the two-piece fit.</p>
<p>For each <italic>N</italic><sub>snp</sub>, we construct the most plausible potential new allele by finding the <italic>N</italic><sub>snp</sub> positions that have the worst one-piece, but best two-piece, fits. We quantify this using the ratio of the two <italic>ϵ</italic>,
<disp-formula id="pcbi.1007133.e001"><alternatives><graphic id="pcbi.1007133.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007133.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>r</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>ϵ</mml:mi> <mml:mtext>1-piece</mml:mtext></mml:msub> <mml:msub><mml:mi>ϵ</mml:mi> <mml:mtext>2-piece</mml:mtext></mml:msub></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula></p>
<p>Because cases that would be better described by more complex models will have larger residuals (poor fits) for both one-piece and two-piece models, which cancel out in the ratio, this formulation provides robustness to deviations from linearity. The model for the best potential new allele consists of the <italic>N</italic><sub>snp</sub> positions that have the largest values of <italic>r</italic>.</p>
<p>In order to strike an appropriate balance between focusing the fit’s attention on the area of the discontinuity, while taking advantage of the largest possible sample size from many surrounding bins, we perform all fits in a window of width 10 bins. This window begins at zero for small <italic>N</italic><sub>snp</sub>, while for larger <italic>N</italic><sub>snp</sub> it is symmetric around <italic>N</italic><sub>snp</sub>.</p>
<p>We apply several additional criteria to ensure that the candidate fits make a compelling case for a new allele. The slope at the discontinuity, i.e. the slope defined by the two points on either side, must be much larger than both the upper and lower fitted slopes (a fractional difference of more than 2.5 times). For larger <italic>N</italic><sub>snp</sub> (five or more), the slopes before and after the discontinuity must also either be consistent, or the lower slope must be the smaller of the two.</p>
<p>The unfortunate profusion of constant values in the preceding paragraphs deserves some examination. In general, for the sake of simplicity and interpretability, we have wherever possible minimized the number of such constants. However, practical constraints make it difficult to reduce their number further. In theory, it would be possible to construct a more complicated model that faithfully recreated all the details of the real system, which would enable a collection of simple likelihood ratio tests. However, in practice this approach is unlikely to be computationally feasible, and would likely require a much lengthier development process. Instead, we have adopted the approach of comprehensively validating a simpler model which, nevertheless, provides an adequate description of the system’s real biological complexity.</p>
</sec>
<sec id="sec011">
<title>Comparing multiple hypotheses</title>
<p>The previous section outlines a procedure for identifying a single potential new allele for each individual <italic>N</italic><sub>snp</sub>. In realistic samples, however, we must treat the general case where there may be several new alleles, either with the same <italic>N</italic><sub>snp</sub>, or spread among several <italic>N</italic><sub>snp</sub>.</p>
<p>To do this, we first sort every candidate position within each <italic>N</italic><sub>snp</sub> by decreasing <italic>r</italic>. In order to better adjudicate between ties in the first sort, we then sort again either by decreasing y-intercept (if <italic>N</italic><sub>snp</sub> less than three) or decreasing two-piece fit <italic>ϵ</italic>. The first <italic>N</italic><sub>snp</sub> elements of this sorted list of candidate positions are then taken as a candidate allele, the next <italic>N</italic><sub>snp</sub> positions are taken as a second candidate allele, and so on, until fewer than <italic>N</italic><sub>snp</sub> remain. The second sorting step serves to group together positions with similar fit properties, and that are thus most likely to come from the same new allele. These fit properties are affected by several aspects of the new alleles, most notably their prevalence. In cases with two new alleles with the same prevalence, for example, this is not an effective means of determining which positions go with which allele; however, in real data such cases are very rare.</p>
<p>For each of these candidate alleles, both the smallest <italic>r</italic> among their positions, and the mean, must be greater than 2.75. The discontinuities for every pair of positions must also be compatible, defined as the difference in bin totals (number of sequences) on either side of <italic>N</italic><sub>snp</sub>, which must be closer than three times the maximum of their two uncertainties.</p>
<p>This procedure is repeated for each <italic>N</italic><sub>snp</sub>, resulting in a list of candidate alleles from each; these lists are then merged into a final list that is sorted by decreasing <italic>N</italic><sub>snp</sub>. We then go through this list and discard alleles that share any positions with an allele earlier in the list. This last sorting is due to the fact that it is easier for a high-<italic>N</italic><sub>snp</sub> allele to mimic a low-<italic>N</italic><sub>snp</sub> allele than the reverse.</p>
</sec>
<sec id="sec012">
<title>Approximations and pre-filters</title>
<p>The procedure described above would work well in principle, but would require a computationally prohibitive number of fits. As a rough estimate, taking 50 initial, known alleles in a sample, each with 300 positions, looking up through <italic>N</italic><sub>snp</sub> equals eight, and with both the one-piece and two-piece fits, we would need 360,000 individual linear fits. To be useful, however, it must run as part of the overall partis annotation, which takes only minutes on samples with tens of thousands of sequences. Luckily, the overwhelming majority of these fits can be avoided by ignoring uninteresting positions using a number of approximation procedures. The cumulative effect of the following approximations and filters is that a typical run requires of order 100 fits, with no appreciable decrease in precision or sensitivity. This results in a method that does not add significant run time to an existing partis run.</p>
<p>The first step is to ignore positions for which there would not be enough statistical power to have any sensitivity to new alleles. We thus skip positions with fewer than 150 total observed sequences, summed over bins. Positions with fewer than 30 observed mutations, also summed over bins, are similarly skipped.</p>
<p>For each <italic>N</italic><sub>snp</sub>, we also ignore positions that do not have at least eight observed mutations in the <italic>N</italic><sub>snp</sub><sup>th</sup> bin. This bin is of primary importance, because it is the means by which we determine that this <italic>N</italic><sub>snp</sub> is the correct one, rather than those slightly larger or smaller. If this bin is truly signaling a new allele, then it must contain a significant number of mutated sequences.</p>
<p>For several of the subsequent steps, we use an approximate fitting procedure to arrive at a slope, intercept, and associated uncertainties. While less accurate, and more heuristic, than the least-squares fits that are used elsewhere, it is also much faster. We begin by calculating the two-point slope between each pair of adjacent points. If there are only two points in total, this is supplemented by a “synthetic” slope between the first point shifted up, and the second shifted down, by their respective uncertainties. The approximate slope is then calculated as the mean of these pairwise slopes, with its uncertainty the associated standard error. We arrive at the approximate y-intercept with a similar procedure, except that the pairwise slope is replaced by the pairwise y-intercept, which uses the previously-calculated pairwise slope.</p>
<p>For smaller <italic>N</italic><sub>snp</sub> (three or less), we also require that the approximate upper-region y-intercept fit bounds do not include zero. If they do include zero, there will not be a significant difference between the one- and two-piece fits. As an additional, and more stringent, test that the upper-region y-intercept for these smaller <italic>N</italic><sub>snp</sub> is well above zero, we require that the approximate fit’s y-intercept is also greater than zero.</p>
<p>For <italic>N</italic><sub>snp</sub> equals two, we also require that the bin immediately before the <italic>N</italic><sub>snp</sub><sup>th</sup> bin be outside of the upper-region y-intercept fit bounds.</p>
<p>And finally, for larger <italic>N</italic><sub>snp</sub> (five or greater), the approximate lower fit’s slope must be less than that of the approximate upper fit, in cases in which they are inconsistent.</p>
</sec>
<sec id="sec013">
<title>Initial germline database</title>
<p>To construct the initial germline database, we begin by taking the functional V, D, and J genes from the IMGT database. We then also remove non-full length V sequences.</p>
</sec>
<sec id="sec014">
<title>Excluded bases on 5’ and 3’ ends</title>
<p>We are typically analyzing only partial V sequences, which leads to additional complications. On the 5’ end, the method must account for samples in which the read does not extend through the entire V gene. On the 3’ end, meanwhile, VDJ rearrangement itself deletes some number of bases. The presence of incomplete V sequences clearly reduces our sensitivity to new alleles simply by reducing the sample size for positions at each end. A more serious problem, however, is that differing lengths cause sequences to be assigned to incorrect bins, since their apparent number of mutations is different than their true number. In order to avoid this problem, we ensure that all analyzed sequences begin and end at the same aligned germline bases. To accomplish this, for each end (5’ and 3’), we find the deletion length such that only a small fraction (<italic>f</italic>, by default 0.01) of sequences have a longer deletion length. We then exclude the fraction <italic>f</italic> of sequences that have longer deletions. Among the remaining sequences, we then exclude from the analysis the positions that fall within these deletion lengths. For example, if 99% of sequences have 3’ deletions of four or fewer bases, then we would discard sequences with more than four 3’-deleted bases, and would not use that gene’s four most-3’ positions in the fitting procedure. Note that on the 3’ side of V, this exclusion procedure is especially important because the final few germline-aligned positions next to any non-templated insertion always have very poorly-measured mutation frequencies.</p>
</sec>
<sec id="sec015">
<title>Collapsing clones</title>
<p>Our method requires that we consider only independent mutation events, excluding any mutations that share a common ancestry. In order to satisfy this requirement we attempt to select from each clone the largest possible set of sequences without shared mutations. In doing this, we give preference to relatively unmutated sequences, since most new alleles are separated by only a few SNPs from known alleles. Specifically, we sort the sequences from each clonal family in order of increasing apparent V mutation. We then traverse this list, selecting each sequence that does not share any mutations with a previously-selected sequence. As shown in [<xref ref-type="bibr" rid="pcbi.1007133.ref039">39</xref>] it would be straightforward to use the full partis method to separate the sequences into clonal families. However, for the purposes of ensuring independent mutations, there is little benefit to having precisely accurate clusters, since a slightly inaccurate clustering only results in slightly inaccurate uncertainties in the fits, and uncertainties on uncertainties are in practice never large enough to impact the analysis. For the sake of speed, then, we simply cluster using inferred naive sequences, i.e. every sequence that is inferred to have the same naive sequence is clustered together. This has the additional benefit of becoming more conservative as the sample size becomes large—in other words it tends to over-cluster more as the space of potential naive rearrangements fills up, and nearby rearrangement events have very similar naive sequences. This has the effect of sacrificing some sensitivity in order to ensure that mutations are actually independent.</p>
</sec>
<sec id="sec016">
<title>Initial removal of less-likely alleles</title>
<p>Some care is necessary when constructing each sample’s initial set of known genes. We find the performance of our new-allele inference to be robust enough that the best approach is to first choose a minimal number of genes whose presence in the sample is supported by very strong evidence. We then apply the new-allele inference framework in order to reinstate alleles for which the evidence was less overwhelming, along with any novel alleles.</p>
<p>In order to construct each sample’s minimal initial gene set, we first partition the complete set of IMGT [<xref ref-type="bibr" rid="pcbi.1007133.ref001">1</xref>] genes into groups within which SHM can easily cause confusion, and then retain only the most common gene in each group. Note that this partitioning cannot be accomplished using only the IMGT names—there are many cases of allelic variants that differ by so many SNPs that confusion is very unlikely, as well as alleles of separate genes that differ by only a single SNP. We construct these groups by single-linkage clustering such that genes with the same conserved cysteine position, and separated by fewer than eight SNPs, are grouped together. In order to ensure that we can re-infer all of the genes within each group, this number corresponds to the maximum number of SNPs for new-allele inference.</p>
<p>We also discard alleles that appear to occur at extremely low frequencies, by default less than one part in 2000.</p>
</sec>
<sec id="sec017">
<title>Template allele removal</title>
<p>The procedure outlined thus far can yield a confident judgment on whether there exists a previously-unknown allele separated from some known, “template” allele. We must also, however, distinguish between cases where this template allele is also present in the sample, and cases where it is not (and was simply the closest known allele). In order to do this we observe that in the plots in <xref ref-type="fig" rid="pcbi.1007133.g014">Fig 14</xref> the y-intercept of the upper (post-<italic>N</italic><sub>snp</sub>) fit is determined largely by the prevalence of the new allele. For <italic>N</italic><sub>snp</sub> near one, the y-value is very close to the actual allele prevalence, while for larger <italic>N</italic><sub>snp</sub> the relationship is more complex. When the new allele’s prevalence is 1, i.e. the template allele is not present in the sample, however, the fitted post-<italic>N</italic><sub>snp</sub> y-value is also very close to 1. The only deviation is a slight decreasing slope from reversion to germline at higher mutation levels. We thus remove template genes from the germline set when the upper fits for each position have y-intercept 1.1 ± 0.12 and slope −0.01 ± 0.015.</p>
</sec>
<sec id="sec018">
<title>Adding a new allele</title>
<p>Once we have decided that there is sufficient evidence for a new allele separated by <italic>N</italic><sub>snp</sub> SNPs from an existing allele, there remain several additional considerations.</p>
<p>First, we must determine its original germline sequence. We begin by restricting ourselves to sequences assigned to the <italic>N</italic><sub>snp</sub><sup>th</sup> bin, i.e. which contain <italic>N</italic><sub>snp</sub> apparent mutations. This restriction is important, because unmutated sequences stemming from the new allele are assigned to this bin. It thus minimizes the confusion caused by mutated sequences derived from the existing allele, as well as from any additional new alleles. For each of the <italic>N</italic><sub>snp</sub> positions where this allele differs from the template allele, we then choose as the new allele’s germline nucleotide the most commonly-observed non-template nucleotide at that position.</p>
<p>If the newly-identified allele was present in the original, full germline set, then we add it with its original name; otherwise we add it with a provisional name derived from the template gene. Because of the unavoidable ambiguity created by 3’ exonuclease deletion (and short reads), in order to be considered equivalent we require only that two alleles are identical after applying the 5’ and 3’ exclusions described above. If, for instance, we infer a new allele that differs by several SNPs from some template gene, and there is an existing allele in the original set that is identical to this new allele except for an extra base to the 3’ of the cysteine, we assume that the newly-inferred and existing alleles are in fact the same. More generally, we note that any new-allele inference framework that uses expressed data will suffer from a large uncertainty as to the precise number and identity of a V gene’s most-3’ few germline bases. In order to resolve this uncertainty we must perform germline sequencing.</p>
</sec>
<sec id="sec019">
<title>Simulation details</title>
<p>The simulated samples used for validation were made with the same basic framework described in [<xref ref-type="bibr" rid="pcbi.1007133.ref004">4</xref>]. In addition to the details described there, we have added options to control various aspects of a sample’s germline set. All simulation options are described in detail in the manual (<ext-link ext-link-type="uri" xlink:href="https://git.io/fAZ28" xlink:type="simple">https://git.io/fAZ28</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://git.io/fAZ2E" xlink:type="simple">https://git.io/fAZ2E</ext-link>).</p>
<p>Most basically, we have added the ability to insert into a germline set new alleles that are separated from existing alleles by both point and insertion/deletion mutations. The number of each type of mutation, and their properties, are specified with command line options. Each mutation occurs either at a specified position in the allele’s sequence, or at a random position within specified bounds (for instance, within vs outside of the CDR3). These options allowed the creation of the simplified sparse gene repertoire samples in the Results.</p>
<p>These sparse repertoires are built around a single known germline gene. We then add either one or two novel alleles, separated by SNPs at uniformly-selected random positions, from this existing germline gene.</p>
<p>In order to generate a germline set for the full repertoire samples, for each region we first choose some number of genes from the IMGT set, and then some number of alleles for each of these genes. The mean number of alleles per gene is specified on the command line, then for each gene we choose a number of alleles from {1, 2} with weights such as to (on average) arrive at the specified mean over all genes. For both the “low-SHM” and “high-SHM” full-repertoire samples, this procedure was followed with 42, 22, and 6 genes (V, D, and J regions), with a mean alleles per gene of 1.33, 1.1, and 1 (V, D, and J). This is concordant with the references in Results above, in particular [<xref ref-type="bibr" rid="pcbi.1007133.ref007">7</xref>], which reported a mean over 12 individuals of 40.2 homozygous, 8.6 two-allele heterozygous, and 1.1 three-allele heterozygous V genes, for an overall mean alleles per gene of 1.2. Six novel alleles were then added, separated by 1, 1, 2, 3, 5, and 6 point mutations (at uniformly-selected random positions) from an existing allele.</p>
<p>We choose each gene’s relative prevalence counts from a uniform random distribution with bounds [1, 1/<italic>f</italic><sub>min</sub>], where <italic>f</italic><sub>min</sub> is the minimum desired prevalence ratio between any pair of genes in the repertoire. This ensures that the prevalence ratio for every pair of genes in the repertoire is in [<italic>f</italic><sub>min</sub>, 1], where <italic>f</italic><sub>min</sub> equals 0.15 (“low-SHM” samples) or 0.05 (“high-SHM” samples). While this is roughly compatible with the variation in expression levels typically reported in real data, we emphasize that most previous studies (including our own [<xref ref-type="bibr" rid="pcbi.1007133.ref004">4</xref>]) have aligned against the full IMGT set, and as such their reported expression levels for less-common genes are probably meaningless (<xref ref-type="table" rid="pcbi.1007133.t001">Table 1</xref>, <xref ref-type="fig" rid="pcbi.1007133.g003">Fig 3</xref>).</p>
<p>The SHM distributions in the full-repertoire samples were chosen to be representative of typical IgM-specific data (“low-SHM”, mean value 0.02) or typical unsorted samples (“high-SHM”, mean value 0.06) (compare to mean values in <xref ref-type="supplementary-material" rid="pcbi.1007133.s001">S1 Fig</xref>).</p>
<p>Finally, we must decide on the clonal family structure of each sample. Real repertoires vary widely in both their clonality and lineage structure. However, we have shown in Figs <xref ref-type="fig" rid="pcbi.1007133.g001">1</xref> and <xref ref-type="fig" rid="pcbi.1007133.g002">2</xref> that our clonal family collapse is an effective-enough approximation that changes in clonality and lineage structure are equivalent to changes in sample size, and thus only affect sensitivity. In order to maximize the variety of interesting variables over which we can perform validation, we thus simulate the full repertoire samples with singleton clonal families.</p>
<p>All samples in both the low- and high-SHM groups have 50,000 sequences. This number is chosen such as to be large enough that sample size is not the principal limiter of sensitivity, while also being typical of real-world samples after error correction. We do not vary this total number of sequences because varying the constituent parameters described above is equivalent, while providing more clarity to the underlying processes.</p>
</sec>
<sec id="sec020">
<title>Phylogenetic comparison plots</title>
<p>In order to make the phylogenetic gene set comparison plots (Figs <xref ref-type="fig" rid="pcbi.1007133.g003">3</xref>, <xref ref-type="fig" rid="pcbi.1007133.g004">4</xref>, <xref ref-type="fig" rid="pcbi.1007133.g005">5</xref>, <xref ref-type="fig" rid="pcbi.1007133.g006">6</xref>, <xref ref-type="fig" rid="pcbi.1007133.g008">8</xref>, <xref ref-type="fig" rid="pcbi.1007133.g009">9</xref>, <xref ref-type="fig" rid="pcbi.1007133.g010">10</xref>, <xref ref-type="fig" rid="pcbi.1007133.g011">11</xref> and <xref ref-type="fig" rid="pcbi.1007133.g012">12</xref>, <xref ref-type="supplementary-material" rid="pcbi.1007133.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007133.s003">S3</xref> Figs) we begin by aligning all the genes that we want to compare using MUSCLE [<xref ref-type="bibr" rid="pcbi.1007133.ref040">40</xref>] (v3.8.31 with default parameters). We then use RAxML [<xref ref-type="bibr" rid="pcbi.1007133.ref041">41</xref>] (v8.2.10, with the GTR model) to create a tree for these genes. In order to allow easy visual comparison of the entire germline gene set in one plot, while also allowing comparison within each gene family (IMGT definition, e.g. IGHV3), we then collapse to length zero each branch that joins two different gene families. If the reader would like to compare combinations of germline sets that are not shown in this paper, all true and inferred germline sets, for simulation and data, are available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.1037463" xlink:type="simple">https://doi.org/10.5281/zenodo.1037463</ext-link>, and the command line script used to make these plots is available at <ext-link ext-link-type="uri" xlink:href="https://git.io/vFo2B" xlink:type="simple">https://git.io/vFo2B</ext-link>.</p>
</sec>
<sec id="sec021">
<title>Comparison between methods</title>
<p>While a comprehensive comparison of the details of all three methods (TIgGER, IgDiscover, and partis) is beyond the scope of this paper, we highlight some instructive details. First, the default partis method and TIgGER are more similar to each other than either is to IgDiscover. Both use a fitting procedure on mutation accumulation plots to look for new alleles. However, as described above, our approach to extracting information from these plots is very different, using hypothesis comparison rather than sharp cutoffs, for instance on the y-intercept.</p>
<p>IgDiscover, on the other hand, takes a quite different approach, clustering together sequences by distance and taking the consensus sequence of each cluster to be a germline gene. The main advantage of this approach is that it enables detection of new genes which are separated by either point mutations or insertions/deletions from existing alleles. The purely mutation accumulation plot-based approaches employed by TIgGER and default partis, in contrast, can only detect new alleles separated by point mutations. The tradeoff is that the fitting-based methods are able to use more detailed position-based information which allows them to function well in repertoires with higher SHM. As noted by the IgDiscover authors, distance-based clustering methods, in general, suffer from the fact that once SHM is high enough that clusters from distinct V genes start bleed together, the heuristic thresholds used to separate clusters create significant inaccuracies.</p>
<p>On human repertoires, since the IMGT set is already fairly complete, the ability to detect new alleles separated by insertion/deletion mutations is not particularly important. The germlines of most other species, however, are much less well characterized. It is thus quite common in these species to encounter novel alleles that are not simply allelic variants of well-known genes.</p>
<p>The obvious course of action, then, is to combine the mutation accumulation plot-based and clustering-based methods in order to allow accurate inference on non-naive repertoires of all species. We have, in fact, implemented this approach in partis: it is the default for non-human samples, and can be turned on for human samples. However, after extensive validation of this combined method, we believe that a somewhat modified clustering approach will be required to achieve better performance on highly mutated samples from all species, and thus leave its description to a future paper.</p>
</sec>
</sec>
<sec id="sec022">
<title>Supporting information</title>
<supplementary-material id="pcbi.1007133.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>V region mutation frequency distributions from the low (left), typical (middle), and high (right) mutation samples used to make the top panels of <xref ref-type="fig" rid="pcbi.1007133.g001">Fig 1</xref>.</title>
<p>In the context of these distributions, the full-repertoire samples (Figs <xref ref-type="fig" rid="pcbi.1007133.g003">3</xref>, <xref ref-type="fig" rid="pcbi.1007133.g004">4</xref>, <xref ref-type="fig" rid="pcbi.1007133.g005">5</xref> and <xref ref-type="fig" rid="pcbi.1007133.g006">6</xref>) correspond to a mean value of 0.02 (“low-SHM” samples) and 0.06 (“high-SHM” samples).</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007133.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Comparison of all three inference methods on the AR-type Myasthenia Gravis samples from [<xref ref-type="bibr" rid="pcbi.1007133.ref034">34</xref>] (explanation in <xref ref-type="fig" rid="pcbi.1007133.g008">Fig 8</xref>).</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007133.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Comparison of all three inference methods on the MK-type Myasthenia Gravis samples from [<xref ref-type="bibr" rid="pcbi.1007133.ref034">34</xref>] (explanation in <xref ref-type="fig" rid="pcbi.1007133.g008">Fig 8</xref>).</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007133.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>A version of <xref ref-type="fig" rid="pcbi.1007133.g008">Fig 8</xref> where leaves have been labeled with gene names.</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007133.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>A version of <xref ref-type="fig" rid="pcbi.1007133.g009">Fig 9</xref> where leaves have been labeled with gene names.</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007133.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>A version of <xref ref-type="fig" rid="pcbi.1007133.g010">Fig 10</xref> where leaves have been labeled with gene names.</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007133.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>A version of <xref ref-type="fig" rid="pcbi.1007133.g011">Fig 11</xref> where leaves have been labeled with gene names.</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007133.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>A version of <xref ref-type="fig" rid="pcbi.1007133.g012">Fig 12</xref> where leaves have been labeled with gene names.</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007133.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>A version of <xref ref-type="supplementary-material" rid="pcbi.1007133.s002">S2 Fig</xref> where leaves have been labeled with gene names.</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007133.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.s010" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>A version of <xref ref-type="supplementary-material" rid="pcbi.1007133.s003">S3 Fig</xref> where leaves have been labeled with gene names.</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007133.s011" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.s011" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Summary of data samples used.</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007133.s012" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007133.s012" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>List of total sequences in each data sample used.</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors would like to thank Kristian Davidsen, Laura Noges, and Peter Ralph for helpful discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1007133.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lefranc</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Giudicelli</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Ginestoux</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Jabado-Michaloud</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Folch</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Bellahcene</surname> <given-names>F</given-names></name>, <etal>et al</etal>. <article-title>IMGT, the international ImMunoGeneTics information system</article-title>. <source>Nucleic Acids Res</source>. <year>2009</year> <month>Jan</month>;<volume>37</volume>(<issue>suppl 1</issue>):<fpage>D1006</fpage>–<lpage>D1012</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/content/37/suppl_1/D1006.abstract" xlink:type="simple">http://nar.oxfordjournals.org/content/37/suppl_1/D1006.abstract</ext-link> <object-id pub-id-type="pmid">18978023</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ye</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Madden</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Ostell</surname> <given-names>JM</given-names></name>. <article-title>IgBLAST: an immunoglobulin variable domain sequence analysis tool</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year> <month>Jul</month>;<volume>41</volume>(<issue>Web Server issue</issue>):<fpage>W34</fpage>–<lpage>40</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt382" xlink:type="simple">http://dx.doi.org/10.1093/nar/gkt382</ext-link> <object-id pub-id-type="pmid">23671333</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brochet</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Lefranc</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Giudicelli</surname> <given-names>V</given-names></name>. <article-title>IMGT/V-QUEST: the highly customized and integrated system for IG and TR standardized V-J and V-D-J sequence analysis</article-title>. <source>Nucleic Acids Res</source>. <year>2008</year> <month>Jul</month>;<volume>36</volume>(<issue>Web Server issue</issue>):<fpage>W503</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkn316" xlink:type="simple">10.1093/nar/gkn316</ext-link></comment> <object-id pub-id-type="pmid">18503082</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ralph</surname> <given-names>DK</given-names></name>, <name name-style="western"><surname>Matsen</surname> <given-names>FA</given-names> <suffix>IV</suffix></name>. <article-title>Consistency of VDJ Rearrangement and Substitution Parameters Enables Accurate B Cell Receptor Sequence Annotation</article-title>. <source>PLOS Comput Biol</source>. <year>2016</year> <month>Jan</month>;<volume>12</volume>(<issue>1</issue>):<fpage>e1004409</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004409" xlink:type="simple">http://dx.doi.org/10.1371/journal.pcbi.1004409</ext-link> <object-id pub-id-type="pmid">26751373</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bolotin</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Poslavsky</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mitrophanov</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Shugay</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mamedov</surname> <given-names>IZ</given-names></name>, <name name-style="western"><surname>Putintseva</surname> <given-names>EV</given-names></name>, <etal>et al</etal>. <article-title>MiXCR: software for comprehensive adaptive immunity profiling</article-title>. <source>Nat Methods</source>. <year>2015</year> <day>29</day> <month>Apr</month>;<volume>12</volume>(<issue>5</issue>):<fpage>380</fpage>–<lpage>381</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.3364" xlink:type="simple">10.1038/nmeth.3364</ext-link></comment> <object-id pub-id-type="pmid">25924071</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Gäeta</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Pomat</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Siba</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Sewell</surname> <given-names>WA</given-names></name>, <etal>et al</etal>. <article-title>Genomic screening by 454 pyrosequencing identifies a new human IGHV gene and sixteen other new IGHV allelic variants</article-title>. <source>Immunogenetics</source>. <year>2011</year> <month>May</month>;<volume>63</volume>(<issue>5</issue>):<fpage>259</fpage>–<lpage>265</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00251-010-0510-8" xlink:type="simple">10.1007/s00251-010-0510-8</ext-link></comment> <object-id pub-id-type="pmid">21249354</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Boyd</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Gaëta</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Fire</surname> <given-names>AZ</given-names></name>, <name name-style="western"><surname>Marshall</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Merker</surname> <given-names>JD</given-names></name>, <etal>et al</etal>. <article-title>Individual variation in the germline Ig gene repertoire inferred from variable region gene rearrangements</article-title>. <source>J Immunol</source>. <year>2010</year> <month>Jun</month>;<volume>184</volume>(<issue>12</issue>):<fpage>6986</fpage>–<lpage>6992</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4049/jimmunol.1000445" xlink:type="simple">10.4049/jimmunol.1000445</ext-link></comment> <object-id pub-id-type="pmid">20495067</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kidd</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Boyd</surname> <given-names>SD</given-names></name>, <etal>et al</etal>. <article-title>The inference of phased haplotypes for the immunoglobulin H chain V region gene loci by analysis of VDJ gene rearrangements</article-title>. <source>J Immunol</source>. <year>2012</year> <day>1</day> <month>Feb</month>;<volume>188</volume>(<issue>3</issue>):<fpage>1333</fpage>–<lpage>1340</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4049/jimmunol.1102097" xlink:type="simple">10.4049/jimmunol.1102097</ext-link></comment> <object-id pub-id-type="pmid">22205028</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Watson</surname> <given-names>CT</given-names></name>, <name name-style="western"><surname>Steinberg</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Huddleston</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Warren</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Malig</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Schein</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Complete haplotype sequence of the human immunoglobulin heavy-chain variable, diversity, and joining genes and characterization of allelic and copy-number variation</article-title>. <source>Am J Hum Genet</source>. <year>2013</year> <day>4</day> <month>Apr</month>;<volume>92</volume>(<issue>4</issue>):<fpage>530</fpage>–<lpage>546</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ajhg.2013.03.004" xlink:type="simple">10.1016/j.ajhg.2013.03.004</ext-link></comment> <object-id pub-id-type="pmid">23541343</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Watson</surname> <given-names>CT</given-names></name>, <name name-style="western"><surname>Steinberg</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Graves</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Warren</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Malig</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Schein</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Sequencing of the human IG light chain loci from a hydatidiform mole BAC library reveals locus-specific signatures of genetic diversity</article-title>. <source>Genes Immun</source>. <year>2014</year> <day>23</day> <month>Oct</month>;Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/gene.2014.56" xlink:type="simple">http://dx.doi.org/10.1038/gene.2014.56</ext-link> <object-id pub-id-type="pmid">25338678</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gadala-Maria</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Yaari</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Uduman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kleinstein</surname> <given-names>SH</given-names></name>. <article-title>Automated analysis of high-throughput B-cell sequencing data reveals a high frequency of novel immunoglobulin V gene segment alleles</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2015</year> <day>9</day> <month>Feb</month>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1417683112" xlink:type="simple">10.1073/pnas.1417683112</ext-link></comment> <object-id pub-id-type="pmid">25675496</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Corcoran</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Phad</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Vázquez Bernat</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Stahl-Hennig</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sumida</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Persson</surname> <given-names>MAA</given-names></name>, <etal>et al</etal>. <article-title>Production of individualized V gene databases reveals high levels of immunoglobulin genetic diversity</article-title>. <source>Nat Commun</source>. <year>2016</year> <month>Dec</month>;<volume>7</volume>:<fpage>13642</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms13642" xlink:type="simple">10.1038/ncomms13642</ext-link></comment> <object-id pub-id-type="pmid">27995928</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Scheepers</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Shrestha</surname> <given-names>RK</given-names></name>, <name name-style="western"><surname>Lambson</surname> <given-names>BE</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>KJL</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>IA</given-names></name>, <name name-style="western"><surname>Naicker</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Ability to develop broadly neutralizing HIV-1 antibodies is not restricted by the germline Ig gene repertoire</article-title>. <source>J Immunol</source>. <year>2015</year> <month>May</month>;<volume>194</volume>(<issue>9</issue>):<fpage>4371</fpage>–<lpage>4378</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4049/jimmunol.1500118" xlink:type="simple">10.4049/jimmunol.1500118</ext-link></comment> <object-id pub-id-type="pmid">25825450</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lee</surname> <given-names>CEH</given-names></name>, <name name-style="western"><surname>Gaëta</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Malming</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Bain</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Sewell</surname> <given-names>WA</given-names></name>, <name name-style="western"><surname>Collins</surname> <given-names>AM</given-names></name>. <article-title>Reconsidering the human immunoglobulin heavy-chain locus</article-title>. <source>Immunogenetics</source>. <year>2006</year>;<volume>57</volume>(<issue>12</issue>):<fpage>917</fpage>–<lpage>925</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00251-005-0062-5" xlink:type="simple">10.1007/s00251-005-0062-5</ext-link></comment> <object-id pub-id-type="pmid">16402215</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lee</surname> <given-names>CEH</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>KJL</given-names></name>, <name name-style="western"><surname>Sewell</surname> <given-names>WA</given-names></name>, <name name-style="western"><surname>Collins</surname> <given-names>AM</given-names></name>. <article-title>Use of IGHJ and IGHD gene mutations in analysis of immunoglobulin sequences for the prognosis of chronic lymphocytic leukemia</article-title>. <source>Leuk Res</source>. <year>2007</year> <month>Sep</month>;<volume>31</volume>(<issue>9</issue>):<fpage>1247</fpage>–<lpage>1252</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.leukres.2006.10.013" xlink:type="simple">10.1016/j.leukres.2006.10.013</ext-link></comment> <object-id pub-id-type="pmid">17169423</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>KJL</given-names></name>, <name name-style="western"><surname>Sewell</surname> <given-names>WA</given-names></name>, <name name-style="western"><surname>Collins</surname> <given-names>AM</given-names></name>. <article-title>Many human immunoglobulin heavy-chain IGHV gene polymorphisms have been reported in error</article-title>. <source>Immunol Cell Biol</source>. <year>2008</year> <month>Feb</month>;<volume>86</volume>(<issue>2</issue>):<fpage>111</fpage>–<lpage>115</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/sj.icb.7100144" xlink:type="simple">10.1038/sj.icb.7100144</ext-link></comment> <object-id pub-id-type="pmid">18040280</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Collins</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Roskin</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Marquis</surname> <given-names>CP</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>KJL</given-names></name>. <article-title>The mouse antibody heavy chain repertoire is germline-focused and highly variable between inbred strains</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source>. <year>2015</year> <month>Sep</month>;<volume>370</volume> (<issue>1676</issue>). Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.2014.0236" xlink:type="simple">http://dx.doi.org/10.1098/rstb.2014.0236</ext-link></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Venter</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Adams</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>EW</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>PW</given-names></name>, <name name-style="western"><surname>Mural</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Sutton</surname> <given-names>GG</given-names></name>, <etal>et al</etal>. <article-title>The sequence of the human genome</article-title>. <source>Science</source>. <year>2001</year> <month>Feb</month>;<volume>291</volume>(<issue>5507</issue>):<fpage>1304</fpage>–<lpage>1351</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1058040" xlink:type="simple">http://dx.doi.org/10.1126/science.1058040</ext-link> <object-id pub-id-type="pmid">11181995</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Waterston</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Lindblad-Toh</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Birney</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Rogers</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Abril</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Agarwal</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Initial sequencing and comparative analysis of the mouse genome</article-title>. <source>Nature</source>. <year>2002</year> <month>Dec</month>;<volume>420</volume>(<issue>6915</issue>):<fpage>520</fpage>–<lpage>562</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature01262" xlink:type="simple">10.1038/nature01262</ext-link></comment> <object-id pub-id-type="pmid">12466850</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<collab>1000 Genomes Project Consortium</collab>, <name name-style="western"><surname>Abecasis</surname> <given-names>GR</given-names></name>, <name name-style="western"><surname>Altshuler</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Auton</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Brooks</surname> <given-names>LD</given-names></name>, <name name-style="western"><surname>Durbin</surname> <given-names>RM</given-names></name>, <etal>et al</etal>. <article-title>A map of human genome variation from population-scale sequencing</article-title>. <source>Nature</source>. <year>2010</year> <month>Oct</month>;<volume>467</volume>(<issue>7319</issue>):<fpage>1061</fpage>–<lpage>1073</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature09534" xlink:type="simple">http://dx.doi.org/10.1038/nature09534</ext-link> <object-id pub-id-type="pmid">20981092</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Treangen</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Salzberg</surname> <given-names>SL</given-names></name>. <article-title>Repetitive DNA and next-generation sequencing: computational challenges and solutions</article-title>. <source>Nat Rev Genet</source>. <year>2011</year> <month>Nov</month>;<volume>13</volume>(<issue>1</issue>):<fpage>36</fpage>–<lpage>46</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg3117" xlink:type="simple">10.1038/nrg3117</ext-link></comment> <object-id pub-id-type="pmid">22124482</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chimge</surname> <given-names>NO</given-names></name>, <name name-style="western"><surname>Pramanik</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Gao</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Shen</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Determination of gene organization in the human IGHV region on single chromosomes</article-title>. <source>Genes Immun</source>. <year>2005</year> <month>May</month>;<volume>6</volume>(<issue>3</issue>):<fpage>186</fpage>–<lpage>193</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/sj.gene.6364176" xlink:type="simple">10.1038/sj.gene.6364176</ext-link></comment> <object-id pub-id-type="pmid">15744329</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref023">
<label>23</label>
<mixed-citation publication-type="other" xlink:type="simple">Luo S, Yu JA, Li H, Song YS. Worldwide genetic variation of the IGHV and TRBV immune receptor gene families in humans. bioRxiv. 2017 Jun;p. 155440. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/155440" xlink:type="simple">http://dx.doi.org/10.1101/155440</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1007133.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ceredig</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Seoighe</surname> <given-names>C</given-names></name>. <article-title>A Database of Human Immune Receptor Alleles Recovered from Population Sequencing Data</article-title>. <source>J Immunol</source>. <year>2017</year> <month>Jan</month>;Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4049/jimmunol.1601710" xlink:type="simple">http://dx.doi.org/10.4049/jimmunol.1601710</ext-link></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Watson</surname> <given-names>CT</given-names></name>, <name name-style="western"><surname>Matsen</surname> <given-names>FA</given-names> <suffix>IV</suffix></name>, <name name-style="western"><surname>Jackson</surname> <given-names>KJL</given-names></name>, <name name-style="western"><surname>Bashir</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Glanville</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Comment on “A Database of Human Immune Receptor Alleles Recovered from Population Sequencing Data”</article-title>. <source>The Journal of Immunology</source>. <year>2017</year> <month>May</month>;<volume>198</volume>(<issue>9</issue>):<fpage>3371</fpage>–<lpage>3373</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.jimmunol.org/content/198/9/3371?etoc" xlink:type="simple">http://www.jimmunol.org/content/198/9/3371?etoc</ext-link> <object-id pub-id-type="pmid">28416712</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Avnir</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Watson</surname> <given-names>CT</given-names></name>, <name name-style="western"><surname>Glanville</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Peterson</surname> <given-names>EC</given-names></name>, <name name-style="western"><surname>Tallarico</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Bennett</surname> <given-names>AS</given-names></name>, <etal>et al</etal>. <article-title><italic>IGHV1-69</italic> polymorphism modulates anti-influenza antibody repertoires, correlates with IGHV utilization shifts and varies by ethnicity</article-title>. <source>Sci Rep</source>. <year>2016</year> <month>Feb</month>;<volume>6</volume>:<fpage>20842</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/srep20842" xlink:type="simple">10.1038/srep20842</ext-link></comment> <object-id pub-id-type="pmid">26880249</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Lucas</surname> <given-names>AH</given-names></name>. <article-title>IGH V3-23*01 and its allele V3-23*03 differ in their capacity to form the canonical human antibody combining site specific for the capsular polysaccharide of Haemophilus influenzae type b</article-title>. <source>Immunogenetics</source>. <year>2003</year> <month>Aug</month>;<volume>55</volume>(<issue>5</issue>):<fpage>336</fpage>–<lpage>338</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00251-003-0583-8" xlink:type="simple">10.1007/s00251-003-0583-8</ext-link></comment> <object-id pub-id-type="pmid">12845501</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rogozin</surname> <given-names>IB</given-names></name>, <name name-style="western"><surname>Kolchanov</surname> <given-names>NA</given-names></name>. <article-title>Somatic hypermutagenesis in immunoglobulin genes. II. Influence of neighbouring base sequences on mutagenesis</article-title>. <source>Biochim Biophys Acta</source>. <year>1992</year> <month>Nov</month>;<volume>1171</volume>(<issue>1</issue>):<fpage>11</fpage>–<lpage>18</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/1420357" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/1420357</ext-link> <object-id pub-id-type="pmid">1420357</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cui</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Di Niro</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Vander Heiden</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Briggs</surname> <given-names>AW</given-names></name>, <name name-style="western"><surname>Adams</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Gilbert</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>A Model of Somatic Hypermutation Targeting in Mice Based on High-Throughput Ig Sequencing Data</article-title>. <source>J Immunol</source>. <year>2016</year> <month>Jan</month>;<volume>197</volume>(<issue>9</issue>):<fpage>3566</fpage>–<lpage>3574</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4049/jimmunol.1502263" xlink:type="simple">10.4049/jimmunol.1502263</ext-link></comment> <object-id pub-id-type="pmid">27707999</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yaari</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Uduman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kleinstein</surname> <given-names>SH</given-names></name>. <article-title>Quantifying selection in high-throughput Immunoglobulin sequencing data sets</article-title>. <source>Nucleic Acids Res</source>. <year>2012</year> <month>May</month>;<volume>40</volume>(<issue>17</issue>):<fpage>e134</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gks457" xlink:type="simple">http://dx.doi.org/10.1093/nar/gks457</ext-link> <object-id pub-id-type="pmid">22641856</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McCoy</surname> <given-names>CO</given-names></name>, <name name-style="western"><surname>Bedford</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Minin</surname> <given-names>VN</given-names></name>, <name name-style="western"><surname>Bradley</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Robins</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Matsen</surname> <given-names>FA</given-names> <suffix>IV</suffix></name>. <article-title>Quantifying evolutionary constraints on B-cell affinity maturation</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source>. <year>2015</year> <day>5</day> <month>Sep</month>;<volume>370</volume> (<issue>1676</issue>). Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.2014.0244" xlink:type="simple">http://dx.doi.org/10.1098/rstb.2014.0244</ext-link> <object-id pub-id-type="pmid">26194758</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Matsuda</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Ishii</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Bourvagnet</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kuma</surname> <given-names>Ki</given-names></name>, <name name-style="western"><surname>Hayashida</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Miyata</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>The complete nucleotide sequence of the human immunoglobulin heavy chain variable region locus</article-title>. <source>J Exp Med</source>. <year>1998</year> <month>Dec</month>;<volume>188</volume>(<issue>11</issue>):<fpage>2151</fpage>–<lpage>2162</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1084/jem.188.11.2151" xlink:type="simple">10.1084/jem.188.11.2151</ext-link></comment> <object-id pub-id-type="pmid">9841928</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Elhanati</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Sethna</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Marcou</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Callan</surname> <given-names>CG</given-names> <suffix>Jr</suffix></name>, <name name-style="western"><surname>Mora</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Walczak</surname> <given-names>AM</given-names></name>. <article-title>Inferring processes underlying B-cell repertoire diversity</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source>. <year>2015</year> <day>5</day> <month>Sep</month>;<volume>370</volume> (<issue>1676</issue>). Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.2014.0243" xlink:type="simple">http://dx.doi.org/10.1098/rstb.2014.0243</ext-link> <object-id pub-id-type="pmid">26194757</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vander Heiden</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Stathopoulos</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>JQ</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Gilbert</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Bolen</surname> <given-names>CR</given-names></name>, <etal>et al</etal>. <article-title>Dysregulation of B Cell Repertoire Formation in Myasthenia Gravis Patients Revealed through Deep Sequencing</article-title>. <source>J Immunol</source>. <year>2017</year> <day>13</day> <month>Jan</month>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4049/jimmunol.1601415" xlink:type="simple">10.4049/jimmunol.1601415</ext-link></comment> <object-id pub-id-type="pmid">28087666</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Laserson</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Vigneault</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Gadala-Maria</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Yaari</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Uduman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Vander Heiden</surname> <given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>High-resolution antibody dynamics of vaccine-induced immune responses</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2014</year> <day>17</day> <month>Mar</month>;Available from: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1323862111" xlink:type="simple">http://dx.doi.org/10.1073/pnas.1323862111</ext-link></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sheng</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Schramm</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Kong</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Program</surname> <given-names>NCS</given-names></name>, <name name-style="western"><surname>Mullikin</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Mascola</surname> <given-names>JR</given-names></name>, <etal>et al</etal>. <article-title>Gene-Specific Substitution Profiles Describe the Types and Frequencies of Amino Acid Changes during Antibody Somatic Hypermutation</article-title>. <source>Frontiers in immunology</source>. <year>2017</year> <month>May</month>;<volume>8</volume>:<fpage>537</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fimmu.2017.00537" xlink:type="simple">10.3389/fimmu.2017.00537</ext-link></comment> <object-id pub-id-type="pmid">28539926</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hagen</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Hartmann</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Steel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Stadler</surname> <given-names>T</given-names></name>. <article-title>Age-dependent speciation can explain the shape of empirical phylogenies</article-title>. <source>Syst Biol</source>. <year>2015</year> <month>May</month>;<volume>64</volume>(<issue>3</issue>):<fpage>432</fpage>–<lpage>440</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/sysbio/syv001" xlink:type="simple">10.1093/sysbio/syv001</ext-link></comment> <object-id pub-id-type="pmid">25575504</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref038">
<label>38</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Lefranc</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Lefranc</surname> <given-names>G</given-names></name>. <source>The Immunoglobulin FactsBook</source>. <publisher-loc>Cambridge, MA</publisher-loc>: <publisher-name>Academic Press</publisher-name>; <year>2001</year>.</mixed-citation>
</ref>
<ref id="pcbi.1007133.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ralph</surname> <given-names>DK</given-names></name>, <name name-style="western"><surname>Matsen</surname> <given-names>FA</given-names> <suffix>IV</suffix></name>. <article-title>Likelihood-Based Inference of B Cell Clonal Families</article-title>. <source>PLOS Comput Biol</source>. <year>2016</year> <month>Oct</month>;<volume>12</volume>(<issue>10</issue>):<fpage>e1005086</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005086" xlink:type="simple">10.1371/journal.pcbi.1005086</ext-link></comment> <object-id pub-id-type="pmid">27749910</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Edgar</surname> <given-names>RC</given-names></name>. <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>. <source>Nucleic Acids Res</source>. <year>2004</year> <month>Mar</month>;<volume>32</volume>(<issue>5</issue>):<fpage>1792</fpage>–<lpage>1797</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkh340" xlink:type="simple">10.1093/nar/gkh340</ext-link></comment> <object-id pub-id-type="pmid">15034147</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007133.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stamatakis</surname> <given-names>A</given-names></name>. <article-title>RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</article-title>. <source>Bioinformatics</source>. <year>2014</year> <month>May</month>;<volume>30</volume>(<issue>9</issue>):<fpage>1312</fpage>–<lpage>1313</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btu033" xlink:type="simple">10.1093/bioinformatics/btu033</ext-link></comment> <object-id pub-id-type="pmid">24451623</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>