<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article article-type="research-article" dtd-version="3.0" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004736</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00989</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biophysics</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Biophysics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biophysics</subject><subj-group><subject>Ion channels</subject><subj-group><subject>Calcium channels</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Biophysics</subject><subj-group><subject>Ion channels</subject><subj-group><subject>Calcium channels</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Ion channels</subject><subj-group><subject>Calcium channels</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Ion channels</subject><subj-group><subject>Calcium channels</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Ion channels</subject><subj-group><subject>Calcium channels</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Ion channels</subject><subj-group><subject>Calcium channels</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Ion channels</subject><subj-group><subject>Calcium channels</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Ion channels</subject><subj-group><subject>Calcium channels</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Calcium imaging</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Calcium imaging</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Fluorescence imaging</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data acquisition</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Inferring Neuronal Dynamics from Calcium Imaging Data Using Biophysical Models and Bayesian Inference</article-title>
<alt-title alt-title-type="running-head">Biophysically Informed Bayesian Inference for Calcium Imaging Data</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Rahmati</surname>
<given-names>Vahid</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kirmse</surname>
<given-names>Knut</given-names>
</name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Marković</surname>
<given-names>Dimitrije</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Holthoff</surname>
<given-names>Knut</given-names>
</name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kiebel</surname>
<given-names>Stefan J.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Psychology, Technische Universität Dresden, Dresden, Germany</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Biomagnetic Centre, Hans-Berger Department of Neurology, University Hospital Jena, Jena, Germany</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Hans-Berger Department of Neurology, University Hospital Jena, Jena, Germany</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Max Planck Institute for Human Cognitive and Brain Sciences, Leipzig, Germany</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Hilgetag</surname>
<given-names>Claus C.</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Hamburg University, GERMANY</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: KK KH. Performed the experiments: KK. Analyzed the data: VR SJK. Contributed reagents/materials/analysis tools: VR SJK. Wrote the paper: VR KK DM KH SJK.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">vahid.rahmati@tu-dresden.de</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>19</day>
<month>2</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="collection">
<month>2</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>2</issue>
<elocation-id>e1004736</elocation-id>
<history>
<date date-type="received">
<day>18</day>
<month>6</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>5</day>
<month>1</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Rahmati et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004736"/>
<abstract>
<p>Calcium imaging has been used as a promising technique to monitor the dynamic activity of neuronal populations. However, the calcium trace is temporally smeared which restricts the extraction of quantities of interest such as spike trains of individual neurons. To address this issue, spike reconstruction algorithms have been introduced. One limitation of such reconstructions is that the underlying models are not informed about the biophysics of spike and burst generations. Such existing prior knowledge might be useful for constraining the possible solutions of spikes. Here we describe, in a novel Bayesian approach, how principled knowledge about neuronal dynamics can be employed to infer biophysical variables and parameters from fluorescence traces. By using both synthetic and <italic>in vitro</italic> recorded fluorescence traces, we demonstrate that the new approach is able to reconstruct different repetitive spiking and/or bursting patterns with accurate single spike resolution. Furthermore, we show that the high inference precision of the new approach is preserved even if the fluorescence trace is rather noisy or if the fluorescence transients show slow rise kinetics lasting several hundred milliseconds, and inhomogeneous rise and decay times. In addition, we discuss the use of the new approach for inferring parameter changes, e.g. due to a pharmacological intervention, as well as for inferring complex characteristics of immature neuronal circuits.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Calcium imaging of single neurons enables the indirect observation of neuronal dynamics, for example action potential firing. In contrast to the precise timing of spike trains, the calcium trace is temporally rather smeared and measured as a fluorescence trace. Consequently, several methods have been proposed to reconstruct spikes from calcium imaging data. However, a common feature of these methods is that they are not based on the biophysics of how neurons fire spikes and bursts. We propose to introduce well-established biophysical models to create a direct link between neuronal dynamics, e.g. the membrane potential, and fluorescence traces. Using both synthetic and experimental data, we show that this approach not only provides a robust and accurate spike reconstruction but also a reliable inference about the biophysically relevant parameters and variables. This enables novel ways of analyzing calcium imaging experiments in terms of the underlying biophysical quantities.</p>
</abstract>
<funding-group>
<funding-statement>This work was supported by the German Research Foundation and the Open Access Publication Funds of the TU Dresden, the Priority Program 1665 (HO 2156/3-1, KI 1816/1-1 and KI 1638/3-1), the Collaborative Research Center/Transregio 166 of the German Research Foundation (TRR 166/1 B3 to KH and KK), the Research Group FO 1738 (WI 830/10-2 to KH), the Federal Ministry of Education and Research (01GQ0923 to KH) and the Interdisciplinary Centre for Clinical Research Jena (to KK and KH). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="11"/>
<table-count count="5"/>
<page-count count="42"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All experimental data are available from the figshare database (<ext-link ext-link-type="uri" xlink:href="http://figshare.com/s/e524c1d214d411e5869c06ec4b8d1f61" xlink:type="simple">http://figshare.com/s/e524c1d214d411e5869c06ec4b8d1f61</ext-link>).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Calcium imaging has been used to record neuronal activity indirectly [<xref ref-type="bibr" rid="pcbi.1004736.ref001">1</xref>]. Individual neurons or neuronal populations are labeled by applying fluorescent calcium indicators so that the intracellular calcium transients become measurable by optical means. The technique has a temporal resolution up to the millisecond scale and allows measurements at multiple structural levels, from cellular sub-compartments [<xref ref-type="bibr" rid="pcbi.1004736.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref003">3</xref>] and individual neurons [<xref ref-type="bibr" rid="pcbi.1004736.ref004">4</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref005">5</xref>] to rather large neuronal ensembles [<xref ref-type="bibr" rid="pcbi.1004736.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1004736.ref008">8</xref>]. Moreover, calcium imaging can be applied to both <italic>in vivo</italic> [<xref ref-type="bibr" rid="pcbi.1004736.ref006">6</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref009">9</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref010">10</xref>] and <italic>in vitro</italic> brain preparations [<xref ref-type="bibr" rid="pcbi.1004736.ref011">11</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref012">12</xref>].</p>
<p>While calcium imaging techniques have a wide range of applications, the reconstruction of the quantities of interest such as spike (or action potential) trains and intracellular free calcium concentration, [Ca<sup>2+</sup>], kinetics from fluorescence, <italic>F</italic><sub><italic>t</italic></sub>, traces is restricted mostly due to the intrinsic low temporal resolution of calcium traces, relative to the fast time scale of spikes. Several algorithms for the reconstruction of spikes from calcium imaging data have been proposed. These include template matching [<xref ref-type="bibr" rid="pcbi.1004736.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref009">9</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref014">14</xref>], first-derivative methods including deconvolution [<xref ref-type="bibr" rid="pcbi.1004736.ref015">15</xref>–<xref ref-type="bibr" rid="pcbi.1004736.ref017">17</xref>], reverse correlation [<xref ref-type="bibr" rid="pcbi.1004736.ref018">18</xref>] and a sequential Monte Carlo method [<xref ref-type="bibr" rid="pcbi.1004736.ref019">19</xref>].</p>
<p>One common feature of these previously described reconstruction methods is that they are not based on biophysical models for how spikes are generated. Such biophysical models have been developed to model different biophysical characteristics and firing patterns observed in electrophysiological data [<xref ref-type="bibr" rid="pcbi.1004736.ref020">20</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref021">21</xref>]. Here, we specify a generative forward model by explicitly linking the membrane potential (<italic>V</italic>), rather than only spikes, to fluorescence traces through [Ca<sup>2+</sup>] kinetics. We pursue the idea that reconstruction of spikes and, potentially, inferring the underlying neuronal dynamics, can be performed by inverting this generative forward model. The inversion of such biophysically plausible models has been found useful for magneto- and electroencephalography and can be performed using Bayesian inference techniques [<xref ref-type="bibr" rid="pcbi.1004736.ref022">22</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref023">23</xref>]. The expected advantages for the analysis of calcium imaging data, relative to existing approaches, are an increased robustness to noise and artefacts, incorporation of biophysically sensible prior information, and the biophysical interpretation of inferred variables and identified parameters. In addition, the Bayesian inference approach captures the uncertainty about the inferred quantities of interest, thereby allowing one to assess which dynamics and parameters can be inferred from the fluorescence traces, and which ones cannot.</p>
<p>As an illustration and proof-of-concept of the proposed modelling approach, we use both synthetic and <italic>in vitro</italic> calcium imaging data. We show for both data sets that spikes can be reconstructed accurately, even under low signal to noise (SNR) conditions, through inferring the neuronal dynamics such as membrane potential, [Ca<sup>2+</sup>] kinetics, membrane refractoriness and voltage-gated ionic currents. One important, potential application of the approach may be its use to reconstruct spikes from imaging data at high sampling rates but with rather low SNRs. We will show that the biophysical model reliably infers the within-burst or single spikes and also quantitatively captures and infers several experimental phenomena, e.g. fluorescence transients with both typical (i.e. fast) [<xref ref-type="bibr" rid="pcbi.1004736.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref024">24</xref>–<xref ref-type="bibr" rid="pcbi.1004736.ref026">26</xref>] or slow rise kinetics [<xref ref-type="bibr" rid="pcbi.1004736.ref027">27</xref>], and the somatic bursts of hippocampal pyramidal neurons [<xref ref-type="bibr" rid="pcbi.1004736.ref028">28</xref>–<xref ref-type="bibr" rid="pcbi.1004736.ref030">30</xref>]. We will further demonstrate the usefulness of the approach for experimental setups like a pharmacological intervention where predictions about the change in specific biophysical parameters can be tested directly. To illustrate the method on real data, we use our recorded data from immature neurons of neonatal mice which impose a challenging spike reconstruction task, due to the slow rise kinetics of their spike-evoked fluorescence transients. In addition, we apply the method to a publicly available <italic>in vitro</italic> data set with fast rising fluorescence transients. To reduce the computational complexity of the method we also introduce and use two new, differentiable integrate-and-fire models for repetitive spiking and bursting firing patterns.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>Overview</title>
<p>Our approach for model-based analysis of calcium imaging data is based on linking the neuronal membrane potential, to the fluorescence traces by using the kinetics of [Ca<sup>2+</sup>] as an intermediate variable. This requires three components: (i) a model for the membrane dynamics and how spikes are generated, (ii) a model for the [Ca<sup>2+</sup>] kinetics, where the entry via Ca<sup>2+</sup> influx is regulated by a nonlinear function representing the activation-state of high-voltage-activated (HVA) calcium channels, and (iii) an observation function which provides a noisy nonlinear mapping from the generated [Ca<sup>2+</sup>] time series to the fluorescence trace. These three model components form a so-called generative model which explains how data are generated starting from the membrane potential. Given a fluorescence trace, we ‘invert’ this model by making inference on the neuron’s underlying hidden states (i.e. dynamics) and/or parameters, see <xref ref-type="fig" rid="pcbi.1004736.g001">Fig 1A</xref>.</p>
<fig id="pcbi.1004736.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004736.g001</object-id>
<label>Fig 1</label>
<caption>
<title>The generative model and non-hybrid quadratic integrate-and-fire (family of QGIF) models.</title>
<p>(<bold>A</bold>) Graph representing the generative model and its inversion, which are comprised of evolution (i.e., a neuron model) and observation equations. The illustrated hierarchy in the graph displays how neuronal dynamics relate to fluorescence traces. (<bold>B</bold> and <bold>C</bold>) Sample voltage traces of (<bold>B</bold>) QGIF and (<bold>C</bold>) bursting-QGIF models. The traces show the rhythmic activity of these models in response to sustained depolarizations. Note that the family of QGIF models does not require any reset condition for spike/burst generation. The persistent Na<sup>+</sup> and M-type K<sup>+</sup> currents (red and green lines, respectively) of bursting-QGIF model are in units of [<italic>μA</italic> / <italic>cm</italic><sup>2</sup>]. Parameters for the simulations: (<bold>B</bold>) <italic>I</italic><sub><italic>app</italic></sub> = 0.2 <italic>μA</italic> / <italic>cm</italic><sup>2</sup>, (<bold>C</bold>) <inline-formula id="pcbi.1004736.e001"><alternatives><graphic id="pcbi.1004736.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e001" xlink:type="simple"/>
<mml:math display="inline" id="M1"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>80</mml:mn><mml:mspace width="0.25em"/><mml:mi>μ</mml:mi><mml:mi>A</mml:mi><mml:mspace width="0.25em"/><mml:mi>m</mml:mi><mml:mi>S</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:math>
</alternatives></inline-formula>, <italic>I</italic><sub><italic>app</italic></sub> = 1 <italic>μA</italic> / <italic>cm</italic><sup>2</sup>. See <xref ref-type="table" rid="pcbi.1004736.t001">Table 1</xref> for the rest of parameter values.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.g001" xlink:type="simple"/>
</fig>
<table-wrap id="pcbi.1004736.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004736.t001</object-id>
<label>Table 1</label> <caption><title>Parameter values.</title></caption>
<alternatives>
<graphic id="pcbi.1004736.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Models</th>
<th align="center">Parameters</th>
<th align="center">Units</th>
<th align="center">References</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><bold>QGIF family</bold></td>
<td align="center"><italic>V</italic><sub><italic>th</italic></sub> = −59.9</td>
<td align="center"><italic>mV</italic></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref048">48</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>I</italic><sub><italic>th</italic></sub> = 0.16</td>
<td align="center"><italic>μA</italic> / <italic>cm</italic><sup>2</sup></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref048">48</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>g</italic><sub><italic>L</italic></sub> = 0.1</td>
<td align="center"><italic>mS</italic> / <italic>cm</italic><sup>2</sup></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref048">48</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>C</italic> = 1</td>
<td align="center"><italic>μF</italic> / <italic>cm</italic><sup>2</sup></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref048">48</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>V</italic><sub><italic>peak</italic></sub> = 30</td>
<td align="center"><italic>mV</italic></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref029">29</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>σ</italic><sub><italic>peak</italic></sub> = 1</td>
<td align="center"><italic>mV</italic></td>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>a</italic><sub><italic>rep</italic></sub> = 10<sup>12</sup></td>
<td align="center"><italic>mV</italic></td>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>b</italic><sub><italic>rep</italic></sub> = 10<sup>4</sup></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>C</italic><sub><italic>rep</italic></sub> = 0.1</td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"><bold>QGIF</bold></td>
<td align="center"><inline-formula id="pcbi.1004736.e002"><alternatives><graphic id="pcbi.1004736.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e002" xlink:type="simple"/>
<mml:math display="inline" id="M2"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>120</mml:mn></mml:mrow></mml:math>
</alternatives></inline-formula></td>
<td align="center"><italic>μA mS</italic> / <italic>μF</italic></td>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center">Δ<sub><italic>th</italic></sub> = 3.48</td>
<td align="center"><italic>mV</italic></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref048">48</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>dt</italic> = 0.2</td>
<td align="center"><italic>ms</italic></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref021">21</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>k</italic> = 3 <bold>[INV]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center">ϒ<sub><italic>F</italic></sub> = 3 <bold>[INV]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center">ϒ<sub><italic>V</italic></sub> = 0.005 <bold>[INV]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center">ϒ<sub><italic>Ca</italic></sub> = 10 <bold>[INV]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center"><inline-formula id="pcbi.1004736.e003"><alternatives><graphic id="pcbi.1004736.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e003" xlink:type="simple"/>
<mml:math display="inline" id="M3"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>2000</mml:mn></mml:mrow></mml:math>
</alternatives></inline-formula> <bold>[SIM]</bold></td>
<td align="center"><italic>ms</italic></td>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center"><inline-formula id="pcbi.1004736.e004"><alternatives><graphic id="pcbi.1004736.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e004" xlink:type="simple"/>
<mml:math display="inline" id="M4"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>7500</mml:mn></mml:mrow></mml:math>
</alternatives></inline-formula> <bold>[INV]</bold></td>
<td align="center"><italic>ms</italic></td>
<td align="center"/>
</tr>
<tr>
<td align="center"><bold>bursting-QGIF</bold></td>
<td align="center"><inline-formula id="pcbi.1004736.e005"><alternatives><graphic id="pcbi.1004736.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e005" xlink:type="simple"/>
<mml:math display="inline" id="M5"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>87</mml:mn></mml:mrow></mml:math>
</alternatives></inline-formula> <bold>[SIM]</bold></td>
<td align="center"><italic>μA mS</italic> / <italic>μF</italic></td>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center"><inline-formula id="pcbi.1004736.e006"><alternatives><graphic id="pcbi.1004736.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e006" xlink:type="simple"/>
<mml:math display="inline" id="M6"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>80</mml:mn></mml:mrow></mml:math>
</alternatives></inline-formula> <bold>[INV]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>E</italic><sub><italic>K</italic></sub> = −90</td>
<td align="center"><italic>mV</italic></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref057">57</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>E</italic><sub><italic>Na</italic></sub> = 55</td>
<td align="center"><italic>mV</italic></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref057">57</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>g</italic><sub><italic>M</italic></sub> = 1 <bold>[U]</bold></td>
<td align="center"><italic>mS</italic> / <italic>cm</italic><sup>2</sup></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref057">57</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>g</italic><sub><italic>NaP</italic></sub> = 0.41 <bold>[SIM] [U]</bold></td>
<td align="center"><italic>mS</italic> / <italic>cm</italic><sup>2</sup></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref057">57</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center">Δ<sub><italic>th</italic></sub> = 3.48 <bold>[SIM] [U]</bold></td>
<td align="center"><italic>mV</italic></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref048">48</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>O</italic> = 0</td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>dt</italic> = 0.05</td>
<td align="center"><italic>ms</italic></td>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>k</italic> = 8 <bold>[INV]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center">ϒ<sub><italic>F</italic></sub> = 6 <bold>[INV]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center">ϒ<sub><italic>V</italic></sub> = 0.005 <bold>[INV]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center">ϒ<sub><italic>z</italic></sub> = 20 <bold>[INV]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center">ϒ<sub><italic>Ca</italic></sub> = 10 <bold>[INV]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center"><inline-formula id="pcbi.1004736.e007"><alternatives><graphic id="pcbi.1004736.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e007" xlink:type="simple"/>
<mml:math display="inline" id="M7"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>800</mml:mn></mml:mrow></mml:math>
</alternatives></inline-formula> <bold>[SIM]</bold></td>
<td align="center"><italic>ms</italic></td>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center"><inline-formula id="pcbi.1004736.e008"><alternatives><graphic id="pcbi.1004736.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e008" xlink:type="simple"/>
<mml:math display="inline" id="M8"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>850</mml:mn></mml:mrow></mml:math>
</alternatives></inline-formula> <bold>[INV]</bold></td>
<td align="center"><italic>ms</italic></td>
<td align="center"/>
</tr>
<tr>
<td align="center"><bold>FHN</bold></td>
<td align="center"><italic>ψ</italic><sub>1</sub> = 0.7</td>
<td align="center"/>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref021">21</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>ψ</italic><sub>2</sub> = 0.8</td>
<td align="center"/>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref021">21</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>λ</italic> = 0.08</td>
<td align="center"/>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref021">21</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>dt</italic> = 0.2</td>
<td align="center"><italic>ms</italic></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref021">21</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>k</italic> = 3 <bold>[INV]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center">ϒ<sub><italic>F</italic></sub> = 3 <bold>[INV]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center">ϒ<sub><italic>V</italic></sub> = 2 <bold>[INV]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center">ϒ<sub><italic>W</italic></sub> = 30 <bold>[INV]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center">ϒ<sub><italic>Ca</italic></sub> = 10 <bold>[INV]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center"><inline-formula id="pcbi.1004736.e009"><alternatives><graphic id="pcbi.1004736.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e009" xlink:type="simple"/>
<mml:math display="inline" id="M9"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>2000</mml:mn></mml:mrow></mml:math>
</alternatives></inline-formula> <bold>[SIM]</bold></td>
<td align="center"><italic>ms</italic></td>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center"><inline-formula id="pcbi.1004736.e010"><alternatives><graphic id="pcbi.1004736.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e010" xlink:type="simple"/>
<mml:math display="inline" id="M10"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>7500</mml:mn></mml:mrow></mml:math>
</alternatives></inline-formula> <bold>[INV]</bold></td>
<td align="center"><italic>ms</italic></td>
<td align="center"/>
</tr>
<tr>
<td align="center"><bold>Calcium channel</bold></td>
<td align="center"><italic>g</italic><sub><italic>Ca</italic></sub> = 5</td>
<td align="center"><italic>mS</italic> / <italic>cm</italic><sup>2</sup></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref029">29</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>κ</italic><sub><italic>Ca</italic></sub> = 0.002 <bold>[SIM] [U]</bold></td>
<td align="center"/>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref064">64</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center">[Ca<sup>2+</sup>]<sub>base</sub> = 0 <bold>[SIM] [U]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>E</italic><sub><italic>Ca</italic></sub> = 120</td>
<td align="center"><italic>mV</italic></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref064">64</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>ρ</italic> = 5</td>
<td align="center"><italic>mV</italic></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref064">64</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>V</italic><sub>1/2</sub> = −25 <bold>[SIM]</bold></td>
<td align="center"><italic>mV</italic></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref064">64</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>V</italic><sub>1/2</sub> = −45 <bold>[INV]</bold></td>
<td align="center"><italic>mV</italic></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref067">67</xref>]</td>
</tr>
<tr>
<td align="center"><bold>Ca</bold><sup><bold>2+</bold></sup> <bold>-fluorescence mapping</bold></td>
<td align="center"><italic>K</italic><sub><italic>d</italic></sub> = 200 <bold>(for OGB-1)</bold></td>
<td align="center"><italic>nM</italic></td>
<td align="center">[<xref ref-type="bibr" rid="pcbi.1004736.ref004">4</xref>]</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>κ</italic><sub><italic>F</italic></sub> = 10 <bold>[U] (for QGIF)</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>κ</italic><sub><italic>F</italic></sub> = 5 <bold>[U] (for bursting-QGIF &amp; FHN)</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>d</italic><sub><italic>F</italic></sub> = 0 <bold>[U]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"><bold>Precision-parameters</bold></td>
<td align="center"><italic>σ</italic> = inf ≈ 10<sup>12</sup> <bold>[SIM] [U]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>α</italic> = inf ≈ 10<sup>12</sup> <bold>[SIM] [U]</bold></td>
<td align="center"/>
<td align="center"/>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001"><p>Parameter values used in the generative and inverse models. This table lists the default values of modeling parameters. The abbreviations <bold>SIM</bold> and <bold>INV</bold> in front of the parameter values (second column) indicate that these values were used in the simulations and inversions, respectively. The parameters designated by <bold>U</bold> were considered as free parameters in the inversions and thus need to be inferred from the data; the prior distributions for these parameters are listed in <xref ref-type="table" rid="pcbi.1004736.t002">Table 2</xref>. Moreover, for simulating data the initial conditions of all neuronal dynamics were set to their steady-states in the absence of input to neuron model. The rest of parameters were kept with the same values in both simulations and inversions. All parameter values are consistent across the figures, unless stated otherwise.</p></fn>
</table-wrap-foot>
</table-wrap>
<table-wrap id="pcbi.1004736.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004736.t002</object-id>
<label>Table 2</label> <caption><title>Prior densities.</title></caption>
<alternatives>
<graphic id="pcbi.1004736.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Models</th>
<th align="center">Parameters</th>
<th align="center">Prior densities</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><bold>All</bold></td>
<td align="center"><inline-formula id="pcbi.1004736.e011"><alternatives><graphic id="pcbi.1004736.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e011" xlink:type="simple"/>
<mml:math display="inline" id="M11"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
</alternatives></inline-formula></td>
<td align="center"><inline-formula id="pcbi.1004736.e012"><alternatives><graphic id="pcbi.1004736.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e012" xlink:type="simple"/>
<mml:math display="inline" id="M12"><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</alternatives></inline-formula></td>
</tr>
<tr>
<td align="center"/>
<td align="center"><inline-formula id="pcbi.1004736.e013"><alternatives><graphic id="pcbi.1004736.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e013" xlink:type="simple"/>
<mml:math display="inline" id="M13"><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.002</mml:mn><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
</alternatives></inline-formula></td>
<td align="center"><inline-formula id="pcbi.1004736.e014"><alternatives><graphic id="pcbi.1004736.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e014" xlink:type="simple"/>
<mml:math display="inline" id="M14"><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</alternatives></inline-formula></td>
</tr>
<tr>
<td align="center"/>
<td align="center">[Ca<sup>2+</sup>]<sub>base</sub></td>
<td align="center">[Ca<sup>2+</sup>]<sub>base</sub> ∼ <italic>N</italic>(0,100)</td>
</tr>
<tr>
<td align="center"/>
<td align="center">[Ca<sup>2+</sup>](0)</td>
<td align="center"><inline-formula id="pcbi.1004736.e015"><alternatives><graphic id="pcbi.1004736.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e015" xlink:type="simple"/>
<mml:math display="inline" id="M15"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mtext>Ca</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mtext>Ca</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow/><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>45</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>25</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</alternatives></inline-formula></td>
</tr>
<tr>
<td align="center"/>
<td align="center"><inline-formula id="pcbi.1004736.e016"><alternatives><graphic id="pcbi.1004736.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e016" xlink:type="simple"/>
<mml:math display="inline" id="M16"><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mi mathvariant="normal">exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</alternatives></inline-formula></td>
<td align="center"><inline-formula id="pcbi.1004736.e017"><alternatives><graphic id="pcbi.1004736.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e017" xlink:type="simple"/>
<mml:math display="inline" id="M17"><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</alternatives></inline-formula></td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>d</italic><sub><italic>F</italic></sub></td>
<td align="center"><italic>d</italic><sub><italic>F</italic></sub> ∼ <italic>N</italic>(0.5min(<italic>F</italic><sub><italic>t</italic></sub>),0.25)</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>α</italic></td>
<td align="center"><italic>α</italic> ∼ <italic>Ga</italic>(1,1)</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>σ</italic></td>
<td align="center"><italic>σ</italic> ∼ <italic>Ga</italic>(1,1)</td>
</tr>
<tr>
<td align="center"><bold>QGIF</bold></td>
<td align="center"><italic>V</italic>(0)</td>
<td align="center"><italic>V</italic>(0) ∼ <italic>N</italic>(<italic>V</italic><sup><italic>ss</italic></sup>,100)</td>
</tr>
<tr>
<td align="center"><bold>Bursting-QGIF</bold></td>
<td align="center"><inline-formula id="pcbi.1004736.e018"><alternatives><graphic id="pcbi.1004736.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e018" xlink:type="simple"/>
<mml:math display="inline" id="M18"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>3.48</mml:mn><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
</alternatives></inline-formula></td>
<td align="center"><inline-formula id="pcbi.1004736.e019"><alternatives><graphic id="pcbi.1004736.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e019" xlink:type="simple"/>
<mml:math display="inline" id="M19"><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</alternatives></inline-formula></td>
</tr>
<tr>
<td align="center"/>
<td align="center"><inline-formula id="pcbi.1004736.e020"><alternatives><graphic id="pcbi.1004736.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e020" xlink:type="simple"/>
<mml:math display="inline" id="M20"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.41</mml:mn><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
</alternatives></inline-formula></td>
<td align="center"><inline-formula id="pcbi.1004736.e021"><alternatives><graphic id="pcbi.1004736.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e021" xlink:type="simple"/>
<mml:math display="inline" id="M21"><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</alternatives></inline-formula></td>
</tr>
<tr>
<td align="center"/>
<td align="center"><inline-formula id="pcbi.1004736.e022"><alternatives><graphic id="pcbi.1004736.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e022" xlink:type="simple"/>
<mml:math display="inline" id="M22"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
</alternatives></inline-formula></td>
<td align="center"><inline-formula id="pcbi.1004736.e023"><alternatives><graphic id="pcbi.1004736.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e023" xlink:type="simple"/>
<mml:math display="inline" id="M23"><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
</alternatives></inline-formula></td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>V</italic>(0)</td>
<td align="center"><italic>V</italic>(0) ∼ <italic>N</italic>(<italic>V</italic><sup><italic>ss</italic></sup>,100)</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>z</italic>(0)</td>
<td align="center"><italic>z</italic>(0) ∼ <italic>N</italic>(<italic>z</italic><sup><italic>ss</italic></sup>,1)</td>
</tr>
<tr>
<td align="center"><bold>FHN</bold></td>
<td align="center"><italic>V</italic>(0)</td>
<td align="center"><italic>V</italic>(0) ∼ <italic>N</italic>(<italic>V</italic><sup><italic>ss</italic></sup>,4)</td>
</tr>
<tr>
<td align="center"/>
<td align="center"><italic>W</italic>(0)</td>
<td align="center"><italic>W</italic>(0) ∼ <italic>N</italic>(<italic>W</italic><sup><italic>ss</italic></sup>,1)</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001"><p>Prior densities of the free (i.e. unknown) parameters. <italic>N</italic>(mean,variance) indicates normal distribution, and <italic>Ga</italic>(shape, rate) indicates a Gamma distribution. The superscript <italic>ss</italic> denotes the steady-state value of the corresponding variable in the absence of input to neuron model. The proper values for <inline-formula id="pcbi.1004736.e024"><alternatives><graphic id="pcbi.1004736.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e024" xlink:type="simple"/>
<mml:math display="inline" id="M24"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:math>
</alternatives></inline-formula> (in terms of <inline-formula id="pcbi.1004736.e025"><alternatives><graphic id="pcbi.1004736.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e025" xlink:type="simple"/>
<mml:math display="inline" id="M25"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math>
</alternatives></inline-formula>) can be found in <xref ref-type="table" rid="pcbi.1004736.t001">Table 1</xref>.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>For inference, we use a recently developed approximate (variational) Bayesian inference approach [<xref ref-type="bibr" rid="pcbi.1004736.ref031">31</xref>] for stochastic, nonlinear state-space models, i.e. discretized stochastic nonlinear dynamic systems. In the following, we refer to this variational Bayesian approach as VB-Laplace. This approach performs efficient and robust parameter estimation even if both the evolution and observation equations (as with the proposed calcium imaging model) are nonlinear. As the framework enables analytical update equations, the method is generic and efficient in terms of computation time. Critically, the approach also enables the estimation of parameters (e.g., calcium decay time-constant) and precision-parameters, e.g. noise level on fluorescence trace. As we will show below, this is important for the application to calcium imaging data. As with any Bayesian approach, the method relies on the specification of the prior distributions of the parameters. This is useful because the generative model is biophysical and plausible prior knowledge can be derived directly from previous modelling and experimental studies.</p>
<p>The generative model is defined in terms of its state (i.e. evolution) and observation (i.e. likelihood) equations:
<disp-formula id="pcbi.1004736.e026">
<alternatives>
<graphic id="pcbi.1004736.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e026" xlink:type="simple"/>
<mml:math display="block" id="M26">
<mml:mrow><mml:mtext>Generative model</mml:mtext><mml:mo>:</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
where <italic>x</italic> denote the states of neuronal dynamics such as <italic>V</italic> and [Ca<sup>2+</sup>], <italic>y</italic><sub><italic>t</italic></sub> refers to the fluorescence responses, <italic>θ</italic> and <italic>φ</italic> are quantities that parameterize the state evolution function <italic>f</italic> and observation function <italic>g</italic>, respectively, and <italic>u</italic><sub><italic>t</italic></sub> is the synaptic (or applied) input time series to the membrane. In this generic formalism, <italic>η</italic><sub><italic>t</italic></sub> denotes state-noise with precision (i.e., inverse variance) <italic>α</italic> and <italic>ε</italic><sub><italic>t</italic></sub> denotes measurement-noise with precision <italic>σ</italic>. The both random variables are drawn from zero-mean Gaussians: <italic>η</italic><sub><italic>t</italic></sub> ∼ <italic>N</italic>(0,(<italic>α</italic>ϒ<sub><italic>x</italic></sub>)<sup>−1</sup>) and <italic>ε</italic><sub><italic>t</italic></sub> ∼ <italic>N</italic>(0,(<italic>σ</italic>ϒ<sub><italic>y</italic></sub>)<sup>−1</sup>), where ϒ<sub><italic>x</italic></sub> and ϒ<sub><italic>y</italic></sub> denote their corresponding inverse covariance matrices. The state equations (<xref ref-type="disp-formula" rid="pcbi.1004736.e026">Eq 1</xref>) are derived from a set of first-order nonlinear differential equations which formulate the interaction between the underlying neuronal mechanisms. By integrating these equations and passing the [Ca<sup>2+</sup>] states through the observer equation, <italic>F</italic><sub><italic>t</italic></sub> traces are generated. This operator is assumed to be a saturating (nonlinear) function.</p>
<p>In what follows, we use <xref ref-type="disp-formula" rid="pcbi.1004736.e026">Eq 1</xref> as the basis for all following models, where the evolution and observation functions are specified in detail to derive several models that we used to analyze calcium imaging data. One guiding principle for the following selection of biophysical models is that we prefer models with low complexity and dimensionality, i.e. a low number of parameters and variables. Theoretical considerations and preliminary analyses showed that it is unlikely that all parameters of highly detailed, complex models can be inferred from fluorescence traces, which are temporally smooth in comparison to spike data.</p>
</sec>
<sec id="sec004">
<title>Evolution functions</title>
<p>Evolution functions are the neuronal models which formulate the neuron biophysics; they link the dynamic change in the membrane potential (in response to input) to the [Ca<sup>2+</sup>] kinetics. These models are comprised of three units: (i) a spiking model which (mainly) governs the membrane potential, (ii) a model for the mechanism of HVA calcium channels where the membrane potential controls the amount of calcium current entering the neuron, and (iii) an equation to model the modulation of [Ca<sup>2+</sup>] due to both the removal mechanisms of free cytoplasmic Ca<sup>2+</sup> and the change in calcium current. The resulting [Ca<sup>2+</sup>] kinetics will be used later in the observation equation in order to compute the fluorescence trace (see <xref ref-type="disp-formula" rid="pcbi.1004736.e048">Eq 12</xref>).</p>
</sec>
<sec id="sec005">
<title>Spiking models</title>
<p>Spiking models can be categorized broadly into two groups: single- and multi-compartment models. The spiking models reported in the literature, for example [<xref ref-type="bibr" rid="pcbi.1004736.ref029">29</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref032">32</xref>–<xref ref-type="bibr" rid="pcbi.1004736.ref037">37</xref>], can reproduce a wide-range of repetitive spiking and/or bursting firing patterns of neurons; for reviews see also [<xref ref-type="bibr" rid="pcbi.1004736.ref020">20</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref021">21</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref038">38</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref039">39</xref>]. Since the fluorescence traces we considered were extracted exclusively from the somata, it is a sufficient approximation here to adopt single-compartment models of the cell body. In principle, any model based on differential equations can be used as a generative model of spikes. To show this anecdotally but also to investigate whether there is any particular model that may be best suited for modelling calcium transients, we selected three different models. We used two repetitive spiking models (i.e., the Fitzhugh-Nagumo model and Quadratic-Gaussian integrate-and-fire (I&amp;F) model) with different model complexities (i.e., number of parameters and variables), as well as a model for compound spiking and/or bursting patterns (i.e., bursting-Quadratic-Gaussian I&amp;F). We motivate the choice of each of these three models, in the three next sections below.</p>
<p>In all spiking models considered next, the total input current to neuron is <italic>I</italic> = <italic>I</italic><sub><italic>app</italic></sub> + <italic>I</italic><sub><italic>syn</italic></sub>, where <italic>I</italic><sub><italic>app</italic></sub> and <italic>I</italic><sub><italic>syn</italic></sub> are applied and synaptic currents, respectively.</p>
<sec id="sec006">
<title>FitzHugh-Nagumo Model (FHN)</title>
<p>The FitzHugh-Nagumo model is a two-dimensional reduction of the Hodgkin-Huxley (HH) model and is one of the most widely-used models of spike generation [<xref ref-type="bibr" rid="pcbi.1004736.ref040">40</xref>–<xref ref-type="bibr" rid="pcbi.1004736.ref042">42</xref>]. Unlike the HH model, which has four dynamical variables with highly nonlinear equations, the FHN model is based only on a 2D system of equations with less nonlinearities. This reduced complexity and dimensionality motivated our choice of the FHN model, rather than the HH model. The FHN model describes the spike generation by two equations:
<disp-formula id="pcbi.1004736.e027">
<alternatives>
<graphic id="pcbi.1004736.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e027" xlink:type="simple"/>
<mml:math display="block" id="M27">
<mml:mrow><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>V</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow/><mml:mn>3</mml:mn></mml:msubsup></mml:mrow><mml:mn>3</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:mi>I</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
<disp-formula id="pcbi.1004736.e028">
<alternatives>
<graphic id="pcbi.1004736.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e028" xlink:type="simple"/>
<mml:math display="block" id="M28">
<mml:mrow><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>W</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where parameters <italic>λ</italic>, <italic>ψ</italic><sub>1</sub> and <italic>ψ</italic><sub>2</sub> are constants, <italic>V</italic> denotes the membrane potential, and <italic>W</italic> denotes the recovery variable of the membrane; <italic>V</italic> and <italic>W</italic> are dimensionless variables that have biophysical roles and time scales similar to the voltage-gated ionic channels (e.g. activation of K<sup>+</sup>, and inactivation of Na<sup>+</sup> channels) in the HH model [<xref ref-type="bibr" rid="pcbi.1004736.ref035">35</xref>]. Note that the FHN model does not fire all-or-none spikes. Depending on the input strength, it may generate subthreshold responses, or partial- or full-amplitude spikes [<xref ref-type="bibr" rid="pcbi.1004736.ref041">41</xref>]. As a consequence, similarly to the HH model, no well-defined firing threshold exists in the FHN model [<xref ref-type="bibr" rid="pcbi.1004736.ref041">41</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref043">43</xref>].</p>
</sec>
<sec id="sec007">
<title>Quadratic-Gaussian Integrate-and-Fire model (QGIF)</title>
<p>For a further reduction of model complexity, we can use single-variable (i.e. 1D) spiking models instead of the 2D FHN model. The 1D models such as standard I&amp;F model [<xref ref-type="bibr" rid="pcbi.1004736.ref044">44</xref>–<xref ref-type="bibr" rid="pcbi.1004736.ref047">47</xref>], or its analogues [<xref ref-type="bibr" rid="pcbi.1004736.ref048">48</xref>] use the membrane potential as the only dynamical variable to generate spikes. From our perspective, the main drawback of these so-called hybrid models is their non-differentiability; that is, they demand (at least) one <italic>if</italic> condition due to the resetting of the membrane potential whenever a spike reaches its peak. The generative models in the presence of such a step function cannot be well inverted by our VB-Laplace method. To overcome this technical difficulty, we extended a quadratic I&amp;F model. The advantage of the quadratic I&amp;F model is its activity-dependent threshold (for non-zero inputs) and spike latency [<xref ref-type="bibr" rid="pcbi.1004736.ref021">21</xref>], as found experimentally. In addition, it produces the upstroke of a spike by the bistability of its resting and repetitive spiking states. Therefore, this model only requires one resetting condition which is used for hyperpolarizing the membrane potential at the spike’s peak. Furthermore, it is computationally affordable [<xref ref-type="bibr" rid="pcbi.1004736.ref049">49</xref>] when compared to other nonlinear alternatives such as exponential I&amp;F model [<xref ref-type="bibr" rid="pcbi.1004736.ref048">48</xref>]. In summary, by adapting this hybrid model [<xref ref-type="bibr" rid="pcbi.1004736.ref048">48</xref>] we created a novel 1D spiking model (i.e. the quadratic-Gaussian I&amp;F (QGIF) model) without any discontinuous reset condition. This makes the model differentiable and invertible with the proposed Bayesian approach. The membrane potential in the QGIF model is governed by the following equations:
<disp-formula id="pcbi.1004736.e029">
<alternatives>
<graphic id="pcbi.1004736.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e029" xlink:type="simple"/>
<mml:math display="block" id="M29">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>C</mml:mi><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>γ</mml:mi></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>I</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
where <italic>C</italic> denotes the membrane capacitance, <italic>g</italic><sub><italic>L</italic></sub> the leak conductance, <italic>I</italic><sub><italic>L</italic></sub> the leak current, and <italic>E</italic><sub><italic>L</italic></sub> the leak reversal potential. Finally, <italic>f</italic><sub><italic>sp</italic></sub>(<italic>V</italic>) and <italic>f</italic><sub><italic>rep</italic></sub>(<italic>V</italic>) are the functions which describe the currents relating to the spiking- and repolarization-phases of each spike, respectively. In this model we set the parameter <italic>γ</italic> equal to <italic>dt</italic> / <italic>C</italic>, where <italic>dt</italic> denotes the integration time-step size. Following [<xref ref-type="bibr" rid="pcbi.1004736.ref048">48</xref>], we defined the spike-generating function by a quadratic function:
<disp-formula id="pcbi.1004736.e030">
<alternatives>
<graphic id="pcbi.1004736.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e030" xlink:type="simple"/>
<mml:math display="block" id="M30">
<mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
where Δ<sub><italic>th</italic></sub> denotes the spike slope factor, and <italic>I</italic><sub><italic>th</italic></sub> the threshold current which corresponds to the voltage threshold <italic>V</italic><sub><italic>th</italic></sub>. After generating a spike, the original quadratic I&amp;F models, for example [<xref ref-type="bibr" rid="pcbi.1004736.ref048">48</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref050">50</xref>], use a reset of <italic>V</italic> while we use here a repolarization function which exerts an instantaneous repolarization that lasts for one time bin <italic>dt</italic>; the resulting intrinsic continuity in the membrane potential renders our spiking model non-hybrid. We formulate this function as a combination of a delta-like Gaussian and a steep sigmoid function:
<disp-formula id="pcbi.1004736.e031">
<alternatives>
<graphic id="pcbi.1004736.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e031" xlink:type="simple"/>
<mml:math display="block" id="M31">
<mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msqrt><mml:mi>π</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>V</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
<disp-formula id="pcbi.1004736.e032">
<alternatives>
<graphic id="pcbi.1004736.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e032" xlink:type="simple"/>
<mml:math display="block" id="M32">
<mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
where <italic>a</italic><sub><italic>rep</italic></sub>, <italic>σ</italic><sub><italic>peak</italic></sub>, <italic>b</italic><sub><italic>rep</italic></sub> and <italic>c</italic><sub><italic>rep</italic></sub> denote the generic shape parameters of these functions, <italic>V</italic><sub><italic>peak</italic></sub> denotes the height of the spike’s peak, and <inline-formula id="pcbi.1004736.e033"><alternatives><graphic id="pcbi.1004736.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e033" xlink:type="simple"/>
<mml:math display="inline" id="M33"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math>
</alternatives></inline-formula> denotes the size of the following repolarization after each spike. In our parameterization for this model, the value assigned to <inline-formula id="pcbi.1004736.e034"><alternatives><graphic id="pcbi.1004736.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e034" xlink:type="simple"/>
<mml:math display="inline" id="M34"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math>
</alternatives></inline-formula> shifts the membrane potential to more negative voltages than the resting potential <italic>V</italic><sub><italic>rest</italic></sub> to model the hyperpolarization-phase of the spike. The QGIF model (also its bursting version; see below) is able to exhibit reasonable neuronal responses to both constant and fluctuating (synaptic) inputs. <xref ref-type="fig" rid="pcbi.1004736.g001">Fig 1B</xref> shows the response of this model to a sustained applied current.</p>
</sec>
<sec id="sec008">
<title>Bursting-Quadratic-Gaussian Integrate-and-Fire model (bursting-QGIF)</title>
<p>Many neurons fire bursts of spikes, for a review see [<xref ref-type="bibr" rid="pcbi.1004736.ref051">51</xref>]. The bursts are thought to play an important role in neural information transmission [<xref ref-type="bibr" rid="pcbi.1004736.ref028">28</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref051">51</xref>–<xref ref-type="bibr" rid="pcbi.1004736.ref054">54</xref>]. These firing patterns may also be intermixed by those of repetitive single spikes [<xref ref-type="bibr" rid="pcbi.1004736.ref028">28</xref>]. In this work, we aim at the precise reconstruction of the within-burst spikes from fluorescence traces. As a representative, we will demonstrate such reconstruction for the somatic bursts of hippocampal pyramidal neurons [<xref ref-type="bibr" rid="pcbi.1004736.ref028">28</xref>–<xref ref-type="bibr" rid="pcbi.1004736.ref030">30</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref055">55</xref>]. To do this, we require a model with low complexity (for inversion) but coverage of the important biophysics of these neurons. For this purpose, we adapted the QGIF model of the previous section to derive a bursting-QGIF model by incorporating the non-inactivating muscarinic-sensitive (M-type) K<sup>+</sup> and persistent Na<sup>+</sup> currents (<italic>I</italic><sub><italic>M</italic></sub> and <italic>I</italic><sub><italic>NaP</italic></sub>, respectively). The contribution of these currents to bursting activity of hippocampal pyramidal neurons has been already reported [<xref ref-type="bibr" rid="pcbi.1004736.ref056">56</xref>–<xref ref-type="bibr" rid="pcbi.1004736.ref059">59</xref>]. In brief, the slow activation of <italic>I</italic><sub><italic>M</italic></sub> during the bursting period is likely to be involved in the burst termination, and the increase of <italic>I</italic><sub><italic>NaP</italic></sub> can give rise to bursts as well as an increase in the number of spikes per burst. We followed [<xref ref-type="bibr" rid="pcbi.1004736.ref057">57</xref>] for both formulating and setting the parameters of these currents. Overall, the current balance equation for the bursting-QGIF model is given by:
<disp-formula id="pcbi.1004736.e035">
<alternatives>
<graphic id="pcbi.1004736.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e035" xlink:type="simple"/>
<mml:math display="block" id="M35">
<mml:mrow><mml:mi>C</mml:mi><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>η</mml:mi></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004736.e036">
<alternatives>
<graphic id="pcbi.1004736.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e036" xlink:type="simple"/>
<mml:math display="block" id="M36">
<mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>∞</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>75</mml:mn></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004736.e037">
<alternatives>
<graphic id="pcbi.1004736.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e037" xlink:type="simple"/>
<mml:math display="block" id="M37">
<mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mi>∞</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula>
<disp-formula id="pcbi.1004736.e038">
<alternatives>
<graphic id="pcbi.1004736.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e038" xlink:type="simple"/>
<mml:math display="block" id="M38">
<mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004736.e039">
<alternatives>
<graphic id="pcbi.1004736.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e039" xlink:type="simple"/>
<mml:math display="block" id="M39">
<mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>∞</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>V</mml:mi><mml:mo>+</mml:mo><mml:mn>41</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow/><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004736.e040">
<alternatives>
<graphic id="pcbi.1004736.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e040" xlink:type="simple"/>
<mml:math display="block" id="M40">
<mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>∞</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>V</mml:mi><mml:mo>+</mml:mo><mml:mn>39</mml:mn></mml:mrow><mml:mn>5</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow/><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>z</italic><sub>∞</sub> and <italic>r</italic><sub>∞</sub> denote the steady-state activation values for gating variables of <italic>I</italic><sub><italic>M</italic></sub> and <italic>I</italic><sub><italic>NaP</italic></sub>, and <italic>E</italic><sub><italic>K</italic></sub> and <italic>E</italic><sub><italic>Na</italic></sub> (resp. <italic>g</italic><sub><italic>M</italic></sub> and <italic>g</italic><sub><italic>NaP</italic></sub>) denote the reversal potentials (resp. the maximal conductances) of these currents. The slow gating variable <italic>z</italic> is the probability of activation of <italic>I</italic><sub><italic>M</italic></sub>. Note that the inference may assign negative values to this variable; this would lack physical meaning. In order to constrain the solution, without qualitatively changing the dynamics, we reformulate the model using a first-order Euler method, see also [<xref ref-type="bibr" rid="pcbi.1004736.ref060">60</xref>]:
<disp-formula id="pcbi.1004736.e041">
<alternatives>
<graphic id="pcbi.1004736.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e041" xlink:type="simple"/>
<mml:math display="block" id="M41">
<mml:mrow><mml:msubsup><mml:mi>z</mml:mi><mml:mrow/><mml:mrow><mml:mi>a</mml:mi><mml:mi>u</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>z</mml:mi><mml:mrow/><mml:mrow><mml:mi>a</mml:mi><mml:mi>u</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>75</mml:mn></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>∞</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>z</mml:mi><mml:mrow/><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004736.e042">
<alternatives>
<graphic id="pcbi.1004736.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e042" xlink:type="simple"/>
<mml:math display="block" id="M42">
<mml:mrow><mml:mi>z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>z</mml:mi><mml:mrow/><mml:mrow><mml:mi>a</mml:mi><mml:mi>u</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula>
<disp-formula id="pcbi.1004736.e043">
<alternatives>
<graphic id="pcbi.1004736.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e043" xlink:type="simple"/>
<mml:math display="block" id="M43">
<mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where we expressed the dynamics of the gating variable <italic>z</italic> in terms of the variable <italic>z</italic><sup><italic>aux</italic></sup> to constrain <italic>z</italic> to the interval [0,1], thereby providing biophysically interpretable states for the activation of <italic>I</italic><sub><italic>M</italic></sub>. Parameter <italic>O</italic> can be set properly to retain numerical stability. Furthermore, the bursting-QGIF model can account for a variety of firing patterns which were reported by previous electrophysiological experiments, for example [<xref ref-type="bibr" rid="pcbi.1004736.ref030">30</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref037">37</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref056">56</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref057">57</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref059">59</xref>]. <xref ref-type="fig" rid="pcbi.1004736.g001">Fig 1C</xref> shows a typical bursting voltage trace of this model when stimulated by a sustained applied current. In <xref ref-type="fig" rid="pcbi.1004736.g002">Fig 2</xref>, we provide a more detailed assessment of this model.</p>
<fig id="pcbi.1004736.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004736.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Assessment of biophysical aspects of the bursting-QGIF model.</title>
<p>(<bold>A</bold>-<bold>C</bold>) Simulated voltage traces of the bursting-QGIF model in response to (<bold>A</bold>) sustained (not shown) and (<bold>B</bold>) brief square (magenta line) positive current pulses, and (<bold>C</bold>) a sinusoidal input current (magenta line). (<bold>A</bold>) The increment in persistent Na<sup>+</sup> current enhances the burstiness, similarly to [<xref ref-type="bibr" rid="pcbi.1004736.ref057">57</xref>]: As <italic>g</italic><sub><italic>NaP</italic></sub> increases, the number of spikes within each burst is increased, and the interspike intervals become shorter. Note that as expected biophysically the model exhibits a tonic repetitive spiking pattern for weak <italic>g</italic><sub><italic>NaP</italic></sub> densities. (<bold>B</bold>) M-type K<sup>+</sup> current governs the recovery mechanism for membrane potential, similarly to [<xref ref-type="bibr" rid="pcbi.1004736.ref057">57</xref>]: Blocking the M-type K<sup>+</sup> channel by setting <italic>g</italic><sub><italic>M</italic></sub> = 0 leads to a prolonged burst in response to a short-duration depolarized current pulse (magenta line). This indicates that the activation of this channel is important for terminating the bursts. (<bold>C</bold>) The bursting-QGIF model is selective in the input slope, similarly to [<xref ref-type="bibr" rid="pcbi.1004736.ref053">53</xref>]: the periodic burst response of the model to a sinusoidal input current shows that the burst are mainly initiated on the positive slope of the input (magenta line) thus signalling the input slope. The conductances and currents across <bold>A</bold>-<bold>C</bold> are in units of [<italic>mS</italic> / <italic>cm</italic><sup>2</sup>] and [<italic>μA</italic> / <italic>cm</italic><sup>2</sup>], respectively; input currents are in arbitrary units. Parameters for the simulation: (<bold>A</bold>-<bold>C</bold>) <inline-formula id="pcbi.1004736.e044"><alternatives><graphic id="pcbi.1004736.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e044" xlink:type="simple"/>
<mml:math display="inline" id="M44"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>80</mml:mn><mml:mspace width="0.25em"/><mml:mi>μ</mml:mi><mml:mi>A</mml:mi><mml:mspace width="0.25em"/><mml:mi>m</mml:mi><mml:mi>S</mml:mi><mml:mo>/</mml:mo><mml:mi>μ</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:math>
</alternatives></inline-formula>, (<bold>A</bold>) <italic>I</italic><sub><italic>app</italic></sub> = 1, (<bold>B</bold>) <italic>I</italic><sub><italic>app</italic></sub> = 0.6, (<bold>C</bold>) <italic>I</italic><sub><italic>app</italic></sub> = 2.5sin(0.03<italic>t</italic>) <italic>μA</italic> / <italic>cm</italic><sup>2</sup>. See <xref ref-type="table" rid="pcbi.1004736.t001">Table 1</xref> for the rest of parameter values.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.g002" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec009">
<title>Calcium dynamics</title>
<sec id="sec010">
<title>Calcium channels</title>
<p>Voltage-gated calcium channels have been categorized into high- and low-voltage-activated (HVA and LVA, respectively) channels [<xref ref-type="bibr" rid="pcbi.1004736.ref061">61</xref>], for a review see [<xref ref-type="bibr" rid="pcbi.1004736.ref001">1</xref>]. Unlike LVA (T-type) calcium channels, somatic calcium transients due to spikes are known to be largely mediated by HVA calcium channels (L-, N-, P/Q-, and R-type) whose activation threshold is considerably more positive than typical resting membrane potentials [<xref ref-type="bibr" rid="pcbi.1004736.ref005">5</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref062">62</xref>]. Importantly, it has been found for hippocampal CA3 neurons that L-type calcium channels are predominantly localized in somata, and have a major role in somatic calcium transients [<xref ref-type="bibr" rid="pcbi.1004736.ref063">63</xref>]. In our experiment the region of interest for extracting the fluorescence traces was also restricted to cell bodies. In addition, previous studies reported that in recorded fluorescence traces there is nearly no evidence for subthreshold fluctuations in the membrane potential [<xref ref-type="bibr" rid="pcbi.1004736.ref005">5</xref>]. Consequently, we assumed that the recorded fluorescence transients relate to the surge of Ca<sup>2+</sup> through L-type channels. To model these channels, we followed [<xref ref-type="bibr" rid="pcbi.1004736.ref064">64</xref>], as the underlying mechanisms in the chosen parameter regime (see <xref ref-type="table" rid="pcbi.1004736.t001">Table 1</xref>) are comparable to the Cav 1.2 and Cav 1.3 forms of the L-type calcium channels [<xref ref-type="bibr" rid="pcbi.1004736.ref065">65</xref>]. In addition, the model has less complexity as compared to other models proposed for L-type calcium channels; for a review see [<xref ref-type="bibr" rid="pcbi.1004736.ref066">66</xref>]. Overall, this model [<xref ref-type="bibr" rid="pcbi.1004736.ref064">64</xref>] formulates the calcium current, <italic>I</italic><sub><italic>Ca</italic></sub>, across the membrane as:
<disp-formula id="pcbi.1004736.e045">
<alternatives>
<graphic id="pcbi.1004736.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e045" xlink:type="simple"/>
<mml:math display="block" id="M45">
<mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mi>∞</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula>
where <italic>g</italic><sub><italic>Ca</italic></sub> and <italic>E</italic><sub><italic>Ca</italic></sub> denote the corresponding maximal conductance and reversal potential, respectively. The steady-state voltage-dependent activation of this channel, <italic>s</italic><sub>∞</sub>, is described by the Boltzmann function (see also [<xref ref-type="bibr" rid="pcbi.1004736.ref064">64</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref067">67</xref>]):
<disp-formula id="pcbi.1004736.e046">
<alternatives>
<graphic id="pcbi.1004736.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e046" xlink:type="simple"/>
<mml:math display="block" id="M46">
<mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>∞</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow/><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula>
which is characterized by a half-activation voltage, <italic>V</italic><sub>1/2</sub>, and a slope factor, <italic>ρ</italic>. This model formulates <italic>I</italic><sub><italic>Ca</italic></sub> as a non-inactivating current whose activation is an instantaneous function of the membrane potential.</p>
<p>Eqs <xref ref-type="disp-formula" rid="pcbi.1004736.e045">9</xref> and <xref ref-type="disp-formula" rid="pcbi.1004736.e046">10</xref> are based on the biophysical ranges of the membrane potential. However according to the parameter regime of the FHN model (see <xref ref-type="table" rid="pcbi.1004736.t001">Table 1</xref>) each full spike in this model has a peak and undershoot of 2 and -2, respectively. Therefore, the voltage will be scaled as: <italic>ι</italic><sub>1</sub><italic>V</italic>−<italic>ι</italic><sub>2</sub>, where we set <italic>ι</italic><sub>1</sub> = 30 and <italic>ι</italic><sub>2</sub> = 40. Note that the QGIF models are already in a biologically plausible range; for example, in the QGIF model each spike has a peak around 30 <italic>mV</italic> followed by a hyperpolarization at around -80 <italic>mV</italic>.</p>
</sec>
<sec id="sec011">
<title>[Ca<sup>2+</sup>] kinetics</title>
<p>The equation of [Ca<sup>2+</sup>] kinetics is given in [<xref ref-type="bibr" rid="pcbi.1004736.ref068">68</xref>] as:
<disp-formula id="pcbi.1004736.e047">
<alternatives>
<graphic id="pcbi.1004736.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e047" xlink:type="simple"/>
<mml:math display="block" id="M47">
<mml:mrow><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">[</mml:mo><mml:mi>C</mml:mi><mml:msubsup><mml:mi>a</mml:mi><mml:mrow/><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mtext>Ca</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mtext>Ca</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula>
where the opening of the calcium channels elevates the cytosolic [Ca<sup>2+</sup>] using entry via <italic>I</italic><sub><italic>Ca</italic></sub>, which subsequently decays back down to its basal concentration, [Ca<sup>2+</sup>]<sub>base</sub>, by time-constant <italic>τ</italic><sub><italic>Ca</italic></sub>. Parameter <italic>κ</italic><sub><italic>Ca</italic></sub> converts the calcium current to calcium concentration (per time unit), and also scales the amplitude of the calcium transient during the activation of the channel. The negative sign of <italic>I</italic><sub><italic>Ca</italic></sub> renders it an inward current. Note that the decay kinetics of the calcium transient reflect the decline in [Ca<sup>2+</sup>] as a result of different pumping and buffering mechanisms; for a review see [<xref ref-type="bibr" rid="pcbi.1004736.ref001">1</xref>].</p>
</sec>
</sec>
<sec id="sec012">
<title>The observation model</title>
<p>The transformation between [Ca<sup>2+</sup>] kinetics and fluorescence responses can be described by a saturating Hill-type function [<xref ref-type="bibr" rid="pcbi.1004736.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref069">69</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref070">70</xref>]:
<disp-formula id="pcbi.1004736.e048">
<alternatives>
<graphic id="pcbi.1004736.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e048" xlink:type="simple"/>
<mml:math display="block" id="M48">
<mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mtext>Ca</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>κ</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mtext>Ca</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mtext>Ca</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>F</mml:mi></mml:msub></mml:mrow>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula>
where <italic>κ</italic><sub><italic>F</italic></sub> and <italic>d</italic><sub><italic>F</italic></sub> are scale and offset parameters for the fluorescence trace and parameter <italic>K</italic><sub><italic>d</italic></sub> is the so-called dissociation constant [<xref ref-type="bibr" rid="pcbi.1004736.ref026">26</xref>], a quantitative measure of the affinity of the fluorescent indicator to calcium.</p>
<p>In practice, for each fluorescence trace, we estimate the measurement SNR by dividing the minimum amplitude of the fluorescence transient by the standard deviation (std) of the baseline fluorescence, similarly to [<xref ref-type="bibr" rid="pcbi.1004736.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref069">69</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref071">71</xref>].</p>
</sec>
<sec id="sec013">
<title>Summary: The full generative model</title>
<p>In brief, each generative model (<xref ref-type="disp-formula" rid="pcbi.1004736.e026">Eq 1</xref>) is a combination of the equations for a spiking model, the HVA calcium channel (Eqs <xref ref-type="disp-formula" rid="pcbi.1004736.e045">9</xref> and <xref ref-type="disp-formula" rid="pcbi.1004736.e046">10</xref>), [Ca<sup>2+</sup>] kinetics (<xref ref-type="disp-formula" rid="pcbi.1004736.e047">Eq 11</xref>), and the observation (<xref ref-type="disp-formula" rid="pcbi.1004736.e048">Eq 12</xref>). As spiking models we use the FHN model, (<xref ref-type="disp-formula" rid="pcbi.1004736.e027">Eq 2</xref>), and the family of differentiable integrate-and-fire models, for single spikes (QGIF, Eqs <xref ref-type="disp-formula" rid="pcbi.1004736.e029">3</xref>–<xref ref-type="disp-formula" rid="pcbi.1004736.e032">6</xref>), and spike bursts (bursting-QGIF, Eqs <xref ref-type="disp-formula" rid="pcbi.1004736.e030">4</xref>–<xref ref-type="disp-formula" rid="pcbi.1004736.e037">7</xref>), see also <xref ref-type="table" rid="pcbi.1004736.t003">Table 3</xref> for an overview. The parameter values for all models have been summarized in <xref ref-type="table" rid="pcbi.1004736.t001">Table 1</xref>, or are indicated in the figure captions of the Results section below. More details are available in the <xref ref-type="supplementary-material" rid="pcbi.1004736.s001">S1 Appendix</xref>.</p>
<table-wrap id="pcbi.1004736.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004736.t003</object-id>
<label>Table 3</label> <caption><title>Generative models.</title></caption>
<alternatives>
<graphic id="pcbi.1004736.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.t003" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"/>
<th align="center"/>
<th align="center">Spiking models</th>
<th align="center"/>
<th align="center">Calcium channel</th>
<th align="center"/>
<th align="center">[Ca<sup>2+</sup>] kinetics</th>
<th align="center"/>
<th align="center">Ca<sup>2+</sup> -fluorescence mapping</th>
<th align="center"/>
<th align="center">Generative model’s name</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><xref ref-type="disp-formula" rid="pcbi.1004736.e026">Eq 1</xref></td>
<td align="center"><bold>{</bold></td>
<td align="center"><bold>QGIF</bold> (Eqs <xref ref-type="disp-formula" rid="pcbi.1004736.e029">3</xref>–<xref ref-type="disp-formula" rid="pcbi.1004736.e032">6</xref>)</td>
<td align="center">+</td>
<td align="center">Eqs <xref ref-type="disp-formula" rid="pcbi.1004736.e045">9</xref>–<xref ref-type="disp-formula" rid="pcbi.1004736.e046">10</xref></td>
<td align="center">+</td>
<td align="center"><xref ref-type="disp-formula" rid="pcbi.1004736.e047">Eq 11</xref></td>
<td align="center">+</td>
<td align="center"><xref ref-type="disp-formula" rid="pcbi.1004736.e048">Eq 12</xref></td>
<td align="center"><bold>}</bold> =</td>
<td align="center"><bold>QGIF</bold></td>
</tr>
<tr>
<td align="center"/>
<td align="center"/>
<td align="center"><bold>Bursting-QGIF</bold> (Eqs <xref ref-type="disp-formula" rid="pcbi.1004736.e030">4</xref>–<xref ref-type="disp-formula" rid="pcbi.1004736.e037">7</xref>)</td>
<td align="center"/>
<td align="center"/>
<td align="center"/>
<td align="center"/>
<td align="center"/>
<td align="center"/>
<td align="center"/>
<td align="center"><bold>Bursting-QGIF</bold></td>
</tr>
<tr>
<td align="center"/>
<td align="center"/>
<td align="center"><bold>FHN</bold> (<xref ref-type="disp-formula" rid="pcbi.1004736.e027">Eq 2</xref>)</td>
<td align="center"/>
<td align="center"/>
<td align="center"/>
<td align="center"/>
<td align="center"/>
<td align="center"/>
<td align="center"/>
<td align="center"><bold>FHN</bold></td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t003fn001"><p>Overview of the three generative models QGIF (Quadratic-Gaussian integrate-and-fire) model, bursting-QGIF model, and Fitzhugh-Nagumo (FHN) model, and the equations required for their construction. The three models only differ in the spiking model.</p></fn>
</table-wrap-foot>
</table-wrap>
</sec>
<sec id="sec014">
<title>Bayesian inference</title>
<p>This section describes the main concepts of the VB-Laplace method, a Bayesian inference method for stochastic nonlinear state-space models [<xref ref-type="bibr" rid="pcbi.1004736.ref031">31</xref>]. The inference is based on a probabilistic generative model which quantitatively describes how observed data are generated. For a given generative model, say model <italic>m</italic> and data time series <italic>y</italic><sub><italic>t</italic></sub>, the task is to infer the moments of the posterior (the so-called conditional) distributions <italic>p</italic>(<italic>υ</italic>|<italic>y</italic><sub><italic>t</italic></sub>,<italic>m</italic>) for the parameters/variables of interest <italic>υ</italic> = {<italic>x</italic><sub><italic>t</italic></sub>,<italic>φ</italic>,<italic>θ</italic>,<italic>α</italic>,<italic>σ</italic>} (see <xref ref-type="disp-formula" rid="pcbi.1004736.e026">Eq 1</xref>), by using variational Bayes [<xref ref-type="bibr" rid="pcbi.1004736.ref072">72</xref>]. In this method the moments of the posterior distribution (conditional mean <italic>μ</italic> and covariance ∑) are updated iteratively by optimizing a free-energy lower bound, <italic>F</italic>(<italic>q</italic>,<italic>y</italic><sub><italic>t</italic></sub>), on the log-evidence (i.e. the logarithm of the model evidence) with respect to an approximate posterior density, <italic>q</italic>(<italic>υ</italic>). The free energy is the difference between the Kullback-Leibler divergence (denoted by <italic>D</italic><sub><italic>KL</italic></sub>(⋅||⋅)) of true and approximate posterior densities, and the log-evidence [<xref ref-type="bibr" rid="pcbi.1004736.ref072">72</xref>]:
<disp-formula id="pcbi.1004736.e049">
<alternatives>
<graphic id="pcbi.1004736.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e049" xlink:type="simple"/>
<mml:math display="block" id="M49">
<mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal">ln</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>υ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>υ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula></p>
<p>Variational Bayes aims at minimizing the Kullback-Leibler divergence so that the approximations to both posterior <italic>p</italic>(<italic>υ</italic>|<italic>y</italic><sub><italic>t</italic></sub>,<italic>m</italic>)≈<italic>q</italic>(<italic>υ</italic>) and log-evidence ln <italic>p</italic>(<italic>y</italic><sub><italic>t</italic></sub>|<italic>m</italic>) ≈ <italic>F</italic>(<italic>q</italic>,<italic>υ</italic>) become analytical (i.e. can be computed iteratively in a computationally efficient fashion). This minimization is equal to maximizing the free-energy, with respect to <italic>q</italic>(<italic>υ</italic>). Note that the divergence is a non-negative value (thus, the free-energy is a lower bound on the log-evidence), and <italic>q</italic><sub>exact</sub>(<italic>υ</italic>) = <italic>p</italic>(<italic>υ</italic>|<italic>y</italic><sub><italic>t</italic></sub>,<italic>m</italic>). The VB-Laplace method [<xref ref-type="bibr" rid="pcbi.1004736.ref031">31</xref>] inverts the generative model under two simplifying assumptions: (i) a mean-field separability assumption [<xref ref-type="bibr" rid="pcbi.1004736.ref073">73</xref>] which factorizes the <italic>q</italic>(<italic>υ</italic>) into the product of approximate marginal posterior densities, over the model unknown quantities (i.e. <italic>υ</italic>), and (ii) a Laplace approximation whereby each of these marginal densities (except those for precision-parameters) is approximated by a Gaussian density, namely <inline-formula id="pcbi.1004736.e050"><alternatives><graphic id="pcbi.1004736.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e050" xlink:type="simple"/>
<mml:math display="inline" id="M50"><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>υ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:msub><mml:mi>υ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>υ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
</alternatives></inline-formula>. The first assumption facilitates the iterative maximization of free energy, and the latter finesses the analytical intractability problem of the inference; this problem arises from the nonlinearities in the likelihood (i.e. observation) functions. To update the marginal densities, the VB-Laplace method uses an iterative regularized Gauss-Newton scheme [<xref ref-type="bibr" rid="pcbi.1004736.ref074">74</xref>]. The precision-parameters are updated without requiring the Laplace approximation. Furthermore, the update rules of the hidden states exploit a variational Bayesian Laplace treatment of the extended Kalman-Rauch filter/smoother. Conceptually, given the full data time series, these probabilistic filters evaluate the approximate marginal posterior density on the hidden-states time point by time point, i.e. <italic>q</italic><sub><italic>i</italic></sub>(<italic>x</italic><sub><italic>t</italic></sub>|<italic>y</italic><sub>1:T</sub>), instead of capturing the full joint density over the whole time series, i.e. <italic>q</italic><sub><italic>i</italic></sub>(<italic>x</italic><sub>1:T</sub>|<italic>y</italic><sub>1:T</sub>). Therefore, the VB-Laplace method can control the lagged Kalman forward pass [<xref ref-type="bibr" rid="pcbi.1004736.ref031">31</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref075">75</xref>] by specifying to what extent this lag, <italic>k</italic>, is going to be applied. That is, for time <italic>t</italic>, this scheme approximates the lagged posterior density, <italic>p</italic><sub><italic>i</italic></sub>(<italic>x</italic><sub><italic>t</italic></sub>|<italic>y</italic><sub>1:<italic>t</italic>+<italic>k</italic></sub>,<italic>m</italic>), by making inference on hidden-state at the current time, i.e. <italic>x</italic><sub><italic>t</italic></sub>, after observing all data up to time <italic>t</italic> + <italic>k</italic>, i.e. <italic>y</italic><sub>1:<italic>t</italic>+<italic>k</italic></sub>. This step should (in general) improve the precision and the temporal smoothness of the inference on the hidden states. For full details of the VB-Laplace method we point the interested reader to [<xref ref-type="bibr" rid="pcbi.1004736.ref031">31</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref060">60</xref>].</p>
<p>All Bayesian inference procedures described in this study have been implemented as Matlab (MathWorks) code in the VBA toolbox (<ext-link ext-link-type="uri" xlink:href="http://mbb-team.github.io/VBA-toolbox/" xlink:type="simple">http://mbb-team.github.io/VBA-toolbox/</ext-link>) developed by Jean Daunizeau and colleagues.</p>
</sec>
<sec id="sec015">
<title>Experimental methods</title>
<p>The experimental data recorded in our lab were six <italic>in vitro</italic> fluorescence traces for which simultaneous electrophysiological recordings (thus, veridical spike times) were also acquired.</p>
</sec>
<sec id="sec016">
<title>Preparation of acute brain slices</title>
<p>All experimental procedures were carried out with approval by the local government and complied with international and European Union norms. Experiments were performed on acute brain slices prepared from C57BL/6J mice at postnatal day (P) 3–4 (P0 –day of birth). Animals were decapitated under deep isoflurane anesthesia. The brain was removed quickly and transferred into ice-cold saline containing (in <italic>mM</italic>): 125 NaCl, 4 KCl, 10 glucose, 1.25 NaH<sub>2</sub>PO<sub>4</sub>, 25 NaHCO<sub>3</sub>, 0.5 CaCl<sub>2</sub>, and 2.5 MgCl<sub>2</sub>, bubbled with 5% CO<sub>2</sub>/95% O<sub>2</sub> (pH = 7.4). Horizontal slices (350 <italic>μm</italic>) comprising the CA3 region of the hippocampus were cut on a vibratome (VT1200 S, Leica) and stored for at least 1h before use at room temperature in artificial cerebrospinal fluid (ACSF) containing (in <italic>mM</italic>): 125 NaCl, 4 KCl, 10 glucose, 1.25 NaH<sub>2</sub>PO<sub>4</sub>, 25 NaHCO<sub>3</sub>, 2 CaCl<sub>2</sub>, and 1 MgCl<sub>2</sub>, bubbled with 5% CO<sub>2</sub>/95% O<sub>2</sub> (pH = 7.4).</p>
</sec>
<sec id="sec017">
<title>Simultaneous confocal Ca<sup>2+</sup> imaging and electrophysiological recordings</title>
<p>For recordings, slices were placed into a submerged-type recording chamber on the stage of an Eclipse FN1 microscope (Nikon). Cells were loaded with the AM-ester of the Ca<sup>2+</sup> indicator Oregon Green 488 BAPTA-1 (OGB1, 340 <italic>μM</italic>) by pressure-ejection (30 <italic>s</italic>) from a glass pipette (3–6 <italic>M</italic>Ω) [<xref ref-type="bibr" rid="pcbi.1004736.ref076">76</xref>]. Fluorescence traces were acquired using a 16×/0.8 NA water-immersion objective (Nikon) at a frame rate of 22.6 <italic>Hz</italic> using a CSU10 Nipkow-disc scanning unit (Yokogawa) and a Rolera-XR camera (QImaging) controlled by the software Streampix 5 (Norpix). Excitation light at 488 <italic>nm</italic> was provided by a single wavelength solid-state laser (Sapphire CDRH-LP, Coherent). Electrophysiological signals were acquired using a Multiclamp 700B amplifier, a 16-bit AD/DA board (Digidata 1440A) and the software pClamp 10.4 (Molecular Devices). Signals were low-pass filtered at 3 <italic>kHz</italic> and sampled at 20 <italic>kHz</italic>. Loose-patch (seal resistance &lt; 1 <italic>G</italic>Ω) or tight-seal cell-attached recordings from cells in stratum pyramidale of the CA3 region were performed in voltage-clamp mode using borosilicate glass pipettes (8–12 <italic>M</italic>Ω) filled with 154 <italic>mM</italic> NaCl. Alexa Fluor 488 (25–75 <italic>μM</italic>) was frequently added for pipette visualization. Holding current was manually zeroed prior to each experiment. Brief LED light pulses were used to synchronize optical and electrophysiological signals. All experiments were performed at 32–34°C at an ACSF flow rate of ~3 ml min<sup>-1</sup>.</p>
</sec>
<sec id="sec018">
<title>Extraction of fluorescence traces</title>
<p>We extracted the “somatic” fluorescence traces from a set of fluorescence image sequences recorded from the hippocampal CA3 neurons (see previous section); <xref ref-type="fig" rid="pcbi.1004736.g003">Fig 3A</xref> depicts the mean frame of one of the recorded image sequences for the whole field of view. We then converted the traces to the relative fluorescence changes (<italic>F</italic><sub><italic>t</italic></sub> = Δ<italic>F</italic> / <italic>F</italic><sub>0</sub>) after subtraction of its resting (pre-stimulus) intensity level, <italic>F</italic><sub>0</sub> [<xref ref-type="bibr" rid="pcbi.1004736.ref077">77</xref>].</p>
<fig id="pcbi.1004736.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004736.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Field of view and low frequency temporal drifts.</title>
<p>(<bold>A</bold>) Sample average (over frames) Oregon Green BAPTA 1 (OGB-1) fluorescence image of a neuronal population from the CA3 area of a hippocampal slice. (<bold>B</bold>) An <italic>in vitro</italic> OGB-1 fluorescence trace before (blue line) and after (red line) removal of its slowly varying components, by using the fourth degree polynomial detrending method.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec019">
<title>Temporal drifts</title>
<p>A preliminary analysis of the recorded fluorescence traces (see <xref ref-type="sec" rid="sec015">Experimental methods</xref>) showed strong evidence of temporal low frequency drifts, which might be attributed to, for example, mechanical movements or photobleaching. In particular, we found (downward) drifts in the data lasting several hundred seconds (see <xref ref-type="fig" rid="pcbi.1004736.g003">Fig 3B</xref>, blue trace). This is far beyond the plausible ranges of calcium decay time-constants. Such low-frequency drifts have often been reported in time series of ECG and fMRI data, for example [<xref ref-type="bibr" rid="pcbi.1004736.ref078">78</xref>–<xref ref-type="bibr" rid="pcbi.1004736.ref080">80</xref>]. These drifts have commonly been treated as confounds, for example [<xref ref-type="bibr" rid="pcbi.1004736.ref081">81</xref>], because they can induce pronounced autocorrelation in the residual noise structures [<xref ref-type="bibr" rid="pcbi.1004736.ref082">82</xref>]. This autocorrelation may in turn decrease inference accuracy. Therefore, several methods have been suggested to remove low frequency drifts prior to analysis, for example [<xref ref-type="bibr" rid="pcbi.1004736.ref078">78</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref083">83</xref>]. Here, we decided to apply a fourth degree polynomial detrending method [<xref ref-type="bibr" rid="pcbi.1004736.ref078">78</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref084">84</xref>] to the fluorescence traces. Details for this method can be found in the <xref ref-type="supplementary-material" rid="pcbi.1004736.s002">S2 Appendix</xref>.</p>
</sec>
<sec id="sec020">
<title>Membrane potential thresholding</title>
<p>To extract the onset times of reconstructed firing events by the QGIF and FHN models (see <xref ref-type="sec" rid="sec026">Results</xref>), we threshold the inferred membrane potentials. For simplicity, we use as voltage threshold (which we used as spike detection threshold) the value zero. After a threshold event, we also discount any other threshold passing from negative to positive for the next 6 <italic>ms</italic> to prevent false spike detection from potential high frequency fluctuations in the inferred membrane potentials.</p>
</sec>
<sec id="sec021">
<title>Prior distributions</title>
<p>The Bayesian approach allows us to specify prior distributions to quantities of the generative model. Following [<xref ref-type="bibr" rid="pcbi.1004736.ref031">31</xref>], Gaussian prior distributions are assumed on both the evolution and observation parameters, and the initial conditions of hidden states. Each Gaussian prior is defined by its mean, <italic>μ</italic>, and covariance, ∑; the mean determines the prior expectation, and the covariance embodies the prior beliefs or information about the quantities of interest:
<disp-formula id="pcbi.1004736.e051">
<alternatives>
<graphic id="pcbi.1004736.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e051" xlink:type="simple"/>
<mml:math display="block" id="M51">
<mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004736.e052">
<alternatives>
<graphic id="pcbi.1004736.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e052" xlink:type="simple"/>
<mml:math display="block" id="M52">
<mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>φ</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>φ</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>φ</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula>
<disp-formula id="pcbi.1004736.e053">
<alternatives>
<graphic id="pcbi.1004736.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e053" xlink:type="simple"/>
<mml:math display="block" id="M53">
<mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where the upper index 0 denotes these moments belong to prior distributions. Moreover, the form of the evolution and observation equations (note the Gaussian state- and measurement- noises in <xref ref-type="disp-formula" rid="pcbi.1004736.e026">Eq 1</xref>) yields the Gaussian transition and likelihood densities, respectively:
<disp-formula id="pcbi.1004736.e054">
<alternatives>
<graphic id="pcbi.1004736.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e054" xlink:type="simple"/>
<mml:math display="block" id="M54">
<mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mi mathvariant="normal">ϒ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow/><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004736.e055">
<alternatives>
<graphic id="pcbi.1004736.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e055" xlink:type="simple"/>
<mml:math display="block" id="M55">
<mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>σ</mml:mi><mml:msub><mml:mi mathvariant="normal">ϒ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow/><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula></p>
<p>Hence, the mean and variance of the prior distribution on hidden states and observations can be assigned through the definition of the evolution and observation functions, and precision quantities. In addition, Gamma priors are used on precision-parameters, where each distribution is parameterized by its shape, <italic>a</italic>, and rate, <italic>b</italic>, parameters:
<disp-formula id="pcbi.1004736.e056">
<alternatives>
<graphic id="pcbi.1004736.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e056" xlink:type="simple"/>
<mml:math display="block" id="M56">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>σ</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mi>σ</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>σ</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula></p>
</sec>
<sec id="sec022">
<title>Parameters of interest</title>
<p>In the present models, there are five subsets of parameters: (i) calcium-dynamics-modulating parameters, (ii) membrane-potential-modulating parameters, (iii) initial conditions, (iv) observation parameters, and (v) precision-parameters. In the following, we motivate our choices for the prior distributions of these parameters. Not unexpectedly and due to the temporal smoothness of the fluorescence transients, our preliminary analyses revealed that the biophysical models are rather too complex and potentially over-fitting the data. To avoid over-parameterization, we therefore fixed several parameters to physiologically plausible values. Operationally, for a fixed parameter we set its prior variance equal to zero. This effectively prevents updating of the parameter in the VB-Laplace method. To fit the data, we kept those parameters free which influenced the kinetics of the fluorescence transients as these parameters may be inferred from the data. In the following, we will specify which parameters are fixed for the five different model components (see <xref ref-type="table" rid="pcbi.1004736.t001">Table 1</xref> for the parameter values):</p>
<list list-type="simple">
<list-item><label>(i)</label><p>Calcium-dynamics-modulating parameters control the dynamics of HVA calcium channel’s gating variable and current (Eqs <xref ref-type="disp-formula" rid="pcbi.1004736.e045">9</xref> and <xref ref-type="disp-formula" rid="pcbi.1004736.e046">10</xref>), as well as the kinetics of Ca<sup>2+</sup> concentration (<xref ref-type="disp-formula" rid="pcbi.1004736.e047">Eq 11</xref>). Specifically, we fixed parameters <italic>ρ</italic>, <italic>V</italic><sub>1/2</sub>, <italic>E</italic><sub><italic>Ca</italic></sub>, and <italic>g</italic><sub><italic>Ca</italic></sub>. As free parameters, we used <italic>τ</italic><sub><italic>Ca</italic></sub>, <italic>κ</italic><sub><italic>Ca</italic></sub>, and [Ca<sup>2+</sup>]<sub>base</sub>. Note that as both <italic>g</italic><sub><italic>Ca</italic></sub> and <italic>κ</italic><sub><italic>Ca</italic></sub> have in <xref ref-type="disp-formula" rid="pcbi.1004736.e047">Eq 11</xref> the same effect on scaling the calcium transients we fix <italic>g</italic><sub><italic>Ca</italic></sub>.</p></list-item>
<list-item><label>(ii)</label><p>Membrane-potential-modulating parameters control the dynamics of membrane potential, refractoriness, and activation of the voltage-gated ion channels. Importantly, selection of inappropriate parameter regimes may preclude firing of the neuron, or trap it in a biologically meaningless state. Therefore, we fix most of these parameters in order to retain their potential physiological meanings. However, for inverting the bursting-QGIF model for data with near-millisecond resolution, we use Δ<sub><italic>th</italic></sub>, <italic>g</italic><sub><italic>M</italic></sub>, and <italic>g</italic><sub><italic>NaP</italic></sub> as free parameters. These, in principle, can take part in shaping of spike-evoked calcium transients (see <xref ref-type="sec" rid="sec026">Results</xref>). In particular, by keeping <italic>g</italic><sub><italic>M</italic></sub> and <italic>g</italic><sub><italic>NaP</italic></sub> as free parameters the model will have access to a wide range of different firing regimes. It is an open and interesting question whether these parameters can be inferred from the data, e.g. at a high temporal resolution (see <xref ref-type="sec" rid="sec026">Results</xref>).</p></list-item>
<list-item><label>(iii)</label><p>Prior means for initial conditions were set to their steady-state values in the absence of any input current to the neuron, i.e. when the neuron is “at rest”. We allowed the VB-Laplace method to estimate the initial values of the neuronal dynamics from the onset of fluorescence traces by keeping these as free parameters.</p></list-item>
<list-item><label>(iv)</label><p>Observation parameters control the mapping of [Ca<sup>2+</sup>] kinetics on to fluorescence traces. We fix <italic>K</italic><sub><italic>d</italic></sub> and keep only <italic>κ</italic><sub><italic>F</italic></sub> and <italic>d</italic><sub><italic>F</italic></sub> as free parameters. We specify tighter priors on these parameters in favor of the parameters of interest listed under (i). This is because parameters <italic>κ</italic><sub><italic>F</italic></sub> and <italic>κ</italic><sub><italic>Ca</italic></sub> (and <italic>g</italic><sub><italic>Ca</italic></sub>), as well as <italic>K</italic><sub><italic>d</italic></sub> all effectively scale the fluorescence transients [<xref ref-type="bibr" rid="pcbi.1004736.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref069">69</xref>]. Similarly, both <italic>d</italic><sub><italic>F</italic></sub> and [Ca<sup>2+</sup>]<sub>base</sub> can set the offset of fluorescence trace [<xref ref-type="bibr" rid="pcbi.1004736.ref019">19</xref>]. However, our preliminary results showed that using <italic>κ</italic><sub><italic>F</italic></sub> and <italic>d</italic><sub><italic>F</italic></sub> as free parameters increased the robustness of the inference with respect to adverse conditions such as low SNR and rather variable amplitudes of the transients.</p></list-item>
<list-item><label>(v)</label><p>Precision-parameters control the level of synaptic input to the membrane, and the noise on gating variables, recovery variable, [Ca<sup>2+</sup>] kinetics, and fluorescence traces. This noise level can differ, for example, among different experimental conditions. Therefore, precision-parameters need to be inferred from the data. To do so, it is sufficient to make inference about either the precision-parameters (i.e. <italic>α</italic> and <italic>σ</italic>) or the inverse covariance matrices (i.e. ϒ<sub><italic>x</italic></sub> and ϒ<sub><italic>y</italic></sub>), see <xref ref-type="disp-formula" rid="pcbi.1004736.e026">Eq 1</xref>. Following [<xref ref-type="bibr" rid="pcbi.1004736.ref031">31</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref060">60</xref>] we kept the precision-parameters free, while the inverse covariance matrices are fixed with constant values. We defined ϒ<sub><italic>x</italic></sub> as a diagonal matrix and ϒ<sub><italic>y</italic></sub> as a scalar whose values are constant for the whole time series.</p></list-item>
</list>
<p>In summary, we specify prior distributions on initial conditions, six evolution parameters <italic>θ</italic> = {<italic>κ</italic><sub><italic>Ca</italic></sub>,<italic>τ</italic><sub><italic>Ca</italic></sub>,[Ca<sup>2+</sup>]<sub>base</sub>,Δ<sub><italic>th</italic></sub>,<italic>g</italic><sub><italic>M</italic></sub>,<italic>g</italic><sub><italic>NaP</italic></sub>}, two observation parameters <italic>φ</italic> = {<italic>κ</italic><sub><italic>F</italic></sub>,<italic>d</italic><sub><italic>F</italic></sub>} and precision-parameters {<italic>α</italic>,<italic>σ</italic>}. The prior distributions are listed in <xref ref-type="table" rid="pcbi.1004736.t002">Table 2</xref>. To ensure the positivity of the evolution parameters (except [Ca<sup>2+</sup>]<sub>base</sub>; see the <xref ref-type="supplementary-material" rid="pcbi.1004736.s001">S1 Appendix</xref>) and the observation scaling parameter (i.e. <italic>κ</italic><sub><italic>F</italic></sub>) we re-parameterized them as <inline-formula id="pcbi.1004736.e057"><alternatives><graphic id="pcbi.1004736.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e057" xlink:type="simple"/>
<mml:math display="inline" id="M57"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
</alternatives></inline-formula> and <inline-formula id="pcbi.1004736.e058"><alternatives><graphic id="pcbi.1004736.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e058" xlink:type="simple"/>
<mml:math display="inline" id="M58"><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>κ</mml:mi><mml:mi>F</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
</alternatives></inline-formula>, see also [<xref ref-type="bibr" rid="pcbi.1004736.ref060">60</xref>]. That is, we estimate the posterior distribution over, e.g., parameter <italic>θ</italic><sub><italic>i</italic></sub> under Gaussian prior assumption on its modal parameter <italic>χ</italic><sub><italic>i</italic></sub>; thus <inline-formula id="pcbi.1004736.e059"><alternatives><graphic id="pcbi.1004736.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e059" xlink:type="simple"/>
<mml:math display="inline" id="M59"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
</alternatives></inline-formula>. <inline-formula id="pcbi.1004736.e060"><alternatives><graphic id="pcbi.1004736.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e060" xlink:type="simple"/>
<mml:math display="inline" id="M60"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:math>
</alternatives></inline-formula> and <inline-formula id="pcbi.1004736.e061"><alternatives><graphic id="pcbi.1004736.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e061" xlink:type="simple"/>
<mml:math display="inline" id="M61"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:math>
</alternatives></inline-formula> are the prior mean and variance of <italic>χ</italic><sub><italic>i</italic></sub>. Accordingly, we set <inline-formula id="pcbi.1004736.e062"><alternatives><graphic id="pcbi.1004736.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e062" xlink:type="simple"/>
<mml:math display="inline" id="M62"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math>
</alternatives></inline-formula>, while prior knowledge about the prior expectation of the parameter will be effectively embodied in the value of <inline-formula id="pcbi.1004736.e063"><alternatives><graphic id="pcbi.1004736.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e063" xlink:type="simple"/>
<mml:math display="inline" id="M63"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:math>
</alternatives></inline-formula>.</p>
<p>To assign a proper prior to calcium decay time-constant, we consider the following relationship:
<disp-formula id="pcbi.1004736.e064">
<alternatives>
<graphic id="pcbi.1004736.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e064" xlink:type="simple"/>
<mml:math display="block" id="M64">
<mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mi>d</mml:mi><mml:msubsup><mml:mi>t</mml:mi><mml:mrow/><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>×</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(17)</label>
</disp-formula>
where <inline-formula id="pcbi.1004736.e065"><alternatives><graphic id="pcbi.1004736.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e065" xlink:type="simple"/>
<mml:math display="inline" id="M65"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:math>
</alternatives></inline-formula> is an a-priori specified value for <italic>τ</italic><sub><italic>Ca</italic></sub>, <inline-formula id="pcbi.1004736.e066"><alternatives><graphic id="pcbi.1004736.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e066" xlink:type="simple"/>
<mml:math display="inline" id="M66"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math>
</alternatives></inline-formula> is the actual value of calcium decay time-constant in real time, <italic>dt</italic><sup><italic>frame</italic></sup> is the inverse sampling frequency (in [<italic>ms</italic>]), and <italic>dt</italic> is the integration time-step size of neuron dynamics (in [<italic>ms</italic>]). <xref ref-type="disp-formula" rid="pcbi.1004736.e064">Eq 17</xref> informs the generative model about the temporal precision of fluorescence data: the inversion operates on two different time scales simultaneously, a slow and fast relating to fluorescence traces (observation equation) and neural dynamics (evolution equations). The slow time scale evolves in an image frame resolution and the fast in a sub-millisecond resolution.</p>
<p>Note that most of the fixed parameters in both simulating and inverting tasks (<xref ref-type="table" rid="pcbi.1004736.t001">Table 1</xref>), as well as the prior means for the free parameters (<xref ref-type="table" rid="pcbi.1004736.t002">Table 2</xref>) were set to values according to previously reported modelling or experimental studies (e.g., see the “References” column in <xref ref-type="table" rid="pcbi.1004736.t001">Table 1</xref>). See also the <xref ref-type="supplementary-material" rid="pcbi.1004736.s001">S1 Appendix</xref> for a more detailed explanation about our choices for a number of fixed parameters, like <italic>V</italic><sub>1/2</sub> and [Ca<sup>2+</sup>]<sub>base</sub>.</p>
</sec>
<sec id="sec023">
<title>Data simulation</title>
<p>To illustrate the method, we simulated the synthetic fluorescence traces using each of the FHN, QGIF and bursting-QGIF models, followed by inversion for each data set. For each model, the membrane was stimulated by a set of square pulses of depolarizing currents with various widths and strengths so that the spiking and/or bursting firing patterns were triggered. These traces were down-sampled at the desired frame rates (see <xref ref-type="sec" rid="sec026">Results</xref>). We added background noise, i.e. the trace recorded in the absence of fluorescence emission (when the laser was switched OFF), after scaling to the fluorescence traces in order to achieve the desired SNRs.</p>
</sec>
<sec id="sec024">
<title>Scaling of fluorescence data</title>
<p>In this study, the fluorescence traces which we used as data had a range around 0.2 (for high SNR) &lt; max(<italic>F</italic><sub><italic>t</italic></sub>) &lt; 1 (for low SNR), with the baseline set to zero. For data within different ranges, one can use the priors used in this study, following by an automated normalization, see also [<xref ref-type="bibr" rid="pcbi.1004736.ref071">71</xref>], where first the baseline of the drift-corrected trace is set to zero, followed by a scaling: <italic>F</italic><sub><italic>t</italic></sub> ← (<italic>scale</italic> × <italic>F</italic><sub><italic>t</italic></sub> / max(<italic>F</italic><sub><italic>t</italic></sub>)), where <italic>scale</italic> = 1.</p>
</sec>
<sec id="sec025">
<title>Alternative methods</title>
<p>We compare the spike reconstruction efficiency of our method to two different types of established spike reconstruction methods: 1) template matching [<xref ref-type="bibr" rid="pcbi.1004736.ref085">85</xref>], and 2) a deconvolution-based method [<xref ref-type="bibr" rid="pcbi.1004736.ref071">71</xref>].</p>
<p>For the first type, we used a widely-used template matching (TM) method using an optimally scaled template [<xref ref-type="bibr" rid="pcbi.1004736.ref085">85</xref>] implemented in the pCLAMP 10.2 software package (Molecular Devices, Sunnyvale, CA, 2009). To perform the comparisons, we use two data sets with different types of, in particular, rise kinetics (i.e. fast or slow, see <xref ref-type="sec" rid="sec026">Results</xref>). In an initial, interactive phase we defined a distinct template for each data set, as follows. For data with slowly rising transients, we first extracted around twenty veridical fluorescence transients from the six <italic>in vitro</italic> low SNR fluorescence traces, recorded in our lab. After averaging these transients, which were evoked during synchronized network activities, we found that a two-term Boltzmann equation can be well fitted to this averaged (empirical) template (see <xref ref-type="sec" rid="sec026">Results</xref>). In a similar way, we defined a template for the data set with fast rising transients; namely, by averaging fifty-six veridical single-spike-evoked transients extracted from twelve adopted <italic>in vitro</italic> traces (see below), followed by fitting a two-term Boltzmann equation to the averaged transient. Accordingly, we adopted the fitted templates by the TM method in order to detect the spiking activities in fluorescence traces. For this method a threshold (Thr<sub>TM</sub>) parameter for the detection-criterion needs to be set manually. In brief, this threshold embodies both the optimum scaling factor and the goodness of fit; for more detail see [<xref ref-type="bibr" rid="pcbi.1004736.ref085">85</xref>]. For each trace, we used four different thresholds as Thr<sub>TM</sub> = 1, 1.5, 2 and 2.5. We then used the available joint electrophysiological and optical recordings in order to select the optimal threshold for each data set, separately (see <xref ref-type="sec" rid="sec026">Results</xref>). All these steps were carried out using pCLAMP 10.2.</p>
<p>As a deconvolution-based method, we used the fast filter technique [<xref ref-type="bibr" rid="pcbi.1004736.ref071">71</xref>] which is one the most well-established, probabilistic spike reconstruction methods. This method performs a fast nonnegative deconvolution of fluorescence traces in order to infer the most likely spike trains. It uses a first-order generative model: The calcium transients are generated through convolving the spikes, sampled from a Poisson distribution, with a decaying exponential. This model assumes an instantaneous rise time for each evoked transient, whose amplitude is linearly scaled by the number of spikes in a time frame. The generated [Ca<sup>2+</sup>] trace is converted to fluorescence intensities by using a linear (or saturating) mapping and adding Gaussian noise. Given the model and a fluorescence trace, the method aims to find the maximum a posteriori (MAP) spike train (the filter’s output). Note that the computed MAP is an approximation to the actual MAP. This is because for the inversion the method replaces the Poisson distribution with an exponential distribution, due to analytical intractability issues. This approximation removes the integer constraint from the number of spikes, which had been primarily determined by the Poisson distribution. Consequently, an optimal detection threshold for the filter’s output must be determined, in order to extract the best possible solution to the most likely spike train (see [<xref ref-type="bibr" rid="pcbi.1004736.ref071">71</xref>]). In other words, this thresholding is required for reporting the spike or event (single spike or burst) detection results. In our analyses, we were interested in quantifying the event, rather than individual spike detection errors (see <xref ref-type="sec" rid="sec026">Results</xref>). Accordingly, to make the comparison to the proposed method appropriate, when searching for an optimal threshold, we only counted the first inferred spike per event. For implementing this method we used available Matlab code (<ext-link ext-link-type="uri" xlink:href="https://github.com/jovo/fast-oopsi/" xlink:type="simple">https://github.com/jovo/fast-oopsi/</ext-link>), with the parameter initializations performed as described in the main paper [<xref ref-type="bibr" rid="pcbi.1004736.ref071">71</xref>], including the sampling rate of the fluorescence data. More details about the method can be found in [<xref ref-type="bibr" rid="pcbi.1004736.ref071">71</xref>].</p>
</sec>
</sec>
<sec id="sec026" sec-type="results">
<title>Results</title>
<p>In this section, we apply the proposed method to both synthetic data and <italic>in vitro</italic> fluorescence measurements. In particular, we use two <italic>in vitro</italic> data sets, which have been acquired simultaneously with electrophysiological recordings to validate the inferred spike times: 1) a data set of six joint transmembrane current and fluorescence traces (with slowly rising transients) recorded in our lab from neonatal CA3 neurons, and 2) a data set of twelve joint membrane potential and fluorescence traces (with fast rising transients) recorded for a previous study [<xref ref-type="bibr" rid="pcbi.1004736.ref071">71</xref>] from juvenile layer V somatosensory cortex neurons (available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/jovo/fast-oopsi/tree/master/data/" xlink:type="simple">https://github.com/jovo/fast-oopsi/tree/master/data/</ext-link>). For our approach, the values of all model parameters and their prior densities are summarized in Tables <xref ref-type="table" rid="pcbi.1004736.t001">1</xref> and <xref ref-type="table" rid="pcbi.1004736.t002">2</xref>, unless stated otherwise in the figure captions.</p>
<p>For the sake of brevity, hereafter we refer to our approach (i.e. the combination of the VB-Laplace and our generative models) as “CaBBI”; an abbreviation of “<italic>calcium</italic> imaging analysis using <italic>biophysical</italic> models and <italic>Bayesian inference</italic>”.</p>
<sec id="sec027">
<title>Synthetic data</title>
<p>In this section, we show the inversion results of the new approach for fluorescence traces simulated by the three different generative models (see <xref ref-type="sec" rid="sec002">Methods</xref>). More specifically, we will show that through making a reliable inference about the neuronal dynamics (like, membrane potential), our approach has the following central features:</p>
<list list-type="order">
<list-item><p>It accurately reconstructs both single spikes and within-burst spikes from fluorescence transients with fast rise times (e.g. 3 <italic>ms</italic>). Such transients are typical for adult neurons and are the standard transient type considered in previously proposed spike/firing rate reconstruction methods, e.g. [<xref ref-type="bibr" rid="pcbi.1004736.ref017">17</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref071">71</xref>]; see also [<xref ref-type="bibr" rid="pcbi.1004736.ref086">86</xref>].</p></list-item>
<list-item><p>The method accurately reconstructs the single spikes from the transients even with “slow” rise kinetics (e.g. lasting 100 <italic>ms</italic> for a single-spike-evoked transient) as observed in the data from neonate hippocampal tissues [<xref ref-type="bibr" rid="pcbi.1004736.ref027">27</xref>], and in recordings with new genetically encoded calcium indicators [<xref ref-type="bibr" rid="pcbi.1004736.ref087">87</xref>–<xref ref-type="bibr" rid="pcbi.1004736.ref089">89</xref>]. To our knowledge, this is the first time that an (accurate) spike reconstruction approach, in practice, is applied to such data.</p></list-item>
<list-item><p>The method adapts to different kinetics of the spike-evoked fluorescence transients, for example with different rise times. This means that due to the biophysical constraints embodied by the generative model equations, the method does not require a training/conditioning or re-parameterization phase. This training step is typically performed by other methods, usually by using simultaneous optical and electrophysiological recordings, to constrain/set parameters and priors [<xref ref-type="bibr" rid="pcbi.1004736.ref005">5</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref025">25</xref>].</p></list-item>
<list-item><p>The method is robust against rather high levels of noise (i.e. low SNR condition). This is important because fluorescence traces with high temporal resolutions [<xref ref-type="bibr" rid="pcbi.1004736.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref090">90</xref>], or obtained from <italic>in vivo</italic> experiments [<xref ref-type="bibr" rid="pcbi.1004736.ref091">91</xref>], are usually acquired with relatively low SNR. This would mean that when using the proposed method, one can have, for example, both high temporal resolution and informative spike reconstructions.</p></list-item>
</list>
</sec>
<sec id="sec028">
<title>Simulated single-spike-evoked transients (with fast rise times)</title>
<p>To show that our approach can accurately reconstruct spikes from fluorescence traces, we first applied it to simulated traces resembling the single-spike-evoked transients in adult neurons with fast rise kinetics.</p>
<p>The generated traces are shown in <xref ref-type="fig" rid="pcbi.1004736.g004">Fig 4</xref> (first row) for the two non-bursting models, QGIF and FHN. We inverted these models for fluorescence traces containing the transients with fast rise times, i.e. less than 5 <italic>ms</italic> (thus, imaged within one frame in the given sampling frequency of 33.3 <italic>Hz</italic>). The fast rise kinetics are shown in zoomed-up, representative fluorescence transients in the last row of <xref ref-type="fig" rid="pcbi.1004736.g004">Fig 4</xref>. This figure shows that the neuronal dynamics can be inferred reasonably accurately, including the non-saturating [Ca<sup>2+</sup>] kinetics (third row) and membrane potentials (fourth row). Consequently, the spikes were detected accurately, as compared to simulated spikes (grey stars in fourth row). For data with high SNR this can be seen in <xref ref-type="fig" rid="pcbi.1004736.g004">Fig 4A and 4B</xref>; QGIF: SNR ≈ 30, number of veridical spikes (n) = 12, missed spikes (M) = 0 and falsely detected spikes (FD) = 0, FHN: SNR ≈ 20, n = 13, M = 0 and FD = 0. The uncertainty (shaded areas) was mainly elevated for near-rest membrane potentials. This is because we modeled only HVA calcium channels, which open mainly during spikes (see <xref ref-type="sec" rid="sec002">Methods</xref>). We also evaluated the inference under low SNRs, see <xref ref-type="fig" rid="pcbi.1004736.g004">Fig 4C</xref>. These low SNRs present a lower limit of the typical SNR expected in regular experimental setups. <xref ref-type="fig" rid="pcbi.1004736.g004">Fig 4C</xref> (fourth panel) shows that even for this low SNR (<xref ref-type="fig" rid="pcbi.1004736.g004">Fig 4C</xref>, first panel), the estimated spikes match accurately the true spikes (grey stars) and only one spike was missed (red star) (<xref ref-type="fig" rid="pcbi.1004736.g004">Fig 4C</xref>, fourth panel; SNR ≈ 2.5, n = 13, M = 1 and FD = 0). For the low SNR case the inferred non-saturating [Ca<sup>2+</sup>] kinetics (<xref ref-type="fig" rid="pcbi.1004736.g004">Fig 4C</xref>, third panel) display a higher level of rest [Ca<sup>2+</sup>] as compared to the true kinetics (<xref ref-type="fig" rid="pcbi.1004736.g004">Fig 4C</xref>, second panel). This indicates that CaBBI has optimized the fit by estimating larger values for basal calcium concentration. For this low SNR case we used only the FHN model; qualitatively similar results can be obtained by inverting the QGIF model (not shown).</p>
<fig id="pcbi.1004736.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004736.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Results of the proposed approach for synthetic single-spike-evoked transients with fast rise times.</title>
<p>(<bold>A</bold>): QGIF model, (<bold>B</bold>): FHN model with high SNR, (<bold>C):</bold> FHN model with low SNR. (<bold>A</bold>-<bold>C</bold>) Inferring neuronal dynamics from transients with fast rise times (e.g. 3 <italic>ms</italic>). The fluorescence traces (first row) and [Ca<sup>2+</sup>] kinetics (second row) were simulated by using (<bold>A</bold>) QGIF and (<bold>B</bold> and <bold>C</bold>) FHN generative models. Inverting each model for its corresponding trace by using CaBBI led to a reasonably accurate inference about the membrane potentials and non-saturating [Ca<sup>2+</sup>] kinetics (rows four and three); 95% confidence intervals are shown as shaded areas. The inferred spikes (fourth row) coincide accurately with the veridical spikes (grey stars). The robustness of the method against high levels of noise is evident in the results shown in <bold>C</bold>, where only one spike was missed (red star). Fifth row shows the zoom into the rise time of a representative fluorescence transient in each trace shown in the first row. Membrane potential has the unit of [<italic>mV</italic>] in the (family of) QGIF model(s), but is dimensionless in the FHN model. The fluorescence traces were sampled at a frequency of 33.3 <italic>Hz</italic>. The values of parameters for the simulations and inversions can be found in <xref ref-type="table" rid="pcbi.1004736.t001">Table 1</xref>, and prior distributions in <xref ref-type="table" rid="pcbi.1004736.t002">Table 2</xref>. Units and conventions, as well as the parameter values are consistent across the following figures, unless stated otherwise.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.g004" xlink:type="simple"/>
</fig>
<p>In sum, the proposed approach can reconstruct spikes veridically from single-spike-evoked transients with fast rise times, even at a low SNR level.</p>
</sec>
<sec id="sec029">
<title>Simulated single-spike-evoked transients (with slow rise times)</title>
<p>For slowly rising transients there is a delay (on the order of 100 <italic>ms</italic>) between the onset of the spike and the peak of the fluorescence transient. Although this may not be a crucial issue for reconstruction methods, this delay may cause difficulty for reconstruction methods that rely on a rather instantaneous relationship between spike and fluorescence transient peak, e.g. the sequential Monte Carlo [<xref ref-type="bibr" rid="pcbi.1004736.ref019">19</xref>] or finite rate of innovation [<xref ref-type="bibr" rid="pcbi.1004736.ref092">92</xref>] methods. Here, we show that the proposed method can precisely reconstruct single spikes even if the transients have slow rise kinetics.</p>
<p>The interpolated rise kinetics of the fluorescence transients lasted around 200–450 <italic>ms</italic>, see the fourth row of <xref ref-type="fig" rid="pcbi.1004736.g005">Fig 5</xref>. We inverted the non-bursting models (i.e. QGIF and FHN) for the traces containing single-spike-evoked fluorescence transients (first row of <xref ref-type="fig" rid="pcbi.1004736.g005">Fig 5</xref>). The non-saturating [Ca<sup>2+</sup>] kinetics and veridical spikes can be accurately estimated for data with high SNR (<xref ref-type="fig" rid="pcbi.1004736.g005">Fig 5A and 5B</xref>), second and third rows; QGIF: SNR ≈ 25, n = 12, M = 0 and FD = 0, FHN: SNR ≈ 25, n = 13, M = 0 and FD = 0), and for the trace with low SNR (<xref ref-type="fig" rid="pcbi.1004736.g005">Fig 5C</xref>; FHN: SNR ≈ 2, n = 13, M = 0 and FD = 0); compare grey stars to inferred spikes in the third row of <xref ref-type="fig" rid="pcbi.1004736.g005">Fig 5</xref>.</p>
<fig id="pcbi.1004736.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004736.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Results of the proposed approach for synthetic single-spike-evoked transients with slow rise times (around 200–450 ms).</title>
<p>(<bold>A</bold>): QGIF model, (<bold>B</bold>): FHN model with high SNR, (<bold>C):</bold> FHN model with low SNR. First row: Fluorescence traces generated by each of the two non-bursting generative models. The rising kinetics of all transients were stretched using interpolation, Second row: Inferred non-saturating [Ca<sup>2+</sup>] kinetics, Third row: Inferred membrane potentials, where the synthetic spikes as indicated by grey stars are closely matched by the inferred spikes, Fourth row: Zoom into the interpolated, slow rise time of the first fluorescence transient in the traces shown in the first row. The time from the simulated spike (grey star) to the peak was roughly 200–450 <italic>ms</italic>. The decaying time-constant of the transients was about 2 seconds.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.g005" xlink:type="simple"/>
</fig>
<p>We performed these reconstructions with the same parameterization as in the previous section (synthetic adult neurons with faster rise times), since our generative models do not incorporate any parameter which can explicitly capture the slow rise times in the data (<italic>τ</italic><sub><italic>Ca</italic></sub> corresponds only to the ‘decay’ but not the rise kinetics of the calcium transient; see <xref ref-type="disp-formula" rid="pcbi.1004736.e047">Eq 11</xref>). Still, the results displayed in <xref ref-type="fig" rid="pcbi.1004736.g005">Fig 5</xref> show that the models can be inverted reasonably well given data with slow rise kinetics. This is because the inference procedure takes into account the stochastic dependencies among the neuronal dynamics (see <xref ref-type="sec" rid="sec002">Methods</xref>), whose evolutions over time are constrained by their prior precisions. Accordingly, CaBBI adapts to different fluorescence transient kinetics (as for example here with slow rise kinetics) by using a suitable amount of state-noise on the neuronal dynamics.</p>
</sec>
<sec id="sec030">
<title>Simulated burst-evoked transients</title>
<p>Many neurons fire bursts, possibly intermixed with single spikes. Here we show that if the temporal resolution of the fluorescence measurements is high enough, we can still accurately reconstruct spike timing (see <xref ref-type="fig" rid="pcbi.1004736.g006">Fig 6</xref>). This holds true not only for single spikes but also for the spikes within a burst.</p>
<fig id="pcbi.1004736.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004736.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Results of the proposed approach for synthetic burst-evoked transients with fast rise times.</title>
<p>(<bold>A</bold>): The fluorescence trace generated by the bursting-QGIF model, sampled at a high frequency of 700 <italic>Hz</italic>. (<bold>B</bold>): Inferred non-saturating [Ca<sup>2+</sup>] kinetics. (<bold>C</bold>): Inferred membrane potential, (<bold>D</bold>): Simulated membrane potential of the bursting-QGIF model. Comparison of <bold>C</bold> and <bold>D</bold> indicates that both single and within-burst spikes could accurately be detected (note also the grey stars), resulting in a precise estimation of the interburst intervals and periods of quiescence. The values of parameters for the simulations and inversions, as well as the prior distributions can be found in Tables <xref ref-type="table" rid="pcbi.1004736.t001">1</xref> and <xref ref-type="table" rid="pcbi.1004736.t002">2</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.g006" xlink:type="simple"/>
</fig>
<p>For bursts the reconstruction of spike activity from fluorescence traces becomes challenging: For high frequency and/or a high number of spikes within each burst, the impact of calcium accumulation [<xref ref-type="bibr" rid="pcbi.1004736.ref077">77</xref>] and fluorescence saturation [<xref ref-type="bibr" rid="pcbi.1004736.ref093">93</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref094">94</xref>] becomes relevant (especially when high-affinity indicators are used); in principle, these two mechanisms result in smaller spike-evoked fluorescence transients (thus, smaller effective SNR) with (probably) slower decays [<xref ref-type="bibr" rid="pcbi.1004736.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref026">26</xref>]. These strong nonlinearities will make the spike reconstruction challenging mainly due to the less differentiable transients during bursts.</p>
<p>In general, fluorescence traces with low temporal resolution, e.g. acquired at 4.2 <italic>Hz</italic> [<xref ref-type="bibr" rid="pcbi.1004736.ref095">95</xref>], cannot resolve the single transients evoked by each distinct spike within a burst [<xref ref-type="bibr" rid="pcbi.1004736.ref017">17</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref095">95</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref096">96</xref>]. However, recent developments in calcium imaging have made it possible to obtain fluorescence measurements at very high sampling rates such as 1 <italic>kHz</italic>, for example [<xref ref-type="bibr" rid="pcbi.1004736.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref025">25</xref>]. Assuming a sampling rate of 700 <italic>Hz</italic>, we generated a synthetic fluorescence trace (<xref ref-type="fig" rid="pcbi.1004736.g006">Fig 6A</xref>) using the bursting-QGIF model. To generate complex burst patterns (<xref ref-type="fig" rid="pcbi.1004736.g006">Fig 6D</xref>), we used doublet, triplet and multiplet (5 and 10 spikes) bursts, and interspersed single spikes (indicated by grey stars in <xref ref-type="fig" rid="pcbi.1004736.g006">Fig 6C</xref>). Although we imposed relatively high noise on the trace, all of single spikes and the within-burst spikes were inferred accurately (<xref ref-type="fig" rid="pcbi.1004736.g006">Fig 6C</xref>; SNR ≈ 3, bursting-QGIF: n = 25, M = 0 and FD = 0). In addition, the durations of the bursts’ active phase and the interburst intervals, as well as the periods of quiescence were reasonably well estimated (compare the simulated and inferred membrane potentials in <xref ref-type="fig" rid="pcbi.1004736.g006">Fig 6C and 6D</xref>). In addition and as shown in <xref ref-type="fig" rid="pcbi.1004736.g006">Fig 6C</xref>, for each burst the reconstructed spikes have correctly inferred incomplete repolarizations and are located on top of a plateau; this is a common bursting characteristic of many neurons, including hippocampal cells [<xref ref-type="bibr" rid="pcbi.1004736.ref028">28</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref029">29</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref058">58</xref>]. The non-saturating [Ca<sup>2+</sup>] kinetics can also be accurately inferred (<xref ref-type="fig" rid="pcbi.1004736.g006">Fig 6B</xref>) from these saturated traces with highly accumulated transients (<xref ref-type="fig" rid="pcbi.1004736.g006">Fig 6A</xref>). In summary, we found that the method can read out spikes within bursts observed in synthetic fluorescence traces (with fast rise kinetics) when the temporal measurement resolution is high enough, e.g. 700 <italic>Hz</italic>.</p>
</sec>
<sec id="sec031">
<title>Biological data</title>
<sec id="sec032">
<title>In vitro recorded fluorescence transients (with slow rise times)</title>
<p>Having accurately reconstructed spikes from synthetic data, we now apply the proposed approach to the experimental data recorded in our lab from neonate hippocampal tissue (i.e. first data set; see above). An exclusive feature of these data is the slow rise time (up to several hundred milliseconds) of fluorescence transients, consistent with previous work [<xref ref-type="bibr" rid="pcbi.1004736.ref027">27</xref>]. For model inversion based on these data, we use the same values of the parameters as for both synthetic data sets with fast rise time and slow rise time; namely, independent of our <italic>in vitro</italic> data. As shown above on synthetic data with slow rise time, we expect that the method can intrinsically adapt to the <italic>in vitro</italic> fluorescence transients without requiring any training/conditioning phase, unlike [<xref ref-type="bibr" rid="pcbi.1004736.ref005">5</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref025">25</xref>].</p>
<p>For the analysis, we used six <italic>in vitro</italic> fluorescence image sequences of CA3 immature tissues, as well as the simultaneously recorded transmembrane current signals recorded from two (one per image sequence) patched cells in our experiment (see <xref ref-type="sec" rid="sec015">Experimental methods</xref>). For these two cells, the veridical spike times provided by the electrophysiological recordings enabled us to validate the inferred onset times of spiking events (i.e. burst or single spike).</p>
<p>A hallmark of the measured data is spontaneous, synchronized network activities which are expressed as so-called giant depolarizing potentials (GDPs) in individual neurons [<xref ref-type="bibr" rid="pcbi.1004736.ref097">97</xref>]. In the CA3 hippocampal region, each GDP is usually seen as a slow wave-like propagation (e.g., lasting 200 <italic>ms</italic>) of cellular activation traveling across neurons in the direction, for example, from the CA3c area to the CA3b area [<xref ref-type="bibr" rid="pcbi.1004736.ref027">27</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref098">98</xref>]. An important variable of GDPs is the onset times of cellular activation during GDPs. If one knew the precise onset times of neurons participating in a GDP, one can analyze the underlying spatiotemporal characteristics of GDPs, i.e. the GDP’s propagation direction or velocity across the network, the GDP initiators cells, or any systematic cellular activation orders across multiple GDPs [<xref ref-type="bibr" rid="pcbi.1004736.ref027">27</xref>]. The reconstruction of such network characteristics would enable an improved analysis of the development of immature neuronal circuits, as compared to a GDP analysis based on the smeared fluorescence image sequences [<xref ref-type="bibr" rid="pcbi.1004736.ref027">27</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref099">99</xref>].</p>
<p>We observed the GDP-mediated spiking activity of individual neurons as single or burst of spikes, consistent with [<xref ref-type="bibr" rid="pcbi.1004736.ref097">97</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref100">100</xref>]. In the previous section, we showed that for transients of adult neurons with a fast rise time (e.g. 3 <italic>ms</italic>) and acquired at a high enough temporal resolution (700 <italic>Hz</italic>), the within-burst spikes can be reconstructed accurately using fluorescence measurements. For neonatal neurons, the rise time of each single-spike-evoked transient lasts much longer, e.g. 100 <italic>ms</italic> [<xref ref-type="bibr" rid="pcbi.1004736.ref027">27</xref>]. This long rise time may be caused by strongly nonlinear mechanisms of Ca<sup>2+</sup> pumping and buffering [<xref ref-type="bibr" rid="pcbi.1004736.ref101">101</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref102">102</xref>]. In addition, GDP-mediated spiking events occur during synaptically-driven long-lasting depolarizations (up to several hundred milliseconds) with large amplitudes (e.g. -10 <italic>mV</italic>, thus mostly above the half-activation of HVA calcium channels) [<xref ref-type="bibr" rid="pcbi.1004736.ref097">97</xref>], thereby modulating the Ca<sup>2+</sup> kinetics with added, pronounced nonlinearities. Effectively, for our neonatal neuronal data acquired at 22.6 <italic>Hz</italic>, we could not resolve the GDP-mediated within-burst spikes. This means that in the recorded fluorescence traces, both GDP-mediated burst-evoked and GDP-mediated single-spike-evoked transients were characterized by a single rising phase and a single decaying phase.</p>
<p>In all of these recorded fluorescence traces, there was evidence of slowly varying drifts. To ensure reliable estimates of biophysical parameters and states, we removed these drifts from the traces by using a fourth degree polynomial detrending method (see <xref ref-type="sec" rid="sec002">Methods</xref>). In <xref ref-type="fig" rid="pcbi.1004736.g003">Fig 3B</xref>, the original (blue line) and drift-corrected (red line) versions of one of the recorded fluorescence traces are plotted. In addition, we emulated the measurements at a low SNR level by scaling and adding the background noise to the fluorescence traces (see <xref ref-type="sec" rid="sec002">Methods</xref>).</p>
<p>In <xref ref-type="fig" rid="pcbi.1004736.g007">Fig 7</xref> (see also <xref ref-type="supplementary-material" rid="pcbi.1004736.s003">S1 Fig</xref>) the precise detection of GDPs is shown for three representative samples (out of six) of drift-corrected <italic>in vitro</italic> fluorescence traces (with slowly rising transients). Critically, as mentioned above, both GDP-mediated bursts and single spikes had similar transient kinetics with a single prolonged rise (up to 400 <italic>ms</italic>, see fourth row of <xref ref-type="fig" rid="pcbi.1004736.g007">Fig 7A–7C</xref>) and large amplitudes which were rather independent of spike count (see <xref ref-type="fig" rid="pcbi.1004736.g008">Fig 8A</xref>); unlike the data from adult neurons [<xref ref-type="bibr" rid="pcbi.1004736.ref009">9</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref103">103</xref>].</p>
<fig id="pcbi.1004736.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004736.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Results of the proposed approach for <italic>in vitro</italic> fluorescence traces with slowly rising transients (around 400 ms).</title>
<p>(<bold>A</bold>): QGIF model, (<bold>B</bold>): FHN model with high SNR, (<bold>C)</bold> FHN model with low SNR. First row (<bold>A</bold>-<bold>C</bold>): The <italic>in vitro</italic> fluorescence traces containing transients with relatively variable and slow rise times, mediated by spontaneous GDPs. The low SNR trace in <bold>C</bold> was generated by contaminating the <italic>in vitro</italic> trace by background noise. Second row (<bold>A</bold>-<bold>C</bold>): Inferred non-saturating [Ca<sup>2+</sup>] kinetics, Third row (<bold>A</bold>-<bold>C</bold>): Inferred membrane potentials, where the onset times of GDP-mediated events (single spike or burst) determined by electrophysiological recordings (grey stars) and inferred spikes are highly concurrent. The two light blue stars indicate that there was no recorded transmembrane current available for the observed events in the fluorescence trace(s). Note that for a GDP-mediated burst event the onset time refers to the occurrence of its first spike. Fourth row (<bold>A</bold>-<bold>C</bold>): Zoom into the slow rise time of the first fluorescence transient in the traces shown in the first row. The numbers and stars indicate the veridical spike count and the onset time of each GDP. The rise time from GDP onsets to the fluorescence transient peaks was around 300–450 <italic>ms</italic>. The decay kinetics of the transients was lasting around 3.5–4.5 seconds.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.g007" xlink:type="simple"/>
</fig>
<fig id="pcbi.1004736.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004736.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Accuracy of the reconstructed GDP onset times of the proposed approach and template matching method on <italic>in vitro</italic> data.</title>
<p>(<bold>A</bold>) The 3D histogram shows the relation between the number of spikes per spontaneous GDPs and the peak of the fluorescence transients (n = 51 GDPs). (<bold>B</bold>) The two-term Boltzmann template for the template matching (TM) method derived from the first experimental data set. (<bold>C</bold>) Timing error distributions computed for the QGIF model inversion for all six fluorescence traces, under low SNR. Gaussian fit: mean = 1.7 and std = 3.2 time bins (i.e. frames). (<bold>D</bold>) Timing error distribution for the TM method, under low SNR. Gaussian fit: mean = 3.7 and std = 3.8 time bins. (<bold>E</bold>) Timing errors estimated by the QGIF model and the TM method plotted for each <italic>in vitro</italic> trace of the first data set.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.g008" xlink:type="simple"/>
</fig>
<p>Accepting that one cannot differentiate between GDP-mediated single-spike- and burst-evoked transients, we used the two repetitive spiking models (QGIF and FHN) to infer the onset times of individual neurons’ firing (single spike or burst) during the synchronous events. We found that both models can accurately detect the experimentally observed GDP-mediated spiking events under high SNR condition (<xref ref-type="fig" rid="pcbi.1004736.g007">Fig 7A and 7B</xref>), third row; QGIF: SNR ≈ 25, n = 11, M = 0 and FD = 0, FHN: SNR ≈ 25, n = 8, M = 0 and FD = 0). The inferred spike-evoked calcium transients have amplitudes mostly around 10 <italic>nM</italic>, consistent with [<xref ref-type="bibr" rid="pcbi.1004736.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref104">104</xref>]. These values were inferred from the data as we used rather uninformative priors (see <xref ref-type="table" rid="pcbi.1004736.t002">Table 2</xref>). We also evaluated the performance of our approach for experimental fluorescence traces with low SNR using the FHN model (<xref ref-type="fig" rid="pcbi.1004736.g007">Fig 7C</xref>). The results (<xref ref-type="fig" rid="pcbi.1004736.g007">Fig 7C</xref>) indicate that the inversion can perform reliable inference even under low SNR: A single noise peak was miss-interpreted as a spike (third row, red star; SNR ≈ 2.5, n = 10, M = 0 and FD = 1). Although fluorescence measurements are commonly recorded with higher SNRs than the trace displayed in <xref ref-type="fig" rid="pcbi.1004736.g007">Fig 7C</xref> (first panel), this robustness against a high level of noise is important: In principle, for GDP experiments one may use faster cameras and scanners which will result in a lower SNR but an increased temporal resolution. Using the proposed method in combination with such fast imaging techniques, one may be able to better extract the differences in cellular activation latencies during GDP events.</p>
</sec>
</sec>
<sec id="sec033">
<title>Quantification of detection accuracy: Comparisons</title>
<p>Here, we compare the detection accuracy of our method, CaBBI, to two well-established, widely-used spike reconstruction methods: a template-matching method [<xref ref-type="bibr" rid="pcbi.1004736.ref085">85</xref>], and a deconvolution-based fast filter method [<xref ref-type="bibr" rid="pcbi.1004736.ref071">71</xref>].</p>
<sec id="sec034">
<title>Comparison on first data set</title>
<p>CaBBI: We first quantified the GDP detection errors (<xref ref-type="table" rid="pcbi.1004736.t004">Table 4</xref>) as well as the accuracy of the inferred onset times of GDPs (<xref ref-type="fig" rid="pcbi.1004736.g008">Fig 8C–8E</xref>) for our method, under both low SNR (~2.5) and high SNR (~25) conditions. We inverted both the QGIF and FHN models for all six drift-corrected fluorescence traces of the first data set acquired with simultaneous electrophysiological recordings. To read out the GDPs’ onset times from the inferred spikes we extracted the time points at which the membrane potential crossed the detection threshold of zero (see <xref ref-type="sec" rid="sec002">Methods</xref>). Both the QGIF and FHN models detected the GDPs without error under a high SNR (n = 51, M = 0 and FD = 0). There were only few detection errors under low SNR (see <xref ref-type="table" rid="pcbi.1004736.t004">Table 4</xref>).</p>
<table-wrap id="pcbi.1004736.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004736.t004</object-id>
<label>Table 4</label> <caption><title>GDP detection results of three different methods (first data set).</title></caption>
<alternatives>
<graphic id="pcbi.1004736.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.t004" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" colspan="2">Method</th>
<th align="center"># Missed GDPs</th>
<th align="center"># Falsely Detected GDPs</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold>CaBBI</bold></td>
<td align="left">FHN</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr>
<td align="left"/>
<td align="left">QGIF</td>
<td align="center">2</td>
<td align="center">1</td>
</tr>
<tr>
<td align="left"><bold>Template matching</bold></td>
<td align="left">Thr<sub>TM</sub> = 1</td>
<td align="center">0</td>
<td align="center">74</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Thr<sub>TM</sub> = 1.5</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Thr<sub>TM</sub> = 2</td>
<td align="center">3</td>
<td align="center">2</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Thr<sub>TM</sub> = 2.5</td>
<td align="center">18</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left"><bold>Fast filter</bold></td>
<td align="left">Thr<sub>ff</sub> = 0.65</td>
<td align="center">16</td>
<td align="center">19</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Thr<sub>ff</sub> = 0.7</td>
<td align="center">21</td>
<td align="center">8</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Thr<sub>ff</sub> = 0.75</td>
<td align="center">26</td>
<td align="center">7</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t004fn001"><p>GDP detection results of the proposed approach (CaBBI), the template matching (TM) method, and the fast filter technique. For the proposed approach we used both the FHN and QGIF models, for the TM method we employed four detection-criterion thresholds (Thr<sub>TM</sub>), and for the fast filter three event detection thresholds (Thr<sub>ff</sub>). The methods were applied to the first data set (<italic>in vitro</italic> data with slowly rising transients) under a low SNR (~2.5). The total number of veridical GDPs was 51. The comparison shows that both the proposed approach and the TM method have a high GDP detection accuracy, while the fast filter cannot solve this task as it was developed for transients with fast rise times.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>Template matching: In an initial phase, the template (<xref ref-type="fig" rid="pcbi.1004736.g008">Fig 8B</xref>) was determined empirically from the first data set (see <xref ref-type="sec" rid="sec002">Methods</xref>). As is common practice, we used several detection-criterion thresholds and selected the best threshold manually. For the optimal threshold (Thr<sub>TM</sub> = 1.5), the GDP detection accuracy of the TM method was as good as that of CABBI when using the FHN model (<xref ref-type="table" rid="pcbi.1004736.t004">Table 4</xref>).</p>
<p>Fast filter: We applied the fast filter to the first data set under low SNR, and thresholded its outputs by using a set of event detection thresholds (see <xref ref-type="sec" rid="sec002">Methods</xref>). Its detection results for three different thresholds are shown in <xref ref-type="table" rid="pcbi.1004736.t004">Table 4</xref>; including Thr<sub>ff</sub> = 0.7 which extracted the events with relatively smaller errors (n = 51, M = 21 and FD = 8) than all other thresholds (i.e. Thr<sub>ff</sub> = 0, 0.05, …, 1). Not surprisingly, this method could not perform a reliable GDP detection from these data, as it has been originally developed for deconvolving fast rising transients [<xref ref-type="bibr" rid="pcbi.1004736.ref071">71</xref>].</p>
<p>We also computed the ‘timing errors’ as the difference between the inferred onset times and the veridical GDP-mediated spike times measured by the simultaneously recorded transmembrane current signals (<xref ref-type="fig" rid="pcbi.1004736.g008">Fig 8C–8E</xref>). For GDP-mediated burst events we compared the inferred onset time to the veridical timing of the first spike of that burst. For 51 veridical GDP events the QGIF model showed a reasonably accurate inference about the onset times with a timing error of 1.7 ± 3.2 (mean ± std) for low (<xref ref-type="fig" rid="pcbi.1004736.g008">Fig 8C</xref>) and -0.5 ± 2.0 time bins (frames) for high SNR conditions (not shown). We found the FHN model to be clearly less accurate (timing error of 10.0 ± 10.3 time bins) than the QGIF model. We compared the timing errors of our method only to the TM method, as the fast filter technique showed an insufficient GDP detection accuracy for these data. For the optimal detection-criterion threshold of the TM method (i.e. Thr<sub>TM</sub> = 1.5; see <xref ref-type="table" rid="pcbi.1004736.t004">Table 4</xref>), the timing error was 3.7 ± 3.8 time bins (<xref ref-type="fig" rid="pcbi.1004736.g008">Fig 8D</xref>), which is significantly higher (paired-sample Wilcoxon signed-rank test (two-sided); p &lt; 0.001) than the error of the QGIF model (<xref ref-type="fig" rid="pcbi.1004736.g008">Fig 8C</xref>). We also show this difference between the two reconstruction methods for single fluorescence traces in <xref ref-type="fig" rid="pcbi.1004736.g008">Fig 8E</xref>.</p>
<p>Overall, these results (<xref ref-type="table" rid="pcbi.1004736.t004">Table 4</xref> and <xref ref-type="fig" rid="pcbi.1004736.g008">Fig 8</xref>) indicate that the new method, CaBBI, can detect GDPs as accurately as the TM method and reconstruct the onset times more accurately than the TM method, for low SNR. In addition, CaBBI does not require an initial, interactive phase where the template is estimated and the detection-criterion threshold is selected manually.</p>
<p>Note that the good results of the TM method in comparison to CaBBI and the fast filter method should be interpreted with some caution. The TM method had two specific advantages not harnessed by the other two methods: 1) the fluorescence transients used to define the empirical template were extracted veridically, by harnessing the simultaneously measured electrophysiological data. In addition, the optimal detection-criterion threshold was verified through the electrophysiological data. A fairer comparison would have been to not use the electrophysiological data at all. However, this would have made the comparison operator-dependent when defining the template. 2) The TM template was derived from the same data set, for which spikes/events were detected with that template. In other words, the same data was used for ‘training’ the model, and again for spike/event detection (testing). In contrast, with CaBBI, we analyzed the data without using any prior information from the same data.</p>
</sec>
<sec id="sec035">
<title>Comparison on second data set</title>
<p>To perform a comparison using data with fast rising transients, for which the fast filter technique was developed, we used twelve <italic>in vitro</italic> fluorescence traces (second data set, see above). These data have been used originally to evaluate the fast filter technique [<xref ref-type="bibr" rid="pcbi.1004736.ref071">71</xref>]. We performed this comparison in terms of the event, rather than individual spike, detection accuracy (see <xref ref-type="sec" rid="sec002">Methods</xref>), since our method was not able to reconstruct the within-burst spikes from these data (see below). In the following, we explain the comparison results for all three methods.</p>
<p>CaBBI and fast filter: For our method, we used the same parameterization as for the first comparison, after setting <italic>scale</italic> = 1 (see <xref ref-type="sec" rid="sec002">Methods</xref>) for all twelve traces. The inversion results of our method (both the QGIF and FHN models) and the fast filter for three representative samples are shown in <xref ref-type="fig" rid="pcbi.1004736.g009">Fig 9A–9C</xref>. The results for these samples show that both methods have qualitatively similar, reasonably good detection accuracy of the spiking events (i.e. bursts or single spikes); note the veridical timing (grey star) and spike count per event on top of the second row, determined by the simultaneous electrophysiological recordings. Note that CaBBI inferred all the single-spike- or burst-evoked transients as if always evoked by single spikes, since the transients evoked by individual spikes are poorly resolved in these data (see [<xref ref-type="bibr" rid="pcbi.1004736.ref071">71</xref>]). In contrast to the GDP-evoked transients (see <xref ref-type="fig" rid="pcbi.1004736.g007">Fig 7</xref>, first row), in these data the higher spike count per event was mostly encoded by the transients with higher amplitudes (<xref ref-type="fig" rid="pcbi.1004736.g009">Fig 9A–9C</xref>, first row). Although hard to see from the fourth row of <xref ref-type="fig" rid="pcbi.1004736.g009">Fig 9A–9C</xref>, the fast filter used this feature of the data to partially infer the spikes within the burst events, when using a manually determined detection threshold (see <xref ref-type="sec" rid="sec002">Methods</xref>). For CaBBI, we observed that as the spike counts of events and therefore the amplitudes of the transients became more variable in a fluorescence trace (compare <xref ref-type="fig" rid="pcbi.1004736.g009">Fig 9A–9C</xref>, first row), inferring the events from transients with lower amplitude became more difficult. As a result, some of them were inferred as partial spikes. For instance, see the fluorescence trace in <xref ref-type="fig" rid="pcbi.1004736.g009">Fig 9A</xref>, which was a hard case also for the fast filter to invert.</p>
<fig id="pcbi.1004736.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004736.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Comparison of the proposed approach and the fast filter for <italic>in vitro</italic> fluorescence traces with fast rising transients.</title>
<p>First row: The <italic>in vitro</italic> fluorescence traces containing transients with fast rise times. Second and third rows: Inferred membrane potentials (posterior means) using CaBBI with the QGIF and FHN models. Fourth row: Inferred spike trains of the fast filter. The comparison of the veridical spiking events (grey stars) to the inferred ones (<bold>A</bold>-<bold>C</bold>, the last three rows) shows that both methods have similar event detection results for fast rising transients. The numbers below the grey stars indicate the spike count per each veridical event, determined by electrophysiological recordings.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.g009" xlink:type="simple"/>
</fig>
<p>In summary, for all twelve traces (<xref ref-type="table" rid="pcbi.1004736.t005">Table 5</xref>) the FHN model had an event detection accuracy (n = 149, M = 10, and FD = 20) similar to the fast filter with the optimal threshold of 0.35 (n = 149, M = 11, and FD = 15). The QGIF model had, however, an inflated error of missed events and at the same time a considerably smaller error of falsely detected events (n = 149, M = 45, and FD = 2), as compared to the fast filter. When applying the template matching method, we first defined the empirical template, applied it to all twelve traces, and then selected the optimal detection-criterion threshold manually. Among the three methods, TM detected the events with the highest accuracy (n = 149, M = 7, and FD = 1), when using its optimal threshold which was Thr<sub>TM</sub> = 1.5 (see <xref ref-type="table" rid="pcbi.1004736.t005">Table 5</xref>). Although, note that the same two caveats for the TM method apply as in the comparison on the first data set (see above).</p>
<table-wrap id="pcbi.1004736.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004736.t005</object-id>
<label>Table 5</label> <caption><title>Event detection results of three different methods (second data set).</title></caption>
<alternatives>
<graphic id="pcbi.1004736.t005g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.t005" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" colspan="2">Method</th>
<th align="center"># Missed events</th>
<th align="center"># Falsely Detected event</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><bold>CaBBI</bold></td>
<td align="left">FHN</td>
<td align="center">10</td>
<td align="center">20</td>
</tr>
<tr>
<td align="left"/>
<td align="left">QGIF</td>
<td align="center">45</td>
<td align="center">2</td>
</tr>
<tr>
<td align="left"><bold>Template matching</bold></td>
<td align="left">Thr<sub>TM</sub> = 1</td>
<td align="center">0</td>
<td align="center">14</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Thr<sub>TM</sub> = 1.5</td>
<td align="center">7</td>
<td align="center">1</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Thr<sub>TM</sub> = 2</td>
<td align="center">32</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Thr<sub>TM</sub> = 2.5</td>
<td align="center">53</td>
<td align="center">0</td>
</tr>
<tr>
<td align="left"><bold>Fast filter</bold></td>
<td align="left">Thr<sub>ff</sub> = 0.3</td>
<td align="center">3</td>
<td align="center">40</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Thr<sub>ff</sub> = 0.35</td>
<td align="center">11</td>
<td align="center">15</td>
</tr>
<tr>
<td align="left"/>
<td align="left">Thr<sub>ff</sub> = 0.4</td>
<td align="center">19</td>
<td align="center">10</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t005fn001"><p>Event detection results of the proposed approach (CaBBI), the template matching (TM) method, and the fast filter technique. This table uses the same format as <xref ref-type="table" rid="pcbi.1004736.t004">Table 4</xref>. The methods were applied to the second <italic>in vitro</italic> data set with low SNR fast rising transients. The total number of veridical events was 149. The comparison shows that the TM method was the best method for the optimal detection-criterion threshold (Thr<sub>TM</sub> = 1.5). CaBBI (the FHN model) and the fast filter (Thr<sub>ff</sub> = 0.35) had similar event detection accuracy for these data.</p></fn>
</table-wrap-foot>
</table-wrap>
</sec>
</sec>
<sec id="sec036">
<title>Inference on GDP propagation patterns</title>
<p>Above, we already showed the reasonably high accuracy of our method in reconstructing GDP onset times (see <xref ref-type="fig" rid="pcbi.1004736.g008">Fig 8</xref>). We now show the usefulness of this accuracy in inferring the propagation patterns of GDPs, as the complex characteristics of immature neuronal circuits.</p>
<p>We illustrate the reconstruction of GDP characteristics using one representative fluorescent image sequence (out of six) recorded in our experiment. For this image sequence, the fluorescence traces were extracted from 40 well identifiable neurons. The raster plot of color-coded high SNR fluorescence traces in <xref ref-type="fig" rid="pcbi.1004736.g010">Fig 10A</xref> (upper panel) shows clearly visible, spontaneous synchronous network events (i.e. GDPs). The same data under low SNR condition (around 2.5; after contaminating the traces by scaled background noise; see above) is shown in the lower panel of <xref ref-type="fig" rid="pcbi.1004736.g010">Fig 10A</xref>. Using the new method and as a proof of principle, we reconstructed the onset times of all 40 neurons during GDPs, under the low SNR condition. For inversions, we used the QGIF model because of its lower timing error in extraction of GDPs’ onset times, as compared to the FHN model and the TM method (see above). The reconstructed events are shown in <xref ref-type="fig" rid="pcbi.1004736.g010">Fig 10B</xref>, where it can easily be seen that their timings show a close match to the large fluorescence changes in <xref ref-type="fig" rid="pcbi.1004736.g010">Fig 10A</xref> (upper panel).</p>
<fig id="pcbi.1004736.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004736.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Using the proposed approach for large-scale reconstruction of the cellular activation latencies during GDPs.</title>
<p>(<bold>A</bold>) Two raster plots of color-coded <italic>in vitro</italic> fluorescence traces for 40 CA3 immature neurons. Upper Panel: high SNR condition, Lower panel: low SNR condition. (<bold>B)</bold> The reconstructed patterns of onset times of spontaneous activities (both isolated and GDP-mediated events), identified by inverting the QGIF model for low SNR data (lower panel of <bold>A</bold>). (<bold>C</bold>) Histogram of cellular activation latency distributions over all reconstructed GDPs and neurons. The red curve shows a Gaussian fit: with mean = -14.5 and std = 90 <italic>ms</italic>. (<bold>D</bold>) Closer inspection of the reconstructed raster plots in B around the second and third GDPs, unveiling the cellular activation latencies during each GDP. (<bold>E</bold>) The spatiotemporal GDP propagation across neurons can be observed based on color-coded latencies of neurons during the second and third GDPs. SR and SO denote stratum radiatum and stratum oriens of the hippocampal CA3, and DG denotes dentate gyrus.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.g010" xlink:type="simple"/>
</fig>
<p>The histogram of onset latencies of neurons over all GDPs is plotted in <xref ref-type="fig" rid="pcbi.1004736.g010">Fig 10C</xref>. For each GDP, the latencies were computed with respect to the median onset time of neurons during that GDP. In this histogram, the medians are centered on 0 <italic>ms</italic> so that earlier and later activations of neurons have negative and positive values, respectively. The observed latency distribution can be approximated by a Gaussian distribution with a mean of -14.5 <italic>ms</italic> and standard deviation of 90 <italic>ms</italic>, which is consistent with previous reports for the developing hippocampus [<xref ref-type="bibr" rid="pcbi.1004736.ref027">27</xref>]. For visualization of the difference between onset times, we plotted the reconstructed onset times of the second and third GDPs in <xref ref-type="fig" rid="pcbi.1004736.g010">Fig 10D</xref>. In addition, in <xref ref-type="fig" rid="pcbi.1004736.g010">Fig 10E</xref> we show the inferred onset latencies for these two representative GDPs color-coded at their actual spatial positions in the field of view. In the first of these images (second GDP), the GDP pattern starts roughly in the center of the image and spreads to both left-upward and bottom-right, i.e. from the stratum pyramidale (SP) in CA3 towards both CA1 and dentate gyrus (DG). The second image (third GDP) shows, instead, a rather clear unidirectional orientation towards DG. Such wave-like patterns of propagation of these two illustrative GDPs are consistent with previous reports [<xref ref-type="bibr" rid="pcbi.1004736.ref027">27</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref105">105</xref>].</p>
</sec>
<sec id="sec037">
<title>Inferring biophysical parameters</title>
<p>In this section, we show how our approach can be used for quantifying biophysically interpretable parameter changes based on calcium imaging data, e.g. for inferring changes of parameters due to pharmacological interventions. To provide a proof-of-concept, we used two synthetic data sets where we changed: 1) the calcium decay time-constant and 2) the conductance of M-type K<sup>+</sup> channels.</p>
<sec id="sec038">
<title>Change of calcium decay time-constant</title>
<p><bold>I</bold>n general the calcium/fluorescence transients may display variable kinetics. We use the parameterization of a previously reported experiment: Sasaki et al. (2008) [<xref ref-type="bibr" rid="pcbi.1004736.ref005">5</xref>] investigated the contribution of endogenous Ca<sup>2+</sup> stores to calcium transients by pharmacologically depleting calcium in the endoplasmic reticulum. The authors treated the neurons with thapsigargin; an inhibitor of the Ca<sup>2+</sup>-ATPase family of calcium pumps. Their results showed that the thapsigargin profoundly prolongs the decay kinetics of calcium transient while its effect on the transient amplitude is insignificant. We thus reproduced such fluorescence traces (<xref ref-type="fig" rid="pcbi.1004736.g011">Fig 11A and 11B</xref>), first row), by using the FHN as a generative model. Based on values reported by [<xref ref-type="bibr" rid="pcbi.1004736.ref005">5</xref>], we simulated the fluorescence traces by setting <italic>τ</italic><sub><italic>Ca</italic></sub> = 600 <italic>ms</italic> for the control and <italic>τ</italic><sub><italic>Ca</italic></sub> = 6000 <italic>ms</italic> for the thapsigargin-treated neuron. We inverted the model for each generated time series. For the two inversions, we used the same priors for all parameters, as in previous sections (see Tables <xref ref-type="table" rid="pcbi.1004736.t001">1</xref> and <xref ref-type="table" rid="pcbi.1004736.t002">2</xref>), except for two of them: Firstly, for the calcium decay time-constant we used an increased prior mean to inform the inversion about the expected effect of the pharmacological manipulation. Accordingly, we set <inline-formula id="pcbi.1004736.e067"><alternatives><graphic id="pcbi.1004736.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e067" xlink:type="simple"/>
<mml:math display="inline" id="M67"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math>
</alternatives></inline-formula> = 1000 <italic>ms</italic> (consistent with calcium decay time-constant in the mammalian brain [<xref ref-type="bibr" rid="pcbi.1004736.ref009">9</xref>]) for the control and <inline-formula id="pcbi.1004736.e068"><alternatives><graphic id="pcbi.1004736.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e068" xlink:type="simple"/>
<mml:math display="inline" id="M68"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math>
</alternatives></inline-formula> = 9000 <italic>ms</italic> for the thapsigargin-treated fluorescence traces, respectively. Secondly, we slightly increased the observation precision from ϒ<sub><italic>F</italic></sub> = 3 to 5 in order to make the model explain the data by changing the calcium decay time-constant parameter. The results show that the inferred decay time-constants for non-saturating [Ca<sup>2+</sup>] kinetics (<xref ref-type="fig" rid="pcbi.1004736.g011">Fig 11A and 11B</xref>), second row) were reasonably well estimated as <inline-formula id="pcbi.1004736.e069"><alternatives><graphic id="pcbi.1004736.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e069" xlink:type="simple"/>
<mml:math display="inline" id="M69"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math>
</alternatives></inline-formula> ≈ 580 <italic>ms</italic> and 5820 <italic>ms</italic>.</p>
<fig id="pcbi.1004736.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004736.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Inference about parameter changes in synthetic data.</title>
<p>(<bold>A</bold> and <bold>B</bold>): The simulated fluorescence traces (green line) by the FHN model for (<bold>A</bold>) <italic>τ</italic><sub><italic>Ca</italic></sub> = 600 <italic>ms</italic> and (<bold>B</bold>) <italic>τ</italic><sub><italic>Ca</italic></sub> = 6000 <italic>ms</italic>. Red lines show the inferred non-saturating [Ca<sup>2+</sup>] kinetics of the FHN model. (<bold>C</bold> and <bold>D</bold>): the simulated fluorescence traces (green line), membrane potentials (black line), and the applied input current (magenta line, shown in arbitrary units) to the bursting-QGIF neuron models for (<bold>C</bold>) <italic>g</italic><sub><italic>M</italic></sub> = 0.8 and (<bold>D</bold>) <italic>g</italic><sub><italic>M</italic></sub> = 0.45 <italic>mS</italic> / <italic>cm</italic><sup>2</sup>. The bottom panels show the membrane potentials (posterior means; blue lines) inferred using the bursting-QGIF model for the two fluorescence traces. Parameters for simulating the data (different from <xref ref-type="table" rid="pcbi.1004736.t001">Table 1</xref>): (<bold>A</bold>) <italic>τ</italic><sub><italic>Ca</italic></sub> = 600 <italic>ms</italic>, (<bold>B</bold>) <italic>τ</italic><sub><italic>Ca</italic></sub> = 6000 <italic>ms</italic>, (<bold>C</bold> and <bold>D</bold>) <italic>I</italic><sub><italic>app</italic></sub> = 0.74sin(0.003<italic>t</italic>) <italic>μA</italic> / <italic>cm</italic><sup>2</sup>, <italic>g</italic><sub><italic>NaP</italic></sub> = 0.18, <italic>g</italic><sub><italic>L</italic></sub> = 0.01 <italic>mS</italic> / <italic>cm</italic><sup>2</sup>, <italic>κ</italic><sub><italic>F</italic></sub> = 1, <italic>K</italic><sub><italic>d</italic></sub> = 150 <italic>nM</italic>, <italic>τ</italic><sub><italic>Ca</italic></sub> = 500 <italic>ms</italic>, (<bold>C</bold>) <italic>g</italic><sub><italic>M</italic></sub> = 0.8, (<bold>D</bold>) <italic>g</italic><sub><italic>M</italic></sub> = 0.45 <italic>mS</italic> / <italic>cm</italic><sup>2</sup>. Parameters for inversion (different from Tables <xref ref-type="table" rid="pcbi.1004736.t001">1</xref> and <xref ref-type="table" rid="pcbi.1004736.t002">2</xref>): (<bold>A</bold>) ϒ<sub><italic>F</italic></sub> = 5, <inline-formula id="pcbi.1004736.e070"><alternatives><graphic id="pcbi.1004736.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e070" xlink:type="simple"/>
<mml:math display="inline" id="M70"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>1000</mml:mn><mml:mspace width="0.25em"/><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:math>
</alternatives></inline-formula>, (<bold>B</bold>) ϒ<sub><italic>F</italic></sub> = 5, <inline-formula id="pcbi.1004736.e071"><alternatives><graphic id="pcbi.1004736.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e071" xlink:type="simple"/>
<mml:math display="inline" id="M71"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>9000</mml:mn><mml:mspace width="0.25em"/><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:math>
</alternatives></inline-formula>, (<bold>C</bold> and <bold>D</bold>) <inline-formula id="pcbi.1004736.e072"><alternatives><graphic id="pcbi.1004736.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e072" xlink:type="simple"/>
<mml:math display="inline" id="M72"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.25em"/><mml:mi>m</mml:mi><mml:mi>S</mml:mi><mml:mo>/</mml:mo><mml:mi>c</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math>
</alternatives></inline-formula> (the only free parameter, in addition to initial conditions), all other parameters were fixed at their values that we used for simulating <bold>C</bold> and <bold>D</bold>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.g011" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec039">
<title>Change of voltage-gated channel conductance</title>
<p>In a second simulation, we tested how reliably our approach can quantify changes of the conductance of a voltage-gated channel (<xref ref-type="fig" rid="pcbi.1004736.g011">Fig 11C and 11D</xref>). We focused on M-type K<sup>+</sup> channels, which are known to control the burstiness of action potential discharges [<xref ref-type="bibr" rid="pcbi.1004736.ref057">57</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref106">106</xref>]. Therefore, we considered an experiment based on the bursting-QGIF model in which the conductance of M-type K<sup>+</sup> channels was varied (e.g. see [<xref ref-type="bibr" rid="pcbi.1004736.ref106">106</xref>]). We simulated two neurons with exactly the same parameterization (see the caption of <xref ref-type="fig" rid="pcbi.1004736.g011">Fig 11</xref>), except for <italic>g</italic><sub><italic>M</italic></sub> (set to <italic>g</italic><sub><italic>M</italic></sub> = 0.8 and <italic>g</italic><sub><italic>M</italic></sub> = 0.45 <italic>mS</italic> / <italic>cm</italic><sup>2</sup>). For stimulation, we used the same sinusoidal input current for both conditions (<xref ref-type="fig" rid="pcbi.1004736.g011">Fig 11C and 11D</xref>), magenta lines). As expected, this input triggered a lower number of spikes per burst for higher <italic>g</italic><sub><italic>M</italic></sub> (2 spikes; see <xref ref-type="fig" rid="pcbi.1004736.g011">Fig 11C</xref>, black lines), as compared to the second condition (4 spikes, <xref ref-type="fig" rid="pcbi.1004736.g011">Fig 11D</xref>). Note that, as the potassium channels act and integrate effectively in (sub-) millisecond ranges, only fluorescence traces acquired with a sufficiently high temporal precision might be informative about their kinetics. This is important for inferring about the changes in <italic>g</italic><sub><italic>M</italic></sub>. Accordingly, we subsampled the generated fluorescence traces from their original temporal precision (20 <italic>kHz</italic>) to a frame duration of about 0.5 <italic>ms</italic> (<xref ref-type="fig" rid="pcbi.1004736.g011">Fig 11C and 11D</xref>, green lines). Such near millisecond frame duration should be feasible with the advent of new fast imaging techniques (e.g. see [<xref ref-type="bibr" rid="pcbi.1004736.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref025">25</xref>]). Note that, given only these fluorescence traces, inferring about the induced changes in <italic>g</italic><sub><italic>M</italic></sub> is still a challenging task. This is because of the relatively similar values we used for <italic>g</italic><sub><italic>M</italic></sub>, in combination with an indirect, highly nonlinear relationship between the activation variable of this channel and the observed fluorescence traces (see <xref ref-type="sec" rid="sec002">Methods</xref>). To test for a change in <italic>g</italic><sub><italic>M</italic></sub>, we fixed all parameters at their true values (assuming that these parameters have been determined already in an initial baseline experiment), except the initial conditions and <italic>g</italic><sub><italic>M</italic></sub> (see the caption of <xref ref-type="fig" rid="pcbi.1004736.g011">Fig 11</xref>) which we kept as free parameters and for which we used the same priors as before (<xref ref-type="table" rid="pcbi.1004736.t002">Table 2</xref>). This implies that the prior mean of the M-type K<sup>+</sup> conductance is effectively set to <inline-formula id="pcbi.1004736.e073"><alternatives><graphic id="pcbi.1004736.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004736.e073" xlink:type="simple"/>
<mml:math display="inline" id="M73"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:math>
</alternatives></inline-formula> = 1 <italic>ms</italic> / <italic>cm</italic><sup>2</sup> [<xref ref-type="bibr" rid="pcbi.1004736.ref057">57</xref>]. The inversions were not informed about the input current. We found that our method was able to estimate <italic>g</italic><sub><italic>M</italic></sub> for both conditions close to the true values as <italic>g</italic><sub><italic>M</italic></sub> ≈ 0.73 and 0.42 <italic>mS</italic> / <italic>cm</italic><sup>2</sup>, respectively. These estimates were obtained by making a reasonably good inference about the membrane potentials (<xref ref-type="fig" rid="pcbi.1004736.g011">Fig 11C and 11D</xref>, blue lines), and thus the gating variable of the M-type K<sup>+</sup> channels and [Ca<sup>2+</sup>] kinetics (not shown).</p>
<p>In sum, these two synthetic examples show that the new approach can infer and quantify the changes in hidden parameters of interest, given only the fluorescence traces. Particularly, the second example indicates how a focused constraint may enable the sensitive analysis of changes in biophysical parameters.</p>
</sec>
</sec>
</sec>
<sec id="sec040" sec-type="conclusions">
<title>Discussion</title>
<p>We have presented a novel Bayesian, biophysically informed method (called CaBBI; an abbreviation of “<italic>calcium</italic> imaging analysis using <italic>biophysical</italic> models and <italic>Bayesian inference</italic>”) for the analysis of calcium imaging data. Using both synthetic and <italic>in vitro</italic> data we have shown that CaBBI provides an accurate spike reconstruction not only under low SNR conditions but also for different fluorescence transient kinetics, such as slowly rising fluorescence transients of immature neurons. Importantly, as we used a biophysically informed method, we performed the reconstruction without an initial training phase, which is usually required for template-based methods. Using synthetic data, we have shown that the method can accurately reconstruct within-burst spikes, if the temporal resolution is high enough. As two potential applications, we have quantified the onset times of cellular activation during network events such as giant depolarizing potentials (GDPs), as well as changes in biophysically interpretable parameters due to simulated pharmacological interventions.</p>
<sec id="sec041">
<title>Biophysical modelling</title>
<p>The biophysically informed model has the key advantage that the possible fluorescence trace variations are highly constrained by the equations of the generative model (see <xref ref-type="table" rid="pcbi.1004736.t003">Table 3</xref>). This guards the model inference effectively against noise sources which are unlikely to be caused by noise in the modelled neuronal and calcium dynamics. In addition, CaBBI allows the incorporation of prior knowledge about the biophysically interpretable model quantities. The specification of prior distributions is a convenient compromise between fixing and freeing parameters when inverting the model. By varying the width of the prior distribution, one can effectively control how much each parameter or combinations of parameters are determined by the data or by prior knowledge. Although not shown here, formal model comparison can be used to select the best model among different prior specifications [<xref ref-type="bibr" rid="pcbi.1004736.ref107">107</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref108">108</xref>].</p>
<p>The biophysical modelling aspect enables CaBBI to directly infer and quantify biophysically interpretable changes caused by selective manipulations of physiological parameters using a pharmacological intervention (see <xref ref-type="fig" rid="pcbi.1004736.g011">Fig 11</xref>). Critically, one can test specific hypotheses by using suitable priors which are susceptible for the expected changes caused by an intervention. Using model comparison, one can proceed to test this change-sensitive model against an alternative model that does not expect this change. In this paper, we showed such an application for quantifying a particular pharmacologically-induced change: i) in the calcium decay time-constant (<xref ref-type="fig" rid="pcbi.1004736.g011">Fig 11A and 11B</xref>, and ii) in the conductance of M-type K<sup>+</sup> channels (<xref ref-type="fig" rid="pcbi.1004736.g011">Fig 11C and 11D</xref>). We found that CaBBI could reasonably reliably infer about the changes in these protocols, since we appropriately fixed and/or constrained its model quantities thereby informing it about the purpose of each intervention (see the caption of <xref ref-type="fig" rid="pcbi.1004736.g011">Fig 11</xref>). In general, such informative constraints can augment the accuracy of corresponding inference schemes, by guarding them against over-parameterization, non-identifiability, and non-interpretability. These issues may arise from the relative complexity of the generative models (see below), and the nonlinear relationship between the observed fluorescence kinetics and the neuronal dynamics. In principle, we expect that this approach (exemplified in <xref ref-type="fig" rid="pcbi.1004736.g011">Fig 11</xref>) can be applied to other physiological parameters under different experimental conditions, as long as suitable model constraints are used.</p>
<p>To our knowledge, CaBBI is the first method which enables analyzing calcium imaging data based on biophysical models of spike and burst generations. Accordingly, in addition to proposing a pure spike reconstruction method, our aim was to establish a calcium imaging modelling framework for incorporating and inferring neuronal quantities of conductance-based neuronal networks. The main feature of CaBBI is that, using the same parameterization, it can model fluorescence transients with rather different kinetics. Such variability can, in principle, render the spike reconstruction difficult for methods which are based on fixed or prototypical templates, e.g. [<xref ref-type="bibr" rid="pcbi.1004736.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref009">9</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref012">12</xref>–<xref ref-type="bibr" rid="pcbi.1004736.ref014">14</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref017">17</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref109">109</xref>]. In contrast, CaBBI, similar to some previously proposed methods [<xref ref-type="bibr" rid="pcbi.1004736.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref025">25</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref071">71</xref>], does not rely on a fixed template but can adapt itself to the transient kinetics of each individual neuron in order to precisely reconstruct spikes. We showed this for fluorescence traces containing transients with significantly variable kinetics, i.e. with rather inhomogeneous rise and decay kinetics (e.g. see <xref ref-type="fig" rid="pcbi.1004736.g010">Fig 10</xref>). The reason for this adaptation ability is that CaBBI is informed by the generative biophysical model about the possible kinetics and infers the exact kinetics from the data. Therefore, CaBBI does not require an initial training phase neither for constraining the prior distributions [<xref ref-type="bibr" rid="pcbi.1004736.ref025">25</xref>] nor for setting the optimal method parameters manually.</p>
<p>One potential limitation is that CaBBI, as compared to alternative methods, requires rather long computer run times due to the Bayesian inference and the implementation in Matlab. For example, the reconstruction of the spikes of a single fluorescence trace with 6,000 frames using default parameters and the QGIF model requires less than an hour on a standard desktop computer. To compute all inversions reported in this paper in an acceptable time, we made use of compute servers. A second potential limitation is that due to the relative complexity of the generative models we had to fix many of the parameters at some suitable values reported by previous experimental and modelling studies (see <xref ref-type="table" rid="pcbi.1004736.t001">Table 1</xref>). Without these constraints or using proper prior distributions (see <xref ref-type="table" rid="pcbi.1004736.t002">Table 2</xref>), CaBBI may be too unconstrained. In this paper, we demonstrated that such suitable constraints exist for the generative models and data we have used. Finally, the current generative models of CaBBI are not able to reconstruct the spike counts from the burst-evoked transients which have similar shape as single-spike-evoked transients, e.g. due to a low sampling rate. For adult neurons, usually, such transients differ mainly in their amplitudes depending on the spike counts of their underlying events. Although only a few methods (like the fast filter [<xref ref-type="bibr" rid="pcbi.1004736.ref071">71</xref>]) are, at least in principle, able to decode the bursts’ spike counts from such variability (e.g. in the amplitudes), our current generative models treat all such transients as having been evoked by single spikes (e.g. see <xref ref-type="fig" rid="pcbi.1004736.g009">Fig 9</xref>). This is because of the biophysical essence of our neuron models, which relate each resolved transient to a spike, and compensate for such variability in the rise kinetics through a proper regulation of the neuronal dynamics.</p>
</sec>
<sec id="sec042">
<title>FHN and QGIF models</title>
<p>For CaBBI to be applied, one requires a biophysically informed model based on continuous over time, differentiable dynamics. In the literature, a wide range of both spiking and bursting models was reported [<xref ref-type="bibr" rid="pcbi.1004736.ref021">21</xref>], including Hodgkin-Huxley-type models [<xref ref-type="bibr" rid="pcbi.1004736.ref038">38</xref>], Morris-Lecar model [<xref ref-type="bibr" rid="pcbi.1004736.ref110">110</xref>], and Hindmarsh-Rose model [<xref ref-type="bibr" rid="pcbi.1004736.ref036">36</xref>]. Another criterion for CaBBI to work properly is that the generative model should have a rather low number of variables and parameters as the fluorescence trace is not too informative about the underlying neuronal variables due to the temporal smearing of the calcium responses. As a representative of such continuous models we have selected the widely-used FHN model (2D), which is able to produce single spikes [<xref ref-type="bibr" rid="pcbi.1004736.ref040">40</xref>–<xref ref-type="bibr" rid="pcbi.1004736.ref042">42</xref>]. Alternatives would have been analogous 2D models such as the Morris-Lecar model [<xref ref-type="bibr" rid="pcbi.1004736.ref110">110</xref>] or reduced versions of the Hodgkin-Huxley model [<xref ref-type="bibr" rid="pcbi.1004736.ref111">111</xref>]; see also [<xref ref-type="bibr" rid="pcbi.1004736.ref049">49</xref>]. We also used integrate-and-fire (I&amp;F) models. To make them continuous and avoid the discontinuous reset conditions of I&amp;F models, e.g. [<xref ref-type="bibr" rid="pcbi.1004736.ref033">33</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref112">112</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref113">113</xref>], we described two new models called QGIF (1D) and bursting-QGIF (2D), see <xref ref-type="table" rid="pcbi.1004736.t003">Table 3</xref>. These two models adopt a minimum number of required variables for producing the single (QGIF) and burst (bursting-QGIF) spiking patterns. In addition, the QGIF model can be readily extended to describe different types of neurons with their specific active ionic currents [<xref ref-type="bibr" rid="pcbi.1004736.ref114">114</xref>], e.g. we showed this by creating the bursting-QGIF model for hippocampal pyramidal neurons.</p>
<p>With respect to the reconstruction efficiency we found that the FHN model is better suited for more accurate single spike and event (like GDP occurrence) detection than the QGIF model. Under a low SNR, the inferred membrane potentials of the QGIF model were usually relatively noisy and the inferred spikes sometimes did not cross the detection threshold (see <xref ref-type="sec" rid="sec002">Methods</xref>) of zero, and were thus counted as missed events (e.g. see <xref ref-type="table" rid="pcbi.1004736.t004">Table 4</xref>); this indicates that to increase the detection accuracy of the QGIF model one may need to use a lower detection threshold, like -10 <italic>mV</italic>. The greater robustness of the FHN model is possibly due to its recovery variable (<xref ref-type="disp-formula" rid="pcbi.1004736.e027">Eq 2</xref>) whose negative feedback on membrane potential constrains the membrane potential kinetics.</p>
<p>For fluorescence transients with slow rise kinetics observed in our experimental data, we found that the QGIF model can reconstruct the onset times of GDP events more accurately than the FHN model (see <xref ref-type="fig" rid="pcbi.1004736.g008">Fig 8</xref>, and text). The precise GDP onset time reconstruction of the QGIF model was preserved even for low SNR traces. For the QGIF model, the optimization process converges usually quicker than the FHN model. Therefore, in terms of time consumption the QGIF model can be more reasonable to use for data of, e.g., a population of neurons imaged by regular experimental setups which usually acquire data at rather high SNR levels.</p>
</sec>
<sec id="sec043">
<title>Further improvements and extensions</title>
<p>An advantage of CaBBI is that one can readily modify the generative models or replace them with other models. For instance, using CaBBI for the reconstruction of spikes from slowly rising fluorescence transients acquired at near-millisecond temporal resolution may further require a modification of the generative models. To do this, one can incorporate, e.g., an extended model of calcium dynamics (<xref ref-type="disp-formula" rid="pcbi.1004736.e047">Eq 11</xref>) which prolongs the Ca<sup>2+</sup> influx so that the mechanism of delay between the spike occurrence and the fluorescence transient peak is explicitly captured. For data providing such temporal resolution, one can also model the experimentally observed double-exponential decay kinetics of calcium transients including the typically observed rise time [<xref ref-type="bibr" rid="pcbi.1004736.ref013">13</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref115">115</xref>]. In general, this observation reflects the contribution of two [Ca<sup>2+</sup>] decay mechanisms with different time-constants, which can be modeled in <xref ref-type="disp-formula" rid="pcbi.1004736.e047">Eq 11</xref>, similarly to [<xref ref-type="bibr" rid="pcbi.1004736.ref115">115</xref>]. This generalization should provide a better fit to data showing such kinetics, and thus enhance the reconstruction precision.</p>
<p>Large-scale calcium imaging from populations of individual neurons aims to provide a better understanding of neuronal circuit dynamics [<xref ref-type="bibr" rid="pcbi.1004736.ref001">1</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref011">11</xref>]. CaBBI provides a new model-based calcium imaging framework, and as an outlook, may be extended to analyze the data of imaged populations. More specifically, the presented approach is a first step towards incorporating the networks of biophysical spiking neuron models (e.g. see [<xref ref-type="bibr" rid="pcbi.1004736.ref116">116</xref>,<xref ref-type="bibr" rid="pcbi.1004736.ref117">117</xref>]), together with their ubiquitous mechanisms such as synaptic plasticity (e.g. see [<xref ref-type="bibr" rid="pcbi.1004736.ref117">117</xref>–<xref ref-type="bibr" rid="pcbi.1004736.ref119">119</xref>]). We expect that such a network extension enables studying the neuronal dynamics and biophysical parameters of complex neuronal circuits measured indirectly by calcium imaging.</p>
</sec>
</sec>
<sec id="sec044">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004736.s001" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.s001" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Model specifications and parameters.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004736.s002" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.s002" xlink:type="simple">
<label>S2 Appendix</label>
<caption>
<title>Polynomial filter.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004736.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004736.s003" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Additional illustrative results of the proposed approach for <italic>in vitro</italic> fluorescence traces with slowly rising transients.</title>
<p>The same format is used as in <xref ref-type="fig" rid="pcbi.1004736.g009">Fig 9</xref>. This figure shows the inferred membrane potentials (posterior means) when using the FHN and QGIF models for two representative <italic>in vitro</italic> fluorescence traces with slowly rising transients evoked by GDP-mediated single spikes, under low SNR.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1004736.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Grienberger</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Konnerth</surname> <given-names>A</given-names></name> (<year>2012</year>) <article-title>Imaging calcium in neurons</article-title>. <source>Neuron</source> <volume>73</volume>: <fpage>862</fpage>–<lpage>885</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2012.02.011" xlink:type="simple">10.1016/j.neuron.2012.02.011</ext-link></comment> <object-id pub-id-type="pmid">22405199</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brenowitz</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Regehr</surname> <given-names>WG</given-names></name> (<year>2007</year>) <article-title>Reliability and heterogeneity of calcium signaling at single presynaptic boutons of cerebellar granule cells</article-title>. <source>J Neurosci</source> <volume>27</volume>: <fpage>7888</fpage>–<lpage>7898</lpage>. <object-id pub-id-type="pmid">17652580</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Majewska</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sur</surname> <given-names>M</given-names></name> (<year>2003</year>) <article-title>Motility of dendritic spines in visual cortex in vivo: changes during the critical period and effects of visual deprivation</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>100</volume>: <fpage>16024</fpage>–<lpage>16029</lpage>. <object-id pub-id-type="pmid">14663137</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maravall</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mainen</surname> <given-names>ZF</given-names></name>, <name name-style="western"><surname>Sabatini</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Svoboda</surname> <given-names>K</given-names></name> (<year>2000</year>) <article-title>Estimating intracellular calcium concentrations and buffering without wavelength ratioing</article-title>. <source>Biophys J</source> <volume>78</volume>: <fpage>2655</fpage>–<lpage>2667</lpage>. <object-id pub-id-type="pmid">10777761</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sasaki</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Takahashi</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Matsuki</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ikegaya</surname> <given-names>Y</given-names></name> (<year>2008</year>) <article-title>Fast and accurate detection of action potentials from somatic calcium fluctuations</article-title>. <source>Journal of Neurophysiology</source> <volume>100</volume>: <fpage>1668</fpage>–<lpage>1676</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00084.2008" xlink:type="simple">10.1152/jn.00084.2008</ext-link></comment> <object-id pub-id-type="pmid">18596182</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gobel</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Helmchen</surname> <given-names>F</given-names></name> (<year>2007</year>) <article-title>In vivo calcium imaging of neural network function</article-title>. <source>Physiology (Bethesda)</source> <volume>22</volume>: <fpage>358</fpage>–<lpage>365</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004736.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Greenberg</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Houweling</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Kerr</surname> <given-names>JN</given-names></name> (<year>2008</year>) <article-title>Population imaging of ongoing neuronal activity in the visual cortex of awake rats</article-title>. <source>Nat Neurosci</source> <volume>11</volume>: <fpage>749</fpage>–<lpage>751</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2140" xlink:type="simple">10.1038/nn.2140</ext-link></comment> <object-id pub-id-type="pmid">18552841</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ohki</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Chung</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ch'ng</surname> <given-names>YH</given-names></name>, <name name-style="western"><surname>Kara</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Reid</surname> <given-names>RC</given-names></name> (<year>2005</year>) <article-title>Functional imaging with cellular resolution reveals precise micro-architecture in visual cortex</article-title>. <source>Nature</source> <volume>433</volume>: <fpage>597</fpage>–<lpage>603</lpage>. <object-id pub-id-type="pmid">15660108</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kerr</surname> <given-names>JND</given-names></name>, <name name-style="western"><surname>Greenberg</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Helmchen</surname> <given-names>F</given-names></name> (<year>2005</year>) <article-title>Imaging input and output of neocortical networks in vivo</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>102</volume>: <fpage>14063</fpage>–<lpage>14068</lpage>. <object-id pub-id-type="pmid">16157876</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Luo</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Callaway</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Svoboda</surname> <given-names>K</given-names></name> (<year>2008</year>) <article-title>Genetic dissection of neural circuits</article-title>. <source>Neuron</source> <volume>57</volume>: <fpage>634</fpage>–<lpage>660</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2008.01.002" xlink:type="simple">10.1016/j.neuron.2008.01.002</ext-link></comment> <object-id pub-id-type="pmid">18341986</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ikegaya</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Aaron</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Cossart</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Aronov</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lampl</surname> <given-names>I</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Synfire chains and cortical songs: temporal modules of cortical activity</article-title>. <source>Science</source> <volume>304</volume>: <fpage>559</fpage>–<lpage>564</lpage>. <object-id pub-id-type="pmid">15105494</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smetters</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Majewska</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name> (<year>1999</year>) <article-title>Detecting action potentials in neuronal populations with calcium imaging</article-title>. <source>Methods</source> <volume>18</volume>: <fpage>215</fpage>–<lpage>221</lpage>. <object-id pub-id-type="pmid">10356353</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Grewe</surname> <given-names>BF</given-names></name>, <name name-style="western"><surname>Langer</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kasper</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kampa</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Helmchen</surname> <given-names>F</given-names></name> (<year>2010</year>) <article-title>High-speed in vivo calcium imaging reveals neuronal network activity with near-millisecond precision (vol 7, pg 399, 2010)</article-title>. <source>Nature Methods</source> <volume>7</volume>: <fpage>479</fpage>–<lpage>479</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004736.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kerr</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>de Kock</surname> <given-names>CP</given-names></name>, <name name-style="western"><surname>Greenberg</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Bruno</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Sakmann</surname> <given-names>B</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Spatial organization of neuronal population responses in layer 2/3 of rat barrel cortex</article-title>. <source>J Neurosci</source> <volume>27</volume>: <fpage>13316</fpage>–<lpage>13328</lpage>. <object-id pub-id-type="pmid">18045926</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moreaux</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Laurent</surname> <given-names>G</given-names></name> (<year>2007</year>) <article-title>Estimating firing rates from calcium signals in locust projection neurons in vivo</article-title>. <source>Front Neural Circuits</source> <volume>1</volume>: <fpage>2</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/neuro.04.002.2007" xlink:type="simple">10.3389/neuro.04.002.2007</ext-link></comment> <object-id pub-id-type="pmid">18946544</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mukamel</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Nimmerjahn</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schnitzer</surname> <given-names>MJ</given-names></name> (<year>2009</year>) <article-title>Automated analysis of cellular signals from large-scale calcium imaging data</article-title>. <source>Neuron</source> <volume>63</volume>: <fpage>747</fpage>–<lpage>760</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2009.08.009" xlink:type="simple">10.1016/j.neuron.2009.08.009</ext-link></comment> <object-id pub-id-type="pmid">19778505</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yaksi</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Friedrich</surname> <given-names>RW</given-names></name> (<year>2006</year>) <article-title>Reconstruction of firing rate changes across neuronal populations by temporally deconvolved Ca2+ imaging</article-title>. <source>Nat Methods</source> <volume>3</volume>: <fpage>377</fpage>–<lpage>383</lpage>. <object-id pub-id-type="pmid">16628208</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ramdya</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Reiter</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Engert</surname> <given-names>F</given-names></name> (<year>2006</year>) <article-title>Reverse correlation of rapid calcium signals in the zebrafish optic tectum in vivo</article-title>. <source>J Neurosci Methods</source> <volume>157</volume>: <fpage>230</fpage>–<lpage>237</lpage>. <object-id pub-id-type="pmid">16765450</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vogelstein</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Watson</surname> <given-names>BO</given-names></name>, <name name-style="western"><surname>Packer</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Jedynak</surname> <given-names>B</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Spike Inference from Calcium Imaging Using Sequential Monte Carlo Methods</article-title>. <source>Biophysical Journal</source> <volume>97</volume>: <fpage>636</fpage>–<lpage>655</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2008.08.005" xlink:type="simple">10.1016/j.bpj.2008.08.005</ext-link></comment> <object-id pub-id-type="pmid">19619479</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref020"><label>20</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Ermentrout</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Terman</surname> <given-names>D</given-names></name> (<year>2010</year>) <source>Mathematical Foundations of Neuroscience</source>: <publisher-name>Springer</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1004736.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Izhikevich</surname> <given-names>EM</given-names></name> (<year>2004</year>) <article-title>Which model to use for cortical spiking neurons?</article-title> <source>Neural Networks, IEEE Transactions on</source> <volume>15</volume>: <fpage>1063</fpage>–<lpage>1070</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004736.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>David</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Kiebel</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Harrison</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Mattout</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kilner</surname> <given-names>JM</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Dynamic causal modeling of evoked responses in EEG and MEG</article-title>. <source>Neuroimage</source> <volume>30</volume>: <fpage>1255</fpage>–<lpage>1272</lpage>. <object-id pub-id-type="pmid">16473023</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kiebel</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Garrido</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Moran</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name> (<year>2009</year>) <article-title>Dynamic causal modeling for EEG and MEG</article-title>. <source>Hum Brain Mapp</source> <volume>30</volume>: <fpage>1866</fpage>–<lpage>1876</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/hbm.20775" xlink:type="simple">10.1002/hbm.20775</ext-link></comment> <object-id pub-id-type="pmid">19360734</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cornelisse</surname> <given-names>LN</given-names></name>, <name name-style="western"><surname>van Elburg</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Meredith</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Mansvelder</surname> <given-names>HD</given-names></name> (<year>2007</year>) <article-title>High speed two-photon imaging of calcium dynamics in dendritic spines: consequences for spine calcium kinetics and buffer capacity</article-title>. <source>PLoS One</source> <volume>2</volume>: <fpage>e1073</fpage>. <object-id pub-id-type="pmid">17957255</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ranganathan</surname> <given-names>GN</given-names></name>, <name name-style="western"><surname>Koester</surname> <given-names>HJ</given-names></name> (<year>2010</year>) <article-title>Optical recording of neuronal spiking activity from unbiased populations of neurons with high spike detection efficiency and high temporal precision</article-title>. <source>J Neurophysiol</source> <volume>104</volume>: <fpage>1812</fpage>–<lpage>1824</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00197.2010" xlink:type="simple">10.1152/jn.00197.2010</ext-link></comment> <object-id pub-id-type="pmid">20610791</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yasuda</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Nimchinsky</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Scheuss</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Pologruto</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Oertner</surname> <given-names>TG</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Imaging calcium concentration dynamics in small neuronal compartments</article-title>. <source>Sci STKE</source> <volume>2004</volume>: pl5.</mixed-citation></ref>
<ref id="pcbi.1004736.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Takano</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>McCartney</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ortinski</surname> <given-names>PI</given-names></name>, <name name-style="western"><surname>Yue</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Putt</surname> <given-names>ME</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Deterministic and stochastic neuronal contributions to distinct synchronous CA3 network bursts</article-title>. <source>J Neurosci</source> <volume>32</volume>: <fpage>4743</fpage>–<lpage>4754</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4277-11.2012" xlink:type="simple">10.1523/JNEUROSCI.4277-11.2012</ext-link></comment> <object-id pub-id-type="pmid">22492030</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Harris</surname> <given-names>KD</given-names></name>, <name name-style="western"><surname>Hirase</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Leinekugel</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Henze</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Buzsaki</surname> <given-names>G</given-names></name> (<year>2001</year>) <article-title>Temporal interaction between single spikes and complex spike bursts in hippocampal pyramidal cells</article-title>. <source>Neuron</source> <volume>32</volume>: <fpage>141</fpage>–<lpage>149</lpage>. <object-id pub-id-type="pmid">11604145</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Traub</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Wong</surname> <given-names>RKS</given-names></name>, <name name-style="western"><surname>Miles</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Michelson</surname> <given-names>H</given-names></name> (<year>1991</year>) <article-title>A Model of a Ca3 Hippocampal Pyramidal Neuron Incorporating Voltage-Clamp Data on Intrinsic Conductances</article-title>. <source>Journal of Neurophysiology</source> <volume>66</volume>: <fpage>635</fpage>–<lpage>650</lpage>. <object-id pub-id-type="pmid">1663538</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wong</surname> <given-names>RK</given-names></name>, <name name-style="western"><surname>Stewart</surname> <given-names>M</given-names></name> (<year>1992</year>) <article-title>Different firing patterns generated in dendrites and somata of CA1 pyramidal neurones in guinea-pig hippocampus</article-title>. <source>J Physiol</source> <volume>457</volume>: <fpage>675</fpage>–<lpage>687</lpage>. <object-id pub-id-type="pmid">1297848</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Kiebel</surname> <given-names>SJ</given-names></name> (<year>2009</year>) <article-title>Variational Bayesian identification and prediction of stochastic nonlinear dynamic causal models</article-title>. <source>Physica D-Nonlinear Phenomena</source> <volume>238</volume>: <fpage>2089</fpage>–<lpage>2118</lpage>. <object-id pub-id-type="pmid">19862351</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hodgkin</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Huxley</surname> <given-names>AF</given-names></name> (<year>1952</year>) <article-title>A Quantitative Description of Membrane Current and Its Application to Conduction and Excitation in Nerve</article-title>. <source>Journal of Physiology-London</source> <volume>117</volume>: <fpage>500</fpage>–<lpage>544</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004736.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Izhikevich</surname> <given-names>EM</given-names></name> (<year>2003</year>) <article-title>Simple model of spiking neurons</article-title>. <source>IEEE Trans Neural Netw</source> <volume>14</volume>: <fpage>1569</fpage>–<lpage>1572</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TNN.2003.820440" xlink:type="simple">10.1109/TNN.2003.820440</ext-link></comment> <object-id pub-id-type="pmid">18244602</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McCormick</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Huguenard</surname> <given-names>JR</given-names></name> (<year>1992</year>) <article-title>A model of the electrophysiological properties of thalamocortical relay neurons</article-title>. <source>J Neurophysiol</source> <volume>68</volume>: <fpage>1384</fpage>–<lpage>1400</lpage>. <object-id pub-id-type="pmid">1331356</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rinzel</surname> <given-names>J</given-names></name> (<year>1985</year>) <article-title>Excitation dynamics: insights from simplified membrane models</article-title>. <source>Fed Proc</source> <volume>44</volume>: <fpage>2944</fpage>–<lpage>2946</lpage>. <object-id pub-id-type="pmid">2415401</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rose</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Hindmarsh</surname> <given-names>JL</given-names></name> (<year>1989</year>) <article-title>The assembly of ionic currents in a thalamic neuron. I. The three-dimensional model</article-title>. <source>Proc R Soc Lond B Biol Sci</source> <volume>237</volume>: <fpage>267</fpage>–<lpage>288</lpage>. <object-id pub-id-type="pmid">2571154</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Clancy</surname> <given-names>CE</given-names></name> (<year>2008</year>) <article-title>Ionic mechanisms of endogenous bursting in CA3 hippocampal pyramidal neurons: a model study</article-title>. <source>PLoS One</source> <volume>3</volume>: <fpage>e2056</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0002056" xlink:type="simple">10.1371/journal.pone.0002056</ext-link></comment> <object-id pub-id-type="pmid">18446231</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pospischil</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Toledo-Rodriguez</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Monier</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Piwkowska</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Bal</surname> <given-names>T</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Minimal Hodgkin-Huxley type models for different classes of cortical and thalamic neurons</article-title>. <source>Biol Cybern</source> <volume>99</volume>: <fpage>427</fpage>–<lpage>441</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00422-008-0263-8" xlink:type="simple">10.1007/s00422-008-0263-8</ext-link></comment> <object-id pub-id-type="pmid">19011929</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref039"><label>39</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Rinzel</surname> <given-names>J</given-names></name> (<year>1987</year>) <chapter-title>A Formal Classification of Bursting Mechanisms in Excitable Systems</chapter-title>. In: <name name-style="western"><surname>Teramoto</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Yumaguti</surname> <given-names>M</given-names></name>, editors. <source>Mathematical Topics in Population Biology, Morphogenesis and Neurosciences</source>: <publisher-name>Springer</publisher-name> <publisher-loc>Berlin Heidelberg</publisher-loc>. pp. <fpage>267</fpage>–<lpage>281</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004736.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fitzhugh</surname> <given-names>R</given-names></name> (<year>1961</year>) <article-title>Impulses and Physiological States in Theoretical Models of Nerve Membrane</article-title>. <source>Biophys J</source> <volume>1</volume>: <fpage>445</fpage>–<lpage>466</lpage>. <object-id pub-id-type="pmid">19431309</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Izhikevich</surname> <given-names>EMaF</given-names></name>, <name name-style="western"><surname>R</surname></name>. (<year>2006</year>) <article-title>FitzHugh-Nagumo model</article-title>. <source>Scholarpedia</source> <volume>1</volume>: <fpage>1349</fpage>.</mixed-citation></ref>
<ref id="pcbi.1004736.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nagumo</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Arimoto</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Yoshizawa</surname> <given-names>S</given-names></name> (<year>1962</year>) <article-title>Active Pulse Transmission Line Simulating Nerve Axon</article-title>. <source>Proceedings of the Institute of Radio Engineers</source> <volume>50</volume>: <fpage>2061</fpage>–&amp;.</mixed-citation></ref>
<ref id="pcbi.1004736.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>FitzHugh</surname> <given-names>R</given-names></name> (<year>1955</year>) <article-title>Mathematical models of threshold phenomena in the nerve membrane</article-title>. <source>Bulletin of Mathematical Biology</source> <volume>17</volume>: <fpage>257</fpage>–<lpage>278</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004736.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Knight</surname> <given-names>BW</given-names></name> (<year>1972</year>) <article-title>Dynamics of encoding in a population of neurons</article-title>. <source>J Gen Physiol</source> <volume>59</volume>: <fpage>734</fpage>–<lpage>766</lpage>. <object-id pub-id-type="pmid">5025748</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lapicque</surname> <given-names>L</given-names></name> (<year>1907</year>) <article-title>Recherches quantitatives sur l’excitation electrique des nerfs traitee comme une polarization</article-title>. <source>J Physiol Pathol Gen</source> <volume>9</volume>: <fpage>620</fpage>–<lpage>635</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004736.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stein</surname> <given-names>RB</given-names></name> (<year>1967</year>) <article-title>Some Models of Neuronal Variability</article-title>. <source>Biophysical Journal</source> <volume>7</volume>: <fpage>37</fpage>–<lpage>68</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(67)86574-3" xlink:type="simple">10.1016/S0006-3495(67)86574-3</ext-link></comment> <object-id pub-id-type="pmid">19210981</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref047"><label>47</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Tuckwell</surname> <given-names>HC</given-names></name> (<year>1988</year>) <chapter-title>Introduction to theoretical neurobiology</chapter-title>. <publisher-loc>Cambridge Cambridgeshire; New York</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1004736.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Trocmé</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Hansel</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>van Vreeswijk</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name> (<year>2003</year>) <article-title>How spike generation mechanisms determine the neuronal response to fluctuating inputs</article-title>. <source>Journal of Neuroscience</source> <volume>23</volume>: <fpage>11628</fpage>–<lpage>11640</lpage>. <object-id pub-id-type="pmid">14684865</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref049"><label>49</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Izhikevich</surname> <given-names>E</given-names></name> (<year>2007</year>) <chapter-title>Dynamical systems in neuroscience: the geometry of excitability and bursting</chapter-title>: <publisher-name>MIT Press</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1004736.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Latham</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Richmond</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>PG</given-names></name>, <name name-style="western"><surname>Nirenberg</surname> <given-names>S</given-names></name> (<year>2000</year>) <article-title>Intrinsic dynamics in neuronal networks. I. Theory</article-title>. <source>J Neurophysiol</source> <volume>83</volume>: <fpage>808</fpage>–<lpage>827</lpage>. <object-id pub-id-type="pmid">10669496</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Izhikevich</surname> <given-names>EM</given-names></name> (<year>2006</year>) <article-title>Bursting</article-title>. <source>Scholarpedia</source> <volume>1</volume>: <fpage>1300</fpage>.</mixed-citation></ref>
<ref id="pcbi.1004736.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cooper</surname> <given-names>DC</given-names></name> (<year>2002</year>) <article-title>The significance of action potential bursting in the brain reward circuit</article-title>. <source>Neurochem Int</source> <volume>41</volume>: <fpage>333</fpage>–<lpage>340</lpage>. <object-id pub-id-type="pmid">12176075</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kepecs</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>XJ</given-names></name>, <name name-style="western"><surname>Lisman</surname> <given-names>J</given-names></name> (<year>2002</year>) <article-title>Bursting neurons signal input slope</article-title>. <source>J Neurosci</source> <volume>22</volume>: <fpage>9053</fpage>–<lpage>9062</lpage>. <object-id pub-id-type="pmid">12388612</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lisman</surname> <given-names>JE</given-names></name> (<year>1997</year>) <article-title>Bursts as a unit of neural information: making unreliable synapses reliable</article-title>. <source>Trends Neurosci</source> <volume>20</volume>: <fpage>38</fpage>–<lpage>43</lpage>. <object-id pub-id-type="pmid">9004418</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buckmaster</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Amaral</surname> <given-names>DG</given-names></name> (<year>2001</year>) <article-title>Intracellular recording and labeling of mossy cells and proximal CA3 pyramidal cells in macaque monkeys</article-title>. <source>J Comp Neurol</source> <volume>430</volume>: <fpage>264</fpage>–<lpage>281</lpage>. <object-id pub-id-type="pmid">11135261</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Azouz</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Jensen</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Yaari</surname> <given-names>Y</given-names></name> (<year>1996</year>) <article-title>Ionic basis of spike after-depolarization and burst generation in adult rat hippocampal CA1 pyramidal cells</article-title>. <source>The Journal of physiology</source> <volume>492</volume> (<issue>Pt 1</issue>): <fpage>211</fpage>–<lpage>223</lpage>. <object-id pub-id-type="pmid">8730596</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref057"><label>57</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Golomb</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Yue</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Yaari</surname> <given-names>Y</given-names></name> (<year>2006</year>) <article-title>Contribution of persistent Na+ current and M-type K+ current to somatic bursting in CA1 pyramidal cells: combined experimental and modeling study</article-title>. <source>J Neurophysiol</source> <volume>96</volume>: <fpage>1912</fpage>–<lpage>1926</lpage>. <object-id pub-id-type="pmid">16807352</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref058"><label>58</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sipila</surname> <given-names>ST</given-names></name>, <name name-style="western"><surname>Huttu</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Voipio</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kaila</surname> <given-names>K</given-names></name> (<year>2006</year>) <article-title>Intrinsic bursting of immature CA3 pyramidal neurons and consequent giant depolarizing potentials are driven by a persistent Na+ current and terminated by a slow Ca2+ -activated K+ current</article-title>. <source>Eur J Neurosci</source> <volume>23</volume>: <fpage>2330</fpage>–<lpage>2338</lpage>. <object-id pub-id-type="pmid">16706841</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref059"><label>59</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Su</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Alroy</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Kirson</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Yaari</surname> <given-names>Y</given-names></name> (<year>2001</year>) <article-title>Extracellular calcium modulates persistent sodium current-dependent burst-firing in hippocampal pyramidal neurons</article-title>. <source>J Neurosci</source> <volume>21</volume>: <fpage>4173</fpage>–<lpage>4182</lpage>. <object-id pub-id-type="pmid">11404402</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref060"><label>60</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Adam</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Rigoux</surname> <given-names>L</given-names></name> (<year>2014</year>) <article-title>VBA: a probabilistic treatment of nonlinear models for neurobiological and behavioural data</article-title>. <source>PLoS Comput Biol</source> <volume>10</volume>: <fpage>e1003441</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003441" xlink:type="simple">10.1371/journal.pcbi.1003441</ext-link></comment> <object-id pub-id-type="pmid">24465198</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref061"><label>61</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Catterall</surname> <given-names>WA</given-names></name> (<year>2000</year>) <article-title>Structure and regulation of voltage-gated Ca2+ channels</article-title>. <source>Annu Rev Cell Dev Biol</source> <volume>16</volume>: <fpage>521</fpage>–<lpage>555</lpage>. <object-id pub-id-type="pmid">11031246</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref062"><label>62</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Helmchen</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Imoto</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sakmann</surname> <given-names>B</given-names></name> (<year>1996</year>) <article-title>Ca2+ buffering and action potential-evoked Ca2+ signaling in dendrites of pyramidal neurons</article-title>. <source>Biophys J</source> <volume>70</volume>: <fpage>1069</fpage>–<lpage>1081</lpage>. <object-id pub-id-type="pmid">8789126</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref063"><label>63</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Elliott</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Malouf</surname> <given-names>AT</given-names></name>, <name name-style="western"><surname>Catterall</surname> <given-names>WA</given-names></name> (<year>1995</year>) <article-title>Role of calcium channel subtypes in calcium transients in hippocampal CA3 neurons</article-title>. <source>J Neurosci</source> <volume>15</volume>: <fpage>6433</fpage>–<lpage>6444</lpage>. <object-id pub-id-type="pmid">7472406</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref064"><label>64</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ermentrout</surname> <given-names>B</given-names></name> (<year>1998</year>) <article-title>Linearization of F-I curves by adaptation</article-title>. <source>Neural Comput</source> <volume>10</volume>: <fpage>1721</fpage>–<lpage>1729</lpage>. <object-id pub-id-type="pmid">9744894</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref065"><label>65</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Helton</surname> <given-names>TD</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Lipscombe</surname> <given-names>D</given-names></name> (<year>2005</year>) <article-title>Neuronal L-type calcium channels open quickly and are inhibited slowly</article-title>. <source>J Neurosci</source> <volume>25</volume>: <fpage>10247</fpage>–<lpage>10251</lpage>. <object-id pub-id-type="pmid">16267232</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref066"><label>66</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tuckwell</surname> <given-names>HC</given-names></name> (<year>2012</year>) <article-title>Quantitative aspects of L-type Ca2+ currents</article-title>. <source>Prog Neurobiol</source> <volume>96</volume>: <fpage>1</fpage>–<lpage>31</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.pneurobio.2011.09.010" xlink:type="simple">10.1016/j.pneurobio.2011.09.010</ext-link></comment> <object-id pub-id-type="pmid">22008116</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref067"><label>67</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kudela</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Franaszczuk</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Bergey</surname> <given-names>GK</given-names></name> (<year>2003</year>) <article-title>Reduction of intracellular calcium removal rate can explain changes in seizure dynamics: studies in neuronal network models</article-title>. <source>Epilepsy Res</source> <volume>57</volume>: <fpage>95</fpage>–<lpage>109</lpage>. <object-id pub-id-type="pmid">15013051</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref068"><label>68</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Traub</surname> <given-names>RD</given-names></name> (<year>1982</year>) <article-title>Simulation of intrinsic bursting in CA3 hippocampal neurons</article-title>. <source>Neuroscience</source> <volume>7</volume>: <fpage>1233</fpage>–<lpage>1242</lpage>. <object-id pub-id-type="pmid">7110586</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref069"><label>69</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mishchenko</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Vogelstein</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name> (<year>2011</year>) <article-title>A Bayesian approach for inferring neuronal connectivity from calcium fluorescent imaging data</article-title>. <source>The Annals of Applied Statistics</source> <volume>5</volume>: <fpage>1229</fpage>–<lpage>1261</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004736.ref070"><label>70</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pologruto</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Yasuda</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Svoboda</surname> <given-names>K</given-names></name> (<year>2004</year>) <article-title>Monitoring neural activity and [Ca2+] with genetically encoded Ca2+ indicators</article-title>. <source>J Neurosci</source> <volume>24</volume>: <fpage>9572</fpage>–<lpage>9579</lpage>. <object-id pub-id-type="pmid">15509744</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref071"><label>71</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vogelstein</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Packer</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Machado</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Sippy</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Babadi</surname> <given-names>B</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Fast nonnegative deconvolution for spike train inference from population calcium imaging</article-title>. <source>J Neurophysiol</source> <volume>104</volume>: <fpage>3691</fpage>–<lpage>3704</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.01073.2009" xlink:type="simple">10.1152/jn.01073.2009</ext-link></comment> <object-id pub-id-type="pmid">20554834</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref072"><label>72</label><mixed-citation publication-type="other" xlink:type="simple">Beal M (2003) Variational algorithms for approximate Bayesian inference.</mixed-citation></ref>
<ref id="pcbi.1004736.ref073"><label>73</label><mixed-citation publication-type="other" xlink:type="simple">Tanaka T (1999) A theory of mean field approximation. Proceedings of the 1998 conference on Advances in neural information processing systems II: MIT Press. pp. 351–357.</mixed-citation></ref>
<ref id="pcbi.1004736.ref074"><label>74</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Mattout</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Trujillo-Barreto</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ashburner</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Penny</surname> <given-names>W</given-names></name> (<year>2007</year>) <article-title>Variational free energy and the Laplace approximation</article-title>. <source>Neuroimage</source> <volume>34</volume>: <fpage>220</fpage>–<lpage>234</lpage>. <object-id pub-id-type="pmid">17055746</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref075"><label>75</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Stephan</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name> (<year>2012</year>) <article-title>Stochastic dynamic causal modelling of fMRI data: should we care about neural noise?</article-title> <source>Neuroimage</source> <volume>62</volume>: <fpage>464</fpage>–<lpage>481</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2012.04.061" xlink:type="simple">10.1016/j.neuroimage.2012.04.061</ext-link></comment> <object-id pub-id-type="pmid">22579726</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref076"><label>76</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stosiek</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Garaschuk</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Holthoff</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Konnerth</surname> <given-names>A</given-names></name> (<year>2003</year>) <article-title>In vivo two-photon calcium imaging of neuronal networks</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>100</volume>: <fpage>7319</fpage>–<lpage>7324</lpage>. <object-id pub-id-type="pmid">12777621</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref077"><label>77</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Helmchen</surname> <given-names>F</given-names></name> (<year>2011</year>) <article-title>Calibration of Fluorescent Calcium Indicators</article-title>. <source>Cold Spring Harbor Protocols</source> <volume>2011</volume>: pdb.top120.</mixed-citation></ref>
<ref id="pcbi.1004736.ref078"><label>78</label><mixed-citation publication-type="other" xlink:type="simple">Chouhan VS, Mehta SS. Total Removal of Baseline Drift from ECG Signal; 2007 5–7 March 2007. pp. 512–515.</mixed-citation></ref>
<ref id="pcbi.1004736.ref079"><label>79</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lowe</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Russell</surname> <given-names>DP</given-names></name> (<year>1999</year>) <article-title>Treatment of baseline drifts in fMRI time series analysis</article-title>. <source>J Comput Assist Tomogr</source> <volume>23</volume>: <fpage>463</fpage>–<lpage>473</lpage>. <object-id pub-id-type="pmid">10348457</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref080"><label>80</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Lewis</surname> <given-names>BK</given-names></name>, <name name-style="western"><surname>Ruttimann</surname> <given-names>UE</given-names></name>, <name name-style="western"><surname>Ye</surname> <given-names>FQ</given-names></name>, <name name-style="western"><surname>Sinnwell</surname> <given-names>TM</given-names></name>, <etal>et al</etal>. (<year>1999</year>) <article-title>Investigation of low frequency drift in fMRI signal</article-title>. <source>Neuroimage</source> <volume>9</volume>: <fpage>526</fpage>–<lpage>533</lpage>. <object-id pub-id-type="pmid">10329292</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref081"><label>81</label><mixed-citation publication-type="other" xlink:type="simple">Yizhao N, Chu C, Saunders CJ, Ashburner J. Kernel methods for fMRI pattern prediction; 2008 1–8 June 2008. pp. 692–697.</mixed-citation></ref>
<ref id="pcbi.1004736.ref082"><label>82</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friman</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Borga</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lundberg</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Knutsson</surname> <given-names>H</given-names></name> (<year>2004</year>) <article-title>Detection and detrending in fMRI data analysis</article-title>. <source>Neuroimage</source> <volume>22</volume>: <fpage>645</fpage>–<lpage>655</lpage>. <object-id pub-id-type="pmid">15193593</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref083"><label>83</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friman</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Borga</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lundberg</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Knutsson</surname> <given-names>H</given-names></name> (<year>2002</year>) <article-title>Exploratory fMRI analysis by autocorrelation maximization</article-title>. <source>Neuroimage</source> <volume>16</volume>: <fpage>454</fpage>–<lpage>464</lpage>. <object-id pub-id-type="pmid">12030831</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref084"><label>84</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Worsley</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Liao</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Aston</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Petre</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Duncan</surname> <given-names>GH</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title>A general statistical analysis for fMRI data</article-title>. <source>Neuroimage</source> <volume>15</volume>: <fpage>1</fpage>–<lpage>15</lpage>. <object-id pub-id-type="pmid">11771969</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref085"><label>85</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Clements</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Bekkers</surname> <given-names>JM</given-names></name> (<year>1997</year>) <article-title>Detection of spontaneous synaptic events with an optimally scaled template</article-title>. <source>Biophys J</source> <volume>73</volume>: <fpage>220</fpage>–<lpage>229</lpage>. <object-id pub-id-type="pmid">9199786</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref086"><label>86</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oh</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Oliveira</surname> <given-names>FA</given-names></name>, <name name-style="western"><surname>Waters</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Disterhoft</surname> <given-names>JF</given-names></name> (<year>2013</year>) <article-title>Altered calcium metabolism in aging CA1 hippocampal pyramidal neurons</article-title>. <source>J Neurosci</source> <volume>33</volume>: <fpage>7905</fpage>–<lpage>7911</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.5457-12.2013" xlink:type="simple">10.1523/JNEUROSCI.5457-12.2013</ext-link></comment> <object-id pub-id-type="pmid">23637181</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref087"><label>87</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chen</surname> <given-names>TW</given-names></name>, <name name-style="western"><surname>Wardill</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Pulver</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Renninger</surname> <given-names>SL</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Ultrasensitive fluorescent proteins for imaging neuronal activity</article-title>. <source>Nature</source> <volume>499</volume>: <fpage>295</fpage>–<lpage>300</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12354" xlink:type="simple">10.1038/nature12354</ext-link></comment> <object-id pub-id-type="pmid">23868258</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref088"><label>88</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Horikawa</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Yamada</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Matsuda</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kobayashi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hashimoto</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Spontaneous network activity visualized by ultrasensitive Ca(2+) indicators, yellow Cameleon-Nano</article-title>. <source>Nat Methods</source> <volume>7</volume>: <fpage>729</fpage>–<lpage>732</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1488" xlink:type="simple">10.1038/nmeth.1488</ext-link></comment> <object-id pub-id-type="pmid">20693999</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref089"><label>89</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reiff</surname> <given-names>DF</given-names></name>, <name name-style="western"><surname>Ihring</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Guerrero</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Isacoff</surname> <given-names>EY</given-names></name>, <name name-style="western"><surname>Joesch</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>In vivo performance of genetically encoded indicators of neural activity in flies</article-title>. <source>J Neurosci</source> <volume>25</volume>: <fpage>4766</fpage>–<lpage>4778</lpage>. <object-id pub-id-type="pmid">15888652</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref090"><label>90</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilt</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>Fitzgerald</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Schnitzer</surname> <given-names>MJ</given-names></name> (<year>2013</year>) <article-title>Photon shot noise limits on optical detection of neuronal spikes and estimation of spike timing</article-title>. <source>Biophys J</source> <volume>104</volume>: <fpage>51</fpage>–<lpage>62</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2012.07.058" xlink:type="simple">10.1016/j.bpj.2012.07.058</ext-link></comment> <object-id pub-id-type="pmid">23332058</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref091"><label>91</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Golshani</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Goncalves</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Khoshkhoo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mostany</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Smirnakis</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Internally mediated developmental desynchronization of neocortical network activity</article-title>. <source>J Neurosci</source> <volume>29</volume>: <fpage>10890</fpage>–<lpage>10899</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.2012-09.2009" xlink:type="simple">10.1523/JNEUROSCI.2012-09.2009</ext-link></comment> <object-id pub-id-type="pmid">19726647</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref092"><label>92</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Onativia</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schultz</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Dragotti</surname> <given-names>PL</given-names></name> (<year>2013</year>) <article-title>A finite rate of innovation algorithm for fast and accurate spike detection from two-photon calcium imaging</article-title>. <source>J Neural Eng</source> <volume>10</volume>: <fpage>046017</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1741-2560/10/4/046017" xlink:type="simple">10.1088/1741-2560/10/4/046017</ext-link></comment> <object-id pub-id-type="pmid">23860257</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref093"><label>93</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Visscher</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Brakenhoff</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Visser</surname> <given-names>TD</given-names></name> (<year>1994</year>) <article-title>Fluorescence saturation in confocal microscopy</article-title>. <source>Journal of Microscopy</source> <volume>175</volume>: <fpage>162</fpage>–<lpage>165</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004736.ref094"><label>94</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Konnerth</surname> <given-names>A</given-names></name> (<year>2005</year>) <chapter-title>Imaging in neuroscience and development: a laboratory manual</chapter-title>. <publisher-loc>Cold Spring Harbor, N.Y.</publisher-loc>: <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>. <volume>xvi</volume>, 854 p. p.</mixed-citation></ref>
<ref id="pcbi.1004736.ref095"><label>95</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Park</surname> <given-names>IJ</given-names></name>, <name name-style="western"><surname>Bobkov</surname> <given-names>YV</given-names></name>, <name name-style="western"><surname>Ache</surname> <given-names>BW</given-names></name>, <name name-style="western"><surname>Principe</surname> <given-names>JC</given-names></name> (<year>2013</year>) <article-title>Quantifying bursting neuron activity from calcium signals using blind deconvolution</article-title>. <source>J Neurosci Methods</source> <volume>218</volume>: <fpage>196</fpage>–<lpage>205</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jneumeth.2013.05.007" xlink:type="simple">10.1016/j.jneumeth.2013.05.007</ext-link></comment> <object-id pub-id-type="pmid">23711821</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref096"><label>96</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lutcke</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Gerhard</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Zenke</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Helmchen</surname> <given-names>F</given-names></name> (<year>2013</year>) <article-title>Inference of neuronal network spike dynamics and topology from calcium imaging data</article-title>. <source>Front Neural Circuits</source> <volume>7</volume>: <fpage>201</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncir.2013.00201" xlink:type="simple">10.3389/fncir.2013.00201</ext-link></comment> <object-id pub-id-type="pmid">24399936</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref097"><label>97</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ben-Ari</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Cherubini</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Corradetti</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gaiarsa</surname> <given-names>JL</given-names></name> (<year>1989</year>) <article-title>Giant synaptic potentials in immature rat CA3 hippocampal neurones</article-title>. <source>J Physiol</source> <volume>416</volume>: <fpage>303</fpage>–<lpage>325</lpage>. <object-id pub-id-type="pmid">2575165</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref098"><label>98</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Valeeva</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Abdullin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tyzio</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Skorinkin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Nikolski</surname> <given-names>E</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Temporal coding at the immature depolarizing GABAergic synapse</article-title>. <source>Front Cell Neurosci</source> <volume>4</volume>.</mixed-citation></ref>
<ref id="pcbi.1004736.ref099"><label>99</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ben-Ari</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Gaiarsa</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Tyzio</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Khazipov</surname> <given-names>R</given-names></name> (<year>2007</year>) <article-title>GABA: a pioneer transmitter that excites immature neurons and generates primitive oscillations</article-title>. <source>Physiol Rev</source> <volume>87</volume>: <fpage>1215</fpage>–<lpage>1284</lpage>. <object-id pub-id-type="pmid">17928584</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref100"><label>100</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Leinekugel</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Khalilov</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Ben-Ari</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Khazipov</surname> <given-names>R</given-names></name> (<year>1998</year>) <article-title>Giant depolarizing potentials: the septal pole of the hippocampus paces the activity of the developing intact septohippocampal complex in vitro</article-title>. <source>J Neurosci</source> <volume>18</volume>: <fpage>6349</fpage>–<lpage>6357</lpage>. <object-id pub-id-type="pmid">9698326</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref101"><label>101</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eilers</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Callewaert</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Armstrong</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Konnerth</surname> <given-names>A</given-names></name> (<year>1995</year>) <article-title>Calcium signaling in a narrow somatic submembrane shell during synaptic activity in cerebellar Purkinje neurons</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>92</volume>: <fpage>10272</fpage>–<lpage>10276</lpage>. <object-id pub-id-type="pmid">7479766</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref102"><label>102</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eilers</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Plant</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Konnerth</surname> <given-names>A</given-names></name> (<year>1996</year>) <article-title>Localized calcium signalling and neuronal integration in cerebellar Purkinje neurones</article-title>. <source>Cell Calcium</source> <volume>20</volume>: <fpage>215</fpage>–<lpage>226</lpage>. <object-id pub-id-type="pmid">8889210</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref103"><label>103</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rochefort</surname> <given-names>NL</given-names></name>, <name name-style="western"><surname>Garaschuk</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Milos</surname> <given-names>RI</given-names></name>, <name name-style="western"><surname>Narushima</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Marandi</surname> <given-names>N</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Sparsification of neuronal activity in the visual cortex at eye-opening</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>106</volume>: <fpage>15049</fpage>–<lpage>15054</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0907660106" xlink:type="simple">10.1073/pnas.0907660106</ext-link></comment> <object-id pub-id-type="pmid">19706480</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref104"><label>104</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schiller</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Helmchen</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Sakmann</surname> <given-names>B</given-names></name> (<year>1995</year>) <article-title>Spatial profile of dendritic calcium transients evoked by action potentials in rat neocortical pyramidal neurones</article-title>. <source>J Physiol</source> <volume>487</volume> (<issue>Pt 3</issue>): <fpage>583</fpage>–<lpage>600</lpage>. <object-id pub-id-type="pmid">8544123</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref105"><label>105</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bolea</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sanchez-Andres</surname> <given-names>JV</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>JY</given-names></name> (<year>2006</year>) <article-title>Initiation and propagation of neuronal coactivation in the developing hippocampus</article-title>. <source>J Neurophysiol</source> <volume>95</volume>: <fpage>552</fpage>–<lpage>561</lpage>. <object-id pub-id-type="pmid">16177178</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref106"><label>106</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yue</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Yaari</surname> <given-names>Y</given-names></name> (<year>2004</year>) <article-title>KCNQ/M channels control spike afterdepolarization and burst generation in hippocampal neurons</article-title>. <source>J Neurosci</source> <volume>24</volume>: <fpage>4614</fpage>–<lpage>4624</lpage>. <object-id pub-id-type="pmid">15140933</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref107"><label>107</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rigoux</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Stephan</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name> (<year>2014</year>) <article-title>Bayesian model selection for group studies—revisited</article-title>. <source>Neuroimage</source> <volume>84</volume>: <fpage>971</fpage>–<lpage>985</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2013.08.065" xlink:type="simple">10.1016/j.neuroimage.2013.08.065</ext-link></comment> <object-id pub-id-type="pmid">24018303</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref108"><label>108</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stephan</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Penny</surname> <given-names>WD</given-names></name>, <name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Moran</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name> (<year>2009</year>) <article-title>Bayesian model selection for group studies</article-title>. <source>Neuroimage</source> <volume>46</volume>: <fpage>1004</fpage>–<lpage>1017</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2009.03.025" xlink:type="simple">10.1016/j.neuroimage.2009.03.025</ext-link></comment> <object-id pub-id-type="pmid">19306932</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref109"><label>109</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sato</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Gray</surname> <given-names>NW</given-names></name>, <name name-style="western"><surname>Mainen</surname> <given-names>ZF</given-names></name>, <name name-style="western"><surname>Svoboda</surname> <given-names>K</given-names></name> (<year>2007</year>) <article-title>The functional microarchitecture of the mouse barrel cortex</article-title>. <source>PLoS Biol</source> <volume>5</volume>: <fpage>e189</fpage>. <object-id pub-id-type="pmid">17622195</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref110"><label>110</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morris</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lecar</surname> <given-names>H</given-names></name> (<year>1981</year>) <article-title>Voltage oscillations in the barnacle giant muscle fiber</article-title>. <source>Biophys J</source> <volume>35</volume>: <fpage>193</fpage>–<lpage>213</lpage>. <object-id pub-id-type="pmid">7260316</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref111"><label>111</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moehlis</surname> <given-names>J</given-names></name> (<year>2006</year>) <article-title>Canards for a reduction of the Hodgkin-Huxley equations</article-title>. <source>J Math Biol</source> <volume>52</volume>: <fpage>141</fpage>–<lpage>153</lpage>. <object-id pub-id-type="pmid">16195925</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref112"><label>112</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Burkitt</surname> <given-names>AN</given-names></name> (<year>2006</year>) <article-title>A review of the integrate-and-fire neuron model: I. Homogeneous synaptic input</article-title>. <source>Biol Cybern</source> <volume>95</volume>: <fpage>1</fpage>–<lpage>19</lpage>. <object-id pub-id-type="pmid">16622699</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref113"><label>113</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname> <given-names>GD</given-names></name>, <name name-style="western"><surname>Cox</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Sherman</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Rinzel</surname> <given-names>J</given-names></name> (<year>2000</year>) <article-title>Fourier analysis of sinusoidally driven thalamocortical relay neurons and a minimal integrate-and-fire-or-burst model</article-title>. <source>J Neurophysiol</source> <volume>83</volume>: <fpage>588</fpage>–<lpage>610</lpage>. <object-id pub-id-type="pmid">10634897</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref114"><label>114</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Hille</surname> <given-names>B</given-names></name> (<year>2001</year>) <source>Ion Channels of Excitable Membranes</source> (<edition>3rd Edition</edition>): <publisher-name>Sinauer Associates Inc</publisher-name> 2001–07.</mixed-citation></ref>
<ref id="pcbi.1004736.ref115"><label>115</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Majewska</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Ross</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name> (<year>2000</year>) <article-title>Mechanisms of calcium decay kinetics in hippocampal spines: role of spine calcium pumps and calcium diffusion through the spine neck in biochemical compartmentalization</article-title>. <source>J Neurosci</source> <volume>20</volume>: <fpage>1722</fpage>–<lpage>1734</lpage>. <object-id pub-id-type="pmid">10684874</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref116"><label>116</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shriki</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Hansel</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name> (<year>2003</year>) <article-title>Rate models for conductance-based cortical neuronal networks</article-title>. <source>Neural Comput</source> <volume>15</volume>: <fpage>1809</fpage>–<lpage>1841</lpage>. <object-id pub-id-type="pmid">14511514</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref117"><label>117</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Standage</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Trappenberg</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Blohm</surname> <given-names>G</given-names></name> (<year>2014</year>) <article-title>Calcium-dependent calcium decay explains STDP in a dynamic model of hippocampal synapses</article-title>. <source>PLoS One</source> <volume>9</volume>: <fpage>e86248</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0086248" xlink:type="simple">10.1371/journal.pone.0086248</ext-link></comment> <object-id pub-id-type="pmid">24465987</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref118"><label>118</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hennig</surname> <given-names>MH</given-names></name> (<year>2013</year>) <article-title>Theoretical models of synaptic short term plasticity</article-title>. <source>Front Comput Neurosci</source> <volume>7</volume>: <fpage>154</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncom.2013.00154" xlink:type="simple">10.3389/fncom.2013.00154</ext-link></comment> <object-id pub-id-type="pmid">24198783</object-id></mixed-citation></ref>
<ref id="pcbi.1004736.ref119"><label>119</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tsodyks</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Uziel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name> (<year>2000</year>) <article-title>Synchrony generation in recurrent networks with frequency-dependent synapses</article-title>. <source>J Neurosci</source> <volume>20</volume>: <fpage>RC50</fpage>. <object-id pub-id-type="pmid">10627627</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>