<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-00553</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005362</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Medical microbiology</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Microbial genomics</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Microbial genomics</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Thermodynamics</subject><subj-group><subject>Entropy</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Immune cells</subject><subj-group><subject>Antibody-producing cells</subject><subj-group><subject>B cells</subject><subj-group><subject>Memory B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>Antibody-producing cells</subject><subj-group><subject>B cells</subject><subj-group><subject>Memory B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>Antibody-producing cells</subject><subj-group><subject>B cells</subject><subj-group><subject>Memory B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Blood cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>B cells</subject><subj-group><subject>Memory B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>B cells</subject><subj-group><subject>Memory B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>B cells</subject><subj-group><subject>Memory B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>B cells</subject><subj-group><subject>Memory B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Community ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Community ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Immune cells</subject><subj-group><subject>Antibody-producing cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>Antibody-producing cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>Antibody-producing cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Blood cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>B cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecological metrics</subject><subj-group><subject>Species diversity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecological metrics</subject><subj-group><subject>Species diversity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune system proteins</subject><subj-group><subject>Immune receptors</subject><subj-group><subject>B cell receptors</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune system proteins</subject><subj-group><subject>Immune receptors</subject><subj-group><subject>B cell receptors</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Immune system proteins</subject><subj-group><subject>Immune receptors</subject><subj-group><subject>B cell receptors</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Signal transduction</subject><subj-group><subject>Immune receptors</subject><subj-group><subject>B cell receptors</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Microbial taxonomy</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Microbial taxonomy</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Quantitative Comparison of Abundance Structures of Generalized Communities: From B-Cell Receptor Repertoires to Microbiomes</article-title>
<alt-title alt-title-type="running-head">Quantitative Comparison of Abundance Structures of Generalized Communities</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Saeedghalati</surname> <given-names>Mohammadkarim</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Farahpour</surname> <given-names>Farnoush</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9313-8636</contrib-id>
<name name-style="western">
<surname>Budeus</surname> <given-names>Bettina</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Lange</surname> <given-names>Anja</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Westendorf</surname> <given-names>Astrid M.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Seifert</surname> <given-names>Marc</given-names></name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Küppers</surname> <given-names>Ralf</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2973-7869</contrib-id>
<name name-style="western">
<surname>Hoffmann</surname> <given-names>Daniel</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Bioinformatics and Computational Biophysics, Faculty of Biology, University of Duisburg-Essen, Essen, Germany</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Center for Medical Biotechnology, University of Duisburg-Essen, Essen, Germany</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Institute of Medical Microbiology, Medical Faculty, University of Duisburg-Essen, Essen, Germany</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Institute of Cell Biology (Cancer Research), Medical Faculty, University of Duisburg-Essen, Essen, Germany</addr-line>
</aff>
<aff id="aff005">
<label>5</label>
<addr-line>Center for Computational Sciences and Simulation, University of Duisburg-Essen, Essen, Germany</addr-line>
</aff>
<aff id="aff006">
<label>6</label>
<addr-line>Center for Water and Environmental Research, University of Duisburg-Essen, Essen, Germany</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Matthews</surname> <given-names>Thomas</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Oxford, UNITED KINGDOM</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item>
<p><bold>Conceptualization:</bold> MSa FF DH.</p>
</list-item>
<list-item>
<p><bold>Data curation:</bold> MSa FF BB.</p>
</list-item>
<list-item>
<p><bold>Formal analysis:</bold> MSa FF DH.</p>
</list-item>
<list-item>
<p><bold>Funding acquisition:</bold> RK DH.</p>
</list-item>
<list-item>
<p><bold>Investigation:</bold> MSa FF DH.</p>
</list-item>
<list-item>
<p><bold>Methodology:</bold> MSa FF DH.</p>
</list-item>
<list-item>
<p><bold>Project administration:</bold> DH.</p>
</list-item>
<list-item>
<p><bold>Resources:</bold> MSa FF MSe RK BB DH.</p>
</list-item>
<list-item>
<p><bold>Software:</bold> MSa FF DH.</p>
</list-item>
<list-item>
<p><bold>Supervision:</bold> RK AMW DH.</p>
</list-item>
<list-item>
<p><bold>Validation:</bold> MSa FF RK MSe AMW DH.</p>
</list-item>
<list-item>
<p><bold>Visualization:</bold> MSa FF DH.</p>
</list-item>
<list-item>
<p><bold>Writing – original draft:</bold> MSa FF DH.</p>
</list-item>
<list-item>
<p><bold>Writing – review &amp; editing:</bold> MSa FF BB AL AMW MSe RK DH.</p>
</list-item>
</list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">daniel.hoffmann@uni-due.de</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>1</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>23</day>
<month>1</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>1</issue>
<elocation-id>e1005362</elocation-id>
<history>
<date date-type="received">
<day>5</day>
<month>4</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>12</day>
<month>1</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Saeedghalati et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005362"/>
<abstract>
<p>The <italic>community</italic>, the assemblage of organisms co-existing in a given space and time, has the potential to become one of the unifying concepts of biology, especially with the advent of high-throughput sequencing experiments that reveal genetic diversity exhaustively. In this spirit we show that a tool from community ecology, the Rank Abundance Distribution (RAD), can be turned by the new MaxRank normalization method into a generic, expressive descriptor for quantitative comparison of communities in many areas of biology. To illustrate the versatility of the method, we analyze RADs from various <italic>generalized communities</italic>, i.e. assemblages of genetically diverse cells or organisms, including human B cells, gut microbiomes under antibiotic treatment and of different ages and countries of origin, and other human and environmental microbial communities. We show that normalized RADs enable novel quantitative approaches that help to understand structures and dynamics of complex generalized communities.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Living things are parts of complex communities, similar to humans living in cities. A quantitative way of describing such communities is to measure the abundance of each species in the community so that a sorted list of abundance numbers is produced, a so-called Rank Abundance Distribution (RAD). With recent breakthroughs in genome analysis this approach can also be applied to very complex communities, such as the community of the myriads of microbes in a human gut (gut microbiome), or the diverse set of human immune cells. One problem with this approach is that it is not trivial to quantitatively compare RADs for different communities, especially if they are highly complex. We show that it is possible to computationally “normalize” RADs so that they can be quantitatively compared across many different communities. In this way, this normalization enables insight into structures and dynamics of arbitrary communities. We demonstrate this with applications to human immune cells, gut microbiomes under antibiotic treatment or under different nutritional regimes, and environmental microbiomes.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Deutsche Forschungsgemeinschaft (DE)</institution>
</funding-source>
<award-id>TRR60/A2</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Küppers</surname> <given-names>R.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>Deutsche Forschungsgemeinschaft (DE)</institution>
</funding-source>
<award-id>TRR60/B1</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2973-7869</contrib-id>
<name name-style="western">
<surname>Hoffmann</surname> <given-names>Daniel</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution>Deutsche Forschungsgemeinschaft (DE)</institution>
</funding-source>
<award-id>KU1315/8-1</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Küppers</surname> <given-names>R.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by grant numbers TRR60/A2, TRR60/B1, KU1315/8-1 from Deutsche Forschungsgemeinschaft, <ext-link ext-link-type="uri" xlink:href="http://www.dfg.de" xlink:type="simple">http://www.dfg.de</ext-link>. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="12"/>
<table-count count="2"/>
<page-count count="29"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-02-06</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All data sets used in this work are available without limitations from public repositories as detailed in the Materials and Methods section.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The <italic>community</italic>, i.e. the assemblage of organisms co-existing in a given space and time, is central to much of ecology [<xref ref-type="bibr" rid="pcbi.1005362.ref001">1</xref>], and since Darwin’s “entangled bank” [<xref ref-type="bibr" rid="pcbi.1005362.ref002">2</xref>] one of the great challenges of biology is to explain the observed species diversity in communities mechanistically as a consequence of interactions and evolution. Modern experimental methods of high-throughput sequencing have brought us closer to complete inventories of community diversity. Moreover, these methods enable us to widen the scope of the community concept to <italic>generalized communities</italic>, that we define as assemblages of genomically diverse entities, which include, apart from communities in classical ecology, for instance B or T cell repertoires of the adaptive immune system, viral quasi-species, tumors, or human microbiomes.</p>
<p>An intuitive description of a community composition is a table with columns <italic>species</italic> and <italic>abundance</italic>, possibly ordered from most to least abundant species (we use the term <italic>species</italic> here in a loose sense for operational taxonomic units or other genomically distinct biological entities). A visually more accessible graphical representation of this table would be a plot that arranges the species along the horizontal axis and the abundances as vertical bars, sorted from highest to lowest bar. While such a plot is expressive for a specific community, it does not lend itself to quantitative comparisons between communities. To illustrate this point, consider a comparison of a community of South-American animal species with one of Sub-Saharan African animal species from regions with otherwise similar conditions. The two species columns of our table would have practically no overlap so that a direct comparison of these tables or plots is not possible. The same lack of overlap has to be expected for other generalized communities. For instance if we compare high-throughput sequencing data of B cell receptors of two persons, it is unlikely that there are receptors on mature B cells that occur in both persons. Nevertheless, it is a meaningful biological question whether the abundance structures of the two sets of B cells differ, e.g. whether the B cell repertoire is dominated by a few clones with high cell numbers, or whether it is distributed over many different clones with low cell numbers.</p>
<p>A popular method for community comparison even in the absence of species overlap is to compute for each community a diversity index [<xref ref-type="bibr" rid="pcbi.1005362.ref003">3</xref>], i.e. a single number that characterizes one aspect of the community, for instance the species richness, the evenness of the distribution, the Shannon entropy, or one of many related measures [<xref ref-type="bibr" rid="pcbi.1005362.ref004">4</xref>], and then to compare the values of these indices between communities. The main disadvantage of this index approach is that it reduces a feature-rich abundance distribution to a single number, which may neglect important characteristics of that distribution.</p>
<p>An alternative approach that had a major influence on the development of the theoretical foundations of modern ecology is to discard the species labels of the species-abundance table, which then becomes a so-called Species Abundance Distribution (SAD; for excellent reviews see [<xref ref-type="bibr" rid="pcbi.1005362.ref005">5</xref>], or [<xref ref-type="bibr" rid="pcbi.1005362.ref006">6</xref>], chapter 9). There are several established ways of presenting the information contained in a SAD (see Fig 1 of [<xref ref-type="bibr" rid="pcbi.1005362.ref005">5</xref>]), for instance as straightforward histogram with species abundance as function of a species index, or as a binned histogram, typically with doubling bin widths with decreasing abundance. Here we focus on the Rank Abundance Distribution or RAD (<xref ref-type="fig" rid="pcbi.1005362.g001">Fig 1</xref>) as SAD representation. RADs are simply vectors of species abundances sorted in decreasing order, usually visualized as two dimensional plots, possibly with one or both axes scaled logarithmically. In comparison to the mentioned simple and binned histograms, RADs are more smooth due to their component sorting [<xref ref-type="bibr" rid="pcbi.1005362.ref007">7</xref>], and they retain the full biological resolution of the sampling experiment. The information content in RADs and probability distribution functions is the same, and one can be transformed into the other (see e.g. [<xref ref-type="bibr" rid="pcbi.1005362.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005362.ref009">9</xref>]).</p>
<fig id="pcbi.1005362.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005362.g001</object-id>
<label>Fig 1</label>
<caption>
<title>A typical Rank Abundance Distribution (RAD).</title>
<p>A RAD with species abundances plotted in decreasing order from the most abundant (rank 10<sup>0</sup> = 1) on the left to the least abundant species sampled from the community on the right. Both axes are scaled logarithmically to reveal the global structure of the RAD. Quantities such as the number of sampled individuals or the richness of the sample can be easily retrieved from the RAD.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005362.g001" xlink:type="simple"/>
</fig>
<p>Obviously, RADs retain the complete shape information of species-abundance tables. The abstraction of species information means that RADs enable analysis of generic abundance distribution features of generalized communities, independently of the actual species composition.</p>
<p>RADs, and more generally SADs have been a key conceptual tool in the development and benchmarking of mechanistic models of ecological communities [<xref ref-type="bibr" rid="pcbi.1005362.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1005362.ref015">15</xref>]. The mathematical functions resulting from mechanistic or statistical models, such as the log-normal distribution, were usually fitted to empirical RADs or SADs to identify the best community model. This basic research has paved the way for the application of these distributions to community comparisons, for instance to the characterization of community changes with changing environmental conditions (see e.g. [<xref ref-type="bibr" rid="pcbi.1005362.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1005362.ref017">17</xref>]. In these cases, the community comparison is typically a parameter comparison between fits of generic mathematical models to different RADs or SADs, or it is a purely visual comparison of these distributions [<xref ref-type="bibr" rid="pcbi.1005362.ref005">5</xref>].</p>
<p>In real-world samples, RADs are often not adequately described by a uniform mathematical model, e.g. a single log-normal distribution [<xref ref-type="bibr" rid="pcbi.1005362.ref018">18</xref>]. In macroecology, knowledge about the properties and relations between the observed animals and plants can be used to deconstruct multimodal distributions, and to fit simple models to fractions of the samples [<xref ref-type="bibr" rid="pcbi.1005362.ref003">3</xref>]. This knowledge is generally not available for high-throughput sequencing data of complex generalized communities, so that RAD analyses based on simple parametric models are difficult. This calls for a non-parametric approach. A further problem is that in practice the number of sampled species or sequences usually differs between samples. This means that RADs often have different dimensions and cannot be compared directly. It is possible to test for arbitrary pairs of RADs the null hypothesis that they originate from the same distribution using the Kolmogorov-Smirnov test [<xref ref-type="bibr" rid="pcbi.1005362.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005362.ref019">19</xref>], but this is usually not helpful for quantitative comparisons. Technically, differences between a pair of RADs of different richness <italic>m</italic>, <italic>n</italic> could be also quantified by the Kolmogorov-Smirnov statistic <italic>D</italic> evaluated for the corresponding pair of cumulative distribution functions. However, it is problematic to interpret <italic>D</italic> in such cases since we are forced to equate non-reporting of |<italic>m</italic> − <italic>n</italic>| ranks in the shorter RAD with zero abundance, although the non-reporting may have technical reasons, e.g. limited sequencing depth. Thus, the question arises whether quantitative RAD comparisons are possible between samples of different richness. We quote from the widely cited SAD review by McGill <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005362.ref005">5</xref>]:</p>
<p>“How do we compare SADs? Nearly all comparisons of SADs along gradients, deconstructions or time trajectories to date have been purely by visual inspection (…). Most particularly, these visual inspections have been performed on rank-abundance plots which, by using an x-axis that runs from 1 to S (i.e. species richness), seriously confounds the effects of species richness per se with other changes in the shape of the SAD (…). Changes in species richness are a legitimate factor that should be considered a change in shape of the SAD. However, changes in richness so strongly dominate in rank-abundance plots that no other changes are easily considered. Is there any other change in the shape of an SAD after controlling for the fact that productivity affects richness? We cannot say at the present time (…) More rigorous multivariate methods are needed.”</p>
<p>Here, we introduce MaxRank normalization of RADs, a new method that enables quantitative comparison of RADs, including their shapes. The approach is non-parametric and allows for the direct quantitative comparison of complex RADs without deconstruction and model fitting. An essential component of the method is the re-sampling of RADs up to a given richness. Consequently, the resulting normalized RADs (NRADs) are largely agnostic about the true richness of the original sample.</p>
<p>The fact MaxRank normalization uses re-sampling may lead to conflation with <italic>rarefaction</italic> and <italic>rarefying</italic> (on the distinction between the terms see [<xref ref-type="bibr" rid="pcbi.1005362.ref020">20</xref>]), two other techniques that also use re-sampling. <italic>Rarefaction</italic> [<xref ref-type="bibr" rid="pcbi.1005362.ref021">21</xref>] is typically used to estimate and compare richness between samples, i.e. exactly the quantity that is not of interest in MaxRank normalization. <italic>Rarefying</italic> (e.g. [<xref ref-type="bibr" rid="pcbi.1005362.ref022">22</xref>]) is applied to normalize OTU counts between samples. However, it is precisely the purpose of RADs and MaxRank normalization to abandon OTUs, and thus to make quantitative comparisons of abundance structures of different communities possible, irrespective of OTUs.</p>
<p>We show here that results from the quantitative comparison of normalized RADs reflect biological differences between samples. To emphasize the versatility of the method, we have chosen a diverse set of high-throughput sequencing data representing different types of generalized communities, namely, human B cell receptor repertoires, and various human and environmental microbiomes.</p>
<p>As one example of generalized communities we use human B cell receptor (BCR) repertoires. The diversity of BCRs in an individual is crucial for the recognition of antigens and the adaptive immune response [<xref ref-type="bibr" rid="pcbi.1005362.ref023">23</xref>]. Here we focus on the so-called <italic>heavy</italic> part of the receptor encoded by combinations of gene segments of the Ig heavy chain (IGHV) locus (<xref ref-type="fig" rid="pcbi.1005362.g002">Fig 2A</xref>; [<xref ref-type="bibr" rid="pcbi.1005362.ref024">24</xref>]), and especially on the diversity of the “variable” <italic>V</italic><sub><italic>H</italic></sub> segments in that part (<xref ref-type="fig" rid="pcbi.1005362.g002">Fig 2B</xref>). Based on sequence homology, the <italic>V</italic><sub><italic>H</italic></sub> segments are grouped into seven families (<italic>V</italic><sub><italic>H</italic></sub>1—<italic>V</italic><sub><italic>H</italic></sub>7), with members of a family having more than 80% sequence homology [<xref ref-type="bibr" rid="pcbi.1005362.ref025">25</xref>]. The sizes of the families vary from 1 (<italic>V</italic><sub><italic>H</italic></sub>6 family) to 18–21 (<italic>V</italic><sub><italic>H</italic></sub>3 family). The primary repertoire of rearranged IGHV genes among naïve, antigen-inexperienced B cells (<xref ref-type="fig" rid="pcbi.1005362.g002">Fig 2C</xref>) typically encompasses all available <italic>V</italic><sub><italic>H</italic></sub> segments, although abundances can vary considerably between <italic>V</italic><sub><italic>H</italic></sub> gene segments. Exposure to antigens leads to a selective adaptation of the BCR repertoire that results in individual-specific sets of memory B cells (<xref ref-type="fig" rid="pcbi.1005362.g002">Fig 2D</xref>). In the course of this complex maturation process, the usage of <italic>V</italic><sub><italic>H</italic></sub> segments in BCR rearrangement repertoires may change. On top of this layer of complexity, several <italic>classes</italic> of BCRs with different biological functions, such as IgG or IgM, are generated by class switching. Depending on the chronological order of these different processes, and on the individual immune histories, we can expect more similar or more divergent IGHV gene diversity between receptor classes and individuals in memory B cells. We study this question with RADs computed from High-Throughput Sequencing (HTSeq) data.</p>
<fig id="pcbi.1005362.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005362.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Diversity of the <italic>V</italic><sub><italic>H</italic></sub> region of BCRs.</title>
<p>(A) The human genome contains sets of <italic>V</italic><sub><italic>H</italic></sub>, <italic>D</italic><sub><italic>H</italic></sub>, and <italic>J</italic><sub><italic>H</italic></sub> gene segments. (B) The “variable” <italic>V</italic><sub><italic>H</italic></sub> segments can be grouped into seven <italic>V</italic><sub><italic>H</italic></sub> families based on sequence similarity. (C) A genetically diverse pool of B cells is generated by V(D)J recombination. (D) Exposure to antigens induces an adaptation of the BCR repertoire, generating genetic variants and changing the usage pattern of <italic>V</italic><sub><italic>H</italic></sub> gene segments.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005362.g002" xlink:type="simple"/>
</fig>
<p>HTSeq technology is also transforming the study of microbial communities, because it allows us for the first time to see these complex assemblages in their full diversity [<xref ref-type="bibr" rid="pcbi.1005362.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1005362.ref027">27</xref>]. For instance, we now start to see the diverse composition of human gut microbiomes, and we begin to understand the links between the human microbiome, health and disease [<xref ref-type="bibr" rid="pcbi.1005362.ref028">28</xref>]. However, the deluge of data makes us also aware of the need for new ways to analyze and model such complex systems, e.g. with methods developed in ecology [<xref ref-type="bibr" rid="pcbi.1005362.ref029">29</xref>], such as RADs. We have selected three HTSeq data sets to demonstrate the potential and limitations of RADs for the analysis and the modeling of microbiomes: the considerable effect of antibiotics on gut microbiomes [<xref ref-type="bibr" rid="pcbi.1005362.ref030">30</xref>], a large collection of gut microbiomes from countries where different life styles prevail [<xref ref-type="bibr" rid="pcbi.1005362.ref031">31</xref>], and a diverse set of human and environmental microbiomes [<xref ref-type="bibr" rid="pcbi.1005362.ref032">32</xref>]. In these examples, we use RADs as an analytic tool to generate easily interpretable results, and as a basis for quantitative models.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec003">
<title>Datasets</title>
<p>In the work presented here we used high-throughput sequencing (HTSeq) amplicon data from four different sources to compute and analyze NRADs, as described in the following.</p>
<sec id="sec004">
<title>B cell dataset</title>
<p>HTSeq amplicon data of IGHV genes were obtained for four different memory B cell fractions, <italic>IgG</italic><sup>+</sup><italic>CD</italic>27<sup>−</sup> (for short: <italic>IgG</italic><sup>+</sup>), <italic>IgG</italic><sup>+</sup><italic>CD</italic>27<sup>+</sup>, <italic>IgM</italic><sup>+</sup><italic>IgD</italic><sup>+</sup><italic>CD</italic>27<sup>+</sup>, <inline-formula id="pcbi.1005362.e001"><alternatives><graphic id="pcbi.1005362.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mi>I</mml:mi> <mml:mi>g</mml:mi> <mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow> <mml:mo>+</mml:mo></mml:msubsup> <mml:mi>C</mml:mi> <mml:mi>D</mml:mi> <mml:msup><mml:mn>27</mml:mn> <mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, from two unrelated healthy donors, as published in [<xref ref-type="bibr" rid="pcbi.1005362.ref033">33</xref>] and in NCBI Sequence Read Archive (SRA) entry SRP062460. Since each fraction was split evenly into two independently processed subsamples, the total number of analyzed samples was 16. Sequence processing was described in [<xref ref-type="bibr" rid="pcbi.1005362.ref033">33</xref>]. Briefly, reads of bad quality were removed, and remaining reads collapsed to single sequences to eliminate PCR bias. Sequences were then assigned to their respective <italic>V</italic><sub><italic>H</italic></sub> gene segments. For all 16 samples, NRADs were computed using <italic>V</italic><sub><italic>H</italic></sub> gene segments as “species” and the number of distinct sequences assigned to each <italic>V</italic><sub><italic>H</italic></sub> gene segment as abundance of the respective species.</p>
</sec>
<sec id="sec005">
<title>Gut microbiome dataset</title>
<p>HTSeq data (bacterial 16S rRNA gene fragment amplicons) from 528 human gut microbiomes [<xref ref-type="bibr" rid="pcbi.1005362.ref031">31</xref>] were retrieved from MG-RAST project 401 (<ext-link ext-link-type="uri" xlink:href="http://metagenomics.anl.gov/" xlink:type="simple">http://metagenomics.anl.gov/</ext-link>). The dataset comprised 114 samples from rural Malawi, 315 samples from US metropolitan areas, and 99 samples from the Amazon region of Venezuela. Human subjects were aged between 11 days to 83 years with a median of 14 years.</p>
</sec>
<sec id="sec006">
<title>GlobalPatterns dataset</title>
<p>Caporaso <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005362.ref032">32</xref>] evaluated diversity patterns of microbial communities across a panel of HTSeq samples (bacterial 16S rRNA gene fragment amplicons) from diverse sources, including samples from human feces, skin, and tongue, environmental samples from ocean, estuary sediment, freshwater, soil, and three mock communities. Data from 26 of these samples were available through the R-package phyloseq [<xref ref-type="bibr" rid="pcbi.1005362.ref034">34</xref>], version 1.12.2. We used the OTU (Operational Taxonomic Unit) tables provided by phyloseq to compute NRADs. For better readability, samples were renamed according to the type of sample origin and given a consecutive sample number, e.g. from old names <italic>LMEpi24M</italic>, <italic>SLEpi20M</italic> in [<xref ref-type="bibr" rid="pcbi.1005362.ref032">32</xref>] to new names <italic>lake1</italic>, <italic>lake2</italic>. For human origins <italic>tongue</italic>, <italic>palm</italic>, <italic>feces</italic>, the same sample numbers refer to the same individuals, e.g. <italic>tongue1</italic> and <italic>feces1</italic> come from the same person number 1. A correspondence table linking old and new names is provided in <xref ref-type="supplementary-material" rid="pcbi.1005362.s003">S1 Table</xref>.</p>
</sec>
<sec id="sec007">
<title>Antibiotic treatment dataset</title>
<p>Dethlefsen <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005362.ref030">30</xref>] studied the effect of the antibiotic Ciprofloxacin on gut microbiomes of three healthy human individuals using HTSeq data (bacterial 16S rRNA gene fragment amplicons) before (8 measurements), during (4 measurements), and after treatment (6 measurements). The corresponding 18 OTU tables were retrieved from the supplementary material of [<xref ref-type="bibr" rid="pcbi.1005362.ref030">30</xref>].</p>
</sec>
</sec>
<sec id="sec008">
<title>Computation of normalized RADs (NRADs)</title>
<p>For each dataset we followed the flowchart in <xref ref-type="fig" rid="pcbi.1005362.g003">Fig 3</xref>.</p>
<fig id="pcbi.1005362.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005362.g003</object-id>
<label>Fig 3</label>
<caption>
<title>General process employed in this work.</title>
<p>Flowchart of procedure from original species/abundances or sequence/reads data (top box) to original RADs, then to NRADs, and analyses based on NRADs.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005362.g003" xlink:type="simple"/>
</fig>
<sec id="sec009">
<title>Compilation of abundance vectors</title>
<p>For each of the samples we had a two-column table of sequences and the corresponding numbers of sequence reads (here proxies for abundances), as obtained from the HTSeq experiment, or, equivalently, an OTU table with OTU names or numbers and the corresponding abundances in the sample. All data had been pre-processed and controlled for quality as described in [<xref ref-type="bibr" rid="pcbi.1005362.ref033">33</xref>], [<xref ref-type="bibr" rid="pcbi.1005362.ref030">30</xref>], [<xref ref-type="bibr" rid="pcbi.1005362.ref031">31</xref>], and [<xref ref-type="bibr" rid="pcbi.1005362.ref032">32</xref>], respectively.</p>
<p>The species columns were discarded, so that only a list or vectors of abundances remained for each sample. Abundances of each vector were sorted in descending order, bringing the highest abundance to the first element of the vector (= rank 1), the second highest to rank 2, etc. The resulting abundance vectors, one for each sample, were then normalized in the next step.</p>
</sec>
<sec id="sec010">
<title>MaxRank normalization</title>
<p>MaxRank normalization is the key step to make abundance structures of generalized communities comparable, thus enabling all succeeding analyses. MaxRank normalization maps all rank abundance vectors to the same rank range from 1 to a common maximum rank <italic>R</italic>. The normalization procedure is explained in the following.</p>
<p>First we chose the maximum rank or “MaxRank” <italic>R</italic> (symbol <italic>R</italic> is used for the MaxRank throughout this work). The minimum <italic>R</italic> is 2 because <italic>R</italic> = 1 would eliminate all abundance structure. The maximum <italic>R</italic> is the minimum dimension of rank abundance vectors included in the analysis. For instance for the GlobalPatterns dataset, we had rank abundance vectors with dimensions from 2067 to 7679, and the maximum possible <italic>R</italic> for the whole set is therefore 2067. A value of <italic>R</italic> larger than this maximum would mean that we had to invent new ranks that have not been observed for at least one sample. In practice, this maximum <italic>R</italic> is often a good choice since it retains the abundance structure of all included communities in the greatest possible detail. We have therefore chosen in all analyses the maximum possible <italic>R</italic>.</p>
<p>Once the maximum rank had been fixed to a common <italic>R</italic> for all samples, we applied the MaxRank normalization separately to each sample. To this end we first generated for each sample <italic>s</italic> a pool of <inline-formula id="pcbi.1005362.e002"><alternatives><graphic id="pcbi.1005362.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>R</mml:mi> <mml:mi>s</mml:mi></mml:msub></mml:msubsup> <mml:msub><mml:mi>A</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> individuals, with <italic>R</italic><sub><italic>s</italic></sub> the original maximum rank (i.e. the richness) of sample <italic>s</italic>, and <italic>A</italic><sub><italic>sr</italic></sub> the abundance of rank <italic>r</italic> in that sample. From this pool we drew individuals at random with uniform probability and without replacement as long as the number of sampled ranks did not exceed <italic>R</italic>. In this way we generated a new, reduced abundance vector of <italic>R</italic> ranks, with a reduced number <inline-formula id="pcbi.1005362.e003"><alternatives><graphic id="pcbi.1005362.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>s</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> of individuals. Division of these reduced abundances by <inline-formula id="pcbi.1005362.e004"><alternatives><graphic id="pcbi.1005362.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>s</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> transforms the reduced abundance vector to a probability distribution (or relative abundances) for the <italic>R</italic> ranks with rank probabilities summing up to 1. We use therefore the terms <italic>probability</italic> and <italic>abundance</italic> in the remainder of the article as synonyms.</p>
<p>If <italic>R</italic> = <italic>R</italic><sub><italic>s</italic></sub>, the procedure above reproduces exactly the original RAD. If <italic>R</italic> &lt; <italic>R</italic><sub><italic>s</italic></sub>, the random drawing of individuals from the pool in general introduces a sampling error in the abundances. To control this error, we repeated the procedure several times (typically 10–100 times) and averaged over all sampled abundance distributions. This average abundance distribution was returned as the final “normalized RAD” (NRAD) for each sample, together with 90% confidence intervals for the mean abundance at each rank, estimated as the interval between the 5% and 95% percentile of the bootstrapped averages at the respective rank.</p>
<p>For the NRAD of sample <italic>i</italic> we use as notation in the following a vector <bold>a</bold><sub><italic>i</italic></sub> of <italic>R</italic> abundances <italic>a</italic><sub><italic>ir</italic></sub>:
<disp-formula id="pcbi.1005362.e005"><alternatives><graphic id="pcbi.1005362.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mrow><mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>R</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
with elements <italic>a</italic><sub><italic>ir</italic></sub> ∈ ]0, 1] (ranks <italic>r</italic> = 1, 2, …, <italic>R</italic>) that are sorted (<italic>a</italic><sub><italic>ik</italic></sub> ≥ <italic>a</italic><sub><italic>i</italic>ℓ</sub> for ranks <italic>k</italic> &lt; ℓ), and normalized (<inline-formula id="pcbi.1005362.e006"><alternatives><graphic id="pcbi.1005362.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>r</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>).</p>
</sec>
<sec id="sec011">
<title>Software implementation of MaxRank normalization</title>
<p>We have implemented the methods used in this work in free open source software packages <italic>RADanalysis</italic> and <italic>RankAbundanceDistributions</italic> available in R (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/RADanalysis/" xlink:type="simple">https://cran.r-project.org/web/packages/RADanalysis/</ext-link>) and Julia (<ext-link ext-link-type="uri" xlink:href="https://github.com/DanielHoffmann32/RankAbundanceDistributions.jl" xlink:type="simple">https://github.com/DanielHoffmann32/RankAbundanceDistributions.jl</ext-link>).</p>
</sec>
</sec>
<sec id="sec012">
<title>Analyses of NRADs</title>
<p>The last box of the flowchart <xref ref-type="fig" rid="pcbi.1005362.g003">Fig 3</xref> indicates that sets of RADs normalized to a common <italic>R</italic> can be analyzed in numerous ways. In this article we used methods from three branches of data analysis: ordination, clustering, and classification. Since many ordination and clustering methods require a <italic>distance</italic> between the studied objects, we first describe how we computed distances between pairs of NRADs, and then the actual analysis methods.</p>
<sec id="sec013">
<title>Distances between NRADs</title>
<p>In this work, if not mentioned explicitly otherwise, a distance <italic>d</italic><sub><italic>R</italic></sub> between a pair of NRADs <bold>a</bold><sub><italic>i</italic></sub>,<bold>a</bold><sub><italic>j</italic></sub> is the Manhattan distance:
<disp-formula id="pcbi.1005362.e007"><alternatives><graphic id="pcbi.1005362.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mi>R</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>R</mml:mi></mml:munderover> <mml:mrow><mml:mo>|</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>r</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>r</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula></p>
<p>The reason for using the Manhattan distance was that it accounts for NRAD-NRAD differences in a balanced way: NRADs typically show the largest differences in the first few ranks (in the “heads” of the NRADs, <xref ref-type="fig" rid="pcbi.1005362.g001">Fig 1</xref>), while the differences are typically small in the “tails” of the NRADs, which comprise many more ranks than the heads. The Manhattan distance gives the few large differences in the small heads and the many small differences in the large tails approximately the same weights.</p>
<p>All pairwise distances <italic>d</italic><sub><italic>R</italic></sub>(<bold>a</bold><sub><italic>i</italic></sub>, <bold>a</bold><sub><italic>j</italic></sub>) between NRADs in a dataset were collected in a distance matrix for that dataset. The distance matrix was then used for distance based ordination and clustering.</p>
<p>We tested the practical suitability of the Kolmogorov-Smirnov statistic <italic>D</italic> as a distance measure using the function <italic>ks.test</italic> of R-package stats [<xref ref-type="bibr" rid="pcbi.1005362.ref035">35</xref>], version 3.2.2.</p>
</sec>
<sec id="sec014">
<title>Ordination</title>
<p>We used classical multi-dimensional scaling (cMDS) [<xref ref-type="bibr" rid="pcbi.1005362.ref036">36</xref>] as an ordination method to arrange NRADs (<xref ref-type="disp-formula" rid="pcbi.1005362.e005">Eq 1</xref>) of each dataset in an expressive and visually accessible way, usually in two dimensions called <italic>first coordinate</italic> and <italic>second coordinate</italic>. For a cMDS analysis, the distance matrix of the dataset to be analyzed was submitted to the <italic>cmdscale</italic> function of the R-package stats [<xref ref-type="bibr" rid="pcbi.1005362.ref035">35</xref>], version 3.2.2, or the <italic>classical_MDS</italic> function of Julia package MultivariateStats, release 0.1.0 (<ext-link ext-link-type="uri" xlink:href="https://github.com/JuliaStats/MultivariateStats.jl" xlink:type="simple">https://github.com/JuliaStats/MultivariateStats.jl</ext-link>).</p>
</sec>
<sec id="sec015">
<title>Clustering</title>
<p>NRADs of the B cell and GlobalPattern data were clustered hierarchically by applying function <italic>hclust</italic> of R-package stats, version 3.2.2, to the NRAD distance matrix using the complete linkage cluster criterion.</p>
</sec>
<sec id="sec016">
<title>NRAD averaging</title>
<p>Groups of NRADs, for instance the three groups of NRADs of gut microbiomes of individuals (a) before, (b) during, or (c) after treatment with Ciprofloxacin [<xref ref-type="bibr" rid="pcbi.1005362.ref030">30</xref>], or NRADs of gut microbiomes of individuals in certain age intervals [<xref ref-type="bibr" rid="pcbi.1005362.ref031">31</xref>] were summarized by computing an average NRAD <inline-formula id="pcbi.1005362.e008"><alternatives><graphic id="pcbi.1005362.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">a</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> for each group <italic>g</italic> with members <italic>i</italic> = 1, 2, …, <italic>n</italic>. Note that averages of NRADs are NRADs themselves with the same MaxRank <italic>R</italic> and total abundance of 1. The 90% confidence interval for the mean NRAD of each group <italic>g</italic> was estimated for each rank, estimated as the interval between the 5% and 95% percentile of the bootstrapped averages at the respective rank.</p>
</sec>
<sec id="sec017">
<title>Classification</title>
<p>For the classification of gut microbiomes according to country of origin we trained random forests [<xref ref-type="bibr" rid="pcbi.1005362.ref037">37</xref>] models with R-package randomForest, version 4.6-12 [<xref ref-type="bibr" rid="pcbi.1005362.ref038">38</xref>] with NRADs as predictors and country (MV vs. US) as class labels. The importance of each rank for the classification was estimated by computing the effect on the classification performance of randomly permuting class labels for each rank. Models were tested by threefold cross-validation, i.e. threefold training of a model on a randomly selected 2/3 of the data, followed by predicting the labels of the left-out 1/3, and comparison of predictions with ground truth from [<xref ref-type="bibr" rid="pcbi.1005362.ref031">31</xref>]. Prediction performance was quantified by the accuracy <italic>ACC</italic> and the <italic>κ</italic> statistic [<xref ref-type="bibr" rid="pcbi.1005362.ref039">39</xref>]:
<disp-formula id="pcbi.1005362.e009"><alternatives><graphic id="pcbi.1005362.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mrow><mml:mi>A</mml:mi> <mml:mi>C</mml:mi> <mml:mi>C</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>o</mml:mi> <mml:mi>r</mml:mi> <mml:mi>r</mml:mi> <mml:mi>e</mml:mi> <mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mi>N</mml:mi></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula> <disp-formula id="pcbi.1005362.e010"><alternatives><graphic id="pcbi.1005362.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mrow><mml:mi>κ</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>A</mml:mi> <mml:mi>C</mml:mi> <mml:mi>C</mml:mi> <mml:mo>-</mml:mo> <mml:mi>A</mml:mi> <mml:mi>C</mml:mi> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>x</mml:mi> <mml:mi>p</mml:mi> <mml:mi>e</mml:mi> <mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>A</mml:mi> <mml:mi>C</mml:mi> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>x</mml:mi> <mml:mi>p</mml:mi> <mml:mi>e</mml:mi> <mml:mi>c</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
with <italic>N</italic> predictions of which <italic>n</italic><sub><italic>correct</italic></sub> were correct, and <italic>ACC</italic><sub><italic>expect</italic></sub> the accuracy expected by randomly guessing from the given true distribution of labels with guessing probabilities as obtained from the model. For example, for <italic>N</italic> instances labeled by country <italic>X</italic> or <italic>Y</italic> we predict with the model <italic>n</italic><sub><italic>pred</italic>,<italic>X</italic></sub> and <italic>n</italic><sub><italic>pred</italic>,<italic>Y</italic></sub>, while the true numbers are <italic>n</italic><sub><italic>true</italic>,<italic>X</italic></sub>, <italic>n</italic><sub><italic>true</italic>,<italic>Y</italic></sub>, and we have then <italic>ACC</italic><sub><italic>expect</italic></sub> = (<italic>n</italic><sub><italic>pred</italic>,<italic>X</italic></sub>/<italic>N</italic>) ⋅ (<italic>n</italic><sub><italic>true</italic>,<italic>X</italic></sub>/<italic>N</italic>) + (<italic>n</italic><sub><italic>pred</italic>,<italic>Y</italic></sub>/<italic>N</italic>) ⋅ (<italic>n</italic><sub><italic>true</italic>,<italic>Y</italic></sub>/<italic>N</italic>). We report <italic>κ</italic> because <italic>ACC</italic> can be biased if the different labels are not represented by approximately equal numbers of instances. A simplified interpretation of <italic>κ</italic> is the fraction of prediction accuracy that is not explained by guessing. A perfect model has <italic>κ</italic> = 1, a randomly guessing model <italic>κ</italic> = 0.</p>
</sec>
<sec id="sec018">
<title>Model fitting</title>
<p>For the B cell data, geometric distributions were fitted to <italic>V</italic><sub><italic>H</italic></sub> gene sequence counts with a maximum likelihood method in Julia v0.4 package <italic>Distributions</italic> (<ext-link ext-link-type="uri" xlink:href="https://github.com/JuliaStats/Distributions.jl" xlink:type="simple">https://github.com/JuliaStats/Distributions.jl</ext-link>) and tested for consistency by a one-sample Kolmogorov-Smirnov test in Julia v0.4 package <italic>HypothesisTests</italic> (<ext-link ext-link-type="uri" xlink:href="https://github.com/JuliaStats/HypothesisTests.jl" xlink:type="simple">https://github.com/JuliaStats/HypothesisTests.jl</ext-link>).</p>
<p>For the model of gut microbiome entropy as function of age, we computed Shannon entropies <italic>H</italic><sub><italic>R</italic></sub> from NRADs with function <italic>entropy</italic> from Julia v0.4 package <italic>StatsBase</italic> (<ext-link ext-link-type="uri" xlink:href="https://github.com/JuliaStats/StatsBase.jl" xlink:type="simple">https://github.com/JuliaStats/StatsBase.jl</ext-link>). Age was provided by the dataset given by [<xref ref-type="bibr" rid="pcbi.1005362.ref031">31</xref>].</p>
<p>The model was fitted to the set of (entropy, age) pairs by least-squares minimization with the Levenberg-Marquardt algorithm [<xref ref-type="bibr" rid="pcbi.1005362.ref040">40</xref>], as implemented in Julia v0.4 package <italic>LsqFit</italic> (<ext-link ext-link-type="uri" xlink:href="https://github.com/JuliaOpt/LsqFit.jl" xlink:type="simple">https://github.com/JuliaOpt/LsqFit.jl</ext-link>). Starting conditions for the fit were the same for the MV and US set, namely <inline-formula id="pcbi.1005362.e011"><alternatives><graphic id="pcbi.1005362.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>R</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>3</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <italic>λ</italic><sub><italic>R</italic></sub> = 0.19, <inline-formula id="pcbi.1005362.e012"><alternatives><graphic id="pcbi.1005362.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>R</mml:mi></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>6</mml:mn> <mml:mo>.</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, obtained from a rough data-based estimate. Confidence intervals were estimated from the Jacobians at the optimally fitted parameters, as implemented in <italic>LsqFit</italic> function <italic>estimate_errors</italic>.</p>
</sec>
<sec id="sec019">
<title>Comparison to standard distributions</title>
<p>Five standard distributions commonly used to model RADs were fitted to the RADs of the GlobalPattern set as described in [<xref ref-type="bibr" rid="pcbi.1005362.ref041">41</xref>] and implemented in the <italic>radfit</italic> function of R-package vegan, version 2.2-1 [<xref ref-type="bibr" rid="pcbi.1005362.ref042">42</xref>]: broken stick (null model, no free parameter), preemption (geometric series), log-normal, Zipf, and Mandelbrot. Fits to the Mandelbrot distribution did not converge, so that only the other four distributions are shown.</p>
</sec>
</sec>
</sec>
<sec id="sec020" sec-type="results">
<title>Results</title>
<sec id="sec021">
<title>B cell dataset: Abundance structures of biologically distinct generalized communities</title>
<p>With their highly diverse repertoire of antigen-binding receptors, human memory B cells are an example of what we have earlier termed <italic>generalized community</italic>. This diversity is achieved by a process that is only partly understood and currently subject of intense research [<xref ref-type="bibr" rid="pcbi.1005362.ref043">43</xref>, <xref ref-type="bibr" rid="pcbi.1005362.ref044">44</xref>]: it starts with the genetic recombination of triplets of specific <italic>V</italic><sub><italic>H</italic></sub>, <italic>D</italic><sub><italic>H</italic></sub>, and <italic>J</italic><sub><italic>H</italic></sub> gene segments from genetic pools of these segments, followed by various mutation and selection steps, and eventually leads to distinct classes and sub-classes of memory B cells.</p>
<p>We assume as a working hypothesis that all memory B cells underwent the same diversity generating process. If this is true, we should see a very similar <italic>V</italic><sub><italic>H</italic></sub> gene rearrangement pattern (<xref ref-type="fig" rid="pcbi.1005362.g002">Fig 2</xref>) in all sub-classes of memory B cells, leading to the same normalized RADs (NRADs) of memory B cells in all sub-classes. To test this hypothesis, we used HTSeq data of the immunoglobulin heavy-chain variable (IGHV) regions of four large memory B cell sub-classes, <italic>IgG</italic><sup>+</sup>, <italic>IgG</italic><sup>+</sup><italic>CD</italic>27<sup>+</sup>, <inline-formula id="pcbi.1005362.e013"><alternatives><graphic id="pcbi.1005362.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:mi>I</mml:mi> <mml:mi>g</mml:mi> <mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow> <mml:mo>+</mml:mo></mml:msubsup> <mml:mi>C</mml:mi> <mml:mi>D</mml:mi> <mml:msup><mml:mn>27</mml:mn> <mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <italic>IgM</italic><sup>+</sup><italic>IgD</italic><sup>+</sup><italic>CD</italic>27<sup>+</sup>, from two donors. The IGHV regions derive from the genomic pool of 38–46 <italic>V</italic><sub><italic>H</italic></sub> segments (<xref ref-type="fig" rid="pcbi.1005362.g002">Fig 2A</xref>) and have been modified by mutation and selection steps. If we interpret the original set of <italic>V</italic><sub><italic>H</italic></sub> segments as the “species” to be ranked according to their abundances, we should under our working hypothesis see the same NRADs in all memory B cell sub-classes. To exclude distortions of abundances due to primer bias, we collapsed abundances of <italic>V</italic><sub><italic>H</italic></sub> segments from the measured read numbers to the numbers of distinct <italic>V</italic><sub><italic>H</italic></sub> sequence variants. Thus, in this case an abundance is the number of distinct sequences that originate from the same <italic>V</italic><sub><italic>H</italic></sub> segment, and that have been diversified by somatic mutations and clonal expansions. <xref ref-type="fig" rid="pcbi.1005362.g004">Fig 4</xref> summarizes the results.</p>
<fig id="pcbi.1005362.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005362.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Rank abundance distributions of memory B cell receptors.</title>
<p>Four different B cell receptor sub-classes from donors 1 (replicate samples A, B) and 2 (replicates C, D) are compared. Top left panel: Log-log plot of RADs prior to normalization. Top right: Log-log plot of corresponding NRADs. Legend for RADs and NRADs is given in bottom right panel. Bottom left: Hierarchical clustering tree based on all pairwise distances between the 16 NRADs.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005362.g004" xlink:type="simple"/>
</fig>
<p>The non-normalized RADs (top left of <xref ref-type="fig" rid="pcbi.1005362.g004">Fig 4</xref>) have similar, boomerang-like shapes, although direct comparisons is difficult since differences in abundance span more than one order of magnitude, and maximum ranks differ between 35 and 40. For direct comparison we therefore normalized the RADs to a MaxRank <italic>R</italic> = 35 (top right of <xref ref-type="fig" rid="pcbi.1005362.g004">Fig 4</xref>). The resulting NRADs have overall very similar shapes, lending support to our working hypothesis of a common generation and selection process. However, there are notable features that differentiate between groups of NRADs. For instance at rank 1 the most diverse IGHV regions in IgM receptors of donor 1 (green curves in <xref ref-type="fig" rid="pcbi.1005362.g004">Fig 4</xref>) are more abundant than all other rank 1 abundances. Conversely, for donor 2 the most diverse IGHV regions in IgM (blue curves) are the least abundant of all rank 1 abundances. Towards higher ranks, IgM abundances of both donors (blue and green) are more similar to each other. IgG receptors (red and orange) have more similar abundance structures throughout all ranks, and have stronger right tails than IgM receptors, indicating a more even <italic>V</italic><sub><italic>H</italic></sub> segment diversity in IgG than IgM receptors.</p>
<p>The differences between the NRAD curves are subtle, but they emerge clearly when we quantitatively analyze NRAD distances (<xref ref-type="disp-formula" rid="pcbi.1005362.e007">Eq 2</xref>). In the hierarchical clustering tree of the distances (<xref ref-type="fig" rid="pcbi.1005362.g004">Fig 4</xref>) we see three main clusters of NRADs, a big cluster of <italic>IgG</italic><sup>+</sup> and <italic>IgG</italic><sup>+</sup><italic>CD</italic>27<sup>+</sup> NRADs on the right of the tree in red and orange, and two clusters of IgM related NRADs. These three clusters appear robustly, no matter whether the average linkage or the complete linkage criterion is used for clustering.</p>
<p>As expected for replicates, (A, B) and (C, D) of the same sub-class coming from the same donor yield NRADs that are most similar and thus fall into the same lowest-level clusters. Beyond this, memory B cell sub-classes have remarkably different cluster structures. The big <italic>IgG</italic><sup>+</sup>/<italic>IgG</italic><sup>+</sup><italic>CD</italic>27<sup>+</sup> cluster (red and orange) of eight NRADs has a substructure of an <italic>IgG</italic><sup>+</sup> cluster and a separate <italic>IgG</italic><sup>+</sup><italic>CD</italic>27<sup>+</sup> cluster, i.e. here the memory B cell sub-class has a stronger impact on the NRAD than inter-donor differences. This is different for the <inline-formula id="pcbi.1005362.e014"><alternatives><graphic id="pcbi.1005362.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:mi>I</mml:mi> <mml:mi>g</mml:mi> <mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow> <mml:mo>+</mml:mo></mml:msubsup> <mml:mi>C</mml:mi> <mml:mi>D</mml:mi> <mml:msup><mml:mn>27</mml:mn> <mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and <italic>IgM</italic><sup>+</sup><italic>IgD</italic><sup>+</sup><italic>CD</italic>27<sup>+</sup> clusters. There, each of the two donors forms a cluster of its own that combines both <inline-formula id="pcbi.1005362.e015"><alternatives><graphic id="pcbi.1005362.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:mi>I</mml:mi> <mml:mi>g</mml:mi> <mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow> <mml:mo>+</mml:mo></mml:msubsup> <mml:mi>C</mml:mi> <mml:mi>D</mml:mi> <mml:msup><mml:mn>27</mml:mn> <mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and <italic>IgM</italic><sup>+</sup><italic>IgD</italic><sup>+</sup><italic>CD</italic>27<sup>+</sup> NRADs, i.e. in these two IgM sub-classes, inter-personal differences in <italic>V</italic><sub><italic>H</italic></sub> diversity patterns are stronger than differences between sub-classes.</p>
<p>Our working hypothesis was that we have basically a single, diversity generating process for all memory B cell sub-classes, leading to the same NRADs for <italic>V</italic><sub><italic>H</italic></sub> gene rearrangement pattern in all sub-classes. Overall, our results are consistent with this big picture since all NRADs are variants of the same boomerang shaped template. However, the quantitative analysis of NRAD distances picked up differences that require refinements of this model. This is not surprising since some of the steps that potentially affect <italic>V</italic><sub><italic>H</italic></sub> rearrangement diversity, for instance class switching, cannot apply equally to all memory B cell sub-classes. What is surprising are the specific differences in <italic>V</italic><sub><italic>H</italic></sub> rearrangement diversity between IgM and IgG sub-classes, e.g. the structure of the IgG cluster discussed above suggests that there could be significantly different selection pressures towards the final memory B cells in the two sub-classes <italic>IgG</italic><sup>+</sup> (i.e. <italic>IgG</italic><sup>+</sup><italic>CD</italic>27<sup>−</sup>) and <italic>IgG</italic><sup>+</sup><italic>CD</italic>27<sup>+</sup>.</p>
<p>Recently, we have used the same HTSeq data for a detailed sequence-based analysis of the clonal composition and genealogy of memory B cells [<xref ref-type="bibr" rid="pcbi.1005362.ref033">33</xref>]. Although our current NRAD-based analysis disregards much of the information used in [<xref ref-type="bibr" rid="pcbi.1005362.ref033">33</xref>], results are consistent: First, the <italic>V</italic><sub><italic>H</italic></sub> gene rearrangement composition is mostly very similar across the studied sub-classes of memory B cells, in agreement with a shared generation process [<xref ref-type="bibr" rid="pcbi.1005362.ref045">45</xref>]. Second, <italic>IgM</italic><sup>+</sup><italic>IgD</italic><sup>+</sup><italic>CD</italic>27<sup>+</sup> and <inline-formula id="pcbi.1005362.e016"><alternatives><graphic id="pcbi.1005362.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:mi>I</mml:mi> <mml:mi>g</mml:mi> <mml:msubsup><mml:mi>M</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>n</mml:mi> <mml:mi>l</mml:mi> <mml:mi>y</mml:mi></mml:mrow> <mml:mo>+</mml:mo></mml:msubsup> <mml:mi>C</mml:mi> <mml:mi>D</mml:mi> <mml:msup><mml:mn>27</mml:mn> <mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> show almost the same <italic>V</italic><sub><italic>H</italic></sub> gene rearrangement diversity, likely due to their clonal relatedness as described in [<xref ref-type="bibr" rid="pcbi.1005362.ref033">33</xref>]. Third, there are significant and consistent differences between <italic>IgG</italic><sup>+</sup><italic>CD</italic>27<sup>+</sup> and <italic>IgG</italic><sup>+</sup><italic>CD</italic>27<sup>−</sup> with respect to mutation load in both donors, also in agreement with [<xref ref-type="bibr" rid="pcbi.1005362.ref046">46</xref>] or [<xref ref-type="bibr" rid="pcbi.1005362.ref047">47</xref>].</p>
<p>To conclude this section, we return to the conspicuous boomerang shape that is the template common to all B cell receptor RADs and NRADs (<xref ref-type="fig" rid="pcbi.1005362.g004">Fig 4</xref>). When testing for similarity to standard model distributions in ecology, we found that the broken stick distribution [<xref ref-type="bibr" rid="pcbi.1005362.ref013">13</xref>] is a good description for the NRADs of sub-class <italic>IgG</italic><sup>+</sup><italic>CD</italic>27<sup>+</sup> (<xref ref-type="fig" rid="pcbi.1005362.g005">Fig 5</xref>). If included in the hierarchical clustering, the broken stick NRAD appears among the branches of the <italic>IgG</italic><sup>+</sup><italic>CD</italic>27<sup>+</sup> sub-tree (inset of <xref ref-type="fig" rid="pcbi.1005362.g005">Fig 5</xref>). However, even for the other sub-classes, we cannot reject the broken stick distribution (p-values from Kolmogorov-Smirnov tests between 1.0 and 0.87 with a median of 0.99), though they deviate more than <italic>IgG</italic><sup>+</sup><italic>CD</italic>27<sup>+</sup>. Note that the normalized broken stick distribution in <xref ref-type="fig" rid="pcbi.1005362.g005">Fig 5</xref> has no free parameters and therefore has not been fitted.</p>
<fig id="pcbi.1005362.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005362.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Broken stick distribution (solid line) and NRADs of <italic>IgG</italic><sup>+</sup><italic>CD</italic>27<sup>+</sup> fractions (points).</title>
<p>Inset: section of hierarchical clustering dendrogram where broken stick distribution appears. This plot adopts the usual presentation of the broken stick distribution in the literature with linear horizontal axis and logarithmic vertical axis. Therefore the boomerang shapes of the log-log <xref ref-type="fig" rid="pcbi.1005362.g004">Fig 4</xref> appear horizontally stretched.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005362.g005" xlink:type="simple"/>
</fig>
<p>Several mechanisms in community ecology and elsewhere lead to broken stick RADs [<xref ref-type="bibr" rid="pcbi.1005362.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005362.ref048">48</xref>–<xref ref-type="bibr" rid="pcbi.1005362.ref050">50</xref>]. A simple explanation for the observed RADs of <italic>V</italic><sub><italic>H</italic></sub> segment usage could be the following. Assume a fixed number <inline-formula id="pcbi.1005362.e017"><alternatives><graphic id="pcbi.1005362.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>H</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> of <italic>V</italic><sub><italic>H</italic></sub> segments in the genome, and a fixed total number <italic>N</italic><sub><italic>t</italic></sub> of all BCR sequence variants (i.e. summed over all <italic>V</italic><sub><italic>H</italic></sub> segments). The biological purpose of fixing <italic>N</italic><sub><italic>t</italic></sub> could be to provide a sufficient number of BCR variants to cover the typical antigen diversity. These two assumptions fix the average number <inline-formula id="pcbi.1005362.e018"><alternatives><graphic id="pcbi.1005362.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>H</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> of sequence variants per <italic>V</italic><sub><italic>H</italic></sub> segment. If this is all we know, the Maximum Entropy principle states that the geometric distribution is the most parsimonious explanation fulfilling these requirements [<xref ref-type="bibr" rid="pcbi.1005362.ref051">51</xref>]. The geometric distribution is the discrete equivalent of the continuous exponential distribution, which generates the broken stick RAD [<xref ref-type="bibr" rid="pcbi.1005362.ref048">48</xref>]. Thus, our argument posits a random process that produces numbers of sequence variants per <italic>V</italic><sub><italic>H</italic></sub> segment with a geometric distribution. In fact, sequence counts of most RADs are compatible with geometric distributions according to Kolmogorov-Smirnov tests at significance level 0.05 (exception: sample D of <italic>IgM</italic><sup>+</sup><italic>IgD</italic><sup>+</sup><italic>CD</italic>27<sup>+</sup> with <italic>p</italic> = 0.04). Given that there is good agreement between the RADs of the BCR sub-classes (<xref ref-type="fig" rid="pcbi.1005362.g004">Fig 4</xref>), and also good agreement in the usage of individual <italic>V</italic><sub><italic>H</italic></sub> segments between human donors [<xref ref-type="bibr" rid="pcbi.1005362.ref033">33</xref>], our argument suggests the following two testable hypotheses. First, the random mechanism leading to the broken stick RAD could be encoded in the human genome and conserved among individuals with intact immune systems. Second, since our argument is generic, we should see the broken stick RAD also in other species with similar BCR rearrangement mechanisms.</p>
</sec>
<sec id="sec022">
<title>Antibiotic treatment dataset: Abundance structure reacts to perturbations</title>
<p>Dethlefsen <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005362.ref030">30</xref>] reported the effects of a short course of Ciprofloxacin (Cp) treatment on the gut microbiomes of three healthy human individuals. When comparing gut microbiomes prior to treatment and during treatment, they found markedly perturbed taxonomic composition, richness, diversity, and evenness. These perturbations varied between individuals. After treatment, the community compositions recovered within four weeks to states close to pre-treatment, though with some species lost. We tested whether the dynamics of perturbation and recovery is reflected by changes of NRADs.</p>
<p>The NRADs fall into two clusters, one well-defined “off-Cp” cluster of NRADs before and after treatment (blue and green in <xref ref-type="fig" rid="pcbi.1005362.g006">Fig 6</xref>), and one wider “on-Cp” cluster during treatment (red in <xref ref-type="fig" rid="pcbi.1005362.g006">Fig 6</xref>). All on-CP NRADs have heavier heads and less weight in the tails, consistent with the decreased gut microbiome diversity under treatment discovered by [<xref ref-type="bibr" rid="pcbi.1005362.ref030">30</xref>]. After normalization, we could compute distances between all pairs of NRADs and apply multidimensional scaling (MDS) to the distance matrix. The MDS plot <xref ref-type="fig" rid="pcbi.1005362.g006">Fig 6B</xref> captures the abundance dynamics from the well-defined off-Cp cluster on the right to the wider on-Cp cluster on the left and back again to the off-Cp cluster on the right. We usually find in MDS analyses a strong correlation of the first coordinate with Shannon entropy. Hence, the dynamics in the MDS plot <xref ref-type="fig" rid="pcbi.1005362.g006">Fig 6B</xref> from right (pre-Cp) to left (Cp) to right (post-Cp) corresponds to a succession of high-low-high entropy. This can also be seen directly from the NRADs: the off-Cp NRADs have a relatively heavy tail and weak head, i.e. a more even distribution with higher entropy, corresponding to a more diverse gut microbiome. Conversely, the on-Cp NRADs have a more heavy head and weaker tail, i.e. a less even distribution with lower entropy, corresponding to a less diverse gut microbiome, partly decimated by the effect of the antibiotic.</p>
<fig id="pcbi.1005362.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005362.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Abundance dynamics of gut microbiomes of three individuals under treatment with antibiotic Ciprofloxacin (Cp).</title>
<p>(A) NRADs before (green), during (red), and after (blue) treatment. Bold lines are mean NRADs, shaded regions are 90% confidence intervals of the means. (B) MDS of NRADs with one point per NRAD using the same color code as in panel A. For each of the three individuals, arrows connect points corresponding to the last measurement before treatment, measurements during treatment, and the first measurement after treatment. The two coordinates of the MDS plot explain 89% of the NRAD distances.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005362.g006" xlink:type="simple"/>
</fig>
<p>Dethlefsen <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005362.ref030">30</xref>] remarked that after treatment several taxa failed to recover, while the participants in the study had normal intestinal function, and they argued that the eliminated taxa after treatment may have been replaced by other taxa with similar functions. The fact that pre- and post-Cp NRAD ensembles have the same shapes and form a single compact off-Cp cluster (<xref ref-type="fig" rid="pcbi.1005362.g006">Fig 6</xref>) supports this assessment.</p>
<p>It is instructive to compare our analysis based on the abundance structure with an OTU composition analysis as in Fig 6 of Ref [<xref ref-type="bibr" rid="pcbi.1005362.ref030">30</xref>]. The OTU based PCA in Ref [<xref ref-type="bibr" rid="pcbi.1005362.ref030">30</xref>] has a cluster structure that is influenced by both the individual microbiome donor and by the treatment state. The conflation of both influences makes the result of the PCA richer but also more difficult to interpret: If we consider individual microbiome compositions, all three individuals have different microbiome dynamics under treatment. Conversely, the NRAD based analysis is blind to individual differences in microbiome composition. This blindness to composition means on the other hand to focus on the abundance structure, which makes the result in our <xref ref-type="fig" rid="pcbi.1005362.g006">Fig 6</xref> more easy to interpret: In terms of the abundance structure, all three individuals behave in the same way, clearly showing a generic effect of the antibiotic treatment.</p>
</sec>
<sec id="sec023">
<title>Gut microbiomes dataset: NRADs enable quantitative models</title>
<p>Yatsunenko <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005362.ref031">31</xref>] found in 528 gut microbiomes from Malawi, United States and Venezuela, that (1) species richness of gut microbiomes increased with age from birth to about the third year, and then was much less variable, and (2) taxonomic composition of adult gut microbiomes from the Unites States differed strongly from those of Malawi and Venezuela, while the latter two showed less pronounced differences. In our analysis we do neither use richness (we normalize to a common richness), nor taxonomic labels, but we use solely the abundance vectors (<xref ref-type="disp-formula" rid="pcbi.1005362.e005">Eq 1</xref>) as quantitative descriptors of NRAD shapes. Nevertheless, we will in the following show results consistent with key results from [<xref ref-type="bibr" rid="pcbi.1005362.ref031">31</xref>] with NRADs. Additionally, we will present a novel NRAD-based quantitative model for the development of gut microbiome entropy as function of age.</p>
<p>Prior to normalization, the richness of the samples covered three orders of magnitude, from 4105 to 296214 different ranks. All 528 RADs were normalized to the same MaxRank of <italic>R</italic> = 4105 to make RAD shapes and quantities computed thereof comparable.</p>
<sec id="sec024">
<title>NRADs differentiate between ages and countries</title>
<p>First we applied MDS to the distance matrix of all 528 NRADs to see whether NRADs of different countries (especially between US = United States and MV = Malawi/Venezuela) and ages can be distinguished (<xref ref-type="fig" rid="pcbi.1005362.g007">Fig 7A</xref>). We found a banana shaped distribution in the MDS plot, arranged along the first coordinate that explains two thirds of the spread between NRADs (the banana shape also appears with nonmetric MDS [<xref ref-type="bibr" rid="pcbi.1005362.ref052">52</xref>]). The banana reaches from babies and small children on the left to adults on the right. Thus we have a clear age related trend of NRADs. It is remarkable that while the points for the smallest children have the largest scatter, the averages between MV and US are the same within the margin of error. Above the youngest age group, NRADs split up into two branches, one for MV and one for US. For adults the means of the MDS clusters of MV and US have small errors and are clearly separated. Differences between the older age groups within the same country are small. The described patterns in the MDS plot is consistent with the taxonomy based results in [<xref ref-type="bibr" rid="pcbi.1005362.ref031">31</xref>].</p>
<fig id="pcbi.1005362.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005362.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Country of origin and age as determinants of gut microbiomes NRADs.</title>
<p>(A) MDS-ordination of NRADs of those 489 gut microbiomes from Malawi/Venezuela (MV) and United States (US) with age information. Small symbols represent individual NRADs, large symbols are averages. Error bars are 90% confidence intervals of the averages. The two coordinates of the MDS plot explain 83% of the NRAD distances. (B) Importance of each of the 4105 NRAD ranks for the random forest classification according to country of origin (MV vs. US). The two peaks around ranks 20 and 200 are the NRAD regions that carry most information about the country of origin.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005362.g007" xlink:type="simple"/>
</fig>
<p>Yatsunenko <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005362.ref031">31</xref>] had trained a statistical model that identified bacterial species characteristic to each of the countries. These species could be used to predict the country of origin from the taxonomic composition.</p>
<p>The pattern in the MDS plot (<xref ref-type="fig" rid="pcbi.1005362.g007">Fig 7A</xref>) suggests that it could be possible to train for the older age groups a statistical model that correctly predicts the country of origin of a sample from the shape of the NRAD. To test this hypothesis we trained a random forest model to classify NRADs from individuals older than 3 years according to country Malawi/Venezuela (MV, 89 NRADs) or United States (US, 254 NRADs). We found a high accuracy <italic>ACC</italic> = 0.94 ± 0.02 (mean ± standard error) of the model in threefold cross-validation. However, since the dataset is by far not evenly distributed over both countries, <italic>ACC</italic> could grossly overrate the performance. We therefore computed the <italic>κ</italic>-statistic and found <italic>κ</italic> = 0.85 ± 0.05, confirming the very good performance of this statistical model for predicting country of origin from NRAD. To avoid misunderstandings, we emphasize that “country of origin” is here a proxy for conditions, e.g. life style or diet, prevailing in a sample set that lead to a certain type of NRAD. If these conditions are similar, it is conceivable that NRADs will be similar too and therefore cannot be separated accurately.</p>
<p>It is interesting that not the head or tail region is most important for the classification performance, but that two separate regions in the middle carry most of the information about the country of origin (<xref ref-type="fig" rid="pcbi.1005362.g007">Fig 7B</xref>). Thus we could have normalized to even smaller <italic>R</italic> values without too much loss of information for the classification.</p>
</sec>
<sec id="sec025">
<title>A quantitative model for the change of gut microbiome NRAD entropies with age</title>
<p>Yatsunenko <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005362.ref031">31</xref>] observed that the taxonomic richness in gut microbiomes increased strongly during the first 3 years of age, and then stabilized. We asked whether NRADs reflect this dynamics, even though NRADs ignore taxonomy and eliminate richness. For the first analysis (<xref ref-type="fig" rid="pcbi.1005362.g008">Fig 8</xref>) we split the dataset into log-age intervals of approximately equal lengths, so that we have shorter age intervals at young age when most of the changes are expected, and longer age intervals in the more stable later regime. We then averaged all NRADs in these intervals, irrespective of country of origin.</p>
<fig id="pcbi.1005362.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005362.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Averaged NRADs of gut microbiome data in six age groups.</title>
<p>The number of NRADs per group from youngest to oldest were 9, 18, 55, 64, 34, and 309, respectively. Solid lines are mean NRADs, shaded areas are 90% confidence intervals for the means.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005362.g008" xlink:type="simple"/>
</fig>
<p>The NRADs in <xref ref-type="fig" rid="pcbi.1005362.g008">Fig 8</xref> have a clear dynamics with age: The average abundance in the head region up to about rank 10<sup>0.6</sup> ≈ 4 decreases continuously from the youngest to the oldest age groups, while in the middle and tail regions the average abundance increases from youngest to oldest. These changes are fast in the youngest age groups, and slow down in the oldest groups that have practically the same NRADs. The change from NRADs with strong heads and weak tails in the young, to NRADs with weaker heads and stronger tails in the old means that the evenness of the distribution increases. Since evenness is one aspect of diversity [<xref ref-type="bibr" rid="pcbi.1005362.ref003">3</xref>], we conclude that the growing species richness described by [<xref ref-type="bibr" rid="pcbi.1005362.ref031">31</xref>] in their taxonomy-driven analysis is mirrored by an increase of evenness with age as computed from NRADs.</p>
<p>We now proceed from the qualitative comparison of NRADs in <xref ref-type="fig" rid="pcbi.1005362.g008">Fig 8</xref> to a quantitative model of Shannon entropy as a function of age. Quantitatively, Shannon evenness <italic>J</italic><sup>(<italic>i</italic>)</sup> of NRAD <italic>i</italic> can be expressed in terms of entropy <italic>H</italic><sup>(<italic>i</italic>)</sup> and species richness <italic>S</italic><sup>(<italic>i</italic>)</sup> as [<xref ref-type="bibr" rid="pcbi.1005362.ref003">3</xref>]:
<disp-formula id="pcbi.1005362.e019"><alternatives><graphic id="pcbi.1005362.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mrow><mml:msup><mml:mi>J</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac> <mml:mo>·</mml:mo> <mml:msup><mml:mi>H</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mtext>with</mml:mtext> <mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:msup><mml:mi>H</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>r</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>R</mml:mi></mml:munderover> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>r</mml:mi></mml:mrow></mml:msub> <mml:mo form="prefix">log</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>r</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
where we have used rank abundances <italic>a</italic><sub><italic>ir</italic></sub> according to <xref ref-type="disp-formula" rid="pcbi.1005362.e005">Eq (1)</xref>, and, for simplicity, plain symbols <italic>J</italic>, <italic>H</italic> instead of the commonly used <italic>J</italic>′, <italic>H</italic>′. Since by definition for MaxRank normalized RADs we have <italic>S</italic> = <italic>R</italic> = <italic>const</italic>, the evenness <italic>J</italic> computed from NRADs is proportional to the Shannon entropy <italic>H</italic> of these NRADs. Thus, we can rephrase our observation that NRAD evenness <italic>J</italic> grows with age as an increase of NRAD entropy <italic>H</italic> with age, or, because entropy is a measure of diversity, as growth of diversity with age.</p>
<p>Entropy is sensitive to sampling errors, and therefore not an ideal measure of diversity [<xref ref-type="bibr" rid="pcbi.1005362.ref003">3</xref>]. For instance, bigger samples from the same biological system have often higher richness which directly affects entropy. MaxRank normalization eliminates richness and thus attenuates this error. This property invites quantitative comparison of evenness or entropy across many samples. Here we exploit this to study the 489 HTSeq datasets of gut microbiomes that had information about age in their metadata. The richness in these samples varies over three orders of magnitude, between 4 × 10<sup>3</sup> and 3 × 10<sup>5</sup>.</p>
<p>In <xref ref-type="fig" rid="pcbi.1005362.g009">Fig 9A</xref> entropies of the 489 gut microbiomes with age information are plotted against age. The dynamics of average entropy with age is consistent with <xref ref-type="fig" rid="pcbi.1005362.g008">Fig 8</xref> discussed previously, namely a strong increase in the youngest and stabilization in older individuals.</p>
<fig id="pcbi.1005362.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005362.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Development of gut microbiome entropy <italic>H</italic><sub><italic>R</italic></sub> with age <italic>t</italic>.</title>
<p>(A) Entropies <inline-formula id="pcbi.1005362.e020"><alternatives><graphic id="pcbi.1005362.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>R</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (with <italic>R</italic> = 4105) in nats for 181 samples from Malawi and Venezuela (MV, blue dots), and 308 samples from the United States (US, orange dots). Log-scaled horizontal axis is age in years. Superimposed are models for <inline-formula id="pcbi.1005362.e021"><alternatives><graphic id="pcbi.1005362.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>R</mml:mi></mml:mrow> <mml:mrow><mml:mi>M</mml:mi> <mml:mi>V</mml:mi></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (blue line) and <inline-formula id="pcbi.1005362.e022"><alternatives><graphic id="pcbi.1005362.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>R</mml:mi></mml:mrow> <mml:mrow><mml:mi>U</mml:mi> <mml:mi>S</mml:mi></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (orange line) according to <xref ref-type="disp-formula" rid="pcbi.1005362.e023">Eq (6)</xref>. Areas around the model lines shaded in blue and orange are the corresponding 90% confidence intervals of the respective models. (B) and (C) Comparison of mean entropies of measured data (red points) and their corresponding 90% confidence intervals (error bars), with the model (solid gray lines) and its 90% confidence interval (shaded areas), for MV (panel B) and US (panel C). Model lines and shaded areas are the same as in panel A.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005362.g009" xlink:type="simple"/>
</fig>
<p>The empirically observed change of entropy with age could be explained by a simple quantitative model. We assume that the youngest babies have a gut microbiome of very low diversity. Every microbial intake by the child will therefore have potentially a large impact on the diversity of its microbiome. This will lead to an increasing diversity of the gut microbiome with age. However, as the diversity increases, the impact of new intakes on the diversity will decrease since some of the species have already been taken up earlier. Thus we expect an increase that asymptotically approaches a diversity typical for the environment and life style of the individual. One of the simplest models for entropy <italic>H</italic><sub><italic>R</italic></sub> as measure of diversity with age <italic>t</italic> that shows this behavior is:
<disp-formula id="pcbi.1005362.e023"><alternatives><graphic id="pcbi.1005362.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mrow><mml:msub><mml:mi>H</mml:mi> <mml:mi>R</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>R</mml:mi></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>R</mml:mi></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>R</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>R</mml:mi></mml:msub> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
with three parameters, the maximum entropy <inline-formula id="pcbi.1005362.e024"><alternatives><graphic id="pcbi.1005362.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>R</mml:mi></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> defining the asymptotic diversity, the entropy <inline-formula id="pcbi.1005362.e025"><alternatives><graphic id="pcbi.1005362.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>R</mml:mi></mml:mrow> <mml:mn>0</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> of the gut microbiome shortly after birth, and the entropy growth rate <italic>λ</italic><sub><italic>R</italic></sub>. All quantities have an index <italic>R</italic> to remind us that we base our model on NRADs with a certain MaxRank <italic>R</italic>.</p>
<p>We have fitted two sets of optimal parameters, one with the MV and one with the US data (<xref ref-type="table" rid="pcbi.1005362.t001">Table 1</xref>).</p>
<table-wrap id="pcbi.1005362.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005362.t001</object-id>
<label>Table 1</label>
<caption>
<title>Optimal parameters for the model of gut microbiome NRAD entropy as function of age.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005362.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005362.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="left">
<inline-formula id="pcbi.1005362.e026">
<alternatives>
<graphic id="pcbi.1005362.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e026" xlink:type="simple"/>
<mml:math display="inline" id="M26">
<mml:msubsup>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mi>R</mml:mi>
</mml:mrow>
<mml:mn>0</mml:mn>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</th>
<th align="left">
<inline-formula id="pcbi.1005362.e027">
<alternatives>
<graphic id="pcbi.1005362.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e027" xlink:type="simple"/>
<mml:math display="inline" id="M27">
<mml:msubsup>
<mml:mi>H</mml:mi>
<mml:mrow>
<mml:mi>R</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>m</mml:mi>
<mml:mi>a</mml:mi>
<mml:mi>x</mml:mi>
</mml:mrow>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>
</th>
<th align="left"><italic>λ</italic><sub><italic>R</italic></sub> (<italic>yr</italic><sup>−1</sup>)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><italic>MV</italic></td>
<td align="left">3.41 ± 0.17</td>
<td align="left">5.82 ± 0.06</td>
<td align="left">0.69 ± 0.09</td>
</tr>
<tr>
<td align="left"><italic>US</italic></td>
<td align="left">3.43 ± 0.19</td>
<td align="left">5.27 ± 0.03</td>
<td align="left">1.16 ± 0.27</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001">
<p>Parameters of optimal models <xref ref-type="disp-formula" rid="pcbi.1005362.e023">Eq (6)</xref> fitted separately to the data from MV and US. Errors are 90% confidence intervals.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p><inline-formula id="pcbi.1005362.e028">
<alternatives>
<graphic id="pcbi.1005362.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e028" xlink:type="simple"/>
<mml:math display="inline" id="M28">
<mml:msubsup>
<mml:mi mathvariant="bold-italic">H</mml:mi>
<mml:mrow>
<mml:mi mathvariant="bold-italic">R</mml:mi>
</mml:mrow>
<mml:mn mathvariant="bold">0</mml:mn>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula> <inline-formula id="pcbi.1005362.e029"><alternatives><graphic id="pcbi.1005362.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> The corresponding models are the solid lines in <xref ref-type="fig" rid="pcbi.1005362.g009">Fig 9</xref>. <xref ref-type="fig" rid="pcbi.1005362.g009">Fig 9B and 9C</xref> show that the fitted models capture the average development of diversity with age and the differences between MV and US. The models have a reasonable accuracy with coefficients of determination of <inline-formula id="pcbi.1005362.e030"><alternatives><graphic id="pcbi.1005362.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mi>M</mml:mi> <mml:mi>V</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>74</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005362.e031"><alternatives><graphic id="pcbi.1005362.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mi>U</mml:mi> <mml:mi>S</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>52</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. For all points in <xref ref-type="fig" rid="pcbi.1005362.g009">Fig 9B and 9C</xref> data and model are consistent, with one boundary case being the US model around age 3 <italic>yr</italic> (≈10<sup>0.5</sup> <italic>yr</italic>), where it has a larger error because only a small number of measurements were available (see <xref ref-type="fig" rid="pcbi.1005362.g009">Fig 9A</xref> at this age).</p>
<p>The models are consistent with the observations by [<xref ref-type="bibr" rid="pcbi.1005362.ref031">31</xref>] in their taxonomy-based analysis, such as the increase of gut microbiome diversity in babies and children up to about three years, the split between MV and US in small children, and the turn to the higher asymptotic level in MV and the lower asymptotic level in US. Quantitatively, the model predicts that the youngest babies on average have gut microbiomes with <italic>H</italic><sub>4105</sub> ≈ 3.42 in both MV and US. The averages cannot be distinguished between MV and US up to about 2 <italic>yr</italic> (= 10<sup>0.3</sup> <italic>yr</italic>). On average, children in the US reach the plateau <inline-formula id="pcbi.1005362.e032"><alternatives><graphic id="pcbi.1005362.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>4105</mml:mn></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>U</mml:mi> <mml:mi>S</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>5</mml:mn> <mml:mo>.</mml:mo> <mml:mn>27</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> at about 3.2 <italic>yr</italic> (= 10<sup>0.5</sup> <italic>yr</italic>), children in MV reach the higher plateau <inline-formula id="pcbi.1005362.e033"><alternatives><graphic id="pcbi.1005362.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>4105</mml:mn></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>M</mml:mi> <mml:mi>V</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>5</mml:mn> <mml:mo>.</mml:mo> <mml:mn>82</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> at about 5.6 <italic>yr</italic> (= 10<sup>0.75</sup> <italic>yr</italic>). It must be emphasized that the model predicts <italic>average</italic> diversities as a function of age, not individual diversities. The large spread of entropy values around the average model in <xref ref-type="fig" rid="pcbi.1005362.g009">Fig 9A</xref> shows that inter-individual variation cannot be neglected. Finally, although the model is simple, plausible and fits the data well, other mathematical forms than <xref ref-type="disp-formula" rid="pcbi.1005362.e023">Eq (6)</xref> are possible.</p>
</sec>
</sec>
<sec id="sec026">
<title>GlobalPatterns dataset: Strengths and limitations of NRADs</title>
<p>Analyses with NRADs are complementary to taxonomy-based analyses: NRADs are blind to taxonomy, which is both a limitation and an advantage. It is a limitation because community biology is a function of taxonomic composition. It is an advantage because it enables quantitative comparison between taxonomically different generalized communities and thus discovery of generic community biology that is independent of actual taxonomic composition. A dataset where these aspects can be explored is the GlobalPattern dataset of Caporaso <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005362.ref032">32</xref>] with 26 samples from human microbiomes, various environments, and mock communities. We transformed OTU tables to RADs and normalized them to MaxRank <italic>R</italic> = 2067, the minimum richness in the set, and we computed a distance matrix of all pairs of NRADs.</p>
<p>Hierarchical clustering of the distance matrix (dendrogram in <xref ref-type="fig" rid="pcbi.1005362.g010">Fig 10A</xref>) led to close clustering of some samples that also form taxonomic clusters [<xref ref-type="bibr" rid="pcbi.1005362.ref032">32</xref>], namely the creek samples and a lake sample, the mock communities, or the human tongue and most feces communities. The NRADs in these clusters have low distances and thus are similar (e.g. <xref ref-type="fig" rid="pcbi.1005362.g010">Fig 10B</xref>).</p>
<fig id="pcbi.1005362.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005362.g010</object-id>
<label>Fig 10</label>
<caption>
<title>GlobalPatterns dataset.</title>
<p>(A) Hierarchical clustering dendrogram based on distances between NRADs. (B) NRADs of three samples of similar origin that form a cluster. (C) Microbiome of human palm of human individual 1 clusters closely with sediments 2 and 3, but is more distant to tongue microbiome of individual 1. (D) Three differently shaped NRADs with same entropy.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005362.g010" xlink:type="simple"/>
</fig>
<p>Other relationships are more unexpected. The taxonomy-based analysis by [<xref ref-type="bibr" rid="pcbi.1005362.ref032">32</xref>] clusters tongue and palm microbiomes together and clearly separates human microbiomes from environmental samples. Conversely, NRADs of microbiomes of human palms do cluster closer with environmental samples than with microbiomes of tongues or feces. For instance, the NRAD <italic>palm1</italic> does not cluster with the microbiome <italic>tongue1</italic> of the same individual, but most closely with the sediment samples. NRADs of both <italic>palm1</italic> and <italic>sediment2</italic> have a lower abundance of rank 1 than tongue1 but more heavy tails (<xref ref-type="fig" rid="pcbi.1005362.g010">Fig 10C</xref>), were <italic>palm1</italic> and <italic>sediment2</italic> fit almost perfectly. Reasons for this unexpected clustering are not known. It could be that microbiomes in tongue and feces are more strictly controlled by the host body and the microbiome itself, while microbiomes on palms are more exposed to the environment.</p>
<p>In the GlobalPatterns dataset, entropies <italic>H</italic><sub><italic>R</italic></sub> range from 2.67 (<italic>tongue2</italic>) to 6.58 (<italic>soil2</italic>) with a median of 4.10 and a standard deviation of 1.06, and one may be tempted to explain the observed clustering by different entropies. However, such a simple approach is not successful here. For instance, the three NRADs in <xref ref-type="fig" rid="pcbi.1005362.g010">Fig 10D</xref> have almost the same entropies (<inline-formula id="pcbi.1005362.e034"><alternatives><graphic id="pcbi.1005362.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>R</mml:mi></mml:mrow> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>r</mml:mi> <mml:mi>e</mml:mi> <mml:mi>e</mml:mi> <mml:mi>k</mml:mi> <mml:mn>3</mml:mn></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>3</mml:mn> <mml:mo>.</mml:mo> <mml:mn>98</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005362.e035"><alternatives><graphic id="pcbi.1005362.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>R</mml:mi></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>o</mml:mi> <mml:mi>c</mml:mi> <mml:mi>k</mml:mi> <mml:mn>2</mml:mn></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>3</mml:mn> <mml:mo>.</mml:mo> <mml:mn>95</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005362.e036"><alternatives><graphic id="pcbi.1005362.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>R</mml:mi></mml:mrow> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>o</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi> <mml:mi>u</mml:mi> <mml:mi>e</mml:mi> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>3</mml:mn> <mml:mo>.</mml:mo> <mml:mn>91</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>), but have completely different shapes, and are members of different clusters. In general, the rich information content of an NRAD cannot be reduced to a single scalar quantity.</p>
<p>In the introduction we have mentioned that a theoretical possibility to quantitatively compare pairs of RADs of different richness (a strength of MaxRank normalization) is the use of the Kolmogorov-Smirnov statistic <italic>D</italic>, without RAD normalization. This corresponds to using the Chebyshev distance between the corresponding two cumulative distribution functions with different support. Although it is obvious that this approach treats the tail regions in a problematic way, it is unclear whether this problem is of practical relevance. To test this, we treated <italic>D</italic> as a distance and reran the hierarchical clustering with this distance. In fact, this <italic>D</italic>-based tree recovers some of the features of <xref ref-type="fig" rid="pcbi.1005362.g010">Fig 10A</xref>, but in general shows less biologically meaningful clusters (<xref ref-type="supplementary-material" rid="pcbi.1005362.s001">S1 Fig</xref>). We conclude that a <italic>D</italic>-based analysis is in practice no alternative to MaxRank normalization.</p>
<p>As mentioned in the introduction, one commonly used procedure for quantitative RAD comparisons is a parametric approach. Typically, a standard distribution such as the log-normal is fitted to a set of RADs and the comparison is then reduced to a comparison of the fitted parameters. We have tested the viability of this approach by fitting to the RADs of all GlobalPatterns samples five standard distributions, broken stick as null model, preemption, log-normal, Zipf, and Mandelbrot [<xref ref-type="bibr" rid="pcbi.1005362.ref041">41</xref>]. For most samples, with the exception of some soil and sediment samples, we found clear <italic>qualitative</italic> deviations from all five fitted distributions (<xref ref-type="supplementary-material" rid="pcbi.1005362.s002">S2 Fig</xref>), or, in other words, only few fitted distributions reflected the actual RAD shapes. This means that this parametric approach is in general not an option for quantitative analysis of HTSeq data. In contrast, with our non-parametric approach we can quantitatively compare all information-rich NRADs in a consistent and detailed way.</p>
</sec>
<sec id="sec027">
<title>Robustness of analyses based on MaxRank normalization</title>
<p>The key feature of MaxRank normalization is that it enables quantitative RAD comparisons by mapping RADs with diverse richness values to NRADs of a common richness <italic>R</italic>. It is clear that the lower <italic>R</italic>, the less information can be carried by NRADs. This could make analyses based on NRADs sensitive to <italic>R</italic>. To test this, we have tested how the choice of <italic>R</italic> affects NRAD based classification, NRAD distances, and NRAD entropies, as used in the previous sections.</p>
<p>First, we address the question whether NRAD based classification is sensitive to <italic>R</italic> using the classification of gut microbiomes described earlier. We use the same random forest classification and threefold cross validation as before to classify NRADs of gut microbiomes of individuals older than 3 years into MV (Malawi/Venezuela) or US (United States). The results for <italic>R</italic> = 4105, 1000, and 250 are summarized in <xref ref-type="table" rid="pcbi.1005362.t002">Table 2</xref>.</p>
<table-wrap id="pcbi.1005362.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005362.t002</object-id>
<label>Table 2</label>
<caption>
<title>Accuracy of NRAD-based classification.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005362.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005362.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"><italic>R</italic></th>
<th align="left"><italic>ACC</italic></th>
<th align="left"><italic>κ</italic></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">4105</td>
<td align="left">0.948 ± 0.018</td>
<td align="left">0.862 ± 0.049</td>
</tr>
<tr>
<td align="left">1000</td>
<td align="left">0.947 ± 0.022</td>
<td align="left">0.860 ± 0.057</td>
</tr>
<tr>
<td align="left">250</td>
<td align="left">0.917 ± 0.025</td>
<td align="left">0.784 ± 0.064</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001">
<p>Accuracy <italic>ACC</italic> and <italic>κ</italic> statistic of NRAD-based classification for country of origin of gut microbiome as function of MaxRank <italic>R</italic>.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>The table shows a weak reduction in accuracy and <italic>κ</italic> statistic with decreasing <italic>R</italic> and increasing errors, both explainable by a loss of information stored in the NRADs with lower <italic>R</italic>. However, the reduction of <italic>R</italic> from 4105 to 1000 affects the accuracy of the classifier barely, and even the classifier computed from NRADs with <italic>R</italic> = 250 has still a good accuracy. The weak dependency is consistent with the importance plot (<xref ref-type="fig" rid="pcbi.1005362.g007">Fig 7B</xref>) where the regions of high importance cover two extended rank intervals that can be mapped down to NRADs with <italic>R</italic> = 250 or lower, though with some losses.</p>
<p>Secondly, we test the effect of <italic>R</italic> reduction on NRAD distances for the GlobalPatterns data set. <xref ref-type="fig" rid="pcbi.1005362.g011">Fig 11A</xref> demonstrates that NRAD distances (<xref ref-type="disp-formula" rid="pcbi.1005362.e007">Eq 2</xref>) are well-conserved even if <italic>R</italic> is an order of magnitude lower than the richness of the original RADs. Approximately halving <italic>R</italic> from <italic>R</italic> = 2067 (the maximum possible <italic>R</italic> in the GlobalPatterns set) to <italic>R</italic> = 1000 does not affect distances between NRADs: the points are very close to the diagonal (coefficient of determination <italic>r</italic><sup>2</sup> = 1.000). If we reduce <italic>R</italic> more drastically to 250 (green points in <xref ref-type="fig" rid="pcbi.1005362.g011">Fig 11A</xref>), deviations appear, but we still have <italic>r</italic><sup>2</sup> = 0.976. The small deviations of NRAD distances in <xref ref-type="fig" rid="pcbi.1005362.g011">Fig 11A</xref> for <italic>R</italic> = 250 are all towards smaller NRAD distances (points shifted to the left of the diagonal), because lowering <italic>R</italic> from 2067 to 250 means that for <italic>R</italic> = 250 we straighten some of the fine-grained structure of NRADs with <italic>R</italic> = 2067 that allows for larger NRAD distances. Even for <italic>R</italic> = 100 we still have <italic>r</italic><sup>2</sup> = 0.913.</p>
<fig id="pcbi.1005362.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005362.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Dependence of NRAD distances <italic>d</italic><sub><italic>R</italic></sub> on MaxRank <italic>R</italic>.</title>
<p>Co-ordinates are distances <italic>d</italic><sub><italic>R</italic></sub> between all 26 ⋅ (26 − 1)/2 = 325 NRAD pairs of the 26 GlobalPatterns samples at three different values of <italic>R</italic>. If the distance of an NRAD pair is the same for both <italic>R</italic>, the point lies on the diagonal. (A) MaxRank normalization; (B) cutoff normalization.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005362.g011" xlink:type="simple"/>
</fig>
<p>In <xref ref-type="fig" rid="pcbi.1005362.g011">Fig 11B</xref> we show for comparison how reduction of <italic>R</italic> affects NRAD distances for a simpler normalization scheme in which ranks above a given <italic>R</italic> are cut off (“cutoff normalization”), i.e. information in the tails with ranks higher than <italic>R</italic> is completely neglected. The scatter of the points is generally wider for all three values of <italic>R</italic> with <italic>r</italic><sup>2</sup> = 0.995, 0.874 and 0.614, respectively. These lower <italic>r</italic><sup>2</sup> values point to the importance of the tails that are neglected by cutoff normalization. NRAD pairs with differences predominantly in the neglected tails appear in <xref ref-type="fig" rid="pcbi.1005362.g011">Fig 11B</xref> shifted to the left of the diagonal, while NRAD pairs with more divergent heads and more similar tails appear right shifted. Cutoff normalization clearly is less robust than MaxRank normalization with respect to the choice of <italic>R</italic>.</p>
<p>As a consequence of the robustness of NRAD distances, the down-stream analyses that make use of NRAD distances are also quite robust. For instance, the hierarchical clustering (<xref ref-type="fig" rid="pcbi.1005362.g010">Fig 10A</xref>) of the GlobalPatterns dataset is identical between <italic>R</italic> = 250, <italic>R</italic> = 1000, and <italic>R</italic> = 2067 up to an agglomeration height of 0.98 (vertical axis in <xref ref-type="fig" rid="pcbi.1005362.g010">Fig 10A</xref>). Cluster assignments differ only above this agglomeration height at the highest branching points and thus at the most fuzzy cluster level.</p>
<p>Thirdly, we find for each sample <italic>i</italic> a regular and systematic <italic>R</italic> dependence of NRAD entropy <inline-formula id="pcbi.1005362.e037"><alternatives><graphic id="pcbi.1005362.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>R</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1005362.e019">Eq 5</xref>):
<disp-formula id="pcbi.1005362.e038"><alternatives><graphic id="pcbi.1005362.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>R</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>/</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>R</mml:mi> <mml:mo>≈</mml:mo> <mml:msup><mml:mi mathvariant="normal">c</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula>
with a sample dependent constant <italic>c</italic><sup>(<italic>i</italic>)</sup>. This approximation works reasonably well if <italic>R</italic> is not varied by more than an order of magnitude. <xref ref-type="disp-formula" rid="pcbi.1005362.e038">Eq (7)</xref> corresponds formally to the definition of Shannon evenness with <italic>R</italic> interpreted as richness (<xref ref-type="disp-formula" rid="pcbi.1005362.e019">Eq 5</xref>), i.e. Shannon evenness changes weakly with <italic>R</italic>. Moreover, this equation means that entropy or information content will systematically decrease with decreasing <italic>R</italic>. This decrease will depend weakly on <italic>R</italic> since log <italic>R</italic> changes only slowly with <italic>R</italic>.</p>
<p>As the NRAD entropies change systematically with <italic>R</italic>, this must also affect our model of entropy of gut microbiome NRADs as function of age. For instance if we approximately halve <italic>R</italic> from 4105 to 2000 and repeat the fitting of the model <xref ref-type="disp-formula" rid="pcbi.1005362.e023">Eq (6)</xref> we arrive at <inline-formula id="pcbi.1005362.e039"><alternatives><graphic id="pcbi.1005362.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>2000</mml:mn></mml:mrow> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>M</mml:mi> <mml:mi>V</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>3</mml:mn> <mml:mo>.</mml:mo> <mml:mn>34</mml:mn> <mml:mo>±</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>16</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005362.e040"><alternatives><graphic id="pcbi.1005362.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>2000</mml:mn></mml:mrow> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>U</mml:mi> <mml:mi>S</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>3</mml:mn> <mml:mo>.</mml:mo> <mml:mn>35</mml:mn> <mml:mo>±</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>19</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005362.e041"><alternatives><graphic id="pcbi.1005362.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mn>2000</mml:mn></mml:mrow> <mml:mrow><mml:mi>M</mml:mi> <mml:mi>V</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>70</mml:mn> <mml:mo>±</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>09</mml:mn> <mml:mspace width="0.166667em"/><mml:mi>y</mml:mi> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005362.e042"><alternatives><graphic id="pcbi.1005362.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mn>2000</mml:mn></mml:mrow> <mml:mrow><mml:mi>U</mml:mi> <mml:mi>S</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>18</mml:mn> <mml:mo>±</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>27</mml:mn> <mml:mspace width="0.166667em"/><mml:mi>y</mml:mi> <mml:msup><mml:mi>r</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005362.e043"><alternatives><graphic id="pcbi.1005362.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>2000</mml:mn></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>M</mml:mi> <mml:mi>V</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>5</mml:mn> <mml:mo>.</mml:mo> <mml:mn>62</mml:mn> <mml:mo>±</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>06</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1005362.e044"><alternatives><graphic id="pcbi.1005362.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005362.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>2000</mml:mn></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>U</mml:mi> <mml:mi>S</mml:mi></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>5</mml:mn> <mml:mo>.</mml:mo> <mml:mn>12</mml:mn> <mml:mo>±</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>03</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Entropic model parameters <italic>H</italic><sub>2000</sub> are systematically lower by a small amount than the corresponding <italic>H</italic><sub>4105</sub> values (<xref ref-type="table" rid="pcbi.1005362.t001">Table 1</xref>) as expected from an approximate scaling (<xref ref-type="disp-formula" rid="pcbi.1005362.e038">Eq 7</xref>). If all entropic factors in <xref ref-type="disp-formula" rid="pcbi.1005362.e023">Eq (6)</xref> scale in the same way, the scaling factor cancels, and the exponential growth term <italic>e</italic><sup>−<italic>λt</italic></sup> should stay the same. In fact, the growth parameters <italic>λ</italic> are almost unaffected by the decrease of <italic>R</italic> from 4105 to 2000.</p>
<p>Finally, one important aspect of robustness is the following. If we take several samples of different size and therefore different richness of the same, well-mixed generalized community, then determine the RADs of those samples, and finally normalize these RADs to the same <italic>R</italic>, we should obtain the same NRAD for all samples. Only if this requirement is met can NRADs inform reliably about a generalized community. To test fulfillment of this requirement, we first down-sampled original HTSeq data sets by an order of magnitude in richness. <xref ref-type="fig" rid="pcbi.1005362.g012">Fig 12A</xref> shows as an example the original RAD and the down-sampled RAD of the first sample in the gut microbiome data of [<xref ref-type="bibr" rid="pcbi.1005362.ref031">31</xref>] (MG-RAST ID 4.4899263e6). We then normalized both to the same MaxRank <italic>R</italic> = 1000 (<xref ref-type="fig" rid="pcbi.1005362.g012">Fig 12B</xref>). For all samples we found that both RADs, the original and the down-sampled, led to practically the same NRAD. The violin plot <xref ref-type="fig" rid="pcbi.1005362.g012">Fig 12C</xref> makes a quantitative statement about this property: the biologically relevant distance distributions between NRADs are the same for both the original and down-sampled data (left and middle violin in <xref ref-type="fig" rid="pcbi.1005362.g012">Fig 12C</xref> are equal). In comparison, the distances between corresponding pairs of NRADs of original and down-sampled RADs are negligible (right violin in <xref ref-type="fig" rid="pcbi.1005362.g012">Fig 12C</xref>) as it should be for a normalization procedure that is robust against the size of the source sample.</p>
<fig id="pcbi.1005362.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005362.g012</object-id>
<label>Fig 12</label>
<caption>
<title>Robustness of NRADs against varying sampling depth.</title>
<p>(A) original RAD of first sample of [<xref ref-type="bibr" rid="pcbi.1005362.ref031">31</xref>] (black) and down-sampled RAD (red). (B) the two NRADs obtained by MaxRank normalization to <italic>R</italic> = 1000 of the RADs in panel A are almost indistinguishable. (C) comparison of NRAD distances of the first 50 samples of the data set of [<xref ref-type="bibr" rid="pcbi.1005362.ref031">31</xref>]. Left violin plot: density of distances between NRADs computed by MaxRank normalization to <italic>R</italic> = 1000 of the original RADs; middle violin plot: same for down-sampled RADs; right violin plot: distances between corresponding original and down-sampled NRADs. The biologically meaningful NRAD distance distributions are robust against differences in sample size (left and middle violin). In comparison, the distances related to differences in sample size are negligible (right violin).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005362.g012" xlink:type="simple"/>
</fig>
<p>In summary, we found that NRADs are robust quantitative descriptors of RADs. However, it is also clear that there are critical values of <italic>R</italic> below which essential RAD structures are lost and analyses become inconclusive. These critical values will depend on the studied RADs and on the analysis method. We recommend to monitor NRAD quality with methods suitable for the respective question. For instance, if the cluster structure of a set of NRADs is of interest, clustering and ordination methods as those presented above can be used to detect loss of structure when results for several <italic>R</italic> values are compared.</p>
</sec>
</sec>
<sec id="sec028" sec-type="conclusions">
<title>Discussion</title>
<p>MaxRank normalization makes communities of different richness quantitatively comparable by mapping their RADs to NRADs of a common richness <italic>R</italic>. This is similar to projecting objects of different higher dimensions to one common lower dimension where the projections can be compared directly. The price to be paid is information loss, especially loss of richness information. However, the remaining information enables new approaches to community analysis. In particular, we could show that the information extracted from NRADs is sufficient to generate quantitative models of the dynamics or composition of generalized communities.</p>
<p>MaxRank normalization is not the only possible algorithm that maps higher richness RADs to a common lower richness, but it has crucial advantages over other procedures. For instance, another procedure is to cut off in all RADs ranks beyond a common maximum rank <italic>R</italic>. Obviously, this simple procedure neglects information in the RAD tails, leading to lower robustness as shown earlier. An alternative would be to scale the rank axis to the same maximum number. This would lead to fractional pseudo-ranks; the corresponding pseudo-rank abundance vectors have different dimensions and thus cannot be compared directly. Another alternative is the coarse-graining of the rank axis to a given number of pseudo-ranks. This is also not satisfying as the coarse-graining would treat samples of different richness differently, and because the pseudo-ranks are not observables. Conversely, MaxRank normalization is conceptually attractive since it corresponds to a real experimental sampling process with the attainment of a given richness as stop criterion. In fact, a similar observational protocol (“m-species list”), i.e. sampling up to a constant maximum rank, has been used in field ecology [<xref ref-type="bibr" rid="pcbi.1005362.ref053">53</xref>]. MaxRank normalization does not impose a specific model, i.e. the approach is model-free and generally applicable. For instance, we have applied it not only to HTSeq data but also to data from conventional ecological sampling of macro-invertebrates from fresh-water systems (unpublished).</p>
<p>MaxRank normalization (re-sampling up to a given maximum rank) may be confused with <italic>rarefying</italic> (re-sampling up to a given maximum number of individuals) [<xref ref-type="bibr" rid="pcbi.1005362.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1005362.ref022">22</xref>]. However, the two methods answer different diversity questions: rarefying allows answering questions that relate to sample richness (and typically also to OTU abundance), while NRAD comparison largely eliminates richness (and OTUs) and puts emphasis on abundance structure difference.</p>
<p>There are a number of limitations of MaxRank normalization. First, it is obvious that most information about richness is lost. Interestingly, it is not completely lost, but partially encoded in the NRADs, as a detailed technical analysis shows (to be published elsewhere). Nevertheless, if mainly changes or differences in richness are of interest, NRADs are not suitable.</p>
<p>Second, and related to the previous limitation, it is possible that some of the samples to be compared are richness-limited while others are not. In this case the information loss mentioned above can turn the method useless. To illustrate this point, imagine two systems that should be compared, one with two species, the other with thousands of species. In this case we would normalize the system to <italic>R</italic> = 2 and lose almost all the information in the RAD of the richer system. This limitation is usually not serious for the analysis of HTSeq data of generalized communities such as microbiomes. One strategy to cope with outlier samples of extremely low richness that would enforce the use of a low <italic>R</italic> and severe loss of information in NRADs is to discard such outliers, thus sacrificing some breadth for higher accuracy.</p>
<p>Third, a more severe problem with HTSeq data is the often implied assumption that read counts are quantitative measures of abundances. Unfortunately, HTSeq data can be biased by the experimental protocol, e.g. by preferential PCR amplification of certain species and non-amplification of others, or it can contain false positives, e.g. error mutants or chimeras produced in the experimental process [<xref ref-type="bibr" rid="pcbi.1005362.ref054">54</xref>, <xref ref-type="bibr" rid="pcbi.1005362.ref055">55</xref>]. Since RADs are derived from OTU tables, any abundance bias that affects OTU tables will also affect RADs. Although these problems do not limit applicability of MaxRank normalization, they do limit the possible biological interpretation of the results. Related to this point, we found that changes in HTSeq protocols can significantly impact RADs and therefore NRADs. Thus, a stringent control is required if results from different studies are to be compared. Such a control can be implemented e.g. by comparing RADs resulting from the application of the different protocols to common reference samples. As HTSeq technology develops rapidly, some of these experimental problems may be solved in the near future. But even with these imperfections, NRADs can be used as generic quantitative descriptors to discover new community biology.</p>
<p>Fourth, analyses based on NRADs alone are blind to taxonomic composition. This can be an advantage because in this way generic effects that influence the abundance structure can become clearly visible. But this blindness to taxonomy makes NRAD based analyses inadequate if differences or changes in taxonomic composition are of major interest.</p>
</sec>
<sec id="sec029">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005362.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005362.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Kolmogorov-Smirnov statistic <italic>D</italic> as RAD-RAD distance.</title>
<p>Hierarchical clustering dendrogram of GlobalPatterns RADs, using Kolmogorov-Smirnov statistic <italic>D</italic> between pairs of non-normalized RADs as distance (results with the Anderson-Darling statistic were essentially the same). Some of the samples (e.g. <italic>soil1</italic> and <italic>soil2</italic>) are clustered similar to the NRAD-NRAD distance based dendrogram <xref ref-type="fig" rid="pcbi.1005362.g010">Fig 10A</xref> of main text. More often, clustering based on NRAD distances is biologically more meaningful than <italic>D</italic>-based clustering (e.g. <italic>ocean1/2/3</italic>). In some cases, the <italic>D</italic>-based clustering is biologically outright wrong as for the cluster formed by the high-evenness mock samples and the low-evenness tongue samples.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005362.s002" mimetype="image/png" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005362.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Fits of four standard distributions to RADs of GlobalPatterns set.</title>
<p>(PNG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005362.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005362.s003" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Meta-data for GlobalPatterns and correspondence of original sample IDs and new sample names.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005362.ref001">
<label>1</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Morin</surname> <given-names>PJ</given-names></name>. <source>Community Ecology</source>. <publisher-name>Wiley-Blackwell</publisher-name>; <year>1999</year>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.worldcat.org/isbn/0865423504" xlink:type="simple">http://www.worldcat.org/isbn/0865423504</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005362.ref002">
<label>2</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Darwin</surname> <given-names>C</given-names></name>. <source>On the Origin of Species</source>. <publisher-name>J. Murray</publisher-name>, <publisher-loc>London</publisher-loc>; <year>1859</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005362.ref003">
<label>3</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Magurran</surname> <given-names>AE</given-names></name>. <source>Measuring Biological Diversity</source>. <publisher-name>Wiley</publisher-name>; <year>2004</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://books.google.de/books?id=tUqzLSUzXxcC" xlink:type="simple">https://books.google.de/books?id=tUqzLSUzXxcC</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005362.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hill</surname> <given-names>MO</given-names></name>. <article-title>Diversity and Evenness: A Unifying Notation and Its Consequences</article-title>. <source>Ecology</source>. <year>1973</year>;<volume>54</volume>(<issue>2</issue>):pp. <fpage>427</fpage>–<lpage>432</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/1934352" xlink:type="simple">10.2307/1934352</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McGill</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Etienne</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Gray</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Alonso</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Benecha</surname> <given-names>HK</given-names></name>, <etal>et al</etal>. <article-title>Species abundance distributions: moving beyond single prediction theories to integration within an ecological framework</article-title>. <source>Ecol Lett</source>. <year>2007</year>;<volume>10</volume>(<issue>10</issue>):<fpage>995</fpage>–<lpage>1015</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1461-0248.2007.01094.x" xlink:type="simple">10.1111/j.1461-0248.2007.01094.x</ext-link></comment> <object-id pub-id-type="pmid">17845298</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref006">
<label>6</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Magurran</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>McGill</surname> <given-names>BJ</given-names></name>. <chapter-title>Biological Diversity: Frontiers in Measurement and Assessment</chapter-title>. <source>Oxford biology</source>. <publisher-name>OUP</publisher-name> <publisher-loc>Oxford</publisher-loc>; <year>2011</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005362.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Newman</surname> <given-names>M</given-names></name>. <article-title>Power laws, Pareto distributions and Zipf’s law</article-title>. <source>Contemporary Physics</source>. <year>2005</year>;<volume>46</volume>(<issue>5</issue>):<fpage>323</fpage>–<lpage>351</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/00107510500052444" xlink:type="simple">10.1080/00107510500052444</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref008">
<label>8</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>May</surname> <given-names>RM</given-names></name>. <chapter-title>Patterns of species abundance and diversity</chapter-title>. In: <name name-style="western"><surname>Cody</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Diamond</surname> <given-names>J</given-names></name>, editors. <source>Ecology and evolution of communities</source>. <publisher-name>Harvard University Press</publisher-name>; <year>1975</year>. p. <fpage>81</fpage>–<lpage>120</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005362.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lü</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>ZK</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>T</given-names></name>. <article-title>Zipf’s law leads to Heaps’ law: analyzing their relation in finite-size systems</article-title>. <source>PLoS One</source>. <year>2010</year>;<volume>5</volume>(<issue>12</issue>):<fpage>e14139</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0014139" xlink:type="simple">10.1371/journal.pone.0014139</ext-link></comment> <object-id pub-id-type="pmid">21152034</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Motomura</surname> <given-names>I</given-names></name>. <article-title>On the statistical treatment of communities</article-title>. <source>Zool Mag</source>. <year>1932</year>;<volume>44</volume>:<fpage>379</fpage>–<lpage>383</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005362.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fisher</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Corbet</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>CB</given-names></name>. <article-title>The relation between the number of species and the number of individuals in a random sample of an animal population</article-title>. <source>Journal of Animal Ecology</source>. <year>1943</year>;<volume>12</volume>:<fpage>42</fpage>–<lpage>58</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/1411" xlink:type="simple">10.2307/1411</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Preston</surname> <given-names>FW</given-names></name>. <article-title>The Commonness, And Rarity, of Species</article-title>. <source>Ecology</source>. <year>1948</year>;<volume>29</volume>(<issue>3</issue>):<fpage>254+</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/1930989" xlink:type="simple">10.2307/1930989</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>MacArthur</surname> <given-names>RH</given-names></name>. <article-title>On the relative abundance of bird species</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>1957</year>;<volume>43</volume>(<issue>3</issue>):<fpage>293</fpage>–<lpage>295</lpage>. <object-id pub-id-type="pmid">16590018</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref014">
<label>14</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hubbell</surname> <given-names>S</given-names></name>. <source>The Unified Neutral Theory of Biodiversity and Biogeography</source>. <publisher-name>Princeton University Press</publisher-name>; <year>2001</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005362.ref015">
<label>15</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>May</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>McLean</surname> <given-names>AR</given-names></name>. <source>Theoretical Ecology: Principles and Applications</source>. <publisher-name>OUP</publisher-name> <publisher-loc>Oxford</publisher-loc>; <year>2007</year>. Available from: <ext-link ext-link-type="uri" xlink:href="http://books.google.de/books?id=6AbQp2jbiI4C" xlink:type="simple">http://books.google.de/books?id=6AbQp2jbiI4C</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005362.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gray</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Waldichuk</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Newton</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Berry</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Holden</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>Pearson</surname> <given-names>TH</given-names></name>. <article-title>Pollution-Induced Changes in Populations [and Discussion]</article-title>. <source>Philosophical Transactions of the Royal Society of London B: Biological Sciences</source>. <year>1979</year>;<volume>286</volume>(<issue>1015</issue>):<fpage>545</fpage>–<lpage>561</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.1979.0045" xlink:type="simple">10.1098/rstb.1979.0045</ext-link></comment> <object-id pub-id-type="pmid">40277</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Foster</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Dunstan</surname> <given-names>PK</given-names></name>. <article-title>The analysis of biodiversity using rank abundance distributions</article-title>. <source>Biometrics</source>. <year>2010</year>;<volume>66</volume>(<issue>1</issue>):<fpage>186</fpage>–<lpage>195</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1541-0420.2009.01263.x" xlink:type="simple">10.1111/j.1541-0420.2009.01263.x</ext-link></comment> <object-id pub-id-type="pmid">19432789</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Matthews</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Whittaker</surname> <given-names>RJ</given-names></name>. <article-title>On the species abundance distribution in applied ecology and biodiversity management</article-title>. <source>J Appl Ecol</source>. <year>2015</year>;<volume>52</volume>(<issue>2</issue>):<fpage>443</fpage>–<lpage>454</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/1365-2664.12380" xlink:type="simple">10.1111/1365-2664.12380</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tokeshi</surname> <given-names>M</given-names></name>. <article-title>Species Abundance Patterns and Community Structure</article-title>. <source>Advances in Ecological Research</source>. <year>1993</year>;<volume>24</volume>:<fpage>111</fpage>–<lpage>186</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0065-2504(08)60042-2" xlink:type="simple">http://dx.doi.org/10.1016/S0065-2504(08)60042-2</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005362.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McMurdie</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>S</given-names></name>. <article-title>Waste not, want not: why rarefying microbiome data is inadmissible</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>(<issue>4</issue>):<fpage>e1003531</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003531" xlink:type="simple">10.1371/journal.pcbi.1003531</ext-link></comment> <object-id pub-id-type="pmid">24699258</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sanders</surname> <given-names>HL</given-names></name>. <article-title>Marine Benthic Diversity: A Comparative Study</article-title>. <source>The American Naturalist</source>. <year>1968</year>;<volume>102</volume>(<issue>925</issue>):<fpage>243</fpage>–<lpage>282</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1086/282541" xlink:type="simple">10.1086/282541</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Koren</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Knights</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Gonzalez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Waldron</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Segata</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Knight</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>A guide to enterotypes across the human body: meta-analysis of microbial community structures in human microbiome datasets</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year>;<volume>9</volume>(<issue>1</issue>):<fpage>e1002863</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002863" xlink:type="simple">10.1371/journal.pcbi.1002863</ext-link></comment> <object-id pub-id-type="pmid">23326225</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref023">
<label>23</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Janeway</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Travers</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Walport</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Shlomchik</surname> <given-names>M</given-names></name>. <source>Immunobiology: The Immune System in Health and Disease</source>. <edition>5th ed</edition>. <publisher-name>Garland Science</publisher-name>; <year>2001</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005362.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tonegawa</surname> <given-names>S</given-names></name>. <article-title>Somatic generation of antibody diversity</article-title>. <source>Nature</source>. <year>1983</year>;<volume>302</volume>(<issue>5909</issue>):<fpage>575</fpage>–<lpage>581</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/302575a0" xlink:type="simple">10.1038/302575a0</ext-link></comment> <object-id pub-id-type="pmid">6300689</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Matsuda</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Honjo</surname> <given-names>T</given-names></name>. <article-title>Organization of the human immunoglobulin heavy-chain locus</article-title>. <source>Adv Immunol</source>. <year>1996</year>;<volume>62</volume>:<fpage>1</fpage>–<lpage>29</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0065-2776(08)60426-5" xlink:type="simple">10.1016/S0065-2776(08)60426-5</ext-link></comment> <object-id pub-id-type="pmid">8781265</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Venter</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Remington</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Heidelberg</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Halpern</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Rusch</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Eisen</surname> <given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>Environmental genome shotgun sequencing of the Sargasso Sea</article-title>. <source>Science</source>. <year>2004</year>;<volume>304</volume>(<issue>5667</issue>):<fpage>66</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1093857" xlink:type="simple">10.1126/science.1093857</ext-link></comment> <object-id pub-id-type="pmid">15001713</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tringe</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>von Mering</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kobayashi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Salamov</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>HW</given-names></name>, <etal>et al</etal>. <article-title>Comparative metagenomics of microbial communities</article-title>. <source>Science</source>. <year>2005</year>;<volume>308</volume>(<issue>5721</issue>):<fpage>554</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1107851" xlink:type="simple">10.1126/science.1107851</ext-link></comment> <object-id pub-id-type="pmid">15845853</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<collab>Human Microbiome Project Consortium</collab>. <article-title>Structure, function and diversity of the healthy human microbiome</article-title>. <source>Nature</source>. <year>2012</year>;<volume>486</volume>(<issue>7402</issue>):<fpage>207</fpage>–<lpage>214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11234" xlink:type="simple">10.1038/nature11234</ext-link></comment> <object-id pub-id-type="pmid">22699609</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Costello</surname> <given-names>EK</given-names></name>, <name name-style="western"><surname>Stagaman</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Dethlefsen</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Bohannan</surname> <given-names>BJM</given-names></name>, <name name-style="western"><surname>Relman</surname> <given-names>DA</given-names></name>. <article-title>The application of ecological theory toward an understanding of the human microbiome</article-title>. <source>Science</source>. <year>2012</year>;<volume>336</volume>(<issue>6086</issue>):<fpage>1255</fpage>–<lpage>1262</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1224203" xlink:type="simple">10.1126/science.1224203</ext-link></comment> <object-id pub-id-type="pmid">22674335</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dethlefsen</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Huse</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sogin</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Relman</surname> <given-names>DA</given-names></name>. <article-title>The pervasive effects of an antibiotic on the human gut microbiota, as revealed by deep 16S rRNA sequencing</article-title>. <source>PLoS Biol</source>. <year>2008</year>;<volume>6</volume>(<issue>11</issue>):<fpage>e280</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.0060280" xlink:type="simple">10.1371/journal.pbio.0060280</ext-link></comment> <object-id pub-id-type="pmid">19018661</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yatsunenko</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Rey</surname> <given-names>FE</given-names></name>, <name name-style="western"><surname>Manary</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Trehan</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Dominguez-Bello</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Contreras</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Human gut microbiome viewed across age and geography</article-title>. <source>Nature</source>. <year>2012</year>;<volume>486</volume>(<issue>7402</issue>):<fpage>222</fpage>–<lpage>227</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11053" xlink:type="simple">10.1038/nature11053</ext-link></comment> <object-id pub-id-type="pmid">22699611</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Caporaso</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Lauber</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Walters</surname> <given-names>WA</given-names></name>, <name name-style="western"><surname>Berg-Lyons</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lozupone</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Turnbaugh</surname> <given-names>PJ</given-names></name>, <etal>et al</etal>. <article-title>Global patterns of 16S rRNA diversity at a depth of millions of sequences per sample</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2011</year>;<volume>108</volume> <issue>Suppl 1</issue>:<fpage>4516</fpage>–<lpage>4522</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1000080107" xlink:type="simple">10.1073/pnas.1000080107</ext-link></comment> <object-id pub-id-type="pmid">20534432</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Budeus</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Schweigle de Reynoso</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Przekopowitz</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hoffmann</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Seifert</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Küppers</surname> <given-names>R</given-names></name>. <article-title>Complexity of the human memory B-cell compartment is determined by the versatility of clonal diversification in germinal centers</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2015</year>;<volume>112</volume>(<issue>38</issue>):<fpage>E5281</fpage>–<lpage>E5289</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1511270112" xlink:type="simple">10.1073/pnas.1511270112</ext-link></comment> <object-id pub-id-type="pmid">26324941</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McMurdie</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>S</given-names></name>. <article-title>phyloseq: An R Package for Reproducible Interactive Analysis and Graphics of Microbiome Census Data</article-title>. <source>PLoS One</source>. <year>2013</year>;<volume>8</volume>(<issue>4</issue>):<fpage>e61217</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0061217" xlink:type="simple">10.1371/journal.pone.0061217</ext-link></comment> <object-id pub-id-type="pmid">23630581</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref035">
<label>35</label>
<mixed-citation publication-type="book" xlink:type="simple">
<collab>R Core Team</collab>. <source>R: A Language and Environment for Statistical Computing</source>; <year>2015</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/" xlink:type="simple">https://www.R-project.org/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005362.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gower</surname> <given-names>JC</given-names></name>. <article-title>Some Distance Properties of Latent Root and Vector Methods Used in Multivariate Analysis</article-title>. <source>Biometrika</source>. <year>1966</year>;<volume>53</volume>(<issue>3/4</issue>):<fpage>325</fpage>–<lpage>338</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biomet/53.3-4.325" xlink:type="simple">10.1093/biomet/53.3-4.325</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Breiman</surname> <given-names>L</given-names></name>. <article-title>Random Forests</article-title>. <source>Machine Learning</source>. <year>2001</year>;<volume>45</volume>:<fpage>5</fpage>–<lpage>32</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1023/A:1010933404324" xlink:type="simple">10.1023/A:1010933404324</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liaw</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wiener</surname> <given-names>M</given-names></name>. <article-title>Classification and Regression by randomForest</article-title>. <source>R News</source>. <year>2002</year>;<volume>2</volume>(<issue>3</issue>):<fpage>18</fpage>–<lpage>22</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005362.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cohen</surname> <given-names>J</given-names></name>. <article-title>A Coefficient of Agreement for Nominal Scales</article-title>. <source>Educational and Psychological Measurement</source>. <year>1960</year>;<volume>20</volume>(<issue>1</issue>):<fpage>37</fpage>–<lpage>46</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1177/001316446002000104" xlink:type="simple">10.1177/001316446002000104</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Levenberg</surname> <given-names>K</given-names></name>. <article-title>A Method for the Solution of Certain Non-Linear Problems in Least Squares</article-title>. <source>Quarterly of Applied Mathematics</source>. <year>1944</year>;<volume>2</volume>:<fpage>164</fpage>–<lpage>168</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1090/qam/10666" xlink:type="simple">10.1090/qam/10666</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilson</surname> <given-names>JB</given-names></name>. <article-title>Methods for fitting dominance/diversity curves</article-title>. <source>Journal of Vegetation Science</source>. <year>1991</year>;<volume>2</volume>(<issue>1</issue>):<fpage>35</fpage>–<lpage>46</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/3235896" xlink:type="simple">10.2307/3235896</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref042">
<label>42</label>
<mixed-citation publication-type="other" xlink:type="simple">Oksanen, J, Blanchet, FG, Kindt, R, Legendre, P, Minchin, PR, O’Hara, RB, et al. vegan: Community Ecology Package; 2015. Available from: <ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=vegan" xlink:type="simple">http://CRAN.R-project.org/package=vegan</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005362.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Choi</surname> <given-names>NM</given-names></name>, <name name-style="western"><surname>Loguercio</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Verma-Gaur</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Degner</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Torkamani</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Su</surname> <given-names>AI</given-names></name>, <etal>et al</etal>. <article-title>Deep sequencing of the murine IgH repertoire reveals complex regulation of nonrandom V gene rearrangement frequencies</article-title>. <source>J Immunol</source>. <year>2013</year>;<volume>191</volume>(<issue>5</issue>):<fpage>2393</fpage>–<lpage>2402</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4049/jimmunol.1301279" xlink:type="simple">10.4049/jimmunol.1301279</ext-link></comment> <object-id pub-id-type="pmid">23898036</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Frock</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Du</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Meyers</surname> <given-names>RM</given-names></name>, <etal>et al</etal>. <article-title>Chromosomal Loop Domains Direct the Recombination of Antigen Receptor Genes</article-title>. <source>Cell</source>. <year>2015</year>;<volume>163</volume>(<issue>4</issue>):<fpage>947</fpage>–<lpage>959</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2015.10.016" xlink:type="simple">10.1016/j.cell.2015.10.016</ext-link></comment> <object-id pub-id-type="pmid">26593423</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Seifert</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Küppers</surname> <given-names>R</given-names></name>. <article-title>Molecular footprints of a germinal center derivation of human IgM+(IgD+)CD27+ B cells and the dynamics of memory B cell generation</article-title>. <source>J Exp Med</source>. <year>2009</year>;<volume>206</volume>(<issue>12</issue>):<fpage>2659</fpage>–<lpage>2669</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1084/jem.20091087" xlink:type="simple">10.1084/jem.20091087</ext-link></comment> <object-id pub-id-type="pmid">19917772</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fecteau</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Côté</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Néron</surname> <given-names>S</given-names></name>. <article-title>A new memory CD27-IgG+ B cell population in peripheral blood expressing VH genes with low frequency of somatic mutation</article-title>. <source>J Immunol</source>. <year>2006</year>;<volume>177</volume>(<issue>6</issue>):<fpage>3728</fpage>–<lpage>3736</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4049/jimmunol.177.6.3728" xlink:type="simple">10.4049/jimmunol.177.6.3728</ext-link></comment> <object-id pub-id-type="pmid">16951333</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jackson</surname> <given-names>KJL</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Collins</surname> <given-names>AM</given-names></name>. <article-title>Human immunoglobulin classes and subclasses show variability in VDJ gene mutation levels</article-title>. <source>Immunol Cell Biol</source>. <year>2014</year>;<volume>92</volume>(<issue>8</issue>):<fpage>729</fpage>–<lpage>733</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/icb.2014.44" xlink:type="simple">10.1038/icb.2014.44</ext-link></comment> <object-id pub-id-type="pmid">24913324</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cohen</surname> <given-names>JE</given-names></name>. <article-title>Alternate Derivations of a Species-Abundance Relation</article-title>. <source>The American Naturalist</source>. <year>1968</year>;<volume>102</volume>(<issue>924</issue>):<fpage>165</fpage>–<lpage>172</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1086/282533" xlink:type="simple">10.1086/282533</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sugihara</surname> <given-names>G</given-names></name>. <article-title>Minimal community structure: an explanation of species abundance patterns</article-title>. <source>American Naturalist</source>. <year>1980</year>;<volume>116</volume>(<issue>6</issue>):<fpage>770</fpage>–<lpage>787</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1086/283669" xlink:type="simple">10.1086/283669</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tokeshi</surname> <given-names>M</given-names></name>. <article-title>Niche apportionment or random assortment: species abundance patterns revisited</article-title>. <source>Journal of Animal Ecology</source>. <year>1990</year>;<volume>59</volume>:<fpage>1129</fpage>–<lpage>1146</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/5036" xlink:type="simple">10.2307/5036</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref051">
<label>51</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Cover</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>JA</given-names></name>. <source>Elements of information theory</source>. <edition>2nd ed</edition>. <publisher-name>Wiley</publisher-name>; <year>2006</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005362.ref052">
<label>52</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gardener</surname> <given-names>M</given-names></name>. <source>Community ecology: analytical methods using R and Excel</source>. <publisher-loc>Exeter</publisher-loc>: <publisher-name>Pelagic Publishing</publisher-name>; <year>2014</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005362.ref053">
<label>53</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>MacKinnon</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Phillipps</surname> <given-names>K</given-names></name>. <source>A field guide to the birds of Borneo, Sumatra, Java, and Bali: the Greater Sunda Islands</source>. <publisher-name>Oxford University Press</publisher-name>; <year>1993</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005362.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schloss</surname> <given-names>PD</given-names></name>, <name name-style="western"><surname>Gevers</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Westcott</surname> <given-names>SL</given-names></name>. <article-title>Reducing the effects of PCR amplification and sequencing artifacts on 16S rRNA-based studies</article-title>. <source>PLoS One</source>. <year>2011</year>;<volume>6</volume>(<issue>12</issue>):<fpage>e27310</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0027310" xlink:type="simple">10.1371/journal.pone.0027310</ext-link></comment> <object-id pub-id-type="pmid">22194782</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005362.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Degnan</surname> <given-names>PH</given-names></name>, <name name-style="western"><surname>Ochman</surname> <given-names>H</given-names></name>. <article-title>Illumina-based analysis of microbial community diversity</article-title>. <source>ISME J</source>. <year>2012</year>;<volume>6</volume>(<issue>1</issue>):<fpage>183</fpage>–<lpage>194</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ismej.2011.74" xlink:type="simple">10.1038/ismej.2011.74</ext-link></comment> <object-id pub-id-type="pmid">21677692</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>