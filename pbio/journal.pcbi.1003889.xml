<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-00766</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003889</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein structure</subject><subj-group><subject>Protein folding</subject><subject>Protein structure prediction</subject></subj-group></subj-group><subj-group><subject>Protein interactions</subject></subj-group></subj-group></subj-group><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject></subj-group></subj-group><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Artificial intelligence</subject><subj-group><subject>Machine learning</subject><subj-group><subject>Machine learning algorithms</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Computer and information sciences</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject></subj-group></subj-group><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Improved Contact Predictions Using the Recognition of Protein Like Contact Patterns</article-title>
<alt-title alt-title-type="running-head">Improved Contact Predictions Using PconsC2</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Skwark</surname><given-names>Marcin J.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Raimondi</surname><given-names>Daniele</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Michel</surname><given-names>Mirco</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Elofsson</surname><given-names>Arne</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Department of Biochemistry and Biophysics, Stockholm University, Stockholm, Sweden</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Science for Life Laboratory, Stockholm University, Solna, Sweden</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Department of Information and Computer Science, Aalto University, Aalto, Finland</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>Interuniversity Institute of Bioinformatics in Brussels, ULB-VUB, La Plaine Campus, Triomflaan, Brussels, Belgium</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Wei</surname><given-names>Guanghong</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Fudan University, China</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">arne@bioinfo.se</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: AE MJS DR. Performed the experiments: MJS DR MM. Analyzed the data: AE MJS DR MM. Contributed reagents/materials/analysis tools: MJS. Wrote the paper: AE MJS DR MM.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>11</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>6</day><month>11</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>11</issue>
<elocation-id>e1003889</elocation-id>
<history>
<date date-type="received"><day>1</day><month>5</month><year>2014</year></date>
<date date-type="accepted"><day>3</day><month>9</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Skwark et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article id="RA1" related-article-type="companion" ext-link-type="uri" page="e1002972" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pcbi.1002972"> <article-title>"New Methods Section in PLOS Computational Biology"</article-title></related-article>
<abstract>
<p>Given sufficient large protein families, and using a global statistical inference approach, it is possible to obtain sufficient accuracy in protein residue contact predictions to predict the structure of many proteins. However, these approaches do not consider the fact that the contacts in a protein are neither randomly, nor independently distributed, but actually follow precise rules governed by the structure of the protein and thus are interdependent. Here, we present PconsC2, a novel method that uses a deep learning approach to identify protein-like contact patterns to improve contact predictions. A substantial enhancement can be seen for all contacts independently on the number of aligned sequences, residue separation or secondary structure type, but is largest for <italic>β</italic>-sheet containing proteins. In addition to being superior to earlier methods based on statistical inferences, in comparison to state of the art methods using machine learning, PconsC2 is superior for families with more than 100 effective sequence homologs. The improved contact prediction enables improved structure prediction.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Here, we introduce a novel protein contact prediction method PconsC2 that, to the best of our knowledge, outperforms earlier methods. PconsC2 is based on our earlier method, PconsC, as it utilizes the same set of contact predictions from plmDCA and PSICOV. However, in contrast to PconsC, where each residue pair is analysed independently, the initial predictions are analysed in context of neighbouring residue pairs using a deep learning approach, inspired by earlier work. We find that for each layer the deep learning procedure improves the predictions. At the end, after five layers of deep learning and inclusion of a few extra features provides the best performance. An improvement can be seen for all types of proteins, independent on length, number of homologous sequences and structural class. However, the improvement is largest for <italic>β</italic>-sheet containing proteins. Most importantly the improvement brings for the first time sufficiently accurate predictions to some protein families with less than 1000 homologous sequences. PconsC2 outperforms as well state of the art machine learning based predictors for protein families larger than 100 effective sequences. PconsC2 is licensed under the GNU General Public License v3 and freely available from <ext-link ext-link-type="uri" xlink:href="http://c2.pcons.net/" xlink:type="simple">http://c2.pcons.net/</ext-link>.</p>
</abstract>
<funding-group><funding-statement>This work was supported by grants from the Swedish Research Council (VR-NT 2012-5046, VR-M 2010-3555), SSF (the Foundation for Strategic Research) and Vinnova through the Vinnova-JSP program, the EU 7'Th Framework Program by support to the EDICT project, contract No: FP7-HEALTH-F4-2007-201924. MJS has been funded by TranSys, a Marie Curie ITN (No FP7-PEOPLE-2007-ITN-215524) and The Academy of Finland (Finnish Centre of Excellence in Computational Inference Research COIN, 251170). DR is funded by Agency for Innovation by Science and Technology in Flanders (IWT). We acknowledge the computational resources provided by Aalto Science-IT project. Part of the computation was performed on resources provided by the Swedish National Infrastructure for Computing (SNIC). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="14"/></counts><custom-meta-group><custom-meta id="data-availability" xlink:type="simple"><meta-name>Data Availability</meta-name><meta-value>The authors confirm that all data underlying the findings are fully available without restriction. All data is found in the supplementary data (the list of files in our new set and their sequences).</meta-value></custom-meta></custom-meta-group></article-meta>
</front>
<body><disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods article.</p>
</disp-quote><sec id="s2">
<title>Introduction</title>
<p>De novo protein structure prediction is a long-standing problem in protein bioinformatics. For many years the focus was to develop methods that accurately describe the free energy landscape of a protein and then use a search strategy to identify the conformation with the lowest free energy. Using this strategy, methods based on fragment-based assembly of proteins can sometimes produce surprisingly accurate models, in particular for small <italic>α</italic>-helical proteins <xref ref-type="bibr" rid="pcbi.1003889-Bowie1">[1]</xref>-<xref ref-type="bibr" rid="pcbi.1003889-Jones1">[3]</xref>. In addition, molecular dynamics simulations can also accurately predict the structure of small fast folding proteins <xref ref-type="bibr" rid="pcbi.1003889-LindorffLarsen1">[4]</xref>. However, it is also clear that these methods are still not generally applicable to large-scale prediction of protein structures at high accuracy <xref ref-type="bibr" rid="pcbi.1003889-Piana1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1003889-Tai1">[6]</xref>. An alternative approach is to first predict which residues interact and then use these interactions to predict the structure of the protein <xref ref-type="bibr" rid="pcbi.1003889-Marks1">[7]</xref>.</p>
<p>Knowing which residues in a protein interact with each other provides sufficient information to predict the structure of a protein <xref ref-type="bibr" rid="pcbi.1003889-Levitt1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1003889-Vendruscolo1">[9]</xref>. However, until recently, contact predictions were not sufficiently accurate to significantly aid protein structure predictions <xref ref-type="bibr" rid="pcbi.1003889-Tress1">[10]</xref>. The most successful methods for contact predictions are based on identifying correlated mutations between pairs of residues <xref ref-type="bibr" rid="pcbi.1003889-Gobel1">[11]</xref>. The introduction of predictors using global models, inferring couplings between residues from the observed correlations, significantly increases the accuracy of co-variation based methods <xref ref-type="bibr" rid="pcbi.1003889-Giraud1">[12]</xref>-<xref ref-type="bibr" rid="pcbi.1003889-Burger1">[16]</xref>. For accurate prediction these global contact prediction methods depend on accurate multiple sequence alignments of thousand or even more homologous protein sequences, using alignments from methods such as HHblits <xref ref-type="bibr" rid="pcbi.1003889-Remmert1">[17]</xref> and jackhmmer <xref ref-type="bibr" rid="pcbi.1003889-Johnson1">[18]</xref>. It has been shown that these global contact prediction methods actually provide sufficient information for predicting the structure of proteins belonging to large protein families <xref ref-type="bibr" rid="pcbi.1003889-Marks1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1003889-Hopf1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1003889-Nugent1">[20]</xref>.</p>
<p>In addition to utilising correlated mutations, earlier contact prediction methods used various machine learning approaches to improve the predictions <xref ref-type="bibr" rid="pcbi.1003889-Fariselli1">[21]</xref>. In the first generation of these predictors every residue pair was considered independent from all other pairs. Here, features such as the amino acid type and conservation provided some improvement over only using the correlated mutations. In recent studies more complex machine learning algorithms have been used. These algorithms try to fully utilize the information, that can be inferred from the structure of a contact map using advanced machine learning methods including deep learning approaches <xref ref-type="bibr" rid="pcbi.1003889-Klepeis1">[22]</xref>-<xref ref-type="bibr" rid="pcbi.1003889-DiLena1">[26]</xref> or constraint satisfaction of rules describing protein like contacts maps using linear programming <xref ref-type="bibr" rid="pcbi.1003889-Wang1">[27]</xref>.</p>
<p>Deep learning is a sub-field of machine learning in which multiple layers of non-linear processing are used to learn nonlinear mappings and abstract complex features through the subsequent layers of the deep architecture, thereby obtaining a hierarchical abstraction of the input data <xref ref-type="bibr" rid="pcbi.1003889-Hinton1">[28]</xref>. The techniques falling under the collective name of deep learning, thanks to their ability to define higher-level concepts by learning a feature hierarchy, can efficiently handle some typical artificial intelligence problems including image and object recognition, natural language processing and computer vision <xref ref-type="bibr" rid="pcbi.1003889-Bengio1">[29]</xref>. In general, deep learning is very useful in structured learning problems including protein contact predictions <xref ref-type="bibr" rid="pcbi.1003889-DiLena2">[30]</xref>. To our knowledge, deep learning has not earlier been combined with the improved contact prediction obtained from statistical inference contact prediction methods. Furthermore, the method described here is different from earlier deep-learning approaches: our implementation is based on a feed-forward stack of random forests learners and not layers of Neural Networks, as in earlier implementations. Further higher-level abstraction of the data is geared towards the recognition of secondary structure visual patterns in contact maps and to iteratively refine the initial predictions.</p>
<p>The method is based on the fact that in proteins residue-residue contacts are often found in proximity of other contacts, while a non-contact is often found next to other non-contacts. In a 3×3 contact matrix with either a contact or a non-contact in the central position the frequency of contacts in the other positions differs significantly, see <xref ref-type="fig" rid="pcbi-1003889-g001">Figure 1</xref>. When a non-contact is present, the most frequent contact maps are the ones with none or only one contact present in the matrix. In contrast when a contact is present in the central position already the fifth most common contact map has three additional contacts and contacts maps with many contacts are more frequent, see <xref ref-type="fig" rid="pcbi-1003889-g001">Figure 1</xref>. Further, 98% of long-range contacting residues, compared to 30% for non-contacting pairs, are not isolated, i.e. contacts are found in the proximity of other contacts <xref ref-type="bibr" rid="pcbi.1003889-DiLena1">[26]</xref>.</p>
<fig id="pcbi-1003889-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003889.g001</object-id><label>Figure 1</label><caption>
<title>a) Relative frequencies of the number of contacts found in a 3×3contact map.</title>
<p>Solid line represents the cases where a contact is present in the central position and the dashed line where the central position is a non-contact. The X-axis shows the number of contacts within the window, while the Y-axis shows the frequency of all contact maps with this number of contacts. b) Illustration of the twelve most frequent 3×3 contact maps when the central pair is a contact (marked with a circle) or a non-contact. In both figures the data is derived from a randomly selected subset of PDB and contacts are defined as elsewhere in the paper, that is C-<italic>β</italic>-C-<italic>β</italic> distance less than 8 Å.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003889.g001" position="float" xlink:type="simple"/></fig>
<p>Moreover, the distribution of contacts follows characteristic patterns and recurring ones can be visually recognised and therefore used for constraining the prediction of nearby contacts. For instance if residues <italic>i</italic> and <italic>j</italic> in two <italic>α</italic>-helices are in contact, residues <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e001" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e002" xlink:type="simple"/></inline-formula> most likely will not be in contact. Contrary, a contact between residues <italic>i</italic> and <italic>j</italic> in two parallel <italic>β</italic>-strands implies strongly that the neighbouring residues, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e003" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e004" xlink:type="simple"/></inline-formula>, also are in contact.</p>
<p>Here, we show that a deep learning pattern recognition-based approach improves the accuracy significantly for all types of proteins, residue separations and numbers of homologous sequences. The obtained improvement is largest for <italic>β</italic>-sheet containing proteins, but exist for all type of proteins. Further, in comparison to state of the art other machine learning based methods contact prediction methods PconsC2 is superior for proteins with more than 100 effective sequence homologs.</p>
</sec><sec id="s3">
<title>Results</title>
<p>We recently developed PconsC, an ensemble method reconciling predictions across different contact inference methods and a range of multiple sequence alignments <xref ref-type="bibr" rid="pcbi.1003889-Skwark1">[31]</xref>. PconsC as well as PconsC2 are based on in total 16 contact predictions using a combination of HHblits <xref ref-type="bibr" rid="pcbi.1003889-Remmert1">[17]</xref> and jackhmmer <xref ref-type="bibr" rid="pcbi.1003889-Johnson1">[18]</xref> alignments with contact predictions from PSICOV <xref ref-type="bibr" rid="pcbi.1003889-Jones2">[32]</xref> and plmDCA <xref ref-type="bibr" rid="pcbi.1003889-Ekeberg1">[33]</xref>, see <xref ref-type="fig" rid="pcbi-1003889-g002">Figure 2</xref>. One limitation of PconsC, as well as all other global contact prediction methods, is that the processing of contacts is performed in isolation without considering nearby contacts. However, it was recently shown that such information could be utilised to improve contact predictions <xref ref-type="bibr" rid="pcbi.1003889-DiLena2">[30]</xref>, <xref ref-type="bibr" rid="pcbi.1003889-Eickholt2">[34]</xref>. Here, we present PconsC2 a deep learning based approach that considers nearby contacts and iteratively improves the contact predictions used in PconsC.</p>
<fig id="pcbi-1003889-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003889.g002</object-id><label>Figure 2</label><caption>
<title>a) Overview of the PconsC and PconsC2 pipelines.</title>
<p>For a query sequence; HHblits and jackhmmer are used to produce in total 8 multiple sequence alignments. In total 16 different contact maps are then produced using PSICOV and plmDCA. These are then fed into two different machine learning protocols, PconsC and PconsC2. In PconsC2 additional features are added and five layers of deep learning is applied. Predictions from PconsC and PconsC2 are shown to the right. b–d) An example on how the deep learning procedure used in PconsC2 improves predictions for the protein 1pcf:A. Each upper or lower triangle depicts the top <italic>L</italic> long-range predictions in a contact map predicted at one layer. Green dots represent correct predictions and red wrong predictions, while grey depicts true contacts. The values in the corners of the contact maps represent the fraction of correctly predicted contacts (PPV) within the top <italic>L</italic> long-range predictions. In this example the number of correct predictions doubles from the first to the last layer.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003889.g002" position="float" xlink:type="simple"/></fig>
<p>The development of PconsC2 was performed using five-fold cross-validation on 150 proteins reported in the PSICOV paper <xref ref-type="bibr" rid="pcbi.1003889-Jones2">[32]</xref>. Further testing and analysis performance was performed using 383 proteins not related to the training set and on all proteins from CASP10 <xref ref-type="bibr" rid="pcbi.1003889-Kryshtafovych1">[35]</xref>. The general features of the three sets are described in <xref ref-type="table" rid="pcbi-1003889-t001">Table 1</xref>. Two notable differences between the training set and the other sets are that some protein families in the test set have fewer homologous sequences and they neither are all strictly single domain non-interacting proteins.</p>
<table-wrap id="pcbi-1003889-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003889.t001</object-id><label>Table 1</label><caption>
<title>Properties of the three datasets.</title>
</caption><alternatives><graphic id="pcbi-1003889-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003889.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">PSICOV</td>
<td align="left" rowspan="1" colspan="1">New</td>
<td align="left" rowspan="1" colspan="1">CASP10</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Entries</td>
<td align="left" rowspan="1" colspan="1">150</td>
<td align="left" rowspan="1" colspan="1">383</td>
<td align="left" rowspan="1" colspan="1">114</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Median <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e005" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">1029</td>
<td align="left" rowspan="1" colspan="1">165</td>
<td align="left" rowspan="1" colspan="1">1224</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Median length</td>
<td align="left" rowspan="1" colspan="1">143 AA</td>
<td align="left" rowspan="1" colspan="1">161 AA</td>
<td align="left" rowspan="1" colspan="1">216 AA</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Part of complex</td>
<td align="left" rowspan="1" colspan="1">9%</td>
<td align="left" rowspan="1" colspan="1">70%</td>
<td align="left" rowspan="1" colspan="1">50%</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Multi-domain</td>
<td align="left" rowspan="1" colspan="1">0%</td>
<td align="left" rowspan="1" colspan="1">10%</td>
<td align="left" rowspan="1" colspan="1">22%</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>Median <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e006" xlink:type="simple"/></inline-formula> is the median number of effective sequences, computed by clustering sequences with identity above a pre-computed threshold. Part of complex is the fraction of proteins that are part of a complex according to PISA <xref ref-type="bibr" rid="pcbi.1003889-Krissinel1">[49]</xref>. Multi-domain is the fraction of proteins containing more than one Pfam domain <xref ref-type="bibr" rid="pcbi.1003889-Bateman1">[50]</xref>. Median resolution is the median resolution of crystal structures, where numbers in brackets indicate fraction of structures from NMR.</p></fn></table-wrap-foot></table-wrap><sec id="s3a">
<title>PconsC can be improved by using deep learning</title>
<p>First, we examined if a deep learning approach improves predictions using identical inputs as in PconsC <xref ref-type="bibr" rid="pcbi.1003889-Skwark1">[31]</xref>. PconsC and PconsC2 both use in total 16 predictions from PSICOV <xref ref-type="bibr" rid="pcbi.1003889-Jones2">[32]</xref> and plmDCA <xref ref-type="bibr" rid="pcbi.1003889-Ekeberg1">[33]</xref> created from 8 different alignments. In the first layer, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e007" xlink:type="simple"/></inline-formula>, the prediction yields basically the same performances as PconsC, but is substantially better than the individual predictions from PSICOV or plmDCA, see <xref ref-type="fig" rid="pcbi-1003889-g003">Figure 3a</xref>. The small difference in performance to PconsC is due to the fact that PconsC was trained on the closest distance between any two atoms in a residue and not the C<italic>β</italic>-C<italic>β</italic> contacts used here, and due to differences in the training, as well as inherent noise in the training of the underlying machine learning method.</p>
<fig id="pcbi-1003889-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003889.g003</object-id><label>Figure 3</label><caption>
<title>a) ROC plot depicting the PPV values for different predictors.</title>
<p>The x-axis represents the number of contact predictions in relationship to the length of the protein. At <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e008" xlink:type="simple"/></inline-formula> one prediction is included for each residue in each protein. The baselines are predictions from PSICOV (black), plmDCA (green) and PconsC (blue). Predictions from different layers in the deep learning procedure during training of PconsC2 are shown in red. The prediction at the first layer overlaps almost perfectly with prediction from PconsC. b) Impact of different sizes of the receptive field on prediction precision, measured at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e009" xlink:type="simple"/></inline-formula> contacts. The X-axis represents each layer in the deep learning procedure.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003889.g003" position="float" xlink:type="simple"/></fig>
<p>In layers <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e010" xlink:type="simple"/></inline-formula> the predictions performed in the previous layer are taken into consideration in the <italic>receptive field</italic>, providing information about the neighbourhood of predicted contacts around each residue pair. Already using a <italic>receptive field</italic> of the size 3×3 provides some improvement, see <xref ref-type="fig" rid="pcbi-1003889-g003">Figure 3b</xref>, but the improvement is more substantial for window sizes up to 11×11, which is therefore used below. It is notable, that the major improvements in the prediction accuracy appears already on the first two layers of deep learning, gradually levelling off at the subsequent ones, see <xref ref-type="fig" rid="pcbi-1003889-g003">Figure 3a</xref>. Using too many layers, the architecture becomes over-trained and starts to recognise and reconstruct the visual patterns of secondary structures, exaggerating the clustering of the predicted contacts, obtaining predictions without biological or structural meaning.</p>
<p>Using a window of 11×11 and five layers of deep learning and evaluating the predictions at one prediction per residue (L = 1), a common cutoff used in earlier studies, the relative improvement between first and last layer in PPV is 54% (18% in terms of absolute PPV), see <xref ref-type="table" rid="pcbi-1003889-t002">Table 2</xref>. In <xref ref-type="fig" rid="pcbi-1003889-g002">Figure 2</xref> it can be seen that the deep learning procedure efficiently filters out sporadic isolated predictions, while increasing the amount of predicted contacts between secondary structure elements.</p>
<table-wrap id="pcbi-1003889-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003889.t002</object-id><label>Table 2</label><caption>
<title>PPV using different inputs features.</title>
</caption><alternatives><graphic id="pcbi-1003889-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003889.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Features</td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e011" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e012" xlink:type="simple"/></inline-formula></td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">16 Predictions</td>
<td align="left" rowspan="1" colspan="1">0.57</td>
<td align="left" rowspan="1" colspan="1">0.67</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">16 Predictions + Separation</td>
<td align="left" rowspan="1" colspan="1">0.59</td>
<td align="left" rowspan="1" colspan="1">0.68</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">16 Predictions + SS</td>
<td align="left" rowspan="1" colspan="1">0.57</td>
<td align="left" rowspan="1" colspan="1">0.70</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">16 Predictions + PSSM</td>
<td align="left" rowspan="1" colspan="1">0.59</td>
<td align="left" rowspan="1" colspan="1">0.70</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">16 Predictions + RSA</td>
<td align="left" rowspan="1" colspan="1">0.59</td>
<td align="left" rowspan="1" colspan="1">0.71</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">16 Predictions + all features</td>
<td align="left" rowspan="1" colspan="1">0.61</td>
<td align="left" rowspan="1" colspan="1">0.73</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt102"><label/><p>Impact of different feature combinations on PPV values for first and fifth layer of deep learning.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s3b">
<title>Further improvement using additional features</title>
<p>Next, we examined if it was possible to further improve the accuracy by including additional features. Inspired by current literature, we included four different features: Separation of contacting residues in the sequence (Separation), predicted secondary structures of residues surrounding the potentially contacting residues (SS), predicted solvent accessible surface area (RSA) and sequence profiles in the form of PSSMs (PSSM). All features improve the accuracy with a few percentage points both at the first and final layer, see <xref ref-type="table" rid="pcbi-1003889-t002">Table 2</xref>. An additional small improvement can be obtained when combining all features. In total the improvement is 7–8% at the last layer in the deep learning procedure, see <xref ref-type="table" rid="pcbi-1003889-t002">Table 2</xref>. The final version of PconsC2 uses all features and the predictions are further analysed below using the independent dataset of 383 proteins.</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<p>To further evaluate the performance of PconsC2 to other methods we have used three different datasets, see <xref ref-type="table" rid="pcbi-1003889-t001">Table 1</xref>; First the 150 proteins from the PSICOV set used for training, secondly a completely independent dataset of 383 proteins not homologous to any protein in the training set and finally all proteins from CASP10. In the independent set the average number of homologous sequences is lower and therefore the average performance is lower as well, but the relative increase in performance from the training set is maintained. The performance analysis is done using predictions of one long-range contact per residue (L = 1, with sequence separation of at least 5 amino acids) for each protein in the test set. This is a common way to evaluate contact prediction methods and it has been shown that the relative performance differences are quite independent on the number of contacts tested <xref ref-type="bibr" rid="pcbi.1003889-Tress1">[10]</xref>. At <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e013" xlink:type="simple"/></inline-formula> the positive predictive values, PPV, precision, increases from 0.25 for the best single methods (plmDCA) to 0.29 for PconsC and to 0.44 for PconsC2.</p>
<sec id="s4a">
<title>PconsC2 improves predictions at all sequence separations</title>
<p>Contacts at different separation provide different types of information and the underlying contact prediction methods; plmDCA and PSICOV, behave quite differently in this aspect. Both methods predict a lower fraction of long-range contacts than observed in proteins, but PSICOV predicts more long-range contacts among its top-ranked predictions than plmDCA, see <xref ref-type="fig" rid="pcbi-1003889-g004">Figure 4</xref>. However, the accuracy of these long-range predictions is lower. And the reverse is true for short-range contacts (separated by less than 10 residues), here PSICOV predicts fewer but more accurate contacts. The distribution of predictions from PconsC is quite similar to the distribution from plmDCA, just with a higher accuracy.</p>
<fig id="pcbi-1003889-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003889.g004</object-id><label>Figure 4</label><caption>
<title>a) Performance of PconsC2 at different sequence separations compared to PconsC, plmDCA and PSICOV, considering top <italic>L</italic> contacts per protein.</title>
<p>Curves are smoothed with a rolling average window of 5 residues. b) Number of contacts predicted at different sequence separations. The read line represent the distribution of observed contacts in the dataset, normalised in so that the total number of contacts is identical to the number of predicted contacts.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003889.g004" position="float" xlink:type="simple"/></fig>
<p>The separation distribution for the top ranked contacts for PconsC2 resembles the distribution of contacts from PSICOV. However, the accuracy for contacts predicted by PconsC2 is higher and not strongly dependent on residue separation, see <xref ref-type="fig" rid="pcbi-1003889-g004">Figure 4</xref>. Both the increased accuracy of short-range contacts and in particular the increased number of long-range contacts should be useful for structure prediction, as accurately predicted long-range contacts contain more structural information.</p>
<p>In a comparison to other contact prediction methods PconsC2 exhibits greater accuracy at all sequence separations, but the performance improvement is most prominent for the contacts with sequence separation of 12 amino acids or more, see <xref ref-type="table" rid="pcbi-1003889-t003">Table 3</xref>. The improved accuracy is evident independent on the number of residues analysed, while the remaining results are consistent with performances reported previously in the literature <xref ref-type="bibr" rid="pcbi.1003889-Wang1">[27]</xref>.</p>
<table-wrap id="pcbi-1003889-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003889.t003</object-id><label>Table 3</label><caption>
<title>PPV values for contacts at different separations.</title>
</caption><alternatives><graphic id="pcbi-1003889-t003-3" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003889.t003" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Range</td>
<td align="left" rowspan="1" colspan="1">PconsC2</td>
<td align="left" rowspan="1" colspan="1">PconsC</td>
<td align="left" rowspan="1" colspan="1">PSICOV</td>
<td align="left" rowspan="1" colspan="1">plmDCA</td>
<td align="left" rowspan="1" colspan="1">MI</td>
<td align="left" rowspan="1" colspan="1">CMIr</td>
<td align="left" rowspan="1" colspan="1">CMAPpro</td>
<td align="left" rowspan="1" colspan="1">PhyCMAP</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Short (6–12)</td>
<td align="left" rowspan="1" colspan="1">0.53</td>
<td align="left" rowspan="1" colspan="1">0.34</td>
<td align="left" rowspan="1" colspan="1">0.30</td>
<td align="left" rowspan="1" colspan="1">0.31</td>
<td align="left" rowspan="1" colspan="1">0.08</td>
<td align="left" rowspan="1" colspan="1">0.16</td>
<td align="left" rowspan="1" colspan="1">0.49</td>
<td align="left" rowspan="1" colspan="1">0.50</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Medium (12–24)</td>
<td align="left" rowspan="1" colspan="1">0.56</td>
<td align="left" rowspan="1" colspan="1">0.41</td>
<td align="left" rowspan="1" colspan="1">0.33</td>
<td align="left" rowspan="1" colspan="1">0.37</td>
<td align="left" rowspan="1" colspan="1">0.09</td>
<td align="left" rowspan="1" colspan="1">0.20</td>
<td align="left" rowspan="1" colspan="1">0.44</td>
<td align="left" rowspan="1" colspan="1">0.44</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Long (24+)</td>
<td align="left" rowspan="1" colspan="1">0.55</td>
<td align="left" rowspan="1" colspan="1">0.46</td>
<td align="left" rowspan="1" colspan="1">0.37</td>
<td align="left" rowspan="1" colspan="1">0.41</td>
<td align="left" rowspan="1" colspan="1">0.09</td>
<td align="left" rowspan="1" colspan="1">0.19</td>
<td align="left" rowspan="1" colspan="1">0.37</td>
<td align="left" rowspan="1" colspan="1">0.35</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt103"><label/><p>Prediction accuracy at particular sequence separations taking into account L/10 predicted contacts in the class.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s4b">
<title>PconsC2 improvement is largest for <italic>β</italic>-sheets</title>
<p>The interaction patterns between different secondary structure elements vary significantly. In particular, parallel and anti-parallel <italic>β</italic>-sheets are easily recognisable in a contact map because of their dense visual patterns. On the other hand contacts between <italic>β</italic>-sheets are primarily mediated through backbone hydrogen bonds, suggesting that these might not be under the same co-evolutionary pressure as contacts mediated by sidechains, that is they might be harder to identify using methods based on co-variation of the sidechains. To analyse the effect of secondary structure, all proteins in the independent dataset were classified into their fold classes according to CATH <xref ref-type="bibr" rid="pcbi.1003889-Orengo1">[36]</xref>.</p>
<p>In <xref ref-type="table" rid="pcbi-1003889-t004">Table 4</xref> and <xref ref-type="fig" rid="pcbi-1003889-g005">Figure 5</xref> it can be seen that the improvement obtained by PconsC2 is largest for all <italic>β</italic> proteins and least for all <italic>α</italic> proteins. The overall performance is highest for the mixed <italic>α</italic>/<italic>β</italic> proteins followed by all <italic>β</italic> proteins.</p>
<fig id="pcbi-1003889-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003889.g005</object-id><label>Figure 5</label><caption>
<title>Positive predictive value plotted versus efficient number of sequences for predictions made by PSICOV, plmDCA, PconsC and PconsC2, considering top <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e014" xlink:type="simple"/></inline-formula> contacts per protein target.</title>
<p>Line: running average with frame size 20. (a) All proteins, (b) all-<italic>α</italic>-helical proteins (c) all- <italic>β</italic>-sheet proteins and (d) mixed <italic>α/β</italic>-proteins.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003889.g005" position="float" xlink:type="simple"/></fig><table-wrap id="pcbi-1003889-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003889.t004</object-id><label>Table 4</label><caption>
<title>PPV values at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e015" xlink:type="simple"/></inline-formula> for different protein structural classes.</title>
</caption><alternatives><graphic id="pcbi-1003889-t004-4" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003889.t004" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Structural class</td>
<td align="left" rowspan="1" colspan="1">No</td>
<td align="left" rowspan="1" colspan="1">PSICOV</td>
<td align="left" rowspan="1" colspan="1">plmDCA</td>
<td align="left" rowspan="1" colspan="1">PconsC</td>
<td align="left" rowspan="1" colspan="1">PconsC2</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">all <italic>α</italic></td>
<td align="left" rowspan="1" colspan="1">119</td>
<td align="left" rowspan="1" colspan="1">0.18</td>
<td align="left" rowspan="1" colspan="1">0.20</td>
<td align="left" rowspan="1" colspan="1">0.24</td>
<td align="left" rowspan="1" colspan="1">0.33</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>α/β</italic></td>
<td align="left" rowspan="1" colspan="1">159</td>
<td align="left" rowspan="1" colspan="1">0.27</td>
<td align="left" rowspan="1" colspan="1">0.31</td>
<td align="left" rowspan="1" colspan="1">0.36</td>
<td align="left" rowspan="1" colspan="1">0.53</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">all <italic>β</italic></td>
<td align="left" rowspan="1" colspan="1">98</td>
<td align="left" rowspan="1" colspan="1">0.21</td>
<td align="left" rowspan="1" colspan="1">0.21</td>
<td align="left" rowspan="1" colspan="1">0.25</td>
<td align="left" rowspan="1" colspan="1">0.40</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">few sec.str.</td>
<td align="left" rowspan="1" colspan="1">7</td>
<td align="left" rowspan="1" colspan="1">0.24</td>
<td align="left" rowspan="1" colspan="1">0.29</td>
<td align="left" rowspan="1" colspan="1">0.35</td>
<td align="left" rowspan="1" colspan="1">0.47</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">All</td>
<td align="left" rowspan="1" colspan="1">383</td>
<td align="left" rowspan="1" colspan="1">0.23</td>
<td align="left" rowspan="1" colspan="1">0.25</td>
<td align="left" rowspan="1" colspan="1">0.29</td>
<td align="left" rowspan="1" colspan="1">0.44</td>
</tr>
</tbody>
</table>
</alternatives></table-wrap>
<p>In <xref ref-type="table" rid="pcbi-1003889-t005">Table 5</xref> individual contacts between residues in different secondary structure elements are analysed. For all types of secondary structures PconsC2 produces more correct predictions than the other methods. However, due to its design, PconsC2 tends to over-emphasise contacts between secondary structures in comparison to the contacts involving loop regions. While the dataset contains only 22% of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e016" xlink:type="simple"/></inline-formula> long-range contacts, PconsC2 assigns 34% of its top-ranked predictions to this type of interaction. PconsC2 predicts more than twice as many <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e017" xlink:type="simple"/></inline-formula> contacts than any other method, while still maintaining a slightly higher accuracy. A similar but less pronounced effect can be observed for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e018" xlink:type="simple"/></inline-formula> contacts, where PconsC2 assigns 15% of its top ranked contacts to this class, although contacts comprise only 11% of the observed contacts. In contrast, contacts involving loop residues are less frequent among top ranked contacts. In particular contacts between loops and another secondary structure are only rarely predicted. However, thanks to the increased accuracy the number of correctly identified contacts is actually similar, or higher, for PconsC2 also for loop-loop contacts, highlighting the ability of PconsC2 to filter out false predictions.</p>
<table-wrap id="pcbi-1003889-t005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003889.t005</object-id><label>Table 5</label><caption>
<title>PPV values at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e019" xlink:type="simple"/></inline-formula> for contacts between different secondary structure classes.</title>
</caption><alternatives><graphic id="pcbi-1003889-t005-5" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003889.t005" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Structural category</td>
<td align="left" rowspan="1" colspan="1">Real</td>
<td align="left" rowspan="1" colspan="1">PSICOV</td>
<td align="left" rowspan="1" colspan="1">plmDCA</td>
<td align="left" rowspan="1" colspan="1">PconsC</td>
<td align="left" rowspan="1" colspan="1">PconsC2</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>α</italic> - <italic>α</italic></td>
<td align="left" rowspan="1" colspan="1">11%</td>
<td align="left" rowspan="1" colspan="1">0.23 (15%)</td>
<td align="left" rowspan="1" colspan="1">0.22 (17%)</td>
<td align="left" rowspan="1" colspan="1">0.28 (16%)</td>
<td align="left" rowspan="1" colspan="1">0.40 (15%)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>α</italic> - <italic>β</italic></td>
<td align="left" rowspan="1" colspan="1">8%</td>
<td align="left" rowspan="1" colspan="1">0.31 (9%)</td>
<td align="left" rowspan="1" colspan="1">0.46 (7%)</td>
<td align="left" rowspan="1" colspan="1">0.48 (8%)</td>
<td align="left" rowspan="1" colspan="1">0.54 (7%)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>α</italic> - loop</td>
<td align="left" rowspan="1" colspan="1">16%</td>
<td align="left" rowspan="1" colspan="1">0.18 (21%)</td>
<td align="left" rowspan="1" colspan="1">0.22 (21%)</td>
<td align="left" rowspan="1" colspan="1">0.27 (21%)</td>
<td align="left" rowspan="1" colspan="1">0.37 (13%)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>β</italic> - <italic>β</italic></td>
<td align="left" rowspan="1" colspan="1">22%</td>
<td align="left" rowspan="1" colspan="1">0.41 (13%)</td>
<td align="left" rowspan="1" colspan="1">0.51 (12%)</td>
<td align="left" rowspan="1" colspan="1">0.52 (13%)</td>
<td align="left" rowspan="1" colspan="1">0.57 (34%)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>β</italic> - loop</td>
<td align="left" rowspan="1" colspan="1">22%</td>
<td align="left" rowspan="1" colspan="1">0.20 (23%)</td>
<td align="left" rowspan="1" colspan="1">0.22 (21%)</td>
<td align="left" rowspan="1" colspan="1">0.26 (22%)</td>
<td align="left" rowspan="1" colspan="1">0.46 (16%)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">loop -loop</td>
<td align="left" rowspan="1" colspan="1">21%</td>
<td align="left" rowspan="1" colspan="1">0.19 (18%)</td>
<td align="left" rowspan="1" colspan="1">0.17 (22%)</td>
<td align="left" rowspan="1" colspan="1">0.24 (19%)</td>
<td align="left" rowspan="1" colspan="1">0.30 (16%)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">ALL</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">0.24</td>
<td align="left" rowspan="1" colspan="1">0.26</td>
<td align="left" rowspan="1" colspan="1">0.31</td>
<td align="left" rowspan="1" colspan="1">0.46</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt104"><label/><p>Accuracy in different structural categories considering top L contacts per protein. Percentage shows the relative fraction of predicted contacts in that category.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s4c">
<title>PconsC2 produce accurate contact predictions for smaller families</title>
<p>The success of statistical inference contact prediction methods, such as PSICOV and plmDCA, depends strongly on the availability of thousands of aligned sequences. Today the genome projects have already provided a sufficient number of homologous sequences for more than one hundred protein domain families <xref ref-type="bibr" rid="pcbi.1003889-Kamisetty1">[37]</xref>. In the future increased sequencing efforts will eventually expand the range of proteins for which these methods are applicable, thus increasing the number of potential prediction targets. However, as protein domain family sizes follow a power-law distribution <xref ref-type="bibr" rid="pcbi.1003889-Qian1">[38]</xref>, the vast majority of protein families may never reach the thousands of members that are needed for successful predictions. Therefore, it is of great importance to increase the accuracy of contact predictions for smaller protein families.</p>
<p>We examined to what extent PconsC2 could increase the performance for smaller families. Due to the way the input alignments are constructed, the total count of sequences in the alignment is not the most suitable metric for the information content, as a high number of close homologs do not provide as much co-variation as comparable number of more distantly related proteins. As suggested before a better measure is to use the number of efficient sequences to take redundancy into account <xref ref-type="bibr" rid="pcbi.1003889-Jones1">[32]</xref>.</p>
<p>In <xref ref-type="fig" rid="pcbi-1003889-g005">Figure 5</xref> it can be seen that PconsC2 maintains the superior predictive performance throughout the whole set of alignments, independently on the size of the protein families. It attains an average prediction precision of 0.40 for alignments as small as 100 efficient sequences. This is on par with the PPV values obtained for protein families with thousands of sequences using the other methods. In particular for all <italic>β</italic>-proteins the plateau performance is reached at a lower number of sequences than for earlier methods. Although the average PPV for PconsC2, as well as earlier statistical inference methods, depend strongly on the number of efficient sequences in the alignment it is clear that PPV values of 0.5 or even higher are reached even for protein families with fewer than 100 effective sequences, see <xref ref-type="fig" rid="pcbi-1003889-g005">Figure 5</xref>. If this performance could be pushed to all protein families of this size the usefulness of contact prediction methods for structure prediction would increase significantly.</p>
</sec><sec id="s4d">
<title>PconsC2 performs better than earlier predictors</title>
<p>In addition we compare PconsC2 to a set of alternative contact prediction methods, including mutual information (MI) and MI with phylogenetic correction (CMIr), and two recent machine learning based methods, PhyCMAP and CMAPpro.</p>
<p>In all three datasets PconsC2 shows a higher performance than all the other methods, see <xref ref-type="fig" rid="pcbi-1003889-g006">Figure 6a-c</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003889.s001">S1</xref>. At one prediction per residue, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e020" xlink:type="simple"/></inline-formula>, the PPV values of PconsC2 ranges from 0.75, in the PSICOV set to 0.5 in the independent dataset. In comparison plmDCA PPV values range from 0.5 to 0.25 and CMAPpro has PPV values of approximately 0.45 to 0.3. In all sets the PPV values are at least 0.1 units higher for PconsC2 than for the best of the other methods. The improvement exist for all sequence separations, see <xref ref-type="table" rid="pcbi-1003889-t003">Table 3</xref>.</p>
<fig id="pcbi-1003889-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003889.g006</object-id><label>Figure 6</label><caption>
<title>(a–c) ROC plot depicting the PPV values for different predictors.</title>
<p>The x-axis represents the number of contacts prediction in relationship to the length of the protein. At L = 1 on average one prediction is included for each residue in a protein. (a) Performance on the PSICOV set, (b) Performance on the new dataset, (c) Performance on the CASP10 dataset. (d–f) Positive predictive value plotted versus efficient number of sequences for predictions considering top <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e021" xlink:type="simple"/></inline-formula> contacts per protein. The lines show a running average and the red dots individual predictions by PconsC2.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003889.g006" position="float" xlink:type="simple"/></fig>
<p>Next, we compared the performance of the different methods given the number of effective sequences in the alignments. For PconsC and PconsC2, which use several multiple alignments, we used HHblits with an E-value cutoff <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e022" xlink:type="simple"/></inline-formula> as an estimation of the number of sequences. As has been reported before methods that use statistical inference show a strong dependency on family size with a strong increase in performance between 100 and 1000 effective sequences <xref ref-type="bibr" rid="pcbi.1003889-Morcos1">[39]</xref>. In contrast the performance of the machine learning methods is rather unaffected by the family size. As a consequence of this machine learning methods outperform all methods for families up to 100 effective sequences, and all methods except PconsC2 for families up to a few hundred effective sequences. However, these methods are clearly outperformed by all statistical inferences methods for large families.</p>
<p>There is a difference in performance on the PSICOV set versus the other two dataset given the same the number of effective, see <xref ref-type="fig" rid="pcbi-1003889-g006">Figure 6d-f</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003889.s001">S1</xref>. This difference is smaller for the machine learning based methods than for the correlated mutation based methods. In addition to having on average larger families the PSICOV dataset contains strictly single domain proteins, while the other sets contain both single and multi-domain proteins and proteins that are parts of large complexes, see <xref ref-type="table" rid="pcbi-1003889-t001">Table 1</xref>. The drop in performance is most likely caused by non-conserved domain-domain or protein-protein interactions. Further, accurate multiple sequence alignments of large multi-domain protein families is difficult.</p>
</sec><sec id="s4e">
<title>Good and bad examples</title>
<p>To highlight the behaviour of PconsC2 in comparison to PconsC we selected a few examples to highlight when PconsC2 significantly improves the predictions, see <xref ref-type="fig" rid="pcbi-1003889-g007">Figure 7</xref>.</p>
<fig id="pcbi-1003889-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003889.g007</object-id><label>Figure 7</label><caption>
<title>Contact maps for four proteins; (a) 1z4A and (b) 3znuG, (c) 1wigA and (d) 1imxA.</title>
<p>The upper-left triangle depicting the contact map predicted by PconsC, and lower-right triangle by PconsC2. Grey dots indicate the real, observed contacts in PDB structures, while coloured ones depict the contacts predicted by respective methods. Here red represent wrong predictions and green correct ones. The values in the corners of the contact maps represent the fraction of correctly predicted contacts within the top <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e023" xlink:type="simple"/></inline-formula> long-range predictions.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003889.g007" position="float" xlink:type="simple"/></fig>
<p>The first example, <italic>P. furiosus</italic> DNA polymerase sliding clamp (1iz4A), contains two DNA clamp domains, which are in a predominantly <italic>β</italic> conformation. In comparison to PconsC, PconsC2 filters out spurious short- and medium-range predictions, located at the domain termini. In addition, PconsC2 increases the predicted contact density in the <italic>β</italic>-sheet regions of both domains.</p>
<p>The second example, <italic>R. opacus 1CP</italic> chloromuconolactone dehalogenase ClcF (3znuG), is a homo-10-meric protein. Here, we only predict contacts within one chain and the prediction performance of PconsC is poorer (PPV = 0.18) than of the constituting methods (plmDCA, PPV = 0.39 and PSICOV PPV = 0.29). This is due to a limited overlap between the individual predictions, resulting in a nearly random distribution of predicted contacts. However, the use of additional information, as well as pattern recognition in PconsC2 allows for reconciling the conflicting predictions and attaining a better prediction than any of the individual methods (PPV = 0.56).</p>
<p>Obviously, there also exist proteins for which the PconsC2 methodology does not work and occasionally PconsC2 performs worse than PconsC. In general these cases can be divided into two categories. PconsC2 tends to perform badly, when the underlying predictors provide conflicting or low quality information. PconsC2 also sometimes fails when the deep learning methodology introduces artefacts into the contact map. We have paid close attention to reducing the amount of artefacts introduced by deep learning, which is one of the main reasons behind limiting the number of prediction layers.</p>
<p>The first example of PconsC2 failing with respect to PconsC is the LIM domain of RSGI RUH-019 (1wigA), which is a relatively short (73 amino acids) protein that contains few secondary structures. Here, PconsC2 produces a spurious cluster of predictions between the N- and C-termini, reducing the PPV from 0.49 to 0.40, see see <xref ref-type="fig" rid="pcbi-1003889-g007">Figure 7c</xref>.</p>
<p>The second example is the human insulin-like growth factor 1A (1imxA), for which neither PconsC nor PconsC2 make usable predictions. It is worth noting, that the contact patterns predicted by both approaches are quite different, with PconsC predicted contacts being more uniformly distributed along the sequence, while the PconsC2 attempts to create incorrect interactions between secondary structure elements, see <xref ref-type="fig" rid="pcbi-1003889-g007">Figure 7d</xref>.</p>
</sec><sec id="s4f">
<title>Using PconsC2 improves protein modelling</title>
<p>One of the ultimate goals of contact prediction is to facilitate <italic>ab-initio</italic> protein structure prediction. To test if the improved contact predictions from PconsC2 indeed are more useful for protein modelling, we built models for all proteins in the independent test set using both PconsC and PconsC2 predicted contacts, using the PconsFold pipeline <xref ref-type="bibr" rid="pcbi.1003889-Michel1">[40]</xref>. Models constructed using contacts predicted by PconsC2 are on average 9% better in terms of TM-score <xref ref-type="bibr" rid="pcbi.1003889-Zhang1">[41]</xref>, than those using contacts predicted by PconsC, see <xref ref-type="table" rid="pcbi-1003889-t006">Table 6</xref>. As expected from the PPV analysis the improvement is largest for <italic>β</italic>-sheet containing proteins, see <xref ref-type="table" rid="pcbi-1003889-t006">Table 6</xref>.</p>
<table-wrap id="pcbi-1003889-t006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003889.t006</object-id><label>Table 6</label><caption>
<title>Average TM-score of models generated with contacts from PconsC or PconsC2.</title>
</caption><alternatives><graphic id="pcbi-1003889-t006-6" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003889.t006" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Structural class</td>
<td align="left" rowspan="1" colspan="1">No</td>
<td align="left" rowspan="1" colspan="1">PconsC</td>
<td align="left" rowspan="1" colspan="1">PconsC2</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">all <italic>α</italic></td>
<td align="left" rowspan="1" colspan="1">119</td>
<td align="left" rowspan="1" colspan="1">0.36</td>
<td align="left" rowspan="1" colspan="1">0.39</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>α/β</italic></td>
<td align="left" rowspan="1" colspan="1">159</td>
<td align="left" rowspan="1" colspan="1">0.38</td>
<td align="left" rowspan="1" colspan="1">0.41</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">all <italic>β</italic></td>
<td align="left" rowspan="1" colspan="1">98</td>
<td align="left" rowspan="1" colspan="1">0.26</td>
<td align="left" rowspan="1" colspan="1">0.29</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">few sec.str.</td>
<td align="left" rowspan="1" colspan="1">7</td>
<td align="left" rowspan="1" colspan="1">0.33</td>
<td align="left" rowspan="1" colspan="1">0.35</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">All</td>
<td align="left" rowspan="1" colspan="1">383</td>
<td align="left" rowspan="1" colspan="1">0.34</td>
<td align="left" rowspan="1" colspan="1">0.37</td>
</tr>
</tbody>
</table>
</alternatives></table-wrap>
<p>The average quality increases with the effective number of sequences in the protein family, see <xref ref-type="fig" rid="pcbi-1003889-g008">Figure 8</xref>. However, the variation is also rather large, that is for some small families good models are generated, while for some large families the models are not optimal. The average improvement obtained by PconsC2 is quite constant for families with more than 50 effective sequences.</p>
<fig id="pcbi-1003889-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003889.g008</object-id><label>Figure 8</label><caption>
<title>(a) Comparison of the quality of models generated using the PconsFold pipeline <xref ref-type="bibr" rid="pcbi.1003889-Michel1">[40]</xref> and contacts predicted by either PconsC or PconsC2.</title>
<p>In PconsFold, Rosetta <xref ref-type="bibr" rid="pcbi.1003889-Levitt1">[2]</xref> is used together with predicted contacts from PconsC (blue) or PconsC2 (red). Each dot represents one model and the lines show the running average. The average TM-score for models generated with PconsC contacts is 0.34 vs. 0.37 for models generated using PconsC2. (b) Comparison of agreement with predicted contacts for the native structure and the top-ranked model. The colours of each dot represent the TM-score of the model. Dots below the diagonal line indicates that the model agrees worse with predicted contacts than the native structure, that is it should be possible to obtain better models given a more efficient modelling procedure.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003889.g008" position="float" xlink:type="simple"/></fig>
<p>One likely reason why the improvement of model qualities not is larger might be that our folding protocol cannot fully utilize the improved contacts. In <xref ref-type="fig" rid="pcbi-1003889-g008">Figure 8b</xref> it can be seen that for many of the proteins with best PPV values the predicted contacts are much better fulfilled by the native structure than by the top ranked model, that is the contact information is not fully utilised in our folding protocol, i.e. there is room for improvement.</p>
</sec><sec id="s4g">
<title>Final summary</title>
<p>Earlier statistical inference co-evolution based contact prediction methods assume independence between the couplings calculated among pairs of residues, but contacts in a protein contact map are neither randomly, nor independently distributed. Their distribution clearly follows characteristic patterns for certain types of interactions, e.g. hydrogen bonding ladders between <italic>β</italic>-sheets, which can be recognised. When a hypothetical contact is predicted between residue <italic>i</italic> and <italic>j</italic> it is intrinsically conditioned that the contact likelihood of – at least – the pairs of residues close to <italic>i</italic>, <italic>j</italic> are affected. Such rules have been used in other contact prediction methods, not using the statistical inference approach, either by satisfying specific constraints <xref ref-type="bibr" rid="pcbi.1003889-DiLena2">[27]</xref> or be using a deep learning approach <xref ref-type="bibr" rid="pcbi.1003889-LindorffLarsen1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1003889-Tai1">[26]</xref>. Here, we have developed a novel method, PconsC2, which uses a deep learning approach taking this information into account to improve contact predictions.</p>
<p>PconsC2 improves the prediction for all proteins and all types of contacts, but the improvement is most significant for <italic>β</italic>-sheet containing proteins. Perhaps most importantly, already at 100 effective sequence homologs the average prediction accuracy from PconsC2 rivals the maximum accuracies obtained from earlier methods and for larger families PconsC2 outperforms all methods. However, other machine learning approaches outperform PconsC2 for smaller families indicating room for improvement. The fact that PconsC2 predicts a larger fraction of contacts separated by many residues contributes to that models produced using contacts from PconsC2 instead of PconsC are on average 9% better.</p>
</sec></sec><sec id="s5" sec-type="methods">
<title>Methods</title>
<p>There exist different possible definitions for residue contacts. The most commonly used are based on C<italic>α</italic>-C<italic>α</italic>, C<italic>β</italic>-C<italic>β</italic> or the closest heavy atom distances in sidechains. The relative improvement of PconsC2 is independent on the definition and therefore we chose to present only the results using the same contact definition as used in CASP (Critical Assessment of protein Structure Prediction), that is C<italic>β</italic>-C<italic>β</italic>, C<italic>α</italic> for Glycine, distance between the amino-acids <sub>≤</sub>8Å <xref ref-type="bibr" rid="pcbi.1003889-Ezkurdia1">[42]</xref>.</p>
<sec id="s5a">
<title>Dataset</title>
<p>PconsC2 has been trained on a set of 150 non-large, single-domain proteins used for evaluation of PSICOV <xref ref-type="bibr" rid="pcbi.1003889-Jones1">[32]</xref> and used for evaluation of PconsC <xref ref-type="bibr" rid="pcbi.1003889-Bowie1">[31]</xref>. The intermediate results have been obtained using this set, with 5-fold cross validation, with regard to CATH superfamilies. The datasets are available from <xref ref-type="supplementary-material" rid="pcbi.1003889.s002">Table S1</xref> and <ext-link ext-link-type="uri" xlink:href="https://c2.pcons.net/" xlink:type="simple">https://c2.pcons.net/</ext-link>.</p>
<p>The final evaluation was conducted on a set of 383 proteins, which are not evolutionarily related to the proteins in the training set. This set was constructed starting from approximately 650 proteins of known structure, including proteins representing the most common folds. This set was then homology reduced to ensure that no protein in this set has detectable hits with E-value lower than 10<sup>−3</sup> to any of the proteins in the training set or the proteins in testing set. Homology reduction was done by a jackhmmer search against UniRef100. Finally proteins with very few homologs and not compact were rejected. We considered proteins to be not compact enough if they have a small amount of long-range contacts, long intrinsic disordered regions, or large unstructured termini.</p>
<p>For the CASP10 datasets all protein sequences were downloaded from the CASP website. Comparisons were performed both against the predictions submitted to CASP and by running all predictors again, taking into account increases in databases' size etc. An overview of the three datasets is presented in <xref ref-type="table" rid="pcbi-1003889-t001">Table 1</xref>.</p>
<sec id="s5a1">
<title>Effective sequence</title>
<p>The number of sequences included in an alignment can be used as a rough indicator of the expected accuracy of the contact predictions. However, a better correlation is obtained when effective number of aligned sequences is used, i.e taking the redundancy into account. Here, we have used the same definition as used in the PSICOV article <xref ref-type="bibr" rid="pcbi.1003889-Jones1">[32]</xref>, but other definitions provide very similar results. The effective number of aligned sequences is calculated as follows; First, the mean sequence identity (MeanID) is calculated for all sequences and then a similarity threshold is computed as:<disp-formula id="pcbi.1003889.e024"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003889.e024" xlink:type="simple"/></disp-formula></p>
<p>Then all sequences that have fewer than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e025" xlink:type="simple"/></inline-formula> differences are counted as a single sequence for the purpose of computing the number of sequences in the alignment.</p>
</sec><sec id="s5a2">
<title>Comparison to other methods</title>
<p>For benchmarking, predictions from PconsC2 are compared with predictions from a number of other methods. These can basically be divided into three groups, mutual information methods that only use mutual information, global information methods that infer the observed mutual information from estimated direct interactions, and machine learning based methods that use mutual information as well as other information to predict contacts.</p>
<p>Here, Mutual Information (MI) and Corrected Mutual Information (CMIr) are calculated using a freely available package developed by Bahar <xref ref-type="bibr" rid="pcbi.1003889-Bakan1">[43]</xref>, <xref ref-type="bibr" rid="pcbi.1003889-Liu1">[44]</xref>. Here, the alignment refinement removes any rows that have more than 20% gaps. CMIr is calculated using the average product correction <xref ref-type="bibr" rid="pcbi.1003889-Dunn1">[45]</xref>, which has been shown to improve residue contact predictions.</p>
<p>Further three statistical inference methods; plmDCA <xref ref-type="bibr" rid="pcbi.1003889-Simons1">[33]</xref>, PSICOV <xref ref-type="bibr" rid="pcbi.1003889-Jones1">[32]</xref> and PconsC <xref ref-type="bibr" rid="pcbi.1003889-Bowie1">[31]</xref> were also included in the benchmark. Prediction for PSICOV and plmDCA were based on the HHblits alignments with an E-value cutoff <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e026" xlink:type="simple"/></inline-formula>, as this provided the best performance. As described elsewhere PconsC and PconsC2 use predictions from plmDCA and PSICOV as inputs to their machine learning methods.</p>
<p>Finally, we also tested three machine learning based contact predictors; PhyCMAP <xref ref-type="bibr" rid="pcbi.1003889-DiLena2">[27]</xref>, CMAPpro <xref ref-type="bibr" rid="pcbi.1003889-Tai1">[26]</xref> and DNcon <xref ref-type="bibr" rid="pcbi.1003889-LindorffLarsen1">[25]</xref>. PhyCMAP uses mutual information as well as other constrains to construct an objective function <xref ref-type="bibr" rid="pcbi.1003889-DiLena2">[27]</xref>. In addition it utilizes linear physical constraints describing how contacts can be related to each other in a protein. The objective function is then optimised given the constraints using integer linear programming. This results in a physically feasible contact map. In CMAPpro and DNcon mutual information and other features are used to predict an initial contact map, this is then refined using a deep learning approach <xref ref-type="bibr" rid="pcbi.1003889-Tai1">[6]</xref>. Unfortunately, we did not manage to run all queries through DNcon website, but preliminary data for about 100 proteins did not indicate that it would perform better than CMAPpro or PhyCMAP. Therefore, at the end predictions were only compared with PhyCMAP, which was run locally, and CMAPpro, which was run through its website as a downloadable version is not available. It can be noted that although the performance of PconsC2 is superior to the other methods it is also significantly computationally more expensive.</p>
</sec></sec><sec id="s5b">
<title>Deep learning</title>
<p>The machine learning architecture implemented in this paper is inspired by deep learning literature in the sense that it is a feed-forward stack of learners, in which each layer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e027" xlink:type="simple"/></inline-formula> refines the predictions provided by the previous layer. Deep learning approaches are generally implemented through <italic>deep</italic> neural networks architectures (with many hidden layers of neurons) and are particularly useful in structured problems. It is because the hidden layers can learn and store complex <italic>higher level</italic> feature representations for the activation signals provided by the input layer, thus mimicking in a certain sense, the concept of high-level <italic>concepts</italic>. This behaviour can be extremely valuable for solving structured problems in which some high-level structure underlies the input data, such as image, speech and handwriting recognition. Deep learning architectures based on neural networks have some drawbacks: for example they are computationally demanding and require careful tuning <xref ref-type="bibr" rid="pcbi.1003889-Larochelle1">[46]</xref>. In this work we chose to lower the complexity of the machine learning procedure and architecture while preserving the ability to <italic>abstract</italic> higher level features from the data (the secondary structure visual patterns in the contact maps). We implemented a multilayer feed-forward stack of random forest learners, but in principle any machine learning algorithm could be used in each layer; for this reason, during the description of the architecture, we refer with the generic term of “learner” to the algorithm used in each layer.</p>
<p>Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e028" xlink:type="simple"/></inline-formula> be the feature vector representing the residue pair <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e029" xlink:type="simple"/></inline-formula>. These features are taken in input by the first layer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e030" xlink:type="simple"/></inline-formula> of the architecture, obtaining the predictions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e031" xlink:type="simple"/></inline-formula>. In the subsequent learning layers <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e032" xlink:type="simple"/></inline-formula>, for each residue pair <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e033" xlink:type="simple"/></inline-formula> the input consist of the feature vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e034" xlink:type="simple"/></inline-formula> plus a subset of the predictions of the previous layer. This subset represents the probabilities of contacts in the neighbourhood of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e035" xlink:type="simple"/></inline-formula>, named the <italic>receptive field</italic> <xref ref-type="bibr" rid="pcbi.1003889-Ekeberg1">[30]</xref>.</p>
<p>The approach described here is conceptually different from the one adopted by Di Lena et al. <xref ref-type="bibr" rid="pcbi.1003889-Ekeberg1">[30]</xref>. In particular, they used a 3-dimensional stack in which each layer is composed by many <italic>positional</italic> neural networks, one for each position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e036" xlink:type="simple"/></inline-formula> in the contact map. Our method is computationally less demanding as only one learner for each layer is used. In each layer the single learner handles all of the prediction of the entire contact maps regardless of the positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e037" xlink:type="simple"/></inline-formula>. The learner can still abstract complex features, such as the secondary structure patterns, from the receptive field.</p>
<p>The architecture can be described with the following recurrent formalisation:</p>
<list list-type="bullet"><list-item>
<p>Layer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e038" xlink:type="simple"/></inline-formula>: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e039" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>Layers <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e040" xlink:type="simple"/></inline-formula>: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e041" xlink:type="simple"/></inline-formula></p>
</list-item></list>
<p>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e042" xlink:type="simple"/></inline-formula> is the neighbourhood of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e043" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e044" xlink:type="simple"/></inline-formula> is the set containing all predictions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e045" xlink:type="simple"/></inline-formula> obtained from the layer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e046" xlink:type="simple"/></inline-formula>. The function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e047" xlink:type="simple"/></inline-formula> selects the receptive field and is defined as:</p>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e048" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e049" xlink:type="simple"/></inline-formula>.</p>
<p>Here, the receptive field is a square matrix of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e050" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e051" xlink:type="simple"/></inline-formula> pairs representing the predicted probability of a contact for the neighbouring residue pairs.</p>
</sec><sec id="s5c">
<title>PconsC2 is using Random Forests</title>
<p>During the development of PconsC2, we observed certain inherent characteristics of input data and the contact prediction problem, which can be summarised in the following three points:</p>
<list list-type="order"><list-item>
<p>The contact prediction problem requires the elaboration, for each <italic>L</italic>-residue long protein, of a number of vectors in the order of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e052" xlink:type="simple"/></inline-formula>, that is the machine learning method must efficiently handle large sets of data.</p>
</list-item><list-item>
<p>The number of contacts increases almost linearly with protein length, but since the number of possible contacts increases quadratically, the contact density of a protein decreases with the inverse of the protein length. This means that the set of vectors for training is heavily unbalanced.</p>
</list-item><list-item>
<p>The dataset (consisting of predictions from the single coevolution based methods) is quite noisy and might contain artefacts, as certain strong couplings detected by these methods may have arisen for reasons other than intra-chain spatial proximity.</p>
</list-item></list>
<p>We found, in spirit of PconsC <xref ref-type="bibr" rid="pcbi.1003889-Skwark1">[31]</xref>, that ensemble methods, in particular Random Forests, tend to result in most robust and accurate predictive models. This is likely due to the diversity among the learners, which allows for correcting the misclassifications of certain predictions.</p>
<p>In PconsC2 each layer of the deep learning architecture uses a Random Forest Classifier <xref ref-type="bibr" rid="pcbi.1003889-Pedregosa1">[47]</xref> with 100 trees and a minimum of 500 samples for any newly created leaf to avoid over fitting. These constraints have been introduced in order to build a forest with the greatest generalisation power possible.</p>
</sec><sec id="s5d">
<title>Receptive field</title>
<p>As described above, each layer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e053" xlink:type="simple"/></inline-formula> (with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e054" xlink:type="simple"/></inline-formula>) takes as input two different types of features, the <italic>ordinary features</italic> and the receptive field, concatenated. The ordinary features are identical for each residue pair in every layer, while the receptive field <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e055" xlink:type="simple"/></inline-formula> is a squared set of predictions centered in each couple of residues <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e056" xlink:type="simple"/></inline-formula>, with an area of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e057" xlink:type="simple"/></inline-formula> predictions obtained from the previous layer. As can be seen in <xref ref-type="fig" rid="pcbi-1003889-g003">Figure 3</xref> the prediction performance increases with increasing size of the receptive field. We chose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e058" xlink:type="simple"/></inline-formula>, giving a field size of 11×11, as the best compromise between prediction precision and performance.</p>
</sec><sec id="s5e">
<title>Feature encoding scheme</title>
<p>PconsC2 uses the same combination of predictions from PSICOV <xref ref-type="bibr" rid="pcbi.1003889-Jones2">[32]</xref> and plmDCA <xref ref-type="bibr" rid="pcbi.1003889-Ekeberg1">[33]</xref>, as PconsC. The results have been obtained, using four different E-value cut-offs (10<sup>−40</sup>, 10<sup>−10</sup>, 10<sup>−4</sup> and 1) to construct alignments by HHblits (from HHsuite 2.0.16) and jackhmmer from HMMER 3.0. The HHblits alignments used the bundled uniprot20_2013_03 database. Disabling both filtering the resulting MSA (-all parameter) and limiting the amount of sequences, that are allowed to pass the second pre-filter, as well as allowing for realigning all the hits in HHblits lead to the construction of the most information-rich and accurate alignment at cost of slightly increased running time. Jackhmmer alignments were constructed with UniRef100, based on UniProt 2013_06 release, with at most 5 rounds of iterative search and inclusion threshold (incE) set to the same value as the E-value threshold.</p>
<sec id="s5e1">
<title>Additional input features</title>
<p>In addition to the 16 contact predictions we examined the possibility to use additional information in the form of sequence separation, PSSMs as well as predicted structural features.</p>
<p>Sequence separation is the distance between amino acids in sequence space, or differently formulated, the absolute value of difference between amino acid indices.</p>
<p>For each protein in the dataset, a sequence profile starting from the MSA obtained with HHblits with E-value cut-off <sub>1</sub> was calculated. In the feature vector we represent each position <italic><sub>i</sub></italic> of the protein sequence with 21 real values, denoting the logarithm of ratio of frequency of an amino acid at this position to the background frequency of this amino acid in UniRef50. As the predictions take into account two positions in the sequence at the time, this results in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e059" xlink:type="simple"/></inline-formula> new dimensions in the feature vector. This feature is referred to as “PSSM” in <xref ref-type="table" rid="pcbi-1003889-t002">Table 2</xref>.</p>
<p>The secondary structure prediction was calculated feeding PSIPRED with the alignment obtained by running HHblits with E-value cut-off <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e060" xlink:type="simple"/></inline-formula> and filtered down to diversity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e061" xlink:type="simple"/></inline-formula> by <italic>hhfilter</italic>, as implemented in <italic>addss.pl</italic> script of HHsuite. The secondary structure prediction for each residue was encoded using a vector of probabilities for each of the structural classes (Helix, Strand, Coil). Here, we used a window of 9 residues (i-4, i+4) providing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e062" xlink:type="simple"/></inline-formula> new dimensions, referring to this feature as “SS”.</p>
<p>Predicted relative solvent accessibility information calculated with NetSurfP <xref ref-type="bibr" rid="pcbi.1003889-Petersen1">[48]</xref> was also used. Best performance was obtained using window size of 9 residues, encoding relative surface accessibility, Z-fit score (reliability value), plus probabilities for three secondary structure classes as predicted by NetSurfP (Helix, Strand and Coil). This results in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e063" xlink:type="simple"/></inline-formula> new dimensions in the feature vector, denoted as “RSA” in <xref ref-type="table" rid="pcbi-1003889-t002">Table 2</xref>.</p>
<p>The secondary structure features predicted by NetSurfP and PSIPRED may seem redundant, though methods used are not the same. Predictions by PSIPRED come at nearly negligible computational cost, as they use pre-computed alignments, whereas NetSurfP predictions come “free” with predicted RSA and the inclusion of both provided a slight improvement.</p>
<p>In summary, the additional features are:</p>
<list list-type="bullet"><list-item>
<p>PSICOV and plmDCA are, respectively, the 8 predictions from PSICOV and from plmDCA (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e064" xlink:type="simple"/></inline-formula> dimensions)</p>
</list-item><list-item>
<p>Separation is 1 dimension denoting the distance between amino acids in the sequence space</p>
</list-item><list-item>
<p>SS are the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e065" xlink:type="simple"/></inline-formula> dimensions representing the predicted Secondary Structure</p>
</list-item><list-item>
<p>PSSM are the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e066" xlink:type="simple"/></inline-formula> dimensions containing the sequence profiles calculated from HHblits alignment at E-value cut-off equal to 1</p>
</list-item><list-item>
<p>RSA are the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e067" xlink:type="simple"/></inline-formula> values used to represent the predicted relative surface accessibility, its confidence and predicted secondary structure.</p>
</list-item></list>
</sec></sec><sec id="s5f">
<title>Availability</title>
<p>PconsC2 is licensed under the Gnu Public License. The source code is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/ElofssonLab/PconsC2/" xlink:type="simple">https://github.com/ElofssonLab/PconsC2/</ext-link>. However, to run it a rather substantial set of other programs are needed, including plmDCA, Matlab, PSICOV, HHblits and jackhmmer. Therefore, we also provide iso-images containing all necessary tools and databases. We do also provide a web-server at <ext-link ext-link-type="uri" xlink:href="http://c2.pcons.net/" xlink:type="simple">http://c2.pcons.net/</ext-link>. Unfortunately given the computational costs involved in running PconsC2 the capacity of the web-server is somewhat limited.</p>
</sec></sec><sec id="s6">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003889.s001" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003889.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p>Figure analogous to <xref ref-type="fig" rid="pcbi-1003889-g006">Figure 6c and f</xref>, depicting performance of discussed methods on CASP10 proteins, including additional methods. (a) ROC plot depicting the PPV values for different predictors on the CASP10 dataset. The x-axis represents the number of contacts prediction in relationship to the length of the protein. At L = 1 on average one prediction is included for each residue in a protein. Performance. (b) Positive predictive value plotted versus efficient number of sequences for predictions considering top <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003889.e068" xlink:type="simple"/></inline-formula> contacts per protein. The lines show a running average and the red dots individual predictions by PconsC2.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003889.s002" mimetype="text/plain" xlink:href="info:doi/10.1371/journal.pcbi.1003889.s002" position="float" xlink:type="simple"><label>Table S1</label><caption>
<p>PDB IDs and sequences of the training- and testsets used in this study.</p>
<p>(TXT)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>DR is particularly grateful to Piero Fariselli for all the hints and suggestions, to Gabriele Orlando for the constructive discussions and to Anna Laura Mascagni for the support during the entire period. We are also grateful for valuable discussions with Debora S. Marks, Chris Sander, Erik Aurell and Sikander Hayat. We thank Nanjiang Shu for support setting up the web-server.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003889-Bowie1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bowie</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Eisenberg</surname><given-names>D</given-names></name> (<year>1994</year>) <article-title>An evolutionary approach to folding small alpha-helical proteins that uses sequence information and an empirical guiding fitness function</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>91</volume>: <fpage>4436</fpage>–<lpage>4440</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Simons1"><label>2</label>
<mixed-citation publication-type="other" xlink:type="simple">Simons K, Bonneau R, Ruczinski I, Baker D (1999) Ab initio protein structure prediction of CASP III targets using ROSETTA. Proteins Suppl 3: 171–176.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Jones1"><label>3</label>
<mixed-citation publication-type="other" xlink:type="simple">Jones D (2001) Predicting novel protein folds by using FRAGFOLD. Proteins Suppl 5: 127–132.</mixed-citation>
</ref>
<ref id="pcbi.1003889-LindorffLarsen1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lindorff-Larsen</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Piana</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Dror</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Shaw</surname><given-names>D</given-names></name> (<year>2011</year>) <article-title>How fast-folding proteins fold</article-title>. <source>Science</source> <volume>334</volume>: <fpage>517</fpage>–<lpage>520</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Piana1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Piana</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Klepeis</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Shaw</surname><given-names>D</given-names></name> (<year>2014</year>) <article-title>Assessing the accuracy of physical models used in protein-folding simulations: quantitative evidence from long molecular dynamics simulations</article-title>. <source>Curr Opin Struct Biol</source> <volume>24C</volume>: <fpage>98</fpage>–<lpage>105</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Tai1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tai</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Bai</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Taylor</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>B</given-names></name> (<year>2014</year>) <article-title>Assessment of template-free modeling in CASP10 and ROLL</article-title>. <source>Proteins</source> <volume>82</volume> <supplement>Suppl 2</supplement><fpage>57</fpage>–<lpage>83</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Marks1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marks</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Colwell</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Sheridan</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Hopf</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Pagnani</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Protein 3d structure computed from evolutionary sequence variation</article-title>. <source>PLoS One</source> <volume>6</volume>: <fpage>e28766</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Levitt1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Levitt</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Warshel</surname><given-names>A</given-names></name> (<year>1975</year>) <article-title>Computer simulation of protein folding</article-title>. <source>Nature</source> <volume>253</volume>: <fpage>694</fpage>–<lpage>698</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Vendruscolo1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vendruscolo</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Kussell</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Domany</surname><given-names>E</given-names></name> (<year>1997</year>) <article-title>Recovery of protein structure from contact maps</article-title>. <source>Fold Des</source> <volume>2</volume>: <fpage>295</fpage>–<lpage>306</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Tress1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tress</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name> (<year>2010</year>) <article-title>Predicted residue-residue contacts can help the scoring of 3d models</article-title>. <source>Proteins</source> <volume>78</volume>: <fpage>1980</fpage>–<lpage>1991</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Gobel1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gobel</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Sander</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Schneider</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name> (<year>1994</year>) <article-title>Correlated mutations and residue contacts in proteins</article-title>. <source>Proteins</source> <volume>18</volume>: <fpage>309</fpage>–<lpage>317</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Giraud1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Giraud</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Heumann</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Lapedes</surname><given-names>A</given-names></name> (<year>1999</year>) <article-title>Superadditive correlation</article-title>. <source>Phys Rev E Stat Phys Plasmas Fluids Relat Interdiscip Topics</source> <volume>59</volume>: <fpage>4983</fpage>–<lpage>4991</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Lapedes1"><label>13</label>
<mixed-citation publication-type="other" xlink:type="simple">Lapedes AS, Liu C L, Stormo G D (1999) Correlated mutations in models of protein sequences:phylogenetic and structural effects. In: Proceedings of the IMS/AMS International Conference on Statistics in Molecular Biology and Genetics. Hayward CA, Monograph Series of the Inst. for Mathematical Statistics, pp.236–256.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Lapedes2"><label>14</label>
<mixed-citation publication-type="other" xlink:type="simple">Lapedes A, Giraud B, Jarzynski C (2012) Using Sequence Alignments to Predict Protein Structure and Stability with High Accuracy. ArXiv e-prints.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Weigt1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weigt</surname><given-names>M</given-names></name>, <name name-style="western"><surname>White</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Szurmant</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Hoch</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name> (<year>2009</year>) <article-title>Identification of direct residue contacts in protein-protein interaction by message passing</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>106</volume>: <fpage>67</fpage>–<lpage>72</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Burger1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Burger</surname><given-names>L</given-names></name>, <name name-style="western"><surname>van Nimwegen</surname><given-names>E</given-names></name> (<year>2010</year>) <article-title>Disentangling direct from indirect co-evolution of residues in protein alignments</article-title>. <source>PLoS Comput Biol</source> <volume>6</volume>: <fpage>e1000633</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Remmert1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Remmert</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Biegert</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Hauser</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Soding</surname><given-names>J</given-names></name> (<year>2012</year>) <article-title>HHblits: lightning-fast iterative protein sequence searching by HMM-HMM alignment</article-title>. <source>Nat Methods</source> <volume>9</volume>: <fpage>173</fpage>–<lpage>175</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Johnson1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Johnson</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Eddy</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Portugaly</surname><given-names>E</given-names></name> (<year>2010</year>) <article-title>Hidden markov model speed heuristic and iterative HMM search procedure</article-title>. <source>BMC Bioinformatics</source> <volume>11</volume>: <fpage>431</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Hopf1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hopf</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Colwell</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Sheridan</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Rost</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Sander</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Three-dimensional structures of membrane proteins from genomic sequencing</article-title>. <source>Cell</source> <volume>149</volume>: <fpage>1607</fpage>–<lpage>1621</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Nugent1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nugent</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Jones</surname><given-names>DT</given-names></name> (<year>2012</year>) <article-title>Accurate de novo structure prediction of large transmembrane protein domains using fragment-assembly and correlated mutation analysis</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>109</volume>: <fpage>E1540</fpage>–<lpage>1547</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Fariselli1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fariselli</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Olmea</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Valencia</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Casadio</surname><given-names>R</given-names></name> (<year>2001</year>) <article-title>Prediction of contact maps with neural networks and correlated mutations</article-title>. <source>Protein Eng</source> <volume>14</volume>: <fpage>835</fpage>–<lpage>843</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Klepeis1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Klepeis</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Floudas</surname><given-names>C</given-names></name> (<year>2003</year>) <article-title>ASTRO-FOLD: a combinatorial and global optimization framework for ab initio prediction of three-dimensional structures of proteins from the amino acid sequence</article-title>. <source>Biophys J</source> <volume>85</volume>: <fpage>2119</fpage>–<lpage>2146</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Subramani1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Subramani</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Wei</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Floudas</surname><given-names>C</given-names></name> (<year>2012</year>) <article-title>ASTRO-FOLD 2.0: an enhanced framework for protein structure prediction</article-title>. <source>AIChE J</source> <volume>58</volume>: <fpage>1619</fpage>–<lpage>1637</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Pollastri1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pollastri</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Baldi</surname><given-names>P</given-names></name> (<year>2002</year>) <article-title>Prediction of contact maps by GIOHMMs and recurrent neural networks using lateral propagation from all four cardinal corners</article-title>. <source>Bioinformatics</source> <volume>18</volume> <supplement>Suppl 1</supplement><fpage>S62</fpage>–<lpage>70</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Eickholt1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eickholt</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Cheng</surname><given-names>J</given-names></name> (<year>2012</year>) <article-title>Predicting protein residue-residue contacts using deep networks and boosting</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>3066</fpage>–<lpage>3072</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-DiLena1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Di Lena</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Nagata</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Baldi</surname><given-names>P</given-names></name> (<year>2012</year>) <article-title>Deep architectures for protein contact map prediction</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>2449</fpage>–<lpage>2457</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Wang1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Xu</surname><given-names>J</given-names></name> (<year>2013</year>) <article-title>Predicting protein contact map using evolutionary and physical constraints by integer programming</article-title>. <source>Bioinformatics</source> <volume>29</volume>: <fpage>i266</fpage>–<lpage>73</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Hinton1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hinton</surname><given-names>GE</given-names></name> (<year>2007</year>) <article-title>Learning multiple layers of representation</article-title>. <source>Trends in cognitive sciences</source> <volume>11</volume>: <fpage>428</fpage>–<lpage>434</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Bengio1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bengio</surname><given-names>Y</given-names></name> (<year>2009</year>) <article-title>Learning deep architectures for ai</article-title>. <source>Foundations and trends in Machine Learning</source> <volume>2</volume>: <fpage>1</fpage>–<lpage>127</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-DiLena2"><label>30</label>
<mixed-citation publication-type="other" xlink:type="simple">Di Lena P, Baldi P, Nagata K (2012) Deep spatio-temporal architectures and learning for protein structure prediction. In: Advances in Neural Information Processing Systems 25. pp.521–529.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Skwark1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Skwark</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Abdel-Rehim</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Elofsson</surname><given-names>A</given-names></name> (<year>2013</year>) <article-title>PconsC: Combination of direct information methods and alignments improves contact prediction. Bioinformatics</article-title>. <volume>29</volume>: <fpage>1815</fpage>–<lpage>6</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Jones2"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jones</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Buchan</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Cozzetto</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Pontil</surname><given-names>M</given-names></name> (<year>2012</year>) <article-title>PSICOV: precise structural contact prediction using sparse inverse covariance estimation on large multiple sequence alignments</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>184</fpage>–<lpage>190</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Ekeberg1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ekeberg</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Lovkvist</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Lan</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Weigt</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Aurell</surname><given-names>E</given-names></name> (<year>2013</year>) <article-title>Improved contact prediction in proteins: Using pseudolikelihoods to infer Potts models</article-title>. <source>Phys Rev E Stat Nonlin Soft Matter Phys</source> <volume>87</volume>: <fpage>012707</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Eickholt2"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eickholt</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Cheng</surname><given-names>J</given-names></name> (<year>2013</year>) <article-title>A study and benchmark of DNcon: a method for protein residue-residue contact prediction using deep networks</article-title>. <source>BMC Bioinformatics</source> <volume>14</volume> <supplement>Suppl 14</supplement><fpage>S12</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Kryshtafovych1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kryshtafovych</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Fidelis</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Moult</surname><given-names>J</given-names></name> (<year>2014</year>) <article-title>CASP10 results compared to those of previous CASP experiments</article-title>. <source>Proteins</source> <volume>82</volume> <supplement>Suppl 2</supplement><fpage>164</fpage>–<lpage>174</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Orengo1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Orengo</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Michi</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Jones</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Jones</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Swindels</surname><given-names>MB</given-names></name>, <etal>et al</etal>. (<year>1997</year>) <article-title>Cath - a hierarchical classification of protein domain structures</article-title>. <source>Structure</source> <volume>5</volume>: <fpage>1093</fpage>–<lpage>1108</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Kamisetty1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kamisetty</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Ovchinnikov</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Baker</surname><given-names>D</given-names></name> (<year>2013</year>) <article-title>Assessing the utility of coevolution-based residue-residue contact predictions in a sequence- and structure-rich era</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>110</volume>: <fpage>15674</fpage>–<lpage>15679</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Qian1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Qian</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Luscombe</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Gerstein</surname><given-names>M</given-names></name> (<year>2001</year>) <article-title>Protein family and fold occurrence in genomes: power-law behaviour and evolutionary model</article-title>. <source>J Mol Biol</source> <volume>313</volume>: <fpage>673</fpage>–<lpage>681</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Morcos1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morcos</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Pagnani</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Lunt</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Bertolino</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Marks</surname><given-names>DS</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>108</volume>: <fpage>E1293</fpage>–<lpage>1301</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Michel1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Michel</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hayat</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Skwark</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Sander</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Marks</surname><given-names>DS</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Pconsfold: Improved contact predictions improve protein models</article-title>. <source>Bioinformatics</source> <volume>30</volume>: <fpage>i482</fpage>–<lpage>8</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Zhang1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Skolnick</surname><given-names>J</given-names></name> (<year>2004</year>) <article-title>Scoring function for automated assessment of protein structure template quality</article-title>. <source>Proteins</source> <volume>57</volume>: <fpage>702</fpage>–<lpage>710</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Ezkurdia1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ezkurdia</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Grana</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Izarzugaza</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Tress</surname><given-names>M</given-names></name> (<year>2009</year>) <article-title>Assessment of domain boundary predictions and the prediction of intramolecular contacts in CASP8</article-title>. <source>Proteins</source> <volume>77</volume> <supplement>Suppl 9</supplement><fpage>196</fpage>–<lpage>209</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Bakan1"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bakan</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Meireles</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Bahar</surname><given-names>I</given-names></name> (<year>2011</year>) <article-title>Prody: protein dynamics inferred from theory and experiments</article-title>. <source>Bioinformatics</source> <volume>27</volume>: <fpage>1575</fpage>–<lpage>1577</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Liu1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Bahar</surname><given-names>I</given-names></name> (<year>2012</year>) <article-title>Sequence evolution correlates with structural dynamics</article-title>. <source>Mol Biol Evol</source> <volume>29</volume>: <fpage>2253</fpage>–<lpage>2263</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Dunn1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dunn</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Wahl</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Gloor</surname><given-names>G</given-names></name> (<year>2008</year>) <article-title>Mutual information without the influence of phylogeny or entropy dramatically improves residue contact prediction</article-title>. <source>Bioinformatics</source> <volume>24</volume>: <fpage>333</fpage>–<lpage>340</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Larochelle1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Larochelle</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Y</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Louradour</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Lamblin</surname><given-names>P</given-names></name> (<year>2009</year>) <article-title>Exploring strategies for training deep neural networks</article-title>. <source>J Mach Learn Res</source> <volume>10</volume>: <fpage>1</fpage>–<lpage>40</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Pedregosa1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pedregosa</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Varoquaux</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Gramfort</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Michel</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Thirion</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Scikit-learn: Machine learning in python</article-title>. <source>Journal of Machine Learning Research</source> <volume>12</volume>: <fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Petersen1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Petersen</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Petersen</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Andersen</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Nielsen</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Lundegaard</surname><given-names>C</given-names></name> (<year>2009</year>) <article-title>A generic method for assignment of reliability scores applied to solvent accessibility predictions</article-title>. <source>BMC Struct Biol</source> <volume>9</volume>: <fpage>51</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Krissinel1"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Krissinel</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Henrick</surname><given-names>K</given-names></name> (<year>2007</year>) <article-title>Inference of macromolecular assemblies from crystalline state</article-title>. <source>J Mol Biol</source> <volume>372</volume>: <fpage>774</fpage>–<lpage>797</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003889-Bateman1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bateman</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Birney</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Cerruti</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Etwiller</surname><given-names>L</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title>The pfam protein families database</article-title>. <source>Nucleic Acids Res</source> <volume>30</volume>: <fpage>276</fpage>–<lpage>280</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>