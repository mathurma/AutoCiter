<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-00016</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003467</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology</subject><subj-group><subject>Computational biology</subject></subj-group><subj-group><subject>Developmental biology</subject><subj-group><subject>Pattern formation</subject></subj-group></subj-group><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject><subj-group><subject>DNA transcription</subject></subj-group></subj-group><subj-group><subject>Molecular genetics</subject><subj-group><subject>Gene regulation</subject></subj-group></subj-group></subj-group><subj-group><subject>Model organisms</subject><subj-group><subject>Animal models</subject><subj-group><subject>Drosophila melanogaster</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Computer science</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Quantitative Modeling of a Gene's Expression from Its Intergenic Sequence</article-title>
<alt-title alt-title-type="running-head">Gene Expression Modeling from Intergenic Locus</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Samee</surname><given-names>Md. Abul Hassan</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Sinha</surname><given-names>Saurabh</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Department of Computer Science, University of Illinois at Urbana-Champaign, Urbana, Illinois, United States of America</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Institute for Genomic Biology, University of Illinois at Urbana-Champaign, Urbana, Illinois, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Tanay</surname><given-names>Amos</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Weizmann Institute of Science, Israel</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">samee1@illinois.edu</email> (MAHS); <email xlink:type="simple">sinhas@illinois.edu</email> (SS)</corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: MAHS SS. Performed the experiments: MAHS. Analyzed the data: MAHS SS. Contributed reagents/materials/analysis tools: MAHS. Wrote the paper: MAHS SS.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>3</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>6</day><month>3</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>3</issue>
<elocation-id>e1003467</elocation-id>
<history>
<date date-type="received"><day>26</day><month>12</month><year>2012</year></date>
<date date-type="accepted"><day>18</day><month>12</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Samee, Sinha</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Modeling a gene's expression from its intergenic locus and trans-regulatory context is a fundamental goal in computational biology. Owing to the distributed nature of cis-regulatory information and the poorly understood mechanisms that integrate such information, gene locus modeling is a more challenging task than modeling individual enhancers. Here we report the first quantitative model of a gene's expression pattern as a function of its locus. We model the expression readout of a locus in two tiers: 1) combinatorial regulation by transcription factors bound to each enhancer is predicted by a thermodynamics-based model and 2) independent contributions from multiple enhancers are linearly combined to fit the gene expression pattern. The model does not require any prior knowledge about enhancers contributing toward a gene's expression. We demonstrate that the model captures the complex multi-domain expression patterns of anterior-posterior patterning genes in the early Drosophila embryo. Altogether, we model the expression patterns of 27 genes; these include several gap genes, pair-rule genes, and anterior, posterior, trunk, and terminal genes. We find that the model-selected enhancers for each gene overlap strongly with its experimentally characterized enhancers. Our findings also suggest the presence of sequence-segments in the locus that would contribute ectopic expression patterns and hence were “shut down” by the model. We applied our model to identify the transcription factors responsible for forming the stripe boundaries of the studied genes. The resulting network of regulatory interactions exhibits a high level of agreement with known regulatory influences on the target genes. Finally, we analyzed whether and why our assumption of enhancer independence was necessary for the genes we studied. We found a deterioration of expression when binding sites in one enhancer were allowed to influence the readout of another enhancer. Thus, interference between enhancer activities was a possible factor necessitating enhancer independence in our model.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Quantitative modeling of gene expression from DNA sequences and regulatory inputs underpin our studies of gene regulation. The existing literature focuses on modeling parts of a gene's expression pattern from its experimentally characterized “enhancers”, which are ∼1 Kbp long sequences, often located in the gene's intergenic region or “locus.” However, a far-reaching goal is to model all aspects of a gene's expression based on the genome sequence, without prior knowledge of enhancers. With this motivation, we have developed a model that maps a gene's locus and cellular context to its expression in that context. Using this model, we study the regulation of 27 genes having complex expression patterns in the <italic>Drosophila</italic> embryo. Our findings suggest the presence of sequence segments that can irreconcilably distort the gene's expression pattern and thus have to be “shut-down” by the model. We also apply the model to identify the transcription factors forming the stripe boundaries of the studied genes; and our results agree remarkably with experimental findings of decades of work. Finally, we develop a new method to analyze if and why multiple segments influencing a gene's expression need to avoid interaction between themselves.</p>
</abstract>
<funding-group><funding-statement>This work was supported by NIH grant 1R01GM085233 (SS), NSF CAREER grant 0746303 (SS), and NSF Award 1136913: “EFRI-MIKS: Multiscale Analysis of Morphogen Gradients” (SS). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="21"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Gene regulation is key to understanding of a variety of biological processes ranging from development <xref ref-type="bibr" rid="pcbi.1003467-Davidson1">[1]</xref> to disease <xref ref-type="bibr" rid="pcbi.1003467-Epstein1">[2]</xref>. Transcriptional regulation is one of the best studied stages of gene regulation <xref ref-type="bibr" rid="pcbi.1003467-Courey1">[3]</xref>, especially in the context of developmental biology <xref ref-type="bibr" rid="pcbi.1003467-White1">[4]</xref>. Studies of early embryonic development in <italic>Drosophila</italic> <xref ref-type="bibr" rid="pcbi.1003467-Schroeder1">[5]</xref> have revealed the roles of various transcription factors (TFs) in setting up precise spatio-temporal gene expression patterns, and delineated many “enhancers” (also called “cis-regulatory modules” or “CRMs”) that mediate the activities of combinations of TFs. We have today a fairly detailed knowledge of the transcriptional regulatory network involved in patterning of the anterior-posterior (A/P) and dorso-ventral (D/V) axes in the blastoderm-stage <italic>Drosophila</italic> embryo <xref ref-type="bibr" rid="pcbi.1003467-DePamphilis1">[6]</xref>–<xref ref-type="bibr" rid="pcbi.1003467-Arnosti1">[8]</xref>. This knowledge has spurred the development of quantitative models of gene regulation that aim to map the sequence of a given enhancer to the expression pattern driven by that enhancer <xref ref-type="bibr" rid="pcbi.1003467-Bintu1">[9]</xref>–<xref ref-type="bibr" rid="pcbi.1003467-Gertz1">[17]</xref>. These models attempt to (1) predict the strength of TF binding to sites within the enhancer by using data on TF concentration and binding specificity, and (2) integrate the predicted binding strengths of multiple TFs into a quantitative prediction of that enhancer's contribution to gene expression. The prediction may vary from one cell type to another, as TF concentrations vary. The ultimate goal is to build a computational tool that automatically predicts the expression of any gene in any cellular condition based solely on the genome sequence and a quantitative description of the trans-regulatory context <xref ref-type="bibr" rid="pcbi.1003467-Kim1">[18]</xref>. Such a computational tool will embody our knowledge of the so-called “cis-regulatory code” <xref ref-type="bibr" rid="pcbi.1003467-Istrail1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-OchoaEspinosa1">[20]</xref>. It will help us annotate the regulatory genome at a single nucleotide resolution, and predict the effects of genotypic changes (in cis or in trans) on gene expression and phenotype.</p>
<sec id="s1a">
<title>Gene expression modeling</title>
<p>In this study, we consider the problem of <italic>modeling</italic> gene expression, which is an important intermediate step in the more ambitious goal of building the <italic>predictive</italic> tool mentioned above. In the modeling task, we are given the inputs (sequence and TF concentrations) and output (gene expression), and a model with tunable parameters is trained to map the inputs to the outputs. Such a model has many possible uses. Once trained on wild-type data on a gene, it can be used to predict outputs on non-wild-type inputs, which may include changes in cis (sequence) or trans (TF concentrations). It can provide a quantitative description of how a specific gene's regulation is encoded in the sequence, and can precisely characterize each TF's role in regulating the gene. Moreover, by testing alternative models in terms of their goodness-of-fit on the data, we can gain valuable insights into the mechanisms underlying gene regulation. Here, we develop such a model of gene expression, show that it fits the available data accurately, and demonstrate a few practical utilities of the model.</p>
</sec><sec id="s1b">
<title>Locus-level gene expression modeling</title>
<p>A key challenge in achieving the above-stated goal is to model a gene's expression <italic>from the sequence of its entire intergenic region</italic>, or “locus”. While regulatory influences on a gene have been known to be located at great distances (&gt;1 Mbp) from the gene <xref ref-type="bibr" rid="pcbi.1003467-Sagai1">[21]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Visel1">[22]</xref>, it is frequently observed that much of the information about the gene's expression pattern is encoded in its locus <xref ref-type="bibr" rid="pcbi.1003467-Blackwood1">[23]</xref>. This information is typically organized in modular units of length ∼1 Kbp, called enhancers, that are scattered in the locus, both proximal and distal to the gene, and upstream, downstream as well as within introns of the gene. For instance, complex gene expression patterns such as the seven-striped patterns of “pair-rule” genes (<xref ref-type="fig" rid="pcbi-1003467-g001">Figure 1A,B</xref>) in the <italic>Drosophila</italic> embryo are known to be determined by multiple, distinct enhancers (<xref ref-type="fig" rid="pcbi-1003467-g001">Figure 1C</xref>), each of which is sufficient to drive a discrete aspect (one or two stripes) of the gene's overall pattern <xref ref-type="bibr" rid="pcbi.1003467-Andrioli1">[24]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Riddihough1">[25]</xref>. How the information encoded by multiple enhancers in a locus is integrated together is a largely unexplored problem. A simple hypothesis might be that the binding sites located across different enhancers in a gene's locus constitute one large enhancer, interpreted by the same rules of combinatorial action that apply to binding sites within any single enhancer. The more common view <xref ref-type="bibr" rid="pcbi.1003467-Howard1">[26]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Fujioka1">[27]</xref>, however, is that each enhancer is interpreted independently of others, and readouts of multiple enhancers are superimposed or combined additively to produce the gene expression pattern. If this latter view is more accurate, existing sequence-to-expression models, which have been tested on individual enhancers, may not suffice to model a gene's expression from its entire intergenic region. Indeed, while there have been several successful attempts to model enhancer readouts, especially for A/P and D/V patterning genes in <italic>Drosophila</italic> <xref ref-type="bibr" rid="pcbi.1003467-Bintu1">[9]</xref>–<xref ref-type="bibr" rid="pcbi.1003467-Kim1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Fakhouri1">[28]</xref>, we are not aware of any computational model that has been successfully tested on a multi-enhancer gene locus such as those of the pair-rule genes (<xref ref-type="fig" rid="pcbi-1003467-g001">Figure 1A–C</xref>). Our primary objective in this work is to implement and test such a computational model. A recent study by Kim et al. <xref ref-type="bibr" rid="pcbi.1003467-Kim1">[18]</xref> makes significant contributions to this modeling question, although the authors' primary focus was on elucidating specific details of transcriptional control mechanisms. (Also see <xref ref-type="sec" rid="s3">Discussion</xref>.)</p>
<fig id="pcbi-1003467-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003467.g001</object-id><label>Figure 1</label><caption>
<title>(A) Schematic of expression pattern of the pair-rule gene <italic>even-skipped</italic> (<italic>eve</italic>) in <italic>D. melanogaster</italic> embryo.</title>
<p>‘A’ and ‘P’ denote the anterior and the posterior ends of the embryo, respectively. (B) Quantitative profile of <italic>eve</italic> gene expression along the anterior-posterior axis of the embryo. (C) Genome Browser view of the five distinct enhancer elements that drive <italic>eve</italic> gene expression; each enhancer's name denotes the specific stripe(s) of gene expression that it drives. The entire locus is 17 Kbp long. (D) Concentration profiles along the anterior-posterior axis, for the nine TFs used to model the expression patterns of the genes <italic>eve</italic>, <italic>h</italic>, <italic>run</italic>, and <italic>gt</italic>. (E) Real (red) and GEMSTAT-predicted (green) expression profiles along the A/P axis for the known enhancers of <italic>eve</italic>, <italic>h</italic>, <italic>run</italic>, and <italic>gt</italic>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003467.g001" position="float" xlink:type="simple"/></fig>
<p>We present a computational framework for modeling the expression level of a gene from the sequence of its locus and a quantitative description of the trans-regulatory context (TF concentrations). We refer to this task as “locus-level gene expression modeling”, where a gene's locus is considered to be the non-coding sequences extending upstream and downstream of the gene until a neighboring gene's boundary. (This includes UTRs and introns.) Our new model, called GEMSTAT-GL (“<bold>G</bold>ene <bold>E</bold>xpression <bold>M</bold>odeling based on <bold>Sta</bold>tistical <bold>T</bold>hermodynamics - <bold>G</bold>ene-locus <bold>L</bold>evel”), implements the two-layered, modular organization of cis-regulatory information mentioned above, thus reflecting the commonly held view today.</p>
</sec><sec id="s1c">
<title>Practical problems in implementing a locus-level model</title>
<p>An important challenge for a model that interprets multiple enhancers in a locus and combines their separate readouts is the unknown location of enhancers in a locus <xref ref-type="bibr" rid="pcbi.1003467-Halfon1">[29]</xref>–<xref ref-type="bibr" rid="pcbi.1003467-Lifanov1">[31]</xref> – an enhancer is typically ∼1 Kbp long and may be located anywhere within the much longer (often 10–50 Kbp long) gene locus. Accurate identification of all the necessary enhancers in the locus will be a prerequisite for modeling gene expression. High throughput characterization of chromatin marks <xref ref-type="bibr" rid="pcbi.1003467-Ernst1">[32]</xref>–<xref ref-type="bibr" rid="pcbi.1003467-Visel2">[35]</xref> and computational enhancer scans <xref ref-type="bibr" rid="pcbi.1003467-Halfon1">[29]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Berman1">[36]</xref>–<xref ref-type="bibr" rid="pcbi.1003467-Sinha1">[40]</xref> may help overcome this challenge in the future; but ideally the quantitative model should automatically discover the contributing segments in the locus, rather than relying on enhancers identified <italic>a priori</italic>. A second major challenge in locus-level modeling is to model the mechanisms that integrate outputs from distinct enhancers into the endogenous gene expression. As noted above, a relatively simple “additive” mechanism has been suggested in the literature <xref ref-type="bibr" rid="pcbi.1003467-Howard1">[26]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Howard2">[41]</xref>–<xref ref-type="bibr" rid="pcbi.1003467-Perry1">[43]</xref>, where readouts of the contributing enhancers are summed up to produce the gene expression pattern. However, existing quantitative models often are capable of predicting enhancer readouts only on a relative scale (e.g., expression pattern along the A/P axis rather than absolute expression values). As such, it is not clear if a simple summation of model predictions on enhancers will suffice to accurately predict gene expression patterns. Moreover, while a minimal set of enhancers may capture all aspects of the gene expression pattern, it is not clear what role the rest of the locus plays. If the locus harbors multiple enhancers with similar readouts, as has been suggested by the discovery of “shadow enhancers” <xref ref-type="bibr" rid="pcbi.1003467-Barolo1">[44]</xref>–<xref ref-type="bibr" rid="pcbi.1003467-Perry2">[46]</xref>, a quantitative model should take into account contributions from all of them. These are some of the challenges related to locus-level gene expression modeling that motivate our work.</p>
</sec><sec id="s1d">
<title>Overview of model development and testing</title>
<p>We report here the first general-purpose quantitative model of a gene's expression pattern as a function of the sequence of its entire locus. Here, “general-purpose” implies that the model can be trained on any given data set with minimal or no manual parameter tuning. Admittedly, the model has to be provided with a complete set of candidate regulators (TFs), as well as their DNA binding motifs and relative concentrations, which currently limits its applicability to regulatory networks where such information is available. But given this information the model then automatically learns values for all of its free parameters, and the locations of relevant enhancers in the gene locus. As noted above, the new model treats the expression readout of an entire gene locus as being two tiered – 1) sites within each enhancer act together to produce that enhancer's contribution, which is modeled using the thermodynamics-based GEMSTAT model of enhancer function <xref ref-type="bibr" rid="pcbi.1003467-He1">[11]</xref>, and 2) contributions from multiple enhancers are combined as a weighted sum to produce the gene expression profile. See <xref ref-type="fig" rid="pcbi-1003467-g002">Figure 2</xref> for an overview of the newly proposed GEMSTAT-GL model. We initially focused on the expression patterns of the genes <italic>even-skipped</italic>, <italic>hairy</italic>, <italic>runt</italic>, and <italic>giant</italic> in the developmental stage following the maternal to zygotic transition <xref ref-type="bibr" rid="pcbi.1003467-DePamphilis1">[6]</xref> in early <italic>Drosophila melanogaster</italic> embryos. In this stage, each of these genes is expressed in a complex multi stripe pattern and is known to be regulated by multiple enhancers within its locus, and is thus an ideal test case for locus-level modeling. As a point of contrast to the two-tiered model of GEMSTAT-GL, we also trained the GEMSTAT model that was shown previously to accurately model ∼40 enhancers involved in A/P patterning. We found that GEMSTAT fails to model multiple sharply defined stripes and instead predicts one broad expression domain when it is used for locus-level modeling of each of the four genes mentioned above. In order to demonstrate the broader applicability of GEMSTAT-GL, we next used it to model the expression patterns of 23 additional genes in early <italic>Drosophila</italic> embryo (we have thus modeled all the 27 A/P genes from Kazemian et al. <xref ref-type="bibr" rid="pcbi.1003467-Kazemian1">[13]</xref>). From the intergenic locus of each gene, our model automatically selected one or a handful of segments that together generated the gene's expression. The selected segments were found to overlap enhancers known to regulate the gene, even though the model was not informed about these enhancers. We also investigated whether and how the intergenic sequence outside these selected segments contributes to the gene's expression. Our findings suggest the presence of sequence segments in the locus that would exert an irreconcilable impact on the gene's expression pattern and thus were required to be explicitly “shut down” by the model, presumably reflecting a similar phenomenon <italic>in vivo</italic>.</p>
<fig id="pcbi-1003467-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003467.g002</object-id><label>Figure 2</label><caption>
<title>Overview of the newly proposed GEMSTAT-GL model (details are given in <xref ref-type="sec" rid="s4">Materials and Methods</xref>).</title>
<p>The model has two types of parameters, namely thermodynamic parameters (to compute the expression readout of any sequence window) and window-weight parameters (to compute a weighted summation of the expression readouts of a set of selected windows). The parameters are optimized iteratively to fit the expression pattern of a given gene from its locus. In the example shown, GEMSTAT-GL is applied to fit the three-striped expression pattern (shown by the green, the red, and the blue stripes) of a gene <italic>g</italic> from its locus. Each iteration in model training consists of two phases. In the first phase, through a sliding window mechanism, the model selects a set <italic>C(s)</italic> of candidate windows for each stripe <italic>s</italic>. To this end, each window's readout (computed by GEMSTAT, denoted here by function <italic>G</italic>) is compared against each individual stripe, as exemplified through the operations on the green window. (Computation of the initial estimates for thermodynamic parameters is explained in main text.) In the second phase, a solution is constructed by iteratively checking if including a new window from the candidate sets (computed in Phase 1) improves model performance. In the shown example, the green window first gets included in the solution since it fits the green stripe satisfactorily. Next, the first window from the red stripe's candidate set is added to the solution and weights for the two windows are optimized so that a weighted summation of their readouts (denoted by function <italic>GL</italic>) fits the expression pattern consisting of the green and the red stripes. The model shows improved performance and hence, the red window is retained in the solution. However, when the second window from the red stripe's candidate set is added to the solution, it deteriorates model performance. The window is therefore discarded. Similarly, the blue window from the blue stripe's candidate set is checked and found to improve model performance – resulting in its inclusion to the solution. After completing the second phase, the model re-estimates the thermodynamic parameters and loops back to Phase 1.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003467.g002" position="float" xlink:type="simple"/></fig></sec><sec id="s1e">
<title>Practical utilities of the new model</title>
<p>We used our models to analyze several aspects of the regulation of <italic>eve</italic>, <italic>h</italic>, <italic>run</italic>, and <italic>gt</italic>. 1) An immediate practical benefit of our model is the automatic discovery of candidate enhancers in the locus, along with accurate assignments of regulatory activity to each enhancer. This goes one step beyond our previous work <xref ref-type="bibr" rid="pcbi.1003467-Kazemian1">[13]</xref> where enhancers were annotated based on their pattern generating potential. The new method ensures that activities of multiple enhancers in the locus can be aggregated to match the gene's expression profile. Also, since GEMSTAT-GL allows model parameters to be trained simultaneously with the discovery of enhancers in a gene's locus, the assignment of regulatory activity to enhancers is empirically more accurate than those reported in <xref ref-type="bibr" rid="pcbi.1003467-Kazemian1">[13]</xref>. 2) We performed <italic>in silico</italic> knock-downs of TFs and identified the TFs responsible for the formation of stripe boundaries in A/P expression patterns of these genes. The resulting network of regulatory interactions exhibits a very high level of agreement with known regulatory influences on the target genes, illustrating the potential of the model-based approach for unraveling regulatory networks. 3) We also developed a method to investigate whether and why the assumed independence of enhancers was necessary in our model. We found that interaction or “cross-talk” <xref ref-type="bibr" rid="pcbi.1003467-Perry1">[43]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Prazak1">[47]</xref>–<xref ref-type="bibr" rid="pcbi.1003467-Kirstein1">[49]</xref> between the enhancers of a gene is detrimental to our model's fits to the gene's expression data, and identified cases where specific binding sites in one enhancer that may interfere with another enhancer's readout. This suggests that in these cases the independence of enhancer contributions is necessary for proper modeling of gene expression.</p>
<p>An implementation of the “GEMSTAT-GL” model is available for download at: <ext-link ext-link-type="uri" xlink:href="http://veda.cs.uiuc.edu/gemstat-gl/index.htm" xlink:type="simple">http://veda.cs.uiuc.edu/gemstat-gl/index.htm</ext-link>.</p>
</sec></sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>A thermodynamics-based model accurately predicts readouts of the enhancers of <italic>even-skipped</italic>, <italic>hairy</italic>, <italic>runt</italic>, and <italic>giant</italic></title>
<p>We previously reported a statistical thermodynamics-based model of enhancer function, called “GEMSTAT”, that was shown to successfully predict the expression patterns of ∼40 enhancers of the anterior posterior (A/P) axis patterning system in early <italic>Drosophila</italic> embryo <xref ref-type="bibr" rid="pcbi.1003467-He1">[11]</xref>. GEMSTAT is built on basic physical principles laid out by Shea and Ackers <xref ref-type="bibr" rid="pcbi.1003467-Buchler1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Shea1">[50]</xref>. It is the only available general purpose tool that can predict the expression readout of an arbitrary DNA segment and whose parameters can be trained on any given set of enhancers. It assumes gene expression in a cell type to be proportional to the fractional occupancy <xref ref-type="bibr" rid="pcbi.1003467-Ay1">[51]</xref> of the basal transcriptional machinery at the gene promoter, and estimates this occupancy from the enhancer sequence and the binding specificities (motifs) and concentrations of TFs in that cell type. Due to its previous successful application to individual enhancers and due to our extensive experience with it, GEMSTAT was a natural initial choice for modeling a gene locus. We made a major modification to GEMSTAT's objective function, which is used to compare predicted and real expression patterns: instead of the “root mean square error” function <xref ref-type="bibr" rid="pcbi.1003467-He1">[11]</xref>, it now uses a “weighted Pattern Generating Potential” (w-PGP) function <xref ref-type="bibr" rid="pcbi.1003467-Samee1">[52]</xref> that was designed specifically for comparing spatial gene expression patterns. (See <xref ref-type="sec" rid="s4">Materials and Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003467.s010">Figure S10</xref> for details.)</p>
<p>Before using GEMSTAT to model the entire locus, we sought to confirm if it accurately models the characterized enhancers of the genes of interest in this study. We first focused on four genes in the early <italic>Drosophila</italic> embryo, namely <italic>even-skipped (eve)</italic>, <italic>hairy (h)</italic>, <italic>runt (run)</italic>, and <italic>giant (gt)</italic>. The multi-stripe patterns of these genes (e.g., <xref ref-type="fig" rid="pcbi-1003467-g001">Figure 1A,B</xref>) are among the first manifestations of complex combinatorial regulation in the <italic>Drosophila</italic> embryo <xref ref-type="bibr" rid="pcbi.1003467-Reinitz1">[53]</xref>. These genes are initially regulated by an interplay of maternally deposited proteins and their immediate regulatory targets <xref ref-type="bibr" rid="pcbi.1003467-DePamphilis1">[6]</xref>, and their expression is later stabilized through more complex mechanisms including auto-<xref ref-type="bibr" rid="pcbi.1003467-Harding1">[54]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Jiang1">[55]</xref> and cross-regulation <xref ref-type="bibr" rid="pcbi.1003467-Harding2">[56]</xref>. Due to the complexity and multi-enhancer origins of their expression patterns and due to availability of high resolution expression data <xref ref-type="bibr" rid="pcbi.1003467-Pisarev1">[57]</xref>, these four genes were chosen as the primary subject of our study. (See <xref ref-type="supplementary-material" rid="pcbi.1003467.s014">Text S1</xref> for a discussion of why several other complex patterned genes were not included in the initial study.) A total of 18 early functioning enhancers have been reported in the literature for <italic>eve</italic>, <italic>h</italic>, <italic>run</italic>, and <italic>gt</italic> – 5 for <italic>eve</italic> (<xref ref-type="fig" rid="pcbi-1003467-g001">Figure 1C</xref>), 7 for <italic>h</italic>, 3 for <italic>run</italic>, and 3 for <italic>gt</italic> – each responsible for some discrete aspect (typically one or two “stripes”) of the respective gene's pattern during early stages of development. Thus, for each gene our data set included the sequences and known expression readouts of each enhancer, and the DNA motifs and A/P concentration profiles of nine TFs – BCD, CAD, ZLD, GT, HB, KNI, KR, TLL, and SLP (<xref ref-type="fig" rid="pcbi-1003467-g001">Figure 1D</xref>) – that are known to regulate expression at this stage of development <xref ref-type="bibr" rid="pcbi.1003467-DePamphilis1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Harrison1">[58]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Nien1">[59]</xref>. For each gene, GEMSTAT learns one set of parameters so as to maximize the agreement between predicted and known expression profiles of all enhancers of the gene according to the w-PGP metric (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). As shown in <xref ref-type="fig" rid="pcbi-1003467-g001">Figure 1E</xref>, readouts of known enhancers were modeled accurately for each of the four genes, suggesting that the GEMSTAT model captures the combinatorial action of multiple, heterotypic binding sites in those enhancers. (The enhancers responsible for stripes 2, 4, and 6 of <italic>run</italic> are not known.) This exercise is shown schematically in <xref ref-type="fig" rid="pcbi-1003467-g003">Figure 3A</xref>. We used a constrained parameter estimation strategy here to guard against over-fitting. (See <xref ref-type="sec" rid="s4">Materials and Methods</xref>.)</p>
<fig id="pcbi-1003467-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003467.g003</object-id><label>Figure 3</label><caption>
<title>A hypothetical example illustrating the different attempts at developing a locus-level model of gene expression.</title>
<p>Notations used in the figure are explained in the bottom panel. The hypothetical gene here is expressed in four stripes, as shown in the panel for notations using four blue stripes within a rectangle. The thick purple line near the base of each panel denotes the locus; red circles and green triangles denote activator and repressor TFs bound to their cognate sites within the locus, respectively. The bold pink arrow indicates GEMSTAT prediction of an expression readout on a given segment. (A) GEMSTAT accurately models the 2-striped expression patterns driven by “known” enhancers for this hypothetical gene. (B) GEMSTAT fails to model the four-striped readout of entire locus in the “Direct Interaction” mode. (C) GEMSTAT fails to model the locus readout in the “Short Range Repression” mode (quenching effect of repressors is shown using the dark-red colored dashed arrows connecting repressors to activators bound at nearby sites). (D) GEMSTAT also fails to model the gene's four-striped expression from the concatenation of its two “known” enhancers. (E) A two-tiered model, that first selects a handful of variable-length windows (putative enhancers) from the locus and then takes a weighted summation of the GEMSTAT-predicted readouts of those windows to model gene expression. This model produces accurate fits.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003467.g003" position="float" xlink:type="simple"/></fig></sec><sec id="s2b">
<title>Intergenic locus readout under the thermodynamic model does not agree with multi-stripe expression pattern</title>
<p>Having confirmed that GEMSTAT can model enhancer readouts accurately, we next tested if GEMSTAT can model the multi-stripe patterns of the genes of interest from their respective intergenic regions (<xref ref-type="fig" rid="pcbi-1003467-g003">Figure 3B</xref>). By doing so, we hoped to answer the following question raised in the introductory section: Do the rules for interpreting a collection of binding sites in an enhancer apply unchanged to the larger collection of sites present throughout the locus? The intergenic region or “locus” was defined here as the sequence bounded by the immediate neighboring genes on either side (<xref ref-type="fig" rid="pcbi-1003467-g001">Figure 1C</xref>), and was of length 17 Kbp, 68 Kbp, 58 Kbp, and 17 Kbp for <italic>eve</italic>, <italic>h</italic>, <italic>run</italic>, and <italic>gt</italic>, respectively (<xref ref-type="supplementary-material" rid="pcbi.1003467.s012">Table S1</xref>).</p>
<p>We performed two exercises, under different assumptions about the range of regulatory influence of repressors. In the first exercise, we assumed that repressor molecules bound to their cognate binding sites can directly affect the transcriptional machinery (“DIRECT INTERACTION” mode of GEMSTAT <xref ref-type="bibr" rid="pcbi.1003467-He1">[11]</xref>). However, as shown in <xref ref-type="supplementary-material" rid="pcbi.1003467.s001">Figure S1A</xref>, GEMSTAT was unable to find any set of parameters for which the predicted gene expression profiles match the multi-stripe profiles. One possible explanation for this failure is the phenomenon of “short range repression” (SRR). Some of the repressors of this regulatory system (e.g., GT, KNI, and KR) are known to act over short ranges only, i.e., their binding sites mediate a repressive action only if located within 100–150 bp of activator sites <xref ref-type="bibr" rid="pcbi.1003467-Fakhouri1">[28]</xref>. Therefore, in our second set of tests we trained GEMSTAT in the “SRR” mode <xref ref-type="bibr" rid="pcbi.1003467-He1">[11]</xref>, which captures short range repression, on each gene's locus (<xref ref-type="fig" rid="pcbi-1003467-g003">Figure 3C</xref>). However, this test was also unsuccessful (<xref ref-type="supplementary-material" rid="pcbi.1003467.s001">Figure S1B</xref>), i.e., no parameter setting was found for which predicted expression profiles match the real gene expression profiles. We note that all of these failed experiments were performed with an unconstrained parameter estimation strategy (which is GEMSTAT's default strategy, see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). Therefore, failures of these experiments were presumably not due to shortcomings of the parameter optimization algorithm.</p>
<p>The finding that GEMSTAT successfully models enhancer functions but fails on the entire locus has at least two possible explanations. The first explanation is that binding sites within certain segments in the locus contribute to gene expression while sites outside of these segments do not contribute, and their inclusion in the model is somehow detrimental to the goodness-of-fit. To test this, we concatenated the known enhancers of each gene (<xref ref-type="fig" rid="pcbi-1003467-g003">Figure 3D</xref>) and searched for the best fit between GEMSTAT predictions and data. No satisfactory fit was found (<xref ref-type="supplementary-material" rid="pcbi.1003467.s001">Figure S1C</xref>), suggesting that the above explanation is not sufficient. A second explanation for the failure of GEMSTAT on locus-level modeling has to do with the way GEMSTAT models the sequence. It computes the readout as a single non-linear function of (the strengths of) all binding sites in the sequence. Perhaps the readout of the locus is not best described as computing this function on all sites in the locus, even though the readout of individual enhancers does conform to this model. An emerging hypothesis was that local clusters of sites act together in ways captured by the GEMSTAT model (as demonstrated by the enhancer modeling exercise above) but contributions from different clusters of sites do not interfere with each other and these clusters should not be interpreted together. This hypothesis reflects the conventional wisdom about cis-regulatory architecture, and was reached here on the basis of the failed modeling exercises described above. We explored this hypothesis next, within a modeling framework, and found it being supported by all the genes modeled in this work.</p>
</sec><sec id="s2c">
<title>A two-tiered model based on GEMSTAT accurately predicts expression from the entire gene locus</title>
<p>Our working hypothesis now was that distinct segments in the gene locus are interpreted separately based on the collection of sites within each segment, and their individual readouts are then aggregated to produce the overall pattern. Thus, it presents a “two-tiered” gene expression model. The main challenges in formulating and training such a model are: (i) determining the segments whose readouts are aggregated, and (ii) choosing an appropriate aggregator function. The quantitative model may not assume prior knowledge of enhancers in the locus since such a strategy is not generalizable to poorly characterized loci. Gene expression profiles should be modeled solely from the gene locus and TF data (concentrations and motifs).</p>
<p>Pursuing the above hypothesis, we implemented a two-tiered model that uses contributions from a number of sequence windows in the locus, and predicts gene expression as a weighted sum of these contributions (<xref ref-type="fig" rid="pcbi-1003467-g003">Figure 3E</xref>; see <xref ref-type="fig" rid="pcbi-1003467-g002">Figure 2</xref> for more details). We call this new model “GEMSTAT-GL”, with “GL” abbreviating for “gene-locus level”. The sequence windows were allowed to be of varying lengths, even mutually overlapping if necessary, and their separate readouts were predicted using GEMSTAT. The number and locations of contributing sequence windows, as well as the weight of each window's contribution were left to be automatically discovered during model training. Model training was performed iteratively, with a new sequence window being included for contributing to gene expression only if its inclusion significantly improved the agreement between predicted and real expression profiles. In this way, the complexity of the model was kept under control. Details of this two tiered model and its parameter estimation procedure are described in <xref ref-type="sec" rid="s4">Materials and Methods</xref>. Roughly speaking, this procedure (a) finds a window whose GEMSTAT readout matches one aspect (e.g., a stripe) of the gene expression pattern, (b) tests if a weighted summation of this window's readout and the readouts of already selected windows improves the overall prediction, and (c) includes the window if such an improvement is noted. The model parameters were fit separately for each gene; hence we adopted a “constrained” parameter estimation strategy to avoid over-fitting (see <xref ref-type="sec" rid="s4">Materials and Methods</xref> and <xref ref-type="sec" rid="s3">Discussion</xref>).</p>
<p>Predictions from the GEMSTAT-GL model agreed very well with the real expression profiles of each of the four target genes, <italic>eve</italic>, <italic>h</italic>, <italic>run</italic>, and <italic>gt</italic> (<xref ref-type="fig" rid="pcbi-1003467-g004">Figure 4A–D</xref>). For instance, we noted that the seven-stripes of <italic>eve</italic> and <italic>h</italic> expression were faithfully captured by the model (<xref ref-type="fig" rid="pcbi-1003467-g004">Figure 4A,B</xref>), while the seven-striped pattern of <italic>run</italic> was well approximated by a six-striped predicted pattern, with the model failing to separate stripes 4 and 5. Both domains of <italic>gt</italic> expression and their experimentally characterized assignments to three different enhancers were reproduced by the model. The agreement between model and data seen here for the <italic>eve</italic> and <italic>h</italic> stripes is qualitatively superior to corresponding fits in previous work on enhancer modeling <xref ref-type="bibr" rid="pcbi.1003467-He1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Segal1">[14]</xref>, and this may be attributed to the fact that GEMSTAT-GL fits parameters on each gene separately. However, subsequent control experiments (described next) largely ruled out the possibility of obtaining such accurate models through over-fitting and highlighted the significance of the reported models. From each gene's locus, the model chose a small number of segments (at most seven) in the first tier before aggregating their GEMSTAT-based readouts in the second tier. The segments selected from a locus received comparable weights, with their values differing by at most two-fold (see <xref ref-type="supplementary-material" rid="pcbi.1003467.s002">Figure S2</xref>). Moreover, these automatically chosen segments showed strong overlap with previously characterized enhancers of the respective genes (<xref ref-type="fig" rid="pcbi-1003467-g004">Figure 4A–D</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003467.s003">Figure S3</xref>), even though the enhancers were not known to the model training procedure. In particular, of the 21 regulatory segments chosen from the four gene loci, 16 overlapped with REDFly enhancers <xref ref-type="bibr" rid="pcbi.1003467-Gallo1">[60]</xref>. The extent of overlap between GEMSTAT-GL selected regulatory segments and REDFly enhancers are shown in <xref ref-type="supplementary-material" rid="pcbi.1003467.s003">Figure S3</xref>.</p>
<fig id="pcbi-1003467-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003467.g004</object-id><label>Figure 4</label><caption>
<title>(A) Results of applying GEMSTAT-GL on the intergenic region of <italic>eve</italic> in <italic>D. melanogaster.</italic> Left panel shows the real (red) and predicted (green) expression profiles along the A/P axis.</title>
<p>Right panel shows the locations of selected windows (green boxes) in the locus and their predicted expression patterns (top), along with locations of known <italic>eve</italic> enhancers (red boxes). (B), (C), and (D), same information for <italic>h</italic>, <italic>run</italic>, and <italic>gt</italic>, respectively. (E) Expression patterns modeled by GEMSTAT-GL from the intergenic regions of <italic>eve</italic>, <italic>h</italic>, <italic>run</italic>, and <italic>gt</italic> in the <italic>D. pseudoobscura</italic> genome.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003467.g004" position="float" xlink:type="simple"/></fig>
<p>This initial success of the model motivated us further to test its generalizability. We therefore applied the model to all 27 A/P genes considered in <xref ref-type="bibr" rid="pcbi.1003467-Kazemian1">[13]</xref>. These 27 genes, which are expressed between stages 4 and 6 during <italic>Drosophila</italic> embryogenesis, include several gap genes, pair-rule genes, and anterior, posterior, trunk, and terminal genes. They are, with the exception of secondary pair-rule genes (<xref ref-type="supplementary-material" rid="pcbi.1003467.s014">Text S1</xref>), likely to be regulated primarily by the maternal and the early zygotic proteins, and therefore are reasonable targets for modeling using the same input TFs as above. (We also used the TFs Capicua (CIC), Forkhead (FKH), and Huckebein (HKB) in modeling these genes, as in <xref ref-type="bibr" rid="pcbi.1003467-Kazemian1">[13]</xref>.) The four genes modeled above – <italic>eve</italic>, <italic>h</italic>, <italic>run</italic>, and <italic>gt</italic> – are included in these 27 genes; hence we show the modeled expression patterns of the additional 23 genes in <xref ref-type="fig" rid="pcbi-1003467-g005">Figure 5</xref>. GEMSTAT-GL was able to accurately fit the expression pattern for most of the genes, demonstrating its wide applicability for gene-locus modeling. The model fits were less accurate for the secondary pair-rule genes <italic>ftz</italic>, <italic>odd</italic>, and <italic>prd</italic>, where 4, 3 and 5 stripes were correctly reproduced (out of seven stripes of each gene). This relative lack of accuracy is probably because the direct regulators of these genes include the primary pair-rule proteins <xref ref-type="bibr" rid="pcbi.1003467-Schroeder2">[61]</xref>, which were not among the input TFs (see <xref ref-type="supplementary-material" rid="pcbi.1003467.s014">Text S1</xref>). Another case of model failure was <italic>ttk</italic>, presumably because the precise seven-striped pattern of <italic>ttk</italic> occurs later than stage 6 of embryogenesis <xref ref-type="bibr" rid="pcbi.1003467-Brown1">[62]</xref> and it requires other regulators than the used TFs (e.g., Biniou <xref ref-type="bibr" rid="pcbi.1003467-Jakobsen1">[63]</xref>). To model these additional 23 genes, GEMSTAT-GL selected 29 regulatory segments, 23 of which were overlapping with REDFly enhancers (see <xref ref-type="supplementary-material" rid="pcbi.1003467.s003">Figure S3</xref> for the extent of overlap). As above, a constrained parameter fitting strategy was used here. The w-PGP scores of GEMSTAT-GL for all the 27 genes modeled above are shown in <xref ref-type="supplementary-material" rid="pcbi.1003467.s013">Table S2</xref>.</p>
<fig id="pcbi-1003467-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003467.g005</object-id><label>Figure 5</label><caption>
<title>Results of fitting the GEMSTAT-GL model on the intergenic locus of 23 additional genes studied in <xref ref-type="bibr" rid="pcbi.1003467-Kazemian1">[13]</xref>.</title>
<p>Quantitative data on target expression patterns were obtained from the companion website of the same study, and were originally derived from <italic>in situ</italic> expression images at the FlyExpress <xref ref-type="bibr" rid="pcbi.1003467-Kumar1">[81]</xref> database. For each gene, the red and the green plots represent the target (real) and the modeled expression patterns, respectively.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003467.g005" position="float" xlink:type="simple"/></fig><sec id="s2c1">
<title>Control experiments suggest that the trained model is not over-fit</title>
<p>Over-fitting was a concern in the above modeling exercise, since our framework does not allow testing of predictions on unseen data. We performed a number of control experiments, described next, to address this concern. As “negative controls”, we repeated the above model-training exercise on the following types of artificial data sets (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>): (a) the locus of one gene was used to model the expression pattern of a different gene, (b) the locus of a given gene was used to model a “random” expression pattern, and (c) a gene's expression pattern was modeled from a randomly generated sequence of the same length as the gene's locus, and (d) a gene's expression pattern was modeled from a random relocation of TF binding sites in its locus. Each negative control experiment failed, as expected: no parameter settings were found for which model predictions agreed with data (<xref ref-type="supplementary-material" rid="pcbi.1003467.s004">Figure S4</xref>). Moreover, experiment (d) allowed us to assess the significance of our original model fits by comparing the goodness-of-fit score (value of objective function) of the trained model to an empirical distribution of scores from 100 negative controls for each gene. As shown in <xref ref-type="supplementary-material" rid="pcbi.1003467.s005">Figure S5</xref>, the original models were highly significant, with goodness-of-fit scores greater than all negative controls and with values 30–40 standard deviations above the mean from negative controls. We note that, as opposed to the constrained parameter estimation strategy in the modeling of real data, there was no constraint on parameter values in the control experiments. As an additional test, we trained the model on <italic>D. melanogaster</italic> gene expression profiles of <italic>eve</italic>, <italic>h</italic>, <italic>run</italic> and <italic>gt</italic> using sequence from the loci of their respective <italic>D. pseudoobscura</italic> orthologs. We assumed that the expression profile characterized experimentally in <italic>D. melanogaster</italic> remains unchanged in this related species <xref ref-type="bibr" rid="pcbi.1003467-Segal1">[14]</xref>. The trained model was found to capture the real expression profiles well (<xref ref-type="fig" rid="pcbi-1003467-g004">Figure 4E</xref>), although not as accurately as in <italic>D. melanogaster</italic>: for the seven-striped patterns of <italic>eve</italic>, <italic>h</italic>, and <italic>run</italic>, the model reproduced the locations of 6, 7, and 6 stripes respectively, though the inter-stripe boundaries were not as prominent as in the <italic>D. melanogaster</italic> models. The model fits on <italic>gt</italic> reproduced both anterior and posterior domains of endogenous expression, though the model-predicted domains were shifted posteriorly. We note again that we are unable to test the trained model by direct prediction of the readout of an unseen gene locus, since the locations and weights of contributing sequence windows have to be learned from that locus.</p>
</sec></sec><sec id="s2d">
<title>A sampling strategy reveals the cis-regulatory architecture of a gene locus</title>
<p>The two-tiered model described above discovered a small number of segments whose readouts could be aggregated to match the gene expression profile. This set of segments describes the “regulatory architecture” of the gene locus (<xref ref-type="fig" rid="pcbi-1003467-g004">Figure 4A–D</xref>), as a checkered pattern of putative enhancers (green boxes in the genome browser views) interspersed with large spacer regions that do not contribute to gene expression. However, since the model was trained with a local search algorithm and was designed to utilize only as many segments as necessary, it is possible that the learned architecture is one of many possible architectures, each of which has its own locations of putative enhancers and intervening spacers. To investigate this possibility, we performed Markov Chain Monte Carlo sampling of the space of architectures. (See <xref ref-type="sec" rid="s4">Materials and Methods</xref> for details.) Each architecture was represented by the locations of sequence segments that contribute to gene expression, and their respective weights. Also, each architecture was sampled with probability proportional to its w-PGP score, which quantifies how well the model predictions for that architecture agree with gene expression. A summary of the large number (50,000) of architectures sampled by this scheme from the <italic>eve</italic> locus is shown in <xref ref-type="fig" rid="pcbi-1003467-g006">Figure 6A</xref>. Similar depictions for the <italic>h</italic> and <italic>run</italic> locus are given in <xref ref-type="supplementary-material" rid="pcbi.1003467.s006">Figure S6</xref>. It shows the average weight that a segment received over all samples. (A weight of zero indicates that the segment was part of the spacer regions between putative enhancers in that architecture, and weights cannot be negative.) We see that the average weights are heavily peaked at a handful of locations, while most other segments within the locus have very low average weights. Moreover, the high weight locations are coincident with the contributing segments from the optimal architecture found above (<xref ref-type="fig" rid="pcbi-1003467-g004">Figure 4A</xref>). This indicates the existence of a unique regulatory architecture at the gene locus. We also noted that the high weight segments of this architecture overlap known enhancers of the gene.</p>
<fig id="pcbi-1003467-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003467.g006</object-id><label>Figure 6</label><caption>
<title>Outcome of MCMC sampling to reveal the cis-regulatory architecture of <italic>eve</italic> intergenic region.</title>
<p>(A) Top panel shows the <italic>eve</italic> intergenic locus along with the known enhancers of <italic>eve</italic> and windows selected by GEMSTAT-GL to model <italic>eve</italic> expression pattern. Bottom panel shows the average weight of segments in the locus as estimated by MCMC sampling. The horizontal axis of the bottom panel spans the <italic>eve</italic> locus; green diamonds in the plot represent the starting positions of the sequence segments that comprise the MCMC samples (segments corresponding to two different green diamonds might therefore differ in length). The vertical axis denotes the average weight (on a relative scale between 0 and 1) that each segment received over 50,000 samples. (B) Predicted readouts of three zero-weight segments that could have an irreconcilable effect on the gene expression pattern, and were not selected by the two-tiered model.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003467.g006" position="float" xlink:type="simple"/></fig>
<p>On the other hand, there were many segments with average weight close to 0 (<xref ref-type="fig" rid="pcbi-1003467-g006">Figure 6A</xref>), that were not included in any sampled architecture. Such segments either (a) have no regulatory information within them, or (b) their readout as predicted by the GEMSTAT model is inconsistent with and must not be aggregated with the readouts of other segments. The latter possibility suggests that there may be segments that exert an irreconcilable impact on the gene's expression pattern and thus have to be explicitly “shut down” by the model. A direct examination of their predicted readouts confirmed that this was indeed the case for some segments (<xref ref-type="fig" rid="pcbi-1003467-g006">Figure 6B</xref>). While most of the non-contributing segments had no noticeable readout, some such segments led to predicted expression at levels comparable to the known enhancers but at inappropriate axial positions, i.e., outside the stripe domains.</p>
</sec><sec id="s2e">
<title>A regulatory network of transcription factors determining “stripes” of gene expression</title>
<p>One of the advantages of a quantitative model of gene expression is that it allows us to predict the effects of perturbations in <italic>cis</italic>- (the regulatory sequence) or in <italic>trans</italic>- (the transcription factors) on expression. For example, a “<italic>knock-down</italic>” of a TF is easily simulated by setting the TF's concentration to zero. Such <italic>in silico</italic> knock-downs may then be used to infer regulatory influences of any TF on the gene, and a transcriptional regulatory network may be constructed. In our past work <xref ref-type="bibr" rid="pcbi.1003467-Kazemian1">[13]</xref>, we constructed such a regulatory network at the level of individual enhancers, i.e., the network predicted when a TF's knock-down would significantly affect an enhancer's readout. Such an effect does not necessarily translate to a change in gene expression, as there may be redundancy of information in the locus <xref ref-type="bibr" rid="pcbi.1003467-Barolo1">[44]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Perry2">[46]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Frankel1">[64]</xref>. An advantage of having a quantitative model of the readout of the entire gene locus is that regulatory networks may be constructed at the level of genes rather than enhancers. An edge in such a network would correspond to a TF's knock-down affecting the gene expression; such an effect can be then be probed experimentally through an <italic>in situ</italic> hybridization assay in <italic>TF<sup>−</sup></italic> condition. (Testing a TF-enhancer association experimentally would involve reporter gene assays, which are more expensive.)</p>
<p>Here, we used <italic>in silico</italic> knock-downs to predict TF-gene regulatory interactions, and described the predicted interactions as a “TF-stripe” network where edges connect TFs to specific stripes in the gene's expression profile, reflecting an effect of the TF on establishment of that particular stripe. The TF-stripe network for the <italic>eve</italic> gene (<xref ref-type="fig" rid="pcbi-1003467-g007">Figure 7A</xref>) shows 35 edges (12 activating, 23 repressive influences) between nine TFs and seven stripes of <italic>eve</italic> expression. The activators BCD and CAD regulate the anterior and posterior stripes, as expected from their concentration profiles. Each of the two borders (anterior and posterior) of any stripe is regulated by one or two TFs. This automatically constructed network is in very high agreement with the literature: 30 of the 35 edges have been previously confirmed or hypothesized based on genetic evidence, and only two interactions (small dashed edges: BCD→Stripe 5 and HB→Stripe 2) with experimental evidence were not recovered by our procedure. The “HB→Stripe 2” interaction cannot be recovered by our model because we assign a fixed role (activator or repressor) to each TF, while the literature points to an activating role for HB at stripe 2 <xref ref-type="bibr" rid="pcbi.1003467-Arnosti2">[65]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Small1">[66]</xref> and a repressive role elsewhere <xref ref-type="bibr" rid="pcbi.1003467-Zhang1">[67]</xref>. Overall, the strong agreement between the predicted and previously characterized TF-stripe network strongly argues for the usefulness of our approach, when we consider the vast amount of experimental work that has gone into characterizing those 30 recovered edges. Moreover, our model-based approach predicts three regulatory interactions that were not known previously (large dashed edges). These include roles for TLL and SLP in setting up the anterior border of Stripe 1 and a role for TLL at the posterior border of Stripe 5. Similar TF-stripe networks were constructed for <italic>h</italic>, <italic>run</italic>, and <italic>gt</italic>; these networks are shown, along with known interactions from the literature, in <xref ref-type="fig" rid="pcbi-1003467-g007">Figure 7B–D</xref>. As in the network for <italic>eve</italic>, we missed very few of the known edges in these latter three networks, and most of the missed edges correspond to “indirect” activation (i.e., if A is a repressor of B and B is a repressor of C, then A indirectly activates C) which can only be captured by a network level model of gene regulation <xref ref-type="bibr" rid="pcbi.1003467-Dresch1">[68]</xref>.</p>
<fig id="pcbi-1003467-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003467.g007</object-id><label>Figure 7</label><caption>
<title>(A)–(D) Networks showing regulatory influences of TFs on individual stripes of <italic>eve</italic>, <italic>h</italic>, <italic>run</italic>, and <italic>gt</italic>, respectively.</title>
<p>Red edges denote repressive and green edges denote activating role of the corresponding TF. Solid edges denote predicted influences that are already known in the literature. Edges with large dashes denote predicted influences that were not reported in the literature before (false positive or novel predictions), while edges with small dashes denote predicted influences already known in literature but missed by our model (false negatives).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003467.g007" position="float" xlink:type="simple"/></fig>
<p>A comparison of the networks predicted by GEMSTAT-GL with the ones deduced in previous computational studies <xref ref-type="bibr" rid="pcbi.1003467-Kazemian1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Reinitz1">[53]</xref> highlights several edges that previous models had failed to identify but have been corroborated by <italic>in vivo</italic> experiments. For example, the “TLL→<italic>h</italic> Stripe 6” and “TLL→<italic>h</italic> Stripe 7” edges in our network were suggested previously through experiments involving <italic>tll</italic> mutant embryos <xref ref-type="bibr" rid="pcbi.1003467-Riddihough1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-LaRosee1">[69]</xref>, but the enhancer-based model of our previous work <xref ref-type="bibr" rid="pcbi.1003467-Kazemian1">[13]</xref> misses both of these edges. Several such examples were also noted with respect to the network reported in <xref ref-type="bibr" rid="pcbi.1003467-Reinitz1">[53]</xref> (not shown).</p>
<p>An important observation from the TF-stripe networks of <xref ref-type="fig" rid="pcbi-1003467-g007">Figure 7</xref> is the major role played by Zelda in setting up pair rule gene expression. Recent studies have shown Zelda (Zld) to be a master regulator of early embryonic development <xref ref-type="bibr" rid="pcbi.1003467-Harrison1">[58]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Nien1">[59]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Liang1">[70]</xref>, and Nien et al. <xref ref-type="bibr" rid="pcbi.1003467-Nien1">[59]</xref> have specifically shown the effect of Zelda knockdown on pair-rule expression. While all four genes (<italic>eve</italic>, <italic>h</italic>, <italic>run</italic>, and <italic>gt</italic>) showed severely modified expression in <italic>zld<sup>−</sup></italic> experiments, a closer examination of <xref ref-type="fig" rid="pcbi-1003467-g005">Figure 5</xref> in <xref ref-type="bibr" rid="pcbi.1003467-Nien1">[59]</xref> reveals specific effects that are in agreement with our TF-stripe network. For instance, the <italic>h</italic> gene shows complete abolishment of stripes 1, 2, 4, consistent with our predictions of direct Zelda influence on stripes 1, 2, 3, and 4 of this gene. Similarly, the most pronounced effect of Zelda knockdown on <italic>run</italic> expression is the abolishment of stripes 1, 2, 5, and 6, and our network predicts direct effects of Zelda of stripes 1 and 2. We are not aware of any previous computational modeling effort that predicts these specific effects of Zelda.</p>
<p>We should note that, our reported success in recapitulating known regulatory edges is based on our own literature survey where we have tried to be as exhaustive as possible, but admittedly we might have missed some results. As such, the high rate of recapitulated network edges is a preliminary, rather than an absolute, assessment of the accuracy of these networks.</p>
</sec><sec id="s2f">
<title>Modeling cross-talk between enhancers results in aberrant expression readouts</title>
<p>Several studies make a case for interactions between enhancers of a gene <xref ref-type="bibr" rid="pcbi.1003467-Prazak1">[47]</xref>–<xref ref-type="bibr" rid="pcbi.1003467-Kirstein1">[49]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Barolo2">[71]</xref>–<xref ref-type="bibr" rid="pcbi.1003467-Montavon1">[74]</xref>, raising doubts about enhancer modularity or independence <xref ref-type="bibr" rid="pcbi.1003467-Barolo1">[44]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Maeda1">[75]</xref>. Our experience in computational modeling of gene expression, as reported above, seems to suggest that enhancer independence is the common case. GEMSTAT-GL, which assumes independence of enhancer activities and linear aggregation of their readouts, fits expression data accurately, while GEMSTAT, which interprets all binding sites in the locus together, completely failed to fit the data. We investigated the source of this dichotomy in a systematic way, by modifying GEMSTAT-GL to allow for a limited degree of interaction (non-independence) between enhancers and noting cases where such interaction leads to a marked deterioration in model fits. We report this analysis for the enhancers of <italic>eve</italic>, <italic>h</italic>, <italic>run</italic>, and <italic>gt</italic>.</p>
<p>Let C<sub>1</sub> and C<sub>2</sub> be two non-overlapping enhancers (and the only two enhancers) in a locus. Let <italic>E</italic> denote the gene expression profile and let G(C<sub>i</sub>) denote the readout predicted by GEMSTAT for any enhancer C<sub>i</sub>. As described in the previous sections, GEMSTAT-GL tests how well C<sub>1</sub> and C<sub>2</sub> explain <italic>E</italic> by computing w-PGP(<italic>E</italic>, G(C<sub>1</sub>)+G(C<sub>2</sub>)), i.e., the similarity between gene expression profile E and the integrated output of C<sub>1</sub> and C<sub>2</sub>. (We ignore weights of summands here, for simplicity.) Now, let us consider any sub-segment <italic>c</italic> of C<sub>2</sub> and represent by G(C<sub>1</sub>, <italic>c</italic>) the GEMSTAT prediction on the set of binding sites in C<sub>1</sub> and <italic>c</italic> considered together. This simulates an interaction between C<sub>1</sub> and a part of C<sub>2</sub>. We may now use w-PGP(<italic>E</italic>, G(C<sub>2</sub>)+G(C<sub>1</sub>,<italic>c</italic>)) as the accuracy of a model where the outputs of C<sub>1</sub> and C<sub>2</sub> are no longer independent, and in particular, the output of C<sub>1</sub> is shaped by contributions from a part of C<sub>2</sub>. Let G<sub>1</sub> and G<sub>2</sub> denote two GEMSTAT-GL models (i.e., two different parameter settings) trained to optimize w-PGP(<italic>E</italic>, G<sub>1</sub>(C<sub>2</sub>)+G<sub>1</sub>(C<sub>1</sub>)) and w-PGP(<italic>E</italic>, G<sub>2</sub>(C<sub>2</sub>)+G<sub>2</sub>(C<sub>1</sub>,<italic>c</italic>)), respectively. Our goal is to find a <italic>c</italic> such that w-PGP(<italic>E</italic>, G<sub>2</sub>(C<sub>2</sub>)+G<sub>2</sub>(C<sub>1</sub>,<italic>c</italic>))&lt;w-PGP(<italic>E</italic>, G<sub>1</sub>(C<sub>2</sub>)+G<sub>1</sub>(C<sub>1</sub>)), i.e., where the model with enhancer interaction is significantly worse than the additive model. Likewise, we search for a subsegment <italic>c</italic> of C<sub>1</sub> such that w-PGP(<italic>E</italic>, G<sub>3</sub>(C<sub>1</sub>)+G<sub>3</sub>(C<sub>2</sub>,<italic>c</italic>))&lt;w-PGP(<italic>E</italic>, G<sub>1</sub>(C<sub>1</sub>)+G<sub>1</sub>(C<sub>2</sub>)) where G<sub>3</sub> is a new GEMSTAT-GL model trained to optimize w-PGP(<italic>E</italic>, G<sub>3</sub>(C<sub>1</sub>)+G<sub>3</sub>(C<sub>2</sub>,<italic>c</italic>)). The discovery of any such subsegment of either C<sub>1</sub> or C<sub>2</sub> will point to an <italic>avoided interaction</italic> between the two enhancers, i.e., a specific example in support of the enhancer independence assumed in GEMSTAT-GL.</p>
<p>We show in <xref ref-type="fig" rid="pcbi-1003467-g008">Figure 8</xref>, using a heat map, the outcome of the above analysis performed on the five enhancers contributing towards the <italic>eve</italic> gene's expression. Rows in this heat map represent binding sites within the enhancers, and columns represent enhancers. The cell at row <italic>i</italic> and column <italic>j</italic> represents the effect (on model fits) of allowing the binding site <italic>i</italic> to interact with enhancer <italic>j</italic>. Red indicates that modeling this interaction leads to worse fits, suggesting that the interaction is avoided in reality through unknown mechanisms of enhancer independence. Green color in the heat map suggests a synergistic interaction.</p>
<fig id="pcbi-1003467-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003467.g008</object-id><label>Figure 8</label><caption>
<title>A heatmap visualization of the changes in GEMSTAT-GL's goodness-of-fit owing to interactions between the enhancers selected for the <italic>eve</italic> gene.</title>
<p>The heatmap has 5 columns and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e001" xlink:type="simple"/></inline-formula> rows, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e002" xlink:type="simple"/></inline-formula> denotes the total number of binding sites in the five <italic>eve</italic> enhancers. Each row in the heatmap represents a binding site; the ordering of the rows, from top to bottom, reflects the 5′ to 3′ order of the respective binding sites in the locus. Each horizontal dot-dash line demarcates binding sites from two different enhancers. Each column in the heatmap represents an enhancer; the columns are ordered, from left to right, according to the 5′ to 3′ order of the corresponding enhancers in the locus. The cell at row <italic>i</italic> and column <italic>j</italic> represents, on a green-to-red color scale (green: high, red: low), the effect of allowing the binding site <italic>i</italic> to interact with enhancer <italic>j</italic>. This effect quantifies how the goodness-of-fit improves (green) or decreases (red) when interactions are allowed (see <xref ref-type="sec" rid="s4">Materials and Methods</xref> for details). Two segments <italic>S<sub>1</sub></italic> and <italic>S<sub>2</sub></italic> within the <italic>eve</italic> stripe 2 enhancer are shown on the left of the heatmap, along with their constituent binding sites for TFs KR, TLL, KNI, BCD. Each of these segments has binding sites that, when allowed to interact with the eve_3_7 enhancer, result in poorer fits.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003467.g008" position="float" xlink:type="simple"/></fig>
<p>Heat maps for the four genes modeled in this study (<xref ref-type="fig" rid="pcbi-1003467-g008">Figure 8</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003467.s007">Figure S7</xref>) highlighted the necessity of their enhancers to act autonomously. The many red cells indicate that such interaction must be explicitly avoided. For instance, we noted that a segment containing KR sites within the <italic>eve</italic> stripe 2 enhancer (Segment <italic>S<sub>1</sub></italic>, <xref ref-type="fig" rid="pcbi-1003467-g008">Figure 8</xref>) adversely affects the predicted readout of the <italic>eve</italic> stripe 3+7 enhancer. These KR sites, when included in modeling the stripe 3+7 enhancer result in a weaker stripe 3, since the expression domain of KR covers <italic>eve</italic> stripe 3. A similar effect is noted for a second segment in the stripe 2 enhancer (Segment <italic>S<sub>2</sub></italic>, <xref ref-type="fig" rid="pcbi-1003467-g008">Figure 8</xref>) that contains four KNI sites, which adversely influence modeling of the stripe 3+7 enhancer. Although the latter contains several KNI sites, the four additional KNI sites impart more repression than necessary and hence a deterioration in the quality of fit. (This deterioration is, however, less severe than that caused by the first segment.) These examples provide more detailed insights into why we failed in our initial attempts to model gene expression from an entire locus using GEMSTAT, where all such interactions were allowed.</p>
</sec></sec><sec id="s3">
<title>Discussion</title>
<p>We have presented for the first time a quantitative model that relates gene expression to the sequence of an entire gene locus, using information on the trans-regulatory context (TF concentrations). We started by showing that the thermodynamics-based model “GEMSTAT” accurately models individual enhancer readouts, but fails to model the entire locus. We then performed a series of tests where we changed the way the GEMSTAT model was applied to the locus, all of which resulted in failure. We developed a new model called GEMSTAT-GL where the expression readout of the locus is two-tiered: sites within each enhancer act together to produce that enhancer's contribution, and contributions from multiple enhancers are aggregated to produce the gene's expression pattern. This model shows very good fits to the data (<xref ref-type="fig" rid="pcbi-1003467-g004">Figure 4</xref> and <xref ref-type="fig" rid="pcbi-1003467-g005">Figure 5</xref>) for the 27 genes studied here, and most remarkably for the complex, seven-stripe patterns of <italic>eve</italic>, <italic>h</italic>, and <italic>run</italic>. The process of training the model on a gene locus automatically predicts enhancers in that locus, without relying on chromatin accessibility data, and makes accurate assignments of regulatory activity to each of the predicted enhancers. We will make available, upon publication, a general-purpose implementation of the GEMSTAT-GL model that may be applied to any gene for which the relevant inputs (TFs, TF motifs, TF concentrations) and output (gene expression) are known. The implementation also allows users to include chromatin accessibility data as a filter on the locus being modeled.</p>
<p>We note that the GEMSTAT-GL model, as presented here, is given an intergenic sequence and its expression readout, and it finds a plausible explanation of whether and how the sequence could drive that expression. As such, it can be applied, in principle, to any of the thousands of genes whose embryonic expression patterns are known from <italic>in situ</italic> hybridization assays <xref ref-type="bibr" rid="pcbi.1003467-Tomancak1">[76]</xref>. Once trained, the model reveals the cis-regulatory architecture of the locus (locations and readouts of individual enhancers), and can predict the effects of perturbations in cis (sequence) or trans (TF concentration).</p>
<p>However, the model cannot currently be used to predict the expression readout of a gene locus from sequence only. This is because the locations of contributing segments in the locus are free parameters of the model and can be learnt only if the gene expression readout is known. Thus, the model performance reported here refers only to “training data accuracy”, and leaves open the possibility of over-fitting. However, the model training failed on a variety of different “negative control” tests, where there was no link between the given sequence and expression, thus addressing concerns of over-fitting. We expect future work to address the current limitation that prevents the new model from a full-fledged application to the genome. One way this may be achieved is through intelligent use of accessibility and chromatin state information <xref ref-type="bibr" rid="pcbi.1003467-Kharchenko1">[33]</xref>, <xref ref-type="bibr" rid="pcbi.1003467-Ernst2">[77]</xref> from the locus when selecting segments that contribute to gene expression.</p>
<p>Another potential limitation of this work is its reliance on prior knowledge of the TFs relevant to the regulatory system being studied (the A/P patterning system here). Ideally, the model should be able to automatically identify the TFs that are needed to explain the data, but this ability was not tested in this work. In a separate work <xref ref-type="bibr" rid="pcbi.1003467-Samee1">[52]</xref>, we address the question of systematically identifying the TFs to use when modeling enhancers using GEMSTAT.</p>
<p>A basic principle underlying GEMSTAT-GL is the modular view of the gene locus' readout, which holds that individual enhancers drive discrete aspects (e.g., one or two stripes) of the gene's expression pattern, through combinatorial action of the binding sites within them, and the overall gene expression pattern results from a superposition of these separate enhancer readouts. Our tests showed that a model that violates this modular view and instead interprets all binding sites in the locus as acting together is unlikely to fit the data. In other words, the rules for interpreting the set of sites across all enhancers are not the same as the rules that apply to sites within an enhancer. The final subsection of RESULTS provides details of this principle in action: the different enhancers have the potential to interfere with each other, i.e., if some sites in one enhancer, say S<sub>i</sub>, are interpreted together with sites of another enhancer, say S<sub>j</sub>, the combined readout may be different from the readout of S<sub>j</sub> itself.</p>
<p>Another defining aspect of our model is the use of a “weighted sum” as the aggregator of multiple enhancer readouts. We note that the weights assigned by the model to different contributing segments (enhancers) are comparable to each other (<xref ref-type="supplementary-material" rid="pcbi.1003467.s002">Figure S2</xref>), and that a simple unweighted sum captures the seven stripe pattern of gene expression qualitatively (<xref ref-type="supplementary-material" rid="pcbi.1003467.s002">Figure S2</xref>), but fails to capture the “valley” between stripes 2 and 3 for <italic>eve</italic> and between stripes 4 and 5 for <italic>run</italic>; whereas the prediction for <italic>h</italic> remains relatively unaffected. Thus, the use of non-uniform weights may be a way for our model to correct for inaccuracies of the GEMSTAT model in predicting enhancer readout, especially at stripe borders. These weights need not be a reflection of any fundamental biochemical preference for one enhancer over another.</p>
<p>One may speculate on biochemical mechanisms that implement the two-tiered readout of the regulatory information at the locus, and the additive aggregator function. An obvious possibility is that each contributing segment interacts with the promoter separately, as shown in <xref ref-type="fig" rid="pcbi-1003467-g009">Figure 9A</xref>. In the example shown, there are two enhancers and three possible configurations of enhancer-promoter interaction. The “Boltzmann weight” of each configuration is assumed to depend only on the enhancer interacting with the promoter in that configuration. Let these weights be 1, η<sub>B</sub> and η<sub>A</sub> for the configurations at the top, middle and bottom respectively. Assuming that gene expression ‘<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e003" xlink:type="simple"/></inline-formula>’ is proportional to the total probability ‘<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e004" xlink:type="simple"/></inline-formula>’ of configurations with any enhancer-promoter interaction, we get:<disp-formula id="pcbi.1003467.e005"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003467.e005" xlink:type="simple"/></disp-formula>First, let us consider a trans-regulatory context where one of the enhancers (say A) drives expression and the other (say B) does not. This can be formulated as:<disp-formula id="pcbi.1003467.e006"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003467.e006" xlink:type="simple"/></disp-formula>Under these conditions, we get <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e007" xlink:type="simple"/></inline-formula>, i.e., the contributions of the two enhancers add up to produce the expression driven by the locus. Thus, if a gene is under the control of multiple enhancers and if a single enhancer dominates all others in any particular trans-regulatory context (position along the A/P axis, for pair rule genes), we expect the combined readout of the multiple enhancers to be a sum of their individual readouts.</p>
<fig id="pcbi-1003467-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003467.g009</object-id><label>Figure 9</label><caption>
<title>(A) A gene locus with two enhancers (A and B) can be in one of three different configurations of enhancer-promoter interaction: (top) neither enhancer interacts with promoter, (middle) only B interacts and (bottom) only A interacts.</title>
<p>In a configuration where A interacts with promoter, B does not interact, and vice versa. (B) Combining contributions from two enhancers. If each enhancer's contribution is given by the gene expression probability <italic>p</italic> due to that enhancer, the combined contribution of the two enhancers (assuming independent interactions with the promoter) is 2p/(1+p), plotted in red. For small values of p, this is well approximated by 2p (green), the sum of their contributions. For larger values of <italic>p</italic>, a better approximation is provided by the function 1−(1−p)<sup>2</sup>, in blue.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003467.g009" position="float" xlink:type="simple"/></fig>
<p>Now consider a trans-regulatory context where both enhancers A and B (of <xref ref-type="fig" rid="pcbi-1003467-g009">Figure 9A</xref>) have comparable outputs. We may formulate this as:<disp-formula id="pcbi.1003467.e008"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003467.e008" xlink:type="simple"/></disp-formula>It is easily shown that in this case<disp-formula id="pcbi.1003467.e009"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003467.e009" xlink:type="simple"/></disp-formula>We plot this function, representing the combined readout of the locus, in <xref ref-type="fig" rid="pcbi-1003467-g009">Figure 9B</xref>. For small values of <italic>p</italic> (&lt;0.2), this function is reasonably approximated by 2<italic>p</italic>, indicating that the enhancer contributions add up. Note that a value of <italic>p</italic> = 0.2 does not necessarily mean low gene expression; under the Shea &amp; Ackers theory, expression levels are only <italic>proportional</italic> to <italic>p</italic> as defined here. For larger values of <italic>p</italic>, we see that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e010" xlink:type="simple"/></inline-formula> is better approximated by the function 1−(1−p)<sup>2</sup>, which represents the model of enhancer synergy proposed by Perry et al. <xref ref-type="bibr" rid="pcbi.1003467-Perry1">[43]</xref>. In this case, the separate readouts of enhancers do not combine additively. Another scenario in which additivity is not expected is where multiple enhancers can interact simultaneously with the promoter, as is the case in the “long range dominant repression” model of Perry et al. <xref ref-type="bibr" rid="pcbi.1003467-Perry1">[43]</xref>. We explicitly prohibited such a configuration in the model of <xref ref-type="fig" rid="pcbi-1003467-g009">Figure 9A</xref>. We should also note that, the aforementioned assumptions do not preclude overlapping enhancers. Discovery of overlapping enhancers, in this modeling framework, is not therefore a violation of the linearity assumption.</p>
<p>In light of the simplistic arguments presented above, we suggest that the model illustrated in <xref ref-type="fig" rid="pcbi-1003467-g009">Figure 9A</xref>, with the strength of each enhancer-promoter interaction being unaffected by other enhancers in the locus, as a mechanistic basis of the GEMSTAT-GL model. Additivity of enhancer contributions in any given trans-regulatory context can be explained by this model as arising out of (a) one enhancer's contribution dominating all others or (b) each enhancer's contribution being at a relatively low level, i.e., the probability <italic>p</italic> defined above being not close to 1.</p>
<sec id="s3a">
<title>A note on parameter estimation for the locus-level modeling problem</title>
<p>A locus-level model of gene expression requires more precision than an enhancer-level model. The success of an enhancer-level model is typically assessed from its precision in modeling the position of the peaks of the expression domains driven by an enhancer. Consequently, the most successful enhancer-level models produce qualitatively accurate expression patterns for each enhancer but may not capture the peak amplitude of expression domains correctly. That is, relative peak amplitudes of readouts from two enhancers are often inconsistent with model predictions. Another type of imprecision noted in enhancer-level models is the inability to predict the sharp boundaries of expression domains. A locus-level model cannot afford to tolerate such imprecision, especially when it is applied to model complex multi-stripe expression patterns. The two weaknesses of enhancer-level model fits mentioned above can cause our locus-level model to predict qualitatively inaccurate expression patterns (e.g., miss an inter-stripe boundary), and are likely to lead to false regulatory sequence discovery and wrong inference about the roles of TFs. At the same time, the quantitative imprecision in predicted enhancer readouts may be unavoidable at this time due to fundamental limitations of the thermodynamic model, e.g., biochemical mechanisms that are not modeled.</p>
<p>Our strategy of optimizing the thermodynamic parameters for each gene separately was a pragmatic decision made to compensate for the minor inaccuracies of enhancer-level modeling. As shown in <xref ref-type="supplementary-material" rid="pcbi.1003467.s008">Figure S8</xref>, when GEMSTAT-GL was optimized without re-training the thermodynamic parameters (thus, the locations and the weights of the windows were the only free parameters in the model), it could still capture the correct locations for five of the seven stripes of <italic>eve</italic> expression but suffered severely in terms of modeling the inter-stripe valleys. Thus, fitting the thermodynamic parameters in a locus-specific manner helps GEMSTAT-GL to achieve the desired accuracy. It is plausible that this strategy might lead to over-fit GEMSTAT-GL for the single intergenic locus being modeled. This is why we performed four different types of negative controls, to demonstrate that the constraints imposed on the parameters during model optimization are strongly guarding us against over-fitting the model for any specific locus.</p>
<p>In a recent study <xref ref-type="bibr" rid="pcbi.1003467-Kim1">[18]</xref>, Kim et al. trained thermodynamics-based models on a collection of <italic>eve</italic> enhancers in order to provide deeper insights into combinatorial cis-regulatory logic, which, as they pointed out, is a pre-requisite for locus-level modeling of gene expression. Among other findings, they reported a model that predicts <italic>eve</italic> stripes 2, 3, and 7 from the sequence upstream of the gene, and a different model (i.e., different parameter settings) that predicts stripes 4, 5, and 6 from the sequence downstream of the gene. Their results, in addition to providing insights about functioning of enhancers, highlight the difficulty of modeling the readout of an entire gene locus using pre-determined parameters, even when the models are accurate at the enhancer level. This agrees with our own view mentioned above, and suggests that fitting thermodynamic parameters for individual loci, with appropriate constraints, is a necessary step at the current stage of computational modeling of gene expression from the locus.</p>
</sec></sec><sec id="s4" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="s4a">
<title>Data collection</title>
<p>We collected enhancers previously reported to regulate the genes <italic>eve</italic>, <italic>h</italic>, <italic>run</italic>, and <italic>gt</italic> from the REDfly database <xref ref-type="bibr" rid="pcbi.1003467-Gallo1">[60]</xref>. We also extracted the embryonic expression pattern of each of these genes during the temporal class 5 in nuclear division cycle 14A, from the FlyEx database <xref ref-type="bibr" rid="pcbi.1003467-Pisarev1">[57]</xref>. The FlyEx database provides the expression level as a function of the A/P axis, obtained after appropriate normalization and averaging over embryos. Expression profiles for known enhancers were derived from respective gene expression profiles based on prior knowledge about which stripes correspond to each enhancer (See <xref ref-type="supplementary-material" rid="pcbi.1003467.s009">Figure S9</xref> for details). We note that, although the real expression profiles being modeled in GEMSTAT and GEMSTAT-GL are shown in the figures as scaled between 0 and 1, it is not a requirement of the models. The output of our models is a probability value, and the gene expression is assumed to be <italic>proportional</italic> to this probability. As such, the models' output (probability) can be scaled and compared against any quantitative expression level. Position weight matrices (PWMs) of all the TFs were taken from the Fly Factor Survey database <xref ref-type="bibr" rid="pcbi.1003467-Noyes1">[78]</xref>. Protein concentration profiles of the TFs along the A/P axis were obtained from the FlyEx database <xref ref-type="bibr" rid="pcbi.1003467-Pisarev1">[57]</xref> and the data set used in <xref ref-type="bibr" rid="pcbi.1003467-Kazemian1">[13]</xref>. The data sets are made available at <ext-link ext-link-type="uri" xlink:href="http://veda.cs.uiuc.edu/gemstat-gl/index.htm" xlink:type="simple">http://veda.cs.uiuc.edu/gemstat-gl/index.htm</ext-link>.</p>
</sec><sec id="s4b">
<title>The GEMSTAT model</title>
<p>This is described in detail in our previous work <xref ref-type="bibr" rid="pcbi.1003467-He1">[11]</xref>, and here we review its main ideas. As per the model, transcriptional regulation takes place through the interaction of three major components: (a) DNA sequence, (b) TF molecules, and (c) the basal transcriptional machinery (BTM). A TF molecule may bind the sequence at any binding site, with site-specific affinity. The BTM may bind at the core promoter of the gene, and it initiates transcription when thus bound. Interactions between bound TF molecules and the BTM (possibly through co-factors, which are not explicitly modeled) determine the occupancy, i.e., probability of binding, of the BTM at the promoter. We assume, following Shea &amp; Ackers <xref ref-type="bibr" rid="pcbi.1003467-Shea1">[50]</xref>, that the level of gene expression depends primarily on the rate of transcription initiation, and in particular on the BTM occupancy.</p>
<p>Being a statistical thermodynamics model, GEMSTAT considers an ensemble of molecular configurations of the transcriptional regulatory machinery; each configuration, denoted by <italic>σ</italic>, specifies which sites in the DNA sequence are bound by cognate TFs. For every configuration <italic>σ</italic>, GEMSTAT computes two quantities: (a) the Boltzmann weight of <italic>σ</italic>, denoted by <italic>W(σ)</italic>, and (b) the transcriptional effect of <italic>σ</italic> on the BTM, denoted by <italic>Q(σ)</italic>. The Boltzmann weight <italic>W(σ)</italic> is calculated based on TF concentration and the binding affinity of every bound site in <italic>σ</italic>, which in turn is estimated from the sequence and the TF motif <xref ref-type="bibr" rid="pcbi.1003467-Stormo1">[79]</xref>. The transcriptional effect <italic>Q(σ)</italic> represents interactions between bound TF molecules of configuration <italic>σ</italic> and the promoter-bound BTM, and is modeled with free parameters (one per TF) reflecting such interactions. Every configuration <italic>σ</italic> of the regulatory sequence corresponds to two configurations of the entire regulatory apparatus, depending on whether the BTM is bound or not. The relative probability of bound BTM is given by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e011" xlink:type="simple"/></inline-formula> and the gene expression level is assumed proportional to <italic>E</italic>. GEMSTAT models self-cooperative DNA-binding by any TF through a free parameter (cooperativity term) that is multiplied with <italic>W(σ)</italic> for every occurrence of an adjacent pair of bound sites within a fixed distance from each other.</p>
</sec><sec id="s4c">
<title>Modeling enhancers with GEMSTAT</title>
<p>We performed simultaneous training of GEMSTAT parameters on all known enhancers of a gene. The inputs were the sequence of each enhancer, and the motifs and A/P concentration profiles of nine relevant TFs. GEMSTAT learns optimal parameters such that its predictions for A/P expression pattern of each enhancer matches the corresponding real pattern. GEMSTAT was used in the “DIRECT INTERACTION” mode (see <xref ref-type="bibr" rid="pcbi.1003467-He1">[11]</xref>) unless stated otherwise. The number of free parameters is 28 (three per TF, plus one global parameter), and raises concerns about over-fitting. To address this, a “constrained parameter estimation strategy” was used, as described below.</p>
</sec><sec id="s4d">
<title>Constrained parameter estimation strategy</title>
<p>To guard against over-fitting, we used the following model training strategy. We first trained GEMSTAT on ∼40 enhancers with A/P patterned expression <xref ref-type="bibr" rid="pcbi.1003467-Segal1">[14]</xref>, while excluding enhancers of the given gene. Training on this large data set greatly constrains the model and rules out over-fitting. We used the parameter values thus obtained as the starting point of the parameter training procedure on regulatory sequences of the given gene. Thereafter, the training procedure was prohibited from altering any parameter's value by more than two fold from its initial value. This strategy ensured that the final model trained on the given gene is largely consistent with a model that reflects other regulatory parts of the genome.</p>
</sec><sec id="s4e">
<title>Modeling a gene locus with GEMSTAT</title>
<p>This was performed just as any individual enhancer would be modeled by GEMSTAT. The inputs were the sequence of the locus, and the motifs and concentration profiles of the nine TFs. GEMSTAT's goal was to learn parameters such that its prediction for the readout of the entire locus matches the gene expression pattern, as quantified by the “weighted Pattern Generating Potential” (w-PGP) score described in the next paragraph. Also, since we claim (see RESULTS) that GEMSTAT is unable to model gene loci, we used an unconstrained parameter estimation strategy where the model training procedure was free to use any parameter values within a reasonable range.</p>
</sec><sec id="s4f">
<title>Evaluation of model predictions using “weighted pattern generating potentials”</title>
<p>Two obvious approaches to assess the agreement between real and predicted expression profiles are the “sum of squared errors” or “correlation coefficient”. However, as shown in our previous work <xref ref-type="bibr" rid="pcbi.1003467-Kazemian1">[13]</xref>, these do not always capture the salient features of an A/P expression pattern. We devised a new scoring function, called “weighted pattern generating potential” (w-PGP) to address this issue. The score is explained in <xref ref-type="supplementary-material" rid="pcbi.1003467.s010">Figure S10</xref> and its legend. It is a modification of the “PGP” score of <xref ref-type="bibr" rid="pcbi.1003467-Kazemian1">[13]</xref>. The essence of w-PGP is to reward the agreement between real and predicted readouts and penalize the disagreement. We have performed detailed explorations of the w-PGP score in a separate work <xref ref-type="bibr" rid="pcbi.1003467-Samee1">[52]</xref> and found it to be superior to the sum of squared errors or the correlation coefficient.</p>
</sec><sec id="s4g">
<title>GEMSTAT-GL model for predicting gene expression from intergenic sequence</title>
<p>The new quantitative model for predicting gene expression from the entire locus of a gene operates in two tiers (<xref ref-type="fig" rid="pcbi-1003467-g002">Figure 2</xref>). Recall that the inputs to the model are (i) the sequence of the locus, TF motifs, and TF concentration profiles along the A/P axis, and (ii) the gene's expression profile (assumed here to be multiple stripes along the axis). The trained model comprises (i) a set of windows (possibly of varying length, and possibly overlapping each other) in the locus, and their “window weights” (positive numbers), and (ii) values for GEMSTAT parameters reflecting TF-DNA, TF-BTM, and TF-TF interactions. The model's prediction of gene expression is the weighted sum of readouts from every window in the model, the readouts being predicted by GEMSTAT, and the weights being the window weights mentioned above. More specifically, we optimize the following function.<disp-formula id="pcbi.1003467.e012"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003467.e012" xlink:type="simple"/></disp-formula>where,</p>
<list list-type="bullet"><list-item>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e013" xlink:type="simple"/></inline-formula> is a vector representing the expression pattern of the gene being modeled. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e014" xlink:type="simple"/></inline-formula> element of this vector denotes the relative level of gene expression at the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e015" xlink:type="simple"/></inline-formula> position along the spatial axis;</p>
</list-item><list-item>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e016" xlink:type="simple"/></inline-formula> is a vector representing the thermodynamic parameters;</p>
</list-item><list-item>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e017" xlink:type="simple"/></inline-formula> is a vector representing the window-weights. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e018" xlink:type="simple"/></inline-formula> element of this vector denotes the weight of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e019" xlink:type="simple"/></inline-formula> window included in the solution;</p>
</list-item><list-item>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e020" xlink:type="simple"/></inline-formula> is a matrix of dimension <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e021" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e022" xlink:type="simple"/></inline-formula> denotes the number of windows included in the solution (hence, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e023" xlink:type="simple"/></inline-formula>). The first and second elements in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e024" xlink:type="simple"/></inline-formula> row of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e025" xlink:type="simple"/></inline-formula>denote the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e026" xlink:type="simple"/></inline-formula> window's location and length, respectively; and</p>
</list-item><list-item>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e027" xlink:type="simple"/></inline-formula> denotes the dot-product <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e028" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e029" xlink:type="simple"/></inline-formula> being a matrix whose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e030" xlink:type="simple"/></inline-formula> row represents the readout of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e031" xlink:type="simple"/></inline-formula> window as predicted by GEMSTAT using the parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e032" xlink:type="simple"/></inline-formula>. Note that, the location and the length of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e033" xlink:type="simple"/></inline-formula> window are specified by the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e034" xlink:type="simple"/></inline-formula> row of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e035" xlink:type="simple"/></inline-formula>.</p>
</list-item></list>
<p>We describe here the procedure for training the two-tiered model, given its input. The procedure learns optimal values of the GEMSTAT parameters as well as “window weight” parameters (see above) that maximize the w-PGP score between the gene expression profile and the model's prediction. A model is denoted by <italic>M = (</italic><bold><italic>W</italic></bold><italic>, </italic><bold><italic>σ</italic></bold><italic>, </italic><bold><italic>θ</italic></bold><italic>)</italic> where <bold><italic>W</italic></bold> is a set of sequence windows from the locus, <bold><italic>σ</italic></bold> is the set of window weights, one for each window in <bold><italic>W</italic></bold>, and <bold><italic>θ</italic></bold> is a set of GEMSTAT parameters. The model training happens in two phases. In the beginning, <bold><italic>θ</italic></bold> is set to GEMSTAT parameters learned from a large set of known enhancers excluding any known enhancers of the target gene.</p>
<sec id="s4g1">
<title>Phase 1</title>
<p>In the first phase, the algorithm scans the intergenic sequence to find <italic>N = 5</italic> best sequence windows for each stripe in the gene expression pattern. To do so, it examines every window starting at 100 bp intervals in the locus, and of length between 500 bp and 2500 bp. (These are user-configurable parameters.) It scores every window <italic>W</italic> against every stripe <italic>S</italic> of the target gene expression, based on how well the expression read-out of <italic>W</italic> (predicted by GEMSTAT) fits the expression profile of <italic>S</italic>. The fit is quantified by the w-PGP score. At the end of this phase, the algorithm has found a set of <italic>N</italic> best windows for each stripe <italic>S</italic>, denoted by <italic>C(S)</italic>.</p>
</sec><sec id="s4g2">
<title>Phase 2</title>
<p>Next, the algorithm iteratively selects windows to include in the model, and learns their corresponding window weights. In the <italic>i<sup>th</sup></italic> iteration, it builds a model <italic>M<sub>i</sub> = (</italic><bold><italic>W<sub>i</sub></italic></bold><italic>, </italic><bold><italic>σ<sub>i</sub></italic></bold><italic>, </italic><bold><italic>θ</italic></bold><italic>)</italic> for the first <italic>i</italic> stripes of gene expression. A pseudo-code is provided next.</p>
<p>Given: GEMSTAT parameters <bold><italic>θ</italic></bold> and a candidate set of windows <italic>C(S)</italic> for every stripe <italic>S</italic>.</p>
<p>Initialization: <bold><italic>W<sub>0</sub></italic></bold>: = NULL; <italic>BESTSCORE<sub>0</sub></italic>: = 0.</p>
<p>For <italic>i</italic>: = 1 to <italic>K</italic> (the number of stripes in gene expression pattern) do:</p>
<list list-type="order"><list-item>
<p><bold><italic>W<sub>i</sub></italic></bold>: = <bold><italic>W<sub>i−1</sub></italic></bold>; <italic>BESTSCORE<sub>i</sub></italic>: = <italic>BESTSCORE<sub>i−1</sub></italic>;</p>
</list-item><list-item>
<p>For each window <italic>w</italic> in <italic>C(S<sub>i</sub>)</italic> do</p>
<list list-type="alpha-lower"><list-item>
<p>Define a new set <italic>W′</italic> = <bold><italic>W<sub>i</sub></italic></bold> U {<italic>w</italic>}</p>
</list-item><list-item>
<p>Let <bold><italic>σ</italic></bold> be a set of window weights, one weight for each window in W′. Let Score<sub>i</sub>(<bold><italic>W′</italic></bold>, <bold><italic>σ</italic></bold>) denote the w-PGP score that compares (i) the two-tiered model predictions using windows of <bold><italic>W′</italic></bold> and window weights <bold><italic>σ</italic></bold>, and (ii) the gene expression pattern limited to the first <italic>i</italic> stripes or expression domains. (The stripes were considered arbitrarily from anterior to posterior.)</p>
</list-item><list-item>
<p>Find <bold><italic>σ</italic></bold> that maximizes <italic>Score<sub>i</sub>(</italic><bold><italic>W′</italic></bold><italic>, </italic><bold><italic>σ</italic></bold><italic>)</italic> over all possible <bold><italic>σ</italic></bold>. This maximization is performed through alternating between the Simplex and the Gradient Descent algorithms for numerical optimization. Denote max<bold><italic><sub>σ</sub></italic></bold><italic> Score<sub>i</sub>(</italic><bold><italic>W′</italic></bold><italic>, </italic><bold><italic>σ</italic></bold><italic>)</italic> by <italic>Score(w)</italic>.</p>
</list-item></list>
</list-item><list-item>
<p>Let <italic>w<sup>*</sup></italic> denote the window that maximizes <italic>Score(w)</italic> in the previous step.</p>
</list-item><list-item>
<p>If <italic>Score(w<sup>*</sup>)</italic> is greater than <italic>BESTSCORE<sub>i</sub></italic>, then</p>
<list list-type="alpha-lower"><list-item>
<p><bold><italic>W<sub>i</sub></italic></bold>: = <bold><italic>W<sub>i</sub></italic></bold> U {<italic>w<sup>*</sup></italic>}</p>
</list-item><list-item>
<p><italic>C(S<sub>i</sub>)</italic>: = <italic>C(S<sub>i</sub>)\w*</italic></p>
</list-item><list-item>
<p><italic>BESTSCORE<sub>i</sub></italic>: = <italic>Score(w<sup>*</sup>)</italic></p>
</list-item><list-item>
<p>Loop back to (2).</p>
</list-item></list>
</list-item></list>
<p>At the end of this phase, a model <italic>M = (</italic><bold><italic>W</italic></bold><italic>, </italic><bold><italic>σ</italic></bold><italic>, </italic><bold><italic>θ</italic></bold><italic>)</italic> has been found for the entire expression pattern. Now, the GEMSTAT parameters <bold><italic>θ</italic></bold> are retrained while keeping <bold><italic>W</italic></bold> and <bold><italic>σ</italic></bold> fixed. The algorithm then loops back to Phase 1. It iterates through these two phases until a constant number <italic>N<sub>I</sub></italic> of iterations have been completed or the improvement in the model's w-PGP score is less than a small constant <italic>δ&gt;0</italic>. We set <italic>N<sub>I</sub> = 100</italic> and <italic>δ = 10<sup>−4</sup></italic> for training the models in this paper.</p>
<p>We note that, the GEMSTAT model <xref ref-type="bibr" rid="pcbi.1003467-He1">[11]</xref> is used in two contexts while training GEMSTAT-GL. First, to compute the initial estimates for GEMSTAT-GL's thermodynamic parameters, we optimize GEMSTAT for ∼40 A/P patterning enhancers associated with genes other than the gene being modeled. The objective function used to optimize GEMSTAT for this purpose was the average of the w-PGP scores of all enhancers in the dataset. Starting from these initial values, GEMSTAT-GL then searches the parameter space for better estimates of its thermodynamic parameters. In the second scenario, GEMSTAT is used to compute the readout of every window that GEMSTAT-GL examines within the locus (i.e., in Phase 1 described above). In this case, GEMSTAT-GL inputs its thermodynamic parameters and a sequence window to GEMSTAT, which then outputs the readout of the given window resulting from the input parameters.</p>
</sec></sec><sec id="s4h">
<title>Control experiments</title>
<p>(1) One of the negative control experiments involved modeling a gene's expression pattern from a randomly generated sequence of the same length as the gene locus. The random sequence was generated by independently sampling each nucleotide from a common frequency distribution. (2) Another negative control experiment involved modeling a “random” expression pattern from the sequence of a gene locus. Random expression patterns were generated based on the gene's real expression pattern, as follows. First, for any axial position, let us define the gene to be OFF if the expression value is less than 0.5 and ON otherwise. Then, for a gene <italic>G</italic> whose actual expression profile has <italic>N</italic> stripes and <italic>K</italic> axial positions where it is ON, we defined a “random” expression profile as one where: (a) the number of stripes is a randomly chosen number between <italic>N/2</italic> and <italic>N</italic>, (b) the stripes are located randomly along the A/P axis, and (c) there are <italic>K</italic> data points where it is ON. Computation of such a random expression is detailed in <xref ref-type="supplementary-material" rid="pcbi.1003467.s011">Figure S11</xref>. (3) In the final set of negative control experiments we used a “variant” of a gene's locus, where the TF binding sites were relocated to randomly selected positions within the locus, to model the gene's expression pattern.</p>
</sec><sec id="s4i">
<title>Constructing a regulatory network of TF-stripe interaction through <italic>in silico</italic> TF knockdown</title>
<p>In order to infer edges in the TF-stripe interaction networks, we repeated the following steps for each TF. First the relative concentration of the TF being examined was set to zero at every position along the A/P axis (the relative concentration profiles of all other TFs were left unchanged). This was essentially an <italic>in silico</italic> knock-down of the TF being examined. A GEMSTAT-GL model trained earlier using real data for the target gene was then re-run on this new data (but not optimized anew). We then observed the resulting output and inferred edges in the network as follows. If knock-down of the TF was found to weaken a stripe's expression (by at least 2%), we inferred an activation edge from the TF to the stripe. In case the knock-down was found to strengthen the stripe's expression (by at least 2%) and/or shift the stripe's boundary (by at least 1% of the A/P axis at the position of half-maximum peak expression), we inferred a repression edge.</p>
</sec><sec id="s4j">
<title>Sampling the two-tiered model</title>
<p>As noted above, a model is denoted by <italic>M = (</italic><bold><italic>W</italic></bold><italic>, </italic><bold><italic>σ</italic></bold><italic>, </italic><bold><italic>θ</italic></bold><italic>)</italic> where <bold><italic>W</italic></bold> is a set of sequence windows from the locus, <bold><italic>σ</italic></bold> is the set of window weights, one for each window in <bold><italic>W</italic></bold>, and <bold><italic>θ</italic></bold> is a set of GEMSTAT parameters. We described above a local search algorithm to find the optimal model. We also performed MCMC sampling of the space of all possible windows and window-weights, i.e., <italic>(</italic><bold><italic>W</italic></bold><italic>, </italic><bold><italic>σ</italic></bold><italic>)</italic> for a global examination of the expression contributions of segments in the locus.</p>
<sec id="s4j1">
<title>Sample space</title>
<p>Each sample is an <italic>extended</italic> weight vector <bold>σ</bold> that has one real number for every possible window in the locus. Recall that this includes windows of length between 500 and 2500 (in increments of 50), with start positions that are multiples of 100 bp. Note also that any <bold>σ</bold> corresponds to a particular model <italic>M</italic><sub>σ</sub>: the window set <bold><italic>W</italic></bold> is determined by the non-zero weights in <bold>σ</bold>, and the GEMSTAT parameters <bold><italic>θ</italic></bold> are assumed fixed. The w-PGP score of model <italic>M</italic><sub>σ</sub> is denoted by Score(<bold>σ</bold>), and the MCMC attempts to sample <bold>σ</bold> with probability proportional to Score(<bold>σ</bold>).</p>
</sec><sec id="s4j2">
<title>Sampling algorithm</title>
<p>We used the Metropolis-Hastings algorithm to sample <bold>σ</bold>. The allowed moves from a current sample <bold><italic>σ<sub>i</sub></italic></bold> are determined as follows. Let <bold><italic>b<sub>i</sub></italic></bold> be a bit vector of the same dimensionality as <bold><italic>σ<sub>i</sub></italic></bold> and its <italic>j<sup>th</sup></italic> bit being defined as <italic>b<sub>ij</sub></italic> = 1 if <italic>σ<sub>ij</sub></italic>&gt;0 and <italic>b<sub>ij</sub></italic> = 0 otherwise. That is, <bold><italic>b<sub>i</sub></italic></bold> indicates which windows have positive weights in <bold><italic>σ<sub>i</sub></italic></bold>. The samples reachable in one move from the current sample <bold><italic>σ<sub>i</sub></italic></bold> (with bit vector <bold><italic>b<sub>i</sub></italic></bold>) are those with bit vectors within a Hamming distance of 2 from <bold><italic>b<sub>i</sub></italic></bold>. In other words, any move adds or deletes at most two windows from consideration in the first tier of the model. The proposal distribution of the Metropolis Hastings algorithm is described next. Given a current sample <bold><italic>σ<sub>i</sub></italic></bold> (with bit vector <bold><italic>b<sub>i</sub></italic></bold>), we choose two bits at random and toggle each bit with probability 1/2. This samples a bit vector <bold><italic>b<sub>j</sub></italic></bold> that is (a) identical to <bold><italic>b<sub>i</sub></italic></bold> with probability ¼, (b) 1 Hamming distance from <bold><italic>b<sub>i</sub></italic></bold> with probability ½, and (c) 2 Hamming distance from <bold><italic>b<sub>i</sub></italic></bold> with probability ¼. All bit vectors with a particular Hamming distance are equally likely. There are <italic>L</italic> = |<italic>b<sub>i</sub></italic>| of these at Hamming distance 1, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003467.e036" xlink:type="simple"/></inline-formula> of these at Hamming distance 2. The newly sampled bit vector <bold><italic>b<sub>j</sub></italic></bold> is then used as the “shape vector” of a Dirichlet distribution, from which a probability vector is sampled. This is the newly sampled weight vector <bold><italic>σ<sub>j</sub></italic></bold>. As prescribed by the Metropolis Hastings algorithm, this proposed sample <bold><italic>σ<sub>j</sub></italic></bold> is then accepted with probability min(1, Score(<italic>σ<sub>j</sub></italic>)/Score(<italic>σ<sub>i</sub></italic>)).</p>
</sec></sec><sec id="s4k">
<title>Constructing heatmaps to study enhancer interactions</title>
<p>Our goal was to probe potential interactions between binding sites from two different enhancers. In particular, we wanted to determine if interpreting the sites of one enhancer together with sites from another enhancer leads to better model predictions than the baseline of GEMSTAT-GL where each enhancer is interpreted independently. A natural way to represent such potential interactions is with a <italic>hypergraph</italic>. Hypergraphs generalize the concept of graphs by allowing each edge (called “hyperedge”) to represent a relationship shared among more than two nodes. In our formulation, every binding site in every enhancer is a node in a hypergraph, and any subset of sites from two different enhancers defines a hyperedge. The evidence in favor of that subset of sites being interpreted together, as if they were sites in the same enhancer, is the weight of the hyperedge. Such weights can be negative also, indicating that the particular subset of sites if interpreted together will make model predictions worse. We limited our attention to hyperedges defined by including (a) all sites of one enhancer and (b) sites within a sub-segment of a different enhancer, thus simplifying the space of enhancer interactions considered. Our model-based predictions of potential interactions (or avoidance of interactions) can be captured by this weighted hypergraph. However, a hypergraph is hard to visualize and less likely to lead to biological insights via direct examination. We therefore mapped the constructed hypergraph to a weighted graph where the weight of every edge represents the effect of allowing interaction between the two binding sites that the edge represents. Visualization of the edge weights of this graph through heatmaps then revealed how any binding site could affect the readout of any enhancer in our model.</p>
<sec id="s4k1">
<title>Hypergraph construction</title>
<p>For a gene <italic>g</italic>, suppose the GEMSTAT-GL model selects <italic>n</italic> contributing enhancers <italic>C<sub>1</sub>, C<sub>2</sub>, …, C<sub>n</sub></italic>. Let <italic>SITES(C<sub>i</sub>)</italic> denote the set of TF binding sites in enhancer <italic>C<sub>i</sub></italic>. Then, for every binding site in every set <italic>SITES(C<sub>i</sub>)</italic>, we include one node in a hypergraph. There are two types of hyperedges in our hypergraph. First, every subset of <italic>SITES(C<sub>i</sub>)</italic> constitutes one hyperedge, and every such hyperedge was assigned a weight of zero. Each of the remaining hyperedges represents a collection of binding sites from two different enhancers, and was constructed as follows. Let <italic>e<sub>h</sub></italic> denote a hyperedge that consists of binding sites from enhancers <italic>C<sub>1</sub></italic> and <italic>C<sub>2</sub></italic>. Then the hyperedge <italic>e<sub>h</sub></italic> would include all the binding sites of one enhancer (say, <italic>C<sub>1</sub></italic>) and between one and five contiguous binding sites of the other enhancer (<italic>C<sub>2</sub></italic> in this case). For each hyperedge <italic>e<sub>h</sub></italic> constructed in this way, we optimized a new GEMSTAT-GL model where the contributing enhancers are <italic>C<sub>2</sub></italic>, … <italic>C<sub>n</sub></italic>, as well as the newly constructed set of sites <italic>e<sub>h</sub></italic> treated as an “enhancer”. The difference between the w-PGP score of this new model and the original model learned for gene <italic>g</italic> was then assigned as the weight of <italic>e<sub>h</sub></italic>.</p>
</sec><sec id="s4k2">
<title>Mapping hypergraph to graph</title>
<p>A graph was constructed with the same nodes as that in the hypergraph, with an edge for each pair of nodes. The weight of an edge was computed by averaging the weight of every hyperedge where the corresponding pair of nodes appeared. This approach of approximating a hypergraph through a graph was discussed in detail in <xref ref-type="bibr" rid="pcbi.1003467-Agarwal1">[80]</xref>. By construction, this graph has the property that the edge between node <italic>i</italic> and node <italic>j</italic> has the same weight for all nodes <italic>j</italic> corresponding to sites in the same enhancer.</p>
</sec></sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003467.s001" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003467.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p>Results of failed attempts to model the seven-striped expressions of <italic>eve</italic> (left panel), <italic>h</italic> (middle panel), and <italic>run</italic> (right panel) from their respective intergenic regions. (A,B): GEMSTAT-predicted readout of the entire locus in the ‘Direct Interaction’ (A) and the ‘Short Range Repression’ (B) modes respectively. (C) GEMSTAT-predicted readout of the concatenation of all known enhancers of the gene. No enhancer has been reported to date for stripes 2, 4, and 6 of <italic>run</italic>. We therefore tried modeling only stripes 1, 3, 5, and 7 from the concatenation of the known enhancers of <italic>run</italic>.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003467.s002" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003467.s002" position="float" xlink:type="simple"><label>Figure S2</label><caption>
<p>Role of the weight parameters in the two-tiered model. For each gene (column), the top panel shows the un-scaled readouts of individual segments selected by the model, the middle panel shows an un-weighted summation of these readouts (green, compared to real expression profile in red), and the bottom panel shows the weighted summation reported by our model along with the weight of each GEMSTAT-GL selected window in the inset.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003467.s003" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003467.s003" position="float" xlink:type="simple"><label>Figure S3</label><caption>
<p>Extent of overlap between REDFly enhancers and GEMSTAT-GL selected windows. GEMSTAT-GL selected 50 windows to model the 27 genes mentioned in <xref ref-type="supplementary-material" rid="pcbi.1003467.s012">Table S1</xref>, <xref ref-type="fig" rid="pcbi-1003467-g004">Figure 4</xref>, and <xref ref-type="fig" rid="pcbi-1003467-g005">Figure 5</xref>. Out of these 50 windows, 39 were found to overlap with REDFly enhancers. No window overlapped with two REDFly enhancers and no two windows overlapped with the same REDFly enhancer. (A) Each bar represents the length of a REDFly enhancer (normalized to 100%) mentioned in the vertical axis. The green (red, resp.) bar shows the percentage of basepairs in the REDFly enhancer that were found to be included (not included, resp.) in the overlapping GEMSTAT-GL window. (B) Each bar represents the length of a GEMSTAT-GL window (normalized to 100%) that overlaps with the REDFly enhancer mentioned in the vertical axis. The green (red, resp.) bar shows the percentage of basepairs in the window that are common (not common, resp.) with the overlapping REDFly enhancer. For example, for the enhancer tll_P2, panel (A) shows that GEMSTAT-GL used such a window, say W, in modeling the <italic>tll</italic> gene that completely contains the tll_P2 enhancer, while panel (B) shows that the tll_P2 sequence comprises about 90% of W.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003467.s004" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003467.s004" position="float" xlink:type="simple"><label>Figure S4</label><caption>
<p>Results of “negative control” experiments. (A) Modeling a gene's expression from the intergenic region of a different gene. In each case, the model was trained to fit the real expression profile of a gene (red) using sequence from a different gene's locus. The best-fit predictions (green) did not match the real profiles well. (B) Modeling random expression patterns (red) from the intergenic sequences of <italic>eve</italic>, <italic>h</italic>, and <italic>run</italic>. Best-fit predictions are shown in green. (C) Modeling real expression patterns (red) from random sequences of the same length as the locus of the corresponding gene. Best-fit predictions are shown in green.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003467.s005" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003467.s005" position="float" xlink:type="simple"><label>Figure S5</label><caption>
<p>Histograms reflecting the empirical distributions of w-PGP scores computed from a negative control experiment (repeated 100 times) where a gene's expression pattern was modeled from its own locus but the binding sites within the locus were randomly relocated. (A)–(D) Histograms for <italic>eve</italic>, <italic>h</italic>, <italic>run</italic>, and <italic>gt</italic>, respectively. Each histogram drawn with red bars was obtained from models trained in the negative control experiment, while the green bar corresponds to the original model.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003467.s006" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003467.s006" position="float" xlink:type="simple"><label>Figure S6</label><caption>
<p>Results of MCMC sampling for the genes <italic>h</italic> (A) and <italic>run</italic> (B) along with the REDFly enhancers and GEMSTAT-GL selected windows viewed in Genome Browser. Semantics of the plots are described in the legend of <xref ref-type="fig" rid="pcbi-1003467-g006">Figure 6</xref>.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003467.s007" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003467.s007" position="float" xlink:type="simple"><label>Figure S7</label><caption>
<p>Heatmap visualizations of the changes in GEMSTAT-GL's goodness-of-fit owing to interactions between the enhancers selected for the genes (A) <italic>h</italic>, (B) <italic>run</italic>, and (C) <italic>gt</italic>. Semantics of the heatmaps are explained in the legend of <xref ref-type="fig" rid="pcbi-1003467-g008">Figure 8</xref>.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003467.s008" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003467.s008" position="float" xlink:type="simple"><label>Figure S8</label><caption>
<p>(A) Seven-stripe expression pattern of <italic>eve</italic> (red) and GEMSTAT-GL prediction (green) when thermodynamic parameters were kept fixed during model fitting. (B–F) Model-predicted readouts (green) of individual windows automatically discovered by GEMSTAT-GL. These readouts are aggregated by the model using weighted summation, to produce the locus-level readout shown in (A).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003467.s009" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003467.s009" position="float" xlink:type="simple"><label>Figure S9</label><caption>
<p>Steps in extracting enhancer expression profile from experimentally characterized gene expression profile.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003467.s010" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003467.s010" position="float" xlink:type="simple"><label>Figure S10</label><caption>
<p>An overview of the ‘weighted pattern generating potential’ (w-PGP) scheme to score model predictions (design choices have been explained in <xref ref-type="bibr" rid="pcbi.1003467-Samee2">[82]</xref>). The red and the green curves depict 16 data points of a real expression pattern and the corresponding predicted expression pattern, respectively. While scoring the predicted expression for similarity to the real expression, w-PGP determines a reward and a penalty for each data point of the predicted expression. Reward is based on expression that has been predicted correctly and penalty is based on expression that has been predicted erroneously (i.e., over expression or missed expression). For example, as the reward term at data point 10 (where the model missed some portion of the real expression), w-PGP uses the product of c<sub>10</sub> (predicted expression) and r<sub>10</sub> (real expression). As the penalty term at the same data point, w-PGP uses the product of e<sub>10</sub> (missed expression) and p<sub>10</sub> (the maximum possible value of missed expression). On the other hand, for data point 7 (where there is an over expression), w-PGP does not assign any penalty but computes the reward term as the product of c<sub>7</sub> (predicted expression) and r<sub>7</sub> ( = c<sub>7</sub>).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003467.s011" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003467.s011" position="float" xlink:type="simple"><label>Figure S11</label><caption>
<p>Steps in computing a random expression pattern corresponding to the real expression pattern of a gene G, for setting up one kind of “negative control” experiments. If G has N stripes and is expressed in K axial positions, we first select a random number (denoted by ‘stripe count’) between N/2 and N as the number of stripes of the random expression. Next, we compute stripe count number of segments such that the lengths of those segments sum up to K. These segments denote the widths of the stripes in our random expression. Similarly, assuming that G is not expressed in K<sup>0</sup> number of axial positions, we compute stripe count +1 number of segments such that the lengths of those segments sum up to K<sup>0</sup>. These segments denote the widths of the gaps between successive stripes in our random expression. We then start with a gap, and concatenate the stripes and the gaps alternately to generate the desired random expression. In a final step, we smooth this random expression through a logistic function.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003467.s012" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003467.s012" position="float" xlink:type="simple"><label>Table S1</label><caption>
<p>Intergenic locus sizes of the 27 genes modeled in the study.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003467.s013" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003467.s013" position="float" xlink:type="simple"><label>Table S2</label><caption>
<p>w-PGP scores of GEMSTAT-GL predicted expression patterns.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003467.s014" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1003467.s014" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p>Lack of estimates for pair-rule TF parameters constrains the initial focus on primary pair-rule genes.</p>
<p>(DOCX)</p>
</caption></supplementary-material></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pcbi.1003467-Davidson1"><label>1</label>
<mixed-citation publication-type="book" xlink:type="simple">Davidson EH (2006) The regulatory genome : gene regulatory networks in development and evolution. Burlington, MA ; San Diego: Academic. xi, 289 p. p.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Epstein1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Epstein</surname><given-names>DJ</given-names></name> (<year>2009</year>) <article-title>Cis-regulatory mutations in human disease</article-title>. <source>Briefings in functional genomics &amp; proteomics</source> <volume>8</volume>: <fpage>310</fpage>–<lpage>316</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Courey1"><label>3</label>
<mixed-citation publication-type="book" xlink:type="simple">Courey AJ (2008) Mechanisms in transcriptional regulation. Malden, MA ; Oxford: Blackwell Pub. xiii, 231 p., 221 p. of plates p.</mixed-citation>
</ref>
<ref id="pcbi.1003467-White1"><label>4</label>
<mixed-citation publication-type="book" xlink:type="simple">White RJ (2001) Gene transcription : mechanisms and control. London ; Malden, MA: Blackwell Science. xii, 273 p. p.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Schroeder1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schroeder</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>Pearce</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Fak</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Fan</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Unnerstall</surname><given-names>U</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Transcriptional control in the segmentation gene network of Drosophila</article-title>. <source>PLoS biology</source> <volume>2</volume>: <fpage>E271</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-DePamphilis1"><label>6</label>
<mixed-citation publication-type="book" xlink:type="simple">DePamphilis ML (2002) Gene expression at the beginning of animal development. Amsterdam ; New York: Elsevier. xvi, 280 p. p.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Reeves1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reeves</surname><given-names>GT</given-names></name>, <name name-style="western"><surname>Stathopoulos</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>Graded dorsal and differential gene regulation in the Drosophila embryo</article-title>. <source>Cold Spring Harb Perspect Biol</source> <volume>1</volume>: <fpage>a000836</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Arnosti1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Arnosti</surname><given-names>DN</given-names></name> (<year>2003</year>) <article-title>Analysis and function of transcriptional regulatory elements: insights from Drosophila</article-title>. <source>Annu Rev Entomol</source> <volume>48</volume>: <fpage>579</fpage>–<lpage>602</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Bintu1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bintu</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Buchler</surname><given-names>NE</given-names></name>, <name name-style="western"><surname>Garcia</surname><given-names>HG</given-names></name>, <name name-style="western"><surname>Gerland</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Transcriptional regulation by the numbers: models</article-title>. <source>Current opinion in genetics &amp; development</source> <volume>15</volume>: <fpage>116</fpage>–<lpage>124</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Buchler1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buchler</surname><given-names>NE</given-names></name>, <name name-style="western"><surname>Gerland</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name> (<year>2003</year>) <article-title>On schemes of combinatorial transcription logic</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>100</volume>: <fpage>5136</fpage>–<lpage>5141</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-He1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>He</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Samee</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Blatti</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Sinha</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>Thermodynamics-based models of transcriptional regulation by enhancers: the roles of synergistic activation, cooperative binding and short-range repression</article-title>. <source>PLoS computational biology</source> <volume>6</volume>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Janssens1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Janssens</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Hou</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Jaeger</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Kim</surname><given-names>AR</given-names></name>, <name name-style="western"><surname>Myasnikova</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Quantitative and predictive model of transcriptional control of the Drosophila melanogaster even skipped gene</article-title>. <source>Nature genetics</source> <volume>38</volume>: <fpage>1159</fpage>–<lpage>1165</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Kazemian1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kazemian</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Blatti</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Richards</surname><given-names>A</given-names></name>, <name name-style="western"><surname>McCutchan</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Wakabayashi-Ito</surname><given-names>N</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Quantitative analysis of the Drosophila segmentation regulatory network using pattern generating potentials</article-title>. <source>PLoS biology</source> <volume>8</volume>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Segal1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Segal</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Raveh-Sadka</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Schroeder</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Unnerstall</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Gaul</surname><given-names>U</given-names></name> (<year>2008</year>) <article-title>Predicting expression patterns from regulatory sequence in Drosophila segmentation</article-title>. <source>Nature</source> <volume>451</volume>: <fpage>535</fpage>–<lpage>540</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Zinzen1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zinzen</surname><given-names>RP</given-names></name>, <name name-style="western"><surname>Girardot</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Gagneur</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Braun</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Furlong</surname><given-names>EE</given-names></name> (<year>2009</year>) <article-title>Combinatorial binding predicts spatio-temporal cis-regulatory activity</article-title>. <source>Nature</source> <volume>462</volume>: <fpage>65</fpage>–<lpage>70</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Zinzen2"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zinzen</surname><given-names>RP</given-names></name>, <name name-style="western"><surname>Senger</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Levine</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Papatsenko</surname><given-names>D</given-names></name> (<year>2006</year>) <article-title>Computational models for neurogenic gene expression in the Drosophila embryo</article-title>. <source>Current biology : CB</source> <volume>16</volume>: <fpage>1358</fpage>–<lpage>1365</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Gertz1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gertz</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Siggia</surname><given-names>ED</given-names></name>, <name name-style="western"><surname>Cohen</surname><given-names>BA</given-names></name> (<year>2009</year>) <article-title>Analysis of combinatorial cis-regulation in synthetic and genomic promoters</article-title>. <source>Nature</source> <volume>457</volume>: <fpage>215</fpage>–<lpage>218</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Kim1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kim</surname><given-names>AR</given-names></name>, <name name-style="western"><surname>Martinez</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Ionides</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Ramos</surname><given-names>AF</given-names></name>, <name name-style="western"><surname>Ludwig</surname><given-names>MZ</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Rearrangements of 2.5 kilobases of noncoding DNA from the Drosophila even-skipped locus define predictive rules of genomic cis-regulatory logic</article-title>. <source>PLoS genetics</source> <volume>9</volume>: <fpage>e1003243</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Istrail1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Istrail</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Davidson</surname><given-names>EH</given-names></name> (<year>2005</year>) <article-title>Logic functions of the genomic cis-regulatory code</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>102</volume>: <fpage>4954</fpage>–<lpage>4959</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-OchoaEspinosa1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ochoa-Espinosa</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Small</surname><given-names>S</given-names></name> (<year>2006</year>) <article-title>Developmental mechanisms and cis-regulatory codes</article-title>. <source>Current opinion in genetics &amp; development</source> <volume>16</volume>: <fpage>165</fpage>–<lpage>170</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Sagai1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sagai</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Hosoya</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Mizushina</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Tamura</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Shiroishi</surname><given-names>T</given-names></name> (<year>2005</year>) <article-title>Elimination of a long-range cis-regulatory module causes complete loss of limb-specific Shh expression and truncation of the mouse limb</article-title>. <source>Development</source> <volume>132</volume>: <fpage>797</fpage>–<lpage>803</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Visel1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Visel</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Rubin</surname><given-names>EM</given-names></name>, <name name-style="western"><surname>Pennacchio</surname><given-names>LA</given-names></name> (<year>2009</year>) <article-title>Genomic views of distant-acting enhancers</article-title>. <source>Nature</source> <volume>461</volume>: <fpage>199</fpage>–<lpage>205</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Blackwood1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blackwood</surname><given-names>EM</given-names></name>, <name name-style="western"><surname>Kadonaga</surname><given-names>JT</given-names></name> (<year>1998</year>) <article-title>Going the distance: a current view of enhancer action</article-title>. <source>Science</source> <volume>281</volume>: <fpage>60</fpage>–<lpage>63</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Andrioli1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Andrioli</surname><given-names>LP</given-names></name>, <name name-style="western"><surname>Vasisht</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Theodosopoulou</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Oberstein</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Small</surname><given-names>S</given-names></name> (<year>2002</year>) <article-title>Anterior repression of a Drosophila stripe enhancer requires three position-specific mechanisms</article-title>. <source>Development</source> <volume>129</volume>: <fpage>4931</fpage>–<lpage>4940</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Riddihough1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Riddihough</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Ish-Horowicz</surname><given-names>D</given-names></name> (<year>1991</year>) <article-title>Individual stripe regulatory elements in the Drosophila hairy promoter respond to maternal, gap, and pair-rule genes</article-title>. <source>Genes &amp; development</source> <volume>5</volume>: <fpage>840</fpage>–<lpage>854</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Howard1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Howard</surname><given-names>KR</given-names></name>, <name name-style="western"><surname>Struhl</surname><given-names>G</given-names></name> (<year>1990</year>) <article-title>Decoding positional information: regulation of the pair-rule gene hairy</article-title>. <source>Development</source> <volume>110</volume>: <fpage>1223</fpage>–<lpage>1231</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Fujioka1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fujioka</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Emi-Sarker</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Yusibova</surname><given-names>GL</given-names></name>, <name name-style="western"><surname>Goto</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Jaynes</surname><given-names>JB</given-names></name> (<year>1999</year>) <article-title>Analysis of an even-skipped rescue transgene reveals both composite and discrete neuronal and early blastoderm enhancers, and multi-stripe positioning by gap gene repressor gradients</article-title>. <source>Development</source> <volume>126</volume>: <fpage>2527</fpage>–<lpage>2538</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Fakhouri1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fakhouri</surname><given-names>WD</given-names></name>, <name name-style="western"><surname>Ay</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sayal</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Dresch</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Dayringer</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Deciphering a transcriptional regulatory code: modeling short-range repression in the Drosophila embryo</article-title>. <source>Molecular systems biology</source> <volume>6</volume>: <fpage>341</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Halfon1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Halfon</surname><given-names>MS</given-names></name>, <name name-style="western"><surname>Grad</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Church</surname><given-names>GM</given-names></name>, <name name-style="western"><surname>Michelson</surname><given-names>AM</given-names></name> (<year>2002</year>) <article-title>Computation-based discovery of related transcriptional regulatory modules and motifs using an experimentally validated combinatorial model</article-title>. <source>Genome research</source> <volume>12</volume>: <fpage>1019</fpage>–<lpage>1028</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Kazemian2"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kazemian</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Zhu</surname><given-names>Q</given-names></name>, <name name-style="western"><surname>Halfon</surname><given-names>MS</given-names></name>, <name name-style="western"><surname>Sinha</surname><given-names>S</given-names></name> (<year>2011</year>) <article-title>Improved accuracy of supervised CRM discovery with interpolated Markov models and cross-species comparison</article-title>. <source>Nucleic acids research</source> <volume>39</volume>: <fpage>9463</fpage>–<lpage>9472</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Lifanov1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lifanov</surname><given-names>AP</given-names></name>, <name name-style="western"><surname>Makeev</surname><given-names>VJ</given-names></name>, <name name-style="western"><surname>Nazina</surname><given-names>AG</given-names></name>, <name name-style="western"><surname>Papatsenko</surname><given-names>DA</given-names></name> (<year>2003</year>) <article-title>Homotypic regulatory clusters in Drosophila</article-title>. <source>Genome research</source> <volume>13</volume>: <fpage>579</fpage>–<lpage>588</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Ernst1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ernst</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Kheradpour</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Mikkelsen</surname><given-names>TS</given-names></name>, <name name-style="western"><surname>Shoresh</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Ward</surname><given-names>LD</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Mapping and analysis of chromatin state dynamics in nine human cell types</article-title>. <source>Nature</source> <volume>473</volume>: <fpage>43</fpage>–<lpage>49</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Kharchenko1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kharchenko</surname><given-names>PV</given-names></name>, <name name-style="western"><surname>Alekseyenko</surname><given-names>AA</given-names></name>, <name name-style="western"><surname>Schwartz</surname><given-names>YB</given-names></name>, <name name-style="western"><surname>Minoda</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Riddle</surname><given-names>NC</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Comprehensive analysis of the chromatin landscape in Drosophila melanogaster</article-title>. <source>Nature</source> <volume>471</volume>: <fpage>480</fpage>–<lpage>485</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Negre1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Negre</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>CD</given-names></name>, <name name-style="western"><surname>Ma</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Bristow</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Miller</surname><given-names>SW</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>A cis-regulatory map of the Drosophila genome</article-title>. <source>Nature</source> <volume>471</volume>: <fpage>527</fpage>–<lpage>531</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Visel2"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Visel</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Blow</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Akiyama</surname><given-names>JA</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>ChIP-seq accurately predicts tissue-specific activity of enhancers</article-title>. <source>Nature</source> <volume>457</volume>: <fpage>854</fpage>–<lpage>858</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Berman1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berman</surname><given-names>BP</given-names></name>, <name name-style="western"><surname>Nibu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Pfeiffer</surname><given-names>BD</given-names></name>, <name name-style="western"><surname>Tomancak</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Celniker</surname><given-names>SE</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title>Exploiting transcription factor binding site clustering to identify cis-regulatory modules involved in pattern formation in the Drosophila genome</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>99</volume>: <fpage>757</fpage>–<lpage>762</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Donaldson1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Donaldson</surname><given-names>IJ</given-names></name>, <name name-style="western"><surname>Chapman</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gottgens</surname><given-names>B</given-names></name> (<year>2005</year>) <article-title>TFBScluster: a resource for the characterization of transcriptional regulatory networks</article-title>. <source>Bioinformatics</source> <volume>21</volume>: <fpage>3058</fpage>–<lpage>3059</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Frith1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Frith</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Weng</surname><given-names>Z</given-names></name> (<year>2003</year>) <article-title>Cluster-Buster: Finding dense clusters of motifs in DNA sequences</article-title>. <source>Nucleic acids research</source> <volume>31</volume>: <fpage>3666</fpage>–<lpage>3668</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Philippakis1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Philippakis</surname><given-names>AA</given-names></name>, <name name-style="western"><surname>He</surname><given-names>FS</given-names></name>, <name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name> (<year>2005</year>) <article-title>Modulefinder: a tool for computational discovery of cis regulatory modules</article-title>. <source>Pac Symp Biocomput</source> <fpage>519</fpage>–<lpage>530</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Sinha1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sinha</surname><given-names>S</given-names></name>, <name name-style="western"><surname>van Nimwegen</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Siggia</surname><given-names>ED</given-names></name> (<year>2003</year>) <article-title>A probabilistic method to detect regulatory modules</article-title>. <source>Bioinformatics</source> <volume>19 Suppl 1</volume>: <fpage>i292</fpage>–<lpage>301</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Howard2"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Howard</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Ingham</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Rushlow</surname><given-names>C</given-names></name> (<year>1988</year>) <article-title>Region-specific alleles of the Drosophila segmentation gene hairy</article-title>. <source>Genes &amp; development</source> <volume>2</volume>: <fpage>1037</fpage>–<lpage>1046</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Ishihara1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ishihara</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Sato</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ikeda</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Yajima</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Kawakami</surname><given-names>K</given-names></name> (<year>2008</year>) <article-title>Multiple evolutionarily conserved enhancers control expression of Eya1</article-title>. <source>Dev Dyn</source> <volume>237</volume>: <fpage>3142</fpage>–<lpage>3156</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Perry1"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Perry</surname><given-names>MW</given-names></name>, <name name-style="western"><surname>Boettiger</surname><given-names>AN</given-names></name>, <name name-style="western"><surname>Levine</surname><given-names>M</given-names></name> (<year>2011</year>) <article-title>Multiple enhancers ensure precision of gap gene-expression patterns in the Drosophila embryo</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>108</volume>: <fpage>13570</fpage>–<lpage>13575</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Barolo1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Barolo</surname><given-names>S</given-names></name> (<year>2012</year>) <article-title>Shadow enhancers: frequently asked questions about distributed cis-regulatory information and enhancer redundancy</article-title>. <source>Bioessays</source> <volume>34</volume>: <fpage>135</fpage>–<lpage>141</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Hong1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hong</surname><given-names>JW</given-names></name>, <name name-style="western"><surname>Hendrix</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Levine</surname><given-names>MS</given-names></name> (<year>2008</year>) <article-title>Shadow enhancers as a source of evolutionary novelty</article-title>. <source>Science</source> <volume>321</volume>: <fpage>1314</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Perry2"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Perry</surname><given-names>MW</given-names></name>, <name name-style="western"><surname>Boettiger</surname><given-names>AN</given-names></name>, <name name-style="western"><surname>Bothma</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Levine</surname><given-names>M</given-names></name> (<year>2010</year>) <article-title>Shadow enhancers foster robustness of Drosophila gastrulation</article-title>. <source>Current biology : CB</source> <volume>20</volume>: <fpage>1562</fpage>–<lpage>1567</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Prazak1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Prazak</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Fujioka</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gergen</surname><given-names>JP</given-names></name> (<year>2010</year>) <article-title>Non-additive interactions involving two distinct elements mediate sloppy-paired regulation by pair-rule transcription factors</article-title>. <source>Developmental biology</source> <volume>344</volume>: <fpage>1048</fpage>–<lpage>1059</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Yao1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yao</surname><given-names>LC</given-names></name>, <name name-style="western"><surname>Phin</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Cho</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Rushlow</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Arora</surname><given-names>K</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Multiple modular promoter elements drive graded brinker expression in response to the Dpp morphogen gradient</article-title>. <source>Development</source> <volume>135</volume>: <fpage>2183</fpage>–<lpage>2192</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Kirstein1"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kirstein</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Sanz</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Quinones</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Moscat</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Diaz-Meco</surname><given-names>MT</given-names></name>, <etal>et al</etal>. (<year>1996</year>) <article-title>Cross-talk between different enhancer elements during mitogenic induction of the human stromelysin-1 gene</article-title>. <source>The Journal of biological chemistry</source> <volume>271</volume>: <fpage>18231</fpage>–<lpage>18236</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Shea1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shea</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Ackers</surname><given-names>GK</given-names></name> (<year>1985</year>) <article-title>The OR control system of bacteriophage lambda. A physical-chemical model for gene regulation</article-title>. <source>Journal of molecular biology</source> <volume>181</volume>: <fpage>211</fpage>–<lpage>230</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Ay1"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ay</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Arnosti</surname><given-names>DN</given-names></name> (<year>2011</year>) <article-title>Mathematical modeling of gene expression: a guide for the perplexed biologist</article-title>. <source>Critical reviews in biochemistry and molecular biology</source> <volume>46</volume>: <fpage>137</fpage>–<lpage>151</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Samee1"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Samee</surname><given-names>MAH</given-names></name>, <name name-style="western"><surname>Sinha</surname><given-names>S</given-names></name> <article-title>Evaluating thermodynamic models of enhancer activity on cellular resolution gene expression data</article-title>. <source>Methods</source> <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.ymeth.2013.03.005" xlink:type="simple">http://dx.doi.org/10.1016/j.ymeth.2013.03.005</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Reinitz1"><label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reinitz</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Sharp</surname><given-names>DH</given-names></name> (<year>1995</year>) <article-title>Mechanism of eve stripe formation</article-title>. <source>Mechanisms of development</source> <volume>49</volume>: <fpage>133</fpage>–<lpage>158</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Harding1"><label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Harding</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Hoey</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Warrior</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Levine</surname><given-names>M</given-names></name> (<year>1989</year>) <article-title>Autoregulatory and gap gene response elements of the even-skipped promoter of Drosophila</article-title>. <source>The EMBO journal</source> <volume>8</volume>: <fpage>1205</fpage>–<lpage>1212</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Jiang1"><label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jiang</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Hoey</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Levine</surname><given-names>M</given-names></name> (<year>1991</year>) <article-title>Autoregulation of a segmentation gene in Drosophila: combinatorial interaction of the even-skipped homeo box protein with a distal enhancer element</article-title>. <source>Genes &amp; development</source> <volume>5</volume>: <fpage>265</fpage>–<lpage>277</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Harding2"><label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Harding</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Rushlow</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Doyle</surname><given-names>HJ</given-names></name>, <name name-style="western"><surname>Hoey</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Levine</surname><given-names>M</given-names></name> (<year>1986</year>) <article-title>Cross-regulatory interactions among pair-rule genes in Drosophila</article-title>. <source>Science</source> <volume>233</volume>: <fpage>953</fpage>–<lpage>959</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Pisarev1"><label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pisarev</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Poustelnikova</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Samsonova</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Reinitz</surname><given-names>J</given-names></name> (<year>2009</year>) <article-title>FlyEx, the quantitative atlas on segmentation gene expression at cellular resolution</article-title>. <source>Nucleic acids research</source> <volume>37</volume>: <fpage>D560</fpage>–<lpage>566</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Harrison1"><label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Harrison</surname><given-names>MM</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>XY</given-names></name>, <name name-style="western"><surname>Kaplan</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Botchan</surname><given-names>MR</given-names></name>, <name name-style="western"><surname>Eisen</surname><given-names>MB</given-names></name> (<year>2011</year>) <article-title>Zelda binding in the early Drosophila melanogaster embryo marks regions subsequently activated at the maternal-to-zygotic transition</article-title>. <source>PLoS genetics</source> <volume>7</volume>: <fpage>e1002266</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Nien1"><label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nien</surname><given-names>CY</given-names></name>, <name name-style="western"><surname>Liang</surname><given-names>HL</given-names></name>, <name name-style="western"><surname>Butcher</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Sun</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Fu</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Temporal coordination of gene networks by Zelda in the early Drosophila embryo</article-title>. <source>PLoS genetics</source> <volume>7</volume>: <fpage>e1002339</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Gallo1"><label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gallo</surname><given-names>SM</given-names></name>, <name name-style="western"><surname>Gerrard</surname><given-names>DT</given-names></name>, <name name-style="western"><surname>Miner</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Simich</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Des Soye</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>REDfly v3.0: toward a comprehensive database of transcriptional regulatory elements in Drosophila</article-title>. <source>Nucleic acids research</source> <volume>39</volume>: <fpage>D118</fpage>–<lpage>123</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Schroeder2"><label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schroeder</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>Greer</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Gaul</surname><given-names>U</given-names></name> (<year>2011</year>) <article-title>How to make stripes: deciphering the transition from non-periodic to periodic patterns in Drosophila segmentation</article-title>. <source>Development</source> <volume>138</volume>: <fpage>3067</fpage>–<lpage>3078</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Brown1"><label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brown</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>C</given-names></name> (<year>1993</year>) <article-title>Repression of Drosophila pair-rule segmentation genes by ectopic expression of tramtrack</article-title>. <source>Development</source> <volume>117</volume>: <fpage>45</fpage>–<lpage>58</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Jakobsen1"><label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jakobsen</surname><given-names>JS</given-names></name>, <name name-style="western"><surname>Braun</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Astorga</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Gustafson</surname><given-names>EH</given-names></name>, <name name-style="western"><surname>Sandmann</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Temporal ChIP-on-chip reveals Biniou as a universal regulator of the visceral muscle transcriptional network</article-title>. <source>Genes &amp; development</source> <volume>21</volume>: <fpage>2448</fpage>–<lpage>2460</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Frankel1"><label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Frankel</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Davis</surname><given-names>GK</given-names></name>, <name name-style="western"><surname>Vargas</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Payre</surname><given-names>F</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Phenotypic robustness conferred by apparently redundant transcriptional enhancers</article-title>. <source>Nature</source> <volume>466</volume>: <fpage>490</fpage>–<lpage>493</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Arnosti2"><label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Arnosti</surname><given-names>DN</given-names></name>, <name name-style="western"><surname>Barolo</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Levine</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Small</surname><given-names>S</given-names></name> (<year>1996</year>) <article-title>The eve stripe 2 enhancer employs multiple modes of transcriptional synergy</article-title>. <source>Development</source> <volume>122</volume>: <fpage>205</fpage>–<lpage>214</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Small1"><label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Small</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Blair</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Levine</surname><given-names>M</given-names></name> (<year>1992</year>) <article-title>Regulation of even-skipped stripe 2 in the Drosophila embryo</article-title>. <source>The EMBO journal</source> <volume>11</volume>: <fpage>4047</fpage>–<lpage>4057</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Zhang1"><label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname><given-names>CC</given-names></name>, <name name-style="western"><surname>Bienz</surname><given-names>M</given-names></name> (<year>1992</year>) <article-title>Segmental determination in Drosophila conferred by hunchback (hb), a repressor of the homeotic gene Ultrabithorax (Ubx)</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>89</volume>: <fpage>7511</fpage>–<lpage>7515</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Dresch1"><label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dresch</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Thompson</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Arnosti</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Chiu</surname><given-names>C</given-names></name> (<year>2013</year>) <article-title>Two-Layer Mathematical Modeling of Gene Expression: Incorporating DNA-Level Information and System Dynamics</article-title>. <source>SIAM Journal on Applied Mathematics</source> <volume>73</volume>: <fpage>804</fpage>–<lpage>826</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-LaRosee1"><label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>La Rosee</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Hader</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Taubert</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Rivera-Pomar</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Jackle</surname><given-names>H</given-names></name> (<year>1997</year>) <article-title>Mechanism and Bicoid-dependent control of hairy stripe 7 expression in the posterior region of the Drosophila embryo</article-title>. <source>The EMBO journal</source> <volume>16</volume>: <fpage>4403</fpage>–<lpage>4411</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Liang1"><label>70</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liang</surname><given-names>HL</given-names></name>, <name name-style="western"><surname>Nien</surname><given-names>CY</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>HY</given-names></name>, <name name-style="western"><surname>Metzstein</surname><given-names>MM</given-names></name>, <name name-style="western"><surname>Kirov</surname><given-names>N</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>The zinc-finger protein Zelda is a key activator of the early zygotic genome in Drosophila</article-title>. <source>Nature</source> <volume>456</volume>: <fpage>400</fpage>–<lpage>403</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Barolo2"><label>71</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Barolo</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Levine</surname><given-names>M</given-names></name> (<year>1997</year>) <article-title>hairy mediates dominant repression in the Drosophila embryo</article-title>. <source>The EMBO journal</source> <volume>16</volume>: <fpage>2883</fpage>–<lpage>2891</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Spitz1"><label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Spitz</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Gonzalez</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Duboule</surname><given-names>D</given-names></name> (<year>2003</year>) <article-title>A global control region defines a chromosomal regulatory landscape containing the HoxD cluster</article-title>. <source>Cell</source> <volume>113</volume>: <fpage>405</fpage>–<lpage>417</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Gonzalez1"><label>73</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gonzalez</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Duboule</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Spitz</surname><given-names>F</given-names></name> (<year>2007</year>) <article-title>Transgenic analysis of Hoxd gene regulation during digit development</article-title>. <source>Developmental biology</source> <volume>306</volume>: <fpage>847</fpage>–<lpage>859</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Montavon1"><label>74</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Montavon</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Soshnikova</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Mascrez</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Joye</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Thevenet</surname><given-names>L</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>A regulatory archipelago controls Hox genes transcription in digits</article-title>. <source>Cell</source> <volume>147</volume>: <fpage>1132</fpage>–<lpage>1145</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Maeda1"><label>75</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maeda</surname><given-names>RK</given-names></name>, <name name-style="western"><surname>Karch</surname><given-names>F</given-names></name> (<year>2011</year>) <article-title>Gene expression in time and space: additive vs hierarchical organization of cis-regulatory regions</article-title>. <source>Current opinion in genetics &amp; development</source> <volume>21</volume>: <fpage>187</fpage>–<lpage>193</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Tomancak1"><label>76</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tomancak</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Berman</surname><given-names>BP</given-names></name>, <name name-style="western"><surname>Beaton</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Weiszmann</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Kwan</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Global analysis of patterns of gene expression during Drosophila embryogenesis</article-title>. <source>Genome biology</source> <volume>8</volume>: <fpage>R145</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Ernst2"><label>77</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ernst</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Kellis</surname><given-names>M</given-names></name> (<year>2010</year>) <article-title>Discovery and characterization of chromatin states for systematic annotation of the human genome</article-title>. <source>Nat Biotechnol</source> <volume>28</volume>: <fpage>817</fpage>–<lpage>825</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Noyes1"><label>78</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Noyes</surname><given-names>MB</given-names></name>, <name name-style="western"><surname>Meng</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Wakabayashi</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sinha</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Brodsky</surname><given-names>MH</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>A systematic characterization of factors that regulate Drosophila segmentation via a bacterial one-hybrid system</article-title>. <source>Nucleic acids research</source> <volume>36</volume>: <fpage>2547</fpage>–<lpage>2560</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Stormo1"><label>79</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name> (<year>2000</year>) <article-title>DNA binding sites: representation and discovery</article-title>. <source>Bioinformatics</source> <volume>16</volume>: <fpage>16</fpage>–<lpage>23</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Agarwal1"><label>80</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Agarwal</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Jongwoo</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Zelnik-Manor</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Perona</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Kriegman</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Beyond pairwise clustering; 2005 20–25 June 2005</article-title>. <fpage>838</fpage>–<lpage>845</lpage> vol. 832.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Kumar1"><label>81</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kumar</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Konikoff</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Van Emden</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Busick</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Davis</surname><given-names>KT</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>FlyExpress: visual mining of spatiotemporal patterns for genes and publications in Drosophila embryogenesis</article-title>. <source>Bioinformatics</source> <volume>27</volume>: <fpage>3319</fpage>–<lpage>3320</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003467-Samee2"><label>82</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Samee</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Sinha</surname><given-names>S</given-names></name> (<year>2013</year>) <article-title>Evaluating thermodynamic models of enhancer activity on cellular resolution gene expression data</article-title>. <source>Methods</source> <volume>62</volume>: <fpage>79</fpage>–<lpage>90</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>