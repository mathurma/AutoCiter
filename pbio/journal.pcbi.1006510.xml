<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-00209</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006510</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Single neuron function</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Computational neuroscience</subject><subj-group><subject>Single neuron function</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neuronal morphology</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject><subj-group><subject>Neuronal dendrites</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject><subj-group><subject>Neuronal dendrites</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Computerized simulations</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Extracellular space</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Physical chemistry</subject><subj-group><subject>Ions</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>A Kirchhoff-Nernst-Planck framework for modeling large scale extracellular electrodiffusion surrounding morphologically detailed neurons</article-title>
<alt-title alt-title-type="running-head">Modelling large scale electrodiffusion surrounding morphologically detailed neurons</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2929-4383</contrib-id>
<name name-style="western">
<surname>Solbrå</surname> <given-names>Andreas</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Bergersen</surname> <given-names>Aslak Wigdahl</given-names></name>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>van den Brink</surname> <given-names>Jonas</given-names></name>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8138-3995</contrib-id>
<name name-style="western">
<surname>Malthe-Sørenssen</surname> <given-names>Anders</given-names></name>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5425-5012</contrib-id>
<name name-style="western">
<surname>Einevoll</surname> <given-names>Gaute T.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4721-1599</contrib-id>
<name name-style="western">
<surname>Halnes</surname> <given-names>Geir</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Center for Integrative Neuroplasticity, University of Oslo, Oslo, Norway</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Physics, University of Oslo, Oslo, Norway</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Simula Research Laboratory, Fornebu, Norway</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Department of Mathematical Sciences and Technology, Norwegian University of Life Sciences, Ås, Norway</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Barreto</surname> <given-names>Ernest</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>George Mason University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">geir.halnes@nmbu.no</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>10</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>4</day>
<month>10</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>10</issue>
<elocation-id>e1006510</elocation-id>
<history>
<date date-type="received">
<day>6</day>
<month>2</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>12</day>
<month>9</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Solbrå et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006510"/>
<abstract>
<p>Many pathological conditions, such as seizures, stroke, and spreading depression, are associated with substantial changes in ion concentrations in the extracellular space (ECS) of the brain. An understanding of the mechanisms that govern ECS concentration dynamics may be a prerequisite for understanding such pathologies. To estimate the transport of ions due to electrodiffusive effects, one must keep track of both the ion concentrations and the electric potential simultaneously in the relevant regions of the brain. Although this is currently unfeasible experimentally, it is in principle achievable with computational models based on biophysical principles and constraints. Previous computational models of extracellular ion-concentration dynamics have required extensive computing power, and therefore have been limited to either phenomena on very small spatiotemporal scales (micrometers and milliseconds), or simplified and idealized 1-dimensional (1-D) transport processes on a larger scale. Here, we present the 3-D Kirchhoff-Nernst-Planck (KNP) framework, tailored to explore electrodiffusive effects on large spatiotemporal scales. By assuming electroneutrality, the KNP-framework circumvents charge-relaxation processes on the spatiotemporal scales of nanometers and nanoseconds, and makes it feasible to run simulations on the spatiotemporal scales of millimeters and seconds on a standard desktop computer. In the present work, we use the 3-D KNP framework to simulate the dynamics of ion concentrations and the electrical potential surrounding a morphologically detailed pyramidal cell. In addition to elucidating the single neuron contribution to electrodiffusive effects in the ECS, the simulation demonstrates the efficiency of the 3-D KNP framework. We envision that future applications of the framework to more complex and biologically realistic systems will be useful in exploring pathological conditions associated with large concentration variations in the ECS.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Many pathological conditions, such as epilepsy and cortical spreading depression, are linked to abnormal extracellular ion concentrations in the brain. Understanding the underlying principles of such conditions may prove important in developing treatments for these illnesses, which incur societal costs of tens of billions annually. In order to investigate the role of ion-concentration dynamics in the pathological conditions, one must measure the spatial distribution of all ion concentrations over time. This remains challenging experimentally, which makes computational modeling an attractive tool. We have previously introduced the Kirchhoff-Nernst-Planck framework, an efficient framework for modeling electrodiffusion. In this study, we introduce a 3-dimensional version of this framework and use it to model the electrodiffusion of ions surrounding a morphologically detailed neuron. The simulation covered a 1 mm<sup>3</sup> cylinder of tissue for over a minute and was performed in less than a day on a standard desktop computer, demonstrating the framework’s efficiency. We believe this to be an important step on the way to understanding phenomena involving ion concentration shifts at the tissue level.</p>
</abstract>
<funding-group>
<funding-statement>This work was funded by the Research Council of Norway (BIOTEK2021 Digital Life project ‘DigiBrain’, project 248828). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="2"/>
<page-count count="26"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-10-16</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All model code will be available at <ext-link ext-link-type="uri" xlink:href="https://github.com/CINPLA/KNPsim" xlink:type="simple">https://github.com/CINPLA/KNPsim</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The brain mainly consists of a dense packing of neurons and neuroglia, submerged in the cerebrospinal fluid which fills the <italic>extracellular space</italic> (ECS). Neurons generate their electrical signals by exchanging ions with the ECS through ion-selective channels in their plasma membranes. During normal signaling, this does not lead to significant changes in local ion concentrations, as neuronal and glial transport mechanisms work towards maintaining ion concentrations close to baseline levels. However, endured periods of enhanced neuronal activity or aberrant ion transport may lead to changes in ECS ion concentrations. Local concentration changes often coincide with slow shifts in the ECS potential [<xref ref-type="bibr" rid="pcbi.1006510.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1006510.ref003">3</xref>], which may be partly evoked by diffusive electrical currents, i.e., currents carried by charged ions moving along ECS concentration gradients [<xref ref-type="bibr" rid="pcbi.1006510.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref004">4</xref>]. While concentration gradients can influence electrical fields, the reverse is also true, since ions move not only by diffusion but also by electric drift. A better understanding of the electrodiffusive interplay between ECS ion dynamics and ECS potentials may be a prerequisite for understanding the mechanisms behind many pathological conditions linked to substantial concentration shifts in the ECS, such as epilepsy and spreading depression [<xref ref-type="bibr" rid="pcbi.1006510.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1006510.ref007">7</xref>].</p>
<p>A simultaneous and accurate knowledge of the concentration of all ion species is needed to make reliable estimates of electrodiffusive effects in the ECS. Although this is currently unfeasible experimentally, it is in principle achievable with computational models based on biophysical principles and constraints. However, in most computational models in neuroscience ion-concentration dynamics are only partially modeled, or are ignored altogether. One reason for this is the challenge involved in keeping track of all ion concentrations and their spatiotemporal dynamics. Another reason may be the strong focus within the community on modeling the neuronal membrane dynamics at short timescales, during which both intra- and extracellular concentration changes are relatively small and putatively negligible. Although there exist models that account for ion concentration shifts and their effects on neuronal and glial reversal potentials [<xref ref-type="bibr" rid="pcbi.1006510.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1006510.ref011">11</xref>], the most common computational models for excitable cells, the multi-compartmental models and the cable equation, are based on the assumptions that (i) the ECS potential is constant (ground), and (ii) the ion concentrations are constant [<xref ref-type="bibr" rid="pcbi.1006510.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref013">13</xref>]. The NEURON simulator [<xref ref-type="bibr" rid="pcbi.1006510.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref015">15</xref>] is based on these assumptions, and although they are physically incorrect, they still allow for efficient and fairly accurate predictions of the membrane-potential dynamics.</p>
<p>Because of assumption (i), multi-compartmental models are unsuited for modeling ECS dynamics, and several approaches have been taken to construct models which include ECS effects. A majority of computational studies of ECS potentials are based on <italic>volume conductor</italic> (VC) theory [<xref ref-type="bibr" rid="pcbi.1006510.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1006510.ref021">21</xref>]. VC-schemes link neuronal membrane dynamics to its signatures in the ECS potential. In contrast to the multi-compartmental models, VC-schemes are derived by allowing the ECS potential to vary, but still assuming that the ion concentrations are constant. VC-schemes are attractive, because they offer closed-form solutions, and allow the calculation of the electric field for arbitrarily large systems. Although it may be reasonable to neglect variations in ECS ion concentrations on short timescales, the accumulative effects of endured neuronal activity may lead to significant concentration changes in the ECS, which are related to the aforementioned pathological conditions. Naturally, models that do not include ion-concentration dynamics are not applicable for exploring such pathologies. Furthermore, VC-schemes neglect the effects from diffusive currents on the ECS potentials [<xref ref-type="bibr" rid="pcbi.1006510.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref023">23</xref>], and in previous computational studies we have found the low-frequency components of the ECS potential to be dominated by diffusion effects [<xref ref-type="bibr" rid="pcbi.1006510.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref024">24</xref>].</p>
<p>A simplified approach to modeling concentration dynamics in brain tissue, is to use reaction-diffusion schemes (see e.g., [<xref ref-type="bibr" rid="pcbi.1006510.ref025">25</xref>–<xref ref-type="bibr" rid="pcbi.1006510.ref027">27</xref>]). In these schemes, concentration dynamics are simulated under the simplifying assumption that ions move due to diffusion only. This approach has been used for many specific applications, giving results in close agreement with experimental data [<xref ref-type="bibr" rid="pcbi.1006510.ref026">26</xref>]. However, the net transport of abundant charge carriers such as Na<sup>+</sup>, K<sup>+</sup>, Ca<sup>2+</sup>, and Cl<sup>−</sup>, is also influenced by electric forces, which is not incorporated in diffusion only (DO)-schemes. Furthermore, DO-schemes do not include the influence that diffusing ions can have on the electrical potential.</p>
<p>To account for the electric interactions between the different ion species, as well as the effect of such electric forces on the ECS potential, an electrodiffusive modeling framework is needed. The most detailed modeling scheme for electrodiffusion is the Poisson-Nernst-Planck (PNP) scheme [<xref ref-type="bibr" rid="pcbi.1006510.ref028">28</xref>–<xref ref-type="bibr" rid="pcbi.1006510.ref034">34</xref>]. The PNP-scheme explicitly models charge-relaxation processes, that is, tiny deviations from electroneutrality involving only about 10<sup>—9</sup> of the total ionic concentration [<xref ref-type="bibr" rid="pcbi.1006510.ref035">35</xref>]. This requires a prohibitively high spatiotemporal resolution, which makes the PNP-scheme too computationally expensive for modeling the ECS on the tissue scale. Even the state-of-the-art simulations in the literature are on the order of milliseconds on computational domains of micrometers. The PNP-scheme is therefore not suited for simulating processes taking place at the tissue scale [<xref ref-type="bibr" rid="pcbi.1006510.ref023">23</xref>].</p>
<p>A series of modeling schemes have been developed that circumvent the brief charge-relaxation processes, and solve directly for the ECS potential when the system is in a quasi-steady state [<xref ref-type="bibr" rid="pcbi.1006510.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref036">36</xref>–<xref ref-type="bibr" rid="pcbi.1006510.ref042">42</xref>]. Circumventing charge-relaxation allows for simulations on spatiotemporal scales which are larger, compared to what is possible with the PNP-scheme, by several orders of magnitude. The charge-relaxation can be bypassed by replacing Poisson’s equation with the constraint that the bulk solution is electroneutral. These schemes have been shown to deviate from the PNP-scheme very close to the cell membrane (less than 5 Î¼m), but to give a good agreement in the bulk solution [<xref ref-type="bibr" rid="pcbi.1006510.ref023">23</xref>]. The simplest electroneutral modeling scheme is the <italic>Kirchhoff-Nernst-Planck (KNP)</italic> scheme, previously developed in our group [<xref ref-type="bibr" rid="pcbi.1006510.ref041">41</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref042">42</xref>]. A similar scheme was developed in parallel in the heart cell community [<xref ref-type="bibr" rid="pcbi.1006510.ref040">40</xref>].</p>
<p>The KNP-scheme has previously been used to study electrodiffusive phenomena such as spatial K<sup>+</sup> buffering by astrocytes [<xref ref-type="bibr" rid="pcbi.1006510.ref041">41</xref>], effects of ECS diffusion on the local field potential [<xref ref-type="bibr" rid="pcbi.1006510.ref004">4</xref>], and the implication for current-source density analysis [<xref ref-type="bibr" rid="pcbi.1006510.ref024">24</xref>]. For simplicity, these previous applications were limited to idealized 1-D setups with a relatively coarse spatial resolution. Furthermore, a comparison between the KNP framework and other simulation frameworks was not included in previous studies.</p>
<p>In the present study, we introduce a 3-D version of the KNP framework which can be used to simulate the electrodiffusive dynamics of ion-concentrations and the electrical potential in the ECS on large spatiotemporal scales. We establish in which situations the assumptions used in the KNP scheme are warranted by comparing it to the more physically detailed PNP scheme. Furthermore, we identify the conditions under which an electrodiffusive formalism is needed by comparing the KNP scheme to the VC and DO schemes. The simplified schemes can be derived from the KNP scheme by assuming, respectively, that (for VC) diffusive effects on the membrane potential and (for DO) migratory effects on the concentration dynamics are negligible. Accordingly, the accuracy of the simplifying assumptions can be assessed by comparing how close their predictions come to the KNP scheme.</p>
<p>We present the results of three distinct simulation setups, which we will refer to as Application 1, Application 2, and Application 3 for the remainder of this study:</p>
<p>In Application 1, we consider an idealized 1-D domain filled with a salt solution, starting with a nonzero ion concentration gradient. We solve the system using the PNP-scheme, the KNP-scheme, and a DO-scheme. We compare results on short and long timescales (nanoseconds and seconds), to highlight the similarities and differences between the schemes.</p>
<p>In Application 2, we consider a 3-D domain with an ion concentration point source and a point sink, of equal magnitude, embedded in a standard ECS ion solution. We compare results obtained with the VC- and KNP-schemes to highlight their similarities and differences.</p>
<p>In Application 3, we consider a morphologically realistic pyramidal neuron model [<xref ref-type="bibr" rid="pcbi.1006510.ref043">43</xref>]) embedded in a 3-D ECS solution. The neuronal morphology is inserted as a 1-D branching tree, which means that it does not occupy any volume, but gives rise to a morphologically realistic spatial distribution of neuronal membrane current sources or sinks. The ECS dynamics is computed using the KNP-scheme, and show how concentration gradients gradually build up in the ECS due to the neural activity, and how this influences the local potential in the ECS. We compare results obtained with the VC-, DO-, and KNP-schemes to highlight their similarities and differences.</p>
<p>The first two applications are simplified simulation setups, used to better understand the differences between the schemes introduced above, while the third application is the main result of this study, as it illustrates the scales at which the KNP-scheme can be used.</p>
<p>To our knowledge, the KNP-scheme is the first simulation framework which can handle 3-D electrodiffusion in neuronal tissue at relatively large spatiotemporal scales without demanding an insurmountable amount of computer power. For Application 3, the long-term ECS ion-concentration dynamics (about 100 s) in a spatial region of about 1 mm<sup>3</sup> was run on a standard desktop computer within a day. We expect that the presented simulation framework will be of great use for future studies, especially for modeling tissue dynamics in the context of exploring pathological conditions associated with large shifts in ECS ion concentrations [<xref ref-type="bibr" rid="pcbi.1006510.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1006510.ref007">7</xref>].</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and methods</title>
<p>This section is thematically split into three parts. We begin by explaining the necessary physical theory, stating and deriving the equations which we implemented. Then, we explain in more detail how the models were implemented, including details such as numerical schemes and boundary conditions. Finally, we give the specific details on each of the three applications used in the study. The source code can be found online, at <ext-link ext-link-type="uri" xlink:href="https://github.com/CINPLA/KNPsim" xlink:type="simple">https://github.com/CINPLA/KNPsim</ext-link>, and the results in this study can be reproduced by checking out the tag <monospace>PLoS</monospace>.</p>
<sec id="sec003">
<title>Theory</title>
<sec id="sec004">
<title>The Nernst-Planck equation for electrodiffusion</title>
<p>The ion concentration dynamics of an ion species in a solution is described by the continuity equation:
<disp-formula id="pcbi.1006510.e001"><alternatives><graphic id="pcbi.1006510.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mo>∇</mml:mo> <mml:mo>·</mml:mo> <mml:msub><mml:mi>J</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>in</mml:mtext> <mml:mspace width="4.pt"/><mml:mo>Ω</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>c</italic><sub><italic>k</italic></sub> is the concentration of ion species <italic>k</italic>, <italic>f</italic><sub><italic>k</italic></sub> represent any source terms in the system, <italic>Ω</italic> is the domain for which the concentrations are defined, and <italic>J</italic><sub><italic>k</italic></sub> is the concentration flux of ion species <italic>k</italic>. In the applications in this study, <italic>f</italic><sub><italic>k</italic></sub> is implemented as a set of point sources at specified coordinates in the ECS. In the Nernst-Planck equation, <italic>J</italic><sub><italic>k</italic></sub> consists of a diffusive and an electric component:
<disp-formula id="pcbi.1006510.e002"><alternatives><graphic id="pcbi.1006510.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>J</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>J</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mtext>diff</mml:mtext></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>J</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mtext>field</mml:mtext></mml:msubsup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
The diffusive component is given by Fick’s first law,
<disp-formula id="pcbi.1006510.e003"><alternatives><graphic id="pcbi.1006510.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mtext>diff</mml:mtext></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>D</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where <italic>D</italic><sub><italic>k</italic></sub> is the diffusion coefficient of ion species <italic>k</italic>. The electric component is
<disp-formula id="pcbi.1006510.e004"><alternatives><graphic id="pcbi.1006510.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mtext>field</mml:mtext></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mi>ψ</mml:mi></mml:mfrac> <mml:mrow><mml:mo>∇</mml:mo> <mml:mi>ϕ</mml:mi></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
where <italic>ϕ</italic> is the electric potential, <italic>z</italic><sub><italic>k</italic></sub> is the valency of ion species <italic>k</italic>, and <italic>ψ</italic> = <italic>RT</italic>/<italic>F</italic> is defined by the gas constant (<italic>R</italic>), Faraday’s constant (<italic>F</italic>) and the temperature (<italic>T</italic>) which we assume to be constant (cf. <xref ref-type="table" rid="pcbi.1006510.t001">Table 1</xref>). Inserting Eqs <xref ref-type="disp-formula" rid="pcbi.1006510.e002">2</xref>–<xref ref-type="disp-formula" rid="pcbi.1006510.e004">4</xref> into <xref ref-type="disp-formula" rid="pcbi.1006510.e001">Eq 1</xref>, yields the time evolution of the concentration of ion species <italic>k</italic>:
<disp-formula id="pcbi.1006510.e005"><alternatives><graphic id="pcbi.1006510.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mo>∇</mml:mo> <mml:mo>·</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mi>D</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mi>ψ</mml:mi></mml:mfrac> <mml:mo>∇</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>]</mml:mo> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>in</mml:mtext> <mml:mspace width="4.pt"/><mml:mo>Ω</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula></p>
<table-wrap id="pcbi.1006510.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006510.t001</object-id>
<label>Table 1</label>
<caption>
<title>The physical parameters used in the simulations.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006510.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006510.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">symbol</th>
<th align="left">explanation</th>
<th align="left">value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><italic>R</italic></td>
<td align="left">gas constant</td>
<td align="left">8.314 J/(K mol)</td>
</tr>
<tr>
<td align="center"><italic>T</italic></td>
<td align="left">temperature</td>
<td align="left">300 K</td>
</tr>
<tr>
<td align="center"><italic>F</italic></td>
<td align="left">Faraday’s constant</td>
<td align="left">9.648 × 10<sup>4</sup> C/mol</td>
</tr>
<tr>
<td align="center"><italic>ϵ</italic><sub>0</sub></td>
<td align="left">vacuum permittivity</td>
<td align="left">8.854 × 10<sup>−12</sup> F/m</td>
</tr>
<tr>
<td align="center"><italic>ϵ</italic><sub><italic>r</italic></sub></td>
<td align="left">relative permittivity</td>
<td align="left">80</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>We model the ECS as a continuous medium, while in reality, the ECS only takes up roughly 20% of the tissue volume [<xref ref-type="bibr" rid="pcbi.1006510.ref044">44</xref>] in the brain. To compensate for this, we use the porous medium approximation [<xref ref-type="bibr" rid="pcbi.1006510.ref045">45</xref>]. This involves two changes to the model. The diffusion constants of the ion species are modified as
<disp-formula id="pcbi.1006510.e006"><alternatives><graphic id="pcbi.1006510.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>D</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msup><mml:mo>λ</mml:mo> <mml:mn>2</mml:mn></mml:msup></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
where λ is the tortuosity, which accounts for various hindrances to free diffusion and electrical migration through the ECS. We used the value λ = 1.6 [<xref ref-type="bibr" rid="pcbi.1006510.ref046">46</xref>]. We denote the fraction of tissue volume belonging to the ECS by <italic>α</italic>, and set the value <italic>α</italic> = 0.2. The sources in the system are modified as
<disp-formula id="pcbi.1006510.e007"><alternatives><graphic id="pcbi.1006510.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>f</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mi>α</mml:mi></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula> <inline-formula id="pcbi.1006510.e008"><alternatives><graphic id="pcbi.1006510.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006510.e009"><alternatives><graphic id="pcbi.1006510.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> are the values used in the simulations, and we will refer to these in the remainder of this study. In this study, we included four ion species: Ca<sup>2+</sup>, K<sup>+</sup>, Na<sup>+</sup>, and a general anion X<sup>−</sup> accounting for all negative ions in the system. Their diffusion constants, as well as their steady-state values assumed for the ECS, are shown in <xref ref-type="table" rid="pcbi.1006510.t002">Table 2</xref>.</p>
<table-wrap id="pcbi.1006510.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006510.t002</object-id>
<label>Table 2</label>
<caption>
<title>Diffusion constants and baseline ECS concentrations for the ion species considered, with values as in [<xref ref-type="bibr" rid="pcbi.1006510.ref004">4</xref>].</title>
<p>All ion constants were modified as <inline-formula id="pcbi.1006510.e010"><alternatives><graphic id="pcbi.1006510.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>D</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, where λ = 1.6 is the tortuosity. The general anion X<sup>−</sup> was given the properties of Cl<sup>−</sup>.</p>
</caption>
<alternatives>
<graphic id="pcbi.1006510.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006510.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="right">Na<sup>+</sup></th>
<th align="right">K<sup>+</sup></th>
<th align="right">X<sup>−</sup></th>
<th align="right">Ca<sup>2+</sup></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><italic>D</italic> (μm<sup>2</sup>/ms)</td>
<td align="right">1.33</td>
<td align="right">1.96</td>
<td align="char" char=".">2.03</td>
<td align="char" char=".">0.71</td>
</tr>
<tr>
<td align="left"><italic>c</italic><sub>out</sub> (mM)</td>
<td align="right">150</td>
<td align="right">3</td>
<td align="char" char=".">155.8</td>
<td align="char" char=".">1.4</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec005">
<title>Poisson-Nernst-Planck (PNP) framework</title>
<p>In order to solve the Nernst-Planck equation (<xref ref-type="disp-formula" rid="pcbi.1006510.e001">Eq 1</xref>), we need an expression for the electrical potential. One common approach is to assume Poisson’s equation for electrostatics,
<disp-formula id="pcbi.1006510.e011"><alternatives><graphic id="pcbi.1006510.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mo>∇</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mi>ϕ</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mi>ρ</mml:mi> <mml:mi>ϵ</mml:mi></mml:mfrac> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mtext>in</mml:mtext> <mml:mspace width="4.pt"/><mml:mo>Ω</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
where <italic>ρ</italic> is the charge concentration in the system, and <italic>ϵ</italic> is the permittivity of the system, given by <italic>ϵ</italic> = <italic>ϵ</italic><sub><italic>r</italic></sub> <italic>ϵ</italic><sub>0</sub>, where <italic>ϵ</italic><sub>0</sub> is the vacuum permittivity, and <italic>ϵ</italic><sub><italic>r</italic></sub> is the relative permittivity of the extracellular medium (cf. <xref ref-type="table" rid="pcbi.1006510.t001">Table 1</xref>).</p>
<p>The charge concentration is given by the sum of contributions from the different ion species,
<disp-formula id="pcbi.1006510.e012"><alternatives><graphic id="pcbi.1006510.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ρ</mml:mi> <mml:mo>=</mml:mo> <mml:mi>F</mml:mi> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mtext>ions</mml:mtext></mml:mrow></mml:munder> <mml:msub><mml:mi>z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula></p>
<p>Poisson’s equation (<xref ref-type="disp-formula" rid="pcbi.1006510.e011">Eq 8</xref>) combined with the Nernst-Planck equation (<xref ref-type="disp-formula" rid="pcbi.1006510.e005">Eq 5</xref>) is referred to as the Poisson-Nernst-Planck equations. The PNP-system is defined at all points in space and gives physically correct results in cases where the continuum approximation for the ions is valid. However, there are a few challenges involved in solving the PNP system. Firstly, when neuronal membranes are present in the system, these need to be defined in terms of appropriate boundary conditions. Secondly, the PNP system is numerically very inefficient, because it models charge-relaxation processes which in the tissue solution take place at the spatiotemporal scales of nanometers and nanoseconds [<xref ref-type="bibr" rid="pcbi.1006510.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref048">48</xref>].</p>
</sec>
<sec id="sec006">
<title>Kirchhoff-Nernst-Planck (KNP) framework</title>
<p>Several frameworks that assume the system to be electroneutral at all interior points have been developed to overcome the limitations of the PNP framework [<xref ref-type="bibr" rid="pcbi.1006510.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref036">36</xref>–<xref ref-type="bibr" rid="pcbi.1006510.ref041">41</xref>]. We will here present one of these frameworks, which we have coined the Kirchhoff-Nernst-Planck framework.</p>
<p>In the KNP framework, the electric field (in <xref ref-type="disp-formula" rid="pcbi.1006510.e001">Eq 1</xref>) is required to be such that:
<disp-formula id="pcbi.1006510.e013"><alternatives><graphic id="pcbi.1006510.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>ρ</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>i</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>cap</mml:mtext></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
at all points in the system. In all the applications of this study, the neural output is implemented as a set of point sources which are known from separate simulations performed in the NEURON simulator. Here, <inline-formula id="pcbi.1006510.e014"><alternatives><graphic id="pcbi.1006510.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msub><mml:mover accent="true"><mml:mi>i</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>cap</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> is the capacitive component in the source term, which exclusively stems from the capacitive current across a neuronal membrane. The bulk solution is assumed to be electroneutral, so that ∂<italic>ρ</italic>/∂<italic>t</italic> = 0 at points where there are no neuronal source. In other words, the only allowed nonzero charge density in the KNP-system is that building up the membrane potential across a capacitive membrane.</p>
<p>The rationale behind assuming bulk electroneutrality is that (i) charge concentration will only deviate from zero on nanometer scales, and that (ii) charge-relaxation occurs within a few nanoseconds, after which the system will settle at a quasi-steady state where ∂<italic>ρ</italic>/∂<italic>t</italic> ≈ 0. Furthermore, the number of ions that constitute the net charge density at equilibrium is about nine orders of magnitudes smaller than the number of ions present [<xref ref-type="bibr" rid="pcbi.1006510.ref035">35</xref>]. Hence, if we simulate neuronal processes that take place at the spatiotemporal resolution of, or larger than, micrometers and microseconds, we would expect the bulk solution to appear electroneutral.</p>
<p>Motivated by this, the KNP-scheme bypasses the rapid equilibration process by assuming that the quasi-steady state is reached instantaneously, and derives the value for <italic>ϕ</italic> associated with the equilibrium state. In doing so, the KNP-scheme implicitly neglects the tiny local charge separation associated with charge-relaxation processes in the bulk. We investigate the magnitude of this charge separation in the Results-section.</p>
<p>To turn <xref ref-type="disp-formula" rid="pcbi.1006510.e013">Eq 10</xref> into an equation which can be solved for <italic>ϕ</italic>, we combine it with <xref ref-type="disp-formula" rid="pcbi.1006510.e012">Eq 9</xref> to obtain:
<disp-formula id="pcbi.1006510.e015"><alternatives><graphic id="pcbi.1006510.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mtext>ions</mml:mtext></mml:mrow></mml:munder> <mml:msub><mml:mi>z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>i</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>cap</mml:mtext></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
Inserting this into the Nernst-Planck equation (<xref ref-type="disp-formula" rid="pcbi.1006510.e005">Eq 5</xref>) gives us:
<disp-formula id="pcbi.1006510.e016"><alternatives><graphic id="pcbi.1006510.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∇</mml:mo> <mml:mo>·</mml:mo> <mml:mo>(</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>∇</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>+</mml:mo> <mml:mo>∇</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mi>F</mml:mi> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mtext>ions</mml:mtext></mml:mrow></mml:munder> <mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>i</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>cap</mml:mtext></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>in</mml:mtext> <mml:mspace width="4.pt"/><mml:mo>Ω</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
where <italic>σ</italic> is the conductivity of the medium, defined as [<xref ref-type="bibr" rid="pcbi.1006510.ref049">49</xref>]:
<disp-formula id="pcbi.1006510.e017"><alternatives><graphic id="pcbi.1006510.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>σ</mml:mi> <mml:mo>=</mml:mo> <mml:mi>F</mml:mi> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mtext>ions</mml:mtext></mml:mrow></mml:munder> <mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow> <mml:mi>ψ</mml:mi></mml:mfrac> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
and
<disp-formula id="pcbi.1006510.e018"><alternatives><graphic id="pcbi.1006510.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mi>F</mml:mi> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mtext>ions</mml:mtext></mml:mrow></mml:munder> <mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula> <xref ref-type="disp-formula" rid="pcbi.1006510.e016">Eq 12</xref> is similar to Poisson’s equation, in that it is an elliptic equation that can be solved for <italic>ϕ</italic>, assuming that <italic>c</italic><sub><italic>k</italic></sub> is known.</p>
<p>The potential can be separated into the contribution from diffusive effects, and the contribution from the membrane currents. In order to analyze these components separately, we replace <xref ref-type="disp-formula" rid="pcbi.1006510.e016">Eq 12</xref> with the following equivalent set of equations:
<disp-formula id="pcbi.1006510.e019"><alternatives><graphic id="pcbi.1006510.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ϕ</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mtext>VC</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mtext>diff</mml:mtext></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
where
<disp-formula id="pcbi.1006510.e020"><alternatives><graphic id="pcbi.1006510.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∇</mml:mo> <mml:mo>·</mml:mo> <mml:mo>(</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mtext>VC</mml:mtext></mml:msub> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mi>F</mml:mi> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mtext>ions</mml:mtext></mml:mrow></mml:munder> <mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>i</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>cap</mml:mtext></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>in</mml:mtext> <mml:mspace width="4.pt"/><mml:mo>Ω</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
and
<disp-formula id="pcbi.1006510.e021"><alternatives><graphic id="pcbi.1006510.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∇</mml:mo> <mml:mo>·</mml:mo> <mml:mo>(</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mtext>diff</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:mo>∇</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>in</mml:mtext> <mml:mspace width="4.pt"/><mml:mo>Ω</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula></p>
<p>
<xref ref-type="disp-formula" rid="pcbi.1006510.e013">Eq 10</xref> ensures that balance between positive and negative ions entering a volume in extracellular space during a given time step is always so that the net charge accumulation is identical to the change in the (outside) membrane charge, as determined by <inline-formula id="pcbi.1006510.e022"><alternatives><graphic id="pcbi.1006510.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:msub><mml:mover accent="true"><mml:mi>i</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>cap</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>. However, the capacitive term <inline-formula id="pcbi.1006510.e023"><alternatives><graphic id="pcbi.1006510.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:msub><mml:mover accent="true"><mml:mi>i</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>cap</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> is not ion-specific, and does not enter as a source term in the Nernst-Planck equation for ion concentration dynamics (<xref ref-type="disp-formula" rid="pcbi.1006510.e001">Eq 1</xref>). This means that the KNP formalism does not specify which ions that actually accumulate at the membrane, but treats all ions entering a volume as part of the extracellular solution. The inaccuracy introduced by this approximation should be small, as the fraction of ions that are membrane bound should be very small at the spatial resolution that we are interested in.</p>
</sec>
<sec id="sec007">
<title>Volume Conductor (VC) framework</title>
<p>Standard VC-schemes include only the effects of the transmembrane currents, and ignore all other ion-concentration dynamics. Using the standard notation from current source density theory, the electric potential is found from
<disp-formula id="pcbi.1006510.e024"><alternatives><graphic id="pcbi.1006510.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>C</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mo>∇</mml:mo> <mml:mo>·</mml:mo> <mml:mo>[</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>∇</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
where <italic>C</italic> is the current source density [<xref ref-type="bibr" rid="pcbi.1006510.ref024">24</xref>]. This is the potential found in <xref ref-type="disp-formula" rid="pcbi.1006510.e020">Eq 16</xref>, if we set the current source density as
<disp-formula id="pcbi.1006510.e025"><alternatives><graphic id="pcbi.1006510.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>C</mml:mi> <mml:mo>=</mml:mo> <mml:mi>F</mml:mi> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mtext>ions</mml:mtext></mml:mrow></mml:munder> <mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>i</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>cap</mml:mtext></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula>
As the ECS concentrations are not modeled, <italic>σ</italic> is typically defined to be constant in VC-schemes, and current sources are modeled as either point or line sources [<xref ref-type="bibr" rid="pcbi.1006510.ref050">50</xref>]. This approach gives a closed-form solution for <italic>ϕ</italic>, which means it can be applied to arbitrarily large systems. In this study, when we refer to <italic>ϕ</italic><sub>VC</sub>, we mean <italic>ϕ</italic><sub>VC</sub> as found in the KNP-scheme (<xref ref-type="disp-formula" rid="pcbi.1006510.e020">Eq 16</xref>). This is essentially the same as in most common VC-implementations, with the exception that <italic>σ</italic> in <xref ref-type="disp-formula" rid="pcbi.1006510.e020">Eq 16</xref> is found from the ion concentrations.</p>
</sec>
<sec id="sec008">
<title>Diffusion Only (DO) framework</title>
<p>Reaction-diffusion schemes ignore all electric forces in the system. In our implementation, we obtained this by setting <italic>ϕ</italic> = 0 in <xref ref-type="disp-formula" rid="pcbi.1006510.e005">Eq 5</xref>. The resulting equation for the concentration dynamics is:
<disp-formula id="pcbi.1006510.e026"><alternatives><graphic id="pcbi.1006510.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mo>∇</mml:mo> <mml:mo>·</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>in</mml:mtext> <mml:mspace width="4.pt"/><mml:mo>Ω</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula>
This is the equation used when we refer to the DO-scheme in the Results-section.</p>
</sec>
</sec>
<sec id="sec009">
<title>Implementation</title>
<p>The solver for the above modeling schemes was implemented utilizing FEniCS, an open-source platform for solving partial differential equations using the finite element method [<xref ref-type="bibr" rid="pcbi.1006510.ref051">51</xref>]. The reader is referred to [<xref ref-type="bibr" rid="pcbi.1006510.ref052">52</xref>] for an extensive introduction to the finite element method. The time derivative was approximated using an implicit Euler time-stepping scheme. We chose to use this method as the PNP equations are highly unstable, and the implicit Euler step offers superior stability to other methods [<xref ref-type="bibr" rid="pcbi.1006510.ref033">33</xref>]. Employing the implicit Euler step makes the PNP-scheme fairly stable, at the cost of numerical efficiency. Piecewise linear Lagrangian elements were used for all unknowns in all simulations [<xref ref-type="bibr" rid="pcbi.1006510.ref052">52</xref>].</p>
<p>The system was solved monolithically, using Newton’s method to solve for each time step. Due to limitations of FEniCS’ built-in nonlinear solver, we implemented our own Newton solver, which is found in the source code. Details on the FEniCS implementation are found in <xref ref-type="supplementary-material" rid="pcbi.1006510.s002">S1 Appendix</xref>.</p>
<sec id="sec010">
<title>Boundary conditions</title>
<p>For the first application, we employed a sealed (no-flow) boundary for the ion concentrations,
<disp-formula id="pcbi.1006510.e027"><alternatives><graphic id="pcbi.1006510.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>J</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>·</mml:mo> <mml:mi mathvariant="bold">n</mml:mi></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>at</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>∂</mml:mi> <mml:mo>Ω</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula>
where <bold>n</bold> is a unit vector directed out of the domain, and ∂<italic>Ω</italic> is the boundary of the domain.</p>
<p>For the second and third application, we assumed a concentration-clamp boundary condition,
<disp-formula id="pcbi.1006510.e028"><alternatives><graphic id="pcbi.1006510.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>out</mml:mtext></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>at</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>∂</mml:mi> <mml:mo>Ω</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
where <italic>c</italic><sub><italic>k</italic>,out</sub> was set to typical ECS baseline concentrations, see <xref ref-type="table" rid="pcbi.1006510.t002">Table 2</xref>. This can be interpreted as our system interacting with a larger reservoir of ions (the rest of the brain).</p>
<p>In order to maintain overall electroneutrality in the system, the KNP-scheme dictates that no net charge can leave the system on the boundary. In the current application, we have applied this criterion locally to each point at the boundary, using the condition:
<disp-formula id="pcbi.1006510.e029"><alternatives><graphic id="pcbi.1006510.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>(</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>∇</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>+</mml:mo> <mml:mo>∇</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo> <mml:mo>·</mml:mo> <mml:mi mathvariant="bold">n</mml:mi></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>at</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>∂</mml:mi> <mml:mo>Ω</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula></p>
<p>Note that this requirement is automatically fulfilled when we use the boundary conditions in <xref ref-type="disp-formula" rid="pcbi.1006510.e027">Eq 21</xref>, but must be given as an additional condition when the concentration-clamp boundary is used. Furthermore, as we split the potential into the components <italic>ϕ</italic><sub>diff</sub> and <italic>ϕ</italic><sub>VC</sub>, we had to apply boundary conditions to each component. We set the boundary conditions as
<disp-formula id="pcbi.1006510.e030"><alternatives><graphic id="pcbi.1006510.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>(</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mtext>diff</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:mo>∇</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo> <mml:mo>·</mml:mo> <mml:mi mathvariant="bold">n</mml:mi></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>at</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>∂</mml:mi> <mml:mo>Ω</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula>
<disp-formula id="pcbi.1006510.e031"><alternatives><graphic id="pcbi.1006510.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>∇</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mtext>VC</mml:mtext></mml:mrow></mml:msub> <mml:mo>·</mml:mo> <mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>n</mml:mi></mml:mstyle> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>at</mml:mtext><mml:mspace width="4pt"/><mml:mo>∂</mml:mo> <mml:mo>Ω</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula></p>
<p>In order to compare the PNP- and KNP-schemes directly, we chose the same boundary condition for the potential in the PNP-scheme.</p>
<p>To make the system fully determined, we set the additional requirement
<disp-formula id="pcbi.1006510.e032"><alternatives><graphic id="pcbi.1006510.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>∫</mml:mo> <mml:mo>Ω</mml:mo></mml:msub> <mml:mi>ϕ</mml:mi> <mml:mspace width="4pt"/><mml:mtext>d</mml:mtext> <mml:mi>x</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula></p>
</sec>
</sec>
<sec id="sec011">
<title>Summary of the KNP-scheme</title>
<p>For readability, we include the complete set of equations used in the KNP-scheme.
<disp-formula id="pcbi.1006510.e033"><alternatives><graphic id="pcbi.1006510.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>-</mml:mo> <mml:mo>∇</mml:mo> <mml:mo>·</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mi>ψ</mml:mi></mml:mfrac> <mml:mo>∇</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>in</mml:mtext> <mml:mspace width="4.pt"/><mml:mo>Ω</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(27)</label></disp-formula> <disp-formula id="pcbi.1006510.e034"><alternatives><graphic id="pcbi.1006510.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∇</mml:mo> <mml:mo>·</mml:mo> <mml:mo>(</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mtext>VC</mml:mtext></mml:msub> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mi>F</mml:mi> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mtext>ions</mml:mtext></mml:mrow></mml:munder> <mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>i</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>cap</mml:mtext></mml:msub></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>in</mml:mtext> <mml:mspace width="4.pt"/><mml:mo>Ω</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(28)</label></disp-formula> <disp-formula id="pcbi.1006510.e035"><alternatives><graphic id="pcbi.1006510.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∇</mml:mo> <mml:mo>·</mml:mo> <mml:mo>(</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mtext>diff</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:mo>∇</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>in</mml:mtext> <mml:mspace width="4.pt"/><mml:mo>Ω</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(29)</label></disp-formula> <disp-formula id="pcbi.1006510.e036"><alternatives><graphic id="pcbi.1006510.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>out</mml:mtext></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>at</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>∂</mml:mi> <mml:mo>Ω</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(30)</label></disp-formula> <disp-formula id="pcbi.1006510.e037"><alternatives><graphic id="pcbi.1006510.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>(</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>∇</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mtext>diff</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:mo>∇</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo> <mml:mo>·</mml:mo> <mml:mi mathvariant="bold">n</mml:mi></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>at</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>∂</mml:mi> <mml:mo>Ω</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(31)</label></disp-formula> <disp-formula id="pcbi.1006510.e038"><alternatives><graphic id="pcbi.1006510.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∇</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mtext>VC</mml:mtext></mml:msub> <mml:mo>·</mml:mo> <mml:mi mathvariant="bold">n</mml:mi></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>at</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>∂</mml:mi> <mml:mo>Ω</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(32)</label></disp-formula>
where we use the following definitions
<disp-formula id="pcbi.1006510.e039"><alternatives><graphic id="pcbi.1006510.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e039" xlink:type="simple"/><mml:math display="block" id="M39"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mtext>VC</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mtext>diff</mml:mtext></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(33)</label></disp-formula> <disp-formula id="pcbi.1006510.e040"><alternatives><graphic id="pcbi.1006510.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mi>σ</mml:mi> <mml:mrow><mml:mo>=</mml:mo> <mml:mi>F</mml:mi> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mtext>ions</mml:mtext></mml:mrow></mml:munder> <mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow> <mml:mi>ψ</mml:mi></mml:mfrac> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(34)</label></disp-formula> <disp-formula id="pcbi.1006510.e041"><alternatives><graphic id="pcbi.1006510.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mi>b</mml:mi> <mml:mrow><mml:mo>=</mml:mo> <mml:mi>F</mml:mi> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mtext>ions</mml:mtext></mml:mrow></mml:munder> <mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(35)</label></disp-formula>
Furthermore, <inline-formula id="pcbi.1006510.e042"><alternatives><graphic id="pcbi.1006510.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006510.e043"><alternatives><graphic id="pcbi.1006510.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:msub><mml:mover accent="true"><mml:mi>i</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>cap</mml:mtext></mml:msub></mml:math></alternatives></inline-formula> are assumed to be known quantities.</p>
</sec>
<sec id="sec012">
<title>Application details</title>
<p>In the following, we go through the details of the three applications presented.</p>
<sec id="sec013">
<title>Application 1: 1-D step concentration</title>
<p>In the first application, which was implemented using the PNP-, KNP-, and DO-schemes, we used an idealized 1-D mesh with a resolution sufficiently fine for PNP to be stable. Two ion species were included in this setup; Na<sup>+</sup> and X<sup>−</sup>. We present two simulations using this setup.</p>
<list list-type="order">
<list-item>
<p>The first simulation was performed on a mesh on the interval [−0.1 μm, 0.1 μm]. The mesh had uniformly spaced vertices, with Δ<italic>x</italic> = 0.02 nm. The time step was set to Δ<italic>t</italic> = 0.1 ns. The simulation was stopped at <italic>t</italic><sub>end</sub> = 0.1 μs.</p>
</list-item>
<list-item>
<p>The second simulation was performed on a mesh on the interval [−50 μm, 50 μm], with Δ<italic>x</italic> = 0.01 μm, and Δ<italic>t</italic> = 1.0 ms. The simulation was stopped at <italic>t</italic><sub>end</sub> = 10 μs.</p>
</list-item>
</list>
<p>For both simulations, the initial concentration of both ion species was set to a step function, as
<disp-formula id="pcbi.1006510.e044"><alternatives><graphic id="pcbi.1006510.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e044" xlink:type="simple"/><mml:math display="block" id="M44"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>c</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>140</mml:mn> <mml:mspace width="4.pt"/><mml:mtext>mM</mml:mtext></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>x</mml:mi> <mml:mo>≤</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>150</mml:mn> <mml:mspace width="4.pt"/><mml:mtext>mM</mml:mtext></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>x</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(36)</label></disp-formula></p>
</sec>
<sec id="sec014">
<title>Application 2: Point source/sink simulation</title>
<p>For the second application, which was implemented using the KNP-scheme, we generated a 3-D box-shaped mesh with opposing corners located at (0 μm, 0 μm, 0 μm) and (400 μm, 400 μm and 40 μm). The mesh consisted of 27000 linear tetrahedral cells. A K<sup>+</sup> point source and a K<sup>+</sup> point sink were placed in the system. They were placed with a distance of 160 <italic>μ</italic>m apart, at <bold>x</bold><sub>1</sub> = (120 μm, 200 μm, 20 μm) and <bold>x</bold><sub>2</sub> = (280 μm, 200 μ, m20 μm). Both were turned on at <italic>t</italic> = 0 and shut off at <italic>t</italic> = 1 s. The point source/sink pair were given opposites fluxes, of magnitude ±<italic>I</italic>(<italic>Fα</italic>)<sup>−1</sup>, where <italic>F</italic> is Faraday’s constant, <italic>α</italic> is the ECS fraction, and <italic>I</italic> is the input current, set to <italic>I</italic> = 0.1 nA. The simulation was started at <italic>t</italic><sub>start</sub> = 0 s, and stopped at <italic>t</italic><sub>end</sub> = 2 s, with a time step of Δ<italic>t</italic> = 2 ms. Two measurement points were chosen to create time series of the potential. These were placed at <bold>x</bold><sub>left</sub> = (120 μ, m205 μ, m20 μm) and <bold>x</bold><sub>right</sub> = (280 μ, m205 μ, m20 μm) (see <xref ref-type="sec" rid="sec016">Results</xref>).</p>
</sec>
<sec id="sec015">
<title>Application 3: Input from a morphologically detailed neuron</title>
<p>In the final simulation we modeled the ion sources from a morphologically detailed neuron [<xref ref-type="bibr" rid="pcbi.1006510.ref043">43</xref>], using the KNP-scheme. The source terms were generated by simulations run on the NEURON simulator. The spatial location and magnitude of ion specific membrane currents were stored, and used as an external input to the KNP simulation in the form of ion sinks and sources distributed in the 3-D ECS mesh (i.e., ions entering or disappearing from the ECS), as illustrated in <xref ref-type="fig" rid="pcbi.1006510.g001">Fig 1A and 1B</xref>. The NEURON simulations were run independently from the KNP simulation, which means that there was no feedback from the ECS dynamics to the neurons. Apart from determining the distribution of point sources/sinks, the neuronal morphology was not explicitly accounted in the KNP simulations. However, the reduced extracellular volume fraction and the membrane-imposed hindrances (tortuosity) to extracellular transports were accounted for as a tissue-average, as reflected in the porous medium approximation (cf. Eqs <xref ref-type="disp-formula" rid="pcbi.1006510.e006">6</xref> and <xref ref-type="disp-formula" rid="pcbi.1006510.e007">7</xref>).</p>
<fig id="pcbi.1006510.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006510.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Model system of a 3-D cylinder of ECS containing a morphologically detailed neuron.</title>
<p><bold>(A)</bold> The simulated domain is denoted by <italic>Ω</italic>, and the boundary is denoted by ∂<italic>Ω</italic>. Exchange of ions between the neuron and ECS was modeled as a set of point sources (marked by blue dots). Two measurement points were used to create time series in the Results-section. These are shown as the green and purple points. <bold>(B)</bold> Each point source was included as a sink/source of each ion species, as well as a capacitive current.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006510.g001" xlink:type="simple"/>
</fig>
<p>Assuming a single point source, located at the point <bold>x</bold><sub>1</sub> = (<italic>x</italic><sub>1</sub>, <italic>y</italic><sub>1</sub>, <italic>z</italic><sub>1</sub>), with an ion specific current <italic>I</italic><sub><italic>k</italic></sub>(<italic>t</italic>), the source term for ion species <italic>k</italic> would be,
<disp-formula id="pcbi.1006510.e045"><alternatives><graphic id="pcbi.1006510.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e045" xlink:type="simple"/><mml:math display="block" id="M45"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>F</mml:mi> <mml:msub><mml:mi>z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mi>α</mml:mi></mml:mrow></mml:mfrac> <mml:msub><mml:mi>I</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(37)</label></disp-formula>
where the 3-D Dirac delta function <italic>δ</italic><sup>3</sup>(<bold>x</bold>) is used to make the source local in space. The 3-D neuron in separated into <italic>N</italic><sub><italic>C</italic></sub> compartments, with centers at <inline-formula id="pcbi.1006510.e046"><alternatives><graphic id="pcbi.1006510.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mi>C</mml:mi></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. The source term for ion species <italic>k</italic> is the sum of the current point sources from all these compartments,
<disp-formula id="pcbi.1006510.e047"><alternatives><graphic id="pcbi.1006510.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>F</mml:mi> <mml:msub><mml:mi>z</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mi>α</mml:mi></mml:mrow></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mi>C</mml:mi></mml:msub></mml:munderover> <mml:msubsup><mml:mi>I</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mi>j</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(38)</label></disp-formula>
where <inline-formula id="pcbi.1006510.e048"><alternatives><graphic id="pcbi.1006510.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi> <mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the current from compartment <italic>j</italic> specific to ion species <italic>k</italic>, at time <italic>t</italic>. By convention, we define the current to be positive if there is a flow of positive charge out of the cell. In addition to the ionic membrane currents <inline-formula id="pcbi.1006510.e049"><alternatives><graphic id="pcbi.1006510.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:msubsup><mml:mi>I</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mi>j</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> there are also capacitive membrane currents <inline-formula id="pcbi.1006510.e050"><alternatives><graphic id="pcbi.1006510.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:msubsup><mml:mi>I</mml:mi> <mml:mrow><mml:mtext>cap</mml:mtext></mml:mrow> <mml:mi>j</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. As capacitive sources are not ion specific, they did not appear as source terms in the Nernst-Planck equation (<xref ref-type="disp-formula" rid="pcbi.1006510.e005">Eq 5</xref>), but gave rise to source terms in the KNP equation for the extracellular field. (cf. <xref ref-type="disp-formula" rid="pcbi.1006510.e013">Eq 10</xref>):
<disp-formula id="pcbi.1006510.e051"><alternatives><graphic id="pcbi.1006510.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e051" xlink:type="simple"/><mml:math display="block" id="M51"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>i</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>cap</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>α</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mi>C</mml:mi></mml:msub></mml:munderover> <mml:msubsup><mml:mi>I</mml:mi> <mml:mrow><mml:mtext>cap</mml:mtext></mml:mrow> <mml:mi>j</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(39)</label></disp-formula>
With these source terms (Eqs <xref ref-type="disp-formula" rid="pcbi.1006510.e047">38</xref> and <xref ref-type="disp-formula" rid="pcbi.1006510.e051">39</xref>), the KNP equation (<xref ref-type="disp-formula" rid="pcbi.1006510.e016">Eq 12</xref>) can be written:
<disp-formula id="pcbi.1006510.e052"><alternatives><graphic id="pcbi.1006510.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e052" xlink:type="simple"/><mml:math display="block" id="M52"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∇</mml:mo> <mml:mo>·</mml:mo> <mml:mo>(</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>∇</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>+</mml:mo> <mml:mo>∇</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>α</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mi>C</mml:mi></mml:msub></mml:munderover> <mml:msup><mml:mi>I</mml:mi> <mml:mi>j</mml:mi></mml:msup> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(40)</label></disp-formula>
where <italic>I</italic><sup><italic>j</italic></sup> denotes the sum of all ionic and capacitive membrane current at compartment <italic>j</italic>,
<disp-formula id="pcbi.1006510.e053"><alternatives><graphic id="pcbi.1006510.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e053" xlink:type="simple"/><mml:math display="block" id="M53"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>I</mml:mi> <mml:mi>j</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>I</mml:mi> <mml:mrow><mml:mtext>cap</mml:mtext></mml:mrow> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mtext>ions</mml:mtext></mml:mrow></mml:munder> <mml:msubsup><mml:mi>I</mml:mi> <mml:mi>k</mml:mi> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(41)</label></disp-formula></p>
<p>The delta functions were implemented using the <monospace>PointSource</monospace> object in FEniCS, which will approximate a Dirac delta function at a given point <bold>x</bold><sub><italic>j</italic></sub> by a function using only the closest points in the mesh.</p>
<p>To generate the ion-specific membrane currents, we used a model developed for cortical layer 5 pyramidal cells [<xref ref-type="bibr" rid="pcbi.1006510.ref043">43</xref>], consisting of 196 sections. All ionic currents, as well as the capacitive current, was recorded for each section. The neuron was driven by Poissonian input trains through 10.000 synapses. The synapses were uniformly distributed over the membrane area, and were tuned to give the model neuron a firing rate of about five action potentials (APs) per second. The NEURON simulation was nearly identical to that used by us previously, and we refer to the original implementation for further details [<xref ref-type="bibr" rid="pcbi.1006510.ref004">4</xref>]. The only difference is that in the previous paper, the membrane currents were stored in 1-D compartments based on their position in the discretization of the ECS, while in this implementation they were stored as point sources with 3-D coordinates.</p>
<p>The extracellular space was modeled as a 3-D cylinder with a height of roughly 1500 μm and a radius of roughly 500 μm. The mesh was automatically generated using <italic>mshr</italic> [<xref ref-type="bibr" rid="pcbi.1006510.ref053">53</xref>], yielding a mesh with 53619 linear tetrahedral cells. All ionic concentrations were clamped at the boundary, to their initial background concentrations (cf. <xref ref-type="table" rid="pcbi.1006510.t002">Table 2</xref>). The time step was Δ<italic>t</italic> = 0.1 s, and the simulation was stopped at <italic>t</italic><sub>end</sub> = 80 s. An additional simulation was performed using a smaller time step of Δ<italic>t</italic> = 0.1 ms. Starting with the concentrations found at the end of the 80-second simulation, this secondary simulation was stopped at <italic>t</italic><sub>end</sub> = 80.2 s. The NEURON simulations were performed using time steps of 0.025 ms. The neuronal output to the extracellular space during an extracellular time step Δ<italic>t</italic>, was computed by integrating the NEURON simulation outcome over Δ<italic>t</italic>.</p>
<p>Two measurement points were chosen for creating time series of the concentrations. These are referred to as the green and purple measurement points in the Results-section, and are shown in <xref ref-type="fig" rid="pcbi.1006510.g001">Fig 1A</xref>. In the computational mesh, with the soma centered at the origin, the green point was set at <bold>x</bold><sub>green</sub> = (20 μm, 20 μm, 20 μm), and the purple point was set near the apical dendrites, at <bold>x</bold><sub>purple</sub> = (−100 μm, 1100 μm, 0 μm).</p>
</sec>
</sec>
</sec>
<sec id="sec016" sec-type="results">
<title>Results</title>
<p>Below we present the results obtained with the three different applications listed in the introduction and methodology. In the first subsection, we have explored the validity of the KNP framework by comparing it to the PNP framework in a simplified application representing a box filled with a solution containing only two ion species, Na<sup>+</sup> and X<sup>−</sup>. We also showed that even for this system, containing no current sources, a DO model gave different results that the other models. In the second subsection, we have highlighted the differences between the KNP- and VC-schemes using an idealized application containing only a single current source and sink, both mediated by K<sup>+</sup> ions. Finally, in the third subsection, we have used the KNP-scheme to model the ion dynamics and electric potential around a detailed model of a pyramidal neuron. For this final application, we also compared the predictions of the KNP-scheme to those of the simpler DO- and VC-schemes, and analyzed their differences.</p>
<sec id="sec017">
<title>Application 1: Comparison of KNP-, PNP- and DO-schemes for a salt concentration gradient</title>
<p>The differences and similarities between KNP, PNP and DO were illustrated using the simplified 1-D domain representing a box filled with a solution containing two ion species, Na<sup>+</sup> and X<sup>−</sup>, with an initial concentration gradient (see <xref ref-type="sec" rid="sec002">Methods</xref>).</p>
<p>When we simulated Application 1 using the PNP-scheme, two distinct modes of behavior were revealed. Firstly, an initial charge-relaxation mode occurred. During this mode, the X<sup>−</sup> concentration spread towards the left side of the box faster than the Na<sup>+</sup> concentration, since X<sup>−</sup> had a larger diffusion coefficient than Na<sup>+</sup>. Due to the charge separation caused by this process, an electrical potential difference rapidly built up in the system (see blue line in <xref ref-type="fig" rid="pcbi.1006510.g002">Fig 2A</xref>). The charge separation process only went on for a few nanoseconds, before the system reached a quasi-steady state. Secondly, a quasi-steady state occurred, in which the potential difference was such that diffusion and electrical drift were in equilibrium, and further charge separation was prevented. The quasi-steady state potential changed on a slow timescale of seconds (<xref ref-type="fig" rid="pcbi.1006510.g002">Fig 2B</xref>). This was the timescale at which the concentration differences in the system evened out.</p>
<fig id="pcbi.1006510.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006510.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Electrodiffusion in a simple 1-D system containing no current sources.</title>
<p>The system had an initial step concentration of NaX being 140 mM for <italic>x</italic> &lt; 0 and 150 mM for <italic>x</italic> &gt; 0. <bold>(A)</bold> Dynamics of the potential difference between the left and right sides of the system on a short timescale. Δ<italic>ϕ</italic> is defined as Δ<italic>ϕ</italic> = <italic>ϕ</italic>(<italic>x</italic><sub>right</sub>) − <italic>ϕ</italic>(<italic>x</italic><sub>left</sub>), where <italic>x</italic><sub>right</sub> = 0.1 μm and <italic>x</italic><sub>left</sub> = −0.1 μm. In PNP simulations, the system spent about 10 ns building up the potential difference across the system. In KNP simulations, the steady-state potential was assumed to occur immediately. After 10 ns, the schemes were virtually indistinguishable. <bold>(B)</bold> Dynamics of the potential between <italic>x</italic><sub>right</sub> = 50 μm and <italic>x</italic><sub>left</sub> = −50 μm on a long timescale. The PNP- and KNP-schemes gave identical predictions. <bold>(C)</bold> The concentration profiles in the system at <italic>t</italic> = 1.0 s as obtained with KNP, DO and according to the theoretical approximation when NaX develops as a single concentration moving by diffusion with a modified diffusion coefficient.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006510.g002" xlink:type="simple"/>
</fig>
<p>A comparison between the two lines in <xref ref-type="fig" rid="pcbi.1006510.g002">Fig 2A and 2B</xref> highlights the key difference between the PNP (blue line) and KNP (yellow dashed line) schemes. The KNP-scheme does not model the relaxation of the charge concentration, but derives the quasi-steady state potential directly. The results using KNP therefore deviated from those using PNP only on very short timescales during which the quasi-steady state potential was built up. After the initial charge-relaxation (<italic>t</italic>&gt; 5 ns), the two schemes were in excellent agreement.</p>
<p>In theoretical studies of binary systems of ions, it has been shown that the ion concentrations will develop approximately as a single particle species moving by simple diffusion with a modified diffusion coefficient [<xref ref-type="bibr" rid="pcbi.1006510.ref054">54</xref>],
<disp-formula id="pcbi.1006510.e054"><alternatives><graphic id="pcbi.1006510.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006510.e054" xlink:type="simple"/><mml:math display="block" id="M54"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>NaX</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mn>2</mml:mn> <mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>Na</mml:mtext></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>X</mml:mtext></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>Na</mml:mtext></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mtext>X</mml:mtext></mml:msub></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(42)</label></disp-formula>
In <xref ref-type="fig" rid="pcbi.1006510.g002">Fig 2C</xref> the ion concentration profiles obtained with this theoretical approximation have been compared to a KNP-based simulation, as well as a DO-simulation where the electric charge of the ions was ignored, so that they were allowed to diffuse independently. The KNP solution was in agreement with <xref ref-type="disp-formula" rid="pcbi.1006510.e054">Eq 42</xref>, and shows that the anion and cation concentrations coincided closely due to the strong electrical forces that would be associated with charge separation. This comparison highlights the shortcomings of the DO-model, which (i) gave inaccurate predictions of the two ion-concentration profiles, and (ii) predicted that the twin ion species were not locally balanced, so that the system contained a charge density <italic>ρ</italic> = <italic>F</italic>(<italic>c</italic><sub>Na</sub>−<italic>c</italic><sub>X</sub>) which varied over the x-axis. According to the Poisson equation (<xref ref-type="disp-formula" rid="pcbi.1006510.e011">Eq 8</xref>), the charge density associated with the concentration profiles in <xref ref-type="fig" rid="pcbi.1006510.g002">Fig 2C</xref> would amount voltage differences of 247 kV across the system, which is clearly not physically realistic.</p>
</sec>
<sec id="sec018">
<title>Application 2: Comparison of KNP- and VC-schemes for an ion source-sink pair</title>
<p>We next compared the KNP-scheme with the simpler VC-scheme for computing ECS potentials. We first did this for an idealized setup, using the computational domain of a 3-D box consisting of the extracellular domain. The initial ion concentrations were uniform, with values from <xref ref-type="table" rid="pcbi.1006510.t002">Table 2</xref>. The box contained one K<sup>+</sup> point source, and one K<sup>+</sup> point sink, with equal magnitudes (see <xref ref-type="sec" rid="sec002">Methods</xref>).</p>
<p>The electrical potential <italic>ϕ</italic> at the end of the stimulus period (<italic>t</italic> = 1 s) is shown in <xref ref-type="fig" rid="pcbi.1006510.g003">Fig 3A</xref>. The resulting electrical potential could be split into two contributions, i.e., the contribution from the source and sink currents, <italic>ϕ</italic><sub>VC</sub> (<xref ref-type="fig" rid="pcbi.1006510.g003">Fig 3B</xref>), and the contribution from the diffusive currents in the ECS, <italic>ϕ</italic><sub>diff</sub> (<xref ref-type="fig" rid="pcbi.1006510.g003">Fig 3C</xref>).</p>
<fig id="pcbi.1006510.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006510.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Application with a K<sup>+</sup> point source/sink pair in a 3-D box containing a standard ECS ion solution.</title>
<p>The source and sink were turned on at <italic>t</italic> = 0 s, and turned off at <italic>t</italic> = 1 s. The simulation was stopped at <italic>t</italic> = 2 s. <bold>(A)</bold> The total electrical potential <italic>ϕ</italic> at the end of the stimulus period (<italic>t</italic> = 1.0 s) in a plane intersecting the source and sink. <bold>(B)</bold> The volume conductor component of the electrical potential, <italic>ϕ</italic><sub>VC</sub>. <bold>(C)</bold> The diffusive component of the electrical potential <italic>ϕ</italic><sub>diff</sub>. <bold>(D)</bold> The difference in the electric potential between points close to the point sources (blue line), also shown is the differences in the VC component of the potential (stapled yellow line). Δ<italic>ϕ</italic> is defined as Δ<italic>ϕ</italic> = <italic>ϕ</italic>(<bold>x</bold><sub>left</sub>) − <italic>ϕ</italic>(<bold>x</bold><sub>right</sub>), where <bold>x</bold><sub>left</sub> and <bold>x</bold><sub>right</sub> were points 5 μm away from the left and right, respectively (see <xref ref-type="sec" rid="sec002">Methods</xref>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006510.g003" xlink:type="simple"/>
</fig>
<p>In this simulation, <italic>ϕ</italic><sub>VC</sub> had a constant value which was reached immediately when the source and sink were turned on, and remained constant throughout the stimulus period since the source and sink were constant. This was not the case for <italic>ϕ</italic><sub>diff</sub>, which was close to zero at <italic>t</italic> = 0, but increased gradually throughout the simulation, as concentration gradients built up in the system. The diffusion potential <italic>ϕ</italic><sub>diff</sub> was quite local, and gave strongest contribution close to the source and sink (<xref ref-type="fig" rid="pcbi.1006510.g003">Fig 3C</xref>).</p>
<p>The differences between the KNP scheme and VC scheme are illustrated in <xref ref-type="fig" rid="pcbi.1006510.g003">Fig 3D</xref>, which shows the potential difference between two points close to the source and sink. VC and KNP gave similar estimates of the potential <italic>ϕ</italic> only for a brief period after the source and sink had been turned on, when the contribution from diffusion was still small. As the simulation progressed, the local build-up of ion concentrations evoked a shift in the KNP-simulated potential <italic>ϕ</italic>, but left <italic>ϕ</italic><sub>VC</sub> unaffected. The difference between the schemes <italic>ϕ</italic> − <italic>ϕ</italic><sub>VC</sub> is identical to the diffusion potential <italic>ϕ</italic><sub>diff</sub>, which is not accounted for by the VC scheme. The diffusion component had a sort of screening effect, reducing the potential difference between the source and sink compared to what we would predict in the absence of diffusion (i.e. |<italic>ϕ</italic>| &lt; |<italic>ϕ</italic><sub>VC</sub>|). After roughly 0.1 seconds, <italic>ϕ</italic><sub>diff</sub> had lowered <italic>ϕ</italic> by about 5%, compared to what the VC model predicted. This effect lasted until the source and sink were turned off (<xref ref-type="fig" rid="pcbi.1006510.g003">Fig 3D</xref>). After this, <italic>ϕ</italic><sub>VC</sub> immediately dropped to zero, while in the KNP-scheme, a diffusion potential <italic>ϕ</italic><sub>diff</sub> remained. In the absence of sources, <italic>ϕ</italic><sub>diff</sub> decayed gradually until system reached a steady state.</p>
</sec>
<sec id="sec019">
<title>Application 3: Ion dynamics in the ECS of a morphologically detailed neuron</title>
<p>Finally, we used the KNP-scheme to model electrodiffusion in a 3-D cylinder containing a morphologically detailed neuron (<xref ref-type="fig" rid="pcbi.1006510.g001">Fig 1A</xref>). The neuron was represented as a set of point sources and sinks that had a spatial distribution representing the neuronal morphology, and which exchanged ions with the system as illustrated in <xref ref-type="fig" rid="pcbi.1006510.g001">Fig 1B</xref> (see <xref ref-type="sec" rid="sec002">Methods</xref> for details). Since ECS ion concentrations generally vary on a slow timescale (order of seconds), the system was simulated for 80 s. Due to the efficiency of the KNP-scheme, we could run this simulation in less than 15 hours using 4 CPU cores in parallel on a standard desktop computer.</p>
<sec id="sec020">
<title>Concentration gradients in the ECS caused by neuronal membrane currents</title>
<p>Due to the slow nature of diffusion, the concentration changes clearly reflected the presence of neuronal sources/sinks. This can be seen in the snapshots of the ion-concentration profile surrounding the neuron after <italic>t</italic> = 80.0 s of neural activity (<xref ref-type="fig" rid="pcbi.1006510.g004">Fig 4</xref>). The largest changes were seen for the Na<sup>+</sup> and K<sup>+</sup> concentrations near the soma and axon hillock. This reflects the strong neuronal output of K<sup>+</sup> and uptake of Na<sup>+</sup> from the soma-near regions during action potentials. Animations that show the time evolution of the concentrations were also created (see <xref ref-type="supplementary-material" rid="pcbi.1006510.s001">S1 Animations</xref>).</p>
<fig id="pcbi.1006510.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006510.g004</object-id>
<label>Fig 4</label>
<caption>
<title>(A)-(D)The change in ionic concentration for Ca<sup>2+</sup>, K<sup>+</sup>, Na<sup>+</sup>, and X<sup>−</sup>, respectively, as measured at <italic>t</italic> = 80 s, compared to the initial concentration.</title>
<p>Δ<italic>c</italic><sub><italic>k</italic></sub> is the change in concentration from the initial value, defined as Δ<italic>c</italic><sub><italic>k</italic></sub> = <italic>c</italic><sub><italic>k</italic></sub>(<italic>t</italic>) − <italic>c</italic><sub><italic>k</italic></sub>(0). The concentrations were measured in a 2-D slice going through the center of the computational mesh, and the neuron morphology was stenciled in. The green and purple dots signify selected measurement points in the ECS near the soma (green) and apical dendrites (purple) of the neuron, which are reference points for the analysis in the following sections.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006510.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec021">
<title>The effect of electrical fields on extracellular ion dynamics</title>
<p>In general, ions move both by electrical drift and diffusion. To explore the relative effect of these transport processes on the ECS ion-concentration dynamics, we compared two simulations where (i) ions moved by independent diffusion as predicted by the DO-scheme, and (ii) where ions moved due to electrodiffusion as predicted by the KNP-scheme. The two schemes were compared by looking at time series for the ion concentrations at two selected measurement points, one near the soma (green), and one near the apical dendrites (purple), as indicated in <xref ref-type="fig" rid="pcbi.1006510.g004">Fig 4</xref>. The concentration time series obtained with the KNP-scheme are shown in <xref ref-type="fig" rid="pcbi.1006510.g005">Fig 5A and 5B</xref>, for the green and purple measurement points, respectively. In the remaining panels of <xref ref-type="fig" rid="pcbi.1006510.g005">Fig 5</xref>, the KNP and DO-schemes are compared.</p>
<fig id="pcbi.1006510.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006510.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Ion concentration dynamics at selected measurement points.</title>
<p>The locations of the measurement points were in the ECS near the soma (green) and apical dendrites (purple) of the neuron. Δ<italic>c</italic>(<italic>t</italic>) is the change in concentration from the initial value, defined as Δ<italic>c</italic>(<italic>t</italic>) = <italic>c</italic>(<italic>t</italic>) − <italic>c</italic>(0). <bold>(A)-(B)</bold> Dynamics of all ion species as predicted by the KNP-scheme. <bold>(C)-(F)</bold> A comparison between the KNP and DO predictions at the measurement point near the soma. <bold>(G)-(J)</bold> A comparison between the KNP and DO predictions at the measurement point near the apical dendrites. <bold>(C)-(J)</bold> To generate the DO predictions, we set the ECS field to zero, which ensured that the ECS dynamics was due to diffusion only.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006510.g005" xlink:type="simple"/>
</fig>
<p>At the measurement point near the soma (<xref ref-type="fig" rid="pcbi.1006510.g005">Fig 5C–5F</xref>), the KNP- and DO-schemes gave similar predictions for all ion species except X<sup>−</sup> (<xref ref-type="fig" rid="pcbi.1006510.g005">Fig 5E</xref>). To explain this, we separate the local concentration dynamics into (i) a component due to neuronal uptake/efflux, (ii) a component due to ECS diffusion, and (iii) a component due to ECS electrical drift. The first two components (i-ii) were shared between the KNP- and DO-schemes, and the differences between the schemes were due to the latter component, which was absent from the DO-scheme. The component (iii) represents ions being electrically forced into a local region to ensure local electroneutrality, and would in principle affect the dynamics of all ion species. The reason why the effect was small in the case of Na<sup>+</sup> and K<sup>+</sup>, is that the concentration changes of these ions were dominated by (i) the neuronal uptake and output during AP firing, and less so by (ii-iii) electrodiffusion in the ECS. The reason why the relative effect of electrical drift was larger for X<sup>−</sup> than for Ca<sup>2+</sup> is twofold. First, X<sup>−</sup> had a larger diffusion constant than Ca<sup>2+</sup>, and was therefore more mobile (cf. <xref ref-type="table" rid="pcbi.1006510.t002">Table 2</xref>). Secondly, the number of electrically migrating ions is proportional to the abundance of a given ion species (cf. <xref ref-type="disp-formula" rid="pcbi.1006510.e004">Eq 4</xref>), as well as the valence of the ion species. Even though Ca<sup>2+</sup> has a larger valence than X<sup>−</sup>, as X<sup>−</sup> was a significantly more abundant than Ca<sup>2+</sup> in the ECS (cf. <xref ref-type="table" rid="pcbi.1006510.t002">Table 2</xref>), we would expect X<sup>−</sup> to be most affected by electrical drift.</p>
<p>In the apical dendrites, the membrane currents were not dominated by the AP exchange of Na<sup>+</sup> and K<sup>+</sup>, and shifts in the different ion concentrations were more similar in magnitude. At the measurement point near the apical dendrites, the KNP and DO predictions deviated for all ion species (<xref ref-type="fig" rid="pcbi.1006510.g005">Fig 5G–5J</xref>). The deviations were largest for Na<sup>+</sup> and X<sup>−</sup>, which again reflects the fact that these were the two most abundant ion species in the ECS (cf. <xref ref-type="table" rid="pcbi.1006510.t002">Table 2</xref>).</p>
<p>The exact nature of the ECS dynamics in <xref ref-type="fig" rid="pcbi.1006510.g005">Fig 5</xref> depended on the specific distribution of ion channels in the selected neuronal model. Although this model choice was somewhat arbitrary, these simulations still serve as a clear demonstration that ECS ion dynamics in general is of electrodiffusive nature, and thus depend on effects that are not accounted for by a DO-scheme.</p>
</sec>
<sec id="sec022">
<title>Local effects of diffusion on the extracellular potential</title>
<p>Above, we saw that the ECS potential could influence the local ion-concentration dynamics. Here, we explore how the ion-concentration dynamics can influence the local potential <italic>ϕ</italic>. We first study a low-pass filtered version of <italic>ϕ</italic> by taking the average over a 100 ms interval. <xref ref-type="fig" rid="pcbi.1006510.g006">Fig 6A</xref> shows the spatial profile of the low-pass filtered <italic>ϕ</italic> at <italic>t</italic> = 80 s, while <xref ref-type="fig" rid="pcbi.1006510.g006">Fig 6B and 6C</xref> show the diffusion component (<italic>ϕ</italic><sub>diff</sub>) and VC component (<italic>ϕ</italic><sub>VC</sub>) of <italic>ϕ</italic>, respectively. Evidently, the two components had similar amplitudes, which means that ECS diffusion gave a substantial contribution to the total potential <italic>ϕ</italic>. It should be noted that this conclusion is based on the low-pass filtered version of the signal, and that the higher frequency components are studied below.</p>
<fig id="pcbi.1006510.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006510.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Spatial profile of the ECS potential at a selected time point.</title>
<p>The ECS potential was averaged over a 100 ms interval between <italic>t</italic> = 79.9 s and 80 s. This averaging low-pass filters the potential. <bold>(A)</bold> ECS potential as predicted by the KNP-scheme. <bold>(B)</bold> The VC component of the potential. <bold>(C)</bold> The diffusive component of the potential.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006510.g006" xlink:type="simple"/>
</fig>
<p>Interestingly, the simulations demonstrated that <italic>ϕ</italic><sub>diff</sub> was much more local than <italic>ϕ</italic><sub>VC</sub>. Whereas the membrane currents generated potential fluctuations over the entire simulated region, the <italic>ϕ</italic><sub>diff</sub> contributions were confined to the regions of space where concentration gradients were nonzero. Since diffusion is a slow process, only a relatively small region of about 200 μm around the neuron was affected during the 80 s simulation. The local nature of <italic>ϕ</italic><sub>diff</sub> implies that <italic>ϕ</italic><sub>VC</sub> gives a good estimate of <italic>ϕ</italic> in regions where concentration gradients are small, even if diffusive effects are present in other regions of the system.</p>
<p>To compare <italic>ϕ</italic><sub>VC</sub> to other common implementations of the VC-scheme, we note that for other implementations, <italic>σ</italic> is usually kept constant in the entire domain. We measured <italic>σ</italic> throughout the domain for the whole simulation, and found that it varied by about at most 0.001%, which means that this result is essentially the same as what would be found by the traditional implementation of the VC-scheme, given that the same boundary conditions are used.</p>
</sec>
<sec id="sec023">
<title>Diffusive currents affect the low-frequency part of the LFP</title>
<p>To gain further insight in how diffusion can affect ECS potentials, we also explored the temporal development of <italic>ϕ</italic> at two selected measurement points (marked in green and purple in <xref ref-type="fig" rid="pcbi.1006510.g006">Fig 6</xref>). <xref ref-type="fig" rid="pcbi.1006510.g007">Fig 7A and 7B</xref> show the dynamics of <italic>ϕ</italic> (blue curve) during an 80 seconds simulation, as well as its components <italic>ϕ</italic><sub>VC</sub> (orange curve) and <italic>ϕ</italic><sub>diff</sub> (green curve). Again, each data point represents the average over a 100 ms interval, so that <italic>ϕ</italic> was effectively low-pass filtered. As we also saw above, the low-frequency contributions of <italic>ϕ</italic><sub>VC</sub> and <italic>ϕ</italic><sub>diff</sub> were similar in magnitude (and opposite in sign).</p>
<fig id="pcbi.1006510.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006510.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Dynamics of the ECS potential at selected measurement points.</title>
<p>The selected measurement points were in the ECS near the soma (green) and apical dendrites (purple) of the neuron. <bold>(A)-(B)</bold> Dynamics of the ECS potential for the first 80 s of the simulation. Each data point represent an average over a 100 ms time interval, which effectively low-pass filtered the signal. <bold>(C)-(D)</bold> High resolution time series for the ECS potential during a neural AP. The data were not low-pass filtered, but had a temporal resolution of 0.1 ms.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006510.g007" xlink:type="simple"/>
</fig>
<p>The time series clearly showed that <italic>ϕ</italic><sub>VC</sub> varied more rapidly in time than <italic>ϕ</italic><sub>diff</sub>. Even when low-pass filtered, <italic>ϕ</italic><sub>VC</sub> fluctuated several times between about 0.5 and 1.5 μV during the 80 s simulation, while <italic>ϕ</italic><sub>diff</sub> underwent an almost monotonous decrease from zero towards -1 μV (<xref ref-type="fig" rid="pcbi.1006510.g007">Fig 7A</xref>).</p>
<p>Due to the slow nature of the diffusive currents, their contribution to the ECS potentials was close to DC-like, and we would therefore not expect diffusion to have an impact on brief signals, such as extracellular AP signatures. We verified this in an additional simulation, which started (with the ECS concentrations) at <italic>t</italic> = 80 s, and which used a smaller time step (0.1 ms) in order to simulate an AP with sufficient temporal resolution. The simulation was run for 200 ms, and an AP was observed at roughly <italic>t</italic> = 80.18 s.</p>
<p>
<xref ref-type="fig" rid="pcbi.1006510.g007">Fig 7C and 7D</xref> shows the time course of <italic>ϕ</italic> (blue curve) and <italic>ϕ</italic><sub>VC</sub> (orange curve) during the AP. The constant offset between the two curves was due to the diffusive contribution <italic>ϕ</italic><sub>diff</sub>, which was accounted for by <italic>ϕ</italic>, but not by <italic>ϕ</italic><sub>VC</sub>. In the apical dendritic region, the offset was of comparable magnitude to the amplitude of the AP signature (<xref ref-type="fig" rid="pcbi.1006510.g007">Fig 7C</xref>). The diffusion evoked offset was even larger outside the soma, but its relative impact on <italic>ϕ</italic> was smaller, since <italic>ϕ</italic><sub>VC</sub> there varied by more than 100 μV during the AP (<xref ref-type="fig" rid="pcbi.1006510.g007">Fig 7D</xref>). The offset was seen to distort the shape of the AP signature at either of these points. Hence, we can conclude that diffusion can have a strong effect on the low-frequency components of <italic>ϕ</italic>, but that the high frequency components are unaffected by diffusion. This conclusion is in line with what we found in previous studies based on simpler, 1-D implementations of the KNP-scheme [<xref ref-type="bibr" rid="pcbi.1006510.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref024">24</xref>].</p>
</sec>
</sec>
</sec>
<sec id="sec024" sec-type="conclusions">
<title>Discussion</title>
<p>In the current work we presented a 3-D version of the electrodiffusive KNP-scheme, and used it to simultaneously simulate the dynamics of ion concentrations and the electrical potential in the ECS of a piece of tissue containing a morphologically realistic distribution of neuronal current sources/sinks. We demonstrated the applicability of this simulation framework by comparing it to the more physically detailed, but more computationally demanding PNP-scheme (<xref ref-type="fig" rid="pcbi.1006510.g002">Fig 2</xref>). Furthermore, we demonstrated the need for an electrodiffusive simulation framework by showing (i) how its predicted ion concentrations deviated from predictions obtained with the diffusion only (DO) scheme, which ignores concentration variations due to electrical drift in the ECS (Figs <xref ref-type="fig" rid="pcbi.1006510.g002">2</xref> and <xref ref-type="fig" rid="pcbi.1006510.g005">5</xref>), and (ii) how its predicted potentials deviated from predictions obtained with the volume conductor (VC) schemes, which ignores voltage variations due to diffusive currents in the ECS (Figs <xref ref-type="fig" rid="pcbi.1006510.g003">3</xref>, <xref ref-type="fig" rid="pcbi.1006510.g006">6</xref> and <xref ref-type="fig" rid="pcbi.1006510.g007">7</xref>).</p>
<p>To our knowledge, the presented model is the first in the field of computational neuroscience that can handle electrodiffusive processes in 3-D on spatiotemporal scales spanning over millimeters and seconds without demanding an insurmountable amount of computer power. Even the most resource-demanding simulations presented here could be performed in about 15 hours on a normal stationary computer, and we believe that simulation efficiency can be improved even further if we select an optimal numerical scheme for KNP. In the current work, all simulations were run using an implicit Euler time-stepping scheme. This choice was mainly based on the requirements of the PNP-scheme, which requires an implicit scheme in order to not become unstable. The KNP-scheme is, however, much more stable than the PNP-scheme, and in future KNP implementations we will investigate the possibility of using an operator-splitting approach for the numerical solver, which would likely improve the efficiency of the simulations.</p>
<sec id="sec025">
<title>Model limitations</title>
<p>The presented implementation of the 3-D KNP-scheme was limited to a relatively small piece of neural tissue, which included only a single pyramidal neuron modeled with the NEURON simulator. Although this approach provided clarity regarding the possible single-neuron contribution to the ECS electro- and concentration dynamics, there are many reasons why this simulation setup was far from representative for any biologically realistic scenario.</p>
<p>Firstly, the brain is packed with neurons and glial cells, and even the small volume considered here would in reality be populated by thousands of neurons that would contribute to the ECS dynamics. In a realistic scenario, ECS concentration shifts may become much larger than for the single-neuron case, where the maximal changes in ion concentration were roughly 1% (for K<sup>+</sup> near the soma). Accordingly, the effects of electrodiffusion in the single neuron-setup used here were small, and the simulations in Application 3 should predominantly be regarded as a proof of principle, and as a precursor for what could be expected in more realistic scenarios with additive contributions from networks of neurons to extracellular ion dynamics.</p>
<p>Secondly, the simulations were performed under the simplifying assumption that there was no feedback from the ECS dynamics to the neurodynamics. This assumption gave us the advantage that the neuronal output did not depend on the modelling scheme used for the ECS dynamics, meaning that VC-, DO- and KNP-schemes could be compared under identical input/output conditions. In reality, however, shifts in extracellular (or intracellular) concentrations would influence the reversal potential of transmembrane currents, which in turn would have an impact on the neurodynamics (see [<xref ref-type="bibr" rid="pcbi.1006510.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1006510.ref011">11</xref>]), and these effects are not accounted for in the current model. In addition, simulations based on the NEURON simulator do not account for ephaptic feedback from extracellular fields onto neurons, which could also have moderate impact on neurodynamics (see [<xref ref-type="bibr" rid="pcbi.1006510.ref055">55</xref>]).</p>
<p>Thirdly, the neuron model used in our study did not include the Na<sup>+</sup>/K<sup>+</sup>-exchanger pump [<xref ref-type="bibr" rid="pcbi.1006510.ref043">43</xref>]. This is the case for most neuron models currently available in NEURON (for a model with ion pumps, see [<xref ref-type="bibr" rid="pcbi.1006510.ref056">56</xref>]). Together with astrocytic uptake mechanisms, the exchanger pump would strive towards maintaining extra- and intracellular ion concentrations close to baseline levels. For a biophysical modeling scheme that derives the transmembrane transport through channels and pumps from first principles, see e.g., [<xref ref-type="bibr" rid="pcbi.1006510.ref057">57</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref058">58</xref>]. In the presence of such mechanisms, the single-neuron contribution to ECS concentration shifts would likely be smaller than in the simulations presented here, or would require a higher neural activity level in order to occur. The model limitations mentioned above were also present in the previous 1-D implementation of the KNP-scheme, and we refer to this previous work for a more thorough discussion [<xref ref-type="bibr" rid="pcbi.1006510.ref004">4</xref>].</p>
</sec>
<sec id="sec026">
<title>Previous models of ECS electrodiffusion</title>
<p>Several previous studies have explored ECS electrodiffusion on small spatiotemporal scales [<xref ref-type="bibr" rid="pcbi.1006510.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref028">28</xref>–<xref ref-type="bibr" rid="pcbi.1006510.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref036">36</xref>–<xref ref-type="bibr" rid="pcbi.1006510.ref039">39</xref>]. Electrodiffusive models tailored to explore larger spatiotemporal scales have to our knowledge so far only been implemented in 1-D [<xref ref-type="bibr" rid="pcbi.1006510.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref040">40</xref>–<xref ref-type="bibr" rid="pcbi.1006510.ref042">42</xref>].</p>
<p>We have previously used a 1-D implementation of the KNP-scheme to explore the effect of diffusive currents on ECS potentials [<xref ref-type="bibr" rid="pcbi.1006510.ref004">4</xref>]. Qualitatively, the results from the 1-D simulations were similar to those found in the current 3-D model, and in both cases it was concluded that diffusive currents affected the low-frequency components of ECS potentials (<xref ref-type="fig" rid="pcbi.1006510.g007">Fig 7</xref>). In the 1-D implementation, diffusion and electrical drift were confined to the spatial direction along the neuronal extension, i.e. along the basal dendrite-soma-apical dendrite axis, and did not occur in the lateral direction. As discussed in [<xref ref-type="bibr" rid="pcbi.1006510.ref004">4</xref>], the 1-D assumption is equivalent to assuming lateral homogeneity, which means that any neuron is surrounded by neighboring neurons with identical activity patterns as itself. Clearly, this is would not apply to most biological scenarios, which means that the results obtained with the 3-D implementation are generally more reliable. In contrast to the 1-D model, the 3-D model predicts how ion concentrations vary in all spatial directions surrounding the neuronal sources, and can thus be applied to a broader range of biological problems.</p>
<p>The diffusion potentials addressed by the KNP-scheme are those that arise due to ECS concentration gradients on relatively large spatial scales. Diffusion potentials of this kind are often referred to as liquid junction potentials, since they are most pronounced at the boundary between two solutions of different ion compositions [<xref ref-type="bibr" rid="pcbi.1006510.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref059">59</xref>]. These diffusion potentials are unrelated to filtering effects hypothesized to arise due to diffusion in the vicinity of the membrane when electric charge is transferred from the intracellular to the extracellular space [<xref ref-type="bibr" rid="pcbi.1006510.ref060">60</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref061">61</xref>].</p>
</sec>
<sec id="sec027">
<title>Outlook</title>
<p>The presented version of the KNP-scheme was developed for use in a hybrid simulation setup where the dynamics of ion concentrations and the electrical potential in the ECS were computed with KNP, while the neurodynamics was computed with the NEURON simulator tool. By necessity, this scheme shares the limitations of the NEURON simulator in terms of handling intracellular ion dynamics, which by default is not electrodiffusive in the NEURON environment [<xref ref-type="bibr" rid="pcbi.1006510.ref014">14</xref>]. A natural future endeavor will therefore be to derive a computational scheme that in a consistent way couples both the intra- and extracellular ion-concentration and voltage dynamics based on the KNP-scheme. Such a scheme will represent a generalization of the previously developed <italic>extracellular-membrane-intracellular</italic> (EMI) model [<xref ref-type="bibr" rid="pcbi.1006510.ref055">55</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref062">62</xref>], which in a consistent way couples the intra- and extracellular electrodynamics, but so far does not include ion-concentration dynamics and thus not diffusive currents.</p>
<p>This being said, the hybrid KNP/NEURON version presented here is valuable in its own right, since it allows the KNP framework to be combined with the many models that are already available in the NEURON software. Although we here only studied a single neuron’s contribution to the ECS electro- and concentration dynamics, we envision future applications of the 3-D KNP to more complex systems. The 3-D version of the KNP-scheme is generally applicable, and could be used to simulate the dynamics of ion concentrations and the electrical potential in the ECS surrounding arbitrary complex models of neurons or populations of neurons. It could, for example, be used to account for extracellular transport processes in the Blue Brain Simulator [<xref ref-type="bibr" rid="pcbi.1006510.ref063">63</xref>]. If combined with a cellular system of neurons and glial cells tailored to represent a specific experimental condition, the KNP-scheme could be used to explore the mechanisms behind spreading depression [<xref ref-type="bibr" rid="pcbi.1006510.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref064">64</xref>], epilepsy [<xref ref-type="bibr" rid="pcbi.1006510.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006510.ref065">65</xref>], or other pathological conditions associated with large shifts in extracellular ion concentrations. In such applications, however, the hybrid KNP framework would need to be expanded to also account for the effect of ECS concentration dynamics on neuronal reversal potentials. This would require the development of an application programming interface that allows two-way communication between the simulator tools NEURON (for neurons) and FEniCS (for ECS). Since neurodynamics typically occurs at a much faster time scale (millisceonds) than changes in ECS ion concentrations (seconds), the interface could be based on using multiple time scales in order to keep the computational cost manageable. For example, a millisecond resolution could be used in NEURON simulations, while ECS concentrations could be computed (and updated in NEURON) at a slower temporal resolution of e.g., seconds.</p>
</sec>
</sec>
<sec id="sec028">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006510.s001" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006510.s001" xlink:type="simple">
<label>S1 Animations</label>
<caption>
<title>Animations of the ion-concentration dynamics.</title>
<p>Animations of the temporal evolution of the ion concentrations were created using ParaView. The neuron morphology was stenciled in.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006510.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006510.s002" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Details on the FEniCS implementation.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1006510.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cordingley</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Somjen</surname> <given-names>GG</given-names></name>. <article-title>The clearing of excess potassium from extracellular space in spinal cord and cerebral cortex</article-title>. <source>Brain research</source>. <year>1978</year>;<volume>151</volume>:<fpage>291</fpage>–<lpage>306</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0006-8993(78)90886-7" xlink:type="simple">10.1016/0006-8993(78)90886-7</ext-link></comment> <object-id pub-id-type="pmid">209864</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dietzel</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Heinemann</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Lux</surname> <given-names>HD</given-names></name>. <article-title>Relations between slow extracellular potential changes, glial potassium buffering, and electrolyte and cellular volume changes during neuronal hyperactivity in cat</article-title>. <source>Glia</source>. <year>1989</year>;<volume>2</volume>:<fpage>25</fpage>–<lpage>44</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/glia.440020104" xlink:type="simple">10.1002/glia.440020104</ext-link></comment> <object-id pub-id-type="pmid">2523337</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Syková</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Nicholson</surname> <given-names>C</given-names></name>. <article-title>Diffusion in Brain Extracellular Space</article-title>. <source>Physiol Rev</source>. <year>2008</year>;<volume>88</volume>:<fpage>1277</fpage>–<lpage>1340</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/physrev.00027.2007" xlink:type="simple">10.1152/physrev.00027.2007</ext-link></comment> <object-id pub-id-type="pmid">18923183</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Halnes</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Mäki-Marttunen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Keller</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Pettersen</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Andreassen</surname> <given-names>OA</given-names></name>, <name name-style="western"><surname>Einevoll</surname> <given-names>GT</given-names></name>. <article-title>Effect of ionic diffusion on extracellular potentials in neural tissue</article-title>. <source>PLoS computational biology</source>. <year>2016</year>;<volume>12</volume>(<issue>11</issue>):<fpage>e1005193</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005193" xlink:type="simple">10.1371/journal.pcbi.1005193</ext-link></comment> <object-id pub-id-type="pmid">27820827</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Park</surname> <given-names>EH</given-names></name>, <name name-style="western"><surname>Durand</surname> <given-names>DM</given-names></name>. <article-title>Role of potassium lateral diffusion in non-synaptic epilepsy: a computational study</article-title>. <source>Journal of theoretical biology</source>. <year>2006</year>;<volume>238</volume>(<issue>3</issue>):<fpage>666</fpage>–<lpage>82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2005.06.015" xlink:type="simple">10.1016/j.jtbi.2005.06.015</ext-link></comment> <object-id pub-id-type="pmid">16085109</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Florence</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Dahlem</surname> <given-names>Ma</given-names></name>, <name name-style="western"><surname>Almeida</surname> <given-names>ACG</given-names></name>, <name name-style="western"><surname>Bassani</surname> <given-names>JWM</given-names></name>, <name name-style="western"><surname>Kurths</surname> <given-names>J</given-names></name>. <article-title>The role of extracellular potassium dynamics in the different stages of ictal bursting and spreading depression: a computational study</article-title>. <source>Journal of theoretical biology</source>. <year>2009</year>;<volume>258</volume>(<issue>2</issue>):<fpage>219</fpage>–<lpage>28</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2009.01.032" xlink:type="simple">10.1016/j.jtbi.2009.01.032</ext-link></comment> <object-id pub-id-type="pmid">19490858</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Enger</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Vindedal</surname> <given-names>GF</given-names></name>, <name name-style="western"><surname>Jensen</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Johannes Helm</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Sprengel</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Dynamics of Ionic Shifts in Cortical Spreading Depression</article-title>. <source>Cerebral cortex (New York, NY: 1991)</source>. <year>2015</year>; p. <fpage>1</fpage>–<lpage>8</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006510.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cressman</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Ullah</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Ziburkus</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schiff</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Barreto</surname> <given-names>E</given-names></name>. <article-title>The influence of sodium and potassium dynamics on excitability, seizures, and the stability of persistent states: I. Single neuron dynamics</article-title>. <source>Journal of computational neuroscience</source>. <year>2009</year>;<volume>26</volume>(<issue>2</issue>):<fpage>159</fpage>–<lpage>70</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10827-008-0132-4" xlink:type="simple">10.1007/s10827-008-0132-4</ext-link></comment> <object-id pub-id-type="pmid">19169801</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ullah</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Cressman</surname> <given-names>JR</given-names> <suffix>Jr</suffix></name>, <name name-style="western"><surname>Barreto</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Schiff</surname> <given-names>SJ</given-names></name>. <article-title>The influence of sodium and potassium dynamics on excitability, seizures, and the stability of persistent states: II. Network and glial dynamics</article-title>. <source>Journal of computational neuroscience</source>. <year>2009</year>;<volume>26</volume>(<issue>2</issue>):<fpage>171</fpage>–<lpage>183</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10827-008-0130-6" xlink:type="simple">10.1007/s10827-008-0130-6</ext-link></comment> <object-id pub-id-type="pmid">19083088</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barreto</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Cressman</surname> <given-names>JR</given-names></name>. <article-title>Ion concentration dynamics as a mechanism for neuronal bursting</article-title>. <source>Journal of biological physics</source>. <year>2011</year>;<volume>37</volume>(<issue>3</issue>):<fpage>361</fpage>–<lpage>373</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10867-010-9212-6" xlink:type="simple">10.1007/s10867-010-9212-6</ext-link></comment> <object-id pub-id-type="pmid">22654181</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Øyehaug</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Østby</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Lloyd</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Omholt</surname> <given-names>SW</given-names></name>, <name name-style="western"><surname>Einevoll</surname> <given-names>GT</given-names></name>. <article-title>Dependence of spontaneous neuronal firing and depolarisation block on astroglial membrane transport mechanisms</article-title>. <source>Journal of computational neuroscience</source>. <year>2012</year>;<volume>32</volume>(<issue>1</issue>):<fpage>147</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10827-011-0345-9" xlink:type="simple">10.1007/s10827-011-0345-9</ext-link></comment> <object-id pub-id-type="pmid">21667153</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref012">
<label>12</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Rall</surname> <given-names>W</given-names></name>. <chapter-title>Core conductor theory and cable properties of neurons</chapter-title>. In: <source>Handbook of Physiology</source>. <publisher-name>American Physiological Society</publisher-name>, <publisher-loc>Bethesda</publisher-loc>; <year>1977</year>. p. <fpage>39</fpage>–<lpage>97</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://onlinelibrary.wiley.com/doi/10.1002/cphy.cp010103/full" xlink:type="simple">http://onlinelibrary.wiley.com/doi/10.1002/cphy.cp010103/full</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006510.ref013">
<label>13</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Rall</surname> <given-names>W</given-names></name>. <chapter-title>Cable theory for dendritic neurons</chapter-title>. In: <source>Methods in neuronal modeling</source>. <publisher-name>MIT Press</publisher-name>; <year>1989</year>. p. <fpage>9</fpage>–<lpage>92</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006510.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hines</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Carnevale</surname> <given-names>NT</given-names></name>. <article-title>The NEURON simulation environment</article-title>. <source>NEURON</source>. <year>2006</year>;<volume>9</volume>(<issue>6</issue>).</mixed-citation>
</ref>
<ref id="pcbi.1006510.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hines</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Davison</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Muller</surname> <given-names>E</given-names></name>. <article-title>NEURON and Python</article-title>. <source>Frontiers in neuroinformatics</source>. <year>2009</year>;<volume>3</volume>(<issue>January</issue>):<fpage>1</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/neuro.11.001.2009" xlink:type="simple">10.3389/neuro.11.001.2009</ext-link></comment> <object-id pub-id-type="pmid">19198661</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mitzdorf</surname> <given-names>U</given-names></name>. <article-title>Current source-density method and application in cat cerebral cortex: investigation of evoked potentials and EEG phenomena</article-title>. <source>Physiological reviews</source>. <year>1985</year>;<volume>65</volume>(<issue>1</issue>):<fpage>37</fpage>–<lpage>100</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/physrev.1985.65.1.37" xlink:type="simple">10.1152/physrev.1985.65.1.37</ext-link></comment> <object-id pub-id-type="pmid">3880898</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Holt</surname> <given-names>GR</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name>. <article-title>Electrical interactions via the extracellular potential near cell bodies</article-title>. <source>Journal of computational neuroscience</source>. <year>1999</year>;<volume>6</volume>:<fpage>169</fpage>–<lpage>184</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1023/A:1008832702585" xlink:type="simple">10.1023/A:1008832702585</ext-link></comment> <object-id pub-id-type="pmid">10333161</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pettersen</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Hagen</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Einevoll</surname> <given-names>GT</given-names></name>. <article-title>Estimation of population firing rates and current source densities from laminar electrode recordings</article-title>. <source>Journal of computational neuroscience</source>. <year>2008</year>;<volume>24</volume>(<issue>3</issue>):<fpage>291</fpage>–<lpage>313</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10827-007-0056-4" xlink:type="simple">10.1007/s10827-007-0056-4</ext-link></comment> <object-id pub-id-type="pmid">17926125</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pettersen</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Einevoll</surname> <given-names>GT</given-names></name>. <article-title>Amplitude variability and extracellular low-pass filtering of neuronal spikes</article-title>. <source>Biophysical journal</source>. <year>2008</year>;<volume>94</volume>(<issue>3</issue>):<fpage>784</fpage>–<lpage>802</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1529/biophysj.107.111179" xlink:type="simple">10.1529/biophysj.107.111179</ext-link></comment> <object-id pub-id-type="pmid">17921225</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Reimann</surname> <given-names>MW</given-names></name>, <name name-style="western"><surname>Anastassiou</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Perin</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Hill</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name>. <article-title>A biophysically detailed model of neocortical local field potentials predicts the critical role of active membrane currents</article-title>. <source>Neuron</source>. <year>2013</year>;<volume>79</volume>(<issue>2</issue>):<fpage>375</fpage>–<lpage>90</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2013.05.023" xlink:type="simple">10.1016/j.neuron.2013.05.023</ext-link></comment> <object-id pub-id-type="pmid">23889937</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Łȩski</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lindén</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Tetzlaff</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Pettersen</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Einevoll</surname> <given-names>GT</given-names></name>. <article-title>Frequency dependence of signal power and spatial reach of the local field potential</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year>;<volume>9</volume>(<issue>7</issue>):<fpage>e1003137</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003137" xlink:type="simple">10.1371/journal.pcbi.1003137</ext-link></comment> <object-id pub-id-type="pmid">23874180</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gratiy</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Halnes</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Denman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Hawrylycz</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Einevoll</surname> <given-names>GT</given-names></name>, <etal>et al</etal>. <article-title>From Maxwell’s equations to the theory of current-source density analysis</article-title>. <source>European Journal of Neuroscience</source>. <year>2017</year>;<volume>45</volume>(<issue>8</issue>):<fpage>1013</fpage>–<lpage>1023</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/ejn.13534" xlink:type="simple">10.1111/ejn.13534</ext-link></comment> <object-id pub-id-type="pmid">28177156</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pods</surname> <given-names>J</given-names></name>. <article-title>A comparison of computational models for the extracellular potential of neurons</article-title>. <source>Journal of Integrative Neuroscience</source>. <year>2017</year>;<volume>16</volume>(<issue>1</issue>):<fpage>19</fpage>–<lpage>32</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3233/JIN-170009" xlink:type="simple">10.3233/JIN-170009</ext-link></comment> <object-id pub-id-type="pmid">28891501</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Halnes</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Mäki-Marttunen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Pettersen</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Andreassen</surname> <given-names>OA</given-names></name>, <name name-style="western"><surname>Einevoll</surname> <given-names>GT</given-names></name>. <article-title>Ion diffusion may introduce spurious current sources in current-source density (CSD) analysis</article-title>. <source>Journal of Neurophysiology</source>. <year>2017</year>;<volume>118</volume>(<issue>1</issue>):<fpage>114</fpage>–<lpage>120</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.00976.2016" xlink:type="simple">10.1152/jn.00976.2016</ext-link></comment> <object-id pub-id-type="pmid">28298307</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kerr</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Bartol</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Kaminsky</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dittrich</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>JCJ</given-names></name>, <name name-style="western"><surname>Baden</surname> <given-names>SB</given-names></name>, <etal>et al</etal>. <article-title>Fast Monte Carlo Simulation Methods for Biological Reaction-Diffusion Systems in Solution and on Surfaces</article-title>. <source>SIAM J Sci Comput</source>. <year>2008</year>;<volume>30</volume>(<issue>6</issue>):<fpage>3126</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1137/070692017" xlink:type="simple">10.1137/070692017</ext-link></comment> <object-id pub-id-type="pmid">20151023</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fleidervish</surname> <given-names>IA</given-names></name>, <name name-style="western"><surname>Lasser-Ross</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Gutnick</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Ross</surname> <given-names>WN</given-names></name>. <article-title>Na<sup>+</sup> imaging reveals little difference in action potential-evoked Na<sup>+</sup> influx between axon and soma</article-title>. <source>Nature neuroscience</source>. <year>2010</year>;<volume>13</volume>(<issue>7</issue>):<fpage>852</fpage>–<lpage>860</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.2574" xlink:type="simple">10.1038/nn.2574</ext-link></comment> <object-id pub-id-type="pmid">20543843</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McDougal</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Hines</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Lytton</surname> <given-names>WW</given-names></name>. <article-title>Reaction-diffusion in the NEURON simulator</article-title>. <source>Frontiers in neuroinformatics</source>. <year>2013</year>;<volume>7</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fninf.2013.00028" xlink:type="simple">10.3389/fninf.2013.00028</ext-link></comment> <object-id pub-id-type="pmid">24298253</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Léonetti</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dubois-Violette</surname> <given-names>E</given-names></name>. <article-title>Theory of Electrodynamic Instabilities in Biological Cells</article-title>. <source>Physical Review Letters</source>. <year>1998</year>;<volume>81</volume>(<issue>9</issue>):<fpage>1977</fpage>–<lpage>1980</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevLett.81.1977" xlink:type="simple">10.1103/PhysRevLett.81.1977</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Léonetti</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dubois-Violette</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Homblé</surname> <given-names>F</given-names></name>. <article-title>Pattern formation of stationary transcellular ionic currents in Fucus</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2004</year>;<volume>101</volume>(<issue>28</issue>):<fpage>10243</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0402335101" xlink:type="simple">10.1073/pnas.0402335101</ext-link></comment> <object-id pub-id-type="pmid">15232004</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lu</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>YC</given-names></name>, <name name-style="western"><surname>Huber</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Bond</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Holst</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>McCammon</surname> <given-names>JA</given-names></name>. <article-title>Electrodiffusion: a continuum modeling framework for biomolecular systems with realistic spatiotemporal resolution</article-title>. <source>The Journal of chemical physics</source>. <year>2007</year>;<volume>127</volume>(<issue>13</issue>):<fpage>135102</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.2775933" xlink:type="simple">10.1063/1.2775933</ext-link></comment> <object-id pub-id-type="pmid">17919055</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lopreore</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Bartol</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Coggan</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Keller</surname> <given-names>DX</given-names></name>, <name name-style="western"><surname>Sosinsky</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Ellisman</surname> <given-names>MH</given-names></name>, <etal>et al</etal>. <article-title>Computational modeling of three-dimensional electrodiffusion in biological systems: application to the node of Ranvier</article-title>. <source>Biophysical journal</source>. <year>2008</year>;<volume>95</volume>(<issue>6</issue>):<fpage>2624</fpage>–<lpage>35</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1529/biophysj.108.132167" xlink:type="simple">10.1529/biophysj.108.132167</ext-link></comment> <object-id pub-id-type="pmid">18556758</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nanninga</surname> <given-names>PM</given-names></name>. <article-title>A computational neuron model based on Poisson-Nernst-Planck theory</article-title>. <source>ANZIAM Journal</source>. <year>2008</year>;<volume>50</volume>:<fpage>46</fpage>–<lpage>59</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.21914/anziamj.v50i0.1390" xlink:type="simple">10.21914/anziamj.v50i0.1390</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pods</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schönke</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bastian</surname> <given-names>P</given-names></name>. <article-title>Electrodiffusion models of neurons and extracellular space using the Poisson-Nernst-Planck equations–numerical simulation of the intra- and extracellular potential for an axon model</article-title>. <source>Biophysical journal</source>. <year>2013</year>;<volume>105</volume>(<issue>1</issue>):<fpage>242</fpage>–<lpage>54</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.bpj.2013.05.041" xlink:type="simple">10.1016/j.bpj.2013.05.041</ext-link></comment> <object-id pub-id-type="pmid">23823244</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gardner</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Baer</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Crook</surname> <given-names>SM</given-names></name>. <article-title>Drift-diffusion simulation of the ephaptic effect in the triad synapse of the retina</article-title>. <source>Journal of computational neuroscience</source>. <year>2015</year>;<volume>38</volume>(<issue>1</issue>):<fpage>129</fpage>–<lpage>42</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10827-014-0531-7" xlink:type="simple">10.1007/s10827-014-0531-7</ext-link></comment> <object-id pub-id-type="pmid">25260382</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Aguilella</surname> <given-names>VM</given-names></name>, <name name-style="western"><surname>Mafé</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Pellicer</surname> <given-names>J</given-names></name>. <article-title>On the nature of the diffusion potential derived from Nernst-Planck flux equations by using the electroneutrality assumption</article-title>. <source>Electrochimica acta</source>. <year>1987</year>;<volume>32</volume>(<issue>3</issue>):<fpage>483</fpage>–<lpage>488</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0013-4686(87)85018-1" xlink:type="simple">10.1016/0013-4686(87)85018-1</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mori</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Fishman</surname> <given-names>GI</given-names></name>, <name name-style="western"><surname>Peskin</surname> <given-names>CS</given-names></name>. <article-title>Ephaptic conduction in a cardiac strand model with 3D electrodiffusion</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2008</year>;<volume>105</volume>(<issue>17</issue>):<fpage>6463</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0801089105" xlink:type="simple">10.1073/pnas.0801089105</ext-link></comment> <object-id pub-id-type="pmid">18434544</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref037">
<label>37</label>
<mixed-citation publication-type="other" xlink:type="simple">Mori Y. From three-dimensional electrophysiology to the cable model: an asymptotic study. arXiv preprint arXiv:09013914. 2009; p. 1–39.</mixed-citation>
</ref>
<ref id="pcbi.1006510.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mori</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Peskin</surname> <given-names>C</given-names></name>. <article-title>A numerical method for cellular electrophysiology based on the electrodiffusion equations with internal boundary conditions at membranes</article-title>. <source>Communications in Applied Mathematics and Computational Science</source>. <year>2009</year>;<volume>4</volume>.<issue>1</issue>:<fpage>85</fpage>–<lpage>134</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2140/camcos.2009.4.85" xlink:type="simple">10.2140/camcos.2009.4.85</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mori</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Eisenberg</surname> <given-names>RS</given-names></name>. <article-title>A model of electrodiffusion and osmotic water flow and its energetic structure</article-title>. <source>Physica D: Nonlinear Phenomena</source>. <year>2011</year>;<volume>240</volume>(<issue>22</issue>):<fpage>1835</fpage>–<lpage>1852</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.physd.2011.08.010" xlink:type="simple">10.1016/j.physd.2011.08.010</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Niederer</surname> <given-names>S</given-names></name>. <article-title>Regulation of ion gradients across myocardial ischemic border zones: a biophysical modelling analysis</article-title>. <source>PloS one</source>. <year>2013</year>;<volume>8</volume>(<issue>4</issue>):<fpage>e60323</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0060323" xlink:type="simple">10.1371/journal.pone.0060323</ext-link></comment> <object-id pub-id-type="pmid">23577101</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Halnes</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Østby</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Pettersen</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Omholt</surname> <given-names>SW</given-names></name>, <name name-style="western"><surname>Einevoll</surname> <given-names>GT</given-names></name>. <article-title>Electrodiffusive model for astrocytic and neuronal ion concentration dynamics</article-title>. <source>PLoS computational biology</source>. <year>2013</year>;<volume>9</volume>(<issue>12</issue>):<fpage>e1003386</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003386" xlink:type="simple">10.1371/journal.pcbi.1003386</ext-link></comment> <object-id pub-id-type="pmid">24367247</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref042">
<label>42</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Halnes</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Østby</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Pettersen</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Omholt</surname> <given-names>SW</given-names></name>, <name name-style="western"><surname>Einevoll</surname> <given-names>GT</given-names></name>. <chapter-title>An Electrodiffusive Formalism for Ion Concentration Dynamics in Excitable Cells and the Extracellular Space Surrounding Them</chapter-title>. In: <source>Advances in cognitive neurodynamics (IV)</source>. <publisher-name>Springer</publisher-name> <publisher-loc>Netherlands</publisher-loc>; <year>2015</year>. p. <fpage>353</fpage>–<lpage>360</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://link.springer.com/chapter/10.1007/978-94-017-9548-7_50" xlink:type="simple">http://link.springer.com/chapter/10.1007/978-94-017-9548-7_50</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006510.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hay</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Hill</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schürmann</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Segev</surname> <given-names>I</given-names></name>. <article-title>Models of neocortical layer 5b pyramidal cells capturing a wide range of dendritic and perisomatic active properties</article-title>. <source>PLoS computational biology</source>. <year>2011</year>;<volume>7</volume>(<issue>7</issue>):<fpage>e1002107</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002107" xlink:type="simple">10.1371/journal.pcbi.1002107</ext-link></comment> <object-id pub-id-type="pmid">21829333</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lehmenkühler</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Syková</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Svoboda</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zilles</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Nicholson</surname> <given-names>C</given-names></name>. <article-title>Extracellular space parameters in the rat neocortex and subcortical white matter during postnatal development determined by diffusion analysis</article-title>. <source>Neuroscience</source>. <year>1993</year>;<volume>55</volume>(<issue>2</issue>):<fpage>339</fpage>–<lpage>351</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0306-4522(93)90503-8" xlink:type="simple">10.1016/0306-4522(93)90503-8</ext-link></comment> <object-id pub-id-type="pmid">8377929</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nicholson</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Phillips</surname> <given-names>JM</given-names></name>. <article-title>Ion diffusion modified by tortuosity and volume fraction in the extracellular microenvironment of the rat cerebellum</article-title>. <source>The Journal of Physiology</source>. <year>1981</year>;<volume>8</volume>:<fpage>225</fpage>–<lpage>257</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1113/jphysiol.1981.sp013981" xlink:type="simple">10.1113/jphysiol.1981.sp013981</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chen</surname> <given-names>KC</given-names></name>, <name name-style="western"><surname>Nicholson</surname> <given-names>C</given-names></name>. <article-title>Spatial buffering of potassium ions in brain extracellular space</article-title>. <source>Biophysical journal</source>. <year>2000</year>;<volume>78</volume>(<issue>6</issue>):<fpage>2776</fpage>–<lpage>97</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0006-3495(00)76822-6" xlink:type="simple">10.1016/S0006-3495(00)76822-6</ext-link></comment> <object-id pub-id-type="pmid">10827962</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref047">
<label>47</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Grodzinsky</surname> <given-names>F</given-names></name>. <source>Fields, Forces, and Flows in Biological Systems</source>. <publisher-name>Garland Science, Taylor &amp; Francis Group</publisher-name>, <publisher-loc>London &amp; New York</publisher-loc>.; <year>2011</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006510.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Britz</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Strutwolf</surname> <given-names>J</given-names></name>. <article-title>Several ways to simulate time dependent liquid junction potentials by finite differences</article-title>. <source>Electrochimica Acta</source>. <year>2014</year>;<volume>137</volume>:<fpage>328</fpage>–<lpage>335</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.electacta.2014.06.016" xlink:type="simple">10.1016/j.electacta.2014.06.016</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref049">
<label>49</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name>. <source>Biophysics of computation: information processing in single neurons</source>. <edition>1st ed</edition>. <publisher-name>Oxford University Press</publisher-name>: <publisher-loc>New York</publisher-loc>; <year>1999</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006510.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lindén</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hagen</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Łȩski</surname> <given-names>S</given-names></name>. <article-title>LFPy: a tool for biophysical simulation of extracellular potentials generated by detailed model neurons</article-title>. <source>Frontiers in neuroinformatics</source>. <year>2014</year>;<volume>7</volume>(<issue>41</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fninf.2013.00041" xlink:type="simple">10.3389/fninf.2013.00041</ext-link></comment> <object-id pub-id-type="pmid">24474916</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref051">
<label>51</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Logg</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mardal</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Wells</surname> <given-names>GN</given-names></name>, <etal>et al</etal>. <source>Automated Solution of Differential Equations by the Finite Element Method</source>. <publisher-name>Springer</publisher-name>; <year>2012</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006510.ref052">
<label>52</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Larson</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Bengzon</surname> <given-names>F</given-names></name>. <source>The finite element method: Theory, implementation, and applications</source>. <volume>vol. 10</volume>. <publisher-name>Springer Science &amp; Business Media</publisher-name>; <year>2013</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006510.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Alnæs</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Blechta</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hake</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Johansson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kehlet</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Logg</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>The FEniCS project version 1.5</article-title>. <source>Archive of Numerical Software</source>. <year>2015</year>;<volume>3</volume>(<issue>100</issue>):<fpage>9</fpage>–<lpage>23</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006510.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Henderson</surname> <given-names>P</given-names></name>. <article-title>Zur Thermodynamik der Flüssigkeitsketten</article-title>. <source>Zeitschrift für Physikalische Chemie</source>. <year>1907</year>;<volume>59</volume>(<issue>1</issue>):<fpage>118</fpage>–<lpage>127</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006510.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tveito</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jæger</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Lines</surname> <given-names>GT</given-names></name>, <name name-style="western"><surname>Paszkowski</surname> <given-names>Ł</given-names></name>, <name name-style="western"><surname>Sundnes</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Edwards</surname> <given-names>AG</given-names></name>, <etal>et al</etal>. <article-title>An evaluation of the accuracy of classical models for computing the membrane potential and extracellular potential for neurons</article-title>. <source>Frontiers in computational neuroscience</source>. <year>2017</year>;<volume>11</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fncom.2017.00027" xlink:type="simple">10.3389/fncom.2017.00027</ext-link></comment> <object-id pub-id-type="pmid">28484385</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hübel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Dahlem</surname> <given-names>MA</given-names></name>. <article-title>Dynamics from seconds to hours in Hodgkin-Huxley model with time-dependent ion concentrations and buffer reservoirs</article-title>. <source>PLoS computational biology</source>. <year>2014</year>;<volume>10</volume>(<issue>12</issue>):<fpage>e1003941</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003941" xlink:type="simple">10.1371/journal.pcbi.1003941</ext-link></comment> <object-id pub-id-type="pmid">25474648</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref057">
<label>57</label>
<mixed-citation publication-type="other" xlink:type="simple">Herrera-Valdez MA. Geometry and nonlinear dynamics underlying excitability phenotypes in biophysical models of membrane potential. Ph.D. Thesis. The University of Arizona. 2014. Available from: <ext-link ext-link-type="uri" xlink:href="https://repository.arizona.edu/handle/10150/312741" xlink:type="simple">https://repository.arizona.edu/handle/10150/312741</ext-link></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Herrera-Valdez</surname> <given-names>MA</given-names></name>. <article-title>A thermodynamic description for physiological transmembrane transport</article-title>. <source>PeerJ PrePrints</source>. <year>2018</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1006510.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Perram</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Stiles</surname> <given-names>PJ</given-names></name>. <article-title>On the nature of liquid junction and membrane potentials</article-title>. <source>Physical chemistry chemical physics: PCCP</source>. <year>2006</year>;<volume>8</volume>(<issue>36</issue>):<fpage>4200</fpage>–<lpage>13</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1039/b601668e" xlink:type="simple">10.1039/b601668e</ext-link></comment> <object-id pub-id-type="pmid">16971988</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bédard</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rodrigues</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Roy</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Contreras</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Destexhe</surname> <given-names>A</given-names></name>. <article-title>Evidence for frequency-dependent extracellular impedance from the transfer function between extracellular and intracellular potentials: Intracellular-LFP transfer function</article-title>. <source>Journal of Computational Neuroscience</source>. <year>2010</year>;<volume>29</volume>(<issue>3</issue>):<fpage>389</fpage>–<lpage>403</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10827-010-0250-7" xlink:type="simple">10.1007/s10827-010-0250-7</ext-link></comment> <object-id pub-id-type="pmid">20559865</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bédard</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Destexhe</surname> <given-names>A</given-names></name>. <article-title>Generalized theory for current-source-density analysis in brain tissue</article-title>. <source>Physical Review E</source>. <year>2011</year>;<volume>84</volume>(<issue>4</issue>):<fpage>041909</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.84.041909" xlink:type="simple">10.1103/PhysRevE.84.041909</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Agudelo-Toro</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Neef</surname> <given-names>A</given-names></name>. <article-title>Computationally efficient simulation of electrical activity at cell membranes interacting with self-generated and externally imposed electric fields</article-title>. <source>Journal of neural engineering</source>. <year>2013</year>;<volume>10</volume>(<issue>2</issue>):<fpage>026019</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1088/1741-2560/10/2/026019" xlink:type="simple">10.1088/1741-2560/10/2/026019</ext-link></comment> <object-id pub-id-type="pmid">23503026</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name>. <article-title>The blue brain project</article-title>. <source>Nature Reviews Neuroscience</source>. <year>2006</year>; p. <fpage>159</fpage>–<lpage>174</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006510.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Spong</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Andrew</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Robertson</surname> <given-names>RM</given-names></name>. <article-title>Mechanisms of spreading depolarization in vertebrate and insect central nervous systems</article-title>. <source>Journal of Neurophysiology</source>. <year>2016</year>;<volume>116</volume>(<issue>3</issue>):<fpage>1117</fpage>–<lpage>1127</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.00352.2016" xlink:type="simple">10.1152/jn.00352.2016</ext-link></comment> <object-id pub-id-type="pmid">27334953</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006510.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Raimondo</surname> <given-names>JV</given-names></name>, <name name-style="western"><surname>Burman</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Katz</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Akerman</surname> <given-names>CJ</given-names></name>. <article-title>Ion dynamics during seizures</article-title>. <source>Frontiers in Cellular Neuroscience</source>. <year>2015</year>;<volume>9</volume>:<fpage>419</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fncel.2015.00419" xlink:type="simple">10.3389/fncel.2015.00419</ext-link></comment> <object-id pub-id-type="pmid">26539081</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>