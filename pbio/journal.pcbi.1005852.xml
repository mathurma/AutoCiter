<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005852</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00827</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Random variables</subject><subj-group><subject>Covariance</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Research assessment</subject><subj-group><subject>Research errors</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Microbial ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Microbial ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Microbial ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Bayesian method</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Medical microbiology</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Microbial genomics</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Microbial genomics</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Community ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Community ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Theoretical ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Theoretical ecology</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>A Bayesian method for detecting pairwise associations in compositional data</article-title>
<alt-title alt-title-type="running-head">Bayesian analysis of compositional covariance</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7385-8994</contrib-id>
<name name-style="western">
<surname>Schwager</surname>
<given-names>Emma</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4956-2429</contrib-id>
<name name-style="western">
<surname>Mallick</surname>
<given-names>Himel</given-names>
</name>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Ventz</surname>
<given-names>Steffen</given-names>
</name>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Huttenhower</surname>
<given-names>Curtis</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Biostatistics, Harvard T.H. Chan School of Public Health, Boston, Massachusetts, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Broad Institute of MIT and Harvard, Cambridge, Massachusetts, United States of America</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Department of Computer Science and Statistics, University of Rhode Island, Kingstown, Rhode Island, United States of America</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Department of Biostatistics and Computational Biology, Dana-Farber Cancer Institute, Boston, Massachusetts, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Blekhman</surname>
<given-names>Ran</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Minnesota, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">chuttenh@hsph.harvard.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>15</day>
<month>11</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="collection">
<month>11</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>11</issue>
<elocation-id>e1005852</elocation-id>
<history>
<date date-type="received">
<day>24</day>
<month>5</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>25</day>
<month>10</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Schwager et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005852"/>
<abstract>
<p>Compositional data consist of vectors of proportions normalized to a constant sum from a basis of unobserved counts. The sum constraint makes inference on correlations between unconstrained features challenging due to the information loss from normalization. However, such correlations are of long-standing interest in fields including ecology. We propose a novel Bayesian framework (BAnOCC: Bayesian Analysis of Compositional Covariance) to estimate a sparse precision matrix through a LASSO prior. The resulting posterior, generated by MCMC sampling, allows uncertainty quantification of any function of the precision matrix, including the correlation matrix. We also use a first-order Taylor expansion to approximate the transformation from the unobserved counts to the composition in order to investigate what characteristics of the unobserved counts can make the correlations more or less difficult to infer. On simulated datasets, we show that BAnOCC infers the true network as well as previous methods while offering the advantage of posterior inference. Larger and more realistic simulated datasets further showed that BAnOCC performs well as measured by type I and type II error rates. Finally, we apply BAnOCC to a microbial ecology dataset from the Human Microbiome Project, which in addition to reproducing established ecological results revealed unique, competition-based roles for Proteobacteria in multiple distinct habitats.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Data from many fields are available primarily in the form of proportions, also referred to as compositions, which impose mathematical constraints on identifying interactions among components in the underlying systems. In particular, correlations cannot be calculated directly from proportions or from count data that give rise to them. Methods that work around this difficulty generally do so by imposing strong assumptions about the distribution of underlying data or associated correlations, and these in turn often prevent quantifying uncertainty in the resulting estimates of correlation. We developed a statistical model (BAnOCC: Bayesian Analysis of Compositional Covariance) that both estimates correlations between counts or proportions and provides a posterior distribution for each correlation that quantifies how uncertain the estimate is. BAnOCC does well at controlling the number of false positives in simulated data and can be practically applied to a wide range of proportional data types.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000062</institution-id>
<institution>National Institute of Diabetes and Digestive and Kidney Diseases</institution>
</institution-wrap>
</funding-source>
<award-id>U54DE023798</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Huttenhower</surname>
<given-names>Curtis</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>DBI-1053486</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Huttenhower</surname>
<given-names>Curtis</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution>Army Research Office (US)</institution>
</funding-source>
<award-id>W911NF-11-1-0473</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Huttenhower</surname>
<given-names>Curtis</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution>National Science Foundation (US)</institution>
</funding-source>
<award-id>ATD-1042785</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Ventz</surname>
<given-names>Steffen</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution>National Institutes of Health (US)</institution>
</funding-source>
<award-id>R01HG005220</award-id>
</award-group>
<funding-statement>This work was supported by the National Institutes of Health grants U54DE023798 (CH) and R01HG005220 (CH), National Science Foundation grants ATD-1042785 (SV) and DBI-1053486 (CH), and Army Research Office grant W911NF-11-1-0473 (CH). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="1"/>
<page-count count="21"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-11-29</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>A long-standing goal of applied statistics in many fields has been identifying features associated significantly by a measure such as correlation [<xref ref-type="bibr" rid="pcbi.1005852.ref001">1</xref>,<xref ref-type="bibr" rid="pcbi.1005852.ref002">2</xref>]. When the features to be associated form a composition, inference of the correlation matrix is subject to the well-known problem of spurious correlation [<xref ref-type="bibr" rid="pcbi.1005852.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1005852.ref006">6</xref>]. Compositional data in particular are vectors of proportions that sum to a fixed constant (typically one); they are usually thought of as the result of sum-normalizing an unobserved (or unrecorded) and unconstrained basis, following the terminology of [<xref ref-type="bibr" rid="pcbi.1005852.ref006">6</xref>]. The resulting sum-constraint of the compositional data means that any pairwise correlation measured using such data can be non-zero even if all the pairwise correlations on the unobserved count scale are zero, a phenomenon called spurious correlation [<xref ref-type="bibr" rid="pcbi.1005852.ref003">3</xref>]. The fact that all the features sum to one also makes the correlation matrix on the unobserved counts (that is, the basis correlation matrix) non-identifiable without untestable, though perhaps not unreasonable, assumptions [<xref ref-type="bibr" rid="pcbi.1005852.ref007">7</xref>–<xref ref-type="bibr" rid="pcbi.1005852.ref010">10</xref>]. Any method thus offers at best a partial reconstruction of the unobserved count correlation matrix, and the interest in characterizing such correlations in fields from geology to ecology has led to a variety of approaches.</p>
<p>In the context of microbial ecology, several methods have been proposed to identify significant ecological relationships from compositions; virtually all rely on some form of sparsity assumption and infer quantities relating to the log-transformed unobserved counts (hereafter referred to as the log-basis). The only technique that does not rely on a sparsity assumption is ReBoot [<xref ref-type="bibr" rid="pcbi.1005852.ref007">7</xref>], which estimates a “compositionally-corrected” correlation matrix using a permutation-based method. Friedman and Alm [<xref ref-type="bibr" rid="pcbi.1005852.ref008">8</xref>] proposed SparCC, which estimates the log-basis correlation matrix under the assumption that the correlations are on average small in magnitude. Fang et al. [<xref ref-type="bibr" rid="pcbi.1005852.ref009">9</xref>] noted that the resulting estimate is not guaranteed to be positive definite or that the elements will lie inside [–1, 1] and proposed CCLasso to estimate the log-basis correlation matrix using a LASSO penalty on the off-diagonal elements of the variance-covariance matrix. Ban et al. [<xref ref-type="bibr" rid="pcbi.1005852.ref010">10</xref>] similarly proposed REBACCA to estimate the log-basis correlation matrix; they use the same LASSO penalty function but a different likelihood function. Kurtz et al. [<xref ref-type="bibr" rid="pcbi.1005852.ref011">11</xref>] proposed SPIEC-EASI to estimate the log-basis precision matrix when the number of features is large by using sparse graph estimation techniques.</p>
<p>These approaches have difficulty quantifying uncertainty in the estimates, cannot incorporate uncertainty from the choice of tuning parameter, and are not flexible in the quantities they estimate. Friedman and Alm [<xref ref-type="bibr" rid="pcbi.1005852.ref008">8</xref>] proposed an inferential procedure based on the bootstrap, but offered no theoretical justification. Fang et al. [<xref ref-type="bibr" rid="pcbi.1005852.ref009">9</xref>] and Kurtz et al. [<xref ref-type="bibr" rid="pcbi.1005852.ref011">11</xref>] focused solely on estimation, while Ban et al. [<xref ref-type="bibr" rid="pcbi.1005852.ref010">10</xref>] used a subsampling method from Shah and Samworth [<xref ref-type="bibr" rid="pcbi.1005852.ref012">12</xref>] to stabilize the selection error rate. The LASSO-based methods [<xref ref-type="bibr" rid="pcbi.1005852.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1005852.ref011">11</xref>] typically choose a shrinkage parameter and subsequently infer the log-basis covariance or precision matrix. Friedman and Alm [<xref ref-type="bibr" rid="pcbi.1005852.ref008">8</xref>], Fang et al. [<xref ref-type="bibr" rid="pcbi.1005852.ref009">9</xref>], and Ban et al. [<xref ref-type="bibr" rid="pcbi.1005852.ref010">10</xref>] all use the log-basis covariance matrix for network construction, while Kurtz et al. [<xref ref-type="bibr" rid="pcbi.1005852.ref011">11</xref>] use the log-basis precision matrix. This means that investigators typically must choose whether a precision or correlation matrix is best, and often use the resulting estimate with little guidance as to its uncertainty.</p>
<p>We address these issues by providing a flexible, fully Bayesian approach to identify correlations in compositional data. It is able to quantify uncertainty through the associated posterior and estimates both the log-basis correlation and precision matrix by modeling the composition directly. The graphical LASSO prior of [<xref ref-type="bibr" rid="pcbi.1005852.ref013">13</xref>] is used to estimate a sparse log-basis precision matrix (and hence a sparse log-basis correlation matrix) through a LASSO penalty, mitigating the non-identifiable nature of the unobserved count correlation matrix. We have implemented the resulting method as BAnOCC (Bayesian Analysis of Compositional Covariance). In this study, we also use a first-order Taylor expansion to approximate the compositional covariance as a function of the mean and variance of the unobserved counts. While not necessary to the development of our method, this expansion helps us explore the situations in which a naïve approach (ignoring the sum-constraint) might work. This approximation shows not only that the spurious correlation between two features can take any value in [−1,1] even if none of the features are correlated on the unobserved count scale, but also that both the variances and means of the unobserved counts control the magnitude and direction of the spurious correlation. Thus, we provide a novel characterization of the surprisingly broad circumstances under which compositionality can impede straightforward identification of the correlation matrix, and we provide the BAnOCC model to overcome this in datasets where it is possible.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>Per-subject basis (unobserved and unconstrained count) and composition notation</title>
<p>The model assumes that a single subject’s composition, <bold>C</bold><sub><italic>i</italic></sub> = (<italic>C</italic><sub><italic>i</italic>,1</sub>,…,<italic>C</italic><sub><italic>i</italic>,<italic>p</italic></sub>)<sup><italic>T</italic></sup>, is generated by the normalization of that subject’s unobserved and unconstrained counts, <bold>X</bold><sub><italic>i</italic></sub> = (<italic>X</italic><sub><italic>i</italic>,1</sub>,…,<italic>X</italic><sub><italic>i</italic>,<italic>p</italic></sub>)<sup><italic>T</italic></sup>. That is, <inline-formula id="pcbi.1005852.e001"><alternatives><graphic id="pcbi.1005852.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:msub><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>. We also assume that the unobserved counts for all subjects are independent and identically distributed (iid); this implies that the compositions are iid as well because the transformation is per-subject.</p>
</sec>
<sec id="sec004">
<title>Feature correlations and covariances in composition and unobserved counts</title>
<p>We also introduce notation for the covariance and correlation among the features. The covariance matrix of the unobserved counts is denoted by <bold>Σ</bold><sub><italic>X</italic></sub> = [<italic>σ</italic><sub><italic>X</italic>,<italic>jk</italic></sub>], to be inferred from <bold>C</bold><sub>1</sub>,…,<bold>C</bold><sub><italic>n</italic></sub>. Similarly, the covariance matrix of the composition is denoted by <bold>Σ</bold><sub><italic>C</italic></sub> = [<italic>σ</italic><sub><italic>C</italic>,<italic>jk</italic></sub>]. To construct the network of feature interactions, the relevant null hypotheses (one for each feature pair <italic>j</italic> and <italic>k</italic>) are that features <italic>j</italic> and <italic>k</italic> have a covariance of zero (<italic>σ</italic><sub><italic>X</italic>,<italic>jk</italic></sub> = 0); this is equivalent to testing if they are uncorrelated (<italic>ρ</italic><sub><italic>X</italic>,<italic>jk</italic></sub> = 0). We then define the unobserved count and compositional correlation matrices as <bold>R</bold><sub><italic>X</italic></sub> = [<italic>ρ</italic><sub><italic>X</italic>,<italic>jk</italic></sub>] and <bold>R</bold><sub><italic>C</italic></sub> = [<italic>ρ</italic><sub><italic>C</italic>,<italic>jk</italic></sub>], respectively.</p>
</sec>
</sec>
<sec id="sec005">
<title>BAnOCC: Bayesian analysis of compositional covariance</title>
<p>BAnOCC assumes that the unobserved counts follow a log-normal distribution and that their correlation matrix is sparse; it is parametrized with the log-basis precision matrix and the log-basis mean (<bold><xref ref-type="fig" rid="pcbi.1005852.g001">Fig 1</xref></bold>). Posteriors for the parameters of the model (and thus functions of them which are of interest) are inferred using MCMC sampling. This fully Bayesian treatment of the problem gives several advantages: a full posterior distribution to quantify the uncertainty in the estimates, the ability to place a prior on the sparsity parameter, and estimates of any function of the log-basis precision matrix, including the log-basis covariance and correlation matrices.</p>
<fig id="pcbi.1005852.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005852.g001</object-id>
<label>Fig 1</label>
<caption>
<title>BAnOCC infers log-basis correlation and precision matrices from compositions by modeling unobserved and unconstrained counts.</title>
<p>In the BAnOCC model, the observed compositions, <bold>C</bold><sub>i</sub>, are derived by normalizing the unobserved counts <bold>X</bold><sub>i</sub>. The BAnOCC model assumes that the <bold>X</bold><sub>i</sub> follow a log-normal distribution, parametrized by the log-basis mean <bold>m</bold> and covariance <bold>S</bold>. It places a normal prior on <bold>m,</bold> the GLASSO prior of [<xref ref-type="bibr" rid="pcbi.1005852.ref013">13</xref>] on the log-basis precision matrix <bold>O,</bold> and a hyperprior on the GLASSO shrinkage parameter λ (see <xref ref-type="sec" rid="sec002">Methods</xref>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.g001" xlink:type="simple"/>
</fig>
<p>BAnOCC models the unobserved and unconstrained counts using a log-normal distribution with parameters based on the moments of the log-basis: <inline-formula id="pcbi.1005852.e002"><alternatives><graphic id="pcbi.1005852.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mover><mml:mrow><mml:mo>∼</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:mover><mml:mi mathvariant="script">L</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">m</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>, such that <inline-formula id="pcbi.1005852.e003"><alternatives><graphic id="pcbi.1005852.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mi mathvariant="bold">m</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo>{</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>}</mml:mo><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> and <bold>S</bold> = Var(log{<bold>X</bold>}). This continuous approximation of the underlying unobserved count data is expected to perform well when the underlying counts have a large dynamic range. In ecology, for example, the log-normal distribution is used to model the (discrete) abundance across species [<xref ref-type="bibr" rid="pcbi.1005852.ref014">14</xref>,<xref ref-type="bibr" rid="pcbi.1005852.ref015">15</xref>]. In microbial ecology specifically, the logistic normal is sometimes assumed to be the generating distribution of the composition [<xref ref-type="bibr" rid="pcbi.1005852.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1005852.ref011">11</xref>]; further, the (discrete) read counts are often simulated using a log-normal distribution [<xref ref-type="bibr" rid="pcbi.1005852.ref016">16</xref>,<xref ref-type="bibr" rid="pcbi.1005852.ref017">17</xref>]. The log-normal distribution also allows the totals to be easily integrated out of the likelihood.</p>
<sec id="sec006">
<title>Parametrization of the likelihood</title>
<p>The likelihood is parametrized by the log-basis precision matrix <bold>O</bold> = <bold>S</bold><sup>−1</sup> and the log-basis mean <bold>m</bold>, and other parameters of interest like the log-basis covariance matrix <bold>S</bold> are sampled as transformations of these. By parametrizing using <bold>O</bold>, we are able to leverage a graphical LASSO prior to enforce sparsity on <bold>O</bold> and by extension <bold>S</bold>. Conveniently, the assumption of the log-normal distribution obviates the need to sample the covariance of the unobserved counts to determine the existence and direction of an association between two features on the unobserved count scale. This results because when some element of <bold>S</bold>, <italic>s</italic><sub><italic>jk</italic></sub>, is zero, then the corresponding element of <inline-formula id="pcbi.1005852.e004"><alternatives><graphic id="pcbi.1005852.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula> will also be zero; further, the non-zero elements of <bold>S</bold> and <bold>Σ</bold><sub><italic>X</italic></sub> will have the same sign (though not the same magnitude).</p>
<p>Under the log-normal assumption, the complete likelihood of the observed composition <bold>c</bold><sub><italic>i</italic></sub> and the latent total <inline-formula id="pcbi.1005852.e005"><alternatives><graphic id="pcbi.1005852.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is given by
<disp-formula id="pcbi.1005852.e006">
<alternatives>
<graphic id="pcbi.1005852.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">m</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">O</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi><mml:mo>[</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="bold">m</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">O</mml:mi><mml:mo>{</mml:mo><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="bold">m</mml:mi><mml:mo>}</mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="bold">O</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
where <inline-formula id="pcbi.1005852.e007"><alternatives><graphic id="pcbi.1005852.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:msub><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:munderover><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>. A detailed derivation can be found in <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s001">S1 Text</xref></bold>. Fitting this likelihood directly is computationally expensive, as the presence of the latent totals necessitates exploring a space whose dimension depends on both <italic>n</italic> and <italic>p</italic>. However, (<xref ref-type="disp-formula" rid="pcbi.1005852.e006">1</xref>) factors into two portions: a part dependent on the compositions <bold>c</bold><sub><italic>i</italic></sub>, and the kernel of a log-normal distribution for the totals <inline-formula id="pcbi.1005852.e008"><alternatives><graphic id="pcbi.1005852.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> with parameters <inline-formula id="pcbi.1005852.e009"><alternatives><graphic id="pcbi.1005852.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold">O</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">m</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005852.e010"><alternatives><graphic id="pcbi.1005852.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold">O</mml:mi><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> (where <bold>1</bold> is a vector of 1’s). Integrating over the totals in (<xref ref-type="disp-formula" rid="pcbi.1005852.e006">1</xref>) (<bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s001">S1 Text</xref></bold>) gives the more computationally tractable marginal likelihood
<disp-formula id="pcbi.1005852.e011">
<alternatives>
<graphic id="pcbi.1005852.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e011" xlink:type="simple"/>
<mml:math display="block" id="M11">
<mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">m</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">O</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>|</mml:mo> <mml:mi mathvariant="bold">O</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi><mml:mo>{</mml:mo> <mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">m</mml:mi><mml:mo>− </mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold">O</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">m</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>}</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Π</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math>
</alternatives>
</disp-formula></p>
</sec>
<sec id="sec007">
<title>Prior distributions</title>
<p>In order to mitigate the non-identifiability of the precision matrix <bold>O,</bold> BAnOCC uses a shrinkage prior to conservatively estimate the sparsest <bold>O</bold> consistent with the observed relative abundance data. This is the graphical LASSO prior of [<xref ref-type="bibr" rid="pcbi.1005852.ref013">13</xref>]:
<disp-formula id="pcbi.1005852.e012">
<alternatives>
<graphic id="pcbi.1005852.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e012" xlink:type="simple"/>
<mml:math display="block" id="M12">
<mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">O</mml:mi><mml:mo>|</mml:mo><mml:mi>λ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:munderover><mml:mo stretchy="true">∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="true">∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mfenced><mml:mo>}</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="bold">O</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
where <inline-formula id="pcbi.1005852.e013"><alternatives><graphic id="pcbi.1005852.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="bold">O</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is an indicator function that <bold>O</bold> is positive definite, Exp(<italic>x</italic>|<italic>λ</italic>) has the exponential density of the form <italic>p</italic>(<italic>x</italic>) = <italic>λe</italic><sup>−<italic>λx</italic></sup>1<sub><italic>x</italic>&gt;0</sub>, and Laplace (<italic>x</italic>|<italic>λ</italic>) has the Laplace density of the form <inline-formula id="pcbi.1005852.e014"><alternatives><graphic id="pcbi.1005852.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>. In comparison to variable selection priors such as spike-and-slab [<xref ref-type="bibr" rid="pcbi.1005852.ref018">18</xref>], the graphical LASSO prior is more scalable to high dimensions at the cost of being unable to generate estimates that are exactly zero [<xref ref-type="bibr" rid="pcbi.1005852.ref019">19</xref>]. We deal with this by using the resulting posterior samples to conclude whether a correlation is likely to be zero or not. The choice of <italic>λ</italic> is key to the degree of shrinkage imposed by this prior. We placed a gamma prior on <italic>λ</italic> in lieu of specifying it <italic>a priori</italic>; this is possible because [<xref ref-type="bibr" rid="pcbi.1005852.ref013">13</xref>] showed that the normalizing constant <italic>C</italic> does not depend on <italic>λ</italic>. The prior for <bold>m</bold> is the conditionally-conjugate normal prior <inline-formula id="pcbi.1005852.e015"><alternatives><graphic id="pcbi.1005852.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">n</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">L</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> with mean <bold>n</bold> and covariance matrix <bold>L</bold>. Hyperparameter choice for the two priors (on <bold>m</bold> and <italic>λ</italic>) is discussed in more detail below.</p>
</sec>
<sec id="sec008">
<title>Implementation and inference</title>
<p>BAnOCC samples the posterior using Stan’s C++ implementation and R interface [<xref ref-type="bibr" rid="pcbi.1005852.ref020">20</xref>]. Multiple quantities can be estimated from BAnOCC, including the log-basis precision, covariance, and correlation matrices. In our simulations and application, we estimated the log-basis correlation <bold>R</bold><sub>log<bold>X</bold></sub> because it is interpretable and nicely scaled; we used the posterior median as the point estimate and the 95% credible intervals for <italic>w</italic><sub><italic>jk</italic></sub> to determine whether the correlation between features <italic>j</italic> and <italic>k</italic> was non-zero.</p>
</sec>
</sec>
<sec id="sec009">
<title>Choosing hyperparameters</title>
<p>The interpretation of the prior parameters on <bold>m</bold> is relatively straightforward, while that of the shrinkage parameter <italic>λ</italic> is less clear. Because log-basis means <bold>m</bold> have a normal distribution, <italic>e</italic><sup><bold>m</bold></sup> represents the median unobserved counts, which conveniently have a log-normal distribution with parameters <bold>n</bold> and <bold>L</bold>. Therefore, we could parametrize the prior on <bold>m</bold> by the expected median unobserved counts <bold>n</bold><sub><italic>LN</italic></sub> = exp{<bold>n</bold> + 0.5<italic>diag</italic>(<bold>L</bold>)} and uncertainty of the median unobserved counts <inline-formula id="pcbi.1005852.e016"><alternatives><graphic id="pcbi.1005852.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msub><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">n</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">n</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">L</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>. The prior on the shrinkage parameter <italic>λ</italic> has a shape parameter <italic>a</italic> that determines how much prior probability mass is placed on <italic>λ</italic> values close to zero, and a rate parameter <italic>b</italic> that determines how the probability mass is spread across the entire domain. In particular, <italic>a</italic> ≤ 1 forces an asymptote at zero, while <italic>a</italic> &gt; 1 does not.</p>
<p>When little or no prior data is available, weakly informative priors can be used. Any prior on <italic>λ</italic> should have high probability mass close to zero and so should have <italic>a</italic> ≤ 1. Larger values of <italic>a</italic> will “soften” the asymptotic behavior at zero (<bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s007">S1 Fig</xref></bold>). The value of the rate parameter <italic>b</italic> should be chosen to so that most prior probability mass is on sensible values for <italic>λ</italic>. The degree of shrinkage implied by <italic>λ</italic> does not appreciably change for <italic>λ</italic> &gt; 1 (<bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s008">S2 Fig</xref></bold>), and so a <italic>b</italic> of around 5 will give a reasonable uninformative prior distribution for <italic>λ</italic>. For the log-basis means, <inline-formula id="pcbi.1005852.e017"><alternatives><graphic id="pcbi.1005852.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mi mathvariant="bold">m</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mi mathvariant="bold">I</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> can be used, with <italic>l</italic> a large value such as 100. An overlarge value for <italic>l</italic> can make computation less efficient and put prior mass on grossly implausible values of e<sup><bold>m</bold></sup>, so an <italic>l</italic> of 500 or less is reasonable.</p>
<p>Prior subject-matter information can be incorporated into the priors for both <italic>λ</italic> and <bold>m</bold>, but most easily into the prior on <bold>m</bold>. If the data have few features, a smaller shape hyperparameter <italic>a</italic> should be employed to upweight values of <italic>λ</italic> that yield high shrinkage. The implied prior on the median unobserved counts <italic>e</italic><sup><bold>m</bold></sup> could be sampled to provide an empirical distribution of the total counts <inline-formula id="pcbi.1005852.e018"><alternatives><graphic id="pcbi.1005852.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:munderover><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>; this could be assessed for gross deviations from what might be considered reasonable, or agreement with known ranges if such data are available.</p>
</sec>
<sec id="sec010">
<title>Software</title>
<p>The implementation of BAnOCC is publicly available with source code, documentation, and tutorial data as an R/Bioconductor package at <ext-link ext-link-type="uri" xlink:href="http://huttenhower.sph.harvard.edu/banocc" xlink:type="simple">http://huttenhower.sph.harvard.edu/banocc</ext-link>.</p>
</sec>
<sec id="sec011" sec-type="results">
<title>Results</title>
<sec id="sec012">
<title>Unobserved count mean and covariance determine spurious correlation sign and magnitude</title>
<p>We first aimed to identify what characteristics of compositional data impede or facilitate the accurate estimation of the unobserved count correlation matrices in general. Such characteristics should delineate when BAnOCC or any other technique for estimating the unobserved count correlation would perform well. A first-order Taylor expansion approximates the compositional covariance as a function of the mean and covariance of the unobserved counts. Because the compositional correlation is a function of the compositional covariance, the resulting approximation also explains how the correlation behaves. Letting <bold>X</bold> represent the unobserved counts and <bold>C</bold> the composition, with the mean of <bold>X</bold> denoted by <bold>μ</bold><sub><italic>X</italic></sub> = (<italic>μ</italic><sub><italic>X</italic>,<italic>j</italic></sub>)<sup><italic>T</italic></sup> and the approximate average proportions by <inline-formula id="pcbi.1005852.e019"><alternatives><graphic id="pcbi.1005852.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mi mathvariant="bold">ω</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>, the Taylor expansion yields
<disp-formula id="pcbi.1005852.e020">
<alternatives>
<graphic id="pcbi.1005852.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e020" xlink:type="simple"/>
<mml:math display="block" id="M20">
<mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">ω</mml:mi><mml:msup><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold">I</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">ω</mml:mi><mml:msup><mml:mrow><mml:mn mathvariant="bold">1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula></p>
<p>Here <bold>I</bold> is the <italic>p</italic> × <italic>p</italic> identity matrix, and <bold>1</bold> is a <italic>p</italic>-dimensional vector of 1’s. Eq (<xref ref-type="disp-formula" rid="pcbi.1005852.e020">2</xref>) allows us to approximate the behavior of the compositional covariance from the parameters of the unobserved counts that generate it. For a detailed derivation, see <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s001">S1 Text</xref></bold>.</p>
</sec>
<sec id="sec013">
<title>Spurious correlation can take any value between -1 and 1</title>
<p>Surprisingly, when no features are correlated on the unobserved count scale, the spurious correlation can take any value in [−1,1] depending on the properties of the unobserved counts (<bold><xref ref-type="fig" rid="pcbi.1005852.g002">Fig 2</xref></bold>). This is suggested by considering Eq (<xref ref-type="disp-formula" rid="pcbi.1005852.e020">2</xref>) when <italic>σ</italic><sub><italic>X</italic>,<italic>jk</italic></sub> = 0 for all <italic>j</italic> ≠ <italic>k</italic>, then
<disp-formula id="pcbi.1005852.e021">
<alternatives>
<graphic id="pcbi.1005852.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e021" xlink:type="simple"/>
<mml:math display="block" id="M21">
<mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mrow><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mspace width="0.25em"/><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi><mml:mo>.</mml:mo>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula></p>
<p>The weights <italic>ω</italic><sub><italic>j</italic></sub> and the variances <italic>σ</italic><sub><italic>X</italic>,<italic>ll</italic></sub> can be configured arbitrarily to force <italic>σ</italic><sub><italic>C</italic>,<italic>jk</italic></sub> either to the extreme positive or extreme negative end of the spectrum. In particular, we see three types of strong spurious correlations (<bold><xref ref-type="fig" rid="pcbi.1005852.g002">Fig 2B–2D</xref></bold>): “negative dominant”, “positive dominant”, and “negative mixed”. These three types of correlations are thus representative of a range of expected real-world behaviors, and we included them in subsequent simulation studies of BAnOCC and previous models.</p>
<fig id="pcbi.1005852.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005852.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Spurious correlation is not constrained as a function of feature count, mean, and variance.</title>
<p><bold>A</bold> The approximate compositional correlation (based on Eq (<xref ref-type="disp-formula" rid="pcbi.1005852.e021">3</xref>)) between features j and k when σ<sub>X,jk</sub> = 0, as a function of the proportion of the total mean and proportion of total variability they contribute. <bold>B</bold>-<bold>D</bold> Examples of compositions that display positive (<bold>B</bold>) and negative (<bold>C</bold>-<bold>D</bold>) compositional correlations; in each, the top panel shows the correlation of the unconstrained and unobserved abundances across samples, while the bottom panel shows the correlation of the relative abundances across samples. The spurious correlation can be positive or negative, and of arbitrary magnitude, depending on the characteristics of the unobserved abundances.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.g002" xlink:type="simple"/>
</fig>
<p>“Negative dominant” spurious correlation (<bold><xref ref-type="fig" rid="pcbi.1005852.g002">Fig 2B</xref></bold>) occurs when features <italic>j</italic> and <italic>k</italic> in the unobserved counts have (1) high mean and (2) high variability compared to the remaining (<italic>l</italic> ≠ <italic>j</italic>,<italic>k</italic>) features. Intuitively, the remaining features must contribute minimally to the total mean or total variance in the unobserved counts. When normalized, the sum-constraint thus forces a negative correlation between features <italic>j</italic> and <italic>k</italic> because they behave as if they were the only two features in the composition.</p>
<p>In the “positive dominant” spurious correlation type (<bold><xref ref-type="fig" rid="pcbi.1005852.g002">Fig 2C</xref></bold>), features <italic>j</italic> and <italic>k</italic> in the unobserved counts have (1) small variability and (2) high mean relative to the remaining (<italic>l</italic> ≠ <italic>j</italic>,<italic>k</italic>) features. The positive correlation in the composition results because the variability in the sum of the remaining feature abundances causes the compositions for features <italic>j</italic> and <italic>k</italic> to be shrunk or stretched in the same direction when the data are normalized.</p>
<p>Finally, “negative mixed” spurious correlations are the result of “positive dominant” type bases where feature <italic>k</italic> and the remaining features have switched roles (<bold><xref ref-type="fig" rid="pcbi.1005852.g002">Fig 2D</xref></bold>). After normalization, the variability in feature <italic>k</italic> forces feature <italic>j</italic> to move in the opposite direction to accommodate the remaining features.</p>
</sec>
<sec id="sec014">
<title>Extending and improving current assumptions about compositional correlation</title>
<p>Eq (<xref ref-type="disp-formula" rid="pcbi.1005852.e021">3</xref>) also offers an alternative explanation for the negative covariance between features in a Dirichlet distribution. A Dirichlet distribution with parameters <italic>α</italic><sub>1</sub>…,<italic>α</italic><sub><italic>p</italic></sub> results when each feature is independent on the unobserved count scale and has a <italic>Gamma</italic>(<italic>α</italic><sub><italic>j</italic></sub>,<italic>β</italic>). The mean and variance of a Gamma distribution are <inline-formula id="pcbi.1005852.e022"><alternatives><graphic id="pcbi.1005852.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mfrac><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005852.e023"><alternatives><graphic id="pcbi.1005852.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mfrac><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>, respectively, implying that in the unobserved counts, a feature with high mean will also have high variance, and vice versa. This captures “negative dominant” correlations well, but fails to capture “positive dominant” or “negative mixed” correlations, which result when at least one feature has high mean but <italic>low</italic> variance in the unobserved counts.</p>
<p>Eqs (<xref ref-type="disp-formula" rid="pcbi.1005852.e020">2</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005852.e021">3</xref>) further suggest that the overall effect of normalization on the correlation estimate as the number of features <italic>p</italic> increases depends on the characteristics of <bold>μ</bold><sub><italic>X</italic></sub> and <bold>Σ</bold><sub><italic>X</italic></sub>. In ecological applications, it is often assumed that if <italic>p</italic> is large and the compositional means are similar across the <italic>p</italic> features, then the correlation estimates based on the composition and unobserved counts are not likely to be very different [<xref ref-type="bibr" rid="pcbi.1005852.ref008">8</xref>,<xref ref-type="bibr" rid="pcbi.1005852.ref010">10</xref>]. Part of the appeal of this reasoning is that it does not rely on information about the unobserved and unconstrained counts. Expanding Eq (<xref ref-type="disp-formula" rid="pcbi.1005852.e020">2</xref>), we can see that <bold>Σ</bold><sub><italic>C</italic></sub> ∝ <bold>Σ</bold><sub><italic>X</italic></sub> − <bold>ω1</bold><sup><italic>T</italic></sup><bold>Σ</bold><sub><italic>X</italic></sub> − <bold>Σ</bold><sub><italic>X</italic></sub><bold>1ω</bold><sup><italic>T</italic></sup> + <bold>ω1</bold><sup><italic>T</italic></sup><bold>Σ</bold><sub><italic>X</italic></sub><bold>1ω</bold><sup><italic>T</italic></sup>. If the means are very similar to each other, this affects only the weights <bold>ω</bold> given to the offset <bold>ω1</bold><sup><italic>T</italic></sup><bold>Σ</bold><sub><italic>X</italic></sub> − <bold>Σ</bold><sub><italic>X</italic></sub><bold>1ω</bold><sup><italic>T</italic></sup> + <bold>ω1</bold><sup><italic>T</italic></sup><bold>Σ</bold><sub><italic>X</italic></sub><bold>1ω</bold><sup><italic>T</italic></sup>. Small weights render the offset negligible only in the case where the unobserved variance on the unobserved counts <bold>Σ</bold><sub><italic>X</italic></sub> is not too large: the behavior of the offset as the number of features increases depends on the similarity of the means (through <bold>ω</bold>) <italic>and</italic> on the variances of the additional features in the unobserved counts (through <bold>Σ</bold><sub><italic>X</italic></sub>).</p>
<p>Thus when analyzing compositional data, one cannot know with certainty in which data the correlations are strongly affected by the normalization, much less the magnitude and direction of the change in correlation structure induced by normalizing. The information loss due to normalization implies that <bold>Σ</bold><sub><italic>X</italic></sub> is non-identifiable without assumptions about its structure. However, knowing how the unobserved and unobserved counts affect the spurious correlation allows simulation of datasets that have specific types of spurious correlation for testing the performance of estimation methods in these cases.</p>
</sec>
</sec>
<sec id="sec015">
<title>Simulation studies</title>
<sec id="sec016">
<title>Data generation methods</title>
<p>Using the information from this theoretical analysis, we tested BAnOCC on two types of datasets. The first comprised small datasets generated using the model itself but designed to be challenging by incorporating negative dominant correlations. Second, we also simulated larger, more realistic datasets using an independent model specific to microbial community structure, sparseDOSSA [<xref ref-type="bibr" rid="pcbi.1005852.ref021">21</xref>].</p>
<p>For the former, four small datasets with 1,000 samples and nine features each were generated according to four scenarios. The “simple” scenario had no true correlations and no negative dominant correlation; the “high spurious” scenario had no true correlations but the presence of a negative dominant correlation; the “retained spike” scenario had several true correlations and no negative dominant correlation; and the “reversed spike” scenario had several true correlations and a negative dominant correlation between two features that are positively correlated in the unobserved abundances (see details in <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s002">S2 Text</xref></bold> and data in <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s004">S1 Data</xref></bold>). On these data, we used hyperparameters <italic>n</italic><sub><italic>j</italic></sub> = 0, <bold>L</bold> = 1000<bold>I</bold>, <italic>a</italic> = 0.5 and <italic>b</italic> = 5 (<bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s009">S3 Fig</xref></bold>).</p>
<p>Realistic data were generated using the SparseDOSSA model [<xref ref-type="bibr" rid="pcbi.1005852.ref021">21</xref>], which generates each feature from a zero-inflated, truncated log-normal distribution with subsequent rounding and estimates the feature-specific parameters by fitting to a given real-world template dataset. We induced correlations between features by using a multivariate distribution with a log-basis correlation that had off-diagonal elements set to one of four different correlation strengths ({−0.7,−0.3,0.3,0.7}). To ensure that strong compositional effects were present, we used a template with low-diversity community structure [<xref ref-type="bibr" rid="pcbi.1005852.ref022">22</xref>] with 14 pseudomicrobial features. The correlations were set so that the non-zero elements of the log-basis precision matrix and the log-basis covariance matrix would be the same; we used seven correlations (see details in <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s002">S2 Text</xref></bold> and data in <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s005">S2 Data</xref></bold>). We used hyperparameters <italic>a</italic> = 0.5, <italic>b</italic> = 5, <italic>n</italic><sub><italic>j</italic></sub> = 3, and <bold>L</bold> = 30<bold>I</bold> (<bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s010">S4 Fig</xref></bold>).</p>
</sec>
<sec id="sec017">
<title>BAnOCC and CCLasso perform comparably in difficult scenarios</title>
<p>Using our first set of simulated data for evaluation, we compared the estimation and inference from BAnOCC with that from CCLasso [<xref ref-type="bibr" rid="pcbi.1005852.ref009">9</xref>], a frequentist LASSO-based method that chooses the shrinkage parameter using <italic>K</italic>-fold cross validation (<bold><xref ref-type="fig" rid="pcbi.1005852.g003">Fig 3</xref></bold>). BAnOCC had much lower false positive rates than CCLasso, resulting from the model’s ability to use the posterior distribution to account for estimate uncertainty while CCLasso, being LASSO-based, used a non-zero point estimate to determine significance of an effect.</p>
<fig id="pcbi.1005852.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005852.g003</object-id>
<label>Fig 3</label>
<caption>
<title>BAnOCC infers the correct unobserved abundance correlation matrix in four scenarios simulated to be challenging.</title>
<p>Each column represents one four datasets simulated to evaluate methods for identification of correlations from compositional data: “simple”, with no true correlations and no negative dominant correlation; “high spurious”, with no true correlations and the presence of a negative dominant correlation; “retained spike” with several true correlations and no negative dominant correlation; and “reversed spike” with several true correlations and a negative dominant correlation between two positively correlated features. The top row shows the true correlation matrix. The second row shows the uncorrected compositional correlations <inline-formula id="pcbi.1005852.e024"><alternatives><graphic id="pcbi.1005852.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>ˆ</mml:mi></mml:mover></mml:math></alternatives></inline-formula> as estimated using the 1,000 samples in the simulated data. Each of the subsequent rows shows the log-basis correlation estimate <inline-formula id="pcbi.1005852.e025"><alternatives><graphic id="pcbi.1005852.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="bold">X</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and the associated inference using the compositional data for Pearson correlation, BAnOCC, and CCLasso, respectively.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.g003" xlink:type="simple"/>
</fig>
<p>BAnOCC and CCLasso both estimate the log-basis correlation matrix accurately, and both are a substantial improvement on a naïve approach (row 2 of <bold><xref ref-type="fig" rid="pcbi.1005852.g003">Fig 3</xref></bold>). In particular, both BAnOCC and CCLasso have much lower false positive rates than Pearson correlation. Over all the null associations, Pearson correlation had a staggering false positive rate of 82%; CCLasso had almost 14% false positives as a result of many small but non-zero estimates; BAnOCC, because it uses the posterior credible intervals to evaluate uncertainty, had a false positive rate of about 3%. BAnOCC cannot estimate the log-basis correlations <italic>w</italic><sub><italic>jk</italic></sub> to be exactly zero because of the continuous prior, but the null associations whose 95% credible intervals cover zero have very small estimates (all are less than 0.15, 75% are less than 0.05).</p>
<p>The association between features 1 and 5 in the “reversed spike” dataset was difficult for both BAnOCC and CCLasso. Both gave a small, negative estimate (-0.001 for BAnOCC and -0.113 for CCLasso). BAnOCC displays a slight bias toward positive correlations instead of the moderate negative correlation that was present in the underlying unobserved abundances, as shown by several false positive associations in this dataset. This behavior is common among many methods, including SparCC and SPIEC-EASI (<bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s011">S5 Fig</xref></bold>). It results from the fact that when a negative-dominant structure is present, positive correlations become much more likely to be real than negative ones, an interesting observation to consider when interpreting real-world results from any of these methods.</p>
<p>BAnOCC and CCLasso agree well with the true magnitude and direction of the non-zero associations that both methods conclude are significant. For these associations, the relative difference with the true value is less than 15% for both methods. When the associations were rejected, the 95% credible interval from BAnOCC covered the true value, indicating its utility for evaluating the uncertainty of the estimate. The false negative rates were 25% for BAnOCC and 0% for CCLasso, a direct result of the higher tolerance for false positives CCLasso exhibits. In practice, this has the expected effect of dramatically lowering BAnOCC’s false positive rate in recovering true correlations from compositional data.</p>
</sec>
<sec id="sec018">
<title>Comparison of type I and type II error rates</title>
<p>We compared BAnOCC’s performance as measured by type I and type II error rates to a range of previous methods (<bold><xref ref-type="fig" rid="pcbi.1005852.g004">Fig 4</xref></bold>): simplicial variation [<xref ref-type="bibr" rid="pcbi.1005852.ref023">23</xref>], SparCC [<xref ref-type="bibr" rid="pcbi.1005852.ref008">8</xref>], CCLasso [<xref ref-type="bibr" rid="pcbi.1005852.ref009">9</xref>], SPIEC-EASI [<xref ref-type="bibr" rid="pcbi.1005852.ref011">11</xref>], ReBoot [<xref ref-type="bibr" rid="pcbi.1005852.ref007">7</xref>], and Spearman correlation (directly on the composition as a negative control). Of the two frequentist LASSO-based methods (CCLasso and REBACCA [<xref ref-type="bibr" rid="pcbi.1005852.ref010">10</xref>]), CCLasso alone had an R package interface; because they employ highly similar approaches, they should yield similar results. For a positive control, we also applied Spearman correlation to the unconstrained (and usually unobserved) counts (<bold><xref ref-type="table" rid="pcbi.1005852.t001">Table 1</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s003">S3 Text</xref></bold>).</p>
<fig id="pcbi.1005852.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005852.g004</object-id>
<label>Fig 4</label>
<caption>
<title>The BAnOCC model controls type I error while maintaining power.</title>
<p>Results on simulated data comprising SparseDOSSA-derived compositions modeled on a low-diversity dataset with 14 features. The type I error rate is controlled at the 0.05 level for BAnOCC and approximately so for SparCC, CCLasso, and SPIEC-EASI (MB), but not for simplicial variation or Spearman correlation (on the composition, a negative control). BAnOCC maintains good power across all true correlation values, but as expected has better power for stronger true correlation values. Type I and type II error rates are determined by correct or incorrect rejection of H<sub>0</sub> based on inference (simplicial variation, SparCC, Spearman correlation, and BAnOCC) or estimation (CCLasso and SPIEC-EASI). * = rejection of H<sub>0</sub> based on estimation; ** = rejection of H<sub>0</sub> based on inference from credible intervals; all others, rejection of H<sub>0</sub> based on inference from p-values. (<bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s012">S6 Fig</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s013">S7 Fig</xref></bold>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.g004" xlink:type="simple"/>
</fig>
<table-wrap id="pcbi.1005852.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005852.t001</object-id>
<label>Table 1</label> <caption><title>Methods included in an evaluation on simulated data.</title> <p>Type I and type II error rates were determined for these methods by the correct or incorrect rejection of H<sub>0</sub>; for CCLasso and SPIEC-EASI, no inferential methodology was provided and so the correct or incorrect estimation of w<sub>jk</sub> as zero was used. Note that although SPIEC-EASI infers the precision matrix, construction of the true correlation matrix in the simulated data guarantees that the same elements will be non-zero in the precision and covariance matrix.</p></caption>
<alternatives>
<graphic id="pcbi.1005852.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Method</th>
<th align="left">H<sub>0</sub></th>
<th align="left">Error calls</th>
<th align="left">Inference Method</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Simplicial Variation</td>
<td align="left"><inline-formula id="pcbi.1005852.e026"><alternatives><graphic id="pcbi.1005852.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></alternatives></inline-formula></td>
<td align="left">inference</td>
<td align="left">one-sided permutation test</td>
</tr>
<tr>
<td align="left">SparCC</td>
<td align="left"><italic>w</italic><sub><italic>jk</italic></sub> = 0</td>
<td align="left">inference</td>
<td align="left">authors’ bootstrap-based method</td>
</tr>
<tr>
<td align="left">CCLasso</td>
<td align="left"><italic>w</italic><sub><italic>jk</italic></sub> = 0</td>
<td align="left">estimation</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left">SPIEC-EASI</td>
<td align="left"><italic>w</italic><sub><italic>jk</italic></sub> = 0</td>
<td align="left">estimation</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left">ReBoot</td>
<td align="left"><italic>ρ</italic><sub><italic>X</italic>,<italic>jk</italic></sub> = 0</td>
<td align="left">inference</td>
<td align="left">permutation-based test</td>
</tr>
<tr>
<td align="left">BAnOCC</td>
<td align="left"><italic>w</italic><sub><italic>jk</italic></sub> = 0</td>
<td align="left">inference</td>
<td align="left">95% credible interval</td>
</tr>
<tr>
<td align="left">Spearman (composition)</td>
<td align="left"><italic>ρ</italic><sub><italic>X</italic>,<italic>jk</italic></sub> = 0</td>
<td align="left">inference</td>
<td align="left">two-sided permutation test</td>
</tr>
<tr>
<td align="left">Spearman (unconstrained counts)</td>
<td align="left"><italic>ρ</italic><sub><italic>X</italic>,<italic>jk</italic></sub> = 0</td>
<td align="left">inference</td>
<td align="left">two-sided permutation test</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Overall, BAnOCC controlled the type I error rate for all correlation strengths (<bold><xref ref-type="fig" rid="pcbi.1005852.g004">Fig 4A</xref></bold>) while maintaining comparable power compared with other recent methods (<bold><xref ref-type="fig" rid="pcbi.1005852.g004">Fig 4B</xref></bold>). These results held true in a more even community with larger features, in which BAnOCC was the sole method to fully control the type I error rate (<bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s014">S8 Fig</xref></bold>). As the number of samples increased, all methods increased in power (<bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s015">S9 Fig</xref></bold>), while the type I error rates remained fairly constant (<bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s016">S10 Fig</xref></bold>).</p>
<p>Only BAnOCC and SparCC controlled type I error while maintaining high power for all correlation strengths (see also AUC boxplots in <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s012">S6 Fig</xref></bold>). Both behaved similarly to Spearman correlation applied to the unconstrained abundances, which represents the best possible performance (as it uses the unconstrained data rather than the composition—this is impossible in practice, when only the composition is available). SparCC’s type I error rate was slightly inflated in a larger dataset with more features, while BAnOCC continued to control the type I error rate at the nominal level (<bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s014">S8 Fig</xref></bold>). As other authors have noted, SparCC does not guarantee that its log-basis correlation estimate has bounded elements nor that it is positive definite [<xref ref-type="bibr" rid="pcbi.1005852.ref009">9</xref>]. By contrast, BAnOCC not only estimates a positive definite correlation matrix with bounded elements, but also can infer network edges based on the precision matrix as well.</p>
<p>Several methods proved to control the type I error rate poorly: Spearman correlation exemplifies this as a negative control, but simplicial variation, SPIEC-EASI using GLASSO and to a lesser extent CCLasso were comparable. ReBoot, by design, attenuates the type I error rate of Spearman correlation, but does not control it perfectly. The high type I error rates are also somewhat expected in simplicial variation, but SPIEC-EASI using GLASSO may not be performing as expected, especially since in contrast the Meinshausen-Bühlmann neighborhood selection method did control type I error. This may also possibly be because the neighborhood selection infers each element of the matrix one at a time, while GLASSO infers the matrix all at once; this makes the GLASSO optimization a more difficult problem.</p>
<p>Feature 5 in the template dataset has a large mean and variance, while feature 3 has a small mean and variance. This results in a strong negative spurious correlation in the composition, which gives rise to interesting behavior of essentially all methods when detecting this association. When the true association is negative, many compositionally-appropriate methods such as BAnOCC, SparCC, and SPIEC-EASI (MB) do poorly at detecting the true correlation (<bold><xref ref-type="fig" rid="pcbi.1005852.g004">Fig 4B</xref></bold>) because the negative correlation is difficult to attribute to the unobserved counts rather than spurious correlation. Conversely, more naïve methods such as simplicial variation and Spearman correlation do very well at detecting a weak negative correlation between these two features because this becomes a strong negative correlation in the composition. This simulated example thus provides some insight into the form of sensitivity / specificity tradeoff that applies in the constrained, information-loss setting of identifying true correlations from compositions.</p>
</sec>
</sec>
<sec id="sec019">
<title>A microbial interaction network from the Human Microbiome Project</title>
<p>As an example application, we inferred a correlation network among microbial taxa profiled using ecological data from the Human Microbiome Project [<xref ref-type="bibr" rid="pcbi.1005852.ref022">22</xref>] (<bold><xref ref-type="fig" rid="pcbi.1005852.g005">Fig 5</xref></bold>). Microbial community sequencing generates compositions by assigning sequencing reads to microorganisms; since nucleotide sequencing depth is arbitrary, the resulting counts are not informative regarding the unobserved and unconstrained counts and are often normalized to relative abundances. Co-variation patterns in such data are of interest because they suggest ecological interactions, such as mutualism (positive correlation) or predation (negative correlation) [<xref ref-type="bibr" rid="pcbi.1005852.ref007">7</xref>].</p>
<fig id="pcbi.1005852.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005852.g005</object-id>
<label>Fig 5</label>
<caption>
<title>BAnOCC association networks from the Human Microbiome Project.</title>
<p>The association networks inferred from three HMP body sites: stool (<bold>A</bold>), buccal mucosa (<bold>B</bold>), and posterior fornix (<bold>C</bold>). Using four chains with a minimum of 5000 iterations, we ran BAnOCC until convergence (see details in <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s003">S3 Text</xref></bold>). Only significant correlations stronger than 0.15 are shown (see <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s023">S1 Table</xref></bold>, <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s024">S2 Table</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s025">S3 Table</xref></bold>). The GLASSO prior results in sparse networks for these datasets, highlighting individual associations between taxa.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.g005" xlink:type="simple"/>
</fig>
<p>The microbial taxonomic relative abundance data used here consisted of 523 microbial features measured across 700 total samples using MetaPhlAn2 v2.0_beta1 [<xref ref-type="bibr" rid="pcbi.1005852.ref024">24</xref>] in July of 2014 (available in <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s006">S3 Data</xref></bold>), further excluding from all networks markers removed in the subsequent version’s database (v2.0_beta2). These samples were in turn drawn from 127 individuals at six distinct body sites. Microbial ecology differs at each body site [<xref ref-type="bibr" rid="pcbi.1005852.ref022">22</xref>], providing examples for BAnOCC analysis that ranged from diverse, relatively even communities (such as stool) to less diverse, highly skewed ecologies (such as the vaginal posterior fornix). For each of three representative body sites (stool, posterior fornix, and buccal mucosa), we selected the first time point from each subject, collapsed taxonomic information to the genus level, and then removed features with relative abundance less than 0.0001 in at least 50% of samples. With too few features, little to nothing can be concluded about the true correlations; so if fewer than 10 features remained we lowered the prevalence cutoff until 10 features were retained.</p>
<p>The hyperparameters for the gamma prior on <italic>λ</italic> were <italic>a</italic> = 0.5 and <italic>b</italic> = 5 for all body sites, ensuring that we gave substantial weight to sparser precision matrices. For all body sites, we used the prior variability of the log-basis means <bold>L</bold> = 30<bold>I</bold>; each body site, however, had a different <italic>n</italic><sub><italic>j</italic></sub> so that the distribution of the sums of medians were similar across different body sites (see <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s017">S11</xref>–<xref ref-type="supplementary-material" rid="pcbi.1005852.s020">S14</xref> Figs</bold>). We further compared BAnOCC’s inferred network using the log-basis correlation matrix with that from CCLasso, and BAnOCC’s inferred network using the log-basis precision matrix with SPIEC-EASI. There is broad agreement between the methods as to which edges are significant, with very few edges discrepant between the methods (<bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s021">S15 Fig</xref></bold>).</p>
<p>In stool, BAnOCC inferred several positive associations between genera within the family Bacteroidales, in particular <italic>Bacteroides</italic>, <italic>Odoribacter</italic>, <italic>Parabacteroides</italic> and <italic>Alistipes</italic> (<bold><xref ref-type="fig" rid="pcbi.1005852.g005">Fig 5A</xref></bold>). Until recently, these genera were classified as part of the same genus [<xref ref-type="bibr" rid="pcbi.1005852.ref025">25</xref>]. This supports the common observation that closely (but not too closely) related taxa tend to have positive ecological associations [<xref ref-type="bibr" rid="pcbi.1005852.ref026">26</xref>]. Additionally, positive associations in the buccal mucosa (<bold><xref ref-type="fig" rid="pcbi.1005852.g005">Fig 5B</xref></bold>) connect taxa that are known to physically co-aggregate; in particular, <italic>Fusobacterium</italic> interactions with species from the <italic>Porphyromonas</italic> and <italic>Capnocytophaga</italic> genera (among others) are crucial in biofilm formation [<xref ref-type="bibr" rid="pcbi.1005852.ref027">27</xref>] and have been previously recovered from 16S-based ecological analyses [<xref ref-type="bibr" rid="pcbi.1005852.ref007">7</xref>]. Lastly, we can see the well-documented negative association between the <italic>Lactobacillus</italic> genus in the posterior fornix with several genera associated with dysbiosis such as <italic>Gardnerella</italic> and <italic>Prevotella</italic> [<xref ref-type="bibr" rid="pcbi.1005852.ref028">28</xref>] (<bold><xref ref-type="fig" rid="pcbi.1005852.g005">Fig 5C</xref></bold>).</p>
<p>Two interactions newly suggested by this analysis involved the Proteobacteria across multiple body sites, and specifically in stool and the oral cavity (buccal mucosa). The genera <italic>Escherichia</italic> and <italic>Haemophilus</italic> represent the two major proteobacterial residents in these habitats, respectively, and both were involved in predominantly negative interactions with more typical, abundant members of these communities (e.g. <italic>Faecalibacterium</italic> and <italic>Eubacterium</italic> in the gut, <italic>Leptotrichia</italic> or <italic>Corynebacterium</italic> in the mouth). These clades are highly phylogenetically diverged and tend to carry larger, more generalize genomes and pan-genomes [<xref ref-type="bibr" rid="pcbi.1005852.ref029">29</xref>,<xref ref-type="bibr" rid="pcbi.1005852.ref030">30</xref>]; this suggests that they will overgrow in these habitats only in unusual situations, exemplified by <italic>E</italic>. <italic>coli</italic>’s abundance in the gut primarily during inflammation [<xref ref-type="bibr" rid="pcbi.1005852.ref031">31</xref>]. Further details may be provided by future analyses using BAnOCC or related methods on species or strain-level ecological profiling.</p>
</sec>
<sec id="sec020" sec-type="conclusions">
<title>Discussion</title>
<p>Here, we describe BAnOCC, a Bayesian method for inferring the log-basis correlation structure from compositional data. Assuming a log-normal distribution on the unobserved and unconstrained counts, the model estimates the log-basis correlations using a sparsity-inducing shrinkage prior on the log-basis precision matrix. It is part of a family of several recently proposed LASSO-based methods [<xref ref-type="bibr" rid="pcbi.1005852.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1005852.ref011">11</xref>] which provide a more rigorous approach to correcting for compositional effects than earlier methods [<xref ref-type="bibr" rid="pcbi.1005852.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1005852.ref008">8</xref>]. Unlike the other LASSO-based correlation-inference methods that summarize pairwise associations using a single point estimate, BAnOCC yields uncertainty estimates of the precision, covariance, and correlation parameters. Simulation results show that BAnOCC performs as well as or better than existing methods in controlling type I error while maintaining power for network edge detection from compositional data. Finally, we applied the method to assess microbial relationships in the human microbiome, confirming established interactions and suggesting novel ones for future validation.</p>
<p>Analysis using a Taylor series approximation provided one of the first characterizations of properties that make true correlations “difficult” to recover from compositions, or conversely “easy” to miss as false negatives. In particular, this depends not only on the more intuitive number and evenness of feature means, but also on the distribution of their variance. This allowed us to simulate designedly difficult test cases for BAnOCC and a variety of published methods, in contrast to previous simulation studies that relied primarily on relatively simple synthetic data [<xref ref-type="bibr" rid="pcbi.1005852.ref007">7</xref>–<xref ref-type="bibr" rid="pcbi.1005852.ref010">10</xref>]. In most studies, spurious correlation is noted to be commonly present and of varying magnitudes and directions [<xref ref-type="bibr" rid="pcbi.1005852.ref011">11</xref>]. However, the possible sensitivity of methods to the type of spurious correlation encountered has not been explored and is an important contribution to the characterization of existing and future methods.</p>
<p>We anticipate several computational and statistical refinements that may further improve BAnOCC’s performance. While BAnOCC uses 95% credible intervals for inference, these can be overly conservative [<xref ref-type="bibr" rid="pcbi.1005852.ref032">32</xref>]. Alternative thresholding methods may improve on this, such as the scaled neighborhood criterion [<xref ref-type="bibr" rid="pcbi.1005852.ref032">32</xref>] or the partial-correlation based approach of [<xref ref-type="bibr" rid="pcbi.1005852.ref033">33</xref>] and [<xref ref-type="bibr" rid="pcbi.1005852.ref013">13</xref>]. A discrete-continuous mixture prior such as the <italic>G</italic> -Wishart prior [<xref ref-type="bibr" rid="pcbi.1005852.ref034">34</xref>] or the covariance selection prior [<xref ref-type="bibr" rid="pcbi.1005852.ref035">35</xref>] on the log-basis correlation matrix would further allow the posterior probability that <italic>w</italic><sub><italic>jk</italic></sub> = 0 to be nonzero, and this quantity could be used as a threshold.</p>
<p>For applications specifically on count data, such as microbial compositions, the data could be modeled more accurately by adding a hierarchical layer. This would generate measurement counts conditional on the unobserved and unconstrained counts, making the observed compositions a function of normalized measurement counts. The degree of zero-inflation observed in ecological data could also be modeled directly using a hurdle or mixture model, or a multinomial distribution for the measurement counts. This would provide a particularly targeted approach for microbial ecology, in which more detailed data (at the species or strain level [<xref ref-type="bibr" rid="pcbi.1005852.ref024">24</xref>]) could be further incorporated. We thus hope to refine both the accuracy of compositional correlation inference and the applications to microbial community data in future studies.</p>
</sec>
<sec id="sec021">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005852.s001" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Detailed mathematical derivations.</title>
<p>Beginning from initial definitions, a step-by-step derivation of the likelihood in Eq (<xref ref-type="disp-formula" rid="pcbi.1005852.e006">1</xref>), the marginal likelihood for the composition, and the Taylor Series approximation in Eq (<xref ref-type="disp-formula" rid="pcbi.1005852.e020">2</xref>).</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s002" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s002" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Detailed description of simulated datasets.</title>
<p>Descriptions of how the datasets were generated for both the challenging scenarios case and for the realistic data case.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s003" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s003" xlink:type="simple">
<label>S3 Text</label>
<caption>
<title>Implementation of methods compared.</title>
<p>Details on how each of the methods compared in the <bold>Results</bold> section were implemented, run on the simulated data, and evaluated for type I and type II errors.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s004" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s004" xlink:type="simple">
<label>S1 Data</label>
<caption>
<title>Simulated data for difficult scenarios.</title>
<p>The simulated data for each of four difficult simulation scenarios described in the <bold>Results</bold> section. For details on how these were generated, see <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s002">S2 Text</xref></bold>.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s005" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s005" xlink:type="simple">
<label>S2 Data</label>
<caption>
<title>Realistic simulated data.</title>
<p>All simulated datasets from sparseDOSSA, as well as the template dataset used. For details on how these were generated, see <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s002">S2 Text</xref></bold>.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s006" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s006" xlink:type="simple">
<label>S3 Data</label>
<caption>
<title>HMP taxonomic profiles.</title>
<p>The taxonomic profiles from the Human Microbiome Project data as processed with MetaPhlAn version 2.0_beta1 [<xref ref-type="bibr" rid="pcbi.1005852.ref024">24</xref>].</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s007" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>A relatively informative prior on λ is effective.</title>
<p>The densities of different priors on λ for different ranges of λ values. The shape parameter a determines how quickly the prior density decreasys, while the rate parameter b determines how much prior weight is placed on small λ values rather than large λ values.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s008" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Shrinkage increases for smaller λ.</title>
<p><bold>A</bold> The shape of the prior on o<sub>jk</sub> and o<sub>jj</sub> for several values of λ. Smaller λ results in greater shrinkage towards zero. <bold>B</bold>-<bold>C</bold> The prior probability in the interval (−0.001,0.001) for each off-diagonal element o<sub>jk</sub>| λ∼Laplace(λ) across small (<bold>B</bold>) or large (<bold>C</bold>) values of λ. Small values (&lt;0.1) of λ show the greatest shrinkage, while beyond λ = 1 the shrinkage becomes negligible, as shown by the maximal shrinkage for λ &gt; 0.2 being &lt;0.005.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s009" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Prior distributions for test cases.</title>
<p>The prior distributions for the test cases used a prior on <bold>m</bold> that was very uninformative, being centered at 0 and with a large variance. The prior on λ put most prior weight on λ values less than one and had narrow tails to encourage shrinkage of the correlation estimates (<bold>B</bold>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s010" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Prior distributions for realistic simulated data.</title>
<p>We used a prior for <bold>m</bold> that gave reasonable behavior for the sum of the unobserved count medians <inline-formula id="pcbi.1005852.e027"><alternatives><graphic id="pcbi.1005852.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:munderover><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>14</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (<bold>A</bold>). The prior on λ put most prior weight on λ values less than one and had narrow tails to encourage shrinkage of the correlation estimates (<bold>B</bold>). (See also <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s020">S14 Fig</xref></bold>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s011" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s011" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Additional results for difficult scenarios.</title>
<p>The estimates and significance of several methods on the four scenarios (columns): simple, with no true correlations and no negative dominant spurious correlation; high spurious, with no true correlations and a negative dominant spurious correlation; retained spike, with several true correlations and no negative dominant spurious correlation; and reversed spike, with several true correlations and a negative dominant spurious correlation. The top row is data-derived, with the bottom triangle indicating the true log-basis correlation <inline-formula id="pcbi.1005852.e028"><alternatives><graphic id="pcbi.1005852.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="bold">X</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and the top triangle the compositional correlation calcualted using the 1,000 samples from the data. BAnOCC evaluates significance using 95 % credible intervals. CCLAsso and SPIEC-EASI (MB) are significant if they are non-zero. SPIEC-EASI (MB) colors indicate the sign rather than the magnitude of the estimated correlations as the estimates are not possible to compute. SparCC evaluates significance using a bootstrap-based method. All the methods do poorly at detecting and correctly estimating the negative correlation between features 1 and 5 in the reversed spike scenario, and instead tend to falsely detect several positive correlations.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s012" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s012" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>AUC boxplots of method performance on “realistic” simulated datasets.</title>
<p>For each given correlation strength and template dataset, AUCs were calculated for each of 105 simulated datasets comprising sparseDOSSA-derived compositions with 100 samples modeled on a low-diversity dataset with 14 features. The ROCs used to measure the AUCs are based on p-values (Spearman correlation, simplicial variation, SparCC), credible intervals (BAnOCC), correlation estimate (CCLasso) or stability score (SPIEC-EASI). Thus each boxplot consists of 105 points. Each of the 105 AUCs are measured over seven true correlations, and all of the methods do better than expected by chance (red line), although BAnOCC has overall the highest average AUC.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s013" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s013" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Average ROC curves of method performance on “realistic” simulated datasets.</title>
<p>For a given correlation strength, each ROC is calculated over the aggregation of all 735 true associations in 105 simulated datasets comprising SparseDOSSA-derived compositions with 100 samples modeled on a low-diversity dataset with 14 features. The cutoffs used are based on p-values (Spearman correlation, simplicial variation, SparCC), credible interval width (BAnOCC), correlation estimate (CCLasso) or stability score (SPIEC-EASI).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s014" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s014" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Type I error rates and power in large datasets.</title>
<p>Results on simulated data comprising 100 SparseDOSSA-derived compositions modeled on a high-diversity dataset with 89 features. <bold>A</bold> Type I error rates are controlled across all correlation values only by BAnOCC. <bold>B</bold> Power is comparable between BAnOCC and other modern methods across spiked correlation strengths, with BAnOCC and others correctly controlling error rates and only BAnOCC providing full inference and probability distributions on the resulting microbial interaction networks. * = rejection of H<sub>0</sub> based on estimation; ** = rejection of H<sub>0</sub> based on inference from credible intervals; all others, rejection of H<sub>0</sub> based on inference from p-values. (See <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s022">S16 Fig</xref></bold> for the priors used.)</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s015" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s015" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Power across multiple sample sizes and numbers of features.</title>
<p>Power on simulated data comprising SparseDOSSA-derived compositions modeled on a low-diversity dataset with 14 features (small template) or a high-diversity dataset with 89 features (large template). See <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s002">S2 Text</xref></bold> for simulation details. The rows correspond to the number of samples (50, 100, or 150) simulated. BAnOCC controls the type I error rate in all scenarios, and the type I error rate behavior for most methods does not change with increasing sample size. * = rejection of H<sub>0</sub> based on estimation; ** = rejection of H<sub>0</sub> based on inference from credible intervals; all others, rejection of H<sub>0</sub> based on inference from p-values.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s016" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s016" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Type I error rates across multiple sample sizes and numbers of features.</title>
<p>Type I error rates on simulated data comprising SparseDOSSA-derived compositions modeled on a low-diversity dataset with 14 features (small template) or a high-diversity dataset with 89 features (large template). See <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s002">S2 Text</xref></bold> for simulation details. The rows correspond to the number of samples (50, 100, or 150) simulated. BAnOCC controls the type I error rate in all scenarios, and the type I error rate behavior for most methods does not change with increasing sample size. * = rejection of H<sub>0</sub> based on estimation; ** = rejection of H<sub>0</sub> based on inference from credible intervals; all others, rejection of H<sub>0</sub> based on inference from p-values.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s017" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s017" xlink:type="simple">
<label>S11 Fig</label>
<caption>
<title>Prior distributions for the stool body site.</title>
<p>We used a prior for <bold>m</bold> that gave reasonable behavior for the sum of the unobserved count medians <inline-formula id="pcbi.1005852.e029"><alternatives><graphic id="pcbi.1005852.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:munderover><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>24</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (<bold>A</bold>). The prior on λ put most prior weight on λ values less than one and had narrow tails to encourage shrinkage of the correlation estimates (<bold>B</bold>). (See also <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s020">S14 Fig</xref></bold>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s018" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s018" xlink:type="simple">
<label>S12 Fig</label>
<caption>
<title>Prior distributions for the buccal mucosa body site.</title>
<p>We used a prior for <bold>m</bold> that gave reasonable behavior for the sum of the unobserved count medians <inline-formula id="pcbi.1005852.e030"><alternatives><graphic id="pcbi.1005852.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:munderover><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (<bold>A</bold>). The prior on λ put most prior weight on λ values less than one and had narrow tails to encourage shrinkage of the correlation estimates (<bold>B</bold>). (See also <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s020">S14 Fig</xref></bold>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s019" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s019" xlink:type="simple">
<label>S13 Fig</label>
<caption>
<title>Prior distributions for the posterior fornix body site.</title>
<p>We used a prior for <bold>m</bold> that gave reasonable behavior for the sum of the unobserved count medians <inline-formula id="pcbi.1005852.e031"><alternatives><graphic id="pcbi.1005852.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:munderover><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (<bold>A</bold>). The prior on λ put most prior weight on λ values less than one and had narrow tails to encourage shrinkage of the correlation estimates (<bold>B</bold>). (See also <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s020">S14 Fig</xref></bold>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s020" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s020" xlink:type="simple">
<label>S14 Fig</label>
<caption>
<title>Implied priors on median unobserved counts.</title>
<p>The implied priors on the median unobserved counts <inline-formula id="pcbi.1005852.e032"><alternatives><graphic id="pcbi.1005852.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> (top panel) and the sum of the median unobserved counts <inline-formula id="pcbi.1005852.e033"><alternatives><graphic id="pcbi.1005852.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:munderover><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (bottom panel) for the SparseDOSSA simulated data and the body sites from the application. Each distribution is estimated using 100,000 random samples. The mean of m<sub>j</sub> was selected such that the sum of the median unobserved counts approximately shared the same average.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s021" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s021" xlink:type="simple">
<label>S15 Fig</label>
<caption>
<title>Comparison of inferred networks on HMP data.</title>
<p>The number of edges significant in both methods, neither method, or only one method, stratified by body site and whether the methods use the log-basis precision or correlation matrix. Most edges are concordantly significant (or not) between both methods; few are significant by only one method. Further, most of the edges significant in CCLasso but not BAnOCC are small in magnitude (BAnOCC not sig, CCLasso magnitude &lt; 0.1).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s022" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s022" xlink:type="simple">
<label>S16 Fig</label>
<caption>
<title>Prior distributions for large datasets.</title>
<p>For our larger datasets simulated based on a stool dataset with 89 features, we used a prior for <bold>m</bold> that gave reasonable behavior for the sum of the basis medians <inline-formula id="pcbi.1005852.e034"><alternatives><graphic id="pcbi.1005852.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005852.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:munderover><mml:mstyle displaystyle="false"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>89</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (<bold>A</bold>). The prior on λ put most prior weight on λ values less than one and had narrow tails to encourage shrinkage of the correlation estimates (<bold>B</bold>). (See also <bold><xref ref-type="supplementary-material" rid="pcbi.1005852.s020">S14 Fig</xref></bold>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s023" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s023" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>BAnOCC stool network.</title>
<p>The significant edges from running BAnOCC on the stool body site with 5,500 warmup iterations and 12,000 total iterations. Edges are ordered by posterior median correlation magnitude. “hpd.95.ci” indicates the highest posterior density 95% credible intervals.</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s024" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s024" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>BAnOCC buccal mucosa network.</title>
<p>The significant edges from running BAnOCC on the buccal mucosa body site with 5,500 warmup iterations and 12,000 total iterations. Edges are ordered by posterior median correlation magnitude. “hpd.95.ci” indicates the highest posterior density 95% credible intervals.</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005852.s025" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005852.s025" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>BAnOCC posterior fornix network.</title>
<p>The significant edges from running BAnOCC on the posterior fornix body site with 1,500 warmup iterations and 5,000 total iterations. Edges are ordered by posterior median correlation magnitude. “hpd.95.ci” indicates the highest posterior density 95% credible intervals.</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005852.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pearson</surname> <given-names>K</given-names></name>. <article-title>Mathematical contributions to the theory of evolution. III. regression, heredity, and panmixia</article-title>. <source>Philos Trans A Math Phys Eng Sci</source>. <year>1896</year>;<volume>187</volume>: <fpage>253</fpage>–<lpage>318</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Spearman</surname> <given-names>C</given-names></name>. <article-title>The proof and measurement of association between two things</article-title>. <source>The American Journal of Psychology</source>. <year>1904</year>;<volume>15</volume>: <fpage>72</fpage>–<lpage>101</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pearson</surname> <given-names>K</given-names></name>. <article-title>Mathematical contributions to the theory of evolution.–On a form of spurious correlation which may arise when indices are used in the measurement of organs</article-title>. <source>Proc R Soc Lond</source>. <year>1897</year>;<volume>60</volume>: <fpage>489</fpage>–<lpage>498</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chayes</surname> <given-names>FA</given-names></name>. <article-title>On correlation between variables of constant sum</article-title>. <source>J Geophys Res</source>. <year>1960</year>;<volume>65</volume>: <fpage>4185</fpage>–<lpage>4193</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chayes</surname> <given-names>FA</given-names></name>, <name name-style="western"><surname>Kruskal</surname> <given-names>W</given-names></name>. <article-title>Approximate statistical test for correlations between proportions</article-title>. <source>The Journal of Geology</source>. <year>1966</year>;<volume>74</volume>: <fpage>692</fpage>–<lpage>702</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aitchison</surname> <given-names>J</given-names></name>. <article-title>A new approach to null correlations of proportions</article-title>. <source>Math Geol</source>. <year>1981</year>;<volume>13</volume>: <fpage>175</fpage>–<lpage>189</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Faust</surname> <given-names>K.</given-names></name> and <name name-style="western"><surname>Sathirapongsasuti</surname> <given-names>F.</given-names></name>, <name name-style="western"><surname>Izard</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Segata</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Gevers</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Raes</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Huttenhower</surname> <given-names>C</given-names></name>. <article-title>Microbial co-occurrence relationships in the human microbiome</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>: <fpage>e1002606</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002606" xlink:type="simple">10.1371/journal.pcbi.1002606</ext-link></comment> <object-id pub-id-type="pmid">22807668</object-id></mixed-citation></ref>
<ref id="pcbi.1005852.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friedman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Alm</surname> <given-names>EJ</given-names></name>. <article-title>Inferring correlation networks from genomic survey data</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>: <fpage>e1002687</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002687" xlink:type="simple">10.1371/journal.pcbi.1002687</ext-link></comment> <object-id pub-id-type="pmid">23028285</object-id></mixed-citation></ref>
<ref id="pcbi.1005852.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Deng</surname> <given-names>M</given-names></name>. <article-title>CCLasso: Correlation inference for compositional data through lasso</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>: <fpage>3172</fpage>–<lpage>3180</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btv349" xlink:type="simple">10.1093/bioinformatics/btv349</ext-link></comment> <object-id pub-id-type="pmid">26048598</object-id></mixed-citation></ref>
<ref id="pcbi.1005852.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ban</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>An</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Jiang</surname> <given-names>H</given-names></name>. <article-title>Investigating microbial co-occurrence patterns based on metagenomic compositional data</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>: <fpage>3322</fpage>–<lpage>3329</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btv364" xlink:type="simple">10.1093/bioinformatics/btv364</ext-link></comment> <object-id pub-id-type="pmid">26079350</object-id></mixed-citation></ref>
<ref id="pcbi.1005852.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kurtz</surname> <given-names>ZD</given-names></name>, <name name-style="western"><surname>Müller</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Miraldi</surname> <given-names>ER</given-names></name>, <name name-style="western"><surname>Littman</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Blaser</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Bonneau</surname> <given-names>RA</given-names></name>. <article-title>Sparse and compositionally robust inference of microbial ecological networks</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>: <fpage>1</fpage>–<lpage>25</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shah</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Samworth</surname> <given-names>RJ</given-names></name>. <article-title>Variable selection with error control: Another look at stability selection</article-title>. <source>J R Stat Soc Series B Stat Methodol</source>. <year>2013</year>;<volume>75</volume>: <fpage>55</fpage>–<lpage>80</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>H</given-names></name>. <article-title>Bayesian graphical lasso models and efficient posterior computation</article-title>. <source>Bayesian Anal</source>. <year>2012</year>;<volume>7</volume>: <fpage>867</fpage>–<lpage>886</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Preston</surname> <given-names>FW</given-names></name>. <article-title>The commonness, and rarity, of species</article-title>. <source>Ecology</source>. <year>1948</year>;<volume>29</volume>: <fpage>254</fpage>–<lpage>283</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Magurran</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Henderson</surname> <given-names>PA</given-names></name>. <article-title>Explaining the excess of rare species in natural species abundance distributions</article-title>. <source>Nature</source>. <year>2003</year>;<volume>422</volume>: <fpage>714</fpage>–<lpage>716</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature01547" xlink:type="simple">10.1038/nature01547</ext-link></comment> <object-id pub-id-type="pmid">12700760</object-id></mixed-citation></ref>
<ref id="pcbi.1005852.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koren</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Knights</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Gonzalez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Waldron</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Segata</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Knight</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>A guide to enterotypes across the human body: Meta-analysis of microbial community structures in human microbiome datasets</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year>;<volume>9</volume>: <fpage>1</fpage>–<lpage>16</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Paulson</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Stine</surname> <given-names>OC</given-names></name>, <name name-style="western"><surname>Bravo</surname> <given-names>HC</given-names></name>, <name name-style="western"><surname>Pop</surname> <given-names>M</given-names></name>. <article-title>Differential abundance analysis for microbial marker-gene surveys</article-title>. <source>Nat Meth</source>. <year>2013</year>;<volume>10</volume>: <fpage>1200</fpage>–<lpage>1202</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mitchell</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Beauchamp</surname> <given-names>JJ</given-names></name>. <article-title>Bayesian variable selection in linear regression</article-title>. <source>J Am Stat Assoc</source>. <year>1988</year>;<volume>83</volume>: <fpage>1023</fpage>–<lpage>1032</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mallick</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Yi</surname> <given-names>N</given-names></name>. <article-title>Bayesian methods for high dimensional linear models</article-title>. <source>J Biom Biostat</source>. <year>2013</year>;<volume>1</volume>: <fpage>005</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4172/2155-6180.S1-005" xlink:type="simple">10.4172/2155-6180.S1-005</ext-link></comment> <object-id pub-id-type="pmid">24511433</object-id></mixed-citation></ref>
<ref id="pcbi.1005852.ref020"><label>20</label><mixed-citation publication-type="other" xlink:type="simple">Stan Development Team. RStan: the R interface to Stan, version 2.6.0 2014. Available: <ext-link ext-link-type="uri" xlink:href="http://mc-stan.org/rstan.html" xlink:type="simple">http://mc-stan.org/rstan.html</ext-link></mixed-citation></ref>
<ref id="pcbi.1005852.ref021"><label>21</label><mixed-citation publication-type="other" xlink:type="simple">Ren B, Schwager E, Tickle TL, Huttenhower C. SparseDOSSA: Sparse data observations for simulating synthetic abundance. 2016. Available: <ext-link ext-link-type="uri" xlink:href="https://huttenhower.sph.harvard.edu/sparsedossa" xlink:type="simple">https://huttenhower.sph.harvard.edu/sparsedossa</ext-link></mixed-citation></ref>
<ref id="pcbi.1005852.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><collab>The Human Microbiome Consortium</collab>. <article-title>Structure, function and diversity of the healthy human microbiome</article-title>. <source>Nature</source>. <year>2012</year>;<volume>486</volume>: <fpage>207</fpage>–<lpage>214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature11234" xlink:type="simple">10.1038/nature11234</ext-link></comment> <object-id pub-id-type="pmid">22699609</object-id></mixed-citation></ref>
<ref id="pcbi.1005852.ref023"><label>23</label><mixed-citation publication-type="other" xlink:type="simple">Aitchison J. A concise guide to compositional data analysis. 2nd compositional data analysis workshop. 2003.</mixed-citation></ref>
<ref id="pcbi.1005852.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Truong</surname> <given-names>DT</given-names></name>, <name name-style="western"><surname>Franzosa</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Tickle</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Scholz</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Weingart</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Pasolli</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>MetaPhlAn2 for enhanced metagenomic taxonomic profiling</article-title>. <source>Nat Meth</source>. <year>2015</year>;<volume>12</volume>: <fpage>902</fpage>–<lpage>903</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rajilić-Stojanović</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Vos</surname> <given-names>WM de</given-names></name>. <article-title>The first 1000 cultured species of the human gastrointestinal microbiota</article-title>. <source>FEMS Microbiol Rev</source>. Oxford, UK; <year>2014</year>;<volume>38</volume>: <fpage>996</fpage>–<lpage>1047</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/1574-6976.12075" xlink:type="simple">10.1111/1574-6976.12075</ext-link></comment> <object-id pub-id-type="pmid">24861948</object-id></mixed-citation></ref>
<ref id="pcbi.1005852.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Barberán</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bates</surname> <given-names>ST</given-names></name>, <name name-style="western"><surname>Casamayor</surname> <given-names>EO</given-names></name>, <name name-style="western"><surname>Fierer</surname> <given-names>N</given-names></name>. <article-title>Using network analysis to explore co-occurrence patterns in soil microbial communities</article-title>. <source>ISME J</source>. <year>2012</year>;<volume>6</volume>: <fpage>343</fpage>–<lpage>351</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ismej.2011.119" xlink:type="simple">10.1038/ismej.2011.119</ext-link></comment> <object-id pub-id-type="pmid">21900968</object-id></mixed-citation></ref>
<ref id="pcbi.1005852.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kolenbrander</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Palmer</surname> <given-names>RJ</given-names> <suffix>Jr</suffix></name>, <name name-style="western"><surname>Periasamy</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Jakubovics</surname> <given-names>NS</given-names></name>. <article-title>Oral multispecies biofilm development and the key role of cell–cell distance</article-title>. <source>Nat Rev Micro</source>. <year>2010</year>;<volume>8</volume>: <fpage>471</fpage>–<lpage>480</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gajer</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Brotman</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Bai</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Sakamoto</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schütte</surname> <given-names>UME</given-names></name>, <name name-style="western"><surname>Zhong</surname> <given-names>X</given-names></name>, <etal>et al</etal>. <article-title>Temporal dynamics of the human vaginal microbiota</article-title>. <source>Sci Transl Med</source>. <year>2012</year>;<volume>4</volume>: <fpage>132ra52</fpage>–<lpage>132ra52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/scitranslmed.3003605" xlink:type="simple">10.1126/scitranslmed.3003605</ext-link></comment> <object-id pub-id-type="pmid">22553250</object-id></mixed-citation></ref>
<ref id="pcbi.1005852.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rasko</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Rosovitz</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>GSA</given-names></name>, <name name-style="western"><surname>Mongodin</surname> <given-names>EF</given-names></name>, <name name-style="western"><surname>Fricke</surname> <given-names>WF</given-names></name>, <name name-style="western"><surname>Gajer</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>The pangenome structure of <italic>escherichia coli</italic>: Comparative genomic analysis of e. coli commensal and pathogenic isolates</article-title>. <source>J Bacteriol</source>. <year>2008</year>;<volume>190</volume>: <fpage>6881</fpage>–<lpage>6893</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/JB.00619-08" xlink:type="simple">10.1128/JB.00619-08</ext-link></comment> <object-id pub-id-type="pmid">18676672</object-id></mixed-citation></ref>
<ref id="pcbi.1005852.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hogg</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Hu</surname> <given-names>FZ</given-names></name>, <name name-style="western"><surname>Janto</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Boissy</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Hayes</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Keefe</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Characterization and modeling of the <italic>haemophilus influenzae</italic> core and supragenomes based on the complete genomic sequences of Rd and 12 clinical nontypeable strains</article-title>. <source>Genome Biol</source>. <year>2007</year>;<volume>8</volume>: <fpage>R103</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/gb-2007-8-6-r103" xlink:type="simple">10.1186/gb-2007-8-6-r103</ext-link></comment> <object-id pub-id-type="pmid">17550610</object-id></mixed-citation></ref>
<ref id="pcbi.1005852.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Arthur</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Perez-Chanona</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Mühlbauer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tomkovich</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Uronis</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Fan</surname> <given-names>T-J</given-names></name>, <etal>et al</etal>. <article-title>Intestinal inflammation targets cancer-inducing activity of the microbiota</article-title>. <source>Science</source>. <year>2012</year>;<volume>338</volume>: <fpage>120</fpage>–<lpage>123</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1224820" xlink:type="simple">10.1126/science.1224820</ext-link></comment> <object-id pub-id-type="pmid">22903521</object-id></mixed-citation></ref>
<ref id="pcbi.1005852.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>N</given-names></name>. <article-title>The bayesian elastic net</article-title>. <source>Bayesian Anal</source>. <year>2010</year>;<volume>5</volume>: <fpage>151</fpage>–<lpage>170</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carvalho</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Polson</surname> <given-names>NG</given-names></name>, <name name-style="western"><surname>Scott</surname> <given-names>JG</given-names></name>. <article-title>The horseshoe estimator for sparse signals</article-title>. <source>Biometrika</source>. <year>2010</year>;<volume>97</volume>: <fpage>465</fpage>–<lpage>480</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dawid</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Lauritzen</surname> <given-names>SL</given-names></name>. <article-title>Hyper markov laws in the statistical analysis of decomposable graphical models</article-title>. <source>The Annals of Statistics</source>. <year>1993</year>;<volume>21</volume>: <fpage>1272</fpage>–<lpage>1317</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005852.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wong</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Carter</surname> <given-names>CK</given-names></name>, <name name-style="western"><surname>Kohn</surname> <given-names>R</given-names></name>. <article-title>Efficient estimation of covariance selection models</article-title>. <source>Biometrika</source>. <year>2003</year>;<volume>90</volume>: <fpage>809</fpage>–<lpage>830</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>