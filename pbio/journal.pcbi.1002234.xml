<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PCOMPBIOL-D-11-00301</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1002234</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Biochemistry</subject>
          </subj-group>
          <subj-group>
            <subject>Computational biology</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Computational Biology</subject>
          <subject>Biochemistry</subject>
          <subject>Mathematics</subject>
        </subj-group>
      </article-categories><title-group><article-title>Near-Native Protein Loop Sampling Using Nonparametric Density Estimation Accommodating Sparcity</article-title><alt-title alt-title-type="running-head">DPM-HMM Loop Modeling</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
          <name name-style="western">
            <surname>Joo</surname>
            <given-names>Hyun</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
          <name name-style="western">
            <surname>Chavan</surname>
            <given-names>Archana G.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Day</surname>
            <given-names>Ryan</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Lennox</surname>
            <given-names>Kristin P.</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Sukhanov</surname>
            <given-names>Paul</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Dahl</surname>
            <given-names>David B.</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Vannucci</surname>
            <given-names>Marina</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Tsai</surname>
            <given-names>Jerry</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Chemistry, University of the Pacific, Stockton, California, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Statistics, Texas A&amp;M University, College Station, Texas, United States of America</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Department of Statistics, Rice University, Houston, Texas, United States of America</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Levitt</surname>
            <given-names>Michael</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">Stanford University, United States of America</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">jtsai@pacific.edu</email></corresp>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: HJ RD KPL DBD MV JT. Performed the experiments: HJ AGC RD KPL PS. Analyzed the data: HJ AGC RD PS. Contributed reagents/materials/analysis tools: HJ AGC RD KPL DBD MV JT. Wrote the paper: HJ AGC RD PS JT.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <month>10</month>
        <year>2011</year>
      </pub-date><pub-date pub-type="epub">
        <day>20</day>
        <month>10</month>
        <year>2011</year>
      </pub-date><volume>7</volume><issue>10</issue><elocation-id>e1002234</elocation-id><history>
        <date date-type="received">
          <day>3</day>
          <month>3</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>1</day>
          <month>9</month>
          <year>2011</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2011</copyright-year><copyright-holder>Joo et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>Unlike the core structural elements of a protein like regular secondary structure, template based modeling (TBM) has difficulty with loop regions due to their variability in sequence and structure as well as the sparse sampling from a limited number of homologous templates. We present a novel, knowledge-based method for loop sampling that leverages homologous torsion angle information to estimate a continuous joint backbone dihedral angle density at each loop position. The φ,ψ distributions are estimated via a Dirichlet process mixture of hidden Markov models (DPM-HMM). Models are quickly generated based on samples from these distributions and were enriched using an end-to-end distance filter. The performance of the DPM-HMM method was evaluated against a diverse test set in a leave-one-out approach. Candidates as low as 0.45 Å RMSD and with a worst case of 3.66 Å were produced. For the canonical loops like the immunoglobulin complementarity-determining regions (mean RMSD &lt;2.0 Å), the DPM-HMM method performs as well or better than the best templates, demonstrating that our automated method recaptures these canonical loops without inclusion of any IgG specific terms or manual intervention. In cases with poor or few good templates (mean RMSD &gt;7.0 Å), this sampling method produces a population of loop structures to around 3.66 Å for loops up to 17 residues. In a direct test of sampling to the Loopy algorithm, our method demonstrates the ability to sample nearer native structures for both the canonical CDRH1 and non-canonical CDRH3 loops. Lastly, in the realistic test conditions of the CASP9 experiment, successful application of DPM-HMM for 90 loops from 45 TBM targets shows the general applicability of our sampling method in loop modeling problem. These results demonstrate that our DPM-HMM produces an advantage by consistently sampling near native loop structure. The software used in this analysis is available for download at <ext-link ext-link-type="uri" xlink:href="http://www.stat.tamu.edu/~dahl/software/cortorgles/" xlink:type="simple">http://www.stat.tamu.edu/~dahl/software/cortorgles/</ext-link>.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>A protein's structure consists of elements of regular secondary structure connected by less regular stretches of loop segments. The irregularity of the loop structure makes loop modeling quite challenging. More accurate sampling of these loop conformations has a direct impact on protein modeling, design, function classification, as well as protein interactions. A method has been developed that extends a more comprehensive knowledge-based approach to producing models of the loop regions of protein structure. Most physical models cannot adequately sample the large conformational space, while the more discrete knowledge based libraries are conformationally limited. To address both of these problems, we introduce a novel statistical method that produces a continuous yet weighted estimation of loop conformational space from a discrete library of structures by using a Dirichlet process mixture of hidden Markov models (DPM-HMM). Applied to loop structure sampling, the results of a number of tests demonstrate that our approach quickly generates large numbers of candidates with near native loop conformations. Most significantly, in the cases where the template sampling is sparse and/or far from native conformations, the DPM-HMM method samples close to the native space and produces a population of accurate loop structures.</p>
      </abstract><funding-group><funding-statement>This work was suppported by an National Institutes of Health National Institute of General Medicine grant R01 GM81631. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="14"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Starting from a known structural homolog, template based modeling (TBM) of protein structure provides the most accurate predictions of protein sequences with unknown structure <xref ref-type="bibr" rid="pcbi.1002234-Qu1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Petrey1">[2]</xref>. However, even with close structural homologs, structurally variable regions (SVRs), commonly referred to as loops, are the worst predicted segments <xref ref-type="bibr" rid="pcbi.1002234-Venclovas1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Fiser1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Kryshtafovych1">[5]</xref>. Because loop regions join elements of regular secondary structures and often play an important role in active site composition, ligand binding, and protein-protein interactions, accurate sampling is integral to a useful TBM prediction of protein structure. Structurally, loops often lie on the solvent-exposed surface of proteins, allowing them more conformational flexibility and susceptibility to insertions and deletions. This variability makes loop regions notoriously difficult to align at both the sequence and structural level, which often results in large stretches of gapped positions. As an added level of complexity, the conformational space is usually poorly populated due to the low structural homologs. This variability and sparsity of data pose much of the challenge in modeling with current approaches, and these problems increase with loop length.</p>
      <p>Typically, loop-modeling methods have adopted one of two general strategies, <italic>de novo</italic> and knowledge-based loop modeling methods. In <italic>de novo</italic> loop modeling <xref ref-type="bibr" rid="pcbi.1002234-Fiser1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Fine1">6</xref>, physico-chemical based principles are used to compute the lowest energy conformations for a loop <xref ref-type="bibr" rid="pcbi.1002234-Bruccoleri1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Shenkin1">[8]</xref>. In successful applications to short loop modeling, <italic>de novo</italic> methods include molecular dynamics simulations <xref ref-type="bibr" rid="pcbi.1002234-Hornak1">[9]</xref>, simulated annealing <xref ref-type="bibr" rid="pcbi.1002234-Fiser1">[4]</xref>, buildup from discretized φ,ψ pairs <xref ref-type="bibr" rid="pcbi.1002234-Jacobson1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-DePristo1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Deane1">[12]</xref>, and ‘random tweak’ <xref ref-type="bibr" rid="pcbi.1002234-Shenkin1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Xiang1">[13]</xref>. However, these methods are limited because they require significant computational resources to sample near-native conformations. Alternatively, the loops in some proteins can be classified into structural families or canonical types, as in the antibody hypervariable regions (complementarity determining regions or CDRs) <xref ref-type="bibr" rid="pcbi.1002234-Martin1">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Michalsky1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Martin2">[16]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Chothia1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Morea1">[18]</xref>. Such knowledge-based schemes utilize known structures or fragments of structures to efficiently sample loop conformations, <xref ref-type="bibr" rid="pcbi.1002234-Wojcik1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Sudarsanam1">[20]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Soto1">[21]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Zhu1">[22]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Lee1">[23]</xref>, but are limited to sampling within the knowledge base. Using large databases of supersecondary structures <xref ref-type="bibr" rid="pcbi.1002234-Espadaler1">[24]</xref>, loops are successively aligned with templates based on parameters such as the stem region geometry, length, and sequence similarity <xref ref-type="bibr" rid="pcbi.1002234-Fiser2">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Oliva1">[26]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Peng1">[27]</xref>. While the strategies in various methods differ in many respects, the fundamental idea is to efficiently sample the available conformational space for loops of the particular length, and then score the samples using various energy functions <xref ref-type="bibr" rid="pcbi.1002234-Bruccoleri1">[7]</xref>. The modeling of longer loops up to 13 residues in length has been achieved using exhaustive sampling of φ,ψ space with clustering and energy minimization <xref ref-type="bibr" rid="pcbi.1002234-Zhu2">[28]</xref>. In addition, there are approaches that combine the use of loop databases and physical-based algorithms <xref ref-type="bibr" rid="pcbi.1002234-Rohl1">[29]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-vanVlijmen1">[30]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Liu1">[31]</xref> as well as methods sampling loop libraries that focus on loop closure <xref ref-type="bibr" rid="pcbi.1002234-Boomsma1">[32]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Canutescu1">[33]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Boomsma2">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Rosenbach1">[35]</xref>. For all methods leveraging information from known structures, sampling is limited to the discrete conformational space represented in the structural library. While providing efficient sampling, this approach poses difficulties in completely representing the structural variability of a loop region.</p>
      <p>To address these obstacles in sampling of loop models, a novel statistical method has been developed that implements a Dirichlet process mixture of hidden Markov models (DPM-HMM) <xref ref-type="bibr" rid="pcbi.1002234-Lennox1">[36]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Lennox2">[37]</xref> for continuous density estimation of φ,ψ residue torsion angles in the loop region. This statistical modeling not only retains the advantages of utilizing information from homologous proteins but also provides the continuous sampling of conformational space allowed by physico-chemical methods. From the sparse sampling at each loop position, the DPM-HMM method computes a joint φ,ψ density using statistical inferences from neighboring residues to make probable estimations of a continuous probability. The approach uses the φ,ψ data from homologous loops to model the joint φ,ψ distributions at each loop alignment position. The results are continuous density estimations of each residue's Ramachandran space, which allows sampling from a wider range of φ,ψ values than the discrete possibilities using a loop library <xref ref-type="bibr" rid="pcbi.1002234-Bruccoleri1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Jacobson1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Deane1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Zhu2">[28]</xref>, yet the distribution is informed by the homologous loops. A related statistical method with a different formulation called DBN-torus has been concurrently developed by Boomsma <italic>et. al.</italic> <xref ref-type="bibr" rid="pcbi.1002234-Boomsma2">[34]</xref> for the modeling of fragments in template-free protein structure prediction. Unlike the specificity of this method for fragment generation, our approach is tailored for TBM and produces nearer native loop samples even when good templates are not available. Moreover, the DPM-HMM method allows fast, knowledge-based sampling of backbone torsion angles focused within probable regions of φ,ψ space <xref ref-type="bibr" rid="pcbi.1002234-Lennox1">[36]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Lennox2">[37]</xref>. In this study, the ability of the DPM-HMM approach to sample near-native candidates is demonstrated in the modeling of loops from the following three groups: (1) canonical and non-canonical hypervariable loops within the heavy chain complementarity-determining regions (CDRHs) of immunoglobulins, (2) the conserved EF loop from the globin fold, and (3) the loops of CASP9 targets. Examples of these are shown in <xref ref-type="fig" rid="pcbi-1002234-g001">Figure 1</xref>. Sampling near native loop conformations was tested in leave one out (LOO) approach and general applicability of the method is demonstrated with the results for loop modeling of TBM targets from CASP9 experiment. Also, the performance of DPM-HMM method was compared with LoopyMod by using CDRH1 and CDRH3 data sets.</p>
      <fig id="pcbi-1002234-g001" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002234.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>The 465 loop data set.</title>
          <p>Global superposition data set of 465 loops used to test sampling. All representations are in backbone cartoon. (<bold>a</bold>) 111 target loops from CDRH1 (12 residues), (<bold>b</bold>) 130 target loops from CDRH2 (7, 8 and 10 residues), (<bold>c</bold>) 111 target loops from CDRH3 (8, 10–17 residues), (<bold>d</bold>) 21 loops from CASP9 target, T0617 (12 residues), and (<bold>e</bold>) 92 globin EF loops (12, 13 and 15 residues).</p>
        </caption>
        <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002234.g001" xlink:type="simple"/>
      </fig>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <p>In the following sections, the DPM-HMM density estimation approach is shown to sample near native loop conformations in various classes of loop prediction difficulty. To simplify our discussion, the difficulty of prediction is classified based on the global RMSD of the closest known template to the native loop structure. Loops in the canonical class have templates that are less than 2 Å to the native structure. The common classes include templates that are 2–4 Å to the native loop conformation, although these are by no means simple to predict. Difficult loops are those that have templates greater than 4 Å and in many cases contain fewer than 10 templates to model.</p>
      <sec id="s2a">
        <title>φ,ψ Distributions</title>
        <p>At the heart of our approach is the DPM-HMM density estimation of the backbone φ,ψ angles <xref ref-type="bibr" rid="pcbi.1002234-Lennox1">[36]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Lennox2">[37]</xref>, and the method's ability to correctly model the torsion angle space helps to explain our success or failure in modeling particular targets in our LOO tests. <xref ref-type="fig" rid="pcbi-1002234-g002">Figure 2</xref> shows four examples of Ramachandran plots <xref ref-type="bibr" rid="pcbi.1002234-Ramachandran1">[38]</xref> taken from predictions of targets from the CDRH2 loops. Our method uses the normalized φ,ψ data from template loops <xref ref-type="bibr" rid="pcbi.1002234-Dahl1">[39]</xref> as a prior or basis for its density estimations (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>) of the probability distributions. As shown by the scattered points in <xref ref-type="fig" rid="pcbi-1002234-g002">Figure 2</xref>, the backbone φ,ψ angles from the templates provides the raw data that combine with the prior to produce the estimated distributions shown as contour lines in the plots. In a number of cases our statistical estimation of density performed well, as evidenced by the presence of the native, target φ,ψ pair (shown as a red point in <xref ref-type="fig" rid="pcbi-1002234-g002">Figure 2</xref>) being predicted within the highest probability regions. Panels (a) and (c) in <xref ref-type="fig" rid="pcbi-1002234-g002">Figure 2</xref> show the native φ,ψ pair within the highest region of estimated density. For <xref ref-type="fig" rid="pcbi-1002234-g002">Figure 2a</xref>, the observed result is expected as these positions hold the anchoring residues for CDRH2, which are consistently in the β-sheet region of the Ramachandran plot. As can be seen in <xref ref-type="fig" rid="pcbi-1002234-g002">Figure 2c</xref>, certain positions heavily favor the left-handed helical region. This method's success in loop prediction corresponds well with density plots that contain a majority of residues with highest density around the native φ,ψ pair. By contrast, panels (b) and (d) in <xref ref-type="fig" rid="pcbi-1002234-g002">Figure 2</xref> show instances in which the native φ,ψ resides in a lower probability region of our density estimates. <xref ref-type="fig" rid="pcbi-1002234-g002">Figure 2b</xref> shows a residue sampling the second highest region of a left-handed helix. In <xref ref-type="fig" rid="pcbi-1002234-g002">Figure 2d</xref>, unlike the majority residues that populate the β-sheet region, the glycine residue at the anchor position after the CDRH2 loop exhibits φ,ψ values in the commonly disallowed lower right quadrant of the Ramachandran plot. Because our density estimation model does not exclude but places a lower probability distribution in this region, these positions in the loop are more of a challenge to our sampling and helps to explain the prediction limit of 3.66 Å for poor/sparse input data described below.</p>
        <fig id="pcbi-1002234-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002234.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Density estimations of φ,ψ distributions.</title>
            <p>Examples of DPM-HMM estimated backbone dihedral angle density distributions at various positions of targets from predictions of the CDRH2 loop and anchor residues. The grey dots represent the observed φ,ψ input data at a particular alignment position. The contour lines represent the calculated density estimation calculated from the φ,ψ pair data. The red dots indicate the actual φ,ψ values of the target structure. Position refers to the place in the modeled loop and the PDB code refers to the predicted target. (<bold>a</bold>) position 1 of 1mfa <xref ref-type="bibr" rid="pcbi.1002234-Zdanov1">[55]</xref>, (<bold>b</bold>) position 6 of 1w72 <xref ref-type="bibr" rid="pcbi.1002234-Hulsmeyer1">[56]</xref>, (<bold>c</bold>) position of 6 for 1gig <xref ref-type="bibr" rid="pcbi.1002234-Bizebard1">[57]</xref> and (<bold>d</bold>) position 9 (last anchor residue) of 1rmf <xref ref-type="bibr" rid="pcbi.1002234-Jedrzejas1">[58]</xref>.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002234.g002" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2b">
        <title>Global RMSD Comparisons</title>
        <p>Instead of a measure based just on Cα atoms, root mean squared deviations (RMSDs) were calculated using all of the main-chain heavy atoms between the candidates and the native target to analyze the data and measure the accuracy of the prediction (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). In addition, we performed global superposition of the loop fragments on the protein structure to calculate the RMSD between the models and the reference structure, which is a departure from the more commonly used local superposition that is independent of the overall protein structure. A local superposition of the loop candidates certainly produces lower average RMSD values to the reference structure as loop fragments often fit well locally to the reference, but the loop might not be the best candidate due to lever arm effects in the take off and landing residues. In contrast, while a global superposition will always yield a higher value for RMSD than local superposition as pointed out by Choi <italic>et. al.</italic> <xref ref-type="bibr" rid="pcbi.1002234-Choi1">[40]</xref> assessing loop accuracy in the global context of the protein structure properly reproduces modeling conditions, where the native loop or overall structure is not known and loops are placed onto a backbone template. <xref ref-type="fig" rid="pcbi-1002234-g003">Figure 3</xref> demonstrates the accuracy of global over local alignment in providing a more realistic measure to evaluate loop modeling. In both parts of <xref ref-type="fig" rid="pcbi-1002234-g003">Figure 3</xref>, the same 97 candidates of a loop for CASP9 target T0617, whose average Cα distance for C-terminal anchor is below 1.0 Å, are either locally (<xref ref-type="fig" rid="pcbi-1002234-g003">Figure 3a</xref>) or globally (<xref ref-type="fig" rid="pcbi-1002234-g003">Figure 3b</xref>) superposed to the native target crystal structure depicted by a thicker red backbone trace. Comparing <xref ref-type="fig" rid="pcbi-1002234-g003">Figures 3a</xref> with 3b, local superposition of the 97 candidates produces a much smaller spread over a global superposition. The average RMSD proves this observation: 1.86 Å for local superposition opposed to 3.17 Å for global superposition. However, the most significant difference occurs at the take-off and landing positions. In the local superposition, the variation around the ends is larger, whereas in the global superposition, it is quite small. Comparing the closest candidates by both methods demonstrates the importance of using global superposition. The blue line is the best candidate by local superposition, which has a local RMSD of 0.58 Å yet a global RMSD of 1.10 Å. So, while this candidate looks to be the best match in <xref ref-type="fig" rid="pcbi-1002234-g003">Figure 3a</xref>, this loop would not be the best fit on the protein structure as shown in <xref ref-type="fig" rid="pcbi-1002234-g003">Figure 3b</xref>. It can be seen that even though the first N-terminal residue (anchoring residue) coordinates are shared between the target and all candidates, the overall orientations of the loops are very diverse. The green backbone is the best overall loop candidate found by global superposition at a RMSD of 0.77 Å (<xref ref-type="fig" rid="pcbi-1002234-g003">Figure 3b</xref>), which is closer to the red native backbone than the top loop selected by local superposition. This candidate would have been missed in a local superposition with a RMSD of 0.65 Å. By not considering the fit of the loop onto the structure, local superposition accuracy is misleading and impractical in TBM as loops need to be evaluated in the context of a complete structure. Therefore, even though the RMSD values are higher for global superpositioning, the comparison stays truer to real prediction situations where the loop is being matched onto the body of model structure.</p>
        <fig id="pcbi-1002234-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002234.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Local versus global superposition.</title>
            <p>The 97 candidate loops below 1 Å average Cα–Cα termini distance cutoff for the target loop 3bpx from dataset T0617, showing various orientations of the candidate loops (grey) in backbone Cα trace. Reference loop is shown in red stick representation. The best candidate by local superposition in blue and best candidate by global superposition is shown as green. (<bold>a</bold>) Local superposition of candidate loops to the reference crystal structure with average local RMSD of 1.86 Å. (<bold>b</bold>) Candidate loops are superposed only at the take-off region (first residue at N-terminus) of the loop. Average global RMSD of candidates to the reference crystal structure is 3.17 Å.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002234.g003" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2c">
        <title>Sampling Efficiency</title>
        <p>The DPM-HMM method is able to produce consistent results across the various types of loop targets. In our LOO tests modeling the 465 loop data set (<xref ref-type="table" rid="pcbi-1002234-t001">Table 1</xref>), the low mean global RMSDs for the best candidates shown in <xref ref-type="table" rid="pcbi-1002234-t001">Table 1</xref> demonstrate that our method performs well at sampling near-native loop candidates. To provide more details about the DPM-HMM's performance, sampling accuracy was measured by comparing the global RMSD of the best sampled candidate to that of the best template from the discrete set of template loop structures (<xref ref-type="fig" rid="pcbi-1002234-g004">Figure 4</xref>). The best template is the one with lowest global RMSD to the target native loop segment. In <xref ref-type="fig" rid="pcbi-1002234-g004">Figure 4</xref>, the points below the diagonal line indicate loops our method modeled better than the best available template (best candidate's RMSD is lower than that of the best template). The DPM-HMM method performs consistently well for common targets with templates averaging between 3 to 4 Å RMSD and even for the difficult targets with a mean template RMSD above 7 Å. Of all the 465 targets predicted by the DPM-HMM method, the best candidate global RMSDs are in the range from 0.45 Å to a top value of 3.66 Å, regardless of the loop length, number of templates, and the quality of the templates. So, we can reliably say that our method samples loop conformations at least within 3.66 Å to the native.</p>
        <fig id="pcbi-1002234-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002234.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>DPM-HMM Sampling performance.</title>
            <p>RMSD of the best candidate versus RMSD of the best template. The diagonal line is unity. Points below the line indicate predictions better than the best template. The inset shows the percentage of better and worse predictions in each RMSD bin. When the RMSD of the best templates are below 1 Å, the chances our methods improve the loop are about 38%. When they are between in 1–2 Å, the chances are higher than 75%. In the 2–3 Å range, chances of improvement are higher than 93%. For higher than 3 Å, the loop structures are always improved.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002234.g004" xlink:type="simple"/>
        </fig>
        <table-wrap id="pcbi-1002234-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002234.t001</object-id><label>Table 1</label><caption>
            <title>Loop modeling template datasets and accuracy measure (RMSD) for the sampled candidates.</title>
          </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002234-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002234.t001" xlink:type="simple"/><table>
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" colspan="1" rowspan="1">LOOP</td>
                <td align="left" colspan="1" rowspan="1">Length (AA)</td>
                <td align="left" colspan="1" rowspan="1">Targets</td>
                <td align="left" colspan="3" rowspan="1">Templates' Average RMSD</td>
                <td align="left" colspan="1" rowspan="1">Best RMSD<xref ref-type="table-fn" rid="nt105">d</xref></td>
                <td align="left" colspan="1" rowspan="1">Average Best RMSD<xref ref-type="table-fn" rid="nt106">e</xref></td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">Min<xref ref-type="table-fn" rid="nt102">a</xref></td>
                <td align="left" colspan="1" rowspan="1">Max<xref ref-type="table-fn" rid="nt103">b</xref></td>
                <td align="left" colspan="1" rowspan="1">Average<xref ref-type="table-fn" rid="nt104">c</xref></td>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1"/>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>CDRH1</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">12</td>
                <td align="left" colspan="1" rowspan="1">111</td>
                <td align="left" colspan="1" rowspan="1">2.35</td>
                <td align="left" colspan="1" rowspan="1">2.44</td>
                <td align="left" colspan="1" rowspan="1">2.42(0.01)</td>
                <td align="left" colspan="1" rowspan="1">0.61</td>
                <td align="left" colspan="1" rowspan="1">1.04(0.28)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>CDRH2</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">7</td>
                <td align="left" colspan="1" rowspan="1">30</td>
                <td align="left" colspan="1" rowspan="1">1.49</td>
                <td align="left" colspan="1" rowspan="1">1.61</td>
                <td align="left" colspan="1" rowspan="1">1.58(0.02)</td>
                <td align="left" colspan="1" rowspan="1">0.45</td>
                <td align="left" colspan="1" rowspan="1">0.62(0.20)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">8</td>
                <td align="left" colspan="1" rowspan="1">87</td>
                <td align="left" colspan="1" rowspan="1">2.49</td>
                <td align="left" colspan="1" rowspan="1">2.69</td>
                <td align="left" colspan="1" rowspan="1">2.68(0.02)</td>
                <td align="left" colspan="1" rowspan="1">0.54</td>
                <td align="left" colspan="1" rowspan="1">0.84(0.19)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">10</td>
                <td align="left" colspan="1" rowspan="1">13</td>
                <td align="left" colspan="1" rowspan="1">1.97</td>
                <td align="left" colspan="1" rowspan="1">2.88</td>
                <td align="left" colspan="1" rowspan="1">2.75(0.24)</td>
                <td align="left" colspan="1" rowspan="1">0.50</td>
                <td align="left" colspan="1" rowspan="1">0.81(0.16)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>CDRH3</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">8</td>
                <td align="left" colspan="1" rowspan="1">13</td>
                <td align="left" colspan="1" rowspan="1">2.26</td>
                <td align="left" colspan="1" rowspan="1">3.86</td>
                <td align="left" colspan="1" rowspan="1">3.65(0.42)</td>
                <td align="left" colspan="1" rowspan="1">0.77</td>
                <td align="left" colspan="1" rowspan="1">1.08(0.17)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">10</td>
                <td align="left" colspan="1" rowspan="1">15</td>
                <td align="left" colspan="1" rowspan="1">4.53</td>
                <td align="left" colspan="1" rowspan="1">5.31</td>
                <td align="left" colspan="1" rowspan="1">5.18(0.19)</td>
                <td align="left" colspan="1" rowspan="1">1.12</td>
                <td align="left" colspan="1" rowspan="1">1.46(0.22)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">11</td>
                <td align="left" colspan="1" rowspan="1">13</td>
                <td align="left" colspan="1" rowspan="1">3.14</td>
                <td align="left" colspan="1" rowspan="1">3.54</td>
                <td align="left" colspan="1" rowspan="1">3.41(0.11)</td>
                <td align="left" colspan="1" rowspan="1">1.17</td>
                <td align="left" colspan="1" rowspan="1">1.52(0.29)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">12</td>
                <td align="left" colspan="1" rowspan="1">6</td>
                <td align="left" colspan="1" rowspan="1">4.47</td>
                <td align="left" colspan="1" rowspan="1">5.39</td>
                <td align="left" colspan="1" rowspan="1">4.96(0.41)</td>
                <td align="left" colspan="1" rowspan="1">1.81</td>
                <td align="left" colspan="1" rowspan="1">2.10(0.17)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">13</td>
                <td align="left" colspan="1" rowspan="1">28</td>
                <td align="left" colspan="1" rowspan="1">4.81</td>
                <td align="left" colspan="1" rowspan="1">5.30</td>
                <td align="left" colspan="1" rowspan="1">5.20(0.10)</td>
                <td align="left" colspan="1" rowspan="1">1.32</td>
                <td align="left" colspan="1" rowspan="1">1.92(0.40)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">14</td>
                <td align="left" colspan="1" rowspan="1">14</td>
                <td align="left" colspan="1" rowspan="1">5.46</td>
                <td align="left" colspan="1" rowspan="1">7.37</td>
                <td align="left" colspan="1" rowspan="1">7.11(0.49)</td>
                <td align="left" colspan="1" rowspan="1">1.72</td>
                <td align="left" colspan="1" rowspan="1">2.16(0.39)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">15</td>
                <td align="left" colspan="1" rowspan="1">8</td>
                <td align="left" colspan="1" rowspan="1">3.93</td>
                <td align="left" colspan="1" rowspan="1">4.50</td>
                <td align="left" colspan="1" rowspan="1">4.31(0.20)</td>
                <td align="left" colspan="1" rowspan="1">1.64</td>
                <td align="left" colspan="1" rowspan="1">2.36(0.46)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">16</td>
                <td align="left" colspan="1" rowspan="1">5</td>
                <td align="left" colspan="1" rowspan="1">6.08</td>
                <td align="left" colspan="1" rowspan="1">6.93</td>
                <td align="left" colspan="1" rowspan="1">6.42(0.34)</td>
                <td align="left" colspan="1" rowspan="1">2.92</td>
                <td align="left" colspan="1" rowspan="1">3.15(0.19)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">17</td>
                <td align="left" colspan="1" rowspan="1">9</td>
                <td align="left" colspan="1" rowspan="1">7.05</td>
                <td align="left" colspan="1" rowspan="1">7.68</td>
                <td align="left" colspan="1" rowspan="1">7.43(0.24)</td>
                <td align="left" colspan="1" rowspan="1">2.82</td>
                <td align="left" colspan="1" rowspan="1">3.13(0.32)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>EF</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">12</td>
                <td align="left" colspan="1" rowspan="1">23</td>
                <td align="left" colspan="1" rowspan="1">2.58</td>
                <td align="left" colspan="1" rowspan="1">2.79</td>
                <td align="left" colspan="1" rowspan="1">2.73(0.05)</td>
                <td align="left" colspan="1" rowspan="1">0.58</td>
                <td align="left" colspan="1" rowspan="1">0.98(0.28)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">13</td>
                <td align="left" colspan="1" rowspan="1">66</td>
                <td align="left" colspan="1" rowspan="1">2.58</td>
                <td align="left" colspan="1" rowspan="1">2.97</td>
                <td align="left" colspan="1" rowspan="1">2.95(0.05)</td>
                <td align="left" colspan="1" rowspan="1">0.68</td>
                <td align="left" colspan="1" rowspan="1">1.08(0.15)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1"/>
                <td align="left" colspan="1" rowspan="1">15</td>
                <td align="left" colspan="1" rowspan="1">3</td>
                <td align="left" colspan="1" rowspan="1">1.46</td>
                <td align="left" colspan="1" rowspan="1">4.15</td>
                <td align="left" colspan="1" rowspan="1">3.11(1.45)</td>
                <td align="left" colspan="1" rowspan="1">2.01</td>
                <td align="left" colspan="1" rowspan="1">2.43(0.39)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">
                  <bold>T0617</bold>
                </td>
                <td align="left" colspan="1" rowspan="1">12</td>
                <td align="left" colspan="1" rowspan="1">21</td>
                <td align="left" colspan="1" rowspan="1">3.17</td>
                <td align="left" colspan="1" rowspan="1">3.41</td>
                <td align="left" colspan="1" rowspan="1">3.33(0.07)</td>
                <td align="left" colspan="1" rowspan="1">0.77</td>
                <td align="left" colspan="1" rowspan="1">1.23(0.39)</td>
              </tr>
            </tbody>
          </table></alternatives><table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>Of the best candidates, lowest RMSD (Å) and average RMSD (Å) for five loops sampled using DPM-HMM method along with their loop length, number of targets in each group and average RMSD (Å) of all the templates used.</p>
            </fn>
            <fn id="nt102">
              <label>a</label>
              <p>Minimum average RMSD of all the templates in a subgroup.</p>
            </fn>
            <fn id="nt103">
              <label>b</label>
              <p>Maximum average RMSD of all the templates in a subgroup.</p>
            </fn>
            <fn id="nt104">
              <label>c</label>
              <p>Average of mean RMSD of all the templates in the group. Standard deviations are given in parenthesis.</p>
            </fn>
            <fn id="nt105">
              <label>d</label>
              <p>Lowest of all best candidates' RMSD that is sampled in each subgroup of loop targets.</p>
            </fn>
            <fn id="nt106">
              <label>e</label>
              <p>Average of best candidate's RMSDs for every target in each subgroup. Standard deviations are given in parenthesis.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p>The inset in <xref ref-type="fig" rid="pcbi-1002234-g004">Figure 4</xref> shows the percentage of better or worse candidates compared to the best template binned by RMSD. In the very close canonical RMSD range of 0–1 Å, 38% candidates were sampled better than the best templates. Moreover, in this regime very close to the native structure where there is a higher probability to produce incorrect structures over the right ones, the DPM-HMM method sampled the remaining 62% in this canonical class not far from the best template. The worst case is with maximum deviation of 0.6 Å and mean deviation of 0.2 Å from the best template. As shown in the inset to <xref ref-type="fig" rid="pcbi-1002234-g004">Figure 4</xref>, our sampling percentages from the DPM-HMM method only improve as the difficulty of loop modeling increases. In the RMSD range of 1–2 Å, around 75% of the best candidates improved on the best templates, and of the 25% that did not, the average increase in RMSD was 0.3 Å with a worst case of 1.3 Å deviation from the best template. In the next bin between 2–3 Å RMSD, 93% or almost all cases produced better candidates. In this range, the 7% of the cases that produced worse candidates averaged 0.6 Å RMSD with a maximum at 1.4 Å. For the cases with templates above 3.0 Å RMSD, which combines some common and all the difficult loop targets, our DPM-HMM method consistently constructs candidates that were better than the closest templates. Overall, about 76% of the loop conformations are sampled more accurately than the best templates available. This consistency of the DPM-HMM method in building improved loop models over these sets of varying difficulty demonstrates its utility and promise.</p>
      </sec>
      <sec id="s2d">
        <title>Influence of the Template Knowledge Base</title>
        <p>We wanted to investigate how much influence the input data set had on our ability to build near native models. <xref ref-type="fig" rid="pcbi-1002234-g005">Figure 5</xref> shows the correlation between the input templates' average RMSD and the best predictions for each of the 465 targets in our LOO tests. As a measure of the diversity of the templates, the average RMSD is calculated as the mean value between all the templates used in the DPM-HMM density estimation with each other. A larger average RMSD indicates greater diversity in the input template data. As expected, near native input data produces better model structures. As shown previously, the DPM-HMM has a limit of 3.66 Å even with very poor input data with average RMSD values past 7.0 Å. Furthermore, the targets were classified into 3 groups according to the number of templates used to produce the DPM-HMM models: (1) those relying upon less than 10 templates, (2) those with between 11–30 templates, and (3) those with greater than 30 templates. For the loops molded with fewer than 10 templates, their best RMSDs are mostly above 2 Å and do not demonstrate a strong dependence on the quality of input data. This suggests that the influence of the prior distribution determines the upper limit of our approach's abilities to sample the native structure. The targets that used between 11–30 templates display the expected correlation of improved candidate production from nearer native sets of templates. For this amount of input data, the DPM-HMM approach increases the probability of sampling near the target structure, which results in RMSDs of most of the best candidates below 2 Å. In our data set, there were only three loop examples that possessed more than 30 templates for input data: CDRH1 12 residue loop with 111 targets, CDRH2 8 residue loop with 87 targets, and EF 13 residue loop with 66 targets. Their average RMSD values are similar and cluster around 2.5 Å (see black filled circles in <xref ref-type="fig" rid="pcbi-1002234-g005">Figure 5</xref>). The large clustering is due to the numerous LOO tests that could be performed in this group. The best RMSD values range from 0.5 to 1.8 Å with a few exceptions discussed below, and 260 target tests in this class are modeled as below 1.8 Å RMSD. Although a large number of templates gives a better chance to model the long loops close to the native structure, the results from this class suggests that there is a saturation limit to the amount of information provided by the input data.</p>
        <fig id="pcbi-1002234-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002234.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Influence of the variation of input data.</title>
            <p>RMSD of the best candidate versus average RMSD between all the templates. The data points are classified according to the number of templates used for input in the DPM-HMM φ,ψ density estimation. Grey filled circles represent targets with less than 10 templates, open circles are with 10 to 30 templates and black filled circles are with more than 30 templates.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002234.g005" xlink:type="simple"/>
        </fig>
        <p>The DPM-HMM approach fails to produce a model that is better than the average RMSD of the templates in two special cases (data points above the unity line in <xref ref-type="fig" rid="pcbi-1002234-g005">Figure 5</xref>). One particular case is a 15 residue EF loop that was modeled using only 2 templates. For this target, the average RMSD of templates is 1.46 Å but the RMSD of the best candidate is 2.77 Å, which is shown as the grey filled circle above the unity line in <xref ref-type="fig" rid="pcbi-1002234-g005">Figure 5</xref>. This high RMSD arises primarily from using idealized bond lengths and bond angles to build loop structures from φ,ψ angles that are unable to reproduce that native loops conformation due to irregularities in bond angles, which has been previously discussed in detail <xref ref-type="bibr" rid="pcbi.1002234-Holmes1">[41]</xref>. The other loop that was poorly modeled belongs to the CDRH1 segment from the humanized anti-gamma-interferon antibody (1b2w <xref ref-type="bibr" rid="pcbi.1002234-Fan1">[42]</xref>) in the class of greater than 30 templates. The best sampled model has a global RMSD of 2.53 Å to the native loop structure (black dot above the diagonal in <xref ref-type="fig" rid="pcbi-1002234-g005">Figure 5</xref>). This loop possesses a 3<sub>10</sub> helical conformation in the middle of the CDRH1, which places it as a distinct outlier in the dataset with over 100 canonical templates.</p>
      </sec>
      <sec id="s2e">
        <title>Sampling Efficiency Dependence on Loop Length and Template Number</title>
        <p>The relationship between the loop length and the sampling efficiency was also investigated. In general, loop-modeling methods are more effective at predicting the shorter loops, where the accuracy decreases as the loop length increases. <xref ref-type="fig" rid="pcbi-1002234-g006">Figure 6</xref> shows sample of various sizes of loops ranging from 7 to 17 amino acid residues. A linear correlation exists between the loop length and best-sampled loop conformation (<xref ref-type="fig" rid="pcbi-1002234-g006">Figure 6a</xref>). In loop modeling, loops with 11–13 amino acid residues are considered long and prediction accuracies of about 1.0–1.5 Å for these long loops are considered to be a success <xref ref-type="bibr" rid="pcbi.1002234-Choi1">[40]</xref>. In this study, sampling efficiency for shorter loops (7–10 amino acid residues) was found to be below 0.5 Å. For the loops with 11–13 residues, the best candidates' global RMSDs are below 1.2 Å. For longer loops with 14–17 amino acids in length, the global RMSD is within the range of 1.8–3.0 Å, which improves upon the sampling reported by other methods <xref ref-type="bibr" rid="pcbi.1002234-Choi1">[40]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Sivasubramanian1">[43]</xref>. The upper bound of sampling efficiency achieved here is about 3.66 Å, which encompasses the largest global RMSD for one of the predicted candidates belonging to the longest (17 residue long) of CDRH3 loop category. The best candidates' RMSDs are also plotted against the number of templates in <xref ref-type="fig" rid="pcbi-1002234-g006">Figure 6b</xref>. As expected, the higher number of templates improves upon the sampling. From <xref ref-type="fig" rid="pcbi-1002234-g006">Figure 6b</xref>, the DPM-HMM method requires at least 30 templates in a data set to consistently make a prediction below 1 Å. With less than 30 templates, the dependency is more about how close the input data is to the target loop structure, where some instances are successful and others approach the 3.66 Å limit of our method.</p>
        <fig id="pcbi-1002234-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002234.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Dependence of input data: length and amount.</title>
            <p>(<bold>a</bold>) Correlation of the best candidate RMSD with loop length. The prediction shows a linear correlation to loop length. (<bold>b</bold>) Correlation of RMSD of the best candidate to the number of templates. The candidates decrease in RMSD as the number of templates increases to a cutoff of ∼30 templates, suggesting that more than 30 templates do not improve the sampling in the DPM-HMM method.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002234.g006" xlink:type="simple"/>
        </fig>
        <p>To further investigate the DPM-HMM method, sampling was analyzed for 90 properly identified loops modeled in 45 TBM targets during our group's CASP9 campaign. <xref ref-type="fig" rid="pcbi-1002234-g007">Figure 7</xref> shows RMSD of the best candidate as a function of loop length. This dataset represents realistic modeling under real-world conditions where very few templates are available to model the torsion angle space. Also, available templates were of various sizes in loop length for each target loop. Our results demonstrate that sampling efficiency is very good for the loops of smaller lengths (3–7 residues) with best-sampled candidates global RMSD of 0.25 Å to the native reference structure. Average global RMSD for best-sampled candidates in this group is about 0.89 Å. For medium sized loops (8–13 residues), best candidate RMSD is 0.99 Å and the mean over the group is 1.9 Å. For longer loops with more than 16 residues, sampling efficiency escapes the DPM-HMM limit of 3.66 Å. These longer loops pose a problem to the DPM-HMM to accurately model the data over so many residues. As can be seen from <xref ref-type="fig" rid="pcbi-1002234-g007">Figure 7</xref>, the limit is stretched at 20 residues, where the best candidates are greater than 5 Å. Overall, the results demonstrate the general applicability of our method in realistic TBM situation where limited number of templates with variable loop lengths was used for modeling.</p>
        <fig id="pcbi-1002234-g007" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002234.g007</object-id>
          <label>Figure 7</label>
          <caption>
            <title>CASP9 Loop sampling.</title>
            <p>Assessment of sampling efficiency for the 90 loops modeled in the CASP9 experiment (see <xref ref-type="sec" rid="s4">Materials and Methods</xref> for selection). All loops were modeled with very limited number of templates, mostly 1–5, and with templates of various lengths. For smaller loops with 3–8 residues, global RMSD is mostly below 2.5 Å. For medium sized loops (8–13 amino acids), global RMSD is between 1–3 Å. As the loop length increases, best-sampled conformations have higher RMSD from the native structure. The DPM-HMM fails after 20 residues as shown by the increase in RMSD above 5 Å.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002234.g007" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2f">
        <title>Sampling Efficiency Compared to LoopyMod</title>
        <p><xref ref-type="fig" rid="pcbi-1002234-g008">Figure 8</xref> compares the sampling efficiencies of DPM-HMM and LoopyMod for 2 sets of loops: the canonical CDRH1 and the non-canonical CDRH3. First, canonical conformations from CDRH1 dataset containing 111 target loops were sampled with LoopyMod and results compared to the DPM-HMM method in the first 2 columns of <xref ref-type="fig" rid="pcbi-1002234-g008">Figure 8</xref>. The global RMSD of the best candidate by LoopyMod is 1.02 Å, which is higher than the 0.61 Å by DPM-HMM method. Variance within RMSDs of the best candidates is also lower in DPM-HMM method than in LoopyMod. The DPM-HMM method produces all of its best candidates below 2.5 Å global RMSD, whereas LoopyMod has some cases upwards of 4 Å. In this canonical class, the DPM-HMM demonstrates that it performs well. Secondly, we tested the sampling efficiency of our method against LoopyMod for the non-canonical class of loops from CDRH3. The third and the fourth columns in <xref ref-type="fig" rid="pcbi-1002234-g008">Figure 8</xref> show comparison of sampling efficiency for CDRH3 by both DPM-HMM and LoopyMod, respectively. As expected, the distribution from both methods is wider as compared to the RMSD distribution for canonical class of loops (CDRH1). The median global RMSD of the best candidates is lower from the DPM-HMM method. The best models have RMSDs of 0.77 Å and 1.05 Å by DPM-HMM and LoopyMod, respectively. The tighter distribution of the DPM-HMM for both the canonical and non-canonical class of loops indicates this method's ability to take advantage of the knowledge base in producing near native candidates. (See Figure S1 in <xref ref-type="supplementary-material" rid="pcbi.1002234.s001">Text S1</xref> for scatter plot of individual data points)</p>
        <fig id="pcbi-1002234-g008" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002234.g008</object-id>
          <label>Figure 8</label>
          <caption>
            <title>Loop sampling comparison.</title>
            <p>Boxplots display the RMSD sampling distribution of the DPM-HMM method alongside that of the LoopyMod method for loops of different difficulty: canonical (CDRH1) and non-canonical (CDRH3) loops. Comparison of sampling to the canonical CDRH1 is shown by the left 2 boxplots and the comparison to the non-canonical CDRH3 by the right 2 boxplots. In both cases, the DPM-HMM exhibits a tighter distribution and lower median RMSD.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002234.g008" xlink:type="simple"/>
        </fig>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <sec id="s3a">
        <title>General Dependencies of the DPM-HMM Method</title>
        <p>The DPM-HMM method's use of a knowledge base implies that the approach is dependent on quality of the input data. Because longer loops are sampled less accurately and less consistently, loop length needs to be included in the discussion. As <xref ref-type="fig" rid="pcbi-1002234-g004">Figures 4</xref> and <xref ref-type="fig" rid="pcbi-1002234-g008">8</xref> show, the DPM-HMM method performs well with canonical loops, so the discussion will focus on the longer more difficult to predict loops. Loops with lengths of 15, 16 and 17 are modeled only with 2 to 8 templates. The longest 17 residue loops from CDRH3 was modeled with 8 templates and is considered to be a very difficult loop to model because of the length and the conformational variability (templates' average global RMSD is 7.43±0.24 Å). The best models for this group show average global RMSD of 3.13±0.32 Å, which improves upon the closest templates as well as models predicted by other methods for the loops of similar length <xref ref-type="bibr" rid="pcbi.1002234-Choi1">[40]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Wright1">[44]</xref>. Recently, Choi <italic>et. al.</italic> <xref ref-type="bibr" rid="pcbi.1002234-Choi1">[40]</xref> reported best models for 15–17 residue loops in the range of 3.48–4.75 Å. With best candidate global RMSDs between 1.12 to 1.81 Å (<xref ref-type="fig" rid="pcbi-1002234-g004">Figure 4</xref>), moderate length loops of 10–13 residues from CDRH3 were sampled closer to the target structure than that of the best templates. Another example of a longer loop used in this study is the 15 residue EF loop from the globin fold. There are only 3 EF loop targets with 15 residues; therefore one target is modeled using only the remaining two loops as input template data (average RMSD 3.11±1.45 Å). The best predicted candidates were found to deviate from the target structure on average by 2.43±0.39 Å. While many of the φ,ψ density estimations properly model the backbone torsion angles in high density areas (see <xref ref-type="fig" rid="pcbi-1002234-g002">Figures 2a and 2b</xref>), it requires only a few residues with angles reside in lower density regions of our density estimation (see <xref ref-type="fig" rid="pcbi-1002234-g002">Figures 2b and 2d</xref>) to make sampling a close model more difficult. It's also worth mentioning that two of the three globin EF loop 15mers are from crystal structures of the similar proteins with identical sequence in loop regions, however loop conformations varies from these 15mers with global RMSD of 2.26 Å. This reflects an extreme case of template based loop modeling with a limited number of templates, and the DPM-HMM method still achieves reasonable sampling efficiency in such difficult cases.</p>
        <p>The templates' average global RMSD provides an independent measure about the variability within the input knowledge base that can be used in real-world conditions to predict model's sampling performance. Lower values of RMSDs result from similar loop conformations to the other templates and higher values are attributed to the large deviation of loop conformations in the template set. Hence, the wider the range of template average RMSDs, the more diverse the template set is. Yet, even with a large variability in conformational space, our DPM-HMM can sample a diverse φ,ψ distribution, and still produce models better than the best template. Even if templates' average RMSDs are larger than 7.0 Å, the best candidates are at a maximum 3.66 Å RMSD. One example of improvement is 17 residue CDRH3 loop from monoclonal antibody hGR-2 F6 (1dqd <xref ref-type="bibr" rid="pcbi.1002234-Wright1">[44]</xref>). The 8 input templates possess an average template RMSD of 7.05 Å and the best template has the RMSD of 8.30 Å to the target structure (data point not shown in <xref ref-type="fig" rid="pcbi-1002234-g004">Figure 4</xref>). For this difficult case, the DPM-HMM method produced a best candidate with a 3.11 Å RMSD to the native loop. This result demonstrates the ability of the DMP-HMM method to produce consistently good models for even difficult loop modeling examples. A major reason for this ability is that the continuous density estimations do not outright exclude areas of Ramachandran space, but rather bias the more probable regions as informed by the input data from the templates. Unfortunately, the DPM-HMM method has a residue limit of about 20 amino acids as shown by our CASP9 results in <xref ref-type="fig" rid="pcbi-1002234-g007">Figure 7</xref>, where the method begins to under-sample the density estimations due to computational constraints. Overall, our approach directly addresses the familiar problem of insufficient templates as well as those all too common instances where the native loop uniquely deviates from the prevalent conformation of the templates at certain positions. For these reasons, the DPM-HMM method proves to be a reliable tool for loop modeling, since even with a small number of templates and low structural similarity, the DPM-HMM approach can quickly and thoroughly sample backbone φ,ψ space to identify loop structures near to native structure.</p>
      </sec>
      <sec id="s3b">
        <title>Assessment of Method for Loop Modeling</title>
        <p>In this study, we applied a novel loop modeling method, the Dirichlet process mixture of hidden Markov models or DPM-HMM <xref ref-type="bibr" rid="pcbi.1002234-Lennox1">[36]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Lennox2">[37]</xref> for φ,ψ density estimation in loop regions. 465 target loops classified in 17 groups depending on the loop identity and length were modeled. These targets were representatives of the various challenges in loop modeling from the easier canonical loops to non-canonical loops with many residues and insufficient sampling. By estimating a continuous distribution across conformational space, the DPM-HMM method combines the advantages of continuous sampling from physical methods and propensities from knowledge-based methods without compromising modeling speed or being limited to specific conformations found in fragment-based libraries. The best global RMSD of a candidate is as low as 0.45 Å for one of the shortest loops (7 amino acid residues) from CDRH2. For these canonical loops with templates below 1.0 Å, the DPM-HMM produces improved models in about 38% of target loops. Also, It is also very encouraging that we can always improve the best templates when best template RMSDs are higher than 3.0 Å. For the most difficult case of a long 17 residue loop with sparse input data, the DPM-HMM approach produces models within 3.66 Å, which is the limit independent of loop length and quality of input data (<xref ref-type="fig" rid="pcbi-1002234-g004">Figures 4</xref> and <xref ref-type="fig" rid="pcbi-1002234-g005">5</xref>). Our results demonstrate that the DPM-HMM method provides consistent and reliable model sampling across the spectrum of loop modeling up to 20 residues.</p>
        <p>The modeling accuracy was found to depend on three factors. The first, and most important, is loop length. It is well known that a loop becomes more difficult to model as length becomes longer (<xref ref-type="fig" rid="pcbi-1002234-g006">Figures 6a</xref> and <xref ref-type="fig" rid="pcbi-1002234-g007">7</xref>), since more residues exponentially increase the potential conformational space. This quickly reduces the effective sampling that can be done. However, a loop with 17 amino acids was successfully modeled to 2.82 Å RMSD of the native with only 8 templates in the input data set. The low number of templates for input data points out the second factor: the number of templates available (<xref ref-type="fig" rid="pcbi-1002234-g005">Figure 5</xref> and <xref ref-type="fig" rid="pcbi-1002234-g006">6b</xref>). The sampling efficiency shows negative correlation with the number of templates when less than 30 templates are used (<xref ref-type="fig" rid="pcbi-1002234-g006">Figure 6b</xref>). The sampling efficiency becomes saturated when more than 30 templates are available. The last factor is the quality of the templates, which provides the input data for our density estimations. If near native templates are available, modeled loops are most likely close to the target structure. Even in cases where no good templates are available, the DPM-HMM method can produce improved loop models. Since all of the allowable Ramanchandran space possesses some probability in the density estimation, this approach can sample into underrepresented areas of conformational space and account for novel loop conformations outside of the representation of the knowledge base. To conclude, the DPM-HMM method can be generally applied as an effective and reliable template based loop-modeling algorithm as seen from the results for benchmarking loops from the CASP9 targets.</p>
      </sec>
    </sec>
    <sec id="s4" sec-type="materials|methods">
      <title>Materials and Methods</title>
      <sec id="s4a">
        <title>Data Sets</title>
        <p>A dataset of 465 target loops was compiled for this study, as given in <xref ref-type="table" rid="pcbi-1002234-t001">Table 1</xref>. For all loops, two anchoring residues on either side were included as anchoring residues. Structural alignments were performed using MUSTANG <xref ref-type="bibr" rid="pcbi.1002234-Konagurthu1">[45]</xref>. Structures of 132 immunoglobulin heavy variable domains at greater than 95% sequence identity were retrieved from the ASTRAL compendium of protein structure <xref ref-type="bibr" rid="pcbi.1002234-Chandonia1">[46]</xref>. As one of the most common representatives for template-based loop modeling, the three complementarity-determining regions (CDRs) from the heavy chain were selected for modeling. According to IMGT numbering scheme <xref ref-type="bibr" rid="pcbi.1002234-Lefranc1">[47]</xref>, the CDR loop sets were constructed by extracting the residues at following sequence positions: 23–39 for CDRH1, 56–67 for CDRH2 and 104–118 for CDRH3. The second loop data set was taken from 92 globin structures which were downloaded from the PDB <xref ref-type="bibr" rid="pcbi.1002234-Berman1">[48]</xref> and structurally aligned, as used previously by Tsai <italic>et. al.</italic> <xref ref-type="bibr" rid="pcbi.1002234-Lennox1">[36]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Lennox2">[37]</xref>. DSSP <xref ref-type="bibr" rid="pcbi.1002234-Kabsch1">[49]</xref> secondary structure profiles were used to determine the boundaries of the longest loop in the globin fold. This loop connecting helices E and F consists of alignment positions 93–106 in the multiple structural alignments. The third data set consisted of the templates for a CASP9 target, T0617 (3nrv). The longest loop containing 12 residues was extracted from 21 structurally superposed non-redundant template structures. Table S1 in <xref ref-type="supplementary-material" rid="pcbi.1002234.s001">Text S1</xref> shows PDB identifiers and loop sequence positions for all the data sets used in this study.</p>
        <p><xref ref-type="table" rid="pcbi-1002234-t001">Table 1</xref> provides the details of the final data sets used and <xref ref-type="fig" rid="pcbi-1002234-g001">Figure 1</xref> shows structural superposition of all the templates in each dataset. The set is briefly described here. A total of 352 well-defined loops from 132 antibody structures were classified into three major classes as CDRH1, CDRH2 and CDRH3. Not all the loop regions are well defined in each PDB, so each set consisted of slightly different numbers of templates. Therefore, 111 protein structures are in the CDRH1 loop set, which is well conserved with 12 residues in each loop structure. CDRH2 contains 130 loop structures and is subdivided in three groups by loop lengths of 7, 8 and 10 residue loops. CDRH3 is the most diverse dataset, containing a total of 111 loop structures that are grouped by sizes ranging from 8–17 amino acid residues. Next, 92 globin EF loops are grouped into the 3 classes: 12, 13, and 15 residue loops. Lastly, 21 target loops were extracted from the template structures to the CASP9 target T0617 and all loops are 12 residues in length. The crystal structure geometry of the backbone atoms (N, Cα and C) of the first anchoring residue (N-terminal) of the target loop was used to build the models. All the models were built starting from the second residue at N-terminal residue to the last residue at C-terminal. Sharing the first anchoring residue backbone coordinates results in globally superposed loops, so no further superposition is needed. Length of the loops refers to the total number of residues modeled. Although two more residues on both sides of the loop region are included in the sampling, only the second residue from the N-terminus and last two residues at the C-terminus were counted in the total number of residues (as defined by loop length).</p>
      </sec>
      <sec id="s4b">
        <title>Dataset from CASP9 Targets</title>
        <p>To show the general applicability of our sampling method outside a specific class or fold in protein family, data was compiled for 90 identified loops modeled during the CASP9 campaign. As this work focuses on loop sampling, only cases were considered where loop regions were identified correctly. For each target protein sequence from 305 putative loops in 45 TBM targets, closely similar templates were identified by a PSI-BLAST <xref ref-type="bibr" rid="pcbi.1002234-Altschul1">[50]</xref> search. Template structures were superposed by MUSTANG <xref ref-type="bibr" rid="pcbi.1002234-Konagurthu1">[45]</xref> program as described above. The target sequence was aligned to the multiple templates using the profile alignment function in Muscle <xref ref-type="bibr" rid="pcbi.1002234-Edgar1">[51]</xref>. Based on the multiple sequence/structure alignment of target sequence and templates, loop regions in the target sequence were defined. The loop region definition in some of the cases was erroneous depending on the quality and number of templates as well as accuracy of the sequence alignment. Also, loops with no available reference structures were excluded from this analysis. (See Table S2 in <xref ref-type="supplementary-material" rid="pcbi.1002234.s001">Text S1</xref> for PDB ids of reference structures and positions of loops with their RMSDs).</p>
      </sec>
      <sec id="s4c">
        <title>Comparison of Sampling Efficiency with Sampling Algorithm of LoopyMod</title>
        <p>For fair comparisons with a common method for loop modeling, the dataset of canonical (CDRH1) and non-canonical (CDRH3) loop conformations were modeled using both DPM-HMM and LoopyMod program <xref ref-type="bibr" rid="pcbi.1002234-Xiang1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Soto1">[21]</xref>. Although LoopyMod is a complete loop prediction algorithm that includes sampling, scoring and ranking steps, we are interested in only comparing the sampling efficiency of our method to that of LoopyMod. Therefore, scoring and ranking steps in LoopyMod were omitted and all the sampled loop conformations were collected for global RMSD calculations. To simulate a realistic loop-modeling problem, the best template was provided as the input to the LoopyMod and a million conformations were generated. From these, a global backbone RMSDs against the reference crystal structure of the loop was calculated. (See Figure S1a and S1b in <xref ref-type="supplementary-material" rid="pcbi.1002234.s001">Text S1</xref> for comparison of RMSD of best candidates to the RMSD of best template used by DPM-HMM and LoopyMod methods).</p>
      </sec>
      <sec id="s4d">
        <title>Generation of Correlated φ,ψ Density Distributions</title>
        <p>The joint φ,ψ distribution were estimated using the Dirichlet process mixture of hidden Markov models (DPM-HMM) <xref ref-type="bibr" rid="pcbi.1002234-Lennox1">[36]</xref>, <xref ref-type="bibr" rid="pcbi.1002234-Lennox2">[37]</xref>. Data consists of sequences of angle pairs (φ<italic><sub>ij</sub></italic>, ψ<italic><sub>ij</sub></italic>), where <italic>i</italic> = 1,2,3,…,<italic>n</italic> is the index for a particular observed loop and <italic>j</italic> = 1,2,3,…,<italic>m</italic> is the index for the sequence position within the alignment. The model uses standard Bayesian nonparametrics density estimation techniques to estimate the joint density of all angle pairs across all <italic>m</italic> positions. Conceptually, it states that the data of loop <italic>i</italic> across the <italic>m</italic> positions - (φ<italic><sub>i1</sub></italic>,ψ<italic><sub>i1</sub></italic>), (φ<italic><sub>i2</sub></italic>, ψ<italic><sub>i2</sub></italic>),…, (φ<italic><sub>im</sub></italic>,ψ<italic><sub>im</sub></italic>) - arises from one of many clusters. Each cluster has a unique “centering” backbone angles, whereas members of a given cluster randomly deviate from its cluster center. The cluster to which each loop belongs is uncertain and the method mixes over this uncertainty, providing so-called mixture models. In contrast to many traditional mixture modeling approaches, however, the number of component distributions in our model is theoretically infinite, increasing the flexibility of the model.</p>
        <p>Naively, one might simply model the “centering” backbone angles of each cluster as being independent, but that would ignore the obvious secondary structure that can readily be inferred from the observed data. Instead, the DPM-HMM considers a hidden Markov model for these “centering” backbone angles. Statistically, this represents a prior distribution on the values of parameters for the bivariate von Mises (BVM) sine model. The hidden states consisted of four secondary structure types: coil, helix, strand, and turn. The emission distributions for BVM location (or “centering”) parameters were bivariate von Mises sine model mixtures designed to mimic the distributions of torsion angles within each state from the PDB. Conditioning on inferred secondary structure (i.e., the hidden state in the Markov chain), the location parameters can be very specific. Transition probabilities among the states were also calculated based on observed distributions. Different emission distributions were used at locations containing proline or glycine due to the distinctive properties of these amino acids. (The emission distributions for scale parameters were identical for all states.) This informative centering distribution allowed us to leverage information along a sequence to provide informative secondary structure based density estimates even at positions with poor representation in an alignment.</p>
        <p>Briefly, the formal statistical model can be written as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002234.e001" xlink:type="simple"/></disp-formula>where <italic>p</italic> ((φ,ψ) | <italic>μ</italic>, ν, Ω) is a bivariate von Mises sine model <xref ref-type="bibr" rid="pcbi.1002234-Engh1">[52]</xref> with mean parameters (<italic>μ</italic>,ν), <italic>μ<sub>i</sub></italic> = <italic>(μ<sub>i1</sub>, μ<sub>i2</sub>, μ<sub>i3</sub>, …, μ<sub>im</sub>)</italic>, ν<italic><sub>i</sub></italic> = (ν<italic><sub>i1</sub></italic>, ν<italic><sub>i2</sub></italic>, ν<italic><sub>i3</sub></italic>, …, ν<italic><sub>im</sub></italic>), Ω<italic><sub>i</sub></italic> = (Ω<italic><sub>i1</sub></italic>, Ω<italic><sub>i2</sub></italic>, Ω<italic><sub>i3</sub></italic>, …, Ω<italic><sub>im</sub></italic>), and precision matrix Ω, <italic>G</italic> is a draw from a Dirichlet process with mass parameter <italic>τ</italic> and centering distributions <italic>H<sub>1</sub></italic> for <italic>μ<sub>i</sub></italic>, ν<italic><sub>i</sub></italic>, and <italic>H<sub>2</sub></italic> for Ω<italic><sub>i</sub></italic>.. <italic>H<sub>2</sub></italic> is taken to be the product of <italic>m</italic> identical Wishart distributions with shape parameter α<sub>0</sub> and scale matrix β<sub>0</sub>, with an expected value of α<sub>0</sub>/(2β<sub>0</sub>). The distribution <italic>H<sub>1</sub></italic> is the hidden Markov model discussed previously, with a state space consisting of four secondary structure classes (helix, turn, coil, and strand) each of which is represented by a mixture of between one and five bivariate von Mises sine models. A complete description of this method, including computational details, is provided in <xref ref-type="bibr" rid="pcbi.1002234-Lennox1">[36]</xref>. For each density estimate, we ran two Markov chain Monte Carlo (MCMC) <xref ref-type="bibr" rid="pcbi.1002234-Neal1">[53]</xref> runs for 11,000 iterations with the first 1,000 discarded as burn in. Using 1-in-20 thinning, this gave us 1,000 draws from the posterior distribution, which forms the basis for our density estimate. For our hyperparameter settings, we took <italic>τ = 5</italic>. <italic>H<sub>2</sub></italic> was the product of <italic>m</italic> independent Wishart distributions with shape parameter α<sub>0</sub> = 2 and a 2×2 scale matrix β<sub>0</sub>, which had diagonal elements equal to 0.25 and off diagonal elements equal to 0. Because density estimation is the most computationally intensive portion of our loop-modeling scheme, this approach makes the simplification of only uniquely modeling positions with proline and glycine. For this reason, two loops can produce equivalent posterior distributions if their prolines and glycines appear in the same positions. Additional details on fitting this model and adjustments for gaps in alignment data are provided in previous work <xref ref-type="bibr" rid="pcbi.1002234-Lennox1">[36]</xref>.</p>
      </sec>
      <sec id="s4e">
        <title>DPM-HMM Model Building from φ,ψ Sample Space and Analysis</title>
        <p>We used the leave one out (LOO) approach to model every target in a dataset. For each sampling and prediction run, the target loop is left out: not included as input data for the DPM-HMM density estimation. Remaining loops from the subgroup of the target were then used as templates to model and sample the joint φ,ψ distributions for a target sequence. A set of one million φ,ψ draws from the estimated densities was generated for each of the target loops. For all the one million draws of the torsion angles, all backbone atom models were constructed in Cartesian coordinate space using Self-Normalizing Natural Extension Reference Frame (SNerf) algorithm <xref ref-type="bibr" rid="pcbi.1002234-Parsons1">[54]</xref> with standard bond length and angle data <xref ref-type="bibr" rid="pcbi.1002234-Engh1">[52]</xref>. In comparison to the initial density estimation, these two steps of making draws from the distribution and building the loop in Cartesian coordinates are relatively fast. About three hours of CPU time are required to sample one million points in φ,ψ space for an average sized target loop (about 12 amino acid residues). Model building from the sampled torsion angle space and filtering using average backbone α carbon (Cα) distance takes about 1.5 hours of CPU time. The computational expense scales linearly with the number of residues in the loop and the number of models to be built.</p>
        <p>Three backbone atom coordinates of the first residue at entering N-terminal side of the target loop were used as the anchor for construction of the models in a Cartesian space. So all models in the set are built from the same starting point. To ensure appropriate loop closure, models were refined using a simple distance filter with a 2.0 Å cutoff value. This Cα distance filter is very basic using the average distance between the last two Cα atoms of a candidate loop model and those of target loop crystal structure in the loop exit. Since the backbone atom coordinates of first anchoring residue are shared in all the models and the reference structure, this simple filter works well and produces a pool of suitable candidates. Filtered models can be further scored for side chain clashes after grafting on the surface of the whole protein.</p>
        <p>The DPM-HMM software used in this analysis is available for download at <ext-link ext-link-type="uri" xlink:href="http://www.stat.tamu.edu/~dahl/software/cortorgles/" xlink:type="simple">http://www.stat.tamu.edu/~dahl/software/cortorgles/</ext-link>.</p>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002234.s001" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002234.s001" xlink:type="simple">
        <label>Text S1</label>
        <caption>
          <p>Primary data for the five classes of loops used for statistical modeling and sampling (Table S1a through S1e) and data for target loops that were modeled during CASP9 experiment (Table S2). Figure S1 shows comparison of RMSDs for the best candidates modeled using DPM-HMM and LoopyMod methods for (a) canonical and (b) non-canonical classes of loops.</p>
          <p>(DOC)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>We would like to thank Tien Ho for his initial input and work on this project.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002234-Qu1">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Qu</surname><given-names>XT</given-names></name><name name-style="western"><surname>Swanson</surname><given-names>R</given-names></name><name name-style="western"><surname>Day</surname><given-names>R</given-names></name><name name-style="western"><surname>Tsai</surname><given-names>J</given-names></name></person-group>             <year>2009</year>             <article-title>A Guide to Template Based Structure Prediction.</article-title>             <source>Curr Prot Pep Sci</source>             <volume>10</volume>             <fpage>270</fpage>             <lpage>285</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Petrey1">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Petrey</surname><given-names>D</given-names></name><name name-style="western"><surname>Honig</surname><given-names>B</given-names></name></person-group>             <year>2005</year>             <article-title>Protein structure prediction: inroads to biology.</article-title>             <source>Mol Cell</source>             <volume>20</volume>             <fpage>811</fpage>             <lpage>819</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Venclovas1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Venclovas</surname><given-names>C</given-names></name><name name-style="western"><surname>Zemla</surname><given-names>A</given-names></name><name name-style="western"><surname>Fidelis</surname><given-names>K</given-names></name><name name-style="western"><surname>Moult</surname><given-names>J</given-names></name></person-group>             <year>2003</year>             <article-title>Assessment of progress over the CASP experiments.</article-title>             <source>Proteins</source>             <volume>53</volume>             <supplement>Suppl 6</supplement>             <fpage>585</fpage>             <lpage>595</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Fiser1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fiser</surname><given-names>A</given-names></name><name name-style="western"><surname>Do</surname><given-names>RK</given-names></name><name name-style="western"><surname>Sali</surname><given-names>A</given-names></name></person-group>             <year>2000</year>             <article-title>Modeling of loops in protein structures.</article-title>             <source>Protein Sci</source>             <volume>9</volume>             <fpage>1753</fpage>             <lpage>1773</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Kryshtafovych1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kryshtafovych</surname><given-names>A</given-names></name><name name-style="western"><surname>Venclovas</surname><given-names>C</given-names></name><name name-style="western"><surname>Fidelis</surname><given-names>K</given-names></name><name name-style="western"><surname>Moult</surname><given-names>J</given-names></name></person-group>             <year>2005</year>             <article-title>Progress over first decade of CASP experiments.</article-title>             <source>Proteins</source>             <volume>61</volume>             <fpage>225</fpage>             <lpage>236</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Fine1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fine</surname><given-names>RM</given-names></name><name name-style="western"><surname>Wang</surname><given-names>H</given-names></name><name name-style="western"><surname>Shenkin</surname><given-names>PS</given-names></name><name name-style="western"><surname>Yarmush</surname><given-names>DL</given-names></name><name name-style="western"><surname>Levinthal</surname><given-names>C</given-names></name></person-group>             <year>1986</year>             <article-title>Predicting antibody hypervariable loop conformations. II: Minimization and molecular dynamics studies of MCPC603 from many randomly generated loop conformations.</article-title>             <source>Proteins</source>             <volume>1</volume>             <fpage>342</fpage>             <lpage>362</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Bruccoleri1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bruccoleri</surname><given-names>RE</given-names></name><name name-style="western"><surname>Karplus</surname><given-names>M</given-names></name></person-group>             <year>1987</year>             <article-title>Prediction of the folding of short polypeptide segments by uniform conformational sampling.</article-title>             <source>Biopolymers</source>             <volume>26</volume>             <fpage>137</fpage>             <lpage>168</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Shenkin1">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Shenkin</surname><given-names>PS</given-names></name><name name-style="western"><surname>Yarmush</surname><given-names>DL</given-names></name><name name-style="western"><surname>Fine</surname><given-names>RM</given-names></name><name name-style="western"><surname>Wang</surname><given-names>HJ</given-names></name><name name-style="western"><surname>Levinthal</surname><given-names>C</given-names></name></person-group>             <year>1987</year>             <article-title>Predicting antibody hypervariable loop conformation. I. Ensembles of random conformations for ringlike structures.</article-title>             <source>Biopolymers</source>             <volume>26</volume>             <fpage>2053</fpage>             <lpage>2085</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Hornak1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hornak</surname><given-names>V</given-names></name><name name-style="western"><surname>Simmerling</surname><given-names>C</given-names></name></person-group>             <year>2003</year>             <article-title>Generation of accurate protein loop conformations through low-barrier molecular dynamics.</article-title>             <source>Proteins</source>             <volume>51</volume>             <fpage>577</fpage>             <lpage>590</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Jacobson1">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Jacobson</surname><given-names>MP</given-names></name><name name-style="western"><surname>Pincus</surname><given-names>DL</given-names></name><name name-style="western"><surname>Rapp</surname><given-names>CS</given-names></name><name name-style="western"><surname>Day</surname><given-names>TJ</given-names></name><name name-style="western"><surname>Honig</surname><given-names>B</given-names></name><etal/></person-group>             <year>2004</year>             <article-title>A hierarchical approach to all-atom protein loop prediction.</article-title>             <source>Proteins</source>             <volume>55</volume>             <fpage>351</fpage>             <lpage>367</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-DePristo1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>DePristo</surname><given-names>MA</given-names></name><name name-style="western"><surname>de Bakker</surname><given-names>PI</given-names></name><name name-style="western"><surname>Lovell</surname><given-names>SC</given-names></name><name name-style="western"><surname>Blundell</surname><given-names>TL</given-names></name></person-group>             <year>2003</year>             <article-title>Ab initio construction of polypeptide fragments: efficient generation of accurate, representative ensembles.</article-title>             <source>Proteins</source>             <volume>51</volume>             <fpage>41</fpage>             <lpage>55</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Deane1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Deane</surname><given-names>CM</given-names></name><name name-style="western"><surname>Blundell</surname><given-names>TL</given-names></name></person-group>             <year>2000</year>             <article-title>A novel exhaustive search algorithm for predicting the conformation of polypeptide segments in proteins.</article-title>             <source>Proteins</source>             <volume>40</volume>             <fpage>135</fpage>             <lpage>144</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Xiang1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Xiang</surname><given-names>Z</given-names></name><name name-style="western"><surname>Soto</surname><given-names>CS</given-names></name><name name-style="western"><surname>Honig</surname><given-names>B</given-names></name></person-group>             <year>2002</year>             <article-title>Evaluating conformational free energies: the colony energy and its application to the problem of loop prediction.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>99</volume>             <fpage>7432</fpage>             <lpage>7437</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Martin1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Martin</surname><given-names>AC</given-names></name><name name-style="western"><surname>Thornton</surname><given-names>JM</given-names></name></person-group>             <year>1996</year>             <article-title>Structural families in loops of homologous proteins: automatic classification, modelling and application to antibodies.</article-title>             <source>J Mol Biol</source>             <volume>263</volume>             <fpage>800</fpage>             <lpage>815</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Michalsky1">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Michalsky</surname><given-names>E</given-names></name><name name-style="western"><surname>Goede</surname><given-names>A</given-names></name><name name-style="western"><surname>Preissner</surname><given-names>R</given-names></name></person-group>             <year>2003</year>             <article-title>Loops In Proteins (LIP)–a comprehensive loop database for homology modelling.</article-title>             <source>Protein Eng</source>             <volume>16</volume>             <fpage>979</fpage>             <lpage>985</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Martin2">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Martin</surname><given-names>AC</given-names></name><name name-style="western"><surname>Cheetham</surname><given-names>JC</given-names></name><name name-style="western"><surname>Rees</surname><given-names>AR</given-names></name></person-group>             <year>1989</year>             <article-title>Modeling antibody hypervariable loops: a combined algorithm.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>86</volume>             <fpage>9268</fpage>             <lpage>9272</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Chothia1">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chothia</surname><given-names>C</given-names></name><name name-style="western"><surname>Lesk</surname><given-names>AM</given-names></name></person-group>             <year>1987</year>             <article-title>Canonical structures for the hypervariable regions of immunoglobulins.</article-title>             <source>J Mol Biol</source>             <volume>196</volume>             <fpage>901</fpage>             <lpage>917</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Morea1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Morea</surname><given-names>V</given-names></name><name name-style="western"><surname>Tramontano</surname><given-names>A</given-names></name><name name-style="western"><surname>Rustici</surname><given-names>M</given-names></name><name name-style="western"><surname>Chothia</surname><given-names>C</given-names></name><name name-style="western"><surname>Lesk</surname><given-names>AM</given-names></name></person-group>             <year>1998</year>             <article-title>Conformations of the third hypervariable region in the VH domain of immunoglobulins.</article-title>             <source>J Mol Biol</source>             <volume>275</volume>             <fpage>269</fpage>             <lpage>294</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Wojcik1">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wojcik</surname><given-names>J</given-names></name><name name-style="western"><surname>Mornon</surname><given-names>JP</given-names></name><name name-style="western"><surname>Chomilier</surname><given-names>J</given-names></name></person-group>             <year>1999</year>             <article-title>New efficient statistical sequence-dependent structure prediction of short to medium-sized protein loops based on an exhaustive loop classification.</article-title>             <source>J Mol Biol</source>             <volume>289</volume>             <fpage>1469</fpage>             <lpage>1490</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Sudarsanam1">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sudarsanam</surname><given-names>S</given-names></name><name name-style="western"><surname>Dubose</surname><given-names>RF</given-names></name><name name-style="western"><surname>March</surname><given-names>CJ</given-names></name><name name-style="western"><surname>Srinivasan</surname><given-names>S</given-names></name></person-group>             <year>1995</year>             <article-title>Modeling protein loops using a Πi+1, Ψi dimer database.</article-title>             <source>Protein Sci</source>             <volume>4</volume>             <fpage>1412</fpage>             <lpage>1420</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Soto1">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Soto</surname><given-names>CS</given-names></name><name name-style="western"><surname>Fasnacht</surname><given-names>M</given-names></name><name name-style="western"><surname>Zhu</surname><given-names>J</given-names></name><name name-style="western"><surname>Forrest</surname><given-names>L</given-names></name><name name-style="western"><surname>Honig</surname><given-names>B</given-names></name></person-group>             <year>2008</year>             <article-title>Loop modeling: Sampling, filtering, and scoring.</article-title>             <source>Proteins</source>             <volume>70</volume>             <fpage>834</fpage>             <lpage>843</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Zhu1">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zhu</surname><given-names>F</given-names></name><name name-style="western"><surname>Agrafiotis</surname><given-names>DK</given-names></name></person-group>             <year>2007</year>             <article-title>Self-organizing superposition (SOS) algorithm for conformational sampling.</article-title>             <source>J Comp Chem</source>             <volume>28</volume>             <fpage>1234</fpage>             <lpage>1239</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Lee1">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>J</given-names></name><name name-style="western"><surname>Lee</surname><given-names>D</given-names></name><name name-style="western"><surname>Park</surname><given-names>H</given-names></name><name name-style="western"><surname>Coutsias</surname><given-names>EA</given-names></name><name name-style="western"><surname>Seok</surname><given-names>C</given-names></name></person-group>             <year>2010</year>             <article-title>Protein loop modeling by usig fragment assembly and analytical loop closure.</article-title>             <source>Proteins</source>             <volume>78</volume>             <fpage>3428</fpage>             <lpage>3436</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Espadaler1">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Espadaler</surname><given-names>J</given-names></name><name name-style="western"><surname>Fernandez-Fuentes</surname><given-names>N</given-names></name><name name-style="western"><surname>Hermoso</surname><given-names>A</given-names></name><name name-style="western"><surname>Querol</surname><given-names>E</given-names></name><name name-style="western"><surname>Aviles</surname><given-names>FX</given-names></name><etal/></person-group>             <year>2004</year>             <article-title>ArchDB: automated protein loop classification as a tool for structural genomics.</article-title>             <source>Nucleic Acids Res</source>             <volume>32</volume>             <fpage>D185</fpage>             <lpage>188</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Fiser2">
        <label>25</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fiser</surname><given-names>A</given-names></name><name name-style="western"><surname>Sali</surname><given-names>A</given-names></name></person-group>             <year>2003</year>             <article-title>Modeller: generation and refinement of homology-based protein structure models.</article-title>             <source>Methods Enzymol</source>             <volume>374</volume>             <fpage>461</fpage>             <lpage>491</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Oliva1">
        <label>26</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Oliva</surname><given-names>B</given-names></name><name name-style="western"><surname>Bates</surname><given-names>PA</given-names></name><name name-style="western"><surname>Querol</surname><given-names>E</given-names></name><name name-style="western"><surname>Aviles</surname><given-names>FX</given-names></name><name name-style="western"><surname>Sternberg</surname><given-names>MJ</given-names></name></person-group>             <year>1997</year>             <article-title>An automated classification of the structure of protein loops.</article-title>             <source>J Mol Biol</source>             <volume>266</volume>             <fpage>814</fpage>             <lpage>830</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Peng1">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Peng</surname><given-names>HP</given-names></name><name name-style="western"><surname>Yang</surname><given-names>AS</given-names></name></person-group>             <year>2007</year>             <article-title>Modeling protein loops with knowledge-based prediction of sequence-structure alignment.</article-title>             <source>Bioinformatics</source>             <volume>23</volume>             <fpage>2836</fpage>             <lpage>2842</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Zhu2">
        <label>28</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zhu</surname><given-names>K</given-names></name><name name-style="western"><surname>Pincus</surname><given-names>DL</given-names></name><name name-style="western"><surname>Zhao</surname><given-names>S</given-names></name><name name-style="western"><surname>Friesner</surname><given-names>RA</given-names></name></person-group>             <year>2006</year>             <article-title>Long loop prediction using the protein local optimization program.</article-title>             <source>Proteins</source>             <volume>65</volume>             <fpage>438</fpage>             <lpage>452</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Rohl1">
        <label>29</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rohl</surname><given-names>CA</given-names></name><name name-style="western"><surname>Strauss</surname><given-names>CE</given-names></name><name name-style="western"><surname>Chivian</surname><given-names>D</given-names></name><name name-style="western"><surname>Baker</surname><given-names>D</given-names></name></person-group>             <year>2004</year>             <article-title>Modeling structurally variable regions in homologous proteins with rosetta.</article-title>             <source>Proteins</source>             <volume>55</volume>             <fpage>656</fpage>             <lpage>677</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-vanVlijmen1">
        <label>30</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>van Vlijmen</surname><given-names>HW</given-names></name><name name-style="western"><surname>Karplus</surname><given-names>M</given-names></name></person-group>             <year>1997</year>             <article-title>PDB-based protein loop prediction: parameters for selection and methods for optimization.</article-title>             <source>J Mol Biol</source>             <volume>267</volume>             <fpage>975</fpage>             <lpage>1001</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Liu1">
        <label>31</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>P</given-names></name><name name-style="western"><surname>Zhu</surname><given-names>F</given-names></name><name name-style="western"><surname>Rassokhin</surname><given-names>DN</given-names></name><name name-style="western"><surname>Agrafiotis</surname><given-names>DK</given-names></name></person-group>             <year>2009</year>             <article-title>A self-organizing algorithm for modeling protein loops.</article-title>             <source>PLoS Comput Biol</source>             <volume>5</volume>             <fpage>e1000478</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Boomsma1">
        <label>32</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Boomsma</surname><given-names>W</given-names></name><name name-style="western"><surname>Hamelryck</surname><given-names>T</given-names></name></person-group>             <year>2005</year>             <article-title>Full cyclic coordinate descent: solving the protein loop closure problem in C-alpha space.</article-title>             <source>BMC Bioinformatics</source>             <volume>6</volume>             <fpage>159</fpage>             <lpage>169</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Canutescu1">
        <label>33</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Canutescu</surname><given-names>AA</given-names></name><name name-style="western"><surname>Dunbrack</surname><given-names>RL</given-names><suffix>Jr</suffix></name></person-group>             <year>2003</year>             <article-title>Cyclic coordinate descent: A robotics algorithm for protein loop closure.</article-title>             <source>Protein Sci</source>             <volume>12</volume>             <fpage>963</fpage>             <lpage>972</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Boomsma2">
        <label>34</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Boomsma</surname><given-names>W</given-names></name><name name-style="western"><surname>Mardia</surname><given-names>KV</given-names></name><name name-style="western"><surname>Taylor</surname><given-names>CC</given-names></name><name name-style="western"><surname>Ferkinghoff-Borg</surname><given-names>J</given-names></name><name name-style="western"><surname>Krogh</surname><given-names>A</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>A generative, probabilistic model of local protein structure.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>105</volume>             <fpage>8932</fpage>             <lpage>8937</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Rosenbach1">
        <label>35</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rosenbach</surname><given-names>D</given-names></name><name name-style="western"><surname>Rosenfeld</surname><given-names>R</given-names></name></person-group>             <year>1995</year>             <article-title>Simultaneous modeling of multiple loops in proteins.</article-title>             <source>Protein Sci</source>             <volume>4</volume>             <fpage>496</fpage>             <lpage>505</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Lennox1">
        <label>36</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lennox</surname><given-names>KP</given-names></name><name name-style="western"><surname>Vannucci</surname><given-names>M</given-names></name><name name-style="western"><surname>Day</surname><given-names>R</given-names></name><name name-style="western"><surname>Tsai</surname><given-names>JW</given-names></name></person-group>             <year>2010</year>             <article-title>A Dirichlet process mixture of hidden Markov models for protein structure prediction.</article-title>             <source>Ann Appl Stat</source>             <volume>4</volume>             <fpage>916</fpage>             <lpage>962</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Lennox2">
        <label>37</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lennox</surname><given-names>KP</given-names></name><name name-style="western"><surname>Dahl</surname><given-names>DB</given-names></name><name name-style="western"><surname>Vannucci</surname><given-names>M</given-names></name><name name-style="western"><surname>Tsai</surname><given-names>JW</given-names></name></person-group>             <year>2009</year>             <article-title>Density estimation for protein conformation angles using a bivariate von Mises Distribution and Baysian Nonparametrics.</article-title>             <source>J Am Stat Assoc</source>             <volume>104</volume>             <fpage>586</fpage>             <lpage>596</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Ramachandran1">
        <label>38</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ramachandran</surname><given-names>GN</given-names></name><name name-style="western"><surname>Kolaskar</surname><given-names>AS</given-names></name><name name-style="western"><surname>Ramakrishnan</surname><given-names>C</given-names></name><name name-style="western"><surname>Sasisekharan</surname><given-names>V</given-names></name></person-group>             <year>1974</year>             <article-title>The mean geometry of the peptide unit from crystal structure data.</article-title>             <source>Biochim Biophys Acta</source>             <volume>359</volume>             <fpage>298</fpage>             <lpage>302</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Dahl1">
        <label>39</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Dahl</surname><given-names>DB</given-names></name><name name-style="western"><surname>Bohannan</surname><given-names>Z</given-names></name><name name-style="western"><surname>Mo</surname><given-names>Q</given-names></name><name name-style="western"><surname>Vannucci</surname><given-names>M</given-names></name><name name-style="western"><surname>Tsai</surname><given-names>J</given-names></name></person-group>             <year>2008</year>             <article-title>Assessing side-chain perturbations of the protein backbone: a knowledge-based classification of residue Ramachandran space.</article-title>             <source>J Mol Biol</source>             <volume>378</volume>             <fpage>749</fpage>             <lpage>758</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Choi1">
        <label>40</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Choi</surname><given-names>Y</given-names></name><name name-style="western"><surname>Deane</surname><given-names>CM</given-names></name></person-group>             <year>2010</year>             <article-title>FREAD revisited: Accurate loop strucutre prediction using a database search algorithm.</article-title>             <source>Proteins</source>             <volume>78</volume>             <fpage>1431</fpage>             <lpage>1440</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Holmes1">
        <label>41</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Holmes</surname><given-names>JB</given-names></name><name name-style="western"><surname>Tsai</surname><given-names>J</given-names></name></person-group>             <year>2004</year>             <article-title>Some fundamental aspects of building protein structures from fragment libraries.</article-title>             <source>Protein Sci</source>             <volume>13</volume>             <fpage>1636</fpage>             <lpage>1650</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Fan1">
        <label>42</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fan</surname><given-names>ZC</given-names></name><name name-style="western"><surname>Shan</surname><given-names>L</given-names></name><name name-style="western"><surname>Goldsteen</surname><given-names>BZ</given-names></name><name name-style="western"><surname>Guddat</surname><given-names>LW</given-names></name><name name-style="western"><surname>Thakur</surname><given-names>A</given-names></name><etal/></person-group>             <year>1999</year>             <article-title>Comparison of the three-dimensional structures of a humanized and a chimeric Fab of an anti-gamma-interferon antibody.</article-title>             <source>J Mol Recognit</source>             <volume>12</volume>             <fpage>19</fpage>             <lpage>32</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Sivasubramanian1">
        <label>43</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sivasubramanian</surname><given-names>A</given-names></name><name name-style="western"><surname>Sircar</surname><given-names>A</given-names></name><name name-style="western"><surname>Chaudhury</surname><given-names>S</given-names></name><name name-style="western"><surname>Gray</surname><given-names>JJ</given-names></name></person-group>             <year>2009</year>             <article-title>Toward high-resolution homology modeling of antibody Fv regions and application to antibody-antigen docking.</article-title>             <source>Proteins</source>             <volume>74</volume>             <fpage>497</fpage>             <lpage>514</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Wright1">
        <label>44</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wright</surname><given-names>LM</given-names></name><name name-style="western"><surname>Brzozowski</surname><given-names>AM</given-names></name><name name-style="western"><surname>Hubbard</surname><given-names>RE</given-names></name><name name-style="western"><surname>Pike</surname><given-names>AC</given-names></name><name name-style="western"><surname>Roberts</surname><given-names>SM</given-names></name><etal/></person-group>             <year>2000</year>             <article-title>Structure of Fab hGR-2 F6. a competitive antagonist of the glucagon receptor.</article-title>             <source>Acta Crystallogr D Biol Crystallogr</source>             <volume>56</volume>             <fpage>573</fpage>             <lpage>580</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Konagurthu1">
        <label>45</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Konagurthu</surname><given-names>AS</given-names></name><name name-style="western"><surname>Whisstock</surname><given-names>JC</given-names></name><name name-style="western"><surname>Stuckey</surname><given-names>PJ</given-names></name><name name-style="western"><surname>Lesk</surname><given-names>AM</given-names></name></person-group>             <year>2006</year>             <article-title>MUSTANG: a multiple structural alignment algorithm.</article-title>             <source>Proteins</source>             <volume>64</volume>             <fpage>559</fpage>             <lpage>574</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Chandonia1">
        <label>46</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chandonia</surname><given-names>JM</given-names></name><name name-style="western"><surname>Hon</surname><given-names>G</given-names></name><name name-style="western"><surname>Walker</surname><given-names>NS</given-names></name><name name-style="western"><surname>Lo Conte</surname><given-names>L</given-names></name><name name-style="western"><surname>Koehl</surname><given-names>P</given-names></name><etal/></person-group>             <year>2004</year>             <article-title>The ASTRAL Compendium in 2004.</article-title>             <source>Nucleic Acids Res</source>             <volume>32</volume>             <fpage>D189</fpage>             <lpage>192</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Lefranc1">
        <label>47</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lefranc</surname><given-names>MP</given-names></name><name name-style="western"><surname>Pommie</surname><given-names>C</given-names></name><name name-style="western"><surname>Ruiz</surname><given-names>M</given-names></name><name name-style="western"><surname>Giudicelli</surname><given-names>V</given-names></name><name name-style="western"><surname>Foulquier</surname><given-names>E</given-names></name><etal/></person-group>             <year>2003</year>             <article-title>IMGT unique numbering for immunoglobulin and T cell receptor variable domains and Ig superfamily V-like domains.</article-title>             <source>Dev Comp Immunol</source>             <volume>27</volume>             <fpage>55</fpage>             <lpage>77</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Berman1">
        <label>48</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Berman</surname><given-names>HM</given-names></name><name name-style="western"><surname>Westbrook</surname><given-names>J</given-names></name><name name-style="western"><surname>Feng</surname><given-names>Z</given-names></name><name name-style="western"><surname>Gilliland</surname><given-names>G</given-names></name><name name-style="western"><surname>Bhat</surname><given-names>TN</given-names></name><etal/></person-group>             <year>2000</year>             <article-title>The Protein Data Bank.</article-title>             <source>Nucleic Acids Res</source>             <volume>28</volume>             <fpage>235</fpage>             <lpage>242</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Kabsch1">
        <label>49</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kabsch</surname><given-names>W</given-names></name><name name-style="western"><surname>Sander</surname><given-names>C</given-names></name></person-group>             <year>1983</year>             <article-title>Dictionary of protein secondary structure: Pattern recognition of hydrogen-bonded and geometrical features.</article-title>             <source>Biopolymers</source>             <volume>22</volume>             <fpage>2577</fpage>             <lpage>2637</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Altschul1">
        <label>50</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Madden</surname><given-names>TL</given-names></name><name name-style="western"><surname>Schäffer</surname><given-names>AA</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>J</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name><etal/></person-group>             <year>1997</year>             <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs.</article-title>             <source>Nucleic Acid Res</source>             <volume>25</volume>             <fpage>3389</fpage>             <lpage>3402</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Edgar1">
        <label>51</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Edgar</surname><given-names>RC</given-names></name></person-group>             <year>2004</year>             <article-title>MUSCLE: multple sequence alignment with high accuracy and high throughput.</article-title>             <source>Nucleic Acids Res</source>             <volume>32</volume>             <fpage>1792</fpage>             <lpage>1797</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Engh1">
        <label>52</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Engh</surname><given-names>RA</given-names></name><name name-style="western"><surname>Huber</surname><given-names>R</given-names></name></person-group>             <year>1991</year>             <article-title>Accurate bond and angle parameters for X-ray protein structure refinement.</article-title>             <source>Acta Crystallogr A</source>             <volume>47</volume>             <fpage>392</fpage>             <lpage>400</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Neal1">
        <label>53</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Neal</surname><given-names>RM</given-names></name></person-group>             <year>2000</year>             <article-title>Markov chain sampling methods for Dirichlet process mixture models.</article-title>             <source>J Comput Graph Statist</source>             <volume>9</volume>             <fpage>249</fpage>             <lpage>265</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Parsons1">
        <label>54</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Parsons</surname><given-names>J</given-names></name><name name-style="western"><surname>Holmes</surname><given-names>JB</given-names></name><name name-style="western"><surname>Rojas</surname><given-names>JM</given-names></name><name name-style="western"><surname>Tsai</surname><given-names>J</given-names></name><name name-style="western"><surname>Strauss</surname><given-names>CE</given-names></name></person-group>             <year>2005</year>             <article-title>Practical conversion from torsion space to Cartesian space for in silico protein synthesis.</article-title>             <source>J Comput Chem</source>             <volume>26</volume>             <fpage>1063</fpage>             <lpage>1068</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Zdanov1">
        <label>55</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zdanov</surname><given-names>A</given-names></name><name name-style="western"><surname>Li</surname><given-names>Y</given-names></name><name name-style="western"><surname>Bundle</surname><given-names>DR</given-names></name><name name-style="western"><surname>Deng</surname><given-names>SJ</given-names></name><name name-style="western"><surname>MacKenzie</surname><given-names>CR</given-names></name><etal/></person-group>             <year>1994</year>             <article-title>Structure of a single-chain antibody variable domain (Fv) fragment complexed with a carbohydrate antigen at 1.7-A resolution.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>91</volume>             <fpage>6423</fpage>             <lpage>6427</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Hulsmeyer1">
        <label>56</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hulsmeyer</surname><given-names>M</given-names></name><name name-style="western"><surname>Chames</surname><given-names>P</given-names></name><name name-style="western"><surname>Hillig</surname><given-names>RC</given-names></name><name name-style="western"><surname>Stanfield</surname><given-names>RL</given-names></name><name name-style="western"><surname>Held</surname><given-names>G</given-names></name><etal/></person-group>             <year>2005</year>             <article-title>A major histocompatibility complex-peptide-restricted antibody and t cell receptor molecules recognize their target by distinct binding modes: crystal structure of human leukocyte antigen (HLA)-A1-MAGE-A1 in complex with FAB-HYB3.</article-title>             <source>J Biol Chem</source>             <volume>280</volume>             <fpage>2972</fpage>             <lpage>2980</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Bizebard1">
        <label>57</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bizebard</surname><given-names>T</given-names></name><name name-style="western"><surname>Daniels</surname><given-names>R</given-names></name><name name-style="western"><surname>Kahn</surname><given-names>R</given-names></name><name name-style="western"><surname>Golinelli-Pimpaneau</surname><given-names>B</given-names></name><name name-style="western"><surname>Skehel</surname><given-names>JJ</given-names></name><etal/></person-group>             <year>1994</year>             <article-title>Refined three-dimensional structure of the Fab fragment of a murine IgGl,lambda antibody.</article-title>             <source>Acta Crystallogr D Biol Crystallogr</source>             <volume>50</volume>             <fpage>768</fpage>             <lpage>777</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002234-Jedrzejas1">
        <label>58</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Jedrzejas</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Miglietta</surname><given-names>J</given-names></name><name name-style="western"><surname>Griffin</surname><given-names>JA</given-names></name><name name-style="western"><surname>Luo</surname><given-names>M</given-names></name></person-group>             <year>1995</year>             <article-title>Structure of a monoclonal anti-ICAM-1 antibody R6.5 Fab fragment at 2.8 A resolution.</article-title>             <source>Acta Crystallogr D Biol Crystallogr</source>             <volume>51</volume>             <fpage>380</fpage>             <lpage>385</lpage>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>