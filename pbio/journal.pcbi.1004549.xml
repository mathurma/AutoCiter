<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00514</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004549</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Establishing a Statistical Link between Network Oscillations and Neural Synchrony</article-title>
<alt-title alt-title-type="running-head">Spike Synchrony and Oscillations</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Zhou</surname> <given-names>Pengcheng</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Burton</surname> <given-names>Shawn D.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Snyder</surname> <given-names>Adam C.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Smith</surname> <given-names>Matthew A.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Urban</surname> <given-names>Nathaniel N.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Kass</surname> <given-names>Robert E.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
<xref ref-type="aff" rid="aff007"><sup>7</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Program for Neural Computation, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Center for the Neural Basis of Cognition, Pittsburgh, Pennsylvania, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Biological Sciences, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Department of Ophthalmology, University of Pittsburgh, Pittsburgh, Pennsylvania, United States of America</addr-line>
</aff>
<aff id="aff005">
<label>5</label>
<addr-line>Department of Neurobiology, University of Pittsburgh, Pittsburgh, Pennsylvania, United States of America</addr-line>
</aff>
<aff id="aff006">
<label>6</label>
<addr-line>Department of Statistics, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line>
</aff>
<aff id="aff007">
<label>7</label>
<addr-line>Department of Machine Learning, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Sporns</surname> <given-names>Olaf</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Indiana University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: PZ SDB ACS REK MAS NNU. Performed the experiments: PZ SDB ACS. Analyzed the data: PZ. Contributed reagents/materials/analysis tools: PZ REK. Wrote the paper: PZ REK SDB.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">kass@stat.cmu.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>10</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>14</day>
<month>10</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>10</issue>
<elocation-id>e1004549</elocation-id>
<history>
<date date-type="received">
<day>4</day>
<month>4</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>4</day>
<month>9</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Zhou et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004549" xlink:type="simple"/>
<abstract>
<p>Pairs of active neurons frequently fire action potentials or “spikes” nearly synchronously (i.e., within 5 ms of each other). This spike synchrony may occur by chance, based solely on the neurons’ fluctuating firing patterns, or it may occur too frequently to be explicable by chance alone. When spike synchrony above chances levels is present, it may subserve computation for a specific cognitive process, or it could be an irrelevant byproduct of such computation. Either way, spike synchrony is a feature of neural data that should be explained. A point process regression framework has been developed previously for this purpose, using generalized linear models (GLMs). In this framework, the observed number of synchronous spikes is compared to the number predicted by chance under varying assumptions about the factors that affect each of the individual neuron’s firing-rate functions. An important possible source of spike synchrony is network-wide oscillations, which may provide an essential mechanism of network information flow. To establish the statistical link between spike synchrony and network-wide oscillations, we have integrated oscillatory field potentials into our point process regression framework. We first extended a previously-published model of spike-field association and showed that we could recover phase relationships between oscillatory field potentials and firing rates. We then used this new framework to demonstrate the statistical relationship between oscillatory field potentials and spike synchrony in: 1) simulated neurons, 2) <italic>in vitro</italic> recordings of hippocampal CA1 pyramidal cells, and 3) <italic>in vivo</italic> recordings of neocortical V4 neurons. Our results provide a rigorous method for establishing a statistical link between network oscillations and neural synchrony.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Spike synchrony, which is widely reported in neural systems, may contribute to information transmission within and across brain regions. Critical to this theory is the potential link between oscillatory activity and synchronous spiking. In this article we provide a method for establishing the statistical association of spike synchrony with an oscillatory local field potential. We demonstrate the value of this technique by numerical simulation together with application to both <italic>in vitro</italic> and <italic>in vivo</italic> neural recordings.</p>
</abstract>
<funding-group>
<funding-statement>PZ and REK are supported by National Institute of Mental Health (NIMH, <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.nimh.nih.gov/index.shtml">http://www.nimh.nih.gov/index.shtml</ext-link>, R01MH064537); PZ is also supported by Richard King Mellon Foundation (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://foundationcenter.org/grantmaker/rkmellon/">http://foundationcenter.org/grantmaker/rkmellon/</ext-link>) Presidential Fellowship in Life Sciences, National Institute on Drug Abuse (NIDA, <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.drugabuse.gov">http://www.drugabuse.gov</ext-link>, R90DA023426), Pennsylvania Department of Health (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.portal.state.pa.us/portal/server.pt/community/health_research_program_cure/14189">http://www.portal.state.pa.us/portal/server.pt/community/health_research_program_cure/14189</ext-link>, Formula SAP4100054842); NNU and REK are supported by National Science Foundation (NSF, <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.nsf.gov/">http://www.nsf.gov/</ext-link>, 1430208). SDB is supported by National Institute on Deafness and Other Communication Disorders (NIDCD, <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.nidcd.nih.gov/Pages/default.aspx">http://www.nidcd.nih.gov/Pages/default.aspx</ext-link>, F31DC013490); NNU is supported by NIDCD (R01DC005798 and R01DC011184); ACS is supported by National Eye Institute (NEI, <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="https://www.nei.nih.gov/">https://www.nei.nih.gov/</ext-link>, F32EY023456); MAS is supported by NEI (R01EY022928 and P30EY008098) and career development award from Research to Prevent Blindness. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="0"/>
<page-count count="25"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>A leading theory of current neuroscience is that synchronous firing of neurons driven by network-wide oscillations may encode and transmit information within and across brain regions [<xref ref-type="bibr" rid="pcbi.1004549.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1004549.ref009">9</xref>]. Supporting this theory, a number of studies have suggested that synchronous firing of action potentials or “spikes” may indeed occur in conjunction with oscillations in local field potential (LFP) [<xref ref-type="bibr" rid="pcbi.1004549.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1004549.ref014">14</xref>]. However, a missing link in this theory has been the ability to dissociate enhanced spike synchrony due to network-wide oscillations from enhanced spike synchrony that may be due to other measured or unmeasured sources. Recently, we developed a statistical framework in which the association between spike synchrony and measured covariates may be assessed [<xref ref-type="bibr" rid="pcbi.1004549.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1004549.ref016">16</xref>]. Here we show how this approach may be applied to describe the relationship between spike synchrony and oscillatory activity.</p>
<p>Using point process regression models, which take the form of generalized linear models (GLMs), our statistical framework compares the observed number of synchronous spikes within a small time window (here, 5 ms) to the number predicted by chance, under varying assumptions about the factors that affect the firing of each individual neuron [<xref ref-type="bibr" rid="pcbi.1004549.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1004549.ref016">16</xref>]. The number of synchronous spikes predicted “by chance” refers here to the number predicted under conditional independence after conditioning on the various measured factors that have been hypothesized to affect individual-neuron spiking. For example, two neurons having fluctuating stimulus-driven firing rates will produce some number of synchronous spikes even if they are acting independently. The point process regression method fits fluctuating firing rate functions for each neuron separately, then predicts the number of synchronous spikes under conditional independence (i.e., after conditioning on these fluctuating firing rates), and compares the prediction to the observed number of synchronous spikes. In this way, a single factor may be either included or excluded from the regression model in order to quantify that factor’s ability to explain the observed spike synchrony.</p>
<p>In this article, we consider the contribution of network-wide oscillations by comparing observed and predicted spike synchrony after conditioning on the phase of an LFP representing a network-wide oscillation. Thus, we predict spike synchrony with and without inclusion of LFP phase as an explanatory variable for each neuron separately. To demonstrate that increased spike synchrony is associated with a network-wide oscillation, we would begin by establishing that, without considering LFP phase, the observed number of synchronous spikes is greater than the predicted number by a statistically significant magnitude, after conditioning on both stimulus-driven firing rates and recent post-spike history effects. This would indicate a failure of the phase-free model to accurately account for spike synchrony. We would then include the LFP phase in the model, and if it succeeded in predicting spike synchrony, then we would conclude that LFP phase can explain the remaining spike synchrony. Furthermore, we could estimate the proportion of excess synchronous spikes accounted for by the LFP phase. The same procedure could be used, instead to demonstrate the role of network-wide oscillations in suppressing spike synchrony.</p>
<p>In order to carry out this general procedure, we first need to model an individual neuron’s spiking probability in terms of LFP phase. We follow [<xref ref-type="bibr" rid="pcbi.1004549.ref017">17</xref>], which recently described and assessed point process regression models that include a sinusoidal phase term. We enhance their approach by weakening the sinusoidal assumption, allowing the phase relationship to be nonparametric as in [<xref ref-type="bibr" rid="pcbi.1004549.ref018">18</xref>], and we add to the favorable results of [<xref ref-type="bibr" rid="pcbi.1004549.ref017">17</xref>] by showing that, in estimating phase relationships, the point process regression model can reduce bias and mean-squared error in comparison with the more familiar spike phase histogram approach. Using this point process regression model, we are then able to quantify the dependence of synchronous spiking on an oscillatory modulation. We illustrate the method using simulated neurons, <italic>in vitro</italic> recordings of hippocampal CA1 pyramidal cells, and <italic>in vivo</italic> recordings of neocortical V4 neurons from a behaving monkey.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Point Process Model for Spike Trains</title>
<p>We assume that the spiking of each neuron follows a point process and, following [<xref ref-type="bibr" rid="pcbi.1004549.ref019">19</xref>] (page 592), we write its conditional intensity function as <italic>λ</italic>(<italic>t</italic>∣<italic>H</italic><sub><italic>t</italic></sub>,<italic>X</italic><sub><italic>t</italic></sub>), where <italic>H</italic><sub><italic>t</italic></sub> represents the spike history (auto-history), and the covariate <italic>X</italic><sub><italic>t</italic></sub> represents other external factors. In this work, we let <italic>X</italic><sub><italic>t</italic></sub> include the stimulus and the LFP phase, denoted by <italic>X</italic><sub><italic>t</italic></sub> = (<italic>S</italic><sub><italic>t</italic></sub>,Φ<sub><italic>t</italic></sub>). We assume the conditional intensity takes a multiplicative form, which becomes additive on the log scale:
<disp-formula id="pcbi.1004549.e001"><alternatives><graphic id="pcbi.1004549.e001g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e001"/><mml:math id="M1" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mo form="prefix">log</mml:mo> <mml:mi>λ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo>Φ</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"/> <mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo>Φ</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>t</italic>* is the last spike time preceding <italic>t</italic> (see <xref ref-type="sec" rid="sec013">Materials and Methods</xref>).</p>
<p>We use splines to capture stimulus and auto-history effects, and circular splines to capture LFP phase effects. Our point process model thus takes the form of a standard generalized linear model (GLM). We also ensure identifiability by imposing a set of restrictions (Eqs (<xref ref-type="disp-formula" rid="pcbi.1004549.e048">20</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004549.e049">21</xref>)), which are implemented within a maximum likelihood estimation (MLE) algorithm. The parametric bootstrap is used for acquiring 95% confidence bands.</p>
<p>To illustrate the ability of the MLE algorithm to recover the model in <xref ref-type="disp-formula" rid="pcbi.1004549.e001">Eq (1)</xref>, we simulated 100 spike trains (<xref ref-type="fig" rid="pcbi.1004549.g001">Fig 1A</xref>) with known functions <italic>λ</italic><sub>1</sub>(<italic>t</italic>), <italic>λ</italic><sub>2</sub>(<italic>t</italic> − <italic>t</italic>*) and <italic>λ</italic><sub>3</sub>(<italic>ϕ</italic>). Using the simulated spike trains and phase of the oscillatory drive (representing a network-wide oscillation), the MLE algorithm accurately fit the underlying spike history (<xref ref-type="fig" rid="pcbi.1004549.g001">Fig 1B</xref>), stimulus (<xref ref-type="fig" rid="pcbi.1004549.g001">Fig 1C</xref>) and phase modulation (<xref ref-type="fig" rid="pcbi.1004549.g001">Fig 1D</xref>) effects. Our approach can thus accurately recover the statistical relationships between firing rate and various external factors.</p>
<fig id="pcbi.1004549.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004549.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Simulated spike trains and results of model fitting.</title>
<p>(A) Simulated spike trains in response to a fluctuating stimulus and oscillatory drive. (B,C,D) Ground truth (red) and fitted results (blue) for different terms in the firing-rate probability model. For each fitted result, we used a parametric bootstrap to determine the 95% confidence band (cyan). (B) Effect of auto-history <italic>λ</italic><sub>2</sub>(<italic>t</italic> − <italic>t</italic>*) on output firing rate. (C) Effect of stimulus <italic>λ</italic><sub>1</sub>(<italic>t</italic>) on output firing rate. (D) Phase modulation curve <italic>λ</italic><sub>3</sub>(<italic>ϕ</italic>) of firing rate.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004549.g001"/>
</fig>
<p>The model in <xref ref-type="disp-formula" rid="pcbi.1004549.e001">Eq (1)</xref> is a “full” model including stimulus, auto-history, and an oscillatory factor. Importantly, we can remove selected factors from the full model (e.g., the LFP phase modulation) and still fit the spike trains using the same procedure. Indeed, in the following results, we also fit a simplified model lacking the oscillatory factor,
<disp-formula id="pcbi.1004549.e002"><alternatives><graphic id="pcbi.1004549.e002g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e002"/><mml:math id="M2" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula></p>
</sec>
<sec id="sec004">
<title>Estimation of LFP Phase Modulation</title>
<p>Many researchers have reported that firing rate is modulated by the phase of specific network-wide oscillations in different brain areas, such as monkey V1 [<xref ref-type="bibr" rid="pcbi.1004549.ref020">20</xref>], rat hippocampus [<xref ref-type="bibr" rid="pcbi.1004549.ref021">21</xref>], rat prefrontal cortex [<xref ref-type="bibr" rid="pcbi.1004549.ref022">22</xref>], mouse olfactory bulb [<xref ref-type="bibr" rid="pcbi.1004549.ref023">23</xref>], human pedunculopontine nucleus [<xref ref-type="bibr" rid="pcbi.1004549.ref024">24</xref>], lamprey reticulospinal neuron [<xref ref-type="bibr" rid="pcbi.1004549.ref025">25</xref>], and so on. Almost all of these results [<xref ref-type="bibr" rid="pcbi.1004549.ref020">20</xref>–<xref ref-type="bibr" rid="pcbi.1004549.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1004549.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1004549.ref025">25</xref>] used spike phase histograms to show how firing rate is modulated by the oscillation. The significance of phase locking can be evaluated using Rayleigh’s Z statistic [<xref ref-type="bibr" rid="pcbi.1004549.ref022">22</xref>]. The model in <xref ref-type="disp-formula" rid="pcbi.1004549.e001">Eq (1)</xref> offers an alternative method of computing LFP phase modulation.</p>
<p>We simulated <italic>N</italic> spike trains and estimated LFP phase modulation using two different methods: 1) the classical spike phase histogram, and 2) by fitting <italic>λ</italic><sub>3</sub>(<italic>ϕ</italic>) with the point process regression of <xref ref-type="disp-formula" rid="pcbi.1004549.e001">model (1)</xref>. The true LFP phase modulation function is defined as <italic>λ</italic><sub>3</sub>(<italic>ϕ</italic>). The discrepancy between the estimated <inline-formula id="pcbi.1004549.e003"><alternatives><graphic id="pcbi.1004549.e003g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e003"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>λ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>3</mml:mn></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <italic>λ</italic><sub>3</sub>(<italic>ϕ</italic>) is measured by the integrated squared error (ISE):
<disp-formula id="pcbi.1004549.e004"><alternatives><graphic id="pcbi.1004549.e004g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e004"/><mml:math id="M4" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>ISE</mml:mtext> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>π</mml:mi></mml:mrow> <mml:mi>π</mml:mi></mml:msubsup> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mi>d</mml:mi> <mml:mi>ϕ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Using each method, we can derive point-by-point standard errors and 95% confidence bands for the LFP phase modulation. The mean integrated squared error (MISE) is then defined as:
<disp-formula id="pcbi.1004549.e005"><alternatives><graphic id="pcbi.1004549.e005g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e005"/><mml:math id="M5" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mtext>MISE</mml:mtext></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:msub><mml:mtext>ISE</mml:mtext> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"/> <mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>π</mml:mi></mml:mrow> <mml:mi>π</mml:mi></mml:msubsup> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>λ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>3</mml:mn> <mml:mi>i</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mi>d</mml:mi> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>n</italic> is the total number of data sets and <italic>i</italic> is the index of <italic>i</italic>th data set. <inline-formula id="pcbi.1004549.e006"><alternatives><graphic id="pcbi.1004549.e006g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e006"/><mml:math id="M6" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mover><mml:mi>λ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>3</mml:mn> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is computed given <italic>N</italic> repeated trials of spike train in <italic>i</italic>th data set. We can decompose MISE in terms of the sample mean <inline-formula id="pcbi.1004549.e007"><alternatives><graphic id="pcbi.1004549.e007g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e007"/><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>λ</mml:mi> <mml:mo accent="true">‾</mml:mo></mml:mover> <mml:mn>3</mml:mn></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in the form of:
<disp-formula id="pcbi.1004549.e008"><alternatives><graphic id="pcbi.1004549.e008g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e008"/><mml:math id="M8" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>π</mml:mi></mml:mrow> <mml:mi>π</mml:mi></mml:msubsup> <mml:mo>{</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>λ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>3</mml:mn> <mml:mi>i</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>}</mml:mo> <mml:mi>d</mml:mi> <mml:mi>ϕ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
which provides an estimator of variance plus bias squared.</p>
<p>The histogram method is highly dependent on the bin size for smoothing. We picked the optimal bin size that minimizes the MISE. <xref ref-type="fig" rid="pcbi.1004549.g002">Fig 2C</xref> illustrates how the MISEs of the two methods are dependent on number of trials <italic>N</italic>. Both methods achieve smaller MISEs when more data are used, but the spike phase histogram method consistently exhibits a much larger MISE than the GLM method. Indeed, the spike phase histogram MISE reaches an asymptote for high <italic>N</italic> that is much larger than the MISE of the GLM method. In <xref ref-type="fig" rid="pcbi.1004549.g002">Fig 2F</xref> we show the variance and bias separately for the two methods. These results show that the spike phase histogram method retains a large bias, explaining the MISE asymptote in <xref ref-type="fig" rid="pcbi.1004549.g002">Fig 2C</xref>. The LFP phase modulation estimated by the spike phase histogram method additionally exhibits significantly larger variance than the GLM method for small sample sizes (&lt; 17 trials).</p>
<fig id="pcbi.1004549.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004549.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Estimation of LFP phase modulation by spike phase histogram and GLM methods.</title>
<p>(A,B,D,E) Point process regression using the GLM (B,E) yields estimates of the LFP phase modulation with comparable variance but substantially lower bias than estimates made using the spike phase histogram method (A,D). (C) Comparison of the MISE between the estimated and true LFP phase modulation using the spike phase histogram and GLM methods, across different sample sizes. (F) Comparison of the variance and bias in the LFP phase modulation estimated by the two methods.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004549.g002"/>
</fig>
<p>Two additional comments can be made about the results shown above (<xref ref-type="fig" rid="pcbi.1004549.g002">Fig 2</xref>). First, when few trials or samples are available, only the GLM method can provide an accurate estimation of the LFP phase modulation of a neuron’s firing. Second, for moderately large samples, the error in the estimation of the LFP phase modulation by the spike phase histogram method arises primarily from estimation bias. We can explain this second point by considering the definitions of the two methods. The term <italic>λ</italic><sub>3</sub>(<italic>ϕ</italic>) describes how an oscillation changes the firing rate and is independent of other factors (stimulus, auto-history, etc.). In contrast, the spike phase histogram method provides the distribution of phases when a spike occurs, denoted as <italic>P</italic><sub><italic>data</italic></sub>(<italic>ϕ</italic>). Since the generation of a spike train is influenced by factors other than the oscillation, especially for a non-Poisson process, <italic>P</italic><sub><italic>data</italic></sub>(<italic>ϕ</italic>) is conceptually different than <italic>λ</italic><sub>3</sub>(<italic>ϕ</italic>). Below, we explore this conceptual difference further.</p>
<sec id="sec005">
<title>Bias in the estimation of the LFP phase modulation using the spike phase histogram method</title>
<p>To simplify our GLM, let us assume that the stimulus effect is a constant <italic>λ</italic><sub>1</sub>(<italic>t</italic>) = <italic>C</italic> and <italic>f</italic> is the frequency of the oscillation. Now the firing probability model is:
<disp-formula id="pcbi.1004549.e009"><alternatives><graphic id="pcbi.1004549.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e009"/><mml:math id="M9" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>C</mml:mi> <mml:mo>·</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Suppose we observed a spike train {<italic>u</italic><sub><italic>k</italic></sub>}. The spike phase histogram method provides an estimate of the distribution of {<italic>ϕ</italic><sub><italic>u</italic><sub><italic>k</italic></sub></sub>},
<disp-formula id="pcbi.1004549.e010"><alternatives><graphic id="pcbi.1004549.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e010"/><mml:math id="M10" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:msub><mml:mi>u</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"/> <mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mrow><mml:mo>∫</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:msub><mml:mi>u</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:msub><mml:mi>u</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:msub><mml:mi>u</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"/> <mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mrow><mml:mo>∫</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:msub><mml:mi>u</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:msub><mml:mi>u</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where <italic>P</italic><sub><italic>data</italic></sub>(<italic>ϕ</italic><sub><italic>u</italic><sub><italic>k</italic></sub></sub> = <italic>ϕ</italic>∣<italic>ϕ</italic><sub><italic>u</italic><sub><italic>k</italic> − 1</sub></sub> = <italic>ϕ</italic><sub>0</sub>) is the conditional probability of <italic>ϕ</italic><sub><italic>u</italic><sub><italic>k</italic></sub></sub> = <italic>ϕ</italic> given the phase of its previous spike is <italic>ϕ</italic><sub>0</sub>. This conditional probability can be computed using the distribution of the waiting times [<xref ref-type="bibr" rid="pcbi.1004549.ref019">19</xref>] (page 602),
<disp-formula id="pcbi.1004549.e011"><alternatives><graphic id="pcbi.1004549.e011g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e011"/><mml:math id="M11" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>exp</mml:mtext> <mml:mo>{</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>u</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>u</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>u</mml:mi> <mml:mo>}</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
If we have a spike at phase <italic>ϕ</italic>, while its previous spike is at phase <italic>ϕ</italic><sub>0</sub>, then the waiting time should be within the set <inline-formula id="pcbi.1004549.e012"><alternatives><graphic id="pcbi.1004549.e012g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e012"/><mml:math id="M12" display="inline" overflow="scroll"><mml:mrow><mml:mi>W</mml:mi> <mml:mo>=</mml:mo> <mml:mo stretchy="false">{</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mo>:</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>ϕ</mml:mi> <mml:mo>−</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mi>w</mml:mi></mml:mfrac> <mml:mo>+</mml:mo> <mml:mfrac><mml:mi>k</mml:mi> <mml:mi>f</mml:mi></mml:mfrac> <mml:mo>,</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:mi>w</mml:mi> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>f</mml:mi> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Thus
<disp-formula id="pcbi.1004549.e013"><alternatives><graphic id="pcbi.1004549.e013g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e013"/><mml:math id="M13" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:msub><mml:mi>u</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:msub><mml:mi>u</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>w</mml:mi></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"/> <mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>w</mml:mi></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>W</mml:mi></mml:mrow></mml:munder> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>u</mml:mi> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula> <xref ref-type="disp-formula" rid="pcbi.1004549.e010">Eq (3)</xref> shows that <italic>P</italic><sub><italic>data</italic></sub>(<italic>ϕ</italic>) is an eigenfunction of <italic>P</italic><sub><italic>data</italic></sub>(<italic>ϕ</italic><sub><italic>u</italic><sub><italic>k</italic></sub></sub> = <italic>ϕ</italic>∣<italic>ϕ</italic><sub><italic>u</italic><sub><italic>k</italic> − 1</sub></sub> = <italic>ϕ</italic><sub><italic>u</italic><sub><italic>k</italic> − 1</sub></sub>). This is very hard to compute analytically, but we can get its numerical solution instead. When we discretize <italic>ϕ</italic> and write <italic>P</italic><sub><italic>data</italic></sub>(<italic>ϕ</italic>) as a vector <italic>P</italic>, <xref ref-type="disp-formula" rid="pcbi.1004549.e010">Eq (3)</xref> can be rewritten as
<disp-formula id="pcbi.1004549.e014"><alternatives><graphic id="pcbi.1004549.e014g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e014"/><mml:math id="M14" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>=</mml:mo> <mml:mi>A</mml:mi> <mml:mo>·</mml:mo> <mml:mi>P</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>P</italic> ∈ ℝ<sup><italic>m</italic> × 1</sup>, <italic>m</italic> is the number of bins to discretize <italic>ϕ</italic> ∈ [−<italic>π</italic>,<italic>π</italic>), and <italic>A</italic>∈ℝ<sup><italic>m</italic> × <italic>m</italic></sup> is the transition probability
<disp-formula id="pcbi.1004549.e015"><alternatives><graphic id="pcbi.1004549.e015g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e015"/><mml:math id="M15" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:msub><mml:mi>u</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:msub><mml:mi>u</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Thus <italic>P</italic> is the eigenvector of <italic>A</italic> and its corresponding eigenvalue is 1. Numerical tools were used to compute <italic>P</italic>, which is the discrete version of <italic>P</italic><sub><italic>data</italic></sub>(<italic>ϕ</italic>). In this way we can theoretically determine the LFP phase modulation given by the spike phase histogram. This theoretical prediction accurately predicts the LFP phase modulation estimated from simulated spike trains using the spike phase histogram method (<xref ref-type="fig" rid="pcbi.1004549.g003">Fig 3B, 3C, 3E and 3F</xref>).</p>
<fig id="pcbi.1004549.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004549.g003</object-id>
<label>Fig 3</label>
<caption>
<title>LFP phase modulation estimated by the spike phase histogram method is inherently biased for non-Poisson firing.</title>
<p>(A,D) Auto-history effects for Poisson (A) and non-Poisson (D) firing. (B,C,E,F) Theoretical and simulated estimations of the LFP phase modulation for Poisson (B,C) and non-Poisson (E,F) firing at low (B,E) and high (C,F) mean firing rates. Note that, for non-Poisson firing, the spike phase histogram estimation of the LFP phase modulation introduces a firing rate-dependent bias.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004549.g003"/>
</fig>
<p>Using this theoretical prediction, we examined how bias emerges in spike phase histogram estimates of the LFP modulation. We considered Poisson and non-Poisson firing across different mean firing rates. When a neuron’s firing approximates a Poisson process (i.e., <italic>λ</italic><sub>2</sub>(<italic>t</italic>) = 1) (<xref ref-type="fig" rid="pcbi.1004549.g003">Fig 3A</xref>), the results of the spike phase histogram match <italic>λ</italic><sub>3</sub>(<italic>ϕ</italic>) independent of the mean firing rate <italic>C</italic> (<xref ref-type="fig" rid="pcbi.1004549.g003">Fig 3B and 3C</xref>). Indeed, it can be shown that <inline-formula id="pcbi.1004549.e016"><alternatives><graphic id="pcbi.1004549.e016g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e016"/><mml:math id="M16" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> is a solution to <xref ref-type="disp-formula" rid="pcbi.1004549.e010">Eq (3)</xref>. Specifically, <xref ref-type="disp-formula" rid="pcbi.1004549.e013">Eq (4)</xref> inserted into <xref ref-type="disp-formula" rid="pcbi.1004549.e010">Eq (3)</xref> with some basic substitutions yields:
<disp-formula id="pcbi.1004549.e017"><alternatives><graphic id="pcbi.1004549.e017g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e017"/><mml:math id="M17" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mi>C</mml:mi> <mml:mo>·</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>f</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>·</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>{</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>C</mml:mi> <mml:mo>·</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>f</mml:mi> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>u</mml:mi> <mml:mo>}</mml:mo> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
When <italic>λ</italic><sub>2</sub>(<italic>t</italic>) = 1, we replace <italic>P</italic><sub><italic>data</italic></sub>(<italic>ϕ</italic>) with <inline-formula id="pcbi.1004549.e018"><alternatives><graphic id="pcbi.1004549.e018g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e018"/><mml:math id="M18" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1004549.e017">Eq (5)</xref>. Then the integrand in the right side is <inline-formula id="pcbi.1004549.e019"><alternatives><graphic id="pcbi.1004549.e019g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e019"/><mml:math id="M19" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi> <mml:mo>⋅</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>−</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>f</mml:mi> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>⋅</mml:mo> <mml:mtext>exp</mml:mtext> <mml:mrow><mml:mo stretchy="true">{</mml:mo> <mml:mo>−</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>C</mml:mi> <mml:mo>⋅</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>−</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>f</mml:mi> <mml:mi>u</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mi>d</mml:mi> <mml:mi>u</mml:mi> <mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, which is a probability density function and hence has the integral of 1, making the right side <italic>λ</italic><sub>3</sub>(<italic>ϕ</italic>). Thus, <italic>λ</italic><sub>3</sub>(<italic>ϕ</italic>) is one solution of <xref ref-type="disp-formula" rid="pcbi.1004549.e010">Eq (3)</xref>. These results show that the spike phase histogram estimate of the LFP phase modulation is accurate for Poisson firing. In contrast, for non-Poisson firing (in which the neuron’s firing rate is influenced by its firing history) <italic>λ</italic><sub>2</sub>(<italic>t</italic>) is no longer a constant (<xref ref-type="fig" rid="pcbi.1004549.g003">Fig 3D</xref>). As a result, estimates of the LFP phase modulation curve diverge from <italic>λ</italic><sub>3</sub>(<italic>ϕ</italic>) in a firing rate-dependent manner (<xref ref-type="fig" rid="pcbi.1004549.g003">Fig 3E and 3F</xref>). Thus, the GLM method for estimating a neuron’s LFP phase modulation is more accurate than the spike phase histogram method for smaller sample sizes (<xref ref-type="fig" rid="pcbi.1004549.g002">Fig 2</xref>) and for non-Poisson firing (<xref ref-type="fig" rid="pcbi.1004549.g003">Fig 3</xref>).</p>
</sec>
</sec>
<sec id="sec006">
<title>Comparison with Spike Field Coherence</title>
<p>Spike field coherence (SFC) is commonly used to report interactions between spikes and specific oscillations in LFP. Lepage et al. [<xref ref-type="bibr" rid="pcbi.1004549.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1004549.ref026">26</xref>] showed that SFC is dependent on the expected rate of spiking, and they proposed to use intensity field coherence, which is a rate-independent measure, for inference of spike field synchrony. They also used GLMs to estimate spike field association [<xref ref-type="bibr" rid="pcbi.1004549.ref017">17</xref>]. In their work, they assumed that the LFP phase modulation is a sinusoidal function with period of 2<italic>π</italic>, which might not be accurate enough in some cases [<xref ref-type="bibr" rid="pcbi.1004549.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1004549.ref023">23</xref>]. In our model, to approximate this periodic function we use circular splines [<xref ref-type="bibr" rid="pcbi.1004549.ref018">18</xref>], which remain easy to fit while being more flexible than a sinusoidal function.</p>
<p>Here, we provide two examples showing that when estimating spike field relationships, the SFC can be misleading. First, we simulated spike trains with three different mean firing rates, then computed SFCs with GNU software Chronux [<xref ref-type="bibr" rid="pcbi.1004549.ref027">27</xref>]. <xref ref-type="fig" rid="pcbi.1004549.g004">Fig 4A</xref> shows that the three SFCs are different even though they were generated by the same <italic>λ</italic><sub>3</sub>(<italic>ϕ</italic>) = 1 + 0.4cos(<italic>ϕ</italic> + <italic>π</italic>). On the other hand, when we use our model to fit the LFP phase modulation functions, <xref ref-type="fig" rid="pcbi.1004549.g004">Fig 4C</xref> shows that there is no difference in phase modulation strength in these three cases. Second, we show that two neurons exhibiting different LFP phase modulations can have the same SFC (<xref ref-type="fig" rid="pcbi.1004549.g004">Fig 4B</xref>) because they have different firing rates. Again, we can use our model to distinguish these two conditions by their respective LFP phase modulation curves (<xref ref-type="fig" rid="pcbi.1004549.g004">Fig 4D</xref>).</p>
<fig id="pcbi.1004549.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004549.g004</object-id>
<label>Fig 4</label>
<caption>
<title>LFP phase modulation estimated by the GLM method does not depend on firing rate.</title>
<p>(A,C), In three simulations, we keep <italic>λ</italic><sub>3</sub>(<italic>ϕ</italic>) = 1 + 0.4cos(<italic>ϕ</italic>+<italic>π</italic>) while varying mean firing rates. The SFC method (A) reports three distinct results, while the GLM method (<bold>C</bold>) showed that the LFP phase modulations are the same. (B, D), Different combinations of firing rate and LFP phase modulation <italic>λ</italic><sub>3</sub>(<italic>ϕ</italic>) = 1 + <italic>a</italic> ⋅ cos(<italic>ϕ</italic> + <italic>π</italic>) can yield the same SFC (B), while the GLM method can distinguish the differences in LFP phase modulation (D). For each parameter set (<italic>a</italic>,firing rate), we had 200 runs. The shaded area is the 95% confidence band.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004549.g004"/>
</fig>
</sec>
<sec id="sec007">
<title>Synchrony and Oscillatory Phase</title>
<p>We now use point process regression of our GLMs Eqs (<xref ref-type="disp-formula" rid="pcbi.1004549.e001">1</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004549.e002">2</xref>) to analyze the contribution of network-wide oscillations to the synchronous spiking of two neurons. We first present numerical simulation results where ground truth is known and then apply the same technique to experimental neural recordings.</p>
<sec id="sec008">
<title>Simulation results</title>
<p>In the Introduction, we described how GLMs can be used to assess the role of some potentially relevant factors in modulating spike synchrony. We designed a scenario in which we tested the contribution of a network-wide oscillation (i.e., an oscillatory LFP) to the number of synchronous spikes observed. This scenario is illustrated schematically in <xref ref-type="fig" rid="pcbi.1004549.g005">Fig 5</xref> for two neurons. The stimulus effects (i.e., the tuning) of the two neurons are different, and both neurons’ spiking activities are influenced by their own recent spike histories. Critically, these two neurons also receive a common oscillatory signal with phase Φ<sub><italic>t</italic></sub> that modulates their firing rate, but their individual phase modulation curves are shifted (i.e., they have different preferred phases Φ<sub><italic>pref</italic></sub>). Because the preferred phase modulates the average timing of each spike in one oscillatory cycle (in this example, ∼ 10 ms), differences in preferred phase lead to a relative shift in spike timing between the two neurons. The larger this shift, the less synchronized are their spikes. As a result, the observed number of synchronized spikes is dependent on the difference of preferred phase ΔΦ<sub><italic>pref</italic></sub>.</p>
<fig id="pcbi.1004549.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004549.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Schematic illustration of the contribution of a network-wide oscillation to synchronous spiking between two neurons.</title>
<p>The firing probability of each neuron is influenced by three factors: stimulus, auto-history and an oscillatory drive. The oscillatory drive is shared by the two neurons, but each neuron exhibits a unique phase modulation curve. Spike trains of the two neurons are observed and synchronized spikes are counted (red circles).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004549.g005"/>
</fig>
<p>This simple scenario was used to demonstrate the effectiveness of the procedure, in principle, and to investigate its statistical power. The assumption that two neurons have different phase modulation curves has been reported both experimentally [<xref ref-type="bibr" rid="pcbi.1004549.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1004549.ref028">28</xref>] and theoretically [<xref ref-type="bibr" rid="pcbi.1004549.ref029">29</xref>]. Jia et al. [<xref ref-type="bibr" rid="pcbi.1004549.ref020">20</xref>] have shown that neurons in area V1 have various preferred phases and the distribution of the preferred phase can change in response to different stimuli. Richardson [<xref ref-type="bibr" rid="pcbi.1004549.ref029">29</xref>] computed analytically the modulation of the oscillatory signal for an exponential integrated-and-fire neuron. He showed that the modulation is influenced by biophysical properties of the neuron. He also showed that there is a phase lag between the peak firing rate and the peak of the oscillatory signal, which corresponds to the preferred phase in <italic>λ</italic><sub>3</sub>(<italic>ϕ</italic>), and this phase lag is dependent on properties of the neuron. Usually the oscillations near two neurons in a small area are very similar; thus the assumption that two neurons receive a common modulation is reasonable. For two neurons located far apart (e.g., two brain areas), this assumption should be useful as long as the two oscillations are coherent. This more general case is relevant to hypotheses about mechanisms of neural communication [<xref ref-type="bibr" rid="pcbi.1004549.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1004549.ref020">20</xref>].</p>
<p>To demonstrate directly the relationship between an oscillatory LFP and spike synchrony, we simulated spike trains from two neurons, then fitted models (<xref ref-type="disp-formula" rid="pcbi.1004549.e001">1</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004549.e002">2</xref>). For each model we used the estimator
<disp-formula id="pcbi.1004549.e020"><alternatives><graphic id="pcbi.1004549.e020g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e020"/><mml:math id="M20" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ζ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>12</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mtext>Observed</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>number</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>of</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>synchronized</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>spikes</mml:mtext></mml:mrow> <mml:mrow><mml:mtext>Predicted</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>number</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>of</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>synchronized</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>spikes</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
of its theoretical counterpart <italic>ζ</italic><sub>12</sub> defined in [<xref ref-type="bibr" rid="pcbi.1004549.ref016">16</xref>]. Under conditional independence, we have log <italic>ζ</italic><sub>12</sub> = 0, while conditional dependence yields either excess synchrony (log <italic>ζ</italic><sub>12</sub> &gt; 0) or suppressed synchrony (log <italic>ζ</italic><sub>12</sub> &lt; 0). We tested <italic>H</italic><sub>0</sub> : log <italic>ζ</italic><sub>12</sub> = 0 using a parametric bootstrap (see <xref ref-type="sec" rid="sec013">Materials and Methods</xref>). Results are shown in <xref ref-type="fig" rid="pcbi.1004549.g006">Fig 6</xref>. Using <xref ref-type="disp-formula" rid="pcbi.1004549.e002">model (2)</xref> (i.e., without the oscillatory factor) we found that <inline-formula id="pcbi.1004549.e021"><alternatives><graphic id="pcbi.1004549.e021g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e021"/><mml:math id="M21" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mspace width="1pt"/><mml:msub><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>12</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is dependent on ΔΦ<sub><italic>pref</italic></sub>. This is because the relative phase preference of the two neurons changed the observed number of synchronized spikes, while the predicted number is almost the same when the contribution of the oscillatory LFP is disregarded. In contrast, when we included the oscillatory factor according to <xref ref-type="disp-formula" rid="pcbi.1004549.e001">Eq (1)</xref>, we found <inline-formula id="pcbi.1004549.e022"><alternatives><graphic id="pcbi.1004549.e022g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e022"/><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mspace width="1pt"/><mml:msub><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>12</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> to be close to 0 and independent of ΔΦ<sub><italic>pref</italic></sub>. Thus, including the oscillatory factor in our model removes the apparent conditional dependence of the predicted spike synchrony on the relative phase preference of the two neurons, and we can conclude that spike synchrony is associated with the oscillatory phase.</p>
<fig id="pcbi.1004549.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004549.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Network-wide oscillations can enhance or suppress the predicted levels of spike synchrony.</title>
<p>(A) Dependence of <inline-formula id="pcbi.1004549.e023"><alternatives><graphic id="pcbi.1004549.e023g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e023"/><mml:math id="M23" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mspace width="1pt"/><mml:msub><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>12</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> on the difference in preferred phases between two neurons, as computed using models with and without an oscillatory factor. Purple and cyan arrows indicate two different Δ(Φ<sub><italic>pref</italic></sub>)s. (B) Bootstrap-generated distribution of <inline-formula id="pcbi.1004549.e024"><alternatives><graphic id="pcbi.1004549.e024g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e024"/><mml:math id="M24" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mspace width="1pt"/><mml:msub><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>12</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> values under the null hypothesis of log<italic>ζ</italic><sub>12</sub> = 0. Arrowhead shows the value of <inline-formula id="pcbi.1004549.e025"><alternatives><graphic id="pcbi.1004549.e025g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e025"/><mml:math id="M25" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mspace width="1pt"/><mml:msub><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>12</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> computed by the simplified model. Thus, a significantly larger number of synchronous spikes is observed than predicted by the model lacking an oscillatory factor (<inline-formula id="pcbi.1004549.e026"><alternatives><graphic id="pcbi.1004549.e026g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e026"/><mml:math id="M26" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mspace width="1pt"/><mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>12</mml:mn></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>057</mml:mn> <mml:mo>±</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>013</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <italic>p</italic> value = 0.0025). (C) Including an oscillatory factor in the model yields an accurate prediction of the observed number of synchronous spikes (<inline-formula id="pcbi.1004549.e027"><alternatives><graphic id="pcbi.1004549.e027g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e027"/><mml:math id="M27" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>12</mml:mn></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mo>−</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>006</mml:mn> <mml:mo>±</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>014</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <italic>p</italic> value = 0.6775). (D, E) Same as (B,C) for different preferred phases that lead to significantly lower synchrony than predicted when an oscillatory factor is not included in the model (D: <inline-formula id="pcbi.1004549.e028"><alternatives><graphic id="pcbi.1004549.e028g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e028"/><mml:math id="M28" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>12</mml:mn></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mo>−</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>082</mml:mn> <mml:mo>±</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>013</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <italic>p</italic> value = 0.0025; E: <inline-formula id="pcbi.1004549.e029"><alternatives><graphic id="pcbi.1004549.e029g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e029"/><mml:math id="M29" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>12</mml:mn></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mo>−</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>009</mml:mn> <mml:mo>±</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>015</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <italic>p</italic> value = 0.2700). (F) Dependence of the power on number of trials and <italic>ζ</italic>. The mean firing rate is 25 Hz. The red and green lines indicate choices of <italic>ζ</italic> and <italic>N</italic> for which the power equals 0.8, based on simulation and theory respectively. (G) Same as (F), but the mean firing rate is 10 Hz.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004549.g006"/>
</fig>
<p>We picked two different values of ΔΦ<sub><italic>pref</italic></sub> (purple and cyan arrows in the <xref ref-type="fig" rid="pcbi.1004549.g006">Fig 6A</xref>) to demonstrate the described hypothesis test. In the first example, we obtained evidence against the null hypothesis of log <italic>ζ</italic><sub>12</sub> = 0 using the simplified model (<xref ref-type="fig" rid="pcbi.1004549.g006">Fig 6B</xref>). That is, there is evidence that the two neurons are not conditionally independent given only the stimulus effects and spike history effects: they exhibit significant levels of excess spike synchrony. <xref ref-type="fig" rid="pcbi.1004549.g006">Fig 6C</xref> shows that including the oscillatory factor accounts for this excess synchrony. In other words, consideration of the oscillatory LFP can explain the higher than expected levels of spike synchrony predicted by the stimulus and spike history effects alone. In turn, lower than expected levels of spike synchrony predicted by the stimulus and spike history effects alone can be explained by consideration of the oscillatory LFP in the second example, in which the oscillatory LFP suppresses spike synchrony (<xref ref-type="fig" rid="pcbi.1004549.g006">Fig 6D and 6E</xref>).</p>
<p>We also investigated the amount of data needed to reliably detect excess synchrony by generating spike trains with varying numbers of trials, varying values of <italic>ζ</italic>, and two levels of firing rate, and then computing the probability of rejecting the null hypothesis (i.e., the statistical power). <xref ref-type="fig" rid="pcbi.1004549.g006">Fig 6F</xref> displays the power when we used the same simulation parameters (apart from <italic>ζ</italic> and number of trials) as in <xref ref-type="fig" rid="pcbi.1004549.g006">Fig 6A–6E</xref>. A standard target for power in the statistics literature is 0.8, and we have indicated this level of power with a red line in <xref ref-type="fig" rid="pcbi.1004549.g006">Fig 6F</xref>. Thus, to attain this high level of power when <italic>ζ</italic> = 1.125 we need 70 trials, but when <italic>ζ</italic> = 1.4 we need only 5 trials. This number is also highly dependent on the mean firing rate. When we change the firing rate from 25 Hz to 10 Hz, we need much more data to detect excess synchrony (<xref ref-type="fig" rid="pcbi.1004549.g006">Fig 6G</xref>). The simulation procedure is computationally slow, but a fast approximation is given by
<disp-formula id="pcbi.1004549.e030"><alternatives><graphic id="pcbi.1004549.e030g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e030"/><mml:math id="M30" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>N</mml:mi> <mml:mo>=</mml:mo> <mml:mo>⌈</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>T</mml:mi> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mi>δ</mml:mi></mml:mrow></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mo>Φ</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>95</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mo>Φ</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msqrt><mml:mi>ζ</mml:mi></mml:msqrt></mml:mrow> <mml:mrow><mml:mo form="prefix">log</mml:mo><mml:mspace width="1pt"/><mml:mi>ζ</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>⌉</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>T</italic> is the length of one trial, <italic>λ</italic><sub>1</sub> and <italic>λ</italic><sub>2</sub> are mean firing rates of two neurons, and <italic>δ</italic> is the bin size for detecting synchronized spikes. The approximate power from this formula is given by the green curves in <xref ref-type="fig" rid="pcbi.1004549.g006">Fig 6F and 6G</xref>. The formula is derived in <bold>Materials and Methods</bold>.</p>
</sec>
</sec>
<sec id="sec009">
<title>Applications to Experimental Neural Recordings</title>
<p>To further demonstrate the value of our approach, we next examined the relationship between an oscillatory signal and spike synchrony in experimental neural recordings from two distinct preparations: hippocampal CA1 pyramidal cells recorded <italic>in vitro</italic> and V4 neurons recorded <italic>in vivo</italic>.</p>
<sec id="sec010">
<title>Hippocampal CA1 pyramidal cells</title>
<p>We first designed an experiment to resemble the scenario proposed in <xref ref-type="fig" rid="pcbi.1004549.g005">Fig 5</xref> using whole-cell patch clamp recordings in a controllable acute slice preparation. In this experiment, we recorded the spiking response of, and spike synchrony between, two CA1 pyramidal cells (<xref ref-type="fig" rid="pcbi.1004549.g007">Fig 7A and 7B</xref>) in response to an arbitrary stimulus with and without a shared oscillatory signal. Critically, to directly test the relationship between the oscillatory signal and the resulting spike synchrony, we limited potential confounding influences on spike synchrony (e.g., common neuromodulatory influences, coupling between two neurons) by recording these neurons sequentially in two separate slices. Each neuron was injected with 100 trials of a 2 s-long 150 pA step current overlaid with a slow sinusoidal current (2 Hz frequency, 25 pA amplitude) and white noise (<italic>σ</italic> = 10 pA) to evoke physiological spike trains with low trial-to-trial reliability. The slow 2 Hz component was the same for all trials, and it generated visible time-varying fluctuations that are visible in the raster plots in <xref ref-type="fig" rid="pcbi.1004549.g007">Fig 7A and 7B</xref>, which led to a time-varying PSTH that was captured by the <italic>λ</italic><sub>1</sub>(<italic>t</italic>) term in <xref ref-type="disp-formula" rid="pcbi.1004549.e001">Eq (1)</xref>. On 50 random trials (“Exp. 2”), an additional sinusoidal current (40 Hz frequency, 15 pA amplitude) with random initial phase (but identical between the two neurons) was also injected to simulate a gamma frequency network-wide oscillation. The 40 Hz component was not consistent over trials due to varying initial phases (<xref ref-type="supplementary-material" rid="pcbi.1004549.s001">S1A Fig</xref>), and its effect is, therefore, not captured by <italic>λ</italic><sub>1</sub>(<italic>t</italic>). Instead, this 40 Hz modulatory effect was captured through the term <italic>λ</italic><sub>3</sub>(Φ<sub><italic>t</italic></sub>) in <xref ref-type="disp-formula" rid="pcbi.1004549.e001">Eq (1)</xref>.</p>
<fig id="pcbi.1004549.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004549.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Shared oscillations contribute to spike synchrony between hippocampal CA1 pyramidal cells <italic>in vitro</italic>.</title>
<p>(A, B) Reconstructed morphologies (left) and raster plots of spike trains (right) evoked in two CA1 pyramidal cells by an arbitrary stimulus waveform with a shared oscillatory signal (“Exp. 2”). Red circles show synchronized spikes between the two neurons. (C) Estimated phase modulation of the two recorded neurons in response to a shared oscillatory signal simulating a network-wide oscillation. (D) In the absence of a shared oscillatory signal, the simplified model (stimulus, or PSTH effects [P] + spike or auto-history effects [H]) lacking an oscillatory factor accurately predicts the observed number of synchronous spikes between the two neurons. (E,F) In the presence of a shared oscillatory signal, the simplified model (P + H) fails to explain the observed number of synchronous spikes (E) while the full model (stimulus, or PSTH effects [P] + spike or auto-history effects [H] + an oscillatory factor [O]) containing an oscillatory factor accurately predicts the observed number of synchronous spikes (F).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004549.g007"/>
</fig>
<p>Thus, in the 50 trials without the simulated network-wide oscillation (“Exp. 1”), each neuron fired according to the its own stimulus and auto-history effects, generating a certain level of largely spontaneous spike synchrony reflecting the neurons’ fluctuating stimulus-driven firing rates. Using our simplified model (<xref ref-type="disp-formula" rid="pcbi.1004549.e002">Eq (2)</xref>), we fit the spike trains from “Exp. 1” and predicted the number of synchronous spikes. As expected, the observed and predicted number of synchronous spikes closely matched (<xref ref-type="fig" rid="pcbi.1004549.g007">Fig 7D</xref>), consistent with the two neurons being conditionally independent given the arbitrary stimulus waveform and their own recent spiking histories. That is, no other factors were necessary to explain the observed number of synchronous spikes. However, using our simplified model to fit the spike trains from “Exp. 2” (<xref ref-type="fig" rid="pcbi.1004549.g007">Fig 7A and 7B</xref>), we observed a significantly greater number of synchronous spikes than could be explained by the stimulus and the neurons’ spike histories alone (<xref ref-type="fig" rid="pcbi.1004549.g007">Fig 7E</xref>). This conditional dependence between the two neurons arose because the firing of the two neurons was modulated by the simulated network-wide oscillation (<xref ref-type="fig" rid="pcbi.1004549.g007">Fig 7C</xref>). Indeed, using our full model (<xref ref-type="disp-formula" rid="pcbi.1004549.e001">Eq (1)</xref>) to fit the spike trains from “Exp. 2” (<xref ref-type="supplementary-material" rid="pcbi.1004549.s001">S1B, S1C and S1D Fig</xref>), the number of synchronous spikes observed closely matched the number of synchronous spikes predicted (<xref ref-type="fig" rid="pcbi.1004549.g007">Fig 7F</xref>).</p>
<p>This experiment demonstrates that when two experimentally recorded neurons are not modulated by a shared oscillatory signal, then the simplified model (<xref ref-type="disp-formula" rid="pcbi.1004549.e002">Eq (2)</xref>) can account for the observed number of synchronous spikes. However, when two neurons are modulated by a shared oscillatory signal (such as an oscillatory LFP, reflecting a network-wide oscillation), then a model including this oscillatory factor (<xref ref-type="disp-formula" rid="pcbi.1004549.e001">Eq (1)</xref>) is necessary to account for the observed number of synchronous spikes. In contrast with our simulation above, the firing of these CA1 neurons is not described by the GLM in <xref ref-type="disp-formula" rid="pcbi.1004549.e001">Eq (1)</xref> exactly. This model mismatch did not restrict the application of our method.</p>
</sec>
<sec id="sec011">
<title>V4 neurons</title>
<p>In this experiment, spike trains from a pair of neural units in V4 were simultaneously recorded (<xref ref-type="fig" rid="pcbi.1004549.g008">Fig 8A and 8D</xref>) with a multi-electrode array during a fixation task in which spontaneous activity was measured. These data have been analyzed in another paper [<xref ref-type="bibr" rid="pcbi.1004549.ref028">28</xref>], which examined the relationship between individual neuron’s activity and large-scale network state. Here we wanted to test whether network-wide oscillations contribute to the excess pairwise synchrony. For each neuron, we defined its surrounding LFP as the average of LFPs recorded at its adjacent electrodes (see <xref ref-type="sec" rid="sec013">Materials and Methods</xref>). The spike-triggered average of the LFP for two neurons showed that the two neurons are phase locked to their surrounding field potential (<xref ref-type="supplementary-material" rid="pcbi.1004549.s002">S2C and S2D Fig</xref> and [<xref ref-type="bibr" rid="pcbi.1004549.ref028">28</xref>]). We also found that the LFP showed a prominent slow oscillation (<xref ref-type="fig" rid="pcbi.1004549.g008">Fig 8B and 8E</xref>). The LFP is thought to be the integrated effect of synaptic and spiking activity [<xref ref-type="bibr" rid="pcbi.1004549.ref030">30</xref>] near the recording sites. We filtered the LFP on each electrode within the 4–25 Hz band and extracted its phase to fit our full model (<xref ref-type="disp-formula" rid="pcbi.1004549.e001">Eq (1)</xref>). Using the same procedure as in the case of the hippocampal CA1 pyramidal cells, we found that a significantly larger number of synchronous spikes were observed than could be explained by the simplified model (<xref ref-type="fig" rid="pcbi.1004549.g008">Fig 8C</xref>), while the full model fully explained the spike synchronization observed between the two neurons (<xref ref-type="fig" rid="pcbi.1004549.g008">Fig 8F</xref>). These results show that for these two neurons <italic>in vivo</italic>, spike synchronization is associated with the network-wide oscillation.</p>
<fig id="pcbi.1004549.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004549.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Shared oscillations contribute to spike synchrony between V4 neurons <italic>in vivo</italic>.</title>
<p>(A,D) Raster plot of spike trains from two neurons recorded simultaneously. Red circles show synchronized spikes between the two neurons. (B,E) Raw (blue) and 4–25 Hz filtered (red) surrounding LFP related with each neuron for a single trial. (C,F) The simplified model failed to explain the observed number of synchronous spikes (C), while the full model containing an oscillatory factor fully accounts for the observed number of synchronous spikes.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004549.g008"/>
</fig>
</sec>
</sec>
</sec>
<sec id="sec012" sec-type="conclusions">
<title>Discussion</title>
<p>In this paper, we have shown how the GLM methods of [<xref ref-type="bibr" rid="pcbi.1004549.ref015">15</xref>–<xref ref-type="bibr" rid="pcbi.1004549.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1004549.ref026">26</xref>] may be combined in order to assess the potential contribution of network-wide oscillations to neural synchrony. The novel approach presented in this study complements existing alternatives [<xref ref-type="bibr" rid="pcbi.1004549.ref031">31</xref>–<xref ref-type="bibr" rid="pcbi.1004549.ref033">33</xref>] by: introducing models of single neuron firing based on stimulus-related fluctuations as well as a network-wide oscillatory signal; using those models to make predictions about spike synchronization; and quantifying departures from those predictions in the observed data. We demonstrated the advantages of this novel approach using both neural simulations and experimental neural recordings <italic>in vitro</italic> and <italic>in vivo</italic>.</p>
<p>In our analyses, we have utilized a repeated-trial structure, which allowed us to estimate the stimulus effects as a function of time, <italic>λ</italic><sub>1</sub>(<italic>t</italic>). We note, however, that the same approach could be applied using a linear response filter [<xref ref-type="bibr" rid="pcbi.1004549.ref034">34</xref>–<xref ref-type="bibr" rid="pcbi.1004549.ref036">36</xref>] or analogous nonlinear methods. Previous work has shown the close relationship between GLM neurons and integrate-and-fire neurons [<xref ref-type="bibr" rid="pcbi.1004549.ref037">37</xref>–<xref ref-type="bibr" rid="pcbi.1004549.ref039">39</xref>]. We only considered one band of oscillation in simulation and experimental examples, but it is straightforward to extend this method to the case of multiple oscillations by including additional terms in the model of <xref ref-type="disp-formula" rid="pcbi.1004549.e001">Eq (1)</xref>. Sometimes the firing probability may be related to the amplitude of the oscillation <italic>A</italic><sub><italic>t</italic></sub>, or the magnitude of an LFP <italic>B</italic><sub><italic>t</italic></sub> (cf. [<xref ref-type="bibr" rid="pcbi.1004549.ref017">17</xref>]). If so, we can change <italic>f</italic><sub>3</sub>(Φ<sub><italic>t</italic></sub>) to <italic>f</italic><sub>3</sub>(<italic>A</italic><sub><italic>t</italic></sub>) or <italic>f</italic><sub>3</sub>(<italic>B</italic><sub><italic>t</italic></sub>). Overall, the key step of this method is to build an approximately correct GLM. The specific form of GLM depends on the data and we can check model performance using time rescaling [<xref ref-type="bibr" rid="pcbi.1004549.ref040">40</xref>]. We have also included a simulation to show that even when the model is mis-specified, and therefore less sensitive, it can detect spike-LFP relationships (<xref ref-type="supplementary-material" rid="pcbi.1004549.s003">S3 Fig</xref>). We have also defined spike synchrony to involve the firing of two neurons within a few milliseconds of each other (i.e., with zero lag on average). In other contexts, however, interest may focus on two neurons firing in procession with a consistent positive or negative lag of many milliseconds. Our approach could be easily applied to such lagged-synchrony cases as well.</p>
<p>In this paper, we consider only pairwise synchrony. By combining our approach with the procedure proposed by [<xref ref-type="bibr" rid="pcbi.1004549.ref016">16</xref>], we can also test the role of oscillations in three-way synchrony. Briefly, we fit all single neuron firing probabilities and then compute the pairwise synchrony coefficients <inline-formula id="pcbi.1004549.e031"><alternatives><graphic id="pcbi.1004549.e031g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e031"/><mml:math id="M31" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>; we can then use an iterative algorithm to estimate the three-way synchrony coefficient <inline-formula id="pcbi.1004549.e032"><alternatives><graphic id="pcbi.1004549.e032g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e032"/><mml:math id="M32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and to test the null hypothesis of two-way interactions, instead of three-way interaction. In principle the same steps may be followed for more than three neurons, but simulations in [<xref ref-type="bibr" rid="pcbi.1004549.ref016">16</xref>] show that very large data sets would be needed in order to demonstrate higher-order interactions convincingly in the absence of stronger assumptions about the nature of those interactions.</p>
<p>It has been argued that synchronous firing resulting from network-wide oscillations could provide an essential mechanism of network information flow, and further serve as a a marker distinguishing normal from diseased states (e.g., see [<xref ref-type="bibr" rid="pcbi.1004549.ref041">41</xref>–<xref ref-type="bibr" rid="pcbi.1004549.ref048">48</xref>]). On the other hand, there has been considerable debate on this subject (see [<xref ref-type="bibr" rid="pcbi.1004549.ref049">49</xref>] and references therein). We remain agnostic on this, and importantly, the value of our methods does not depend on the ultimate outcome of this debate. Instead, we view synchrony, more descriptively, as a feature of spike train data that needs to be explained. To this end, the framework that we have introduced here is useful for quantifying the extent to which oscillations, as a feature of neural activity, are associated with synchronous spiking among neurons. Armed with this method, future experiments can measure oscillations and synchrony in a statistical framework in which their contributions to cognitive and behavioral processes can be accurately quantified.</p>
</sec>
<sec id="sec013" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec014">
<title>Point-Process Framework</title>
<p>In a continuous time interval (0,<italic>T</italic>], a neuron can fire a spike at any discrete time point <italic>u</italic><sub><italic>i</italic></sub>. A series of spikes {<italic>u</italic><sub><italic>i</italic></sub>} for 1 ≤ <italic>i</italic> ≤ <italic>N</italic> forms the spike train, where 0 ≤ <italic>u</italic><sub>1</sub> &lt; ⋯ &lt; <italic>u</italic><sub><italic>N</italic></sub> ≤ <italic>T</italic>. We take the spike train to be a point process, which is characterized by its conditional intensity function
<disp-formula id="pcbi.1004549.e033"><alternatives><graphic id="pcbi.1004549.e033g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e033"/><mml:math id="M33" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo movablelimits="true" form="prefix">lim</mml:mo> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mo>→</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:munder> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mo>[</mml:mo> <mml:mrow><mml:mi>N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
where <italic>N</italic>(<italic>t</italic>) is the total number of spikes prior to time <italic>t</italic>, <italic>H</italic><sub><italic>t</italic></sub> is neuron’s own spiking history prior to time <italic>t</italic>, and <italic>X</italic><sub><italic>t</italic></sub> includes all other relevant covariates. When Δ is small, <italic>λ</italic>(<italic>t</italic>∣<italic>H</italic><sub><italic>t</italic></sub>,<italic>X</italic><sub><italic>t</italic></sub>) ⋅ Δ approximates to the firing probability in the time interval (<italic>t</italic>, <italic>t</italic> + Δ). To determine how different factors contribute to firing rate we write <italic>λ</italic>(<italic>t</italic>∣<italic>H</italic><sub><italic>t</italic></sub>,<italic>X</italic><sub><italic>t</italic></sub>) as a function of (<italic>H</italic><sub><italic>t</italic></sub>,<italic>X</italic><sub><italic>t</italic></sub>)
<disp-formula id="pcbi.1004549.e034"><alternatives><graphic id="pcbi.1004549.e034g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e034"/><mml:math id="M34" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
We can include different factors into this model and study their effects. Usually the stimulus <italic>S</italic>(<italic>t</italic>) is included when neurons show selectivity to stimuli. In this work, because we are interested in phase modulation by an oscillatory signal, the phase of the specific oscillation Φ(<italic>t</italic>) is also included.</p>
</sec>
<sec id="sec015">
<title>Generalized Linear Model and Maximum Likelihood Estimation</title>
<p>To take advantage of the generalized linear model (GLM) framework we divide T into K equally spaced bins, thus taking the bin width to be Δ = <italic>T</italic>/<italic>K</italic>. Δ is small enough that no more than one spike event in each bin, e.g. Δ = 1 ms. Therefore the probability of observing one spike in <italic>k</italic>th bin is
<disp-formula id="pcbi.1004549.e035"><alternatives><graphic id="pcbi.1004549.e035g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e035"/><mml:math id="M35" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:mo>,</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
Using the vector <italic>Y</italic> ⊂ ℝ<sup><italic>K</italic> × 1</sup> to represent the spike train {<italic>u</italic><sub><italic>i</italic></sub>}, <italic>y</italic><sub><italic>k</italic></sub> is the number of spikes in <italic>k</italic>th bin. Since we choose small bin width Δ, <italic>y</italic><sub><italic>k</italic></sub> is not bigger than 1, i.e. <italic>y</italic><sub><italic>k</italic></sub> ∈ {0,1} and, from the Poisson approximation to the binomial for small <italic>p</italic> we take the probability of observing <italic>y</italic><sub><italic>k</italic></sub> given <italic>H</italic><sub><italic>t</italic><sub><italic>k</italic></sub></sub> and <italic>X</italic><sub><italic>t</italic><sub><italic>k</italic></sub></sub> to be
<disp-formula id="pcbi.1004549.e036"><alternatives><graphic id="pcbi.1004549.e036g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e036"/><mml:math id="M36" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>p</mml:mi> <mml:mi>k</mml:mi> <mml:msub><mml:mi>y</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msubsup> <mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>!</mml:mo></mml:mrow></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
where <italic>t</italic><sub><italic>k</italic></sub> = <italic>k</italic>Δ. The loglikelihood function is
<disp-formula id="pcbi.1004549.e037"><alternatives><graphic id="pcbi.1004549.e037g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e037"/><mml:math id="M37" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mo stretchy="false">[</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>·</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo stretchy="false">]</mml:mo> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mo stretchy="false">[</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>·</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mi>λ</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mo>-</mml:mo> <mml:mi>λ</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:msub><mml:mi>t</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
and this is maximized to determine the MLE fit.</p>
<p>We assume that log[<italic>λ</italic>(<italic>t</italic>∣<italic>H</italic><sub><italic>t</italic></sub>,<italic>X</italic><sub><italic>t</italic></sub>)] can be written as a sum of specific functions of each covariate. Here we are studying three factors, stimulus, recent post-spike auto-history, and oscillatory phase, and we write
<disp-formula id="pcbi.1004549.e038"><alternatives><graphic id="pcbi.1004549.e038g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e038"/><mml:math id="M38" display="block" overflow="scroll"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mo>[</mml:mo> <mml:mi>λ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>stimulus</mml:mtext> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>auto-history</mml:mtext> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>oscillation</mml:mtext> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula> <disp-formula id="pcbi.1004549.e039"><alternatives><graphic id="pcbi.1004549.e039g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e039"/><mml:math id="M39" display="block" overflow="scroll"><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo>Φ</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(12)</label></disp-formula>
Here, <italic>S</italic>(<italic>t</italic>) is a possibly time-varying stimulus and <italic>f</italic><sub>1</sub>(stimulus) determines the trial-independent time-varying firing rate, i.e., the effect that is usually associated with the peri-stimulus time histogram (the PSTH), which may be estimated due to the repeated trial structure of the experiment. The recent post-spike auto-history effect is assumed here to be dominated by effects subsequent to the most recent spike <italic>t</italic>* prior to time <italic>t</italic>, as in [<xref ref-type="bibr" rid="pcbi.1004549.ref050">50</xref>], so we assume <italic>f</italic><sub>2</sub>(auto-history) has the form <italic>f</italic><sub>2</sub>(<italic>t</italic> − <italic>t</italic>*). The oscillatory term <italic>f</italic><sub>3</sub>(oscillation) is defined as <italic>f</italic><sub>3</sub>(Φ<sub><italic>t</italic></sub>), where Φ<sub><italic>t</italic></sub> is the phase of specific oscillation. In summary, our spike train model has the form
<disp-formula id="pcbi.1004549.e040"><alternatives><graphic id="pcbi.1004549.e040g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e040"/><mml:math id="M40" display="block" overflow="scroll"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mo>(</mml:mo> <mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo>Φ</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(13)</label></disp-formula> <disp-formula id="pcbi.1004549.e041"><alternatives><graphic id="pcbi.1004549.e041g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e041"/><mml:math id="M41" display="block" overflow="scroll"><mml:mo>=</mml:mo><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo>Φ</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula>
and we will assume <italic>f</italic><sub>1</sub>(⋅), <italic>f</italic><sub>2</sub>(⋅) and <italic>f</italic><sub>3</sub>(⋅) are smooth functions.</p>
</sec>
<sec id="sec016">
<title>Approximate Function with Spline Basis</title>
<p>To fit the smooth functions <italic>f</italic><sub>1</sub>(⋅), <italic>f</italic><sub>2</sub>(⋅) and <italic>f</italic><sub>3</sub>(⋅) we use cubic splines of the form
<disp-formula id="pcbi.1004549.e042"><alternatives><graphic id="pcbi.1004549.e042g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e042"/><mml:math id="M42" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mi>λ</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msub><mml:mi>b</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:munder> <mml:msub><mml:mi>r</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo>Φ</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
where {<italic>a</italic><sub><italic>i</italic></sub>(<italic>t</italic>)} is a B-spline basis set for <italic>f</italic><sub>1</sub>(<italic>t</italic>) within the range <italic>t</italic> ∈ (0,<italic>T</italic>], <inline-formula id="pcbi.1004549.e043"><alternatives><graphic id="pcbi.1004549.e043g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e043"/><mml:math id="M43" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">{</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>−</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>t</mml:mi><mml:mo>*</mml:mo></mml:msubsup> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is a B-spline basis set for <italic>f</italic><sub>2</sub>(<italic>t</italic> − <italic>t</italic>*), and {<italic>r</italic><sub><italic>k</italic></sub>(<italic>ϕ</italic>)} is circular spline basis set for <italic>f</italic><sub>3</sub>(Φ<sub><italic>t</italic></sub>). Thus, we use maximum likelihood to fit the coefficients <bold>Θ</bold> = {<italic>α</italic>,<italic>β</italic>,<italic>γ</italic>}. We used open source software FDAfuns [<xref ref-type="bibr" rid="pcbi.1004549.ref051">51</xref>] to create each B-spline basis sets after manually selecting knots. For the circular spline we pick knots equally spaced in [−<italic>π</italic>,<italic>π</italic>]. Once we get all knots {<italic>ϕ</italic><sub><italic>i</italic></sub>}, acquiring the related basis function is straightforward [<xref ref-type="bibr" rid="pcbi.1004549.ref018">18</xref>] using
<disp-formula id="pcbi.1004549.e044"><alternatives><graphic id="pcbi.1004549.e044g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e044"/><mml:math id="M44" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>∞</mml:mi></mml:munderover> <mml:mfrac><mml:mn>2</mml:mn> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>m</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>4</mml:mn></mml:msup></mml:mfrac> <mml:mo form="prefix">cos</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>m</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
In numerical implementations, we usually cut the summation from <italic>m</italic> = 1 to <italic>m</italic> = 4 because amplitude of each term decreases quickly.</p>
</sec>
<sec id="sec017">
<title>Maximum Likelihood via Iteratively Re-weighted Least Squares</title>
<p>Because <italic>L</italic> in <xref ref-type="disp-formula" rid="pcbi.1004549.e037">Eq (10)</xref> is a concave function, we can use iteratively reweighted least squares (IRLS), as in typical GLM implementations. From Eqs (<xref ref-type="disp-formula" rid="pcbi.1004549.e035">8</xref>), (<xref ref-type="disp-formula" rid="pcbi.1004549.e037">10</xref>), and (<xref ref-type="disp-formula" rid="pcbi.1004549.e042">15</xref>), we can rewrite loglikelihood in matrix form
<disp-formula id="pcbi.1004549.e045"><alternatives><graphic id="pcbi.1004549.e045g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e045"/><mml:math id="M45" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msup><mml:mi>Y</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>·</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>×</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:msub> <mml:mo>·</mml:mo> <mml:mi>μ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula> <disp-formula id="pcbi.1004549.e046"><alternatives><graphic id="pcbi.1004549.e046g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e046"/><mml:math id="M46" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>[</mml:mo> <mml:mi>A</mml:mi> <mml:mo>·</mml:mo> <mml:mi>α</mml:mi> <mml:mo>+</mml:mo> <mml:mi>B</mml:mi> <mml:mo>·</mml:mo> <mml:mi>β</mml:mi> <mml:mo>+</mml:mo> <mml:mi>R</mml:mi> <mml:mo>·</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>]</mml:mo> <mml:mo>Δ</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
Here we have three parameter sets to fit {<italic>α</italic>,<italic>β</italic>,<italic>γ</italic>}. If we fit all three parameter sets together, the dimension space of this GLM model is relative large. To make model fitting efficient, we prefer back-fitting, i.e., fitting each parameter set separately, and iterating cyclically. For example, when we fit the parameters {<italic>α</italic>}, we hold the parameters {<italic>β</italic>,<italic>γ</italic>} constant and rewrite <xref ref-type="disp-formula" rid="pcbi.1004549.e046">Eq (18)</xref> as
<disp-formula id="pcbi.1004549.e047"><alternatives><graphic id="pcbi.1004549.e047g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e047"/><mml:math id="M47" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>=</mml:mo> <mml:mi>V</mml:mi> <mml:mo>·</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>+</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula>
where <italic>θ</italic> ∈ {<italic>α</italic>,<italic>β</italic>,<italic>γ</italic>} and <italic>V</italic> is the corresponding covariate matrix. We fit {<italic>α</italic>,<italic>β</italic>,<italic>γ</italic>} in a sequence and then iterate the loop until convergence. We also must place identifiability restrictions on {<italic>β</italic>,<italic>γ</italic>} because both the auto-history and oscillatory effects modulate the spike trains and the parameters must be constrained to provide unique solutions. We use the constraints
<disp-formula id="pcbi.1004549.e048"><alternatives><graphic id="pcbi.1004549.e048g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e048"/><mml:math id="M48" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo form="prefix">exp</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>b</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>]</mml:mo> <mml:mi>d</mml:mi> <mml:mi>τ</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:mfrac> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula> <disp-formula id="pcbi.1004549.e049"><alternatives><graphic id="pcbi.1004549.e049g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e049"/><mml:math id="M49" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>π</mml:mi></mml:mrow> <mml:mi>π</mml:mi></mml:msubsup> <mml:mo form="prefix">exp</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>r</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>(</mml:mo> <mml:mo>Φ</mml:mo> <mml:mo>)</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>]</mml:mo> <mml:mi>d</mml:mi> <mml:mo>Φ</mml:mo></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula></p>
<p>To avoid over-fitting of the model, we also add an <italic>l</italic><sub>2</sub> penalty into the objective function. Now the problem becomes minimizing objective function
<disp-formula id="pcbi.1004549.e050"><alternatives><graphic id="pcbi.1004549.e050g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e050"/><mml:math id="M50" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Q</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>L</mml:mi> <mml:mo>+</mml:mo> <mml:mfrac><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:mfrac> <mml:msub><mml:mrow><mml:mo>|</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msup><mml:mi>Y</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>·</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>V</mml:mi> <mml:mo>·</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>+</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>×</mml:mo> <mml:mi>K</mml:mi></mml:mrow></mml:msub> <mml:mo>·</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>V</mml:mi> <mml:mo>·</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>+</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>·</mml:mo> <mml:msup><mml:mo>Θ</mml:mo> <mml:mi>T</mml:mi></mml:msup> <mml:mo>Θ</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
Because the objective function <italic>Q</italic> is convex, we can iteratively maximize Θ by following the updating rule
<disp-formula id="pcbi.1004549.e051"><alternatives><graphic id="pcbi.1004549.e051g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e051"/><mml:math id="M51" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mo>Θ</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msup><mml:mo>Θ</mml:mo> <mml:mi>i</mml:mi></mml:msup> <mml:mo>-</mml:mo> <mml:msup><mml:mi>H</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>·</mml:mo> <mml:mo>∇</mml:mo> <mml:mi>Q</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
where <italic>H</italic> is the Hessian of Q and ∇<italic>Q</italic> is the gradient of the function, which are obtained as
<disp-formula id="pcbi.1004549.e052"><alternatives><graphic id="pcbi.1004549.e052g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e052"/><mml:math id="M52" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∇</mml:mo> <mml:mi>Q</mml:mi> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msup><mml:mi>V</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>[</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mi>V</mml:mi> <mml:mo>·</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>+</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>)</mml:mo> <mml:mo>-</mml:mo> <mml:mi>Y</mml:mi> <mml:mo>]</mml:mo> <mml:mo>+</mml:mo> <mml:mi>λ</mml:mi> <mml:mo>Θ</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula> <disp-formula id="pcbi.1004549.e053"><alternatives><graphic id="pcbi.1004549.e053g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e053"/><mml:math id="M53" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>H</mml:mi> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msup><mml:mi>V</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mo>·</mml:mo> <mml:mi>W</mml:mi> <mml:mo>·</mml:mo> <mml:mi>V</mml:mi> <mml:mo>+</mml:mo> <mml:mi>λ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula>
where <italic>W</italic> is a diagonal matrix
<disp-formula id="pcbi.1004549.e054"><alternatives><graphic id="pcbi.1004549.e054g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e054"/><mml:math id="M54" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>W</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo form="prefix">exp</mml:mo> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>V</mml:mi> <mml:mo>·</mml:mo> <mml:mo>Θ</mml:mo> <mml:mo>+</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd/></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn> <mml:mspace width="2.em"/></mml:mrow></mml:mtd> <mml:mtd><mml:mtext>otherwise.</mml:mtext></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula>
The algorithm is summarized as <bold>Algorithm 1</bold>, shown below.</p>
<p specific-use="line"><bold>Algorithm 1</bold>: IRLS method for finding argmin<sub>Θ</sub> <italic>Q</italic>(Θ)</p>
<p specific-use="line"> <bold>Data</bold>: <inline-formula id="pcbi.1004549.e055"><alternatives><graphic id="pcbi.1004549.e055g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e055"/><mml:math id="M55" display="inline" overflow="scroll"><mml:mrow><mml:mi>Y</mml:mi> <mml:mo>,</mml:mo> <mml:mi>V</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mtext>log</mml:mtext> <mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>λ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
<p specific-use="line"> <bold>Result</bold>: Θ* = argmin<sub>Θ</sub> <italic>Q</italic>(Θ)</p>
<p specific-use="line"> <bold>begin</bold></p>
<p specific-use="line">  <italic>Q</italic><sub>1</sub> ← <italic>Q</italic>(Θ<sub>0</sub>);</p>
<p specific-use="line">  <bold>repeat</bold></p>
<p specific-use="line">   <italic>Q</italic><sub>0</sub> ← <italic>Q</italic><sub>1</sub>;</p>
<p specific-use="line">   <inline-formula id="pcbi.1004549.e056"><alternatives><graphic id="pcbi.1004549.e056g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e056"/><mml:math id="M56" display="inline" overflow="scroll"><mml:mrow><mml:mo>∇</mml:mo> <mml:mi>Q</mml:mi> <mml:mo>←</mml:mo> <mml:msup><mml:mi>V</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mrow><mml:mo stretchy="true">[</mml:mo> <mml:mtext>exp</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:mi>V</mml:mi> <mml:mo>⋅</mml:mo> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mtext>log</mml:mtext> <mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo stretchy="false">)</mml:mo> <mml:mo>−</mml:mo> <mml:mi>Y</mml:mi> <mml:mo stretchy="true">]</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>λ</mml:mi> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>;</p>
<p specific-use="line">   <inline-formula id="pcbi.1004549.e057"><alternatives><graphic id="pcbi.1004549.e057g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e057"/><mml:math id="M57" display="inline" overflow="scroll"><mml:mrow><mml:mi>W</mml:mi> <mml:mo>←</mml:mo> <mml:mtext mathvariant="normal">diag</mml:mtext> <mml:mrow><mml:mo stretchy="true">{</mml:mo> <mml:mtext>exp</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:mi>V</mml:mi> <mml:mo>⋅</mml:mo> <mml:msub><mml:mo>Θ</mml:mo> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mtext>log</mml:mtext> <mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>t</mml:mi> <mml:mn>0</mml:mn></mml:msubsup> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>;</p>
<p specific-use="line">   <italic>H</italic> ← <italic>V</italic><sup><italic>T</italic></sup> ⋅ <italic>W</italic> ⋅ <italic>V</italic>+<italic>λ</italic>;</p>
<p specific-use="line">   Θ<sub>1</sub> ← Θ<sub>0</sub> − <italic>H</italic><sup>−1</sup> ⋅ ∇<italic>Q</italic>;</p>
<p specific-use="line">   <italic>Q</italic><sub>1</sub> ← <italic>Q</italic>(Θ<sub>1</sub>);</p>
<p specific-use="line">   Θ<sub>0</sub> ← Θ<sub>1</sub>;</p>
<p specific-use="line">  <bold>until</bold> ∣<italic>Q</italic><sub>1</sub> − <italic>Q</italic><sub>0</sub>∣ ≤ <italic>δ</italic>;</p>
<p specific-use="line">  <bold>return</bold> Θ<sub>1</sub>;</p>
<p specific-use="line"> <bold>end</bold></p>
</sec>
<sec id="sec018">
<title>Spike Synchronization</title>
<p>For a pair of neurons labeled 1 and 2, we fit conditional firing rate for each of them to get <inline-formula id="pcbi.1004549.e058"><alternatives><graphic id="pcbi.1004549.e058g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e058"/><mml:math id="M58" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>λ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">∣</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004549.e059"><alternatives><graphic id="pcbi.1004549.e059g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e059"/><mml:math id="M59" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>λ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">∣</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Then we can predict the number of synchronized spikes given temporal bins with Δ = 5<italic>ms</italic>, as in [<xref ref-type="bibr" rid="pcbi.1004549.ref015">15</xref>], using
<disp-formula id="pcbi.1004549.e060"><alternatives><graphic id="pcbi.1004549.e060g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e060"/><mml:math id="M60" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>r</mml:mi> <mml:mi>e</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(27)</label></disp-formula>
Given spike trains from these two neurons, we can also get the observed number of synchronized spikes <italic>N</italic><sub><italic>obs</italic></sub> by counting. If a pair of spikes from two neurons has an time interval less than 5 <italic>ms</italic>, then this pair is counted as a synchronized spike. Synchrony is measured by taking the ratio of these two numbers <inline-formula id="pcbi.1004549.e061"><alternatives><graphic id="pcbi.1004549.e061g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e061"/><mml:math id="M61" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> or <inline-formula id="pcbi.1004549.e062"><alternatives><graphic id="pcbi.1004549.e062g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e062"/><mml:math id="M62" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mspace width="1pt"/><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> <disp-formula id="pcbi.1004549.e063"><alternatives><graphic id="pcbi.1004549.e063g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e063"/><mml:math id="M63" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>ζ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>b</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>r</mml:mi> <mml:mi>e</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(28)</label></disp-formula>
When two neurons are conditional independent, <xref ref-type="disp-formula" rid="pcbi.1004549.e060">Eq (27)</xref> can make relative good predictions and <inline-formula id="pcbi.1004549.e064"><alternatives><graphic id="pcbi.1004549.e064g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e064"/><mml:math id="M64" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mo>≈</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> (or <inline-formula id="pcbi.1004549.e065"><alternatives><graphic id="pcbi.1004549.e065g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e065"/><mml:math id="M65" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mspace width="1pt"/><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mo>≈</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>).</p>
</sec>
<sec id="sec019">
<title>Bootstrap Method</title>
<p>Once we have <inline-formula id="pcbi.1004549.e066"><alternatives><graphic id="pcbi.1004549.e066g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e066"/><mml:math id="M66" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mspace width="1pt"/><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, we also need to determine its standard error and confidence interval. Furthermore, a <italic>p</italic> value is required to test the hypothesis <inline-formula id="pcbi.1004549.e067"><alternatives><graphic id="pcbi.1004549.e067g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e067"/><mml:math id="M67" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mspace width="1pt"/><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. We use a parametric bootstrap method for these purposes, as in [<xref ref-type="bibr" rid="pcbi.1004549.ref016">16</xref>]. For example, given <inline-formula id="pcbi.1004549.e068"><alternatives><graphic id="pcbi.1004549.e068g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e068"/><mml:math id="M68" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>λ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">∣</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004549.e069"><alternatives><graphic id="pcbi.1004549.e069g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e069"/><mml:math id="M69" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>λ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">∣</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> we can obtain the <italic>p</italic> value as follows:</p>
<list list-type="bullet">
<list-item>
<p>For <italic>i</italic> in 1 : <italic>G</italic> do
<list list-type="order"><list-item><p>Simulate each of the two sets of spike trains, across the same number of trials as in the data, using the respective spike train models with <inline-formula id="pcbi.1004549.e070"><alternatives><graphic id="pcbi.1004549.e070g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e070"/><mml:math id="M70" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>λ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004549.e071"><alternatives><graphic id="pcbi.1004549.e071g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e071"/><mml:math id="M71" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>λ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item> <list-item><p>Compute log <italic>ζ</italic><sub><italic>i</italic></sub> from the spike trains generated in step 1.</p></list-item></list></p>
</list-item>
<list-item>
<p>Compute the number of values {log <italic>ζ</italic><sub><italic>i</italic></sub>} (out of a total of <italic>G</italic> such values) for which <inline-formula id="pcbi.1004549.e072"><alternatives><graphic id="pcbi.1004549.e072g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e072"/><mml:math id="M72" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo stretchy="true">∣</mml:mo> <mml:mrow><mml:mo stretchy="true">{</mml:mo> <mml:mtext>log</mml:mtext><mml:mspace width="1pt"/><mml:msub><mml:mi>ζ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="true">}</mml:mo></mml:mrow> <mml:mo stretchy="true">∣</mml:mo></mml:mrow> <mml:mo>&gt;</mml:mo> <mml:mo stretchy="false">∣</mml:mo> <mml:mtext>log</mml:mtext><mml:mspace width="1pt"/><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mo stretchy="false">∣</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and divide by <italic>G</italic>. This is the <italic>p</italic> value.</p>
</list-item>
</list>
</sec>
<sec id="sec020">
<title>Power Analysis</title>
<p>Statistical power is the probability of correctly rejecting the null hypothesis when it is false. We used the GLM model in <xref ref-type="disp-formula" rid="pcbi.1004549.e001">Eq (1)</xref> to study power as a function of <italic>ζ</italic> and <italic>N</italic> (N being the number of trials). We simulated <italic>N</italic> trials of spike train data for each of two neurons, independently, using <xref ref-type="disp-formula" rid="pcbi.1004549.e001">Eq (1)</xref> with intensity functions <italic>λ</italic><sup>(1)</sup>(<italic>t</italic>∣<italic>H</italic><sub><italic>t</italic></sub>,<italic>X</italic><sub><italic>t</italic></sub>) for the first neuron and <italic>λ</italic><sup>(2)</sup>(<italic>t</italic>∣<italic>H</italic><sub><italic>t</italic></sub>,<italic>X</italic><sub><italic>t</italic></sub>) for the second. The synchronous spikes in the resulting spike trains occur with probability corresponding to <italic>ζ</italic> = 1 (independence). In order to obtain sets of spike trains for other values of <italic>ζ</italic> we removed all the synchronous spikes from the <italic>N</italic> simulated spike trains and replaced them with synchronous spikes generated from an intensity function <italic>ζ</italic> ⋅ <italic>λ</italic><sub>1</sub>(<italic>t</italic>∣<italic>H</italic><sub><italic>t</italic></sub>,<italic>X</italic><sub><italic>t</italic></sub>) ⋅ <italic>λ</italic><sub>2</sub>(<italic>t</italic>∣<italic>H</italic><sub><italic>t</italic></sub>,<italic>X</italic><sub><italic>t</italic></sub>), i.e., for each time bin of width <italic>δ</italic>, synchronous spikes occurred with probability <italic>ζ</italic> ⋅ <italic>λ</italic><sub>1</sub>(<italic>t</italic>∣<italic>H</italic><sub><italic>t</italic></sub>,<italic>X</italic><sub><italic>t</italic></sub>) ⋅ <italic>λ</italic><sub>2</sub>(<italic>t</italic>∣<italic>H</italic><sub><italic>t</italic></sub>,<italic>X</italic><sub><italic>t</italic></sub>)<italic>δ</italic><sup>2</sup>. However, while this is the desired probability of synchronous spikes, it leaves the wrong marginal probability of spiking for each neuron. To adjust these we consider the spike trains made up of only the non-synchronous spikes, and we thin these with probabilities <italic>p</italic><sup>(<italic>j</italic>)</sup>(<italic>t</italic>) given by
<disp-formula id="pcbi.1004549.e073"><alternatives><graphic id="pcbi.1004549.e073g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e073"/><mml:math id="M73" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>(</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>-</mml:mo> <mml:mi>ζ</mml:mi> <mml:mo>·</mml:mo> <mml:msup><mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>(</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>·</mml:mo> <mml:msup><mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>(</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mi>δ</mml:mi></mml:mrow> <mml:mrow><mml:msup><mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>(</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>-</mml:mo> <mml:msup><mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>(</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>·</mml:mo> <mml:msup><mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>(</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>H</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mi>δ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
for <italic>j</italic> = 1,2. Note that when we multiply the numerator and denominator of this expression by <italic>δ</italic> we have the ratio of the desired probability of a non-synchronous spike to the probability of a non-synchronous spike under independence (the latter probability corresponding to the process we are thinning). After obtaining all <italic>N</italic> trials we then fitted the model to these simulated spike trains, found the estimate <inline-formula id="pcbi.1004549.e074"><alternatives><graphic id="pcbi.1004549.e074g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e074"/><mml:math id="M74" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, and applied the hypothesis test using the bootstrap method. This procedure was carried out for each <italic>ζ</italic> and <italic>N</italic> in our simulation.</p>
<p>Because the simulation is computationally time-consuming, for the benefit of any future efforts along these lines, we also derived a formula to approximate the number of trials needed to get 0.8 power. Suppose we have <italic>N</italic> trials, each trial is <italic>T</italic> seconds, the bin size for synchrony detection is <italic>δ</italic>. Denote the instantaneous firing rates for two neurons on trial <italic>i</italic> by <inline-formula id="pcbi.1004549.e075"><alternatives><graphic id="pcbi.1004549.e075g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e075"/><mml:math id="M75" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004549.e076"><alternatives><graphic id="pcbi.1004549.e076g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e076"/><mml:math id="M76" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. The number of synchronized spikes within the <italic>t</italic>th bin is <inline-formula id="pcbi.1004549.e077"><alternatives><graphic id="pcbi.1004549.e077g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e077"/><mml:math id="M77" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>12</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004549.e078"><alternatives><graphic id="pcbi.1004549.e078g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e078"/><mml:math id="M78" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>12</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>∼</mml:mo> <mml:mtext mathvariant="normal">Poisson</mml:mtext> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mi>ζ</mml:mi> <mml:mo>⋅</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>⋅</mml:mo> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>ζ</italic> is the synchrony coefficient. The total number of observed synchronized spikes given <inline-formula id="pcbi.1004549.e079"><alternatives><graphic id="pcbi.1004549.e079g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e079"/><mml:math id="M79" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004549.e080"><alternatives><graphic id="pcbi.1004549.e080g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e080"/><mml:math id="M80" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is <inline-formula id="pcbi.1004549.e081"><alternatives><graphic id="pcbi.1004549.e081g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e081"/><mml:math id="M81" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>b</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">∣</mml:mo><mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:mi>δ</mml:mi></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>12</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. Then we compute <inline-formula id="pcbi.1004549.e082"><alternatives><graphic id="pcbi.1004549.e082g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e082"/><mml:math id="M82" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> conditioned on <inline-formula id="pcbi.1004549.e083"><alternatives><graphic id="pcbi.1004549.e083g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e083"/><mml:math id="M83" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004549.e084"><alternatives><graphic id="pcbi.1004549.e084g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e084"/><mml:math id="M84" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>,
<disp-formula id="pcbi.1004549.e085"><alternatives><graphic id="pcbi.1004549.e085g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e085"/><mml:math id="M85" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>ζ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>b</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>r</mml:mi> <mml:mi>e</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:mi>δ</mml:mi></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>12</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:mi>δ</mml:mi></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>·</mml:mo> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Since <inline-formula id="pcbi.1004549.e086"><alternatives><graphic id="pcbi.1004549.e086g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e086"/><mml:math id="M86" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>12</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>∼</mml:mo> <mml:mtext mathvariant="normal">Poisson</mml:mtext> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mi>ζ</mml:mi> <mml:mo>⋅</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>⋅</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, we can easily get
<disp-formula id="pcbi.1004549.e087"><alternatives><graphic id="pcbi.1004549.e087g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e087"/><mml:math id="M87" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi> <mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>ζ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>E</mml:mi> <mml:mo>[</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:mi>δ</mml:mi></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>12</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:mi>δ</mml:mi></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>·</mml:mo> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:mi>δ</mml:mi></mml:mrow></mml:msubsup> <mml:mi>ζ</mml:mi> <mml:mo>·</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:mi>δ</mml:mi></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>·</mml:mo> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mi>ζ</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>V</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ζ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>V</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:mi>δ</mml:mi></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>12</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:mi>δ</mml:mi></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:mi>δ</mml:mi></mml:mrow></mml:msubsup> <mml:mi>ζ</mml:mi> <mml:mo>·</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:mi>δ</mml:mi></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"/> <mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mi>ζ</mml:mi> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:mi>δ</mml:mi></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Assuming <inline-formula id="pcbi.1004549.e088"><alternatives><graphic id="pcbi.1004549.e088g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e088"/><mml:math id="M88" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004549.e089"><alternatives><graphic id="pcbi.1004549.e089g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e089"/><mml:math id="M89" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>2</mml:mn> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are independent, we have
<disp-formula id="pcbi.1004549.e090"><alternatives><graphic id="pcbi.1004549.e090g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e090"/><mml:math id="M90" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi> <mml:mo stretchy="true">[</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:mi>δ</mml:mi></mml:mrow></mml:munderover> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo stretchy="true">]</mml:mo> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:mi>δ</mml:mi></mml:mrow></mml:munderover> <mml:mi>E</mml:mi> <mml:mo>[</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>]</mml:mo> <mml:mi>E</mml:mi> <mml:mo>[</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>]</mml:mo> <mml:msup><mml:mi>δ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:mi>T</mml:mi> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mi>δ</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>λ</italic><sub>1</sub> and <italic>λ</italic><sub>2</sub> are the mean firing rates of two neurons. Then we have
<disp-formula id="pcbi.1004549.e091"><alternatives><graphic id="pcbi.1004549.e091g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e091"/><mml:math id="M91" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi> <mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>ζ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mrow><mml:mi>E</mml:mi> <mml:mo>[</mml:mo> <mml:mi>E</mml:mi> <mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>ζ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>]</mml:mo> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:mi>ζ</mml:mi></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>V</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ζ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mrow><mml:mi>V</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mo>(</mml:mo> <mml:mi>E</mml:mi> <mml:mo>[</mml:mo> <mml:mover accent="true"><mml:mi>ζ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>]</mml:mo> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mi>E</mml:mi> <mml:mo>[</mml:mo> <mml:mi>V</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ζ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"/> <mml:mtd columnalign="left"><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mi>ζ</mml:mi> <mml:mrow><mml:mi>N</mml:mi> <mml:mi>T</mml:mi> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mi>δ</mml:mi></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:mi>O</mml:mi> <mml:mo>(</mml:mo> <mml:mfrac><mml:mi>ζ</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mi>T</mml:mi> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>3</mml:mn></mml:msup></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi> <mml:mo>[</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mover accent="true"><mml:mi>ζ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>]</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>≈</mml:mo><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mi>ζ</mml:mi> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msup><mml:mi>ζ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mfrac> <mml:mi>V</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ζ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>ζ</mml:mi> <mml:mo>+</mml:mo> <mml:mi>O</mml:mi> <mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>N</mml:mi> <mml:mi>T</mml:mi> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mi>δ</mml:mi> <mml:mi>ζ</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>V</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mo>(</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mover accent="true"><mml:mi>ζ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>≈</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:msup><mml:mi>ζ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mfrac> <mml:mi>V</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ζ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>4</mml:mn> <mml:msup><mml:mi>ζ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mi>V</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ζ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>ζ</mml:mi></mml:mfrac> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>N</mml:mi> <mml:mi>T</mml:mi> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mi>δ</mml:mi></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:mi>O</mml:mi> <mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mi>T</mml:mi> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
We next assume that the distribution of <inline-formula id="pcbi.1004549.e092"><alternatives><graphic id="pcbi.1004549.e092g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e092"/><mml:math id="M92" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mspace width="1pt"/><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> is (approximately) normal, i.e., <inline-formula id="pcbi.1004549.e093"><alternatives><graphic id="pcbi.1004549.e093g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e093"/><mml:math id="M93" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mspace width="1pt"/><mml:mover><mml:mi>ζ</mml:mi> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mo>∈</mml:mo> <mml:mo mathvariant="script">N</mml:mo> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mtext>log</mml:mtext><mml:mspace width="1pt"/><mml:mi>ζ</mml:mi> <mml:mo>,</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>ζ</mml:mi></mml:mfrac> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>N</mml:mi> <mml:mi>T</mml:mi> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mi>δ</mml:mi></mml:mrow></mml:mfrac> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, so that to get the power to equal 0.8 with type I error.05 we need
<disp-formula id="pcbi.1004549.e094"><alternatives><graphic id="pcbi.1004549.e094g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e094"/><mml:math id="M94" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Φ</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:mi>x</mml:mi> <mml:mo>-</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>ζ</mml:mi></mml:mrow> <mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>ζ</mml:mi></mml:mfrac> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>N</mml:mi> <mml:mi>T</mml:mi> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mi>δ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Φ</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:mi>x</mml:mi> <mml:mo>-</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msqrt><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>N</mml:mi> <mml:mi>T</mml:mi> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mi>δ</mml:mi></mml:mrow></mml:mfrac></mml:msqrt></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>95</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>x</italic> is the threshold of rejecting null hypothesis log <italic>ζ</italic> = 0. We can then solve for <italic>N</italic> as the number of needed trials for detecting excess synchony:
<disp-formula id="pcbi.1004549.e095"><alternatives><graphic id="pcbi.1004549.e095g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004549.e095"/><mml:math id="M95" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>N</mml:mi> <mml:mo>=</mml:mo> <mml:mo>⌈</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>T</mml:mi> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mi>δ</mml:mi></mml:mrow></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mo>Φ</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>95</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mo>Φ</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msqrt><mml:mi>ζ</mml:mi></mml:msqrt></mml:mrow> <mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mi>ζ</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>⌉</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
</sec>
<sec id="sec021">
<title>Experiment</title>
<sec id="sec022">
<title>Acute slice electrophysiology</title>
<p>Experiments were completed in compliance with the guidelines established by the Institutional Animal Care and Use Committee of Carnegie Mellon University. Whole-cell patch clamp recordings of hippocampal CA1 pyramidal cells were performed similar to previously described methods [<xref ref-type="bibr" rid="pcbi.1004549.ref052">52</xref>]. Briefly, a postnatal day 16 Thy1-YFP-G mouse [<xref ref-type="bibr" rid="pcbi.1004549.ref053">53</xref>] was anesthetized with isoflurane and decapitated into ice-cold oxygenated dissection solution containing (in <italic>mM</italic>): 125 NaCl, 25 glucose, 2.5 KCl, 25 NaHCO<sub>3</sub>, 1.25 NaH<sub>2</sub>PO<sub>4</sub>, 3 MgCl<sub>2</sub> and 1 CaCl<sub>2</sub>. Brains were rapidly isolated and sagittal slices (310 <italic>μ</italic>m thick) containing the hippocampus were cut using a vibratome (5000 mz-2; Campden, Lafayette, IN, USA). Slices recovered for ∼ 30 min in ∼ 37C oxygenated Ringer solution that was identical to the dissection solution except for lower Mg<sup>2+</sup> concentrations (1 mM MgCl<sub>2</sub>) and higher Ca<sup>2+</sup> concentrations (2 mM CaCl<sub>2</sub>). Slices were then stored in room temperature oxygenated Ringer solution until recording. During recording, slices were continuously superfused with warmed oxygenated Ringer’s solution (temperature measured in bath: 32°C). CA1 pyramidal cells were identified by morphology and laminar position using infrared differential interference contrast microscopy. Whole-cell recordings were made using electrodes (final electrode resistance: 5–7 MΩ) filled with (in mM): 120 potassium gluconate, 2 KCl, 10 Hepes, 10 sodium phosphocreatine, 4 Mg-ATP, 0.3 Na<sub>3</sub>GTP, 0.2 EGTA, 0.25 Alexa Fluor 594 (Life Technologies, Carlsbad, CA, USA) and 0.2% Neurobiotin (Vector Labs, Burlingame, CA, USA). The liquid junction potential was 12–14 mV and was not corrected for. Pipette capacitance was carefully neutralized and series resistance was compensated using the MultiClamp Bridge Balance operation. Data were low-pass filtered at 4 kHz and digitized at 10 kHz using a MultiClamp 700A amplifier (Molecular Devices, Sunnyvale, CA, USA) and an ITC-18 acquisition board (Instrutech, Mineola, NY, USA) controlled by custom software written in Igor Pro (WaveMetrics, Lake Oswego, OR, USA). Cell morphology was reconstructed under a 100X oil-immersion objective and analyzed with Neurolucida (MicroBrightField, Inc., Williston, VT, USA).</p>
</sec>
<sec id="sec023">
<title>V4 neurons</title>
<p>Experimental procedures were approved by the Institutional Animal Care and Use Committee of the University of Pittsburgh. A separate analysis of these data has been previously reported ([<xref ref-type="bibr" rid="pcbi.1004549.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1004549.ref054">54</xref>]).</p>
<p><bold>Subjects</bold>: We implanted one, 100-electrode “Utah” array (Blackrock Microsystems) in right V4 in one adult male rhesus macaque (<italic>Macaca mulatta</italic>). The basic surgical procedures have been described previously [<xref ref-type="bibr" rid="pcbi.1004549.ref055">55</xref>], and were conducted in aseptic conditions under isoflurane anesthesia. In addition to the microelectrode arrays, the animal was implanted with a titanium head post to immobilize the head during experiments. We recorded neurons with receptive fields centered ∼ 4° from the fovea in the lower-left visual field.</p>
<p><bold><italic>Behavioral task</italic></bold>: We trained the subject to maintain fixation on a 0.6° blue dot at the center of a flat-screen cathode ray tube monitor positioned 36 cm from its eyes. The background of the display was 50% gray. We measured the monitor luminance gamma functions using a photometer and linearized the relationship between input voltage and output luminance using lookup tables. The subject was trained to maintain fixation on the central dot for 2 seconds while no other visual stimulus was presented, at which time the fixation point was moved 11.6° in a random direction and the animal received a liquid reinforcement for making a saccade to the new location.</p>
<p><bold><italic>Microelectrode array recordings</italic></bold>: Signals from the microelectrode arrays were band-pass filtered (0.3–7500 Hz), digitized at 30 kHz and amplified by a Grapevine system (Ripple). Signals crossing a threshold (periodically adjusted using a multiple of the root-mean-squared [RMS] noise for each channel) were stored for offline analysis. These waveform segments were sorted using an automated clustering algorithm [<xref ref-type="bibr" rid="pcbi.1004549.ref056">56</xref>] followed by manual refinement using custom MATLAB software [<xref ref-type="bibr" rid="pcbi.1004549.ref057">57</xref>] (available at <ext-link ext-link-type="uri" xlink:href="http://www.smithlab.net/spikesort.html" xlink:type="simple">http://www.smithlab.net/spikesort.html</ext-link>), taking into account the waveform shapes and interspike interval distributions. After sorting, we calculated the signal-to-noise (SNR) ratio of each candidate unit as the ratio of the average waveform amplitude to the standard deviation of the waveform noise [<xref ref-type="bibr" rid="pcbi.1004549.ref057">57</xref>]. Candidates with an SNR below 2.5 were discarded. Signals were also filtered from 0.3–250 Hz with a digital Butterworth filter and sampled at 1 kHz to provide LFPs.</p>
<p><bold><italic>LFP preprocessing</italic></bold>: We assume that the oscillation modulating spiking activity is explicitly within the surrounding LFP. The naive way of selecting LFP is using the one recorded at the same electrode for each neuron. Since spike waveforms might contaminate the LFP spectrum [<xref ref-type="bibr" rid="pcbi.1004549.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1004549.ref058">58</xref>], we computed LFP related to each neuron as the average of LFPs recorded on its neighboring electrodes. Another way of avoiding spike bleed-through is to choose the LFP on any electrodes adjacent to the neuron. In <xref ref-type="supplementary-material" rid="pcbi.1004549.s002">S2A and S2B Fig</xref>, we show that LFPs selected by all three methods are very similar. We also computed the spike-triggered average (STA) field potential using these three different methods. Their shapes are almost the same (<xref ref-type="supplementary-material" rid="pcbi.1004549.s002">S2C ad S2D Fig</xref>). We then bandpass filtered the LFP using Chebyshev type II filter design with passband 4–25 Hz. After we got the filtered oscillatory signal (<xref ref-type="fig" rid="pcbi.1004549.g008">Fig 8B–8E</xref>), we applied the Hilbert transform to estimate the instantaneous phase for further model fitting [<xref ref-type="bibr" rid="pcbi.1004549.ref020">20</xref>].</p>
</sec>
</sec>
</sec>
<sec id="sec024">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004549.s001" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004549.s001" mimetype="application/eps" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>GLM fitting of one CA1 neuron.</title>
<p>(A) Input currents for two differnt trials. The slow 2 Hz components are the same, but the fast 40 Hz oscillatory signals are different due to the varying initial phases. Both input currents have white noise. (B) Effect of stimulus <italic>λ</italic><sub>1</sub>(<italic>t</italic>). (C) Effect of auto-history <italic>λ</italic><sub>2</sub>(<italic>t</italic> − <italic>t</italic>*). (D) Effect of phase modulation <italic>λ</italic><sub>3</sub>(<italic>ϕ</italic>) from the oscillatory signal.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004549.s002" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004549.s002" mimetype="application/eps" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Spike triggered average of two V4 neuron.</title>
<p>(A)(B) Three different ways of selecting the LFP for each neuron: LFP on the same electrode as the neuron detected (red), LFP on one of the neighboring electrodes (blue), averaged LFP on all neighboring electrodes (green); (C)(D) spike-triggered average for three different field potentials shown in (A)(B).</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004549.s003" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004549.s003" mimetype="application/eps" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Explaining synchrony when firing rate is modulated by the amplitude of the oscillation.</title>
<p>In this example, the firing rate is modulated by the magnitude of the oscillation <italic>B</italic><sub><italic>t</italic></sub> = <italic>A</italic><sub><italic>t</italic></sub> cos(Φ<sub><italic>t</italic></sub>), where the amplitude <italic>A</italic><sub><italic>t</italic></sub> is time varying and the modulation curve is 1 + <italic>B</italic><sub><italic>t</italic></sub> = 1 + <italic>A</italic><sub><italic>t</italic></sub>cos(Φ<sub><italic>t</italic></sub>). We want to show that even though the phase-modulation assumption is violated, our method can still explain partly the role of oscillation in synchrony. (A) Amplitude and magnitude of the oscillatory signal; (B) Bootstrap-generated distribution of log <italic>ζ</italic><sub>12</sub> values under the null hypothesis of log <italic>ζ</italic><sub>12</sub>. Arrowhead shows the value of log <italic>ζ</italic><sub>12</sub> predicted by the simplified model. A significantly larger number of synchronous spikes is observed than predicted by the model lacking an oscillatory factor. (C) Including an oscillatory factor in the model yields an accurate prediction of the observed number of synchronous spikes.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004549.s004" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004549.s004" mimetype="application/zip" xlink:type="simple">
<label>S1 Dataset</label>
<caption>
<title>Experimental dataset used in this paper.</title>
<p>Two datasets used for <xref ref-type="fig" rid="pcbi.1004549.g007">Fig 7</xref> and <xref ref-type="fig" rid="pcbi.1004549.g008">Fig 8</xref> were included in S1_Dataset. They were named as CA1_data and V4_data respectively. Details of data format were described in README file of each dataset.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Kensuke Arai for helpful discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004549.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Brette</surname> <given-names>R</given-names></name>. <article-title>Computing with neural synchrony</article-title>. <source>PLoS Computational Biology</source>. <year>2012</year>;<volume>8</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002561" xlink:type="simple">10.1371/journal.pcbi.1002561</ext-link></comment> <object-id pub-id-type="pmid">22719243</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Colgin</surname> <given-names>LL</given-names></name>, <name name-style="western"><surname>Denninger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Fyhn</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hafting</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Bonnevie</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Jensen</surname> <given-names>O</given-names></name>, <etal>et al</etal>. <article-title>Frequency of gamma oscillations routes flow of information in the hippocampus</article-title>. <source>Nature</source>. <year>2009</year> <month>Nov</month>;<volume>462</volume>(<issue>7271</issue>):<fpage>353</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature08573" xlink:type="simple">10.1038/nature08573</ext-link></comment> <object-id pub-id-type="pmid">19924214</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Engel</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Fries</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name>. <article-title>Dynamic predictions: oscillations and synchrony in top-down processing</article-title>. <source>Nature Reviews Neuroscience</source>. <year>2001</year>;<volume>2</volume>:<fpage>704</fpage>–<lpage>716</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/35094565" xlink:type="simple">10.1038/35094565</ext-link></comment> <object-id pub-id-type="pmid">11584308</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Fries</surname> <given-names>P</given-names></name>. <article-title>A mechanism for cognitive dynamics: Neuronal communication through neuronal coherence</article-title>. <source>Trends in Cognitive Sciences</source>. <year>2005</year>;<volume>9</volume>:<fpage>474</fpage>–<lpage>480</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tics.2005.08.011" xlink:type="simple">10.1016/j.tics.2005.08.011</ext-link></comment> <object-id pub-id-type="pmid">16150631</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Geman</surname> <given-names>S</given-names></name>. <article-title>Invariance and selectivity in the ventral visual pathway</article-title>. <source>Journal of Physiology Paris</source>. <year>2006</year>;<volume>100</volume>:<fpage>212</fpage>–<lpage>224</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jphysparis.2007.01.001" xlink:type="simple">10.1016/j.jphysparis.2007.01.001</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Niebur</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Hsiao</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>KO</given-names></name>. <article-title>Synchrony: A neuronal mechanism for attentional selection?</article-title> <source>Current Opinion in Neurobiology</source>. <year>2002</year>;<volume>12</volume>:<fpage>190</fpage>–<lpage>194</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0959-4388(02)00310-0" xlink:type="simple">10.1016/S0959-4388(02)00310-0</ext-link></comment> <object-id pub-id-type="pmid">12015236</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Salinas</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name>. <article-title>Correlated neuronal activity and the flow of neural information</article-title>. <source>Nature Reviews Neuroscience</source>. <year>2001</year>;<volume>2</volume>:<fpage>539</fpage>–<lpage>550</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/35086012" xlink:type="simple">10.1038/35086012</ext-link></comment> <object-id pub-id-type="pmid">11483997</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Paulsen</surname> <given-names>O</given-names></name>. <article-title>Network oscillations: emerging computational principles</article-title>. <source>The Journal of Neuroscience</source>. <year>2006</year>;<volume>26</volume>(<issue>6</issue>):<fpage>1673</fpage>–<lpage>1676</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3737-05d.2006" xlink:type="simple">10.1523/JNEUROSCI.3737-05d.2006</ext-link></comment> <object-id pub-id-type="pmid">16467514</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tiesinga</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Fellous</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name>. <article-title>Regulation of spike timing in visual cortical circuits</article-title>. <source>Nature Reviews Neuroscience</source>. <year>2008</year>;<volume>9</volume>:<fpage>97</fpage>–<lpage>107</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn2315" xlink:type="simple">10.1038/nrn2315</ext-link></comment> <object-id pub-id-type="pmid">18200026</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Denker</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Roux</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Linden</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Diesmann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Riehle</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Grun</surname> <given-names>S</given-names></name>. <article-title>The Local Field Potential Reflects Surplus Spike Synchrony</article-title>. <source>Cerebral Cortex</source>. <year>2011</year> <month>Apr</month>;<volume>21</volume>(<issue>12</issue>):<fpage>2681</fpage>–<lpage>2695</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/cercor/bhr040" xlink:type="simple">10.1093/cercor/bhr040</ext-link></comment> <object-id pub-id-type="pmid">21508303</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Friedrich</surname> <given-names>RW</given-names></name>, <name name-style="western"><surname>Habermann</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Laurent</surname> <given-names>G</given-names></name>. <article-title>Multiplexing using synchrony in the zebrafish olfactory bulb</article-title>. <source>Nature Neuroscience</source>. <year>2004</year>;<volume>7</volume>(<issue>8</issue>):<fpage>862</fpage>–<lpage>871</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1292" xlink:type="simple">10.1038/nn1292</ext-link></comment> <object-id pub-id-type="pmid">15273692</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gregoriou</surname> <given-names>GG</given-names></name>, <name name-style="western"><surname>Gotts</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Desimone</surname> <given-names>R</given-names></name>. <article-title>High-frequency, long-range coupling between prefrontal and visual cortex during attention</article-title>. <source>Science</source>. <year>2009</year>;<volume>324</volume>:<fpage>1207</fpage>–<lpage>1210</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1171402" xlink:type="simple">10.1126/science.1171402</ext-link></comment> <object-id pub-id-type="pmid">19478185</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mizuseki</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Buzsaki</surname> <given-names>G</given-names></name>. <article-title>Theta oscillations decrease spike synchrony in the hippocampus and entorhinal cortex</article-title>. <source>Philosophical transactions of the Royal Society of London Series B, Biological sciences</source>. <year>2014</year>;<volume>369</volume>:<fpage>20120530</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.2012.0530" xlink:type="simple">10.1098/rstb.2012.0530</ext-link></comment> <object-id pub-id-type="pmid">24366139</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Robbe</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Montgomery</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Thome</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rueda-Orozco</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Buzsaki</surname> <given-names>G</given-names></name>. <article-title>Cannabinoids reveal importance of spike timing coordination in hippocampal function</article-title>. <source>Nature Neuroscience</source>. <year>2006</year>;<volume>9</volume>(<issue>12</issue>):<fpage>1526</fpage>–<lpage>1533</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1801" xlink:type="simple">10.1038/nn1801</ext-link></comment> <object-id pub-id-type="pmid">17115043</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Kelly</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Loh</surname> <given-names>WL</given-names></name>. <article-title>Assessment of Synchrony in Multiple Neural Spike Trains Using Loglinear Point Process Models</article-title>. <source>The Annals of Applied Statistics</source>. <year>2011</year> <month>Jun</month>;<volume>5</volume>(<issue>2B</issue>):<fpage>1262</fpage>–<lpage>1292</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/10-AOAS429" xlink:type="simple">10.1214/10-AOAS429</ext-link></comment> <object-id pub-id-type="pmid">21837263</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kelly</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>. <article-title>A framework for evaluating pairwise and multiway synchrony among stimulus-driven neurons</article-title>. <source>Neural Computation</source>. <year>2012</year> <month>Aug</month>;<volume>24</volume>(<issue>8</issue>):<fpage>2007</fpage>–<lpage>32</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00307" xlink:type="simple">10.1162/NECO_a_00307</ext-link></comment> <object-id pub-id-type="pmid">22509967</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lepage</surname> <given-names>KQ</given-names></name>, <name name-style="western"><surname>Gregoriou</surname> <given-names>GG</given-names></name>, <name name-style="western"><surname>Kramer</surname> <given-names>Ma</given-names></name>, <name name-style="western"><surname>Aoi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gotts</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>, <etal>et al</etal>. <article-title>A procedure for testing across-condition rhythmic spike-field association change</article-title>. <source>Journal of Neuroscience Methods</source>. <year>2013</year> <month>Feb</month>;<volume>213</volume>(<issue>1</issue>):<fpage>43</fpage>–<lpage>62</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jneumeth.2012.10.010" xlink:type="simple">10.1016/j.jneumeth.2012.10.010</ext-link></comment> <object-id pub-id-type="pmid">23164959</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kaufman</surname> <given-names>CG</given-names></name>, <name name-style="western"><surname>Ventura</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>. <article-title>Spline-based non-parametric regression for periodic functions and its application to directional tuning of neurons</article-title>. <source>Statistics in Medicine</source>. <year>2005</year> <month>Jul</month>;<volume>24</volume>(<issue>14</issue>):<fpage>2255</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/sim.2104" xlink:type="simple">10.1002/sim.2104</ext-link></comment> <object-id pub-id-type="pmid">15887309</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <article-title>Analysis of Neural Data</article-title>. <source>Springer Series in Statistics</source>; <year>2014</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004549.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jia</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Tanabe</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kohn</surname> <given-names>A</given-names></name>. <article-title>Gamma and the Coordination of Spiking Activity in Early Visual Cortex</article-title>. <source>Neuron</source>. <year>2013</year> <month>Feb</month>;<volume>77</volume>(<issue>4</issue>):<fpage>762</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2012.12.036" xlink:type="simple">10.1016/j.neuron.2012.12.036</ext-link></comment> <object-id pub-id-type="pmid">23439127</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Sirota</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Montgomery</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fujisawa</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Isomura</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Zugaro</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Buzsáki</surname> <given-names>G</given-names></name>. <article-title>Entrainment of neocortical neurons and gamma oscillations by the hippocampal theta rhythm</article-title>. <source>Neuron</source>. <year>2008</year> <month>Nov</month>;<volume>60</volume>(<issue>4</issue>):<fpage>683</fpage>–<lpage>97</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2008.09.014" xlink:type="simple">10.1016/j.neuron.2008.09.014</ext-link></comment> <object-id pub-id-type="pmid">19038224</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Siapas</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Lubenov</surname> <given-names>EV</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>MA</given-names></name>. <article-title>Prefrontal phase locking to hippocampal theta oscillations</article-title>. <source>Neuron</source>. <year>2005</year> <month>Apr</month>;<volume>46</volume>(<issue>1</issue>):<fpage>141</fpage>–<lpage>51</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2005.02.028" xlink:type="simple">10.1016/j.neuron.2005.02.028</ext-link></comment> <object-id pub-id-type="pmid">15820700</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gerkin</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Tripathy</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Urban</surname> <given-names>NN</given-names></name>. <article-title>Origins of correlated spiking in the mammalian olfactory bulb</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2013</year> <month>Sep</month>;<volume>110</volume>(<issue>42</issue>):<fpage>17083</fpage>–<lpage>17088</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1303830110" xlink:type="simple">10.1073/pnas.1303830110</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tattersall</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Stratton</surname> <given-names>PG</given-names></name>, <name name-style="western"><surname>Coyne</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Cook</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Silberstein</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Silburn</surname> <given-names>Pa</given-names></name>, <etal>et al</etal>. <article-title>Imagined gait modulates neuronal network dynamics in the human pedunculopontine nucleus</article-title>. <source>Nature Neuroscience</source>. <year>2014</year> <month>Mar</month>;<volume>17</volume>(<issue>3</issue>):<fpage>449</fpage>–<lpage>54</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3642" xlink:type="simple">10.1038/nn.3642</ext-link></comment> <object-id pub-id-type="pmid">24487235</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Zelenin</surname> <given-names>PV</given-names></name>. <article-title>Reticulospinal neurons controlling forward and backward swimming in the lamprey</article-title>. <source>Journal of Neurophysiology</source>. <year>2011</year> <month>Mar</month>;<volume>105</volume>(<issue>3</issue>):<fpage>1361</fpage>–<lpage>71</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00887.2010" xlink:type="simple">10.1152/jn.00887.2010</ext-link></comment> <object-id pub-id-type="pmid">21248057</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lepage</surname> <given-names>KQ</given-names></name>, <name name-style="western"><surname>Kramer</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>. <article-title>The dependence of spike field coherence on expected intensity</article-title>. <source>Neural Computation</source>. <year>2011</year> <month>Sep</month>;<volume>23</volume>(<issue>9</issue>):<fpage>2209</fpage>–<lpage>41</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00169" xlink:type="simple">10.1162/NECO_a_00169</ext-link></comment> <object-id pub-id-type="pmid">21671792</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Mitra</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Bokil</surname> <given-names>H</given-names></name>. <source>Observed brain dynamics</source>. <publisher-name>Oxford University Press</publisher-name>; <year>2007</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004549.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Snyder</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>MA</given-names></name>. <article-title>Stimulus-dependent spiking relationships with the EEG</article-title>. <source>Journal of Neurophysiology</source>. <year>2015</year> <month>Jun</month>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00427.2015" xlink:type="simple">10.1152/jn.00427.2015</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref029">
<label>29</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Richardson</surname> <given-names>MJE</given-names></name>. <article-title>Spike-train spectra and network response functions for non-linear integrate-and-fire neurons</article-title>. <source>Biological Cybernetics</source>. <year>2008</year> <month>Nov</month>;<volume>99</volume>(<issue>4–5</issue>):<fpage>381</fpage>–<lpage>92</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00422-008-0244-y" xlink:type="simple">10.1007/s00422-008-0244-y</ext-link></comment> <object-id pub-id-type="pmid">19011926</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref030">
<label>30</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Buzsáki</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Anastassiou</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name>. <article-title>The origin of extracellular fields and currents–EEG, ECoG, LFP and spikes</article-title>. <source>Nature Reviews Neuroscience</source>. <year>2012</year>;<volume>13</volume>(<issue>6</issue>):<fpage>407</fpage>–<lpage>420</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn3241" xlink:type="simple">10.1038/nrn3241</ext-link></comment> <object-id pub-id-type="pmid">22595786</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref031">
<label>31</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Grün</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Diesmann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Aertsen</surname> <given-names>A</given-names></name>. <article-title>Unitary events in multiple single-neuron spiking activity: II. Nonstationary data</article-title>. <source>Neural Computation</source>. <year>2002</year>;<volume>14</volume>:<fpage>81</fpage>–<lpage>119</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/089976602753284464" xlink:type="simple">10.1162/089976602753284464</ext-link></comment> <object-id pub-id-type="pmid">11747535</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref032">
<label>32</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Grün</surname> <given-names>S</given-names></name>. <article-title>Data-driven significance estimation for precise spike correlation</article-title>. <source>Journal of Neurophysiology</source>. <year>2009</year>;<volume>101</volume>(<issue>January 2009</issue>):<fpage>1126</fpage>–<lpage>1140</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00093.2008" xlink:type="simple">10.1152/jn.00093.2008</ext-link></comment> <object-id pub-id-type="pmid">19129298</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref033">
<label>33</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Pipa</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wheeler</surname> <given-names>DW</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Nikolić</surname> <given-names>D</given-names></name>. <article-title>NeuroXidence: Reliable and efficient analysis of an excess or deficiency of joint-spike events</article-title>. <source>Journal of Computational Neuroscience</source>. <year>2008</year>;<volume>25</volume>:<fpage>64</fpage>–<lpage>88</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10827-007-0065-3" xlink:type="simple">10.1007/s10827-007-0065-3</ext-link></comment> <object-id pub-id-type="pmid">18219568</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref034">
<label>34</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kelly</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>Ma</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>TS</given-names></name>. <article-title>Accounting for network effects in neuronal responses using L1 regularized point process models</article-title>. <source>Advances in Neural Information Processing Systems</source>. <year>2010</year> <month>Jan</month>;<volume>23</volume>(<issue>2</issue>):<fpage>1099</fpage>–<lpage>1107</lpage>. <object-id pub-id-type="pmid">22162918</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref035">
<label>35</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Park</surname> <given-names>IM</given-names></name>, <name name-style="western"><surname>Meister</surname> <given-names>MLR</given-names></name>, <name name-style="western"><surname>Huk</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>. <article-title>Encoding and decoding in parietal cortex during sensorimotor decision-making</article-title>. <source>Nature Neuroscience</source>. <year>2014</year>;<volume>17</volume>(<issue>10</issue>):<fpage>1395</fpage>–<lpage>1403</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3800" xlink:type="simple">10.1038/nn.3800</ext-link></comment> <object-id pub-id-type="pmid">25174005</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref036">
<label>36</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Shlens</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Sher</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Litke</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Chichilnisky</surname> <given-names>EJ</given-names></name>, <etal>et al</etal>. <article-title>Spatio-temporal correlations and visual signalling in a complete neuronal population</article-title>. <source>Nature</source>. <year>2008</year> <month>Aug</month>;<volume>454</volume>(<issue>7207</issue>):<fpage>995</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature07140" xlink:type="simple">10.1038/nature07140</ext-link></comment> <object-id pub-id-type="pmid">18650810</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref037">
<label>37</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Koyama</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>. <article-title>Spike train probability models for stimulus-driven leaky integrate-and-fire neurons</article-title>. <source>Neural Computation</source>. <year>2008</year> <month>Jul</month>;<volume>20</volume>(<issue>7</issue>):<fpage>1776</fpage>–<lpage>1795</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.2008.06-07-540" xlink:type="simple">10.1162/neco.2008.06-07-540</ext-link></comment> <object-id pub-id-type="pmid">18336078</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref038">
<label>38</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ostojic</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>. <article-title>From spiking neuron models to linear-nonlinear models</article-title>. <source>PLoS Computational Biology</source>. <year>2011</year> <month>Jan</month>;<volume>7</volume>(<issue>1</issue>):<fpage>e1001056</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1001056" xlink:type="simple">10.1371/journal.pcbi.1001056</ext-link></comment> <object-id pub-id-type="pmid">21283777</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref039">
<label>39</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>, <name name-style="western"><surname>Iyengar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>. <chapter-title>Statistical models of spike trains</chapter-title>. In: <name name-style="western"><surname>Laing</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lord</surname> <given-names>GJ</given-names></name>, editors. <source>Stochastic Methods in Neuroscience</source>. <publisher-name>Oxford University Press</publisher-name>; <year>2010</year>. p. <fpage>272</fpage>–<lpage>296</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004549.ref040">
<label>40</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>, <name name-style="western"><surname>Barbieri</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ventura</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>LM</given-names></name>. <article-title>The time-rescaling theorem and its application to neural spike train data analysis</article-title>. <source>Neural Computation</source>. <year>2002</year>;<volume>14</volume>(<issue>2</issue>):<fpage>325</fpage>–<lpage>346</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/08997660252741149" xlink:type="simple">10.1162/08997660252741149</ext-link></comment> <object-id pub-id-type="pmid">11802915</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref041">
<label>41</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bosman</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Schoffelen</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Brunet</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Oostenveld</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bastos</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Womelsdorf</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Attentional Stimulus Selection through Selective Synchronization between Monkey Visual Areas</article-title>. <source>Neuron</source>. <year>2012</year>;<volume>75</volume>:<fpage>875</fpage>–<lpage>888</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2012.06.037" xlink:type="simple">10.1016/j.neuron.2012.06.037</ext-link></comment> <object-id pub-id-type="pmid">22958827</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref042">
<label>42</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Buzsáki</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Draguhn</surname> <given-names>A</given-names></name>. <article-title>Neuronal oscillations in cortical networks</article-title>. <source>science</source>. <year>2004</year>;<volume>304</volume>(<issue>5679</issue>):<fpage>1926</fpage>–<lpage>1929</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1099745" xlink:type="simple">10.1126/science.1099745</ext-link></comment> <object-id pub-id-type="pmid">15218136</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref043">
<label>43</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Grothe</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Neitzel</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Mandon</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kreiter</surname> <given-names>AK</given-names></name>. <article-title>Switching neuronal inputs by differential modulations of gamma-band phase-coherence</article-title>. <source>The Journal of Neuroscience</source>. <year>2012</year>;<volume>32</volume>(<issue>46</issue>):<fpage>16172</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.0890-12.2012" xlink:type="simple">10.1523/JNEUROSCI.0890-12.2012</ext-link></comment> <object-id pub-id-type="pmid">23152601</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref044">
<label>44</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Joshua</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Adler</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Prut</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Vaadia</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Wickens</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Bergman</surname> <given-names>H</given-names></name>. <article-title>Synchronization of Midbrain Dopaminergic Neurons Is Enhanced by Rewarding Events</article-title>. <source>Neuron</source>. <year>2009</year>;<volume>62</volume>:<fpage>695</fpage>–<lpage>704</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2009.04.026" xlink:type="simple">10.1016/j.neuron.2009.04.026</ext-link></comment> <object-id pub-id-type="pmid">19524528</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref045">
<label>45</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ratté</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hong</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>De Schutter</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Prescott</surname> <given-names>SA</given-names></name>. <article-title>Impact of neuronal properties on network coding: roles of spike initiation dynamics and robust synchrony transfer</article-title>. <source>Neuron</source>. <year>2013</year> <month>Jun</month>;<volume>78</volume>(<issue>5</issue>):<fpage>758</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2013.05.030" xlink:type="simple">10.1016/j.neuron.2013.05.030</ext-link></comment> <object-id pub-id-type="pmid">23764282</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref046">
<label>46</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name>. <article-title>Neuronal synchrony: a versatile code for the definition of relations?</article-title> <source>Neuron</source>. <year>1999</year>;<volume>24</volume>(<issue>1</issue>):<fpage>49</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0896-6273(00)80821-1" xlink:type="simple">10.1016/S0896-6273(00)80821-1</ext-link></comment> <object-id pub-id-type="pmid">10677026</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref047">
<label>47</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Uhlhaas</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name>. <article-title>Abnormal neural oscillations and synchrony in schizophrenia</article-title>. <source>Nature Reviews Neuroscience</source>. <year>2010</year> <month>Feb</month>;<volume>11</volume>(<issue>2</issue>):<fpage>100</fpage>–<lpage>13</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn2774" xlink:type="simple">10.1038/nrn2774</ext-link></comment> <object-id pub-id-type="pmid">20087360</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref048">
<label>48</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Womelsdorf</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Fries</surname> <given-names>P</given-names></name>. <article-title>The role of neuronal synchronization in selective attention</article-title>. <source>Current Opinion in Neurobiology</source>. <year>2007</year>;<volume>17</volume>:<fpage>154</fpage>–<lpage>160</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.conb.2007.02.002" xlink:type="simple">10.1016/j.conb.2007.02.002</ext-link></comment> <object-id pub-id-type="pmid">17306527</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref049">
<label>49</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Stanley</surname> <given-names>GB</given-names></name>. <article-title>Reading and writing the neural code</article-title>. <source>Nature Neuroscience</source>. <year>2013</year>;<volume>16</volume>:<fpage>259</fpage>–<lpage>63</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3330" xlink:type="simple">10.1038/nn.3330</ext-link></comment> <object-id pub-id-type="pmid">23434978</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref050">
<label>50</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kass</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ventura</surname> <given-names>V</given-names></name>. <article-title>A spike-train probability model</article-title>. <source>Neural Computation</source>. <year>2001</year>;<volume>1720</volume>:<fpage>1713</fpage>–<lpage>1720</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/08997660152469314" xlink:type="simple">10.1162/08997660152469314</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref051">
<label>51</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Graves</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hooker</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Ramsay</surname> <given-names>J</given-names></name>. <source>Functional data analysis with R and MATLAB</source>. <publisher-name>Springer</publisher-name>, <publisher-loc>New York</publisher-loc>; <year>2009</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004549.ref052">
<label>52</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Burton</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Urban</surname> <given-names>NN</given-names></name>. <article-title>Greater excitability and firing irregularity of tufted cells underlies distinct afferent-evoked activity of olfactory bulb mitral and tufted cells</article-title>. <source>The Journal of Physiology</source>. <year>2014</year>;<volume>00</volume>:<fpage>1</fpage>–<lpage>22</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004549.ref053">
<label>53</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Feng</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Mellor</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Bernstein</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Keller-Peck</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Nguyen</surname> <given-names>QT</given-names></name>, <name name-style="western"><surname>Wallace</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Imaging neuronal subsets in transgenic mice expressing multiple spectral variants of GFP</article-title>. <source>Neuron</source>. <year>2000</year>;<volume>28</volume>:<fpage>41</fpage>–<lpage>51</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0896-6273(00)00084-2" xlink:type="simple">10.1016/S0896-6273(00)00084-2</ext-link></comment> <object-id pub-id-type="pmid">11086982</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref054">
<label>54</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Snyder</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Morais</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Willis</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>MA</given-names></name>. <article-title>Global network influences on local functional connectivity</article-title>. <source>Nature Neuroscience</source>. <year>2015</year> <day>05</day>;<volume>18</volume>(<issue>5</issue>):<fpage>736</fpage>–<lpage>743</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3979" xlink:type="simple">10.1038/nn.3979</ext-link></comment> <object-id pub-id-type="pmid">25799040</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref055">
<label>55</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Smith</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Sommer</surname> <given-names>MA</given-names></name>. <article-title>Spatial and temporal scales of neuronal correlation in visual area V4</article-title>. <source>The Journal of Neuroscience</source>. <year>2013</year>;<volume>33</volume>:<fpage>5422</fpage>–<lpage>32</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4782-12.2013" xlink:type="simple">10.1523/JNEUROSCI.4782-12.2013</ext-link></comment> <object-id pub-id-type="pmid">23516307</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref056">
<label>56</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Shoham</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fellows</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Normann</surname> <given-names>RA</given-names></name>. <article-title>Robust, automatic spike sorting using mixtures of multivariate t-distributions</article-title>. <source>Journal of Neuroscience Methods</source>. <year>2003</year> <month>Aug</month>;<volume>127</volume>(<issue>2</issue>):<fpage>111</fpage>–<lpage>122</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0165-0270(03)00120-1" xlink:type="simple">10.1016/S0165-0270(03)00120-1</ext-link></comment> <object-id pub-id-type="pmid">12906941</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref057">
<label>57</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kelly</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Samonds</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Kohn</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bonds</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Movshon</surname> <given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>Comparison of recordings from microelectrode arrays and single electrodes in the visual cortex</article-title>. <source>The Journal of Neuroscience</source>. <year>2007</year>;<volume>27</volume>:<fpage>261</fpage>–<lpage>264</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4906-06.2007" xlink:type="simple">10.1523/JNEUROSCI.4906-06.2007</ext-link></comment> <object-id pub-id-type="pmid">17215384</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004549.ref058">
<label>58</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ray</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Maunsell</surname> <given-names>JHR</given-names></name>. <article-title>Different origins of gamma rhythm and high-gamma activity in macaque visual cortex</article-title>. <source>PLoS Biology</source>. <year>2011</year>;<volume>9</volume>(<issue>4</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.1000610" xlink:type="simple">10.1371/journal.pbio.1000610</ext-link></comment> <object-id pub-id-type="pmid">21532743</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>