<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-00982</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003625</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Biotechnology</subject><subj-group><subject>Bioengineering</subject><subj-group><subject>Biological systems engineering</subject></subj-group></subj-group></subj-group><subj-group><subject>Computational biology</subject></subj-group><subj-group><subject>Synthetic biology</subject></subj-group><subj-group><subject>Systems biology</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Engineering and technology</subject><subj-group><subject>Control engineering</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title><italic>In-Vivo</italic> Real-Time Control of Protein Expression from Endogenous and Synthetic Gene Networks</article-title>
<alt-title alt-title-type="running-head"><italic>In-Vivo</italic> Control of Gene Networks</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Menolascina</surname><given-names>Filippo</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="fn" rid="fn1"><sup>¤</sup></xref></contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Fiore</surname><given-names>Gianfranco</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Orabona</surname><given-names>Emanuele</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>De Stefano</surname><given-names>Luca</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Ferry</surname><given-names>Mike</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Hasty</surname><given-names>Jeff</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>di Bernardo</surname><given-names>Mario</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff5"><sup>5</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>di Bernardo</surname><given-names>Diego</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>TeleThon Institute of Genetics and Medicine (TIGEM), Naples, Italy</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Department of Electrical Engineering and Information Technology, University of Naples Federico II, Naples, Italy</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Institute of Microelectronics and Microsystems (IMM), CNR, Naples, Italy</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>Department of Bioengineering, University of California, San Diego, La Jolla, California, United States of America</addr-line></aff>
<aff id="aff5"><label>5</label><addr-line>Department of Engineering Mathematics, University of Bristol, Bristol, United Kingdom</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Gabhann</surname><given-names>Feilim Mac</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Johns Hopkins University, United States of America</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">dibernardo@tigem.it</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: FM GF DdB MdB. Performed the experiments: FM GF. Analyzed the data: FM GF. Contributed reagents/materials/analysis tools: EO LDS FM GF. Wrote the paper: FM GF DdB MdB. Technology transfer: MF JH.</p></fn>
<fn id="fn1" fn-type="current-aff"><label>¤</label><p>Current address: Department of Civil and Environmental Engineering, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>5</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>15</day><month>5</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>5</issue>
<elocation-id>e1003625</elocation-id>
<history>
<date date-type="received"><day>14</day><month>6</month><year>2012</year></date>
<date date-type="accepted"><day>1</day><month>4</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Menolascina et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>We describe an innovative experimental and computational approach to control the expression of a protein in a population of yeast cells. We designed a simple control algorithm to automatically regulate the administration of inducer molecules to the cells by comparing the actual protein expression level in the cell population with the desired expression level. We then built an automated platform based on a microfluidic device, a time-lapse microscopy apparatus, and a set of motorized syringes, all controlled by a computer. We tested the platform to force yeast cells to express a desired fixed, or time-varying, amount of a reporter protein over thousands of minutes. The computer automatically switched the type of sugar administered to the cells, its concentration and its duration, according to the control algorithm. Our approach can be used to control expression of any protein, fused to a fluorescent reporter, provided that an external molecule known to (indirectly) affect its promoter activity is available.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>A crucial feature of biological systems is their ability to maintain homeostasis in spite of ever-changing conditions. In engineering, this ability can be embedded in devices ranging from the thermostat to the autopilot of a modern plane using control systems which operate via a negative feedback mechanism: the quantity to be controlled is measured then subtracted from the desired reference value, and the resulting error is used to compute the control action to be implemented on the physical system (e.g. switching on or off the heating, changing the position of the rudder). Here, we developed and applied a method to regulate the expression level of a protein, in a growing population of cells over several generations, in a completely automatic fashion. We designed and implemented an integrated platform comprising a microfluidic device, a time-lapse microscopy apparatus, and a set of motorized syringes, all controlled by a computer. We tested the platform to force yeast cells to express a desired time-varying amount of a gene in yeast. Our method can be applied to control a protein of interest in vivo allowing to probe the function of biological systems in unprecedented ways.</p>
</abstract>
<funding-group><funding-statement>This work was supported by a Italian Telethon Foundation Grant (TGM11SB1) to DdB, Human Frontiers Science Program grant (RGP0020/2011) to DdB and JH. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="14"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>A crucial feature of biological systems is their ability to maintain homeostasis in spite of ever-changing environmental and intracellular conditions. In man-made systems, this ability can be engineered in devices ranging from the simple thermostat to the complex autopilot of a modern plane using “controllers”, which operate via a simple “negative feedback” mechanism (<xref ref-type="fig" rid="pcbi-1003625-g001">Figure 1</xref>): the quantity to be controlled (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e001" xlink:type="simple"/></inline-formula>) is measured (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e002" xlink:type="simple"/></inline-formula>) via a sensor (whose dynamics are described by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e003" xlink:type="simple"/></inline-formula>), then subtracted from the desired reference value (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e004" xlink:type="simple"/></inline-formula>) (i.e. negative feedback), and the resulting error (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e005" xlink:type="simple"/></inline-formula>) is used by the controller to compute the “control action” (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e006" xlink:type="simple"/></inline-formula>) to be implemented (or actuated) on the physical system (e.g. switching on or off the heating, changing the angular position of the rudder).</p>
<fig id="pcbi-1003625-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003625.g001</object-id><label>Figure 1</label><caption>
<title>Feedback control block scheme.</title>
<p>The controller consists of a Proportional-Integral (PI) block followed by a Pulse Width Modulation (PWM) block encoding of the control input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e007" xlink:type="simple"/></inline-formula>. The PWM transforms the continuous control action <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e008" xlink:type="simple"/></inline-formula> into a train of rectangular pulses <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e009" xlink:type="simple"/></inline-formula>, which represents either Galactose (high) or Glucose (low). The alternating series of glucose and galactose pulses is applied to the cell population to be controlled (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e010" xlink:type="simple"/></inline-formula>), whose output <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e011" xlink:type="simple"/></inline-formula> (the controlled variable) is filtered (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e012" xlink:type="simple"/></inline-formula>) by a low-pass filter (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e013" xlink:type="simple"/></inline-formula>) before being fed back to the controller. The difference between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e014" xlink:type="simple"/></inline-formula> and its desired reference level <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e015" xlink:type="simple"/></inline-formula>, namely the error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e016" xlink:type="simple"/></inline-formula>, is used by the PI controller to compute the control input to be supplied to the system to minimize the error signal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e017" xlink:type="simple"/></inline-formula>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003625.g001" position="float" xlink:type="simple"/></fig>
<p>Control engineering has been applied as a powerful theoretical framework to elucidate the underlying principles driving gene networks <xref ref-type="bibr" rid="pcbi.1003625-Iglesias1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1003625-Kurata1">[4]</xref>, to predict their dynamics and their robustness to noise <xref ref-type="bibr" rid="pcbi.1003625-ElSamad1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1003625-Murphy1">[6]</xref>, and to theoretically demonstrate the possibility of steering gene network dynamics <xref ref-type="bibr" rid="pcbi.1003625-Apgar1">[7]</xref>–<xref ref-type="bibr" rid="pcbi.1003625-Klavins1">[9]</xref>.</p>
<p>More recently, other groups have reported experimental applications of control engineering to drive gene expression from artificial inducible promoters by means of external stimuli (e.g. light or osmotic pressure) either in single cells, or across a cell population <xref ref-type="bibr" rid="pcbi.1003625-Uhlendorf1">[10]</xref>–<xref ref-type="bibr" rid="pcbi.1003625-MiliasArgeitis1">[12]</xref>. Toettcher and colleagues documented a successful application of closed-loop optogenetic control of membrane recruitment system in mammalian cells (characteristic time of process in the order of seconds) <xref ref-type="bibr" rid="pcbi.1003625-Toettcher1">[11]</xref>. Milias-Argeitis and colleagues showed how population level control of a light-switchable gene system (characteristic time in the order of minutes) can be achieved by manually sampling a liquid culture of <italic>S. cerevisiae</italic>, then estimating target protein concentration via flow cytometry and control this quantity via Model Predictive Control and Kalman Filtering <xref ref-type="bibr" rid="pcbi.1003625-MiliasArgeitis1">[12]</xref>. While this manuscript was under review, Uhlendorf and colleagues reported a successful attempt to drive gene expression from the Hog1 promoter in yeast using as control input changes in osmolarity <xref ref-type="bibr" rid="pcbi.1003625-Uhlendorf2">[13]</xref>. These authors coupled an external feedback strategy to microscopy and microfluidics to achieve fully automated external control of the reporter fluorescent protein up to 15 hrs.</p>
<p>Here we present, for the first time, the development and application of an automatic control system to regulate at will the level of expression of a protein from the <italic>GAL1</italic> endogenous promoter in an exponentially growing population of yeast cells. We also demonstrated the ability of the control system to regulate at will protein expression from a complex synthetic transcriptional network. We controlled protein expression level by changing in real-time the concentration of a set of inducer molecules, known to modulate its expression (i.e. galactose and glucose).</p>
<p>We first demonstrated the ability of our control platform to regulate the level of expression of a reporter protein fused to the Gal1p protein from the endogenous <italic>GAL1</italic> promoter (<xref ref-type="fig" rid="pcbi-1003625-g002">Figure 2a</xref>). We then applied the same control platform to regulate the level of expression in a complex synthetic gene network (<xref ref-type="fig" rid="pcbi-1003625-g002">Figure 2b</xref>), where the inducer molecule (galactose) directly activates the transcription factor, Gal4p, which in turns drives the expression of another transcription factor (Swi5p), which finally binds the promoter driving the expression of the reporter protein (Cbf1p-Gfp). Due to these multiple transcriptional/translational steps (Gal4p <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e018" xlink:type="simple"/></inline-formula> Swi5p <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e019" xlink:type="simple"/></inline-formula> Cbf1-Gfp), the system is much slower compared to simple promoter-reporter systems, thus control becomes much more challenging due to the delay introduced by this indirect regulation.</p>
<fig id="pcbi-1003625-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003625.g002</object-id><label>Figure 2</label><caption>
<title>Biological systems.</title>
<p>(a): The Gfp protein was integrated downstream of the endogenous <italic>GAL1</italic> promoter (yeast strain courtesy of Prof. Botstein lab). (b): IRMA is composed of 5 genes encoding for transcription factors modulating the expression of each other. Both the transcription factors in the network and the promoters driving their expression are shown (adapted from <xref ref-type="bibr" rid="pcbi.1003625-Cantone1">[17]</xref>). Solid lines model transcriptional interactions, while dashed lines are meant to represent protein-protein interactions.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003625.g002" position="float" xlink:type="simple"/></fig>
<p>Our approach is applicable to a large class of gene networks to control expression of a protein of interest from an endogenous promoter, provided that: (<italic>a</italic>) an external molecule known to affect (even indirectly) the promoter activity is available; (<italic>b</italic>) a fluorescent reporter is fused to the protein; and (<italic>c</italic>) either a mathematical model of the gene network is available or dynamical properties of the bioprocess are compatible with a PI-PWM control configuration (see “Control Objective and Control Strategy” and Figures S7–S8).</p>
</sec><sec id="s2" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="s2a">
<title>Microfluidic master mold and devices fabrication</title>
<p>The microfluidic device presented in <xref ref-type="bibr" rid="pcbi.1003625-Ferry1">[14]</xref> has been used to trap cells and perform experiments. To this aim, a master mold has been produced using a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e020" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e021" xlink:type="simple"/></inline-formula>) silicon wafer as substrate (Silicon Valley Microelectronics, US). In order to develop this device, we used multilayer soft-lithography with SU-8 (Microchem, US) as photoresist. Once the mold was ready we used (Tridecafluoro-1,1,2,2-Tetrahydrooctyl)-1-Trichlorosilane (Sigma-Aldrich, US) to prevent polymer from sticking to microstructures; at this point replica molding allowed us to obtain functional devices (see Supplementary Information).</p>
</sec><sec id="s2b">
<title>Experimental setup</title>
<p>The experimental setup is the same for both strains of cells used in this study (yGIL337 and IC18). Batch cultures were cultured for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e022" xlink:type="simple"/></inline-formula> in Synthetic Complete + Galactose (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e023" xlink:type="simple"/></inline-formula>) + Raffinose (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e024" xlink:type="simple"/></inline-formula>) and repeatedly diluted. On the day designated for the actual control experiment, syringes featuring both Synthetic Complete + Glucose (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e025" xlink:type="simple"/></inline-formula>) and Synthetic Complete + Galactose (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e026" xlink:type="simple"/></inline-formula>) + Raffinose (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e027" xlink:type="simple"/></inline-formula>) were connected to the device; syringes filled with ddH2O were attached to sink ports. Media and sugars filled syringes were attached to a computer controlled linear guide; the initial position for the syringes was <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e028" xlink:type="simple"/></inline-formula> above the level of the device, while the ddH2O syringes were set at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e029" xlink:type="simple"/></inline-formula>. Hydrostatic pressure drove the flow of media in the device. We then loaded cells into the microfluidic device. Visual inspection at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e030" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e031" xlink:type="simple"/></inline-formula> magnifications allowed to exclude the presence of air bubles in the channels. At this point, the imaging field was set on the cell trap (see <xref ref-type="bibr" rid="pcbi.1003625-Ferry1">[14]</xref> for references) and the control algorithm was started. In depth details concerning this procedure are reported in Supplementary Information.</p>
</sec><sec id="s2c">
<title>Microscopy and image processing</title>
<p>Microscopy image acquisition has been carried out by with NIS Elements v. 3.22 software. Phase contrast and fluorescent images were acquired at intervals of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e032" xlink:type="simple"/></inline-formula>. The control algorithm was synchronized with the acquisition process by running a polling routine that checked for the presence of new files in a predefined folder. Once a new set of images was found, the control algorithm run an image processing sub-routine meant to segment the phase contrast image (see Supplementary Information for more details), locate the cells and obtain a binary mask that was used to select only pixels belonging to cells in the field. This mask was employed in the calculation of the population average fluorescence as reported in Supplementary Information. Our control scheme then used this value as a readout of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e033" xlink:type="simple"/></inline-formula> signal and then proceeded to the computation of the input action <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e034" xlink:type="simple"/></inline-formula>.</p>
</sec></sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Choice of biological systems to control</title>
<sec id="s3a1">
<title>Gal1 promoter in <italic>S. cerevisiae</italic></title>
<p>In order to test our control platform on an endogenous promoter in <italic>S. cerevisiae</italic>, we selected the <italic>GAL1</italic> promoter driving expression of the Gal1p protein. In order to follow in real-time the expression level of Gal1p, we used a strain of yeast cells (yGIL337, Gal1-GFP::KanMX, Gal10-mCherry::NatMX) constructed by Lang et al. <xref ref-type="bibr" rid="pcbi.1003625-Lang1">[15]</xref> in which the Gal1 protein, expressed by the <italic>GAL1</italic> promoter, was fused to a green fluorescent protein (Gfp), as shown in <xref ref-type="bibr" rid="pcbi.1003625-Lang1">[15]</xref> (<xref ref-type="fig" rid="pcbi-1003625-g002">Figure 2a</xref>).</p>
<p>The actvity of the <italic>GAL1</italic> promoter is governed by the presence of galactose in the cells' growing medium. This sugar is interpreted as a “switch on” signal for the expression of the <italic>GAL1</italic> gene; when yeasts are fed with glucose the production of Gal1 protein is repressed <xref ref-type="bibr" rid="pcbi.1003625-Bennett1">[16]</xref>. Yeast cells will first consume all the available glucose in the medium and then switch to galactose. Hence, the control input can either be glucose (switch off signal) or galactose (switch on signal), but not an intermediate concentration of the two, because cells will not respond to galactose when glucose is present.</p>
</sec><sec id="s3a2">
<title>IRMA synthetic network in <italic>S. cerevisiae</italic></title>
<p>IRMA (In-vivo Reverse engineering Method Assessment) is a synthetic network we previously constructed in yeast <italic>S. cerevisiae</italic> and shown in <xref ref-type="fig" rid="pcbi-1003625-g002">Figure 2</xref> b <xref ref-type="bibr" rid="pcbi.1003625-Cantone1">[17]</xref>. It consists of 5 genes regulating each other via positive and negative feedback loops, and represents one of the most complex synthetic networks built so far <xref ref-type="bibr" rid="pcbi.1003625-Camacho1">[18]</xref>. The Cbf1-Gfp fusion protein is expressed from the <italic>HO</italic> promoter controlled by two transcription factors: a cell cycle-independent Swi5p mutant (swi5AAA) and Ash1p. The network comprises a transcriptional positive feedback loop from <italic>CBF1</italic> back to itself, via <italic>GAL4</italic> and <italic>SWI5</italic>; and a transcriptional negative feedback loop via <italic>ASH1</italic>. A further regulation is present between <italic>GAL80</italic>, <italic>GAL4</italic> and <italic>SWI5</italic>, whose expression is driven by the <italic>GAL10</italic> promoter, bound by GAL4p. The network can be “switched on” by administering Galactose (GAL) in the medium, which allows <italic>SWI5</italic> to be transcribed by the <italic>GAL10</italic> promoter, or “switched off” by Glucose.</p>
<p>Of note, <italic>CBF1-GFP</italic> expression is delayed with respect to the other genes <xref ref-type="bibr" rid="pcbi.1003625-Cantone1">[17]</xref>. This delay is due to the sequential recruitment of chromatin-modifying complexes at the <italic>HO</italic> promoter, which follow binding of Swi5p and other transcription factors <xref ref-type="bibr" rid="pcbi.1003625-Cosma1">[19]</xref>, and it is estimated in the range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e035" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003625-Cantone1">[17]</xref>.</p>
<p>Galactose and Glucose can be used to control the network's dynamics, which, in turn, can be tracked by estimating the fluorescence level of Cbf1-Gfp, one of IRMA's proteins. By taking full advantage of the detailed description of the biomolecular processes provided in <xref ref-type="bibr" rid="pcbi.1003625-Cantone1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1003625-Cosma1">[19]</xref> we derived a Delay Differential Equations based model (described in Supplementary Information) that was able to capture, to a reasonable extent, the dynamics of the gene network <xref ref-type="bibr" rid="pcbi.1003625-Cantone1">[17]</xref>.</p>
<p>Interestingly, IRMA dynamical properties are commonly observed in endogenous gene regulatory networks and pathways. IRMA contains two of the most common regulatory motifs found in eukaryotic cells, i.e. positive and negative transcriptional feedbacks loops <xref ref-type="bibr" rid="pcbi.1003625-Yosef1">[20]</xref>. Moreover, a protein-protein regulatory interaction is also present, which is much faster than transcriptional regulatory interactions, thus adding concurrent dynamics at different time-scales typical of endogenous regulatory networks. These properties pose two main theoretical and practical challenges: (a) devising a control algorithm for hybrid dynamical system switching between two highly non-linear/time-delayed subsystems; (b) developing a technolgical platform allowing to probe and control the transcriptional/translational activity of a cell. IRMA is therefore an ideal benchmark for testing our in-vivo control strategy on a complex gene network <xref ref-type="bibr" rid="pcbi.1003625-Cantone1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1003625-Menolascina1">[21]</xref>.</p>
</sec></sec><sec id="s3b">
<title>Control objective and control strategy</title>
<sec id="s3b1">
<title>GAL1 promoter</title>
<p>The control objective consists in driving a growing population of yeast cells to produce a desired amount of the Gal1-Gfp fusion protein, over thousands of minutes, by automatically switching the type of sugar administered to the cell, its concentration and its duration.</p>
<p>In order to achieve the control objective, we designed a simple control law to automatically regulate the administration of Galactose/Glucose to the cells (input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e036" xlink:type="simple"/></inline-formula>) as a function of the amount of fluorescent protein produced by the yeast population (output <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e037" xlink:type="simple"/></inline-formula>), following the scheme in <xref ref-type="fig" rid="pcbi-1003625-g003">Figure 3</xref>.</p>
<fig id="pcbi-1003625-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003625.g003</object-id><label>Figure 3</label><caption>
<title>Technological platform enabling in-vivo control experiments.</title>
<p>In-vivo control experiment were carried out via a microfludics-based approach, featuring a computer implementation of the control algorithm and an inverted microscope to sense the fluorescence signal. The computer uses the images taken by the automated microscopy unit to quantify cells fluorescence (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e038" xlink:type="simple"/></inline-formula>) and compare it with the desired amount <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e039" xlink:type="simple"/></inline-formula>. Once the control algorithm has computed the control action <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e040" xlink:type="simple"/></inline-formula> on the basis of the result of the previous comparison (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e041" xlink:type="simple"/></inline-formula>), it varies the height of two syringes filled with either Galactose or Glucose. Hydrostatic pressure generated by the relative difference in the heights of the two syringes drives the flow in the microfluidic device and determines the type of sugar cells will sense within the chamber. Images are sampled at intervals of 5 minutes and used by the control algorithm to close the control loop.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003625.g003" position="float" xlink:type="simple"/></fig>
<p>The input acts nonlinearly on the dynamics of the network, since, as soon as the cells sense Glucose in the medium, they stop responding to Galactose. Therefore, the control input is restricted to be binary, i.e. either Galactose (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e042" xlink:type="simple"/></inline-formula>) or Glucose (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e043" xlink:type="simple"/></inline-formula>). The system output <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e044" xlink:type="simple"/></inline-formula> is the level of the green fluorescent protein fused to <italic>Gal1p</italic> (Gal1-Gfp), which can be used as a proxy of the protein concentration <xref ref-type="bibr" rid="pcbi.1003625-Gordon1">[22]</xref>.</p>
<p>Given the uncertain nature of biological systems and the difficulty, or impossibility, in deriving precise quantitative mathematical models, we decided to design a simple yet effective classic control scheme, which does not require detailed knowledge of the system to be controlled.</p>
<p>Proportional-Integral (PI) controllers use the error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e045" xlink:type="simple"/></inline-formula> in <xref ref-type="fig" rid="pcbi-1003625-g001">Figure 1</xref> to compute the control action, which is proportional to the present error (P) and to the past evolution of the error (I) (Supplementary Information). PI controllers are widely used in industry, and have been shown to be effective also in controlling protein localization and signal transduction activity in single cells <xref ref-type="bibr" rid="pcbi.1003625-Toettcher1">[11]</xref>.</p>
<p>Since the control input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e046" xlink:type="simple"/></inline-formula> is binary, a further step is needed to convert the output of the PI block (which is proportional to the error and its integral) to a binary signal. It is impossible, at this stage, to avoid the analogy with the problems faced in the design of feedback control strategies for power electronic circuits <xref ref-type="bibr" rid="pcbi.1003625-Kassakian1">[23]</xref>. Here, switches and SCRs (silicon controlled rectifiers) can only be turned on or off, some output is typically measured or estimated and, particularly in industrial applications, compensating noise and external disturbances is of utmost importance. The simplest and most widely used technique in this context is PWM (Pulse Width Modulation) control; this is also the encoding strategy we implemented in the control scheme to control the gene network in the yeast population (<xref ref-type="fig" rid="pcbi-1003625-g001">Figure 1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003625.s002">Figure S2</xref>).</p>
<p>The idea behind PWM is to encode a continuous time-varying signal as a train of rectangular pulses, whose duration is proportional to the amplitude of the encoded signal. In its simplest implementation, which we used here, a periodic sawtooth wave (with period equal to 10 min) is compared with the output of the PI block in order to modulate the width of each pulse <xref ref-type="bibr" rid="pcbi.1003625-Banerjee1">[24]</xref>.</p>
<p>We used a simple mathematical description of the GAL1 promoter to tune the gains of the PI regulator and the parameters of the PWM module (Supplementary Information).</p>
<p>One of the most difficult aspects of controlling a biological system, which lies at the core of our work, is to devise an experimental platform enabling such a strategy to be applied to living cells, as described in the next section.</p>
</sec><sec id="s3b2">
<title>IRMA network</title>
<p>The control objective is the same as for the Gal1 promoter previously described, i.e. controlling the level of expression of the reporter protein (Cbf1-Gfp). However, in the IRMA network, unlike the GAL1 promoter system, the <italic>CBF1-GFP</italic> gene is not under the direct control of the inducer molecule (i.e. glucose or galactose). Indeed, as shown in <xref ref-type="fig" rid="pcbi-1003625-g002">Figure 2b</xref>, galactose activates Gal4p, which then drives the expression of <italic>Swi5p</italic> that ultimately binds the <italic>Gal10</italic> promoter driving Cbf1p-GFP expression. This adds a considerable delay in the Cbf1-Gfp activation following galactose treatment <xref ref-type="bibr" rid="pcbi.1003625-Cantone1">[17]</xref>.</p>
<p>IRMA can be described as a single input-single output nonlinear time-delayed dynamical system, where the input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e047" xlink:type="simple"/></inline-formula> models the presence/absence of Galactose and the output <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e048" xlink:type="simple"/></inline-formula> is the concentration of one of its proteins, namely Cbf1-GFP.</p>
<p>The control algorithm designed for this system, as we did for the <italic>Gal1</italic> promoter, is based on a PI regulator whose output is encoded in a switching signal via a PWM module (see Supplementary Informations for details).</p>
<p>However, in order to compensate for the estimated delay of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e049" xlink:type="simple"/></inline-formula> in the Gal1-Gfp gene transcription, which may introduce unwanted oscillations in the controlled variable (i.e. Gfp fluorescence level), we designed and implemented a version of the controller including a predictor inspired by the classic scheme proposed by Otto Smith <xref ref-type="bibr" rid="pcbi.1003625-Smith1">[25]</xref>.</p>
<p>In particular, IRMA's mathematical model <xref ref-type="bibr" rid="pcbi.1003625-Cantone1">[17]</xref> was used to predict, via simulation, the network behavior by removing the delay from the model equation. This simulated response is then used in real-time by the controller to compute the error (Supplementary Information).</p>
<p>Numerical simulations show that this predictor block, however, is not strictly necessary for control; specifically, when the delay is short compared to the desired dynamics of the reference signal, the predictor can be completely removed from the control scheme (Supplementary Information and Figures S7–S8).</p>
<p> The PI-PWM control law (with and without the predictor) was designed and simulated in-silico, in order to evaluate its performance before implementation, and to empirically select the control parameters. Two different experiments were used to assess the performance of the controller: (1) <italic>set-point regulation</italic>, where cells are forced to produce a fixed desired amount of Cbf1-Gfp protein; (2) <italic>signal tracking</italic>, where yeasts are required to synthesize a target time-varying amount of the controlled protein. <italic>In-silico</italic> results of both types of experiments are presented in <xref ref-type="fig" rid="pcbi-1003625-g004">Figure 4</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003625.s005">Figures S5</xref>–<xref ref-type="supplementary-material" rid="pcbi.1003625.s006">S6</xref>–<xref ref-type="supplementary-material" rid="pcbi.1003625.s007">S7</xref>–<xref ref-type="supplementary-material" rid="pcbi.1003625.s008">S8</xref> and in Supplementary Information.</p>
<fig id="pcbi-1003625-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003625.g004</object-id><label>Figure 4</label><caption>
<title>In-silico control of IRMA.</title>
<p>The PI-PWM-Predictor control scheme has been tested in-silico, using the non-linear IRMA model as a proxy, in order to evaluate its performances before implementing it in in-vivo experiments. In this experiment, the CBF1-GFP protein (green line) was controlled so as to follow a triangular reference signal (blue line). The optimal input signal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e050" xlink:type="simple"/></inline-formula> computed by the control algorithm is reported in red: it is a square wave encoding Galactose (higher state) and Glucose (lower state). The input binary variable has been rescaled in this plot for the sake of readability.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003625.g004" position="float" xlink:type="simple"/></fig>
<p><italic>In-silico</italic> results show that both set point and tracking experiments can in principle be successfully carried out by the selected control strategy.</p>
</sec></sec><sec id="s3c">
<title>Implementation of the PI-PWM controller for in-vivo control of protein expression</title>
<p>For the in-vivo control implementation, we designed and implemented an integrated platform based on a microfluidic device, a time-lapse microscopy apparatus, and a set of actuated syringes, all controlled by a computer, as depicted in <xref ref-type="fig" rid="pcbi-1003625-g003">Figure 3</xref>.</p>
<p>At the core of this platform lies a microfluidic chip <xref ref-type="bibr" rid="pcbi.1003625-Ferry1">[14]</xref>. The chip has a micro-chamber (height: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e051" xlink:type="simple"/></inline-formula>) which “traps” yeasts, which can only grow in a monolayer, thus making their automated image analysis easier. Once loaded in the device, yeasts can be exposed to any combination of two inducer compounds by simply modulating the difference in hydrostatic pressures at the two inlets, thanks to the Dial-a-Wave system <xref ref-type="bibr" rid="pcbi.1003625-Ferry1">[14]</xref> (Supplementary Information). This can be easily achieved by varying the vertical position of syringes filled with sugar-supplemented media using motorized linear rails. A Finite State Automaton (FSA), implementing the control logic, runs on a computer and, at intervals of 5 minutes, analyses the images automatically captured by the microscope hosting the microfluidic chip. A custom image processing algorithm locates the yeast cells in phase contrast and quantifies the population average Gfp intensity (Supplementary Information and <xref ref-type="supplementary-material" rid="pcbi.1003625.s009">Figure S9</xref>). This information is then used by the controller to compute the relative duration of Galactose/Glucose pulses, which must be applied to meet the control objective.</p>
</sec><sec id="s3d">
<title>Experimental results</title>
<sec id="s3d1">
<title>GAL1 promoter</title>
<p>The control experiment consisted in a set-point control task, i.e. forcing yeast cells to reach and maintain a constant level of fluorescence equal to 50<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e052" xlink:type="simple"/></inline-formula> of their maximum fluorescence level when grown in galactose-rich medium. Specifically, after having grown yeast cells overnight in galactose, cells were placed in the microfludics device, part of the control platform, for a calibration phase of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e053" xlink:type="simple"/></inline-formula> during which cells were kept in galactose to estimate the average maximum Gfp fluorescence level expressed by the cell population. The desired value was then set to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e054" xlink:type="simple"/></inline-formula> of the estimated maximum fluorescence value.</p>
<p>As shown in <xref ref-type="fig" rid="pcbi-1003625-g005">Figure 5</xref> the control action works effectively in keeping the output, namely the measured fluorescence, close to the desired set-point for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e055" xlink:type="simple"/></inline-formula>. Despite the increasing number of cells and the cell-to-cell variability intrinsic to gene expression, the control error remained bounded for the whole experiment (<xref ref-type="supplementary-material" rid="pcbi.1003625.s010">Figure S10</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003625.s011">S11</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003625.s012">S12</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003625.s013">S13</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003625.s014">S14</xref> of Supplementary Information).</p>
<fig id="pcbi-1003625-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003625.g005</object-id><label>Figure 5</label><caption>
<title><italic>In-vivo</italic> set point control experiments on the GAL1 promoter.</title>
<p>(A–D) Four <italic>in-vivo</italic> set point control experiments were performed on the GAL1 promoter. The desired (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e056" xlink:type="simple"/></inline-formula> in blue) and experimentally quantified GFP fluorescence (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e057" xlink:type="simple"/></inline-formula> in green) in the cell population are shown for the whole duration of the experiments; the control action starts at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e058" xlink:type="simple"/></inline-formula> and lasts for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e059" xlink:type="simple"/></inline-formula>. The fluctuations in fluorescence during the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e060" xlink:type="simple"/></inline-formula> calibration phase are due to stress response after loading cells in the microfludics device. The input signal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e061" xlink:type="simple"/></inline-formula>, computed in real-time by the control algorithm, is shown in red: a high signal corresponds to galactose-rich growth medium, a low signal to glucose growth medium. (Insets) Images taken during the experiments show the growing yeast populations at the beginning, at the half and at the end of each experiment.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003625.g005" position="float" xlink:type="simple"/></fig>
<p>To assess the effectiveness of the feedback control strategy we performed two different types of “negative control” experiments: (1) an additional set-point control experiment, as described before, but with the difference that as soon as the Gfp reached the desired set-point value (i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e062" xlink:type="simple"/></inline-formula> of the maximum fluorescence) the control algorithm was stopped and the input was switched randomly between galactose and glucose (Supplementary Information); (2) yeast cells were fed for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e063" xlink:type="simple"/></inline-formula> only with galactose (sustained “ON” input).</p>
<p>The results of the negative control experiments are shown in <xref ref-type="fig" rid="pcbi-1003625-g006">Figure 6</xref>. It can be appreciated that, as expected, when cells were kept in constant galactose (<xref ref-type="fig" rid="pcbi-1003625-g006">Figure 6</xref>) the measured GFP fluctuated and diverged from the initial value; whereas, when a random input was applied (<xref ref-type="fig" rid="pcbi-1003625-g006">Figure 6</xref>) the output of the system diverged from the desired value, responding to the series of galactose/glucose pulses provided to cells.</p>
<fig id="pcbi-1003625-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003625.g006</object-id><label>Figure 6</label><caption>
<title><italic>In-vivo</italic> negative control experiments on the GAL1 promoter.</title>
<p>(Top panel) the three green signals (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e064" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e065" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e066" xlink:type="simple"/></inline-formula>) represent the measured GFP fluorescence in the cell population for a constant concentration of galactose. The desired (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e067" xlink:type="simple"/></inline-formula> in blue) and experimentally quantified GFP fluorescence (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e068" xlink:type="simple"/></inline-formula> in light green) for the whole duration of the random input negative control experiments are also shown. For this experiments, the control action starts at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e069" xlink:type="simple"/></inline-formula> and it is stopped at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e070" xlink:type="simple"/></inline-formula> as soon as the GFP reaches the desired set-point (arrow), from this time instant onwards, the input randomly switched between galactose and glucose, as described in the Supplementary Information. (Bottom panel) the dark red line represents the constant concentration of galactose (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e071" xlink:type="simple"/></inline-formula>) provided to cells corresponding to the experiments <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e072" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e073" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e074" xlink:type="simple"/></inline-formula>; the light red series of pulses, corresponding to the experiment <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e075" xlink:type="simple"/></inline-formula>, represents the closed loop control input calculated by the control algorithm starting from time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e076" xlink:type="simple"/></inline-formula> up to time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e077" xlink:type="simple"/></inline-formula>, as indicated by arrow; from this time onwards, the input randomly switched between glucose and galactose (Supplementary Information).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003625.g006" position="float" xlink:type="simple"/></fig>
<p>These experiments convincingly demonstrate the ability of our control platform to achieve and maintain a desired level of fluorescence by steering gene expression dynamics across the yeast cell population.</p>
</sec><sec id="s3d2">
<title>IRMA network</title>
<p>In order to test the control scheme in a more complex setting, we performed a set-point control experiment in the IRMA network, where the cell population was required to reach and maintain a fluorescence level equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e078" xlink:type="simple"/></inline-formula> of its maximum value in Galactose over a time interval of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e079" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1003625-g007">Figure 7</xref>, in <xref ref-type="supplementary-material" rid="pcbi.1003625.s015">Figure S15</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003625.s028">Video S2</xref>).</p>
<fig id="pcbi-1003625-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003625.g007</object-id><label>Figure 7</label><caption>
<title><italic>In-vivo</italic> set point control experiment on IRMA.</title>
<p>(Top panel) the desired (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e080" xlink:type="simple"/></inline-formula> in blue) and experimentally quantified GFP (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e081" xlink:type="simple"/></inline-formula> in green) are shown for the whole duration of the experiment; the control action starts at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e082" xlink:type="simple"/></inline-formula> and lasts for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e083" xlink:type="simple"/></inline-formula>. The p-value estimates the statistical significance of the control action in maintaining the desired set-point (Supplementary Material). (Bottom panel) the input signal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e084" xlink:type="simple"/></inline-formula> computed by the control algorithm is shown in red. (Insets) Images taken during the experiment show the growing yeast population at the beginning, at the half and at the end of the experiment.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003625.g007" position="float" xlink:type="simple"/></fig>
<p>In this experiment, we adopted a simple PI-PWM control, as in the case of the Gal1 promoter (Supplementary Information). The experiment started with a short calibration phase of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e085" xlink:type="simple"/></inline-formula> in Galactose to estimate the maximum Cbf1-Gfp fluorescence level produced by the cell population.</p>
<p>As shown in <xref ref-type="fig" rid="pcbi-1003625-g007">Figure 7</xref> and in <xref ref-type="supplementary-material" rid="pcbi.1003625.s015">Figure S15</xref> the desired fluorescence level was successfully achieved and maintained for over 24 hours, the control error did not diverge and remained bounded around zero. The cell-to-cell variability, estimated using the CV, did not change appreciably throughout the experiment, and was found in the expected range <xref ref-type="bibr" rid="pcbi.1003625-Balzsi1">[26]</xref>, despite the increase in the number of cells (estimated from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e086" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e087" xlink:type="simple"/></inline-formula> cells; <xref ref-type="supplementary-material" rid="pcbi.1003625.s016">Figure S16</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003625.s028">Video S2</xref>). As expected, however, due to the more complex network, the fluctuations around the set-point are more evident. Indeed the Normalised Root Mean Squared Error (NRMSE), reported in <xref ref-type="supplementary-material" rid="pcbi.1003625.s015">Figure S15</xref> is greater in this case when compared to the Gal1 promoter control experiment in <xref ref-type="supplementary-material" rid="pcbi.1003625.s010">Figure S10</xref>.</p>
<p> For comparison in <xref ref-type="supplementary-material" rid="pcbi.1003625.s017">Figure S17</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003625.s018">S18</xref>, we also reported two experiment without control input, showing that without active control protein expression fluctuates during the course of the experiment.</p>
<p>In order to test the PI-PWM-predictor control scheme, we set up a more challenging signal tracking task, where the Cbf1-Gfp level of the cell population was required to track a triangular wave over a time interval of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e088" xlink:type="simple"/></inline-formula> corresponding to more than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e089" xlink:type="simple"/></inline-formula> generations of a yeast cell (approx. cell cycle of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e090" xlink:type="simple"/></inline-formula>), as shown in <xref ref-type="fig" rid="pcbi-1003625-g008">Figure 8</xref> (blue line). At the peak of the triangular wave, cells were required to express a fluorescence level equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e091" xlink:type="simple"/></inline-formula> of the maximum level they could produce.</p>
<fig id="pcbi-1003625-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003625.g008</object-id><label>Figure 8</label><caption>
<title><italic>In-vivo</italic> signal tracking control experiment on IRMA.</title>
<p>(Top panel) the desired (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e092" xlink:type="simple"/></inline-formula> in blue) and experimentally quantified GFP (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e093" xlink:type="simple"/></inline-formula> in green) are shown for the whole duration of the experiment (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e094" xlink:type="simple"/></inline-formula>). (Bottom panel) the input signal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e095" xlink:type="simple"/></inline-formula> computed by the control algorithm is shown in red. (Insets) Images taken during the experiment show the growing yeast population at the beginning, at the half and at the end of the experiment.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003625.g008" position="float" xlink:type="simple"/></fig>
<p>To estimate the minimum and maximum fluorescence level, which can vary according to the experimental conditions, the control experiment started with an initial calibration phase, where the network was switched off by administering Galactose (Supplementary Information and <xref ref-type="supplementary-material" rid="pcbi.1003625.s024">Figures S24</xref>–<xref ref-type="supplementary-material" rid="pcbi.1003625.s025">S25</xref>).</p>
<p>The calibration phase was needed to establish the minimal (in Glucose) and maximal (in Galactose) Cbf1-Gfp fluorescence level produced by the cell population. This range was then used by the control algorithm to calibrate the predictor block and to set the desired level of fluorescence. The calibration phase lasted <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e096" xlink:type="simple"/></inline-formula>, (Galactose for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e097" xlink:type="simple"/></inline-formula> and Glucose for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e098" xlink:type="simple"/></inline-formula>). (Supplementary Information and <xref ref-type="supplementary-material" rid="pcbi.1003625.s024">Figures S24</xref>–<xref ref-type="supplementary-material" rid="pcbi.1003625.s025">S25</xref>).</p>
<p>As shown in <xref ref-type="fig" rid="pcbi-1003625-g008">Figure 8</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003625.s019">Figure S19</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003625.s027">Video S1</xref>, the proposed strategy effectively accomplishes the goal of controlling protein expression in a complex gene network across a population of yeast cells, by means of automatic administration of inducer molecules.</p>
<p>Remarkably, the designed control scheme proves to be sufficiently robust despite the large variation in the number of cells over the experiment duration (estimated from 100 to 1200 cells; <xref ref-type="supplementary-material" rid="pcbi.1003625.s020">Figure S20</xref>) and despite the inevitable biological noise. Biological noise is a well-known phenomenon that causes genetically identical cells to respond differently to the same input <xref ref-type="bibr" rid="pcbi.1003625-Balzsi1">[26]</xref>. We quantified biological noise by estimating the standard deviation and the Coefficient of Variation (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e099" xlink:type="simple"/></inline-formula>) throughout the experiment (<xref ref-type="supplementary-material" rid="pcbi.1003625.s019">Figures S19</xref>–<xref ref-type="supplementary-material" rid="pcbi.1003625.s020">S20</xref>); despite the number of cells increasing of an order of magnitude during the experiment (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e100" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e101" xlink:type="simple"/></inline-formula>) the CV does not change considerably, and its level is well in the expected range for living cells <xref ref-type="bibr" rid="pcbi.1003625-Balzsi1">[26]</xref>. Hence the population of cells is entrained by the control signal which keeps them from deviating from the reference signal, as can be appreciated by observing the time evolution of the control error (difference between the average fluorescence value of the population and the desired reference value) in <xref ref-type="supplementary-material" rid="pcbi.1003625.s021">Figure S21</xref>.</p>
<p>Of note, the results are even better than what expected from simulations (<xref ref-type="fig" rid="pcbi-1003625-g004">Figure 4</xref>), in terms of the offset between the reference signal and the actual fluorescence level. The improvement in the experiments can be explained by considering the delay term present in the mathematical model of IRMA used in the simulations. Such delay models the time required for the activation of the <italic>HO</italic> promoter driving expression of the <italic>CBF1</italic> gene in the network, that was quantified to be equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e102" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003625-Cantone1">[17]</xref>. The improvement in the experiments is explained by observing that real cells exhibit a much smaller delay than expected.</p>
<p>A possible explanation of this effect can be found in the epigenetic control of the <italic>HO</italic> promoter; the PI controller keeps activating this promoter indirectly via quickly alternating Galactose and Glucose, thus preventing the promoter to be completely silenced via chromatin remodeling, thus considerably reducing the transcriptional delay.</p>
<p>We also performed a second signal tracking experiment where the cells, after a calibration phase, were forced to increase the expression of Gfp at the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e103" xlink:type="simple"/></inline-formula> of the maximum value measured during the calibration and then to follow a linearly decreasing control reference for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e104" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1003625-g009">Figure 9</xref>).</p>
<fig id="pcbi-1003625-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003625.g009</object-id><label>Figure 9</label><caption>
<title><italic>In-vivo</italic> signal tracking control experiment on IRMA.</title>
<p>(Top panel) the desired (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e105" xlink:type="simple"/></inline-formula> in blue) and experimentally quantified GFP (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e106" xlink:type="simple"/></inline-formula> in green) are shown for the whole duration of the experiment (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e107" xlink:type="simple"/></inline-formula>). (Bottom panel) the input signal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e108" xlink:type="simple"/></inline-formula> computed by the control algorithm is shown in red. (Insets) Images taken during the experiment show the growing yeast population at the beginning, at the half and at the end of the experiment.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003625.g009" position="float" xlink:type="simple"/></fig>
<p>Also in this case the control task was achieved, as shown <xref ref-type="fig" rid="pcbi-1003625-g009">Figure 9</xref>. As before, the controller was able to keep the average of the fluorescence close to the reference signal thus the control error remained bounded for the entire experiment (<xref ref-type="supplementary-material" rid="pcbi.1003625.s022">Figure S22</xref>), although the number of cells was exponentially increasing (<xref ref-type="supplementary-material" rid="pcbi.1003625.s023">Figure S23</xref>).</p>
<p>These results confirm that our control platform can be applied also to control protein expression in a complex gene network.</p>
</sec></sec></sec><sec id="s4">
<title>Discussion</title>
<p>The experimental results described here convincingly demonstrate that the expression of a protein can be controlled in vivo in real-time, using an inducer molecule acting directly or indirectly on protein expression, by applying principles drawn from classical control theory, and without requiring detailed quantitative knowledge of the process to be controlled, at least in the case of set-point regulation.</p>
<p>An experimental control platform, sharing some similarity with our work, was presented as this manuscript was under review <xref ref-type="bibr" rid="pcbi.1003625-Uhlendorf2">[13]</xref>. Differently from our approach, the control scheme proposed by the authors enabled regulation of a reporter protein expression from the Hog1 promoter using osmotic pressure as a control input. The authors implemented a model predictive control scheme which relied on a pre-existing quantitative model of the Hog1 promoter to be controlled, which may not always be available when applying the scheme to a different promoter. Since the authors, for their control scheme, exploited the osmolarity pathway, which shows adaptation, they needed to develop a model-based control approach to predict the system's behaviour.</p>
<p>One of the advantages of our control scheme is that it can use as input any molecule and thus it may be easily transferred to the control of any other endogenous promoter, or gene network, whose dynamics can be elicited by external molecules and for which a measurable estimate of the output is available. Another useful feature is the use of a PI controller that requires minimal knowledge of the model of the system to be controlled. This generality, however, comes at a price: first, if the biological system to be controlled exhibits adaptation, or strong non-linear behaviors such as hysteresis, the PI controller is likely to fail, and a model-based control approach may be required <xref ref-type="bibr" rid="pcbi.1003625-Uhlendorf2">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1003625-Samoilov1">[27]</xref> (e.g. lack of controllability as investigated in Liu et al. <xref ref-type="bibr" rid="pcbi.1003625-Liu1">[28]</xref>); second, the need to construct a fusion protein with a fluorescent reporter, may disrupt the physiological function of the protein.</p>
<p>In addition to providing an innovative platform to control protein expression in a completely automatic fashion, our results show also that binary digital pulses of an inducer molecule can be encoded and interpreted by the cell population to produce an “analog” response, i.e. a triangular wave of protein expression, or constant level of the protein.</p>
<p>Digital-to-analog and analog-to-digital conversion are key features of signaling pathways. Gradients of extracellular stimuli are converted into an all-or-none responses by signaling pathways <xref ref-type="bibr" rid="pcbi.1003625-Kholodenko1">[29]</xref>. These digital responses, in turn, are decoded by the cells to generate analog time-varying transcriptional responses (digital-to-analog conversion). Here we show that this core mechanism can be exploited by artificial control systems to modify at will gene and protein expression.</p>
<p>In this context, we wish to emphasize that, while we focused on a pulse width modulation scheme alternative strategies can indeed be devised (e.g. Pulse Amplitude or Pulse Frequency Modulation).</p>
<p>The control quality obtained by our control scheme is remarkably good in the case of the Gal1 endogenous promoter, but it may seem unsatisfying in the case of the IRMA network when compared to classic control engineering approaches applied to engineering systems and devices. This is the first attempt to control gene expression in a complex network using feedback control in a noisy biological system. Indeed, the presence of cell-to-cell variability is one of the key obstacles when implementing control strategies for living systems. This is why here we aimed at controlling the average fluorescence level of the cell population, which is shown to converge towards the desired value. Moreover, the control scheme keeps biological noise from increasing and at a physiological level as estimated by the CV. Interestingly, in a related work <xref ref-type="bibr" rid="pcbi.1003625-Uhlendorf2">[13]</xref> reporting the result of a control strategy applied to a simpler gene circuit (a single promoter), the observed cell-to-cell variability is comparable to ours, demonstrating the inevitability of biological noise, and the challenges laying ahead for controlling gene expression in living cells.</p>
<p>The microfluidics-based control strategy we developed enables control experiments using small volumes of reagents with minimal perturbations to the cells. It can be easily implemented with limited costs to fine tune the expression of a protein of interest from an endogenous promoter with minimal intervention (i.e. introduction of a fluorescent reporter gene).</p>
<p>We believe that experimental biologists will find new and clever ways to apply our approach to study trafficking or signalling pathways and the endogenous control mechanisms of a cell.</p>
<p>Indeed the ability to simply overexpress a protein has led to innumerable new discoveries, and with our work we are providing a new ability which could be beneficial to many.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003625.s001" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p><bold>IRMA hybrid model.</bold> A hybrid model featuring two distinct vector fields (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e109" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e110" xlink:type="simple"/></inline-formula>) has been derived from the model presented in <xref ref-type="bibr" rid="pcbi.1003625-Cantone1">[17]</xref>. As long as Glucose is administered (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e111" xlink:type="simple"/></inline-formula>) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e112" xlink:type="simple"/></inline-formula> is activated, while the system switches to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e113" xlink:type="simple"/></inline-formula> as soon as Galactose is added to the medium to reflect the inner dynamics of the synthetic circuits to be controlled.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s002" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s002" position="float" xlink:type="simple"><label>Figure S2</label><caption>
<p><bold>IRMA control scheme.</bold> The upper block scheme represents the control algorithm. The lower block magnifies the Predictor block referred to as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e114" xlink:type="simple"/></inline-formula> in the previous schematic. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e115" xlink:type="simple"/></inline-formula> signal sets the desired output <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e116" xlink:type="simple"/></inline-formula> for the controlled system <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e117" xlink:type="simple"/></inline-formula>. The prediction block (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e118" xlink:type="simple"/></inline-formula>) uses the input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e119" xlink:type="simple"/></inline-formula> and output <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e120" xlink:type="simple"/></inline-formula> related to the actual plant <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e121" xlink:type="simple"/></inline-formula> to compute an anticipated version of the output obtained by simulating the response <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e122" xlink:type="simple"/></inline-formula> of mathematical model of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e123" xlink:type="simple"/></inline-formula> in which <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e124" xlink:type="simple"/></inline-formula>. This signal is immediately used to assess the effectiveness of the control action by feeding it back to the first comparator that computes the error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e125" xlink:type="simple"/></inline-formula> made by the system. Moreover, the actual output <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e126" xlink:type="simple"/></inline-formula> of the plant, is compared with a delayed version of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e127" xlink:type="simple"/></inline-formula> signal (as effect of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e128" xlink:type="simple"/></inline-formula> block contribution) to account for discrepancies between the predicted (via IRMA's model <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e129" xlink:type="simple"/></inline-formula>) and real plant behavior. A low-pass filter meant to suppress high-frequency noise is applied to the resulting signal to obtain (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e130" xlink:type="simple"/></inline-formula>) that is finally fed back to the comparator that will subtract it from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e131" xlink:type="simple"/></inline-formula> so as to obtain the control error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e132" xlink:type="simple"/></inline-formula>.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s003" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s003" position="float" xlink:type="simple"><label>Figure S3</label><caption>
<p><bold>Cohen-Coon approximation for IRMA.</bold> In order to design a suitable PI controller we estimated three parameters, namely <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e133" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e134" xlink:type="simple"/></inline-formula> and d (as referenced in <xref ref-type="bibr" rid="pcbi.1003625-Astrm1">[30]</xref>) from the step response profile of the IRMA nonlinear model in equation 1–5. The solid blue line represents the response of our gene network (Cbf1p being the output) to the addition of Galactose to the growth media at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e135" xlink:type="simple"/></inline-formula> while the dashed blue line shows the same information for the time delayed linear system identified with the method in <xref ref-type="bibr" rid="pcbi.1003625-Astrm1">[30]</xref>.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s004" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s004" position="float" xlink:type="simple"><label>Figure S4</label><caption>
<p><bold>Finite State Automaton implementing the control algorithm in <xref ref-type="supplementary-material" rid="pcbi.1003625.s002">Figure S2</xref>.</bold> In the initial state, state 0, the calibration is carried out as previously described. The system cycles on this state until the initialization is completed and then moves to state 1. At this point given the error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e136" xlink:type="simple"/></inline-formula>, the PI - PWM block is simulated to compute the control input <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e137" xlink:type="simple"/></inline-formula>. In state 2 the model prediction is calculated given <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e138" xlink:type="simple"/></inline-formula>; the input is then applied to the physical system by means of hydrostatic pressure modulation in step 3 (the correct amounts of Galactose/Raffinose and Glucose are provided at the end of this step). In state 4 the delayed version of computed output is calculated; during state 5, the presence of a new image is verified, and the image processing algorithm is run in order to obtain the system output measure. Given this it is possible to calculate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e139" xlink:type="simple"/></inline-formula> and the error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e140" xlink:type="simple"/></inline-formula> for the next control iteration. The algorithm then moves to state 1 for a new control iteration to start.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s005" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s005" position="float" xlink:type="simple"><label>Figure S5</label><caption>
<p><bold><italic>In-silico</italic></bold><bold> prediction-based signal tracking control of IRMA.</bold> The predictor-based algorithm is applied to control the dynamical model of IRMA to a time varying reference signal (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e141" xlink:type="simple"/></inline-formula>, in blue); the computed control input (higher state standing for Galactose and lower state meaning Glucose providing) is represented in red (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e142" xlink:type="simple"/></inline-formula>). The good overlap between the reference signal and the simulated Cbf1 time evolution (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e143" xlink:type="simple"/></inline-formula>) provides evidence for the robustness of the designed control scheme in two cases: (top panel) with no delay (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e144" xlink:type="simple"/></inline-formula>) and with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e145" xlink:type="simple"/></inline-formula> (bottom panel).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s006" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s006" position="float" xlink:type="simple"><label>Figure S6</label><caption>
<p><bold><italic>In-silico</italic></bold><bold> prediction-based set point control of IRMA.</bold> The predictor-based algorithm is applied to control the dynamical model of IRMA to a constant reference signal (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e146" xlink:type="simple"/></inline-formula> in blue). The set point is calculated as the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e147" xlink:type="simple"/></inline-formula> of the maximum value for the simulated Cbf1 time evolution evaluated until <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e148" xlink:type="simple"/></inline-formula>. The control input (computed after time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e149" xlink:type="simple"/></inline-formula> where higher state standing for Galactose and lower state meaning Glucose providing) is represented in red (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e150" xlink:type="simple"/></inline-formula>). The simulation was performed with the dynamical model without delay (top panel) or with a delay <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e151" xlink:type="simple"/></inline-formula> (bottom panel). In both cases, the control action is able to guarantee good dynamical performances of the system, indeed the simulated Cbf1 time evolution (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e152" xlink:type="simple"/></inline-formula> in green) tightly matches the reference signal.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s007" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s007" position="float" xlink:type="simple"><label>Figure S7</label><caption>
<p><bold><italic>In-silico</italic></bold><bold> PI/PWM signal tracking control of IRMA.</bold> The PI/PWM control algorithm is applied to control the dynamical model of IRMA to a time varying reference signal (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e153" xlink:type="simple"/></inline-formula>, in blue); the computed control input (high level: Galactose; low level: Glucose) is shown in red (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e154" xlink:type="simple"/></inline-formula>); the Cbf1 time evolution is shown in green (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e155" xlink:type="simple"/></inline-formula>). When the control is applied to the model without the delay, the control output (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e156" xlink:type="simple"/></inline-formula>) follows the reference signal (top panel); whereas the PI - PWM is not able to achieve the control objective for the model with the delay (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e157" xlink:type="simple"/></inline-formula>) (bottom panel).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s008" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s008" position="float" xlink:type="simple"><label>Figure S8</label><caption>
<p><bold><italic>In-silico</italic></bold><bold> PI/PWM set point control of IRMA.</bold> The PI/PWM control algorithm is applied to control the dynamical model of IRMA to a constant reference signal (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e158" xlink:type="simple"/></inline-formula>). The set point is equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e159" xlink:type="simple"/></inline-formula> of the maximum value for the simulated Cbf1 time evolution evaluated until <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e160" xlink:type="simple"/></inline-formula>. The control input, computed after time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e161" xlink:type="simple"/></inline-formula>, is shown in red (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e162" xlink:type="simple"/></inline-formula> high level: Galactose; low level: Glucose). The simulation was performed with the dynamical model without delay (top panel) or with a delay <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e163" xlink:type="simple"/></inline-formula> (bottom panel). When the control is applied to the model without delay, the control output (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e164" xlink:type="simple"/></inline-formula>) follows the reference signal (top panel); on the contrary, the PI - PWM is not able to achieve the control objective for the model with the delay (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e165" xlink:type="simple"/></inline-formula>) (bottom panel).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s009" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s009" position="float" xlink:type="simple"><label>Figure S9</label><caption>
<p><bold>Image processing.</bold> The algorithm applies Otsu thresholding to binarize the grey scale phase contrast image (A). Convex hulls (B) are then used to limit the application of the Circular Hought Transform to find cells' centers and edges (C).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s010" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s010" position="float" xlink:type="simple"><label>Figure S10</label><caption>
<p><bold><italic>In-vivo</italic></bold><bold> set point control experiment no. 1 for the </bold><bold><italic>GAL1</italic></bold><bold> promoter - fluorescence standard deviation.</bold> By using the off-line analysis described in the text, it is possible to compute the standard deviation of the fluorescence for each frame acquired during the control experiment. The desired amount of protein (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e166" xlink:type="simple"/></inline-formula> in blue), the quantified GFP (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e167" xlink:type="simple"/></inline-formula> green line) and the standard deviation's upper and lower bounds (thin green lines) are shown; the control error (top pane in black) is computed as the difference between the feedback signal and the control reference. The input signal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e168" xlink:type="simple"/></inline-formula> computed by the control algorithm is shown in red (bottom panel).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s011" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s011" position="float" xlink:type="simple"><label>Figure S11</label><caption>
<p><bold><italic>In-vivo</italic></bold><bold> set point control experiment no. 2 for the </bold><bold><italic>GAL1</italic></bold><bold> promoter - fluorescence standard deviation.</bold> By using the off-line analysis described in the text, it is possible to compute the standard deviation of the fluorescence for each frame acquired during the control experiment. The desired amount of protein (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e169" xlink:type="simple"/></inline-formula> in blue), the quantified GFP (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e170" xlink:type="simple"/></inline-formula> green line) and the standard deviation's upper and lower bounds (thin green lines) are shown; the control error (top pane in black) is computed as the difference between the feedback signal and the control reference. The input signal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e171" xlink:type="simple"/></inline-formula> computed by the control algorithm is shown in red (bottom panel).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s012" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s012" position="float" xlink:type="simple"><label>Figure S12</label><caption>
<p><bold><italic>In-vivo</italic></bold><bold> set point control experiment no. 3 for the </bold><bold><italic>GAL1</italic></bold><bold> promoter - fluorescence standard deviation.</bold> By using the off-line analysis described in the text, it is possible to compute the standard deviation of the fluorescence for each frame acquired during the control experiment. The desired amount of protein (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e172" xlink:type="simple"/></inline-formula> in blue), the quantified GFP (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e173" xlink:type="simple"/></inline-formula> green line) and the standard deviation's upper and lower bounds (thin green lines) are shown; the control error (top pane in black) is computed as the difference between the feedback signal and the control reference. The input signal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e174" xlink:type="simple"/></inline-formula> computed by the control algorithm is shown in red (bottom panel).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s013" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s013" position="float" xlink:type="simple"><label>Figure S13</label><caption>
<p><bold><italic>In-vivo</italic></bold><bold> set point control experiment no. 4 for the </bold><bold><italic>GAL1</italic></bold><bold> promoter - fluorescence standard deviation.</bold> By using the off-line analysis described in the text, it is possible to compute the standard deviation of the fluorescence for each frame acquired during the control experiment. The desired amount of protein (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e175" xlink:type="simple"/></inline-formula> in blue), the quantified GFP (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e176" xlink:type="simple"/></inline-formula> green line) and the standard deviation's upper and lower bounds (thin green lines) are shown; the control error (top pane in black) is computed as the difference between the feedback signal and the control reference. The input signal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e177" xlink:type="simple"/></inline-formula> computed by the control algorithm is shown in red (bottom panel).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s014" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s014" position="float" xlink:type="simple"><label>Figure S14</label><caption>
<p><bold><italic>In-vivo</italic></bold><bold> set point control experiments </bold><bold><italic>GAL1</italic></bold><bold> promoter - cell count and coefficient of variation.</bold> (A-D) For each of the experiments of Supplementary Figures S10, S11, S12 and S13, the number of cells (top) and the coefficient of variation (bottom) are shown.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s015" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s015" position="float" xlink:type="simple"><label>Figure S15</label><caption>
<p><bold><italic>In-vivo</italic></bold><bold> set point control experiment for the IRMA network - fluorescence standard deviation.</bold> By using the off-line analysis described in the text it is possible to calculate the standard deviation of the fluorescence for each frame acquired during the control. The desired amount of protein (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e178" xlink:type="simple"/></inline-formula> in blue), the quantified GFP (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e179" xlink:type="simple"/></inline-formula> green line), the standard deviation's upper and lower bounds (thin green lines) and the control error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e180" xlink:type="simple"/></inline-formula> in black are shown; mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e181" xlink:type="simple"/></inline-formula>, variance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e182" xlink:type="simple"/></inline-formula> and coefficient of variation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e183" xlink:type="simple"/></inline-formula> of the control error are also shown; the p-value was computed as described in the Supplementary Information text (top panel). The input signal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e184" xlink:type="simple"/></inline-formula> computed by the control algorithm is shown in red (bottom panel).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s016" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s016" position="float" xlink:type="simple"><label>Figure S16</label><caption>
<p><bold><italic>In-vivo</italic></bold><bold> signal tracking control experiment for the IRMA network - cell count and coefficient of variation.</bold> For the experiment of Supplementary <xref ref-type="supplementary-material" rid="pcbi.1003625.s015">Figure S15</xref>, the number of cell (top panel) and the coefficient of variation (bottom panel) are shown.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s017" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s017" position="float" xlink:type="simple"><label>Figure S17</label><caption>
<p><bold>Response to a sustained galactose input for the IRMA network.</bold> Green line: fluorescence measured when the cells are treated with galactose for the whole experiment; light green line: fluorescence measured during the in-vivo set point control experiment (<xref ref-type="fig" rid="pcbi-1003625-g007">Figure 7</xref> - main text); black line: the control reference of the set-point control experiment (<xref ref-type="fig" rid="pcbi-1003625-g007">Figure 7</xref> - main text); red line: the sustained galactose input provided to the cells population; light red: the input calculated automatically by the control algorithm and used to regulate the production of GFP to the desired level in in-vivo set point control experiment (<xref ref-type="fig" rid="pcbi-1003625-g007">Figure 7</xref> - main text).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s018" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s018" position="float" xlink:type="simple"><label>Figure S18</label><caption>
<p><bold>Response to a sustained galactose input for the IRMA network.</bold> Green line: fluorescence measured when the cells are treated with galactose for the whole experiment; blue line: the control reference of the set-point control experiment (<xref ref-type="fig" rid="pcbi-1003625-g007">Figure 7</xref> - main text) (Top panel).(Bottom panel) red line: the sustained galactose input administered to cells. The normalised root mean square error (NRMSE) of the deviation between the blue and the green signal has been reported to be equal to 0.33.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s019" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s019" position="float" xlink:type="simple"><label>Figure S19</label><caption>
<p><bold><italic>In-vivo</italic></bold><bold> signal tracking control experiment for the IRMA network - fluorescence standard deviation.</bold> By using the off-line analysis described in the text it is possible to calculate the standard deviation of the fluorescence for each frame acquired during the control. The desired amount of protein (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e185" xlink:type="simple"/></inline-formula> in blue), the quantified GFP (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e186" xlink:type="simple"/></inline-formula> green line) and its upper and lower bound of the standard deviation (thin green lines) are plotted (top panel). The input signal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e187" xlink:type="simple"/></inline-formula> computed by the control algorithm is shown in red (bottom panel).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s020" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s020" position="float" xlink:type="simple"><label>Figure S20</label><caption>
<p><bold><italic>In-vivo</italic></bold><bold> signal tracking control experiment for the IRMA network - cell count and coefficient of variation.</bold> For the experiment of <xref ref-type="supplementary-material" rid="pcbi.1003625.s019">Figure S19</xref>, the number of cell (top panel) and the coefficient of variation (bottom panel) are plotted.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s021" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s021" position="float" xlink:type="simple"><label>Figure S21</label><caption>
<p><bold>Internal signals of the control experiment in </bold><xref ref-type="fig" rid="pcbi-1003625-g008"><bold>Fig. 8</bold></xref><bold> (main text).</bold> Time evolution of the most relevant signals in the control loop are shown. In particular the Galactose concentration in the medium (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e188" xlink:type="simple"/></inline-formula>) provided to the cells has been plotted in red, while the output of the delay-free model (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e189" xlink:type="simple"/></inline-formula>) and its delayed version (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e190" xlink:type="simple"/></inline-formula>) are shown in green and violet respectively. The error signal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e191" xlink:type="simple"/></inline-formula> (black) calculated as the difference between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e192" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e193" xlink:type="simple"/></inline-formula> (cyan) is also depicted; mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e194" xlink:type="simple"/></inline-formula>, variance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e195" xlink:type="simple"/></inline-formula> and coefficient of variation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e196" xlink:type="simple"/></inline-formula> of the control error are also shown.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s022" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s022" position="float" xlink:type="simple"><label>Figure S22</label><caption>
<p><bold><italic>In-vivo</italic></bold><bold> signal tracking control experiment 2 for the IRMA network - fluorescence standard deviation.</bold> By using the off-line analysis described in the text it is possible to calculate the standard deviation of the fluorescence for each frame acquired during the control. The desired amount of protein (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e197" xlink:type="simple"/></inline-formula> in blue), the quantified GFP (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e198" xlink:type="simple"/></inline-formula> green line) and its upper and lower bound of the standard deviation (thin green lines) are plotted; the control error calculated as the difference between the feedback signal and the control reference is shown in black (top panel). The input signal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e199" xlink:type="simple"/></inline-formula> computed by the control algorithm is shown in red (bottom panel).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s023" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s023" position="float" xlink:type="simple"><label>Figure S23</label><caption>
<p><bold><italic>In-vivo</italic></bold><bold> signal tracking control experiment 2 for the IRMA network - cell count and coefficient of variation.</bold> For the experiment of <xref ref-type="supplementary-material" rid="pcbi.1003625.s022">Figure S22</xref>, the number of cell (top panel) and the coefficient of variation(bottom panel) are plotted.</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s024" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s024" position="float" xlink:type="simple"><label>Figure S24</label><caption>
<p><bold>Calibration phase.</bold> The calibration data have been reported for the experiment in <xref ref-type="fig" rid="pcbi-1003625-g008">Fig. 8</xref>. The simulated (blue) and quantified (green) Gfp evolution have been used to relate fluorescence data to model predictions (model units).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s025" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s025" position="float" xlink:type="simple"><label>Figure S25</label><caption>
<p><bold>IRMA switch off experiment.</bold> Top panel: the green signals represent the measured fluorescence during <italic>in-vivo</italic> switch - off experiments, the blue signal is the result of <italic>in-silico</italic> switch off experiment using the dynamical model of IRMA (all the experimental signals are rescaled to the model range). Bottom panel: the input used to perform the experiment; cells have been fed for 180 minutes with galactose (ON signal, 1 for the mathematical model) and for 420 minutes with glucose (OFF signal, 0 for the mathematical model).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s026" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s026" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>Supplementary information text.</bold> All the additional details concerning materials and methods of the present work are here reported.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s027" mimetype="video/mpeg" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s027" position="float" xlink:type="simple"><label>Video S1</label><caption>
<p><bold>Movie of the experiment in </bold><xref ref-type="fig" rid="pcbi-1003625-g008"><bold>Figure 8</bold></xref><bold>.</bold> (Top left panel) Yeast cell fluorescence during the control experiment; (top right panel) cell count; (bottom left panel) desired (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e200" xlink:type="simple"/></inline-formula> in blue) experimentally quantified GFP fluorescence (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e201" xlink:type="simple"/></inline-formula> in green) and input (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e202" xlink:type="simple"/></inline-formula> in black) calculated by the control algorithm are shown for the whole duration of the experiment; (bottom right panel) histogram of the cell fluorescence distribution.</p>
<p>(MPG)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003625.s028" mimetype="video/mpeg" xlink:href="info:doi/10.1371/journal.pcbi.1003625.s028" position="float" xlink:type="simple"><label>Video S2</label><caption>
<p><bold>Movie of the experiment in </bold><xref ref-type="fig" rid="pcbi-1003625-g009"><bold>Figure 9</bold></xref><bold>.</bold> (Top left panel) Yeast cell fluorescence during the control experiment; (top right panel) cell count; (bottom left panel) desired (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e203" xlink:type="simple"/></inline-formula> in blue) experimentally quantified GFP fluorescence (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e204" xlink:type="simple"/></inline-formula> in green) and input (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003625.e205" xlink:type="simple"/></inline-formula> in black) calculated by the control algorithm are shown for the whole duration of the experiment; (bottom right panel) histogram of the cell fluorescence distribution.</p>
<p>(MPG)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We are thankful to Prof. Botstein for providing yeast strains.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003625-Iglesias1"><label>1</label>
<mixed-citation publication-type="other" xlink:type="simple">Iglesias PA, Ingalls BP (2010) Control theory and systems biology. The MIT Press.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Russo1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Russo</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Di Bernardo</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Sontag</surname><given-names>ED</given-names></name> (<year>2010</year>) <article-title>Global entrainment of transcriptional systems to periodic inputs</article-title>. <source>PLoS computational biology</source> <volume>6</volume>: <fpage>e1000739</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-DelVecchio1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Del Vecchio</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Ninfa</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Sontag</surname><given-names>ED</given-names></name> (<year>2008</year>) <article-title>Modular cell biology: retroactivity and insulation</article-title>. <source>Molecular systems biology</source> <volume>4</volume>: <fpage>161</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Kurata1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kurata</surname><given-names>H</given-names></name>, <name name-style="western"><surname>El-Samad</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Iwasaki</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Ohtake</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Doyle</surname><given-names>JC</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Module-based analysis of robustness tradeoffs in the heat shock response system</article-title>. <source>PLoS computational biology</source> <volume>2</volume>: <fpage>e59</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-ElSamad1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>El-Samad</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Khammash</surname><given-names>M</given-names></name> (<year>2006</year>) <article-title>Regulated degradation is a mechanism for suppressing stochastic fluctuations in gene regulatory networks</article-title>. <source>Biophysical journal</source> <volume>90</volume>: <fpage>3749</fpage>–<lpage>3761</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Murphy1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Murphy</surname><given-names>KF</given-names></name>, <name name-style="western"><surname>Adams</surname><given-names>RM</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Balazsi</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Collins</surname><given-names>JJ</given-names></name> (<year>2010</year>) <article-title>Tuning and controlling gene expression noise in synthetic gene networks</article-title>. <source>Nucleic acids research</source> <volume>38</volume>: <fpage>2712</fpage>–<lpage>2726</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Apgar1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Apgar</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Toettcher</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Endy</surname><given-names>D</given-names></name>, <name name-style="western"><surname>White</surname><given-names>FM</given-names></name>, <name name-style="western"><surname>Tidor</surname><given-names>B</given-names></name> (<year>2008</year>) <article-title>Stimulus design for model selection and validation in cell signaling</article-title>. <source>PLoS computational biology</source> <volume>4</volume>: <fpage>e30</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Bagheri1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bagheri</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Stelling</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Doyle</surname><given-names>F</given-names></name> (<year>2007</year>) <article-title>Circadian phase entrainment via nonlinear model predictive control</article-title>. <source>International Journal of Robust and Nonlinear Control</source> <volume>17</volume>: <fpage>1555</fpage>–<lpage>1571</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Klavins1"><label>9</label>
<mixed-citation publication-type="other" xlink:type="simple">Klavins E (2010) Proportional-integral control of stochastic gene regulatory networks. In: Decision and Control (CDC), 2010 49th IEEE Conference on. IEEE, pp. 2547–2553.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Uhlendorf1"><label>10</label>
<mixed-citation publication-type="other" xlink:type="simple">Uhlendorf J, Bottani S, Fages F, Hersen P, Batt G (2011) Towards real-time control of gene expression: Controlling the hog signaling cascade. In: Pacific Symposium on Biocomputing. World Scientific, pp. 338–349.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Toettcher1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Toettcher</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Gong</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Lim</surname><given-names>WA</given-names></name>, <name name-style="western"><surname>Weiner</surname><given-names>OD</given-names></name> (<year>2011</year>) <article-title>Light-based feedback for controlling intracellular signaling dynamics</article-title>. <source>Nature methods</source> <volume>8</volume>: <fpage>837</fpage>–<lpage>839</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-MiliasArgeitis1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Milias-Argeitis</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Summers</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Stewart-Ornstein</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Zuleta</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Pincus</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>In silico feedback for in vivo regulation of a gene expression circuit</article-title>. <source>Nature biotechnology</source> <volume>29</volume>: <fpage>1114</fpage>–<lpage>1116</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Uhlendorf2"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Uhlendorf</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Miermont</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Delaveau</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Charvin</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Fages</surname><given-names>F</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Long-term model predictive control of gene expression at the population and single-cell levels</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>109</volume>: <fpage>14271</fpage>–<lpage>14276</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Ferry1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ferry</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Razinkov</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Hasty</surname><given-names>J</given-names></name> (<year>2011</year>) <article-title>Microfluidics for synthetic biology from design to execution</article-title>. <source>Methods Enzymol</source> <volume>497</volume>: <fpage>295</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Lang1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lang</surname><given-names>GI</given-names></name>, <name name-style="western"><surname>Botstein</surname><given-names>D</given-names></name> (<year>2011</year>) <article-title>A test of the coordinated expression hypothesis for the origin and maintenance of the gal cluster in yeast</article-title>. <source>PloS one</source> <volume>6</volume>: <fpage>e25290</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Bennett1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bennett</surname><given-names>MR</given-names></name>, <name name-style="western"><surname>Pang</surname><given-names>WL</given-names></name>, <name name-style="western"><surname>Ostroff</surname><given-names>NA</given-names></name>, <name name-style="western"><surname>Baumgartner</surname><given-names>BL</given-names></name>, <name name-style="western"><surname>Nayak</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Metabolic gene regulation in a dynamically changing environment</article-title>. <source>Nature</source> <volume>454</volume>: <fpage>1119</fpage>–<lpage>1122</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Cantone1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cantone</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Marucci</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Iorio</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Ricci</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Belcastro</surname><given-names>V</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>A yeast synthetic network for in vivo assessment of reverse-engineering and modeling approaches</article-title>. <source>Cell</source> <volume>137</volume>: <fpage>172</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Camacho1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Camacho</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Collins</surname><given-names>JJ</given-names></name> (<year>2009</year>) <article-title>Systems biology strikes gold</article-title>. <source>Cell</source> <volume>137</volume>: <fpage>24</fpage>–<lpage>26</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Cosma1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cosma</surname><given-names>MP</given-names></name>, <name name-style="western"><surname>Tanaka</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Nasmyth</surname><given-names>K</given-names></name> (<year>1999</year>) <article-title>Ordered recruitment of transcription and chromatin remodeling factors to a cell cycle–and developmentally regulated promoter</article-title>. <source>Cell</source> <volume>97</volume>: <fpage>299</fpage>–<lpage>311</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Yosef1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yosef</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Regev</surname><given-names>A</given-names></name> (<year>2011</year>) <article-title>Impulse control: temporal dynamics in gene transcription</article-title>. <source>Cell</source> <volume>144</volume>: <fpage>886</fpage>–<lpage>896</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Menolascina1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Menolascina</surname><given-names>F</given-names></name>, <name name-style="western"><surname>di Bernardo</surname><given-names>M</given-names></name>, <name name-style="western"><surname>di Bernardo</surname><given-names>D</given-names></name> (<year>2011</year>) <article-title>Analysis, design and implementation of a novel scheme for in-vivo control of synthetic gene regulatory networks</article-title>. <source>Automatica</source> <volume>47</volume>: <fpage>1265</fpage>–<lpage>1270</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Gordon1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gordon</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Colman-Lerner</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Chin</surname><given-names>TE</given-names></name>, <name name-style="western"><surname>Benjamin</surname><given-names>KR</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>RC</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Single-cell quantification of molecules and rates using open-source microscope-based cytometry</article-title>. <source>Nature methods</source> <volume>4</volume>: <fpage>175</fpage>–<lpage>181</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Kassakian1"><label>23</label>
<mixed-citation publication-type="other" xlink:type="simple">Kassakian JG, Schlecht MF, Verghese GC (1991) Principles of power electronics, volume 46. Addison-Wesley Reading, USA.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Banerjee1"><label>24</label>
<mixed-citation publication-type="other" xlink:type="simple">Banerjee S, Verghese GC (2001) Nonlinear phenomena in power electronics. IEEE press New York.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Smith1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname><given-names>O</given-names></name> (<year>1957</year>) <article-title>Closed control of loops with dead time</article-title>. <source>Chem Eng Progress</source> <volume>57</volume>: <fpage>217</fpage>–<lpage>219</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Balzsi1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Balázsi</surname><given-names>G</given-names></name>, <name name-style="western"><surname>van Oudenaarden</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Collins</surname><given-names>JJ</given-names></name> (<year>2011</year>) <article-title>Cellular decision making and biological noise: from microbes to mammals</article-title>. <source>Cell</source> <volume>144</volume>: <fpage>910</fpage>–<lpage>925</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Samoilov1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Samoilov</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Arkin</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Ross</surname><given-names>J</given-names></name> (<year>2002</year>) <article-title>Signal processing by simple chemical systems</article-title>. <source>The Journal of Physical Chemistry A</source> <volume>106</volume>: <fpage>10205</fpage>–<lpage>10221</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Liu1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname><given-names>YY</given-names></name>, <name name-style="western"><surname>Slotine</surname><given-names>JJ</given-names></name>, <name name-style="western"><surname>Barabási</surname><given-names>AL</given-names></name> (<year>2011</year>) <article-title>Controllability of complex networks</article-title>. <source>Nature</source> <volume>473</volume>: <fpage>167</fpage>–<lpage>173</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Kholodenko1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kholodenko</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Yaffe</surname><given-names>MB</given-names></name>, <name name-style="western"><surname>Kolch</surname><given-names>W</given-names></name> (<year>2012</year>) <article-title>Computational approaches for analyzing information flow in biological networks</article-title>. <source>Science signaling</source> <volume>5</volume>: <fpage>re1</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003625-Astrm1"><label>30</label>
<mixed-citation publication-type="other" xlink:type="simple">Aström KJ, Murray RM (2010) Feedback systems: an introduction for scientists and engineers. Princeton university press.</mixed-citation>
</ref>
</ref-list></back>
</article>