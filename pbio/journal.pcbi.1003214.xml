<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-00192</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003214</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories>
<title-group>
<article-title>The Next Generation of Transcription Factor Binding Site Prediction</article-title>
<alt-title alt-title-type="running-head">The Next Generation of TF Binding Site Prediction</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Mathelier</surname><given-names>Anthony</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Wasserman</surname><given-names>Wyeth W.</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><addr-line>Centre for Molecular Medicine and Therapeutics at the Child and Family Research Institute, Department of Medical Genetics, University of British Columbia, Vancouver, British Columbia, Canada</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Ioshikhes</surname><given-names>Ilya</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Ottawa University, Canada</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">amathelier@cmmt.ubc.ca</email> (AM); <email xlink:type="simple">wyeth@cmmt.ubc.ca</email> (WWW)</corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: AM WWW. Performed the experiments: AM. Analyzed the data: AM WWW. Wrote the paper: AM WWW. Implemented the software package: AM.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>9</month><year>2013</year></pub-date>
<pub-date pub-type="epub"><day>5</day><month>9</month><year>2013</year></pub-date>
<volume>9</volume>
<issue>9</issue>
<elocation-id>e1003214</elocation-id>
<history>
<date date-type="received"><day>1</day><month>2</month><year>2013</year></date>
<date date-type="accepted"><day>22</day><month>7</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2013</copyright-year>
<copyright-holder>Mathelier, Wasserman</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Finding where transcription factors (TFs) bind to the DNA is of key importance to decipher gene regulation at a transcriptional level. Classically, computational prediction of TF binding sites (TFBSs) is based on basic position weight matrices (PWMs) which quantitatively score binding motifs based on the observed nucleotide patterns in a set of TFBSs for the corresponding TF. Such models make the strong assumption that each nucleotide participates independently in the corresponding DNA-protein interaction and do not account for flexible length motifs. We introduce transcription factor flexible models (TFFMs) to represent TF binding properties. Based on hidden Markov models, TFFMs are flexible, and can model both position interdependence within TFBSs and variable length motifs within a single dedicated framework. The availability of thousands of experimentally validated DNA-TF interaction sequences from ChIP-seq allows for the generation of models that perform as well as PWMs for stereotypical TFs and can improve performance for TFs with flexible binding characteristics. We present a new graphical representation of the motifs that convey properties of position interdependence. TFFMs have been assessed on ChIP-seq data sets coming from the ENCODE project, revealing that they can perform better than both PWMs and the dinucleotide weight matrix extension in discriminating ChIP-seq from background sequences. Under the assumption that ChIP-seq signal values are correlated with the affinity of the TF-DNA binding, we find that TFFM scores correlate with ChIP-seq peak signals. Moreover, using available TF-DNA affinity measurements for the Max TF, we demonstrate that TFFMs constructed from ChIP-seq data correlate with published experimentally measured DNA-binding affinities. Finally, TFFMs allow for the straightforward computation of an integrated TF occupancy score across a sequence. These results demonstrate the capacity of TFFMs to accurately model DNA-protein interactions, while providing a single unified framework suitable for the next generation of TFBS prediction.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Transcription factors are critical proteins for sequence-specific control of transcriptional regulation. Finding where these proteins bind to DNA is of key importance for global efforts to decipher the complex mechanisms of gene regulation. Greater understanding of the regulation of transcription promises to improve human genetic analysis by specifying critical gene components that have eluded investigators. Classically, computational prediction of transcription factor binding sites (TFBS) is based on models giving weights to each nucleotide at each position. We introduce a novel statistical model for the prediction of TFBS tolerant of a broader range of TFBS configurations than can be conveniently accommodated by existing methods. The new models are designed to address the confounding properties of nucleotide composition, inter-positional sequence dependence and variable lengths (e.g. variable spacing between half-sites) observed in the more comprehensive experimental data now emerging. The new models generate scores consistent with DNA-protein affinities measured experimentally and can be represented graphically, retaining desirable attributes of past methods. It demonstrates the capacity of the new approach to accurately assess DNA-protein interactions. With the rich experimental data generated from chromatin immunoprecipitation experiments, a greater diversity of TFBS properties has emerged that can now be accommodated within a single predictive approach.</p>
</abstract>
<funding-group><funding-statement>The Wasserman laboratory is supported by the Canadian Institutes of Health Research (CIHR): MOP82875, and the Natural Sciences and Engineering Research Council of Canada: 15RGPIN355532-10. The computer systems of the Gene Regulation Bioinformatics Laboratory were funded by the Canada Foundation for Innovation and the BC Knowledge Development Fund. The research was supported by Award Number R01GM084875 from the National Institute of General Medical Sciences. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institute of General Medical Sciences or the National Institutes of Health. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="18"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Transcription factors (TFs) and their specific binding sites act to modulate the rate of gene transcription. They are central to key biological processes, such as organ development and tissue differentiation, nutrient and environmental stress responses and physiological signals. Delineating specific positions at which TFs bind to DNA is of high importance in deciphering gene regulation at the transcriptional level. Each TF binds a variety of DNA sites with sequence-specific affinity <xref ref-type="bibr" rid="pcbi.1003214-Badis1">[1]</xref>. As TFs bind to DNA in a sequence specific manner, computational methods for motif discrimination have been critically important for the prediction of transcription factor binding sites (TFBSs). Unfortunately, TFBSs are usually short and in most cases TFs are tolerant of sequence variations at many positions of the TFBS. This tolerance for variation impacts the accuracy of genome-scale prediction of TFBSs, as suitable TFBS sequences are found frequently. The accurate prediction of TFBSs is an enduring challenge <xref ref-type="bibr" rid="pcbi.1003214-Wasserman1">[2]</xref>, with ongoing approaches introduced to decrease the high rate of false predictions. In a human cell, it appears that most computationally predicted TFBS are not available for binding, presumably due to chromatin structure and/or local epigenetic properties. Approaches to address the false prediction issue have varied: phylogenetic methods to focus on sequences conserved during evolution <xref ref-type="bibr" rid="pcbi.1003214-Stark1">[3]</xref>, using experimentally mapped transcription start site data to focus on promoter proximal regions <xref ref-type="bibr" rid="pcbi.1003214-Bernard1">[4]</xref>, using histone modification or DNA accessibility data to highlight likely regulatory sequences <xref ref-type="bibr" rid="pcbi.1003214-Arvey1">[5]</xref>, or focusing on locally dense combinations of motifs <xref ref-type="bibr" rid="pcbi.1003214-HoSui1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1003214-HoSui2">[7]</xref> defined from TFBS enrichment analysis of co-expressed genes.</p>
<p>Classically, computational prediction of TFBSs is based on models called position weight matrices (PWMs) that reflect the preferred binding motifs associated to corresponding TFs by providing an additive score for any sequence. They approximate the true specificity of a TF and their parameters can be estimated through different methods (see <xref ref-type="bibr" rid="pcbi.1003214-Stormo1">[8]</xref> for a review). The basic PWMs make the assumption that each nucleotide within a TFBS participates independently in the corresponding DNA-protein interaction. Basic PWMs can perform well in modeling TFBS properties, but do not account for position interdependencies, that have repeatedly been observed to exist within TFBS motifs using crystal structure analyzes <xref ref-type="bibr" rid="pcbi.1003214-Luscombe1">[9]</xref>, biochemical studies <xref ref-type="bibr" rid="pcbi.1003214-Man1">[10]</xref>–<xref ref-type="bibr" rid="pcbi.1003214-Berger1">[12]</xref>, statistical analyzes of large collections of TFBS <xref ref-type="bibr" rid="pcbi.1003214-Barash1">[13]</xref>–<xref ref-type="bibr" rid="pcbi.1003214-Zhou1">[15]</xref>, or quantitative analyzes of protein binding microarray (PBM) data <xref ref-type="bibr" rid="pcbi.1003214-Mukherjee1">[16]</xref>–<xref ref-type="bibr" rid="pcbi.1003214-Zhao1">[18]</xref>. The latter study based on PBM data has demonstrated that position dependencies are stronger between neighboring positions than others. Incorporating these dinucleotide dependencies into the binding models has been shown to improve predictive accuracy <xref ref-type="bibr" rid="pcbi.1003214-Zhao1">[18]</xref>, albeit with modest impact in most cases. The recent comparison of several algorithms using PBM binding assays data in <xref ref-type="bibr" rid="pcbi.1003214-Weirauch1">[17]</xref> also included models considering dinucleotide composition. Recently, a new approach called dinucleotide weight matrices (DWMs) has been developed to extend the basic PWMs by considering the dinucleotide interactions between all pairs of positions within the TFBSs <xref ref-type="bibr" rid="pcbi.1003214-Siddharthan1">[19]</xref>.</p>
<p>Moreover, basic PWMs are restricted to the detection of motifs with a fixed length. This constraint has previously led to alternative heuristic approaches for the modeling of TFBS for TFs tolerant of variable widths, such as nuclear receptors <xref ref-type="bibr" rid="pcbi.1003214-Sandelin1">[20]</xref> and p53 <xref ref-type="bibr" rid="pcbi.1003214-Lyakhov1">[21]</xref>, <xref ref-type="bibr" rid="pcbi.1003214-Riley1">[22]</xref>. The analysis of variable spacing in the context of <italic>Escherichia coli</italic> promoter prediction was an early advance in the field, with the spacing between elements addressed with either PFMs <xref ref-type="bibr" rid="pcbi.1003214-Harr1">[23]</xref> or PWMs using logarithms of the probabilities <xref ref-type="bibr" rid="pcbi.1003214-Staden1">[24]</xref> (see <xref ref-type="bibr" rid="pcbi.1003214-Stormo1">[8]</xref> for a review). With the growth in TFBS data, early findings of variable TFBS configurations <xref ref-type="bibr" rid="pcbi.1003214-Ehret1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1003214-Soldaini1">[26]</xref> are not unique <xref ref-type="bibr" rid="pcbi.1003214-Reid1">[27]</xref>.</p>
<p>Several efforts have explored more flexible models for the prediction of TFBSs. Bayesian hierarchical hidden Markov models (HMMs) have been used to model <italic>cis</italic>-regulatory modules (CRMs) in <xref ref-type="bibr" rid="pcbi.1003214-Lin1">[28]</xref> but TFBSs included in the CRMs are predicted using basic PWMs. In <xref ref-type="bibr" rid="pcbi.1003214-Wasson1">[29]</xref>, the authors present a Boltzmann chain (i.e. an HMM generalization) to model the competition between DNA-binding factors as TFs which TFBSs are predicted using energy PWMs computed from PBM data. HMMs, which have been widely used in computationally biology for the prediction of protein motifs, have also been applied to the identification of TFBS. Implementations based on HMMs have been made for the detailed study of specific TFs or classes of TFs <xref ref-type="bibr" rid="pcbi.1003214-Sandelin1">[20]</xref>, <xref ref-type="bibr" rid="pcbi.1003214-Ehret1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1003214-Levkovitz1">[30]</xref>, and in a few cases the methods were generalized as a framework to theoritically analyze TFBS features <xref ref-type="bibr" rid="pcbi.1003214-Bulyk1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003214-Salama1">[31]</xref>, <xref ref-type="bibr" rid="pcbi.1003214-Mehta1">[32]</xref>. The MAPPER software was implemented using HMMs <xref ref-type="bibr" rid="pcbi.1003214-Marinescu1">[33]</xref>, <xref ref-type="bibr" rid="pcbi.1003214-Marinescu2">[34]</xref>, but the approach retained the classic focus on positional independence consistent with the preponderance of data available at the time. The HMMs approach used in <xref ref-type="bibr" rid="pcbi.1003214-Raman1">[35]</xref> allows for flexible length motifs through the use of profile HMMs, with the unconstrained potential for gaps to be incorporated at any position, as previously introduced for protein families <xref ref-type="bibr" rid="pcbi.1003214-Durbin1">[36]</xref>. To accommodate dependencies between TFBS positions, <xref ref-type="bibr" rid="pcbi.1003214-BenGal1">[37]</xref> introduces a variable-order Bayesian network to model TFBSs, but suggested that greater training data would allow HMM-based approaches to model dependencies at all positions. The growing community interest in the use of HMMs and more advanced models to discriminate TFBS reflects an underlying expectation that emerging data can lead to more effective models.</p>
<p>Recently, a new experimental technique has been developed to study sequences where proteins interact with DNA. This procedure is a combination of chromatin immunoprecipitation and massively parallel sequencing technologies - the well-known ChIP-seq procedure <xref ref-type="bibr" rid="pcbi.1003214-Johnson1">[38]</xref>. It gives, with good sensitivity and specificity, DNA sequences to which proteins of interest bind, providing the opportunity to precisely map those binding sites within the genome. Using such data, we can analyze in depth transcription regulation by focusing on DNA sequences that are bound by specific TFs. The availability of thousands of experimentally validated DNA-TF interaction sequences coming from ChIP-seq data and stored in databases such as produced by the ENCODE project <xref ref-type="bibr" rid="pcbi.1003214-ENCODE1">[39]</xref> allows researchers to develop new approaches for the prediction of specific locations of TFBSs with greater confidence than was previously possible.</p>
<p>We introduce here a novel TFBS model and prediction system based on HMMs, hereafter referred to as TF Flexible Model (TFFM). Building upon previously developed models capturing dinucleotide dependencies and flexible lengths as described previously (see <xref ref-type="supplementary-material" rid="pcbi.1003214.s015">Table S1</xref> for comparison of TFFMs with previous HMM-based TFBS predictions), our approach allows for the capture of these different features within a unique framework. The availability of thousands of ChIP-seq regions for a TF, potentially representing the full diversity of TFBS configurations, motivates the effort to transition to an HMM-based approach to TFBS prediction. The new HMM framework is flexible, supports dinucleotide composition analysis and variable lengths to predict TFBSs. The performance of TFFM was compared to established TFBS prediction methods through analysis of numerous ChIP-seq data sets. Most methods are comparable for TFs exhibiting classic TFBS structures, but TFFMs show distinct performance advantage for the subset of TFs with more diverse binding characteristics. By evaluating the correlation between TFFM scoring with ChIP-seq peak signals and experimentally measured DNA-binding affinities, we found that TFFM scores reflect TF-DNA interactions. Moreover, the probabilistic scheme of the TFFMs allows for a straightforward calculation of a total occupancy score for a DNA region. Researchers may construct and apply the TFFMs through open-source code via an application programming interface at <ext-link ext-link-type="uri" xlink:href="http://cisreg.cmmt.ubc.ca/TFFM/doc/" xlink:type="simple">http://cisreg.cmmt.ubc.ca/TFFM/doc/</ext-link> or directly through our web-based application at <ext-link ext-link-type="uri" xlink:href="http://cisreg.cmmt.ubc.ca/TFFM/" xlink:type="simple">http://cisreg.cmmt.ubc.ca/TFFM/</ext-link>. TFFMs build upon the best properties of the established methods, while offering novel capacities within a unified framework. Every TF has its own DNA binding characteristics (position dependencies, spacing, variable flanking regions, occupancy) which can be captured within the unified TFFM-framework.</p>
</sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>HMM-based framework to predict TFBSs</title>
<p>We present a new HMM-based framework to model and predict TFBSs. HMMs have been extensively used in computational biology to model DNA sequences <xref ref-type="bibr" rid="pcbi.1003214-Durbin1">[36]</xref>. They offer a flexible probabilistic method that gives us the opportunity to model TFBSs with their dinucleotide characteristics and that can be extended to take into consideration flexible motifs. In the context of modeling DNA sequences, an HMM is composed of a set of hidden states emitting nucleotides with defined probabilities (corresponding to the set of emission probabilities) and a set of transition probabilities from state to state. HMMs conveniently accommodate large data, deriving an optimal (at least locally) set of probabilities. HMMs can be trained using different well-established algorithms such as the Baum-Welch algorithm <xref ref-type="bibr" rid="pcbi.1003214-Durbin1">[36]</xref> or the Viterbi <xref ref-type="bibr" rid="pcbi.1003214-Durbin1">[36]</xref> algorithm. We chose the widely used Baum-Welch algorithm since it converges to a local optimum depending on a set of initialized probabilities.</p>
<p>Recent advances in the prediction of TFBSs have incorporated inter-positional properties through the analysis of dinucleotide properties across the sites. To construct models capturing the dinucleotide compositional properties of TFBSs, we implemented two HMM-based approaches.</p>
<p>Initially, we constructed standard first-order HMMs as TFFMs (denoted later as <italic>1st-order TFFMs</italic>). In such models, each position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e001" xlink:type="simple"/></inline-formula> within a TFBS is represented by a state emitting a nucleotide with probabilities dependent on the nucleotide found at the prior position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e002" xlink:type="simple"/></inline-formula> (see <xref ref-type="fig" rid="pcbi-1003214-g001">Figure 1A</xref>). In 1st-order TFFMs, we considered nucleotides surrounding the TFBSs (i.e. nucleotides located before and after a TFBS) by using a specific state modeling the background. The models developed here are similar to the probabilistic dinucleotide PWMs used in <xref ref-type="bibr" rid="pcbi.1003214-Segal1">[40]</xref> to model nucleosomes. However, the 1st-order TFFMs add the capability to capture the properties of the surrounding sequences through the background state, introduce motif length flexibility, and are built upon HMMs as a more dedicated probabilistic framework to model stochastic sequences.</p>
<fig id="pcbi-1003214-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003214.g001</object-id><label>Figure 1</label><caption>
<title>HMM schemas.</title>
<p>(A) 1st-order HMM schema used in 1st-order TFFMs where the first state represents the background and the following states the consecutive positions within a TFBS. Each state emits a nucleotide with a probability dependent on the nucleotide emitted previously. (B) HMM schema used in detailed TFFMs where each state in the 1st-order HMM is decomposed into four states (one per nucleotide). Transition probabilities reflects the emission probabilities of the 1st-order HMM. It allows the start of a TFBS depending on the nucleotide emitted by the background states.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003214.g001" position="float" xlink:type="simple"/></fig>
<p>In 1st-order TFFMs, starting a TFBS is given by a unique probability (representing the transition from the background to the TFBS) whatever the nucleotide found in the surrounding sequence. To allow for starting a TFBS depending on the nucleotide emitted in the background state, we implemented a more detailed and descriptive HMM template as TFFMs (denoted later as <italic>detailed TFFMs</italic>) mimicking the theoretical analysis made in <xref ref-type="bibr" rid="pcbi.1003214-Bulyk1">[11]</xref> (see <xref ref-type="fig" rid="pcbi-1003214-g001">Figure 1B</xref>). The intrinsic different structures of the 1st-order and detailed TFFMs lead to different probabilities for going from the background to the foreground. This is emphasized by the training through the Baum-Welch algorithm which reaches local maximum.</p>
</sec><sec id="s2b">
<title>A graphical representation of the dinucleotide dependencies</title>
<p>By constructing models taking into consideration local dinucleotide dependencies, we aim to better model, characterize, and understand TFBS properties. When trying to analyze and understand a model, a visual representation provides insight into the underlying properties. Basic PWMs for instance can be graphically represented using sequence logos <xref ref-type="bibr" rid="pcbi.1003214-Schneider1">[41]</xref> where each position gives the information content obtained for each nucleotide. The greater the height of the letter corresponding to a nucleotide, the higher the information content and higher the probability of getting it at this position. Using HMMs, we can derive the probability of obtaining each nucleotide at each position, allowing for the generation of sequence logos representing the TFBSs modeled using what we call a summary TFFM logo (see <xref ref-type="fig" rid="pcbi-1003214-g002">Figure 2B</xref>). In summary TFFM logos, we use the probability of each nucleotide at each position to compute the corresponding information content represented in the logo. But this graphical representation fails to convey the local dinucleotide dependencies that motivate the work. To tackle this issue, we introduce a new graphical representation (which we call a dense TFFM logo) allowing researchers to perceive the dinucleotide dependencies captured by the model. As the emission of a nucleotide at each position depends on the nucleotide emitted at the previous position, we represent the nucleotide probabilities at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e003" xlink:type="simple"/></inline-formula> for each possible nucleotide at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e004" xlink:type="simple"/></inline-formula>. Hence, each column represents a position within a TFBS and each row the nucleotide probabilities found at that position. Each row assumes a specific nucleotide has been emitted by the previous hidden state. The intersection between a column corresponding to position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e005" xlink:type="simple"/></inline-formula> and row corresponding to nucleotide <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e006" xlink:type="simple"/></inline-formula> gives the probabilities of getting each nucleotide at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e007" xlink:type="simple"/></inline-formula> if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e008" xlink:type="simple"/></inline-formula> has been seen at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e009" xlink:type="simple"/></inline-formula> (see <xref ref-type="fig" rid="pcbi-1003214-g002">Figure 2A</xref>). For instance, in <xref ref-type="fig" rid="pcbi-1003214-g002">Figure 2C</xref>, we can observe that a “C” is more likely to appear at position 12 if nucleotide “T” was found at position 11 (green box and arrow) whereas a “T” is more likely to appear at position 12 if nucleotide “G” was present at position 11 (orange box and arrow). In order to highlight the most probable row to be used by the TFFM, we vary the opacity to represent the sequence logo. The higher the probability of getting a nucleotide at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e010" xlink:type="simple"/></inline-formula>, the higher the opacity of the row corresponding to this nucleotide at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e011" xlink:type="simple"/></inline-formula>. Unfortunately, the current graphical representation does not allow for variable length or spacing of the motif modelled. One could envision introducing the variable length HMMs graphical representation by following the tool specifically developed in <xref ref-type="bibr" rid="pcbi.1003214-SchusterBckler1">[42]</xref> for protein families.</p>
<fig id="pcbi-1003214-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003214.g002</object-id><label>Figure 2</label><caption>
<title>Sequence logo representing a TFFM.</title>
<p>(A) Graphical representation of a TFFM constructed for the Hnf4A TF. Each column corresponds to a position within a TFBS. Each row captures the probabilities of each nucleotide to appear depending on the nucleotide found at the previous position. The opacity of a case represents the probability of hitting this case depending on the probability of appearance of the corresponding nucleotide at the previous position (the higher the opacity, the higher the probability). (B) The summary logo compacts all the information to summarize the dense logo in (A). (C) Zooming in on the dense TFFM logo for positions 10 to 13 (corresponding to the box in (A)). We observe that a “C” is more likely to appear at position 12 if nucleotide “T” was found at position 11 whereas a “T” is more likely to appear at position 12 if nucleotide “G” was found at position 11.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003214.g002" position="float" xlink:type="simple"/></fig></sec><sec id="s2c">
<title>Comparing predictive power of TFFMs with other models on ChIP-seq data</title>
<p>We provide the TFFM-framework to construct TFFMs from ChIP-seq data sets and to predict TFBSs within DNA sequences. When constructing a TFFM from ChIP-seq data, we extract (using MEME <xref ref-type="bibr" rid="pcbi.1003214-Bailey1">[43]</xref>, <xref ref-type="bibr" rid="pcbi.1003214-Bailey2">[44]</xref>) the most over-represented motif out of the top scoring ChIP-seq sequences and use it to initialize the HMM probabilities (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). Then, the final probabilities are learned using the Baum-Welch algorithm. When predicting TFBSs within DNA sequences using a TFFM, the software gives, at each position within the sequence, the probability of being in a final matching state (corresponding to the last position of a TFBS) in the underlying HMM. These probabilities correspond to posterior probabilities given an HMM and are computed using the well-known forward and backward algorithms <xref ref-type="bibr" rid="pcbi.1003214-Durbin1">[36]</xref>. When assessing the predictive power of the models, one can vary a threshold through these output probabilities to compute values of sensitivity and specificity. 1st-order and detailed TFFMs have been constructed using ENCODE <xref ref-type="bibr" rid="pcbi.1003214-ENCODE1">[39]</xref> ChIP-seq training data sets. The trained TFFMs were used to predict TFBSs within test ChIP-seq data sets by following a 10-fold cross-validation methodology. Finally, the results obtained with TFFMs were compared to the ones obtained from PWMs and DWMs constructed from and applied to the same data.</p>
<p>All ChIP-seq ENCODE data sets from human and mouse (with at least 1800 peaks and a peak max position indicated, i.e. 206 data sets) were used to compare the two types of TFFMs with PWMs and DWMs. Sequences around the peak max positions (50 nucleotides on both sides) were extracted to construct the models and make predictions. The rationale for this is that ChIP-seq peak max positions represent where the maximum amount of ChIP-seq reads map on the genome of reference and TFBSs are expected to be strongly enriched in close proximity to the peak max position <xref ref-type="bibr" rid="pcbi.1003214-Wilbanks1">[45]</xref>. For each data set, the 600 peaks with the highest signal were used to extract the most over-represented motif within the sequences and to initialize the model probabilities. To avoid over-fitting the data when assessing the predictive power of the different models, we used the remaining sequences to construct training and testing data sets following a 10-fold cross-validation approach. Assuming that high quality ChIP-seq data contain at least one true TFBS within each peak region, we considered the hit (matching sequence) with the best score per peak as a TFBS prediction. To assess the level of specificity for each method, we generated background data sets by randomly drawing sequences from mappable regions of the human and mouse genomes by keeping the same %GC composition distribution as in the ChIP-seq testing sequences (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). Another set of background sequences has been generated from a first-order HMM reflecting the background dinucleotide composition of each ChIP-seq testing data set. Across varying thresholds for TFBS prediction scores for the four different models, we calculate predictive sensitivity and specificity at each threshold value and trace the corresponding receiver operating characteristic (ROC) curves.</p>
<p>For each ENCODE ChIP-seq data set, the area under the curves (AUC) for the corresponding ROC curves (for all predictive methods) have been computed. To compare the predictive powers of the different methods, we focus on ChIP-seq data sets for which at least one predictive method achieves an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e012" xlink:type="simple"/></inline-formula> when discriminating ChIP-seq from genomic background sequences (i.e. 96 ChIP-seq data sets). We plot the ratios of performance between the best model and the others on the set of ChIP-seq data for which at least one predictive method is of high quality. In <xref ref-type="fig" rid="pcbi-1003214-g003">Figure 3</xref>, we show the ratio of performance to the best model for ChIP-seq data giving a high quality discriminative performance. When considering a similar performance between models when the ratio of the AUCs is above 95%, we show that the specificity of the binding proteins are captured similarly by using weight matrices (WMs) or TFFMs. Where the performance ratio is below 95%, we can observe an increase in discriminative power in favour of the TFFMs when compared to the WMs (compare the right part of <xref ref-type="fig" rid="pcbi-1003214-g003">Figure 3</xref> to the left part). When considering the strict difference between respective performance (i.e. when getting strictly higher AUC values), the results indicate that the TFFMs are performing strictly better than both the PWMs and the DWMs in discriminating ChIP-seq peak sequences from background sequences in two thirds of the data sets. Namely, the 1st-order and the detailed TFFMs are performing strictly better than both the PWMs and the DWMs for 63 and 65 data sets, respectively, over the 96 ChIP-seq data sets considered (see <xref ref-type="fig" rid="pcbi-1003214-g003">Figure 3</xref>). Taken together, the TFFMs perform strictly better than WMs in 67 data sets over 96 (70%). Similar results (65 over 94, 69%) are obtained when considering background sequences generated from a first-order HMM (see <xref ref-type="supplementary-material" rid="pcbi.1003214.s001">Figure S1</xref>). Explicit AUC values are plotted in <xref ref-type="supplementary-material" rid="pcbi.1003214.s002">Figure S2</xref>. We can observe that the TFFMs perform as well as or better than WMs overall on the sets of ChIP-seq data for which at least one predictive method is of high quality when discriminating ChIP-seq sequences from genomic background sequences. See similar results in <xref ref-type="supplementary-material" rid="pcbi.1003214.s003">Figure S3</xref> when considering HMM-generated background sequences.</p>
<fig id="pcbi-1003214-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003214.g003</object-id><label>Figure 3</label><caption>
<title>Performance comparison between TFFMs and weight matrices.</title>
<p>For the 96 ChIP-seq data sets obtaining an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e013" xlink:type="simple"/></inline-formula>% for at least one method (using a genomic background), the ratio between the AUC value using a specific model and the best AUC obtained is plotted. The four types of models were used (1st-order TFFM, detailed TFFM, PWM, and DWM). By considering a similar performance between two methods when the AUC ratio is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e014" xlink:type="simple"/></inline-formula>%, we plot at the top of the figure the region where the weight matrices (WMs) best perform, where the TFFMs best perform, and where they are similar. AUC ratios are ranked from the least to the most favourable to the TFFMs.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003214.g003" position="float" xlink:type="simple"/></fig>
<p>Statistical significances of the differences in terms of discriminative power between the different methods has been computed for each pair of methods using a Wilcoxon signed rank test <xref ref-type="bibr" rid="pcbi.1003214-Wilcoxon1">[46]</xref> assuming the null hypothesis of a symmetric distribution of AUC differences around 0 when two methods perform similarly. <xref ref-type="table" rid="pcbi-1003214-t001">Table 1</xref> contains the Benjamini-Hochberg <xref ref-type="bibr" rid="pcbi.1003214-Benjamini1">[47]</xref> corrected statistical significance of the differences between each one of the predictive methods when considering data sets where at least one method obtains an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e015" xlink:type="simple"/></inline-formula>. It shows that the performance difference between the two TFFMs is not significant with a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e016" xlink:type="simple"/></inline-formula>-value of 0.528. On the contrary, the difference of performance when comparing both of the TFFMs with the PWMs and the DWMs is statistically significant (see <xref ref-type="table" rid="pcbi-1003214-t001">Table 1</xref> where the maximal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e017" xlink:type="simple"/></inline-formula>-value is equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e018" xlink:type="simple"/></inline-formula>). These <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e019" xlink:type="simple"/></inline-formula>-values indicate that the null hypothesis can be rejected. PWMs and DWMs have more comparable behavior since the difference in performance is less statistically significant (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e020" xlink:type="simple"/></inline-formula>, see <xref ref-type="table" rid="pcbi-1003214-t001">Table 1</xref>). Again, similar results are obtained when considering HMM-generated background sequences (see <xref ref-type="supplementary-material" rid="pcbi.1003214.s016">Table S2</xref>).</p>
<table-wrap id="pcbi-1003214-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003214.t001</object-id><label>Table 1</label><caption>
<title>Statistical significance for discriminative power differences between the predictive methods.</title>
</caption><alternatives><graphic id="pcbi-1003214-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003214.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">1st-order TFFM</td>
<td align="left" rowspan="1" colspan="1">detailed TFFM</td>
<td align="left" rowspan="1" colspan="1">DWM</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>detailed TFFM</bold></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e021" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">-</td>
<td align="left" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>DWM</bold></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e022" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e023" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">-</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>PWM</bold></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e024" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e025" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e026" xlink:type="simple"/></inline-formula></td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><p>The table contains the Benjamini-Hochberg corrected <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e027" xlink:type="simple"/></inline-formula>-values of the differences (using a Wilcoxon signed rank test) between each pair of methods. 1st-order and detailed TFFMs are likely to perform similarly and so between PWM and DWM. <xref ref-type="sec" rid="s2">Results</xref> are obtained using data sets for which at least one method obtains an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e028" xlink:type="simple"/></inline-formula>% when discriminating ChIP-seq data from genomic background sequences. <xref ref-type="sec" rid="s2">Results</xref> obtained with HMM-generated background sequences are given in <xref ref-type="supplementary-material" rid="pcbi.1003214.s016">Table S2</xref>.</p></fn></table-wrap-foot></table-wrap>
<p>To understand whether the TFFMs perform better than the PWMs because of the model or because of the training method (as both differ), we introduce a 0-order TFFM which is basically a PFM modeled by an HMM and trained using the Baum-Welch algorithm (see <xref ref-type="supplementary-material" rid="pcbi.1003214.s014">Figure S14</xref>). We used the 0-order TFFMs to discriminate ChIP-seq sequences from background sequences on the same data sets as previously and computed the corresponding AUCs. In <xref ref-type="fig" rid="pcbi-1003214-g004">Figure 4A</xref>, we observe that the 1st-order and detailed TFFMs outperform the 0-order TFFMs (best AUC of the 1st-order or detailed TFFMs in 90 data sets out of 96, i.e. 94%) emphasizing the need to consider dinucleotide dependencies in the models. In <xref ref-type="fig" rid="pcbi-1003214-g004">Figure 4B</xref>, we compare the 0-order TFFMs to the WMs. The discriminative power of the WMs is higher than the 0-order TFFMs (WMs obtain strictly better AUCs than 0-order TFFMs in 67 data sets out of 96, i.e. 70%, and PWMs perform strictly better than 0-order TFFMs in 63 out of 96 data sets, i.e. 66%) showing that the good performance of the 1st-order and detailed TFFMs does not directly arise from the training methodology since PWMs are performing better, overall, than 0-order TFFMs. Similar results are obtained when using HMM-generated background sequences (see <xref ref-type="supplementary-material" rid="pcbi.1003214.s004">Figure S4</xref>).</p>
<fig id="pcbi-1003214-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003214.g004</object-id><label>Figure 4</label><caption>
<title>Performances comparison between 0-order TFFMs, other TFFMs, and weight matrices.</title>
<p>For the 96 ChIP-seq data sets used in <xref ref-type="fig" rid="pcbi-1003214-g003">Figure 3</xref> (using genomic background), the ratio between the AUC value using a specific model and the best AUC obtained is plotted. (A) The three types of TFFMs were used (1st-order, detailed, and 0-order TFFMs). AUC ratios are ranked from the least to the most favourable to the 1st-order and detailed TFFMs. We observe that the 1st-order and detailed TFFMs outperform the 0-order TFFMs when discriminating ChIP-seq sequences from genomic background sequences. (B) 0-order TFFMs and WMs were used. AUC ratios are ranked from the least to the most favourable to the 0-order TFFM. We observe that the WMs outperform the 0-order TFFMs when discriminating ChIP-seq sequences from genomic background sequences.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003214.g004" position="float" xlink:type="simple"/></fig>
<p>This analysis shows that the TFFMs perform better than PWMs and DWMs more often, with a statistically significant difference, and lead us to hypothesize that the TFFMs are, overall, better at capturing TFBS features found in the experimental data. To further evaluate this property, we analyzed how TFFM scoring correlates with the biological signal found in ChIP-seq data.</p>
</sec><sec id="s2d">
<title>Correlation between prediction scores and ChIP-seq peak scores</title>
<p>An attractive feature of PWMs is that they can produce scores that are correlated with the energetic binding affinity between a protein and a DNA sequence <xref ref-type="bibr" rid="pcbi.1003214-Benos1">[48]</xref>–<xref ref-type="bibr" rid="pcbi.1003214-Benos3">[50]</xref>. We sought to confirm this property using ChIP-seq data and estimate whether the TFFMs similarly exhibit this capacity. From ChIP-seq experiments, we will assume that the maximum number of reads mapping a peak is representative of the DNA-binding affinity of the corresponding TF to the corresponding DNA sequence (while recognizing the limitations of this assumption). We assess whether the different tested scoring models correlate with the peak signal (corresponding to the level of enrichment for TF-binding within the region) when ranking the peaks with respect to their ChIP-seq signal values compared to ranking with respect to the scores of their best hit. For each data set used in the previous AUC analysis (note that the 600 best peaks are not considered in the 10-fold cross-validation), we extracted the predicted scores associated with each ChIP-seq peak on the foreground testing sets for each of the four predictive methods. ENCODE ChIP-seq data also contain a ChIP-seq signal value associated with each one of the peaks. A potential relationship between prediction scores and peak signal values has been evaluated by separating the ChIP-seq peaks into twenty 5-percentile groups using ChIP-seq peak signal values. Spearman's rank correlation coefficients <xref ref-type="bibr" rid="pcbi.1003214-Spearman1">[51]</xref> were computed using the percentiles as the x-axis and the median of prediction scores as the y-axis. The density distribution of Spearman's rank correlation coefficients for each predictive method is given in <xref ref-type="fig" rid="pcbi-1003214-g005">Figure 5A</xref>. The correlation between the prediction scores (for all of the four methods) and the signal value of the corresponding ChIP-seq peaks is mainly located around 1 (with WMs giving slightly better results, see <xref ref-type="fig" rid="pcbi-1003214-g005">Figure 5A</xref>), corresponding to a correlation between the scoring of the methods and ChIP-seq peak signal values. Spearman's rank correlation coefficients indicate that the higher the ChIP-seq peak score, the higher the score we expect to get from the different predictive methods, which is in agreement with the models reflecting the energetic binding affinity between a protein and a DNA sequence. We used 5-percentile groups of sequences (using ChIP-seq peak signal values) to compute Spearman's rank correlation coefficients. The Spearman's rank correlation coefficients computed using all the ChIP-seq peak signal values would result in low correlation values due to the variation of the values from the average trend. Hence, using percentiles gives the general trend that shows the average behaviour of the correlation. We can see from <xref ref-type="fig" rid="pcbi-1003214-g005">Figure 5A</xref> that the trends show a positive correlation. The statistical significance of the trends is assessed by computing the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e029" xlink:type="simple"/></inline-formula>-values of getting a regression line (corresponding to the general trend of correlation) for the observed slope. <xref ref-type="supplementary-material" rid="pcbi.1003214.s005">Figure S5</xref> plots the distribution of the computed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e030" xlink:type="simple"/></inline-formula>-values. We observe that the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e031" xlink:type="simple"/></inline-formula>-values are, overall, close to 0 and indicate that the average behaviour of the correlation given by a linear regression is far from a horizontal line. These results show that all of the predictive methods have the tendency to correlate with ChIP-seq peak signal values. To further analyze the property of correlation between TFFM scores and binding affinities, we considered experimentally measured binding affinities between a TF and DNA sequences and compared these values to the predictive scores obtained from the different models.</p>
<fig id="pcbi-1003214-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003214.g005</object-id><label>Figure 5</label><caption>
<title>Correlations between prediction scores and ChIP-seq peak scores or binding affinities.</title>
<p>(A) ChIP-seq signal values obtained from ENCODE data sets were compared to prediction values obtained with the four different predictive methods. The distribution of Spearman's correlation values from all data sets are given for 1st-order TFFMs, detailed TFFMs, PWMs, and DWMs. An over-representation of Spearman's correlations around 1 (perfect correlation) is found for the four methods. (B) Pearson correlation between scores obtained using the different predictive methods and DNA-binding affinities from <xref ref-type="bibr" rid="pcbi.1003214-Maerkl1">[52]</xref>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003214.g005" position="float" xlink:type="simple"/></fig></sec><sec id="s2e">
<title>Correlation between prediction scores and experimental DNA-binding affinities</title>
<p>In the previous section, we hypothesized that the signal values from ENCODE ChIP-seq peaks reflected the affinity of the TF protein to bind to DNA sequences. In <xref ref-type="bibr" rid="pcbi.1003214-Maerkl1">[52]</xref>, Maerkl and Quake measured experimentally the binding affinities of two isoforms of the human Max TF to DNA sequences by testing sequence permutations. The Max TF binds to a core consensus motif of the form CACGTG. As the motif is palindromic, they measured the binding affinities of the Max proteins for all the possible mutated sequences of the first half of the core motif (namely nucleotides <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e032" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e033" xlink:type="simple"/></inline-formula> from the consensus sequence, see <xref ref-type="supplementary-material" rid="pcbi.1003214.s006">Figure S6</xref>) and conserving the second half of the consensus core binding sites (GTG). We compared these experimental measures to the predictive scores obtained on the Max K562 ChIP-seq data, selected from the available Max ChIP-seq data as it exhibits the highest AUCs in the 10-fold cross-validation experiments for all tested methods. Five different models (0-order TFFM, 1st-order TFFM, detailed TFFM, PWM, and DWM) were constructed from the top 600 peaks for the initialization step and all ChIP-seq sequences were used to train the models. The sequence logo obtained using MEME on the top 600 peaks is given in <xref ref-type="supplementary-material" rid="pcbi.1003214.s006">Figure S6</xref> for reference. We can see that the CACGTG palindromic motif is captured by MEME using the ENCODE ChIP-seq data set. The trained models were then applied to the mutated sequences to get their corresponding predicted scores. Note that the models are trained here on a data set that is independent of the testing data set used in <xref ref-type="bibr" rid="pcbi.1003214-Maerkl1">[52]</xref>.</p>
<p>For each predictive model, we computed the correlation between the predicted scores and the DNA-binding affinity values measured experimentally. Since some mutated sequences can no longer be bound by the Max TF (or with very weak affinity), it is interesting to focus on the sequences to which the TF can actually bind. Hence, we analyzed the correlation between predicted and experimentally measured DNA-binding affinity values by first focusing on the sequences lying in the top 10-percentile affinity values, then the top 20-percentile, and up to including all the sequences using 10-percentile steps. The results of higher interest, corresponding to stronger DNA-binding affinity values, are the top percentiles but all percentiles were computed for completeness. Using such a methodology, we expect the predicted scores obtained from the models to better correlate with high DNA-binding affinity values than with low values. <xref ref-type="fig" rid="pcbi-1003214-g005">Figure 5B</xref> gives the Pearson correlation coefficients with respect to the top percentiles of DNA-binding affinity values for both isoforms of the Max TF. We observe that all the TFFMs (whatever the order) correlate well with the experimental data with a Pearson correlation coefficient over 0.6 up to the top 80-percentiles. Coefficients obtained when considering the top 10- and 20-percentiles (when TF-DNA interaction is the strongest) are around 0.7, showing the high correlation between TFFM scoring and experimental values. In contrast, scores obtained from PWMs and DWMs give Pearson correlation coefficients in the range of 0.45–0.55. Analysis of the Max data indicates that the TFFMs reflect the DNA-binding affinities measured experimentally for the Max TF.</p>
<p>To understand what characteristic(s) the TFFMs are capturing that is not represented by either the PWMs or the DWMs, we examined the DNA sequences obtaining the highest DNA-binding affinity values. We looked at the motifs for which the DNA-binding affinities are the highest by considering the top-scored 25, 50, 75, and 100 sequences (see <xref ref-type="supplementary-material" rid="pcbi.1003214.s007">Figure S7</xref>). <xref ref-type="supplementary-material" rid="pcbi.1003214.s008">Figure S8</xref> contains the sequence logos corresponding to the TFFMs and the PWM (no such representation has been made available for the DWM in <xref ref-type="bibr" rid="pcbi.1003214-Siddharthan1">[19]</xref>). One can observe that the TFFMs better capture the C/T pattern at position 7 that is found strongly at position 4 of the top DNA-binding affinity sequences (<xref ref-type="supplementary-material" rid="pcbi.1003214.s007">Figure S7</xref>). To a lesser extent, the same can be observed at position 6 with the A/G captured by the TFFMs. These patterns are not captured by the PWM since the CAC is strictly expected at positions 5–7, this coming from the construction and training of the PWMs made from the over-represented motif with a strict CAC. Hence, the PWM does not reflect the needed flexibility captured by the TFFMs through the training step, which is captured by the 0-order TFFM (conceptually the same as a PWM but with a different method of training).</p>
<p>In <xref ref-type="bibr" rid="pcbi.1003214-Maerkl1">[52]</xref>, binding affinity differences between the optimal sequence (with a core CACGTG motif) and the mutated sequences were computed. We performed the same analysis using the predictive scores for the different models in order to compare the results. <xref ref-type="table" rid="pcbi-1003214-t002">Table 2</xref> summarizes the comparison in which we observe that the TFFMs perform better than both the PWM and the DWM. Pearson correlation coefficients for TFFMs are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e034" xlink:type="simple"/></inline-formula> whereas the PWM and the DWM obtain at most a coefficient of 0.66. As a conclusion, these results emphasize the capacity of the TFFM scores to correlate with DNA-binding affinity.</p>
<table-wrap id="pcbi-1003214-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003214.t002</object-id><label>Table 2</label><caption>
<title>Pearson correlation coefficients between experimentally measured and predicted changes in affinity correlations.</title>
</caption><alternatives><graphic id="pcbi-1003214-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003214.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Isoform</td>
<td align="left" rowspan="1" colspan="1">Method</td>
<td align="left" rowspan="1" colspan="1">Pearson correlation coefficient</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>isoA</bold></td>
<td align="left" rowspan="1" colspan="1"><bold>PWM</bold></td>
<td align="left" rowspan="1" colspan="1">0.65</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><bold>DWM</bold></td>
<td align="left" rowspan="1" colspan="1">0.66</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><bold>0-order TFFM</bold></td>
<td align="left" rowspan="1" colspan="1"><bold>0.76</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><bold>1st-order TFFM</bold></td>
<td align="left" rowspan="1" colspan="1"><bold>0.74</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><bold>detailed TFFM</bold></td>
<td align="left" rowspan="1" colspan="1"><bold>0.75</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>isoB</bold></td>
<td align="left" rowspan="1" colspan="1"><bold>PWM</bold></td>
<td align="left" rowspan="1" colspan="1">0.60</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><bold>DWM</bold></td>
<td align="left" rowspan="1" colspan="1">0.61</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><bold>0-order TFFM</bold></td>
<td align="left" rowspan="1" colspan="1"><bold>0.77</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><bold>1st-order TFFM</bold></td>
<td align="left" rowspan="1" colspan="1"><bold>0.75</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><bold>detailed TFFM</bold></td>
<td align="left" rowspan="1" colspan="1"><bold>0.75</bold></td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt102"><p>The table contains the Pearson correlation coefficients computed between the experimentally measured and predicted changes in DNA-binding affinity between the optimal sequence and mutated ones. Correlations have been computed for both Max TF isoforms and all the predictive methods. Associated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e035" xlink:type="simple"/></inline-formula>-value have been computed for each Pearson correlation coefficient value and are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e036" xlink:type="simple"/></inline-formula>.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s2f">
<title>Allowing for flexible length motifs using TFFMs</title>
<p>In the previous sections, the TFFMs were used to model TFBSs with fixed length by taking into consideration the dinucleotide composition of the sequences. Another feature of the TFBSs that can be accommodated by TFFMs is flexible length.</p>
<p>A subset of TFs bind to the DNA with different structural conformations, leading to TFBSs of different lengths <xref ref-type="bibr" rid="pcbi.1003214-Ehret1">[25]</xref>–<xref ref-type="bibr" rid="pcbi.1003214-Reid1">[27]</xref>. In order to model a binding site with a flexible length, we can use the transition probabilities of the underlying HMMs of the TFFMs. For instance, a 1st-order HMM state corresponding to position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e037" xlink:type="simple"/></inline-formula> of a TFBS can transition to state at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e038" xlink:type="simple"/></inline-formula> and to state at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e039" xlink:type="simple"/></inline-formula> to allow <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e040" xlink:type="simple"/></inline-formula> to be omitted for some TFBSs of smaller length. The same applies to HMMs of detailed TFFMs where the probabilities are decomposed for each nucleotide in positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e041" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e042" xlink:type="simple"/></inline-formula>. To assess the capacity of the TFFMs to model flexible length TFBSs, we applied the 1st-order and detailed TFFMs to ChIP-seq data corresponding to three TFs with potentially flexible DNA-binding motifs (JunD, STAT4, and STAT6) and compared their discriminative power with fixed length TFFMs, PWMs and DWMs following the cross-validation methodology used previously. We compared the methods to GLAM2 which was first developed to find motifs in proteins with arbitrary insertions and deletions but which can also be applied to DNA sequences <xref ref-type="bibr" rid="pcbi.1003214-Frith1">[53]</xref>.</p>
<sec id="s2f1">
<title>The example of the JunD TF</title>
<p>The first TF analyzed is JunD which has been previously shown to bind to motifs of flexible length using protein binding microarrays in mouse <xref ref-type="bibr" rid="pcbi.1003214-Badis1">[1]</xref>. Badis <italic>et al.</italic> showed that JunD can bind to a core motif composed of either TGACGTCA or TGAC/GTCA where C/G stands for C or G. When applying MEME to the whole JunD K562 ENCODE ChIP-seq data set, we observed the enrichment of the two patterns. We used the data set exhibiting the greatest enrichment of the patterns to train and test the different models. We can see from the ROC curves in <xref ref-type="fig" rid="pcbi-1003214-g006">Figure 6</xref> that introducing a spacer into TFFM for the JunD motif improves the discriminative power of the TFFMs. GLAM2 also performs better than the fixed-length TFFMs, but not as well as the flexible-length TFFMs. The TFFMs using a flexible length outperform the fixed TFFMs, PWMs, DWMs, and GLAM2. Hence, the flexible length TFFMs are able to capture the flexible length motif thanks to the adapted transition probabilities.</p>
<fig id="pcbi-1003214-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003214.g006</object-id><label>Figure 6</label><caption>
<title>ROC curve analysis of JunD ChIP-seq data.</title>
<p>TFFMs allowing a flexible length motif have been compared to PWMs, DWMs, GLAM2, and fixed-length TFFMs. Flexible TFFMs outperform the other models since the corresponding ROC curves are above ROC curves corresponding to other models.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003214.g006" position="float" xlink:type="simple"/></fig></sec><sec id="s2f2">
<title>The examples of STAT4 and STAT6 TFs</title>
<p>STAT TFs bind with a flexible length motif <xref ref-type="bibr" rid="pcbi.1003214-Ehret1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1003214-Soldaini1">[26]</xref>, <xref ref-type="bibr" rid="pcbi.1003214-Wei1">[54]</xref>. STAT4 and STAT6 TFs have been specifically analyzed <xref ref-type="bibr" rid="pcbi.1003214-Wei1">[54]</xref> using ChIP-seq. Even though they were shown to bind to two motifs of different length (STAT4 preferentially binding to a TTCCNGGAA core motif and STAT6 to a TTCCNNGGAA core motif), genes bound by both STAT4 and STAT6 were extracted in different conditions. From such an overlap, one can hypothesize that the TFs can bind to the same motifs when allowing for a flexible spacing between the two halves TTCC and GGAA. To assess this assumption, we constructed 1st-order and detailed TFFMs by allowing for a flexible length in the motif between the two halves. We observe in <xref ref-type="fig" rid="pcbi-1003214-g007">Figure 7</xref> that introducing a spacer does not improve significantly the AUC of the ROC curves (we observe a small decrease for STAT4 and small increase for STAT6) when compared to the fixed-length TFFMs. All TFFMs perform better than PWMs, DWMs, and GLAM2. Allowing for different spacing within STAT binding motifs and assessing their predictive power has been tested in a previous study without success <xref ref-type="bibr" rid="pcbi.1003214-Reid1">[27]</xref>. This might be due to co-occurrences of binding sites with both 1 nt and 2 nt spacers in a subset of the ChIP-seq data as hypothesized in <xref ref-type="bibr" rid="pcbi.1003214-Reid1">[27]</xref> when looking at STAT5a and STAT5b. This is also supported by <xref ref-type="bibr" rid="pcbi.1003214-Wei1">[54]</xref> (where the ChIP-seq data used are originated) showing that 37% of the genes bound by both STAT4 and STAT6 contain the two types of motifs. The use of TFFMs simplifies the analysis, allowing for a single unified model to capture both motif lengths at no cost for the underlying predictive power.</p>
<fig id="pcbi-1003214-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003214.g007</object-id><label>Figure 7</label><caption>
<title>ROC curve analysis of STAT4 and STAT6 ChIP-seq data.</title>
<p>TFFMs allowing a flexible length motif have been compared to PWMs, DWMs, GLAM2, and fixed-length TFFMs on STAT4 (A) and STAT6 (B) ChIP-seq data. Flexible TFFMs do not significantly perform better than fixed-length TFFMs. DWMs, PWMs, and GLAM2 produce a lower discriminative power than the TFFMs.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003214.g007" position="float" xlink:type="simple"/></fig></sec><sec id="s2f3">
<title>Flexible spacing in the flanking regions of a motif</title>
<p>In the previous examples of flexible length binding motifs, we focused on motifs where a spacer was found between the two halves of a core motif. One can also consider motifs containing a flexible edge at the outer edges of a core motif. When analyzing MEME output for ENCODE ChIP-seq data, we observed that a MafK data set showed a weak motif on its edge separated by a 1 nt spacer from the core motif (see <xref ref-type="supplementary-material" rid="pcbi.1003214.s009">Figure S9</xref>). We hypothesized a potential flexible edge in the binding motif that could be explained by different biological phenomena as a binding event with or without a co-factor. We assessed this hypothesis by allowing this edge to be present or not when predicting a binding site in the 1st-order and detailed TFFMs. Following the cross-validation methodology used before, we constructed the corresponding ROC curves and compared the results with the previous models. TFFMs outperformed PWMs and DWMs (see <xref ref-type="fig" rid="pcbi-1003214-g008">Figure 8</xref>). We can see from the ROC curves in <xref ref-type="fig" rid="pcbi-1003214-g008">Figure 8</xref> that introducing a flexible edge gives an improvement to the AUC when compared to the full-length TFFMs. Even though the improvement is not strong, allowing the capture of different types of binding events through a flexible edge gives insight into the binding of MafK. For instance, the flanking portion of motifs might be explained by different conformations of the protein or a potential partnership with a co-factor when binding to the DNA.</p>
<fig id="pcbi-1003214-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003214.g008</object-id><label>Figure 8</label><caption>
<title>ROC curve analysis of MafK ChIP-seq data.</title>
<p>TFFMs allowing a motif with a flexible edge have been compared to PWMs, DWMs, GLAM2, and fixed-length TFFMs. Flexible TFFMs perform slightly better than fixed-length TFFMs and both outperform the other models.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003214.g008" position="float" xlink:type="simple"/></fig></sec></sec><sec id="s2g">
<title>Using TFFMs to compute probabilities of occupancy of a TF</title>
<p>In the previous sections, TFFMs have been used to predict specific TFBS positions. We extended the TFFM-framework to compute an integrated TF occupancy score across a DNA sequence using the TFFM scores. Using the TFFMs, the probability of occupancy (Pocc) of a TF within a defined DNA sequence is obtained by multiplying the TFBS probabilities at each position (see Material and Methods section for details). This is a simpler approach than the physico-chemical models used in tools like GOMER <xref ref-type="bibr" rid="pcbi.1003214-Granek1">[55]</xref> and TRAP <xref ref-type="bibr" rid="pcbi.1003214-Roider1">[56]</xref>, and somewhat similar in concept to the approach of OHMM <xref ref-type="bibr" rid="pcbi.1003214-Drawid1">[57]</xref> which uses HMMs to predict occupancy of TFs with self-overlapping binding motifs. To observe whether Pocc can improve the discriminative power of the TFFMs, Pocc have been computed from TFFMs and assessed for their capacity to discriminate between ChIP-seq data and background sequences and compared to original TFFMs using the best site per ChIP-seq peak to discriminate between ChIP-seq data and background sequences. When analyzing data sets for which at least one method obtains an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e043" xlink:type="simple"/></inline-formula> (97 with a genomic background and 100 with an HMM-generated background), we found that using Pocc values improves discrimination as measured by AUC for 62 out of 97 (i.e. 64%) data sets when considering genomic background and 63 out of 100 (i.e. 63%) when considering HMM-generated background (see <xref ref-type="supplementary-material" rid="pcbi.1003214.s014">Figure S14</xref>).</p>
</sec></sec><sec id="s3">
<title>Discussion</title>
<p>In this report, we have introduced a flexible HMM-based framework for TFBS prediction. The new models are demonstrated to perform as well as classic methods for most data, while exhibiting improved performance for a subset of TFs. The new approach retains the desirable attribute of producing scores correlated with the binding energy of TF-DNA interactions. A new graphical representation is introduced to illustrate the properties of the models, complementing the classic and widely used sequence logos. In applications, the TFFM models have been shown to handle variable spacing between half sites, and to allow for the incorporation of flanking sequence properties into TFBS analysis. With a convenient software package and a breadth of opportunities for improvement, TFFMs are a suitable foundation for the next generation of TFBS prediction.</p>
<p>The new TFFM-framework provides an opportunity for researchers to analyze more deeply the features of TF-DNA binding interaction by looking at local dinucleotide dependencies captured by the TFFMs and represented by the new logos. One can see the TFFMs as the probabilistic analog of the energetic BEEML models developed in <xref ref-type="bibr" rid="pcbi.1003214-Zhao1">[18]</xref>. Unfortunately, the two modeling approaches cannot be directly compared since they are elaborated from two different types of data sets (PBM data for the BEEML tool <xref ref-type="bibr" rid="pcbi.1003214-Zhao1">[18]</xref> and ChIP-seq data for the TFFMs). BEEML software cannot use ChIP-seq data (personal communication with the authors) and the TFFMs have not been developed to consider PBM data information in their current form but both models are able to capture TFBS features with good specificity.</p>
<p>For TFFMs, the greatest utility is in handling the growing subset of TFs with complex binding properties. Such complex binding characteristics of TFs may be decomposed into four categories <xref ref-type="bibr" rid="pcbi.1003214-Badis1">[1]</xref> based on the structure of their corresponding motifs: position interdependence (i.e. the probability of observing a nucleotide at one position is informed by the nucleotide observed at another position), variable width, multiple effects where we can observe a combination of position interdependence and variable length, and alternate recognition interface where bound DNA segments cannot be accounted for using models of either variable length or position interdependence. The models we used in these analyzes aim at addressing the three first categories of TFBS characteristics using only one framework, while the framework provides sufficient flexibility to incorporate the fourth, such as subtle flanking sequence properties.</p>
<p>The TFFM-framework creates new opportunities for innovation in TFBS bioinformatics analysis. Drawing from the initial studies here, it is apparent that refined approaches can be pursued for the identification of TFs capable of binding to motifs of variable width and the analysis of the role of TFBS flanking sequence on TF binding. While the number of cases of TFs tolerant of variable width binding sites has grown with access to high-throughput TFBS data, the TFFM-framework could be extended to enable a comprehensive survey of ChIP-seq data collections to identify additional cases. As observed in the analysis of MafK TFBS flanking sequences, TFFMs are sufficiently flexible to incorporate additional information represented in TFBS proximal sequences. There have been some indications that such sequences may specify interactions with co-factors <xref ref-type="bibr" rid="pcbi.1003214-Siggers1">[58]</xref>. TFFMs offer advantages over past methods for the detection of such weak signals with variable positions. It is our plan to expand the TFFM-framework to automatically look for variable-length motifs.</p>
<p>Beyond the analysis of non-canonical TF binding motifs, there is a significant scientific opportunity to develop a new computational approach for the prediction of functionally significant DNA variations within <italic>cis</italic>-regulatory sequences. The global relationship of TFBSs and nucleotide variations is largely unknown <xref ref-type="bibr" rid="pcbi.1003214-Borneman1">[59]</xref>. Recent studies have shown extensive genetic variations on human TFBSs often correlated with differences in gene expression <xref ref-type="bibr" rid="pcbi.1003214-Kasowski1">[60]</xref> and identified TFBSs as genetic determinants of retroviral integration in the human genome <xref ref-type="bibr" rid="pcbi.1003214-Felice1">[61]</xref>. TFFMs have the capacity of modeling the impact of mutations on the TF-DNA binding affinity, as demonstrated for the Max TF. These early results show the promise for using TFFMs to score the impact of nucleotide variations on TF-DNA interactions.</p>
<p>A key to the long-term development and adoption of TFFMs is the access of researchers to both the binding models and the software for their generation. It is our plan to generate a collection of TFFMs trained on ChIP-seq data sets from ENCODE, as well as other sources compiled into the PAZAR repository <xref ref-type="bibr" rid="pcbi.1003214-PortalesCasamar1">[62]</xref>, <xref ref-type="bibr" rid="pcbi.1003214-PortalesCasamar2">[63]</xref>. Models shall also be incorporated in the next release of the JASPAR collection <xref ref-type="bibr" rid="pcbi.1003214-PortalesCasamar3">[64]</xref>, with a parallel release of PWMs constructed from the same data. Analysis of DNA sequences will be supported through both a web application and a standalone version using already trained TFFMs directly downloadable from JASPAR. For bioinformatics research, we have provided the code of the TFFM package and its documentation (accessible at <ext-link ext-link-type="uri" xlink:href="http://cisreg.cmmt.ubc.ca/TFFM/doc/" xlink:type="simple">http://cisreg.cmmt.ubc.ca/TFFM/doc/</ext-link>) to allow others to refine the approaches and make further innovations to broaden the use of TFFMs.</p>
<p>The new TFFMs described in this report are designed to address the confounding properties of position inter-dependencies in site composition and variable lengths observed in experimental data. These two challenges have emerged as an increasing issue with the availability of large-scale ChIP-seq data, which reveals greater complexity of TFBSs than could be observed in the past. The TFFM graphical motif representation conveys properties of position inter-dependence, allowing researchers to visually analyze the features captured by the model. TFFMs have been assessed on human and mouse ChIP-seq data sets coming from ENCODE, revealing a higher discriminative power than established methods. TFFMs produce scores consistent with observed protein-DNA affinities measured experimentally and have the capacity to predict the impact of TF binding site mutations on TF-DNA binding affinities.</p>
<p>The analysis of TFBS is a central challenge in bioinformatics. TFFMs provide a powerful and flexible framework within which a broad range of problems can be addressed. While many motif discrimination methods are available, it is our perception that TFFMs will emerge as a preferred approach for TFBS analysis.</p>
</sec><sec id="s4" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="s4a">
<title>ChIP-seq data sets</title>
<p>Comparisons between the different predictive methods were done using ChIP-seq data sets from the ENCODE project <xref ref-type="bibr" rid="pcbi.1003214-ENCODE1">[39]</xref>. We used ChIP-seq data sets from human (hg19 assembly) and mouse (mm9 assembly) containing at least 1800 peaks for which the peak max position is known (i.e. narrowPeak-formatted data), representing 206 ChIP-seq experiments. In limiting to sets with at least 1800 peaks, we ensure that at least two times the number of peaks used to search for an over-represented motif by MEME (top 600 peaks used, see below) will be used during the 10-fold cross-validation procedure as explained below. As DNA-binding events should be located around the peak max area (corresponding to the highest coverage of ChIP-seq reads) of the ChIP-seq peaks <xref ref-type="bibr" rid="pcbi.1003214-Wilbanks1">[45]</xref>, we extracted 50 nt on each side of the peak max position. Hence, each peak is composed by 101 nt centered at the peak max position and is associated to a signal value corresponding to the enrichment for TF binding in the region of the peak.</p>
<p>For assessing the performance of TFFMs allowing for flexible length motifs, we used the following ChIP-seq data sets: human ENCODE JunD TF from K562 cells by the University of Chicago, mouse ENCODE MafK TF from Ch12 cells by Stanford University, and STAT4 and STAT6 TFs from <xref ref-type="bibr" rid="pcbi.1003214-Wei1">[54]</xref>.</p>
</sec><sec id="s4b">
<title>HMMs</title>
<p>1st-order HMMs used in 1st-order TFFMs are composed of a state modeling the background sequences surrounding TFBSs and one state per position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e044" xlink:type="simple"/></inline-formula> within the TFBSs. The use of a 1st-order HMM allows the model to capture the dinucleotide dependencies through emission probabilities at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e045" xlink:type="simple"/></inline-formula> dependent on the nucleotide found at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e046" xlink:type="simple"/></inline-formula> (see <xref ref-type="fig" rid="pcbi-1003214-g001">Figure 1A</xref>). One can move from the background state to the first “matching state” (i.e. the first position within a TFBS) with a defined probability, whatever the nucleotide generated by the background state. <xref ref-type="fig" rid="pcbi-1003214-g001">Figure 1A</xref> gives a representation of the 1st-order HMM template where the first state corresponds to the background state representing the nucleotides surrounding TFBSs. Following states correspond to the matching states where each one corresponds to a position within a TFBS. Each state emits a nucleotide with probabilities dependent on the nucleotide emitted by the previous state. Within matching states, moving from one TFBS position to the next is given by transition probabilities equal to 1. Probabilities are learned using the Baum-Welch algorithm on ChIP-seq sequences, starting from initialized values.</p>
<p>HMMs used in detailed TFFMs decompose each state of the 1st-order HMM with four corresponding states in the detailed HMM, each one emitting a nucleotide (A, C, G, or T) with a probability equal to 1 (see <xref ref-type="fig" rid="pcbi-1003214-g001">Figure 1B</xref>). Dinucleotide dependencies are modeled by four transition probabilities getting out of each state at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e047" xlink:type="simple"/></inline-formula> and directing to each state at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e048" xlink:type="simple"/></inline-formula> (see <xref ref-type="fig" rid="pcbi-1003214-g001">Figure 1B</xref>).</p>
<p>HMMs used in 0-order TFFMs are constructed with the same set of states as the ones used for the HMMs of the 1st-order TFFMs. The emission probabilities are different since no dependency between positions is captured. Hence, each state is associated to only four emission probabilities for the four nucleotides (see <xref ref-type="supplementary-material" rid="pcbi.1003214.s014">Figure S14</xref>).</p>
</sec><sec id="s4c">
<title>Probability of occupancy scores computation</title>
<p>The TFFMs provide, at each position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e049" xlink:type="simple"/></inline-formula> within a DNA sequence, the probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e050" xlink:type="simple"/></inline-formula> of being in a final matching state (corresponding to the last position of a TFBS). Directly following the spirit of <xref ref-type="bibr" rid="pcbi.1003214-Granek1">[55]</xref>, the probability of occupancy (Pocc) of a TF, which TFBSs are modeled by a TFFM, on a DNA sequence of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e051" xlink:type="simple"/></inline-formula> can be computed as:<disp-formula id="pcbi.1003214.e052"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003214.e052" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e053" xlink:type="simple"/></inline-formula> represents the probability of a TF not occupying the DNA sequence at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e054" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s4d">
<title>Model comparisons</title>
<p>The different model predictive powers were compared using a 10-fold cross-validation methodology on human and mouse ChIP-seq ENCODE data sets.</p>
<sec id="s4d1">
<title>Data sets construction for cross-validation</title>
<p>Given a ChIP-seq data set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e055" xlink:type="simple"/></inline-formula>, we constructed different sets of sequences that are used to train and test the predictive models. The set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e056" xlink:type="simple"/></inline-formula> is defined by the top (highest signal-values) 600 ChIP-seq peaks. The remaining sequences (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e057" xlink:type="simple"/></inline-formula>) are used to construct the 10 training (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e058" xlink:type="simple"/></inline-formula>) and 10 testing data sets (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e059" xlink:type="simple"/></inline-formula>) that are used for the 10-fold cross-validation, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e060" xlink:type="simple"/></inline-formula> is 9 times larger than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e061" xlink:type="simple"/></inline-formula>.</p>
<p>Ten background data sets (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e062" xlink:type="simple"/></inline-formula>) are generated by selecting randomly the same number of sequences from mappable sequences. Mappable regions of the human and mouse genomes have been derived from the ENCODE CrgMappability 36mer track (<ext-link ext-link-type="uri" xlink:href="ftp://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeMapability/wgEncodeCrgMapabilityAlign36mer.bigWig" xlink:type="simple">ftp://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeMapability/wgEncodeCrgMapabilityAlign36mer.bigWig</ext-link>). They were generated from contiguous 36mers, and keeping regions greater than 200 bp. These regions were split into 100 bp pieces. The background for each dataset was then drawn randomly by matching %GC composition of the foreground sequences.</p>
<p>Finally, we generate 10 additional background data sets (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e063" xlink:type="simple"/></inline-formula>) by using a one-state 1st-order HMM constructed from the matching sequences from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e064" xlink:type="simple"/></inline-formula>.</p>
<p>When predicting TFBSs using a TFFM, input sequences are scored at every positions for both strands. Corresponding scores are the posterior probabilities of being at the final state of the underlying HMM computed by the forward and backward algorithms <xref ref-type="bibr" rid="pcbi.1003214-Durbin1">[36]</xref>.</p>
</sec><sec id="s4d2">
<title>Model construction for cross-validation</title>
<p>Data sets described in the previous section were used to initialize, train, and test the predictive methods through a cross-validation methodology. The procedure was as follows:</p>
<list list-type="order"><list-item>
<p>Apply MEME <xref ref-type="bibr" rid="pcbi.1003214-Bailey1">[43]</xref>, <xref ref-type="bibr" rid="pcbi.1003214-Bailey3">[65]</xref> on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e065" xlink:type="simple"/></inline-formula> and extract the top over-represented motif (default parameters).</p>
</list-item><list-item>
<p>Use the motif to initialize the 0-order, 1st-order, and detailed TFFMs (emission probabilities, for the 0-order and 1st-order TFFMs, and transition probabilities, for the detailed TFFM, are derived from nucleotide frequencies at each position of the motif).</p>
</list-item><list-item>
<p>Train TFFMs on the 10 training sets from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e066" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Apply the TFFMs on matching <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e067" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e068" xlink:type="simple"/></inline-formula> and extract the highest scored hit per sequence.</p>
</list-item><list-item>
<p>Compute the corresponding ROC curve.</p>
</list-item><list-item>
<p>Apply MAST <xref ref-type="bibr" rid="pcbi.1003214-Bailey2">[44]</xref>,<xref ref-type="bibr" rid="pcbi.1003214-Bailey3">[65]</xref> on the 10 training sets from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e069" xlink:type="simple"/></inline-formula> using the motif from MEME (default parameters).</p>
</list-item><list-item>
<p>Construct corresponding PWMs (i.e. log-odds weight matrices derived from the PFMs <xref ref-type="bibr" rid="pcbi.1003214-Stormo1">[8]</xref>) and DWMs using the results from MAST by aligning matched sequences.</p>
</list-item><list-item>
<p>Apply the PWMs and the DWMs on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e070" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e071" xlink:type="simple"/></inline-formula> and extract the best hit per sequence.</p>
</list-item><list-item>
<p>Compute the corresponding ROC curves for each method.</p>
</list-item></list>
</sec></sec><sec id="s4e">
<title>ROC curves</title>
<sec id="s4e1">
<title>Construction of the ROC curves and AUC computation</title>
<p>For each ChIP-seq data set and predictive model, the best hits from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e072" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e073" xlink:type="simple"/></inline-formula> were merged and ranked by their scores (the highest to the lowest). By varying a threshold on the score, we iteratively constructed sets of predicted sequences as TFBSs (i.e. with a score above the threshold). Sequences predicted as TFBSs coming from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e074" xlink:type="simple"/></inline-formula> (resp. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e075" xlink:type="simple"/></inline-formula>) are considered as true (resp. false) positive. On the contrary, true negatives (resp. positive) are sequences coming from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e076" xlink:type="simple"/></inline-formula> (resp. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e077" xlink:type="simple"/></inline-formula>) and not predicted as TFBSs (i.e. with a score below the threshold). Each threshold value gives a pair of specificity-sensitivity values used to construct the ROC curve. The area under the ROC curve (AUC) can be computed using the sensitivity as the y-axis and 1 minus the specificity as the x-axis.</p>
</sec><sec id="s4e2">
<title>Computation of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e078" xlink:type="simple"/></inline-formula>-values</title>
<p>The statistical significance of a difference between two predictive methods has been assessed through a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e079" xlink:type="simple"/></inline-formula>-value computation using the two-paired-samples Wilcoxon signed rank test <xref ref-type="bibr" rid="pcbi.1003214-Wilcoxon1">[46]</xref> assuming a null hypothesis of symmetric distribution of AUC differences around 0 (function <italic>wilcox.test</italic> of the <italic>stats R</italic> package <xref ref-type="bibr" rid="pcbi.1003214-R1">[66]</xref>). <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e080" xlink:type="simple"/></inline-formula>-values were corrected using a Benjamini-Hochberg correction for multiple testing <xref ref-type="bibr" rid="pcbi.1003214-Benjamini1">[47]</xref>.</p>
<p>To assess the statistical significance of the trend of correlation between model scores and ChIP-seq signal values, we computed the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e081" xlink:type="simple"/></inline-formula>-values of getting a regression line (corresponding to the general trend of correlation) with the corresponding slope. The regression lines and the corresponding <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e082" xlink:type="simple"/></inline-formula>-values are obtained through the <italic>lm</italic> function of the <italic>stats R</italic> package <xref ref-type="bibr" rid="pcbi.1003214-R1">[66]</xref>. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e083" xlink:type="simple"/></inline-formula>-value assesses the probability of getting a slope so far from 0 (horizontal line).</p>
</sec></sec><sec id="s4f">
<title>TFFM logos</title>
<p>The summarized features captured by the TFFMs are represented through a sequence logo similar to the ones used for basic PWMs. To construct the sequence logos, the probability of getting each one of the four nucleotides is computed at each position starting from an equiprobability of A, C, G, and T in the background. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e084" xlink:type="simple"/></inline-formula> be the probability of letter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e085" xlink:type="simple"/></inline-formula> at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e086" xlink:type="simple"/></inline-formula>. We compute <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e087" xlink:type="simple"/></inline-formula> as equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e088" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e089" xlink:type="simple"/></inline-formula> corresponds to the emission probability of the nucleotide <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e090" xlink:type="simple"/></inline-formula> at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e091" xlink:type="simple"/></inline-formula> when nucleotide <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e092" xlink:type="simple"/></inline-formula> was found at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e093" xlink:type="simple"/></inline-formula>. When considering the 1st-order TFFMs, we use the emission probability values whereas the transition probability values give the information for the detailed TFFMs.</p>
<p>The classic sequence logos do not give any information about the dinucleotide dependencies captured by the TFFMs. We introduce a new graphical representation of the TFBSs modelled by the TFFMs that is able to capture this feature (see <xref ref-type="fig" rid="pcbi-1003214-g002">Figure 2</xref>). As for a regular sequence logo, each column corresponds to a position within a TFBS. Each row captures the probabilities of each nucleotide knowing the nucleotide at the previous position (one row per nucleotide A, C, G, and T). It follows the same computation as explained above but considering a specific nucleotide found at the previous position. For instance, the probability of emitting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e094" xlink:type="simple"/></inline-formula> at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e095" xlink:type="simple"/></inline-formula> for row A (so A was found at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e096" xlink:type="simple"/></inline-formula>) is equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e097" xlink:type="simple"/></inline-formula>. As for the summary logo, the emission probabilities are used for the 1st-order TFFMs whereas the transition probabilities are used for the detailed TFFMs. The height of the letters reflect their probability (the greater the height, the higher the probability). In order to highlight the preferred rows, the opacity of a case (intersection of a row and a column) represents the probability of finding the nucleotide corresponding to this specific row at the previous position of the TFBS (the higher the opacity, the higher the probability).</p>
<p>Given the probabilities of finding each nucleotide at each TFBS position, we compute the information content (IC) of a TFFM by summing the IC of all the positions computed as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e098" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s4g">
<title>Max experimental DNA-binding affinities</title>
<p>DNA-binding affinities between human Max transcription factor (isoforms A and B) and DNA sequences have been obtained experimentally by using the MITOMI method and reported in <xref ref-type="bibr" rid="pcbi.1003214-Maerkl1">[52]</xref>. Absolute affinity measures were calculated by varying four nucleotides in the first half of the core binding-motif with the preferred GTG second half-site kept. The changes in the energy between the optimal sequence and mutated ones were also computed in <xref ref-type="bibr" rid="pcbi.1003214-Maerkl1">[52]</xref> by subtracting the energy associated with the mutated sequences to the energy of the optimal sequence. Both absolute affinity measures and changes in the binding energy were compared to predicted values obtained with the different models.</p>
</sec><sec id="s4h">
<title>Score correlations</title>
<sec id="s4h1">
<title>Prediction scores vs ChIP-seq peak scores</title>
<p>By applying the 10-fold cross-validation methodology to the ChIP-seq data sets (note that the 600 best/top peaks are not considered in the 10-fold cross-validation), we obtained a score for each one of the peaks (corresponding to the score of the best hit per peak). The ENCODE data associate a signal value to each one of the peaks. The signal value is a measure of the enrichment for the overall peak region (usually, average). As the peak scores coming from ENCODE may be unevenly distributed, we computed the median of the distribution of prediction scores for the sequences within each 5-percentile of the peak scores. Hence, each peak score 5-percentile is associated to a predictive score corresponding to the median of their distribution within the percentile. A Spearman's rank correlation coefficient has been used to compare prediction scores and ChIP-seq peak scores for these latter data using the <italic>cor.test</italic> function of the <italic>stats R</italic> package <xref ref-type="bibr" rid="pcbi.1003214-R1">[66]</xref>.</p>
</sec><sec id="s4h2">
<title>Prediction scores vs experimentally measured DNA-binding affinity</title>
<p>We compared experimental DNA-binding affinities from <xref ref-type="bibr" rid="pcbi.1003214-Maerkl1">[52]</xref> to prediction scores computed using the different models on all the permuted sequences defined in <xref ref-type="bibr" rid="pcbi.1003214-Maerkl1">[52]</xref>. The models derived from ChIP-seq data are 11 nt long (see <xref ref-type="supplementary-material" rid="pcbi.1003214.s006">Figure S6</xref>) and comparisons focussed on sequences corresponding to positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e099" xlink:type="simple"/></inline-formula> (corresponding to nucleotides NCACGTG in the consensus sequences), see <xref ref-type="supplementary-material" rid="pcbi.1003214.s006">Figure S6</xref>. As TFFMs need to incorporate a background context, we generated all the 12 nt long sequences preserving GTG at positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e100" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e101" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e102" xlink:type="simple"/></inline-formula>. Prediction scores obtained by the models were compared to the experimental values corresponding to the sequence with the same nucleotides at positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e103" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e104" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e105" xlink:type="simple"/></inline-formula>. Note that a single value coming from <xref ref-type="bibr" rid="pcbi.1003214-Maerkl1">[52]</xref> is associated with multiple predictive values for a given model. <xref ref-type="sec" rid="s2">Results</xref> are given in <xref ref-type="fig" rid="pcbi-1003214-g005">Figure 5B</xref>. Experimental scores were iteratively divided using top percentiles (ten by ten) and the Pearson correlation coefficient between experimental values and prediction scores was computed for each set (see <xref ref-type="fig" rid="pcbi-1003214-g005">Figure 5B</xref>).</p>
<p>The detailed methodology used is as follows:</p>
<list list-type="order"><list-item>
<p>Construct all 12 nt-long sequences conserving nucleotides GTG at positions 9, 10, and 11 (a nucleotide A is used at the very beginning for the 1st-order TFFM with no impact on the scores).</p>
</list-item><list-item>
<p>Construct TFFMs, PWM (i.e. log-odds weight matrices), and DWM using an initialization from the top 600 peaks and trained on the whole ENCODE human Max K562 ChIP-seq data set.</p>
</list-item><list-item>
<p>Compute the prediction scores on all the sequences using the different methods (only one strand is used for the score computations here).</p>
</list-item></list>
<p>Score associations between experimental values and results obtained using the above methodology are given in <xref ref-type="fig" rid="pcbi-1003214-g005">Figure 5B</xref> and <xref ref-type="table" rid="pcbi-1003214-t002">Table 2</xref>.</p>
<p>Starting from the optimal binding site containing CACGTG, we also compared the changes in prediction scores between a mutated site and the optimal sequence with the changes using the experimental DNA-binding affinities for the same sequences. A Pearson correlation coefficient between the two scores is then computed using the function <italic>cor.test</italic> of the <italic>stats R</italic> package <xref ref-type="bibr" rid="pcbi.1003214-R1">[66]</xref> (see <xref ref-type="table" rid="pcbi-1003214-t002">Table 2</xref>).</p>
</sec></sec><sec id="s4i">
<title>Flexible length models</title>
<sec id="s4i1">
<title>JunD TFFMs</title>
<p>The first over-represented motif found by MEME in the JunD data set used for the flexible motif analysis is 14 nt-long with a G/C (G or C) at the centre of the core motif (see position 9 in <xref ref-type="supplementary-material" rid="pcbi.1003214.s010">Figure S10A</xref>). The second most over-represented from MEME shows a CG (C followed by a G) at the centre of the core motif (see positions 7–8 in <xref ref-type="supplementary-material" rid="pcbi.1003214.s010">Figure S10B</xref>). When initializing the flexible length TFFMs, we added to the 14 nt-long ones the possibility of having either the G/C like pattern at position 9 or a CG like one. Transition probabilities were initialized to allow both motif with 50% probability each. The corresponding TFFMs were then trained on the training data sets following the same 10-fold cross-validation methodology as before.</p>
</sec><sec id="s4i2">
<title>STAT4 and STAT6 TFFMs</title>
<p>To construct a flexible length TFFM modelling STAT4 TFBSs, a gap position has been manually added to the original initialized models between position 5 and 6 (see <xref ref-type="supplementary-material" rid="pcbi.1003214.s011">Figure S11</xref>) with equal probabilities for the four different nucleotides. At the initialization step, the probability of using the added gap is set to 50%. Final probabilities have been learned starting from these initialized models using the 10-fold cross-validation methodology on the training sets.</p>
</sec><sec id="s4i3">
<title>STAT6 TFFMs</title>
<p>To construct a flexible length TFFM modelling STAT6 TFBSs, position 5 from the original motif (see <xref ref-type="supplementary-material" rid="pcbi.1003214.s012">Figure S12</xref>) was allowed to be ignored. Namely, the transition probability between positions 4 and 5 has been manually set to 50% and a new 50% transition probability between positions 4 and 6 has been added. Hence, the TFFMs were able to model 10 nt- to 11 nt-long motifs. Corresponding initialized TFFMs were trained during the 10-fold cross-validation analysis.</p>
</sec><sec id="s4i4">
<title>MafK TFFMs</title>
<p>Using the original initialized TFFM modelling MafK TFBSs, we allowed the motif to end at position 14 in order to model a flexible edge (see <xref ref-type="supplementary-material" rid="pcbi.1003214.s009">Figure S9</xref>). Namely, a 50% transition probability between position 14 and the background state has been added and transition probability between the positions 14 and 15 has been set to 50%. Corresponding initialized TFFMs were trained during the 10-fold cross-validation analysis.</p>
</sec><sec id="s4i5">
<title>GLAM2</title>
<p>GLAM2 <xref ref-type="bibr" rid="pcbi.1003214-Frith1">[53]</xref> has been used on JunD, STAT4, and STAT6 ChIP-seq data sets to predict flexible length motifs. For comparison purposes with the TFFMs, the parameters used were optimized for the search of motifs of the same lengths. Namely, GLAM2 was used to search for 14 nt- to 15 nt-long motifs on the JunD data set, and 11 nt- to 12 nt-long motifs on the STAT4 and STAT6 data sets.</p>
</sec></sec><sec id="s4j">
<title>TFFM-framework</title>
<p>The TFFM-framework is available at <ext-link ext-link-type="uri" xlink:href="http://cisreg.cmmt.ubc.ca/TFFM/doc" xlink:type="simple">http://cisreg.cmmt.ubc.ca/TFFM/doc</ext-link> with a web-based application available at <ext-link ext-link-type="uri" xlink:href="http://cisreg.cmmt.ubc.ca/TFFM/" xlink:type="simple">http://cisreg.cmmt.ubc.ca/TFFM/</ext-link>. The software have been implemented in Python using the Biopython tools <xref ref-type="bibr" rid="pcbi.1003214-Cock1">[67]</xref> and the General Hidden Markov Model library <xref ref-type="bibr" rid="pcbi.1003214-Schliep1">[68]</xref>. The web-based application has been developed using the Python <italic>cgi_app</italic> (<ext-link ext-link-type="uri" xlink:href="https://pypi.python.org/pypi/cgi_app/1.3" xlink:type="simple">https://pypi.python.org/pypi/cgi_app/1.3</ext-link>) and the Python port of the Template Toolkit (<ext-link ext-link-type="uri" xlink:href="http://template-toolkit.org/python/index.html" xlink:type="simple">http://template-toolkit.org/python/index.html</ext-link>).</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003214.s001" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003214.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p><bold>Performances comparison between TFFMs and weight matrices.</bold> For the 94 ChIP-seq data sets obtaining an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e106" xlink:type="simple"/></inline-formula>% for at least one method (using the HMM-generated background), the ratio between the AUC value using a specific model and the best AUC obtained is plotted. The four types of models were used (1st-order TFFM, detailed TFFM, PWM, and DWM). By considering a similar performance between two methods when the AUC ratio is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e107" xlink:type="simple"/></inline-formula>%, we plot at the top of the figure the region where the weight matrices (WMs) best perform, where the TFFMs best perform, and where they are similar. AUC ratios are ranked from the least to the most favorable to the TFFMs.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003214.s002" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003214.s002" position="float" xlink:type="simple"><label>Figure S2</label><caption>
<p><bold>ROC curves analysis.</bold> Comparison of the AUCs corresponding to the ROC curves analysis of the subgroup of 96 ENCODE ChIP-seq data sets for which at least one predictive method generated an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e108" xlink:type="simple"/></inline-formula>% using the genomic background. The y-axis represents the AUC for the ROC curves corresponding to the different ChIP-seq data sets. The x-axis indicates the number of hits found by MEME in the top 600 sequences of the corresponding ChIP-seq data sets. (A) Each point represent a predictive method applied to a ChIP-seq data set (blue for 1st-order TFFMs, red for detailed TFFMs, black for PWMs, and grey for DWMs). (B) Regression lines obtained from the points in (A) for the four different models. The regression lines corresponding to the TFFMs indicate that higher AUC values have been obtained using TFFMs compared to PWMs and DWMs, overall.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003214.s003" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003214.s003" position="float" xlink:type="simple"><label>Figure S3</label><caption>
<p><bold>ROC curves analysis.</bold> Comparison of the AUCs corresponding to the ROC curves analysis of the subgroup of 94 ENCODE ChIP-seq data sets for which at least one predictive method generated an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e109" xlink:type="simple"/></inline-formula>% using the HMM-generated background. The y-axis represents the AUC for the ROC curves corresponding to the different ChIP-seq data sets. The x-axis indicates the number of hits found by MEME in the top 600 sequences of the corresponding ChIP-seq data sets. (A) Each point represent a predictive method applied to a ChIP-seq data set (blue for 1st-order TFFMs, red for detailed TFFMs, black for PWMs, and grey for DWMs). (B) Regression lines obtained from the points in (A) for the four different models. The regression lines corresponding to the TFFMs indicate that higher AUC values have been obtained using TFFMs compared to PWMs and DWMs, overall.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003214.s004" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003214.s004" position="float" xlink:type="simple"><label>Figure S4</label><caption>
<p><bold>Performances comparison between 0-order TFFMs, other TFFMs, and WMs.</bold> For the 94 ChIP-seq data sets used in <xref ref-type="supplementary-material" rid="pcbi.1003214.s001">Figure S1</xref> (using the HMM-generated background), the ratio between the AUC value using a specific model and the best AUC obtained is plotted. (A) The three types of TFFMs were used (1st-order, detailed, and 0-order TFFMs). AUC ratios are ranked from the least to the most favorable to the 1st-order and detailed TFFMs. We observe that the 1st-order and detailed TFFMs outperform the 0-order TFFMs when discriminating ChIP-seq sequences from HMM-generated background sequences. (B) 0-order TFFMs and WMs were used. AUC ratios are ranked from the least to the most favorable to the 0-order TFFM. We observe that the WMs outperform the 0-order TFFMs when discriminating ChIP-seq sequences from HMM-generated background sequences.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003214.s005" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003214.s005" position="float" xlink:type="simple"><label>Figure S5</label><caption>
<p><bold>Statistical significance of the trend of correlation between ChIP-seq peak scores and the different predictive scoring methods.</bold> The statistical significance of the trend plot in <xref ref-type="fig" rid="pcbi-1003214-g005">Figure 5A</xref> is assessed by computing the <italic>p</italic>-value of getting a regression line (between ChIP-seq peak scores and TFFM or WM predicted scores) with an slope that far away from 0. We observe that the p-values are, overall, close to 0 and indicate that the average behaviour of the correlation given by a linear regression is far from an horizontal line.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003214.s006" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003214.s006" position="float" xlink:type="simple"><label>Figure S6</label><caption>
<p><bold>Max sequence logo.</bold> Sequence logo corresponding to Max binding sites. Max binds to the DNA with the core site allowing for CACGTG nucleotides at positions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e110" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e111" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e112" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e113" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e114" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e115" xlink:type="simple"/></inline-formula>.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003214.s007" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003214.s007" position="float" xlink:type="simple"><label>Figure S7</label><caption>
<p><bold>Sequence logos of the top DNA-binding affinity values.</bold> Sequence logos obtained from the top (A) 25, (B) 50, (C) 75, and (D) 100 scoring sequences using DNA-binding affinities measured experimentally.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003214.s008" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003214.s008" position="float" xlink:type="simple"><label>Figure S8</label><caption>
<p><bold>Sequence logos for Max TF.</bold> Sequence logos obtained from the two TFFMs and the PWM after training on all the ChIP-seq data for human Max TF from the K562 cell line. (A) Summary TFFM logo for the 1st-order TFFM. (B) Summary TFFM logo for the detailed TFFM. (C) Sequence logo for the PWM.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003214.s009" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003214.s009" position="float" xlink:type="simple"><label>Figure S9</label><caption>
<p><bold>Sequence logo for MafK TF.</bold> Sequence logo from the motif found over-represented with MEME. We observe a weak motif on the edge of the motif, starting at position 15, is separated by a 1 nt spacer from the core motif.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003214.s010" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003214.s010" position="float" xlink:type="simple"><label>Figure S10</label><caption>
<p><bold>Sequence logos for JunD TF.</bold> Sequence logos of the top two motifs found over-represented with MEME. (A) The first over-represented motif found by MEME in the JunD data set is 14 nt-long with a G/C (G or C) at the centre of the core motif (see position 9). (B) The second most over-represented from MEME shows a CG (C followed by a G) at the centre of the core motif (see positions 7–8).</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003214.s011" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003214.s011" position="float" xlink:type="simple"><label>Figure S11</label><caption>
<p><bold>Sequence logos for STAT4 TF.</bold> Sequence logos of the top motif found over-represented with MEME.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003214.s012" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003214.s012" position="float" xlink:type="simple"><label>Figure S12</label><caption>
<p><bold>Sequence logos for STAT6 TF.</bold> Sequence logos of the top motif found over-represented with MEME.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003214.s013" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003214.s013" position="float" xlink:type="simple"><label>Figure S13</label><caption>
<p><bold>Discriminative power of the probability of occupancy.</bold> Using 1st-order and detailed TFFMs, the ratio between the AUC value obtained from the best site per sequence or the probability of occupancy (Pocc) and the best AUC obtained is plotted. (A) For the 97 ChIP-seq data sets for which at least one method obtains an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e116" xlink:type="simple"/></inline-formula> using a genomic background, results from the two kinds of methods (best site per sequence or Pocc) are plotted. AUC ratios are ranked from the least to the most favorable to the usage of the Pocc computation. (B) For the 100 ChIP-seq data sets for which at least one method obtains an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e117" xlink:type="simple"/></inline-formula> using a HMM-generated background, results from the two kinds of methods (best site per sequence or Pocc) are plotted. AUC ratios are ranked from the least to the most favorable to the usage of the Pocc computation. We observe that using the Pocc computed on the DNA sequences perform better, overall, than using the best score per sequence obtained with the TFFMs on both sets of background sequences.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003214.s014" mimetype="application/postscript" xlink:href="info:doi/10.1371/journal.pcbi.1003214.s014" position="float" xlink:type="simple"><label>Figure S14</label><caption>
<p><bold>0-order HMM schema.</bold> 0-order HMM schema used in 0-order TFFMs where the first state represents the background and the following states the consecutive positions within a TFBS. Each state emits a nucleotide with an independent probability for the previously emitted nucleotides.</p>
<p>(EPS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003214.s015" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003214.s015" position="float" xlink:type="simple"><label>Table S1</label><caption>
<p><bold>HMM-based tools for TFBS prediction comparison.</bold> Different HMM-based tools (names and references are given in the first and second columns) have been developed to predict TFBSs. The table compares different features of the tools. The third column indicates whether the models capture the dependencies between TFBS positions. The fourth column indicates whether the implemented HMMs allow for flexible length motifs. The fifth column indicates which tools implement the computation of probability of occupancy (Pocc) of a TF on DNA sequences. The sixth and seventh columns indicate whether the source-code of the tools is freely available for download and whether there is a corresponding online documentation. Finally, the last column indicates the tools for which a web-based application is available.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003214.s016" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003214.s016" position="float" xlink:type="simple"><label>Table S2</label><caption>
<p><bold>Statistical significance for discriminative power differences between the predictive methods.</bold> The table contains the Benjamini-Hochberg corrected <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003214.e118" xlink:type="simple"/></inline-formula>-values of the differences (using a Wilcoxon signed rank test) between each pair of methods. 1st-order and detailed TFFMs are likely to perform similarly and so between PWM and DWM. <xref ref-type="sec" rid="s2">Results</xref> are obtained using AUC values when discriminating ChIP-seq data from HMM-generated background sequences.</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We thank David J. Arenillas for implementing the web-based application and for helpful comments and Rebecca Worsley-Hunt for the retrieval of the ENCODE data sets, providing the scripts and data sets to construct genomic backgrounds, and helpful comments. We thank Hugues Richard for helpful discussions. We thank the four referees for helpful comments and suggestions. We thank Miroslav Hatas for systems support and Dora Pak for management support.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003214-Badis1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Badis</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Berger</surname><given-names>MF</given-names></name>, <name name-style="western"><surname>Philippakis</surname><given-names>AA</given-names></name>, <name name-style="western"><surname>Talukder</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Gehrke</surname><given-names>AR</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Diversity and complexity in DNA recognition by transcription factors</article-title>. <source>Science (New York, NY)</source> <volume>324</volume>: <fpage>1720</fpage>–<lpage>3</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Wasserman1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wasserman</surname><given-names>WW</given-names></name>, <name name-style="western"><surname>Sandelin</surname><given-names>A</given-names></name> (<year>2004</year>) <article-title>Applied bioinformatics for the identification of regulatory elements</article-title>. <source>Nature reviews Genetics</source> <volume>5</volume>: <fpage>276</fpage>–<lpage>87</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Stark1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stark</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Lin</surname><given-names>MF</given-names></name>, <name name-style="western"><surname>Kheradpour</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Pedersen</surname><given-names>JS</given-names></name>, <name name-style="western"><surname>Parts</surname><given-names>L</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Discovery of functional elements in 12 Drosophila genomes using evolutionary signatures</article-title>. <source>Nature</source> <volume>450</volume>: <fpage>219</fpage>–<lpage>32</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Bernard1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bernard</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Lecharny</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Brunaud</surname><given-names>V</given-names></name> (<year>2010</year>) <article-title>Improved detection of motifs with preferential location in promoters</article-title>. <source>Genome</source> <volume>53</volume>: <fpage>739</fpage>–<lpage>52</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Arvey1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Arvey</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Agius</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Noble</surname><given-names>WS</given-names></name>, <name name-style="western"><surname>Leslie</surname><given-names>C</given-names></name> (<year>2012</year>) <article-title>Sequence and chromatin determinants of cell-type-specific transcription factor binding</article-title>. <source>Genome research</source> <volume>22</volume>: <fpage>1723</fpage>–<lpage>34</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-HoSui1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ho Sui</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Mortimer</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Arenillas</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Brumm</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Walsh</surname><given-names>CJ</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>oPOSSUM: identification of over-represented transcription factor binding sites in co-expressed genes</article-title>. <source>Nucleic acids research</source> <volume>33</volume>: <fpage>3154</fpage>–<lpage>64</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-HoSui2"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ho Sui</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Fulton</surname><given-names>DL</given-names></name>, <name name-style="western"><surname>Arenillas</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Kwon</surname><given-names>AT</given-names></name>, <name name-style="western"><surname>Wasserman</surname><given-names>WW</given-names></name> (<year>2007</year>) <article-title>oPOSSUM: integrated tools for analysis of regulatory motif over-representation</article-title>. <source>Nucleic acids research</source> <volume>35</volume>: <fpage>W245</fpage>–<lpage>52</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Stormo1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name> (<year>2013</year>) <article-title>Modeling the specificity of protein-dna interactions</article-title>. <source>Quantitative Biology</source> <volume>1</volume>: <fpage>115</fpage>–<lpage>130</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Luscombe1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Luscombe</surname><given-names>NM</given-names></name>, <name name-style="western"><surname>Laskowski</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Thornton</surname><given-names>JM</given-names></name> (<year>2001</year>) <article-title>Amino acid-base interactions: a three-dimensional analysis of protein-DNA interactions at an atomic level</article-title>. <source>Nucleic acids research</source> <volume>29</volume>: <fpage>2860</fpage>–<lpage>74</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Man1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Man</surname><given-names>TK</given-names></name>, <name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name> (<year>2001</year>) <article-title>Non-independence of Mnt repressor-operator interaction determined by a new quantitative multiple fluorescence relative affinity (QuMFRA) assay</article-title>. <source>Nucleic acids research</source> <volume>29</volume>: <fpage>2471</fpage>–<lpage>8</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Bulyk1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name>, <name name-style="western"><surname>Johnson</surname><given-names>PLF</given-names></name>, <name name-style="western"><surname>Church</surname><given-names>GM</given-names></name> (<year>2002</year>) <article-title>Nucleotides of transcription factor binding sites exert interdependent effects on the binding affinities of transcription factors</article-title>. <source>Nucleic acids research</source> <volume>30</volume>: <fpage>1255</fpage>–<lpage>1261</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Berger1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berger</surname><given-names>MF</given-names></name>, <name name-style="western"><surname>Philippakis</surname><given-names>AA</given-names></name>, <name name-style="western"><surname>Qureshi</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>He</surname><given-names>FS</given-names></name>, <name name-style="western"><surname>Estep</surname><given-names>PW</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Compact, universal DNA microarrays to comprehensively determine transcription-factor binding site specificities</article-title>. <source>Nature biotechnology</source> <volume>24</volume>: <fpage>1429</fpage>–<lpage>35</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Barash1"><label>13</label>
<mixed-citation publication-type="other" xlink:type="simple">Barash Y, Elidan G, Friedman N, Kaplan T (2003) Modeling dependencies in protein-DNA binding sites. In: Proceedings of the seventh annual international conference on Computational molecular biology - RECOMB '03. New York, New York, USA: ACM Press, pp. 28–37.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Tomovic1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tomovic</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Oakeley</surname><given-names>EJ</given-names></name> (<year>2007</year>) <article-title>Position dependencies in transcription factor binding sites</article-title>. <source>Bioinformatics (Oxford, England)</source> <volume>23</volume>: <fpage>933</fpage>–<lpage>41</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Zhou1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhou</surname><given-names>Q</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name> (<year>2004</year>) <article-title>Modeling within-motif dependence for transcription factor binding site predictions</article-title>. <source>Bioinformatics (Oxford, England)</source> <volume>20</volume>: <fpage>909</fpage>–<lpage>16</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Mukherjee1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mukherjee</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Berger</surname><given-names>MF</given-names></name>, <name name-style="western"><surname>Jona</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>XS</given-names></name>, <name name-style="western"><surname>Muzzey</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Rapid analysis of the DNA-binding specificities of transcription factors with DNA microarrays</article-title>. <source>Nature genetics</source> <volume>36</volume>: <fpage>1331</fpage>–<lpage>9</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Weirauch1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weirauch</surname><given-names>MT</given-names></name>, <name name-style="western"><surname>Cote</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Norel</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Annala</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Zhao</surname><given-names>Y</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Evaluation of methods for modeling transcription factor sequence specificity</article-title>. <source>Nature biotechnology</source> <volume>31</volume>: <fpage>126</fpage>–<lpage>34</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Zhao1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhao</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Ruan</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Pandey</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name> (<year>2012</year>) <article-title>Improved models for transcription factor binding site identification using nonindependent interactions</article-title>. <source>Genetics</source> <volume>191</volume>: <fpage>781</fpage>–<lpage>90</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Siddharthan1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Siddharthan</surname><given-names>R</given-names></name> (<year>2010</year>) <article-title>Dinucleotide weight matrices for predicting transcription factor binding sites: generalizing the position weight matrix</article-title>. <source>PloS one</source> <volume>5</volume>: <fpage>e9722</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Sandelin1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sandelin</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Wasserman</surname><given-names>WW</given-names></name> (<year>2005</year>) <article-title>Prediction of nuclear hormone receptor response elements</article-title>. <source>Molecular endocrinology (Baltimore, Md)</source> <volume>19</volume>: <fpage>595</fpage>–<lpage>606</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Lyakhov1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lyakhov</surname><given-names>IG</given-names></name>, <name name-style="western"><surname>Krishnamachari</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Schneider</surname><given-names>TD</given-names></name> (<year>2008</year>) <article-title>Discovery of novel tumor suppressor p53 response elements using information theory</article-title>. <source>Nucleic acids research</source> <volume>36</volume>: <fpage>3828</fpage>–<lpage>33</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Riley1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Riley</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Sontag</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Levine</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>The p53HMM algorithm: using profile hidden markov models to detect p53-responsive genes</article-title>. <source>BMC Bioinformatics</source> <volume>10</volume>: <fpage>111</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Harr1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Harr</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Häggström</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gustafsson</surname><given-names>P</given-names></name> (<year>1983</year>) <article-title>Seach algorithm for pattern match analysis of nucleic acid sequences</article-title>. <source>Nucleic Acids Research</source> <volume>11</volume>: <fpage>2943</fpage>–<lpage>2957</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Staden1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Staden</surname><given-names>R</given-names></name> (<year>1984</year>) <article-title>Computer methods to locate signals in nucleic acid sequences</article-title>. <source>Nucleic Acids Research</source> <volume>12</volume>: <fpage>505</fpage>–<lpage>519</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Ehret1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ehret</surname><given-names>GB</given-names></name>, <name name-style="western"><surname>Reichenbach</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Schindler</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Horvath</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Fritz</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2001</year>) <article-title>DNA binding specificity of different STAT proteins. Comparison of in vitro specificity with natural target sites</article-title>. <source>The Journal of biological chemistry</source> <volume>276</volume>: <fpage>6675</fpage>–<lpage>88</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Soldaini1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Soldaini</surname><given-names>E</given-names></name>, <name name-style="western"><surname>John</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Moro</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Bollenbacher</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Schindler</surname><given-names>U</given-names></name>, <etal>et al</etal>. (<year>2000</year>) <article-title>DNA Binding Site Selection of Dimeric and Tetrameric Stat5 Proteins Reveals a Large Repertoire of Divergent Tetrameric Stat5a Binding Sites</article-title>. <source>Molecular and Cellular Biology</source> <volume>20</volume>: <fpage>389</fpage>–<lpage>401</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Reid1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reid</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Evans</surname><given-names>KJ</given-names></name>, <name name-style="western"><surname>Dyer</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Wernisch</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Ott</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>Variable structure motifs for transcription factor binding sites</article-title>. <source>BMC genomics</source> <volume>11</volume>: <fpage>30</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Lin1"><label>28</label>
<mixed-citation publication-type="other" xlink:type="simple">Lin Th, Ray P, Sandve GK, Uguroglu S, Xing EP (2008) BayCis : A Bayesian Hierarchical HMM for Cis-Regulatory Module Decoding in Metazoan Genomes. In: Vingron M, Wong L, editors, RECOMB'08 Proceedings of the 12th annual international conference on Research in computational molecular biology. Springer Berlin Heidelberg, pp. 66–81.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Wasson1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wasson</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Hartemink</surname><given-names>AJ</given-names></name> (<year>2009</year>) <article-title>An ensemble model of competitive multi-factor binding of the genome</article-title>. <source>Genome research</source> <volume>19</volume>: <fpage>2101</fpage>–<lpage>12</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Levkovitz1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Levkovitz</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Yosef</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Gershengorn</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Ruppin</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Sharan</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>A Novel HMM-Based Method for Detecting Enriched Transcription Factor Binding Sites Reveals RUNX3 as a Potential Target in Pancreatic Cancer Biology</article-title>. <source>PloS one</source> <volume>5</volume>: <fpage>e14423</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Salama1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Salama</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Stekel</surname><given-names>DJ</given-names></name> (<year>2010</year>) <article-title>Inclusion of neighboring base interdependencies substantially improves genome-wide prokaryotic transcription factor binding site prediction</article-title>. <source>Nucleic acids research</source> <volume>38</volume>: <fpage>e135</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Mehta1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mehta</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Schwab</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Sengupta</surname><given-names>AM</given-names></name> (<year>2011</year>) <article-title>Statistical Mechanics of Transcription-Factor Binding Site Discovery Using Hidden Markov Models</article-title>. <source>Journal of statistical physics</source> <volume>142</volume>: <fpage>1187</fpage>–<lpage>1205</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Marinescu1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marinescu</surname><given-names>VD</given-names></name>, <name name-style="western"><surname>Kohane</surname><given-names>IS</given-names></name>, <name name-style="western"><surname>Riva</surname><given-names>A</given-names></name> (<year>2005</year>) <article-title>MAPPER: a search engine for the computational identification of putative transcription factor binding sites in multiple genomes</article-title>. <source>BMC bioinformatics</source> <volume>6</volume>: <fpage>79</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Marinescu2"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marinescu</surname><given-names>VD</given-names></name>, <name name-style="western"><surname>Kohane</surname><given-names>IS</given-names></name>, <name name-style="western"><surname>Riva</surname><given-names>A</given-names></name> (<year>2005</year>) <article-title>The MAPPER database: a multi-genome catalog of putative transcription factor binding sites</article-title>. <source>Nucleic acids research</source> <volume>33</volume>: <fpage>D91</fpage>–<lpage>7</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Raman1"><label>35</label>
<mixed-citation publication-type="other" xlink:type="simple">Raman R, Overton GC (1994) Application of hidden Markov modeling to the characterization of transcription factor binding sites. In: Proceedings of the Twenty-Seventh Hawaii International Conference on System Sciences HICSS-94. IEEE Comput. Soc. Press, pp. 275–283.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Durbin1"><label>36</label>
<mixed-citation publication-type="other" xlink:type="simple">Durbin R, Edddy S, Krogh A, Mitchison G (1998) Biological sequence analysis Probabilistic models of proteins and nucleic acids. Cambridge: Cambridge University Press.</mixed-citation>
</ref>
<ref id="pcbi.1003214-BenGal1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ben-Gal</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Shani</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Gohr</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Grau</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Arviv</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Identification of transcription factor binding sites with variable-order Bayesian networks</article-title>. <source>Bioinformatics (Oxford, England)</source> <volume>21</volume>: <fpage>2657</fpage>–<lpage>66</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Johnson1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Johnson</surname><given-names>DS</given-names></name>, <name name-style="western"><surname>Mortazavi</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Myers</surname><given-names>RM</given-names></name>, <name name-style="western"><surname>Wold</surname><given-names>B</given-names></name> (<year>2007</year>) <article-title>Genome-wide mapping of in vivo protein- DNA interactions</article-title>. <source>Science (New York, NY)</source> <volume>316</volume>: <fpage>1497</fpage>–<lpage>502</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-ENCODE1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><collab xlink:type="simple">ENCODE</collab> (<year>2004</year>) <article-title>The ENCODE (ENCyclopedia Of DNA Elements) Project</article-title>. <source>Science (New York, NY)</source> <volume>306</volume>: <fpage>636</fpage>–<lpage>40</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Segal1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Segal</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Fondufe-Mittendorf</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Thå ström</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Field</surname><given-names>Y</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>A genomic code for nucleosome positioning</article-title>. <source>Nature</source> <volume>442</volume>: <fpage>772</fpage>–<lpage>8</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Schneider1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schneider</surname><given-names>TD</given-names></name>, <name name-style="western"><surname>Stephens</surname><given-names>RM</given-names></name> (<year>1990</year>) <article-title>Sequence logos: a new way to display consensus sequences</article-title>. <source>Nucleic acids research</source> <volume>18</volume>: <fpage>6097</fpage>–<lpage>6100</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-SchusterBckler1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schuster-Böckler</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Schultz</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Rahmann</surname><given-names>S</given-names></name> (<year>2004</year>) <article-title>HMM Logos for visualization of protein families</article-title>. <source>BMC bioinformatics</source> <volume>5</volume>: <fpage>7</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Bailey1"><label>43</label>
<mixed-citation publication-type="other" xlink:type="simple">Bailey TL, Elkan C (1994) Fitting a mixture model by expectation maximization to discover motifs in biopolymers. In: Proceedings of the second International Conference on Intelligent Systems for Molecular Biology. AAAI Press, pp. 28–36.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Bailey2"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bailey</surname><given-names>TL</given-names></name>, <name name-style="western"><surname>Gribskov</surname><given-names>M</given-names></name> (<year>1998</year>) <article-title>Combining evidence using p-values: application to sequence homology searches</article-title>. <source>Bioinformatics (Oxford, England)</source> <volume>14</volume>: <fpage>48</fpage>–<lpage>54</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Wilbanks1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilbanks</surname><given-names>EG</given-names></name>, <name name-style="western"><surname>Facciotti</surname><given-names>MT</given-names></name> (<year>2010</year>) <article-title>Evaluation of algorithm performance in ChIP-seq peak detection</article-title>. <source>PloS one</source> <volume>5</volume>: <fpage>e11471</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Wilcoxon1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilcoxon</surname><given-names>F</given-names></name> (<year>1945</year>) <article-title>Individual Comparisons by Ranking Methods</article-title>. <source>Biometrics Bulletin</source> <volume>1</volume>: <fpage>80</fpage>–<lpage>83</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Benjamini1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benjamini</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Hochberg</surname><given-names>Y</given-names></name> (<year>1995</year>) <article-title>Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source> <volume>57</volume>: <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Benos1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benos</surname><given-names>PV</given-names></name>, <name name-style="western"><surname>Lapedes</surname><given-names>AS</given-names></name>, <name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name> (<year>2002</year>) <article-title>Probabilistic Code for DNA Recognition by Proteins of the EGR Family</article-title>. <source>Journal of Molecular Biology</source> <volume>323</volume>: <fpage>701</fpage>–<lpage>727</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Benos2"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benos</surname><given-names>PV</given-names></name>, <name name-style="western"><surname>Lapedes</surname><given-names>AS</given-names></name>, <name name-style="western"><surname>Fields</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name> (<year>2001</year>) <article-title>SAMIE: Statistical algorithm for modeling interaction energies</article-title>. <source>In: Pacific Symposium on Biocomputing</source> <volume>volume 126</volume> <volume>6</volume>: <fpage>115</fpage>–<lpage>126</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Benos3"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benos</surname><given-names>PV</given-names></name>, <name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name>, <name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name> (<year>2002</year>) <article-title>Additivity in protein-DNA interactions: how good an approximation is it</article-title>? <source>Nucleic acids research</source> <volume>30</volume>: <fpage>4442</fpage>–<lpage>51</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Spearman1"><label>51</label>
<mixed-citation publication-type="other" xlink:type="simple">Spearman C (1904) The proof and measurement of association between two things. American Journal of Psychology : 72–101.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Maerkl1"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maerkl</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Quake</surname><given-names>SR</given-names></name> (<year>2007</year>) <article-title>A systems approach to measuring the binding energy landscapes of transcription factors</article-title>. <source>Science (New York, NY)</source> <volume>315</volume>: <fpage>233</fpage>–<lpage>7</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Frith1"><label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Frith</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Saunders</surname><given-names>NFW</given-names></name>, <name name-style="western"><surname>Kobe</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Bailey</surname><given-names>TL</given-names></name> (<year>2008</year>) <article-title>Discovering sequence motifs with arbitrary insertions and deletions</article-title>. <source>PLoS computational biology</source> <volume>4</volume>: <fpage>e1000071</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Wei1"><label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wei</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Vahedi</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Sun</surname><given-names>HW</given-names></name>, <name name-style="western"><surname>Watford</surname><given-names>WT</given-names></name>, <name name-style="western"><surname>Takatori</surname><given-names>H</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Discrete roles of STAT4 and STAT6 transcription factors in tuning epigenetic modifications and transcription during T helper cell differentiation</article-title>. <source>Immunity</source> <volume>32</volume>: <fpage>840</fpage>–<lpage>51</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Granek1"><label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Granek</surname><given-names>Ja</given-names></name>, <name name-style="western"><surname>Clarke</surname><given-names>ND</given-names></name> (<year>2005</year>) <article-title>Explicit equilibrium modeling of transcription-factor binding and gene regulation</article-title>. <source>Genome biology</source> <volume>6</volume>: <fpage>R87</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Roider1"><label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Roider</surname><given-names>HG</given-names></name>, <name name-style="western"><surname>Kanhere</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Manke</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Vingron</surname><given-names>M</given-names></name> (<year>2007</year>) <article-title>Predicting transcription factor affinities to DNA from a biophysical model</article-title>. <source>Bioinformatics (Oxford, England)</source> <volume>23</volume>: <fpage>134</fpage>–<lpage>41</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Drawid1"><label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Drawid</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Gupta</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Nagaraj</surname><given-names>VH</given-names></name>, <name name-style="western"><surname>Gélinas</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Sengupta</surname><given-names>AM</given-names></name> (<year>2009</year>) <article-title>OHMM: a Hidden Markov Model accurately predicting the occupancy of a transcription factor with a self-overlapping binding motif</article-title>. <source>BMC bioinformatics</source> <volume>10</volume>: <fpage>208</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Siggers1"><label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Siggers</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Duyzend</surname><given-names>MH</given-names></name>, <name name-style="western"><surname>Reddy</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Khan</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name> (<year>2011</year>) <article-title>Non-DNA-binding cofactors enhance DNA-binding specificity of a transcriptional regulatory complex</article-title>. <source>Molecular Systems Biology</source> <volume>7</volume>: <fpage>1</fpage>–<lpage>14</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Borneman1"><label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Borneman</surname><given-names>AR</given-names></name>, <name name-style="western"><surname>Gianoulis</surname><given-names>Ta</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>ZD</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Rozowsky</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Divergence of transcription factor binding sites across related yeast species</article-title>. <source>Science (New York, NY)</source> <volume>317</volume>: <fpage>815</fpage>–<lpage>9</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Kasowski1"><label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kasowski</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Grubert</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Heffelfinger</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Hariharan</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Asabere</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Variation in transcription factor binding among humans</article-title>. <source>Science (New York, NY)</source> <volume>328</volume>: <fpage>232</fpage>–<lpage>5</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Felice1"><label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Felice</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Cattoglio</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Cittaro</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Testa</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Miccio</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Transcription factor binding sites are genetic determinants of retroviral integration in the human genome</article-title>. <source>PloS one</source> <volume>4</volume>: <fpage>e4571</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-PortalesCasamar1"><label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Portales-Casamar</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Kirov</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Lim</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Lithwick</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Swanson</surname><given-names>MI</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>PAZAR: a framework for collection and dissemination of cis-regulatory sequence annotation</article-title>. <source>Genome biology</source> <volume>8</volume>: <fpage>R207</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-PortalesCasamar2"><label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Portales-Casamar</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Arenillas</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Lim</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Swanson</surname><given-names>MI</given-names></name>, <name name-style="western"><surname>Jiang</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>The PAZAR database of gene regulatory information coupled to the ORCA toolkit for the study of regulatory sequences</article-title>. <source>Nucleic acids research</source> <volume>37</volume>: <fpage>D54</fpage>–<lpage>60</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-PortalesCasamar3"><label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Portales-Casamar</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Thongjuea</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Kwon</surname><given-names>AT</given-names></name>, <name name-style="western"><surname>Arenillas</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Zhao</surname><given-names>X</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>JASPAR 2010: the greatly expanded open-access database of transcription factor binding profiles</article-title>. <source>Nucleic Acids Res</source> <volume>38</volume> (<issue>Database issue</issue>) <fpage>D105</fpage>–<lpage>10</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Bailey3"><label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bailey</surname><given-names>TL</given-names></name>, <name name-style="western"><surname>Boden</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Buske</surname><given-names>FA</given-names></name>, <name name-style="western"><surname>Frith</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Grant</surname><given-names>CE</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>MEME SUITE: tools for motif discovery and searching</article-title>. <source>Nucleic acids research</source> <volume>37</volume>: <fpage>W202</fpage>–<lpage>8</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-R1"><label>66</label>
<mixed-citation publication-type="other" xlink:type="simple">R Development Core Team (2011) R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing, Vienna, Austria. URL <ext-link ext-link-type="uri" xlink:href="http://www.R-project.org/" xlink:type="simple">http://www.R-project.org/</ext-link>. ISBN 3-900051-07-0. </mixed-citation>
</ref>
<ref id="pcbi.1003214-Cock1"><label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cock</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Antao</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Chang</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Chapman</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Cox</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Biopython: freely available python tools for computational molecular biology and bioinformatics</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>1422</fpage>–<lpage>1423</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003214-Schliep1"><label>68</label>
<mixed-citation publication-type="other" xlink:type="simple">Schliep A, Georgi B, Rungsarityotin W (2004) The General Hidden Markov Model Library: Analyzing Systems with Unobservable States. In: Proceedings of the Heinz-Billing-Price. p. 15.</mixed-citation>
</ref>
</ref-list></back>
</article>