<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-02115</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003537</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Evolutionary modeling</subject></subj-group></subj-group><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>BEAST 2: A Software Platform for Bayesian Evolutionary Analysis</article-title>
<alt-title alt-title-type="running-head">Bayesian Evolutionary Analysis with BEAST 2</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Bouckaert</surname><given-names>Remco</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Heled</surname><given-names>Joseph</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Kühnert</surname><given-names>Denise</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Vaughan</surname><given-names>Tim</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Wu</surname><given-names>Chieh-Hsi</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Xie</surname><given-names>Dong</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Suchard</surname><given-names>Marc A.</given-names></name><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="aff" rid="aff5"><sup>5</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Rambaut</surname><given-names>Andrew</given-names></name><xref ref-type="aff" rid="aff6"><sup>6</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Drummond</surname><given-names>Alexei J.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff7"><sup>7</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Computational Evolution Group, Department of Computer Science, University of Auckland, Auckland, New Zealand</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Department of Environmental Systems Science, ETH Zürich, Zürich, Switzerland</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Allan Wilson Centre for Molecular Ecology and Evolution, Massey University, Palmerston North, New Zealand</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>Departments of Biomathematics and Human Genetics, David Geffen School of Medicine, University of California, Los Angeles, Los Angeles, California, United States of America</addr-line></aff>
<aff id="aff5"><label>5</label><addr-line>Department of Biostatistics, School of Public Health, University of California, Los Angeles, Los Angeles, California, United States of America</addr-line></aff>
<aff id="aff6"><label>6</label><addr-line>Institute of Evolutionary Biology, University of Edinburgh, Edinburgh, United Kingdom</addr-line></aff>
<aff id="aff7"><label>7</label><addr-line>Allan Wilson Centre for Molecular Ecology and Evolution, University of Auckland, Auckland, New Zealand</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Prlic</surname><given-names>Andreas</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>UCSD, United States of America</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">remco@cs.auckland.ac.nz</email> (RB); <email xlink:type="simple">alexei@cs.auckland.ac.nz</email> (AJD)</corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Analyzed the data: DK TV CHW. Wrote the paper: RB JH DK TV CHW MAS AR AJD. Developed software: RB JH DK TV CHW DX MAS AR AJD.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>4</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>10</day><month>4</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>4</issue>
<elocation-id>e1003537</elocation-id>
<history>
<date date-type="received"><day>2</day><month>12</month><year>2013</year></date>
<date date-type="accepted"><day>20</day><month>1</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Bouckaert et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>We present a new open source, extensible and flexible software platform for Bayesian evolutionary analysis called BEAST 2. This software platform is a re-design of the popular BEAST 1 platform to correct structural deficiencies that became evident as the BEAST 1 software evolved. Key among those deficiencies was the lack of post-deployment extensibility. BEAST 2 now has a fully developed package management system that allows third party developers to write additional functionality that can be directly installed to the BEAST 2 analysis platform via a package manager without requiring a new software release of the platform. This package architecture is showcased with a number of recently published new models encompassing birth-death-sampling tree priors, phylodynamics and model averaging for substitution models and site partitioning. A second major improvement is the ability to read/write the entire state of the MCMC chain to/from disk allowing it to be easily shared between multiple instances of the BEAST software. This facilitates checkpointing and better support for multi-processor and high-end computing extensions. Finally, the functionality in new packages can be easily added to the user interface (BEAUti 2) by a simple XML template-based mechanism because BEAST 2 has been re-designed to provide greater integration between the analysis engine and the user interface so that, for example BEAST and BEAUti use exactly the same XML file format.</p>
</abstract>
<funding-group><funding-statement>AJD, RB and JH were supported by a Rutherford Discovery Fellowship (<ext-link ext-link-type="uri" xlink:href="http://www.royalsociety.org.nz/programmes/funds/rutherford-discovery/" xlink:type="simple">http://www.royalsociety.org.nz/programmes/funds/rutherford-discovery/</ext-link>) from the Royal Society of New Zealand awarded to AJD. DK and CHW were supported by Marsden grant UOA0809 from the Royal Society of New Zealand (<ext-link ext-link-type="uri" xlink:href="http://www.royalsociety.org.nz/programmes/funds/marsden/awards/award-2008-2/" xlink:type="simple">http://www.royalsociety.org.nz/programmes/funds/marsden/awards/award-2008-2/</ext-link>). MAS was supported by National Institutes of Health (<ext-link ext-link-type="uri" xlink:href="http://www.nih.gov" xlink:type="simple">http://www.nih.gov</ext-link>) grant R01 HG006139 and National Science Foundation (<ext-link ext-link-type="uri" xlink:href="http://www.nsf.gov" xlink:type="simple">http://www.nsf.gov</ext-link>) grants DMS-0856099 and DMS-1264153. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="6"/></counts></article-meta>
</front>
<body><sec id="s1">
<title/>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Software Article.</p>
</disp-quote></sec><sec id="s2">
<title>Introduction</title>
<p>Bayesian phylogenetics has grown to encompass a number of related inference problems that have at their core the observation of one or more alignments of molecular sequence data from evolutionarily-related samples along with associated information. Depending on the details, the associated information can be in the form of dates/locations of sampling, fossil constraints, or various quantitative or categorical traits associated with the samples for which DNA has been collected.</p>
<p>We use the term <italic>Bayesian evolutionary analysis</italic> to encompass a broad set of analysis types that have at their core a model including one or more phylogenetic or genealogical trees. This includes traditional phylogenetics, but also coalescent-based population genetics, phylodynamics, phylogeography, gene-tree/species-tree reconciliation and related analyses.</p>
<p>The first generation Bayesian Evolutionary Analysis by Sampling Trees (BEAST) package <xref ref-type="bibr" rid="pcbi.1003537-Drummond1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003537-Drummond2">[2]</xref> has become a popular platform for solving such problems and takes a modeling philosophy that all of these evolutionary analysis problems share at their core one or more phylogenetic time-trees. A time-tree is a rooted phylogeny in which every node (including the tips) have a time/age associated with them. Typically some times are known (e.g. often the tip times) and some are unknown and must be estimated (e.g. most ancestral divergence times).</p>
<p>This paper describes the overarching design and implementation details of a re-write of the BEAST platform that we have designated BEAST 2, as well as presenting examples of some significant new models developed especially for this new platform.</p>
</sec><sec id="s3">
<title>Design and Implementation</title>
<p>The design goals for BEAST 2 are to provide a software framework for <italic>Bayesian evolutionary analysis</italic> that is (i) useable, (ii) open and (iii) extensible. Useability implies that the system should be easy to use, well documented, have an intuitive user interface and have a manageable learning curve. By open we mean open access, open source, open input/output formats; all of which facilitate reproducible and verifiable results. Openness also implies that the software should run on many platforms. Extensibility implies a design that is modular and easy to make additions to, especially in a way that does not require re-building and re-deploying the software for each additional feature. All of these design goals are made within a scope that encompasses efficient Bayesian inference and model-based hypothesis testing for sequence data analysis involving phylogenetic time-tree models.</p>
<p>These design goals are broadly similar to those that motivated the development of BEAST 1.x. We embarked on a re-write to address the following shortcomings. The BEAST 1.x design resulted in the emergence of three separately maintained parts: (i) BEAST model/likelihood/operator class hierarchies, (ii) BEAST XML parsing class hierarchy, (iii) BEAUti 1.x class hierarchy and user interface code. Each of these parts requires a substantial learning curve and all must be understood in order to add new functionality. In addition BEAST 1.x has no well developed architecture for third-party extensions without re-building and re-distributing the whole package. Newly developed models have to wait for the next release to become available, unless developers release a derivative of BEAST that would then diverge from the main trunk. Neither of these options is ideal. BEAST 1.x also suffers from patchy documentation and a lack of consistency in the XML input format leading to many idiosyncratic quirks.</p>
<sec id="s3a">
<title>BEAST 2</title>
<p>BEAST 2 provides the same core <italic>Bayesian evolutionary analyses</italic> that have made BEAST 1.x popular. In particular it implements relaxed clocks <xref ref-type="bibr" rid="pcbi.1003537-Drummond3">[3]</xref>, non-parametric coalescent analysis <xref ref-type="bibr" rid="pcbi.1003537-Drummond4">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1003537-Minin1">[5]</xref>, multispecies coalescent inference <xref ref-type="bibr" rid="pcbi.1003537-Heled1">[6]</xref>, phylogeography <xref ref-type="bibr" rid="pcbi.1003537-Lemey1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1003537-Lemey2">[8]</xref> and others. BEAUti 2 has been designed from the ground up to be seamlessly integrated with the BEAST analysis engine so that all the models developed can easily be added to the user interface without any GUI programming. In addition BEAST 2 has a sequence simulator for simulation studies, post-processing tools (such as LogAnalyzer, LogCombiner, DensiTree <xref ref-type="bibr" rid="pcbi.1003537-Bouckaert1">[9]</xref>) and comprehensive documentation for both users and developers. The advantages of BEAST 2 include (i) the ability to check-point and resume analyses, (ii) reload analysis specification in BEAUti, (iii) package architecture including extensible XML format and template-based GUI development, and (iv) include details of model in trace files.</p>
</sec><sec id="s3b">
<title>BEAST 2 packages</title>
<p>In many ways BEAST 2 can be considered as a library or platform for MCMC-based Bayesian inference and phylogenetics. A BEAST 2 package is a collection of BEASTObject extensions that builds on that platform. Packages make it easier to describe the separate pieces of academic work that have been developed and aid in correct attribution and separation of concerns. The package architecture also streamlines the core class hierarchy in the software making the core software platform easier to learn for new developers. Finally the package architecture facilitates the separation of stable, experimental and dead code. For a detailed tutorial on writing packages we invite readers to read the BEAST 2 website available at <ext-link ext-link-type="uri" xlink:href="http://beast2.org" xlink:type="simple">http://beast2.org</ext-link>.</p>
</sec><sec id="s3c">
<title>BEAST2 software architecture</title>
<p>The basic philosophy of BEAST 2 framework is that all user-visible objects are sub-classes of the BEASTObject class. BEASTObject is a top-level class in the core package that provides for (i) inputs, which can be other BEASTObjects or various “primitive” values, (ii) documentation (iii) automatic validation and (iv) XML ‘parsing’. Inputs connect BEASTObjects with other BEASTObjects, allowing a model to be visualized as a directed acyclic graph. <xref ref-type="fig" rid="pcbi-1003537-g001">Figure 1</xref> shows a model where each rocket represents a BEASTObject and the thrusters the inputs of these BEASTObjects. A lines from a rocket to a thruster indicates the BEASTObject is available as input to the connected BEASTObject. Visualizing the model this way makes it easy for developers to reason about complex models. The BEASTObject class provides for these things both through a set of inherited methods and through a set of conventions on the use of the Input class as instance variables of the BEASTObject class. These conventions support the linking up of BEASTObjects via either XML or the new BEAUti user interface via introspection of a BEASTObject's instance variables. A key role of the BEASTObject class is the automatic conversion of XML input files to a runtime model and analysis specifications in both BEAST and BEAUti 2 without additional XML parsing code.</p>
<fig id="pcbi-1003537-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003537.g001</object-id><label>Figure 1</label><caption>
<title>A complete model with six sequences, HKY substitution model, strict clock, Yule tree prior, a number of operators, mainly on the tree, and a few loggers to produce output to a trace file, a tree log and screen output.</title>
<p>Note the explicit existence of a State object.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003537.g001" position="float" xlink:type="simple"/></fig>
<p>BEAST 2 is well documented, and the documentation is accessible through the BEAST2 wiki at <ext-link ext-link-type="uri" xlink:href="http://beast2.org/wiki" xlink:type="simple">http://beast2.org/wiki</ext-link>. It contains general information about the programs in the BEAST distribution, frequently asked questions, and a number of tutorials that provide step by step instructions on performing various kinds of analysis, including divergence dating, measurable evolving populations, STAR-BEAST (*BEAST) and phylogeography. Furthermore, there is a mailing list for users and developers and a reference book is available (<ext-link ext-link-type="uri" xlink:href="http://beast2.org/book.html" xlink:type="simple">http://beast2.org/book.html</ext-link>) and is expected to be published in 2014.</p>
</sec></sec><sec id="s4">
<title>Results</title>
<p>Here we illustrate some of the popular and novel modeling features available on the BEAST2 platform. These features cover the key concerns in an evolutionary analysis: the modeling of the substitution process, and the modeling of the generative and observation processes relating to the time-tree.</p>
<p>BEAST2 implements a range of techniques to improve sampling performance including multi-core parallelization, vector and GPU approaches to fine scale parallelization through the use of the BEAGLE library <xref ref-type="bibr" rid="pcbi.1003537-Suchard1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1003537-Ayres1">[11]</xref>. BEAST2 can also be made to perform Metropolis-coupled MCMC and the path sampling approach to model comparison <xref ref-type="bibr" rid="pcbi.1003537-Baele1">[12]</xref> is also implemented.</p>
<p>A suite of methods available in former versions of BEAST have been ported to the new framework including ancestral state reconstruction and phylogeography <xref ref-type="bibr" rid="pcbi.1003537-Lemey1">[7]</xref>, continuous phylogeography <xref ref-type="bibr" rid="pcbi.1003537-Lemey2">[8]</xref>, and the stochastic Dollo substitution model with various character ascertainment schemes <xref ref-type="bibr" rid="pcbi.1003537-Alekseyenko1">[13]</xref>.</p>
<p>Two multilocus methods from BEAST1 are available in BEAST2: EBSP <xref ref-type="bibr" rid="pcbi.1003537-Heled2">[14]</xref> reconstructs the effective population size through time, while *BEAST <xref ref-type="bibr" rid="pcbi.1003537-Heled1">[6]</xref> infers the species phylogeny and population size(s).</p>
<sec id="s4a">
<title>New evolutionary models in BEAST 2</title>
<p>One of the significant new additions to BEAST is the implementation of a spike-and-slab <xref ref-type="bibr" rid="pcbi.1003537-Kuo1">[15]</xref> mixture model within the BEAST 2 framework <xref ref-type="bibr" rid="pcbi.1003537-Wu1">[16]</xref> that simultaneously estimates the phylogenetic tree, the number of partitions, the assignment of sites to partitions, the nucleotide substitution model and a rate multiplier for each partition. This model facilitates the Bayesian selection over a set of nucleotide substitution models including K80 <xref ref-type="bibr" rid="pcbi.1003537-Kimura1">[17]</xref>, F81 <xref ref-type="bibr" rid="pcbi.1003537-Felsenstein1">[18]</xref>, HKY85 <xref ref-type="bibr" rid="pcbi.1003537-Hasegawa1">[19]</xref>, TN93 <xref ref-type="bibr" rid="pcbi.1003537-Tamura1">[20]</xref> and GTR <xref ref-type="bibr" rid="pcbi.1003537-Tavar1">[21]</xref>.</p>
<p>This modelling approach is implemented in the SubstBMA package, and <xref ref-type="fig" rid="pcbi-1003537-g002">Figure 2</xref> shows the results of applying the SDPM2 model <xref ref-type="bibr" rid="pcbi.1003537-Wu1">[16]</xref> to analyse a small multiple sequence alignment of mtDNA from 12 species of primate <xref ref-type="bibr" rid="pcbi.1003537-Hayasaka1">[22]</xref>. With this model, two independent Dirichlet process priors were applied to the substitution model parameters and site rates. Sites in the same substitution model category are not necessarily in the same rate category. The BEAST2 input file and prior setup of the analysis in <xref ref-type="fig" rid="pcbi-1003537-g002">Figure 2</xref> is available in the supplementary information <xref ref-type="supplementary-material" rid="pcbi.1003537.s002">Code S2</xref>. <xref ref-type="fig" rid="pcbi-1003537-g002">Figure 2a</xref> shows that HKY85 is the model preferred by the most sites, with a posterior expectation of 396 out of 898 sites conforming to this model. <xref ref-type="fig" rid="pcbi-1003537-g002">Figure 2b</xref> shows that as expected, sites in the first and second positions are more likely to be in the lower rate categories than the sites in the third codon position. However it also shows that there is large rate variation within each biological partition.</p>
<fig id="pcbi-1003537-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003537.g002</object-id><label>Figure 2</label><caption>
<title>Results from an SDPM2 partition and substitution model averaging analysis of mtDNA from 7 species of primate (data from <xref ref-type="bibr" rid="pcbi.1003537-Hayasaka1">[22]</xref>).</title>
<p>(a) The posterior probability distribution of the substitution model given a site. The grid cell at row <italic>i</italic> and column <italic>j</italic> represents the posterior probability of model <italic>i</italic> at site <italic>j</italic>. The darker the shade, the higher the posterior probability. It appears that this data favours models that accommodate a difference in transition and transversion rates and in nucleotide base frequencies. Of those three models, the simplest version (HKY85) is generally preferred. (b) There are four biological partitions in this data set: the three codon positions and a tRNA region. Conditioned on three rate categories (which has the highest posterior probability), the mean posterior proportion of sites in each category for each biological partition is plotted. The categories with faster rates are closer to the top of the bar.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003537.g002" position="float" xlink:type="simple"/></fig>
<p>The BDSKY package contains the birth–death skyline model <xref ref-type="bibr" rid="pcbi.1003537-Stadler1">[23]</xref> which employs a piecewise constant birth-death-sampling process to compute the probability density of a phylogeny. In this model, a branching event in the sample tree corresponds to a “birth”, each tip in the tree corresponds to a sampling event, and a death is an unobserved event, i.e. an unsampled recovery or death. Each of these three event types occurs with its own characteristic rate in each interval of the piecewise function. This enables the estimation of epidemiological parameters such as the effective reproduction ratio <italic>R</italic>. In particular, the model permits the reconstruction of changes in <italic>R</italic> over time (<xref ref-type="fig" rid="pcbi-1003537-g003">Figure 3</xref>, see <xref ref-type="bibr" rid="pcbi.1003537-Stadler1">[23]</xref> for details). Detecting such changes can help assess the effects of public health measures for the prevention or control of infectious diseases, or to shed light on causes of rapid viral outbreaks. This model can be applied to study the diversification of species. In this scenario a “birth” event in the tree represents a speciation event rather than a transmission event. The Phylodynamics package <xref ref-type="bibr" rid="pcbi.1003537-Khnert1">[24]</xref> contains the BDSIR model <xref ref-type="bibr" rid="pcbi.1003537-Khnert2">[25]</xref>, which allows the reconstruction of viral host population dynamics based on SIR-type models jointly with the phylogenetic inference.</p>
<fig id="pcbi-1003537-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003537.g003</object-id><label>Figure 3</label><caption>
<title>Bayesian estimate of the effective reproduction number <italic>R<sub>e</sub></italic> over time (from simulated data).</title>
<p>Towards the end of the 3.5 years of the underlying epidemic process, <italic>R<sub>e</sub></italic> decreases below 1, which indicates a declining epidemic.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003537.g003" position="float" xlink:type="simple"/></fig>
<p>The MultiTypeTree package <xref ref-type="bibr" rid="pcbi.1003537-Vaughan1">[26]</xref>, <xref ref-type="bibr" rid="pcbi.1003537-Vaughan2">[27]</xref> implements a structured coalescent model that allows inference of subpopulation sizes and migration rates together with location-annotated genealogies (structured trees) from genetic data. This capability is similar to that of MIGRATE <xref ref-type="bibr" rid="pcbi.1003537-Beerli1">[28]</xref>–<xref ref-type="bibr" rid="pcbi.1003537-Beerli3">[30]</xref> and is absent from the original BEAST implementation. Additionally, serially sampled data can be used to jointly infer the time-scale of a phylogeny, which is not possible with the current release of MIGRATE. These capabilities are demonstrated in <xref ref-type="fig" rid="pcbi-1003537-g004">Figure 4</xref>, which presents results of using the MultiTypeTree package to analyze a 117 taxon spatially resolved and serially sampled HCV genotype 1a data set <xref ref-type="bibr" rid="pcbi.1003537-vandeLaar1">[31]</xref> under a GTR+<italic>γ</italic>+I substitution model (the BEAST2 input file for this analysis is available in the supplementary information <xref ref-type="supplementary-material" rid="pcbi.1003537.s003">Code S3</xref>). This package can be extended to include additional models besides the structured coalescent.</p>
<fig id="pcbi-1003537-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003537.g004</object-id><label>Figure 4</label><caption>
<title>Results from a structured coalescent analysis of a spatially-annotated HCV data set using the MultiTypeTree package.</title>
<p>These include (a) a typical tree drawn from the posterior (edge colours represent lineage locations), (b) posterior distributions of <italic>θ</italic> = <italic>N<sub>e</sub>g</italic> for each of the spatially-localized sub-populations and (c) the posterior distribution for the molecular clock rate <italic>μ</italic><sub>0</sub>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003537.g004" position="float" xlink:type="simple"/></fig>
<p>The RBS package contains a reversible-jump based substitution model for nucleotide data <xref ref-type="bibr" rid="pcbi.1003537-Bouckaert2">[32]</xref>. With this substitution model there is no need to choose a substitution model for a given partition, since the RBS model samples the appropriate (mixture of) models given the sequence data. The RBS package also contains an auto-partition model which, as the name suggests, automatically splits an alignment into a fixed number of partitions of contiguous sites. The RBS package is integrated into BEAUti, so its functionality is available in any nucleotide analysis.</p>
<p>The SNAPP package implements a multi-species coalescent for SNP and AFLP data <xref ref-type="bibr" rid="pcbi.1003537-Bryant1">[33]</xref>. Unlike *BEAST, which integrates out gene trees through MCMC, SNAPP integrates out the gene trees analytically. SNAPP can be used to determine the species tree and population sizes on the branches in the tree.</p>
<p>The MASTER package uses the BEAST framework to allow users to quickly and easily assemble and simulate a large class of continuous-time discrete-variable stochastic dynamics models <xref ref-type="bibr" rid="pcbi.1003537-Vaughan3">[34]</xref>. Specific examples include the models commonly found in population genetics, epidemiology, as well as chemistry. The MASTER package allows simulated state space trajectories to be generated, which can in turn be used to estimate the dynamics of moments such as population means and variances. Additionally, the models can be used to generate simulated phylogenetic networks compatible with the population size dynamics. In the case that these networks are tree-like, they can be used to provide starting points for BEAST MCMC calculations.</p>
</sec></sec><sec id="s5">
<title>Availability and Future Directions</title>
<p>The BEAST 2 platform is an open source project and is anonymously available on a source repository hosted by GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/CompEvol/beast2" xlink:type="simple">https://github.com/CompEvol/beast2</ext-link> and supplementary material <xref ref-type="supplementary-material" rid="pcbi.1003537.s001">Code S1</xref>. A website providing extra details, documentation, tutorials (supplementary material <xref ref-type="supplementary-material" rid="pcbi.1003537.s004">Text S1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003537.s005">S2</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003537.s006">S3</xref>) and a draft of an upcoming reference book is also available at <ext-link ext-link-type="uri" xlink:href="http://beast2.org" xlink:type="simple">http://beast2.org</ext-link>. The platform is open and we expect other researchers to add new methods, models and ideas that will take this framework in directions we cannot predict. Nevertheless, the authors have an interest in developing new models for gene-tree/species-tree reconciliation, species delimitation and species assignment as well as continuing to pursue the development of phylodynamic models that unify statistical phylogenetics and mathematical epidemiology.</p>
</sec><sec id="s6">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003537.s001" mimetype="application/x-tar" xlink:href="info:doi/10.1371/journal.pcbi.1003537.s001" position="float" xlink:type="simple"><label>Code S1</label><caption>
<p><bold>BEAST 2.1.0 source code as compressed archive.</bold> </p>
<p>(TGZ)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003537.s002" mimetype="text/xml" xlink:href="info:doi/10.1371/journal.pcbi.1003537.s002" position="float" xlink:type="simple"><label>Code S2</label><caption>
<p><bold>Substitution and partition model averaging example.</bold> Label primate describes the taxonomic scope, SDPM2 is the partition averaging model employed <xref ref-type="bibr" rid="pcbi.1003537-Wu1">[16]</xref> and sc denotes a strict clock analysis. It uses the SubstBMA package, available from <ext-link ext-link-type="uri" xlink:href="http://subst-bma.googlecode.com/" xlink:type="simple">http://subst-bma.googlecode.com/</ext-link>.</p>
<p>(XML)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003537.s003" mimetype="text/xml" xlink:href="info:doi/10.1371/journal.pcbi.1003537.s003" position="float" xlink:type="simple"><label>Code S3</label><caption>
<p><bold>Structured coalescent example.</bold> This example file runs on BEAST 2.1.0 with the MultiTypeTree package (<ext-link ext-link-type="uri" xlink:href="http://compevol.github.io/MultiTypeTree/" xlink:type="simple">http://compevol.github.io/MultiTypeTree/</ext-link>). The data for the structured coalescent example is made up of Hepatitis C (HCV) NS5B sequences obtained from GenBank as described in <xref ref-type="bibr" rid="pcbi.1003537-vandeLaar1">[31]</xref>. A strict molecular clock is used in conjunction with a GTR+Γ+I substitution model. Log-normal priors (<italic>μ</italic> = 0, <italic>σ</italic> = 1) are applied to each of the population size and migration rate parameters.</p>
<p>(XML)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003537.s004" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003537.s004" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>Tutorial for divergence dating.</bold> </p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003537.s005" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003537.s005" position="float" xlink:type="simple"><label>Text S2</label><caption>
<p><bold>Tutorial for measurable evolving populations.</bold> </p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003537.s006" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003537.s006" position="float" xlink:type="simple"><label>Text S3</label><caption>
<p><bold>Tutorial for multi-species coalescent with *BEAST.</bold> </p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We would like to thank all of the participants in NESCENT Working Group on “Software for Bayesian evolutionary analysis by sampling trees” including Alex Alekseyenko, Daniel Ayers, Guy Baele, Trevor Bedford, Peter Beerli, Aaron Darling, Tracy Heath, Philippe Lemey, Mark Holder, Katia Koelle, Paul O. Lewis, Gabriel Leventhal, Erick Matsen, Connor McCoy, Julie Palacios-Roman, David Rasmussen, Ben Redelings, Beth Shapiro, Tanja Stadler, David Swofford and Jeffrey Thorne, for invaluable discussion and assistance in developing the ideas that have culminated in the BEAST 2 software framework. We would also like to thank all the many contributors to BEAST 1.x (and related programs).</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003537-Drummond1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Drummond</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name> (<year>2007</year>) <article-title>Beast: Bayesian evolutionary analysis by sampling trees</article-title>. <source>BMC Evol Biol</source> <volume>7</volume>: <fpage>214</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Drummond2"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Drummond</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Suchard</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Xie</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name> (<year>2012</year>) <article-title>Bayesian phylogenetics with beauti and the beast 1.7</article-title>. <source>Mol Biol Evol</source> <volume>29</volume>: <fpage>1969</fpage>–<lpage>73</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Drummond3"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Drummond</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Ho</surname><given-names>SYW</given-names></name>, <name name-style="western"><surname>Phillips</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name> (<year>2006</year>) <article-title>Relaxed phylogenetics and dating with confidence</article-title>. <source>PLoS Biol</source> <volume>4</volume>: <fpage>e88</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Drummond4"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Drummond</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Shapiro</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Pybus</surname><given-names>OG</given-names></name> (<year>2005</year>) <article-title>Bayesian coalescent inference of past population dynamics from molecular sequences</article-title>. <source>Mol Biol Evol</source> <volume>22</volume>: <fpage>1185</fpage>–<lpage>92</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Minin1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Minin</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Bloomquist</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Suchard</surname><given-names>M</given-names></name> (<year>2008</year>) <article-title>Smooth skyride through a rough skyline: Bayesian coalescent-based inference of population dynamics</article-title>. <source>Molecular Biology and Evolution</source> <volume>25</volume>: <fpage>1459</fpage>–<lpage>1471</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Heled1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Heled</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Drummond</surname><given-names>AJ</given-names></name> (<year>2010</year>) <article-title>Bayesian inference of species trees from multilocus data</article-title>. <source>Mol Biol Evol</source> <volume>27</volume>: <fpage>570</fpage>–<lpage>80</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Lemey1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lemey</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Drummond</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Suchard</surname><given-names>MA</given-names></name> (<year>2009</year>) <article-title>Bayesian phylogeography finds its roots</article-title>. <source>PLoS Comput Biol</source> <volume>5</volume>: <fpage>e1000520</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Lemey2"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lemey</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Welch</surname><given-names>JJ</given-names></name>, <name name-style="western"><surname>Suchard</surname><given-names>MA</given-names></name> (<year>2010</year>) <article-title>Phylogeography takes a relaxed random walk in continuous space and time</article-title>. <source>Mol Biol Evol</source> <volume>27</volume>: <fpage>1877</fpage>–<lpage>85</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Bouckaert1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bouckaert</surname><given-names>RR</given-names></name> (<year>2010</year>) <article-title>Densitree: making sense of sets of phylogenetic trees</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>1372</fpage>–<lpage>1373</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Suchard1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Suchard</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>Many-core algorithms for statistical phylogenetics</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>1370</fpage>–<lpage>1376</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Ayres1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ayres</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Darling</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Zwickl</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Beerli</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Holder</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Beagle: a common application programming inferface and high-performance computing library for statistical phylogenetics</article-title>. <source>Syst Biol</source> <volume>61</volume>: <fpage>170</fpage>–<lpage>173</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Baele1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Baele</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Lemey</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Bedford</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Rambaut</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Suchard</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Improving the accuracy of demographic and molecular clock model comparison while accommodating phylogenetic uncertainty</article-title>. <source>Molecular Biology and Evolution</source> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/mss084" xlink:type="simple">10.1093/molbev/mss084</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003537-Alekseyenko1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alekseyenko</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Suchard</surname><given-names>M</given-names></name> (<year>2008</year>) <article-title>Wagner and Dollo: a stochastic duet by composing two parsimonious solos</article-title>. <source>Systematic Biology</source> <volume>57</volume>: <fpage>772</fpage>–<lpage>784</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Heled2"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Heled</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Drummond</surname><given-names>A</given-names></name> (<year>2008</year>) <article-title>Bayesian inference of population size history from multiple loci</article-title>. <source>BMC Evolutionary Biology</source> <volume>8</volume>: <fpage>289</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Kuo1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kuo</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Mallick</surname><given-names>B</given-names></name> (<year>1998</year>) <article-title>Variable selection for regression models</article-title>. <source>Sankhya: The Indian Journal of Statistics, Series B (1960–2002)</source> <volume>60</volume>: <fpage>65</fpage>–<lpage>81</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Wu1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname><given-names>CH</given-names></name>, <name name-style="western"><surname>Suchard</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Drummond</surname><given-names>AJ</given-names></name> (<year>2013</year>) <article-title>Bayesian selection of nucleotide substitution models and their site assignments</article-title>. <source>Mol Biol Evol</source> <volume>30</volume>: <fpage>669</fpage>–<lpage>88</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Kimura1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kimura</surname><given-names>M</given-names></name> (<year>1980</year>) <article-title>A simple method for estimating evolutionary rates of base substitutions through comparative studies of nucleotide sequences</article-title>. <source>Journal of molecular evolution</source> <volume>16</volume>: <fpage>111</fpage>–<lpage>120</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Felsenstein1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name> (<year>1981</year>) <article-title>Evolutionary trees from DNA sequences: A maximum likelihood approach</article-title>. <source>Journal of Molecular Evolution</source> <volume>17</volume>: <fpage>368</fpage>–<lpage>376</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Hasegawa1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hasegawa</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Kishino</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Yano</surname><given-names>T</given-names></name> (<year>1985</year>) <article-title>Dating of the human-ape splitting by a molecular clock of mitochondrial dna</article-title>. <source>Journal of molecular evolution</source> <volume>22</volume>: <fpage>160</fpage>–<lpage>174</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Tamura1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tamura</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Nei</surname><given-names>M</given-names></name> (<year>1993</year>) <article-title>Estimation of the number of nucleotide substitutions in the control region of mitochondrial dna in humans and chimpanzees</article-title>. <source>Molecular Biology and Evolution</source> <volume>10</volume>: <fpage>512</fpage>–<lpage>526</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Tavar1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tavaré</surname><given-names>S</given-names></name> (<year>1986</year>) <article-title>Some probabilistic and statistical problems in the analysis of dna sequences</article-title>. <source>Lect Math Life Sci</source> <volume>17</volume>: <fpage>57</fpage>–<lpage>86</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Hayasaka1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hayasaka</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Gojobori</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Horai</surname><given-names>S</given-names></name> (<year>1988</year>) <article-title>Molecular phylogeny and evolution of primate mitochondrial dna</article-title>. <source>Mol Biol Evol</source> <volume>5</volume>: <fpage>626</fpage>–<lpage>44</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Stadler1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stadler</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Kühnert</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Bonhoeffer</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Drummond</surname><given-names>AJ</given-names></name> (<year>2013</year>) <article-title>Birth-death skyline plot reveals temporal changes of epidemic spread in HIV and HCV</article-title>. <source>PNAS</source> <volume>110</volume>: <fpage>228</fpage>–<lpage>233</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Khnert1"><label>24</label>
<mixed-citation publication-type="other" xlink:type="simple">Kühnert D. Phylodynamics package. <ext-link ext-link-type="uri" xlink:href="http://phylodynamics.googlecode.com" xlink:type="simple">http://phylodynamics.googlecode.com</ext-link>. Accessed: 2014-01-31.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Khnert2"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kühnert</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Stadler</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Vaughan</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Drummond</surname><given-names>A</given-names></name> (<year>2014</year>) <article-title>Simultaneous reconstruction of evolutionary history and epidemiological dynamics from viral sequences with the birth-death sir model</article-title>. <source>J R Soc Interface</source> <volume>11</volume> (<issue>94</issue>) <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsif.2013.1106" xlink:type="simple">10.1098/rsif.2013.1106</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003537-Vaughan1"><label>26</label>
<mixed-citation publication-type="other" xlink:type="simple">Vaughan T. Multitypetree package. <ext-link ext-link-type="uri" xlink:href="https://github.com/CompEvol/MultiTypeTree" xlink:type="simple">https://github.com/CompEvol/MultiTypeTree</ext-link>. Accessed: 2014-01-31.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Vaughan2"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vaughan</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Kühnert</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Popinga</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Welch</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Drummond</surname><given-names>A</given-names></name> (<year>2013</year>) <article-title>Efficient sampling of multi-type trees for bayesian phylogenetic inference</article-title>. In press.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Beerli1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beerli</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name> (<year>1999</year>) <article-title>Maximum-likelihood estimation of migration rates and effective population numbers in two populations using a coalescent approach</article-title>. <source>Genetics</source> <volume>152</volume>: <fpage>763</fpage>–<lpage>773</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Beerli2"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beerli</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name> (<year>2001</year>) <article-title>Maximum likelihood estimation of a migration matrix and effective population sizes in n subpopulations by using a coalescent approach</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>98</volume>: <fpage>4563</fpage>–<lpage>4568</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Beerli3"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beerli</surname><given-names>P</given-names></name> (<year>2006</year>) <article-title>Comparison of bayesian and maximum-likelihood inference of population genetic parameters</article-title>. <source>Bioinformatics</source> <volume>22</volume>: <fpage>341</fpage>–<lpage>345</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-vandeLaar1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van de Laar</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Pybus</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Bruisten</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Nelson</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Evidence of a large, international network of HCV transmission in HIV-positive men who have sex with men</article-title>. <source>Gastroenterology</source> <volume>136</volume>: <fpage>1609</fpage>–<lpage>1617</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Bouckaert2"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bouckaert</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Alvarado-Mora</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Rebello Pinho</surname><given-names>Ja</given-names></name> (<year>2013</year>) <article-title>Evolutionary rates and hbv: issues of rate estimation with bayesian molecular methods</article-title>. <source>Antiviral therapy</source> <volume>18</volume>: <fpage>497</fpage>–<lpage>503</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Bryant1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bryant</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Bouckaert</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Rosenberg</surname><given-names>N</given-names></name>, <name name-style="western"><surname>RoyChoudhury</surname><given-names>A</given-names></name> (<year>2012</year>) <article-title>Inferring species trees directly from biallelic genetic markers: Bypassing gene trees in a full coalescent analysis</article-title>. <source>Mol Biol Evol</source> <volume>29</volume>: <fpage>1917</fpage>–<lpage>1932</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003537-Vaughan3"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vaughan</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Drummond</surname><given-names>AJ</given-names></name> (<year>2013</year>) <article-title>A stochastic simulator of birth-death master equations with application to phylodynamics</article-title>. <source>Mol Biol Evol</source> <volume>30</volume>: <fpage>1480</fpage>–<lpage>93</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/mst057" xlink:type="simple">10.1093/molbev/mst057</ext-link></comment></mixed-citation>
</ref>
</ref-list></back>
</article>