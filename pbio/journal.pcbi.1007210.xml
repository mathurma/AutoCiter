<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00297</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1007210</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Agriculture</subject><subj-group><subject>Animal products</subject><subj-group><subject>Honey</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Nutrition</subject><subj-group><subject>Diet</subject><subj-group><subject>Food</subject><subj-group><subject>Honey</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Nutrition</subject><subj-group><subject>Diet</subject><subj-group><subject>Food</subject><subj-group><subject>Honey</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>States of matter</subject><subj-group><subject>Fluids</subject><subj-group><subject>Liquids</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>States of matter</subject><subj-group><subject>Fluids</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical mechanics</subject><subj-group><subject>Continuum mechanics</subject><subj-group><subject>Fluid mechanics</subject><subj-group><subject>Fluid dynamics</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical properties</subject><subj-group><subject>Viscosity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Physical chemistry</subject><subj-group><subject>Chemical properties</subject><subj-group><subject>Viscosity</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Materials science</subject><subj-group><subject>Materials physics</subject><subj-group><subject>Viscosity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Materials physics</subject><subj-group><subject>Viscosity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Mechanical engineering</subject><subj-group><subject>Engines</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical mechanics</subject><subj-group><subject>Continuum mechanics</subject><subj-group><subject>Fluid mechanics</subject><subj-group><subject>Fluid dynamics</subject><subj-group><subject>Fluid flow</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Modeling human intuitions about liquid flow with particle-based simulation</article-title>
<alt-title alt-title-type="running-head">Modeling human intuitions about liquid flow with particle-based simulation</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" equal-contrib="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7268-2256</contrib-id>
<name name-style="western">
<surname>Bates</surname> <given-names>Christopher J.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="fn" rid="currentaff001"><sup>¤a</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Yildirim</surname> <given-names>Ilker</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Tenenbaum</surname> <given-names>Joshua B.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Battaglia</surname> <given-names>Peter</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="fn" rid="currentaff002"><sup>¤b</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Brain and Cognitive Sciences, Massachusetts Institue of Technology, Cambridge, Massachusetts, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Center for Brains, Minds and Machines (CBMM), Massachusetts Institue of Technology, Cambridge, Massachusetts, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Computer Science and Artificial Intelligence Laboratory (CSAIL), Massachusetts Institue of Technology, Cambridge, Massachusetts, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Daunizeau</surname> <given-names>Jean</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Brain and Spine Institute (ICM), FRANCE</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="current-aff" id="currentaff001">
<label>¤a</label>
<p>Current address: Department of Brain and Cognitive Sciences, University of Rochester, Rochester, New York</p>
</fn>
<fn fn-type="current-aff" id="currentaff002">
<label>¤b</label>
<p>Current address: DeepMind, London, United Kingdom</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">cjbates@ur.rochester.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>7</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>22</day>
<month>7</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>7</issue>
<elocation-id>e1007210</elocation-id>
<history>
<date date-type="received">
<day>23</day>
<month>2</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>25</day>
<month>6</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Bates et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1007210"/>
<abstract>
<p>Humans can easily describe, imagine, and, crucially, <italic>predict</italic> a wide variety of behaviors of liquids—splashing, squirting, gushing, sloshing, soaking, dripping, draining, trickling, pooling, and pouring—despite tremendous variability in their material and dynamical properties. Here we propose and test a computational model of how people perceive and predict these liquid dynamics, based on coarse approximate simulations of fluids as collections of interacting particles. Our model is analogous to a “game engine in the head”, drawing on techniques for interactive simulations (as in video games) that optimize for efficiency and natural appearance rather than physical accuracy. In two behavioral experiments, we found that the model accurately captured people’s predictions about how liquids flow among complex solid obstacles, and was significantly better than several alternatives based on simple heuristics and deep neural networks. Our model was also able to explain how people’s predictions varied as a function of the liquids’ properties (e.g., viscosity and stickiness). Together, the model and empirical results extend the recent proposal that human physical scene understanding for the dynamics of rigid, solid objects can be supported by approximate probabilistic simulation, to the more complex and unexplored domain of fluid dynamics.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Although most people struggle to learn physics in school, every human brain is a remarkable “intuitive physicist” when it comes to the quick, unconscious judgments we make in interacting with the world. Almost effortlessly, and with surprisingly high quantitative accuracy, we can judge when a plate placed near the edge of a table might be at risk of falling, or how far a partially filled glass of water can be tipped before the water is in danger of spilling. What kinds of computations in the brain support these abilities? We suggest an answer based on probabilistic inference operating over particle-based simulations, the same class of approximation methods used in video games to simulate convincing real-time interactions between objects in a virtual environment. This hypothesis can potentially account for people’s quantitative, graded judgments in diverse and novel situations including a wide array of materials and physical properties, without positing a large number of separate systems or heuristics. Here, we build on previous evidence that a system of approximate probabilistic simulation supports judgments about rigid objects (e.g. judging the stability of towers of blocks, as in the game Jenga), and ask whether people can also make systematic and accurate predictions about flowing and splashing liquids, such as water or honey. We show that it is possible to capture people’s quantitative predictions using a computational model that approximates the true underlying fluid dynamics to varying degrees of coarseness, and find that people’s responses are most consistent with a very coarse approximation; while typical engineering applications might use tens or hundreds of thousands of particles to simulate a fluid, the brain might get by with roughly a hundred particles. Furthermore, we find that people consistently underestimate the potential energy of a splashing liquid in our virtual scenes, and that our model captures this behavior.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>CCF-1231216</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Tenenbaum</surname> <given-names>Joshua B.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>Office of Naval Research (US)</institution>
</funding-source>
<award-id>N00014-13-1-0333</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Tenenbaum</surname> <given-names>Joshua B.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>Research support was provided by the Center for Brains Minds and Machines (CBMM), funded by NSF STC award CCF-1231216 and by an ONR grant N00014-13-1-0333. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="4"/>
<page-count count="29"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-08-01</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Raw data files, including the subject responses, model predictions, experimental stimuli (both video and images), and experiment code are hosted on figshare at: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/ac5d3949f1b4f5917ec5" xlink:type="simple">https://figshare.com/s/ac5d3949f1b4f5917ec5</ext-link>. All other relevant data are within the paper.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>From a glance at liquid flowing into a glass (<xref ref-type="fig" rid="pcbi.1007210.g001">Fig 1A</xref>), you can infer a great deal: it is pouring rapidly, likely from a spout or small opening; it is not viscous; little will likely splash out, although if the angle of the glass were lowered slightly, perhaps much more might escape. Even young children can perceive and interact with liquids in motion (<xref ref-type="fig" rid="pcbi.1007210.g001">Fig 1B</xref>) in ways well beyond the capabilities of modern robots and artificial intelligence (AI) systems. How do people draw rich intuitions about liquids? What is the nature of people’s implicit knowledge of liquid dynamics? By what mechanisms is this knowledge applied to support their everyday interactions with liquids?</p>
<fig id="pcbi.1007210.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007210.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Humans are adept at reasoning about liquids.</title>
<p>(A) Dynamic fluids are very complex, yet ubiquitous in everyday scenes. (B) Humans–even young children–can reason about and interact with liquids effectively.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007210.g001" xlink:type="simple"/>
</fig>
<p>A growing body of evidence supports the view that humans have rich knowledge of everyday rigid body physics, which inform their predictions, inferences, and planning through a system of probabilistic inference [<xref ref-type="bibr" rid="pcbi.1007210.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1007210.ref007">7</xref>]. [<xref ref-type="bibr" rid="pcbi.1007210.ref003">3</xref>] proposed a cognitive mechanism for physical scene understanding based on “approximate probabilistic simulation”. They posited that objects’ spatial geometry and physical attributes, as well as certain laws of mechanics, are represented approximately, and support fast, efficient probabilistic judgments over short time scales via small numbers of simulations based on sampled estimates of the underlying world state. Their model of human cognition’s “intuitive physics engine” explained people’s physical predictions about stability and support relationships, and the motion of objects under gravity, across a wide range of rigid body scenes.</p>
<p>Here we explore how people understand physical scenes involving fluids moving around rigid objects, modeling their judgments as being driven by, in part, some form of approximate probabilistic simulations. We asked three related questions: How well can people predict the behavior of liquids in complex scenes? Can approximate simulation-based models account for people’s quantitative predictions across a range of scenes and different kinds of liquids? How do people’s uncertainty and computational resource limitations influence their judgments? We tackled these questions by probing people’s predictive judgments in two psychophysical experiments, and comparing human predictions to five different models, including four different kinds of simulation-based models varying in their computational complexity and physical assumptions, and a simple neural network alternative that approaches the problem as a pattern recognition task, using a deep convolutional network of the kind that has recently been successful in many computer vision applications [<xref ref-type="bibr" rid="pcbi.1007210.ref008">8</xref>], and which have also begun being studied in fluid simulation [<xref ref-type="bibr" rid="pcbi.1007210.ref009">9</xref>]. We examined how well people’s predictions matched each model, and how they co-varied with each model as a function of liquid properties, such as viscosity and stickiness.</p>
<p>Our experiments asked human participants to predict how a liquid would flow through and around complex arrangements of obstacles (<xref ref-type="fig" rid="pcbi.1007210.g002">Fig 2</xref>). We used two related tasks representative of different kinds of real-world judgments. In the first experiment (example stimuli shown in <xref ref-type="fig" rid="pcbi.1007210.g002">Fig 2A</xref>), participants were asked to predict what percentage of the liquid would end up on the right side of the divider. In the second experiment (example stimuli shown in <xref ref-type="fig" rid="pcbi.1007210.g002">Fig 2B</xref>), participants were asked what percentage would end up in the cup. In each experiment, we used computer-animated liquid stimuli with both water-like and honey-like properties. This allowed us to test both people’s abilities to predict flow for a range of different everyday liquids, and different models’ abilities to capture human intuitions across that range.</p>
<fig id="pcbi.1007210.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007210.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Experimental stimuli.</title>
<p>(A) Examples of water and honey stimuli from Experiment 1 after gravity was applied. (B) Examples of water and honey stimuli from Experiment 2. (Subjects only saw liquid in motion as part of the practice phase, and otherwise only saw a static image of the liquid in its starting position).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007210.g002" xlink:type="simple"/>
</fig>
<p>We compared people’s judgments to a spectrum of simulation-based computational models, as well as a neural network alternative. Our two most sophisticated models are particle simulation models inspired by approximations to physics-based models used in computer graphics, video games, and computational fluid dynamics: the “Intuitive Fluids Engine” (IFE) model, based on smooth particle hydrodynamics (<xref ref-type="fig" rid="pcbi.1007210.g003">Fig 3</xref>), is the most physically appropriate for our tasks, although it is also the most computationally complex. The other physics-based simulation account, “MarbleSim”, is similar but uses rigid body interactions between particles. We also consider a heuristic dynamic simulation model (“SimpleSim”) that is computationally simpler than either physics-based model, and an even simpler heuristic simulator (the “Gravity heuristic”) that is not based on a dynamic simulation at all, but only on the geometric principle that particles under gravity move downwards unless blocked by obstacles. All the dynamics-based models had degrees of freedom permitting them to make more water-like or honey-like predictions, and we explored to what extent varying these parameters could let these models capture people’s varying intuitions for these different kinds of liquids.</p>
<fig id="pcbi.1007210.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007210.g003</object-id>
<label>Fig 3</label>
<caption>
<title>SPH overview.</title>
<p>(A) How SPH approximates a fluid. For any location in the fluid, marked “X” on the diagram, particles in the local neighborhood are used to approximate the fluid’s, density, pressure, and dynamics at that point. The bell-shaped envelope depicts the strength of each neighbor’s influence on the approximation, which falls off with distance. (B) SPH simulations can be allocated more resources to achieve more precise approximations. In the second and third panels, more particles are allocated than in the first, which will result in more accurate and stable simulated fluid dynamics. (C) The rules by which particles interact can be varied to produce different qualitative fluids and materials. The first three panels show differences in splashing behavior as a function of viscosity. The fourth panel shows a non-Newtonian fluid that sticks to rigid surfaces (like honey).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007210.g003" xlink:type="simple"/>
</fig>
<p>To preview our results, we found that the more physically motivated particle-based simulation models provided the best single account of people’s predictions across all our experimental conditions. These models offer a general-purpose computational account of how people predict the motion of fluids on short time scales, in a similar spirit to [<xref ref-type="bibr" rid="pcbi.1007210.ref003">3</xref>]’s approximate probabilistic simulation models of intuitive physics for solid rigid bodies. The flowing liquids in our experimental scenes are much more complex, with far more degrees of freedom, than the rigid body systems on which [<xref ref-type="bibr" rid="pcbi.1007210.ref003">3</xref>]’s original “intuitive physics engine” work focused, but our “intuitive fluids engine” (IFE) model is developed in a similar spirit. The model is based on a commonly used method for simulating fluids, based on collections of dynamic, interacting particles, which is theoretically appealing on several grounds: It can capture a wide variety of materials by varying the specific interaction rules, it includes natural methods for adjusting the computational resource demands by varying the number of particles and complexity of their interactions, and it is relatively simple compared to alternative physical simulation methods. However, while real liquids are much more complex than rigid solids, a main contribution of the present paper is to demonstrate that highly approximate methods for simulating fluids may still be sufficient for the every-day kinds of predictions that people make, and that these approximations may still be cognitively and computationally plausible. Particles are an intuitive idea for simulating physical systems that is useful across a range of physical scales. Real fluids are composed of on the order of 10<sup>23</sup> particles (molecules) per kilogram. Physics, engineering, and graphics applications may use on the order of 10<sup>5</sup> up to 10<sup>7</sup> particles to achieve sufficiently realistic simulations [<xref ref-type="bibr" rid="pcbi.1007210.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1007210.ref011">11</xref>], depending on the specific application. Particle systems are also commonly employed in game engines that must support liquids and soft bodies alongside rigid bodies highly efficiently, to allow for user interactions in real time, even on small mobile devices. A small number of particles (10<sup>3</sup>-10<sup>4</sup>) can achieve sufficiently accurate and stable simulations for the purposes of many computer and mobile games. Here, by contrast, we show that human data is best-accounted with on the order of a hundred particles, 10<sup>2</sup>, or even fewer. Thus brains may have evolved representations for intuitive simulation of fluids similar to those used in contemporary computer simulations, but trading off accuracy for computational efficiency to an extreme that goes well beyond even the most severe short-cuts taken in conventional engineering applications.</p>
<sec id="sec002">
<title>Background of related research</title>
<p>We study the judgments people make about complex physical dynamics—liquid flow—in rich, realistically rendered scenes. This is very different from the highly simplified and abstract stimuli studied in some of the classic work on intuitive psychology in the cognitive psychology literature. Also, our focus on people’s ability to make sophisticated quantitative physical predictions in complex everyday scenes [<xref ref-type="bibr" rid="pcbi.1007210.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1007210.ref007">7</xref>] may appear incongruous next to classic studies of intuitive physics that emphasized ways in which people’s judgments about simple scenarios of objects in motion can be inconsistent with even very basic principles of Newtonian mechanics [<xref ref-type="bibr" rid="pcbi.1007210.ref012">12</xref>]. In part this is just a difference in emphasis: We are interested in explaining how people make successful predictions in complex everyday interactive settings, capacities that no robot, computer vision or AI system currently comes close to, rather than the mistakes people make in much simpler settings which are important for formal physics education but not necessarily for everyday physical interaction with the world. It is important to note, however, that even in previous work which emphasized the failures of people’s physical intuitions, it was often the case that a majority or plurality of participants’ judgments in many of the classic studies were consistent with Newtonian principles or approximate Newtonian simulations [<xref ref-type="bibr" rid="pcbi.1007210.ref012">12</xref>–<xref ref-type="bibr" rid="pcbi.1007210.ref015">15</xref>]; it is just the striking patterns of error which occurred in some cases that were presented as the main findings. With some exceptions [<xref ref-type="bibr" rid="pcbi.1007210.ref013">13</xref>], the classic literature often focused on textbook-style problems, typically presented with static, illustrated diagrams, and requiring participants to draw out future trajectories on paper. In contrast, recent literature has focused on more perceptual and perceptual-motor judgments, typically with rich dynamic displays and implicit inferences about what will happen next over short time scales (but see also, e.g. [<xref ref-type="bibr" rid="pcbi.1007210.ref016">16</xref>] for older examples). Recently, [<xref ref-type="bibr" rid="pcbi.1007210.ref005">5</xref>] even replicated [<xref ref-type="bibr" rid="pcbi.1007210.ref017">17</xref>]’s results showing that people’s drawings of predicted ballistic motion are often very inaccurate, but found that when those same participants were tasked with an interactive task of intercepting a moving object or releasing it to fall with a desired trajectory, their predictions were consistent with Newtonian dynamics. Most relevant to the present work, [<xref ref-type="bibr" rid="pcbi.1007210.ref014">14</xref>] found that subjects were better at judging the trajectory of water exiting a hose than a ball exiting a curved tube, hinting toward a crucial difference in physical predictions with fluids when people can access representations they have developed from their everyday interactions.</p>
<p>These and other findings [<xref ref-type="bibr" rid="pcbi.1007210.ref018">18</xref>] are beginning to coalesce on an explanation of why people’s physical intuitions appear to vary greatly in their accuracy: higher-level, deliberate reasoning about physics differs markedly from physical knowledge available to lower-level perceptual and motor systems. We speculate that higher-level systems, which are more flexible, not specific to physical reasoning, and based more on learning, may not benefit from the perceptual conditions and reward incentives that give rise to accurate physical knowledge in lower-level systems. Hence, our underlying hypothesis is that there are multiple systems supporting physical scene understanding, one of which is physical simulation. The purpose of this work is not to explore the boundaries between the different cognitive mechanisms for understanding physical systems, but rather to provide the first examination of mental simulation as an account of people’s ability to predict fluid flow in realistic situations, and to develop computational models of these simulation abilities that can capture to a reasonable first approximation how people might make these predictions.</p>
<p>Previous artificial intelligence research on reasoning about fluids has often pursued qualitative [<xref ref-type="bibr" rid="pcbi.1007210.ref019">19</xref>–<xref ref-type="bibr" rid="pcbi.1007210.ref023">23</xref>] or logical [<xref ref-type="bibr" rid="pcbi.1007210.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1007210.ref024">24</xref>] approaches, which are computationally efficient, and were developed prior to more recent hardware and algorithmic advances that support fluid simulation in real-time on mobile devices. Qualitative and logical models have been especially useful in situations that ask for explicit reasoning about a range of physical systems that people do not have much direct perceptual-motor experience with (such as thermodynamic or hydrodynamic systems or electrical networks). More recently, [<xref ref-type="bibr" rid="pcbi.1007210.ref020">20</xref>] developed a system of reasoning using first-order logic to draw conclusions about transferring liquid from one container to another in theoretical, two-dimensional scenarios. A key advantage of this approach is that it can be applied even when no numerical information about container geometries, relative distances, initial conditions or volume of the water, pouring speed, etc. is available. At the same time, however, it is unclear how these qualitative or logical models could account for the fine-grained quantitative judgments that participants make in the perceptual settings we study here. A final class of classic AI approaches to intuitive physics is analogical simulation, e.g., [<xref ref-type="bibr" rid="pcbi.1007210.ref025">25</xref>] devised an analogical particle-based fluid simulator, whose particles “communicate” with each other based on a set of eight rules (see <xref ref-type="fig" rid="pcbi.1007210.g004">Fig 4C</xref>). This approach combines some aspects of qualitative reasoning and quantitative, physics-engine-based simulations, and can be seen as a simpler, more heuristic version of physically based simulations. Most recently, deep neural networks have been proposed as a very different approach to making physical predictions on short time scales [<xref ref-type="bibr" rid="pcbi.1007210.ref026">26</xref>]. Both analogical simulation and neural network approaches can be applied to our tasks, and we evaluate simple versions of both on our experimental data, in addition to the more quantitative approximate simulation models we have focused on.</p>
<fig id="pcbi.1007210.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007210.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Gravity heuristic.</title>
<p>(A) Each panel depicts the path of a different particle. (B) Depiction of ‘momentum’ (left) for <italic>m</italic> = 0.1, and ‘global noise’ with <italic>g</italic> ≠ 0 (right), for a single particle that has chosen the “wrong” direction (going against gravity). See text for details. (C) Visualization of model from Gardin and Meltzer (1989). The simulated fluid (blue cubes) travels straight down under gravity, which is analogous to <italic>A</italic>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007210.g004" xlink:type="simple"/>
</fig>
<p>Proponents of qualitative approaches have also argued that solving problems that involve predicting fluid motion “to a high degree of accuracy involves computational fluid dynamics” and “it is quite unlikely that we are capable of performing such a prodigious feat mentally” [<xref ref-type="bibr" rid="pcbi.1007210.ref027">27</xref>]. But it is still unclear to what extent qualitative approaches can account for people’s sophisticated capacity for understanding and interacting with a wide variety of fluids and fluid-like materials in everyday settings. Furthermore, there are strong reasons to believe fluid simulation in the brain is not prohibitively expensive. Particle simulations can be run in parallel on GPUs, and as we argue here, the brain may be able to get by with just a coarse approximation for its purposes. Such simulations require computation that is on par (or less) than that used by today’s deep neural networks for computer vision [<xref ref-type="bibr" rid="pcbi.1007210.ref028">28</xref>], which are thought to be reasonable models of parts of biological visual processing [<xref ref-type="bibr" rid="pcbi.1007210.ref029">29</xref>]. In addition, [<xref ref-type="bibr" rid="pcbi.1007210.ref030">30</xref>]’s recent “interaction networks” and [<xref ref-type="bibr" rid="pcbi.1007210.ref031">31</xref>]’s “neural physics engine” models introduce neural networks which operate on objects and relations, and can learn very accurate quantitative physical simulators from data. In light of this, as well as the mounting evidence that human predictions and inferences about rigid physical objects is supported by simulation, we believe it is plausible that humans perform quantitative simulations, and not justifiable to dismiss this possibility out of hand.</p>
<p>Some psychological work in vision has looked at how humans perceive liquid viscosity, and has also been skeptical of the sort of computations we propose. For example, [<xref ref-type="bibr" rid="pcbi.1007210.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1007210.ref033">33</xref>] argue that perception of liquids relies on superficial cues, and show that people use certain statistical motion cues to predict viscosity. Furthermore, they argue that, “Given that the liquid image motion is a result of…complex physical processes, it seems practically impossible for the visual system to infer the underlying physical movements of particles from observed movements using inverse optics computations.” We do not disagree that surface appearance cues can be important in how people perceive liquid properties. However, such cues alone cannot directly explain how people can <italic>predict</italic> the motion of liquids, which is the focus of our experimental work.</p>
<p>The remainder of this paper is organized as follows. We first present our simulation model and the particle-based simulation method it uses, followed by several alternative models, including simpler simulation alternatives, as well as deep neural networks. We then present Experiment 1, which demonstrates that participants are coarsely able to predict the complex physics of both scenes involving low-viscosity liquids (e.g., water) and scenes involving high-viscosity liquids (e.g., honey), and explores the roles of damping (see Intuitive fluids engine) and uncertainty in our model’s correspondence to participants’ judgments. Experiment 2 then focuses more directly on people’s sensitivity to viscosity. Finally, we discuss implications of both experiments and directions for future work.</p>
</sec>
</sec>
<sec id="sec003" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec004">
<title>Ethics statement</title>
<p>All subjects gave informed consent and were treated according to protocol approved by MIT’s IRB (COUHES 1011004131).</p>
</sec>
<sec id="sec005">
<title>Models</title>
<sec id="sec006">
<title>Physical simulation</title>
<p><italic>Smoothed-particle hydrodynamics</italic>. Our computational cognitive model is built on a particle-based approach to simulating fluids. We define <italic>simulation</italic> as a process that applies fixed rules iteratively, over a sequence of steps, to approximately predict a system’s state over time. The specifics of the simulation algorithm in our model is not crucial to our theory; it implements the general principles that a fluid’s density is approximated as particles, that dynamics of the fluid correspond to the approximately Newtonian dynamics of the individual particles, that the fluid properties (e.g., viscosity, stickiness, etc.) are distinguished by different rules for how the particles interact, and that prediction precision and computational resource demands trade off by varying the numbers of particles, temporal resolution of the simulated time steps, and complexity of the particle dynamics and interaction rules.</p>
<p>There are various classes of fluid simulators one could choose, such as volumetric, particle-based, or more qualitative, which all have in common the property of a time step. Within each broad class, there are various possible implementations. As a starting point, here we choose to explore one particular particle-based method. One possible concern regarding the cognitive plausibility of fluid simulation models is the choice of time-step resolution. The particular implementation we use requires a relatively fine time step for stability (0.0002 seconds). (Specifically, we followed [<xref ref-type="bibr" rid="pcbi.1007210.ref034">34</xref>], with a few exceptions. First, we do not implement their boundary conditions, and instead use a rigid-body physics engine to handle particle-boundary interactions (as discussed below). Second, we use naive time-step updates for the particle states, rather than the more complex “leap-frog” scheme.) But others have implemented stable simulations with the same method using a substantially larger time step of 0.01 seconds, which is sufficient for real-time user interaction with hundreds of particles on a mobile device. Other particle-based simulation methods achieve stability with similarly large time steps [<xref ref-type="bibr" rid="pcbi.1007210.ref035">35</xref>].</p>
<p>Here we use smoothed-particle hydrodynamics (SPH) [<xref ref-type="bibr" rid="pcbi.1007210.ref036">36</xref>], a method from computational fluid dynamics, as the core algorithm for our model. SPH is used widely in graphics and video games for approximating the dynamics of many types of compressible and incompressible fluids (e.g., liquids and gases). The state of the fluid is represented by a set of particles at discrete time steps. Each particle carries information about a volume of fluid in a particular locality in space, including its position, velocity, density, pressure, and mass. On each simulation time step, the particles’ densities and pressures are computed, which are then used to update the accelerations, velocities and positions. A particle’s density is calculated by interpolating its neighbors’ densities, weighted by their distances, <inline-formula id="pcbi.1007210.e001"><alternatives><graphic id="pcbi.1007210.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007210.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:munderover></mml:mstyle> <mml:mi>m</mml:mi> <mml:mi>W</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>ρ</italic><sub><italic>i</italic></sub> is the density at particle <italic>i</italic>’s location, <italic>m</italic> is the mass of each particle, <italic>W</italic> is the kernel function, and <italic>r</italic><sub><italic>ij</italic></sub> is the distance between particles <italic>i</italic> and <italic>j</italic> (<xref ref-type="fig" rid="pcbi.1007210.g003">Fig 3A</xref>). The weighting is determined by <italic>W</italic>, which has a cutoff radius, <italic>h</italic>, beyond which particles have no influence. After computing particle <italic>i</italic>’s density, its pressure is updated, followed by particle-particle friction damping forces (analogous to viscosity). Its acceleration is a linear combination of the pressure and damping, the velocity update is proportional to the acceleration, and the position update is proportional to the velocity.</p>
<p>The precision of the liquid simulation can be adjusted by how many particles are used: with more particles, the simulated liquid’s movement is more closely matched to that of a real liquid (<xref ref-type="fig" rid="pcbi.1007210.g003">Fig 3B</xref>). But increasing the number of particles also increases the computational cost of the simulation, thus effecting a trade-off between efficiency and accuracy.</p>
<p><italic>Intuitive fluids engine</italic>. Our simulation-based cognitive model, which we term the “intuitive fluids engine” (IFE), is analogous to [<xref ref-type="bibr" rid="pcbi.1007210.ref003">3</xref>]’s intuitive physics engine (IPE), but is capable of predicting a fluid’s dynamics. It posits that when the brain observes the initial conditions of a physical scene that contains fluids, it instantiates a corresponding particle-based simulation (i.e., SPH) to predict future states of the scene. SPH comprises a family of related particle-based algorithms, and our implementation is similar to the most popular versions. Our model takes as input the configuration of the scene, including the solid elements and the fluid’s spatial state and material attributes, such as particle friction (<italic>α</italic>) and particle stickiness. The number of particles, <italic>N</italic>, that are instantiated can be varied as a means of adjusting the computational resources allocated to the simulation.</p>
<p>Inconsistency between people’s mental simulations and ground truth physics (or our model’s approximation thereof) may come from two different sources: perceptual uncertainty and incorrect physical assumptions. We explored both of these possibilities in our model. Our task required predicting how water will splash, falling under the full acceleration of gravity. Such splashes are energetic and happen on small time scales, and therefore it should be difficult for people to predict their details exactly. We suspect that people may somehow “slow down” the fluid in order to try to predict splashes in more detail, or may simply underestimate the potential energy of the liquid. We explored this possibility by incorporating a damping term into the IFE simulations. This term decreases the acceleration in each particle at every time step by a fixed proportion, <italic>ζ</italic>, of that particle’s current velocity. That is, <inline-formula id="pcbi.1007210.e002"><alternatives><graphic id="pcbi.1007210.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007210.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msubsup><mml:mi>a</mml:mi> <mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:mi>ζ</mml:mi> <mml:msubsup><mml:mi>v</mml:mi> <mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>i</italic> indexes particles, <italic>t</italic> indexes time, <italic>a</italic> is acceleration, <italic>f</italic> is the standard SPH forces (as given by equations 6 and 10 in [<xref ref-type="bibr" rid="pcbi.1007210.ref034">34</xref>]), <italic>ζ</italic> is the damping parameter, and <italic>v</italic> is the velocity. The result is a liquid that falls more slowly and splashes less energetically. Values of <italic>ζ</italic> were discretized to a spacing of 1.0 (i.e. we simulated 21 different values of <italic>ζ</italic> between <italic>ζ</italic> = 0 and <italic>ζ</italic> = 20).</p>
<p>In prior work [<xref ref-type="bibr" rid="pcbi.1007210.ref037">37</xref>], the probabilistic component of the model was based on perceptual uncertainty that randomly perturbed the initial position of the fluid and averaged the outcome over many random draws, but did not consider potentially incorrect physical assumptions. Here our model’s uncertainty is implemented by averaging the predictions made over a small range of damping values (where <italic>σ</italic> represents the size of the range). Thus, <italic>σ</italic> = 0 represents a deterministic IFE and <italic>σ</italic> ≠ 0 represents a probabilistic IFE. In preliminary analyses, we also found that adding uncertainty over the number of particles or the viscosity did not improve model fits, and its overall impact on model predictions was limited compared to the damping uncertainty proposed here. Note also that uncertainty in one parameter can often mimic the effects of uncertainty in other parameters, so damping uncertainty may also capture certain other sources of uncertainty that we have not explicitly tested. However, it may be fruitful in future work to further explore potential sources of uncertainty.</p>
<p>In our simulations of the stimuli, a liquid was initially positioned at the top of the scene, then moved downward under the force of gravity through a set of solid obstacles, and accumulated in one or more containers at the bottom. In Experiment 1, the bottom was divided into two equally sized basins, left and right. The model’s judgments, <italic>J</italic>, took values between 0 and 1, where 0 represented all liquid flowing into the left basin, and 1 represented all flowing into the right, i.e.: <italic>J</italic> = <italic>n</italic><sub><italic>right</italic></sub>/<italic>N</italic>, where <italic>N</italic> was the total number of particles, and <italic>n</italic><sub><italic>right</italic></sub> was the number that flowed into the right basin. In Experiment 2, there was a cup positioned at the bottom of the scene and <italic>J</italic> = 1 represented all the liquid accumulating inside the cup, while <italic>J</italic> &lt; 1 indicated some liquid collected in the bottom of the scene, outside of the cup. We also computed predictions from a “ground truth” model which did not include uncertainty or damping, and which used a single, deterministic simulation with a high number of particles and the correct viscosity, to predict the liquid behavior as accurately as possible. We emphasize, however, that what we call ground truth here is still an approximation to true physics, but should in theory be more accurate.</p>
<p>We created different SPH liquids with particle friction values that ranged from low (approximating water) to high (approximating honey). However, high viscosity Newtonian liquids behave differently than real honey, because they do not stick to surfaces (SPH particles collide with obstacle surfaces as inelastic spheres, while real fluids have much more complex boundary interactions). <xref ref-type="fig" rid="pcbi.1007210.g003">Fig 3C</xref> reports particle friction values, <italic>α</italic>, for various liquids. Our <italic>α</italic> corresponds to that in the artificial viscosity term of [<xref ref-type="bibr" rid="pcbi.1007210.ref038">38</xref>]. In order to model non-Newtonian, sticky liquids, we created a variant of the basic SPH liquid described so far, which implements particle stickiness by damping the normal and parallel components of velocity for particles that are in collision with solid obstacles (<xref ref-type="fig" rid="pcbi.1007210.g003">Fig 3C</xref>, rightmost panel), where ‘normal’ and ‘parallel’ are with respect to the obstacles surface. Due to the computational demands of running a wide range of fluid simulations, we only considered two sets of sticky parameter values, chosen by hand <italic>a priori</italic> to qualitatively match the visual behavior of the stimuli as closely as possible (details below). The values for the two stickiness parameters varied slightly between Experiment 1 and 2, because in Experiment 2, we made the honey somewhat less viscous than in Experiment 1. The space of possible sticky SPH liquids could in theory be further explored by varying the viscosity in combination with the two parameters controlling the velocity damping. In fact, the full parameter space could be considered as having five parameters (<italic>N</italic>, <italic>ζ</italic>, <italic>α</italic>, and normal and parallel components of damping during collision), but note that adding stickiness to low-viscosity fluids makes little physical sense, as the particles can slide easily past each other compared to more viscous fluids. The result would be largely the same as water, but there would be a layer of particles left stuck to obstacles. This behavior bears little resemblance to any known liquid. Thus, we deem the chosen fixed values to be a sufficient starting point, and distinguish sticky and non-sticky liquids as separate models for the purposes of presentation. All analysis below involving the sticky liquid (“Model 1 honey”; see below) will use these fixed parameter values for <italic>α</italic> and stickiness.</p>
<p>The above model parameters fall into two categories: those that control the fidelity of simulation (<italic>σ</italic>, <italic>N</italic>) and those that determine the physics of the liquid (<italic>ζ</italic>, <italic>α</italic>, particle stickiness). Settings for these parameters are discussed below, in Intuitive fluids engine parameters.</p>
<p><italic>MarbleSim</italic>. We explored another physically-based, but computationally less-demanding simulator, which was akin to representing the fluid as a handful of marbles. This simulator, which we call “MarbleSim”, is identical to the IFE in that it instantiates particles to represent the fluid. However, MarbleSim replaces the SPH forces with rigid-body interaction rules that are standard in rigid-body physics engines. This reduces computational complexity (and simulation time), because there are many fewer pairwise interactions to calculate between particles. In MarbleSim, each particle is represented as a solid sphere that collides inelastically with obstacles and other particles. The IFE simulator also instantiates particles as rigid spheres, but is different in that it ignores particle-particle collisions, allowing them to pass through each other. (Note, however, that the SPH forces will generally prevent particles from getting arbitrarily close.) Thus, particle-obstacle interactions are identical in both the IFE and MarbleSim, but particle-particle interactions in MarbleSim do not involve SPH forces–particles instead collide with each other as rigid bodies, similarly to the way marbles would. All collisions are perfectly inelastic (i.e. particles do not bounce) in both MarbleSim and the IFE, as this is most consistent with the behavior of liquids.</p>
<p>While particles in MarbleSim have a friction parameter that controls how easily they slide past each other when they touch, this is not analogous to the particle friction in the IFE (<italic>α</italic>). Furthermore, this parameter has very little effect on the simulation outcomes in our setting. In addition, stickiness, which we employ in SPH simulations, would make little physical sense in MarbleSim, since the particles easily roll past each other, rather than cohering together as a continuous substance. The result is qualitatively similar in behavior to simulations without stickiness, but varies in outcome because of the layer of stuck particles “left behind” on the obstacles. Thus, similar to the case of sticky, low-viscosity liquids addressed above, a “sticky marble” simulation bears little resemblance to the behavior of either water or honey. However, MarbleSim was still allowed to vary along two dimensions, <italic>N</italic> and <italic>ζ</italic>, which exactly match the corresponding parameters in the IFE, and were allowed to vary along the same ranges of values. Also, we found that performance of the model improved when adding uncertainty over damping, as we did with the IFE. The results reported below use the same value for <italic>σ</italic> as the uncertain IFE.</p>
</sec>
<sec id="sec007">
<title>Heuristic simulation</title>
<p><italic>SimpleSim</italic>. We also explored a simpler kind of dynamic simulation, which is comparable to the analogical models of [<xref ref-type="bibr" rid="pcbi.1007210.ref025">25</xref>] in the way it uses a set of deterministic, recursive heuristics to form predictions. These heuristic rules are inspired by physics but are not in any formal correspondence to physical dynamics. We add to these rules notions of noise and momentum to produce a range of different “fluids”. This model class, which we call “SimpleSim”, instantiates equally-spaced “particles” along the midline of the liquid’s starting position and generates a path straight downward (in the direction of gravity). In the model’s simplest form, when an obstacle is encountered, the path continues along the obstacle surface until it can go straight down again. The direction to travel along the obstacle’s surface (left or right) is chosen to follow the local gradient downward, with gravity (see <xref ref-type="fig" rid="pcbi.1007210.g004">Fig 4A</xref>). For example, if the polygon edge that the particle collides with slopes down and to the right, the particle trajectory continues down and to the right along the surface. More technically, a particle trajectory consists of a series of line segments. Each time the particle changes direction, we solve linear equations to find all intersections between the line representing the new particle trajectory and all obstacle edges. The next collision point for the particle is detected by finding the intersection with the highest <italic>y</italic> value. We also detect at what point the current trajectory will cause the particle to lose contact with the obstacle, and begin a new trajectory segment at that point (i.e. either to drop straight down at the obstacle’s most extreme left or right point or to continue to “hug” the obstacle’s surface).</p>
<p>However, the model also includes two degrees of freedom that allow it to deviate from this basic behavior. The first parameter is a ‘global’ noise parameter, <italic>g</italic> (ranging from 0 to 1), that controls the probability of choosing the “wrong” direction when a particle encounters an obstacle, such that the particle initially travels against gravity. For example, if the colliding edge has a negative slope (down and to the right), the model may randomly choose to continue up and to the left instead of down and to the right (see <xref ref-type="fig" rid="pcbi.1007210.g004">Fig 4B</xref>, right panel). A particle makes this decision about whether to initially travel with or against gravity once per obstacle, upon initial collision, and then continues in that same direction until it reaches the obstacle’s edge. The second parameter, <italic>m</italic> (ranging from 0 to 0.2), is somewhat akin to momentum: a particle does not immediately drop straight down upon reaching the edge of an obstacle. Rather, it continues for a fixed distance in the same direction it was traveling, before dropping straight down (see <xref ref-type="fig" rid="pcbi.1007210.g004">Fig 4B</xref>, left panel). The parameter value specifies the magnitude of this distance. Intuitively, when <italic>m</italic> is smaller, the model should make predictions closer to honey, which clings more to the obstacles, and when it is larger, the model should make predictions closer to water, which sloshes off with some momentum. Both parameters were discretized to 11 evenly-spaced values, and thus we calculated predictions for 121 total parameter settings. The value of <italic>m</italic> corresponded to the extra distance (in meters) traveled in the horizontal direction (orthogonal to gravity). We chose <italic>m</italic> to correspond to the horizontal distance, instead of absolute distance, in order to mirror real Newtonian physics, which separates vector quantities, such as momentum, into orthogonal components. Finally, we found that adding additional uncertainty over <italic>m</italic>, in the same way as we did for the IFE and MarbleSim, modestly improved fits with the data. See <xref ref-type="sec" rid="sec014">Results</xref> for details.</p>
<p>The model’s predictions were calculated by counting the number of “particles” that end up on each side of the divider (or in the cup, for Experiment 2), as in the simulation models. The model reported here used 100 particles, but the results do not depend crucially on the exact number of particles, as the particles’ trajectories are completely independent and do not interfere with each other.</p>
</sec>
<sec id="sec008">
<title>Models without dynamics</title>
<p>We contrasted the simulation-based models above with two alternatives that did not explicitly seek to simulate dynamic fluid motion: one (the “gravity heuristic”) that is still in a sense a simulation model, but which runs a purely geometric simulation, embodying the heuristic notion that gravity pulls all liquid particles down unless an object blocks their path; and another that used a deep convolutional neural network [<xref ref-type="bibr" rid="pcbi.1007210.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1007210.ref039">39</xref>] trained on thousands of examples similar to our experimental test conditions to predict the task target as a pattern recognition problem.</p>
<p>Both of these alternatives are highly specialized to the particular task studied, and are unlikely to generalize to liquid motion in even slightly different conditions (e.g., different obstacle arrangements, different liquid properties), in contrast to the models above which ought to generalize whenever the underlying physics being modeled is shared. However, they represent reasonable and well-known competing perspectives on the general mechanisms of human perception and cognition [<xref ref-type="bibr" rid="pcbi.1007210.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1007210.ref041">41</xref>], and offer advantages such as simplicity of computation and straightforward statements about the learning processes.</p>
<p><italic>Gravity heuristic</italic>. Formally this model corresponds simply to the SimpleSim model with <italic>m</italic> = 0 and <italic>g</italic> = 0. With these parameters set to null values, the model simply follows the geometry of the obstacles, and it makes the same predictions regardless of the liquid type. Thus, it may be considered a simple, geometric heuristic, formalizing the prediction that particles should continue to “go down” under gravity, without penetrating obstacles or showing any momentum and the dynamics that come from that. We include this model in part because of its connection to much earlier work on analog representations for intuitive physics (see <xref ref-type="fig" rid="pcbi.1007210.g004">Fig 4</xref>). We also consider it to be an informative baseline comparison, as it is one of the simplest possible models that can perform this task.</p>
<p><italic>Convolutional networks</italic>. As an alternative to explicit physical representations of liquid dynamics, we also tested the possibility that people’s responses might be based on a simple mapping from visual inputs to physical outcomes, using a deep learning model, in a similar spirit to models of bottom-up visual cortical processing [<xref ref-type="bibr" rid="pcbi.1007210.ref029">29</xref>]. We replaced the top layer of a widely used convolutional neural network [<xref ref-type="bibr" rid="pcbi.1007210.ref008">8</xref>], pre-trained on a very large collection of images, with a linear output layer, and performed backpropagation [<xref ref-type="bibr" rid="pcbi.1007210.ref039">39</xref>] until convergence to learn a regression from images to labels in a supervised fashion. We trained separate networks for water and honey outcomes in each experiment, and refer to each as “water ConvNet” and “honey ConvNet”, respectively. The dataset for the water ConvNet in each experiment consisted of 10,000 randomly generated scenes, with target values in the range [0, 1] that corresponded to the proportion of water that went to the right bin in Experiment 1, or in the cup in Experiment 2 (as determined by a deterministic ground truth simulation with <italic>N</italic> = 100). The network was not shown any intermediate fluid positions. The honey ConvNet in each experiment was trained by fine-tuning the water model using ∼2500 training examples. All networks were trained in layer-wise stages to minimize overfitting, freezing all layers below layer <italic>n</italic>, for <italic>n</italic> = [<italic>N</italic>, …, 1], where <italic>N</italic> is the total number of layers. That is, the first training stage freezes all but the last layer, the second stage freezes all but the last two layers, etc. In addition, we augmented our training data with versions of the original images zoomed by random amounts.</p>
</sec>
</sec>
<sec id="sec009">
<title>Experiment 1</title>
<sec id="sec010">
<title>Participants</title>
<p>All participants (N = 65) were recruited from MIT Brain and Cognitive Sciences’ human participants database (composed of roughly half MIT students and employees, and half local community members). All gave informed consent, were treated according to protocol approved by MIT’s IRB, and were compensated $10/h for participation. All experimental sessions were one hour long, and each participant ran in one session in one experiment. All had normal or corrected-to-normal vision. Stimuli were presented on a liquid-crystal display, which participants free-viewed from a distance of 0.5-0.75 m. They indicated their responses by depressing a key on the keyboard, or by adjusting the computer mouse and then clicking to lock in their choice.</p>
</sec>
<sec id="sec011">
<title>Stimuli and procedure</title>
<p>In order to test people’s ability to predict the behavior of a liquid, participants were presented with 120 virtual scenes, simulated in 3 dimensions (including depth into the screen), with a simulated size of 1.0 m x 1.50 m. The scenes depicted a cylindrical volume (diameter equal to 0.148 m) of liquid positioned above a randomly generated obstacle course composed of fixed, solid objects and asked to predict what fraction of the liquid would flow into each basin below the obstacles under gravity. Participants were randomly assigned to one of two groups: one group was presented with a low-viscosity, water-like liquid (Experiment 1a), the other with a high-viscosity, honey-like liquid (Experiment 1b). The scenes’ geometries were automatically generated as described below. During practice trials (see below), participants viewed videos of the simulated liquid falling under gravity, rendered at 30 Hz using Blender’s (<ext-link ext-link-type="uri" xlink:href="http://www.blender.org" xlink:type="simple">www.blender.org</ext-link>) Cycles ray-tracer. All moving liquid videos were simulated using Blender’s Lattice-Boltzmann liquid simulator (see <xref ref-type="supplementary-material" rid="pcbi.1007210.s001">S1 Appendix</xref> for simulation details). Lattice-Boltzmann methods are very different from SPH, a choice intended to eliminate the possibility that our model would only capture people’s judgments because the scenes were generated using a similar fluid simulation algorithm. All participants were presented with the same, randomly shuffled scene order. The 120 trials were divided into three blocks of 40, with a short break in between. Both Experiments 1a and 1b included a practice and test phase.</p>
<p>On each trial (in both practice and test phases), participants viewed an image of the scene, with the liquid in its starting position. They were instructed to predict the proportion of liquid that would end up on each side of the divider (see the dark wedge at the bottom of the stimuli in <xref ref-type="fig" rid="pcbi.1007210.g002">Fig 2A</xref>), and to indicate their judgment by moving a virtual slider with the mouse left or right, then pressing ENTER to submit. [See online supplementary material for stimuli videos.]</p>
<p>During the practice phase, comprised of 15 trials, participants received visual feedback after submitting their response on each trial. During feedback, subjects saw a rendered video of the liquid flowing through the obstacles (4 seconds for water and 10 seconds for honey; made in Blender, as described above). The practice phase was designed to familiarize participants with the characteristics of the liquid and the response procedure.</p>
<p><italic>Random scene generation</italic>. The obstacles in the test scenes were generated automatically by first dividing a plane into polygonal cells using 2D Voronoi tessellation, then selecting a random subset as solid obstacles such that the total area approximately summed to 0.12 m<sup>2</sup>. Coarse SPH simulations were run to filter out those scenes in which liquid particles remained trapped in obstacle concavities or had little interaction with the obstacles.</p>
<p><italic>Intuitive fluids engine parameters</italic>. We partition the parameter space into three distinct classes of liquids–non-sticky (“water”), sticky (“Model 1 honey”), and highly-damped (“Model 2 honey”; see below). The water and honey classes correspond to the liquids in Experiments 1a and 1b, respectively. For the water IFE we explored particle friction values of <italic>α</italic> = {0.01, 0.2, 2}. The Model 1 honey IFE used <italic>α</italic> = 1.25 for Experiment 1 and <italic>α</italic> = 2 for Experiment 2. (As mentioned above, the Model 1 honey liquids also involved two extra parameters controlling stickiness, which were fixed <italic>a priori</italic> to qualitatively match the stimuli in honey trials of each experiment, respectively.) In total, the IFE has six sub-models: water, Model 1 honey, Model 2 honey, which could all be either deterministic or uncertain (by making <italic>σ</italic> zero or non-zero). However, we only report results from the uncertain versions of these three fluid types, as they had slightly higher correlations with the data across most of parameter space, but maintained the same qualitative trends.</p>
<p>The number of particles used to represent the liquid was varied from 1 to 100. However, with fewer than 15 particles in our settings, the assumptions of SPH are violated to an extent that it cannot be considered to be a fluid simulation. We explored simulations with fewer particles in order to compare their predictions with people, and found them to have poor fits to the data, and therefore we will not report those results. With greater than 100 particles, non-sticky simulations converge to very similar outcomes. The model’s damping parameter was varied from <italic>ζ</italic> = 0 (no damping) to <italic>ζ</italic> = 20 (high damping). The value of <italic>σ</italic> was 0 (i.e. no uncertainty) for the deterministic IFE, and 4 for the uncertain IFE (but results were similar for other values). To compute predictions in the uncertain IFE for a particular value of damping, <italic>ζ</italic>, deterministic simulation outcomes were averaged over damping values in the range [<italic>ζ</italic> − <italic>σ</italic>, <italic>ζ</italic> + <italic>σ</italic>]. Each model (deterministic and uncertain IFEs) made a single prediction for each scene and unique setting of fluid parameter values (<italic>N</italic>, <italic>α</italic> and particle stickiness, <italic>ζ</italic>). The ground truth models corresponded to <italic>ζ</italic> = 0, <italic>σ</italic> = 0, and <italic>N</italic> = 100 (for honey) or <italic>N</italic> = 200 (for water). The number of particles for honey ground truth was fewer than for water because as the number of particles is increased, the fluid behaves as if it were non-sticky. This is because only the particles in contact with an obstacle have modified behavior, and so their impact on the overall dynamics of the fluid diminishes as they become a smaller proportion of the total number of particles. We chose <italic>N</italic> = 100 for ground truth, because during our search for a liquid that qualitatively matched honey from each of the experiments, this is the number of particles we used. Thus, it is the closest match we could find to the behavior of the stimulus fluid. Further work should be dedicated to developing improved simulation methods to more accurately capture the dynamics of sticky liquids, in a way that is independent of number of particles.</p>
<p>As mentioned above, we explored two alternative models to account for judgments about honey stimuli. The first (Model 1) simulated honey as a high particle-friction and particle-stickiness fluid, as described above. The second alternative (Model 2) simply corresponded to the water IFE with high damping. Thus, Model 2 can be considered a subspace of the water IFE. It was found empirically that these two models predict similar outcomes in our tasks, and so we consider each as an alternative cognitive hypothesis. Model 2 honey may be especially appealing from the standpoint of representational simplicity, as it replaces multiple parameters related to stickiness and viscosity with a single parameter, damping.</p>
<p>Note, we did not consider mass to be a free parameter. We set density according to true physical values (approximately), and these values were fixed a priori for water and honey, respectively. In the model, each particle is assigned a mass, but the choice of this value only determines the scaling: giving the particles larger mass means that the equilibrium distance between particles will increase to compensate, yielding fewer particles per area.</p>
<p>We ran simulations to exhaustively explore all combinations of parameter values across the full range of values considered for each parameter. To avoid over-fitting, in general, we chose parameters based on Experiment 1, and fixed them to these values for Experiment 2 (see <xref ref-type="table" rid="pcbi.1007210.t001">Table 1</xref>). Further, we fixed our parameters in a stratified manner, starting by finding the best value for <italic>N</italic>, then fixing <italic>N</italic> to this value while searching for the best values for <italic>α</italic> and <italic>ζ</italic>. More specifically, to choose <italic>N</italic>, we took the average between the best-fitting number of particles for Experiment 1 water trials (with the water IFE) and Experiment 1 honey trials (with the Model 1 honey IFE), which was <italic>N</italic> = 50. (Best-fitting values for water and honey trials independently were <italic>N</italic> = 25 and <italic>N</italic> = 75, respectively, but fits were similar across the range from <italic>N</italic> = 25 to <italic>N</italic> = 75 in both models.) With <italic>N</italic> fixed, we then found the best-fit <italic>α</italic> value for the water IFE on Experiment 1a responses. Next, with <italic>N</italic> and <italic>α</italic> fixed, we found the best <italic>ζ</italic> for the water IFE on Experiment 1a responses. All IFE models, across both experiments, shared the same <italic>N</italic>, as found above, and the water IFE in Experiment 2 inherited its parameters from Experiment 1. Model 1 honey inherited <italic>N</italic> and <italic>ζ</italic> from the water IFE, but used the <italic>α</italic> that was appropriate for honey. Model 2 honey inherited <italic>N</italic> and <italic>α</italic> from the water IFE, but fit <italic>ζ</italic> using responses from Experiment 1b. The final parameter choices for the water IFE were <italic>N</italic> = 50, <italic>α</italic> = 0.01, and <italic>ζ</italic> = 5. The damping value for Model 2 honey was <italic>ζ</italic> = 11. Note that <italic>α</italic> = 0.01 was also the most physically accurate value of <italic>α</italic> for water. Finally, also note that there was no <italic>α</italic> value to fit for Model 1 honey, as it was not allowed to vary.</p>
<table-wrap id="pcbi.1007210.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007210.t001</object-id>
<label>Table 1</label>
<caption>
<title>Summary of the model parameters used in Figs <xref ref-type="fig" rid="pcbi.1007210.g007">7</xref> and <xref ref-type="fig" rid="pcbi.1007210.g008">8</xref>.</title>
<p>The same set of parameters was used to model both experiments (with the exception of <italic>α</italic> in IFE honey models, which was fixed a priori).</p>
</caption>
<alternatives>
<graphic id="pcbi.1007210.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007210.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">Model</th>
<th align="right">N</th>
<th align="right"><italic>α</italic></th>
<th align="right"><italic>ζ</italic></th>
<th align="right"><italic>σ</italic></th>
<th align="right">sticky</th>
<th align="right"><italic>m</italic></th>
<th align="right"><italic>g</italic></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Water IFE</td>
<td align="right">50</td>
<td align="right">0.01</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">No</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
</tr>
<tr>
<td align="left">Honey 1 IFE</td>
<td align="right">50</td>
<td align="right">1.25(Exp. 1)/2.0(Exp. 2)</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">Yes</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
</tr>
<tr>
<td align="left">Honey 2 IFE</td>
<td align="right">50</td>
<td align="right">1.25(Exp. 1)/2.0(Exp. 2)</td>
<td align="right">11</td>
<td align="right">4</td>
<td align="right">No</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
</tr>
<tr>
<td align="left">Water MarbleSim</td>
<td align="right">25</td>
<td align="right">N/A</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">No</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
</tr>
<tr>
<td align="left">Honey MarbleSim</td>
<td align="right">75</td>
<td align="right">N/A</td>
<td align="right">6</td>
<td align="right">4</td>
<td align="right">No</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
</tr>
<tr>
<td align="left">Ground truth water</td>
<td align="right">200</td>
<td align="right">0.01</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">No</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
</tr>
<tr>
<td align="left">Ground truth honey</td>
<td align="right">100</td>
<td align="right">1.25(Exp. 1)/2.0(Exp. 2)</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">Yes</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
</tr>
<tr>
<td align="left">Water SimpleSim</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
<td align="right">4</td>
<td align="right">N/A</td>
<td align="right">0.1</td>
<td align="right">0.1</td>
</tr>
<tr>
<td align="left">Honey SimpleSim</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
<td align="right">4</td>
<td align="right">N/A</td>
<td align="right">0.04</td>
<td align="right">0.0</td>
</tr>
<tr>
<td align="left">Gravity heuristic</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
</tr>
<tr>
<td align="left">ConvNet</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
<td align="right">N/A</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
</sec>
<sec id="sec012">
<title>Experiment 2</title>
<p>For some model parameter settings in Experiment 1, both water and honey models made similar predictions, which limited the model’s ability to assess people’s sensitivity to viscosity and stickiness. In Experiment 2, we designed new stimuli to elicit highly different outcomes between low- and high-particle-friction and stickiness IFE simulations. See <xref ref-type="fig" rid="pcbi.1007210.g005">Fig 5</xref> for examples of Experiment 2’s more strongly contrastive stimuli.</p>
<fig id="pcbi.1007210.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007210.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Example scenes from Experiment 2 for which water and honey trials had very different outcomes.</title>
<p>(A) A scene in which much more honey flowed into the cup than water. (B) A scene in which much more water flowed into the cup than honey.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007210.g005" xlink:type="simple"/>
</fig>
<sec id="sec013">
<title>Stimuli and procedure</title>
<p>We generated new random scenes and automatically selected scenes for which the model’s predictions for honey versus water would be anti-correlated. This would allow us to more directly examine whether our model could explain people’s sensitivities to the different liquids’ physical properties. We also modified the task from Experiment 1, by removing the basin divider and instead placing a cup at the bottom of the scene (see <xref ref-type="fig" rid="pcbi.1007210.g002">Fig 2B</xref>). Participants judged what percent of the liquid would end up in the cup, which was a third of the width of the scene, and could be at one of five evenly-spaced locations along the bottom. By varying the cup location and making the width less than the basins in Experiment 1, we could more easily create strongly anti-correlated scenes. Each scene consisted of 3 obstacles, which could either be an equilateral triangle, square, or circle, and varied randomly in size (within a specified range) and position.</p>
<p>All 21 participants saw 120 trials (60 water and 60 honey). Each participant saw the same 60 scenes for each liquid type, but all honey trials were mirrored with respect to water, to ensure they weren’t recognized. The honey stimulus in Experiment 2 had a lower viscosity than that of Experiment 1. (Experiment 1 honey was meant to be as different as possible from water, to try to elicit different participant responses. Experiment 2’s honey was designed to be more typical of honey encountered in everyday situations, to draw on prior knowledge of how it behaves.) The honey model whose simulation parameters were most closely matched to the stimulus liquid also had a lower viscosity (<italic>α</italic> = 1.25) than that of Experiment 1 (<italic>α</italic> = 2).</p>
</sec>
</sec>
</sec>
<sec id="sec014" sec-type="results">
<title>Results</title>
<sec id="sec015">
<title>Experiment 1</title>
<p>We first asked: How accurate are participants’ predictions about flowing liquids? In all analyses we calculated the means across participants’ judgments for each scene, and estimated Pearson correlations between those mean judgments and each model’s predictions as a measure of how well the model fit the human data.</p>
<p>In Experiment 1a, the correlations between the mean participant responses and the water and honey ground truth models were <italic>r</italic> = 0.76[0.74, 0.78] and <italic>r</italic> = 0.83[0.81, 0.84], respectively (the interval in brackets is a 95% CI, estimated by a bootstrap analysis with 10, 000 resamples [<xref ref-type="bibr" rid="pcbi.1007210.ref042">42</xref>]). This is somewhat surprising because one would expect water simulations to better account for judgments about water than honey simulations (see Experiment 2). By contrast, Experiment 1b showed that participants’ judgments about water and honey were best-explained by their corresponding ground truth models: <italic>r</italic> = 0.48[0.43, 0.53] for water ground truth and <italic>r</italic> = 0.73[0.69, 0.76] for honey ground truth.</p>
<p>Importantly, our results show a significant correlation (two-sample Kolmogorov-Smirnov <italic>p</italic> &lt; .0001) between individual participants’ judgments and the ground truth in all our experiments (see <xref ref-type="fig" rid="pcbi.1007210.g006">Fig 6</xref>). The null hypothesis was generated by drawing random samples from a beta distribution fit to participant data, which captured the variance of their judgments but not any stimulus-specific structure. This result shows that participants cannot simply do well by chance.</p>
<fig id="pcbi.1007210.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007210.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Distribution of individual participant correlations with ground truth (dark colors) versus the null hypothesis (light colors).</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007210.g006" xlink:type="simple"/>
</fig>
<p>Next we asked: How well are participants’ judgments explained by the IFE models versus alternative models? Overall, the results show that the IFE did well in explaining the data, but we also found that the honey IFEs (and honey ground truth) did moderately well in accounting for responses on water trials. Thus, from Experiment 1 alone, it is not clear to what extent people were sensitive to the different fluid properties. In addition, our alternative models also performed moderately well in some cases, compared to the IFE. Experiment 2 addresses both of these issues. Experiment 1 scenes were not designed to guarantee that honey and water resulted in very different outcomes, and thus responses for water versus honey in many scenes <italic>should</italic> be similar. In Experiment 2, we design scenes for which water and honey simulations have maximally different outcomes, and therefore, if people’s predictions are sensitive to different liquid properties, we should be able to detect this. Furthermore, the Experiment 2 scenes are a more stringent test of the alternative models, whose physics do not as closely match the ground truths for water or honey as the IFE’s does.</p>
<p>Correlations between the data in Experiment 1a and uncertain IFE were <italic>r</italic> = 0.92[0.91, 0.93], <italic>r</italic> = 0.76[0.74, 0.78], and <italic>r</italic> = 0.81[0.79, 0.82] for water, Model 1 honey, and Model 2 honey, respectively. Experiment 1b had correlations of <italic>r</italic> = 0.74[0.71, 0.78], <italic>r</italic> = 0.79[0.76, 0.83], and <italic>r</italic> = 0.86[0.83, 0.88] for water, Model 1 honey, and Model 2 honey, respectively. These correlations are summarized in <xref ref-type="fig" rid="pcbi.1007210.g007">Fig 7</xref>. <xref ref-type="fig" rid="pcbi.1007210.g008">Fig 8</xref> summarizes how IFE fits vary across different values of <italic>ζ</italic> and <italic>α</italic>.</p>
<fig id="pcbi.1007210.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007210.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Correlations between mean participant data and all models that make different predictions for water versus honey trials (in both experiments).</title>
<p>A and B show the IFE models and ground truth, while C and D show the alternative models (ConvNet, MarbleSim, and SimpleSim). The alternative models exclude the gravity heuristic, as it makes the same predictions for both water and honey. In Experiment 2, the bars with small or negative values (in B) establish that participants’ responses are sensitive to the stickiness and viscosity of a liquid. Model 1 and Model 2 refer to the two different versions of IFE honey. Model 1 simulates honey as a fluid with high particle friction and stickiness, while Model 2 simulates honey as water with high damping. Summary of parameters for all models are found in <xref ref-type="table" rid="pcbi.1007210.t001">Table 1</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007210.g007" xlink:type="simple"/>
</fig>
<fig id="pcbi.1007210.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007210.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Uncertain IFE performance across a range of <italic>α</italic> and damping values at 50 particles.</title>
<p>Results are qualitatively similar to the deterministic IFE, but with higher correlations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007210.g008" xlink:type="simple"/>
</fig>
<p>The IFE outperformed all alternative models in Experiment 1a, but was slightly outperformed by MarbleSim in Experiment 1b. MarbleSim was also highly competitive in water trials. SimpleSim was somewhat competitive in water trials and highly competitive in honey trials, and the gravity heuristic was competitive on honey trials, but less competitive in water trials. <xref ref-type="table" rid="pcbi.1007210.t002">Table 2</xref> summarizes the numerical results of the alternative models, which are also depicted visually in <xref ref-type="fig" rid="pcbi.1007210.g007">Fig 7C</xref> (with the exception of the gravity heuristic, which is shown in <xref ref-type="fig" rid="pcbi.1007210.g009">Fig 9</xref>). <xref ref-type="table" rid="pcbi.1007210.t002">Table 2</xref> also summarizes the agreements between alternative models and the ground truth predictions for each liquid.</p>
<fig id="pcbi.1007210.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007210.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Comparison of the best-fitting versions of the IFE model and alternative models.</title>
<p>All bars for the IFE, MarbleSim, SimpleSim, and ConvNet are identical to their corresponding bars in <xref ref-type="fig" rid="pcbi.1007210.g007">Fig 7</xref>, and their values are given in <xref ref-type="table" rid="pcbi.1007210.t001">Table 1</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007210.g009" xlink:type="simple"/>
</fig>
<table-wrap id="pcbi.1007210.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007210.t002</object-id>
<label>Table 2</label>
<caption>
<title>Correlations between alternative models and subject data and the ground truth predictions.</title>
</caption>
<alternatives>
<graphic id="pcbi.1007210.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007210.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" colspan="5">Exp. 1</th>
</tr>
<tr>
<th align="left"/>
<th align="right">Data (water trials)</th>
<th align="right">Data (honey trials)</th>
<th align="right">Ground (water)</th>
<th align="right">Ground (honey)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Water ConvNet</td>
<td align="right">0.76[0.74, 0.78]</td>
<td align="right">0.52[0.46, 0.56]</td>
<td align="char" char=".">0.91</td>
<td align="char" char=".">0.69</td>
</tr>
<tr>
<td align="left">Honey ConvNet</td>
<td align="right">0.85[0.83, 0.86]</td>
<td align="right">0.70[0.65, 0.74]</td>
<td align="char" char=".">0.76</td>
<td align="char" char=".">0.82</td>
</tr>
<tr>
<td align="left">Water SimpleSim</td>
<td align="right">0.75[0.73, 0.77]</td>
<td align="right">0.66[0.62, 0.71]</td>
<td align="char" char=".">0.56</td>
<td align="char" char=".">0.60</td>
</tr>
<tr>
<td align="left">Honey SimpleSim</td>
<td align="right">0.68[0.66, 0.70]</td>
<td align="right">0.76[0.73, 0.80]</td>
<td align="char" char=".">0.38</td>
<td align="char" char=".">0.60</td>
</tr>
<tr>
<td align="left">Water MarbleSim</td>
<td align="right">0.88[0.86, 0.89]</td>
<td align="right">0.76[0.72, 0.79]</td>
<td align="char" char=".">0.79</td>
<td align="char" char=".">0.78</td>
</tr>
<tr>
<td align="left">Honey MarbleSim</td>
<td align="right">0.83[0.81, 0.84]</td>
<td align="right">0.84[0.81, 0.87]</td>
<td align="char" char=".">0.60</td>
<td align="char" char=".">0.78</td>
</tr>
<tr>
<td align="left">Gravity heuristic</td>
<td align="right">0.58[0.55, 0.60]</td>
<td align="right">0.73[0.70, 0.77]</td>
<td align="char" char=".">0.19</td>
<td align="char" char=".">0.53</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>MarbleSim’s best-fitting parameter values for water and honey trials respectively were (<italic>N</italic> = 25, <italic>ζ</italic> = 2) and (<italic>N</italic> = 75, <italic>ζ</italic> = 6). Both <italic>N</italic> and <italic>ζ</italic> were fit independently for water versus honey trials. We will refer to these best-fit parameter values as “water MarbleSim” and “honey MarbleSim”, respectively. SimpleSim’s best-fitting parameter values for water and honey trials respectively were (<italic>g</italic> = 0.1, <italic>m</italic> = 0.1) and (<italic>g</italic> = 0.0, <italic>m</italic> = 0.04). Both <italic>g</italic> and <italic>m</italic> were fit independently for water versus honey trials. We will refer to these best-fit parameter values as “water SimpleSim” and “honey SimpleSim”, respectively. To implement SimpleSim’s uncertainty over <italic>m</italic>, which was analogous to the IFE’s and MarbleSim’s uncertainty over <italic>ζ</italic>, we average model predictions over the range [<italic>m</italic> − <italic>σ</italic><sub><italic>m</italic></sub>, <italic>m</italic> + <italic>σ</italic><sub><italic>m</italic></sub>], where <italic>σ</italic><sub><italic>m</italic></sub>/(<italic>m</italic><sub><italic>max</italic></sub> − <italic>m</italic><sub><italic>min</italic></sub>) = <italic>σ</italic>/(<italic>ζ</italic><sub><italic>max</italic></sub> − <italic>ζ</italic><sub><italic>min</italic></sub>), and max and min represent the maximum and minimum values explored for those parameters. Thus, since <italic>m</italic><sub><italic>min</italic></sub> = 0, <italic>m</italic><sub><italic>max</italic></sub> = 0.2, <italic>ζ</italic><sub><italic>min</italic></sub> = 0, <italic>ζ</italic><sub><italic>max</italic></sub> = 20, and <italic>σ</italic> = 4, then <italic>σ</italic><sub><italic>m</italic></sub> = 0.04. Here, we only report results for this value of <italic>σ</italic><sub><italic>m</italic></sub>.</p>
<p>The ConvNet was initially trained on the Experiment 1a ground truth (“water ConvNet”), and a separate model (“honey ConvNet”) was then made by fine-tuning the original network on a smaller number of honey ground truth simulations, in order to better capture human judgments on Experiment 1b. As seen in <xref ref-type="table" rid="pcbi.1007210.t002">Table 2</xref>, the water ConvNet successfully learned to approximate ground truth predictions, but its correlation with people in water trials was comparable to ground truth itself. The honey ConvNet was less successful in learning the ground truth, but its correlations with people in Experiment 1b were also comparable to those with the ground truth. Like with the honey ground truth, the honey ConvNet’s predictions were highly correlated with people in Experiment 1a. Experiment 2 further addresses this issue, by establishing whether people actually make different predictions for water and honey.</p>
<p>We also found hints that people’s predictions were sensitive to the physical attributes of the liquids, which could be predicted by the IFE. In both Experiment 1a and 1b, participants were at least partially sensitive to the physical attributes of viscosity and stickiness of each liquid: the ground truth model whose particle friction and stickiness corresponded to Experiment 1a was a better fit to Experiment 1a’s participants’ responses than those of Experiment 1b (see <xref ref-type="fig" rid="pcbi.1007210.g007">Fig 7</xref>). Experiment 1b’s participants’ responses were better fit by the ground truth model with Experiment 1b’s physical attributes. However, the fit between Experiment 1a responses and the honey ground truth was quite high, an issue which we address in Experiment 2.</p>
<p>In both experiments, including damping in the simulation models improved fits with people’s judgments. Furthermore, the uncertain IFE model had modestly higher correlations in most cases than the deterministic IFE (results not presented here). However, future work should further investigate the role of uncertainty in this kind of task. We also tested our previously presented uncertainty model [<xref ref-type="bibr" rid="pcbi.1007210.ref037">37</xref>], which assumed veridical physics plus uncertainty about the initial location of the fluid. We found this model to be more consistent with the data than ground truth, but it did not account as well for the data as either the deterministic or uncertain damped IFE models we present here.</p>
<p>In Experiment 1a, split-half correlations reveal participants were highly consistent with each other (<italic>r</italic> = 0.96[0.94, 0.97]). Experiment 1b participants were less consistent with each other (<italic>r</italic> = 0.81[0.73, 0.86]) than Experiment 1a, which might be attributable to less familiarity with the liquid, since Experiment 1a participants saw a liquid that behaved similarly to real water, but the liquid in Experiment 1b, while comparable to a highly viscous honey, was less similar to most common liquids. In addition, real honey has highly variable viscosity, so any experience people have with honey is less consistent than with water.</p>
</sec>
<sec id="sec016">
<title>Experiment 2</title>
<p>Our results show that people’s judgments on trials of a particular fluid type were positively correlated with the appropriate model, and near zero or anti-correlated with the other fluid type (see <xref ref-type="fig" rid="pcbi.1007210.g007">Fig 7B</xref>).</p>
<p>Correlations with the IFE model were calculated using the same model parameters from Experiment 1. The correlations for participants on water trials were <italic>r</italic> = 0.57[0.48, 0.64] with the water IFE, <italic>r</italic> = −0.10[−0.20, 0.01] with the Model 1 honey IFE and <italic>r</italic> = 0.08[−0.03, 0.19] with Model 2 honey IFE. On honey trials, correlations were <italic>r</italic> = 0.00[−0.07, 0.08] with the water IFE, <italic>r</italic> = 0.81[0.77, 0.85] with the Model 1 honey IFE, and <italic>r</italic> = 0.82[0.78, 0.86] with Model 2 honey IFE. Correlations with ground truth for water trials were <italic>r</italic> = 0.41[0.35, 0.47] and <italic>r</italic> = −0.03[−0.08, 0.03] for water and honey respectively. Correlations with ground truth for honey trials were <italic>r</italic> = −0.69[−0.71, −0.68] and <italic>r</italic> = 0.69[0.68, 0.7] for water and Model 1 honey respectively.</p>
<p>As shown in <xref ref-type="fig" rid="pcbi.1007210.g009">Fig 9</xref>, the gravity heuristic and SimpleSim accounted just as well for honey trial data as the honey IFE models, but were not as well correlated with water trials. Numerical results for all alternative models are also summarized in <xref ref-type="table" rid="pcbi.1007210.t003">Table 3</xref>, and visualized in <xref ref-type="fig" rid="pcbi.1007210.g007">Fig 7D</xref>. Parameters for MarbleSim and SimpleSim were fixed to their corresponding values in Experiment 1. Results show that, in contrast to Experiment 1, MarbleSim did poorly on honey trials and SimpleSim did poorly on water trials, compared to the IFE.</p>
<table-wrap id="pcbi.1007210.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007210.t003</object-id>
<label>Table 3</label>
<caption>
<title>Correlations between alternative models and subject data and the ground truth predictions.</title>
</caption>
<alternatives>
<graphic id="pcbi.1007210.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007210.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" colspan="5">Exp. 2</th>
</tr>
<tr>
<th align="left"/>
<th align="right">Data (water trials)</th>
<th align="right">Data (honey trials)</th>
<th align="right">Ground (water)</th>
<th align="right">Ground (honey)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Water ConvNet</td>
<td align="right">0.46[0.36, 0.55]</td>
<td align="right">-0.56[-0.62, -0.51]</td>
<td align="char" char=".">0.91</td>
<td align="char" char=".">-0.49</td>
</tr>
<tr>
<td align="left">Honey ConvNet</td>
<td align="right">0.13[0.03, 0.23]</td>
<td align="right">-0.00[-0.08, 0.07]</td>
<td align="char" char=".">0.05</td>
<td align="char" char=".">0.15</td>
</tr>
<tr>
<td align="left">Water SimpleSim</td>
<td align="right">0.22[0.12, 0.32]</td>
<td align="right">0.58[0.52, 0.64]</td>
<td align="char" char=".">-0.40</td>
<td align="char" char=".">0.49</td>
</tr>
<tr>
<td align="left">Honey SimpleSim</td>
<td align="right">-0.06[-0.16, 0.05]</td>
<td align="right">0.78[0.74, 0.82]</td>
<td align="char" char=".">-0.76</td>
<td align="char" char=".">0.70</td>
</tr>
<tr>
<td align="left">Water MarbleSim</td>
<td align="right">0.56[0.48, 0.64]</td>
<td align="right">-0.16[-0.23, -0.09]</td>
<td align="char" char=".">0.56</td>
<td align="char" char=".">-0.08</td>
</tr>
<tr>
<td align="left">Honey MarbleSim</td>
<td align="right">0.33[0.23, 0.42]</td>
<td align="right">0.41[0.35, 0.47]</td>
<td align="char" char=".">-0.09</td>
<td align="char" char=".">0.54</td>
</tr>
<tr>
<td align="left">Gravity heuristic</td>
<td align="right">-0.22[-0.32, -0.12]</td>
<td align="right">0.79[0.74, 0.83]</td>
<td align="char" char=".">-0.89</td>
<td align="char" char=".">0.81</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>As in Experiment 1, the ConvNet model was trained initially on water trials, and then fine-tuned on a smaller number of honey trials, resulting in two separate networks. (Note that separate networks needed to be trained for Experiment 2, because there was a cup rather than a divider at the bottom.) The ConvNet results are shown in <xref ref-type="table" rid="pcbi.1007210.t003">Table 3</xref>. Like Experiment 1, the water ConvNet was quite successful in predicting ground-truth physics, but its correlation with the water trial responses were still lower than the water IFE. By contrast, the honey ConvNet was not as successful in predicting the ground truth on our stimuli. We believe that this is because the scenes we picked as stimuli were not drawn from the same distribution as those in the ConvNet training set. Specifically, the stimuli were drawn from a skewed distribution, which filtered for scenes with highly divergent outcomes for water versus honey, whereas the training set as a whole was not. We believe this problem did not affect the water ConvNet as much, because of differences in behavior between the water and honey. Honey may exhibit different “regimes” of behavior: if only a low proportion of the particles get stuck on an obstacle surface, the simulation may have a very different outcome than if slightly more particles get stuck. It is possible that with a very large training set, the network would be more accurate on our honey stimuli. However, we stopped seeing incremental improvement when the honey ConvNet test set (in both experiments) included more than about 25% of the full set of 10000 training examples.</p>
<p>The results of Experiment 2 show that people are sensitive to the physical parameters (both stickiness and viscosity) of each fluid. Furthermore, our data show that people can accommodate their predictions systematically to different fluids with different physical parameters, but they may do so in one of two ways: by adjusting parameters in the simulation corresponding roughly to the physics, like stickiness and viscosity, or by approximating these physical variations using a single simple parameter, damping. The latter is cognitively appealing for its representational simplicity, but needs further investigation as a candidate cognitive model.</p>
<p>But while participants had good fits with both honey IFE models on honey trials, the water IFE model’s fit to participants’ responses was significantly lower than in the previous experiment, and responses were less accurate with respect to ground truth. In addition, subjects’ split-half correlations were much lower (<italic>r</italic> = 0.72[0.53, 0.82], as compared to <italic>r</italic> = 0.96[0.94, 0.97] in Experiment 1 water trials, <italic>r</italic> = 0.81[0.73, 0.86] in Experiment 1 honey trials, and <italic>r</italic> = 0.87[0.81, 0.92] in Experiment 2 honey trials). One potential explanation of this performance gap is that the task was more intrinsically difficult, as the cup was less wide than each bin in Experiment 1. That is, Experiment 2 scenes may require more precision in simulation (i.e. more samples) to match the accuracy levels in Experiment 1. As a measure of how much precision was required, we compared IFE prediction variance across tasks. That is, we looked at the deterministic IFE predictions over a range of <italic>ζ</italic> values to see how much they varied. If there is high variance, it means the model is less “certain” of the outcome, and therefore the task is more difficult. The ranges of <italic>ζ</italic> examined were the same as those used by the uncertain IFE in the results presented above (i.e. 1 ≤ <italic>ζ</italic> ≤ 9 for water and Model 1 honey, 7 ≤ <italic>ζ</italic> ≤ 15 for Model 2 honey). <xref ref-type="table" rid="pcbi.1007210.t004">Table 4</xref> shows the mean variance across scenes for each experiment and IFE fluid type. The mean variance for water in Experiment 2 was significantly higher than the mean variances for the other two IFE models in both experiments (unpaired t-test, all p-values near zero), supporting the notion that Experiment 2 water stimuli were intrinsically more difficult than the other three tasks. (Note that the human performance was higher on Experiment 1 (both water and honey trials) and Experiment 2 honey trials, but lower on Experiment 2 water trials, qualitatively matching the pattern of model variances.) However, further work will be necessary to understand why the model had higher agreement with ground truth in Experiment 2 water trials than human responses.</p>
<table-wrap id="pcbi.1007210.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007210.t004</object-id>
<label>Table 4</label>
<caption>
<title>IFE variance across experiments.</title>
</caption>
<alternatives>
<graphic id="pcbi.1007210.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007210.t004" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="left">Water</th>
<th align="left">Honey (Model 1)</th>
<th align="left">Honey (Model 2)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Experiment 1</td>
<td align="left">0.003[0.003, 0.003]</td>
<td align="left">0.002[0.002, 0.002]</td>
<td align="left">0.003[0.003, 0.004]</td>
</tr>
<tr>
<td align="left">Experiment 2</td>
<td align="left">0.014[0.013, 0.016]</td>
<td align="left">0.001[0.001, 0.001]</td>
<td align="left">0.009[0.008, 0.010]</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
</sec>
<sec id="sec017" sec-type="conclusions">
<title>Discussion</title>
<p>Here we introduced a computational cognitive model of how humans judge fluid dynamics in complex everyday settings. Our proposed model, the “Intuitive Fluids Engine” (IFE), posits that humans run particle-based mental simulations to predict how a fluid will flow in the world. Our experimental results show that humans are able to make coarse, but often accurate, predictions about fluid dynamics, and that these judgments are better explained by the IFE than several alternative models, including simpler particle-based simulations and models that do not explicitly simulate liquid dynamics. In two experiments, we found that people were able to predict fluid flow in a range of novel environments with multiple obstacles, varied fluid properties, and different task dynamics, appropriately taking into account complex geometric structure and fluid properties such as stickiness and viscosity. Solving these prediction tasks accurately would be very computationally intensive for an agent who has perfect knowledge of the ground truth physics and attempts to model the fluid flow with high precision. Our model explains the difference between this ideal and human performance as the result of several approximations: human mental simulations use only a very limited number of particles to represent the fluid, and only an imperfect approximation to the physics inherent to all particle-based simulators; in addition, particle momentum in mental simulations may be “damped” to varying degrees, especially for more viscous liquids. More generally, the success of this model is consistent with the broader view that many aspects of human intuitive physics can be understood in terms of approximate probabilistic simulation [<xref ref-type="bibr" rid="pcbi.1007210.ref003">3</xref>], extending this thesis from an account of how people understand and interact with simple rigid-body systems to much more complex fluid systems.</p>
<p>A crucial feature of our IFE model is how coarsely it approximates the true physics of fluids. Though our particle-based model is in the same family as SPH methods used for approximate simulations in physics, engineering, computer graphics and video games, its details and implementation differ importantly from those used in other disciplines. The rules that govern the particle-particle and particle-rigid interactions, the parameters of the simulated materials, and the granularity of the mass density approximation are highly simplified relative to those used in typical engineering applications, in ways that render the simulation non-veridical even though it still looks reasonably natural. In particular, very small numbers of particles, by the standards of typical SPH methods (e.g., 50 in our model, versus the hundreds of thousands or millions of particles typical in graphics and engineering, or the thousands typical in video games), gave the best fit to people’s judgments. And when simulating viscous fluids, a variant of our model that lumps various “stickiness” parameters into a single damping parameter fits human judgments well compared to the variant that keeps them separate. Though it requires further exploration, representational simplifications like these may point toward ways that human minds simulate complex real-world physics with cognitively plausible and efficient computations.</p>
<p>The only exception to the general pattern of agreement between physical simulation and people’s judgments occurred in the “Water” condition of Experiment 2, where a minority of participants had no correlation with ground truth. Our analyses showed that trials in this condition were objectively more difficult for a simulation-based approach than those in other conditions, but it is also possible that there are interesting qualitative differences between these trials to be explored further. Future work should more systematically investigate people’s patterns of success and failures in predicting qualitatively different kinds of fluid motion, and we expect that this will yield more insights into the nature of the computations and representations that people use in predicting fluid flow.</p>
<p>A common critique of quantitative simulation-based cognitive models of intuitive physics [<xref ref-type="bibr" rid="pcbi.1007210.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1007210.ref043">43</xref>] is they are impractical or unrealistic, due to the computation costs and the detailed physical knowledge implicitly embedded in these simulation algorithms. The simulation-based model we propose here should alleviate some of these concerns: Even extremely simplified simulations, with very coarse physical approximations, can nonetheless capture the fluid dynamics well enough for everyday judgment purposes. At the same time, these models can capture to a reasonable extent the surprisingly accurate quantitative predictions of fluid flow that people are able to make.</p>
<p>The alternative models we presented aimed to provide a benchmark, against which to compare the performance of our IFE results. We explored simpler, particle-based simulation models, and found that they captured certain aspects of people’s judgments, but no single model could account as fully for people’s predictions as the IFE. Nonetheless, simpler simulation models can do reasonably well here, which suggests that the brain may implement something not quite as sophisticated as our IFE. Taken together, the success of our IFE and alternative simulation models provides strong evidence for relatively sophisticated mental simulation in people’s heads, but point toward the need to further explore simpler simulation alternatives that are still sophisticated enough to account for the wide range of accurate predictions that people can make.</p>
<p>Our SimpleSim model performed especially well on honey trials in both experiments, achieving correlations similar to those of the IFE. A possible explanation for this success is that honey is an easier fluid to simulate heuristically. Supporting this notion, SimpleSim in Experiment 2 had a maximum correlation with the honey ground truth of <italic>r</italic> = 0.80 (occurring at <italic>g</italic> = 0.1, <italic>m</italic> = 0.06), but with the water ground truth, the maximum correlation was just <italic>r</italic> = 0.20 (occurring at <italic>g</italic> = 0.0, <italic>m</italic> = 0.2). (Recall that Experiment 2 scenes were specifically designed to elicit different outcomes for water versus honey, and are thus the best test of whether any parameter setting of SimpleSim could approximate water, as compared to honey.) This result makes intuitive sense, since both real honey and particles in SimpleSim tend to fall straight down near obstacle edges, by contrast to water, which splashes energetically, in different and less predictable directions. We believe that the moderate success of the heuristic simulation model can be attributed in part to the above: it is intrinsically well-suited for simulating sticky, viscous liquids falling under gravity. SimpleSim’s relative success in Experiment 1 water trials can largely be attributed to its close agreement with honey ground truth physics, since honey ground truth and honey IFE also had high correlations with those trials. Thus, the real test of whether SimpleSim is a good model for water trials is Experiment 2, where it does poorly relative to water IFE, water ground truth, and water MarbleSim.</p>
<p>We also explored a non-simulation, neural network model that learned a fast mapping between images of the starting configurations and the numerical outcomes. First, our neural network model shows that it is possible for a connectionist architecture to learn an accurate mapping from a still image representing initial conditions to a single number representing the simulated outcome for our task. Since our networks were trained on ground truth physics, they learned close approximations to the ground truth. It is perhaps unsurprising, then, that they had similar correlations with human data compared to the ground truth simulations. If people learn a similar kind of fast mapping between starting conditions and final outcomes, our results suggest there may be other biases or constraints involved, which we have not captured here. (We also tested whether any intermediate points in training, prior to convergence, resulted in higher correlations with subjects, and found this not to be the case).</p>
<p>Previous AI models for explicit reasoning about fluids (e.g. [<xref ref-type="bibr" rid="pcbi.1007210.ref020">20</xref>–<xref ref-type="bibr" rid="pcbi.1007210.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1007210.ref025">25</xref>]) have been studied in fundamentally different contexts than those we examined here. For example, [<xref ref-type="bibr" rid="pcbi.1007210.ref021">21</xref>] and [<xref ref-type="bibr" rid="pcbi.1007210.ref022">22</xref>] assume laminar flow that is highly constrained by container geometry (e.g. a piston cylinder). These models were designed to answer binary questions (Is the fluid flowing up or down? Is pressure increasing or decreasing?), rather than to predict the location of liquid during or after a splash. It is not clear how such qualitative or logical modeling approaches could be adapted to the present experiment, which involves fluids in rapid dynamical flow, or whether they could capture our participants’ quantitative judgments, but this is an important topic for future work. Perhaps the most similar previous model is [<xref ref-type="bibr" rid="pcbi.1007210.ref025">25</xref>], which could be seen as a simpler particle-based approach and in part motivated the gravity heuristic and SimpleSim models here. Their approach may be adaptable to the present experiments, but it is not immediately clear how to modify it such that it could distinguish between different liquids, such as water and honey.</p>
<p>Future work should explore how the precision, temporal duration, and other structural and parametric features of mental simulation for fluids might be implemented. For example, how does the precision vary as a function of how far into the future one must mentally simulate? [<xref ref-type="bibr" rid="pcbi.1007210.ref044">44</xref>] showed that for stability judgments, where the question is how far a fluid-containing vessel can be tilted before the fluid spills out and only one-time step predictions are needed (in contrast to our judgments here which required looking ahead many time-steps), IFE models can be extremely quantitatively accurate as accounts of people’s judgments. How closely do the attributes represented by the mind correspond to the actual physical characteristics of a liquid? Physically accurate simulation models can account for people’s judgments, but we also showed that a simpler simulation model (SimpleSim) also did reasonably well, even if the more physically accurate simulation models did better overall. This raises the question as to whether other simple simulation models may do better than SPH in accounting for people’s judgments. In order to address this question, it is crucial to design good experiments that can distinguish between different simulation models. For example, a simple extension to the current work could be to find scenes that distinguish as sharply as possible between the predictions of MarbleSim or SimpleSim and those of the IFE. In addition, using more dynamic and interactive scenes, as well as varying how far ahead one must mentally simulate may be useful in distinguishing between potential models.</p>
<p>Can our general approach extend to capture other classes of physical intuitions that go beyond rigid-body dynamics? Particle-based models can provide reasonable simulations for liquids and gases, as well as collections of solid elements (e.g., piles of sand) and composite materials (e.g., mashed potatoes or Play-Doh) whose dynamics share similarities with liquids. In fact, work by [<xref ref-type="bibr" rid="pcbi.1007210.ref045">45</xref>] provides preliminary evidence that particle-based simulation models can capture people’s judgments about sand in a very similar task to the one we present here. What are the limits of simulation-based models–what kinds of non-rigid dynamics can people make coherent predictions about, and might some be better explained by alternative approaches such as qualitative reasoning? Do people begin to use some form of qualitative reasoning as simulation becomes too computationally demanding or in situations where they have insufficient prior experience? There is evidence that internal forward models in the motor system are involved in predicting dynamics that cannot be reenacted by the body [<xref ref-type="bibr" rid="pcbi.1007210.ref046">46</xref>], which might help explain how mental simulations are implemented. Establishing connections between such work and our approximate simulation framework could lead to a deeper understanding of people’s capabilities and limitations when simulating physics.</p>
<p>Another important question is: How could intuitive physics engines be represented in the brain? [<xref ref-type="bibr" rid="pcbi.1007210.ref047">47</xref>] report fMRI evidence for physics-specific processing in an array of cortical regions related to the “multiple demand” system. But no models yet have connected the computational models to their neural substrates. Inspired by the recent successes of deep learning approaches in AI, a plausible candidate might be a recurrent neural network with dynamic, parallel, and distributed structure [<xref ref-type="bibr" rid="pcbi.1007210.ref048">48</xref>]. To date, neural network models have only been able to capture simple and restricted classes of rigid-body dynamics [<xref ref-type="bibr" rid="pcbi.1007210.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1007210.ref049">49</xref>], but as work on multimodal image annotation, linguistic modeling, and more general purpose distributed algorithm learning systems (e.g., LSTMs [<xref ref-type="bibr" rid="pcbi.1007210.ref050">50</xref>, <xref ref-type="bibr" rid="pcbi.1007210.ref051">51</xref>], the “Neural Turing Machine” [<xref ref-type="bibr" rid="pcbi.1007210.ref052">52</xref>]) advances, more richly structured scenes and physical dynamics might become accessible to these frameworks. A more general question for development, and computational cognitive psychologists is: Where does people’s knowledge of liquids come from? Five month-olds can distinguish between solids and liquids in novel contexts after observing their distinct patterns of movement [<xref ref-type="bibr" rid="pcbi.1007210.ref053">53</xref>, <xref ref-type="bibr" rid="pcbi.1007210.ref054">54</xref>], which suggests either a very data-efficient experience-based learning process or innate biases. Perhaps our simulation-based model’s core components can be measured in young children, or its more complex features can be observed as they emerge and mature.</p>
<p>Approximate simulation is a powerful framework that may explain how people understand a wide variety of complex physical processes they encounter in everyday life, such as rigids, non-rigids, and fluids. This work offers the first computational model of how people make intuitive predictions about fluids, and provides evidence that a particle-based simulation model can account for human predictions about liquids with different substance attributes.</p>
</sec>
<sec id="sec018">
<title>Supporting information</title>
<supplementary-material id="pcbi.1007210.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007210.s001" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Simulation in Blender.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007210.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007210.s002" xlink:type="simple">
<label>S2 Appendix</label>
<caption>
<title>Individual subject analyses.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1007210.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sanborn</surname> <given-names>AN</given-names></name>, <name name-style="western"><surname>Mansinghka</surname> <given-names>VK</given-names></name>, <name name-style="western"><surname>Griffiths</surname> <given-names>TL</given-names></name>. <article-title>Reconciling intuitive physics and Newtonian mechanics for colliding objects</article-title>. <source>Psychological review</source>. <year>2013</year>;<volume>120</volume>(<issue>2</issue>):<fpage>411</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1037/a0031912" xlink:type="simple">10.1037/a0031912</ext-link></comment> <object-id pub-id-type="pmid">23458084</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sanborn</surname> <given-names>AN</given-names></name>. <article-title>Testing Bayesian and heuristic predictions of mass judgments of colliding objects</article-title>. <source>Frontiers in psychology</source>. <year>2014</year>;<volume>5</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fpsyg.2014.00938" xlink:type="simple">10.3389/fpsyg.2014.00938</ext-link></comment> <object-id pub-id-type="pmid">25206345</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Battaglia</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Hamrick</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Tenenbaum</surname> <given-names>JB</given-names></name>. <article-title>Simulation as an engine of physical scene understanding</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2013</year>;<volume>110</volume>(<issue>45</issue>):<fpage>18327</fpage>–<lpage>18332</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1306572110" xlink:type="simple">10.1073/pnas.1306572110</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref004">
<label>4</label>
<mixed-citation publication-type="other" xlink:type="simple">Gerstenberg T, Goodman N, Lagnado D, Tenenbaum J. Noisy Newtons: Unifying process and dependency accounts of causal attribution. In: Proceedings of the Annual Meeting of the Cognitive Science Society. vol. 34; 2012.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref005">
<label>5</label>
<mixed-citation publication-type="other" xlink:type="simple">Smith K, Battaglia P, Vul E. Consistent physics underlying ballistic motion prediction. In: Proceedings of the 35th Conference of the Cognitive Science Society; 2013. p. 3426–3431.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Smith</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Vul</surname> <given-names>E</given-names></name>. <article-title>Sources of uncertainty in intuitive physics</article-title>. <source>Topics in cognitive science</source>. <year>2013</year>;<volume>5</volume>(<issue>1</issue>):<fpage>185</fpage>–<lpage>199</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/tops.12009" xlink:type="simple">10.1111/tops.12009</ext-link></comment> <object-id pub-id-type="pmid">23335579</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hamrick</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Battaglia</surname> <given-names>PW</given-names></name>, <name name-style="western"><surname>Griffiths</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Tenenbaum</surname> <given-names>JB</given-names></name>. <article-title>Inferring mass in complex scenes by mental simulation</article-title>. <source>Cognition</source>. <year>2016</year>;<volume>157</volume>:<fpage>61</fpage>–<lpage>76</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cognition.2016.08.012" xlink:type="simple">10.1016/j.cognition.2016.08.012</ext-link></comment> <object-id pub-id-type="pmid">27592412</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Krizhevsky</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sutskever</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>GE</given-names></name>. <article-title>Imagenet classification with deep convolutional neural networks</article-title>. In: <source>Advances in neural information processing systems</source>; <year>2012</year>. p. <fpage>1097</fpage>–<lpage>1105</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref009">
<label>9</label>
<mixed-citation publication-type="other" xlink:type="simple">Tompson J, Schlachter K, Sprechmann P, Perlin K. Accelerating eulerian fluid simulation with convolutional networks. In: Proceedings of the 34th International Conference on Machine Learning-Volume 70. JMLR. org; 2017. p. 3424–3433.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref010">
<label>10</label>
<mixed-citation publication-type="other" xlink:type="simple">Bender J, Erleben K, Galin E. SPH based shallow water simulation. In: Workshop on Virtual Reality Interaction and Physical Simulation; 2011.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Akinci</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Akinci</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Teschner</surname> <given-names>M</given-names></name>. <article-title>Versatile surface tension and adhesion for SPH fluids</article-title>. <source>ACM Transactions on Graphics (TOG)</source>. <year>2013</year>;<volume>32</volume>(<issue>6</issue>):<fpage>182</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1145/2508363.2508395" xlink:type="simple">10.1145/2508363.2508395</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McCloskey</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kohl</surname> <given-names>D</given-names></name>. <article-title>Naive physics: the curvilinear impetus principle and its role in interactions with moving objects</article-title>. <source>Journal of Experimental Psychology: Learning, Memory, and Cognition</source>. <year>1983</year>;<volume>9</volume>(<issue>1</issue>):<fpage>146</fpage>. <object-id pub-id-type="pmid">6220112</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McCloskey</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Washburn</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Felch</surname> <given-names>L</given-names></name>. <article-title>Intuitive physics: The straight-down belief and its origin</article-title>. <source>Journal of Experimental Psychology: Learning, Memory, and Cognition</source>. <year>1983</year>;<volume>9</volume>(<issue>4</issue>):<fpage>636</fpage>. <object-id pub-id-type="pmid">6227681</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kaiser</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Jonides</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Alexander</surname> <given-names>J</given-names></name>. <article-title>Intuitive reasoning about abstract and familiar physics problems</article-title>. <source>Memory &amp; Cognition</source>. <year>1986</year>;<volume>14</volume>(<issue>4</issue>):<fpage>308</fpage>–<lpage>312</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3758/BF03202508" xlink:type="simple">10.3758/BF03202508</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cook</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Breedin</surname> <given-names>SD</given-names></name>. <article-title>Constructing naive theories of motion on the fly</article-title>. <source>Memory &amp; Cognition</source>. <year>1994</year>;<volume>22</volume>(<issue>4</issue>):<fpage>474</fpage>–<lpage>493</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3758/BF03200871" xlink:type="simple">10.3758/BF03200871</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kaiser</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Proffitt</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Whelan</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Hecht</surname> <given-names>H</given-names></name>. <article-title>Influence of animation on dynamical judgments</article-title>. <source>Journal of experimental Psychology: Human Perception and performance</source>. <year>1992</year>;<volume>18</volume>(<issue>3</issue>):<fpage>669</fpage>. <object-id pub-id-type="pmid">1500868</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Caramazza</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>McCloskey</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Green</surname> <given-names>B</given-names></name>. <article-title>Naive beliefs in “sophisticated” subjects: Misconceptions about trajectories of objects</article-title>. <source>Cognition</source>. <year>1981</year>;<volume>9</volume>(<issue>2</issue>):<fpage>117</fpage>–<lpage>123</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0010-0277(81)90007-X" xlink:type="simple">10.1016/0010-0277(81)90007-X</ext-link></comment> <object-id pub-id-type="pmid">7196821</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zago</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lacquaniti</surname> <given-names>F</given-names></name>. <article-title>Cognitive, perceptual and action-oriented representations of falling objects</article-title>. <source>Neuropsychologia</source>. <year>2005</year>;<volume>43</volume>(<issue>2</issue>):<fpage>178</fpage>–<lpage>188</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuropsychologia.2004.11.005" xlink:type="simple">10.1016/j.neuropsychologia.2004.11.005</ext-link></comment> <object-id pub-id-type="pmid">15707903</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Forbus</surname> <given-names>KD</given-names></name>. <article-title>Qualitative modeling</article-title>. <source>Wiley Interdisciplinary Reviews: Cognitive Science</source>. <year>2011</year>;<volume>2</volume>(<issue>4</issue>):<fpage>374</fpage>–<lpage>391</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/wcs.115" xlink:type="simple">10.1002/wcs.115</ext-link></comment> <object-id pub-id-type="pmid">26302198</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Davis</surname> <given-names>E</given-names></name>. <article-title>Pouring Liquids: A Study in Commonsense Physical Reasoning</article-title>. <source>Artificial Intelligence</source>. <year>2008</year>;<volume>172</volume>:<fpage>1540</fpage>–<lpage>1578</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.artint.2008.04.003" xlink:type="simple">10.1016/j.artint.2008.04.003</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kim</surname> <given-names>H</given-names></name>. <article-title>Qualitative Reasoning about Geometry of Fluid Flow</article-title>. <source>Proceedings of Cognitive Science Society-90</source>. <year>1990</year>; p. <fpage>117</fpage>–<lpage>124</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref022">
<label>22</label>
<mixed-citation publication-type="other" xlink:type="simple">Kim H. Qualitative reasoning about fluids and mechanics. DTIC Document; 1993.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref023">
<label>23</label>
<mixed-citation publication-type="other" xlink:type="simple">Collins JW, Forbus KD. Reasoning about Fluids via Molecular Collections. In: AAAI; 1987. p. 590–594.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref024">
<label>24</label>
<mixed-citation publication-type="other" xlink:type="simple">Hayes PJ, et al. The naive physics manifesto. Institut pour les études sémantiques et cognitives/Université de Genève; 1978.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gardin</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Meltzer</surname> <given-names>B</given-names></name>. <article-title>Analogical representations of naive physics</article-title>. <source>Artificial Intelligence</source>. <year>1989</year>;<volume>38</volume>(<issue>2</issue>):<fpage>139</fpage>–<lpage>159</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0004-3702(89)90055-6" xlink:type="simple">10.1016/0004-3702(89)90055-6</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref026">
<label>26</label>
<mixed-citation publication-type="other" xlink:type="simple">Lerer A, Gross S, Fergus R. Learning Physical Intuition of Block Towers by Example. arXiv preprint arXiv:160301312. 2016;.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref027">
<label>27</label>
<mixed-citation publication-type="other" xlink:type="simple">Forbus KD, Gentner D. Qualitative mental models: Simulations or memories. In: Proceedings of the eleventh international workshop on qualitative reasoning. Cortona, Italy; 1997. p. 3–6.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>LeCun</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bengio</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>G</given-names></name>. <article-title>Deep learning</article-title>. <source>Nature</source>. <year>2015</year>;<volume>521</volume>(<issue>7553</issue>):<fpage>436</fpage>–<lpage>444</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature14539" xlink:type="simple">10.1038/nature14539</ext-link></comment> <object-id pub-id-type="pmid">26017442</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yamins</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Hong</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Cadieu</surname> <given-names>CF</given-names></name>, <name name-style="western"><surname>Solomon</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Seibert</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>DiCarlo</surname> <given-names>JJ</given-names></name>. <article-title>Performance-optimized hierarchical models predict neural responses in higher visual cortex</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2014</year>;<volume>111</volume>(<issue>23</issue>):<fpage>8619</fpage>–<lpage>8624</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1403112111" xlink:type="simple">10.1073/pnas.1403112111</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Battaglia</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Pascanu</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Lai</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rezende</surname> <given-names>DJ</given-names></name>, <etal>et al</etal>. <article-title>Interaction networks for learning about objects, relations and physics</article-title>. In: <source>Advances in Neural Information Processing Systems</source>; <year>2016</year>. p. <fpage>4502</fpage>–<lpage>4510</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref031">
<label>31</label>
<mixed-citation publication-type="other" xlink:type="simple">Chang MB, Ullman T, Torralba A, Tenenbaum JB. A compositional object-based approach to learning physical dynamics. arXiv preprint arXiv:161200341. 2016;.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kawabe</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Maruya</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Fleming</surname> <given-names>RW</given-names></name>, <name name-style="western"><surname>Nishida</surname> <given-names>S</given-names></name>. <article-title>Seeing liquids from visual motion</article-title>. <source>Vision research</source>. <year>2015</year>;<volume>109</volume>:<fpage>125</fpage>–<lpage>138</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.visres.2014.07.003" xlink:type="simple">10.1016/j.visres.2014.07.003</ext-link></comment> <object-id pub-id-type="pmid">25102388</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Paulun</surname> <given-names>VC</given-names></name>, <name name-style="western"><surname>Kawabe</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Nishida</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fleming</surname> <given-names>RW</given-names></name>. <article-title>Seeing liquids from static snapshots</article-title>. <source>Vision research</source>. <year>2015</year>;<volume>115</volume>:<fpage>163</fpage>–<lpage>174</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.visres.2015.01.023" xlink:type="simple">10.1016/j.visres.2015.01.023</ext-link></comment> <object-id pub-id-type="pmid">25676882</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref034">
<label>34</label>
<mixed-citation publication-type="other" xlink:type="simple">Becker M, Teschner M. Weakly compressible SPH for free surface flows. In: Proceedings of the 2007 ACM SIGGRAPH/Eurographics symposium on Computer animation. Eurographics Association; 2007. p. 209–217.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Macklin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Müller</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Chentanez</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>TY</given-names></name>. <article-title>Unified particle physics for real-time applications</article-title>. <source>ACM Transactions on Graphics (TOG)</source>. <year>2014</year>;<volume>33</volume>(<issue>4</issue>):<fpage>153</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1145/2601097.2601152" xlink:type="simple">10.1145/2601097.2601152</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Monaghan</surname> <given-names>JJ</given-names></name>. <article-title>Smoothed particle hydrodynamics</article-title>. <source>Reports on progress in physics</source>. <year>2005</year>;<volume>68</volume>(<issue>8</issue>):<fpage>1703</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1088/0034-4885/68/8/R01" xlink:type="simple">10.1088/0034-4885/68/8/R01</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref037">
<label>37</label>
<mixed-citation publication-type="other" xlink:type="simple">Bates CJ, Yildirim I, Tenenbaum JB, Battaglia PW. Humans predict liquid dynamics using probabilistic simulation. Proceedings of the 37th Annual Conference of the Cognitive Science Society. 2015; p. 171–177.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Monaghan</surname> <given-names>JJ</given-names></name>. <article-title>Smoothed particle hydrodynamics</article-title>. <source>Annual review of astronomy and astrophysics</source>. <year>1992</year>;<volume>30</volume>:<fpage>543</fpage>–<lpage>574</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev.aa.30.090192.002551" xlink:type="simple">10.1146/annurev.aa.30.090192.002551</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref039">
<label>39</label>
<mixed-citation publication-type="other" xlink:type="simple">Jia Y, Shelhamer E, Donahue J, Karayev S, Long J, Girshick R, et al. Caffe: Convolutional Architecture for Fast Feature Embedding. arXiv preprint arXiv:14085093. 2014;.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref040">
<label>40</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gigerenzer</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Hertwig</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Pachur</surname> <given-names>T</given-names></name>. <source>Heuristics: The foundations of adaptive behavior</source>. <publisher-name>Oxford University Press, Inc</publisher-name>.; <year>2011</year>.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McClelland</surname> <given-names>JL</given-names></name>. <article-title>Integrating probabilistic models of perception and interactive neural networks: a historical and tutorial review</article-title>. <source>Frontiers in psychology</source>. <year>2013</year>;<volume>4</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fpsyg.2013.00503" xlink:type="simple">10.3389/fpsyg.2013.00503</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref042">
<label>42</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Efron</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>RJ</given-names></name>. <chapter-title>An introduction to the bootstrap</chapter-title>. <source>CRC press</source>; <year>1994</year>.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref043">
<label>43</label>
<mixed-citation publication-type="other" xlink:type="simple">Davis E, Marcus G. The Scope and Limits of Simulation in Cognitive Models. arXiv preprint arXiv:150604956. 2015.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kubricht</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Jiang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Terzopoulos</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>H</given-names></name>. <article-title>Probabilistic Simulation Predicts Human Performance on Viscous Fluid-Pouring Problem</article-title>. In: <source>CogSci</source>; <year>2016</year>.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kubricht</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Jiang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Terzopoulos</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>H</given-names></name>. <article-title>Consistent Probabilistic Simulation Underlying Human Judgment in Substance Dynamics</article-title>. In: <source>CogSci</source>; <year>2017</year>.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schubotz</surname> <given-names>RI</given-names></name>. <article-title>Prediction of external events with our motor system: towards a new framework</article-title>. <source>Trends in cognitive sciences</source>. <year>2007</year>;<volume>11</volume>(<issue>5</issue>):<fpage>211</fpage>–<lpage>218</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tics.2007.02.006" xlink:type="simple">10.1016/j.tics.2007.02.006</ext-link></comment> <object-id pub-id-type="pmid">17383218</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fischer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mikhael</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Tenenbaum</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Kanwisher</surname> <given-names>N</given-names></name>. <article-title>Functional neuroanatomy of intuitive physical inference</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2016</year>; p. 201610344. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1610344113" xlink:type="simple">10.1073/pnas.1610344113</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Michalski</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Memisevic</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Konda</surname> <given-names>K</given-names></name>. <article-title>Modeling Deep Temporal Dependencies with Recurrent Grammar Cells</article-title>. In: <source>Advances in neural information processing systems</source>; <year>2014</year>. p. <fpage>1925</fpage>–<lpage>1933</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref049">
<label>49</label>
<mixed-citation publication-type="other" xlink:type="simple">Grzeszczuk R, Terzopoulos D, Hinton G. Neuroanimator: Fast neural network emulation and control of physics-based models. In: Proceedings of the 25th annual conference on Computer graphics and interactive techniques. ACM; 1998. p. 9–20.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hochreiter</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schmidhuber</surname> <given-names>J</given-names></name>. <article-title>Long short-term memory</article-title>. <source>Neural computation</source>. <year>1997</year>;<volume>9</volume>(<issue>8</issue>):<fpage>1735</fpage>–<lpage>1780</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/neco.1997.9.8.1735" xlink:type="simple">10.1162/neco.1997.9.8.1735</ext-link></comment> <object-id pub-id-type="pmid">9377276</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref051">
<label>51</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Graves</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <source>Supervised sequence labelling with recurrent neural networks</source>. <volume>vol. 385</volume>. <publisher-name>Springer</publisher-name>; <year>2012</year>.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref052">
<label>52</label>
<mixed-citation publication-type="other" xlink:type="simple">Graves A, Wayne G, Danihelka I. Neural Turing Machines. arXiv preprint arXiv:14105401. 2014.</mixed-citation>
</ref>
<ref id="pcbi.1007210.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hespos</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Ferry</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Rips</surname> <given-names>LJ</given-names></name>. <article-title>Five-month-old infants have different expectations for solids and liquids</article-title>. <source>Psychological Science</source>. <year>2009</year>;<volume>20</volume>(<issue>5</issue>):<fpage>603</fpage>–<lpage>611</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1467-9280.2009.02331.x" xlink:type="simple">10.1111/j.1467-9280.2009.02331.x</ext-link></comment> <object-id pub-id-type="pmid">19368696</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007210.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hespos</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Ferry</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Hollenbeck</surname> <given-names>EN</given-names></name>, <name name-style="western"><surname>Rips</surname> <given-names>LJ</given-names></name>. <article-title>Five-Month-Old Infants Have General Knowledge of How Nonsolid Substances Behave and Interact</article-title>. <source>Psychological Science</source>. <year>2015</year>;<volume>1</volume>:<fpage>13</fpage>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>