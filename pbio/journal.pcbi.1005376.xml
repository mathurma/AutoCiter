<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005376</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01297</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Mathematical functions</subject><subj-group><subject>Transfer functions</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biophysics</subject><subj-group><subject>Ion channels</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Biophysics</subject><subj-group><subject>Ion channels</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Ion channels</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Ion channels</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Ion channels</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Ion channels</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Ion channels</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Ion channels</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Signal transduction</subject><subj-group><subject>Cell signaling</subject><subj-group><subject>G-protein signaling</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biophysics</subject><subj-group><subject>Ion channels</subject><subj-group><subject>Calcium channels</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Biophysics</subject><subj-group><subject>Ion channels</subject><subj-group><subject>Calcium channels</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Ion channels</subject><subj-group><subject>Calcium channels</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Ion channels</subject><subj-group><subject>Calcium channels</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Ion channels</subject><subj-group><subject>Calcium channels</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Ion channels</subject><subj-group><subject>Calcium channels</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Ion channels</subject><subj-group><subject>Calcium channels</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Ion channels</subject><subj-group><subject>Calcium channels</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Neurochemistry</subject><subj-group><subject>Neurotransmitters</subject><subj-group><subject>Glutamate</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurochemistry</subject><subj-group><subject>Neurotransmitters</subject><subj-group><subject>Glutamate</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biophysics</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Biophysics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical noise</subject><subj-group><subject>Gaussian noise</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Elucidation of molecular kinetic schemes from macroscopic traces using system identification</article-title>
<alt-title alt-title-type="running-head">Elucidation of molecular kinetic schemes using system identification</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1804-8136</contrib-id>
<name name-style="western">
<surname>Fribourg</surname>
<given-names>Miguel</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0384-073X</contrib-id>
<name name-style="western">
<surname>Logothetis</surname>
<given-names>Diomedes E.</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>González-Maeso</surname>
<given-names>Javier</given-names>
</name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Sealfon</surname>
<given-names>Stuart C.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Galocha-Iragüen</surname>
<given-names>Belén</given-names>
</name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7959-2114</contrib-id>
<name name-style="western">
<surname>Las-Heras Andrés</surname>
<given-names>Fernando</given-names>
</name>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Brezina</surname>
<given-names>Vladimir</given-names>
</name>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Neurology and Center for Translational Systems Biology, Icahn School Of Medicine at Mount Sinai, New York, New York, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Department of Pharmaceutical Sciences, Northeastern University, Boston, Massachusetts, United States of America</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Department of Physiology and Biophysics, Virginia Commonwealth University School of Medicine, Richmond, Virginia, United States of America</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>Department of Signals Systems and Radiocommunications, Universidad Politécnica de Madrid, Madrid, Spain</addr-line></aff>
<aff id="aff005"><label>5</label> <addr-line>Department of Electrical Engineering, Universidad de Oviedo, Gijón, Spain</addr-line></aff>
<aff id="aff006"><label>6</label> <addr-line>Department of Neuroscience, Icahn School of Medicine, New York, New York, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Voets</surname>
<given-names>Thomas</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University of Leuven, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple"> <list-item><p><bold>Conceptualization:</bold> MF VB FLHA BGI JGM DEL SCS.</p></list-item> <list-item><p><bold>Data curation:</bold> MF VB.</p></list-item> <list-item><p><bold>Formal analysis:</bold> MF VB FLHA BGI.</p></list-item> <list-item><p><bold>Funding acquisition:</bold> MF DEL JGM SCS BGI FLHA VB.</p></list-item> <list-item><p><bold>Investigation:</bold> MF VB DEL JGM.</p></list-item> <list-item><p><bold>Methodology:</bold> MF VB FLHA BGI.</p></list-item> <list-item><p><bold>Project administration:</bold> MF.</p></list-item> <list-item><p><bold>Resources:</bold> MF VB DEL SCS JGM.</p></list-item> <list-item><p><bold>Software:</bold> MF VB FLHA BGI.</p></list-item> <list-item><p><bold>Supervision:</bold> VB FLHA BGI DEL JGM SCS.</p></list-item> <list-item><p><bold>Validation:</bold> MF VB FLHA BGI.</p></list-item> <list-item><p><bold>Visualization:</bold> MF VB FLHA BGI.</p></list-item> <list-item><p><bold>Writing – original draft:</bold> MF.</p></list-item> <list-item><p><bold>Writing – review &amp; editing:</bold> MF VB.</p></list-item></list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">miguel.fribourg@mssm.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>13</day>
<month>2</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="collection">
<month>2</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>2</issue>
<elocation-id>e1005376</elocation-id>
<history>
<date date-type="received">
<day>10</day>
<month>8</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>21</day>
<month>1</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Fribourg et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005376"/>
<abstract>
<p>Overall cellular responses to biologically-relevant stimuli are mediated by networks of simpler lower-level processes. Although information about some of these processes can now be obtained by visualizing and recording events at the molecular level, this is still possible only in especially favorable cases. Therefore the development of methods to extract the dynamics and relationships between the different lower-level (microscopic) processes from the overall (macroscopic) response remains a crucial challenge in the understanding of many aspects of physiology. Here we have devised a hybrid computational-analytical method to accomplish this task, the SYStems-based MOLecular kinetic scheme Extractor (SYSMOLE). SYSMOLE utilizes system-identification input-output analysis to obtain a transfer function between the stimulus and the overall cellular response in the Laplace-transformed domain. It then derives a Markov-chain state molecular kinetic scheme uniquely associated with the transfer function by means of a classification procedure and an analytical step that imposes general biological constraints. We first tested SYSMOLE with synthetic data and evaluated its performance in terms of its rate of convergence to the correct molecular kinetic scheme and its robustness to noise. We then examined its performance on real experimental traces by analyzing macroscopic calcium-current traces elicited by membrane depolarization. SYSMOLE derived the correct, previously known molecular kinetic scheme describing the activation and inactivation of the underlying calcium channels and correctly identified the accepted mechanism of action of nifedipine, a calcium-channel blocker clinically used in patients with cardiovascular disease. Finally, we applied SYSMOLE to study the pharmacology of a new class of glutamate antipsychotic drugs and their crosstalk mechanism through a heteromeric complex of G protein-coupled receptors. Our results indicate that our methodology can be successfully applied to accurately derive molecular kinetic schemes from experimental macroscopic traces, and we anticipate that it may be useful in the study of a wide variety of biological systems.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Unraveling the lower-level (microscopic) processes underlying the overall (macroscopic) cell response to a given stimulus is a challenging problem in cell physiology. This has been a classic problem in biophysics, where the ability to record the activity of single ion channels that generate a macroscopic ion current has allowed a measure of direct access to the underlying microscopic processes. These classic studies have demonstrated that very different groupings of the microscopic processes can yield extremely similar macroscopic responses. Biologists in fields other than biophysics are frequently confronted with the same macroscopic-to-microscopic problem, usually, however, without any direct access to the microscopic processes. Thus, the development of computational methods to deduce from the available macroscopic measurements the nature of the underlying microscopic processes can be expected to substantially advance the study of many areas of cell physiology. Toward that aim, here we have derived and tested a hybrid computational-analytical method to extract information about the microscopic processes that is hidden in macroscopic experimental traces. Our method is independent of the particular system under study, and thus can be applied to new as well as previously-recorded macroscopic traces obtained in a wide variety of biological systems.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000050</institution-id>
<institution>National Heart, Lung, and Blood Institute</institution>
</institution-wrap>
</funding-source>
<award-id>R01HL059949</award-id>
<principal-award-recipient>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0384-073X</contrib-id>
<name name-style="western">
<surname>Logothetis</surname>
<given-names>Diomedes E.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000025</institution-id>
<institution>National Institute of Mental Health</institution>
</institution-wrap>
</funding-source>
<award-id>R01MH084894</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>González-Maeso</surname>
<given-names>Javier</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000062</institution-id>
<institution>National Institute of Diabetes and Digestive and Kidney Diseases</institution>
</institution-wrap>
</funding-source>
<award-id>R01DK046943</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Sealfon</surname>
<given-names>Stuart C.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000025</institution-id>
<institution>National Institute of Mental Health</institution>
</institution-wrap>
</funding-source>
<award-id>T32MH096678</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1804-8136</contrib-id>
<name name-style="western">
<surname>Fribourg</surname>
<given-names>Miguel</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000060</institution-id>
<institution>National Institute of Allergy and Infectious Diseases</institution>
</institution-wrap>
</funding-source>
<award-id>U19AI117873</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Sealfon</surname>
<given-names>Stuart C.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award006">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000060</institution-id>
<institution>National Institute of Allergy and Infectious Diseases</institution>
</institution-wrap>
</funding-source>
<award-id>T32AI078892</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1804-8136</contrib-id>
<name name-style="western">
<surname>Fribourg</surname>
<given-names>Miguel</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>Supported by National Institute of Health (<ext-link ext-link-type="uri" xlink:href="https://www.nih.gov" xlink:type="simple">https://www.nih.gov</ext-link>) grants RO1HL059949, R01MH084894, R01 DK046943, U19AI117873, T32MH096678, and T32AI078892. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="2"/>
<page-count count="34"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-02-28</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All the experimental data, including ion-channel and heteromeric signaling traces, are available as supporting information (<xref ref-type="supplementary-material" rid="pcbi.1005376.s004">S1 Data</xref>). Matlab scripts are available at Matlab Central File Exchange <ext-link ext-link-type="uri" xlink:href="https://www.mathworks.com/matlabcentral/fileexchange/" xlink:type="simple">https://www.mathworks.com/matlabcentral/fileexchange/</ext-link></meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>In order to ensure their survival and correct physiological function, cells must respond appropriately to many different kinds of stimuli, such as the presence of various neurotransmitters or hormones in the extracellular fluid, the depolarization of the cell membrane, or stimuli such as mechanical force or light [<xref ref-type="bibr" rid="pcbi.1005376.ref001">1</xref>]. The cell’s response to any particular stimulus engages vast numbers of single molecules whose actions combine to perform various tasks within the cell.</p>
<p>To provide a framework for the study of such cellular responses to stimuli, biologists try to understand the actions of the single molecules in terms of elementary (“microscopic”) molecular processes, such as the opening or closing of ion channels in the membrane, the phosphorylation or dephosphorylation of intracellular proteins, or the nuclear translocation of transcription factors [<xref ref-type="bibr" rid="pcbi.1005376.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref003">3</xref>]. Formally, the dynamics of these processes are typically described by molecular kinetic schemes or, mathematically, Markov-chain state models. Each state in the model represents, for example, a molecular conformation or ligand binding-site occupancy; rate constants govern the transitions between the states (e.g., <xref ref-type="fig" rid="pcbi.1005376.g001">Fig 1</xref>). These types of schemes have been successfully applied to describe many kinds of cellular systems, including the activity of ion channels [<xref ref-type="bibr" rid="pcbi.1005376.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref005">5</xref>], pharmacology of receptors [<xref ref-type="bibr" rid="pcbi.1005376.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1005376.ref008">8</xref>], and flux through metabolic pathways [<xref ref-type="bibr" rid="pcbi.1005376.ref002">2</xref>].</p>
<fig id="pcbi.1005376.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005376.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Problem description and modular implementation of SYSMOLE.</title>
<p>(<bold>A</bold>) Example of classic voltage clamp experimental traces, which can be used as an input (red) and output (black) trace pair for the SYStems-based MOLecular kinetic scheme Extractor (SYSMOLE) method. In voltage-clamp (VC) experiments to study ion-channel currents, one would define an input-output system in which the scalar input signal <italic>u</italic>(<italic>t</italic>) is the depolarizing voltage step (top), and the scalar output signal <italic>y</italic>(<italic>t</italic>) is the actual current trace elicited by the depolarization (bottom). (<bold>B</bold>) Example of two molecular kinetic schemes describing ion channel dynamics in response to a voltage step that yield similar macroscopic traces. C indicates the closed-channel state, O the open-channel state, I the inactivated-channel state, CI the closed-inactivated-channel state, and OI the open-inactivated-channel state. (<bold>C</bold>) Modular organization of SYSMOLE and workflow of the method. Briefly, the Identifier Module uses the input <italic>u</italic>(<italic>t</italic>) and output <italic>y</italic>(<italic>t</italic>) traces to obtain the transfer function <italic>G</italic>(<italic>s</italic>), which can be characterized by the time constants of its poles (<italic>τ</italic><sub><italic>poles</italic></sub>) and zeros (<italic>τ</italic><sub><italic>zeros</italic></sub>), and a gain. The Classifier Module finds the configuration or block diagram associated with the transfer function <italic>G</italic>(<italic>s</italic>). The Molecular Kinetic Converter Module uses the block diagram together with the transfer function <italic>G</italic>(<italic>s</italic>) to derive the molecular kinetic scheme.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005376.g001" xlink:type="simple"/>
</fig>
<p>Clearly, it is desirable to study these microscopic processes directly. This has been possible, to some extent, in a few areas, notably the biophysics of ion channels, an exceptionally favorable case where the exquisitely sensitive patch-clamp technique [<xref ref-type="bibr" rid="pcbi.1005376.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref010">10</xref>] is able to record the activity of single ion channels. As a result, this technique provides some measure of direct information about microscopic processes such as the opening and closing of the channels and allows the construction of molecular kinetic models of these processes [<xref ref-type="bibr" rid="pcbi.1005376.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref012">12</xref>].</p>
<p>In most areas of cell biology, however, such direct access to the microscopic processes is not yet possible. Although new single-molecule techniques provide ways of understanding the properties of key biological molecules in isolation, monitoring the dynamics of single molecules inside cells is technically complex and in many experimental systems not practical (see [<xref ref-type="bibr" rid="pcbi.1005376.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref014">14</xref>] for reviews).</p>
<p>The information that <italic>is</italic> routinely available from cells exposed to stimuli is the overall (“macroscopic”) cellular response (e.g., <xref ref-type="fig" rid="pcbi.1005376.g001">Fig 1A</xref>). This response combines the signal from a large number of molecules and multiple microscopic processes [<xref ref-type="bibr" rid="pcbi.1005376.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref016">16</xref>]. The macroscopic response trace thus contains information about the microscopic processes, and, since it is relatively easy to record in most experimental systems, an attractive approach is to attempt to extract information about the microscopic processes, and the way in which they are combined in the molecular kinetic scheme, from the macroscopic trace.</p>
<p>This, however, is a challenging problem. Although, in theory, the information about all of the relevant microscopic processes is present in the macroscopic trace, the trace combines the information about the individual processes in a way that is often complicated and difficult to interpret immediately in terms of the underlying molecular kinetic scheme [<xref ref-type="bibr" rid="pcbi.1005376.ref017">17</xref>]. For example, the work with ion channels has demonstrated that very similar macroscopic responses can be generated by quite different arrangements of the microscopic processes in the molecular kinetic scheme [<xref ref-type="bibr" rid="pcbi.1005376.ref018">18</xref>] (as can be seen also in <xref ref-type="fig" rid="pcbi.1005376.g001">Fig 1B</xref>).</p>
<p>One way to simplify the problem is to assume a pre-existing molecular kinetic model of the system, based on other kinds of experimental data or simply educated guesswork. Thus, in the ion-channel field, elegant computational methods have been introduced to analyze macroscopic traces of ion currents [<xref ref-type="bibr" rid="pcbi.1005376.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref020">20</xref>], but these methods rely strongly on specific biophysical models of the ion channels and thus are not immediately generalizable to the study of other biological systems.</p>
<p>In this study, we have developed a general method, the SYStems-based MOLecular kinetic scheme Extractor (SYSMOLE), to obtain molecular kinetic schemes from macroscopic traces. SYSMOLE is a hybrid computational-analytical method that, because it does not assume any pre-existing model of the system, can be applied to experimental traces recorded, in principle, in any biological system.</p>
<p>In practical terms, to successfully derive the molecular kinetic scheme underlying a macroscopic trace, a method must perform three distinct tasks: a) it must accurately model the dynamics of the trace, b) it must ensure that this model is unique, and c) it must convert this mathematical model into a biologically interpretable model. SYSMOLE includes a module to tackle each of these tasks (<xref ref-type="fig" rid="pcbi.1005376.g001">Fig 1C</xref>). The Identifier Module accurately captures the dynamics of the macroscopic trace and summarizes this information in the form of a transfer function. The Classifier Module derives a block diagram, a description of how different processes are combined, that is uniquely matched to the transfer function. Finally, the Molecular Kinetic Converter (MKC) Module utilizes both the transfer function and the block diagram to derive a molecular kinetic scheme that can be interpreted biologically in terms of conformational changes of proteins or chemical reactions.</p>
<p>We first describe the implementation of each of the three modules that comprise SYSMOLE. For didactic simplicity, we focus in our presentation on a second-order system, in which two first-order processes are combined in different arrangements; however, our approach is scalable to higher-order systems (<xref ref-type="supplementary-material" rid="pcbi.1005376.s003">S1 Text</xref> section 3). Next, we provide a rigorous evaluation of the performance of SYSMOLE in the presence of noise using synthetic traces. We then report on the performance of SYSMOLE on real experimental traces. We show that SYSMOLE was able to derive the correct molecular kinetic scheme of the inactivation of L-type calcium channels as well as the effects of the calcium-channel blocker nifedipine from macroscopic calcium-current traces. Finally, we describe the use of SYSMOLE to decipher the crosstalk mechanism, through the heteromeric receptor complex formed by the metabotropic glutamate receptor 2 (mGluR2) and the serotonin receptor 2A (5-HT2AR), of a new class of glutamate antipsychotics.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Identifier module</title>
<sec id="sec004">
<title>Description</title>
<p>SYSMOLE aims to understand the system’s response to stimuli by breaking it down in terms of simple processes (i.e. activation, or inactivation). To that aim SYSMOLE relies on System Theory, which has developed robust process-oriented approaches using transformed domains, such as Fourier, Laplace or z, as an alternative functional description that simplifies the process of analyzing the behavior of the system. Laplace transformation from the time domain (<italic>t</italic>) to the frequency domain (<italic>s</italic>), for example, transforms differential equations into algebraic equations and convolution into multiplication, which simplifies the analysis. Furthermore, it allows for a description of the system’s response in the frequency domain as the product <italic>Y</italic>(<italic>s</italic>) = <italic>G</italic>(<italic>s</italic>). <italic>U</italic>(<italic>s</italic>), where <italic>Y</italic>(<italic>s</italic>) and <italic>U</italic>(<italic>s</italic>) refer to the output and the input signals in the frequency domain respectively, and <italic>G</italic>(<italic>s</italic>) to the transfer function that characterizes the system. The transfer function provides in principle the output for any input within certain constraints (see below). Despite this input-output characterization not being suited for systems with multiple alternative outputs to one input such as bistable systems, it provides an extremely powerful characterization of the response to stimuli of a wide range of systems.</p>
<p>The Identifier Module embodies the system-identification component of our approach. It uses the relationship between a given input trace <italic>u</italic>(<italic>t</italic>) and the resulting output trace <italic>y</italic>(<italic>t</italic>) to characterize the dynamics of the system and to summarize them in the form of an overall transfer function <italic>G</italic>(<italic>s</italic>).</p>
</sec>
<sec id="sec005">
<title>Implementation</title>
<p>The Identifier Module considers systems to be causal, linear, and time-invariant (LTI). Causality implies that the output at a certain time depends only on the input up to that time. Linearity enforces the output response of the system to a linear combination of inputs to be equal to the linear combination of the output responses to the individual inputs. Time-invariance means that the output response to a given input does not depend on absolute time. Experimentally, these assumptions can be met by applying some simple constraints. To ensure linearity, one can expose the system to a range of inputs known not to saturate the system. To ensure time-invariance, one can wait for the system to be at steady state before exposing it to the input and measure its response only once if long-term desensitization or other long-term memory processes are known to play a significant role in the system. Given this LTI characterization, SYSMOLE is best adapted to study systems whose behavior can be described or approximated by ordinary differential equations (ODEs).</p>
<p>How does SYSMOLE derive the transfer function in the frequency domain, <italic>G</italic>(<italic>s</italic>), from the input <italic>u</italic>(<italic>t</italic>) and output <italic>y</italic>(<italic>t</italic>) traces in the time domain? It is well known (see [<xref ref-type="bibr" rid="pcbi.1005376.ref021">21</xref>] for a review) that a LTI system can be described by its impulse response <italic>g</italic>(<italic>t</italic>) as follows:
<disp-formula id="pcbi.1005376.e001">
<alternatives>
<graphic id="pcbi.1005376.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mi>y</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mi>u</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
Thus, knowing <italic>g</italic>(<italic>t</italic>) from <italic>t</italic> = 0 to ∞, one can compute the output <italic>y</italic>(<italic>t</italic>) for any input <italic>u</italic>(<italic>t</italic>). The impulse response <italic>g</italic>(<italic>t</italic>) thus provides a complete characterization of the system. The transfer function <italic>G</italic>(<italic>s</italic>) is the representation of <italic>g</italic>(<italic>t</italic>) in the Laplace-transformed domain. Both time <italic>t</italic> and the transformed variable <italic>s</italic> are continuous; in real experiments, however, both <italic>u</italic>(<italic>t</italic>) and <italic>y</italic>(<italic>t</italic>) are sampled discretely in time. The Identifier Module assumes that <italic>u</italic>(<italic>t</italic>) and <italic>y</italic>(<italic>t</italic>) are observed at the sampling instants <italic>t</italic><sub><italic>k</italic></sub> = <italic>kT</italic><sub><italic>s</italic></sub> with <italic>k</italic> = 1,2,…, where <italic>T</italic><sub><italic>s</italic></sub> is the sampling interval. In those terms one can rewrite Eq (<xref ref-type="disp-formula" rid="pcbi.1005376.e001">1</xref>) as
<disp-formula id="pcbi.1005376.e002">
<alternatives>
<graphic id="pcbi.1005376.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mi>y</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mi>u</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
Assuming that <italic>u</italic>(<italic>t</italic>) does not change much during a sample interval one can express <italic>y</italic>(<italic>t</italic>) as
<disp-formula id="pcbi.1005376.e003">
<alternatives>
<graphic id="pcbi.1005376.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:mi>y</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mi>u</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
where we ease the notation and assume that <italic>T</italic><sub><italic>s</italic></sub> is one time unit and use <italic>t</italic> to enumerate the sampling intervals.</p>
<p>According to relationship (<xref ref-type="disp-formula" rid="pcbi.1005376.e003">3</xref>) the output can be exactly calculated once the input is known. In most cases this is unrealistic, since there are always signals beyond our control that also affect the system. In the linear framework used by the Identifier Module those effects are lumped into an additive term at the output <italic>v</italic>(<italic>t</italic>) called disturbance.
<disp-formula id="pcbi.1005376.e004">
<alternatives>
<graphic id="pcbi.1005376.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mi>y</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mi>u</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
Inputs could also be corrupted but their effects are included on the output in <italic>v</italic>(<italic>t</italic>) without loss of generality. Disturbances can come from measurement noise, and other uncontrollable inputs [<xref ref-type="bibr" rid="pcbi.1005376.ref022">22</xref>]. The most characteristic feature of the disturbance is that its value is not known beforehand, and therefore one requires a probabilistic framework to characterize it. The Identifier Module mathematically expresses <italic>v</italic>(<italic>t</italic>) as the output of a system characterized by the discrete-time impulse response <italic>h</italic>(<italic>k</italic>)
<disp-formula id="pcbi.1005376.e005">
<alternatives>
<graphic id="pcbi.1005376.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mi>e</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
where the input <italic>e</italic>(<italic>t</italic>) is white gaussian noise with zero mean and variance <italic>λ</italic>. Although <italic>e</italic>(<italic>t</italic>) being Gaussian is a somewhat restraining assumption, it still allows us to characterize a wide range of disturbances <italic>v</italic>(<italic>t</italic>) by using different <italic>h</italic>(<italic>k</italic>) sequences. This model of disturbance is extremely versatile and should be appropriate to characterize the noise present in a wide range of experimental traces [<xref ref-type="bibr" rid="pcbi.1005376.ref023">23</xref>]. We have successfully applied it to traces with added Gaussian noise (see next sections), and Brownian noise (<xref ref-type="supplementary-material" rid="pcbi.1005376.s003">S1 Text</xref> section 4.1)</p>
<p>In summary, as part of the identification process, the Identifier Module will find the discrete-time response <italic>g</italic>(<italic>k</italic>) and the discrete-time transfer function <italic>G</italic>(<italic>z</italic>) that relates the discrete input and the discrete output. The continuous version of the transfer function <italic>G</italic>(<italic>s</italic>) is obtained by converting <italic>G</italic>(<italic>z</italic>) to the continuous domain <italic>G</italic>(<italic>s</italic>). Furthermore, as part of the identification process the Identifier Module will obtain <italic>H</italic>(<italic>s</italic>), the Laplace Transform of <italic>h</italic>(<italic>k</italic>), which generates the disturbance by filtering white Gaussian noise.</p>
<p>The dynamics of a system can be expressed in many different ways. Probably the simplest input-output relationship between two discrete-time signals is obtained by describing it as a linear difference equation. The Identifier Module describes this relationship as an ARX model (6), a family of difference equations characterized by a set of parameters <inline-formula id="pcbi.1005376.e006"><alternatives><graphic id="pcbi.1005376.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:math></alternatives></inline-formula>.</p>
<disp-formula id="pcbi.1005376.e007">
<alternatives>
<graphic id="pcbi.1005376.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:mi>y</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>y</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi>y</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>u</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi>u</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
<p>Here AR refers to the autoregressive part of <italic>y</italic>(<italic>t</italic>) and X to the contribution of the input <italic>u</italic>(<italic>t</italic>) at earlier times, also called the exogenous variable. We chose the ARX models for the implementation of the identifier for two main reasons: (a) the best parameter estimation given the disturbance can be easily obtained computationally [<xref ref-type="bibr" rid="pcbi.1005376.ref024">24</xref>], and (b) the parameters of the model can be easily converted to the poles and zeros of the transfer function <italic>G</italic>(<italic>s</italic>). The Identifier Module determines optimal values of <italic>n</italic><sub><italic>α</italic></sub>, <italic>n</italic><sub><italic>β</italic></sub> as well as the coefficients <inline-formula id="pcbi.1005376.e008"><alternatives><graphic id="pcbi.1005376.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005376.e009"><alternatives><graphic id="pcbi.1005376.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> that minimize the prediction error in the model by minimizing a function denoted loss function (see prediction-error identification methods in [<xref ref-type="bibr" rid="pcbi.1005376.ref025">25</xref>]). Our identifications provided loss functions of the order 10<sup>−7</sup> or lower indicating that ARX models and Eq (<xref ref-type="disp-formula" rid="pcbi.1005376.e007">6</xref>) provide good fits to the synthetic and experimental traces we studied.</p>
<p>It can be also demonstrated that <italic>n</italic><sub><italic>α</italic></sub> − 1 represents the number of poles, and <italic>n</italic><sub><italic>β</italic></sub> the number of zeros of the discrete transfer function <italic>G</italic>(<italic>z</italic>). Furthermore, by adequately sampling the traces, we can convert the transfer function obtained in the discrete frequency domain, <italic>G</italic>(<italic>z</italic>), to its equivalent transfer function in the continuous frequency domain, <italic>G</italic>(<italic>s</italic>) [<xref ref-type="bibr" rid="pcbi.1005376.ref026">26</xref>]. Each transfer function <italic>G</italic>(<italic>s</italic>) is characterized by the roots of the denominator (poles), the roots of the numerator (zeros), and the gain. The minimum sampling frequency is given by the Nyquist-Shannon sampling theorem applied to the power density spectrum of the signal <italic>y</italic>(<italic>t</italic>), and empirically estimated in a conservative fashion by choosing a sampling period <italic>T</italic><sub><italic>s</italic></sub> one or two orders of magnitude below the smaller time constant.</p>
</sec>
</sec>
<sec id="sec006">
<title>Classifier module</title>
<sec id="sec007">
<title>Description</title>
<p>In the Laplace frequency domain used by SYSMOLE, each process <italic>i</italic> is described by a first-order system (associated with a first-order ODE), with a transfer function <italic>G</italic><sub><italic>i</italic></sub>(<italic>s</italic>) characterized by a gain parameter <italic>k</italic><sub><italic>i</italic></sub> and a time constant <italic>τ</italic><sub><italic>i</italic></sub> as follows:
<disp-formula id="pcbi.1005376.e010">
<alternatives>
<graphic id="pcbi.1005376.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e010" xlink:type="simple"/>
<mml:math display="block" id="M10">
<mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula>
where <inline-formula id="pcbi.1005376.e011"><alternatives><graphic id="pcbi.1005376.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005376.e012"><alternatives><graphic id="pcbi.1005376.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>. Given two processes <italic>a</italic> and <italic>b</italic> described by first-order systems, and thus by first-order transfer functions <italic>G</italic><sub><italic>a</italic></sub>(<italic>s</italic>) and <italic>G</italic><sub><italic>b</italic></sub>(<italic>s</italic>) (e.g., those in <xref ref-type="fig" rid="pcbi.1005376.g002">Fig 2A</xref>) one can find only three truly different ways to combine them: cascade, feedback, and parallel (<xref ref-type="fig" rid="pcbi.1005376.g002">Fig 2B</xref>). We will refer to these configurations as canonical, since any combination of two first-order processes can be converted to one of these three configurations with a simple change in parameters [<xref ref-type="bibr" rid="pcbi.1005376.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref028">28</xref>]. Each canonical configuration has a corresponding block diagram as defined in Systems Theory [<xref ref-type="bibr" rid="pcbi.1005376.ref023">23</xref>] (<xref ref-type="fig" rid="pcbi.1005376.g002">Fig 2B</xref>, left) and yields a response with different dynamics (<xref ref-type="fig" rid="pcbi.1005376.g002">Fig 2B</xref>, right). Combining two first-order processes will result in a second-order transfer function characterized by two poles and one or no zeros. The dependence of the poles, zeros, and gain of <italic>G</italic>(<italic>s</italic>) on the parameters <italic>τ</italic><sub><italic>a</italic></sub>, <italic>τ</italic><sub><italic>b</italic></sub>, <italic>k</italic><sub><italic>a</italic></sub>, and <italic>k</italic><sub><italic>b</italic></sub> of the two first-order processes differs greatly between the three canonical configurations and provides each configuration with a characteristic signature (<xref ref-type="supplementary-material" rid="pcbi.1005376.s001">S1 Fig</xref>).</p>
<fig id="pcbi.1005376.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005376.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Second-order canonical configurations.</title>
<p>(<bold>A</bold>) Example of two first-order processes, <italic>a</italic> and <italic>b</italic>, described by first-order transfer functions <italic>G</italic><sub><italic>a</italic></sub>(<italic>s</italic>) and <italic>G</italic><sub><italic>b</italic></sub>(<italic>s</italic>) with parameters <italic>τ</italic><sub><italic>a</italic></sub> = 5 ms and <italic>k</italic><sub><italic>a</italic></sub> = -1, and <italic>τ</italic><sub><italic>b</italic></sub> = 100 ms and <italic>k</italic><sub><italic>b</italic></sub> = 1, and their responses in time (outputs <italic>y</italic><sub><italic>a</italic></sub>(<italic>t</italic>) and <italic>y</italic><sub><italic>b</italic></sub>(<italic>t</italic>)) to an ideal step input at <italic>t</italic> = 30 ms (<italic>u</italic>(<italic>t</italic>)). (<bold>B</bold>) Block diagram (left) and corresponding output <italic>y</italic>(<italic>t</italic>) (right) in response to a step input <italic>u</italic>(<italic>t</italic>) of the first-order processes <italic>G</italic><sub><italic>a</italic></sub>(<italic>s</italic>) and <italic>G</italic><sub><italic>b</italic></sub>(<italic>s</italic>) combined following the three canonical configurations: cascade, feedback and parallel.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005376.g002" xlink:type="simple"/>
</fig>
<p>Given two first-order systems <italic>G</italic><sub><italic>a</italic></sub>(<italic>s</italic>) and <italic>G</italic><sub><italic>b</italic></sub>(<italic>s</italic>) described by first-order transfer functions <inline-formula id="pcbi.1005376.e013"><alternatives><graphic id="pcbi.1005376.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005376.e014"><alternatives><graphic id="pcbi.1005376.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>, one can analytically derive the transfer functions resulting from combining these two processes following each canonical configuration and obtain:
<disp-formula id="pcbi.1005376.e015">
<alternatives>
<graphic id="pcbi.1005376.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e015" xlink:type="simple"/>
<mml:math display="block" id="M15">
<mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula>
<disp-formula id="pcbi.1005376.e016">
<alternatives>
<graphic id="pcbi.1005376.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e016" xlink:type="simple"/>
<mml:math display="block" id="M16">
<mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>b</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula>
<disp-formula id="pcbi.1005376.e017">
<alternatives>
<graphic id="pcbi.1005376.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e017" xlink:type="simple"/>
<mml:math display="block" id="M17">
<mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula>
As discussed above, each of these transfer functions has distinct features in terms of poles, zeros, and gain (<italic>τ</italic><sub><italic>pole</italic>1</sub>, <italic>τ</italic><sub><italic>pole</italic>2</sub>, <italic>τ</italic><sub><italic>zero</italic></sub>, and <italic>Gain</italic>). The Classifier Module capitalizes on these differences and determines which canonical configuration corresponds to the transfer function obtained by the Identifier Module, <italic>G</italic>(<italic>s</italic>), by comparing the transfer function features of <italic>G</italic>(<italic>s</italic>) to those of the canonical <italic>G</italic>(<italic>s</italic>)<sub><italic>cascade</italic></sub>, <italic>G</italic>(<italic>s</italic>)<sub><italic>feedback</italic></sub>, and <italic>G</italic>(<italic>s</italic>)<sub><italic>parallel</italic></sub>.</p>
</sec>
<sec id="sec008">
<title>Implementation</title>
<p>The Classifier Module is implemented as a series of comparisons between <italic>G</italic>(<italic>s</italic>) and the canonical transfer functions (<xref ref-type="disp-formula" rid="pcbi.1005376.e015">8</xref>), (<xref ref-type="disp-formula" rid="pcbi.1005376.e016">9</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1005376.e017">10</xref>) (<xref ref-type="fig" rid="pcbi.1005376.g003">Fig 3</xref>). It tests sequentially whether the transfer function features for a particular configuration are found in <italic>G</italic>(<italic>s</italic>). Transfer functions arising from systems with more than two processes are characterized by more than two poles. Similarly, first-order transfer functions are characterized by having only one pole and no zeros and can be easily distinguished. From the second-order transfer functions, characterized by two poles, those arising from a cascade configuration have no zeros and are easily classified as well. However, discerning between parallel and feedback configurations constitutes a more challenging task.</p>
<fig id="pcbi.1005376.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005376.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Classifier Module implementation.</title>
<p>Classifier Module flow chart implementation of the comparison between <italic>G</italic>(<italic>s</italic>), the transfer function obtained by the Identifier Module, and the transfer functions associated with the canonical configurations. This module tests sequentially whether <italic>G</italic>(<italic>s</italic>) incorporates the features of a transfer function describing a higher-order system, a first-order system, or a second-order system in each of the canonical configurations: cascade, feedback or parallel. The cost function values for the parallel and feedback optimization problems, <italic>f</italic><sub><italic>valp</italic></sub> and <italic>f</italic><sub><italic>valf</italic></sub> respectively, are used to discern between these two canonical configurations as explained in the <italic>Results</italic> section.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005376.g003" xlink:type="simple"/>
</fig>
<p>It can be mathematically demonstrated that for every transfer function <italic>G</italic>(<italic>s</italic>) with two poles and one zero arising from two fist-order processes, one can find a set of first-order systems <italic>G</italic><sub><italic>af</italic></sub>(<italic>s</italic>) and <italic>G</italic><sub><italic>bf</italic></sub>(<italic>s</italic>) which, when combined in feedback, will result in <italic>G</italic>(<italic>s</italic>). It can also be demonstrated that one can find an analogous set of first-order systems <italic>G</italic><sub><italic>ap</italic></sub>(<italic>s</italic>) and <italic>G</italic><sub><italic>bp</italic></sub>(<italic>s</italic>) which, when combined in parallel, will result <italic>G</italic>(<italic>s</italic>) (<xref ref-type="supplementary-material" rid="pcbi.1005376.s003">S1 Text</xref>). To distinguish between the two configurations one needs to constrain the problem by imposing additional conditions on the possible values of <italic>τ</italic><sub><italic>a</italic></sub>, <italic>τ</italic><sub><italic>b</italic></sub>, <italic>k</italic><sub><italic>a</italic></sub>, and <italic>k</italic><sub><italic>b</italic></sub>. Typically, we are able to provide a range for the speed and strength of each process under study and therefore adding this type of constraint does not constitute a complex task. As an example, from the trace depicted on the introductory figure (<xref ref-type="fig" rid="pcbi.1005376.g001">Fig 1A</xref>, bottom), one can easily constrain the activation process (fast downward inflection) to have a time constant ranging from 1 to 50 <italic>ms</italic>, and the inactivation process (slow upward inflection) to have a time constant greater than 50 <italic>ms</italic>. Similarly, one can restrict the exploration of the parameter space to activation and inactivation gains between -0.2 to 0.2 nA/mV.</p>
<p>The Classifier Module then decides between the feedback and parallel configurations by solving two constrained optimization problems (<xref ref-type="fig" rid="pcbi.1005376.g003">Fig 3</xref>). These two problems are defined by comparing the second-order transfer function <italic>G</italic>(<italic>s</italic>) characterized by a 4-parameter set, either (<italic>τ</italic><sub><italic>pole</italic>1</sub>, <italic>τ</italic><sub><italic>pole</italic>2</sub>, <italic>τ</italic><sub><italic>zero</italic></sub>, and <italic>Gain</italic>) or (<italic>B</italic>0, <italic>B</italic>1, <italic>A</italic>1, and <italic>A</italic>0),
<disp-formula id="pcbi.1005376.e018">
<alternatives>
<graphic id="pcbi.1005376.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e018" xlink:type="simple"/>
<mml:math display="block" id="M18">
<mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula>
to <italic>G</italic>(<italic>s</italic>)<sub><italic>feedback</italic></sub> and <italic>G</italic>(<italic>s</italic>)<sub><italic>parallel</italic></sub>. We define the feedback optimization problem by comparing (<xref ref-type="disp-formula" rid="pcbi.1005376.e018">11</xref>) to (<xref ref-type="disp-formula" rid="pcbi.1005376.e016">9</xref>). Solving the problem thus amounts to determining whether there is a solution for the following system of equations within the range of values allowed for the parameters <italic>ω</italic><sub><italic>a</italic></sub>, <italic>ω</italic><sub><italic>b</italic></sub>, <italic>b</italic><sub><italic>a</italic></sub>, and <italic>b</italic><sub><italic>b</italic></sub>
<disp-formula id="pcbi.1005376.e019">
<alternatives>
<graphic id="pcbi.1005376.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e019" xlink:type="simple"/>
<mml:math display="block" id="M19">
<mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula>
Computationally we solve this problem as an optimization problem in which we minimize the quadratic cost function derived from the system of equations in (<xref ref-type="disp-formula" rid="pcbi.1005376.e019">12</xref>)
<disp-formula id="pcbi.1005376.e020">
<alternatives>
<graphic id="pcbi.1005376.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e020" xlink:type="simple"/>
<mml:math display="block" id="M20">
<mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula>
subjected to the constraints, <italic>ω</italic><sub><italic>amin</italic></sub> ≤ <italic>ω</italic><sub><italic>a</italic></sub> ≤ <italic>ω</italic><sub><italic>amax</italic></sub>, <italic>ω</italic><sub><italic>bmin</italic></sub> ≤ <italic>ω</italic><sub><italic>b</italic></sub> ≤ <italic>ω</italic><sub><italic>bmax</italic></sub>, <italic>b</italic><sub><italic>amin</italic></sub> ≤ <italic>b</italic><sub><italic>a</italic></sub> ≤ <italic>b</italic><sub><italic>amax</italic></sub>, and <italic>b</italic><sub><italic>bmin</italic></sub> ≤ <italic>b</italic><sub><italic>b</italic></sub> ≤ <italic>b</italic><sub><italic>bmax</italic></sub>.</p>
<p>We define analogously the parallel optimization problem. Given the transfer function for the parallel system
<disp-formula id="pcbi.1005376.e021">
<alternatives>
<graphic id="pcbi.1005376.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e021" xlink:type="simple"/>
<mml:math display="block" id="M21">
<mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula>
and the equivalent system of equations
<disp-formula id="pcbi.1005376.e022">
<alternatives>
<graphic id="pcbi.1005376.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e022" xlink:type="simple"/>
<mml:math display="block" id="M22">
<mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula>
we can computationally find the solution as an optimization problem in which we minimize the quadratic cost function
<disp-formula id="pcbi.1005376.e023">
<alternatives>
<graphic id="pcbi.1005376.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e023" xlink:type="simple"/>
<mml:math display="block" id="M23">
<mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula>
subjected to the constraints, <italic>ω</italic><sub><italic>amin</italic></sub> ≤ <italic>ω</italic><sub><italic>a</italic></sub> ≤ <italic>ω</italic><sub><italic>amax</italic></sub>, <italic>ω</italic><sub><italic>bmin</italic></sub> ≤ <italic>ω</italic><sub><italic>b</italic></sub> ≤ <italic>ω</italic><sub><italic>bmax</italic></sub>, <italic>b</italic><sub><italic>amin</italic></sub> ≤ <italic>b</italic><sub><italic>a</italic></sub> ≤ <italic>b</italic><sub><italic>amax</italic></sub>, and <italic>b</italic><sub><italic>bmin</italic></sub> ≤ <italic>b</italic><sub><italic>b</italic></sub> ≤ <italic>b</italic><sub><italic>bmax</italic></sub>.</p>
<p>The cost function values <italic>f</italic><sub><italic>valf</italic></sub> and <italic>f</italic><sub><italic>valp</italic></sub> provide a quantitative measure of the match between <italic>G</italic>(<italic>s</italic>) and <italic>G</italic>(<italic>s</italic>)<sub><italic>feedback</italic></sub>, and <italic>G</italic>(<italic>s</italic>)<sub><italic>parallel</italic></sub> respectively, provided that the constraints are sufficient to distinguish both processes (<xref ref-type="supplementary-material" rid="pcbi.1005376.s003">S1 Text</xref>). A value of <italic>f</italic><sub><italic>valf</italic></sub> greater than <italic>f</italic><sub><italic>valp</italic></sub> indicates that <italic>G</italic>(<italic>s</italic>) arose from two processes combined in parallel. Conversely, a value of <italic>f</italic><sub><italic>valp</italic></sub> greater than <italic>f</italic><sub><italic>valf</italic></sub> indicates a transfer function <italic>G</italic>(<italic>s</italic>) associated with two processes combined following the feedback configuration (<xref ref-type="fig" rid="pcbi.1005376.g003">Fig 3</xref>). We studied the convergence properties of these two optimization problems for a large number of combinations and a wide value range for parameters <italic>τ</italic><sub><italic>a</italic></sub>, <italic>τ</italic><sub><italic>b</italic></sub>, <italic>k</italic><sub><italic>a</italic></sub>, and <italic>k</italic><sub><italic>b</italic></sub>. Our results confirmed the robustness of this implementation to discern between parallel and feedback configurations (<xref ref-type="supplementary-material" rid="pcbi.1005376.s002">S2 Fig</xref>). Similar principles can be applied to third-order systems by including more optimization problems in the implementation (see <xref ref-type="supplementary-material" rid="pcbi.1005376.s003">S1 Text</xref> section 3 for a description of a Classifier Module for transfer functions with three poles and two zeros).</p>
</sec>
</sec>
<sec id="sec009">
<title>Molecular kinetic converter</title>
<sec id="sec010">
<title>Description</title>
<p>In general, obtaining a molecular kinetic scheme associated with a given transfer function <italic>G</italic>(<italic>s</italic>) represents an underdetermined problem with multiple possible solutions [<xref ref-type="bibr" rid="pcbi.1005376.ref018">18</xref>]. Here we show we can use biological principles and our prior information about the biological system under study to constrain the problem and obtain a unique solution. This task, which is analytical as opposed to computational, is implemented by the Molecular Kinetic Converter Module (MKC). Implementing the biological constraints in mathematical/analytical terms is not straightforward. The MKC is implemented as a set of rules or steps that impose different biological/physical principles on the transfer function <italic>G</italic>(<italic>s</italic>) obtained by the Identifier Module, and are based on the block diagram (configuration) derived by the Classifier Module for that particular transfer function. It should be emphasized that the MKC strictly derives a Markov-chain state model and that the interpretation of what each state represents in molecular terms will depend on the experimental conditions in which traces are obtained.</p>
</sec>
<sec id="sec011">
<title>Implementation</title>
<p>Our methodology converts the <italic>G</italic>(<italic>s</italic>) and block diagram (configuration) into a Markov-chain molecular kinetic scheme by implementing the following four principles:</p>
<list list-type="order">
<list-item><p><italic>Number of states and possible transitions</italic>. The number of processes that can be extracted from the input and output traces is established by the order <italic>n</italic> of the transfer function <italic>G</italic>(<italic>s</italic>). The relationship between these processes in the biological system, which is determined by the configuration, defines the possible transitions in the system.</p></list-item>
<list-item><p><italic>Mass conservation</italic>. Mass should be conserved and thus the total amount of molecules, which is the sum of the occupancies of all the states in the system, has to remain constant. Importantly, although ideally all possible states should be described, additional biologically possible states not detected by our experimental assay might be lumped into one state. Furthermore, if one of the processes is removing a given species from the system, through degradation for example, a ‘degraded’ state will need to be included to satisfy this condition.</p></list-item>
<list-item><p><italic>Microscopic reversibility</italic>. Corresponding to every individual set of transitions that takes a molecule through several states back to its original state (forward drive), there is a reverse set of transitions (reverse drive) such that in a state of equilibrium the average rate of the forward drive is equal to the average rate of its reverse drive. In other words, although the macroscopic law of mass action reactions can be used to describe processes that perpetually circle through states, at the molecular level the microscopic reversibility principle states that molecules do not possess infinite energy to remain in constant motion. In our case, a constant circular flow of transitions involving three or more states would contradict this principle and thus would result in a molecular kinetic scheme not biologically possible [<xref ref-type="bibr" rid="pcbi.1005376.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref030">30</xref>].</p></list-item>
<list-item><p><italic>Observable state</italic>. Our experimental assay will typically only allow us to measure one of the states of the biological system, such as the open state of a channel or the activated form of a protein. This observable state should be identified since its occupancy as a function of time is related directly to the measured value of the output signal <italic>y</italic>(<italic>t</italic>).</p></list-item>
</list>
<p>The molecular kinetic scheme associated with the transfer function <italic>G</italic>(<italic>s</italic>) which satisfies the previous four principles can be derived as follows:</p>
<list list-type="order">
<list-item><p>Identify the nodes in the block diagram. The number of states (<italic>N</italic><sub><italic>s</italic></sub>) is equal to the number of nodes and equal to <italic>n</italic> + 1. In the context of this analytical tool, nodes are the points in the block diagram located at the entrance and at the exit of each block (operation blocks like addition and subtraction only add one node). It should be noted that these rules provide the molecular kinetic scheme with the smallest number of states to represent the number of detected first-order processes <italic>n</italic>. More states might exist at the microscopic level that would be collapsed into one of the states. The fractional occupancy in each state <italic>i</italic> is described by a time-dependent state variable <italic>z</italic><sub><italic>i</italic></sub>(<italic>t</italic>) where <italic>i</italic> = 1 … <italic>n</italic> + 1.</p></list-item>
<list-item><p>Include <italic>r</italic> transitions between nodes for each connection described in the block diagram with rates <italic>σ</italic><sub><italic>k</italic></sub> with <italic>k</italic> = 1 … <italic>r</italic>. The value of the signal at a node in a block diagram can be negative, however negative fractional occupancies of a state are not interpretable. In order to implement negative values and subtractions in the molecular kinetic scheme, invert the flow of the signal and the transition (<xref ref-type="fig" rid="pcbi.1005376.g004">Fig 4</xref>).
<fig id="pcbi.1005376.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005376.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Molecular Kinetic Converter Module implementation.</title>
<p>Molecular kinetic schemes derived from block diagrams for first-order systems (<bold>A</bold>), second-order systems in cascade (<bold>B</bold>), second-order systems in feedback (<bold>C</bold>), second-order in parallel addition (<bold>D</bold>), and second-order systems in parallel subtraction (<bold>E</bold>) configurations. Red circles indicate the observable state for each configuration. Black and blue circles depict non-observable states. The supporting material (<xref ref-type="supplementary-material" rid="pcbi.1005376.s003">S1 Text</xref>) provides, based on the steps described in the main text, a complete derivation of the molecular kinetic scheme corresponding to each configuration. It also includes, for each configuration, the equations that describe the transition rates between states (<italic>σ</italic><sub><italic>k</italic></sub>) and the observable proportionality constant (<italic>γ</italic>) as a function of the pole and zero time constants (<italic>τ</italic><sub><italic>pole1</italic></sub>, <italic>τ</italic><sub><italic>pole</italic>2</sub>, and <italic>τ</italic><sub><italic>zero</italic></sub>), and the gain of the system.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005376.g004" xlink:type="simple"/>
</fig></p></list-item>
<list-item><p>Check whether the principle of microscopic reversibility is satisfied by the molecular kinetic scheme. If any perpetual circular flows involving three or more states are present, offset it by adding an equivalent flow in the opposite direction using only the kinetic parameters of the system <italic>σ</italic><sub><italic>k</italic></sub>, to avoid increasing the number of degrees of freedom <italic>r</italic>.</p></list-item>
<list-item><p>Generate the following system of equations in the time domain
<list list-type="alpha-lower">
<list-item><p><italic>N</italic><sub><italic>s</italic></sub> − 1 Ordinary Differential Equations (ODEs) describing the transitions between the states of the form
<disp-formula id="pcbi.1005376.e024">
<alternatives>
<graphic id="pcbi.1005376.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e024" xlink:type="simple"/>
<mml:math display="block" id="M24">
<mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>1</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mspace width="2em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.25em"/><mml:mo>…</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(17)</label>
</disp-formula>
where <italic>l</italic> is the number of transitions coming into the state <italic>i</italic>, and <italic>m</italic> is the number of transitions leaving the state <italic>i</italic>. These equations follow the hypothesis of a Markov chain (i.e. the rates <italic>σ</italic> are independent of time and the state variables <italic>z</italic><sub><italic>i</italic></sub>(<italic>t</italic>)) and can be assimilated to Kirchhoff’s First Law for circuit analysis.</p></list-item>
<list-item><p>1 equation relating the observable state variable <italic>z</italic><sub><italic>obs</italic></sub>(<italic>t</italic>) to the output <italic>y</italic>(<italic>t</italic>) through a proportionality constant <italic>γ</italic> (Observable Equation).
<disp-formula id="pcbi.1005376.e025">
<alternatives>
<graphic id="pcbi.1005376.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e025" xlink:type="simple"/>
<mml:math display="block" id="M25">
<mml:mi>y</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(18)</label>
</disp-formula></p>
<p>Although for the experimental traces analyzed in the present work a simple proportionality constant provided was a sufficient model, it is not necessary for the output to strictly be proportional to the observation. If the relationship between the observed state and the measurement is known and can be characterized by another transfer function in the frequency domain <italic>γ</italic>(<italic>s</italic>) this can be included in the relationship (<xref ref-type="disp-formula" rid="pcbi.1005376.e025">18</xref>).</p></list-item>
<list-item><p>1 equation that establishes mass conservation. It is hard to implement the input signal in Markov chain models. Through the mass-conservation equation we can include the input <italic>u</italic>(<italic>t</italic>) as the unique force driving the change in number of molecules in each state as a function of time <italic>z</italic><sub><italic>i</italic></sub>(<italic>t</italic>) of the system that we assume to be initially at steady state. By enforcing
<disp-formula id="pcbi.1005376.e026">
<alternatives>
<graphic id="pcbi.1005376.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e026" xlink:type="simple"/>
<mml:math display="block" id="M26">
<mml:mi>u</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(19)</label>
</disp-formula>
we guarantee that the total number of molecules in the system is equal to the total amount of molecules before the input, together with the molecules provided by the input. This also ensures that molecules are neither created nor destroyed. For an input step, as the ones <italic>u</italic>(<italic>t</italic>) is a constant that we can normalize to 1, and <italic>z</italic><sub><italic>i</italic></sub>(<italic>t</italic>) can be interpreted as fractional occupancies in the classic ion channel sense. For simplicity, and given that this study focuses on experimental systems in which the input is a step, we will refer to <italic>z</italic><sub><italic>i</italic></sub>(<italic>t</italic>) as fractional occupancies hereinafter. This can however be extended to inputs with any type of dynamics, which is one of the strengths of the method. It should be emphasized that the principles of mass conservation and microscopy reversibility are only imposed on the state fractional occupancies and transition rates which are affected by the particular stimulus or input under study. Other states whose fractional occupancies remain constant or at steady-state could exist, but will not be included in the description.</p></list-item>
</list></p></list-item>
<list-item><p>Laplace transform the system of equations
<disp-formula id="pcbi.1005376.e027">
<alternatives>
<graphic id="pcbi.1005376.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e027" xlink:type="simple"/>
<mml:math display="block" id="M27">
<mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mspace width="2em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.25em"/><mml:mo>…</mml:mo><mml:mspace width="0.25em"/><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>Y</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>U</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(20)</label>
</disp-formula>
where <italic>z</italic><sub><italic>i</italic></sub>(0) is the value of the state variable at the initial time. Typically, one can choose the states where <italic>z</italic><sub><italic>i</italic></sub>(0) = 0 to be in the differential equations to simplify the resolution of the system. The “input” state, in which the system has initially a fractional occupancy of 1, is then included in the mass conservation equation. It should be noted however that the approach can be applied for any initial distribution of fractional occupancies amongst states.</p></list-item>
<list-item><p>To obtain the transfer function of the kinetic model <italic>G</italic>(<italic>s</italic>)<sub><italic>kin</italic></sub> we isolate
<disp-formula id="pcbi.1005376.e028">
<alternatives>
<graphic id="pcbi.1005376.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e028" xlink:type="simple"/>
<mml:math display="block" id="M28">
<mml:mfrac><mml:mrow><mml:mi>Y</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>U</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>C</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(21)</label>
</disp-formula>
where <italic>C</italic>, <italic>D</italic><sub><italic>j</italic></sub> and <italic>A</italic><sub><italic>j</italic></sub> are constants.</p></list-item>
<list-item><p>Using block algebra we obtain the transfer function in terms of the first-order systems
<disp-formula id="pcbi.1005376.e029">
<alternatives>
<graphic id="pcbi.1005376.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e029" xlink:type="simple"/>
<mml:math display="block" id="M29">
<mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(22)</label>
</disp-formula>
where <italic>c</italic>, <italic>d</italic><sub><italic>j</italic></sub> and <italic>a</italic><sub><italic>j</italic></sub> are constants (see Eqs <xref ref-type="disp-formula" rid="pcbi.1005376.e015">8</xref>, <xref ref-type="disp-formula" rid="pcbi.1005376.e016">9</xref> and <xref ref-type="disp-formula" rid="pcbi.1005376.e017">10</xref> for examples).</p></list-item>
<list-item><p>Solve the following system of equations
<disp-formula id="pcbi.1005376.e030">
<alternatives>
<graphic id="pcbi.1005376.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e030" xlink:type="simple"/>
<mml:math display="block" id="M30">
<mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="2em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.20em"/><mml:mo>…</mml:mo><mml:mspace width="0.20em"/><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="4em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.20em"/><mml:mo>…</mml:mo><mml:mspace width="0.20em"/><mml:mi>n</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.35em"/><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(23)</label>
</disp-formula>
where the third equation in the system equals the steady state gain of <italic>G</italic>(<italic>s</italic>) and <italic>G</italic>(<italic>s</italic>)<sub><italic>kin</italic></sub>, for the parameters of the molecular kinetic scheme
<disp-formula id="pcbi.1005376.e031">
<alternatives>
<graphic id="pcbi.1005376.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e031" xlink:type="simple"/>
<mml:math display="block" id="M31">
<mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(24)</label>
</disp-formula>
<disp-formula id="pcbi.1005376.e032">
<alternatives>
<graphic id="pcbi.1005376.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e032" xlink:type="simple"/>
<mml:math display="block" id="M32">
<mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(25)</label>
</disp-formula></p></list-item>
</list>
<p>It is straightforward to test that these rules yield the correct molecular kinetic scheme as any mistake in the steps will result in a system of equations without solutions at step 8 when comparing the coefficients on <italic>G</italic>(<italic>s</italic>)<sub><italic>kin</italic></sub> and the <italic>G</italic>(<italic>s</italic>) derived from the block algebra (<xref ref-type="supplementary-material" rid="pcbi.1005376.s003">S1 Text</xref> section 2.5). As an illustration of the application of these steps, we present below the derivation the molecular kinetic scheme associated with a first-order system (<xref ref-type="fig" rid="pcbi.1005376.g004">Fig 4A</xref>):</p>
<list list-type="order">
<list-item><p>Number of states = <italic>n</italic> + 1 = 2</p></list-item>
<list-item><p>We identify the nodes and include the transitions in the diagram.</p></list-item>
<list-item><p>We check that the principle of microscopic reversibility is satisfied.</p></list-item>
<list-item><p>We build the system of equations
<disp-formula id="pcbi.1005376.e033">
<alternatives>
<graphic id="pcbi.1005376.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e033" xlink:type="simple"/>
<mml:math display="block" id="M33">
<mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mspace width="2em"/><mml:mi mathvariant="normal">ODE</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">Transition</mml:mi><mml:mspace width="0.25em"/><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>y</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mspace width="2em"/><mml:mi mathvariant="normal">Observable</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">Equation</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.25em"/><mml:mrow><mml:mi>u</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mspace width="1.5em"/><mml:mi mathvariant="normal">Mass</mml:mi><mml:mspace width="0.25em"/><mml:mi>Equation</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(26)</label>
</disp-formula></p></list-item>
<list-item><p>We Laplace transform the system
<disp-formula id="pcbi.1005376.e034">
<alternatives>
<graphic id="pcbi.1005376.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e034" xlink:type="simple"/>
<mml:math display="block" id="M34">
<mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mspace width="2em"/><mml:mi mathvariant="normal">T</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.25em"/><mml:mrow><mml:mi>Y</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mspace width="3.5em"/><mml:mi mathvariant="normal">O</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>U</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mspace width="0.75em"/><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
<label>(27)</label>
</disp-formula></p></list-item>
<list-item><p>We obtain <italic>G</italic>(<italic>s</italic>)<sub><italic>kin</italic></sub> by isolating <inline-formula id="pcbi.1005376.e035"><alternatives><graphic id="pcbi.1005376.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mfrac><mml:mrow><mml:mi>Y</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>U</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> from equations T1, O and M.
<disp-formula id="pcbi.1005376.e036">
<alternatives>
<graphic id="pcbi.1005376.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e036" xlink:type="simple"/>
<mml:math display="block" id="M36">
<mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>Y</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>U</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(28)</label>
</disp-formula></p></list-item>
<list-item><p>From the block diagram we obtain <italic>G</italic>(<italic>s</italic>)
<disp-formula id="pcbi.1005376.e037">
<alternatives>
<graphic id="pcbi.1005376.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e037" xlink:type="simple"/>
<mml:math display="block" id="M37">
<mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(29)</label>
</disp-formula></p></list-item>
<list-item><p>Through comparison of the terms in <italic>G</italic>(<italic>s</italic>)<sub><italic>kin</italic></sub> and <italic>G</italic>(<italic>s</italic>) we obtain the parameters of the molecular kinetic scheme
<disp-formula id="pcbi.1005376.e038">
<alternatives>
<graphic id="pcbi.1005376.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e038" xlink:type="simple"/>
<mml:math display="block" id="M38">
<mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(30)</label>
</disp-formula>
<disp-formula id="pcbi.1005376.e039">
<alternatives>
<graphic id="pcbi.1005376.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e039" xlink:type="simple"/>
<mml:math display="block" id="M39">
<mml:msub><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>⇒</mml:mo><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(31)</label>
</disp-formula></p></list-item>
</list>
<p>A complete description of the application of these steps to derive the molecular kinetic schemes corresponding to the three possible canonical configurations for second-order systems (<xref ref-type="fig" rid="pcbi.1005376.g004">Fig 4B, 4C, 4D and 4E</xref>) is provided in the supporting material (<xref ref-type="supplementary-material" rid="pcbi.1005376.s003">S1 Text</xref>). Indications on how these steps could be easily scaled to higher-order systems by taking a module-based approach are also provided. The values of the kinetic parameters <italic>σ</italic><sub><italic>i</italic></sub> and <italic>γ</italic> of the four possible second-order molecular kinetic schemes are detailed below. It is important to note that, based on step 2, the parallel configuration will yield two different molecular kinetic schemes depending on whether the first-order systems <italic>G</italic><sub><italic>a</italic></sub> and <italic>G</italic><sub><italic>b</italic></sub> are added or subtracted.</p>
<list list-type="order">
<list-item><p>Second-order system in cascade configuration (<xref ref-type="fig" rid="pcbi.1005376.g004">Fig 4B</xref>)
<disp-formula id="pcbi.1005376.e040">
<alternatives>
<graphic id="pcbi.1005376.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e040" xlink:type="simple"/>
<mml:math display="block" id="M40">
<mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(32)</label>
</disp-formula>
<disp-formula id="pcbi.1005376.e041">
<alternatives>
<graphic id="pcbi.1005376.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e041" xlink:type="simple"/>
<mml:math display="block" id="M41">
<mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(33)</label>
</disp-formula>
<disp-formula id="pcbi.1005376.e042">
<alternatives>
<graphic id="pcbi.1005376.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e042" xlink:type="simple"/>
<mml:math display="block" id="M42">
<mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(34)</label>
</disp-formula></p></list-item>
<list-item><p>Second-order system in feedback configuration (<xref ref-type="fig" rid="pcbi.1005376.g004">Fig 4C</xref>)
<disp-formula id="pcbi.1005376.e043">
<alternatives>
<graphic id="pcbi.1005376.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e043" xlink:type="simple"/>
<mml:math display="block" id="M43">
<mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(35)</label>
</disp-formula>
<disp-formula id="pcbi.1005376.e044">
<alternatives>
<graphic id="pcbi.1005376.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e044" xlink:type="simple"/>
<mml:math display="block" id="M44">
<mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(36)</label>
</disp-formula>
<disp-formula id="pcbi.1005376.e045">
<alternatives>
<graphic id="pcbi.1005376.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e045" xlink:type="simple"/>
<mml:math display="block" id="M45">
<mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(37)</label>
</disp-formula>
<disp-formula id="pcbi.1005376.e046">
<alternatives>
<graphic id="pcbi.1005376.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e046" xlink:type="simple"/>
<mml:math display="block" id="M46">
<mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(38)</label>
</disp-formula></p></list-item>
<list-item><p>Second-order system in parallel addition configuration (<xref ref-type="fig" rid="pcbi.1005376.g004">Fig 4D</xref>)
<disp-formula id="pcbi.1005376.e047">
<alternatives>
<graphic id="pcbi.1005376.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e047" xlink:type="simple"/>
<mml:math display="block" id="M47">
<mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(39)</label>
</disp-formula>
<disp-formula id="pcbi.1005376.e048">
<alternatives>
<graphic id="pcbi.1005376.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e048" xlink:type="simple"/>
<mml:math display="block" id="M48">
<mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(40)</label>
</disp-formula>
<disp-formula id="pcbi.1005376.e049">
<alternatives>
<graphic id="pcbi.1005376.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e049" xlink:type="simple"/>
<mml:math display="block" id="M49">
<mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(41)</label>
</disp-formula>
<disp-formula id="pcbi.1005376.e050">
<alternatives>
<graphic id="pcbi.1005376.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e050" xlink:type="simple"/>
<mml:math display="block" id="M50">
<mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(42)</label>
</disp-formula></p></list-item>
<list-item><p>Second-order system in parallel subtraction configuration (<xref ref-type="fig" rid="pcbi.1005376.g004">Fig 4E</xref>)
<disp-formula id="pcbi.1005376.e051">
<alternatives>
<graphic id="pcbi.1005376.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e051" xlink:type="simple"/>
<mml:math display="block" id="M51">
<mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(43)</label>
</disp-formula>
<disp-formula id="pcbi.1005376.e052">
<alternatives>
<graphic id="pcbi.1005376.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e052" xlink:type="simple"/>
<mml:math display="block" id="M52">
<mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(44)</label>
</disp-formula>
<disp-formula id="pcbi.1005376.e053">
<alternatives>
<graphic id="pcbi.1005376.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e053" xlink:type="simple"/>
<mml:math display="block" id="M53">
<mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(45)</label>
</disp-formula>
<disp-formula id="pcbi.1005376.e054">
<alternatives>
<graphic id="pcbi.1005376.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e054" xlink:type="simple"/>
<mml:math display="block" id="M54">
<mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(46)</label>
</disp-formula></p></list-item>
</list>
</sec>
</sec>
<sec id="sec012">
<title>SYSMOLE distinguishes different molecular kinetic schemes from similar macroscopic traces</title>
<p>We decided to test first the ability of SYSMOLE to tackle a general class of problems in biology: distinguishing whether two similar macroscopic traces arise from different molecular kinetic schemes. Elucidating the molecular mechanisms of ion-channel inactivation from macroscopic current traces constitutes a classic biophysics problem in this class (see [<xref ref-type="bibr" rid="pcbi.1005376.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref031">31</xref>] for a review on the topic). Many of these molecular mechanisms were identified in the eighties and the nineties for different types of ion channels through single-channel electrophysiology recordings, fluctuation analysis, and analysis of gating currents [<xref ref-type="bibr" rid="pcbi.1005376.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1005376.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref032">32</xref>]. However, analogous problems emerge in a great number of biological systems for which it is hard to design experiments to tease molecular schemes apart, or single-molecule experimental techniques are simply not yet available.</p>
<p>First we programmed an additional external module, the Synthetic Trace Simulator. This module generates a trace simulating each of the five molecular kinetic schemes associated with each configuration (<xref ref-type="fig" rid="pcbi.1005376.g004">Fig 4</xref>): first-order, second-order cascade, second-order feedback, second-order parallel addition, and second-order parallel subtraction. For practical purposes, in our implementation each molecular kinetic scheme is characterized by the parameters of two first-order processes <italic>a</italic> and <italic>b</italic> (<italic>k</italic><sub><italic>a</italic></sub>, <italic>k</italic><sub><italic>b</italic></sub>, <italic>τ</italic><sub><italic>a</italic></sub> and <italic>τ</italic><sub><italic>b</italic></sub>) and the kinetic parameters <italic>σ</italic><sub><italic>k</italic></sub> and <italic>γ</italic> derived from the equations detailed in the previous section. As a proof of concept, we used the Synthetic Trace Simulator to simulate voltage-clamp experiments and generate, in response to a step in voltage, the macroscopic current trace for molecular kinetic schemes that include first-order processes describing the activation and inactivation of ion channels (<xref ref-type="fig" rid="pcbi.1005376.g005">Fig 5</xref>). Emulating the classic biophysics problem, we compared two extremely similar macroscopic traces arising from different molecular kinetic schemes (compare left panels on <xref ref-type="fig" rid="pcbi.1005376.g005">Fig 5A and 5B</xref>). The first simulated current trace (<xref ref-type="fig" rid="pcbi.1005376.g005">Fig 5A</xref>) emerged from a molecular scheme in which inactivation affected both the closed and the open states of the channel (<xref ref-type="fig" rid="pcbi.1005376.g004">Fig 4D</xref>, black: closed state, blue: inactivated states, red: open state). The trace was generated with activation (<italic>a</italic>) and inactivation (<italic>b</italic>) processes defined by parameters <italic>k</italic><sub><italic>a</italic></sub> = -5, <italic>k</italic><sub><italic>b</italic></sub> = 2, <italic>τ</italic><sub><italic>a</italic></sub> = 5 ms, and <italic>τ</italic><sub><italic>b</italic></sub> = 200 ms. The second simulated current trace was generated with a molecular kinetic scheme where inactivation only acted on the open state (<xref ref-type="fig" rid="pcbi.1005376.g004">Fig 4C</xref>, black: closed state, red: open state, blue: inactivated state). This trace was obtained with a molecular kinetic scheme associated with first-order activation (<italic>a</italic>) and inactivation (<italic>b</italic>) processes with parameters <italic>k</italic><sub><italic>a</italic></sub> = -5, <italic>k</italic><sub><italic>b</italic></sub> = 3, <italic>τ</italic><sub><italic>a</italic></sub> = 5 ms, and <italic>τ</italic><sub><italic>b</italic></sub> = 100 ms. We then analyzed both traces with SYSMOLE: first we identified the dynamics of the macroscopic trace elicited by the voltage step and summarized them in a transfer function <italic>G</italic>(<italic>s</italic>), then we classified <italic>G</italic>(<italic>s</italic>) to obtain the underlying configuration, and finally we obtained the corresponding molecular kinetic scheme using the MKC Module (<xref ref-type="fig" rid="pcbi.1005376.g005">Fig 5</xref>).</p>
<fig id="pcbi.1005376.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005376.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Similar traces from different molecular kinetic schemes.</title>
<p>Application of SYSMOLE to two similar synthetic traces in response to an ideal step at <italic>t</italic> = 30 ms. The top trace (<bold>A</bold>) was generated with the Synthetic Trace Simulator (see <italic><xref ref-type="sec" rid="sec002">Results</xref> </italic>section) by combining in parallel two processes with parameters <italic>k</italic><sub><italic>a</italic></sub> = - 5, <italic>k</italic><sub><italic>b</italic></sub> = 3, <italic>τ</italic><sub><italic>a</italic></sub> = 5, ms and <italic>τ</italic><sub><italic>b</italic></sub> = 100 ms. The correct molecular kinetic scheme was derived by SYSMOLE and the kinetic parameters obtained. The bottom trace (<bold>B</bold>) was also generated with the Synthetic Trace Simulator by combining in feedback two processes with parameters <italic>k</italic><sub><italic>a</italic></sub> = - 5, <italic>k</italic><sub><italic>b</italic></sub> = 2, <italic>τ</italic><sub><italic>a</italic></sub> = 5 ms and <italic>τ</italic><sub><italic>b</italic></sub> = 200 ms. The correct molecular kinetic scheme was derived by SYSMOLE and the kinetic parameters obtained. Boundary conditions used in the Classifier Module are <italic>τ</italic><sub><italic>a</italic></sub> ∈ [1, 9] ms, <italic>τ</italic><sub><italic>b</italic></sub> ∈ [50, 250] ms <italic>k</italic><sub><italic>a</italic></sub> ∈ [−20, 20], and <italic>k</italic><sub><italic>b</italic></sub> ∈ [−20, 20] for the parallel problem, and <italic>k</italic><sub><italic>b</italic></sub> ∈ [0, 20] for the feedback problem since combinations in feedback with <italic>k</italic><sub><italic>b</italic></sub> &lt; 0 are unstable.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005376.g005" xlink:type="simple"/>
</fig>
<p>Our results indicate that our methodology can accurately retrieve the molecular kinetic scheme of these two similar traces. Analogous tests with less similar traces were also performed with successful results. In order to control for a possible bias associated with using the same environments for simulation and analysis, two different implementations of the Synthetic Trace Simulator were tested with practically identical results (see <italic><xref ref-type="sec" rid="sec017">Materials and Methods</xref></italic>).</p>
</sec>
<sec id="sec013">
<title>SYSMOLE is robust to noise in the macroscopic trace</title>
<p>Our previous results had concluded that the system-identification approach presented in the first part of the Results section (SYSMOLE) could be successfully applied to accurately elucidate the molecular kinetic scheme underlying a given macroscopic trace. However, these studies had been performed in the absence of noise, an unrealistic situation in any biological experimental setting. We decided to test the effects of noise on the performance of SYSMOLE.</p>
<p>The robustness to noise of SYSMOLE will strongly depend on the features of the signals of interest and the type of noise existing on the trace. A useful approach to establish the reliability of SYSMOLE in the presence of noise is to simulate the types of experimental traces we are studying and test SYSMOLE when different levels of noise are added. We studied the effects of noise on the kinetic parameter values of the molecular kinetic scheme and the probability of error in classification of traces in which we observe a fast-activating process followed by a slower inactivation at the macroscopic level (<xref ref-type="fig" rid="pcbi.1005376.g005">Fig 5</xref>). These traces are representative of the types of traces obtained in voltage-clamp experiments with L-type calcium channels, and in the GPCR-heteromer signaling measurements presented in subsequent sections. By inspection of the traces (Figs <xref ref-type="fig" rid="pcbi.1005376.g005">5</xref> and <xref ref-type="fig" rid="pcbi.1005376.g006">6A</xref>) one can easily conclude that the two processes are not combined in cascade, since this would be incompatible with a signal that reverses direction in the <italic>y</italic> axis (see <xref ref-type="fig" rid="pcbi.1005376.g002">Fig 2</xref>). Therefore, we focused our analysis on how noise affects the distinction between the feedback and parallel configurations, which based on our preliminary tests, is more prone to error due to the presence of noise in the trace. Noise tests were performed for all configurations and a wide range of combinations of first order parameters for the activation and inactivation processes with similar results.</p>
<fig id="pcbi.1005376.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005376.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Effect of noise on kinetic parameters and probability of error in classification.</title>
<p>(<bold>A</bold>) Representative traces of output signal <italic>y</italic>(<italic>t</italic>) used to test the effects of noise. Traces were generated with the Synthetic Trace Module (see <italic><xref ref-type="sec" rid="sec002">Results</xref> </italic>section) combining two first-order processes with parameters <italic>k</italic><sub><italic>a</italic></sub> = - 5, <italic>k</italic><sub><italic>b</italic></sub> = 3, <italic>τ</italic><sub><italic>a</italic></sub> = 5 ms and <italic>τ</italic><sub><italic>b</italic></sub> = 100 ms in parallel with different levels of white Gaussian noise added. (<bold>B</bold>) Relative error in transition-rate kinetic parameters (<italic>σ</italic><sub>1</sub>, <italic>σ</italic><sub>2</sub>, and <italic>σ</italic><sub>3</sub>) and probability of error in detection for parallel and feedback configurations. Each point in the graph depicts the mean and standard deviation of 100 simulations. Boundary conditions used in the Classifier Module are <italic>τ</italic><sub><italic>a</italic></sub> ∈ [1, 9] ms, <italic>τ</italic><sub><italic>b</italic></sub> ∈ [50, 250] ms, <italic>k</italic><sub><italic>a</italic></sub> ∈ [−20, 20], and <italic>k</italic><sub><italic>b</italic></sub> ∈ [−20, 20] for the parallel problem, and <italic>k</italic><sub><italic>b</italic></sub> ∈ [0, 20] for the feedback problem since combinations in feedback with <italic>k</italic><sub><italic>b</italic></sub> &lt; 0 are unstable.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005376.g006" xlink:type="simple"/>
</fig>
<p>Specifically, with the aid of the Synthetic Trace Simulator we generated synthetic traces involving two first-order processes characterized by parameters <italic>τ</italic><sub><italic>a</italic></sub> = 5 ms, <italic>τ</italic><sub><italic>b</italic></sub> = 100 ms, <italic>k</italic><sub><italic>a</italic></sub> = −5, and <italic>k</italic><sub><italic>b</italic></sub> = 3, using the molecular kinetic scheme associated with either the parallel subtraction (<xref ref-type="fig" rid="pcbi.1005376.g004">Fig 4E</xref>) or the feedback (<xref ref-type="fig" rid="pcbi.1005376.g004">Fig 4C</xref>) configurations. We generated multiple traces for each molecular kinetic scheme, to which we added increasing levels of white Gaussian noise (<italic>N</italic> = 100 simulations per level of noise). We analyzed each trace with SYSMOLE and measured (i) the relative error of the transition rate parameter values from the molecular kinetic schemes <italic>σ</italic><sub>1</sub>, <italic>σ</italic><sub>2</sub> and <italic>σ</italic><sub>3</sub> (<xref ref-type="fig" rid="pcbi.1005376.g004">Fig 4D and 4E</xref>), and (ii) the probability of error in classification (<italic>P</italic><sub><italic>e</italic></sub>) defined as the ratio between the number of correct classifications and the total number of simulations at a given level of noise (<xref ref-type="fig" rid="pcbi.1005376.g006">Fig 6B</xref>). It should be noted that the scaling factor <italic>γ</italic> is an adjustable parameter that shapes the amplitude of the signal and its sensitivity to noise has less relevance than the transition rates or the configuration.</p>
<p>In our analysis, traces arising from molecular kinetic schemes associated with the parallel and feedback configurations had similar robustness to noise (<xref ref-type="fig" rid="pcbi.1005376.g006">Fig 6B</xref>). The relative errors in the transition rate kinetic parameters began to degrade at a signal-to-noise ratio (SNR) of 47 dB, but stayed within a relative error of 0.5 at an SNR = 30 dB and above (<italic>see <xref ref-type="sec" rid="sec017">Materials and Methods</xref> </italic>section for a description of how the SNR was calculated). The probability of error in classification increased rapidly for traces with a SNR lower than 25 dB for the parallel configuration and 22 dB for the feedback configuration, reaching a <italic>P</italic><sub><italic>e</italic></sub> = 1 at 18 dB for both configurations. It is worth noting that the <italic>P</italic><sub><italic>e</italic></sub> represents not only the instances in which a trace in feedback configuration is mistakenly classified as a parallel configuration or vice versa, but also errors in which the trace is classified as arising from a higher-order (≥2) or first-order system. These two types of errors quickly dominate the probability of error in detection at high levels of noise as the SNR degrades.</p>
<p>Together, our results indicate that for the traces of interest one can perform a noise analysis with similar synthetic traces and establish for a given SNR the expected probability of error in classification and relative error in the transition-rate parameters of the molecular kinetic scheme. For traces of the types obtained in our experimental systems (L-type calcium channels and GPCR Gi and Gq), our results indicated that a SNR of 25 dB or better should provide the right identification of the molecular kinetic scheme and a low relative error in the kinetic parameters. Analogous studies revealed that a similar robustness to noise of SYSMOLE can be achieved in the presence of Brownian noise, and that the effect of noise on <italic>P</italic><sub><italic>e</italic></sub> can be improved through pre-processing by filtering the signal prior to application of SYSMOLE (<xref ref-type="supplementary-material" rid="pcbi.1005376.s003">S1 Text</xref> sections 4.1 and 4.2). We also established the potential applicability of SYSMOLE to recognizing gene-regulatory mechanisms associated with a feedback or parallel configurations in the presence of cell-to-cell variability in gene induction noise (<xref ref-type="supplementary-material" rid="pcbi.1005376.s003">S1 Text</xref> section 4.3).</p>
</sec>
<sec id="sec014">
<title>Analysis with SYSMOLE of L-type calcium channel experimental traces retrieves the mechanism of action of nifedipine</title>
<p>We decided to apply SYSMOLE to study the molecular mechanism of voltage-dependent inactivation of L-type calcium channels and the mechanism of action of nifedipine, a calcium channel blocker widely used clinically as an antianginal and antihypertensive drug [<xref ref-type="bibr" rid="pcbi.1005376.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref034">34</xref>]. The inactivation mechanism of L-type channels has been extensively studied, and two major inactivation molecular mechanisms have been identified and characterized: a fast calcium-dependent inactivation mediated by the calcium ions entering inside the cells upon opening of the channel, and a voltage-dependent inactivation mediated by the voltage sensor located in the principal subunit and its movement upon depolarization to block the channel (see [<xref ref-type="bibr" rid="pcbi.1005376.ref035">35</xref>] for a review). Nifedipine, as part of the dihydropyridine class of channel blockers, binds to specific regions of the principal subunit to block the channel. The affinities of nifedipine for these binding regions differ depending on the state of the channel: nifedipine has a high affinity site for the inactivated state, a low affinity site accessible in the open state, and virtually no affinity sites for the closed state of the channel [<xref ref-type="bibr" rid="pcbi.1005376.ref036">36</xref>–<xref ref-type="bibr" rid="pcbi.1005376.ref039">39</xref>]. We tested whether we could derive molecular kinetic schemes consistent with the known molecular mechanism of voltage-dependent inactivation and nifedipine blockade of the L-type channels from experimental macroscopic current traces with the help of SYSMOLE.</p>
<p>We used macroscopic current traces from voltage clamp (VC) experiments performed in the accessory radula closer muscle of <italic>Aplysia californica</italic> previously obtained by our group [<xref ref-type="bibr" rid="pcbi.1005376.ref040">40</xref>]. Currents through these channels were isolated from potassium currents by adding selective blockers (see <italic><xref ref-type="sec" rid="sec017">Materials and Methods</xref></italic>) and obtained in response to a depolarization step from - 90 mV to 0 mV. Calcium ions were replaced by barium in the solutions to remove the contribution of calcium-dependent inactivation and isolate the voltage-dependent inactivation of the channels. The currents were measured in the absence or presence of nifedipine (100 nM and 1 <italic>μ</italic>M) (see <xref ref-type="fig" rid="pcbi.1005376.g007">Fig 7A</xref> for representative current traces). Following the noise analysis described in the previous section, the SNR of all traces (&gt; 38 dB for all cases) predicted a low probability of error in the identification by SYSMOLE of the correct molecular kinetic scheme as well as a low relative error for the transition rate parameters <italic>σ</italic><sub><italic>k</italic></sub> (<xref ref-type="fig" rid="pcbi.1005376.g006">Fig 6</xref> and <xref ref-type="table" rid="pcbi.1005376.t001">Table 1</xref>). In VC experiments the voltage is held constant while the current flowing through the ion channels in the cell membrane is measured based on the amount of current that an amplifier needs to supply to maintain the set voltage. We used the voltage as a function of time <italic>V</italic>(<italic>t</italic>) (a step from - 90 to 0 mV) as the input trace, and the recorded current <italic>i</italic>(<italic>t</italic>) as the output trace for SYSMOLE.</p>
<fig id="pcbi.1005376.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005376.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Molecular kinetic scheme and effects of nifedipine on L-type calcium channel traces.</title>
<p>(<bold>A</bold>) Representative L-type calcium ion-channel current (output) elicited by voltage steps from -90 to 0 mV (input), first in the absence of nifedipine, and after addition of nifedipine at 100 nM and 1 μM concentrations. (<bold>B</bold>) Molecular kinetic scheme obtained by applying SYSMOLE to the traces and expected effects of nifedipine on transition rates. (<bold>C</bold>) Fractional occupancies as a function of time of the closed-channel (black), open-channel (red), and inactivated-channel (blue) states resulting from simulating the molecular kinetic scheme. Simulations were generated with the mean value of the kinetic parameters (N = 3–6 traces per treatment). Kinetic parameter values can be found on <xref ref-type="table" rid="pcbi.1005376.t001">Table 1</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005376.g007" xlink:type="simple"/>
</fig>
<table-wrap id="pcbi.1005376.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005376.t001</object-id>
<label>Table 1</label> <caption><title>Kinetic Parameters Ion-channel Traces.</title></caption>
<alternatives>
<graphic id="pcbi.1005376.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005376.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">[Nifedipine]</th>
<th align="left">SNR(dB)</th>
<th align="left">Config.</th>
<th align="center"><italic>σ</italic><sub>1</sub></th>
<th align="center"><italic>σ</italic><sub>2</sub></th>
<th align="center"><italic>σ</italic><sub>3</sub></th>
<th align="center"><italic>γ</italic></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0 nM</td>
<td align="center">47.30 ± 5.92</td>
<td align="center">f (100%)</td>
<td align="center">0.48 ± 0.01</td>
<td align="center">3x10<sup>-3</sup>± 7.95x10<sup>-4</sup></td>
<td align="center">1.18x10<sup>-3</sup>± 2.94x10<sup>-4</sup></td>
<td align="center">-2.41 ± 0.14</td>
</tr>
<tr>
<td align="center">100 nM</td>
<td align="center">51.98 ± 0.89</td>
<td align="center">f (100%)</td>
<td align="center">0.45 ± 0.03</td>
<td align="center">4.40x10<sup>-3</sup>± 2.73x10<sup>-4</sup></td>
<td align="center">9.32x10<sup>-4</sup>± 2.35x10<sup>-4</sup></td>
<td align="center">-2.14 ± 0.05</td>
</tr>
<tr>
<td align="center">1 μM</td>
<td align="center">42.82 ± 3.57</td>
<td align="center">f (100%)</td>
<td align="center">0.39 ± 0.07</td>
<td align="center">2.35x10<sup>-2</sup>± 2.5x10<sup>-2</sup></td>
<td align="center">6.76x10<sup>-4</sup>± 8.73x10<sup>-4</sup></td>
<td align="center">-2.56 ± 1.18</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001"><p>N = 3–8 traces per group. f (100%) indicates feedback configuration was obtained for 100% of the traces.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>In biological terms, we can explain the current trace <italic>i</italic>(<italic>t</italic>) elicited by a step in voltage in a VC experiment using a molecular kinetic scheme as follows. Initially, the system is at steady-state and the fractional occupancies (i.e. the fraction of channels in any particular state) for each of the states are constant and the population of channels in dynamic equilibrium. At this point in time, the current readout is also constant (basal current) and proportional to the fractional occupancy in the open state. When the input steps to a higher voltage, the rate constants which govern the transitions between states change and the population of channels redistributes accordingly among the states. This redistribution is accompanied by a transient in the fractional occupancies, and thus in the current recorded. At the end of this transient a new steady-state level of current is reached. The value of the rate constants characterizing the transitions before the step in voltage are unknown, and therefore, the <italic>σ</italic><sub><italic>k</italic></sub> strictly represent the change in rate associated with the input, in this case a step in voltage.</p>
<p>The results of applying SYSMOLE to derive molecular kinetic schemes from macroscopic traces of L-type calcium channel currents obtained in the voltage-clamp (VC) experiments described, consistently yielded the molecular kinetic scheme associated with a feedback configuration (<xref ref-type="fig" rid="pcbi.1005376.g007">Fig 7B</xref> and <xref ref-type="table" rid="pcbi.1005376.t001">Table 1</xref>). In the absence of nifedipine, inactivation of the channel is due to the voltage-dependent inactivation, which is engaged when the channel opens due to the depolarization of the membrane. As such, a molecular kinetic scheme in which the channels need to open to inactivate is consistent with this molecular mechanism (<xref ref-type="fig" rid="pcbi.1005376.g007">Fig 7B</xref>) [<xref ref-type="bibr" rid="pcbi.1005376.ref041">41</xref>]. Based on the known mechanism of action of nifedipine, and due to the high affinity binding of nifedipine to the inactivated state, we expected the presence of this drug to reduce the transition rate from the inactivated state to the open state (I→O). Similarly, due to the existence of a binding site for nifedipine in the open state of the channel, we also expected an increase in the transition rate between the open state and the inactivated state (O→I), which now includes two different states the one reached through voltage-dependent inactivation, and the inactivation due to the presence of nifedipine. Finally, we expected nifedipine not to affect the transition between the closed and the open state (C→O) since it does not bind to the channel in the resting closed state. All these effects were extracted by SYSMOLE as detailed in <xref ref-type="table" rid="pcbi.1005376.t001">Table 1</xref>, and illustrated by the temporal evolution of the fractional occupancies in the obtained molecular kinetic scheme (<xref ref-type="fig" rid="pcbi.1005376.g007">Fig 7C</xref>).</p>
<p>Together, our results showed that SYSMOLE performed strongly with experimental traces and allowed us to derive the correct molecular kinetic scheme of the voltage-dependent inactivation of the L-type calcium channels and to predict the molecular mechanism of action of nifedipine.</p>
</sec>
<sec id="sec015">
<title>SYSMOLE can be applied to differentiate between <italic>cis-</italic> and <italic>trans</italic>-activation in heteromeric G protein-coupled receptor complexes</title>
<p>G protein-coupled receptors (GPCRs) are membrane-bound receptors that transduce extracellular binding of molecules into intracellular signals by activating a class of heterotrimeric proteins called G proteins [<xref ref-type="bibr" rid="pcbi.1005376.ref042">42</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref043">43</xref>]. Each subclass of G protein is associated with a signaling pathway with specific actions inside the cell in response to stimuli [<xref ref-type="bibr" rid="pcbi.1005376.ref044">44</xref>]. Classically, the signaling paradigm was considered to follow the rule that one ligand binds to one receptor which activates only one pathway. However, extensive biochemical and biophysical evidence has revealed the existence of GPCR homo- and hetero-dimers/oligomers that differentially alter G protein signaling. Furthermore, the regulation of these complexes is found to play a critical role in normal physiology and disease (see [<xref ref-type="bibr" rid="pcbi.1005376.ref045">45</xref>] for a review). Despite their importance, the molecular signaling mechanisms of GPCR heteromeric and homomeric complexes remain largely unknown.</p>
<p>The dysregulation of the heteromeric complex formed by the Gi-coupled metabotropic glutamate receptor 2 (mGluR2) and the Gq-coupled serotonin 2A receptor (5-HT2AR) has been linked to schizophrenia [<xref ref-type="bibr" rid="pcbi.1005376.ref046">46</xref>]. Preclinical and clinical studies suggest that activation of mGluR2 in the complex by allosteric and orthosteric agonists could represent a new therapeutic approach to treat schizophrenia and other disorders [<xref ref-type="bibr" rid="pcbi.1005376.ref047">47</xref>–<xref ref-type="bibr" rid="pcbi.1005376.ref049">49</xref>]. Our group has published work showing that psychedelic drugs upset the G<sub>i</sub>/G<sub>q</sub> signaling balance associated with the mGluR2/5-HT2AR complex by reducing G<sub>i</sub> and increasing G<sub>q</sub> signaling, while antipsychotic drugs restore the natural G<sub>i</sub>/G<sub>q</sub> balance. This is achieved through a crosstalk mechanism in which a ligand acting on one of the receptors, either 5-HT2AR or mGluR2, can change the signaling on their counterpart receptor [<xref ref-type="bibr" rid="pcbi.1005376.ref050">50</xref>]. However, the mechanism by which this crosstalk is achieved molecularly through the mGluR2/5-HT2AR complex remains to be elucidated.</p>
<p>Two possible molecular mechanisms occurring through cross-conformational changes have been postulated to explain the crosstalk observed between mGluR2 and 5-HT2AR through the mGluR2/5-HT2AR complex. One referred to as <italic>cis-</italic>activation, in which the ligand-free receptor is not able to activate G proteins unless the first one signals and is bound to G proteins. The second one referred to as <italic>trans-</italic>activation, in which the signal from the ligand-bound receptor is transmitted to the neighboring receptor which then signals by activating G proteins.</p>
<p>The <italic>cis-</italic>activation and <italic>trans-</italic>activation crosstalk theories could be distinguished in terms of molecular kinetic schemes (<xref ref-type="fig" rid="pcbi.1005376.g008">Fig 8A</xref>). We decided to apply SYSMOLE to derive the molecular kinetic scheme from macroscopic traces obtained from mGluR2/5-HT2AR in response to LY379268, a ligand belonging to the promising new class of glutamate antipsychotics [<xref ref-type="bibr" rid="pcbi.1005376.ref051">51</xref>], which has been shown to elicit a strong crosstalk between the mGluR2 and the 5-HT2AR [<xref ref-type="bibr" rid="pcbi.1005376.ref046">46</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref050">50</xref>]. While glutamate and serotonin, the two endogenous neurotransmitters, activate G<sub>i</sub> and G<sub>q</sub> pathways respectively through the mGluR2/5-HT2AR complex, LY379268 can activate both G<sub>i</sub> and G<sub>q</sub> despite only binding mGluR2 (<xref ref-type="fig" rid="pcbi.1005376.g008">Fig 8A</xref>).</p>
<fig id="pcbi.1005376.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005376.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Molecular kinetic scheme of crosstalk signaling in the mGluR2/5-HT2AR heteromeric complex in response to glutamate antipsychotics.</title>
<p>(<bold>A</bold>) (Top) Scheme of crosstalk signaling through the mGluR2/5-HT2AR complex. In response to the endogenous ligands glutamate and serotonin, the mGluR2/5-HT2AR complex signals through G<sub>i</sub> and G<sub>q</sub> signaling pathways respectively. Certain ligands such as LY379268, a dominant mGluR2 agonist with antipsychotic properties, are able to crosstalk through the complex and activate both G<sub>i</sub> and G<sub>q</sub>. (Bottom) Molecular kinetic schemes associated with the <italic>cis</italic>-activation and the <italic>trans</italic>-activation theories of crosstalk. (<bold>B</bold>) (Left) Representative G-protein sensitive ion-channel (GIRK4*) current trace (output) elicited by a step in LY379268 concentration from 0 to 1 μM (input). (Right) Molecular kinetic scheme obtained by applying SYSMOLE to the traces. (<bold>C</bold>) Fractional occupancies as a function of time of the four states in the molecular kinetic scheme: G<sub>i</sub> OFF / G<sub>q</sub> OFF, G<sub>i</sub> ON / G<sub>q</sub> OFF, G<sub>i</sub> ON / G<sub>q</sub> ON, and G<sub>i</sub> OFF / G<sub>q</sub> ON. The molecular kinetic scheme postulates a new state G<sub>i</sub> OFF / G<sub>q</sub> ON and supports the <italic>trans</italic>-activation theory for crosstalk through the complex (see <italic><xref ref-type="sec" rid="sec002">Results</xref> </italic>section). Simulations were generated with the mean value of the kinetic parameters (N = 5 traces). Kinetic parameter values can be found on <xref ref-type="table" rid="pcbi.1005376.t002">Table 2</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005376.g008" xlink:type="simple"/>
</fig>
<p>Ion channels have been extensively used to measure GPCR signaling activity. For our study, we expressed the mGluR2 and 5-HT2AR receptors together with a G protein sensitive potassium ion channel (GIRK4*) in <italic>Xenopus</italic> oocytes and measured using two-electrode voltage clamp the current flowing through the channel as a function of time (see <italic><xref ref-type="sec" rid="sec017">Materials and Methods</xref></italic>). The input signal for SYSMOLE was a step in concentration of LY379268, and the output signal the macroscopic current through the GIRK4* channel. Since G<sub>i</sub> signaling increases current through the channel (downward direction) and Gq signaling decreases the current through the channel (upward direction) [<xref ref-type="bibr" rid="pcbi.1005376.ref052">52</xref>] the traces obtained (<xref ref-type="fig" rid="pcbi.1005376.g008">Fig 8B</xref>) were perfectly suited to apply SYSMOLE to understand the relationship between G<sub>i</sub> and G<sub>q</sub> signaling and derive a molecular kinetic scheme. It should also be noted that the noise level in these traces results in a SNR clearly below the cut-off for error-free detection (<xref ref-type="fig" rid="pcbi.1005376.g006">Fig 6</xref>). Should the traces be noisier or have a type of noise added other than Gaussian, prior to analyzing the experimental traces SYSMOLE should be tested with synthetic traces and its robustness to noise for that type of trace determined (see <xref ref-type="supplementary-material" rid="pcbi.1005376.s003">S1 Text</xref> sections 4.1 and 4.2 for a description of the robustness of SYSMOLE to Brownian noise, and pre-processing strategies to increase the SNR in the trace).</p>
<p>Given that both the opening and closing of the reporter channel are faster processes (milliseconds) compared to G<sub>i</sub> and G<sub>q</sub> activation (seconds) the trace does not capture them, and the resulting molecular kinetic scheme allows us to distinguish states resulting from combinations in which the G<sub>i</sub> is OFF (no change in current) or ON (current through the channel is increasing), G<sub>q</sub> is OFF (no change in current) or ON (current through the channel is decreasing) or combinations.</p>
<p>Application of SYSMOLE to different macroscopic traces obtained in response to LY379268 (<xref ref-type="table" rid="pcbi.1005376.t002">Table 2</xref>) yielded the molecular kinetic scheme associated with the parallel subtraction (<xref ref-type="fig" rid="pcbi.1005376.g008">Fig 8B</xref> right) with four states, which can be related to different signaling states depending on whether the G<sub>i</sub> or G<sub>q</sub> signaling is ON or OFF in the complex. Additional controls were performed with injection of only one receptor (mGluR2 or 5-HT2AR) and endogenous ligands to ensure that the traces captured the crosstalk effects through mGluR2/5-HT2AR. From the molecular kinetic scheme, it can be inferred that G<sub>i</sub> and G<sub>q</sub> signaling are processes that occur in parallel upon LY379268 binding to mGluR2, and that activation of G<sub>q</sub> does not require G<sub>i</sub> activation. A close look at the fractional occupancy in each state as a function of time reveals that due to the strong G<sub>i</sub> signal activation of mGluR2 by LY379268 (dominant agonist [<xref ref-type="bibr" rid="pcbi.1005376.ref050">50</xref>]), most of the complex molecules move from the G<sub>i</sub> OFF/ G<sub>q</sub> OFF state to G<sub>i</sub> ON/ G<sub>q</sub> OFF state and then transition directly to the G<sub>i</sub> ON/ G<sub>q</sub> ON state. Interestingly, there is also a fraction of the molecules that transition from the original G<sub>i</sub> OFF / G<sub>q</sub> OFF state directly to G<sub>i</sub> OFF/ G<sub>q</sub> ON state, a molecular state that had not been postulated before. This fraction, albeit small, amounts to approximately one third of the total fractional occupancy in the G<sub>i</sub> ON/G<sub>q</sub> ON state when the system reaches steady state Our results support the hypothesis of a <italic>trans-</italic>activation as the mechanism of crosstalk of the mGluR2/5-HT2AR heteromeric complex. It should be noted that the assignment of these ON and OFF states does not come directly from SYSMOLE, which is agnostic to the biological interpretation and is here used to generate hypotheses. The molecular existence of these states would need to be explicitly tested in further experiments (see <italic><xref ref-type="sec" rid="sec016">Discussion</xref></italic>).</p>
<table-wrap id="pcbi.1005376.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005376.t002</object-id>
<label>Table 2</label> <caption><title>Kinetic Parameters mGluR2/5-HT2AR Complex Traces.</title></caption>
<alternatives>
<graphic id="pcbi.1005376.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005376.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">SNR(dB)</th>
<th align="center">Config.</th>
<th align="center"><italic>σ</italic><sub>1</sub></th>
<th align="center"><italic>σ</italic><sub>2</sub></th>
<th align="center"><italic>σ</italic><sub>3</sub></th>
<th align="center"><italic>γ</italic></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">50.4 ± 3.81</td>
<td align="center">p (100%)</td>
<td align="center">0.30 ± 0.04</td>
<td align="center">1.73x10<sup>-3</sup>± 4.96x10<sup>-4</sup></td>
<td align="center">2.73x10<sup>-3</sup>± 1.21x10<sup>-3</sup></td>
<td align="center">-2.29 ± 0.73</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001"><p>N = 5 traces. p (100%) indicates parallel configuration was obtained for 100% of the traces.</p></fn>
</table-wrap-foot>
</table-wrap>
<p>Together, these results exemplify the usefulness of the SYSMOLE system-identification analytical tool in studying heteromeric signaling.</p>
</sec>
</sec>
<sec id="sec016" sec-type="conclusions">
<title>Discussion</title>
<p>A correct characterization of the dynamics of different molecular processes in the cell is fundamental for understanding normal physiological and pathophysiological responses. In most biological systems the direct study of these microscopic molecular processes is not yet possible due to experimental limitations, and only overall macroscopic cell responses to stimuli (macroscopic traces) can be obtained. Here we introduced a method that combines computational and analytical approaches to extract information from the macroscopic trace regarding the molecular microscopic processes and the way in which they are combined. This method, SYSMOLE, conveniently describes the dynamics of these microscopic processes in the form of a molecular kinetic scheme analogous to those used in biophysics and pharmacology.</p>
<p>SYSMOLE is implemented in modular fashion. We first detailed the mathematical underpinnings of each of the three modules that are included in SYSMOLE: the Identifier Module, the Classifier Module, and the Molecular Kinetic Converter Module. Through rigorous and systematic evaluations, we explored SYSMOLE’s limitations and robustness to noise (see also <xref ref-type="supplementary-material" rid="pcbi.1005376.s003">S1 Text</xref> section 4). We validated the performance of SYSMOLE on experimental traces by correctly identifying the molecular kinetic scheme describing the activation and inactivation of L-type calcium channels, as well as the mechanism of action of nifedipine, a calcium channel blocker clinically used in patients with cardiovascular disease. Furthermore, we applied SYSMOLE to study the signaling crosstalk mechanism observed in the heteromeric complex formed by mGluR2 and 5-HT2AR in response to LY379268, a compound that belongs to the new class of glutamate antipsychotics [<xref ref-type="bibr" rid="pcbi.1005376.ref053">53</xref>]. A Matlab toolbox with all the functions that we have developed is available in Matlab Central (<ext-link ext-link-type="uri" xlink:href="https://www.mathworks.com/matlabcentral/fileexchange/61465-sysmole" xlink:type="simple">https://www.mathworks.com/matlabcentral/fileexchange/61465-sysmole</ext-link>). The SYSMOLE toolbox contains an implementation of the modules for second-order systems and third-order systems with three poles and two zeros. It contains the experimental data used in the manuscript, and also provides the user with templates to simulate and test noise models and apply SYSMOLE to traces from their biological system of interest.</p>
<p>In the broader context of systems biology, other powerful methods exist to extract network models from biological data in different domains (see reviews [<xref ref-type="bibr" rid="pcbi.1005376.ref054">54</xref>] and [<xref ref-type="bibr" rid="pcbi.1005376.ref055">55</xref>] for examples in allosteric networks and functional genomics, respectively). As one could expect, each method and approach has its strengths and is most adapted to deal with specific aspects or features of the data and the biological system. A large group of methods obtain possible networks from scarce and unhomogeneously-sampled measurements or traces [<xref ref-type="bibr" rid="pcbi.1005376.ref054">54</xref>–<xref ref-type="bibr" rid="pcbi.1005376.ref060">60</xref>]. SYSMOLE tackles a different set of questions and is best adapted to capture subtle features in adequately-sampled macroscopic traces that underlie essential differences in the biological system. As such, SYSMOLE is a complementary approach to other methods, and as the experimental techniques evolve to enable sampling more often and acquiring more data per unit time, tools like SYSMOLE will become particularly useful to have in the computational biologist toolbox.</p>
<p>Compared to other methods that deal with adequately-sampled data, SYSMOLE is a flexible method that can be generalized to the study of multiple biological systems and applied to different types of biological traces. Various methods have been developed to derive molecular kinetic schemes from macroscopic current traces in the ion channel biophysics field. The best results have been obtained utilizing maximum likelihood methods [<xref ref-type="bibr" rid="pcbi.1005376.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref020">20</xref>] and covariance methods [<xref ref-type="bibr" rid="pcbi.1005376.ref061">61</xref>]. These methods strongly rely on underlying models to characterize ion channel current flow which, following decades of biophysics research, are usually available [<xref ref-type="bibr" rid="pcbi.1005376.ref004">4</xref>]. Unfortunately, these methods cannot be easily generalized to most biological systems, for which reliable models of the molecular microscopic processes are typically unavailable and large numbers of measurements are impractical. Furthermore, many of the available methods are not able to tackle stimuli (inputs) with different dynamics, a key feature of many biological systems and physiological responses. SYSMOLE overcomes these limitations. It does not rely on underlying models, it extracts information per input-output trace pair, and it incorporates information about the dynamics of the stimulus. Utilizing a system identification step based on a transfer function allows SYSMOLE to capture the dynamics without relying on a physical model. By extending the concept of a Markov chain and linking one of the states to the input, SYSMOLE can extract the molecular kinetic scheme from macroscopic traces elicited by inputs with various dynamics. Finally, the flexible properties of SYSMOLE have the added benefit to retrospectively allow leveraging of important biological information from the vast repository of macroscopic traces collected through the years by different labs.</p>
<p>The overall performance of SYSMOLE is determined by the module with the lowest performance, which in turn depends on the characteristics of each particular macroscopic trace and physiological process under study. The performance of the ARX (autoregressive) method used in the Identifier Module will degrade as the noise increases, or as the sampling frequency decreases and the input and output traces become insufficiently sampled in time. Based on our experience these limitations can be overcome through the application of classical preprocessing and filtering techniques to the traces [<xref ref-type="bibr" rid="pcbi.1005376.ref022">22</xref>] (see <xref ref-type="supplementary-material" rid="pcbi.1005376.s003">S1 Text</xref> section 4.1) together with an acquisition sampling frequency of <inline-formula id="pcbi.1005376.e055"><alternatives><graphic id="pcbi.1005376.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>, with <italic>T</italic> being the time constant of the fastest process that we wish to capture. The Classifier Module will not perform properly if information regarding the differences in time constants of the processes under study is unavailable. Lacking this information will result in an improperly bound optimization problem which will not exclude the parameter region where the feedback and parallel solutions coincide (<xref ref-type="supplementary-material" rid="pcbi.1005376.s003">S1 Text</xref> section 1). This might hinder the applicability of the method to processes characterized by extremely similar time constants. Finally, the Molecular Kinetic Converter is an analytical conversion, and thus in principle will always perform correctly. To confirm the validity of the conversion for every case, internal checks are included along the mathematical derivation to ensure the rules presented are sound (<xref ref-type="supplementary-material" rid="pcbi.1005376.s003">S1 Text</xref> section 2).</p>
<p>For didactic simplicity, we focused in our presentation on a second-order system, in which two first-order processes are combined in different arrangements. However, each module in SYSMOLE can be scaled to multiple processes. The ARX implementation of the Identifier module can easily extract up to 6 to 10 processes and does not represent a bottleneck for scalability [<xref ref-type="bibr" rid="pcbi.1005376.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref025">25</xref>]. The series of comparisons implemented in the Classifier Module can be updated to incorporate additional combinations of numbers of poles and zeros. The optimization problems needed to differentiate these additional combinations are also easily scalable to higher-order systems, and thus to multiple processes. Finally, the Molecular Kinetic Scheme can be scaled using a modular approach in which each combination of two processes is considered as a module, and the connection of that module to another module or process also occurs through three possible canonical configurations (see the <italic>Scalibility</italic> section in <xref ref-type="supplementary-material" rid="pcbi.1005376.s003">S1 Text</xref> for a description of the application of SYSMOLE to third-order systems with three poles and two zeros).</p>
<p>Application of SYSMOLE to the study of crosstalk through the mGluR2/5-HT2AR heteromeric receptor complex in <italic>Xenopus</italic> oocytes illustrates its strength in generating new hypotheses regarding molecular mechanisms. Our results indicate that LY379268, a glutamate antipsychotic that binds to mGluR2, can signal through G<sub>q</sub> in the absence of any ligand bound to 5-HT2AR, which suggests <italic>trans</italic>-activation as the molecular mechanism of crosstalk. This analysis postulated the existence of a signaling state in which the receptor signals through G<sub>q</sub> without signaling through Gi. This new state might have important implications in understanding the pharmacology of new glutamate antipsychotic compounds [<xref ref-type="bibr" rid="pcbi.1005376.ref053">53</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref062">62</xref>, <xref ref-type="bibr" rid="pcbi.1005376.ref063">63</xref>]. Since SYSMOLE strictly obtains a Markov-chain state model, the assignment of each of the states to a particular signaling conformation (Gi ON or OFF, Gq ON or OFF) is also postulated. Confirmation of the existence of these states will require further experiments in which it is possible to assume that the occupancies of the states of one or more states is constant or altered. One could for example perform similar crosstalk experiments (<xref ref-type="fig" rid="pcbi.1005376.g008">Fig 8</xref>) with complexes in which either of the receptors that form the heteromer are mutated such that it cannot bind Gi or Gq. Furthermore, relevance of this new postulated signaling state in neurons should also be assessed.</p>
<p>In conclusion, despite the extensive efforts devoted to the development single-molecule experimental techniques, alternatives are needed for the analysis of macroscopic traces. SYSMOLE, a hybrid computational and analytical tool designed to analyze macroscopic traces and derive molecular kinetic schemes, enables the user to extract information regarding the microscopic processes involved in the response to a given stimulus from the available macroscopic traces. SYSMOLE has also the added benefit to be able to leverage important biological information from the vast repository of macroscopic traces to generate new hypotheses.</p>
</sec>
<sec id="sec017" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec018">
<title>Identifier module</title>
<p>The Identifier Module was implemented in Matlab (<ext-link ext-link-type="uri" xlink:href="http://www.mathworks.com/" xlink:type="simple">www.mathworks.com</ext-link>) using the System Identification Toolbox ARX functions. Details on loss-function minimization strategies in prediction-error-identifications can be found in [<xref ref-type="bibr" rid="pcbi.1005376.ref025">25</xref>].</p>
</sec>
<sec id="sec019">
<title>Classifier module</title>
<p>The parallel and feedback optimization problems described in the main text were solved using a trust-region-reflective algorithm [<xref ref-type="bibr" rid="pcbi.1005376.ref064">64</xref>] included in the Optimization Toolbox of Matlab (<ext-link ext-link-type="uri" xlink:href="http://www.mathworks.com/" xlink:type="simple">www.mathworks.com</ext-link>).</p>
</sec>
<sec id="sec020">
<title>Molecular kinetic converter</title>
<p>Details on the derivation of the molecular kinetic schemes for each canonical configuration can be found in the supporting materials (<xref ref-type="supplementary-material" rid="pcbi.1005376.s003">S1 Text</xref>).</p>
</sec>
<sec id="sec021">
<title>Synthetic trace simulator</title>
<p>Two implementations were used: one in Matlab, the environment in which SYSMOLE is implemented, and one using COPASI [<xref ref-type="bibr" rid="pcbi.1005376.ref065">65</xref>], a software application for simulation and analysis of biochemical networks and their dynamics.</p>
</sec>
<sec id="sec022">
<title>Signal-to-noise ratio calculation</title>
<p>In order to obtain the signal-to-noise ratio (SNR) one needs to calculate the average power of the signal <italic>y</italic>(<italic>t</italic>) <italic>P</italic><sub><italic>Y</italic></sub>, as well as the noise power. The signal’s average power can be directly calculated in the time domain as:
<disp-formula id="pcbi.1005376.e056">
<alternatives>
<graphic id="pcbi.1005376.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e056" xlink:type="simple"/>
<mml:math display="block" id="M56">
<mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:msup><mml:mrow><mml:mi>y</mml:mi><mml:mo>[</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(47)</label>
</disp-formula>
where <italic>y</italic>[<italic>n</italic>] is the sequence resulting from discretizing <italic>y</italic>(<italic>t</italic>) with sample period <italic>T</italic><sub><italic>s</italic></sub> and sample number <italic>n</italic> = 1 … <italic>N</italic>.</p>
<p>The noise power depends on the noise characteristics and the bandwidth of <italic>y</italic>(<italic>t</italic>), which varies depending on the parameters of the first order processes that give rise to the signal (<italic>k</italic><sub><italic>a</italic></sub>, <italic>k</italic><sub><italic>b</italic></sub>, <italic>τ</italic><sub><italic>a</italic></sub>, and <italic>τ</italic><sub><italic>b</italic></sub>). All the necessary information needed to calculate this value is provided by the Identifier Module. On the one hand, in the Identifier Module we had included disturbances in the form of white Gaussian noise with variance <italic>λ</italic> filtered and added to the output (see Identifier). On the other hand, this module yields the transfer function <italic>G</italic>(<italic>s</italic>) that will allow us to calculate the bandwidth of the signal <italic>BW</italic>. In order to test whether a noise characterization as WGN is adequate for the type of experimental traces we analyzed, we confirmed that the <italic>λ</italic> value estimated by the Identifier Module matched the value of the variance of <italic>y</italic>(<italic>t</italic>) before stimulation both for the simulated synthetic traces as for the experimental traces. Once <italic>λ</italic> and <italic>BW</italic> are obtained, the noise power <italic>P</italic><sub><italic>N</italic></sub> filtered to the signal’s bandwidth can be calculated as
<disp-formula id="pcbi.1005376.e057">
<alternatives>
<graphic id="pcbi.1005376.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e057" xlink:type="simple"/>
<mml:math display="block" id="M57">
<mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>λ</mml:mi></mml:mrow></mml:mrow><mml:mspace width="0.25em"/><mml:mi>d</mml:mi><mml:mi>f</mml:mi>
</mml:math>
</alternatives>
<label>(48)</label>
</disp-formula>
where <italic>G</italic>(<italic>f</italic>) is the frequency response of the transfer function <italic>G</italic>(<italic>s</italic>), and <italic>S</italic><sub><italic>n</italic></sub>(<italic>f</italic>) is the power spectral density of the noise. Assuming an ideal low-pass filter, the value of this integral can be approximated to
<disp-formula id="pcbi.1005376.e058">
<alternatives>
<graphic id="pcbi.1005376.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005376.e058" xlink:type="simple"/>
<mml:math display="block" id="M58">
<mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>≃</mml:mo><mml:mn>2</mml:mn><mml:mi>λ</mml:mi><mml:mo>.</mml:mo><mml:mi>B</mml:mi><mml:mi>W</mml:mi>
</mml:math>
</alternatives>
<label>(49)</label>
</disp-formula>
For our analysis we used Eq (<xref ref-type="disp-formula" rid="pcbi.1005376.e058">49</xref>) with a bandwidth calculated at 3 dB drop in gain. A design of a non-ideal low-pass filter with cutoff frequency equal to <italic>BW</italic>, 1 dB ripple in the pass band, and 60 dB attenuation in the stop band yielded practically identical results.</p>
</sec>
<sec id="sec023">
<title>Calcium-channel voltage-clamp traces</title>
<p>Digitized current and voltage values were obtained from previous voltage-clamp experiments performed in the accessory radula closer muscle of <italic>Aplysia californica</italic>. Solutions, drug delivery, and experimental conditions are described in detail in reference [<xref ref-type="bibr" rid="pcbi.1005376.ref066">66</xref>].</p>
</sec>
<sec id="sec024">
<title>G-protein coupled receptor activity measurements in <italic>Xenopus</italic> oocytes</title>
<p>Oocytes were isolated and microinjected with equal volumes (50 nl), as previously described [<xref ref-type="bibr" rid="pcbi.1005376.ref067">67</xref>]. In all two-electrode voltage-clamp experiments (TEVC), oocytes were injected with 1 ng of mGluR2, 2 ng of 5-HT2AR, and 2 ng of GIRK4*, and were maintained at 18 ºC for 14 days before recording.</p>
<p>Whole-cell currents were measured by conventional two-electrode voltage-clamp (TEVC) with a GeneClamp 500 amplifier (Axon Instruments, Union City, CA, USA. A high-potassium (HK) solution was used to superfuse oocytes (96 mM KCl, 1 mM NaCl, 1 mM MgCl, 5 mM KOH/HEPES, pH 7.4) to obtain a reversal potential for potassium (<italic>E</italic><sub><italic>k</italic></sub>) close to zero. Inwardly rectifying potassium currents through GIRK4* were obtained by clamping the cells at - 80 mV. A solution of 3 mM of BaCl in HK solution was perfused at the end of each trace to ensure that the current measured corresponded to GIRK4*, as previously described [<xref ref-type="bibr" rid="pcbi.1005376.ref052">52</xref>].</p>
</sec>
</sec>
<sec id="sec025">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005376.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005376.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Signature of poles, zeros, and gain.</title>
<p>Second-order transfer-function values of the time constants associated with the poles and zero, and the gain resulting from applying the three canonical configurations to combine two first-order processes defined by time constants <italic>τ</italic><sub><italic>a</italic></sub> = 5 ms and <italic>τ</italic><sub><italic>b</italic></sub> = 80 ms and strengths (gains), <italic>k</italic><sub><italic>a</italic></sub> and <italic>k</italic><sub><italic>b</italic></sub>, ranging from -10 to 10.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005376.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005376.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Convergence of the Classifier Module.</title>
<p>Study of the convergence properties of the parallel and feedback optimization problems when tested with two processes, <italic>a</italic> and <italic>b</italic>, characterized by <italic>τ</italic><sub><italic>a</italic></sub> = 15 ms and <italic>τ</italic><sub><italic>b</italic></sub> = 150 ms combined in parallel (<bold>A</bold>) with <italic>k</italic><sub><italic>a</italic></sub> ∈ [−10, 10] and <italic>k</italic><sub><italic>b</italic></sub> ∈ [−10, 10], or in feedback (<bold>B</bold>) with <italic>k</italic><sub><italic>a</italic></sub> ∈ [−10, 10], and <italic>k</italic><sub><italic>b</italic></sub> ∈ [0, 10] (negative <italic>k</italic><sub><italic>b</italic></sub> yields unstable positive-feedback systems). Left panel indicates, in red the value for the cost function of the parallel problem (<italic>f</italic><sub><italic>valp</italic></sub>) and in blue the value for the cost function of the feedback problem (<italic>f</italic><sub><italic>valf</italic></sub>), as a function of the number of iterations in the optimization algorithm. First column indicates the normalized Euclidean distance between the real parameter values (<italic>τ</italic><sub><italic>a</italic></sub>, <italic>τ</italic><sub><italic>b</italic></sub>, <italic>k</italic><sub><italic>a</italic></sub>, <italic>k</italic><sub><italic>b</italic></sub>) and the solution obtained by the parallel optimization problem (top), and the feedback optimization problem (bottom). Second column indicates the values for the cost functions of the parallel optimization problem <italic>f</italic><sub><italic>valp</italic></sub> (top) and the feedback optimization problem <italic>f</italic><sub><italic>valf</italic></sub> (bottom). Finally, the third column indicates the value of the logical condition tested by the Classifier Module to discriminate between parallel and the feedback configurations (<xref ref-type="fig" rid="pcbi.1005376.g003">Fig 3</xref>). Identical studies were performed testing the Classifier Module with all possible configurations for <italic>τ</italic><sub><italic>a</italic></sub> = [5, 10, 15, 20] and <italic>τ</italic><sub><italic>b</italic></sub> = [100, 150, 200, 300] with similar results. Boundary conditions used for optimization problems are <italic>k</italic><sub><italic>a</italic></sub> and <italic>k</italic><sub><italic>b</italic></sub> ∈ [−20, 20], <italic>τ</italic><sub><italic>a</italic></sub> ∈ [1, 50] ms and <italic>τ</italic><sub><italic>b</italic></sub> ∈ [50, 350] ms. We restricted <italic>k</italic><sub><italic>b</italic></sub> ∈ [0, 20] for the feedback problem since negative <italic>k</italic><sub><italic>b</italic></sub> would yield positive-feedback unstable systems for negative values. The results indicate that the parallel and feedback optimization problems converge for a wide range of parameters and that the implementation of the Classifier Module is capable of discerning between the parallel and feedback configurations in second-order transfer functions.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005376.s003" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005376.s003" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Additional mathematical derivations and scalability.</title>
<p>(1) Constraints for optimization problems. (2) Derivation of molecular kinetic schemes for the canonical configurations. (3) Scalability. (4) Noise.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005376.s004" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005376.s004" xlink:type="simple">
<label>S1 Data</label>
<caption>
<title>Experimental Traces.</title>
<p>(1) L-type calcium ion-channel current elicited by voltage steps from -90 to 0 mV, first in the absence of nifedipine, and after addition of nifedipine at 100 nM and 1 μM concentration. (2) G-protein sensitive ion-channel (GIRK4*) current traces elicited by a step in LY379268 concentration from 0 to 1 μM.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors want to thank Johna Till Johnson for her generosity and support of this work.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005376.ref001"><label>1</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Marks</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Klingmüller</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Müller-Decker</surname> <given-names>K</given-names></name>. (<year>2009</year>) <chapter-title>Cellular signal processing. an introduction to the molecular mechanims of signal transduction</chapter-title>. <publisher-loc>New York</publisher-loc>: <publisher-name>Garland Science, Taylor and Francis Group, LLC</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1005376.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bray</surname> <given-names>D</given-names></name>. (<year>1995</year>) <article-title>Protein molecules as computational elements in living cells</article-title>. <source>Nature</source> <volume>376</volume>: <fpage>307</fpage>–<lpage>312</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/376307a0" xlink:type="simple">10.1038/376307a0</ext-link></comment> <object-id pub-id-type="pmid">7630396</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Barabasi</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Oltvai</surname> <given-names>ZN</given-names></name>. (<year>2004</year>) <article-title>Network biology: Understanding the cell's functional organization</article-title>. <source>Nat Rev Genet</source> <volume>5</volume>: <fpage>101</fpage>–<lpage>113</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg1272" xlink:type="simple">10.1038/nrg1272</ext-link></comment> <object-id pub-id-type="pmid">14735121</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref004"><label>4</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Hille</surname> <given-names>B</given-names></name>. (<year>2001</year>) <source>Ionic channels of excitable membranes</source>, <edition>3rd ed.</edition> <publisher-loc>Sunderland, MA</publisher-loc>: <publisher-name>Sinauer Associates</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1005376.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sigg</surname> <given-names>D</given-names></name>. (<year>2014</year>) <article-title>Modeling ion channels: Past, present, and future</article-title>. <source>J Gen Physiol</source> <volume>144</volume>: <fpage>7</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1085/jgp.201311130" xlink:type="simple">10.1085/jgp.201311130</ext-link></comment> <object-id pub-id-type="pmid">24935742</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Colquhoun</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Hawkes</surname> <given-names>AG</given-names></name>. (<year>1981</year>) <article-title>On the stochastic properties of single ion channels</article-title>. <source>Proc R Soc Lond B Biol Sci</source> <volume>211</volume>: <fpage>205</fpage>–<lpage>235</lpage>. <object-id pub-id-type="pmid">6111797</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gration</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Lambert</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Ramsey</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Rand</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Usherwood</surname> <given-names>PN</given-names></name>. (<year>1982</year>) <article-title>Closure of membrane channels gated by glutamate receptors may be a two-step process</article-title>. <source>Nature</source> <volume>295</volume>: <fpage>599</fpage>–<lpage>603</lpage>. <object-id pub-id-type="pmid">6120466</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cull-Candy</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Usowicz</surname> <given-names>MM</given-names></name>. (<year>1987</year>) <article-title>Multiple-conductance channels activated by excitatory amino acids in cerebellar neurons</article-title>. <source>Nature</source> <volume>325</volume>: <fpage>525</fpage>–<lpage>528</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/325525a0" xlink:type="simple">10.1038/325525a0</ext-link></comment> <object-id pub-id-type="pmid">2433594</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neher</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sakmann</surname> <given-names>B</given-names></name>. (<year>1992</year>) <article-title>The patch clamp technique</article-title>. <source>Sci Am</source> <volume>266</volume>: <fpage>44</fpage>–<lpage>51</lpage>. <object-id pub-id-type="pmid">1374932</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hamill</surname> <given-names>OP</given-names></name>, <name name-style="western"><surname>Marty</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Neher</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sakmann</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Sigworth</surname> <given-names>FJ</given-names></name>. (<year>1981</year>) <article-title>Improved patch-clamp techniques for high-resolution current recording from cells and cell-free membrane patches</article-title>. <source>Pflugers Arch</source> <volume>391</volume>: <fpage>85</fpage>–<lpage>100</lpage>. <object-id pub-id-type="pmid">6270629</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Qin</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Auerbach</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sachs</surname> <given-names>F</given-names></name>. (<year>1996</year>) <article-title>Estimating single-channel kinetic parameters from idealized patch-clamp data containing missed events</article-title>. <source>Biophys J</source> <volume>70</volume>: <fpage>264</fpage>–<lpage>280</lpage>. S0006-3495(96)79568-1 [pii]. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(96)79568-1" xlink:type="simple">10.1016/S0006-3495(96)79568-1</ext-link></comment> <object-id pub-id-type="pmid">8770203</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Qin</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Auerbach</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sachs</surname> <given-names>F</given-names></name>. (<year>2000</year>) <article-title>A direct optimization approach to hidden markov modeling for single channel kinetics</article-title>. <source>Biophys J</source> <volume>79</volume>: <fpage>1915</fpage>–<lpage>1927</lpage>. S0006-3495(00)76441-1 [pii]. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(00)76441-1" xlink:type="simple">10.1016/S0006-3495(00)76441-1</ext-link></comment> <object-id pub-id-type="pmid">11023897</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ritort</surname> <given-names>F</given-names></name>. (<year>2006</year>) <article-title>Single-molecule experiments in biological physics: Methods and applications</article-title>. <source>J Phys Condens Matter</source> <volume>18</volume>: <fpage>R531</fpage>–<lpage>83</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/0953-8984/18/32/R01" xlink:type="simple">10.1088/0953-8984/18/32/R01</ext-link></comment> <object-id pub-id-type="pmid">21690856</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Roy</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Hohng</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ha</surname> <given-names>T</given-names></name>. (<year>2008</year>) <article-title>A practical guide to single-molecule FRET</article-title>. <source>Nat Methods</source> <volume>5</volume>: <fpage>507</fpage>–<lpage>516</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1208" xlink:type="simple">10.1038/nmeth.1208</ext-link></comment> <object-id pub-id-type="pmid">18511918</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hartwell</surname> <given-names>LH</given-names></name>, <name name-style="western"><surname>Hopfield</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Leibler</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>AW</given-names></name>. (<year>1999</year>) <article-title>From molecular to modular cell biology</article-title>. <source>Nature</source> <volume>402</volume>: <fpage>C47</fpage>–<lpage>52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/35011540" xlink:type="simple">10.1038/35011540</ext-link></comment> <object-id pub-id-type="pmid">10591225</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jordan</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Landau</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Iyengar</surname> <given-names>R</given-names></name>. (<year>2000</year>) <article-title>Signaling networks: The origins of cellular multitasking</article-title>. <source>Cell</source> <volume>103</volume>: <fpage>193</fpage>–<lpage>200</lpage>. S0092-8674(00)00112-4 [pii]. <object-id pub-id-type="pmid">11057893</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bray</surname> <given-names>D</given-names></name>. (<year>2003</year>) <article-title>Molecular networks: The top-down view</article-title>. <source>Science</source> <volume>301</volume>: <fpage>1864</fpage>–<lpage>1865</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1089118" xlink:type="simple">10.1126/science.1089118</ext-link></comment> <object-id pub-id-type="pmid">14512614</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kienker</surname> <given-names>P</given-names></name>. (<year>1989</year>) <article-title>Equivalence of aggregated markov models of ion-channel gating</article-title>. <source>Proc R Soc Lond B Biol Sci</source> <volume>236</volume>: <fpage>269</fpage>–<lpage>309</lpage>. <object-id pub-id-type="pmid">2471201</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Milescu</surname> <given-names>LS</given-names></name>, <name name-style="western"><surname>Yamanishi</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ptak</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Mogri</surname> <given-names>MZ</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>JC</given-names></name>. (<year>2008</year>) <article-title>Real-time kinetic modeling of voltage-gated ion channels using dynamic clamp</article-title>. <source>Biophys J</source> <volume>95</volume>: <fpage>66</fpage>–<lpage>87</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1529/biophysj.107.118190" xlink:type="simple">10.1529/biophysj.107.118190</ext-link></comment> <object-id pub-id-type="pmid">18375511</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Milescu</surname> <given-names>LS</given-names></name>, <name name-style="western"><surname>Akk</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Sachs</surname> <given-names>F</given-names></name>. (<year>2005</year>) <article-title>Maximum likelihood estimation of ion channel kinetics from macroscopic currents</article-title>. <source>Biophys J</source> <volume>88</volume>: <fpage>2494</fpage>–<lpage>2515</lpage>. S0006-3495(05)73305-1 [pii]. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1529/biophysj.104.053256" xlink:type="simple">10.1529/biophysj.104.053256</ext-link></comment> <object-id pub-id-type="pmid">15681642</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref021"><label>21</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Oppenheim</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>Willsky</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Hamid-Nawab</surname> <given-names>S</given-names></name>. (<year>1999</year>) <source>Signals and systems</source>. <edition>2nd ed.</edition> <publisher-loc>Upper Saddle River, NJ</publisher-loc>: <publisher-name>Prentice Hall</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1005376.ref022"><label>22</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Godfrey</surname> <given-names>KR</given-names></name>. (<year>1993</year>) <source>Perturbation signals for system identification</source>. <publisher-loc>London, UK</publisher-loc>: <publisher-name>Prentice Hall</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1005376.ref023"><label>23</label><mixed-citation publication-type="other" xlink:type="simple">Tan AH, Godfrey KR. (2009) A guide to the design and selection of perturbation signals. Proeceeedings 48th IEEE Conference on Decision and Control: 464–469.</mixed-citation></ref>
<ref id="pcbi.1005376.ref024"><label>24</label><mixed-citation publication-type="other" xlink:type="simple">Söderström T, Fan H, Carlsson B, Bigi S. (1997) Least squares parameter estimation of continuous-time ARX models from discrete-time data. IEEE Transaction on Automatic Control 42, NO.5.</mixed-citation></ref>
<ref id="pcbi.1005376.ref025"><label>25</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Ljung</surname> <given-names>L</given-names></name>. (<year>1999</year>) <source>System identification. theory for the user</source>. <edition>2nd ed.</edition>: <publisher-name>Prentice Hall</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1005376.ref026"><label>26</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Oppenheim</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>Schafer</surname> <given-names>RW</given-names></name>. (<year>1989</year>) <chapter-title>Discrete-time signal processing</chapter-title>.: <publisher-name>Prentice hall</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1005376.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mei</surname> <given-names>C</given-names></name>. (<year>2002</year>) <article-title>On teaching the simplification of block diagrams</article-title>. <source>Int J of Engng Ed</source> <volume>18</volume>: <fpage>697</fpage>–<lpage>703</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005376.ref028"><label>28</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Karayanakis</surname> <given-names>NM</given-names></name>. (<year>1995</year>) <source>Advanced system modeling and simulation with block diagram languages</source>. <publisher-loc>Boca Raton, Florida, US</publisher-loc>: <publisher-name>CRC Press</publisher-name>. 350 p.</mixed-citation></ref>
<ref id="pcbi.1005376.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Song</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Magleby</surname> <given-names>KL</given-names></name>. (<year>1994</year>) <article-title>Testing for microscopic reversibility in the gating of maxi K+ channels using two-dimensional dwell-time distributions</article-title>. <source>Biophys J</source> <volume>67</volume>: <fpage>91</fpage>–<lpage>104</lpage>. S0006-3495(94)80458-8 [pii]. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(94)80458-8" xlink:type="simple">10.1016/S0006-3495(94)80458-8</ext-link></comment> <object-id pub-id-type="pmid">7919030</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rothberg</surname> <given-names>BS</given-names></name>, <name name-style="western"><surname>Magleby</surname> <given-names>KL</given-names></name>. (<year>2001</year>) <article-title>Testing for detailed balance (microscopic reversibility in ion channel gating</article-title>. <source>Biophys J</source> <volume>80</volume>: <fpage>3025</fpage>–<lpage>3026</lpage>. S0006-3495(01)76268-6 [pii]. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(01)76268-6" xlink:type="simple">10.1016/S0006-3495(01)76268-6</ext-link></comment> <object-id pub-id-type="pmid">11432375</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Patlak</surname> <given-names>J</given-names></name>. (<year>1991</year>) <article-title>Molecular kinetics of voltage-dependent na+ channels</article-title>. <source>Physiol Rev</source> <volume>71</volume>: <fpage>1047</fpage>–<lpage>1080</lpage>. <object-id pub-id-type="pmid">1656476</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Colquhoun</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Sakmann</surname> <given-names>B</given-names></name>. (<year>1985</year>) <article-title>Fast events in single-channel currents activated by acetylcholine and its analogues at the frog muscle end-plate</article-title>. <source>J Physiol</source> <volume>369</volume>: <fpage>501</fpage>–<lpage>557</lpage>. <object-id pub-id-type="pmid">2419552</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Go</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Bauman</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Coleman King</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Fonarow</surname> <given-names>GC</given-names></name>, <name name-style="western"><surname>Lawrence</surname> <given-names>W</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>An effective approach to high blood pressure control: A science advisory from the american heart association, the american college of cardiology, and the centers for disease control and prevention</article-title>. <source>Hypertension</source> <volume>63</volume>: <fpage>878</fpage>–<lpage>885</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1161/HYP.0000000000000003" xlink:type="simple">10.1161/HYP.0000000000000003</ext-link></comment> <object-id pub-id-type="pmid">24243703</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yancy</surname> <given-names>CW</given-names></name>, <name name-style="western"><surname>Jessup</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bozkurt</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Butler</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Casey</surname> <given-names>DE</given-names> <suffix>Jr</suffix></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>2013 ACCF/AHA guideline for the management of heart failure: Executive summary: A report of the american college of cardiology Foundation/American heart association task force on practice guidelines</article-title>. <source>Circulation</source> <volume>128</volume>: <fpage>1810</fpage>–<lpage>1852</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1161/CIR.0b013e31829e8807" xlink:type="simple">10.1161/CIR.0b013e31829e8807</ext-link></comment> <object-id pub-id-type="pmid">23741057</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Catterall</surname> <given-names>WA</given-names></name>. (<year>2000</year>) <article-title>Structure and regulation of voltage-gated Ca2+ channels</article-title>. <source>Annu Rev Cell Dev Biol</source> <volume>16</volume>: <fpage>521</fpage>–<lpage>555</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev.cellbio.16.1.521" xlink:type="simple">10.1146/annurev.cellbio.16.1.521</ext-link></comment> <object-id pub-id-type="pmid">11031246</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bean</surname> <given-names>BP</given-names></name>. (<year>1984</year>) <article-title>Nitrendipine block of cardiac calcium channels: High-affinity binding to the inactivated state</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>81</volume>: <fpage>6388</fpage>–<lpage>6392</lpage>. <object-id pub-id-type="pmid">6093100</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gurney</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Nerbonne</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Lester</surname> <given-names>HA</given-names></name>. (<year>1985</year>) <article-title>Photoinduced removal of nifedipine reveals mechanisms of calcium antagonist action on single heart cells</article-title>. <source>J Gen Physiol</source> <volume>86</volume>: <fpage>353</fpage>–<lpage>379</lpage>. <object-id pub-id-type="pmid">2414392</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schuster</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lacinova</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Klugbauer</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ito</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Birnbaumer</surname> <given-names>L</given-names></name>, <etal>et al</etal>. (<year>1996</year>) <article-title>The IVS6 segment of the L-type calcium channel is critical for the action of dihydropyridines and phenylalkylamines</article-title>. <source>Embo j</source> <volume>15</volume>: <fpage>2365</fpage>–<lpage>2370</lpage>. <object-id pub-id-type="pmid">8665843</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lacinova</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>An</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Xia</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ito</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Klugbauer</surname> <given-names>N</given-names></name>, <etal>et al</etal>. (<year>1999</year>) <article-title>Distinctions in the molecular determinants of charged and neutral dihydropyridine block of L-type calcium channels</article-title>. <source>J Pharmacol Exp Ther</source> <volume>289</volume>: <fpage>1472</fpage>–<lpage>1479</lpage>. <object-id pub-id-type="pmid">10336541</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brezina</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Evans</surname> <given-names>CG</given-names></name>, <name name-style="western"><surname>Weiss</surname> <given-names>KR</given-names></name>. (<year>1994</year>) <article-title>Enhancement of ca current in the accessory radula closer muscle of aplysia californica by neuromodulators that potentiate its contractions</article-title>. <source>J Neurosci</source> <volume>14</volume>: <fpage>4393</fpage>–<lpage>4411</lpage>. <object-id pub-id-type="pmid">7913122</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Catterall</surname> <given-names>WA</given-names></name>. (<year>1995</year>) <article-title>Structure and function of voltage-gated ion channels</article-title>. <source>Annu Rev Biochem</source> <volume>64</volume>: <fpage>493</fpage>–<lpage>531</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev.bi.64.070195.002425" xlink:type="simple">10.1146/annurev.bi.64.070195.002425</ext-link></comment> <object-id pub-id-type="pmid">7574491</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rosenbaum</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Rasmussen</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Kobilka</surname> <given-names>BK</given-names></name>. (<year>2009</year>) <article-title>The structure and function of G-protein-coupled receptors</article-title>. <source>Nature</source> <volume>459</volume>: <fpage>356</fpage>–<lpage>363</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature08144" xlink:type="simple">10.1038/nature08144</ext-link></comment> <object-id pub-id-type="pmid">19458711</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Audet</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bouvier</surname> <given-names>M</given-names></name>. (<year>2012</year>) <article-title>Restructuring G-protein- coupled receptor activation</article-title>. <source>Cell</source> <volume>151</volume>: <fpage>14</fpage>–<lpage>23</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2012.09.003" xlink:type="simple">10.1016/j.cell.2012.09.003</ext-link></comment> <object-id pub-id-type="pmid">23021212</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oldham</surname> <given-names>WM</given-names></name>, <name name-style="western"><surname>Hamm</surname> <given-names>HE</given-names></name>. (<year>2008</year>) <article-title>Heterotrimeric G protein activation by G-protein-coupled receptors</article-title>. <source>Nat Rev Mol Cell Biol</source> <volume>9</volume>: <fpage>60</fpage>–<lpage>71</lpage>. nrm2299 [pii]. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrm2299" xlink:type="simple">10.1038/nrm2299</ext-link></comment> <object-id pub-id-type="pmid">18043707</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gonzalez-Maeso</surname> <given-names>J</given-names></name>. (<year>2011</year>) <article-title>GPCR oligomers in pharmacology and signaling</article-title>. <source>Mol Brain</source> <volume>4</volume>: 20-6606-4-20.</mixed-citation></ref>
<ref id="pcbi.1005376.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gonzalez-Maeso</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ang</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Yuen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Chan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Weisstaub</surname> <given-names>NV</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Identification of a serotonin/glutamate receptor complex implicated in psychosis</article-title>. <source>Nature</source> <volume>452</volume>: <fpage>93</fpage>–<lpage>97</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature06612" xlink:type="simple">10.1038/nature06612</ext-link></comment> <object-id pub-id-type="pmid">18297054</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moreno</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Holloway</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Albizu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Sealfon</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Gonzalez-Maeso</surname> <given-names>J</given-names></name>. (<year>2011</year>) <article-title>Metabotropic glutamate mGlu2 receptor is necessary for the pharmacological and behavioral effects induced by hallucinogenic 5-HT2A receptor agonists</article-title>. <source>Neurosci Lett</source> <volume>493</volume>: <fpage>76</fpage>–<lpage>79</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neulet.2011.01.046" xlink:type="simple">10.1016/j.neulet.2011.01.046</ext-link></comment> <object-id pub-id-type="pmid">21276828</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Patil</surname> <given-names>ST</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Martenyi</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Lowe</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>KA</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Activation of mGlu2/3 receptors as a new approach to treat schizophrenia: A randomized phase 2 clinical trial</article-title>. <source>Nat Med</source> <volume>13</volume>: <fpage>1102</fpage>–<lpage>1107</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nm1632" xlink:type="simple">10.1038/nm1632</ext-link></comment> <object-id pub-id-type="pmid">17767166</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kinon</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Millen</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>Osuntokun</surname> <given-names>OO</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>JE</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>A multicenter, inpatient, phase 2, double-blind, placebo-controlled dose-ranging study of LY2140023 monohydrate in patients with DSM-IV schizophrenia</article-title>. <source>J Clin Psychopharmacol</source> <volume>31</volume>: <fpage>349</fpage>–<lpage>355</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1097/JCP.0b013e318218dcd5" xlink:type="simple">10.1097/JCP.0b013e318218dcd5</ext-link></comment> <object-id pub-id-type="pmid">21508856</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fribourg</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Moreno</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Holloway</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Provasi</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Baki</surname> <given-names>L</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Decoding the signaling of a GPCR heteromeric complex reveals a unifying mechanism of action of antipsychotic drugs</article-title>. <source>Cell</source> <volume>147</volume>: <fpage>1011</fpage>–<lpage>1023</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2011.09.055" xlink:type="simple">10.1016/j.cell.2011.09.055</ext-link></comment> <object-id pub-id-type="pmid">22118459</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moreno</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Sealfon</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Gonzalez-Maeso</surname> <given-names>J</given-names></name>. (<year>2009</year>) <article-title>Group II metabotropic glutamate receptors and schizophrenia</article-title>. <source>Cell Mol Life Sci</source> <volume>66</volume>: <fpage>3777</fpage>–<lpage>3785</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00018-009-0130-3" xlink:type="simple">10.1007/s00018-009-0130-3</ext-link></comment> <object-id pub-id-type="pmid">19707855</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hatcher-Solis</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Fribourg</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Spyridaki</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Younkin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ellaithy</surname> <given-names>A</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>G protein-coupled receptor signaling to kir channels in xenopus oocytes</article-title>. <source>Curr Pharm Biotechnol</source> <volume>15</volume>: <fpage>987</fpage>–<lpage>995</lpage>. <object-id pub-id-type="pmid">25374032</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ellaithy</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Younkin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gonzalez-Maeso</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Logothetis</surname> <given-names>DE</given-names></name>. (<year>2015</year>) <article-title>Positive allosteric modulators of metabotropic glutamate 2 receptors in schizophrenia treatment</article-title>. <source>Trends Neurosci</source> <volume>38</volume>: <fpage>506</fpage>–<lpage>516</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tins.2015.06.002" xlink:type="simple">10.1016/j.tins.2015.06.002</ext-link></comment> <object-id pub-id-type="pmid">26148747</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gerek</surname> <given-names>ZN</given-names></name>, <name name-style="western"><surname>Ozkan</surname> <given-names>SB</given-names></name>. (<year>2011</year>) <article-title>Change in allosteric network affects binding affinities of PDZ domains: Analysis through perturbation response scanning</article-title>. <source>PLoS Comput Biol</source> <volume>7</volume>: <fpage>e1002154</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002154" xlink:type="simple">10.1371/journal.pcbi.1002154</ext-link></comment> <object-id pub-id-type="pmid">21998559</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Braga-Neto</surname> <given-names>UM</given-names></name>, <name name-style="western"><surname>Marques</surname> <given-names>ET</given-names> <suffix>Jr.</suffix></name> (<year>2006</year>) <article-title>From functional genomics to functional immunomics: New challenges, old problems, big rewards</article-title>. <source>PLoS Comput Biol</source> <volume>2</volume>: <fpage>e81</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0020081" xlink:type="simple">10.1371/journal.pcbi.0020081</ext-link></comment> <object-id pub-id-type="pmid">16863395</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bonneau</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Reiss</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Shannon</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Facciotti</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hood</surname> <given-names>L</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>The inferelator: An algorithm for learning parsimonious regulatory networks from systems-biology data sets de novo</article-title>. <source>Genome Biol</source> <volume>7</volume>: <fpage>R36</fpage>. gb-2006-7-5-r36 [pii]. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2006-7-5-r36" xlink:type="simple">10.1186/gb-2006-7-5-r36</ext-link></comment> <object-id pub-id-type="pmid">16686963</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref057"><label>57</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Greenfield</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hafemeister</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bonneau</surname> <given-names>R</given-names></name>. (<year>2013</year>) <article-title>Robust data-driven incorporation of prior knowledge into the inference of dynamic regulatory networks</article-title>. <source>Bioinformatics</source> <volume>29</volume>: <fpage>1060</fpage>–<lpage>1067</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btt099" xlink:type="simple">10.1093/bioinformatics/btt099</ext-link></comment> <object-id pub-id-type="pmid">23525069</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref058"><label>58</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thorne</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Stumpf</surname> <given-names>MP</given-names></name>. (<year>2012</year>) <article-title>Inference of temporally varying bayesian networks</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>3298</fpage>–<lpage>3305</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts614" xlink:type="simple">10.1093/bioinformatics/bts614</ext-link></comment> <object-id pub-id-type="pmid">23074260</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref059"><label>59</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Babtie</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Kirk</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Stumpf</surname> <given-names>MP</given-names></name>. (<year>2014</year>) <article-title>Topological sensitivity analysis for systems biology</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>111</volume>: <fpage>18507</fpage>–<lpage>18512</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1414026112" xlink:type="simple">10.1073/pnas.1414026112</ext-link></comment> <object-id pub-id-type="pmid">25512544</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref060"><label>60</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oates</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Dondelinger</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Bayani</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Korkola</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gray</surname> <given-names>JW</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Causal network inference using biochemical kinetics</article-title>. <source>Bioinformatics</source> <volume>30</volume>: <fpage>i468</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu452" xlink:type="simple">10.1093/bioinformatics/btu452</ext-link></comment> <object-id pub-id-type="pmid">25161235</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref061"><label>61</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Celentano</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Hawkes</surname> <given-names>AG</given-names></name>. (<year>2004</year>) <article-title>Use of the covariance matrix in directly fitting kinetic parameters: Application to GABAA receptors</article-title>. <source>Biophys J</source> <volume>87</volume>: <fpage>276</fpage>–<lpage>294</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1529/biophysj.103.036632" xlink:type="simple">10.1529/biophysj.103.036632</ext-link></comment> <object-id pub-id-type="pmid">15240464</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref062"><label>62</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Baki</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Fribourg</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Younkin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Eltit</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Moreno</surname> <given-names>JL</given-names></name>, <etal>et al</etal>. (<year>2016</year>) <article-title>Cross-signaling in metabotropic glutamate 2 and serotonin 2A receptor heteromers in mammalian cells</article-title>. <source>Pflugers Arch</source> <volume>468</volume>: <fpage>775</fpage>–<lpage>793</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00424-015-1780-7" xlink:type="simple">10.1007/s00424-015-1780-7</ext-link></comment> <object-id pub-id-type="pmid">26780666</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref063"><label>63</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moreno</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Miranda-Azpiazu</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Garcia-Bea</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Younkin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cui</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2016</year>) <article-title>Allosteric signaling through an mGlu2 and 5-HT2A heteromeric receptor complex and its potential contribution to schizophrenia</article-title>. <source>Sci Signal</source> <volume>9</volume>: <fpage>ra5</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/scisignal.aab0467" xlink:type="simple">10.1126/scisignal.aab0467</ext-link></comment> <object-id pub-id-type="pmid">26758213</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref064"><label>64</label><mixed-citation publication-type="other" xlink:type="simple">Dennis J, Vicente L. (1996) Trust-region interior-point algorithms for minimization problems with simple bounds. Applied Mathematics and Parallel Computing.</mixed-citation></ref>
<ref id="pcbi.1005376.ref065"><label>65</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hoops</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sahle</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gauges</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pahle</surname> <given-names>J</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Copasi—a complex pathway simulator</article-title>. <source>Bioinformatics</source> <volume>22</volume>:</mixed-citation></ref>
<ref id="pcbi.1005376.ref066"><label>66</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brezina</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Evans</surname> <given-names>CG</given-names></name>, <name name-style="western"><surname>Weiss</surname> <given-names>KR</given-names></name>. (<year>1994</year>) <article-title>Characterization of the membrane ion currents of a model molluscan muscle, the accessory radula closer muscle of aplysia californica. III. depolarization-activated ca current</article-title>. <source>J Neurophysiol</source> <volume>71</volume>: <fpage>2126</fpage>–<lpage>2138</lpage>. <object-id pub-id-type="pmid">7931506</object-id></mixed-citation></ref>
<ref id="pcbi.1005376.ref067"><label>67</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lopes</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Rohacs</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Jin</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>J</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title>Alterations in conserved kir channel-PIP2 interactions underlie channelopathies</article-title>. <source>Neuron</source> <volume>34</volume>: <fpage>933</fpage>–<lpage>944</lpage>. <object-id pub-id-type="pmid">12086641</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>