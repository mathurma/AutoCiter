<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">09-PLCB-RA-1298R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000813</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Biophysics/Transcription and Translation</subject><subject>Computational Biology/Transcriptional Regulation</subject><subject>Genetics and Genomics/Gene Expression</subject></subj-group></article-categories><title-group><article-title>Combinatorial Gene Regulation Using Auto-Regulation</article-title><alt-title alt-title-type="running-head">Combinatorial Regulation Using Auto-Regulation</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Hermsen</surname><given-names>Rutger</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Ursem</surname><given-names>Bas</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>ten Wolde</surname><given-names>Pieter Rein</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
</contrib-group><aff id="aff1"><label>1</label><addr-line>Center for Theoretical Biological Physics, University of California, San Diego, California, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>FOM Institute AMOLF, Amsterdam, The Netherlands</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Miyano</surname><given-names>Satoru</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">University of Tokyo, Japan</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">hermsen@ctbp.ucsd.edu</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: RH BU PRtW. Performed the experiments: RH BU. Analyzed the data: RH BU PRtW. Wrote the paper: RH.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>6</month><year>2010</year></pub-date><pub-date pub-type="epub"><day>10</day><month>6</month><year>2010</year></pub-date><volume>6</volume><issue>6</issue><elocation-id>e1000813</elocation-id><history>
<date date-type="received"><day>26</day><month>10</month><year>2009</year></date>
<date date-type="accepted"><day>7</day><month>5</month><year>2010</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2010</copyright-year><copyright-holder>Hermsen et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>As many as 59% of the transcription factors in <italic>Escherichia coli</italic> regulate the transcription rate of their own genes. This suggests that auto-regulation has one or more important functions. Here, one possible function is studied. Often the transcription rate of an auto-regulator is also controlled by additional transcription factors. In these cases, the way the expression of the auto-regulator responds to changes in the concentrations of the “input” regulators (the response function) is obviously affected by the auto-regulation. We suggest that, conversely, auto-regulation may be used to optimize this response function. To test this hypothesis, we use an evolutionary algorithm and a chemical–physical model of transcription regulation to design model <italic>cis</italic>-regulatory constructs with predefined response functions. In these simulations, auto-regulation can evolve if this provides a functional benefit. When selecting for a series of elementary response functions—Boolean logic gates and linear responses—the <italic>cis</italic>-regulatory regions resulting from the simulations indeed often exploit auto-regulation. Surprisingly, the resulting constructs use auto-activation rather than auto-repression. Several design principles show up repeatedly in the simulation results. They demonstrate how auto-activation can be used to generate sharp, switch-like activation and repression circuits and how linearly decreasing response functions can be obtained. Auto-repression, on the other hand, resulted only when a high response speed or a suppression of intrinsic noise was also selected for. The results suggest that, while auto-repression may primarily be valuable to improve the dynamical properties of regulatory circuits, auto-activation is likely to evolve even when selection acts on the shape of response function only.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>Bacteria adjust which proteins they make, and how many copies of each kind, depending on their environment. The production rate of each regulated protein is controlled by a special class of proteins called transcription factors. The rate at which a certain protein is produced usually depends on the cellular concentrations of a few such transcription factors. When circumstances change, the concentrations of these transcription factors alter too and consequently the production rates of all proteins regulated by them are adjusted. Interestingly, many transcription factors also regulate their own synthesis rate. This suggests that this self-regulation must have one or more important functions. In this article we study one possible function. In order for cells to function properly each protein concentration has to respond in a particular way to changes in transcription factor concentrations. We have studied how bacteria can optimize and fine-tune these responses. To this end, we formulated a physical model of the regulation by transcription factors and performed computer simulations. These simulations show that self-regulation—and in particular self-activation—is often a useful tool to achieve the prescribed response. Therefore we conclude that natural selection on the regulation of protein levels could naturally lead to self-regulation.</p>
</abstract><funding-group><funding-statement>This work is part of the research program of the “Stichting voor Fundamenteel Onderzoek der Materie (FOM)”, which is financially supported by the “Nederlandse organisatie voor Wetenschappelijk Onderzoek (NWO)”. Also, this work was supported by the Center for Theoretical Biological Physics (NSF PHY-0822283). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="13"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Many transcription factors (TFs) in <italic>Escherichia coli</italic> regulate the transcription rate of their own gene. In fact, 59% of the TFs are known to auto-regulate and the list is growing <xref ref-type="bibr" rid="pcbi.1000813-Keseler1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1000813-Salgado1">[2]</xref>. Negative auto-regulation (auto-repression) occurs more frequently than positive auto-regulation (auto-activation), but both are very common: 71 auto-repressors and 34 auto-activators are found in the current databases (including 9 TFs that have binding sites for auto-activation as well as for auto-repression). This suggests that auto-regulation has one or several important functions <xref ref-type="bibr" rid="pcbi.1000813-Thieffry1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1000813-ShenOrr1">[4]</xref>. In this paper, one possible function is explored. In general, the expression level of a gene is a function of the concentrations of the TFs that regulate its transcription rate. We propose that auto-regulation can naturally be used to optimize the shape of this response function.</p>
<p>Auto-regulating transcription factors are typically regulated by other TFs too. In fact, 23 auto-regulating TFs in <italic>E. coli</italic> are known to respond to at least <italic>two</italic> additional regulators <xref ref-type="bibr" rid="pcbi.1000813-Keseler1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1000813-Salgado1">[2]</xref>. In such cases, the response of the regulated TF to changes in the “input” TF concentrations must reflect an interplay between regulation and auto-regulation. Conversely, this suggests that auto-regulation could emerge as a result of natural selection on the shape of these responses.</p>
<p>In the past years, several other functions of auto-regulation have been proposed. Negative auto-regulation has been shown to decrease the sensitivity of expression levels to intrinsic fluctuations in the transcription rate under certain conditions <xref ref-type="bibr" rid="pcbi.1000813-Becskei1">[5]</xref>–<xref ref-type="bibr" rid="pcbi.1000813-Stekel1">[7]</xref> and to mitigate variations due to changes in the bacterial growth rate <xref ref-type="bibr" rid="pcbi.1000813-Klumpp1">[8]</xref>. In addition, auto-repression can speed up the response of expression levels after a sudden change in conditions <xref ref-type="bibr" rid="pcbi.1000813-Savageau1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1000813-Rosenfeld1">[10]</xref>. In the presence of time delays, it can also create oscillations <xref ref-type="bibr" rid="pcbi.1000813-Elowitz1">[11]</xref>. On the flip side, negative auto-regulation tends to reduce the sensitivity of the expression level to input signals <xref ref-type="bibr" rid="pcbi.1000813-Hornung1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1000813-Nevozhay1">[13]</xref>. The effects of positive auto-regulation are usually opposite to those of auto-repression: it slows down responses and tends to amplify intrinsic fluctuations. At first sight, these qualities may not seem very desirable. Yet, a slow response can be beneficial if a sensitive response to persisting signals is desired while fast fluctuations in the input signal should be ignored <xref ref-type="bibr" rid="pcbi.1000813-Hornung1">[12]</xref>. Occasionally the fact that auto-activation can provide bi-stability may also be useful <xref ref-type="bibr" rid="pcbi.1000813-Becskei2">[14]</xref>. Each of these qualities could be relevant in some cases; our new suggestion does not contradict or replace any of them.</p>
<p>To study the benefits of auto-regulation we use a computational approach that we developed recently <xref ref-type="bibr" rid="pcbi.1000813-Hermsen1">[15]</xref>. In this approach, an evolutionary algorithm and a physical–chemical model of transcription regulation are integrated to design <italic>in silico cis</italic>-regulatory regions with predefined response functions. The evolutionary algorithm subjects a population of model <italic>cis</italic>-regulatory regions to rounds of mutation and selection. The mutations are introduced at the level of base-pair sequences while the selection step is based on the emerging network properties calculated using the model of transcription regulation. In the course of these simulations complex promoter designs develop that perform the desired function; these designs often reveal new design principles. In earlier work, auto-regulation was not included in this method. In contrast, we now use an extended version of the method to design <italic>cis</italic>-regulatory constructs that <italic>can</italic> exploit feedback.</p>
<p>Many <italic>cis</italic>-regulatory regions in real cells essentially implement logical decisions <xref ref-type="bibr" rid="pcbi.1000813-Hermsen1">[15]</xref>–<xref ref-type="bibr" rid="pcbi.1000813-Kaplan1">[17]</xref>. We therefore study the class of response functions that can be interpreted as analogue equivalents of logic gates. <italic>Gates</italic> are computational devices that produce an output signal depending on one or more input signals; <italic>logic gates</italic> are gates that implement a binary (Boolean) decision rule. For example, a transcriptional AND gate would be a gene whose expression (the “output”) is regulated by two TFs (the “inputs”, TF1 and TF2) such that it is transcribed only if both TF1 <italic>and</italic> TF2 have a sufficient expression level <xref ref-type="bibr" rid="pcbi.1000813-Buchler1">[16]</xref>. We refer to <xref ref-type="table" rid="pcbi-1000813-t001">Table 1</xref> for the definitions of other logic gates. Even though it has proven fruitful to think of promoters as analog approximations of logic gates, we stress that gene expression levels are of course not actually binary and that we do not treat them as binary in the models below.</p>
<table-wrap id="pcbi-1000813-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000813.t001</object-id><label>Table 1</label><caption>
<title>Truth tables of transcriptional logic gates.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000813-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="2" rowspan="1">input TFs</td>
<td align="left" colspan="6" rowspan="1">output (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e001" xlink:type="simple"/></inline-formula>)</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e002" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e003" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><sc>and</sc></td>
<td align="left" colspan="1" rowspan="1"><sc>or</sc></td>
<td align="left" colspan="1" rowspan="1"><sc>nor</sc></td>
<td align="left" colspan="1" rowspan="1"><sc>nand</sc></td>
<td align="left" colspan="1" rowspan="1"><sc>act</sc><xref ref-type="table-fn" rid="nt101">†</xref></td>
<td align="left" colspan="1" rowspan="1">IN<xref ref-type="table-fn" rid="nt101">†</xref></td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">low</td>
<td align="left" colspan="1" rowspan="1">low</td>
<td align="left" colspan="1" rowspan="1">low</td>
<td align="left" colspan="1" rowspan="1">low</td>
<td align="left" colspan="1" rowspan="1">high</td>
<td align="left" colspan="1" rowspan="1">high</td>
<td align="left" colspan="1" rowspan="1">low</td>
<td align="left" colspan="1" rowspan="1">high</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">low</td>
<td align="left" colspan="1" rowspan="1">high</td>
<td align="left" colspan="1" rowspan="1">low</td>
<td align="left" colspan="1" rowspan="1">high</td>
<td align="left" colspan="1" rowspan="1">low</td>
<td align="left" colspan="1" rowspan="1">high</td>
<td align="left" colspan="1" rowspan="1">low</td>
<td align="left" colspan="1" rowspan="1">high</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">high</td>
<td align="left" colspan="1" rowspan="1">low</td>
<td align="left" colspan="1" rowspan="1">low</td>
<td align="left" colspan="1" rowspan="1">high</td>
<td align="left" colspan="1" rowspan="1">low</td>
<td align="left" colspan="1" rowspan="1">high</td>
<td align="left" colspan="1" rowspan="1">high</td>
<td align="left" colspan="1" rowspan="1">low</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">high</td>
<td align="left" colspan="1" rowspan="1">high</td>
<td align="left" colspan="1" rowspan="1">high</td>
<td align="left" colspan="1" rowspan="1">high</td>
<td align="left" colspan="1" rowspan="1">low</td>
<td align="left" colspan="1" rowspan="1">low</td>
<td align="left" colspan="1" rowspan="1">high</td>
<td align="left" colspan="1" rowspan="1">low</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt101"><label>†</label><p>The <sc>act</sc> and <sc>inh</sc> gates have only one input; they depend on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e004" xlink:type="simple"/></inline-formula> only.</p></fn><fn id="nt102"><label/><p>Logic gates are devices that perform elementary binary computations, mapping multiple input signals to one output signal. Here we consider <italic>transcriptional</italic> logic gates. Transcription systems are analogue systems and therefore never truly binary, but it is often useful to think of them as continuous approximations of logic gates. Here, we consider logic gates with one or two inputs (the concentrations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e005" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e006" xlink:type="simple"/></inline-formula> of two transcription factors), and one output (the steady-state expression level of the regulated gene: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e007" xlink:type="simple"/></inline-formula>). The table specifies, for the six logic gates used in our study, the value of the appropriate output <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e008" xlink:type="simple"/></inline-formula> (“low” or “high”) for all input concentrations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e009" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e010" xlink:type="simple"/></inline-formula> (“low” or “high”). All gates are defined for input concentrations in the domain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e011" xlink:type="simple"/></inline-formula> only; concentrations above 500nM are considered high and those below 500nM are low. The acronyms of the gates summarize their function; for instance, the output of an AND gate should be high only when both <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e012" xlink:type="simple"/></inline-formula> <italic>and</italic> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e013" xlink:type="simple"/></inline-formula> are high. Note that that by definition the ACT (activate) and IN (inhibit) gates have only one input, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e014" xlink:type="simple"/></inline-formula>; indeed, their output does not depend on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e015" xlink:type="simple"/></inline-formula>.</p></fn></table-wrap-foot></table-wrap>
<p>We analyze the <italic>cis</italic>-regulatory sequences resulting from the simulations by calculating DNA footprints for the resulting transcription factors and promoter sequences. These footprints show that auto-regulation—in particular auto-<italic>activation</italic>—is often used in these <italic>cis</italic>-regulatory regions; indeed, further analysis shows that auto-activation can be used to construct “better” transcriptional logic gates by allowing for more switch-like, “steep” response functions. However, the use of auto-regulation in shaping response functions is not limited to creating switch-like functions. To demonstrate this, we also applied our method to the design of <italic>cis</italic>-regulatory constructs that respond in a <italic>linear</italic> fashion to input concentrations. Again we find that auto-activation emerges spontaneously in the results.</p>
<p>Finally, we also performed simulations in which we selected for designs with desirable dynamical qualities. First, we adjusted the method to select for gates with a short response time. Second, we performed selection against intrinsic fluctuations. In agreement with earlier results <xref ref-type="bibr" rid="pcbi.1000813-Becskei1">[5]</xref>–<xref ref-type="bibr" rid="pcbi.1000813-Stekel1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1000813-Savageau1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1000813-Rosenfeld1">[10]</xref>, auto-repression evolved in both cases, demonstrating how auto-repression can be used to speed up response times or to reduce intrinsic fluctuations.</p>
<p>Before describing the results we first provide a detailed description of the model and the algorithm used.</p>
</sec><sec id="s2" sec-type="methods">
<title>Methods</title>
<p>We combine a model of transcription regulation and an evolutionary algorithm to design <italic>in silico cis</italic>-regulatory regions with a predefined function. The model of transcription regulation is constructed such that all properties of a model regulatory network follow entirely from the sequences of TFs and <italic>cis</italic>-regulatory regions. Binding sites of TFs are therefore not specified beforehand but appear gradually in the course of the simulations. The model is an extension to the one described in detail in our earlier publication <xref ref-type="bibr" rid="pcbi.1000813-Hermsen1">[15]</xref>. The main innovation is that auto-regulatory interactions are now also included, so that auto-regulation can evolve if this is beneficial.</p>
<sec id="s2a">
<title>Model of transcriptional regulation</title>
<p>We consider one “output” gene, <italic>tf3</italic>, and at most two “input” transcription factors, TF1 and TF2. The gene <italic>tf3</italic> codes for another transcription factor called TF3. All three TFs can regulate the transcription rate of <italic>tf3</italic> by binding to its <italic>cis</italic>-regulatory region. (See <xref ref-type="fig" rid="pcbi-1000813-g001">Fig. 1</xref> for an illustration of the model.)</p>
<fig id="pcbi-1000813-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000813.g001</object-id><label>Figure 1</label><caption>
<title>Illustration of the model of transcription regulation.</title>
<p>The model describes the transcriptional regulation of a gene <italic>tf3</italic> by two transcription factors, TF1 and TF2. In addition, auto-regulation is included: the gene product TF3 of <italic>tf3</italic> can regulate the transcription of <italic>tf3</italic>. TFs act by binding to <italic>tf3</italic>'s <italic>cis</italic>-regulatory region, represented as a string of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e016" xlink:type="simple"/></inline-formula> located directly upstream of the start of transcription. The TF binding domains count <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e017" xlink:type="simple"/></inline-formula> amino acids, and bind to binding sites of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e018" xlink:type="simple"/></inline-formula> bp. TFs can bind anywhere on the <italic>cis</italic>-regulatory region but with varying affinity determined by the DNA sequence. When two TFs bind within a distance less than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e019" xlink:type="simple"/></inline-formula>, they interact with energy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e020" xlink:type="simple"/></inline-formula>, as is indicated schematically by a yellow connection between the TFs. This way cooperative binding is included. The core promoter, consisting of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e021" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e022" xlink:type="simple"/></inline-formula> hexamers, is marked; when RNA polymerase (RNAP) binds to it, it blocks both hexamers and the spacer between them. When a TF binds close to the RNAP we assume an interaction energy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e023" xlink:type="simple"/></inline-formula>; thus the mechanism of regulated recruitment is included. The TF that binds to a site overlapping with the core promoter is red to indicate that it represses transcription by steric hindrance; the green TF is an activator, as it recruits RNAP from its binding site. The gray TFs bind too far upstream to influence the transcription rate.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.g001" xlink:type="simple"/></fig>
<p>The <italic>cis</italic>-regulatory region and the TFs are represented as nucleotide sequences and amino-acid sequences respectively. All TFs can bind anywhere on the <italic>cis</italic>-regulatory region, but the affinity of a TF for a particular site depends on the sequences of the TF and the site. For our purpose, it is sufficient to only model the DNA-binding domains of the TFs explicitly. We assume that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e024" xlink:type="simple"/></inline-formula> amino-acids in these domains are responsible for the DNA-binding specificity and therefore represent each TF as an amino-acid sequence of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e025" xlink:type="simple"/></inline-formula>. We choose <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e026" xlink:type="simple"/></inline-formula> in our simulations because known binding sites in <italic>E. coli</italic> typically have length 6 to 15 and usually one base pair interacts with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e027" xlink:type="simple"/></inline-formula> amino acid in TF–DNA binding <xref ref-type="bibr" rid="pcbi.1000813-Salgado1">[2]</xref>. The <italic>cis</italic>-regulatory region of <italic>tf3</italic> is a base-pair sequence of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e028" xlink:type="simple"/></inline-formula>; we take <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e029" xlink:type="simple"/></inline-formula> because in <italic>E. coli</italic> most transcription factors bind within <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e030" xlink:type="simple"/></inline-formula> from the start of transcription <xref ref-type="bibr" rid="pcbi.1000813-ColladoVides1">[18]</xref>. By the rules specified below all interactions between TFs, RNA polymerase (RNAP) and the <italic>cis</italic>-regulatory region can be deduced from these sequences; therefore each transcriptional gate is completely specified by them.</p>
<p>The various molecules interact in the following ways:</p>
<sec id="s2a1">
<title>TF–DNA interactions</title>
<p>Each TF <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e031" xlink:type="simple"/></inline-formula> can bind to any site <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e032" xlink:type="simple"/></inline-formula> on the <italic>cis</italic>-regulatory region, but the affinity of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e033" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e034" xlink:type="simple"/></inline-formula> depends on the DNA sequence of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e035" xlink:type="simple"/></inline-formula> and the amino-acid sequence of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e036" xlink:type="simple"/></inline-formula>. Each amino acid interacts with exactly one base pair, and the total binding free energy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e037" xlink:type="simple"/></inline-formula> is the sum of the contributions of each amino-acid–base-pair contact. This means that the binding free energy of a TF with amino acids <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e038" xlink:type="simple"/></inline-formula> to a binding site with base pairs <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e039" xlink:type="simple"/></inline-formula> is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e040" xlink:type="simple"/><label>(1)</label></disp-formula>Here <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e041" xlink:type="simple"/></inline-formula> is a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e042" xlink:type="simple"/></inline-formula> matrix containing the binding free energies associated with each amino-acid–base-pair contact. We used the matrix given in <xref ref-type="bibr" rid="pcbi.1000813-MandelGutfreund1">[19]</xref>, based on christallographically solved protein–DNA complexes.</p>
</sec><sec id="s2a2">
<title>TF–TF interactions</title>
<p>TFs are assumed to mutually interact in two ways. First, TFs cannot bind simultaneously to overlapping binding sites due to steric hindrance. This introduces competition for binding to overlapping binding sites. Second, if two TFs bind within a distance of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e043" xlink:type="simple"/></inline-formula> base pairs, they interact cooperatively: if one of the TFs is bound, the equilibrium dissociation constant of the other TF is decreased by a factor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e044" xlink:type="simple"/></inline-formula>, corresponding to an interaction energy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e045" xlink:type="simple"/></inline-formula>. In reality, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e046" xlink:type="simple"/></inline-formula> is typically <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e047" xlink:type="simple"/></inline-formula> (about <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e048" xlink:type="simple"/></inline-formula>), leading to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e049" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1000813-Shea1">[20]</xref>. Many TFs interact by direct contact, but indirect interactions may also occur, for instance if one TF bends, stretches or super-coils the local DNA and thus increases the affinity of the other TF. In the context of this model it is irrelevant which mechanism is responsible for the cooperativity.</p>
</sec><sec id="s2a3">
<title>RNAP–DNA interactions</title>
<p>RNAP is assumed to bind only to the basal promoter. The affinity of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e050" xlink:type="simple"/></inline-formula> for the core promoter is determined by the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e051" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e052" xlink:type="simple"/></inline-formula> consensus hexamer sequences on the <italic>cis</italic>-regulatory region of <italic>tf3</italic>. We determine the binding free energy of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e053" xlink:type="simple"/></inline-formula> for a core promoter by comparing the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e054" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e055" xlink:type="simple"/></inline-formula> hexamers to a large set of real <italic>E. coli</italic> promoters, taken from reference <xref ref-type="bibr" rid="pcbi.1000813-Lisser1">[21]</xref>. To every base pair <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e056" xlink:type="simple"/></inline-formula> at position <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e057" xlink:type="simple"/></inline-formula> within the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e058" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e059" xlink:type="simple"/></inline-formula> hexamers we assign a score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e060" xlink:type="simple"/></inline-formula>; it equals the fraction of real <italic>E. coli</italic> promoters that have <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e061" xlink:type="simple"/></inline-formula> at that particular position, normalized by the random fraction 1/4. Next, the binding energy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e062" xlink:type="simple"/></inline-formula> of RNAP to that particular core promoter can be estimated by <xref ref-type="bibr" rid="pcbi.1000813-Berg1">[22]</xref>–<xref ref-type="bibr" rid="pcbi.1000813-Berg3">[24]</xref>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e063" xlink:type="simple"/><label>(2)</label></disp-formula>Thus, promoter sequences that are more similar to the consensus sequence of real promoters yield a higher affinity.</p>
</sec><sec id="s2a4">
<title>TF–RNAP interactions</title>
<p>TFs interact with RNAP and influence the transcription rate by the principles of regulated recruitment <xref ref-type="bibr" rid="pcbi.1000813-Ptashne1">[25]</xref>. If TFs bind to a site overlapping the basal promoter they block the binding of RNAP and thus repress transcription. On the other hand, if they bind within a distance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e064" xlink:type="simple"/></inline-formula> from the promoter we assume that the TF and RNAP interact cooperatively. If the TF is bound to its binding site, this decreases the dissociation constant of RNAP binding to the promoter by a factor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e065" xlink:type="simple"/></inline-formula> (corresponding to an interaction energy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e066" xlink:type="simple"/></inline-formula>); thus, the TF recruits RNAP and activates transcription.</p>
<p>The transcription rate of <italic>tf3</italic> is assumed to be proportional to the equilibrium fraction of time the promoter is occupied by RNAP <xref ref-type="bibr" rid="pcbi.1000813-Shea1">[20]</xref>. This occupancy can be computed given all sequences and the concentrations of the TFs (denoted by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e067" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e068" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e069" xlink:type="simple"/></inline-formula>). For this we use the statistical mechanics formalism originally developed in Ref. <xref ref-type="bibr" rid="pcbi.1000813-Shea1">[20]</xref> and explained in detail in references <xref ref-type="bibr" rid="pcbi.1000813-Bintu1">[26]</xref> and <xref ref-type="bibr" rid="pcbi.1000813-Hermsen1">[15]</xref>. Briefly, the method calculates the partition sum <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e070" xlink:type="simple"/></inline-formula> of all states of the system in which RNAP is bound to the promoter, and the partition sum <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e071" xlink:type="simple"/></inline-formula> of all states in which RNAP is <italic>not</italic> bound; the fractional occupancy of the promoter is then given by:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e072" xlink:type="simple"/><label>(3)</label></disp-formula>Note that, in general, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e073" xlink:type="simple"/></inline-formula> is a function of all three TF concentrations. To efficiently take into account all possible configurations in which TFs could be bound to the <italic>cis</italic>-regulatory region we use the efficient recursive (dynamic programming) algorithm presented in <xref ref-type="bibr" rid="pcbi.1000813-Hermsen1">[15]</xref>.</p>
<p>The model described above contains the generic mechanisms that are responsible for many of the known transcription regulatory interactions. Yet, several mechanisms that play a role in specific systems are not included; for instance, the model does not include DNA looping, extended <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e074" xlink:type="simple"/></inline-formula> regions or twisting or bending of the DNA by TFs. This suggests that real transcriptional regulatory systems are probably more flexible than our model systems. However, by endowing our model with only the basic features known to be important in virtually any transcription system we ensure that the resulting designs do not rely on exotic mechanisms.</p>
</sec></sec><sec id="s2b">
<title>Model of the dynamics</title>
<p>We model the dynamics of the concentration of TF3, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e075" xlink:type="simple"/></inline-formula>, by the following ordinary differential equation:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e076" xlink:type="simple"/><label>(4)</label></disp-formula>Here <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e077" xlink:type="simple"/></inline-formula> is the maximal production rate of TF3, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e078" xlink:type="simple"/></inline-formula> is the degradation rate constant of TF3. The function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e079" xlink:type="simple"/></inline-formula> was defined above. In this simplified description, transcription and translation are concatenated and translational regulation is not included.</p>
<p>The concentrations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e080" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e081" xlink:type="simple"/></inline-formula> of TF1 and TF2 are considered the inputs of the gate. Assuming that the system is mono-stable (bi-stability is discussed below) equation 4 defines a unique steady state for each set of input concentrations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e082" xlink:type="simple"/></inline-formula> in which <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e083" xlink:type="simple"/></inline-formula> has a value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e084" xlink:type="simple"/></inline-formula>. This steady-state concentration is considered the output of the gate. Because time delays between transcription initiation and translation are ignored, oscillations are excluded and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e085" xlink:type="simple"/></inline-formula> can be calculated by propagating the dynamics numerically from any initial condition until the steady state is reached. (If a gate has only one input, the dependence on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e086" xlink:type="simple"/></inline-formula> is simply dropped.)</p>
<p>We choose the constants <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e087" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e088" xlink:type="simple"/></inline-formula> such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e089" xlink:type="simple"/></inline-formula>; this ensures that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e090" xlink:type="simple"/></inline-formula> stays within the range <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e091" xlink:type="simple"/></inline-formula>. Apart from this ratio the values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e092" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e093" xlink:type="simple"/></inline-formula> are irrelevant because in this work we are not interested in absolute time scales of the dynamics; for simplicity we use a time unit <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e094" xlink:type="simple"/></inline-formula> such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e095" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s2c">
<title>Evolutionary algorithm</title>
<p>In order to design networks with a prescribed function an evolutionary algorithm was used. A population of 200 transcriptional gates was subjected to 1000 cycles of mutation, selection and replication. Initially, all gates had random sequences. Auto-regulation was not imposed, but the system was free to exploit it by evolving binding sites for TF3. The details of the evolutionary algorithm were chosen to combine an effective optimization of the gates with computational efficiency; we emphasize that we do not intend to faithfully mimic biological evolution.</p>
<p>Several types of mutations were included. First, a base substitution could occur in <italic>cis</italic>-regulatory sequences (with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e096" xlink:type="simple"/></inline-formula> per <italic>cis</italic>-regulatory region). If this happened, a base pair was selected at random from the <italic>cis</italic>-regulatory sequence and substituted by a randomly chosen nucleotide. Second, insertions or deletions of a random base pair occurred in <italic>cis</italic>-regulatory regions (with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e097" xlink:type="simple"/></inline-formula>). Third, we applied point mutations to the sequences of the TFs (with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e098" xlink:type="simple"/></inline-formula> per TF), in which case one randomly chosen amino acid in the sequence was replaced by a random alternative. The exact mutation rates are not crucial for the results, as long as the rates are (i) high enough to generate significant variation and (ii) low enough to allow high-quality gates to persist in the population.</p>
<p>For the selection step a fitness score <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e099" xlink:type="simple"/></inline-formula> was used. Here <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e100" xlink:type="simple"/></inline-formula> (where RF stands for Response Function) measures the deviation of the response function from a predefined goal function (the desired response function). It was computed as follows. When evaluating gates with two inputs, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e101" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e102" xlink:type="simple"/></inline-formula>, the output level <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e103" xlink:type="simple"/></inline-formula> was computed for 16 combinations of the input concentrations: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e104" xlink:type="simple"/></inline-formula> (see the red dots in <xref ref-type="fig" rid="pcbi-1000813-g002">Fig. 2B</xref>). Next, the differences between these output levels and the goal function were computed. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e105" xlink:type="simple"/></inline-formula> was defined as the sum of the squares of these deviations. If the gate had only one input, the definition was analogous, except that seven input values were used, equally spaced in the interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e106" xlink:type="simple"/></inline-formula>. The constant <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e107" xlink:type="simple"/></inline-formula> is required to make <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e108" xlink:type="simple"/></inline-formula> dimensionless (for simplicity, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e109" xlink:type="simple"/></inline-formula>) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e110" xlink:type="simple"/></inline-formula> is an arbitrary constant large enough to ensure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e111" xlink:type="simple"/></inline-formula>. Based on the fitness scores, the top 20% of the population were selected and the remaining gates discarded. Subsequently the population was brought back to its initial size by duplicating gates randomly chosen from the survivors of the selection process.</p>
<fig id="pcbi-1000813-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000813.g002</object-id><label>Figure 2</label><caption>
<title>Conditional auto-activation.</title>
<p>In some simulation results, auto-activation occurs only in the presence of another transcription factor (TF). We call this conditional auto-activation. The figure presents two examples. Fig. A: The promoter of an AND gate using conditional auto-activation and, for comparison, one using hetero-cooperative activation. Both designs emerged in the simulations. In the first case, the regulated gene <italic>tf3</italic> codes for a transcription factor TF3 that binds to its own <italic>cis</italic>-regulatory region. However, from its binding site, TF3 can activate transcription only indirectly, by facilitating the binding of TF1 and TF2 to their binding sites. As a result, the auto-activation depends on the presence of TF1 and TF2 (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e112" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e113" xlink:type="simple"/></inline-formula>). Fig. B shows plots of the expression level of <italic>tf3</italic> (fold-change <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e114" xlink:type="simple"/></inline-formula> vs. the concentrations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e115" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e116" xlink:type="simple"/></inline-formula> of TF1 and TF2) resulting from the <italic>cis</italic>-regulatory regions in Fig. A. The red dots show the values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e117" xlink:type="simple"/></inline-formula> that were used to evaluate the fitness of the gate (see <xref ref-type="sec" rid="s2">Methods</xref>). Fig. C and D show the same mechanism in a simplified model inspired by the simulation results. Plot D compares the response functions corresponding to three activation systems depicted in C. In all cases, a single TF activates the expression of a gene <italic>tf3</italic> coding for another transcription factor, TF3. The first two scenarios constitute conventional activation systems with one or two binding sites. In the third scenario, one binding site is replaced by an operator for TF3, which introduces a positive feedback loop depending on the presence TF1. The binding affinities of all sites are optimized using the fitness function described in the main text. The response of the conditional auto-activation system is clearly sharper/more sensitive than the one using a single activation site. Cooperative auto-activation by two sites, however, leads to a slightly sharper response. The results suggest that conditional auto-activation is an alternative design principle that can be used to sharpen responses.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.g002" xlink:type="simple"/></fig>
<p>If auto-activation evolved, the system could become bi-stable. In bi-stable systems, given the inputs <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e118" xlink:type="simple"/></inline-formula> two different values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e119" xlink:type="simple"/></inline-formula> are stable under the dynamics of the system (equation 4) so that the output concentration <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e120" xlink:type="simple"/></inline-formula> is not uniquely defined by the input concentrations. Even though bi-stability is likely to occur in some real transcription networks we decided that such systems do not qualify as gates, since gates by definition map input states to a uniquely defined output state. The fitness function therefore contained an additional term that was designed to penalize bi-stability. When evaluating the fitness of a gate, we always computed the steady-state value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e121" xlink:type="simple"/></inline-formula> <italic>twice</italic> for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e122" xlink:type="simple"/></inline-formula> input values <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e123" xlink:type="simple"/></inline-formula>: once by propagating the differential equation 4 using initial condition <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e124" xlink:type="simple"/></inline-formula> and once using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e125" xlink:type="simple"/></inline-formula>. If the results were different, the difference squared was added to the fitness function, which was sufficient to assure that the particular gate was eliminated by the selection process. However, because this method did not exclude bi-stability for all possible input values we also checked afterward whether the results were bi-stable.</p>
</sec><sec id="s2d">
<title>Definition of the gates</title>
<p>All gates are defined for input concentrations in the domain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e126" xlink:type="simple"/></inline-formula> only. The logic gates are specified in <xref ref-type="table" rid="pcbi-1000813-t001">Table 1</xref>. In addition we define LACT, LIN, MEAN and NMEAN gates. A LACT (linear activate) gate has one input, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e127" xlink:type="simple"/></inline-formula>, and the output <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e128" xlink:type="simple"/></inline-formula> responds as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e129" xlink:type="simple"/></inline-formula>. A LIN (linear inhibit) gate also has one input, but responds according to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e130" xlink:type="simple"/></inline-formula>. A MEAN gate is linear in two inputs, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e131" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e132" xlink:type="simple"/></inline-formula>, and obeys <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e133" xlink:type="simple"/></inline-formula>. Lastly, we define NMEAN to have the following linearly decreasing response function: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e134" xlink:type="simple"/></inline-formula>.</p>
<p>We repeated the simulations for each of the gates 20 times with different random seeds.</p>
</sec><sec id="s2e">
<title>Quantifying the degree of auto-regulation</title>
<p>In order to quantify the importance of auto-regulation in a particular design we defined the measure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e135" xlink:type="simple"/></inline-formula> (referred to as the “feedback measure”). First, we calculated the response function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e136" xlink:type="simple"/></inline-formula> for the particular design. Then we artificially removed all possible binding sites for TF3 by setting the affinity of TF3 for all sites on the <italic>cis</italic>-regulatory region to zero and calculated the response function again; we call the result <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e137" xlink:type="simple"/></inline-formula>. In the absence of auto-regulation one should find <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e138" xlink:type="simple"/></inline-formula>, but if auto-regulation does play a role the two functions differ. Therefore the difference between these functions is a measure of the degree of auto-regulation; we define <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e139" xlink:type="simple"/></inline-formula> as the mean of the squared differences <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e140" xlink:type="simple"/></inline-formula> over 16 combinations of the input concentrations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e141" xlink:type="simple"/></inline-formula> (again, the red dots in <xref ref-type="fig" rid="pcbi-1000813-g002">Fig. 2</xref>). If auto-regulation is not being exploited by a certain design <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e142" xlink:type="simple"/></inline-formula> is generally small (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e143" xlink:type="simple"/></inline-formula>). If, on the other hand, auto-regulation is used the resulting value is typically in the range <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e144" xlink:type="simple"/></inline-formula>. (For instance, if all 16 points shift by 100nM when auto-regulation is removed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e145" xlink:type="simple"/></inline-formula>.)</p>
</sec><sec id="s2f">
<title>Recognizing binding sites</title>
<p>During the simulations, binding sites emerge in the initially random <italic>cis</italic>-regulatory promoter sequences. However, since the equilibrium binding constants have continuous values there is no fundamental distinction between binding sites and non-binding sites. Recognizing binding sites is further complicated by the fact that, in particular in the presence of cooperativity, weak binding sites can be important. Nevertheless, in order to understand the design principles of a particular gate we wish to identify which binding sites are necessary and sufficient to explain the observed promoter response. This problem is not an artifact of our models: the exact same conceptual problems occur whenever one tries to identify the binding sites of real TFs by experiment.</p>
<p>Since a direct cutoff in terms of the equilibrium constants would eliminate possibly important weak sites we use computational “DNA footprints” (analogous to experimental techniques such as DNase I footprinting) to select those sites that are likely to be important. For each TF <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e146" xlink:type="simple"/></inline-formula> and each site <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e147" xlink:type="simple"/></inline-formula>, we calculate the steady-state occupancy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e148" xlink:type="simple"/></inline-formula> for four sets of input concentrations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e149" xlink:type="simple"/></inline-formula>. Sites that influence the response of the gate should have a significant occupancy in at least one of these digital footprints.</p>
<p>We define <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e150" xlink:type="simple"/></inline-formula> to be the maximal occupancy of site <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e151" xlink:type="simple"/></inline-formula> by TF <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e152" xlink:type="simple"/></inline-formula> over the four conditions. Figure 4 in <xref ref-type="supplementary-material" rid="pcbi.1000813.s001">Text S1</xref> shows a histogram of these occupancies for all TFs and all sites using data gathered from the results of 200 simulations. This histogram is bi-modal. The vast majority of the maximal occupancies <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e153" xlink:type="simple"/></inline-formula> have negligible values but a second peak occurs at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e154" xlink:type="simple"/></inline-formula>. This peak is the result of selection pressure and is associated with functional binding sites. Based on this histogram, we use a rather stringent cut-off at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e155" xlink:type="simple"/></inline-formula> to separate binding sites from pseudo binding sites. Simplified models that only take into account these selected binding sites and assume that all other binding affinities are zero usually accurately reproduce the response function of the full, unsimplified system. In rare cases where this is not the case the threshold can be lowered to obtain more accurate but more complex models; this was not necessary for the examples presented below. (See the <xref ref-type="supplementary-material" rid="pcbi.1000813.s001">Text S1</xref> for more details and examples of footprinting profiles.)</p>
</sec></sec><sec id="s3">
<title>Results</title>
<p>Below, we describe the results of the simulations. We regularly compare the results to our previous work in which auto-regulation was excluded (Ref. <xref ref-type="bibr" rid="pcbi.1000813-Hermsen1">[15]</xref>). In some cases the simulations presented here resulted in the same designs as before. But in other cases the designs exploited auto-regulation to arrive at novel and often superior designs. We identified several mechanisms that are used repeatedly in the results and present them below. Details about several of the analyses below can be found in <xref ref-type="supplementary-material" rid="pcbi.1000813.s001">Text S1</xref>.</p>
<sec id="s3a">
<title>Conditional auto-activation leads to steep responses</title>
<p>The first mechanism that our scheme elucidated, we called <italic>conditional auto-activation</italic>. This mechanism occurred in AND and ACT (activation) gates (see <xref ref-type="table" rid="pcbi-1000813-t001">Table 1</xref> for the definitions), in which cooperative activation plays a key role. In those gates, conditional auto-activation is used to create a steep, switch-like response. As an example, we first discuss the design of AND gates.</p>
<p>In simulations in which auto-regulation was excluded by the method, the resulting AND gate designs always consist of a tandem array of binding sites to which TF1 and TF2 bind cooperatively (see <xref ref-type="fig" rid="pcbi-1000813-g002">Fig. 2A</xref>) <xref ref-type="bibr" rid="pcbi.1000813-Hermsen1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1000813-Buchler1">[16]</xref>. We called this a hetero-cooperative module. This design functions as follows. Crucially, the binding site from which RNAP is recruited (the site directly next to the core promoter) is too weak to considerably activate transcription on its own. As a result, only when TF1 and TF2 are both present at sufficient concentrations they bind cooperatively and activate transcription, as the definition of an AND gate requires. In the new simulations, in which auto-regulation can evolve, this design still emerged in 14 out of 20 simulation runs. Each of these gates has a feedback measure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e156" xlink:type="simple"/></inline-formula>, proving that auto-regulation does not play any role.</p>
<p>The remaining 6 simulation runs resulted in conditional auto-activation. In these gates the feedback measure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e157" xlink:type="simple"/></inline-formula> was high, in the range <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e158" xlink:type="simple"/></inline-formula>. The new design looks very similar to the old one (see <xref ref-type="fig" rid="pcbi-1000813-g002">Fig. 2A and B</xref>). However, the hetero-cooperative module now also contains a binding site for TF3, which leads to a positive feedback loop. Importantly, TF3 bound at its binding site cannot recruit RNAP directly; instead, it interacts with the hetero-cooperative activation module. As a result, the auto-activation is conditional on the presence of TF1 and TF2. As the concentrations of TF1 and/or TF2 increase, the auto-activation is gradually turned on, leading to a sudden (steep, switch-like) response.</p>
<p>The exact same mechanism is exploited by some ACT gates. Out of the 20 simulations of ACT gates, 3 resulted in conditional auto-activation (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e159" xlink:type="simple"/></inline-formula> values were <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e160" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e161" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e162" xlink:type="simple"/></inline-formula>), while the other 17 did not use auto-regulation (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e163" xlink:type="simple"/></inline-formula>).</p>
<p>The basic mechanism can be studied in minimal models inspired by the simulation results. In <xref ref-type="fig" rid="pcbi-1000813-g002">Fig. 2C and D</xref>, we compare three activation mechanisms. The first scenario is conventional activation by a single TF1 binding site. In the second scenario only a homo-cooperative activation module is present, consisting of two binding sites for TF1. In the third scenario, the auxiliary TF1 site is replaced by a binding site for TF3, introducing conditional auto-activation. In all designs we chose the binding site affinities such that they maximize the fitness function for the ACT gate. Conditional auto-activation indeed produces a response that is steeper than the one resulting from the design with a single activator binding site (<xref ref-type="fig" rid="pcbi-1000813-g002">Fig. 2D</xref>). However, the conventional cooperative design with two binding sites gives an even steeper result. The results imply that, after one binding site has evolved for the activator TF1, the response can be improved in two ways: by adding an additional site for TF1 (leading to cooperative activation) or by adding a site for TF3 (resulting in conditional auto-activation). Which design emerges therefore depends critically on the actual sequences and mutations occurring in the population. This explains why cooperative activation and conditional auto-activation show up as alternatives in the simulations.</p>
<p>The effect of conditional auto-activation can be understood quantitatively by studying the minimal model mathematically. The response function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e164" xlink:type="simple"/></inline-formula> for the minimal model follows from the condition <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e165" xlink:type="simple"/></inline-formula> and is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e166" xlink:type="simple"/><label>(5)</label></disp-formula>with<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e167" xlink:type="simple"/></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e168" xlink:type="simple"/></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e169" xlink:type="simple"/></disp-formula>Here <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e170" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e171" xlink:type="simple"/></inline-formula> denote the dissociation constants for TF1 and TF3 binding to their respective operator, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e172" xlink:type="simple"/></inline-formula> is the concentration of RNAP normalized by the dissociation constant of RNAP binding to the promoter, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e173" xlink:type="simple"/></inline-formula>. We first consider the limit of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e174" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e175" xlink:type="simple"/></inline-formula>. In this limit <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e176" xlink:type="simple"/></inline-formula> is small as long as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e177" xlink:type="simple"/></inline-formula>. The numerator of 5 can then be approximated by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e178" xlink:type="simple"/></inline-formula>. As a result we can distinguish two regimes depending on the sign of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e179" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e180" xlink:type="simple"/><label>(6)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e181" xlink:type="simple"/></inline-formula> is the border between the two regimes, implicitly given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e182" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e183" xlink:type="simple"/><label>(7)</label></disp-formula>Note that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e184" xlink:type="simple"/></inline-formula> provided <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e185" xlink:type="simple"/></inline-formula>; under this condition approximation 6 holds around the transition <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e186" xlink:type="simple"/></inline-formula>. As both <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e187" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e188" xlink:type="simple"/></inline-formula> are linear functions of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e189" xlink:type="simple"/></inline-formula>, the second regime has the form of a Hill function with Hill coefficient <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e190" xlink:type="simple"/></inline-formula>. Therefore equation 6 shows that equation 5 behaves like a sharp threshold response. This threshold effect is responsible for the increased steepness of the response due to conditional auto-activation.</p>
<p>The maximal expression following from equation 5, at full activation, is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e191" xlink:type="simple"/></inline-formula>. This demonstrates that in the limit of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e192" xlink:type="simple"/></inline-formula> the maximum expression level becomes very low (for a given value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e193" xlink:type="simple"/></inline-formula>). On the other hand, if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e194" xlink:type="simple"/></inline-formula> is increased the term <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e195" xlink:type="simple"/></inline-formula> becomes more and more significant and the transition between the two regimes in equation 6 becomes more and more gradual. Consequently, in the optimized functions plotted in <xref ref-type="fig" rid="pcbi-1000813-g002">Fig. 2</xref> the values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e196" xlink:type="simple"/></inline-formula> reflect a compromise between the opposing requirements of having a high maximal expression (requiring a large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e197" xlink:type="simple"/></inline-formula>) and a sharp threshold response (requiring a small <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e198" xlink:type="simple"/></inline-formula>).</p>
<p>The steepness of a function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e199" xlink:type="simple"/></inline-formula> in the point <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e200" xlink:type="simple"/></inline-formula> can be formalized by the <italic>sensitivity</italic>, defined by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e201" xlink:type="simple"/></inline-formula>. The sensitivity of a Hill function is limited by the Hill coefficient <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e202" xlink:type="simple"/></inline-formula>, which is equal to the number of cooperatively interacting binding sites for the input TF. We therefore ask if a similar limitation applies to the minimal model of conditional auto-activation. From equation 5 the sensitivity function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e203" xlink:type="simple"/></inline-formula> can be derived straightforwardly. The result is rather cumbersome and therefore an exact expression for the <italic>maximal</italic> sensitivity is hard to obtain. However, since the most sensitive part of the function is in the region where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e204" xlink:type="simple"/></inline-formula> (<italic>i.e.</italic>, close to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e205" xlink:type="simple"/></inline-formula>), the maximal sensitivity can be approximated by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e206" xlink:type="simple"/></inline-formula>. In the limit of large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e207" xlink:type="simple"/></inline-formula> this expression converges to<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e208" xlink:type="simple"/><label>(8)</label></disp-formula>Importantly, since we evaluated the sensitivity in a point close to but not exactly at the maximum, this approximate result is a conservative estimate: the true maximum cannot be lower than this. In the limit of small <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e209" xlink:type="simple"/></inline-formula> the maximum sensitivity diverges as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e210" xlink:type="simple"/></inline-formula>, which proves that the sensitivity of response function 5 does not have a theoretical upper limit, unlike those of Hill functions.</p>
<p>So far we have neglected the dynamical properties of the designs because the current model only considers the steady-state response of the system. As we mentioned, auto-activation tends to slow down the response time of the system. Therefore, in systems where the speed of response is of great importance cooperative regulation is expected to outperform conditional auto-activation. Selection on response speed is discussed in more detail below.</p>
</sec><sec id="s3b">
<title>Auto-activation can sharpen repression</title>
<p>A second feedback pattern emerges in logic gates in which repression is important, notably the NAND, NOR and IN (inhibition) gates. As it turns out, whenever steep repression is required, we also find strong auto-activation; this occurred in every simulation run for our NAND, NOR and IN gates (20 repeats each), with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e211" xlink:type="simple"/></inline-formula> in all cases. We present the NAND gate as an example.</p>
<p><xref ref-type="fig" rid="pcbi-1000813-g003">Fig. 3A</xref> shows the <italic>cis</italic>-regulatory region of a typical NAND gate using auto-activation. The corresponding response function plotted in <xref ref-type="fig" rid="pcbi-1000813-g003">Fig. 3B</xref> indeed shows an excellent NAND-like behavior. As quantified below, in fact it performs better than the design without auto-activation reported earlier and reproduced for comparison in <xref ref-type="fig" rid="pcbi-1000813-g003">Fig. 3A and B</xref> <xref ref-type="bibr" rid="pcbi.1000813-Hermsen1">[15]</xref>.</p>
<fig id="pcbi-1000813-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000813.g003</object-id><label>Figure 3</label><caption>
<title>Sharp and complete repression using auto-activation.</title>
<p>In the simulations, auto-activation evolved in every gate that requires strong repression. This figure shows two examples in which auto-activation indeed aids sharp and thorough repression. Fig. A and B depict NAND gates resulting from the simulations. When auto-regulation is not allowed by the method, the input TFs have both activating and repressing binding sites, as reported earlier <xref ref-type="bibr" rid="pcbi.1000813-Hermsen1">[15]</xref> (in Fig. A and C, red boxes represent repressor sites and green boxes activator sites). When auto-regulation is included (<italic>i.e.</italic>, the regulated gene <italic>tf3</italic> codes for a transcription factor TF3 that can bind to its own <italic>cis</italic>-regulatory region) auto-activation emerges. Gene <italic>tf3</italic> is still repressed by a hetero-cooperative module consisting of binding sites for TF1 and TF2. At low concentrations of TF1 and TF2 the auto-activation counteracts the repression module; as a consequence, the response to the concentrations of TF1 and TF2 is very sharp and the fold-change <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e212" xlink:type="simple"/></inline-formula> high, as can be seen in Fig. B. In Fig. C and D we study the mechanism in a simpler model system. Fig. C shows the <italic>cis</italic>-regulatory regions of two slightly different repression systems. In both cases, a transcription factor TF1 represses a gene <italic>tf3</italic>, coding for a second transcription factor TF3, by binding cooperatively to a pair of repressor sites. In the second scenario, an auto-activation site for TF3 is present as well. Fig. D presents the steady-state expression level of <italic>tf3</italic> as a function of the repressor concentration. In both alternatives we optimized the binding sites using the fitness function described in the main text. Clearly, the second scenario leads to a more sensitive repression curve than the first. The presence of auto-activation allows for stronger repressor sites; consequently, as the concentration of TF1 increases the displacement of RNAP from the promoter by the repressor is more effective (<italic>i.e.</italic>, the remaining expression level at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e213" xlink:type="simple"/></inline-formula> is much lower than in the cooperative repression case).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.g003" xlink:type="simple"/></fig>
<p>The design that resulted when auto-activation was excluded is composed of a hetero-cooperative repression module (a tandem series of repressor sites to which both input TFs bind cooperatively). The function of this module is to repress transcription only when both TF1 and TF2 are present in sufficiently high concentrations, as required of a NAND gate. In Ref. <xref ref-type="bibr" rid="pcbi.1000813-Hermsen1">[15]</xref> we pointed out that in the simulation results such a repression module was always accompanied by strong <italic>activation</italic> sites for both input TFs. This counter-intuitive feature turned out to enhance the sharpness of the response. At low TF concentrations, the activation sites counter-act the repression module, so that the expression stays high. At higher TF concentrations, however, the repression module dominates and represses transcription. Under the parameters used designs of this type reached a modest fold-change of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e214" xlink:type="simple"/></inline-formula> and a deviation measure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e215" xlink:type="simple"/></inline-formula> (see section “Evolutionary algorithm” in the <xref ref-type="sec" rid="s2">methods</xref> section for the definition of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e216" xlink:type="simple"/></inline-formula>).</p>
<p>In the new results (<xref ref-type="fig" rid="pcbi-1000813-g003">Fig. 3</xref>) the activation sites for TF1 and TF2 have disappeared, but instead we find auto-activation. In the absence of TF1 and TF2, <italic>tf3</italic> is highly expressed, aided by auto-activation. As the concentrations of TF1 and TF2 are increased, the repression module starts to compete with the auto-activation module. Quite suddenly, the repression module wins this competition and displaces RNAP from the promoter. The strong, cooperative repression module now leads to a rather complete inhibition. The new design can lead to fold-changes of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e217" xlink:type="simple"/></inline-formula> and a deviation measure of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e218" xlink:type="simple"/></inline-formula>.</p>
<p>To study the mechanism responsible for the steepness of the response function we again analyzed a minimal model. In <xref ref-type="fig" rid="pcbi-1000813-g003">Fig. 3C and D</xref> two scenarios for an IN gate are compared. In the first scenario, a transcription factor TF1 cooperatively binds to a pair of repressor sites to inhibit the gene <italic>tf3</italic>. In the second scenario we use the same configuration, but add an activator site for TF3. Thus, auto-activation competes with cooperative repression. The fitness of each design is optimized using the fitness function for the IN gate. As can clearly be seen in <xref ref-type="fig" rid="pcbi-1000813-g003">Fig. 3D</xref> the second scenario, using conditional auto-activation, results in a steeper and more complete repression. <xref ref-type="fig" rid="pcbi-1000813-g001">Figure 1</xref> in <xref ref-type="supplementary-material" rid="pcbi.1000813.s001">Text S1</xref> shows plots of the sensitivity <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e219" xlink:type="simple"/></inline-formula> as a function of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e220" xlink:type="simple"/></inline-formula> for the response plots in <xref ref-type="fig" rid="pcbi-1000813-g003">Fig. 3D</xref> and clearly demonstrates that auto-activation enhances the sensitivity.</p>
<p>Does the sensitivity of the response function 9 have an upper bound, as is the case for Hill functions? To answer this question we again study the minimal model mathematically.</p>
<p>The response function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e221" xlink:type="simple"/></inline-formula> of the minimal model is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e222" xlink:type="simple"/><label>(9)</label></disp-formula>with<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e223" xlink:type="simple"/><label>(10)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e224" xlink:type="simple"/><label>(11)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e225" xlink:type="simple"/><label>(12)</label></disp-formula>We first describe the limit in which <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e226" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e227" xlink:type="simple"/></inline-formula>. The form of this equation is obviously similar to equation 5 for conditional auto-activation. However, here <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e228" xlink:type="simple"/></inline-formula> is large and <italic>negative</italic> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e229" xlink:type="simple"/></inline-formula>) when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e230" xlink:type="simple"/></inline-formula>. In this regime, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e231" xlink:type="simple"/></inline-formula>, so that the numerator is approximated by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e232" xlink:type="simple"/></inline-formula>. As <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e233" xlink:type="simple"/></inline-formula> increases, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e234" xlink:type="simple"/></inline-formula> decreases while the denominator increases; therefore the expression is rapidly repressed. This regime ends suddenly as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e235" xlink:type="simple"/></inline-formula> reaches zero, at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e236" xlink:type="simple"/></inline-formula>; at this point the expression is almost fully repressed.</p>
<p>The sensitivity function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e237" xlink:type="simple"/></inline-formula> can be derived from equation 9. The exact expression is again too cumbersome to derive the maximal sensitivity analytically. However, the most sensitive region of the response plot is again expected around <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e238" xlink:type="simple"/></inline-formula> so that we estimate the maximal sensitivity as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e239" xlink:type="simple"/><label>(13)</label></disp-formula>For large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e240" xlink:type="simple"/></inline-formula> this converges to<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e241" xlink:type="simple"/><label>(14)</label></disp-formula>which for large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e242" xlink:type="simple"/></inline-formula> approaches <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e243" xlink:type="simple"/></inline-formula>. Numerical tests demonstrate that this conservative approximation becomes excellent for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e244" xlink:type="simple"/></inline-formula> (data not shown). In the absence of auto-regulation, the sensitivity cannot exceed 2, the number of repressor sites. Equation 14 demonstrates that in the presence of auto-regulation the sensitivity can easily exceed 2 but is nevertheless limited given <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e245" xlink:type="simple"/></inline-formula>.</p>
<p>We note that the sensitivity is optimal for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e246" xlink:type="simple"/></inline-formula>. Hence, unlike the case of conditional auto-activation the requirements of a high maximal expression and a high sensitivity do not contradict. In the simulations as well as in reality, however, the promoter strength is bounded by other factors. Clearly the binding affinity of RNAP for the promoter is bounded by the physics of RNAP–DNA binding. A less obvious constraint follows from the fact that the expression switches from high to low around <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e247" xlink:type="simple"/></inline-formula>; if the repression is to occur at reasonable TF1 concentrations (the simulations impose the interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e248" xlink:type="simple"/></inline-formula>) high values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e249" xlink:type="simple"/></inline-formula> require low values of the dissociation constant <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e250" xlink:type="simple"/></inline-formula> (<italic>i.e.</italic>, strong repression). Finally, a high sensitivity in one point does not guarantee that the response function switches from high to low in a narrow interval as is required by the fitness function; this explains why in the plots in <xref ref-type="fig" rid="pcbi-1000813-g003">Fig. 3</xref> the maximal sensitivity is not optimal (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e251" xlink:type="simple"/></inline-formula>).</p>
</sec><sec id="s3c">
<title>Linear repression benefits from auto-activation</title>
<p>In both previous cases, auto-regulation was used to obtain the steep or switch-like behavior required to approximate the binary responses of logic gates. Indeed, sharp responses are observed and probably required in many real examples; nevertheless many genes respond in a more gradual manner to their input signals (Ref. <xref ref-type="bibr" rid="pcbi.1000813-Kaplan1">[17]</xref> provides examples of both sharp and gradual responses). Is auto-regulation also useful in cases where a gradual response is required? To test this, we now turn to the results of simulations with <italic>linear</italic> goal functions.</p>
<p>Indeed, simulation results for linear repression (<italic>i.e.</italic>, the LIN and NMEAN gates) always use auto-regulation, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e252" xlink:type="simple"/></inline-formula> in the range <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e253" xlink:type="simple"/></inline-formula>. As can be seen in <xref ref-type="fig" rid="pcbi-1000813-g004">Fig. 4</xref>, approximately linear repression can be obtained when repression is combined with auto-activation; the deviation measure for the simulation result shown is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e254" xlink:type="simple"/></inline-formula>. The same figure shows results of simulations in which auto-regulation is excluded. In that case a large cooperative repression module results, which leads to a less linear result (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e255" xlink:type="simple"/></inline-formula>).<xref ref-type="fig" rid="pcbi-1000813-g005"/></p>
<fig id="pcbi-1000813-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000813.g004</object-id><label>Figure 4</label><caption>
<title>Linear repression using auto-regulation.</title>
<p>If in the simulations we selected for a linearly decreasing response function (a LIN gate), auto-activation emerged. The resulting <italic>cis</italic>-regulatory region is schematically depicted in Fig. A. Red boxes and green boxes represent repressor and activator sites, respectively. The corresponding response function is plotted in Fig. B, alongside the results of a simulation in which auto-regulation is excluded. The auto-activation indeed manages to straighten the repression curve. The seven red dots in Fig. B show the goal function that is used in the fitness function: gates are considered better if their response function fits these points better (see <xref ref-type="sec" rid="s2">Methods</xref>). We again studied a simplified model in more detail; the <italic>cis</italic>-regulatory region and response function of this minimal model are also shown. Indeed, the simple model system with appropriate binding site affinities fits the goal points better than the design without auto-regulation.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.g004" xlink:type="simple"/></fig><fig id="pcbi-1000813-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000813.g005</object-id><label>Figure 5</label><caption>
<title>NAND gates at increasing selection pressure on response speed.</title>
<p>On the one hand, the sensitivity of the response function of a NAND gate is improved by auto-activation. On the other hand, the response speed of the gate is enhanced by auto-repression. Consequently, if selection acts both on the response function and the response time, the simulation results are a compromise and depend critically on the relative magnitudes of the two selection pressures. The figure shows representative response functions and promoter designs of NAND gates resulting from four values of the parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e256" xlink:type="simple"/></inline-formula>, which controls the weight of the response speed in the total fitness function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e257" xlink:type="simple"/></inline-formula>. (The irrelevant constant <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e258" xlink:type="simple"/></inline-formula> merely serves to ensure that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e259" xlink:type="simple"/></inline-formula>.) The average values of the measures <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e260" xlink:type="simple"/></inline-formula> (measuring the response time in arbitrary units <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e261" xlink:type="simple"/></inline-formula>) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e262" xlink:type="simple"/></inline-formula> (the deviation of the response function from the goal function in units <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e263" xlink:type="simple"/></inline-formula>) for each condition are also plotted. By definition, low values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e264" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e265" xlink:type="simple"/></inline-formula> correspond to <italic>good</italic> performance. For the lowest value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e266" xlink:type="simple"/></inline-formula> the response function is optimized and shows an excellent NAND gate. Due to strong, cooperative auto-regulation, the response is very sharp and almost bistable in the transition region, but the response speed is low. At <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e267" xlink:type="simple"/></inline-formula> the result is a compromise: the quality of the response function is clearly reduced but the response speed is higher. Still auto-activation evolves, but it is weaker and non-cooperative and combined with weak auto-repressing binding sites. At <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e268" xlink:type="simple"/></inline-formula> auto-repression fully takes over; the response function is crippled but the response speed is high. If the selection pressure on response time is increased even further (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e269" xlink:type="simple"/></inline-formula>) the response speed is fully optimized by disabling the response altogether.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.g005" xlink:type="simple"/></fig>
<p>Again, we analyzed the mechanism through a slightly simplified model presented in the same figure. The promoter design of the simplified model is identical to the one presented in <xref ref-type="fig" rid="pcbi-1000813-g003">Fig. 3C</xref>, where it was used to demonstrate how auto-activation can provide sharp responses. In essence, the difference between the two cases is that in the IN gate the two repressor sites have the same affinity, whereas in the LIN case they do not: one of them is many times weaker than the other (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e270" xlink:type="simple"/></inline-formula> vs. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e271" xlink:type="simple"/></inline-formula>. As a result, the repression is introduced gradually as the repressor concentration increases.</p>
<p>Linear repression requires that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e272" xlink:type="simple"/></inline-formula> in the domain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e273" xlink:type="simple"/></inline-formula>. Since <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e274" xlink:type="simple"/></inline-formula> is defined as the solution of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e275" xlink:type="simple"/></inline-formula>, we can take the total derivative of this relation to arrive at<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e276" xlink:type="simple"/><label>(15)</label></disp-formula>In the absence of auto-regulation the denominator equals 1. In this case <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e277" xlink:type="simple"/></inline-formula> is a Hill-type function of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e278" xlink:type="simple"/></inline-formula> and therefore its derivative is not constant. In the presence of auto-regulation the denominator can be used to correct some of the variation in the numerator. (See <xref ref-type="supplementary-material" rid="pcbi.1000813.s001">Text S1</xref>.)</p>
<p>In contrast, in the simulation results for linear <italic>activation</italic> (both the LACT and the MEAN gates) auto-regulation is never used. To test if these results are an artifact of the algorithm, we studied a series of models (see <xref ref-type="supplementary-material" rid="pcbi.1000813.s001">Text S1</xref>). Each model is a possible layout of transcription factor binding sites and includes auto-regulatory sites. For each of the models, we optimized the affinities of all binding sites with respect to the fitness score, using a standard Nelder–Mead optimization routine. Consistent with our simulations, in the solutions for all models the affinities of the auto-regulatory sites vanished. Even though the list of models tested is not exhaustive, this suggests that auto-regulation is not helpful in constructing LACT or MEAN gates.</p>
<p>To illustrate an important difference between linear activation and linear repression we provide the following general argument. Suppose that an accurate LACT gate can be constructed using auto-regulation. By definition the response function should then be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e279" xlink:type="simple"/></inline-formula> in the interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e280" xlink:type="simple"/></inline-formula>. Consequently, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e281" xlink:type="simple"/></inline-formula> in this interval. Interestingly, this shows that if all TF3 binding sites in the <italic>cis</italic>-regulatory region are replaced by binding sites for TF1—resulting in a gate without auto-regulation—<italic>the exact same response function should be obtained</italic>. Even though this argument does not prove that auto-regulation cannot be used to construct LACT gates, it does show that if a high-quality LACT can be constructed with auto-regulation a similar response can always be obtained without it as well. This is in stark contrast with the linear repression case, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e282" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s3d">
<title>Selection for quick responses or against noise leads to auto-repression</title>
<p>Surprisingly, auto-repression does not show up in any of the simulations described so far, whereas auto-activation features regularly. As we mentioned in the introduction, previous studies have shown that negative auto-regulation can be used to diminish intrinsic noise and to speed up response times. In the simulations presented so far, such qualities were not rewarded. Therefore we asked if auto-repression would emerge if we did select for such dynamic properties on top of our usual selection criteria.</p>
<p>First, we used a heuristic measure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e283" xlink:type="simple"/></inline-formula> (where RT stands for Response Time) to select for a quick response to changes in the input parameters; it was computed as follows. For 16 combinations of input concentrations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e284" xlink:type="simple"/></inline-formula> (corresponding to the red dots in <xref ref-type="fig" rid="pcbi-1000813-g002">Fig. 2</xref>) we numerically solved the differential equation 4 with two different initial conditions: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e285" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e286" xlink:type="simple"/></inline-formula>. The solutions were used to measure the time it took for the system to approach the steady-state value up to a small distance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e287" xlink:type="simple"/></inline-formula>. The measure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e288" xlink:type="simple"/></inline-formula> was defined as the sum of all 32 response times. The total fitness function, combining selection on the response function with selection on the response time, was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e289" xlink:type="simple"/></inline-formula>, where the factor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e290" xlink:type="simple"/></inline-formula> was used to tune the relative strength of the selection on the response time. Again, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e291" xlink:type="simple"/></inline-formula> is an irrelevant constant ensuring that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e292" xlink:type="simple"/></inline-formula>.</p>
<p>In fact, the initial condition of the simulations, in which the gate is completely dysfunctional, is a local optimum of this fitness score. This is because initially the steady-state expression level is negligible so that the response time for initial condition <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e293" xlink:type="simple"/></inline-formula> is practically zero. Even though mutations that increase the constitutive promoter activity improve both the response function and the response time for initial condition <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e294" xlink:type="simple"/></inline-formula>, the concomitant increase in the response time for initial condition <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e295" xlink:type="simple"/></inline-formula> dominates. To ensure that the simulation was not trapped in this local optimum <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e296" xlink:type="simple"/></inline-formula> was increased slowly from 0 to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e297" xlink:type="simple"/></inline-formula> in the course of the simulations, according to:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e298" xlink:type="simple"/><label>(16)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e299" xlink:type="simple"/></inline-formula> is the simulation time (<italic>i.e.</italic>, the cycle number of the evolutionary algorithm), and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e300" xlink:type="simple"/></inline-formula>.</p>
<p>Second, we selected against intrinsic noise, <italic>i.e.</italic>, fluctuations in the concentration of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e301" xlink:type="simple"/></inline-formula> due to the stochasticity of the processes involved in the production and degradation of TF3. This type of noise should be contrasted with extrinsic noise, which here is understood to be the noise due to fluctuations in the input concentrations <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e302" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e303" xlink:type="simple"/></inline-formula> or due to changes in RNAP concentrations <xref ref-type="bibr" rid="pcbi.1000813-Hornung1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1000813-Swain1">[27]</xref>. Even though extrinsic noise is generally important too <xref ref-type="bibr" rid="pcbi.1000813-Elowitz2">[28]</xref>, the treatment of extrinsic fluctuations involves subtleties that are beyond the scope of this work, such as the question which changes in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e304" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e305" xlink:type="simple"/></inline-formula> should be considered changes in the input signal and which should be considered noise. We therefore only consider intrinsic noise.</p>
<p>In order to treat intrinsic fluctuations in a tractable manner we now replaced the ordinary differential equation 4 by the following stochastic differential equation:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e306" xlink:type="simple"/><label>(17)</label></disp-formula>The term <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e307" xlink:type="simple"/></inline-formula> represents Gaussian white noise and is characterized by (see <xref ref-type="supplementary-material" rid="pcbi.1000813.s001">Text S1</xref>):<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e308" xlink:type="simple"/><label>(18)</label></disp-formula>The first term on the right-hand side describes the noise in the production of TF3 while the second term describes the stochasticity in the degradation of TF3. Both terms depend explicitly on the volume <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e309" xlink:type="simple"/></inline-formula> because, at constant concentration, the copy number of TF3 scales with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e310" xlink:type="simple"/></inline-formula> which affects the variance in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e311" xlink:type="simple"/></inline-formula>.</p>
<p>In <xref ref-type="supplementary-material" rid="pcbi.1000813.s001">Text S1</xref> we show that the standard deviation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e312" xlink:type="simple"/></inline-formula> of the concentration <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e313" xlink:type="simple"/></inline-formula> can be approximated as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e314" xlink:type="simple"/><label>(19)</label></disp-formula>with<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e315" xlink:type="simple"/><label>(20)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e316" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e317" xlink:type="simple"/></inline-formula> are the first and second partial derivatives of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e318" xlink:type="simple"/></inline-formula> with respect to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e319" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e320" xlink:type="simple"/></inline-formula> is the steady-state solution of the deterministic equation 4. We computed the right-hand side of equation 19 numerically for 16 input values <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e321" xlink:type="simple"/></inline-formula> (again, corresponding to the red dots in <xref ref-type="fig" rid="pcbi-1000813-g002">Fig. 2</xref>) and treated the sum of the results as an additional fitness measure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e322" xlink:type="simple"/></inline-formula> (where N stands for Noise). The strength of selection against noise was again increased gradually during the simulations (analogous to equation 16). The total fitness function thus became <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e323" xlink:type="simple"/></inline-formula>.</p>
<p>We performed simulations with several values for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e324" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e325" xlink:type="simple"/></inline-formula>: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e326" xlink:type="simple"/></inline-formula> (where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e327" xlink:type="simple"/></inline-formula> is the arbitrary unit of time, see <xref ref-type="sec" rid="s2">Methods</xref>), and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e328" xlink:type="simple"/></inline-formula>. Indeed, in these simulations auto-repression emerged.</p>
<p>In activating gates (ACT, AND, OR) auto-repression resulted in all simulation runs with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e329" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e330" xlink:type="simple"/></inline-formula>. The auto-repression was invariably strong, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e331" xlink:type="simple"/></inline-formula>, and mediated by multiple cooperative binding sites. If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e332" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e333" xlink:type="simple"/></inline-formula> were further increased eventually the resulting <italic>cis</italic>-regulatory regions became completely dysfunctional; this can be understood from the fact that both the response time and the noise reduction can be optimized by abolishing expression altogether. Figure 7 in <xref ref-type="supplementary-material" rid="pcbi.1000813.s001">Text S1</xref> demonstrates how the properties of resulting OR gates changed as a function of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e334" xlink:type="simple"/></inline-formula>. As <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e335" xlink:type="simple"/></inline-formula> is increased the deviation of the response from the ideal OR gate, measured by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e336" xlink:type="simple"/></inline-formula>, increases, while the noise, measured by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e337" xlink:type="simple"/></inline-formula>, decreases.</p>
<p>As we explained, the response functions of the NAND, NOR and IN gates benefit from auto-activation; in those gates auto-activation occurred unless the selection pressure on the dynamical properties dominated (<italic>i.e.</italic>, if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e338" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e339" xlink:type="simple"/></inline-formula> were large), in which case the quality of the response functions was negatively affected. <xref ref-type="fig" rid="pcbi-1000813-g004">Fig. 4</xref> shows results from simulations selecting for NAND gates at various values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e340" xlink:type="simple"/></inline-formula>. As the selection pressure on response time was increased the response functions became more and more compromised. Auto-activation resulted for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e341" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e342" xlink:type="simple"/></inline-formula>; in the former case the promoter designs were of the type shown in <xref ref-type="fig" rid="pcbi-1000813-g003">Fig. 3A</xref>, while in the latter case only one auto-activation site remained. Interestingly, in most of the simulation runs (18 out of 20) at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e343" xlink:type="simple"/></inline-formula> a weak auto-repression site shows up in conjunction with the auto-activation site. These weak auto-repression sites are incorporated in the hetero-cooperative repression module and have a high occupancy only at high concentrations of TF1 and TF2; analogous to conditional auto-activation, this effect could be called conditional auto-repression. At <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e344" xlink:type="simple"/></inline-formula> the auto-activation was replaced by strong auto-repression mediated by a single or multiple binding sites and the sites for the input TFs were very weak. Finally, at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e345" xlink:type="simple"/></inline-formula> the resulting gates became completely dysfunctional and no significant binding sites remained.</p>
</sec><sec id="s3e">
<title>Auto-activating TFs have more inputs</title>
<p>The results above suggest that auto-activation and auto-repression have very different functions. We therefore wondered whether in the known transcription regulatory network of <italic>E. coli</italic> the auto-activators and auto-repressors have different statistical properties.</p>
<p>Surprisingly, we found that auto-activators are more often regulated by other TFs than auto-repressors. According to the data in RegulonDB <xref ref-type="bibr" rid="pcbi.1000813-Salgado1">[2]</xref>, 18 of the 25 auto-activating TFs in <italic>E. coli</italic> are regulated by at least one additional TF (72%) versus 30 out of 62 auto-repressing TFs (48%); this indeed suggests that auto-activators are more likely to have additional inputs (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e346" xlink:type="simple"/></inline-formula>). The difference becomes more convincing if we look at the total number of inputs for the two sets. The 25 auto-activators have, in total, 52 inputs (<italic>i.e.</italic>, an in-degree of 2.08 on average; the auto-regulation is not counted as an input) while the 62 auto-repressors have 50 inputs in total (0.81 on average). Evidently, auto-activators have significantly more inputs than auto-repressors (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e347" xlink:type="simple"/></inline-formula>).</p>
<p>Since auto-regulation can potentially have many functions and most of the auto-regulators are poorly characterized, we can only speculate about the origin of this difference. One possible explanation would be the following. If a common function of auto-activation is to shape response functions, as suggested by our analysis, then auto-activation should evolve preferentially for TFs that are regulated by one or more input TFs. In that case one would expect the average in-degree for auto-activators to be high. The same argument does not hold for auto-repression: our results suggest that auto-repression typically evolves for different reasons. Some of the functions of auto-repression suggested in the literature, such as its tendency to decrease intrinsic noise and to mitigate the effect of changes in the bacterial growth rates on gene expression, do not require additional input TFs. It is therefore not too surprising that for many auto-repressors (32 out of the 62) no input TF is known.</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<p>Our results shed new light on the use of auto-regulation. We described three situations in which auto-activation can be used to improve the response function of promoters. First, if auto-activation is conditional on the presence of other TFs, it can give rise to sensitive responses that otherwise require multiple cooperative binding sites of the input TF. Presumably, not all input TFs can bind cooperatively to multiple binding sites; in those cases conditional auto-activation can serve as an alternative. Secondly, auto-activation can strongly contribute to the sensitivity of the response of repression systems. Whenever sharp repression is required, auto-activation can have a selective advantage. Thirdly, we showed that auto-activation is also useful if a linearly decreasing response function is desired. Together, such mechanisms may help explain the large number of auto-activators present in <italic>E. coli</italic>.</p>
<p>Auto-repression never appeared in the simulation results if selection was based on the response function of the gates only. Most likely, the limited use of auto-repression in shaping response functions is due to its general tendency to decrease the fold-change and sensitivity of the response. A low fold-change or sensitivity can typically also be achieved without auto-repression by tuning both the promoter strength and the affinities of the TF binding sites. Nevertheless, we cannot exclude the possibility that auto-repression would show up in simulations selecting for response functions different from the ones presented here.</p>
<p>If the fitness function was altered to favor a fast response or suppression of intrinsic transcriptional noise, auto-repression did emerge. It has been suggested before that the function of negative auto-regulation is to regulate such dynamic properties <xref ref-type="bibr" rid="pcbi.1000813-Becskei1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1000813-Savageau1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1000813-Rosenfeld1">[10]</xref>; our results support this view.</p>
<p>In retrospect, the emergence of auto-regulation is hardly surprising. The evolution of <italic>cis</italic>-regulatory regions can be perceived as adaptive curve fitting. Allowing for auto-regulation gives gene-regulatory systems additional degrees of freedom to optimize their performance, and it would perhaps be more surprising if this freedom were not exploited. We therefore expect that the conclusions based on the idealized gates studied in this work are also relevant for real biological systems requiring more complex response functions.</p>
<p>We have seen that in some cases the advantage of using auto-regulation is large (<italic>e.g.</italic> when sensitive repression is required) whereas in other cases there is only a small difference between the quality of the response function for designs with or without auto-regulation. This leads one to wonder whether in the latter case natural selection on the shape of the response would be large enough to evolve and maintain auto-regulation, in particular in the presence of noise. This is largely an open question; yet, the fact that some <italic>E. coli</italic> promoters contain a large number of TF binding sites many of which contribute only marginally to the expression (see for instance <xref ref-type="bibr" rid="pcbi.1000813-Maeda1">[29]</xref>) suggests that, at least in some <italic>cis</italic>-regulatory regions, natural selection is strong enough to fine-tune the response function in great detail.</p>
<p>The results presented are quite insensitive to the parameter values chosen. The value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e348" xlink:type="simple"/></inline-formula> influences important properties such as the maximum fold change in activation systems, but as long as it is chosen within the biological range 10–100 the designs of the gates do not seem to depend qualitatively on the value chosen. To verify this, we performed simulations with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e349" xlink:type="simple"/></inline-formula> for AND, NAND, NOR and OR gates (without selection against noise or response speed) and found the results to be qualitatively the same as those presented. The value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e350" xlink:type="simple"/></inline-formula> influences the spacing of binding sites within a module, but not the basic designs properties, as long as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e351" xlink:type="simple"/></inline-formula> so that overlapping modules can be constructed that bind independently. The results are also insensitive to the length of the binding sites <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e352" xlink:type="simple"/></inline-formula> (we tested this with simulations for AND, NAND, NOR and OR gates with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e353" xlink:type="simple"/></inline-formula>) and the matrix elements of the binding energy matrix; essential is only that the evolutionary algorithm can tune the dissociation constants of the binding sites to a wide range of values (1–10000nM), as in reality. The length of the <italic>cis</italic>-regulatory region, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e354" xlink:type="simple"/></inline-formula>, determines the maximum number of tandem binding sites that fit on the regulatory region; larger values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e355" xlink:type="simple"/></inline-formula> therefore ultimately lead to larger tandem arrays. However, since tandem arrays of five or more binding sites can form in the simulations, we believe that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000813.e356" xlink:type="simple"/></inline-formula> is large enough to accommodate typical <italic>E. coli</italic> promoters.</p>
<p>Even though in eukaryotes the mechanisms of gene regulation are generally different and various additional layers of regulation exist, recent work has shown that many basic principles of prokaryotic gene regulation—in particular the interplay between cooperative binding and competitive inhibition—are equally important in eukaryotes (see for instance <xref ref-type="bibr" rid="pcbi.1000813-Ratna1">[30]</xref> about repression and inhibition in yeast and <xref ref-type="bibr" rid="pcbi.1000813-Zinzen1">[31]</xref> about enhancers in <italic>Drosophila</italic>). Auto-regulation is also widespread in eukaryotes <xref ref-type="bibr" rid="pcbi.1000813-Freeman1">[32]</xref>; therefore, our findings could also be relevant for gene regulation in eukaryotes.</p>
<p>As we mentioned, auto-activation is known to reduce the response speed in some situations and to increase the amplitude of fluctuations. Clearly, those issues may be problematic in some real-life situations. On the other hand, a slow response can be a positive feature as well if it is applied as a filter of high-frequency noise (a low-pass filter). Fluctuations may in some cases be beneficial or even necessary. For instance, when cells respond to a fluctuating environment via the strategy of stochastic switching, fluctuations are essential <xref ref-type="bibr" rid="pcbi.1000813-Kussell1">[33]</xref>. But even when cells cope with a fluctuating environment via the strategy of deterministic switching, fluctuations may be beneficial, since they can increase the population's growth rate when the response function is suboptimal <xref ref-type="bibr" rid="pcbi.1000813-TanaseNicola1">[34]</xref>. Indeed, the fact that auto-activation is found so often in <italic>E. coli</italic> demonstrates that the associated reduction of the response speed and the amplification of fluctuations can apparently be circumvented, tolerated or put to use.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000813.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000813.s001" xlink:type="simple"><label>Text S1</label><caption>
<p>Supplementary information. All supplementary information is contained in this document. It contains supplementary figures, detailed mathematical derivations, additional analyses, and numerical tests of approximations used in the main text.</p>
<p>(0.81 MB PDF)</p>
</caption></supplementary-material></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pcbi.1000813-Keseler1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Keseler</surname><given-names>IM</given-names></name>
<name name-style="western"><surname>Collado-Vides</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Gama-Castro</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Ingraham</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Paley</surname><given-names>S</given-names></name>
<etal/></person-group>             <year>2005</year>             <article-title>Ecocyc: a comprehensive database resource for <italic>Escherichia coli</italic>.</article-title>             <source>Nucl Acids Res</source>             <volume>33</volume>             <fpage>D334</fpage>             <lpage>337</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Salgado1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Salgado</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Santos-Zavaleta</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Gama-Castro</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Millan-Zarate</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Diaz-Peredo</surname><given-names>E</given-names></name>
<etal/></person-group>             <year>2001</year>             <article-title>RegulonDB (version 3.2): transcriptional regulation and operon organization in <italic>Escherichia coli</italic> k-12.</article-title>             <source>Nucl Acids Res</source>             <volume>29</volume>             <fpage>72</fpage>             <lpage>74</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Thieffry1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Thieffry</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Huerta</surname><given-names>AM</given-names></name>
<name name-style="western"><surname>Perez-Rueda</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Collado-Vides</surname><given-names>J</given-names></name>
</person-group>             <year>1998</year>             <article-title>From specific gene regulation to genomic networks: a global analysis of transcriptional regulation in <italic>Escherichia coli</italic>.</article-title>             <source>Bioessays</source>             <volume>20</volume>             <fpage>433</fpage>             <lpage>440</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-ShenOrr1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Shen-Orr</surname><given-names>SS</given-names></name>
<name name-style="western"><surname>Milo</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Mangan</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Alon</surname><given-names>U</given-names></name>
</person-group>             <year>2002</year>             <article-title>Network motifs in the transcriptional regulation network of <italic>Escherichia coli</italic>.</article-title>             <source>Nat Genet</source>             <volume>31</volume>             <fpage>64</fpage>             <lpage>68</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Becskei1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Becskei</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Serrano</surname><given-names>L</given-names></name>
</person-group>             <year>2000</year>             <article-title>Engineering stability in gene networks by autoregulation.</article-title>             <source>Nature</source>             <volume>405</volume>             <fpage>590</fpage>             <lpage>593</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Thattai1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Thattai</surname><given-names>M</given-names></name>
<name name-style="western"><surname>van Oudenaarden</surname><given-names>A</given-names></name>
</person-group>             <year>2001</year>             <article-title>Intrinsic noise in gene regulatory networks.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>98</volume>             <fpage>8614</fpage>             <lpage>9</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Stekel1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Stekel</surname><given-names>DJ</given-names></name>
<name name-style="western"><surname>Jenkins</surname><given-names>DJ</given-names></name>
</person-group>             <year>2008</year>             <article-title>Strong negative self regulation of prokaryotic transcription factors increases the intrinsic noise of protein expression.</article-title>             <source>BMC Syst Biol</source>             <volume>2</volume>             <fpage>6</fpage>          </element-citation></ref>
<ref id="pcbi.1000813-Klumpp1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Klumpp</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Zhang</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name>
</person-group>             <year>2009</year>             <article-title>Growth rate dependent global effects on gene expression in bacteria (in press).</article-title>             <source>Cell</source>          </element-citation></ref>
<ref id="pcbi.1000813-Savageau1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Savageau</surname><given-names>MA</given-names></name>
</person-group>             <year>1974</year>             <article-title>Comparison of classical and autogenous systems of regulation in inducible operons.</article-title>             <source>Nature</source>             <volume>252</volume>             <fpage>546</fpage>             <lpage>549</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Rosenfeld1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rosenfeld</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Elowitz</surname><given-names>MB</given-names></name>
<name name-style="western"><surname>Alon</surname><given-names>U</given-names></name>
</person-group>             <year>2002</year>             <article-title>Negative autoregulation speeds the response times of transcription networks.</article-title>             <source>J Mol Biol</source>             <volume>323</volume>             <fpage>785</fpage>             <lpage>793</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Elowitz1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Elowitz</surname><given-names>MB</given-names></name>
<name name-style="western"><surname>Leibler</surname><given-names>S</given-names></name>
</person-group>             <year>2000</year>             <article-title>A synthetic oscillatory network of transcriptional regulators.</article-title>             <source>Nature</source>             <volume>403</volume>             <fpage>335</fpage>             <lpage>338</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Hornung1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hornung</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Barkai</surname><given-names>N</given-names></name>
</person-group>             <year>2008</year>             <article-title>Noise propagation and signaling sensitivity in biological networks: A role for positive feedback.</article-title>             <source>PLoS Computational Biology</source>             <volume>4</volume>             <fpage>e8</fpage>          </element-citation></ref>
<ref id="pcbi.1000813-Nevozhay1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Nevozhay</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Adams</surname><given-names>RM</given-names></name>
<name name-style="western"><surname>Murphy</surname><given-names>KF</given-names></name>
<name name-style="western"><surname>Josic</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Balázsi</surname><given-names>G</given-names></name>
</person-group>             <year>2009</year>             <article-title>Negative autoregulation linearizes the dose-response and suppresses the heterogeneity of gene expression.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>106</volume>             <fpage>5123</fpage>             <lpage>8</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Becskei2"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Becskei</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Séraphin</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Serrano</surname><given-names>L</given-names></name>
</person-group>             <year>2001</year>             <article-title>Positive feedback in eukaryotic gene networks: cell differentiation by graded to binary response conversion.</article-title>             <source>EMBO J</source>             <volume>20</volume>             <fpage>2528</fpage>             <lpage>35</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Hermsen1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hermsen</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Tans</surname><given-names>S</given-names></name>
<name name-style="western"><surname>ten Wolde</surname><given-names>PR</given-names></name>
</person-group>             <year>2006</year>             <article-title>Transcriptional regulation by competing transcription factor modules.</article-title>             <source>PLoS Computational Biology</source>             <volume>2</volume>             <fpage>e164</fpage>          </element-citation></ref>
<ref id="pcbi.1000813-Buchler1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Buchler</surname><given-names>NE</given-names></name>
<name name-style="western"><surname>Gerland</surname><given-names>U</given-names></name>
<name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name>
</person-group>             <year>2003</year>             <article-title>On schemes of combinatorial transcription logic.</article-title>             <source>Proc Natl Acad Sci USA</source>             <volume>100</volume>             <fpage>5136</fpage>             <lpage>5141</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Kaplan1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kaplan</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Bren</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Zaslaver</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Dekel</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Alon</surname><given-names>U</given-names></name>
</person-group>             <year>2008</year>             <article-title>Diverse two-dimensional input functions control bacterial sugar genes.</article-title>             <source>Mol Cell</source>             <volume>29</volume>             <fpage>786</fpage>             <lpage>792</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-ColladoVides1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Collado-Vides</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Magasanik</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Gralla</surname><given-names>JD</given-names></name>
</person-group>             <year>1991</year>             <article-title>Control site location and transcriptional regulation in <italic>Escherichia coli</italic>.</article-title>             <source>Microbiol Rev</source>             <volume>55</volume>             <fpage>371</fpage>             <lpage>394</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-MandelGutfreund1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mandel-Gutfreund</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Margalit</surname><given-names>H</given-names></name>
</person-group>             <year>1998</year>             <article-title>Quantitative parameters for amino acid-base interactions: implications for prediction of protein-DNA binding sites.</article-title>             <source>Nucl Acids Res</source>             <volume>26(10)</volume>             <fpage>2306</fpage>             <lpage>2312</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Shea1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Shea</surname><given-names>MA</given-names></name>
<name name-style="western"><surname>Ackers</surname><given-names>GK</given-names></name>
</person-group>             <year>1985</year>             <article-title>The <italic>o<sub>r</sub></italic> control system of bacteriophage lambda. a physical-chemical model for gene regulation.</article-title>             <source>J Mol Biol</source>             <volume>181</volume>             <fpage>211</fpage>             <lpage>230</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Lisser1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lisser</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Margalit</surname><given-names>H</given-names></name>
</person-group>             <year>1993</year>             <article-title>Compilation of <italic>E.coli</italic> mRNA promoter sequences.</article-title>             <source>Nucl Acids Res</source>             <volume>21(7)</volume>             <fpage>1507</fpage>             <lpage>1516</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Berg1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Berg</surname><given-names>OG</given-names></name>
<name name-style="western"><surname>von Hippel</surname><given-names>PH</given-names></name>
</person-group>             <year>1987</year>             <article-title>Selection of DNA binding sites by regulatory proteins. Statistical-mechanical theory and application to operators and promoters.</article-title>             <source>J Mol Biol</source>             <volume>193</volume>             <fpage>723</fpage>             <lpage>750</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Berg2"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Berg</surname><given-names>OG</given-names></name>
<name name-style="western"><surname>von Hippel</surname><given-names>PH</given-names></name>
</person-group>             <year>1988</year>             <article-title>Selection of DNA binding sites by regulatory proteins ii. The binding specificity of cyclic AMP receptor protein to recognition sites.</article-title>             <source>J Mol Biol</source>             <volume>200</volume>             <fpage>709</fpage>             <lpage>723</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Berg3"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Berg</surname><given-names>OG</given-names></name>
</person-group>             <year>1988</year>             <article-title>Selection of DNA binding sites by regulatory proteins. Functional specificity and pseudosite competition.</article-title>             <source>J Biomol Struc &amp; Dynam</source>             <volume>6(2)</volume>             <fpage>275</fpage>             <lpage>297</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Ptashne1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ptashne</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Gann</surname><given-names>A</given-names></name>
</person-group>             <year>1997</year>             <article-title>Transcriptional activation by recruitment.</article-title>             <source>Nature</source>             <volume>386</volume>             <fpage>569</fpage>             <lpage>577</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Bintu1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bintu</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Buchler</surname><given-names>NE</given-names></name>
<name name-style="western"><surname>Garcia</surname><given-names>HG</given-names></name>
<name name-style="western"><surname>Gerland</surname><given-names>U</given-names></name>
<name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name>
<etal/></person-group>             <year>2005</year>             <article-title>Transcription regulation by the numbers 1: Models.</article-title>             <source>Curr Opin Gen &amp; Dev</source>             <volume>15</volume>             <fpage>116</fpage>             <lpage>124</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Swain1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Swain</surname><given-names>PS</given-names></name>
<name name-style="western"><surname>Elowitz</surname><given-names>MB</given-names></name>
<name name-style="western"><surname>Siggia</surname><given-names>ED</given-names></name>
</person-group>             <year>2002</year>             <article-title>Intrinsic and extrinsic contributions to stochasticity in gene expression.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>99</volume>             <fpage>12795</fpage>             <lpage>800</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Elowitz2"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Elowitz</surname><given-names>MB</given-names></name>
<name name-style="western"><surname>Levine</surname><given-names>AJ</given-names></name>
<name name-style="western"><surname>Siggia</surname><given-names>ED</given-names></name>
<name name-style="western"><surname>Swain</surname><given-names>PS</given-names></name>
</person-group>             <year>2002</year>             <article-title>Stochastic gene expression in a single cell.</article-title>             <source>Science</source>             <volume>297</volume>             <fpage>1183</fpage>             <lpage>6</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Maeda1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Maeda</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Mizuno</surname><given-names>T</given-names></name>
</person-group>             <year>1990</year>             <article-title>Evidence for multiple ompr-binding sites in the upstream activation sequence of the ompc promoter in escherichia coli: a single ompr-binding site is capable of activating the promoter.</article-title>             <source>J Bacteriol</source>             <volume>172</volume>             <fpage>501</fpage>             <lpage>3</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Ratna1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ratna</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Scherrer</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Fleischli</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Becskei</surname><given-names>A</given-names></name>
</person-group>             <year>2009</year>             <article-title>Synergy of repression and silencing gradients along the chromosome.</article-title>             <source>J Mol Biol</source>             <volume>387</volume>             <fpage>826</fpage>             <lpage>39</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Zinzen1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Zinzen</surname><given-names>RP</given-names></name>
<name name-style="western"><surname>Senger</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Levine</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Papatsenko</surname><given-names>D</given-names></name>
</person-group>             <year>2006 Jul 11</year>             <article-title>Computational models for neurogenic gene expression in the drosophila embryo.</article-title>             <source>Curr Biol</source>             <volume>16</volume>             <fpage>1358</fpage>             <lpage>1365</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Freeman1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Freeman</surname><given-names>M</given-names></name>
</person-group>             <year>2000</year>             <article-title>Feedback control of intercellular signalling in development.</article-title>             <source>Nature</source>             <volume>408</volume>             <fpage>313</fpage>             <lpage>9</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-Kussell1"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kussell</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Leibler</surname><given-names>S</given-names></name>
</person-group>             <year>2005</year>             <article-title>Phenotypic diversity, population growth, and information in fluctuating environments.</article-title>             <source>Science</source>             <volume>309</volume>             <fpage>2075</fpage>             <lpage>2078</lpage>          </element-citation></ref>
<ref id="pcbi.1000813-TanaseNicola1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tanase-Nicola</surname><given-names>S</given-names></name>
<name name-style="western"><surname>ten Wolde</surname><given-names>PR</given-names></name>
</person-group>             <year>2008</year>             <article-title>Regulatory control and the costs and benefits of biochemical noise.</article-title>             <source>PLoS Comput Biol</source>             <volume>4</volume>             <fpage>e1000125</fpage>          </element-citation></ref>
</ref-list>

</back>
</article>