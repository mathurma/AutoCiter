<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005786</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-01327</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular structures and organelles</subject><subj-group><subject>Cell membranes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Protein sequencing</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Protein sequencing</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular structures and organelles</subject><subj-group><subject>Cell membranes</subject><subj-group><subject>Membrane proteins</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Post-translational modification</subject><subj-group><subject>Signal peptides</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Science policy</subject><subj-group><subject>Science and technology workforce</subject><subj-group><subject>Careers in research</subject><subj-group><subject>Engineers</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>People and places</subject><subj-group><subject>Population groupings</subject><subj-group><subject>Professions</subject><subj-group><subject>Engineers</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical models</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Condensed matter physics</subject><subj-group><subject>Solid state physics</subject><subj-group><subject>Crystallography</subject><subj-group><subject>Crystal structure</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular structures and organelles</subject><subj-group><subject>Cell membranes</subject><subj-group><subject>Membrane proteins</subject><subj-group><subject>Integral membrane proteins</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Machine learning to design integral membrane channelrhodopsins for efficient eukaryotic expression and plasma membrane localization</article-title>
<alt-title alt-title-type="running-head">Machine learning to design membrane protein localization</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Bedbrook</surname>
<given-names>Claire N.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Yang</surname>
<given-names>Kevin K.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Rice</surname>
<given-names>Austin J.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Gradinaru</surname>
<given-names>Viviana</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Arnold</surname>
<given-names>Frances H.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Division of Biology and Biological Engineering; California Institute of Technology; Pasadena, California; United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Division of Chemistry and Chemical Engineering; California Institute of Technology; Pasadena, California; United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Maranas</surname>
<given-names>Costas D.</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>The Pennsylvania State University, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>Authors declare no competing interests.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">fha@cheme.caltech.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>23</day>
<month>10</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="collection">
<month>10</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>10</issue>
<elocation-id>e1005786</elocation-id>
<history>
<date date-type="received">
<day>9</day>
<month>8</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>21</day>
<month>9</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Bedbrook et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005786"/>
<abstract>
<p>There is growing interest in studying and engineering integral membrane proteins (MPs) that play key roles in sensing and regulating cellular response to diverse external signals. A MP must be expressed, correctly inserted and folded in a lipid bilayer, and trafficked to the proper cellular location in order to function. The sequence and structural determinants of these processes are complex and highly constrained. Here we describe a predictive, machine-learning approach that captures this complexity to facilitate successful MP engineering and design. Machine learning on carefully-chosen training sequences made by structure-guided SCHEMA recombination has enabled us to accurately predict the rare sequences in a diverse library of channelrhodopsins (ChRs) that express and localize to the plasma membrane of mammalian cells. These light-gated channel proteins of microbial origin are of interest for neuroscience applications, where expression and localization to the plasma membrane is a prerequisite for function. We trained Gaussian process (GP) classification and regression models with expression and localization data from 218 ChR chimeras chosen from a 118,098-variant library designed by SCHEMA recombination of three parent ChRs. We use these GP models to identify ChRs that express and localize well and show that our models can elucidate sequence and structure elements important for these processes. We also used the predictive models to convert a naturally occurring ChR incapable of mammalian localization into one that localizes well.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>A protein’s amino acid sequence determines how it will fold, traffic to subcellular locations, and carry out specific functions within the cell. Understanding this process would enable the design of protein sequences capable of useful functions; unfortunately, we cannot predict in detail how sequence encodes function. However, machine-learning models have the potential to infer the complex protein sequence-function relationship by identifying patterns or features that are important for function from sequences with known functions. We used machine learning to learn about and design membrane proteins (MPs). To function, a MP must be expressed, correctly folded in a lipid membrane, and trafficked to the proper cellular location. We built predictive, machine-learning models for this complex process from a set of &gt;200 chimeric MPs and used them to design new sequences with optimal performance on the challenging task of membrane localization. This general approach to understanding and designing MPs could be broadly useful for important pharmaceutical and engineering MP targets.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000025</institution-id>
<institution>National Institute of Mental Health</institution>
</institution-wrap>
</funding-source>
<award-id>R21MH103824</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Arnold</surname>
<given-names>Frances H.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000025</institution-id>
<institution>National Institute of Mental Health</institution>
</institution-wrap>
</funding-source>
<award-id>R21MH103824</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Gradinaru</surname>
<given-names>Viviana</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000183</institution-id>
<institution>Army Research Office</institution>
</institution-wrap>
</funding-source>
<award-id>W911F-09-0001</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Arnold</surname>
<given-names>Frances H.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000025</institution-id>
<institution>National Institute of Mental Health</institution>
</institution-wrap>
</funding-source>
<award-id>F31MH102913</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Bedbrook</surname>
<given-names>Claire N.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution>National Institute of General Medical Sciences (US)</institution>
</funding-source>
<award-id>F32GM116319</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Rice</surname>
<given-names>Austin J.</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This work is funded by the National Institute for Mental Health R21MH103824 (VG and FHA) and the Institute for Collaborative Biotechnologies through grant number W911F-09-0001 from the U.S. Army Research Office (FHA). The content is solely the responsibility of the authors and does not necessarily reflect the position or policy of the National Center for Research Resources, the National Institutes of Health, or the Government, and no official endorsement should be inferred. VG is a Heritage Principal Investigator supported by the Heritage Medical Research Institute. CNB and AJR are funded by Ruth L. Kirschstein National Research Service Awards (F31MH102913 and F32GM116319, respectively). KKY is a trainee in the Caltech Biotechnology Leadership Program, and has received financial support from the Donna and Benjamin M. Rosen Bioengineering Center. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="1"/>
<page-count count="21"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-11-02</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are either within the paper and its Supporting Information files or published in ref 5.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>As crucial components of regulatory and transport pathways, integral membrane proteins (MPs) are important pharmaceutical and engineering targets [<xref ref-type="bibr" rid="pcbi.1005786.ref001">1</xref>]. To be functional, MPs must be expressed and localized through a series of elaborate sub-cellular processes that include co-translational insertion, rigorous quality control, and multi-step trafficking to arrive at the correct topology in the correct sub-cellular location [<xref ref-type="bibr" rid="pcbi.1005786.ref002">2</xref>–<xref ref-type="bibr" rid="pcbi.1005786.ref004">4</xref>]. With such a complex mechanism for production, it is not surprising that MP engineering has been hampered by poor expression, stability, and localization in heterologous systems [<xref ref-type="bibr" rid="pcbi.1005786.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1005786.ref007">7</xref>]. To overcome these limitations, protein engineers need a tool to predict how changes in sequence affect MP expression and localization. An accurate predictor would enable us to design and produce MP variants that express and localize correctly, a necessary first step in engineering MP function. A useful predictor would be sensitive to subtle changes in sequence that can lead to drastic changes in expression and localization. Our goal here was to develop data-driven models that predict the likelihood of a MP’s expression and plasma membrane localization using the amino acid sequence as the primary input.</p>
<p>For this study, we focus on channelrhodopsins (ChRs), light-gated ion channels that assume a seven transmembrane helix topology with a light-sensitive retinal chromophore bound in an internal pocket. This scaffold is conserved in both microbial rhodopsins (light-driven ion pumps, channels, and light sensors–type I rhodopsins) and animal rhodopsins (light-sensing G-protein coupled receptors–type II rhodopsins) [<xref ref-type="bibr" rid="pcbi.1005786.ref008">8</xref>]. Found in photosynthetic algae, ChRs function as light sensors in phototaxic and photophobic responses [<xref ref-type="bibr" rid="pcbi.1005786.ref009">9</xref>,<xref ref-type="bibr" rid="pcbi.1005786.ref010">10</xref>]. On photon absorption, ChRs undergo a multi-step photo-cycle that allows a flux of ions across the membrane and down the electrochemical gradient [<xref ref-type="bibr" rid="pcbi.1005786.ref011">11</xref>]. When ChRs are expressed transgenically in neurons, their light-dependent activity can stimulate action potentials, allowing cell-specific control over neuronal activity [<xref ref-type="bibr" rid="pcbi.1005786.ref012">12</xref>,<xref ref-type="bibr" rid="pcbi.1005786.ref013">13</xref>] and extensive applications in neuroscience [<xref ref-type="bibr" rid="pcbi.1005786.ref014">14</xref>]. The functional limitations of available ChRs have spurred efforts to engineer or discover novel ChRs [<xref ref-type="bibr" rid="pcbi.1005786.ref011">11</xref>]. The utility of a ChR, however, depends on its ability to express and localize to the plasma membrane in eukaryotic cells of interest, and changes to the amino acid sequence frequently abrogate localization [<xref ref-type="bibr" rid="pcbi.1005786.ref005">5</xref>]. A predictor for ChRs that express and localize would be of great value as a pre-screen for function.</p>
<p>The sequence and structural determinants for membrane localization have been a subject of much scientific investigation [<xref ref-type="bibr" rid="pcbi.1005786.ref015">15</xref>–<xref ref-type="bibr" rid="pcbi.1005786.ref017">17</xref>] and have provided some understanding of the MP sequence elements important for localization, such as signal peptide sequence, positive charge at the membrane–cytoplasm interface (the “positive-inside” rule [<xref ref-type="bibr" rid="pcbi.1005786.ref018">18</xref>]), and increased hydrophobicity in the transmembrane domains. However, these rules are of limited use to a protein engineer: there are too many amino acid sequences that follow these rules but still fail to localize to the plasma membrane (see <xref ref-type="sec" rid="sec002">Results</xref>). MP sequence changes that influence expression and localization are highly context-dependent: what eliminates localization in one sequence context has no effect in another, and subtle amino acid changes can have dramatic effects [<xref ref-type="bibr" rid="pcbi.1005786.ref005">5</xref>,<xref ref-type="bibr" rid="pcbi.1005786.ref016">16</xref>,<xref ref-type="bibr" rid="pcbi.1005786.ref019">19</xref>]. In short, sequence determinants of expression and localization are not captured by simple rules.</p>
<p>Accurate atomistic physics-based models relating a sequence to its level of expression and plasma membrane localization currently do not exist, in large measure due to the complexity of the process. Statistical models offer a powerful alternative. Statistical models are useful for predicting the outcomes of complex processes because they do not require prior knowledge of the specific biological mechanisms involved. That being said, statistical models can also be constructed to exploit prior knowledge, such as MP structural information. Statistical models can be trained using empirical data (in this case expression or localization values) collected from known sequences. During training, the model infers relationships between input (sequence) and output (expression or localization) that are then used to predict the properties of unmeasured sequence variants. The process of using empirical data to train and select statistical models is referred to as machine learning.</p>
<p>Machine learning has been applied to predicting various protein properties, including solubility [<xref ref-type="bibr" rid="pcbi.1005786.ref020">20</xref>,<xref ref-type="bibr" rid="pcbi.1005786.ref021">21</xref>], trafficking to the periplasm [<xref ref-type="bibr" rid="pcbi.1005786.ref022">22</xref>], crystallization propensity [<xref ref-type="bibr" rid="pcbi.1005786.ref023">23</xref>], and function [<xref ref-type="bibr" rid="pcbi.1005786.ref024">24</xref>]. Generally, these models are trained using large data sets composed of literature data from varied sources with little to no standardization of the experimental conditions, and trained using many protein classes (i.e. proteins with various folds and functions), because their aim is to identify sequence elements across all proteins that contribute to the property of interest. This generalist approach, however, is not useful for identifying subtle sequence features (i.e. amino acids or amino acid interactions) that condition expression and localization for a specific class of related sequences, the ChRs in this case. We focused our model building on ChRs, with training data collected from a range of ChR sequences under standardized conditions. We applied Gaussian process (GP) classification and regression [<xref ref-type="bibr" rid="pcbi.1005786.ref025">25</xref>] to build models that predict ChR expression and localization directly from these data.</p>
<p>In our previous work, GP models successfully predicted thermal stability, substrate binding affinity, and kinetics for several soluble enzymes [<xref ref-type="bibr" rid="pcbi.1005786.ref026">26</xref>]. Here, we asked whether GP modeling could accurately predict mammalian expression and localization for heterologous integral membrane ChRs and how much experimental data would be required. For a statistical model to make accurate predictions on a wide range of ChR sequences, it must be trained with a diverse set of ChR sequences [<xref ref-type="bibr" rid="pcbi.1005786.ref025">25</xref>]. We chose to generate a training set using chimeras produced by SCHEMA recombination, which was previously demonstrated to be useful for producing large sets (libraries) of diverse, functional chimeric sequences from homologous parent proteins [<xref ref-type="bibr" rid="pcbi.1005786.ref027">27</xref>]. We synthesized and measured expression and localization for only a small subset (0.18%) of sequences from the ChR recombination library. Here we use these data to train GP classification and regression models to predict the expression and localization properties of diverse, untested ChR sequences. We first made predictions on sequences within a large library of chimeric ChRs; we then expanded the predictions to sequences outside that set.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>The ChR training set</title>
<p>The design and characterization of the chimeric ChR sequences used to train our models have been published [<xref ref-type="bibr" rid="pcbi.1005786.ref005">5</xref>]; we will only briefly describe these results. Two separate, ten-block libraries were designed by recombining three parental ChRs (CsChrimsonR (CsChrimR) [<xref ref-type="bibr" rid="pcbi.1005786.ref028">28</xref>], C1C2 [<xref ref-type="bibr" rid="pcbi.1005786.ref029">29</xref>], and CheRiff [<xref ref-type="bibr" rid="pcbi.1005786.ref030">30</xref>]) with 45–55% amino acid sequence identity and a range of expression, localization, and functional properties (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s002">S1 Fig</xref></bold>) [<xref ref-type="bibr" rid="pcbi.1005786.ref005">5</xref>]. Each chimeric ChR variant in these libraries is composed of blocks of sequence from the parental ChRs. These libraries were prepared by the SCHEMA algorithm to define sequence blocks for recombination that minimize the library-average disruption of tertiary protein structure [<xref ref-type="bibr" rid="pcbi.1005786.ref031">31</xref>,<xref ref-type="bibr" rid="pcbi.1005786.ref032">32</xref>]. One library swaps contiguous elements of primary structure (contiguous library), and the second swaps elements that are contiguous in the tertiary structure but not necessarily in the sequence (non-contiguous library [<xref ref-type="bibr" rid="pcbi.1005786.ref033">33</xref>]). The two libraries have similar, but not identical, element boundaries (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s002">S1A Fig</xref></bold>) and were constructed in order to test whether one design approach was superior to the other (they gave similar results). These designs generate 118,098 possible chimeras (2 x 3<sup>10</sup>), which we will refer to as the recombination library throughout this paper. Each of these chimeras has a full N-terminal signal peptide from one of the three ChR parents.</p>
<p>Two hundred and eighteen chimeras from the recombination library were chosen as a training set, including all the chimeras with single-block swaps (chimeras consisting of 9 blocks of one parent and a single block from one of the other two parents) and multi-block-swap chimera sequences designed to maximize mutual information between the training set and the remainder of the chimeric library. Here, the ‘information’ a chimera has to offer is how its sequence, relative to all previously tested sequences, changes ChR expression and localization. By maximizing mutual information, we select chimera sequences that provide the most information about the whole library by reducing the uncertainty (Shannon entropy) of prediction for the remainder of the library, as described in [<xref ref-type="bibr" rid="pcbi.1005786.ref034">34</xref>,<xref ref-type="bibr" rid="pcbi.1005786.ref035">35</xref>]. The 112 single-block-swap chimeras in the training set have an average of 15 mutations from the most closely related parent, while the 103 multi-block-swap chimeras in the training set have an average of 73 mutations from the most closely related parent (<bold><xref ref-type="table" rid="pcbi.1005786.t001">Table 1</xref></bold>). While the multi-block-swap chimeras provide the most sequence diversity to learn from, they are the least likely to express and localize given their high mutation levels. The single-block-swap chimeras offer less information to learn from due to their sequence redundancies with other chimeras in the training set, but are more likely to express and localize.</p>
<table-wrap id="pcbi.1005786.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005786.t001</object-id>
<label>Table 1</label> <caption><title>Comparison of size, diversity, and localization properties of the training set and subsequent sets of chimeras chosen by models in the iterative steps of model development.</title></caption>
<alternatives>
<graphic id="pcbi.1005786.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"><bold>Set</bold></th>
<th align="left"><bold>Count</bold></th>
<th align="left"><bold>Mutations</bold><break/><bold>mean ± stdev</bold></th>
<th align="left"><bold>Percent with good localization</bold><xref ref-type="table-fn" rid="t001fn001">*</xref></th>
<th align="left"><bold>Localization</bold><break/><bold>mean ± stdev (x10</bold><sup><bold>-3</bold></sup><bold>)</bold></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" style="background-color:#C0C0C0"><bold>training–parents</bold></td>
<td align="left" style="background-color:#C0C0C0">3</td>
<td align="left" style="background-color:#C0C0C0">0</td>
<td align="left" style="background-color:#C0C0C0">100%</td>
<td align="left" style="background-color:#C0C0C0">5.6 ± 3.0</td>
</tr>
<tr>
<td align="left"><bold>training–single-block swap</bold></td>
<td align="left">112</td>
<td align="left">15 ± 9</td>
<td align="left">33%</td>
<td align="left">3.2 ± 3.4</td>
</tr>
<tr>
<td align="left" style="background-color:#C0C0C0"><bold>training–multi-block swap</bold></td>
<td align="left" style="background-color:#C0C0C0">103</td>
<td align="left" style="background-color:#C0C0C0">73 ± 21</td>
<td align="left" style="background-color:#C0C0C0">12%</td>
<td align="left" style="background-color:#C0C0C0">1.5 ± 2.5</td>
</tr>
<tr>
<td align="left"><bold>Exploration</bold></td>
<td align="left">16</td>
<td align="left">69 ± 12</td>
<td align="left">50%</td>
<td align="left">4.8 ± 4.7</td>
</tr>
<tr>
<td align="left" style="background-color:#C0C0C0"><bold>verification–high performing</bold></td>
<td align="left" style="background-color:#C0C0C0">4</td>
<td align="left" style="background-color:#C0C0C0">29 ± 17</td>
<td align="left" style="background-color:#C0C0C0">100%</td>
<td align="left" style="background-color:#C0C0C0">8.0 ± 1.6</td>
</tr>
<tr>
<td align="left"><bold>verification–low performing</bold></td>
<td align="left">7</td>
<td align="left">67 ± 12</td>
<td align="left">0%</td>
<td align="left">0.89 ± 0.73</td>
</tr>
<tr>
<td align="left" style="background-color:#C0C0C0"><bold>optimization</bold></td>
<td align="left" style="background-color:#C0C0C0">4</td>
<td align="left" style="background-color:#C0C0C0">43 ± 6</td>
<td align="left" style="background-color:#C0C0C0">100%</td>
<td align="left" style="background-color:#C0C0C0">14 ± 3.5</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t001fn001"><p>* ‘good localization’ is localization at or above that of the lowest-performing parent, CheRiff</p></fn>
</table-wrap-foot>
</table-wrap>
<p>Genes for these sequences were synthesized and expressed in human embryonic kidney (HEK) cells, and their expression and membrane localization properties were measured (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s002">S1B Fig</xref></bold>) [<xref ref-type="bibr" rid="pcbi.1005786.ref005">5</xref>]. The expression levels were monitored through a fluorescent protein (mKate) fused to the C-termini of the ChRs. Plasma-membrane localization was measured using the SpyTag/SpyCatcher labeling method, which exclusively labels ChR protein that has its N terminus exposed on the extracellular surface of the cell [<xref ref-type="bibr" rid="pcbi.1005786.ref036">36</xref>]. The training set sequences displayed a wide range of expression and localization properties. While the majority of the training set sequences express, only 33% of the single-block-swap chimeras localize well, and an even smaller fraction (12%) of the multi-block-swap chimeras localize well, emphasizing the importance of having a predictive model for membrane localization.</p>
<p>First we explored whether ChR chimera properties could be predicted based on basic biological properties, specifically, signal peptide sequence and hydrophobicity in the transmembrane (TM) domains. Each chimera in the library has one of the three parental signal peptides. Although the signal peptide sequence does affect expression and localization (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s003">S2A Fig</xref></bold>), chimeras with any parental signal peptide can have high or low expression and localization. Thus, the identity of the signal peptide alone is insufficient for accurate predictions of the ChR chimera properties. We then calculated the level of hydrophobicity within the 7-TM domains of each chimera. With very weak correlation between increasing hydrophobicity and measured expression and localization (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s003">S2B Fig</xref></bold>), hydrophobicity alone is also insufficient for accurate prediction of ChR chimera properties. These models do not accurately account for the observed levels of expression or localization (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s002">S1 Fig</xref></bold>). Therefore, we need more expressive models to predict expression and localization from the amino acid sequences of these MPs.</p>
</sec>
<sec id="sec004">
<title>Using GP models to learn about ChRs</title>
<p>Our overall strategy for developing predictive machine-learning models is illustrated in <bold><xref ref-type="fig" rid="pcbi.1005786.g001">Fig 1</xref></bold>. The goal is to use a set of ChR sequences and their expression and localization measurements to train GP regression and classification models that describe how ChR properties depend on sequence and predict the behavior of untested ChRs. GP models infer predictive values from training examples by assuming that similar inputs (ChR sequence variants) will have similar outputs (expression or localization). We quantify the relatedness of inputs (ChR sequence variants) by comparing both sequence and structure. ChR variants with few differences are considered more similar than ChR variants with many differences. We define the sequence similarity between two chimeras by aligning them and counting the number of positions at which they are identical. For structural comparisons, a residue-residue ‘contact map’ was built for each ChR variant, where two residues are in contact if they have any non-hydrogen atoms within 4.5 Å. The maps were generated using a ChR parental sequence alignment and the C1C2 crystal structure, which is the only available ChR structure [<xref ref-type="bibr" rid="pcbi.1005786.ref029">29</xref>], with the assumption that ChR chimeras share the overall contact architecture observed in the C1C2 crystal structure. The structural similarity for any two ChRs was quantified by aligning the contact maps and counting the number of identical contacts [<xref ref-type="bibr" rid="pcbi.1005786.ref026">26</xref>]. Using these metrics, we calculated the sequence and structural similarity between all ChRs in the training set relative to one another (218 x 218 ChR comparisons).</p>
<fig id="pcbi.1005786.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005786.g001</object-id>
<label>Fig 1</label>
<caption>
<title>General approach to machine learning of protein (ChR) structure-function relationships: diversity generation, measurements on a training set, and modeling.</title>
<p>(<bold>1</bold>) Structure-guided SCHEMA recombination is used to select block boundaries for shuffling protein sequences to generate a sequence-diverse ChR library starting from three parent ChRs (shown in red, green, and blue). (<bold>2</bold>) A subset of the library serves as the training set. Genes for these chimeras are synthesized and cloned into a mammalian expression vector, and the transfected cells are assayed for ChR expression and localization. (<bold>3</bold>) Two different models, classification and regression, are trained using the training data and then verified. The classification model is used to explore diverse sequences predicted to have ‘high’ localization. The regression model is used to design ChRs with optimal localization to the plasma membrane.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.g001" xlink:type="simple"/>
</fig>
<p>These similarity functions are called kernel functions and specify how the functional properties of pairs of sequences are expected to covary (they are also known as covariance functions). In other words, the kernel is a measure of similarity between sequences, and we can draw conclusions about unobserved chimeras on the basis of their similarity to sampled points [<xref ref-type="bibr" rid="pcbi.1005786.ref025">25</xref>]. The model has high confidence in predicting the properties of sequences that are similar to previously sampled sequences, and the model is less confident in predicting the properties of sequences that are distant from previously sampled sequences.</p>
<p>To build a GP model, we must also specify how the relatedness between sequences will affect the property of interest, in other words how sensitive the ChR properties are to changes in relatedness as defined by the sequence/structure differences between ChRs. This is defined by the form of the kernel used. We tested three different forms of sequence and structure kernels: linear kernels, squared exponential kernels, and Matérn kernels (see <xref ref-type="sec" rid="sec010">Methods</xref>). These different forms represent the kinds of functions we expect to observe for the protein’s fitness landscape (i.e. the mapping of protein sequence to protein function). The linear kernel corresponds to a simple landscape where the effects of changes in sequence/structure are additive and there is no epistasis. The two non-linear kernels represent more rugged, complex landscapes where effects may be non-additive. Learning involves optimizing the form of the kernel and its hyperparameters (parameters that influence the form of kernel) to enable accurate predictions. The hyperparameters and the form of the kernel were optimized using the Bayesian method of maximizing the marginal likelihood of the resulting model. The marginal likelihood (i.e. how likely it is to observe the data given the model) rewards models that fit the training data well while penalizing model complexity to prevent overfitting.</p>
<p>Once trained with empirical data, the output of the GP regression model is a predicted mean and variance, or standard deviation, for any given ChR sequence variant. The standard deviation is an indication of how confident the model is in the prediction based on the relatedness of the new input relative to the tested sequences.</p>
<p>We used GP models to infer links between ChR properties and ChR sequence and structure from the training data. We first built GP binary classification models. In binary classification, the outputs are class labels i.e. ‘high’ or ‘low’ localization, and the goal is to use the training set data to predict the probability of a sequence falling into one of the two classes (<bold><xref ref-type="fig" rid="pcbi.1005786.g001">Fig 1</xref></bold>). We also built a GP regression model that makes real-valued predictions, i.e. amount of localized protein, based on the training data (<bold><xref ref-type="fig" rid="pcbi.1005786.g001">Fig 1</xref></bold>). After training these models, we verify that their predictions generalize to sequences outside of the training set. Once validated, these two models can be used in different ways. A classification model trained from localization data can be used to predict the probability of highly diverse sequences falling into the ‘high’ localization category (<bold><xref ref-type="fig" rid="pcbi.1005786.g001">Fig 1</xref></bold>). The classification model can only predict if a sequence has ‘high’ vs ‘low’ localization, and it cannot be used to optimize localization. The regression model, on the other hand, can be used to predict sequences with ‘optimal’ properties; for example, a regression model trained from localization data can predict untested sequences that will have very high levels of localization (<bold><xref ref-type="fig" rid="pcbi.1005786.g001">Fig 1</xref></bold>).</p>
</sec>
<sec id="sec005">
<title>Building GP classification models of ChR properties</title>
<p>The training set data (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s002">S1 Fig</xref></bold>) were used to build a GP classification model that predicted which of the 118,098 chimeras in the recombination library would have ‘high’ vs ‘low’ expression, localization, and localization efficiency. The training set includes multi-block swaps chosen to be distant from other sequences in the training set in order to provide information on sequences throughout the recombination library. A sequence was considered ‘high’ if it performed at least as well as the lowest performing parent, and it was considered ‘low’ if it performed worse than the lowest performing parent. Because the lowest performing parent for expression and localization, CheRiff, is produced and localized in sufficient quantities for downstream functional studies, we believe this to be an appropriate threshold for ‘high’ vs ‘low’ performance. For all of the classification models (<bold><xref ref-type="fig" rid="pcbi.1005786.g002">Fig 2</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s004">S3 Fig</xref></bold>), we used kernels based on structural relatedness. For the expression classification model, we found that a linear kernel performed best, i.e. achieved the highest marginal likelihood. This suggests that expression is best approximated by an additive model weighting each of the structural contacts. Localization and localization efficiency required a non-linear kernel for the model to be predictive. This more expressive kernel allows for non-linear relationships and epistasis and also penalizes differing structural contacts more than the linear kernel. This reflects our intuitive understanding that localization is a more demanding property to tune than expression, with stricter requirements and a non-linear underlying fitness landscape.</p>
<fig id="pcbi.1005786.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005786.g002</object-id>
<label>Fig 2</label>
<caption>
<title>GP binary classification models for expression and localization.</title>
<p>Plots of predicted probability vs measured properties are divided into ‘high’ performers (white background) and ‘low’ performers (gray background) for each property (expression and localization). (<bold>A</bold>) &amp; (<bold>D</bold>) Predicted probability vs measured properties for the training set (gray points) and the exploration set (cyan points). Predictions for the training and exploration sets were made using LOO cross-validation. (<bold>B</bold>) &amp; (<bold>E</bold>) Predicted probabilities vs measured properties for the verification set. Predictions for the verification set were made by a model trained on the training and exploration sets. (<bold>C</bold>) &amp; (<bold>F</bold>) Predicted probability of ‘high’ expression, and localization for all chimeras in the recombination library (118,098 chimeras) made by models trained on the data from the training and exploration sets. The gray line shows all chimeras in the library, the gray points indicate the training set, the cyan points indicate the exploration set, the purple points indicate the verification set, and the yellow points indicate the parents. (<bold>A</bold>-<bold>C</bold>) Show expression and (<bold>D</bold>-<bold>F</bold>) show localization. For all plots, the measured property is plotted on a log<sub>2</sub> scale.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.g002" xlink:type="simple"/>
</fig>
<p>Most of the multi-block-swap sequences from the training set did not localize to the membrane [<xref ref-type="bibr" rid="pcbi.1005786.ref005">5</xref>]. We nonetheless want to be able to design highly mutated ChRs that localize well because these are most likely to have interesting functional properties. We therefore used the localization classification model to identify multi-block-swap chimeras from the library that had a high predicted probability (&gt;0.4) of falling into the ‘high’ localizer category (<bold><xref ref-type="fig" rid="pcbi.1005786.g002">Fig 2D</xref></bold>). From the many multi-block-swap chimeras predicted to have ‘high’ localization, we selected a set of 16 highly diverse chimeras with an average of 69 amino acid mutations from the closest parent and called this the ‘exploration’ set (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s005">S4 Fig</xref></bold>). We synthesized and tested these chimeras and found that the model had accurately predicted chimeras with good localization (<bold><xref ref-type="fig" rid="pcbi.1005786.g002">Fig 2</xref></bold> and <bold><xref ref-type="fig" rid="pcbi.1005786.g003">Fig 3</xref></bold>): 50% of the exploration set show ‘high’ localization compared to only 12% of the multi-block-swap sequences from the original training set, even though they have similar levels of mutation (<bold><xref ref-type="table" rid="pcbi.1005786.t001">Table 1</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s001">S1 Data</xref></bold>) (chimeras in the exploration set have on average 69 ± 12 amino acid mutations from the closest parent, versus 73 ± 21 for the multi-block-swap chimeras in the training set). The classification model provides a four-fold enrichment in the number of chimeras that localize well when compared to randomly-selected chimeras with equivalent levels of mutation. This accuracy is impressive given that the exploration set was designed to be distant from any sequence the model had seen during training. The model’s performance on this exploration set indicates its ability to predict the properties of sequences distant from the training set.</p>
<fig id="pcbi.1005786.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005786.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Comparison of measured membrane localization for each data set.</title>
<p>Swarm plots of localization measurements for each data set compared with parents: training set, exploration set, verification set, and optimization set.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.g003" xlink:type="simple"/>
</fig>
<p>The data from the exploration set were then used to better inform our models about highly diverse sequences that localize. To characterize the classification model’s performance, we calculated the area under the receiver operating characteristic (ROC) curve (AUC). A poorly performing model would not do better than random chance, resulting in an AUC of 0.5, while a model that perfectly separates the two classes will have an AUC of 1.0. The revised models achieved AUC up to 0.87 for “leave-one-out” (LOO) cross-validation, indicating that there is a high probability that the classifiers will accurately separate ‘high’ and ‘low’ performing sequences for the properties measured. The AUC is 0.83 for localization, 0.77 for localization efficiency and 0.87 for expression for LOO cross-validation predictions (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s006">S5 Fig</xref></bold>).</p>
<p>To further test the models, we then built a verification set of eleven chimeras, designed using the localization model. This verification set was composed of four chimeras predicted to be highly likely to localize, six chimeras predicted to be very unlikely to localize, and one chimera with a moderate predicted probability of localizing (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s005">S4 Fig</xref></bold>). The measured localization (<bold><xref ref-type="fig" rid="pcbi.1005786.g002">Fig 2E</xref></bold>) and localization efficiency (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s004">S3B Fig</xref></bold>) of the chimeras in the verification set show clear differences, ‘high’ vs ‘low’, consistent with the model predictions (<bold><xref ref-type="table" rid="pcbi.1005786.t001">Table 1</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s001">S1 Data</xref></bold>). The verification sets consist exclusively of chimeras with ‘high’ measured expression, which is consistent with the model’s predictions (<bold><xref ref-type="fig" rid="pcbi.1005786.g002">Fig 2B</xref></bold>). The model perfectly classifies the eleven chimeras as either ‘high’ or ‘low’ for each property (expression, localization, or localization efficiency) as shown in plots of predicted vs measured properties (<xref ref-type="fig" rid="pcbi.1005786.g002"><bold>Fig 2B</bold> and <bold>2E</bold></xref> and <bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s004">S3B Fig</xref></bold>) and by perfect separation in ROC curves i.e. AUC = 1.0 (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s006">S5 Fig</xref></bold>). These models are powerful tools that can confidently predict whether a chimera will have 'high' or 'low' expression (<bold><xref ref-type="fig" rid="pcbi.1005786.g002">Fig 2C</xref></bold>), localization (<bold><xref ref-type="fig" rid="pcbi.1005786.g002">Fig 2F</xref></bold>), and localization efficiency (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s004">S3C Fig</xref></bold>). Of the 118,098 chimeras in the recombination library, 6,631 (5.6%) are predicted to have a probability &gt; 0.5 of 'high' localization, whereas the vast majority of chimeras (99%) are predicted to have a probability &gt; 0.5 of 'high' expression.</p>
</sec>
<sec id="sec006">
<title>Building a regression model for ChR localization</title>
<p>The classification model predicts the probability that a sequence falls into the ‘high’ localizer category, but does not give a quantitative prediction as to how well it localizes. Our next goal was to design chimera sequences with optimal localization. Localization is considered optimal if it is at or above the level of CsChrimR, the best localizing parent, which is more than adequate for <italic>in vivo</italic> applications using ChR functionality to control neuronal activity [<xref ref-type="bibr" rid="pcbi.1005786.ref028">28</xref>]. A regression model for ChR plasma membrane localization is required to predict sequences that have optimal levels of localization. We used the localization data from the training and exploration sets to train a GP regression model (<bold><xref ref-type="fig" rid="pcbi.1005786.g004">Fig 4A</xref></bold>). The diversity of sequences in the training data allows the model to generalize well to the remainder of the recombination library. For this regression model, we do not use all of the features from the combined sequence and structure information; instead, we used L1 linear regression to select a subset of these features. The L1 linear regression identifies the sequence and structural features that most strongly influence ChR localization. Using this subset of features instead of all of the features improved the quality of the predictions (as determined by cross-validation). This indicates that not all of the residues and residue-residue contacts have a large influence on localization of ChR. We then used a kernel based on these chosen features (specific contacts and residues) for GP regression. The regression model for localization showed strong predictive ability as indicated by the strong correlation between predicted and measured localization for LOO cross-validation (correlation coefficient, R &gt; 0.76) (<bold><xref ref-type="fig" rid="pcbi.1005786.g004">Fig 4A</xref></bold>). This was further verified by the strong correlation between predicted and measured values for the previously-discussed verification set (R &gt; 0.9) (<bold><xref ref-type="fig" rid="pcbi.1005786.g004">Fig 4A</xref></bold>). These cross-validation results suggest that the regression model can be used to predict chimeras with optimal localization.</p>
<fig id="pcbi.1005786.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005786.g004</object-id>
<label>Fig 4</label>
<caption>
<title>GP regression model for localization.</title>
<p>(<bold>A</bold>) Predicted vs measured localization for the combined training and exploration sets (gray points), verification set (purple points), and the optimal set (green points). Predictions for the training and exploration sets were made using LOO cross-validation; predictions for the verification and optimal sets were made by a model trained on data from the training and exploration sets. There is clear correlation between predicted and measured localization. The combined training and exploration sets showed good correlation (R &gt; 0.73) as did the verification set (R &gt; 0.9). (<bold>B</bold>) Predicted localization values of all chimeras in the recombination library (118,098 chimeras) based on the GP regression model trained on the training and exploration sets. The gray line shows all chimeras in the library, the gray points indicate the training set and exploration sets, the purple points indicate the verification set, and the yellow points indicate the parents. Error bars (light gray shading) show the standard deviation of the predictions. For all plots, the predicted and measured localization are plotted on a log<sub>2</sub> scale.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.g004" xlink:type="simple"/>
</fig>
<p>We used the localization regression model to predict ChR chimeras with optimal localization using the Lower Confidence Bound (LCB) algorithm, in which the predicted mean minus the predicted standard deviation (LB1) is maximized [<xref ref-type="bibr" rid="pcbi.1005786.ref037">37</xref>]. The LCB algorithm maximally exploits the information learned from the training set by finding sequences the model is most certain will be good localizers. The regression model was used to predict the localization level and standard deviation for all chimeras in the library, and from this the LB1 was calculated for all chimeras (<bold><xref ref-type="fig" rid="pcbi.1005786.g004">Fig 4B</xref></bold>). We selected four chimeras whose LB1 predictions for localization were ranked in the top 0.1% of the library (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s005">S4 Fig</xref></bold>). These were constructed and tested (<bold><xref ref-type="fig" rid="pcbi.1005786.g003">Fig 3</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s007">S6 Fig</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s001">S1 Data</xref></bold>). Measurements showed that they all localize as well as or better than CsChrimR (<bold><xref ref-type="fig" rid="pcbi.1005786.g003">Fig 3</xref></bold> and <bold><xref ref-type="fig" rid="pcbi.1005786.g004">Fig 4A</xref></bold> and <bold><xref ref-type="table" rid="pcbi.1005786.t001">Table 1</xref></bold>). Cell population distributions of the optimal set show properties similar to the CsChrimR parent, with one chimera showing a clear shift in the peak of the distribution towards higher levels of localization (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s008">S7 Fig</xref></bold>). These four sequences differ from CsChrimR at 30 to 50 amino acids (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s005">S4 Fig</xref></bold>).</p>
<p>We were interested in how predictive the GP localization models could be with fewer training examples. To assess the predictive ability of the GP models as a function of training set size, we sampled random sets of training sequences from the dataset, trained models on these random sets, then evaluated the model’s performance on a selected test set (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s009">S8 Fig</xref></bold>). As few as 100 training examples are sufficient for accurate predictions for both the localization regression and classification models. This analysis shows that the models would have been predictive with even fewer training examples than we chose to use.</p>
</sec>
<sec id="sec007">
<title>Sequence and structure features that facilitate prediction of ChR expression and localization</title>
<p>In developing the GP regression model for localization, we used L1-regularized linear regression to identify a limited set of sequence and structural features that strongly influence ChR localization (<bold><xref ref-type="fig" rid="pcbi.1005786.g004">Fig 4</xref></bold>). These features include both inter-residue contacts and individual residues and offer insight into the structural determinants of ChR localization. To better gauge the relative importance of these features, L2-regularized linear regression was used to calculate the positive and negative feature weights, which are proportional to each feature’s inferred contribution to localization. While not as predictive as the GP regression model because it cannot account for higher-order interactions between features, this linear model has the advantage of being interpretable.</p>
<p>When mapped onto the C1C2 structure, these features highlight parts of the ChR sequence and structural contacts that are important for ChR localization to the plasma membrane (<bold><xref ref-type="fig" rid="pcbi.1005786.g005">Fig 5</xref></bold>). Both beneficial and deleterious features are distributed throughout the protein, with no single feature dictating localization properties (<bold><xref ref-type="fig" rid="pcbi.1005786.g005">Fig 5</xref></bold>). Clusters of heavily weighted positive contacts suggest that having structurally proximal CsChrimR-residue pairs are important in the N-terminal domain (NTD), between the NTD and TM4, between TM1 and TM7, and between TM3 and TM7. CsChrimR residues at the extracellular side of TM5 also appear to aid localization, although they are weighted less than CheRiff residues in the same area. Beneficial CheRiff contacts and residues are found in the C-terminal domain (CTD), the interface between the CTD and TM5-6, and in TM1. C1C2 residues at the extracellular side of TM6 are also positively weighted for localization, as are C1C2 contacts between the CTD and TM3-4 loop. From the negatively weighted contacts, it is clear that total localization is harmed when CheRiff contributes to the NTD or the intracellular half of TM4 and when CsChrimR contributes to the CTD. Interestingly, positive contacts were formed between TM6 from C1C2 and TM7 from CheRiff, but when the contributions were reversed (TM6 from CheRiff TM7 from C1C2) or if CsChrimR contributed TM6, strong negative weights were observed. Not surprisingly, the sequence and structure of optimal localizers predicted by GP regression (<bold><xref ref-type="fig" rid="pcbi.1005786.g004">Fig 4</xref></bold>) largely agree with the L2 weights (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s010">S9 Fig</xref></bold>).</p>
<fig id="pcbi.1005786.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005786.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Sequence and structural contact features important for prediction of ChR localization.</title>
<p>Features with positive (<bold>A</bold>) and negative (<bold>B</bold>) weights are displayed on the C1C2 crystal structure (grey). Features can be residues (spheres) or contacts (sticks) from one or more parent ChRs. Features from CsChrimR are shown in red, features from C1C2 are shown in green, and features from CheRiff are shown in blue. In cases where a feature is present in two parents, the following color priorities were used for consistency: red above green above blue. Sticks connect the beta carbons of contacting residues (or alpha carbon in the case of glycine). The size of the spheres and the thickness of the sticks are proportional to the parameter weights. Two residues in contact can be from the same or different parents. Single-color contacts occur when both contributing residues are from the same parent. Multi-color contacts occur when residues from different parents are in contact. The N-terminal domain (NTD), C-terminal domain (CTD), and the seven transmembrane helices (TM1-7) are labeled.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.g005" xlink:type="simple"/>
</fig>
<p>Using this strategy for model interpretation (L1 regression for feature selection followed by L2 regression), we can also weight the contributions of residues and contacts for ChR expression (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s011">S10 Fig</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s012">S11 Fig</xref></bold>). There is some overlap between the heavily weighted features for ChR expression and the features for localization, which is expected because more protein expressed means more protein available for localization. For example, both expression and localization models seem to prefer the NTD from CsChrimR and the extracellular half of TM6 from C1C2, and both disfavor the NTD and the intra-cellular half of TM4 from CheRiff. While the heavily-weighted expression features are limited to these isolated sequence regions, localization features are distributed throughout the protein. Moreover, the majority of heavily-weighted features identified for expression are residues rather than contacts. This is in contrast to those weighted features identified for localization, which include heavily-weighted residues and structural contacts. This suggests that sequence is more important in determining expression properties, which is consistent with the largely sequence-dependent mechanisms associated with successful translation and insertion into the ER membrane. In contrast, both sequence and specific structural contacts contribute significantly to whether a ChR will localize to the plasma membrane. Our results demonstrate that the model can ‘learn’ the features that contribute to localization from the data and make accurate predictions on that property.</p>
</sec>
<sec id="sec008">
<title>Using the GP regression model to engineer novel sequences that localize</title>
<p>We next tested the ChR localization regression model for its ability to predict plasma-membrane localization for ChR sequences outside the recombination library. For this, we chose a natural ChR variant, CbChR1, that expresses in HEK cells and neurons but does not localize to the plasma membrane and thus is non-functional [<xref ref-type="bibr" rid="pcbi.1005786.ref028">28</xref>]. CbChR1 is distant from the three parental sequences, with 60% identity to CsChrimR and 40% identity to CheRiff and C1C2. We optimized CbChR1 by introducing minor amino acid changes predicted by the localization regression model to be beneficial for membrane localization. To enable measurement of CbChR1 localization with the SpyTag-based labeling method, we substituted the N-terminus of CbChR1 with the CsChrimR N-terminus containing the SpyTag sequence downstream of the signal peptide to make the chimera CsCbChR1 [<xref ref-type="bibr" rid="pcbi.1005786.ref036">36</xref>]. This block swap did not change the membrane localization properties of CbChR1 (<bold><xref ref-type="fig" rid="pcbi.1005786.g006">Fig 6C</xref></bold>). Using the regression model, we predicted localization levels for all the possible single-block swaps from the three library parents (CsChrimR, C1C2 and CheRiff) into CsCbChR1 and selected the four chimeras with the highest Upper Confidence Bound (UCB). These chimeras have between 4 and 21 mutations when compared with CsCbChR1. Unlike the LCB algorithm, which seeks to find the safest optimal choices, the UCB algorithm balances exploration and exploitation by maximizing the sum of the predicted mean and standard deviation.</p>
<fig id="pcbi.1005786.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005786.g006</object-id>
<label>Fig 6</label>
<caption>
<title>GP regression model enables engineering of localization in CbChR1.</title>
<p>(<bold>A</bold>) Block identities of the CsCbChR1 chimeras. Each row represents a chimera. Yellow represents the CbChR1 parent and red represents the CsChrimR parent. Chimeras 1c, 2n, and 3c have 4, 21, and 17 mutations with respect to CsCbChR1, respectively. (<bold>B</bold>) Plot of measured localization of CsCbChR1 compared to three CsCbChR1 single-block-swap chimeras and the CheRiff parent. (<bold>C</bold>) Two representative cell images of mKate expression of CbChR1 and CsCbChR1 compared with top-performing CsCbChR1 single-block-swap chimeras show differences in ChR localization properties–chimera 2n and chimera 3c clearly localize to the plasma membrane. Scale bar: 20 μm.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.g006" xlink:type="simple"/>
</fig>
<p>The selected chimeras were assayed for expression, localization, and localization efficiency (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s001">S1 Data</xref></bold>). One of the four sequences did not express; the other three chimeras expressed and had higher localization levels than CsCbChR1 (<bold><xref ref-type="fig" rid="pcbi.1005786.g006">Fig 6B</xref></bold>). Two of the three had localization properties similar to the CheRiff parent (<bold><xref ref-type="fig" rid="pcbi.1005786.g006">Fig 6B</xref></bold>). Images of the two best localizing chimeras illustrate the enhancement in localization when compared with CbChR1 and CsCbChR1 (<bold><xref ref-type="fig" rid="pcbi.1005786.g006">Fig 6C</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s013">S12 Fig</xref></bold>). This improvement in localization was achieved through single-block swaps from CsChrimR (17 and 21 amino acid mutations) (<bold><xref ref-type="fig" rid="pcbi.1005786.g006">Fig 6A</xref></bold>). These results suggest that this regression model can accurately predict minor sequence changes that will improve the membrane localization of natural ChRs.</p>
</sec>
</sec>
<sec id="sec009" sec-type="conclusions">
<title>Discussion</title>
<p>The ability to differentiate the functional properties of closely related sequences is extremely powerful for protein design and engineering. This is of particular interest for protein types that have proven to be more recalcitrant to traditional protein design methods, e.g. MPs. We show here that integral membrane protein expression and plasma membrane localization can be predicted for novel, homologous sequences using moderate-throughput data collection and advanced statistical modeling. We have used the models in four ways: 1) to accurately predict which diverse, chimeric ChRs are likely to express and localize at least as well as a moderately-performing native ChR; 2) to design ChR chimeras with optimized membrane localization that matched or exceeded the performance of a very well-localizing ChR (CsChrimR); 3) to identify the structural interactions (contacts) and sequence elements most important for predicting ChR localization; and 4) to identify limited sequence changes that transform a native ChR from a non-localizer to a localizer.</p>
<p>Whereas 99% of the chimeras in the recombination library are predicted to express in HEK cells, only 5.6% are predicted to localize to the membrane at levels equal to or above the lowest parent (CheRiff). This result shows that expression is robust to recombination-based sequence alterations, whereas correct plasma-membrane localization is much more sensitive. The model enables accurate selection of the rare, localization-capable, proteins from the nearly 120,000 possible chimeric library variants. In future work we will show that this diverse set of several thousand variants predicted to localize serves as a highly enriched source of functional ChRs with novel properties.</p>
<p>Although statistical models generalize poorly as one attempts to make predictions on sequences distant from the sequences used in model training, we show that it is possible to train a model that accurately distinguishes between closely related proteins. The tradeoff between making accurate predictions on subtle sequence changes vs generalized predictions for significantly different sequences is one we made intentionally in order to achieve accurate predictions for an important and interesting class of proteins. Accurate statistical models, like the ones described in this paper, could aid in building more expressive physics-based models.</p>
<p>This work details the steps in building machine-learning models and highlights their power in predicting desirable protein properties that arise from the intersection of multiple cellular processes. Combining recombination-based library design with statistical modeling methods, we have scanned a highly functional portion of protein sequence space by training on only 218 sequences. Model development through iterative training, exploration, and verification has yielded a tool that not only predicts optimally performing chimeric proteins, but can also be applied to improve related ChR proteins outside the library. As large-scale gene synthesis and DNA sequencing become more affordable, machine-learning methods such as those described here will become ever more powerful tools for protein engineering offering an alternative to high-throughput assay systems.</p>
</sec>
<sec id="sec010" sec-type="materials|methods">
<title>Materials and methods</title>
<p>The design, construction, and characterization of recombination library chimeras is described in Bedbrook <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1005786.ref005">5</xref>]. Briefly, HEK 293T cells were transfected with purified ChR variant DNA using Fugene6 reagent according to the manufacturer’s recommendations. Cells were given 48 hours to express before expression and localization were measured. To assay localization level, transfected cells were subjected to the SpyCatcher-GFP labeling assay, as described in Bedbrook <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1005786.ref036">36</xref>]. Transfected HEK cells were then imaged for mKate and GFP fluorescence using a Leica DMI 6000 microscope (for cell populations) or a Zeiss LSM 780 confocal microscope (for single cells: <bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s013">S12 Fig</xref></bold>). Images were processed using custom image processing scripts for expression (mean mKate fluorescence intensity) and localization (mean GFP fluorescence intensity). All chimeras were assayed under identical conditions.</p>
<p>For each chimera, net hydrophobicity was calculated by summing the hydrophobicity of all residues in the TM domains. The C1C2 crystal structure was used to identify residues within TM domains (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s003">S2B Fig</xref></bold>), and the Kyte &amp; Doolittle amino acid hydropathicity scale [<xref ref-type="bibr" rid="pcbi.1005786.ref038">38</xref>] was used to score residue hydrophobicity.</p>
<sec id="sec011">
<title>GP modeling</title>
<p>Both the GP regression and classification modeling methods applied in this paper are based on work detailed in [<xref ref-type="bibr" rid="pcbi.1005786.ref026">26</xref>]. Romero <italic>et al</italic>. applied GP models to predict protein functions and also defined protein distance using a contact map. We have expanded on this previous work. Regression and classification were performed using open-source packages in the SciPy ecosystem [<xref ref-type="bibr" rid="pcbi.1005786.ref039">39</xref>–<xref ref-type="bibr" rid="pcbi.1005786.ref041">41</xref>]. Below are specifics of the GP regression and classification methods used in this paper. The hyperparameters and the form of the kernel were optimized using the Bayesian method of maximizing the marginal likelihood of the resulting model.</p>
<sec id="sec012">
<title>GP regression</title>
<p>In regression, the problem is to infer the value of an unknown function <italic>f</italic>(<italic>x</italic>) at a novel point <italic>x</italic><sub>*</sub> given observations <italic>y</italic> at inputs <italic>X</italic>. Assuming that the observations are subject to independent identically distributed Gaussian noise with variance <inline-formula id="pcbi.1005786.e001"><alternatives><graphic id="pcbi.1005786.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005786.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, the posterior distribution of <italic>f</italic><sub>*</sub> = <italic>f</italic>(<italic>x</italic><sub>*</sub>) for Gaussian process regression is Gaussian with mean
<disp-formula id="pcbi.1005786.e002">
<alternatives>
<graphic id="pcbi.1005786.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005786.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>y</mml:mi>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
and variance
<disp-formula id="pcbi.1005786.e003">
<alternatives>
<graphic id="pcbi.1005786.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005786.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
Where</p>
<list list-type="order">
<list-item><p><italic>K</italic> is the symmetric, square covariance matrix for the training set, where <italic>K</italic><sub><italic>ij</italic></sub> = <italic>k</italic>(<italic>x</italic><sub><italic>i</italic></sub>,<italic>x</italic><sub><italic>j</italic></sub>) for <italic>x</italic><sub><italic>i</italic></sub> and <italic>x</italic><sub><italic>j</italic></sub> in the training set.</p></list-item>
<list-item><p><italic>k</italic><sub>*</sub> is the vector of covariances between the novel input and each input in the training set, where <italic>k</italic><sub>*<italic>i</italic></sub> = <italic>k</italic>(<italic>x</italic><sub>*</sub>,<italic>x</italic><sub><italic>i</italic></sub>).</p></list-item>
</list>
<p>We found that results could be improved by first performing feature selection with L1-regularized linear regression and then only training the GP model on features with non-zero weights in the L1 regression. The hyperparameters in the kernel functions, the noise hyperparameter <italic>σ</italic><sub><italic>p</italic></sub> and the regularization hyperparameter were determined by maximizing the log marginal likelihood:
<disp-formula id="pcbi.1005786.e004">
<alternatives>
<graphic id="pcbi.1005786.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005786.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mspace width="0.25em"/><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>I</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
where <italic>n</italic> is the dimensionality of the inputs.</p>
</sec>
<sec id="sec013">
<title>GP classification</title>
<p>In binary classification, instead of continuous outputs <italic>y</italic>, the outputs are class labels <italic>y</italic><sub><italic>i</italic></sub> ∈ {+1,−1}, and the goal is to use the training data to make probabilistic predictions <italic>π</italic>(<italic>x</italic><sub>*</sub>) = <italic>p</italic>(<italic>y</italic><sub>*</sub> = +1|<italic>x</italic><sub>*</sub>). Unfortunately, the posterior distribution for classification is analytically intractable. We use Laplace's method to approximate the posterior distribution. There is no noise hyperparameter in the classification case. Hyperparameters in the kernels are also found by maximizing the marginal likelihood.</p>
</sec>
<sec id="sec014">
<title>GP kernels for modeling proteins</title>
<p>Gaussian process regression and classification models require kernel functions that measure the similarity between protein sequences. A protein sequence <italic>s</italic> of length <italic>l</italic> is defined by the amino acid present at each location. This information can be encoded as a binary feature vector <italic>x</italic><sub><italic>se</italic></sub> that indicates the presence or absence of each amino acid at each position. The protein's structure can be represented as a residue-residue contact map. The contact-map can be encoded as a binary feature vector <italic>x</italic><sub><italic>st</italic></sub> that indicates the presence or absence of each possible contacting pair. The sequence and structure feature vectors can also be concatenated to form a sequence-structure feature vector.</p>
<p>We considered three types of kernel functions <italic>k</italic>(<italic>s</italic><sub><italic>i</italic></sub>,<italic>s</italic><sub><italic>j</italic></sub>): linear kernels, squared exponential kernels, and Matérn kernels. The linear kernel is defined as:
<disp-formula id="pcbi.1005786.e005">
<alternatives>
<graphic id="pcbi.1005786.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005786.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mi>k</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>x</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:msup>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
where <italic>σ</italic><sub><italic>p</italic></sub> is a hyperparameter that determines the prior variance of the fitness landscape. The squared exponential kernel is defined as:
<disp-formula id="pcbi.1005786.e006">
<alternatives>
<graphic id="pcbi.1005786.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005786.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:mi>k</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
where <italic>l</italic> and <italic>σ</italic><sub><italic>p</italic></sub> are also hyperparameters and |∙|<sub>2</sub> is the L2 norm. Finally, the Matérn kernel with <inline-formula id="pcbi.1005786.e007"><alternatives><graphic id="pcbi.1005786.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005786.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> is defined as:
<disp-formula id="pcbi.1005786.e008">
<alternatives>
<graphic id="pcbi.1005786.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005786.e008" xlink:type="simple"/>
<mml:math display="block" id="M8">
<mml:mi>k</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:mn>5</mml:mn><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>5</mml:mn><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:mn>5</mml:mn><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
Where <italic>l</italic> is once again a hyperparameter.</p>
</sec>
<sec id="sec015">
<title>L1 regression feature identification and weighting</title>
<p>To identify those contacts in the ChR structure most important in determining chimera function (here, localization) we used L1 regression. Given the nature of our library design and the limited set of chimeras tested, there are certain residues and contacts that covary within our training set. The effects of these covarying residues and contacts cannot be isolated from one another using this data set and therefore must be weighted together for their overall contribution to ChR function. By using the concatenated sequence and structure binary feature vector for the training set we were able to identify residues and contacts that covary. Each individual set of covarying residues and contacts was combined into a single feature. L1 linear regression was then used to weight features as either zero or non-zero in their contribution to ChR function. The level of regularization was chosen by LOO cross-validation. We then performed Bayesian ridge linear regression on features with non-zero L1 regression weights using the default settings in scikit-learn [<xref ref-type="bibr" rid="pcbi.1005786.ref042">42</xref>]. The Bayesian ridge linear regression weights were plotted onto the C1C2 structure to highlight positive and negative contributions to ChR localization (<bold><xref ref-type="fig" rid="pcbi.1005786.g005">Fig 5</xref></bold>) and ChR expression (<bold><xref ref-type="supplementary-material" rid="pcbi.1005786.s012">S11 Fig</xref></bold>).</p>
</sec>
</sec>
</sec>
<sec id="sec016">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005786.s001" mimetype="text/csv" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.s001" xlink:type="simple">
<label>S1 Data</label>
<caption>
<title>Localization and expression characterization of ChR chimeras predicted by the models.</title>
<p>Measured localization and expression properties for each chimera tested and associated chimera_name, set, number of mutations, chimera_block_ID, and sequence. Chimera names and chimera_block_ID begin with either ‘c’ or ‘n’ to indicate the contiguous or non-contiguous library. The following 10 digits in the chimera_block_ID indicate, in block order, the parent that contributes each of the 10 blocks (‘0’:CheRiff, ‘1’:C1C2, and ‘2’:CsChrimR). For the contiguous library, blocks in the chimera_block_ID are listed from N- to C-termini; for the non-contiguous library the block order is arbitrary. The set for which the chimera was generated is listed. The number of mutations (m) from the closest parent for each chimera is included. Sequences list only the ChR open reading frame, the C-terminal trafficking and mKate2.5 sequences have been removed. The table shows mean properties (mKate_mean, GFP_mean, and intensity_ratio_mean) and the standard deviation of properties (mKate_std, GFP_std, and intensity_ratio_std). ND: not detected, below the limit of detection for our assay.</p>
<p>(CSV)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005786.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.s002" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Chimera sequences in training set and their expression, localization, and localization efficiencies.</title>
<p>(<bold>A</bold>) (top) shows blocks (different colors) for the contiguous (contig) and non-contiguous (non-contig) library designs and also shows block boundaries (white lines) for the combined contiguous and non-contiguous library designs on the three parental ChRs aligned with a schematic of the ChR secondary structure. (bottom) Sequences of training set chimeras showing block identities. The colors represent the parental origin of the block (red–CsChrimR, green–C1C2, and blue–CheRiff). (<bold>B</bold>) Cumulative distributions of the measured expression, localization, and localization efficiency of all 218 chimeras with the three parental constructs highlighted in color (5).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005786.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.s003" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Chimera expression and localization cannot be predicted from simple rules.</title>
<p>Expression and localization measurements are plotted with chimeras grouped based on (<bold>A</bold>) signal peptide sequence identity and (<bold>B</bold>) hydrophobicity in the transmembrane (TM) domains. (<bold>A</bold>) Each chimera in the training set is grouped based on its signal peptide identity, which could be the CheRiff (0), C1C2 (1), or CsChrimR (2) signal peptide. The measured expression and localization are shown for each chimera in each of the three groups. (<bold>B</bold>) The measured expression and localization with respect to the calculated level of hydrophobicity within the 7-TM domains of each chimera. Hydrophobicity was calculated in the region of the protein highlighted in the surface rendering on the ChR structure.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005786.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.s004" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>GP binary classification model for localization efficiency.</title>
<p>Plots of predicted probability vs measured localization efficiency are divided into ‘high’ performers (white background) and ‘low’ performers (gray background) for localization efficiency. (<bold>A</bold>) Predicted probability vs measured localization efficiency for the training set (gray points) and the exploration set (cyan points). Predictions for the training and exploration sets were made using LOO cross-validation. (<bold>B</bold>) Predicted probabilities vs measured localization efficiency for the verification set. Predictions for the verification set were made by a model trained on the training and exploration sets. (<bold>C</bold>) Probability of ‘high’ localization efficiency for all chimeras in the recombination library (118,098 chimeras) made by a model trained on the data from the training and exploration sets. The gray line shows all chimeras in the library, the gray points indicate the training set, the cyan points indicate the exploration set, the purple points indicate the verification set, and the yellow points indicate the parents. For all plots, the measured localization efficiency is plotted on a log<sub>2</sub> scale.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005786.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.s005" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Chimera block identities for exploration, verification, and optimization sets.</title>
<p>Block identity of chimeras from each set ranked according to their performance for localization with the best ranking chimera listed at the top of the list. ‘High’ and ‘low’ indicates those chimeras had a high predicted probability of localization vs a low predicted probability of localization. Each row represents a chimera. The three different colors represent blocks from the three different parents (red–CsChrimR, green–C1C2, and blue–CheRiff). The number of mutations from the nearest parent and the number of mutations from the nearest previously tested chimera from the library are shown for each chimera.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005786.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.s006" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>ROC curves for GP classification expression, localization, and localization efficiency models.</title>
<p>ROC curves show true positive rate vs false positive rate for predictions from the expression (<bold>A</bold>), localization (<bold>B</bold>), and localization efficiency (<bold>C</bold>) classification models. The gray line shows the ROC for the combined training and exploration sets. The purple line shows the ROC for the verification set. The verification sets consist exclusively of chimeras with ‘high’ expression so no verification ROC curve for expression is shown. Predictions for the training and exploration sets were made using LOO cross-validation, while predictions for the verification set were made by a model trained on the training and exploration sets. Calculated AUC values are shown in the figure key.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005786.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.s007" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Comparison of measured expression and localization efficiency for each data set.</title>
<p>Swarm plots of expression (<bold>A</bold>) and localization efficiency (<bold>B</bold>) measurements for each data set compared with parents: training set, exploration set, verification set, and optimization set.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005786.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.s008" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Cell population distributions of expression, localization, and localization efficiency properties for each chimera in the verification and optimization sets compared with parents.</title>
<p>The distribution of expression (<bold>A</bold>), localization (<bold>B</bold>), and localization efficiency (<bold>C</bold>) for the population of transfected cells is plotted for each parent (top row), each chimera in the verification set (middle row), and each chimera in the optimization set (bottom row) using kernel density estimation for smoothing. Parents are plotted in red (CsChrimR), green (C1C2), and blue (CheRiff). Chimeras in the verification set are plotted in gray if they were predicted to be ‘low’ or purple if they were predicted to be ‘high’ in each property. The vertical, gray, dashed line indicates the mean behavior of the CheRiff parent for each property.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005786.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.s009" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Predictive ability of GP localization models as a function of training set size.</title>
<p>We trained GP models on random training sets of various sizes sampled from our data and evaluated their predictive performance on a fixed test set of sequences for the classification (<bold>A</bold>) and regression (<bold>B</bold>) localization models. The predictive performance of the classification model is described by AUC for the test set (<bold>A</bold>), while the predictive performance of the regression model (<bold>B</bold>) is described by the correlation coefficient (R-value) for the test set. For each training set size, the results are averaged over 100 random samples.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005786.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.s010" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Important features for prediction of ChR localization aligned with chimeras with optimal localization.</title>
<p>Features with positive weights from the localization model (<bold><xref ref-type="fig" rid="pcbi.1005786.g005">Fig 5</xref></bold>) are displayed on the C1C2 crystal structure which is colored based on the block design of two different chimeras, (<bold>A</bold>) n1_7 and (<bold>B</bold>) n4_7, from the optimization set. Features can be residues (spheres) or contacts (sticks) from one or more parent ChRs. Features/blocks from CsChrimR are shown in red, features/blocks from C1C2 are shown in green, and features/blocks from CheRiff are shown in blue. Gray positions are conserved residues. Sticks connect the beta carbons of contacting residues (or alpha carbon in the case of glycine). The size of the spheres and the thickness of the sticks are proportional to the parameter weights.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005786.s011" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.s011" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>GP regression model for ChR expression.</title>
<p>Shows the GP regression model predicted vs measured expression for the combined training and exploration sets (gray points). Predictions for the training and exploration sets were made using LOO cross-validation. The predicted and measured expression are plotted on a log<sub>2</sub> scale. The combined training and exploration sets showed good correlation (R &gt; 0.70).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005786.s012" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.s012" xlink:type="simple">
<label>S11 Fig</label>
<caption>
<title>Sequence and structure features important for prediction of ChR expression.</title>
<p>Features with positive (<bold>A</bold>) and negative (<bold>B</bold>) weights are displayed on the C1C2 crystal structure (grey). Features can be residues (spheres) or contacts (sticks) from one or more parent ChRs. Features from CsChrimR are shown in red, features from C1C2 are shown in green, and features from CheRiff are shown in blue. In cases where a feature is present in two parents, the following color priorities were used for consistency: red above green above blue. Sticks connect the beta carbons of contacting residues (or alpha carbon in the case of glycine). The size of the spheres and the thickness of the sticks are proportional to the parameter weights. Two residues in contact can be from the same or different parents. Single-color contacts occur when both contributing residues are from the same parent. Multi-color contacts occur when residues from different parents are in contact. The N-terminal domain (NTD), C-terminal domain (CTD), and the seven transmembrane helices (TM1-7) are labeled.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005786.s013" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005786.s013" xlink:type="simple">
<label>S12 Fig</label>
<caption>
<title>Localization of engineered CbChR1 variant chimera 3c.</title>
<p>Representative cell confocal images of mKate expression and GFP labeled localization of CsCbChR1 compared with top-performing CsCbChR1 single-block-swap chimera (chimera 3c), and top-performing parent (CsChrimR). CsCbChR1 shows weak expression and no localization, while chimera 3c expresses well and clearly localizes to the plasma membrane as does CsChrimR. Gain was adjusted in CsCbChR1 images to show any low signal. Scale bar: 10 μm.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Twist Bioscience for synthesizing and cloning ChR sequences as part of their α and β manufacturing programs. We thank the Gradinaru and Arnold labs for helpful discussions. We also thank Dr. John Bedbrook for critical reading of the manuscript. Imaging was performed in the Biological Imaging Facility, with the support of the Caltech Beckman Institute and the Arnold and Mabel Beckman Foundation.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005786.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Overington</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Al-Lazikani</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Hopkins</surname> <given-names>AL</given-names></name> (<year>2006</year>) <article-title>How many drug targets are there?</article-title> <source>Nat Rev Drug Discov</source> <volume>5</volume>: <fpage>993</fpage>–<lpage>996</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrd2199" xlink:type="simple">10.1038/nrd2199</ext-link></comment> <object-id pub-id-type="pmid">17139284</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cymer</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>von Heijne</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>SH</given-names></name> (<year>2015</year>) <article-title>Mechanisms of integral membrane protein insertion and folding</article-title>. <source>J Mol Biol</source> <volume>427</volume>: <fpage>999</fpage>–<lpage>1022</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jmb.2014.09.014" xlink:type="simple">10.1016/j.jmb.2014.09.014</ext-link></comment> <object-id pub-id-type="pmid">25277655</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chapple</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Cheetham</surname> <given-names>ME</given-names></name> (<year>2003</year>) <article-title>The chaperone environment at the cytoplasmic face of the endoplasmic reticulum can modulate rhodopsin processing and inclusion formation</article-title>. <source>J Biol Chem</source> <volume>278</volume>: <fpage>19087</fpage>–<lpage>19094</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1074/jbc.M212349200" xlink:type="simple">10.1074/jbc.M212349200</ext-link></comment> <object-id pub-id-type="pmid">12754272</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Goldberg</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Orci</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Schekman</surname> <given-names>R</given-names></name> (<year>2004</year>) <article-title>Bi-directional protein transport between the ER and Golgi</article-title>. <source>Annu Rev Cell Dev Biol</source> <volume>20</volume>: <fpage>87</fpage>–<lpage>123</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev.cellbio.20.010403.105307" xlink:type="simple">10.1146/annurev.cellbio.20.010403.105307</ext-link></comment> <object-id pub-id-type="pmid">15473836</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bedbrook</surname> <given-names>CN</given-names></name>, <name name-style="western"><surname>Rice</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>KK</given-names></name>, <name name-style="western"><surname>Ding</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2017</year>) <article-title>Structure-guided SCHEMA recombination generates diverse chimeric channelrhodopsins</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>.</mixed-citation></ref>
<ref id="pcbi.1005786.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Klenk</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ehrenmann</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schutz</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pluckthun</surname> <given-names>A</given-names></name> (<year>2016</year>) <article-title>A generic selection system for improved expression and thermostability of G protein-coupled receptors by directed evolution</article-title>. <source>Sci Rep</source> <volume>6</volume>: <fpage>21294</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/srep21294" xlink:type="simple">10.1038/srep21294</ext-link></comment> <object-id pub-id-type="pmid">26887595</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Andrell</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Tate</surname> <given-names>CG</given-names></name> (<year>2013</year>) <article-title>Overexpression of membrane proteins in mammalian cells for structural studies</article-title>. <source>Mol Membr Biol</source> <volume>30</volume>: <fpage>52</fpage>–<lpage>63</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3109/09687688.2012.703703" xlink:type="simple">10.3109/09687688.2012.703703</ext-link></comment> <object-id pub-id-type="pmid">22963530</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Spudich</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Jung</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Spudich</surname> <given-names>EN</given-names></name> (<year>2000</year>) <article-title>Retinylidene proteins: structures and functions from archaea to humans</article-title>. <source>Annu Rev Cell Dev Biol</source> <volume>16</volume>: <fpage>365</fpage>–<lpage>392</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev.cellbio.16.1.365" xlink:type="simple">10.1146/annurev.cellbio.16.1.365</ext-link></comment> <object-id pub-id-type="pmid">11031241</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Suzuki</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Yamasaki</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Fujita</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Oda</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Iseki</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>Archaeal-type rhodopsins in Chlamydomonas: model structure and intracellular localization</article-title>. <source>Biochem Biophys Res Commun</source> <volume>301</volume>: <fpage>711</fpage>–<lpage>717</lpage>. <object-id pub-id-type="pmid">12565839</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sineshchekov</surname> <given-names>OA</given-names></name>, <name name-style="western"><surname>Jung</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Spudich</surname> <given-names>JL</given-names></name> (<year>2002</year>) <article-title>Two rhodopsins mediate phototaxis to low- and high-intensity light in Chlamydomonas reinhardtii</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>99</volume>: <fpage>8689</fpage>–<lpage>8694</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.122243399" xlink:type="simple">10.1073/pnas.122243399</ext-link></comment> <object-id pub-id-type="pmid">12060707</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schneider</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Grimm</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hegemann</surname> <given-names>P</given-names></name> (<year>2015</year>) <source>Biophysics of Channelrhodopsin. Annu Rev Biophys</source> <volume>44</volume>: <fpage>167</fpage>–<lpage>186</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev-biophys-060414-034014" xlink:type="simple">10.1146/annurev-biophys-060414-034014</ext-link></comment> <object-id pub-id-type="pmid">26098512</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Boyden</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Bamberg</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Nagel</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Deisseroth</surname> <given-names>K</given-names></name> (<year>2005</year>) <article-title>Millisecond-timescale, genetically targeted optical control of neural activity</article-title>. <source>Nat Neurosci</source> <volume>8</volume>: <fpage>1263</fpage>–<lpage>1268</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1525" xlink:type="simple">10.1038/nn1525</ext-link></comment> <object-id pub-id-type="pmid">16116447</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ishizuka</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kakuda</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Araki</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Yawo</surname> <given-names>H</given-names></name> (<year>2006</year>) <article-title>Kinetic evaluation of photosensitivity in genetically engineered neurons expressing green algae light-gated channels</article-title>. <source>Neurosci Res</source> <volume>54</volume>: <fpage>85</fpage>–<lpage>94</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neures.2005.10.009" xlink:type="simple">10.1016/j.neures.2005.10.009</ext-link></comment> <object-id pub-id-type="pmid">16298005</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yizhar</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Fenno</surname> <given-names>LE</given-names></name>, <name name-style="western"><surname>Davidson</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Mogri</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Deisseroth</surname> <given-names>K</given-names></name> (<year>2011</year>) <article-title>Optogenetics in neural systems</article-title>. <source>Neuron</source> <volume>71</volume>: <fpage>9</fpage>–<lpage>34</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2011.06.004" xlink:type="simple">10.1016/j.neuron.2011.06.004</ext-link></comment> <object-id pub-id-type="pmid">21745635</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fleming</surname> <given-names>KG</given-names></name> (<year>2014</year>) <article-title>Energetics of membrane protein folding</article-title>. <source>Annu Rev Biophys</source> <volume>43</volume>: <fpage>233</fpage>–<lpage>255</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev-biophys-051013-022926" xlink:type="simple">10.1146/annurev-biophys-051013-022926</ext-link></comment> <object-id pub-id-type="pmid">24895854</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Elazar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Weinstein</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Biran</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Fridman</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bibi</surname> <given-names>E</given-names></name>, <etal>et al</etal>. (<year>2016</year>) <article-title>Mutational scanning reveals the determinants of protein insertion and association energetics in the plasma membrane</article-title>. <source>Elife 5</source>.</mixed-citation></ref>
<ref id="pcbi.1005786.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>White</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Wimley</surname> <given-names>WC</given-names></name> (<year>1999</year>) <article-title>Membrane protein folding and stability: physical principles</article-title>. <source>Annu Rev Biophys Biomol Struct</source> <volume>28</volume>: <fpage>319</fpage>–<lpage>365</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev.biophys.28.1.319" xlink:type="simple">10.1146/annurev.biophys.28.1.319</ext-link></comment> <object-id pub-id-type="pmid">10410805</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>von Heijne</surname> <given-names>G</given-names></name> (<year>1989</year>) <article-title>Control of topology and mode of assembly of a polytopic membrane protein by positively charged residues</article-title>. <source>Nature</source> <volume>341</volume>: <fpage>456</fpage>–<lpage>458</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/341456a0" xlink:type="simple">10.1038/341456a0</ext-link></comment> <object-id pub-id-type="pmid">2677744</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Duong</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Jaszewski</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Fleming</surname> <given-names>KG</given-names></name>, <name name-style="western"><surname>MacKenzie</surname> <given-names>KR</given-names></name> (<year>2007</year>) <article-title>Changes in apparent free energy of helix-helix dimerization in a biological membrane due to point mutations</article-title>. <source>J Mol Biol</source> <volume>371</volume>: <fpage>422</fpage>–<lpage>434</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jmb.2007.05.026" xlink:type="simple">10.1016/j.jmb.2007.05.026</ext-link></comment> <object-id pub-id-type="pmid">17570394</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Habibi</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Mohd Hashim</surname> <given-names>SZ</given-names></name>, <name name-style="western"><surname>Norouzi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Samian</surname> <given-names>MR</given-names></name> (<year>2014</year>) <article-title>A review of machine learning methods to predict the solubility of overexpressed recombinant proteins in Escherichia coli</article-title>. <source>BMC Bioinformatics</source> <volume>15</volume>: <fpage>134</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-15-134" xlink:type="simple">10.1186/1471-2105-15-134</ext-link></comment> <object-id pub-id-type="pmid">24885721</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilkinson</surname> <given-names>DL</given-names></name>, <name name-style="western"><surname>Harrison</surname> <given-names>RG</given-names></name> (<year>1991</year>) <article-title>Predicting the solubility of recombinant proteins in Escherichia coli</article-title>. <source>Biotechnology (N Y)</source> <volume>9</volume>: <fpage>443</fpage>–<lpage>448</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005786.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chang</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Webb</surname> <given-names>GI</given-names></name>, <name name-style="western"><surname>Tey</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Song</surname> <given-names>J</given-names></name>, <etal>et al</etal>. (<year>2016</year>) <article-title>Periscope: quantitative prediction of soluble protein expression in the periplasm of Escherichia coli</article-title>. <source>Sci Rep</source> <volume>6</volume>: <fpage>21844</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/srep21844" xlink:type="simple">10.1038/srep21844</ext-link></comment> <object-id pub-id-type="pmid">26931649</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Webb</surname> <given-names>GI</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>D</given-names></name>, <etal>et al</etal>. (<year>2016</year>) <article-title>Crysalis: an integrated server for computational analysis and design of protein crystallization</article-title>. <source>Sci Rep</source> <volume>6</volume>: <fpage>21383</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/srep21383" xlink:type="simple">10.1038/srep21383</ext-link></comment> <object-id pub-id-type="pmid">26906024</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Radivojac</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>WT</given-names></name>, <name name-style="western"><surname>Oron</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Schnoes</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Wittkop</surname> <given-names>T</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>A large-scale evaluation of computational protein function prediction</article-title>. <source>Nat Methods</source> <volume>10</volume>: <fpage>221</fpage>–<lpage>227</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.2340" xlink:type="simple">10.1038/nmeth.2340</ext-link></comment> <object-id pub-id-type="pmid">23353650</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref025"><label>25</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Rasmussen</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>CKI</given-names></name> (<year>2006</year>) <source>Gaussian Processes for Machine Learning</source> <publisher-loc>Cambridge, MA</publisher-loc>: <publisher-name>the MIT Press</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1005786.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Romero</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Krause</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Arnold</surname> <given-names>FH</given-names></name> (<year>2013</year>) <article-title>Navigating the protein fitness landscape with Gaussian processes</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>110</volume>: <fpage>E193</fpage>–<lpage>201</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1215251110" xlink:type="simple">10.1073/pnas.1215251110</ext-link></comment> <object-id pub-id-type="pmid">23277561</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Romero</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Arnold</surname> <given-names>FH</given-names></name> (<year>2009</year>) <article-title>Exploring protein fitness landscapes by directed evolution</article-title>. <source>Nat Rev Mol Cell Biol</source> <volume>10</volume>: <fpage>866</fpage>–<lpage>876</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrm2805" xlink:type="simple">10.1038/nrm2805</ext-link></comment> <object-id pub-id-type="pmid">19935669</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Klapoetke</surname> <given-names>NC</given-names></name>, <name name-style="western"><surname>Murata</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Pulver</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Birdsey-Benson</surname> <given-names>A</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Independent optical excitation of distinct neural populations</article-title>. <source>Nat Methods</source> <volume>11</volume>: <fpage>338</fpage>–<lpage>346</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.2836" xlink:type="simple">10.1038/nmeth.2836</ext-link></comment> <object-id pub-id-type="pmid">24509633</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kato</surname> <given-names>HE</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Yizhar</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Ramakrishnan</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Nishizawa</surname> <given-names>T</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Crystal structure of the channelrhodopsin light-gated cation channel</article-title>. <source>Nature</source> <volume>482</volume>: <fpage>369</fpage>–<lpage>374</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature10870" xlink:type="simple">10.1038/nature10870</ext-link></comment> <object-id pub-id-type="pmid">22266941</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hochbaum</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Farhi</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Klapoetke</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Werley</surname> <given-names>CA</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>All-optical electrophysiology in mammalian neurons using engineered microbial rhodopsins</article-title>. <source>Nat Methods</source> <volume>11</volume>: <fpage>825</fpage>–<lpage>833</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.3000" xlink:type="simple">10.1038/nmeth.3000</ext-link></comment> <object-id pub-id-type="pmid">24952910</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Voigt</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Martinez</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>ZG</given-names></name>, <name name-style="western"><surname>Mayo</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Arnold</surname> <given-names>FH</given-names></name> (<year>2002</year>) <article-title>Protein building blocks preserved by recombination</article-title>. <source>Nat Struct Biol</source> <volume>9</volume>: <fpage>553</fpage>–<lpage>558</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nsb805" xlink:type="simple">10.1038/nsb805</ext-link></comment> <object-id pub-id-type="pmid">12042875</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Drummond</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Sawayama</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Snow</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Bloom</surname> <given-names>JD</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>A diverse family of thermostable cytochrome P450s created by recombination of stabilizing fragments</article-title>. <source>Nat Biotechnol</source> <volume>25</volume>: <fpage>1051</fpage>–<lpage>1056</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt1333" xlink:type="simple">10.1038/nbt1333</ext-link></comment> <object-id pub-id-type="pmid">17721510</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Romero</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Brustad</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Arnold</surname> <given-names>FH</given-names></name> (<year>2013</year>) <article-title>Chimeragenesis of distantly-related proteins by noncontiguous recombination</article-title>. <source>Protein Sci</source> <volume>22</volume>: <fpage>231</fpage>–<lpage>238</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/pro.2202" xlink:type="simple">10.1002/pro.2202</ext-link></comment> <object-id pub-id-type="pmid">23225662</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Romero</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Stone</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lamb</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Chantranupong</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Krause</surname> <given-names>A</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>SCHEMA-designed variants of human Arginase I and II reveal sequence elements important to stability and catalysis</article-title>. <source>ACS Synth Biol</source> <volume>1</volume>: <fpage>221</fpage>–<lpage>228</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/sb300014t" xlink:type="simple">10.1021/sb300014t</ext-link></comment> <object-id pub-id-type="pmid">22737599</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref035"><label>35</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Krause</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Golovin</surname> <given-names>D</given-names></name> (<year>2014</year>) <chapter-title>Submodular function maximization</chapter-title>. <source>Tractability: Practical Approaches to Hard Problems</source>: <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1005786.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bedbrook</surname> <given-names>CN</given-names></name>, <name name-style="western"><surname>Kato</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ravindra Kumar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lakshmanan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Nath</surname> <given-names>RD</given-names></name>, <etal>et al</etal>. (<year>2015</year>) <article-title>Genetically Encoded Spy Peptide Fusion System to Detect Plasma Membrane-Localized Proteins In Vivo</article-title>. <source>Chem Biol</source> <volume>22</volume>: <fpage>1108</fpage>–<lpage>1121</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.chembiol.2015.06.020" xlink:type="simple">10.1016/j.chembiol.2015.06.020</ext-link></comment> <object-id pub-id-type="pmid">26211362</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref037"><label>37</label><mixed-citation publication-type="other" xlink:type="simple">Srinivas N, Krause A, Kakade SM, Seeger M. Gaussian process optimization in the bandit setting: No regret and experimental design.; 2010; Haifa, Israel.</mixed-citation></ref>
<ref id="pcbi.1005786.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kyte</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Doolittle</surname> <given-names>RF</given-names></name> (<year>1982</year>) <article-title>A simple method for displaying the hydropathic character of a protein</article-title>. <source>J Mol Biol</source> <volume>157</volume>: <fpage>105</fpage>–<lpage>132</lpage>. <object-id pub-id-type="pmid">7108955</object-id></mixed-citation></ref>
<ref id="pcbi.1005786.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Walt</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Colbert</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Varoquaux</surname> <given-names>G</given-names></name> (<year>2011</year>) <article-title>The NumPy array: a structure for efficient numerical computation</article-title>. <source>Computing in Science and Engineering</source> <volume>13</volume>: <fpage>22</fpage>–<lpage>30</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005786.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hunter</surname> <given-names>JD</given-names></name> (<year>2007</year>) <article-title>Matplotlib: A 2D Graphics Environment</article-title>. <source>Computing in Science and Engineering</source> <volume>9</volume>: <fpage>90</fpage>–<lpage>95</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005786.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oliphant</surname> <given-names>TE</given-names></name> (<year>2007</year>) <article-title>Python for Scientific Computing</article-title>. <source>Computing in Science and Engineering</source> <volume>9</volume>: <fpage>10</fpage>–<lpage>20</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005786.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pedregosa</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Varoquaux</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gramfort</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Michel</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Thirion</surname> <given-names>B</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Scikit-learn: Machine Learning in Python</article-title>. <source>Journal of Machine Learning Research</source> <volume>12</volume>: <fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>